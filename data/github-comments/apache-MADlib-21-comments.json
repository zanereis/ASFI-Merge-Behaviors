[{"url":"https://api.github.com/repos/apache/madlib/issues/comments/682118085","html_url":"https://github.com/apache/madlib/pull/514#issuecomment-682118085","issue_url":"https://api.github.com/repos/apache/madlib/issues/514","id":682118085,"node_id":"MDEyOklzc3VlQ29tbWVudDY4MjExODA4NQ==","user":{"login":"fmcquillan99","id":10538173,"node_id":"MDQ6VXNlcjEwNTM4MTcz","avatar_url":"https://avatars.githubusercontent.com/u/10538173?v=4","gravatar_id":"","url":"https://api.github.com/users/fmcquillan99","html_url":"https://github.com/fmcquillan99","followers_url":"https://api.github.com/users/fmcquillan99/followers","following_url":"https://api.github.com/users/fmcquillan99/following{/other_user}","gists_url":"https://api.github.com/users/fmcquillan99/gists{/gist_id}","starred_url":"https://api.github.com/users/fmcquillan99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmcquillan99/subscriptions","organizations_url":"https://api.github.com/users/fmcquillan99/orgs","repos_url":"https://api.github.com/users/fmcquillan99/repos","events_url":"https://api.github.com/users/fmcquillan99/events{/privacy}","received_events_url":"https://api.github.com/users/fmcquillan99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-08-27T18:30:04Z","updated_at":"2020-08-27T18:30:34Z","author_association":"NONE","body":"updated user doc as:\r\n\r\n```\r\npred_type (optional)\r\nTEXT, default: 'prob'. Type of output desired, where 'prob' gives predictions for all classes and their associated \r\nprobabilities.  To see only the top probability use 'response'.  Alternatively, you can specify a filter for top n or \r\nminimum probability.  For top n, use  an INTEGER > 0 to indicate the top ranked probabilities to output.  \r\nFor minimum probability, specify a REAL value between 0.0 and 1.0 for the cutoff.\r\n```\r\n\r\n'prob' (default). -- u made it 'all'  but please change back to 'prob'\r\n\r\n'response' -- don't show rank col\r\n\r\nupdated user doc\r\n\r\nINTEGER 1, 2, 3... yes show rank col\r\n\r\nDOUBLE between 0.0 and 1.0 yes show rank col\r\n\r\ndifferentiate between 1.0 and 1\r\n\r\nsuggested error message\r\n\r\nplpy.Error: madlib_keras_predict: Invalid value for pred_type param (azdadg). Must be integer>0, double precision between 0.0 and 1.0, 'response' or 'prob'. (plpython.c:5038)","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/682118085/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/682218982","html_url":"https://github.com/apache/madlib/pull/514#issuecomment-682218982","issue_url":"https://api.github.com/repos/apache/madlib/issues/514","id":682218982,"node_id":"MDEyOklzc3VlQ29tbWVudDY4MjIxODk4Mg==","user":{"login":"fmcquillan99","id":10538173,"node_id":"MDQ6VXNlcjEwNTM4MTcz","avatar_url":"https://avatars.githubusercontent.com/u/10538173?v=4","gravatar_id":"","url":"https://api.github.com/users/fmcquillan99","html_url":"https://github.com/fmcquillan99","followers_url":"https://api.github.com/users/fmcquillan99/followers","following_url":"https://api.github.com/users/fmcquillan99/following{/other_user}","gists_url":"https://api.github.com/users/fmcquillan99/gists{/gist_id}","starred_url":"https://api.github.com/users/fmcquillan99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmcquillan99/subscriptions","organizations_url":"https://api.github.com/users/fmcquillan99/orgs","repos_url":"https://api.github.com/users/fmcquillan99/repos","events_url":"https://api.github.com/users/fmcquillan99/events{/privacy}","received_events_url":"https://api.github.com/users/fmcquillan99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-08-27T22:17:49Z","updated_at":"2020-08-27T22:17:49Z","author_association":"NONE","body":"LGTM","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/682218982/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/682259949","html_url":"https://github.com/apache/madlib/pull/514#issuecomment-682259949","issue_url":"https://api.github.com/repos/apache/madlib/issues/514","id":682259949,"node_id":"MDEyOklzc3VlQ29tbWVudDY4MjI1OTk0OQ==","user":{"login":"reductionista","id":2644901,"node_id":"MDQ6VXNlcjI2NDQ5MDE=","avatar_url":"https://avatars.githubusercontent.com/u/2644901?v=4","gravatar_id":"","url":"https://api.github.com/users/reductionista","html_url":"https://github.com/reductionista","followers_url":"https://api.github.com/users/reductionista/followers","following_url":"https://api.github.com/users/reductionista/following{/other_user}","gists_url":"https://api.github.com/users/reductionista/gists{/gist_id}","starred_url":"https://api.github.com/users/reductionista/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/reductionista/subscriptions","organizations_url":"https://api.github.com/users/reductionista/orgs","repos_url":"https://api.github.com/users/reductionista/repos","events_url":"https://api.github.com/users/reductionista/events{/privacy}","received_events_url":"https://api.github.com/users/reductionista/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-08-28T00:36:52Z","updated_at":"2020-08-28T00:36:52Z","author_association":"CONTRIBUTOR","body":"We should update the usage message (lines 384-394 in `madlib_keras_predict.py_in`:\r\n```\r\nThe output table ('output_table' above) contains the following columns:\tThe output table ('output_table' above) contains the following columns:\r\nid:                 Gives the 'id' for each prediction, corresponding\tid:                 Gives the 'id' for each prediction, corresponding\r\n                    to each row from the test_table.\t                    to each row from the test_table.\r\nestimated_COL_NAME: (For pred_type='response') The estimated class for\testimated_COL_NAME: (For pred_type='response') The estimated class for\r\n                    classification, where COL_NAME is the name of the\t                    classification, where COL_NAME is the name of the\r\n                    column to be predicted from test data.\t                    column to be predicted from test data.\r\nprob_CLASS:         (For pred_type='prob' for classification) The\tprob_CLASS:         (For pred_type='prob' for classification) The\r\n                    probability of a given class. There will be one\t                    probability of a given class. There will be one\r\n                    column for each class in the training data.\t                    column for each class in the training data.\r\n                    TODO change this\r\n```\r\nBut other than that looks good!","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/682259949/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/688930405","html_url":"https://github.com/apache/madlib/pull/513#issuecomment-688930405","issue_url":"https://api.github.com/repos/apache/madlib/issues/513","id":688930405,"node_id":"MDEyOklzc3VlQ29tbWVudDY4ODkzMDQwNQ==","user":{"login":"fmcquillan99","id":10538173,"node_id":"MDQ6VXNlcjEwNTM4MTcz","avatar_url":"https://avatars.githubusercontent.com/u/10538173?v=4","gravatar_id":"","url":"https://api.github.com/users/fmcquillan99","html_url":"https://github.com/fmcquillan99","followers_url":"https://api.github.com/users/fmcquillan99/followers","following_url":"https://api.github.com/users/fmcquillan99/following{/other_user}","gists_url":"https://api.github.com/users/fmcquillan99/gists{/gist_id}","starred_url":"https://api.github.com/users/fmcquillan99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmcquillan99/subscriptions","organizations_url":"https://api.github.com/users/fmcquillan99/orgs","repos_url":"https://api.github.com/users/fmcquillan99/repos","events_url":"https://api.github.com/users/fmcquillan99/events{/privacy}","received_events_url":"https://api.github.com/users/fmcquillan99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-09-08T14:51:07Z","updated_at":"2020-09-08T14:51:07Z","author_association":"NONE","body":"@Advitya17 What is the syntax error here please?\r\n```\r\nSELECT madlib.madlib_keras_automl('cifar10_train_packed', \r\n                           'automl_cifar10_output', \r\n                           'model_arch_library', \r\n                           'automl_cifar_10_mst_table',\r\n                           ARRAY[1], \r\n                           $${'loss': ['categorical_crossentropy'], \r\n                              'optimizer_params_list': [\r\n                                  {'optimizer': ['Adam'],'lr': [0.001, 0.0001, 'log']}\r\n                                  {'optimizer': ['Adam'],'lr': [0.001, 0.0001, 'log']}],\r\n                             'metrics':['accuracy']}$$, \r\n                           $${'batch_size': [64, 128], 'epochs': [1]}$$,\r\n                           'hyperband', \r\n                           'R=9, eta=3, skip_last=2');\r\n```\r\n```\r\nInternalError: (psycopg2.errors.InternalError_) SyntaxError: invalid syntax (<unknown>, line 1) (plpython.c:5038)\r\nCONTEXT:  Traceback (most recent call last):\r\n  PL/Python function \"madlib_keras_automl\", line 21, in <module>\r\n    schedule_loader = madlib_keras_automl.KerasAutoML(**globals())\r\n  PL/Python function \"madlib_keras_automl\", line 42, in wrapper\r\n  PL/Python function \"madlib_keras_automl\", line 215, in __init__\r\n  PL/Python function \"madlib_keras_automl\", line 308, in find_hyperband_config\r\n  PL/Python function \"madlib_keras_automl\", line 42, in wrapper\r\n  PL/Python function \"madlib_keras_automl\", line 283, in __init__\r\n  PL/Python function \"madlib_keras_automl\", line 48, in literal_eval\r\n  PL/Python function \"madlib_keras_automl\", line 36, in parse\r\nPL/Python function \"madlib_keras_automl\"\r\n\r\n[SQL: SELECT madlib.madlib_keras_automl('cifar10_train_packed', \r\n                           'automl_cifar10_output', \r\n                           'model_arch_library', \r\n                           'automl_cifar_10_mst_table',\r\n                           ARRAY[1], \r\n                           $${'loss': ['categorical_crossentropy'], \r\n                              'optimizer_params_list': [\r\n                                  {'optimizer': ['Adam'],'lr': [0.001, 0.0001, 'log']}\r\n                                  {'optimizer': ['Adam'],'lr': [0.001, 0.0001, 'log']}],\r\n                             'metrics':['accuracy']}$$, \r\n                           $${'batch_size': [64, 128], 'epochs': [1]}$$,\r\n                           'hyperband', \r\n                           'R=9, eta=3, skip_last=2');]\r\n(Background on this error at: http://sqlalche.me/e/2j85)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/688930405/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/688997702","html_url":"https://github.com/apache/madlib/pull/513#issuecomment-688997702","issue_url":"https://api.github.com/repos/apache/madlib/issues/513","id":688997702,"node_id":"MDEyOklzc3VlQ29tbWVudDY4ODk5NzcwMg==","user":{"login":"Advitya17","id":37190647,"node_id":"MDQ6VXNlcjM3MTkwNjQ3","avatar_url":"https://avatars.githubusercontent.com/u/37190647?v=4","gravatar_id":"","url":"https://api.github.com/users/Advitya17","html_url":"https://github.com/Advitya17","followers_url":"https://api.github.com/users/Advitya17/followers","following_url":"https://api.github.com/users/Advitya17/following{/other_user}","gists_url":"https://api.github.com/users/Advitya17/gists{/gist_id}","starred_url":"https://api.github.com/users/Advitya17/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Advitya17/subscriptions","organizations_url":"https://api.github.com/users/Advitya17/orgs","repos_url":"https://api.github.com/users/Advitya17/repos","events_url":"https://api.github.com/users/Advitya17/events{/privacy}","received_events_url":"https://api.github.com/users/Advitya17/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-09-08T16:35:46Z","updated_at":"2020-09-08T16:39:31Z","author_association":"CONTRIBUTOR","body":"> @Advitya17 What is the syntax error here please?\r\n> \r\n> ```\r\n> SELECT madlib.madlib_keras_automl('cifar10_train_packed', \r\n>                            'automl_cifar10_output', \r\n>                            'model_arch_library', \r\n>                            'automl_cifar_10_mst_table',\r\n>                            ARRAY[1], \r\n>                            $${'loss': ['categorical_crossentropy'], \r\n>                               'optimizer_params_list': [\r\n>                                   {'optimizer': ['Adam'],'lr': [0.001, 0.0001, 'log']}\r\n>                                   {'optimizer': ['Adam'],'lr': [0.001, 0.0001, 'log']}],\r\n>                              'metrics':['accuracy']}$$, \r\n>                            $${'batch_size': [64, 128], 'epochs': [1]}$$,\r\n>                            'hyperband', \r\n>                            'R=9, eta=3, skip_last=2');\r\n> ```\r\n> \r\n> ```\r\n> InternalError: (psycopg2.errors.InternalError_) SyntaxError: invalid syntax (<unknown>, line 1) (plpython.c:5038)\r\n> CONTEXT:  Traceback (most recent call last):\r\n>   PL/Python function \"madlib_keras_automl\", line 21, in <module>\r\n>     schedule_loader = madlib_keras_automl.KerasAutoML(**globals())\r\n>   PL/Python function \"madlib_keras_automl\", line 42, in wrapper\r\n>   PL/Python function \"madlib_keras_automl\", line 215, in __init__\r\n>   PL/Python function \"madlib_keras_automl\", line 308, in find_hyperband_config\r\n>   PL/Python function \"madlib_keras_automl\", line 42, in wrapper\r\n>   PL/Python function \"madlib_keras_automl\", line 283, in __init__\r\n>   PL/Python function \"madlib_keras_automl\", line 48, in literal_eval\r\n>   PL/Python function \"madlib_keras_automl\", line 36, in parse\r\n> PL/Python function \"madlib_keras_automl\"\r\n> \r\n> [SQL: SELECT madlib.madlib_keras_automl('cifar10_train_packed', \r\n>                            'automl_cifar10_output', \r\n>                            'model_arch_library', \r\n>                            'automl_cifar_10_mst_table',\r\n>                            ARRAY[1], \r\n>                            $${'loss': ['categorical_crossentropy'], \r\n>                               'optimizer_params_list': [\r\n>                                   {'optimizer': ['Adam'],'lr': [0.001, 0.0001, 'log']}\r\n>                                   {'optimizer': ['Adam'],'lr': [0.001, 0.0001, 'log']}],\r\n>                              'metrics':['accuracy']}$$, \r\n>                            $${'batch_size': [64, 128], 'epochs': [1]}$$,\r\n>                            'hyperband', \r\n>                            'R=9, eta=3, skip_last=2');]\r\n> (Background on this error at: http://sqlalche.me/e/2j85)\r\n> ```\r\n\r\n- There needs to be a comma between the dictionaries specified inside optimizer_params_list\r\n- All the params (except optimizer) in the optimizer_params_list should be of the format [lower_bound, upper_bound, distribution_type] and you should specify `[0.0001, 0.001, 'log']` instead of `[0.001, 0.0001, 'log']`.\r\n\r\nThanks for the question though. When I tried it with the right syntax and got the assertion error related to the format of specifying distribution with `[0.001, 0.0001, 'log']`, I saw the error message I threw wasn't completely intuitive, so I can modify its language a bit. ","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/688997702/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/690776040","html_url":"https://github.com/apache/madlib/pull/513#issuecomment-690776040","issue_url":"https://api.github.com/repos/apache/madlib/issues/513","id":690776040,"node_id":"MDEyOklzc3VlQ29tbWVudDY5MDc3NjA0MA==","user":{"login":"fmcquillan99","id":10538173,"node_id":"MDQ6VXNlcjEwNTM4MTcz","avatar_url":"https://avatars.githubusercontent.com/u/10538173?v=4","gravatar_id":"","url":"https://api.github.com/users/fmcquillan99","html_url":"https://github.com/fmcquillan99","followers_url":"https://api.github.com/users/fmcquillan99/followers","following_url":"https://api.github.com/users/fmcquillan99/following{/other_user}","gists_url":"https://api.github.com/users/fmcquillan99/gists{/gist_id}","starred_url":"https://api.github.com/users/fmcquillan99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmcquillan99/subscriptions","organizations_url":"https://api.github.com/users/fmcquillan99/orgs","repos_url":"https://api.github.com/users/fmcquillan99/repos","events_url":"https://api.github.com/users/fmcquillan99/events{/privacy}","received_events_url":"https://api.github.com/users/fmcquillan99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-09-10T23:02:02Z","updated_at":"2020-09-10T23:04:06Z","author_association":"NONE","body":"iris dataset\r\n\r\n(1)\r\nschedule:\r\n```\r\n s | i | n_i | r_i \r\n---+---+-----+-----\r\n 2 | 0 |   9 |   1\r\n 2 | 1 |   3 |   3\r\n 2 | 2 |   1 |   9\r\n 1 | 0 |   3 |   3\r\n 1 | 1 |   1 |   9\r\n 0 | 0 |   3 |   9\r\n(6 rows)\r\n```\r\ntrain:\r\n```\r\nDROP TABLE IF EXISTS automl_output, automl_output_info, automl_output_summary, automl_mst_table, automl_mst_table_summary;\r\n\r\nSELECT madlib.madlib_keras_automl('iris_train_packed', \r\n                                  'automl_output', \r\n                                  'model_arch_library_iris', \r\n                                  'automl_mst_table',\r\n                                  ARRAY[1], \r\n                                  $${'loss': ['categorical_crossentropy'], 'optimizer_params_list': [ {'optimizer': ['Adam'],'lr': [0.00999, 0.01001, 'log']}], 'metrics':['accuracy']}$$, \r\n                                  $${'batch_size': [8], 'epochs': [1]}$$,\r\n                                  'hyperband', \r\n                                  'R=9, eta=3, skip_last=0',\r\n                                  42,                  -- random state\r\n                                  NULL,                  -- object table\r\n                                  FALSE,                 -- use GPUs\r\n                                  'iris_test_packed',    -- validation table\r\n                                   1,                     -- metrics compute freq\r\n                                  'a name is a name',                  -- name\r\n                                  'a descr is a descr');                 -- descr\r\n```\r\nproduces:\r\n```\r\nINFO:  *** Diagonally evaluating 9 configs under bracket=2 & round=0 with 1 iterations ***\r\nCONTEXT:  PL/Python function \"madlib_keras_automl\"\r\nINFO:  \r\n\tTime for training in iteration 1: 8.45693087578 sec\r\nDETAIL:  \r\n\tTraining set after iteration 1:\r\n\tmst_key=2: metric=0.933333337307, loss=0.538550555706\r\n\tmst_key=8: metric=0.316666662693, loss=1.03528738022\r\n\tmst_key=3: metric=0.675000011921, loss=0.833593308926\r\n\tmst_key=6: metric=0.658333361149, loss=0.825735092163\r\n\tmst_key=1: metric=0.808333337307, loss=0.872115910053\r\n\tmst_key=7: metric=0.625, loss=0.974291205406\r\n\tmst_key=9: metric=0.658333361149, loss=0.830321311951\r\n\tmst_key=4: metric=0.658333361149, loss=0.885693848133\r\n\tmst_key=5: metric=0.341666668653, loss=1.09756851196\r\n\tValidation set after iteration 1:\r\n\tmst_key=2: metric=0.966666638851, loss=0.534965932369\r\n\tmst_key=8: metric=0.366666674614, loss=1.03363573551\r\n\tmst_key=3: metric=0.633333325386, loss=0.872259676456\r\n\tmst_key=6: metric=0.699999988079, loss=0.799027740955\r\n\tmst_key=1: metric=0.833333313465, loss=0.866640985012\r\n\tmst_key=7: metric=0.5, loss=0.974297106266\r\n\tmst_key=9: metric=0.699999988079, loss=0.829889714718\r\n\tmst_key=4: metric=0.699999988079, loss=0.885949194431\r\n\tmst_key=5: metric=0.300000011921, loss=1.10424804688\r\nCONTEXT:  PL/Python function \"madlib_keras_automl\"\r\nINFO:  *** Diagonally evaluating 3 configs under bracket=2 & round=1, 3 configs under bracket=1 & round=0 with 3 iterations ***\r\nCONTEXT:  PL/Python function \"madlib_keras_automl\"\r\nINFO:  \r\n\tTime for training in iteration 1: 4.89221119881 sec\r\nDETAIL:  \r\n\tTraining set after iteration 1:\r\n\tmst_key=9: metric=0.658333361149, loss=0.530654907227\r\n\tmst_key=6: metric=0.774999976158, loss=0.531277298927\r\n\tmst_key=11: metric=0.691666662693, loss=0.861804306507\r\n\tmst_key=2: metric=0.716666638851, loss=0.426045030355\r\n\tmst_key=12: metric=0.608333349228, loss=0.984588444233\r\n\tmst_key=10: metric=0.324999988079, loss=1.17993462086\r\n\tValidation set after iteration 1:\r\n\tmst_key=9: metric=0.699999988079, loss=0.514933288097\r\n\tmst_key=6: metric=0.800000011921, loss=0.519642591476\r\n\tmst_key=11: metric=0.666666686535, loss=0.861222624779\r\n\tmst_key=2: metric=0.733333349228, loss=0.385236173868\r\n\tmst_key=12: metric=0.699999988079, loss=0.961848556995\r\n\tmst_key=10: metric=0.366666674614, loss=1.16651546955\r\nCONTEXT:  PL/Python function \"madlib_keras_automl\"\r\nINFO:  \r\n\tTime for training in iteration 2: 5.0256319046 sec\r\nDETAIL:  \r\n\tTraining set after iteration 2:\r\n\tmst_key=9: metric=0.966666638851, loss=0.432032138109\r\n\tmst_key=6: metric=0.908333361149, loss=0.361528068781\r\n\tmst_key=11: metric=0.858333349228, loss=0.686981141567\r\n\tmst_key=2: metric=0.758333325386, loss=0.373835682869\r\n\tmst_key=12: metric=0.600000023842, loss=0.89406478405\r\n\tmst_key=10: metric=0.341666668653, loss=1.13211238384\r\n\tValidation set after iteration 2:\r\n\tmst_key=9: metric=0.933333337307, loss=0.442799389362\r\n\tmst_key=6: metric=0.933333337307, loss=0.350269824266\r\n\tmst_key=11: metric=0.833333313465, loss=0.694237530231\r\n\tmst_key=2: metric=0.899999976158, loss=0.325422286987\r\n\tmst_key=12: metric=0.699999988079, loss=0.868638038635\r\n\tmst_key=10: metric=0.300000011921, loss=1.14590144157\r\nCONTEXT:  PL/Python function \"madlib_keras_automl\"\r\nINFO:  \r\n\tTime for training in iteration 3: 4.99592685699 sec\r\nDETAIL:  \r\n\tTraining set after iteration 3:\r\n\tmst_key=9: metric=0.699999988079, loss=0.403143405914\r\n\tmst_key=6: metric=0.949999988079, loss=0.292406588793\r\n\tmst_key=11: metric=0.949999988079, loss=0.614805757999\r\n\tmst_key=2: metric=0.658333361149, loss=0.662374198437\r\n\tmst_key=12: metric=0.47499999404, loss=0.713567197323\r\n\tmst_key=10: metric=0.40000000596, loss=1.08757543564\r\n\tValidation set after iteration 3:\r\n\tmst_key=9: metric=0.733333349228, loss=0.365277469158\r\n\tmst_key=6: metric=0.899999976158, loss=0.303717941046\r\n\tmst_key=11: metric=0.966666638851, loss=0.615865588188\r\n\tmst_key=2: metric=0.633333325386, loss=0.758127868176\r\n\tmst_key=12: metric=0.566666662693, loss=0.689917981625\r\n\tmst_key=10: metric=0.300000011921, loss=1.09673452377\r\nCONTEXT:  PL/Python function \"madlib_keras_automl\"\r\nINFO:  *** Diagonally evaluating 1 configs under bracket=2 & round=2, 1 configs under bracket=1 & round=1, 3 configs under bracket=0 & round=0 with 9 iterations ***\r\nCONTEXT:  PL/Python function \"madlib_keras_automl\"\r\nINFO:  \r\n\tTime for training in iteration 1: 4.01545906067 sec\r\nDETAIL:  \r\n\tTraining set after iteration 1:\r\n\tmst_key=11: metric=0.949999988079, loss=0.535947144032\r\n\tmst_key=13: metric=0.658333361149, loss=0.576903045177\r\n\tmst_key=6: metric=0.725000023842, loss=0.413865655661\r\n\tmst_key=15: metric=0.566666662693, loss=0.821544110775\r\n\tmst_key=14: metric=0.608333349228, loss=1.00213348866\r\n\tValidation set after iteration 1:\r\n\tmst_key=11: metric=0.866666674614, loss=0.556911349297\r\n\tmst_key=13: metric=0.699999988079, loss=0.577660501003\r\n\tmst_key=6: metric=0.666666686535, loss=0.506598353386\r\n\tmst_key=15: metric=0.600000023842, loss=0.782476782799\r\n\tmst_key=14: metric=0.566666662693, loss=1.00861167908\r\nCONTEXT:  PL/Python function \"madlib_keras_automl\"\r\nINFO:  \r\n\tTime for training in iteration 2: 4.0810611248 sec\r\nDETAIL:  \r\n\tTraining set after iteration 2:\r\n\tmst_key=11: metric=0.958333313465, loss=0.461322844028\r\n\tmst_key=13: metric=0.658333361149, loss=0.488560408354\r\n\tmst_key=6: metric=0.824999988079, loss=0.323733448982\r\n\tmst_key=15: metric=0.875, loss=0.656310975552\r\n\tmst_key=14: metric=0.658333361149, loss=0.641188919544\r\n\tValidation set after iteration 2:\r\n\tmst_key=11: metric=0.866666674614, loss=0.486970752478\r\n\tmst_key=13: metric=0.699999988079, loss=0.468940109015\r\n\tmst_key=6: metric=0.733333349228, loss=0.393083393574\r\n\tmst_key=15: metric=0.800000011921, loss=0.679034292698\r\n\tmst_key=14: metric=0.699999988079, loss=0.636842608452\r\nCONTEXT:  PL/Python function \"madlib_keras_automl\"\r\nINFO:  \r\n\tTime for training in iteration 3: 3.9402680397 sec\r\nDETAIL:  \r\n\tTraining set after iteration 3:\r\n\tmst_key=11: metric=0.841666638851, loss=0.428030073643\r\n\tmst_key=13: metric=0.933333337307, loss=0.341508597136\r\n\tmst_key=6: metric=0.933333337307, loss=0.217096969485\r\n\tmst_key=15: metric=0.941666662693, loss=0.388799399137\r\n\tmst_key=14: metric=0.916666686535, loss=0.44380658865\r\n\tValidation set after iteration 3:\r\n\tmst_key=11: metric=0.733333349228, loss=0.495877951384\r\n\tmst_key=13: metric=0.966666638851, loss=0.35888004303\r\n\tmst_key=6: metric=0.933333337307, loss=0.196621760726\r\n\tmst_key=15: metric=0.866666674614, loss=0.401055067778\r\n\tmst_key=14: metric=0.933333337307, loss=0.44562998414\r\nCONTEXT:  PL/Python function \"madlib_keras_automl\"\r\nINFO:  \r\n\tTime for training in iteration 4: 4.27783608437 sec\r\nDETAIL:  \r\n\tTraining set after iteration 4:\r\n\tmst_key=11: metric=0.899999976158, loss=0.348980903625\r\n\tmst_key=13: metric=0.949999988079, loss=0.273842066526\r\n\tmst_key=6: metric=0.824999988079, loss=0.307050615549\r\n\tmst_key=15: metric=0.941666662693, loss=0.25471162796\r\n\tmst_key=14: metric=0.966666638851, loss=0.266296118498\r\n\tValidation set after iteration 4:\r\n\tmst_key=11: metric=0.833333313465, loss=0.420216292143\r\n\tmst_key=13: metric=0.866666674614, loss=0.317742973566\r\n\tmst_key=6: metric=0.899999976158, loss=0.230505168438\r\n\tmst_key=15: metric=0.899999976158, loss=0.281882911921\r\n\tmst_key=14: metric=0.966666638851, loss=0.275415152311\r\nCONTEXT:  PL/Python function \"madlib_keras_automl\"\r\nINFO:  \r\n\tTime for training in iteration 5: 4.06583809853 sec\r\nDETAIL:  \r\n\tTraining set after iteration 5:\r\n\tmst_key=11: metric=0.958333313465, loss=0.315752029419\r\n\tmst_key=13: metric=0.708333313465, loss=0.4172565341\r\n\tmst_key=6: metric=0.958333313465, loss=0.151342079043\r\n\tmst_key=15: metric=0.975000023842, loss=0.179173886776\r\n\tmst_key=14: metric=0.983333349228, loss=0.177039191127\r\n\tValidation set after iteration 5:\r\n\tmst_key=11: metric=0.866666674614, loss=0.342488378286\r\n\tmst_key=13: metric=0.633333325386, loss=0.558800399303\r\n\tmst_key=6: metric=0.966666638851, loss=0.153643578291\r\n\tmst_key=15: metric=1.0, loss=0.174838155508\r\n\tmst_key=14: metric=0.966666638851, loss=0.192256584764\r\nCONTEXT:  PL/Python function \"madlib_keras_automl\"\r\nINFO:  \r\n\tTime for training in iteration 6: 4.02019715309 sec\r\nDETAIL:  \r\n\tTraining set after iteration 6:\r\n\tmst_key=11: metric=0.883333325386, loss=0.296552926302\r\n\tmst_key=13: metric=0.899999976158, loss=0.248627394438\r\n\tmst_key=6: metric=0.858333349228, loss=0.285588264465\r\n\tmst_key=15: metric=0.949999988079, loss=0.167279005051\r\n\tmst_key=14: metric=0.899999976158, loss=0.227244228125\r\n\tValidation set after iteration 6:\r\n\tmst_key=11: metric=0.833333313465, loss=0.401087760925\r\n\tmst_key=13: metric=0.833333313465, loss=0.321891099215\r\n\tmst_key=6: metric=0.733333349228, loss=0.421591818333\r\n\tmst_key=15: metric=0.966666638851, loss=0.138948410749\r\n\tmst_key=14: metric=0.800000011921, loss=0.34265729785\r\nCONTEXT:  PL/Python function \"madlib_keras_automl\"\r\nINFO:  \r\n\tTime for training in iteration 7: 4.27092909813 sec\r\nDETAIL:  \r\n\tTraining set after iteration 7:\r\n\tmst_key=11: metric=0.891666650772, loss=0.248297154903\r\n\tmst_key=13: metric=0.891666650772, loss=0.24527259171\r\n\tmst_key=6: metric=0.949999988079, loss=0.12675113976\r\n\tmst_key=15: metric=0.916666686535, loss=0.215490117669\r\n\tmst_key=14: metric=0.958333313465, loss=0.127076357603\r\n\tValidation set after iteration 7:\r\n\tmst_key=11: metric=0.866666674614, loss=0.335224747658\r\n\tmst_key=13: metric=0.766666650772, loss=0.349867284298\r\n\tmst_key=6: metric=1.0, loss=0.120815463364\r\n\tmst_key=15: metric=0.933333337307, loss=0.161028474569\r\n\tmst_key=14: metric=0.899999976158, loss=0.196913182735\r\nCONTEXT:  PL/Python function \"madlib_keras_automl\"\r\nINFO:  \r\n\tTime for training in iteration 8: 4.16106319427 sec\r\nDETAIL:  \r\n\tTraining set after iteration 8:\r\n\tmst_key=11: metric=0.958333313465, loss=0.21432980895\r\n\tmst_key=13: metric=0.75, loss=0.440660595894\r\n\tmst_key=6: metric=0.791666686535, loss=0.416923582554\r\n\tmst_key=15: metric=0.933333337307, loss=0.161955311894\r\n\tmst_key=14: metric=0.908333361149, loss=0.182602509856\r\n\tValidation set after iteration 8:\r\n\tmst_key=11: metric=0.866666674614, loss=0.264829039574\r\n\tmst_key=13: metric=0.699999988079, loss=0.644149899483\r\n\tmst_key=6: metric=0.899999976158, loss=0.281583458185\r\n\tmst_key=15: metric=0.866666674614, loss=0.226034641266\r\n\tmst_key=14: metric=0.866666674614, loss=0.33136048913\r\nCONTEXT:  PL/Python function \"madlib_keras_automl\"\r\nINFO:  \r\n\tTime for training in iteration 9: 4.84911680222 sec\r\nDETAIL:  \r\n\tTraining set after iteration 9:\r\n\tmst_key=11: metric=0.975000023842, loss=0.221068292856\r\n\tmst_key=13: metric=0.983333349228, loss=0.138952031732\r\n\tmst_key=6: metric=0.816666662693, loss=0.403530687094\r\n\tmst_key=15: metric=0.941666662693, loss=0.168528050184\r\n\tmst_key=14: metric=0.958333313465, loss=0.14608065784\r\n\tValidation set after iteration 9:\r\n\tmst_key=11: metric=0.966666638851, loss=0.236671224236\r\n\tmst_key=13: metric=0.966666638851, loss=0.161113128066\r\n\tmst_key=6: metric=0.899999976158, loss=0.267582565546\r\n\tmst_key=15: metric=0.966666638851, loss=0.120766565204\r\n\tmst_key=14: metric=0.966666638851, loss=0.127617403865\r\nCONTEXT:  PL/Python function \"madlib_keras_automl\"\r\n madlib_keras_automl \r\n---------------------\r\n \r\n(1 row)\r\n\r\nTime: 93722.857 ms\r\n```\r\n![image](https://user-images.githubusercontent.com/10538173/92820545-ee707e00-f37e-11ea-927b-df37bdf50dce.png)\r\n\r\ne.g., for bracket 2\r\n![image](https://user-images.githubusercontent.com/10538173/92820822-3db6ae80-f37f-11ea-9b53-9dd7cd4d055b.png)\r\n\r\n\r\n\r\nOK","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/690776040/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/690782523","html_url":"https://github.com/apache/madlib/pull/513#issuecomment-690782523","issue_url":"https://api.github.com/repos/apache/madlib/issues/513","id":690782523,"node_id":"MDEyOklzc3VlQ29tbWVudDY5MDc4MjUyMw==","user":{"login":"fmcquillan99","id":10538173,"node_id":"MDQ6VXNlcjEwNTM4MTcz","avatar_url":"https://avatars.githubusercontent.com/u/10538173?v=4","gravatar_id":"","url":"https://api.github.com/users/fmcquillan99","html_url":"https://github.com/fmcquillan99","followers_url":"https://api.github.com/users/fmcquillan99/followers","following_url":"https://api.github.com/users/fmcquillan99/following{/other_user}","gists_url":"https://api.github.com/users/fmcquillan99/gists{/gist_id}","starred_url":"https://api.github.com/users/fmcquillan99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmcquillan99/subscriptions","organizations_url":"https://api.github.com/users/fmcquillan99/orgs","repos_url":"https://api.github.com/users/fmcquillan99/repos","events_url":"https://api.github.com/users/fmcquillan99/events{/privacy}","received_events_url":"https://api.github.com/users/fmcquillan99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-09-10T23:22:16Z","updated_at":"2020-09-10T23:22:40Z","author_association":"NONE","body":"iris dataset\r\n\r\n(2)\r\nschedule:\r\n```\r\n s | i | n_i | r_i \r\n---+---+-----+-----\r\n 3 | 0 |  27 |   1\r\n 3 | 1 |   9 |   3\r\n 3 | 2 |   3 |   9\r\n 3 | 3 |   1 |  27\r\n 2 | 0 |   9 |   3\r\n 2 | 1 |   3 |   9\r\n 2 | 2 |   1 |  27\r\n 1 | 0 |   6 |   9\r\n 1 | 1 |   2 |  27\r\n 0 | 0 |   4 |  27\r\n```\r\nproduces:\r\n![image](https://user-images.githubusercontent.com/10538173/92822881-81aab300-f381-11ea-92fb-6b0f132f95bc.png)\r\n\r\ne.g., for bracket 2\r\n![image](https://user-images.githubusercontent.com/10538173/92823106-c46c8b00-f381-11ea-967b-af9342f6690a.png)\r\n\r\nOK\r\n","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/690782523/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/690789241","html_url":"https://github.com/apache/madlib/pull/513#issuecomment-690789241","issue_url":"https://api.github.com/repos/apache/madlib/issues/513","id":690789241,"node_id":"MDEyOklzc3VlQ29tbWVudDY5MDc4OTI0MQ==","user":{"login":"fmcquillan99","id":10538173,"node_id":"MDQ6VXNlcjEwNTM4MTcz","avatar_url":"https://avatars.githubusercontent.com/u/10538173?v=4","gravatar_id":"","url":"https://api.github.com/users/fmcquillan99","html_url":"https://github.com/fmcquillan99","followers_url":"https://api.github.com/users/fmcquillan99/followers","following_url":"https://api.github.com/users/fmcquillan99/following{/other_user}","gists_url":"https://api.github.com/users/fmcquillan99/gists{/gist_id}","starred_url":"https://api.github.com/users/fmcquillan99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmcquillan99/subscriptions","organizations_url":"https://api.github.com/users/fmcquillan99/orgs","repos_url":"https://api.github.com/users/fmcquillan99/repos","events_url":"https://api.github.com/users/fmcquillan99/events{/privacy}","received_events_url":"https://api.github.com/users/fmcquillan99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-09-10T23:46:10Z","updated_at":"2020-09-10T23:46:10Z","author_association":"NONE","body":"cifar-10 dataset\r\n\r\n(3)\r\nschedule:\r\n```\r\n s | i | n_i | r_i \r\n---+---+-----+-----\r\n 2 | 0 |   9 |   1\r\n 2 | 1 |   3 |   3\r\n 2 | 2 |   1 |   9\r\n 1 | 0 |   3 |   3\r\n 1 | 1 |   1 |   9\r\n 0 | 0 |   3 |   9\r\n(6 rows)\r\n```\r\ntrain:\r\n```\r\nDROP TABLE IF EXISTS automl_cifar10_output, automl_cifar10_output_info, automl_cifar10_output_summary, automl_cifar_10_mst_table, automl_cifar_10_mst_table_summary;\r\n\r\nSELECT madlib.madlib_keras_automl('cifar10_train_packed', \r\n                           'automl_cifar10_output', \r\n                           'model_arch_library', \r\n                           'automl_cifar_10_mst_table',\r\n                           ARRAY[1], \r\n                           $${'loss': ['categorical_crossentropy'], \r\n                              'optimizer_params_list': [\r\n                                  {'optimizer': ['Adam'],'lr': [0.0001, 0.001, 'log']},\r\n                                  {'optimizer': ['RMSprop'],'lr': [0.0001, 0.001, 'log'],'decay: [1e-6]}],\r\n                             'metrics':['accuracy']}$$, \r\n                           $${'batch_size': [64, 128], 'epochs': [1]}$$,\r\n                           'hyperband', \r\n                           'R=9, eta=3, skip_last=0',                                                              \r\n                            42,                    -- random state\r\n                            NULL,                  -- object table\r\n                            FALSE,                 -- use GPUs\r\n                            'cifar10_test_packed', -- validation table\r\n                            1,                     -- metrics compute freq\r\n                            NULL,                  -- name\r\n                            NULL);                 -- descr\r\n```\r\nproduces:\r\n![image](https://user-images.githubusercontent.com/10538173/92825871-e7e50500-f384-11ea-8214-628c71355c83.png)\r\n\r\nfor s=2:\r\n![image](https://user-images.githubusercontent.com/10538173/92826038-18c53a00-f385-11ea-8e11-d13a6e6bccdd.png)\r\n\r\nOK","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/690789241/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/690789601","html_url":"https://github.com/apache/madlib/pull/513#issuecomment-690789601","issue_url":"https://api.github.com/repos/apache/madlib/issues/513","id":690789601,"node_id":"MDEyOklzc3VlQ29tbWVudDY5MDc4OTYwMQ==","user":{"login":"fmcquillan99","id":10538173,"node_id":"MDQ6VXNlcjEwNTM4MTcz","avatar_url":"https://avatars.githubusercontent.com/u/10538173?v=4","gravatar_id":"","url":"https://api.github.com/users/fmcquillan99","html_url":"https://github.com/fmcquillan99","followers_url":"https://api.github.com/users/fmcquillan99/followers","following_url":"https://api.github.com/users/fmcquillan99/following{/other_user}","gists_url":"https://api.github.com/users/fmcquillan99/gists{/gist_id}","starred_url":"https://api.github.com/users/fmcquillan99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmcquillan99/subscriptions","organizations_url":"https://api.github.com/users/fmcquillan99/orgs","repos_url":"https://api.github.com/users/fmcquillan99/repos","events_url":"https://api.github.com/users/fmcquillan99/events{/privacy}","received_events_url":"https://api.github.com/users/fmcquillan99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-09-10T23:47:22Z","updated_at":"2020-09-10T23:47:22Z","author_association":"NONE","body":"I tested a bunch of error conditions and corner cases and it seems fine to me.  Great job on this PR!\r\n\r\nLGTM","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/690789601/reactions","total_count":2,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":1,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/696454397","html_url":"https://github.com/apache/madlib/pull/517#issuecomment-696454397","issue_url":"https://api.github.com/repos/apache/madlib/issues/517","id":696454397,"node_id":"MDEyOklzc3VlQ29tbWVudDY5NjQ1NDM5Nw==","user":{"login":"reductionista","id":2644901,"node_id":"MDQ6VXNlcjI2NDQ5MDE=","avatar_url":"https://avatars.githubusercontent.com/u/2644901?v=4","gravatar_id":"","url":"https://api.github.com/users/reductionista","html_url":"https://github.com/reductionista","followers_url":"https://api.github.com/users/reductionista/followers","following_url":"https://api.github.com/users/reductionista/following{/other_user}","gists_url":"https://api.github.com/users/reductionista/gists{/gist_id}","starred_url":"https://api.github.com/users/reductionista/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/reductionista/subscriptions","organizations_url":"https://api.github.com/users/reductionista/orgs","repos_url":"https://api.github.com/users/reductionista/repos","events_url":"https://api.github.com/users/reductionista/events{/privacy}","received_events_url":"https://api.github.com/users/reductionista/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-09-22T00:42:12Z","updated_at":"2020-09-22T00:42:12Z","author_association":"CONTRIBUTOR","body":"LGTM","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/696454397/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/698536437","html_url":"https://github.com/apache/madlib/pull/518#issuecomment-698536437","issue_url":"https://api.github.com/repos/apache/madlib/issues/518","id":698536437,"node_id":"MDEyOklzc3VlQ29tbWVudDY5ODUzNjQzNw==","user":{"login":"fmcquillan99","id":10538173,"node_id":"MDQ6VXNlcjEwNTM4MTcz","avatar_url":"https://avatars.githubusercontent.com/u/10538173?v=4","gravatar_id":"","url":"https://api.github.com/users/fmcquillan99","html_url":"https://github.com/fmcquillan99","followers_url":"https://api.github.com/users/fmcquillan99/followers","following_url":"https://api.github.com/users/fmcquillan99/following{/other_user}","gists_url":"https://api.github.com/users/fmcquillan99/gists{/gist_id}","starred_url":"https://api.github.com/users/fmcquillan99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmcquillan99/subscriptions","organizations_url":"https://api.github.com/users/fmcquillan99/orgs","repos_url":"https://api.github.com/users/fmcquillan99/repos","events_url":"https://api.github.com/users/fmcquillan99/events{/privacy}","received_events_url":"https://api.github.com/users/fmcquillan99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-09-24T19:15:03Z","updated_at":"2020-09-29T18:53:30Z","author_association":"NONE","body":"(1) \r\nThese 2 methods seems to want `hyperopt` module installed even if I don't call it.  It should only error out if I select to use `hyperopt` as an autoML method:\r\n\r\n- `madlib_keras_automl`\r\n- `hyperband_schedule`\r\n\r\nE.g.,\r\n```\r\n%%sql\r\nDROP TABLE IF EXISTS hb_schedule;\r\nSELECT madlib.hyperband_schedule ('hb_schedule', \r\n                                   6,\r\n                                   3,\r\n                                   0);\r\nSELECT * FROM hb_schedule ORDER BY s DESC, i;\r\n```\r\nproduces\r\n```\r\nInternalError: (psycopg2.errors.InternalError_) ImportError: No module named hyperopt (plpython.c:5038)\r\nCONTEXT:  Traceback (most recent call last):\r\n  PL/Python function \"hyperband_schedule\", line 7, in <module>\r\n    from deep_learning import madlib_keras_automl\r\n  PL/Python function \"hyperband_schedule\", line 21, in <module>\r\nPL/Python function \"hyperband_schedule\"\r\n\r\n[SQL: SELECT madlib.hyperband_schedule ('hb_schedule', \r\n                                   6,\r\n                                   3,\r\n                                   0);]\r\n```\r\n\r\nSame happens with `madlib_keras_automl` when I select `hyperband` as the method I want.  So we need to figure out how hyperopt is installed with madlib.","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/698536437/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/698539283","html_url":"https://github.com/apache/madlib/pull/518#issuecomment-698539283","issue_url":"https://api.github.com/repos/apache/madlib/issues/518","id":698539283,"node_id":"MDEyOklzc3VlQ29tbWVudDY5ODUzOTI4Mw==","user":{"login":"fmcquillan99","id":10538173,"node_id":"MDQ6VXNlcjEwNTM4MTcz","avatar_url":"https://avatars.githubusercontent.com/u/10538173?v=4","gravatar_id":"","url":"https://api.github.com/users/fmcquillan99","html_url":"https://github.com/fmcquillan99","followers_url":"https://api.github.com/users/fmcquillan99/followers","following_url":"https://api.github.com/users/fmcquillan99/following{/other_user}","gists_url":"https://api.github.com/users/fmcquillan99/gists{/gist_id}","starred_url":"https://api.github.com/users/fmcquillan99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmcquillan99/subscriptions","organizations_url":"https://api.github.com/users/fmcquillan99/orgs","repos_url":"https://api.github.com/users/fmcquillan99/repos","events_url":"https://api.github.com/users/fmcquillan99/events{/privacy}","received_events_url":"https://api.github.com/users/fmcquillan99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-09-24T19:21:02Z","updated_at":"2020-09-24T19:21:02Z","author_association":"NONE","body":"(2) \r\nplease turn off the detailed `NOTICE` and `CONTEXT` messages as they are showing on the console by default.","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/698539283/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/698557841","html_url":"https://github.com/apache/madlib/pull/518#issuecomment-698557841","issue_url":"https://api.github.com/repos/apache/madlib/issues/518","id":698557841,"node_id":"MDEyOklzc3VlQ29tbWVudDY5ODU1Nzg0MQ==","user":{"login":"fmcquillan99","id":10538173,"node_id":"MDQ6VXNlcjEwNTM4MTcz","avatar_url":"https://avatars.githubusercontent.com/u/10538173?v=4","gravatar_id":"","url":"https://api.github.com/users/fmcquillan99","html_url":"https://github.com/fmcquillan99","followers_url":"https://api.github.com/users/fmcquillan99/followers","following_url":"https://api.github.com/users/fmcquillan99/following{/other_user}","gists_url":"https://api.github.com/users/fmcquillan99/gists{/gist_id}","starred_url":"https://api.github.com/users/fmcquillan99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmcquillan99/subscriptions","organizations_url":"https://api.github.com/users/fmcquillan99/orgs","repos_url":"https://api.github.com/users/fmcquillan99/repos","events_url":"https://api.github.com/users/fmcquillan99/events{/privacy}","received_events_url":"https://api.github.com/users/fmcquillan99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-09-24T19:58:54Z","updated_at":"2020-09-24T19:58:54Z","author_association":"NONE","body":"(3)\r\n```\r\nPL/Python function \"madlib_keras_automl\"\r\nERROR:  plpy.Error: DL: Please choose a valid distribution type for 'momentum_3': ['linear', 'log'] (plpython.c:5038)\r\n```\r\nShould not report `_3` or `_4` or whatever in messages since user does not know what these are.  Should just report:\r\n```\r\nPL/Python function \"madlib_keras_automl\"\r\nERROR:  plpy.Error: DL: Please choose a valid distribution type for 'momentum': ['linear', 'log'] (plpython.c:5038)\r\n```\r\netc.\r\n","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/698557841/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/698586366","html_url":"https://github.com/apache/madlib/pull/518#issuecomment-698586366","issue_url":"https://api.github.com/repos/apache/madlib/issues/518","id":698586366,"node_id":"MDEyOklzc3VlQ29tbWVudDY5ODU4NjM2Ng==","user":{"login":"fmcquillan99","id":10538173,"node_id":"MDQ6VXNlcjEwNTM4MTcz","avatar_url":"https://avatars.githubusercontent.com/u/10538173?v=4","gravatar_id":"","url":"https://api.github.com/users/fmcquillan99","html_url":"https://github.com/fmcquillan99","followers_url":"https://api.github.com/users/fmcquillan99/followers","following_url":"https://api.github.com/users/fmcquillan99/following{/other_user}","gists_url":"https://api.github.com/users/fmcquillan99/gists{/gist_id}","starred_url":"https://api.github.com/users/fmcquillan99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmcquillan99/subscriptions","organizations_url":"https://api.github.com/users/fmcquillan99/orgs","repos_url":"https://api.github.com/users/fmcquillan99/repos","events_url":"https://api.github.com/users/fmcquillan99/events{/privacy}","received_events_url":"https://api.github.com/users/fmcquillan99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-09-24T21:01:26Z","updated_at":"2020-09-24T21:20:13Z","author_association":"NONE","body":"(4)\r\n`hyperopt` is not learning with cifar10 in the tests I have done so far with `rand` \r\n```\r\nSELECT madlib.madlib_keras_automl('cifar10_train_packed', \r\n                                  'automl_cifar10_output', \r\n                                  'model_arch_library', \r\n                                  'automl_cifar10_mst_table',\r\n                                  ARRAY[1,2,3], \r\n                                  $${'loss': ['categorical_crossentropy'], \r\n                                     'optimizer_params_list': [ \r\n                                         {'optimizer': ['Adam'],'lr': [0.0001, 0.01, 'log']},\r\n                                         {'optimizer': ['RMSprop'],'lr': [0.0001, 0.01, 'log'], 'decay': [1.0e-7, 1.0e-5, 'log']},\r\n                                         {'optimizer': ['SGD'],'lr': [0.0001, 0.01, 'log'], 'momentum': [0.9, 0.99,'log']}],\r\n                                     'metrics':['accuracy']}$$, \r\n                                  $${'batch_size': [64,128], 'epochs': [1]}$$,\r\n                                  'hyperopt', \r\n                                  'num_models=3, num_iters=5, algorithm=rand',\r\n                                  NULL,                    -- random state\r\n                                  NULL,                  -- object table\r\n                                  FALSE,                 -- use GPUs\r\n                                  'cifar10_val_packed', -- validation table\r\n                                  1,                     -- metrics compute freq\r\n                                  NULL,                  -- name\r\n                                  NULL);                 -- descr\r\n```\r\nproduces no-learning result with labels:\r\n```\r\nINFO:  ***Evaluating 3 newly suggested model configurations***\r\nCONTEXT:  PL/Python function \"madlib_keras_automl\"\r\nINFO:  \r\n\tTime for training in iteration 1: 659.287541866 sec\r\nDETAIL:  \r\n\tTraining set after iteration 1:\r\n\tmst_key=3: metric=0.10000000149, loss=nan\r\n\tmst_key=1: metric=0.0988999977708, loss=14.5240154266\r\n\tmst_key=2: metric=0.10000000149, loss=nan\r\n\tValidation set after iteration 1:\r\n\tmst_key=3: metric=0.10000000149, loss=nan\r\n\tmst_key=1: metric=0.0989999994636, loss=14.5224027634\r\n\tmst_key=2: metric=0.10000000149, loss=nan\r\nCONTEXT:  PL/Python function \"madlib_keras_automl\"\r\nINFO:  \r\n\tTime for training in iteration 2: 663.107329845 sec\r\nDETAIL:  \r\n\tTraining set after iteration 2:\r\n\tmst_key=3: metric=0.10000000149, loss=nan\r\n\tmst_key=1: metric=0.0989999994636, loss=14.5224027634\r\n\tmst_key=2: metric=0.10000000149, loss=nan\r\n\tValidation set after iteration 2:\r\n\tmst_key=3: metric=0.10000000149, loss=nan\r\n\tmst_key=1: metric=0.0989999994636, loss=14.5224027634\r\n\tmst_key=2: metric=0.10000000149, loss=nan\r\nCONTEXT:  PL/Python function \"madlib_keras_automl\"\r\netc.\r\n```\r\nWhen I run `hyperband` with same models/hyperparams, it does learn:\r\n```\r\nSELECT madlib.madlib_keras_automl('cifar10_train_packed', \r\n                                  'automl_cifar10_output', \r\n                                  'model_arch_library', \r\n                                  'automl_cifar10_mst_table',\r\n                                  ARRAY[1,2,3], \r\n                                  $${'loss': ['categorical_crossentropy'], \r\n                                     'optimizer_params_list': [ \r\n                                         {'optimizer': ['Adam'],'lr': [0.0001, 0.01, 'log']},\r\n                                         {'optimizer': ['RMSprop'],'lr': [0.0001, 0.01, 'log'], 'decay': [1.0e-7, 1.0e-5, 'log']},\r\n                                         {'optimizer': ['SGD'],'lr': [0.0001, 0.01, 'log'], 'momentum': [0.9, 0.99,'log']}],\r\n                                     'metrics':['accuracy']}$$, \r\n                                  $${'batch_size': [64,128], 'epochs': [1]}$$,\r\n                                  'hyperband', \r\n                                  'R=6, eta=3, skip_last=0',\r\n                                  NULL,                    -- random state\r\n                                  NULL,                  -- object table\r\n                                  FALSE,                 -- use GPUs\r\n                                  'cifar10_val_packed', -- validation table\r\n                                  1,                     -- metrics compute freq\r\n                                  NULL,                  -- name\r\n                                  NULL);                 -- descr\r\n```\r\nproduces\r\n```\r\nPL/Python function \"madlib_keras_automl\"\r\nINFO:  \r\n\tTime for training in iteration 1: 655.647205114 sec\r\nDETAIL:  \r\n\tTraining set after iteration 1:\r\n\tmst_key=3: metric=0.34889999032, loss=1.83796536922\r\n\tmst_key=1: metric=0.468120008707, loss=1.481554389\r\n\tmst_key=2: metric=0.475380003452, loss=1.63904440403\r\n\tValidation set after iteration 1:\r\n\tmst_key=3: metric=0.355800002813, loss=1.83082151413\r\n\tmst_key=1: metric=0.470499992371, loss=1.47972774506\r\n\tmst_key=2: metric=0.470200002193, loss=1.66988003254\r\nCONTEXT:  PL/Python function \"madlib_keras_automl\"\r\n\r\netc.\r\n```\r\nAlso `hyperopt` with `tpe` is not learning cifar10\r\n```\r\nSELECT madlib.madlib_keras_automl('cifar10_train_packed', \r\n                                  'automl_cifar10_output', \r\n                                  'model_arch_library', \r\n                                  'automl_cifar10_mst_table',\r\n                                  ARRAY[1,2,3], \r\n                                  $${'loss': ['categorical_crossentropy'], \r\n                                     'optimizer_params_list': [ \r\n                                         {'optimizer': ['Adam'],'lr': [0.0001, 0.01, 'log']},\r\n                                         {'optimizer': ['RMSprop'],'lr': [0.0001, 0.01, 'log'], 'decay': [1.0e-7, 1.0e-5, 'log']},\r\n                                         {'optimizer': ['SGD'],'lr': [0.0001, 0.01, 'log'], 'momentum': [0.9, 0.99,'log']}],\r\n                                     'metrics':['accuracy']}$$, \r\n                                  $${'batch_size': [64,128], 'epochs': [1]}$$,\r\n                                  'hyperopt', \r\n                                  'num_models=3, num_iters=5, algorithm=tpe',\r\n                                  NULL,                    -- random state\r\n                                  NULL,                  -- object table\r\n                                  FALSE,                 -- use GPUs\r\n                                  'cifar10_val_packed', -- validation table\r\n                                  1,                     -- metrics compute freq\r\n                                  NULL,                  -- name\r\n                                  NULL);                 -- descr\r\n```\r\nproduces\r\n```\r\nCONTEXT:  PL/Python function \"madlib_keras_automl\"\r\nINFO:  \r\n\tTime for training in iteration 1: 648.608314991 sec\r\nDETAIL:  \r\n\tTraining set after iteration 1:\r\n\tmst_key=3: metric=0.10000000149, loss=nan\r\n\tmst_key=1: metric=0.0999400019646, loss=14.5072526932\r\n\tmst_key=2: metric=0.10000000149, loss=14.5062847137\r\n\tValidation set after iteration 1:\r\n\tmst_key=3: metric=0.10000000149, loss=nan\r\n\tmst_key=1: metric=0.10000000149, loss=14.5062856674\r\n\tmst_key=2: metric=0.10000000149, loss=14.5062847137\r\nCONTEXT:  PL/Python function \"madlib_keras_automl\"\r\n```","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/698586366/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/698612856","html_url":"https://github.com/apache/madlib/pull/518#issuecomment-698612856","issue_url":"https://api.github.com/repos/apache/madlib/issues/518","id":698612856,"node_id":"MDEyOklzc3VlQ29tbWVudDY5ODYxMjg1Ng==","user":{"login":"fmcquillan99","id":10538173,"node_id":"MDQ6VXNlcjEwNTM4MTcz","avatar_url":"https://avatars.githubusercontent.com/u/10538173?v=4","gravatar_id":"","url":"https://api.github.com/users/fmcquillan99","html_url":"https://github.com/fmcquillan99","followers_url":"https://api.github.com/users/fmcquillan99/followers","following_url":"https://api.github.com/users/fmcquillan99/following{/other_user}","gists_url":"https://api.github.com/users/fmcquillan99/gists{/gist_id}","starred_url":"https://api.github.com/users/fmcquillan99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmcquillan99/subscriptions","organizations_url":"https://api.github.com/users/fmcquillan99/orgs","repos_url":"https://api.github.com/users/fmcquillan99/repos","events_url":"https://api.github.com/users/fmcquillan99/events{/privacy}","received_events_url":"https://api.github.com/users/fmcquillan99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-09-24T22:04:36Z","updated_at":"2020-09-24T22:07:47Z","author_association":"NONE","body":"output tables \r\n```\r\nmadlib=# select * from automl_cifar10_output_summary;\r\n-[ RECORD 1 ]-------------+-----------------------------------------\r\nsource_table              | cifar10_train_packed\r\nvalidation_table          | cifar10_val_packed\r\nmodel                     | automl_cifar10_output\r\nmodel_info                | automl_cifar10_output_info\r\ndependent_varname         | y\r\nindependent_varname       | x\r\nmodel_arch_table          | model_arch_library\r\nmodel_selection_table     | automl_cifar10_mst_table\r\nautoml_method             | hyperopt\r\nautoml_params             | num_models=4, num_iters=2, algorithm=tpe\r\nrandom_state              | None\r\nobject_table              | None\r\nuse_gpus                  | f\r\nmetrics_compute_frequency | 1\r\nname                      | None\r\ndescription               | None\r\nstart_training_time       | 2020-09-24 21:27:43\r\nend_training_time         | 2020-09-24 21:57:21\r\nmadlib_version            | 1.18.0-dev\r\nnum_classes               | 10\r\nclass_values              | {0,1,2,3,4,5,6,7,8,9}\r\ndependent_vartype         | text\r\nnormalizing_const         | 256\r\n```\r\nand\r\n```\r\nmadlib=# select * from automl_cifar10_output_info;\r\n-[ RECORD 1 ]------------+-----------------------------------------------------------------------------------------------------------------------\r\nmst_key                  | 1\r\nmodel_id                 | 1\r\ncompile_params           | optimizer='SGD(lr=1.0060862144391352,momentum=2.477852193264555)',metrics=['accuracy'],loss='categorical_crossentropy'\r\nfit_params               | epochs=1,batch_size=128\r\nmodel_type               | madlib_keras\r\nmodel_size               | 4886.20019531\r\nmetrics_elapsed_time     | {854.796041965485,1740.91218686104}\r\nmetrics_type             | {accuracy}\r\nloss_type                | categorical_crossentropy\r\ntraining_metrics_final   | 0.100000001490116\r\ntraining_loss_final      | NaN\r\ntraining_metrics         | {0.100000001490116,0.100000001490116}\r\ntraining_loss            | {NaN,NaN}\r\nvalidation_metrics_final | 0.100000001490116\r\nvalidation_loss_final    | NaN\r\nvalidation_metrics       | {0.100000001490116,0.100000001490116}\r\nvalidation_loss          | {NaN,NaN}\r\n-[ RECORD 2 ]------------+-----------------------------------------------------------------------------------------------------------------------\r\nmst_key                  | 3\r\nmodel_id                 | 2\r\ncompile_params           | optimizer='SGD(lr=1.0019632479006402,momentum=2.468115689403145)',metrics=['accuracy'],loss='categorical_crossentropy'\r\nfit_params               | epochs=1,batch_size=128\r\nmodel_type               | madlib_keras\r\nmodel_size               | 2159.70019531\r\nmetrics_elapsed_time     | {867.580676794052,1753.89660692215}\r\nmetrics_type             | {accuracy}\r\nloss_type                | categorical_crossentropy\r\ntraining_metrics_final   | 0.100000001490116\r\ntraining_loss_final      | NaN\r\ntraining_metrics         | {0.100000001490116,0.100000001490116}\r\ntraining_loss            | {NaN,NaN}\r\nvalidation_metrics_final | 0.100000001490116\r\nvalidation_loss_final    | NaN\r\nvalidation_metrics       | {0.100000001490116,0.100000001490116}\r\nvalidation_loss          | {NaN,NaN}\r\n-[ RECORD 3 ]------------+-----------------------------------------------------------------------------------------------------------------------\r\nmst_key                  | 4\r\nmodel_id                 | 2\r\ncompile_params           | optimizer='Adam(lr=1.009549897036113)',metrics=['accuracy'],loss='categorical_crossentropy'\r\nfit_params               | epochs=1,batch_size=64\r\nmodel_type               | madlib_keras\r\nmodel_size               | 2159.70019531\r\nmetrics_elapsed_time     | {880.187488794327,1766.73845982552}\r\nmetrics_type             | {accuracy}\r\nloss_type                | categorical_crossentropy\r\ntraining_metrics_final   | 0.0999400019645691\r\ntraining_loss_final      | 14.5072526931763\r\ntraining_metrics         | {0.0996000021696091,0.0999400019645691}\r\ntraining_loss            | {14.5127325057983,14.5072526931763}\r\nvalidation_metrics_final | 0.100100003182888\r\nvalidation_loss_final    | 14.5046730041504\r\nvalidation_metrics       | {0.101099997758865,0.100100003182888}\r\nvalidation_loss          | {14.4885559082031,14.5046730041504}\r\n-[ RECORD 4 ]------------+-----------------------------------------------------------------------------------------------------------------------\r\nmst_key                  | 2\r\nmodel_id                 | 1\r\ncompile_params           | optimizer='SGD(lr=1.0039632314582876,momentum=2.466481495072043)',metrics=['accuracy'],loss='categorical_crossentropy'\r\nfit_params               | epochs=1,batch_size=64\r\nmodel_type               | madlib_keras\r\nmodel_size               | 4886.20019531\r\nmetrics_elapsed_time     | {885.122605800629,1772.07805681229}\r\nmetrics_type             | {accuracy}\r\nloss_type                | categorical_crossentropy\r\ntraining_metrics_final   | 0.100000001490116\r\ntraining_loss_final      | NaN\r\ntraining_metrics         | {0.100000001490116,0.100000001490116}\r\ntraining_loss            | {NaN,NaN}\r\nvalidation_metrics_final | 0.100000001490116\r\nvalidation_loss_final    | NaN\r\nvalidation_metrics       | {0.100000001490116,0.100000001490116}\r\nvalidation_loss          | {NaN,NaN}\r\n```\r\n```\r\nmadlib=# select * from automl_cifar10_mst_table;\r\n-[ RECORD 1 ]--+--------------------------------------------------------------------------------------------\r\nmst_key        | 4\r\nmodel_id       | 2\r\ncompile_params | optimizer='Adam(lr=1.009549897036113)',metrics=['accuracy'],loss='categorical_crossentropy'\r\nfit_params     | epochs=1,batch_size=64\r\n```","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/698612856/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/699045132","html_url":"https://github.com/apache/madlib/pull/516#issuecomment-699045132","issue_url":"https://api.github.com/repos/apache/madlib/issues/516","id":699045132,"node_id":"MDEyOklzc3VlQ29tbWVudDY5OTA0NTEzMg==","user":{"login":"reductionista","id":2644901,"node_id":"MDQ6VXNlcjI2NDQ5MDE=","avatar_url":"https://avatars.githubusercontent.com/u/2644901?v=4","gravatar_id":"","url":"https://api.github.com/users/reductionista","html_url":"https://github.com/reductionista","followers_url":"https://api.github.com/users/reductionista/followers","following_url":"https://api.github.com/users/reductionista/following{/other_user}","gists_url":"https://api.github.com/users/reductionista/gists{/gist_id}","starred_url":"https://api.github.com/users/reductionista/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/reductionista/subscriptions","organizations_url":"https://api.github.com/users/reductionista/orgs","repos_url":"https://api.github.com/users/reductionista/repos","events_url":"https://api.github.com/users/reductionista/events{/privacy}","received_events_url":"https://api.github.com/users/reductionista/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-09-25T17:06:40Z","updated_at":"2020-09-25T17:06:40Z","author_association":"CONTRIBUTOR","body":"This looks ready to merge to me.  Turning over to @fmcquillan99 for a final usability review.","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/699045132/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/699088843","html_url":"https://github.com/apache/madlib/pull/518#issuecomment-699088843","issue_url":"https://api.github.com/repos/apache/madlib/issues/518","id":699088843,"node_id":"MDEyOklzc3VlQ29tbWVudDY5OTA4ODg0Mw==","user":{"login":"fmcquillan99","id":10538173,"node_id":"MDQ6VXNlcjEwNTM4MTcz","avatar_url":"https://avatars.githubusercontent.com/u/10538173?v=4","gravatar_id":"","url":"https://api.github.com/users/fmcquillan99","html_url":"https://github.com/fmcquillan99","followers_url":"https://api.github.com/users/fmcquillan99/followers","following_url":"https://api.github.com/users/fmcquillan99/following{/other_user}","gists_url":"https://api.github.com/users/fmcquillan99/gists{/gist_id}","starred_url":"https://api.github.com/users/fmcquillan99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmcquillan99/subscriptions","organizations_url":"https://api.github.com/users/fmcquillan99/orgs","repos_url":"https://api.github.com/users/fmcquillan99/repos","events_url":"https://api.github.com/users/fmcquillan99/events{/privacy}","received_events_url":"https://api.github.com/users/fmcquillan99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-09-25T18:36:58Z","updated_at":"2020-09-25T18:36:58Z","author_association":"NONE","body":"(5)\r\nIn this test the 2nd batch is worse than the 1st batch:\r\n```\r\nmadlib=# SELECT madlib.madlib_keras_automl('cifar10_train_packed', \r\nmadlib(#                                   'automl_cifar10_output', \r\nmadlib(#                                   'model_arch_library', \r\nmadlib(#                                   'automl_cifar10_mst_table',\r\nmadlib(#                                   ARRAY[1,2], \r\nmadlib(#                                   $${'loss': ['categorical_crossentropy'], \r\nmadlib$#                                      'optimizer_params_list': [ \r\nmadlib$#                                          {'optimizer': ['Adam'],'lr': [0.0005, 0.01, 'log']},\r\nmadlib$#                                          {'optimizer': ['SGD'],'lr': [0.001, 0.01, 'log'], 'momentum': [0.90, 0.91,'log']}],\r\nmadlib$#                                      'metrics':['accuracy']}$$, \r\nmadlib(#                                   $${'batch_size': [64,128], 'epochs': [1]}$$,\r\nmadlib(#                                   'hyperopt', \r\nmadlib(#                                   'num_models=10, num_iters=2, algorithm=tpe',\r\nmadlib(#                                   NULL,                    -- random state\r\nmadlib(#                                   NULL,                  -- object table\r\nmadlib(#                                   FALSE,                 -- use GPUs\r\nmadlib(#                                   'cifar10_val_packed', -- validation table\r\nmadlib(#                                   1,                     -- metrics compute freq\r\nmadlib(#                                   NULL,                  -- name\r\nmadlib(#                                   NULL);                 -- descr\r\n\r\n\r\nINFO:  \r\n\tTime for training in iteration 1: 1070.08548617 sec\r\nDETAIL:  \r\n\tTraining set after iteration 1:\r\n\tmst_key=1: metric=0.526019990444, loss=1.5796225071\r\n\tmst_key=5: metric=0.562780022621, loss=1.37457168102\r\n\tmst_key=4: metric=0.65314000845, loss=0.969262957573\r\n\tmst_key=2: metric=0.10000000149, loss=2.30277729034\r\n\tmst_key=3: metric=0.464760005474, loss=1.50251471996\r\n\tValidation set after iteration 1:\r\n\tmst_key=1: metric=0.523299992085, loss=1.60135388374\r\n\tmst_key=5: metric=0.559000015259, loss=1.40086007118\r\n\tmst_key=4: metric=0.640600025654, loss=1.00141870975\r\n\tmst_key=2: metric=0.10000000149, loss=2.30277705193\r\n\tmst_key=3: metric=0.463400006294, loss=1.50355136395\r\nCONTEXT:  PL/Python function \"madlib_keras_automl\"\r\nINFO:  \r\n\tTime for training in iteration 2: 1064.05229688 sec\r\nDETAIL:  \r\n\tTraining set after iteration 2:\r\n\tmst_key=1: metric=0.703299999237, loss=0.840497553349\r\n\tmst_key=5: metric=0.664420008659, loss=0.98249232769\r\n\tmst_key=4: metric=0.754859983921, loss=0.701396882534\r\n\tmst_key=2: metric=0.10000000149, loss=2.30290770531\r\n\tmst_key=3: metric=0.535520017147, loss=1.26898431778\r\n\tValidation set after iteration 2:\r\n\tmst_key=1: metric=0.68900001049, loss=0.903733193874\r\n\tmst_key=5: metric=0.653800010681, loss=1.02747094631\r\n\tmst_key=4: metric=0.735899984837, loss=0.765290260315\r\n\tmst_key=2: metric=0.10000000149, loss=2.30290770531\r\n\tmst_key=3: metric=0.530799984932, loss=1.28327465057\r\nCONTEXT:  PL/Python function \"madlib_keras_automl\"\r\n\r\nINFO:  \r\nBest training loss so far:\r\nDETAIL:  \r\nmst_key=4: metric=0.754859983921, loss=0.701396882534\r\nBest validation loss so far:\r\nmst_key=4: metric=0.735899984837, loss=0.765290260315\r\n\r\n\r\n\r\nINFO:  ***Evaluating 5 newly suggested model configurations***\r\nCONTEXT:  PL/Python function \"madlib_keras_automl\"\r\nINFO:  \r\n\tTime for training in iteration 1: 1058.9834702 sec\r\nDETAIL:  \r\n\tTraining set after iteration 1:\r\n\tmst_key=6: metric=0.553560018539, loss=1.41088056564\r\n\tmst_key=10: metric=0.353260010481, loss=1.84440767765\r\n\tmst_key=9: metric=0.519379973412, loss=1.35283255577\r\n\tmst_key=7: metric=0.517820000648, loss=1.31637942791\r\n\tmst_key=8: metric=0.51289999485, loss=1.32810485363\r\n\tValidation set after iteration 1:\r\n\tmst_key=6: metric=0.547699987888, loss=1.44565415382\r\n\tmst_key=10: metric=0.358599990606, loss=1.83988237381\r\n\tmst_key=9: metric=0.518999993801, loss=1.36131703854\r\n\tmst_key=7: metric=0.515799999237, loss=1.32058382034\r\n\tmst_key=8: metric=0.507099986076, loss=1.33919155598\r\nCONTEXT:  PL/Python function \"madlib_keras_automl\"\r\nINFO:  \r\n\tTime for training in iteration 2: 1072.08968186 sec\r\nDETAIL:  \r\n\tTraining set after iteration 2:\r\n\tmst_key=6: metric=0.435039997101, loss=1.98741734028\r\n\tmst_key=10: metric=0.437579989433, loss=1.54891061783\r\n\tmst_key=9: metric=0.606719970703, loss=1.1007784605\r\n\tmst_key=7: metric=0.550220012665, loss=1.23340415955\r\n\tmst_key=8: metric=0.590960025787, loss=1.13847112656\r\n\tValidation set after iteration 2:\r\n\tmst_key=6: metric=0.424100011587, loss=2.0407743454\r\n\tmst_key=10: metric=0.438899993896, loss=1.54700648785\r\n\tmst_key=9: metric=0.595899999142, loss=1.13602638245\r\n\tmst_key=7: metric=0.544099986553, loss=1.24483549595\r\n\tmst_key=8: metric=0.583800017834, loss=1.15895962715\r\nCONTEXT:  PL/Python function \"madlib_keras_automl\"\r\n\r\nINFO:  \r\nBest training loss so far:\r\nDETAIL:  \r\nmst_key=4: metric=0.754859983921, loss=0.701396882534\r\nBest validation loss so far:\r\nmst_key=4: metric=0.735899984837, loss=0.765290260315\r\n```","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/699088843/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/699189947","html_url":"https://github.com/apache/madlib/pull/518#issuecomment-699189947","issue_url":"https://api.github.com/repos/apache/madlib/issues/518","id":699189947,"node_id":"MDEyOklzc3VlQ29tbWVudDY5OTE4OTk0Nw==","user":{"login":"fmcquillan99","id":10538173,"node_id":"MDQ6VXNlcjEwNTM4MTcz","avatar_url":"https://avatars.githubusercontent.com/u/10538173?v=4","gravatar_id":"","url":"https://api.github.com/users/fmcquillan99","html_url":"https://github.com/fmcquillan99","followers_url":"https://api.github.com/users/fmcquillan99/followers","following_url":"https://api.github.com/users/fmcquillan99/following{/other_user}","gists_url":"https://api.github.com/users/fmcquillan99/gists{/gist_id}","starred_url":"https://api.github.com/users/fmcquillan99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmcquillan99/subscriptions","organizations_url":"https://api.github.com/users/fmcquillan99/orgs","repos_url":"https://api.github.com/users/fmcquillan99/repos","events_url":"https://api.github.com/users/fmcquillan99/events{/privacy}","received_events_url":"https://api.github.com/users/fmcquillan99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-09-25T22:32:16Z","updated_at":"2020-10-05T17:26:54Z","author_association":"NONE","body":"(6)\r\nfmin definition\r\nhttps://github.com/hyperopt/hyperopt/wiki/FMin\r\nfmin(loss, space, algo, max_evals)\r\n\r\nLooks like this PR is setting max_evals =  num_models/num_segments in `get_configs_list()`.  For one thing I'm not sure that \r\n```\r\nself.num_workers = get_seg_number() * get_segments_per_host()\r\n```\r\ngives total number of workers?  On a 1 host, 2 segments-per-host database this returned 4 instead of the expected 2.  Also this needs to be consistent with the distribution rules set in the mini-batch preprocessor.\r\n\r\n(7)\r\nThe function `get_configs_list()` may not be distributing the workload correctly to the segments.  \r\nFor \r\n```\r\n    num_models = 3\r\n    num_workers = 3\r\n```\r\nit returns `[(1, 3)]` which seems OK.  But for \r\n```\r\n    num_models = 5\r\n    num_workers = 3\r\n```\r\nit returns `[(1, 5)]` which does not seem OK.  It will not do any hyperopt updates if all 5 configs are grouped together.  I would have expected `[(1, 3), (4, 5)]`.   For \r\n```\r\n    num_models = 20\r\n    num_workers = 3\r\n```\r\nit returns `[(1, 4), (5, 8), (9, 11), (12, 14), (15, 17), (18, 20)]` which means it is running 4 configs on 3 segments multiple times which does not seem efficient.  I would have expected something like `[(1, 3), (4, 6), (7, 9), (10, 12), (13, 15), (16, 18),(19, 20)]` which runs 3 configs at a time on the 3 segments.\r\n\r\n(8)\r\nIn `find_hyperopt_config()` confirm that the loss for *each* model that passed to hyperopt after training, and not just the best one from the group.\r\n\r\n(9)\r\ndefaults\r\nSeems like hyperband defaults are being used for hyperopt in the case that use does not specify hyperband is not specified.  That will probably throw an error.  Should there be defaults for hyperband and hyperopt, or should they be mandatory?","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/699189947/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/699244566","html_url":"https://github.com/apache/madlib/pull/516#issuecomment-699244566","issue_url":"https://api.github.com/repos/apache/madlib/issues/516","id":699244566,"node_id":"MDEyOklzc3VlQ29tbWVudDY5OTI0NDU2Ng==","user":{"login":"fmcquillan99","id":10538173,"node_id":"MDQ6VXNlcjEwNTM4MTcz","avatar_url":"https://avatars.githubusercontent.com/u/10538173?v=4","gravatar_id":"","url":"https://api.github.com/users/fmcquillan99","html_url":"https://github.com/fmcquillan99","followers_url":"https://api.github.com/users/fmcquillan99/followers","following_url":"https://api.github.com/users/fmcquillan99/following{/other_user}","gists_url":"https://api.github.com/users/fmcquillan99/gists{/gist_id}","starred_url":"https://api.github.com/users/fmcquillan99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmcquillan99/subscriptions","organizations_url":"https://api.github.com/users/fmcquillan99/orgs","repos_url":"https://api.github.com/users/fmcquillan99/repos","events_url":"https://api.github.com/users/fmcquillan99/events{/privacy}","received_events_url":"https://api.github.com/users/fmcquillan99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-09-26T00:36:39Z","updated_at":"2020-09-26T00:36:39Z","author_association":"NONE","body":"LGTM\r\n\r\nI added a a commit for user docs.  Feel free to merge @reductionista at your convenience.","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/699244566/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/700935101","html_url":"https://github.com/apache/madlib/pull/518#issuecomment-700935101","issue_url":"https://api.github.com/repos/apache/madlib/issues/518","id":700935101,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMDkzNTEwMQ==","user":{"login":"fmcquillan99","id":10538173,"node_id":"MDQ6VXNlcjEwNTM4MTcz","avatar_url":"https://avatars.githubusercontent.com/u/10538173?v=4","gravatar_id":"","url":"https://api.github.com/users/fmcquillan99","html_url":"https://github.com/fmcquillan99","followers_url":"https://api.github.com/users/fmcquillan99/followers","following_url":"https://api.github.com/users/fmcquillan99/following{/other_user}","gists_url":"https://api.github.com/users/fmcquillan99/gists{/gist_id}","starred_url":"https://api.github.com/users/fmcquillan99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmcquillan99/subscriptions","organizations_url":"https://api.github.com/users/fmcquillan99/orgs","repos_url":"https://api.github.com/users/fmcquillan99/repos","events_url":"https://api.github.com/users/fmcquillan99/events{/privacy}","received_events_url":"https://api.github.com/users/fmcquillan99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-09-29T19:32:11Z","updated_at":"2020-09-29T19:32:11Z","author_association":"NONE","body":"(10) param naming suggestions\r\n\r\nchange `num_models` to `num_configs` since this is what we use in `generate_model_configs()`  - this is effectively the number of trials.  Hyperopt calls this `max_evals`\r\n\r\nchange `num_iters` to `num_iterations` which is what we use elsewhere","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/700935101/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/700952240","html_url":"https://github.com/apache/madlib/pull/518#issuecomment-700952240","issue_url":"https://api.github.com/repos/apache/madlib/issues/518","id":700952240,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMDk1MjI0MA==","user":{"login":"Advitya17","id":37190647,"node_id":"MDQ6VXNlcjM3MTkwNjQ3","avatar_url":"https://avatars.githubusercontent.com/u/37190647?v=4","gravatar_id":"","url":"https://api.github.com/users/Advitya17","html_url":"https://github.com/Advitya17","followers_url":"https://api.github.com/users/Advitya17/followers","following_url":"https://api.github.com/users/Advitya17/following{/other_user}","gists_url":"https://api.github.com/users/Advitya17/gists{/gist_id}","starred_url":"https://api.github.com/users/Advitya17/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Advitya17/subscriptions","organizations_url":"https://api.github.com/users/Advitya17/orgs","repos_url":"https://api.github.com/users/Advitya17/repos","events_url":"https://api.github.com/users/Advitya17/events{/privacy}","received_events_url":"https://api.github.com/users/Advitya17/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-09-29T19:57:42Z","updated_at":"2020-09-29T20:01:33Z","author_association":"CONTRIBUTOR","body":"> (6)\r\n> fmin definition\r\n> https://github.com/hyperopt/hyperopt/wiki/FMin\r\n> fmin(loss, space, algo, max_evals)\r\n> \r\n> Looks like this PR is setting max_evals = num_models/num_segments in `get_configs_list()`. For one thing I'm not sure that\r\n> \r\n> ```\r\n> self.num_workers = get_seg_number() * get_segments_per_host()\r\n> ```\r\n> \r\n> gives total number of workers? On a 1 host, 2 segments-per-host database this returned 4 instead of the expected 2. Also this needs to be consistent with the distribution rules set in the mini-batch preprocessor.\r\n> \r\n> (7)\r\n> The function `get_configs_list()` may not be distributing the workload correctly to the segments.\r\n> For\r\n> \r\n> ```\r\n>     num_models = 3\r\n>     num_workers = 3\r\n> ```\r\n> \r\n> it returns `[(1, 3)]` which seems OK. But for\r\n> \r\n> ```\r\n>     num_models = 5\r\n>     num_workers = 3\r\n> ```\r\n> \r\n> it returns `[(1, 5)]` which does not seem OK. It will not do any hyperopt updates if all 5 configs are grouped together. I would have expected `[(1, 3), (4, 5)]`. For\r\n> \r\n> ```\r\n>     num_models = 20\r\n>     num_workers = 3\r\n> ```\r\n> \r\n> it returns `[(1, 4), (5, 8), (9, 11), (12, 14), (15, 17), (18, 20)]` which means it is running 4 configs on 3 segments multiple times which does not seem efficient. I would have expected something like `[(1, 3), (4, 6), (7, 9), (10, 12), (13, 15), (16, 18),(19, 20)]` which runs 3 configs at a time on the 3 segments.\r\n> \r\n> (8)\r\n> In `find_hyperopt_config()` confirm that the loss for _each_ model that passed to hyperopt after training, and not just the best one from the group.\r\n> \r\n> (9)\r\n> defaults\r\n> Seems like hyperband defaults are being used for hyperopt in the case that use does not specify hyperband is not specified. That will probably throw an error\r\n\r\n@fmcquillan99 \r\n\r\n(7) \r\n\r\n(a) As per my discussions with @reductionista , the current implementation seems to run more than 1 rounds when `number of models >= 2 * number of segments/workers in the cluster`. Sure, though the latter `[(1, 3), (4, 5)]` may have an idle worker, it may be a better approach for Hyperopt.\r\n\r\n(b) In reference to the 2nd example, I believe this was as per our discussions to minimize number of model training function calls (and to make the schedule look relatively more 'balanced'). Observe that the former schedule runs 4 configs on 3 workers for 2 rounds/runs and continues with the 3 configs on 3 workers for all other rounds (as 3 doesn't perfectly divide 20). The latter runs 2 configs on 3 workers at the end which also thus has an idle worker (apart from 1 more model training function call compared to the former approach).\r\n\r\n(8) I believe all the losses are already passed on to hyperopt as part of my implementation, in the `Hyperopt TPE Update` for loop (starting line 753 of the AutoML python file).\r\n\r\n(9) Yes I did observe that. I tried to change the global defaults in the SQL file as per chosen automl method, but ran into errors in the process. As per my current implementation, the hyperband params are defaults and the user may need to explicitly specify hyperopt params when using hyperopt.\r\n\r\n(10) The name changes sound good to me.\r\n\r\nLet me know if there're more areas I could address.","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/700952240/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/704635441","html_url":"https://github.com/apache/madlib/pull/519#issuecomment-704635441","issue_url":"https://api.github.com/repos/apache/madlib/issues/519","id":704635441,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNDYzNTQ0MQ==","user":{"login":"fmcquillan99","id":10538173,"node_id":"MDQ6VXNlcjEwNTM4MTcz","avatar_url":"https://avatars.githubusercontent.com/u/10538173?v=4","gravatar_id":"","url":"https://api.github.com/users/fmcquillan99","html_url":"https://github.com/fmcquillan99","followers_url":"https://api.github.com/users/fmcquillan99/followers","following_url":"https://api.github.com/users/fmcquillan99/following{/other_user}","gists_url":"https://api.github.com/users/fmcquillan99/gists{/gist_id}","starred_url":"https://api.github.com/users/fmcquillan99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmcquillan99/subscriptions","organizations_url":"https://api.github.com/users/fmcquillan99/orgs","repos_url":"https://api.github.com/users/fmcquillan99/repos","events_url":"https://api.github.com/users/fmcquillan99/events{/privacy}","received_events_url":"https://api.github.com/users/fmcquillan99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-07T01:15:45Z","updated_at":"2020-10-07T01:15:45Z","author_association":"NONE","body":"is this ready for final acceptance @khannaekta ?\r\n\r\nthx","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/704635441/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/704636244","html_url":"https://github.com/apache/madlib/pull/519#issuecomment-704636244","issue_url":"https://api.github.com/repos/apache/madlib/issues/519","id":704636244,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNDYzNjI0NA==","user":{"login":"khannaekta","id":15749573,"node_id":"MDQ6VXNlcjE1NzQ5NTcz","avatar_url":"https://avatars.githubusercontent.com/u/15749573?v=4","gravatar_id":"","url":"https://api.github.com/users/khannaekta","html_url":"https://github.com/khannaekta","followers_url":"https://api.github.com/users/khannaekta/followers","following_url":"https://api.github.com/users/khannaekta/following{/other_user}","gists_url":"https://api.github.com/users/khannaekta/gists{/gist_id}","starred_url":"https://api.github.com/users/khannaekta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/khannaekta/subscriptions","organizations_url":"https://api.github.com/users/khannaekta/orgs","repos_url":"https://api.github.com/users/khannaekta/repos","events_url":"https://api.github.com/users/khannaekta/events{/privacy}","received_events_url":"https://api.github.com/users/khannaekta/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-07T01:18:52Z","updated_at":"2020-10-07T01:18:52Z","author_association":"CONTRIBUTOR","body":"@fmcquillan99 Yes, this PR is ready  for final acceptance ","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/704636244/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/705841751","html_url":"https://github.com/apache/madlib/pull/519#issuecomment-705841751","issue_url":"https://api.github.com/repos/apache/madlib/issues/519","id":705841751,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNTg0MTc1MQ==","user":{"login":"fmcquillan99","id":10538173,"node_id":"MDQ6VXNlcjEwNTM4MTcz","avatar_url":"https://avatars.githubusercontent.com/u/10538173?v=4","gravatar_id":"","url":"https://api.github.com/users/fmcquillan99","html_url":"https://github.com/fmcquillan99","followers_url":"https://api.github.com/users/fmcquillan99/followers","following_url":"https://api.github.com/users/fmcquillan99/following{/other_user}","gists_url":"https://api.github.com/users/fmcquillan99/gists{/gist_id}","starred_url":"https://api.github.com/users/fmcquillan99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmcquillan99/subscriptions","organizations_url":"https://api.github.com/users/fmcquillan99/orgs","repos_url":"https://api.github.com/users/fmcquillan99/repos","events_url":"https://api.github.com/users/fmcquillan99/events{/privacy}","received_events_url":"https://api.github.com/users/fmcquillan99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-08T21:48:52Z","updated_at":"2020-10-08T21:58:16Z","author_association":"NONE","body":"(0) can we please rename this to :\r\n```\r\nload_top_k_accuracy_function(\r\n    object table,\r\n    k\r\n    )\r\n```\r\nbecause this is the terminology that Keras uses.  Also make user docs changes from `n` to `k`\r\n\r\n\r\n(1) multi-model, top k default\r\n```\r\nDROP TABLE IF EXISTS mst_table, mst_table_summary;\r\nSELECT madlib.load_model_selection_table('model_arch_library', -- model architecture table\r\n                                         'mst_table',          -- model selection table output\r\n                                          ARRAY[1,2],              -- model ids from model architecture table\r\n                                          ARRAY[                   -- compile params\r\n                                              $$loss='categorical_crossentropy',optimizer='Adam(lr=0.1)',metrics=['top_k_categorical_accuracy']$$,\r\n                                              $$loss='categorical_crossentropy', optimizer='Adam(lr=0.01)',metrics=['top_k_categorical_accuracy']$$,\r\n                                              $$loss='categorical_crossentropy',optimizer='Adam(lr=0.001)',metrics=['top_k_categorical_accuracy']$$\r\n                                          ],\r\n                                          ARRAY[                    -- fit params\r\n                                              $$batch_size=4,epochs=1$$,\r\n                                              $$batch_size=8,epochs=1$$\r\n                                          ]\r\n                                         );                               \r\nSELECT * FROM mst_table ORDER BY mst_key;\r\n```\r\n```\r\n mst_key | model_id |                                          compile_params                                           |      fit_params       \r\n---------+----------+---------------------------------------------------------------------------------------------------+-----------------------\r\n       1 |        1 | loss='categorical_crossentropy',optimizer='Adam(lr=0.001)',metrics=['top_k_categorical_accuracy'] | batch_size=4,epochs=1\r\n       2 |        1 | loss='categorical_crossentropy',optimizer='Adam(lr=0.001)',metrics=['top_k_categorical_accuracy'] | batch_size=8,epochs=1\r\n       3 |        1 | loss='categorical_crossentropy', optimizer='Adam(lr=0.01)',metrics=['top_k_categorical_accuracy'] | batch_size=4,epochs=1\r\n       4 |        1 | loss='categorical_crossentropy', optimizer='Adam(lr=0.01)',metrics=['top_k_categorical_accuracy'] | batch_size=8,epochs=1\r\n       5 |        1 | loss='categorical_crossentropy',optimizer='Adam(lr=0.1)',metrics=['top_k_categorical_accuracy']   | batch_size=4,epochs=1\r\n       6 |        1 | loss='categorical_crossentropy',optimizer='Adam(lr=0.1)',metrics=['top_k_categorical_accuracy']   | batch_size=8,epochs=1\r\n       7 |        2 | loss='categorical_crossentropy',optimizer='Adam(lr=0.001)',metrics=['top_k_categorical_accuracy'] | batch_size=4,epochs=1\r\n       8 |        2 | loss='categorical_crossentropy',optimizer='Adam(lr=0.001)',metrics=['top_k_categorical_accuracy'] | batch_size=8,epochs=1\r\n       9 |        2 | loss='categorical_crossentropy', optimizer='Adam(lr=0.01)',metrics=['top_k_categorical_accuracy'] | batch_size=4,epochs=1\r\n      10 |        2 | loss='categorical_crossentropy', optimizer='Adam(lr=0.01)',metrics=['top_k_categorical_accuracy'] | batch_size=8,epochs=1\r\n      11 |        2 | loss='categorical_crossentropy',optimizer='Adam(lr=0.1)',metrics=['top_k_categorical_accuracy']   | batch_size=4,epochs=1\r\n      12 |        2 | loss='categorical_crossentropy',optimizer='Adam(lr=0.1)',metrics=['top_k_categorical_accuracy']   | batch_size=8,epochs=1\r\n(12 rows)\r\n```\r\n```\r\nDROP TABLE IF EXISTS iris_multi_model, iris_multi_model_summary, iris_multi_model_info;\r\nSELECT madlib.madlib_keras_fit_multiple_model('iris_train_packed',    -- source_table\r\n                                              'iris_multi_model',     -- model_output_table\r\n                                              'mst_table',            -- model_selection_table\r\n                                              2,                     -- num_iterations\r\n                                              FALSE                   -- use gpus\r\n                                             );\r\nSELECT * FROM iris_multi_model_info;\r\n```\r\n```\r\n-[ RECORD 1 ]-------------+---------------------------------------------\r\nsource_table              | iris_train_packed\r\nvalidation_table          | \r\nmodel                     | iris_multi_model\r\nmodel_info                | iris_multi_model_info\r\ndependent_varname         | class_text\r\nindependent_varname       | attributes\r\nmodel_arch_table          | model_arch_library\r\nmodel_selection_table     | mst_table\r\nobject_table              | \r\nnum_iterations            | 2\r\nmetrics_compute_frequency | 2\r\nwarm_start                | f\r\nname                      | \r\ndescription               | \r\nstart_training_time       | 2020-10-08 21:00:11.766483\r\nend_training_time         | 2020-10-08 21:00:36.933537\r\nmadlib_version            | 1.18.0-dev\r\nnum_classes               | 3\r\nclass_values              | {Iris-setosa,Iris-versicolor,Iris-virginica}\r\ndependent_vartype         | character varying\r\nnormalizing_const         | 1\r\nmetrics_iters             | {2}\r\n\r\nTime: 8.248 ms\r\nmadlib=# SELECT * FROM iris_multi_model_info;\r\n-[ RECORD 1 ]------------+--------------------------------------------------------------------------------------------------\r\nmst_key                  | 2\r\nmodel_id                 | 1\r\ncompile_params           | loss='categorical_crossentropy',optimizer='Adam(lr=0.001)',metrics=['top_k_categorical_accuracy']\r\nfit_params               | batch_size=8,epochs=1\r\nmodel_type               | madlib_keras\r\nmodel_size               | 0.7900390625\r\nmetrics_elapsed_time     | {23.0940079689026}\r\nmetrics_type             | {top_k_categorical_accuracy}\r\nloss_type                | categorical_crossentropy\r\ntraining_metrics_final   | 1\r\ntraining_loss_final      | 0.981531918048859\r\ntraining_metrics         | {1}\r\ntraining_loss            | {0.981531918048859}\r\nvalidation_metrics_final | \r\nvalidation_loss_final    | \r\nvalidation_metrics       | \r\nvalidation_loss          | \r\n-[ RECORD 2 ]------------+--------------------------------------------------------------------------------------------------\r\nmst_key                  | 10\r\nmodel_id                 | 2\r\ncompile_params           | loss='categorical_crossentropy', optimizer='Adam(lr=0.01)',metrics=['top_k_categorical_accuracy']\r\nfit_params               | batch_size=8,epochs=1\r\nmodel_type               | madlib_keras\r\nmodel_size               | 1.2197265625\r\nmetrics_elapsed_time     | {23.4646620750427}\r\nmetrics_type             | {top_k_categorical_accuracy}\r\nloss_type                | categorical_crossentropy\r\ntraining_metrics_final   | 1\r\ntraining_loss_final      | 0.49222993850708\r\ntraining_metrics         | {1}\r\ntraining_loss            | {0.49222993850708}\r\nvalidation_metrics_final | \r\nvalidation_loss_final    | \r\nvalidation_metrics       | \r\nvalidation_loss          | \r\netc\r\n```\r\nOK\r\n\r\n\r\n(2) multi-model, top k custom function\r\n\r\nDROP TABLE IF EXISTS custom_function_table;\r\nSELECT madlib.load_top_n_accuracy_function('custom_function_table',\r\n                                   3);\r\n```\r\nINFO:  Keras Custom Function: Created new custom function table custom_function_table.\r\nCONTEXT:  PL/Python function \"load_custom_function\"\r\nSQL statement \"\r\n        SELECT  madlib.load_custom_function('custom_function_table',\r\n                madlib.top_k_categorical_acc_pickled(3, 'top_3_accuracy'),\r\n                'top_3_accuracy',\r\n                'returns top_3_accuracy');\r\n        \"\r\nPL/Python function \"load_custom_function\"\r\nINFO:  Keras Custom Function: Added function top_3_accuracy to custom_function_table table\r\nCONTEXT:  PL/Python function \"load_custom_function\"\r\nSQL statement \"\r\n        SELECT  madlib.load_custom_function('custom_function_table',\r\n                madlib.top_k_categorical_acc_pickled(3, 'top_3_accuracy'),\r\n                'top_3_accuracy',\r\n                'returns top_3_accuracy');\r\n        \"\r\nPL/Python function \"load_custom_function\"\r\n load_top_n_accuracy_function \r\n------------------------------\r\n \r\n(1 row)\r\n```\r\n\r\nSELECT id, name, description FROM custom_function_table ORDER BY id;\r\n```\r\n id |      name      |      description       \r\n----+----------------+------------------------\r\n  1 | top_3_accuracy | returns top_3_accuracy\r\n(1 row)\r\n```\r\n\r\nresults OK but please remove verbose output\r\n\r\n\r\n(3) multi-model, run fit() with custom function\r\n```\r\nDROP TABLE IF EXISTS mst_table, mst_table_summary;\r\nSELECT madlib.load_model_selection_table('model_arch_library', -- model architecture table\r\n                                         'mst_table',          -- model selection table output\r\n                                          ARRAY[1,2],              -- model ids from model architecture table\r\n                                          ARRAY[                   -- compile params\r\n                                              $$loss='categorical_crossentropy',optimizer='Adam(lr=0.1)',metrics=['top_3_accuracy']$$,\r\n                                              $$loss='categorical_crossentropy', optimizer='Adam(lr=0.01)',metrics=['top_3_accuracy']$$,\r\n                                              $$loss='categorical_crossentropy',optimizer='Adam(lr=0.001)',metrics=['top_3_accuracy']$$\r\n                                          ],\r\n                                          ARRAY[                    -- fit params\r\n                                              $$batch_size=4,epochs=1$$,\r\n                                              $$batch_size=8,epochs=1$$\r\n                                          ],\r\n                                          'custom_function_table' -- custom table\r\n                                         );                                 \r\nSELECT * FROM mst_table ORDER BY mst_key;\r\n```\r\n```\r\n mst_key | model_id |                                    compile_params                                     |      fit_params       \r\n---------+----------+---------------------------------------------------------------------------------------+-----------------------\r\n       1 |        1 | loss='categorical_crossentropy',optimizer='Adam(lr=0.1)',metrics=['top_3_accuracy']   | batch_size=4,epochs=1\r\n       2 |        1 | loss='categorical_crossentropy',optimizer='Adam(lr=0.1)',metrics=['top_3_accuracy']   | batch_size=8,epochs=1\r\n       3 |        1 | loss='categorical_crossentropy', optimizer='Adam(lr=0.01)',metrics=['top_3_accuracy'] | batch_size=4,epochs=1\r\n       4 |        1 | loss='categorical_crossentropy', optimizer='Adam(lr=0.01)',metrics=['top_3_accuracy'] | batch_size=8,epochs=1\r\n       5 |        1 | loss='categorical_crossentropy',optimizer='Adam(lr=0.001)',metrics=['top_3_accuracy'] | batch_size=4,epochs=1\r\n       6 |        1 | loss='categorical_crossentropy',optimizer='Adam(lr=0.001)',metrics=['top_3_accuracy'] | batch_size=8,epochs=1\r\n       7 |        2 | loss='categorical_crossentropy',optimizer='Adam(lr=0.1)',metrics=['top_3_accuracy']   | batch_size=4,epochs=1\r\n       8 |        2 | loss='categorical_crossentropy',optimizer='Adam(lr=0.1)',metrics=['top_3_accuracy']   | batch_size=8,epochs=1\r\n       9 |        2 | loss='categorical_crossentropy', optimizer='Adam(lr=0.01)',metrics=['top_3_accuracy'] | batch_size=4,epochs=1\r\n      10 |        2 | loss='categorical_crossentropy', optimizer='Adam(lr=0.01)',metrics=['top_3_accuracy'] | batch_size=8,epochs=1\r\n      11 |        2 | loss='categorical_crossentropy',optimizer='Adam(lr=0.001)',metrics=['top_3_accuracy'] | batch_size=4,epochs=1\r\n      12 |        2 | loss='categorical_crossentropy',optimizer='Adam(lr=0.001)',metrics=['top_3_accuracy'] | batch_size=8,epochs=1\r\n(12 rows)\r\n```\r\n```\r\nDROP TABLE IF EXISTS iris_multi_model, iris_multi_model_summary, iris_multi_model_info;\r\nSELECT madlib.madlib_keras_fit_multiple_model('iris_train_packed',    -- source_table\r\n                                              'iris_multi_model',     -- model_output_table\r\n                                              'mst_table',            -- model_selection_table\r\n                                              2,                     -- num_iterations\r\n                                              FALSE,                   -- use gpus\r\n                                              NULL,\r\n                                              NULL\r\n                                             );\r\nSELECT * FROM iris_multi_model_summary;\r\n```\r\n```\r\nsource_table              | iris_train_packed\r\nvalidation_table          | \r\nmodel                     | iris_multi_model\r\nmodel_info                | iris_multi_model_info\r\ndependent_varname         | class_text\r\nindependent_varname       | attributes\r\nmodel_arch_table          | model_arch_library\r\nmodel_selection_table     | mst_table\r\nobject_table              | custom_function_table\r\nnum_iterations            | 2\r\nmetrics_compute_frequency | 2\r\nwarm_start                | f\r\nname                      | \r\ndescription               | \r\nstart_training_time       | 2020-10-08 21:22:27.219617\r\nend_training_time         | 2020-10-08 21:22:52.310825\r\nmadlib_version            | 1.18.0-dev\r\nnum_classes               | 3\r\nclass_values              | {Iris-setosa,Iris-versicolor,Iris-virginica}\r\ndependent_vartype         | character varying\r\nnormalizing_const         | 1\r\nmetrics_iters             | {2}\r\n```\r\n```\r\nSELECT * FROM iris_multi_model_info;\r\n```\r\n```\r\n-[ RECORD 1 ]------------+--------------------------------------------------------------------------------------\r\nmst_key                  | 2\r\nmodel_id                 | 1\r\ncompile_params           | loss='categorical_crossentropy',optimizer='Adam(lr=0.1)',metrics=['top_3_accuracy']\r\nfit_params               | batch_size=8,epochs=1\r\nmodel_type               | madlib_keras\r\nmodel_size               | 0.7900390625\r\nmetrics_elapsed_time     | {22.8225800991058}\r\nmetrics_type             | {top_3_accuracy}\r\nloss_type                | categorical_crossentropy\r\ntraining_metrics_final   | 1\r\ntraining_loss_final      | 0.488488465547562\r\ntraining_metrics         | {1}\r\ntraining_loss            | {0.488488465547562}\r\nvalidation_metrics_final | \r\nvalidation_loss_final    | \r\nvalidation_metrics       | \r\nvalidation_loss          | \r\n-[ RECORD 2 ]------------+--------------------------------------------------------------------------------------\r\nmst_key                  | 10\r\nmodel_id                 | 2\r\ncompile_params           | loss='categorical_crossentropy', optimizer='Adam(lr=0.01)',metrics=['top_3_accuracy']\r\nfit_params               | batch_size=8,epochs=1\r\nmodel_type               | madlib_keras\r\nmodel_size               | 1.2197265625\r\nmetrics_elapsed_time     | {23.2352600097656}\r\nmetrics_type             | {top_3_accuracy}\r\nloss_type                | categorical_crossentropy\r\ntraining_metrics_final   | 1\r\ntraining_loss_final      | 0.713700234889984\r\ntraining_metrics         | {1}\r\ntraining_loss            | {0.713700234889984}\r\nvalidation_metrics_final | \r\nvalidation_loss_final    | \r\nvalidation_metrics       | \r\nvalidation_loss          | \r\netc\r\n```\r\n\r\nOK\r\n\r\n\r\n(4) did you test with madlib.madlib_keras_fit() ?\r\n\r\n(5) user docs need to be update for fit() and fit_multiple() regarding this function and how to use it.  I can work on that but want to record it here since should go as part of this PR before we merge it.\r\n","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/705841751/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/705885794","html_url":"https://github.com/apache/madlib/pull/519#issuecomment-705885794","issue_url":"https://api.github.com/repos/apache/madlib/issues/519","id":705885794,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNTg4NTc5NA==","user":{"login":"khannaekta","id":15749573,"node_id":"MDQ6VXNlcjE1NzQ5NTcz","avatar_url":"https://avatars.githubusercontent.com/u/15749573?v=4","gravatar_id":"","url":"https://api.github.com/users/khannaekta","html_url":"https://github.com/khannaekta","followers_url":"https://api.github.com/users/khannaekta/followers","following_url":"https://api.github.com/users/khannaekta/following{/other_user}","gists_url":"https://api.github.com/users/khannaekta/gists{/gist_id}","starred_url":"https://api.github.com/users/khannaekta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/khannaekta/subscriptions","organizations_url":"https://api.github.com/users/khannaekta/orgs","repos_url":"https://api.github.com/users/khannaekta/repos","events_url":"https://api.github.com/users/khannaekta/events{/privacy}","received_events_url":"https://api.github.com/users/khannaekta/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-08T23:45:51Z","updated_at":"2020-10-08T23:46:07Z","author_association":"CONTRIBUTOR","body":"> (0) can we please rename this to :\r\n> \r\n> ```\r\n> load_top_k_accuracy_function(\r\n>     object table,\r\n>     k\r\n>     )\r\n> ```......\r\nSure, will make those changes \r\n \r\n> (2) multi-model, top k custom function\r\n> \r\n> ```\r\n> INFO:  Keras Custom Function: Created new custom function table custom_function_table.\r\n> CONTEXT:  PL/Python function \"load_custom_function\"\r\n> SQL statement \"\r\n>         SELECT  madlib.load_custom_function('custom_function_table',\r\n>                 madlib.top_k_categorical_acc_pickled(3, 'top_3_accuracy'),\r\n>                 'top_3_accuracy',\r\n>                 'returns top_3_accuracy');\r\n>         \"\r\n>   ......\r\n> results OK but please remove verbose output\r\n\r\nAgreed! I had the same comment in my initial review too. These verbose INFOs are coming from calling `load_custom_function()`, so we should probably suppress those. \r\n\r\n> (4) did you test with madlib.madlib_keras_fit() ?\r\n\r\nI tested it manually. But will add an end-to-end test for testing it with fit, fit_multiple and evaluate","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/705885794/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/706265521","html_url":"https://github.com/apache/madlib/pull/519#issuecomment-706265521","issue_url":"https://api.github.com/repos/apache/madlib/issues/519","id":706265521,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjI2NTUyMQ==","user":{"login":"fmcquillan99","id":10538173,"node_id":"MDQ6VXNlcjEwNTM4MTcz","avatar_url":"https://avatars.githubusercontent.com/u/10538173?v=4","gravatar_id":"","url":"https://api.github.com/users/fmcquillan99","html_url":"https://github.com/fmcquillan99","followers_url":"https://api.github.com/users/fmcquillan99/followers","following_url":"https://api.github.com/users/fmcquillan99/following{/other_user}","gists_url":"https://api.github.com/users/fmcquillan99/gists{/gist_id}","starred_url":"https://api.github.com/users/fmcquillan99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmcquillan99/subscriptions","organizations_url":"https://api.github.com/users/fmcquillan99/orgs","repos_url":"https://api.github.com/users/fmcquillan99/repos","events_url":"https://api.github.com/users/fmcquillan99/events{/privacy}","received_events_url":"https://api.github.com/users/fmcquillan99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-09T16:01:45Z","updated_at":"2020-10-09T16:01:45Z","author_association":"NONE","body":"sounds good, thanks @khannaekta ","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/706265521/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/707396018","html_url":"https://github.com/apache/madlib/pull/518#issuecomment-707396018","issue_url":"https://api.github.com/repos/apache/madlib/issues/518","id":707396018,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzM5NjAxOA==","user":{"login":"fmcquillan99","id":10538173,"node_id":"MDQ6VXNlcjEwNTM4MTcz","avatar_url":"https://avatars.githubusercontent.com/u/10538173?v=4","gravatar_id":"","url":"https://api.github.com/users/fmcquillan99","html_url":"https://github.com/fmcquillan99","followers_url":"https://api.github.com/users/fmcquillan99/followers","following_url":"https://api.github.com/users/fmcquillan99/following{/other_user}","gists_url":"https://api.github.com/users/fmcquillan99/gists{/gist_id}","starred_url":"https://api.github.com/users/fmcquillan99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmcquillan99/subscriptions","organizations_url":"https://api.github.com/users/fmcquillan99/orgs","repos_url":"https://api.github.com/users/fmcquillan99/repos","events_url":"https://api.github.com/users/fmcquillan99/events{/privacy}","received_events_url":"https://api.github.com/users/fmcquillan99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-12T23:31:18Z","updated_at":"2020-10-12T23:31:18Z","author_association":"NONE","body":"(11)\r\n```\r\nSELECT madlib.madlib_keras_automl('cifar10_train_packed', \r\n                                  'automl_cifar10_output', \r\n                                  'model_arch_library', \r\n                                  'automl_cifar10_mst_table',\r\n                                  ARRAY[2], \r\n                                  $${'loss': ['categorical_crossentropy'], \r\n                                     'optimizer_params_list': [ \r\n                                         {'optimizer': ['Adam'],'lr': [0.0001, 0.01, 'log']},\r\n                                         {'optimizer': ['RMSprop'],'lr': [0.0001, 0.01, 'log'], 'decay': [1.0e-7, 1.0e-5, 'log']},\r\n                                         {'optimizer': ['SGD'],'lr': [0.0001, 0.01, 'log'], 'momentum': [0.9, 0.99,'log']}],\r\n                                     'metrics':['accuracy']}$$, \r\n                                  $${'batch_size': [128], 'epochs': [1]}$$,\r\n                                  'hyperopt', \r\n                                  'num_configs=100, num_iterations=3, algorithm=tpe',\r\n                                  NULL,                    -- random state\r\n                                  NULL,                  -- object table\r\n                                  FALSE,                 -- use GPUs\r\n                                  'cifar10_val_packed', -- validation table\r\n                                  1,                     -- metrics compute freq\r\n                                  NULL,                  -- name\r\n                                  NULL);                 -- descr\r\n```\r\nproduces\r\n```\r\nselect mst_key, metrics_elapsed_time from hopt_cifar10_output_info_c100n3tperun1 order by mst_key;\r\n mst_key |                 metrics_elapsed_time                 \r\n---------+------------------------------------------------------\r\n       1 | {627.882262945175,1264.80915999413,1896.74943590164}\r\n       2 | {614.573877811432,1251.1022670269,1883.14707994461}\r\n       3 | {638.407788038254,1286.73397421837,1939.58357810974}\r\n       4 | {624.925609111786,1273.55782914162,1925.82674407959}\r\n       5 | {650.984225034714,1307.78145503998,1962.8148560524}\r\n       6 | {637.914520978928,1294.23532605171,1949.12843108177}\r\n       7 | {651.188719987869,1301.32990193367,1948.88206887245}\r\n       8 | {637.525157928467,1288.19901585579,1935.65923500061}\r\n       9 | {651.277820110321,1301.09531402588,1947.13559818268}\r\n      10 | {637.898158073425,1287.54387116432,1933.5972070694}\r\n      11 | {650.482151985168,1309.5760037899,1961.18471598625}\r\n      12 | {637.149097919464,1295.67461585999,1947.66235399246}\r\n      13 | {651.543440818787,1299.3868060112,1948.78301692009}\r\n      14 | {638.292811870575,1285.66767001152,1935.02927088737}\r\n      15 | {650.077238082886,1305.37611913681,1962.8950419426}\r\n      16 | {636.498329162598,1291.3173930645,1948.41972708702}\r\n      17 | {649.946799993515,1303.33863401413,1949.58992981911}\r\n      18 | {636.373380899429,1289.27607584,1936.36742186546}\r\n      19 | {647.414880990982,1297.31931090355,1945.65248298645}\r\n      20 | {634.09289598465,1284.170140028,1932.07456684113}\r\n      21 | {684.188683986664,1330.76613283157,1980.06952404976}\r\n      22 | {670.57110285759,1317.26948404312,1966.71574902534}\r\n      23 | {651.919174909592,1304.4483089447,1949.68165898323}\r\n      24 | {637.834177970886,1290.82985186577,1936.79075098038}\r\n      25 | {655.077679872513,1298.5494530201,1945.88967299461}\r\n      26 | {642.029677867889,1285.51564288139,1932.42474102974}\r\n      27 | {647.519994020462,1291.86638307571,1940.63740706444}\r\n      28 | {634.281761884689,1277.6536450386,1927.27670001984}\r\n      29 | {649.227880954742,1295.78293895721,1939.8649418354}\r\n      30 | {635.665500879288,1282.13676691055,1926.41391181946}\r\n      31 | {646.891736984253,1292.39306688309,1939.45323801041}\r\n      32 | {633.289309024811,1278.57114887238,1925.29498195648}\r\n      33 | {645.044659852982,1294.90844988823,1934.83831381798}\r\n      34 | {631.370570898056,1281.09457278252,1921.84612298012}\r\n      35 | {641.974558115005,1287.15608096123,1933.71887016296}\r\n      36 | {628.698891162872,1273.55222702026,1920.55405902863}\r\n      37 | {645.359504938126,1286.81019496918,1936.24443602562}\r\n      38 | {632.138350963593,1273.69606280327,1921.84107279778}\r\n      39 | {645.965959072113,1291.83859109879,1934.28793001175}\r\n      40 | {631.842108011246,1278.0611550808,1921.37190818787}\r\n      41 | {644.744366168976,1284.78299307823,1926.56299805641}\r\n      42 | {631.000986099243,1271.36041498184,1912.94822907448}\r\n      43 | {646.629382133484,1289.81746912003,1938.30674505234}\r\n      44 | {633.08934211731,1276.87801408768,1924.48914599419}\r\n      45 | {645.794209003448,1289.52689504623,1928.10301995277}\r\n      46 | {632.544068098068,1276.46976709366,1915.18053913116}\r\n      47 | {648.967436075211,1296.18764710426,1942.72390508652}\r\n      48 | {635.180493116379,1282.65127015114,1928.7596950531}\r\n      49 | {642.685960054398,1281.86446094513,1924.27530503273}\r\n      50 | {628.867849111557,1268.81643414497,1910.81892299652}\r\n      51 | {642.25784611702,1285.31040906906,1931.93548893929}\r\n      52 | {628.323985099792,1271.58122897148,1918.26403403282}\r\n      53 | {641.810137033463,1285.25560903549,1929.13687109947}\r\n      54 | {628.287924051285,1271.25157594681,1915.76375198364}\r\n      55 | {645.721904993057,1285.12515211105,1928.89319014549}\r\n      56 | {632.100169181824,1271.49339413643,1915.78533101082}\r\n      57 | {639.617475986481,1275.61342597008,1915.39825177193}\r\n      58 | {626.503052949905,1262.02722096443,1901.32048177719}\r\n      59 | {635.73348903656,1280.25348901749,1919.08957004547}\r\n      60 | {622.708857059479,1266.27361917496,1905.91475009918}\r\n      61 | {640.503421068192,1279.74774312973,1920.75052404404}\r\n      62 | {627.23721909523,1266.51659917831,1906.79211616516}\r\n      63 | {642.081022977829,1277.49766278267,1916.42965888977}\r\n      64 | {628.109483957291,1264.7400097847,1903.20749592781}\r\n      65 | {640.490365028381,1283.00291013718,1924.50952506065}\r\n      66 | {627.058392047882,1269.47951006889,1910.89861011505}\r\n      67 | {636.89220905304,1277.09766602516,1910.96581101418}\r\n      68 | {624.116094112396,1263.90056610107,1898.12311601639}\r\n      69 | {635.469167947769,1269.55181598663,1904.01561403275}\r\n      70 | {622.43970489502,1256.59510493279,1890.07668590546}\r\n      71 | {636.119792938232,1276.15144109726,1913.03098011017}\r\n      72 | {622.38174700737,1262.04434704781,1899.77307701111}\r\n      73 | {635.743231058121,1276.63025021553,1917.14123606682}\r\n      74 | {622.766848087311,1263.39644908905,1903.07419419289}\r\n      75 | {630.598103046417,1267.86923599243,1899.72781896591}\r\n      76 | {617.88782787323,1254.63754701614,1886.25667786598}\r\n      77 | {632.587329149246,1270.71484613419,1902.50029301643}\r\n      78 | {619.189999103546,1257.35159301758,1889.55543804169}\r\n      79 | {631.962325811386,1268.57928681374,1901.31368494034}\r\n      80 | {618.959751844406,1255.32190680504,1888.31697797775}\r\n      81 | {634.275179862976,1261.66588997841,1895.5607509613}\r\n      82 | {619.90931391716,1248.77173399925,1882.48632383347}\r\n      83 | {633.14914894104,1265.85549592972,1897.17652893066}\r\n      84 | {619.785959005356,1252.29544901848,1884.09737896919}\r\n      85 | {627.898339033127,1261.44491815567,1893.74317097664}\r\n      86 | {615.068039178848,1248.09124517441,1879.57727813721}\r\n      87 | {633.1245470047,1268.63815689087,1904.82987594604}\r\n      88 | {619.971349954605,1255.54224300385,1891.63547801971}\r\n      89 | {634.308418035507,1267.44264101982,1903.04254603386}\r\n      90 | {621.244497060776,1254.47942519188,1889.07282710075}\r\n      91 | {638.813256025314,1286.2553050518,1923.13115119934}\r\n      92 | {624.587430000305,1271.47850799561,1909.81140208244}\r\n      93 | {635.323696136475,1271.31673598289,1910.10420203209}\r\n      94 | {622.143538951874,1258.46868395805,1896.75948596001}\r\n      95 | {636.06889295578,1269.57318091393,1905.99937295914}\r\n      96 | {621.923580884933,1255.54979085922,1892.35493183136}\r\n      97 | {635.867208957672,1275.91143798828,1907.85138106346}\r\n      98 | {622.153614997864,1262.45370602608,1895.00853896141}\r\n      99 | {632.058423995972,1264.59007382393,1902.03439188004}\r\n     100 | {618.850169897079,1251.59025883675,1889.0108628273}\r\n(100 rows)\r\n```\r\nThese times should be cumulative, not relative to when the trial started.  We want to be able to do a plot that looks like:\r\n\r\n![image](https://user-images.githubusercontent.com/10538173/95799055-5846b500-0ca8-11eb-9f3a-b2dc35b416d0.png)\r\n","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/707396018/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/707396551","html_url":"https://github.com/apache/madlib/pull/518#issuecomment-707396551","issue_url":"https://api.github.com/repos/apache/madlib/issues/518","id":707396551,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzM5NjU1MQ==","user":{"login":"fmcquillan99","id":10538173,"node_id":"MDQ6VXNlcjEwNTM4MTcz","avatar_url":"https://avatars.githubusercontent.com/u/10538173?v=4","gravatar_id":"","url":"https://api.github.com/users/fmcquillan99","html_url":"https://github.com/fmcquillan99","followers_url":"https://api.github.com/users/fmcquillan99/followers","following_url":"https://api.github.com/users/fmcquillan99/following{/other_user}","gists_url":"https://api.github.com/users/fmcquillan99/gists{/gist_id}","starred_url":"https://api.github.com/users/fmcquillan99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmcquillan99/subscriptions","organizations_url":"https://api.github.com/users/fmcquillan99/orgs","repos_url":"https://api.github.com/users/fmcquillan99/repos","events_url":"https://api.github.com/users/fmcquillan99/events{/privacy}","received_events_url":"https://api.github.com/users/fmcquillan99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-12T23:33:03Z","updated_at":"2020-10-12T23:53:59Z","author_association":"NONE","body":"(12)\r\n```\r\n\\d hopt_cifar10_output_info_c100n3tperun1\r\n   Table \"public.hopt_cifar10_output_info_c100n3tperun1\"\r\n          Column          |        Type        | Modifiers \r\n--------------------------+--------------------+-----------\r\n mst_key                  | integer            | not null\r\n model_id                 | integer            | \r\n compile_params           | text               | \r\n fit_params               | text               | \r\n model_type               | text               | \r\n model_size               | double precision   | \r\n metrics_elapsed_time     | double precision[] | \r\n metrics_type             | text[]             | \r\n loss_type                | text               | \r\n training_metrics_final   | double precision   | \r\n training_loss_final      | double precision   | \r\n training_metrics         | double precision[] | \r\n training_loss            | double precision[] | \r\n validation_metrics_final | double precision   | \r\n validation_loss_final    | double precision   | \r\n validation_metrics       | double precision[] | \r\n validation_loss          | double precision[] | \r\n```\r\nis missing from the bottom:\r\n```\r\nmetrics_iters            | integer[]          | \r\n```\r\nI think that metrics_iters is *not* cumulative because that concept does not seem to make sense for hyperopt.  The output table would look like:\r\n```\r\n mst_key |     metrics_iters.   |            metrics_elapsed_time                 \r\n---------+------------------------------------------------------\r\n       1 | {1,4,7} | {627.882262945175,1264.80915999413,1896.74943590164}\r\n       2 | {1,4,7} | {614.573877811432,1251.1022670269,1883.14707994461}\r\n       3 | {1,4,7} | {638.407788038254,1286.73397421837,1939.58357810974}\r\n```\r\nor `{1,2,3}` or  `{5,10,12}` etc. depending on metrics compute freq and number of itns.","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/707396551/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/707397232","html_url":"https://github.com/apache/madlib/pull/518#issuecomment-707397232","issue_url":"https://api.github.com/repos/apache/madlib/issues/518","id":707397232,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzM5NzIzMg==","user":{"login":"Advitya17","id":37190647,"node_id":"MDQ6VXNlcjM3MTkwNjQ3","avatar_url":"https://avatars.githubusercontent.com/u/37190647?v=4","gravatar_id":"","url":"https://api.github.com/users/Advitya17","html_url":"https://github.com/Advitya17","followers_url":"https://api.github.com/users/Advitya17/followers","following_url":"https://api.github.com/users/Advitya17/following{/other_user}","gists_url":"https://api.github.com/users/Advitya17/gists{/gist_id}","starred_url":"https://api.github.com/users/Advitya17/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Advitya17/subscriptions","organizations_url":"https://api.github.com/users/Advitya17/orgs","repos_url":"https://api.github.com/users/Advitya17/repos","events_url":"https://api.github.com/users/Advitya17/events{/privacy}","received_events_url":"https://api.github.com/users/Advitya17/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-12T23:35:32Z","updated_at":"2020-10-12T23:36:02Z","author_association":"CONTRIBUTOR","body":"> (12)\r\n> \r\n> ```\r\n> \\d hopt_cifar10_output_info_c100n3tperun1\r\n>    Table \"public.hopt_cifar10_output_info_c100n3tperun1\"\r\n>           Column          |        Type        | Modifiers \r\n> --------------------------+--------------------+-----------\r\n>  mst_key                  | integer            | not null\r\n>  model_id                 | integer            | \r\n>  compile_params           | text               | \r\n>  fit_params               | text               | \r\n>  model_type               | text               | \r\n>  model_size               | double precision   | \r\n>  metrics_elapsed_time     | double precision[] | \r\n>  metrics_type             | text[]             | \r\n>  loss_type                | text               | \r\n>  training_metrics_final   | double precision   | \r\n>  training_loss_final      | double precision   | \r\n>  training_metrics         | double precision[] | \r\n>  training_loss            | double precision[] | \r\n>  validation_metrics_final | double precision   | \r\n>  validation_loss_final    | double precision   | \r\n>  validation_metrics       | double precision[] | \r\n>  validation_loss          | double precision[] | \r\n> ```\r\n> \r\n> is missing from the bottom:\r\n> \r\n> ```\r\n> metrics_iters            | integer[]          | \r\n> ```\r\n\r\n`metrics_iters` is mentioned in the summary table itself, as its value is the same for all configs (if I recall correctly).","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/707397232/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/707398631","html_url":"https://github.com/apache/madlib/pull/518#issuecomment-707398631","issue_url":"https://api.github.com/repos/apache/madlib/issues/518","id":707398631,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzM5ODYzMQ==","user":{"login":"fmcquillan99","id":10538173,"node_id":"MDQ6VXNlcjEwNTM4MTcz","avatar_url":"https://avatars.githubusercontent.com/u/10538173?v=4","gravatar_id":"","url":"https://api.github.com/users/fmcquillan99","html_url":"https://github.com/fmcquillan99","followers_url":"https://api.github.com/users/fmcquillan99/followers","following_url":"https://api.github.com/users/fmcquillan99/following{/other_user}","gists_url":"https://api.github.com/users/fmcquillan99/gists{/gist_id}","starred_url":"https://api.github.com/users/fmcquillan99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmcquillan99/subscriptions","organizations_url":"https://api.github.com/users/fmcquillan99/orgs","repos_url":"https://api.github.com/users/fmcquillan99/repos","events_url":"https://api.github.com/users/fmcquillan99/events{/privacy}","received_events_url":"https://api.github.com/users/fmcquillan99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-12T23:41:10Z","updated_at":"2020-10-12T23:41:10Z","author_association":"NONE","body":"I don't see it in there\r\n```\r\n\\d hopt_cifar10_output_summary_c100n3tperun1;\r\n      Table \"public.hopt_cifar10_output_summary_c100n3tperun1\"\r\n          Column           |            Type             | Modifiers \r\n---------------------------+-----------------------------+-----------\r\n source_table              | text                        | \r\n validation_table          | text                        | \r\n model                     | text                        | \r\n model_info                | text                        | \r\n dependent_varname         | text                        | \r\n independent_varname       | text                        | \r\n model_arch_table          | text                        | \r\n model_selection_table     | text                        | \r\n automl_method             | text                        | \r\n automl_params             | text                        | \r\n random_state              | text                        | \r\n object_table              | text                        | \r\n use_gpus                  | boolean                     | \r\n metrics_compute_frequency | integer                     | \r\n name                      | text                        | \r\n description               | text                        | \r\n start_training_time       | timestamp without time zone | \r\n end_training_time         | timestamp without time zone | \r\n madlib_version            | text                        | \r\n num_classes               | integer                     | \r\n class_values              | text[]                      | \r\n dependent_vartype         | text                        | \r\n normalizing_const         | real                        | \r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/707398631/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/707399640","html_url":"https://github.com/apache/madlib/pull/518#issuecomment-707399640","issue_url":"https://api.github.com/repos/apache/madlib/issues/518","id":707399640,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzM5OTY0MA==","user":{"login":"Advitya17","id":37190647,"node_id":"MDQ6VXNlcjM3MTkwNjQ3","avatar_url":"https://avatars.githubusercontent.com/u/37190647?v=4","gravatar_id":"","url":"https://api.github.com/users/Advitya17","html_url":"https://github.com/Advitya17","followers_url":"https://api.github.com/users/Advitya17/followers","following_url":"https://api.github.com/users/Advitya17/following{/other_user}","gists_url":"https://api.github.com/users/Advitya17/gists{/gist_id}","starred_url":"https://api.github.com/users/Advitya17/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Advitya17/subscriptions","organizations_url":"https://api.github.com/users/Advitya17/orgs","repos_url":"https://api.github.com/users/Advitya17/repos","events_url":"https://api.github.com/users/Advitya17/events{/privacy}","received_events_url":"https://api.github.com/users/Advitya17/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-12T23:44:57Z","updated_at":"2020-10-12T23:45:52Z","author_association":"CONTRIBUTOR","body":">  mst_key |                 metrics_elapsed_time                 \r\n> ---------+------------------------------------------------------\r\n>        1 | {627.882262945175,1264.80915999413,1896.74943590164}\r\n>        2 | {614.573877811432,1251.1022670269,1883.14707994461}\r\n>        3 | {638.407788038254,1286.73397421837,1939.58357810974}\r\n>        4 | {624.925609111786,1273.55782914162,1925.82674407959}\r\n>        5 | {650.984225034714,1307.78145503998,1962.8148560524}\r\n>        6 | {637.914520978928,1294.23532605171,1949.12843108177}\r\n>        7 | {651.188719987869,1301.32990193367,1948.88206887245}\r\n>        8 | {637.525157928467,1288.19901585579,1935.65923500061}\r\n>        9 | {651.277820110321,1301.09531402588,1947.13559818268}\r\n>       10 | {637.898158073425,1287.54387116432,1933.5972070694}\r\n>       11 | {650.482151985168,1309.5760037899,1961.18471598625}\r\n>       12 | {637.149097919464,1295.67461585999,1947.66235399246}\r\n>       13 | {651.543440818787,1299.3868060112,1948.78301692009}\r\n>       14 | {638.292811870575,1285.66767001152,1935.02927088737}\r\n>       15 | {650.077238082886,1305.37611913681,1962.8950419426}\r\n>       16 | {636.498329162598,1291.3173930645,1948.41972708702}\r\n>       17 | {649.946799993515,1303.33863401413,1949.58992981911}\r\n>       18 | {636.373380899429,1289.27607584,1936.36742186546}\r\n>       19 | {647.414880990982,1297.31931090355,1945.65248298645}\r\n>       20 | {634.09289598465,1284.170140028,1932.07456684113}\r\n\r\nIt may be possible to do the following to get the graph:\r\n\r\n1. Have a 'time offset' like variable (initially set to zero)\r\n2. Time the individual fit multiple function calls (in seconds I presume) (for adding the recorded times to the offset variable each time). \r\n3. After a run of fit multiple, write an update like query to update `metrics_elapsed_time` by adding the total offset to every element of the array value (for the first run, an offset of 0 would be added, i.e. no offset) for the model configs trained in that round (this may be determined by the `mst_key` ranges).\r\n4. Update the offset variable by incrementing it by the recorded time for the most recent loop run (i.e. fit multiple function call).\r\n\r\nLet me know if anything doesn't seem clear.","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/707399640/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/707400603","html_url":"https://github.com/apache/madlib/pull/518#issuecomment-707400603","issue_url":"https://api.github.com/repos/apache/madlib/issues/518","id":707400603,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzQwMDYwMw==","user":{"login":"Advitya17","id":37190647,"node_id":"MDQ6VXNlcjM3MTkwNjQ3","avatar_url":"https://avatars.githubusercontent.com/u/37190647?v=4","gravatar_id":"","url":"https://api.github.com/users/Advitya17","html_url":"https://github.com/Advitya17","followers_url":"https://api.github.com/users/Advitya17/followers","following_url":"https://api.github.com/users/Advitya17/following{/other_user}","gists_url":"https://api.github.com/users/Advitya17/gists{/gist_id}","starred_url":"https://api.github.com/users/Advitya17/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Advitya17/subscriptions","organizations_url":"https://api.github.com/users/Advitya17/orgs","repos_url":"https://api.github.com/users/Advitya17/repos","events_url":"https://api.github.com/users/Advitya17/events{/privacy}","received_events_url":"https://api.github.com/users/Advitya17/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-12T23:48:24Z","updated_at":"2020-10-13T00:01:29Z","author_association":"CONTRIBUTOR","body":"> I don't see it in there\r\n> \r\n> ```\r\n> \\d hopt_cifar10_output_summary_c100n3tperun1;\r\n>       Table \"public.hopt_cifar10_output_summary_c100n3tperun1\"\r\n>           Column           |            Type             | Modifiers \r\n> ---------------------------+-----------------------------+-----------\r\n>  source_table              | text                        | \r\n>  validation_table          | text                        | \r\n>  model                     | text                        | \r\n>  model_info                | text                        | \r\n>  dependent_varname         | text                        | \r\n>  independent_varname       | text                        | \r\n>  model_arch_table          | text                        | \r\n>  model_selection_table     | text                        | \r\n>  automl_method             | text                        | \r\n>  automl_params             | text                        | \r\n>  random_state              | text                        | \r\n>  object_table              | text                        | \r\n>  use_gpus                  | boolean                     | \r\n>  metrics_compute_frequency | integer                     | \r\n>  name                      | text                        | \r\n>  description               | text                        | \r\n>  start_training_time       | timestamp without time zone | \r\n>  end_training_time         | timestamp without time zone | \r\n>  madlib_version            | text                        | \r\n>  num_classes               | integer                     | \r\n>  class_values              | text[]                      | \r\n>  dependent_vartype         | text                        | \r\n>  normalizing_const         | real                        | \r\n> ```\r\n\r\nOkay, in that case I suppose I used the summary table format used earlier in Hyperband (instead of the fit multiple one, which includes the metrics iters). \r\nI suppose the column can be added in the summary table generation function where its value is populated by the temp summary table from the fit multiple call. ","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/707400603/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/707404066","html_url":"https://github.com/apache/madlib/pull/518#issuecomment-707404066","issue_url":"https://api.github.com/repos/apache/madlib/issues/518","id":707404066,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzQwNDA2Ng==","user":{"login":"khannaekta","id":15749573,"node_id":"MDQ6VXNlcjE1NzQ5NTcz","avatar_url":"https://avatars.githubusercontent.com/u/15749573?v=4","gravatar_id":"","url":"https://api.github.com/users/khannaekta","html_url":"https://github.com/khannaekta","followers_url":"https://api.github.com/users/khannaekta/followers","following_url":"https://api.github.com/users/khannaekta/following{/other_user}","gists_url":"https://api.github.com/users/khannaekta/gists{/gist_id}","starred_url":"https://api.github.com/users/khannaekta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/khannaekta/subscriptions","organizations_url":"https://api.github.com/users/khannaekta/orgs","repos_url":"https://api.github.com/users/khannaekta/repos","events_url":"https://api.github.com/users/khannaekta/events{/privacy}","received_events_url":"https://api.github.com/users/khannaekta/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-12T23:56:45Z","updated_at":"2020-10-12T23:56:45Z","author_association":"CONTRIBUTOR","body":"@Advitya17 Thanks for looking into this! Yes, that is one of the ways we can do to fix the times. I will go ahead and make the necessary changes.\r\n","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/707404066/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":1,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/707411308","html_url":"https://github.com/apache/madlib/pull/518#issuecomment-707411308","issue_url":"https://api.github.com/repos/apache/madlib/issues/518","id":707411308,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzQxMTMwOA==","user":{"login":"khannaekta","id":15749573,"node_id":"MDQ6VXNlcjE1NzQ5NTcz","avatar_url":"https://avatars.githubusercontent.com/u/15749573?v=4","gravatar_id":"","url":"https://api.github.com/users/khannaekta","html_url":"https://github.com/khannaekta","followers_url":"https://api.github.com/users/khannaekta/followers","following_url":"https://api.github.com/users/khannaekta/following{/other_user}","gists_url":"https://api.github.com/users/khannaekta/gists{/gist_id}","starred_url":"https://api.github.com/users/khannaekta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/khannaekta/subscriptions","organizations_url":"https://api.github.com/users/khannaekta/orgs","repos_url":"https://api.github.com/users/khannaekta/repos","events_url":"https://api.github.com/users/khannaekta/events{/privacy}","received_events_url":"https://api.github.com/users/khannaekta/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-13T00:21:31Z","updated_at":"2020-10-13T00:21:31Z","author_association":"CONTRIBUTOR","body":"In the current implementation `metrics_iters` is not being populated for hyperopt. \r\n@fmcquillan99 I can make the change to add it to the summary table as it is same for all the models or if we want to be consistent with the output for hyperband we can add it to the info table (it will be the same value for all the models though).","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/707411308/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/707417107","html_url":"https://github.com/apache/madlib/pull/518#issuecomment-707417107","issue_url":"https://api.github.com/repos/apache/madlib/issues/518","id":707417107,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzQxNzEwNw==","user":{"login":"fmcquillan99","id":10538173,"node_id":"MDQ6VXNlcjEwNTM4MTcz","avatar_url":"https://avatars.githubusercontent.com/u/10538173?v=4","gravatar_id":"","url":"https://api.github.com/users/fmcquillan99","html_url":"https://github.com/fmcquillan99","followers_url":"https://api.github.com/users/fmcquillan99/followers","following_url":"https://api.github.com/users/fmcquillan99/following{/other_user}","gists_url":"https://api.github.com/users/fmcquillan99/gists{/gist_id}","starred_url":"https://api.github.com/users/fmcquillan99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmcquillan99/subscriptions","organizations_url":"https://api.github.com/users/fmcquillan99/orgs","repos_url":"https://api.github.com/users/fmcquillan99/repos","events_url":"https://api.github.com/users/fmcquillan99/events{/privacy}","received_events_url":"https://api.github.com/users/fmcquillan99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-13T00:43:19Z","updated_at":"2020-10-13T00:44:44Z","author_association":"NONE","body":"Let's be consistent with the output for hyperband and add it to the info table, even if the value will be the same for all mst keys.  The table is small so that is not a problem and it may change in the future if we learn something new about how `metrics_iters` should be presented.\r\n ","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/707417107/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/712486086","html_url":"https://github.com/apache/madlib/pull/519#issuecomment-712486086","issue_url":"https://api.github.com/repos/apache/madlib/issues/519","id":712486086,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMjQ4NjA4Ng==","user":{"login":"fmcquillan99","id":10538173,"node_id":"MDQ6VXNlcjEwNTM4MTcz","avatar_url":"https://avatars.githubusercontent.com/u/10538173?v=4","gravatar_id":"","url":"https://api.github.com/users/fmcquillan99","html_url":"https://github.com/fmcquillan99","followers_url":"https://api.github.com/users/fmcquillan99/followers","following_url":"https://api.github.com/users/fmcquillan99/following{/other_user}","gists_url":"https://api.github.com/users/fmcquillan99/gists{/gist_id}","starred_url":"https://api.github.com/users/fmcquillan99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmcquillan99/subscriptions","organizations_url":"https://api.github.com/users/fmcquillan99/orgs","repos_url":"https://api.github.com/users/fmcquillan99/repos","events_url":"https://api.github.com/users/fmcquillan99/events{/privacy}","received_events_url":"https://api.github.com/users/fmcquillan99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-19T22:57:07Z","updated_at":"2020-10-19T22:57:07Z","author_association":"NONE","body":"Retesting items from above\r\n\r\n(0)\r\n```\r\nSELECT madlib.load_top_k_accuracy_function(\r\n    'test_custom_function_table',\r\n    10\r\n    );\r\n\r\n```\r\nproduces\r\n```\r\nSELECT id, name, description FROM test_custom_function_table1 ORDER BY id;\r\n id |       name       |       description        \r\n----+------------------+--------------------------\r\n  1 | top_10_accuracy  | returns top_10_accuracy\r\n```\r\nOK\r\n\r\n\r\n(2)\r\n```\r\nSELECT madlib.load_top_k_accuracy_function('custom_function_table',                                                                                                                                3);\r\nINFO:  Keras Custom Function: Added function 'top_3_accuracy' to 'custom_function_table' table\r\nCONTEXT:  PL/Python function \"load_top_k_accuracy_function\"\r\n load_top_k_accuracy_function \r\n------------------------------\r\n \r\n(1 row)\r\n\r\nTime: 1644.004 ms\r\n```\r\nOK\r\n\r\n(5)\r\ncommit below for user docs\r\n\r\n(6)\r\n```\r\nDROP TABLE IF EXISTS custom_function_table;\r\nSELECT madlib.load_top_k_accuracy_function('custom_function_table',\r\n                                           3);\r\nSELECT madlib.load_top_k_accuracy_function('custom_function_table',\r\n                                           10);\r\nSELECT id, name, description FROM custom_function_table ORDER BY id;\r\n```\r\nproduces\r\n```\r\n id |      name       |       description       \r\n----+-----------------+-------------------------\r\n  1 | top_3_accuracy  | returns top_3_accuracy\r\n  2 | top_10_accuracy | returns top_10_accuracy\r\n  ```\r\n OK","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/712486086/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/712504771","html_url":"https://github.com/apache/madlib/pull/519#issuecomment-712504771","issue_url":"https://api.github.com/repos/apache/madlib/issues/519","id":712504771,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMjUwNDc3MQ==","user":{"login":"fmcquillan99","id":10538173,"node_id":"MDQ6VXNlcjEwNTM4MTcz","avatar_url":"https://avatars.githubusercontent.com/u/10538173?v=4","gravatar_id":"","url":"https://api.github.com/users/fmcquillan99","html_url":"https://github.com/fmcquillan99","followers_url":"https://api.github.com/users/fmcquillan99/followers","following_url":"https://api.github.com/users/fmcquillan99/following{/other_user}","gists_url":"https://api.github.com/users/fmcquillan99/gists{/gist_id}","starred_url":"https://api.github.com/users/fmcquillan99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmcquillan99/subscriptions","organizations_url":"https://api.github.com/users/fmcquillan99/orgs","repos_url":"https://api.github.com/users/fmcquillan99/repos","events_url":"https://api.github.com/users/fmcquillan99/events{/privacy}","received_events_url":"https://api.github.com/users/fmcquillan99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-19T23:57:33Z","updated_at":"2020-10-19T23:57:33Z","author_association":"NONE","body":"LGTM","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/712504771/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/715643042","html_url":"https://github.com/apache/madlib/pull/518#issuecomment-715643042","issue_url":"https://api.github.com/repos/apache/madlib/issues/518","id":715643042,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNTY0MzA0Mg==","user":{"login":"fmcquillan99","id":10538173,"node_id":"MDQ6VXNlcjEwNTM4MTcz","avatar_url":"https://avatars.githubusercontent.com/u/10538173?v=4","gravatar_id":"","url":"https://api.github.com/users/fmcquillan99","html_url":"https://github.com/fmcquillan99","followers_url":"https://api.github.com/users/fmcquillan99/followers","following_url":"https://api.github.com/users/fmcquillan99/following{/other_user}","gists_url":"https://api.github.com/users/fmcquillan99/gists{/gist_id}","starred_url":"https://api.github.com/users/fmcquillan99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmcquillan99/subscriptions","organizations_url":"https://api.github.com/users/fmcquillan99/orgs","repos_url":"https://api.github.com/users/fmcquillan99/repos","events_url":"https://api.github.com/users/fmcquillan99/events{/privacy}","received_events_url":"https://api.github.com/users/fmcquillan99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-24T00:30:29Z","updated_at":"2020-10-24T00:30:29Z","author_association":"NONE","body":"(100)\r\nerror msg\r\n```\r\nmadlib=# SELECT madlib.madlib_keras_automl('iris_train_packed',                -- source table\r\nmadlib(#                                   'automl_output',                    -- model output table\r\nmadlib(#                                   'model_arch_library',               -- model architecture table\r\nmadlib(#                                   'automl_mst_table',                 -- model selection output table\r\nmadlib(#                                   ARRAY[1,2],                         -- model IDs\r\nmadlib(#                                   $${\r\nmadlib$#                                       'loss': ['categorical_crossentropy'], \r\nmadlib$#                                       'optimizer_params_list': [ \r\nmadlib$#                                           {'optimizer': ['Adam'],'lr': [0.001, 0.1, 'log']},\r\nmadlib$#                                           {'optimizer': ['RMSprop'],'lr': [0.001, 0.1, 'log']}\r\nmadlib$#                                       ],\r\nmadlib$#                                       'metrics': ['accuracy']\r\nmadlib$#                                   } $$,                               -- compile param grid\r\nmadlib(#                                   $${'batch_size': [4, 8], 'epochs': [1]}$$,  -- fit params grid\r\nmadlib(#                                   'hyperband',                        -- autoML method\r\nmadlib(#                                   'num_configs=6, num_iterations=3, algorithm=rand',  -- autoML params\r\nmadlib(#                                   NULL,                               -- random state\r\nmadlib(#                                   NULL,                               -- object table\r\nmadlib(#                                   FALSE,                              -- use GPUs\r\nmadlib(#                                   'iris_test_packed',                 -- validation table\r\nmadlib(#                                   1,                                  -- metrics compute freq\r\nmadlib(#                                   NULL,                               -- name\r\nmadlib(#                                   NULL);                              -- descr\r\nERROR:  ValueError: invalid literal for int() with base 10: 'rand' (plpython.c:5038)\r\nCONTEXT:  Traceback (most recent call last):\r\n  PL/Python function \"madlib_keras_automl\", line 23, in <module>\r\n    schedule_loader = madlib_keras_automl_hyperband.AutoMLHyperband(**globals())\r\n  PL/Python function \"madlib_keras_automl\", line 164, in __init__\r\n  PL/Python function \"madlib_keras_automl\", line 174, in validate_and_define_inputs\r\nPL/Python function \"madlib_keras_automl\"\r\n```\r\nthis message confused me for awhile till I realized I asked for hyperband but gave hyperopt params accidentally\r\n\r\n(101)\r\nerror msg\r\n```\r\nmadlib=# SELECT madlib.madlib_keras_automl('iris_train_packed',                -- source table\r\nmadlib(#                                   'automl_output',                    -- model output table\r\nmadlib(#                                   'model_arch_library',               -- model architecture table\r\nmadlib(#                                   'automl_mst_table',                 -- model selection output table\r\nmadlib(#                                   ARRAY[1,2],                         -- model IDs\r\nmadlib(#                                   $${\r\nmadlib$#                                       'loss': ['categorical_crossentropy'], \r\nmadlib$#                                       'optimizer_params_list': [ \r\nmadlib$#                                           {'optimizer': ['Adam'],'lr': [0.001, 0.1, 'log']},\r\nmadlib$#                                           {'optimizer': ['RMSprop'],'lr': [0.001, 0.1, 'log']}\r\nmadlib$#                                       ],\r\nmadlib$#                                       'metrics': ['accuracy']\r\nmadlib$#                                   } $$,                               -- compile param grid\r\nmadlib(#                                   $${'batch_size': [4, 8], 'epochs': [1]}$$,  -- fit params grid\r\nmadlib(#                                   'hyperopt',                        -- autoML method\r\nmadlib(#                                   'R=9, eta=3, skip_last=0',          -- autoML params\r\nmadlib(#                                   NULL,                               -- random state\r\nmadlib(#                                   NULL,                               -- object table\r\nmadlib(#                                   FALSE,                              -- use GPUs\r\nmadlib(#                                   'iris_test_packed',                 -- validation table\r\nmadlib(#                                   1,                                  -- metrics compute freq\r\nmadlib(#                                   NULL,                               -- name\r\nmadlib(#                                   NULL);                              -- descr\r\nERROR:  plpy.Error: madlib_keras_automl: skip_last is an invalid automl param (plpython.c:5038)\r\nCONTEXT:  Traceback (most recent call last):\r\n  PL/Python function \"madlib_keras_automl\", line 45, in <module>\r\n    schedule_loader = madlib_keras_automl_hyperopt.AutoMLHyperopt(**globals())\r\n  PL/Python function \"madlib_keras_automl\", line 69, in __init__\r\n  PL/Python function \"madlib_keras_automl\", line 115, in validate_and_define_inputs\r\nPL/Python function \"madlib_keras_automl\"\r\n```\r\nlikewise this could be improved if I asked for hyperopt but gave hyperband params accidentally.  Because skip_last is valid but only for hyberband.\r\n","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/715643042/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/716772313","html_url":"https://github.com/apache/madlib/pull/518#issuecomment-716772313","issue_url":"https://api.github.com/repos/apache/madlib/issues/518","id":716772313,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNjc3MjMxMw==","user":{"login":"fmcquillan99","id":10538173,"node_id":"MDQ6VXNlcjEwNTM4MTcz","avatar_url":"https://avatars.githubusercontent.com/u/10538173?v=4","gravatar_id":"","url":"https://api.github.com/users/fmcquillan99","html_url":"https://github.com/fmcquillan99","followers_url":"https://api.github.com/users/fmcquillan99/followers","following_url":"https://api.github.com/users/fmcquillan99/following{/other_user}","gists_url":"https://api.github.com/users/fmcquillan99/gists{/gist_id}","starred_url":"https://api.github.com/users/fmcquillan99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmcquillan99/subscriptions","organizations_url":"https://api.github.com/users/fmcquillan99/orgs","repos_url":"https://api.github.com/users/fmcquillan99/repos","events_url":"https://api.github.com/users/fmcquillan99/events{/privacy}","received_events_url":"https://api.github.com/users/fmcquillan99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-26T19:26:43Z","updated_at":"2020-10-26T19:26:43Z","author_association":"NONE","body":"(1) install of Hyperopt component\r\n- needs to be installed on master\r\n- is only needed if hyperopt is called (not if only hyperband is called)\r\n- I added a note to user docs (next commit)\r\n\r\n(2) detailed NOTICE and CONTEXT messages can be supressed\r\n- OK, supressed\r\n\r\n(3) Should not report _3 or _4 or whatever in messages since user does not know what these are.\r\n- OK, message fixed\r\n\r\n(4) (5) hyperopt is not learning\r\n- OK, learning now\r\n\r\n(6) correctly set number of workers\r\n- OK, computed correctly now\r\n\r\n(7)\r\n\r\n(8) confirm loss values reported to hyperopt for all configs (not best from group)\r\n- OK, confirmed\r\n\r\n(9) setting default values\r\n- OK, set properly now\r\n\r\n(10) param naming suggestions\r\n- OK, fixed naming \r\n\r\n(11) cumulative times\r\n```\r\n mst_key |                                                                            metrics_elapsed_time                                                                             \r\n---------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n       1 | {3.44599199295044,5.5086510181427,7.59378290176392,9.76283192634583,11.7568578720093,14.0877909660339,16.2628719806671,18.3627188205719,20.6051309108734,22.6256680488586}\r\n       2 | {3.64783596992493,5.74869298934937,7.73203301429749,9.90109395980835,11.9493429660797,14.2302348613739,16.4116108417511,18.5028810501099,20.7483429908752,22.9229199886322}\r\n       3 | {25.3283171653748,27.2733652591705,29.2196431159973,31.2333950996399,33.013738155365,35.0193402767181,36.8298072814941,38.8312292098999,40.8666622638702,42.6906530857086}\r\n       4 | {25.4672672748566,27.4201622009277,29.3609321117401,31.3780810832977,33.1518592834473,35.1660552024841,37.1421611309052,38.971488237381,41.0169200897217,42.8317811489105}\r\n       5 | {45.613331079483,47.5778069496155,49.7638850212097,51.9869689941406,53.9853930473328,56.2250180244446,58.5185329914093,60.7617180347443,63.0875821113586,65.1909580230713}\r\n       6 | {45.7591459751129,47.7180619239807,49.9061949253082,52.1345801353455,54.1592149734497,56.3740320205688,58.6804759502411,60.9120979309082,63.2361199855804,65.3321549892426}\r\n       7 | {68.48650598526,71.0383489131927,73.7156028747559,76.0485279560089,78.6191580295563,81.2393538951874,83.7727980613708,86.2238938808441,88.8117818832397,91.40256690979}\r\n       8 | {68.6526188850403,71.2017469406128,73.8855209350586,76.213299036026,78.8485488891602,81.4080820083618,83.9574830532074,86.3879079818726,88.9709119796753,91.6372621059418}\r\n       9 | {94.9169039726257,97.4595720767975,100.022624015808,102.602681159973,104.947999954224,107.506361961365,110.27393913269,112.921897172928,115.296147108078,117.905650138855}\r\n      10 | {95.0961761474609,97.620619058609,100.199231147766,102.778658151627,105.320446014404,107.670147180557,110.440493106842,113.101521015167,115.461306095123,118.067128181458}\r\n      11 | {121.154954195023,123.238182067871,125.558053016663,127.94621014595,130.058441162109,132.456755161285,134.789571046829,136.911457061768,139.302124023438,141.447726964951}\r\n      12 | {121.302850008011,123.383195161819,125.702442169189,128.096446990967,130.208800077438,132.607058048248,134.943905115128,137.053812026978,139.451186180115,141.589867115021}\r\n      13 | {144.590404987335,146.865453958511,148.973741054535,151.335968017578,153.698374986649,155.985013008118,158.293015003204,160.394205093384,162.702248096466,164.992741107941}\r\n      14 | {144.756483078003,147.041687965393,149.141814947128,151.50594997406,153.962126970291,156.153010129929,158.461601018906,160.565253019333,162.872231960297,165.163074016571}\r\n      15 | {168.281131982803,170.96831202507,173.619775056839,176.261294126511,178.772081136703,181.430242061615,184.221279144287,186.935801029205,189.439113140106,192.158553123474}\r\n      16 | {168.455712080002,171.14265704155,173.794762134552,176.440241098404,178.940042972565,181.715918064117,184.400903940201,187.127205133438,189.61900305748,192.334141969681}\r\n      17 | {195.59405207634,197.74609208107,200.189806938171,202.618988990784,204.730000972748,207.099671125412,209.533874988556,211.708842992783,214.096724033356,216.496123075485}\r\n      18 | {195.76095199585,197.90920996666,200.347979068756,202.780756950378,204.888078927994,207.249115943909,209.746890068054,211.860005140305,214.24716591835,216.653197050095}\r\n      19 | {219.868572473526,222.539808273315,225.132962465286,227.739342451096,230.226921319962,233.084603309631,235.675887346268,238.05983042717,240.733500480652,243.349875450134}\r\n      20 | {220.287011384964,222.718561410904,225.308660268784,227.940581321716,230.405136346817,233.260821342468,235.855934381485,238.236332416534,240.908479452133,243.594557285309}\r\n(20 rows)\r\n\r\n```\r\n- OK\r\n\r\n(12) metrics_iters missing from info table\r\n```\r\n\\d automl_output_info\r\n             Table \"public.automl_output_info\"\r\n          Column          |        Type        | Modifiers \r\n--------------------------+--------------------+-----------\r\n mst_key                  | integer            | not null\r\n model_id                 | integer            | \r\n compile_params           | text               | \r\n fit_params               | text               | \r\n model_type               | text               | \r\n model_size               | double precision   | \r\n metrics_elapsed_time     | double precision[] | \r\n metrics_type             | text[]             | \r\n loss_type                | text               | \r\n training_metrics_final   | double precision   | \r\n training_loss_final      | double precision   | \r\n training_metrics         | double precision[] | \r\n training_loss            | double precision[] | \r\n validation_metrics_final | double precision   | \r\n validation_loss_final    | double precision   | \r\n validation_metrics       | double precision[] | \r\n validation_loss          | double precision[] | \r\n metrics_iters            | integer[]          | \r\n```\r\n- OK, added","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/716772313/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/716773016","html_url":"https://github.com/apache/madlib/pull/518#issuecomment-716773016","issue_url":"https://api.github.com/repos/apache/madlib/issues/518","id":716773016,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNjc3MzAxNg==","user":{"login":"fmcquillan99","id":10538173,"node_id":"MDQ6VXNlcjEwNTM4MTcz","avatar_url":"https://avatars.githubusercontent.com/u/10538173?v=4","gravatar_id":"","url":"https://api.github.com/users/fmcquillan99","html_url":"https://github.com/fmcquillan99","followers_url":"https://api.github.com/users/fmcquillan99/followers","following_url":"https://api.github.com/users/fmcquillan99/following{/other_user}","gists_url":"https://api.github.com/users/fmcquillan99/gists{/gist_id}","starred_url":"https://api.github.com/users/fmcquillan99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmcquillan99/subscriptions","organizations_url":"https://api.github.com/users/fmcquillan99/orgs","repos_url":"https://api.github.com/users/fmcquillan99/repos","events_url":"https://api.github.com/users/fmcquillan99/events{/privacy}","received_events_url":"https://api.github.com/users/fmcquillan99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-26T19:28:14Z","updated_at":"2020-10-26T19:32:37Z","author_association":"NONE","body":"![image](https://user-images.githubusercontent.com/10538173/97219034-b1254b80-1786-11eb-898b-2ce559e2f71e.png)\r\n cumulative time looks OK, x axis is time, just labeled wrong","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/716773016/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/716774952","html_url":"https://github.com/apache/madlib/pull/518#issuecomment-716774952","issue_url":"https://api.github.com/repos/apache/madlib/issues/518","id":716774952,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNjc3NDk1Mg==","user":{"login":"fmcquillan99","id":10538173,"node_id":"MDQ6VXNlcjEwNTM4MTcz","avatar_url":"https://avatars.githubusercontent.com/u/10538173?v=4","gravatar_id":"","url":"https://api.github.com/users/fmcquillan99","html_url":"https://github.com/fmcquillan99","followers_url":"https://api.github.com/users/fmcquillan99/followers","following_url":"https://api.github.com/users/fmcquillan99/following{/other_user}","gists_url":"https://api.github.com/users/fmcquillan99/gists{/gist_id}","starred_url":"https://api.github.com/users/fmcquillan99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmcquillan99/subscriptions","organizations_url":"https://api.github.com/users/fmcquillan99/orgs","repos_url":"https://api.github.com/users/fmcquillan99/repos","events_url":"https://api.github.com/users/fmcquillan99/events{/privacy}","received_events_url":"https://api.github.com/users/fmcquillan99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-26T19:32:02Z","updated_at":"2020-10-26T19:32:44Z","author_association":"NONE","body":"![image](https://user-images.githubusercontent.com/10538173/97219402-314bb100-1787-11eb-8e6b-fbfbe5b2666b.png)\r\nthis one a bit easier to read, x axis is time, just labeled wrong","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/716774952/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/716907845","html_url":"https://github.com/apache/madlib/pull/518#issuecomment-716907845","issue_url":"https://api.github.com/repos/apache/madlib/issues/518","id":716907845,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNjkwNzg0NQ==","user":{"login":"fmcquillan99","id":10538173,"node_id":"MDQ6VXNlcjEwNTM4MTcz","avatar_url":"https://avatars.githubusercontent.com/u/10538173?v=4","gravatar_id":"","url":"https://api.github.com/users/fmcquillan99","html_url":"https://github.com/fmcquillan99","followers_url":"https://api.github.com/users/fmcquillan99/followers","following_url":"https://api.github.com/users/fmcquillan99/following{/other_user}","gists_url":"https://api.github.com/users/fmcquillan99/gists{/gist_id}","starred_url":"https://api.github.com/users/fmcquillan99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmcquillan99/subscriptions","organizations_url":"https://api.github.com/users/fmcquillan99/orgs","repos_url":"https://api.github.com/users/fmcquillan99/repos","events_url":"https://api.github.com/users/fmcquillan99/events{/privacy}","received_events_url":"https://api.github.com/users/fmcquillan99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-27T00:54:55Z","updated_at":"2020-10-27T00:54:55Z","author_association":"NONE","body":"(100) and (101)\r\n- error messages look OK now\r\n\r\nLGTM after merge conflicts fixed","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/716907845/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":1,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/717494198","html_url":"https://github.com/apache/madlib/pull/523#issuecomment-717494198","issue_url":"https://api.github.com/repos/apache/madlib/issues/523","id":717494198,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNzQ5NDE5OA==","user":{"login":"reductionista","id":2644901,"node_id":"MDQ6VXNlcjI2NDQ5MDE=","avatar_url":"https://avatars.githubusercontent.com/u/2644901?v=4","gravatar_id":"","url":"https://api.github.com/users/reductionista","html_url":"https://github.com/reductionista","followers_url":"https://api.github.com/users/reductionista/followers","following_url":"https://api.github.com/users/reductionista/following{/other_user}","gists_url":"https://api.github.com/users/reductionista/gists{/gist_id}","starred_url":"https://api.github.com/users/reductionista/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/reductionista/subscriptions","organizations_url":"https://api.github.com/users/reductionista/orgs","repos_url":"https://api.github.com/users/reductionista/repos","events_url":"https://api.github.com/users/reductionista/events{/privacy}","received_events_url":"https://api.github.com/users/reductionista/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-27T19:48:38Z","updated_at":"2020-10-27T19:48:38Z","author_association":"CONTRIBUTOR","body":"We will test this a bit more before merging.","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/717494198/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/730717369","html_url":"https://github.com/apache/madlib/pull/524#issuecomment-730717369","issue_url":"https://api.github.com/repos/apache/madlib/issues/524","id":730717369,"node_id":"MDEyOklzc3VlQ29tbWVudDczMDcxNzM2OQ==","user":{"login":"fmcquillan99","id":10538173,"node_id":"MDQ6VXNlcjEwNTM4MTcz","avatar_url":"https://avatars.githubusercontent.com/u/10538173?v=4","gravatar_id":"","url":"https://api.github.com/users/fmcquillan99","html_url":"https://github.com/fmcquillan99","followers_url":"https://api.github.com/users/fmcquillan99/followers","following_url":"https://api.github.com/users/fmcquillan99/following{/other_user}","gists_url":"https://api.github.com/users/fmcquillan99/gists{/gist_id}","starred_url":"https://api.github.com/users/fmcquillan99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmcquillan99/subscriptions","organizations_url":"https://api.github.com/users/fmcquillan99/orgs","repos_url":"https://api.github.com/users/fmcquillan99/repos","events_url":"https://api.github.com/users/fmcquillan99/events{/privacy}","received_events_url":"https://api.github.com/users/fmcquillan99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-20T00:15:10Z","updated_at":"2020-11-20T00:15:10Z","author_association":"NONE","body":"Does not work for autoML, but maybe that is OK, maybe we do not need to support for autoML\r\n```\r\nSELECT madlib.madlib_keras_automl('cifar_10_train_data_packed_allseg', \r\n                                  'automl_cifar10_output', \r\n                                  'model_arch_library', \r\n                                  'automl_cifar10_mst_table',\r\n                                  ARRAY[2], \r\n                                  $${'loss': ['categorical_crossentropy'], \r\n                                     'optimizer_params_list': [ \r\n                                         {'optimizer': ['Adam'],'lr': [0.0001, 0.01, 'log']},\r\n                                         {'optimizer': ['RMSprop'],'lr': [0.0001, 0.01, 'log'], 'decay': [1.0e-7, 1.0e-5, 'log']},\r\n                                         {'optimizer': ['SGD'],'lr': [0.0001, 0.01, 'log'], 'momentum': [0.9, 0.99,'log_near_one']}],\r\n                                     'metrics':['accuracy']}$$, \r\n                                  $${'batch_size': [128], 'epochs': [1], callbacks=[TensorBoard(log_dir=\"/tmp/tensorflow/scalars\")]}$$,\r\n                                  'hyperband', \r\n                                  'R=9, eta=3, skip_last=0',\r\n                                  NULL,                  -- random state\r\n                                  NULL,                  -- object table\r\n                                  FALSE,                 -- use GPUs\r\n                                  'cifar_10_test_data_packed_allseg', -- validation table\r\n                                  1,                     -- metrics compute freq\r\n                                  NULL,                  -- name\r\n                                  NULL);                 -- descr\r\n\r\nERROR:  plpy.Error: Invalid syntax in 'fit_params_dict' (plpython.c:5038)\r\nCONTEXT:  Traceback (most recent call last):\r\n  PL/Python function \"madlib_keras_automl\", line 23, in <module>\r\n    schedule_loader = madlib_keras_automl_hyperband.AutoMLHyperband(**globals())\r\n  PL/Python function \"madlib_keras_automl\", line 167, in __init__\r\n  PL/Python function \"madlib_keras_automl\", line 216, in find_hyperband_config\r\n  PL/Python function \"madlib_keras_automl\", line 42, in wrapper\r\n  PL/Python function \"madlib_keras_automl\", line 307, in __init__\r\nPL/Python function \"madlib_keras_automl\"\r\n```","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/730717369/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/731350733","html_url":"https://github.com/apache/madlib/pull/525#issuecomment-731350733","issue_url":"https://api.github.com/repos/apache/madlib/issues/525","id":731350733,"node_id":"MDEyOklzc3VlQ29tbWVudDczMTM1MDczMw==","user":{"login":"fmcquillan99","id":10538173,"node_id":"MDQ6VXNlcjEwNTM4MTcz","avatar_url":"https://avatars.githubusercontent.com/u/10538173?v=4","gravatar_id":"","url":"https://api.github.com/users/fmcquillan99","html_url":"https://github.com/fmcquillan99","followers_url":"https://api.github.com/users/fmcquillan99/followers","following_url":"https://api.github.com/users/fmcquillan99/following{/other_user}","gists_url":"https://api.github.com/users/fmcquillan99/gists{/gist_id}","starred_url":"https://api.github.com/users/fmcquillan99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmcquillan99/subscriptions","organizations_url":"https://api.github.com/users/fmcquillan99/orgs","repos_url":"https://api.github.com/users/fmcquillan99/repos","events_url":"https://api.github.com/users/fmcquillan99/events{/privacy}","received_events_url":"https://api.github.com/users/fmcquillan99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-20T18:57:25Z","updated_at":"2020-11-20T18:57:25Z","author_association":"NONE","body":"(1)\r\ninitial tests for functionality - keras_fit()\r\n\r\n```\r\nDROP TABLE IF EXISTS cifar_10_model, cifar_10_model_summary;\r\nSELECT madlib.madlib_keras_fit('cifar_10_train_data_packed_allseg',    -- source table\r\n                               'cifar_10_model',                -- model output table\r\n                               'model_arch_library',            -- model arch table\r\n                                1,                              -- model arch id\r\n                                $$ loss='categorical_crossentropy', optimizer='rmsprop(lr=0.0001, decay=1e-6)', metrics=['accuracy']$$,  -- compile_params\r\n                                $$ batch_size=32, epochs=3 $$,  -- fit_params\r\n                                3,                              -- num_iterations\r\n                                NULL,                          -- use GPUs\r\n                                'cifar_10_test_data_packed_allseg',    -- validation dataset \r\n                                1                               -- metrics compute frequency \r\n                              ); \r\n```\r\nproduces warning:\r\n\r\n```\r\nWARNING:  This version of tensorflow does not support XLA auto-cluster JIT optimization.  HINT:  upgrading tensorflow may improve performance.  (seg0 slice1 10.128.0.41:40000 pid=6270)\r\nCONTEXT:  PL/Python function \"fit_transition\"\r\nWARNING:  This version of tensorflow does not support XLA auto-cluster JIT optimization.  HINT:  upgrading tensorflow may improve performance.  (seg1 slice1 10.128.0.41:40001 pid=6271)\r\nCONTEXT:  PL/Python function \"fit_transition\"\r\n```\r\n\r\nWhat does user need to do to enable XLA?  I am on TF 1.13.1 currently.\r\n\r\nOtherwise this ran and also warm start seemed to work.\r\n\r\n\r\n(2)\r\ninitial tests for functionality - keras_fit_multiple_model()\r\n\r\nfirst I started with single segment:\r\n```\r\nSELECT __dist_key__, independent_var_shape, dependent_var_shape, buffer_id FROM cifar_10_train_data_packed ORDER BY __dist_key__;\r\n __dist_key__ | independent_var_shape | dependent_var_shape | buffer_id \r\n--------------+-----------------------+---------------------+-----------\r\n            1 | {16667,32,32,3}       | {16667,10}          |         0\r\n            1 | {16666,32,32,3}       | {16666,10}          |         2\r\n            1 | {16667,32,32,3}       | {16667,10}          |         1\r\n(3 rows)\r\n\r\nSELECT __dist_key__, independent_var_shape, dependent_var_shape, buffer_id FROM cifar_10_test_data_packed ORDER BY __dist_key__;\r\n __dist_key__ | independent_var_shape | dependent_var_shape | buffer_id \r\n--------------+-----------------------+---------------------+-----------\r\n            1 | {10000,32,32,3}       | {10000,10}          |         0\r\n(1 row)\r\n```\r\n\r\nrun multi fit:\r\n```\r\nDROP TABLE IF EXISTS cifar10_multi_model, cifar10_multi_model_summary, cifar10_multi_model_info;\r\nSELECT madlib.madlib_keras_fit_multiple_model('cifar_10_train_data_packed',    -- source_table\r\n                                              'cifar10_multi_model',     -- model_output_table\r\n                                              'mst_table',               -- model_selection_table\r\n                                               3,                       -- num_iterations\r\n                                               NULL,                     -- use gpus\r\n                                              'cifar_10_test_data_packed',      -- validation dataset\r\n                                               1,                         -- metrics compute frequency\r\n                                               NULL,                      -- warm_start\r\n                                               'me',\r\n                                               'this is a test run'\r\n                                             );\r\n```\r\n\r\nproduces error:\r\n```\r\nERROR:  plpy.Error: madlib_keras_fit_multiple_model error: No GPUs configured on hosts. (plpython.c:5038)\r\nCONTEXT:  Traceback (most recent call last):\r\n  PL/Python function \"madlib_keras_fit_multiple_model\", line 23, in <module>\r\n    fit_obj = madlib_keras_fit_multiple_model.FitMultipleModel(**globals())\r\n  PL/Python function \"madlib_keras_fit_multiple_model\", line 147, in __init__\r\n  PL/Python function \"madlib_keras_fit_multiple_model\", line 295, in get_accessible_gpus_for_seg\r\nPL/Python function \"madlib_keras_fit_multiple_model\"\r\n\r\n```\r\n\r\nso it looks like `use gpus=NULL` is now defaulting to `TRUE` but it should default to `FALSE` i.e., CPUs.  It used to default to CPUs.\r\n\r\n\r\n(3)\r\ninitial tests for functionality - keras_fit_multiple_model()\r\n\r\nnext I used 2 segments:\r\n```\r\nSELECT __dist_key__, independent_var_shape, dependent_var_shape, buffer_id FROM cifar_10_train_data_packed_allseg ORDER BY __dist_key__;\r\n __dist_key__ | independent_var_shape | dependent_var_shape | buffer_id \r\n--------------+-----------------------+---------------------+-----------\r\n            0 | {12500,32,32,3}       | {12500,10}          |         3\r\n            0 | {12500,32,32,3}       | {12500,10}          |         1\r\n            1 | {12500,32,32,3}       | {12500,10}          |         2\r\n            1 | {12500,32,32,3}       | {12500,10}          |         0\r\n(4 rows)\r\n\r\nSELECT __dist_key__, independent_var_shape, dependent_var_shape, buffer_id FROM cifar_10_test_data_packed_allseg ORDER BY __dist_key__;\r\n __dist_key__ | independent_var_shape | dependent_var_shape | buffer_id \r\n--------------+-----------------------+---------------------+-----------\r\n            0 | {5000,32,32,3}        | {5000,10}           |         1\r\n            1 | {5000,32,32,3}        | {5000,10}           |         0\r\n(2 rows)\r\n```\r\n\r\nrun multi fit:\r\n```\r\nDROP TABLE IF EXISTS cifar10_multi_model, cifar10_multi_model_summary, cifar10_multi_model_info;\r\nSELECT madlib.madlib_keras_fit_multiple_model('cifar_10_train_data_packed_allseg',    -- source_table\r\n                                              'cifar10_multi_model',     -- model_output_table\r\n                                              'mst_table',               -- model_selection_table\r\n                                               3,                       -- num_iterations\r\n                                               NULL,                     -- use gpus\r\n                                              'cifar_10_test_data_packed_allseg',      -- validation dataset\r\n                                               1,                         -- metrics compute frequency\r\n                                               NULL,                      -- warm_start\r\n                                               'me',\r\n                                               'this is a test run'\r\n                                             );\r\n```\r\n\r\nwhich produced error:\r\n```\r\nERROR:  plpy.SPIError: PRIMARY KEY and DISTRIBUTED BY definitions incompatible\r\nHINT:  When there is both a PRIMARY KEY, and a DISTRIBUTED BY clause, the DISTRIBUTED BY clause must be equal to or a left-subset of the PRIMARY KEY\r\nCONTEXT:  Traceback (most recent call last):\r\n  PL/Python function \"madlib_keras_fit_multiple_model\", line 24, in <module>\r\n    fit_obj.fit_multiple_model()\r\n  PL/Python function \"madlib_keras_fit_multiple_model\", line 241, in fit_multiple_model\r\n  PL/Python function \"madlib_keras_fit_multiple_model\", line 509, in init_model_output_tbl\r\nPL/Python function \"madlib_keras_fit_multiple_model\"\r\n```\r\n\r\nI have also seen this error when running on a single segment.","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/731350733/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/732492520","html_url":"https://github.com/apache/madlib/pull/525#issuecomment-732492520","issue_url":"https://api.github.com/repos/apache/madlib/issues/525","id":732492520,"node_id":"MDEyOklzc3VlQ29tbWVudDczMjQ5MjUyMA==","user":{"login":"reductionista","id":2644901,"node_id":"MDQ6VXNlcjI2NDQ5MDE=","avatar_url":"https://avatars.githubusercontent.com/u/2644901?v=4","gravatar_id":"","url":"https://api.github.com/users/reductionista","html_url":"https://github.com/reductionista","followers_url":"https://api.github.com/users/reductionista/followers","following_url":"https://api.github.com/users/reductionista/following{/other_user}","gists_url":"https://api.github.com/users/reductionista/gists{/gist_id}","starred_url":"https://api.github.com/users/reductionista/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/reductionista/subscriptions","organizations_url":"https://api.github.com/users/reductionista/orgs","repos_url":"https://api.github.com/users/reductionista/repos","events_url":"https://api.github.com/users/reductionista/events{/privacy}","received_events_url":"https://api.github.com/users/reductionista/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-23T23:51:46Z","updated_at":"2020-11-24T00:07:57Z","author_association":"CONTRIBUTOR","body":"Thanks for testing it out Frank!\r\n\r\nYou're the first to test this on with tensorflow 1.13, and based on one of the errors you're seeing, I'm guessing you're also the first to test it with gpdb5.  I only tested it on gpdb6 and postgres.\r\n\r\n> WARNING:  This version of tensorflow does not support XLA auto-cluster JIT optimization.  HINT:  upgrading tensorflow may improve performance.  (seg1 slice1 10.128.0.41:40001 pid=6271)\r\n> CONTEXT:  PL/Python function \"fit_transition\"\r\n> ```\r\n> \r\n> What does user need to do to enable XLA? I am on TF 1.13.1 currently.\r\n\r\nNothing, probably just need to upgrade to TF 1.14.  I should add the specific minimum version requirement in the warning message.  I think it was added in 1.14 but I've only used 1.10 and 1.14, so I'll need to confirm that.  Could also be that it's been in there for a while, and they just changed how you access it.  I'll look both of those up, and also run some more comprehensive performance tests to see how much of a difference it actually makes and in what kind of setups.  If it looks like it's not helping much anyway (even though the TF docs say it should) then we can get rid of this message... or maybe even not bother to enable it.  I figure if it does give better performance consistently across models, then we may as well let the user know there's an easy way to get that, without having to tune any parameters or upgrade hardware.  Would also be important to know if there are any cases where it might hurt performance.\r\n \r\n> ERROR:  plpy.Error: madlib_keras_fit_multiple_model error: No GPUs configured on hosts. (plpython.c:5038)\r\n> CONTEXT:  Traceback (most recent call last):\r\n>   PL/Python function \"madlib_keras_fit_multiple_model\", line 23, in <module>\r\n>     fit_obj = madlib_keras_fit_multiple_model.FitMultipleModel(**globals())\r\n>   PL/Python function \"madlib_keras_fit_multiple_model\", line 147, in __init__\r\n>   PL/Python function \"madlib_keras_fit_multiple_model\", line 295, in get_accessible_gpus_for_seg\r\n> PL/Python function \"madlib_keras_fit_multiple_model\"\r\n> ```\r\n> \r\n> so it looks like `use gpus=NULL` is now defaulting to `TRUE` but it should default to `FALSE` i.e., CPUs. It used to default to CPUs.\r\n\r\nGood catch!  For some reason, I get a different error when I tried to reproduce this ( about using BOOLEAN::None in a query).  But I think I see the cause of it--fixing.  I thought we had some dev-check tests for this, will add one if we don't.\r\n\r\n> ```\r\n> ERROR:  plpy.SPIError: PRIMARY KEY and DISTRIBUTED BY definitions incompatible\r\n> HINT:  When there is both a PRIMARY KEY, and a DISTRIBUTED BY clause, the DISTRIBUTED BY clause must be equal to or a left-subset of the PRIMARY KEY\r\n> CONTEXT:  Traceback (most recent call last):\r\n>   PL/Python function \"madlib_keras_fit_multiple_model\", line 24, in <module>\r\n>     fit_obj.fit_multiple_model()\r\n>   PL/Python function \"madlib_keras_fit_multiple_model\", line 241, in fit_multiple_model\r\n>   PL/Python function \"madlib_keras_fit_multiple_model\", line 509, in init_model_output_tbl\r\n> PL/Python function \"madlib_keras_fit_multiple_model\"\r\n> ```\r\n> \r\n> I have also seen this error when running on a single segment.\r\n\r\nInteresting!  Looks like this was due to an unnecessarily strict check in the gpdb5 server code, where it required a specific order for the keys in the PRIMARY KEY constraint.  The server team has fixed that in gpdb6:\r\nhttps://github.com/greenplum-db/gpdb/commit/e572af54e4255d501d261d51d32e1f3d3cf4b9c9\r\n\r\nI can't recall for sure if we decided we care about supporting deep learning in gpdb5 for this release.  But since it's an easy fix, I'll just reverse the order of the keys so that it works on both.","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/732492520/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/736941725","html_url":"https://github.com/apache/madlib/pull/525#issuecomment-736941725","issue_url":"https://api.github.com/repos/apache/madlib/issues/525","id":736941725,"node_id":"MDEyOklzc3VlQ29tbWVudDczNjk0MTcyNQ==","user":{"login":"fmcquillan99","id":10538173,"node_id":"MDQ6VXNlcjEwNTM4MTcz","avatar_url":"https://avatars.githubusercontent.com/u/10538173?v=4","gravatar_id":"","url":"https://api.github.com/users/fmcquillan99","html_url":"https://github.com/fmcquillan99","followers_url":"https://api.github.com/users/fmcquillan99/followers","following_url":"https://api.github.com/users/fmcquillan99/following{/other_user}","gists_url":"https://api.github.com/users/fmcquillan99/gists{/gist_id}","starred_url":"https://api.github.com/users/fmcquillan99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmcquillan99/subscriptions","organizations_url":"https://api.github.com/users/fmcquillan99/orgs","repos_url":"https://api.github.com/users/fmcquillan99/repos","events_url":"https://api.github.com/users/fmcquillan99/events{/privacy}","received_events_url":"https://api.github.com/users/fmcquillan99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-02T02:13:32Z","updated_at":"2020-12-02T02:13:32Z","author_association":"NONE","body":"\r\nre-testing...\r\n\r\n(1)\r\ninitial tests for functionality - keras_fit()\r\n\r\nAfter upgrading to TF 1.14 and re-running a test with XLA auto-cluster JIT optimization, I did not see the warning message anymore.  Also, I saw 30% training time improvement from 237 sec/iteration to 166 sec/iteration for the query, which is great.\r\n\r\n\r\n(2)\r\ninitial tests for functionality - keras_fit_multiple_model()\r\n\r\nfirst I started with single segment:\r\n\r\nThis query does not error on GPUs but still does error out after several minutes.  Also, please turn off the verbose output:\r\n```\r\nNOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index \"__madlib_temp_model_output49543509_1606874577_33655832___pkey\" for table \"__madlib_temp_model_output49543509_1606874577_33655832__\"\r\nCONTEXT:  SQL statement \"\r\n                                    CREATE TABLE __madlib_temp_model_output49543509_1606874577_33655832__\r\n                                    (mst_key INTEGER,\r\n                                     model_weights BYTEA,\r\n                                     model_arch JSON,\r\n                                     compile_params TEXT,\r\n                                     fit_params TEXT,\r\n                                     object_map BYTEA,\r\n                                     __dist_key__ INTEGER,\r\n                                     PRIMARY KEY (__dist_key__, mst_key)\r\n                                    )\r\n                                    DISTRIBUTED BY (__dist_key__)\r\n                                    \"\r\nPL/Python function \"madlib_keras_fit_multiple_model\"\r\nNOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index \"cifar10_multi_model_info_pkey\" for table \"cifar10_multi_model_info\"\r\nCONTEXT:  SQL statement \"\r\n            CREATE TABLE cifar10_multi_model_info (\r\n                mst_key INTEGER PRIMARY KEY,\r\n                model_id INTEGER,\r\n                compile_params TEXT,\r\n                fit_params TEXT,\r\n                model_type TEXT,\r\n                model_size DOUBLE PRECISION,\r\n                metrics_elapsed_time DOUBLE PRECISION[],\r\n                metrics_type TEXT[],\r\n                loss_type TEXT,\r\n                training_metrics_final DOUBLE PRECISION,\r\n                training_loss_final DOUBLE PRECISION,\r\n                training_metrics DOUBLE PRECISION[],\r\n                training_loss DOUBLE PRECISION[],\r\n                validation_metrics_final DOUBLE PRECISION,\r\n                validation_loss_final DOUBLE PRECISION,\r\n                validation_metrics DOUBLE PRECISION[],\r\n                validation_loss DOUBLE PRECISION[]\r\n           ) \"\r\nPL/Python function \"madlib_keras_fit_multiple_model\"\r\nNOTICE:  Table doesn't have 'DISTRIBUTED BY' clause -- Using column(s) named 'mst_key' as the Greenplum Database data distribution key for this table.\r\nHINT:  The 'DISTRIBUTED BY' clause determines the distribution of data. Make sure column(s) chosen are the optimal data distribution key to minimize skew.\r\nCONTEXT:  SQL statement \"\r\n                CREATE TABLE __madlib_temp_next_schedule42211658_1606874876_919189__ AS\r\n                    SELECT\r\n                        mst_key,\r\n                        model_id,\r\n                        __dist_key__ AS __prev_dist_key__,\r\n                        COALESCE(\r\n                            LEAD(__dist_key__)\r\n                                OVER(ORDER BY __dist_key__),\r\n                            FIRST_VALUE(__dist_key__)\r\n                                OVER(ORDER BY __dist_key__)\r\n                        ) AS __dist_key__\r\n                    FROM __madlib_temp_schedule9385959_1606874577_2407209__;\r\n            \"\r\nPL/Python function \"madlib_keras_fit_multiple_model\"\r\nERROR:  plpy.SPIError: AttributeError: '_TfDeviceCaptureOp' object has no attribute '_set_device_from_string' (plpython.c:5038)  (seg0 slice1 10.128.0.41:40000 pid=9278) (plpython.c:5038)\r\nDETAIL:  Message skipped due to incorrect encoding.\r\nCONTEXT:  Traceback (most recent call last):\r\n  PL/Python function \"madlib_keras_fit_multiple_model\", line 24, in <module>\r\n    fit_obj.fit_multiple_model()\r\n  PL/Python function \"madlib_keras_fit_multiple_model\", line 247, in fit_multiple_model\r\n  PL/Python function \"madlib_keras_fit_multiple_model\", line 288, in train_multiple_model\r\n  PL/Python function \"madlib_keras_fit_multiple_model\", line 929, in run_training\r\nPL/Python function \"madlib_keras_fit_multiple_model\"\r\n```\r\n\r\n(3)\r\ninitial tests for functionality - keras_fit_multiple_model()\r\n\r\nnext I used 2 segments:\r\n\r\nThis query errors out after several minutes.\r\n\r\n\r\n```\r\nNOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index \"__madlib_temp_model_output49543509_1606875004_33656259___pkey\" for table \"__madlib_temp_model_output49543509_1606875004_33656259__\"\r\nCONTEXT:  SQL statement \"\r\n                                    CREATE TABLE __madlib_temp_model_output49543509_1606875004_33656259__\r\n                                    (mst_key INTEGER,\r\n                                     model_weights BYTEA,\r\n                                     model_arch JSON,\r\n                                     compile_params TEXT,\r\n                                     fit_params TEXT,\r\n                                     object_map BYTEA,\r\n                                     __dist_key__ INTEGER,\r\n                                     PRIMARY KEY (__dist_key__, mst_key)\r\n                                    )\r\n                                    DISTRIBUTED BY (__dist_key__)\r\n                                    \"\r\nPL/Python function \"madlib_keras_fit_multiple_model\"\r\nNOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index \"cifar10_multi_model_info_pkey\" for table \"cifar10_multi_model_info\"\r\nCONTEXT:  SQL statement \"\r\n            CREATE TABLE cifar10_multi_model_info (\r\n                mst_key INTEGER PRIMARY KEY,\r\n                model_id INTEGER,\r\n                compile_params TEXT,\r\n                fit_params TEXT,\r\n                model_type TEXT,\r\n                model_size DOUBLE PRECISION,\r\n                metrics_elapsed_time DOUBLE PRECISION[],\r\n                metrics_type TEXT[],\r\n                loss_type TEXT,\r\n                training_metrics_final DOUBLE PRECISION,\r\n                training_loss_final DOUBLE PRECISION,\r\n                training_metrics DOUBLE PRECISION[],\r\n                training_loss DOUBLE PRECISION[],\r\n                validation_metrics_final DOUBLE PRECISION,\r\n                validation_loss_final DOUBLE PRECISION,\r\n                validation_metrics DOUBLE PRECISION[],\r\n                validation_loss DOUBLE PRECISION[]\r\n           ) \"\r\nPL/Python function \"madlib_keras_fit_multiple_model\"\r\nERROR:  plpy.SPIError: AttributeError: '_TfDeviceCaptureOp' object has no attribute '_set_device_from_string' (plpython.c:5038)  (seg0 slice1 10.128.0.41:40000 pid=9489) (plpython.c:5038)\r\nDETAIL:  :\r\nTraceback (most recent call last):\r\n  File \"<string>\", line 15, in __plpython_procedure_fit_transition_multiple_model_1572293\r\n  File \"/home/gpadmin/madlib/build/src/ports/greenplum/5/modules/deep_learning/madlib_keras.py\", line 545, in fit_transition\r\n    custom_function_map)\r\n  File \"/home/gpadmin/madlib/build/src/ports/greenplum/5/modules/deep_learning/madlib_keras.py\", line 90, in get_init_model_and_sess\r\n    segment_model = init_model(model_architecture, compile_params, custom_function_map)\r\n  File \"/home/gpadmin/madlib/build/src/ports/greenplum/5/modules/deep_learning/madlib_keras.py\", line 497, in init_model\r\n    segment_model = model_from_json(model_architecture)\r\n  File \"/home/gpadmin/.local/lib/python2.7/site-packages/keras/engine/saving.py\", line 492, in model_from_json\r\n    return deserialize(config, custom_objects=custom_objects)\r\n  File \"/home/gpadmin/.local/lib/python2.7/site-packages/keras/layers/__init__.py\", line 55, in deserialize\r\n    printable_module_name='layer')\r\n  File \"/home/gpadmin/.local/lib/python2.7/site-packages/keras/utils/generic_utils.py\", line 145, in deserialize_keras_object\r\n    list(custom_objects.items())))\r\n  File \"/home/gpadmin/.local/lib/python2.7/site-packages/keras/engine/sequential.py\", line 301, in from_config\r\n    model.add(layer)\r\n  File \"/home/gpadmin/.local/lib/python2.7/site-packages/keras/engine/sequential.py\", line 181, in add\r\n    output_tensor = layer(self.outputs[0])\r\n  File \"/home/gpadmin/.local/lib/python2.7/site-packages/keras/engine/base_layer.py\", line 457, in __call__\r\n    output = self.call(inputs, **kwargs)\r\n  File \"/home/gpadmin/.local/lib/python2.7/site-packages/keras/layers/normalization.py\", line 185, in call\r\n    epsilon=self.epsilon)\r\n  File \"/home/gpadmin/.local/lib/python2.7/site-packages/keras/backend/tensorflow_backend.py\", line 1858, in normalize_batch_in_training\r\n    if not _has_nchw_support() and list(reduction_axes) == [0, 2, 3]:\r\n  File \"/home/gpadmin/.local/lib/python2.7/site-packages/keras/backend/tensorflow_backend.py\", line 291, in _has_nchw_support\r\n    explicitly_on_cpu = _is_current_explicit_device('CPU')\r\n  File \"/home/gpadmin/.local/lib/python2.7/site-packages/keras/backend/tensorflow_backend.py\", line 266, in _is_current_explicit_device\r\n    device = _get_current_tf_device()\r\n  File \"/home/gpadmin/.local/lib/python2.7/site-packages/keras/backend/tensorflow_backend.py\", line 247, in _get_current_tf_device\r\n    g._apply_device_functions(op)\r\n  File \"/usr/local/greenplum-db/ext/python/lib/python2.7/site-packages/tensorflow/python/framework/ops.py\", line 4581, in _apply_device_functions\r\n    op._set_device_from_string(device_string)\r\nAttributeError: '_TfDeviceCaptureOp' object has no attribute '_set_device_from_string'\r\nTraceback (most recent call last):\r\n  PL/Python function \"fit_transition_multiple_model\", line 20, in <module>\r\n    raise e\r\nPL/Python function \"fit_transition_multiple_model\"\r\nCONTEXT:  Traceback (most recent call last):\r\n  PL/Python function \"madlib_keras_fit_multiple_model\", line 24, in <module>\r\n    fit_obj.fit_multiple_model()\r\n  PL/Python function \"madlib_keras_fit_multiple_model\", line 247, in fit_multiple_model\r\n  PL/Python function \"madlib_keras_fit_multiple_model\", line 288, in train_multiple_model\r\n  PL/Python function \"madlib_keras_fit_multiple_model\", line 929, in run_training\r\nPL/Python function \"madlib_keras_fit_multiple_model\"\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/736941725/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/737565309","html_url":"https://github.com/apache/madlib/pull/522#issuecomment-737565309","issue_url":"https://api.github.com/repos/apache/madlib/issues/522","id":737565309,"node_id":"MDEyOklzc3VlQ29tbWVudDczNzU2NTMwOQ==","user":{"login":"reductionista","id":2644901,"node_id":"MDQ6VXNlcjI2NDQ5MDE=","avatar_url":"https://avatars.githubusercontent.com/u/2644901?v=4","gravatar_id":"","url":"https://api.github.com/users/reductionista","html_url":"https://github.com/reductionista","followers_url":"https://api.github.com/users/reductionista/followers","following_url":"https://api.github.com/users/reductionista/following{/other_user}","gists_url":"https://api.github.com/users/reductionista/gists{/gist_id}","starred_url":"https://api.github.com/users/reductionista/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/reductionista/subscriptions","organizations_url":"https://api.github.com/users/reductionista/orgs","repos_url":"https://api.github.com/users/reductionista/repos","events_url":"https://api.github.com/users/reductionista/events{/privacy}","received_events_url":"https://api.github.com/users/reductionista/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-02T23:50:40Z","updated_at":"2020-12-02T23:50:40Z","author_association":"CONTRIBUTOR","body":"LGTM!","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/737565309/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/758288163","html_url":"https://github.com/apache/madlib/pull/523#issuecomment-758288163","issue_url":"https://api.github.com/repos/apache/madlib/issues/523","id":758288163,"node_id":"MDEyOklzc3VlQ29tbWVudDc1ODI4ODE2Mw==","user":{"login":"kaknikhil","id":11729207,"node_id":"MDQ6VXNlcjExNzI5MjA3","avatar_url":"https://avatars.githubusercontent.com/u/11729207?v=4","gravatar_id":"","url":"https://api.github.com/users/kaknikhil","html_url":"https://github.com/kaknikhil","followers_url":"https://api.github.com/users/kaknikhil/followers","following_url":"https://api.github.com/users/kaknikhil/following{/other_user}","gists_url":"https://api.github.com/users/kaknikhil/gists{/gist_id}","starred_url":"https://api.github.com/users/kaknikhil/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaknikhil/subscriptions","organizations_url":"https://api.github.com/users/kaknikhil/orgs","repos_url":"https://api.github.com/users/kaknikhil/repos","events_url":"https://api.github.com/users/kaknikhil/events{/privacy}","received_events_url":"https://api.github.com/users/kaknikhil/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-11T23:25:35Z","updated_at":"2021-01-11T23:25:35Z","author_association":"CONTRIBUTOR","body":"We successfully ran a test with 5 billion rows.  \r\n\r\n```\r\nDROP TABLE IF EXISTS tab1;\r\nCREATE TABLE tab1(\r\n     indep_var BIGINT,\r\n     dep_var BIGINT\r\n);\r\nINSERT INTO tab1 VALUES(generate_series(1,5000000000), generate_series(1,5000000000));\r\n\r\nDROP TABLE IF EXISTS test_linregr, test_linregr_summary;\r\nSELECT madlib.linregr_train( 'tab1',\r\n                             'test_linregr',\r\n                             'dep_var',\r\n                             'ARRAY[1, indep_var]'\r\n                           );\r\n linregr_train\r\n---------------\r\n\r\n(1 row)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/758288163/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/758300359","html_url":"https://github.com/apache/madlib/pull/527#issuecomment-758300359","issue_url":"https://api.github.com/repos/apache/madlib/issues/527","id":758300359,"node_id":"MDEyOklzc3VlQ29tbWVudDc1ODMwMDM1OQ==","user":{"login":"fmcquillan99","id":10538173,"node_id":"MDQ6VXNlcjEwNTM4MTcz","avatar_url":"https://avatars.githubusercontent.com/u/10538173?v=4","gravatar_id":"","url":"https://api.github.com/users/fmcquillan99","html_url":"https://github.com/fmcquillan99","followers_url":"https://api.github.com/users/fmcquillan99/followers","following_url":"https://api.github.com/users/fmcquillan99/following{/other_user}","gists_url":"https://api.github.com/users/fmcquillan99/gists{/gist_id}","starred_url":"https://api.github.com/users/fmcquillan99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmcquillan99/subscriptions","organizations_url":"https://api.github.com/users/fmcquillan99/orgs","repos_url":"https://api.github.com/users/fmcquillan99/repos","events_url":"https://api.github.com/users/fmcquillan99/events{/privacy}","received_events_url":"https://api.github.com/users/fmcquillan99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-12T00:00:00Z","updated_at":"2021-01-12T00:00:00Z","author_association":"NONE","body":"LGTM","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/758300359/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/761292406","html_url":"https://github.com/apache/madlib/pull/528#issuecomment-761292406","issue_url":"https://api.github.com/repos/apache/madlib/issues/528","id":761292406,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MTI5MjQwNg==","user":{"login":"fmcquillan99","id":10538173,"node_id":"MDQ6VXNlcjEwNTM4MTcz","avatar_url":"https://avatars.githubusercontent.com/u/10538173?v=4","gravatar_id":"","url":"https://api.github.com/users/fmcquillan99","html_url":"https://github.com/fmcquillan99","followers_url":"https://api.github.com/users/fmcquillan99/followers","following_url":"https://api.github.com/users/fmcquillan99/following{/other_user}","gists_url":"https://api.github.com/users/fmcquillan99/gists{/gist_id}","starred_url":"https://api.github.com/users/fmcquillan99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmcquillan99/subscriptions","organizations_url":"https://api.github.com/users/fmcquillan99/orgs","repos_url":"https://api.github.com/users/fmcquillan99/repos","events_url":"https://api.github.com/users/fmcquillan99/events{/privacy}","received_events_url":"https://api.github.com/users/fmcquillan99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-16T01:57:30Z","updated_at":"2021-01-16T01:59:21Z","author_association":"NONE","body":"(1)\r\nmaster shows bug\r\n```\r\nDROP TABLE IF EXISTS automl_output, automl_output_info, automl_output_summary, automl_mst_table, automl_mst_table_summary;\r\n\r\nSELECT madlib.madlib_keras_automl('iris_train_packed',                -- source table\r\n                                  'automl_output',                    -- model output table\r\n                                  'model_arch_library',               -- model architecture table\r\n                                  'automl_mst_table',                 -- model selection output table\r\n                                  ARRAY[1,2],                         -- model IDs\r\n                                  $${\r\n                                      'loss': ['categorical_crossentropy'], \r\n                                      'optimizer_params_list': [ \r\n                                          {'optimizer': ['Adam'],'lr': [0.001, 0.1, 'log']},\r\n                                          {'optimizer': ['RMSprop'],'lr': [0.001, 0.1, 'log']}\r\n                                      ],\r\n                                      'metrics': ['accuracy']\r\n                                  } $$,                               -- compile param grid\r\n                                  $${'batch_size': [4, 8], 'epochs': [1]}$$,  -- fit params grid\r\n                                  'hyperband',                        -- autoML method\r\n                                  'R=9, eta=3, skip_last=0',          -- autoML params\r\n                                  NULL,                               -- random state\r\n                                  NULL,                               -- object table\r\n                                  FALSE,                              -- use GPUs\r\n                                  'iris_test_packed',                 -- validation table\r\n                                  1,                                  -- metrics compute freq\r\n                                  NULL,                               -- name\r\n                                  NULL);                              -- descr\r\nselect mst_key, metrics_iters, metrics_elapsed_time from automl_output_info order by mst_key, metrics_iters;\r\n\r\n mst_key |          metrics_iters          |                                                                                                     metrics_elapsed_time                                                                                                      \r\n---------+---------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n       1 | {1}                             | {11.9657690525055}\r\n       2 | {1,2,3,4}                       | {11.2435529232025,7.15870094299316,13.9523301124573,20.7438840866089}\r\n       3 | {1}                             | {11.0448019504547}\r\n       4 | {1}                             | {10.6117079257965}\r\n       5 | {1}                             | {11.5615530014038}\r\n       6 | {1}                             | {12.3658618927002}\r\n       7 | {1,2,3,4,5,6,7,8,9,10,11,12,13} | {12.1693890094757,6.33618497848511,13.3471310138702,20.1482579708099,6.07377481460571,12.4327578544617,18.6241388320923,24.763916015625,31.0342478752136,37.2289469242096,43.5491759777069,49.7643358707428,55.9758470058441}\r\n       8 | {1,2,3,4}                       | {11.7585899829865,6.14086508750916,13.1444580554962,19.9498901367188}\r\n       9 | {1}                             | {10.8477530479431}\r\n      10 | {2,3,4}                         | {6.53312110900879,13.5493569374084,20.3438241481781}\r\n      11 | {2,3,4,5,6,7,8,9,10,11,12,13}   | {5.94354104995728,12.804829120636,19.7415940761566,5.19919085502625,11.5645568370819,17.7508308887482,23.8869698047638,30.0048508644104,36.2117488384247,42.4137489795685,48.7213318347931,54.9328229427338}\r\n      12 | {2,3,4}                         | {6.87433815002441,13.7501399517059,20.5427489280701}\r\n      13 | {5,6,7,8,9,10,11,12,13}         | {5.63267993927002,11.9994189739227,18.1830978393555,24.3246037960052,30.4504268169403,36.6406087875366,43.0894849300385,49.3178629875183,55.5346329212189}\r\n      14 | {5,6,7,8,9,10,11,12,13}         | {5.43539190292358,11.8002669811249,17.9837338924408,24.1173579692841,30.2419698238373,36.4428617954254,42.7420439720154,48.9511477947235,55.3243119716644}\r\n      15 | {5,6,7,8,9,10,11,12,13}         | {5.8685348033905,12.2334108352661,18.4217088222504,24.5603718757629,30.6826229095459,37.0211157798767,43.3373968601227,49.5628578662872,55.7701609134674}\r\n(15 rows)\r\n```\r\n\r\n(2)\r\nPR528 shows bug fixed\r\n```\r\n mst_key |          metrics_iters          |                                                                                                    metrics_elapsed_time                                                                                                     \r\n---------+---------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n       1 | {1,2,3,4}                       | {12.2509210109711,21.5696251392365,28.4033880233765,35.4542641639709}\r\n       2 | {1,2,3,4}                       | {11.6164019107819,20.9570059776306,27.7901480197906,34.7061359882355}\r\n       3 | {1}                             | {11.4122948646545}\r\n       4 | {1}                             | {10.8533229827881}\r\n       5 | {1}                             | {11.8194739818573}\r\n       6 | {1}                             | {12.749902009964}\r\n       7 | {1}                             | {12.5533349514008}\r\n       8 | {1}                             | {12.0531778335571}\r\n       9 | {1,2,3,4,5,6,7,8,9,10,11,12,13} | {11.1789879798889,20.6207029819489,27.5885601043701,34.508040189743,42.3414781093597,48.0012261867523,53.787230014801,59.5213670730591,65.2600991725922,71.2501010894775,76.8915431499481,82.5639650821686,88.264790058136}\r\n      10 | {2,3,4}                         | {21.1628739833832,27.9904689788818,34.9025909900665}\r\n      11 | {2,3,4}                         | {20.3932030200958,27.3551881313324,34.2683320045471}\r\n      12 | {2,3,4,5,6,7,8,9,10,11,12,13}   | {21.3696491718292,28.1980810165405,35.1015841960907,41.3438279628754,47.1330029964447,52.8797709941864,58.6085150241852,64.4296791553497,70.1329569816589,76.0616669654846,81.7249631881714,87.3962721824646}\r\n      13 | {5,6,7,8,9,10,11,12,13}         | {41.7541899681091,47.5591380596161,53.3572280406952,59.0166201591492,64.8324210643768,70.6048891544342,76.4613320827484,82.1320309638977,87.8146560192108}\r\n      14 | {5,6,7,8,9,10,11,12,13}         | {41.5514280796051,47.3472530841827,53.1601960659027,58.8155200481415,64.6345729827881,70.4008929729462,76.2625350952148,81.9320771694183,87.6032180786133}\r\n      15 | {5,6,7,8,9,10,11,12,13}         | {41.9598820209503,47.7600600719452,53.5559930801392,59.2904281616211,65.0303740501404,70.910637140274,76.6586999893188,82.3321261405945,88.0252130031586}\r\n(15 rows)\r\n```\r\n\r\nLGTM","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/761292406/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/763279085","html_url":"https://github.com/apache/madlib/pull/530#issuecomment-763279085","issue_url":"https://api.github.com/repos/apache/madlib/issues/530","id":763279085,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzI3OTA4NQ==","user":{"login":"fmcquillan99","id":10538173,"node_id":"MDQ6VXNlcjEwNTM4MTcz","avatar_url":"https://avatars.githubusercontent.com/u/10538173?v=4","gravatar_id":"","url":"https://api.github.com/users/fmcquillan99","html_url":"https://github.com/fmcquillan99","followers_url":"https://api.github.com/users/fmcquillan99/followers","following_url":"https://api.github.com/users/fmcquillan99/following{/other_user}","gists_url":"https://api.github.com/users/fmcquillan99/gists{/gist_id}","starred_url":"https://api.github.com/users/fmcquillan99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmcquillan99/subscriptions","organizations_url":"https://api.github.com/users/fmcquillan99/orgs","repos_url":"https://api.github.com/users/fmcquillan99/repos","events_url":"https://api.github.com/users/fmcquillan99/events{/privacy}","received_events_url":"https://api.github.com/users/fmcquillan99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-20T02:12:47Z","updated_at":"2021-01-20T02:12:47Z","author_association":"NONE","body":"tested for functionality (not performance diff) and seems fine.\r\n\r\nNot sure if this is the error message you intend:\r\n\r\n```\r\nmadlib=# SELECT madlib.madlib_keras_automl('iris_train_packed',                -- source table\r\nmadlib(#                                   'automl_output',                    -- model output table\r\nmadlib(#                                   'model_arch_library',               -- model architecture table\r\nmadlib(#                                   'automl_mst_table',                 -- model selection output table\r\nmadlib(#                                   ARRAY[1,2],                         -- model IDs\r\nmadlib(#                                   $${\r\nmadlib$#                                       'loss': ['categorical_crossentropy'], \r\nmadlib$#                                       'optimizer_params_list': [ \r\nmadlib$#                                           {'optimizer': ['Adam'],'lr': [0.001, 0.1, 'log']},\r\nmadlib$#                                           {'optimizer': ['RMSprop'],'lr': [0.001, 0.1, 'log']}\r\nmadlib$#                                       ],\r\nmadlib$#                                       'metrics': ['accuracy']\r\nmadlib$#                                   } $$,                               -- compile param grid\r\nmadlib(#                                   $${'batch_size': [4, 8], 'epochs': [1]}$$,  -- fit params grid\r\nmadlib(#                                   'hyperband',                        -- autoML method\r\nmadlib(#                                   'R=9, eta=3, skip_last=1',          -- autoML params\r\nmadlib(#                                   NULL,                               -- random state\r\nmadlib(#                                   NULL,                               -- object table\r\nmadlib(#                                   FALSE,                              -- use GPUs\r\nmadlib(#                                   'iris_test_packed',                 -- validation table\r\nmadlib(#                                   1,                                  -- metrics compute freq\r\nmadlib(#                                   NULL,                               -- name\r\nmadlib(#                                   NULL,                         -- descr\r\nmadlib(#                                   xxx);                             -- caching \r\nERROR:  column \"xxx\" does not exist\r\nLINE 24:                                   xxx);\r\n                                           ^\r\n```\r\n\r\nThis error message seems fine though:\r\n```\r\nmadlib=# \r\nmadlib=# \r\nmadlib=# SELECT madlib.madlib_keras_automl('iris_train_packed',                -- source table\r\nmadlib(#                                   'automl_output',                    -- model output table\r\nmadlib(#                                   'model_arch_library',               -- model architecture table\r\nmadlib(#                                   'automl_mst_table',                 -- model selection output table\r\nmadlib(#                                   ARRAY[1,2],                         -- model IDs\r\nmadlib(#                                   $${\r\nmadlib$#                                       'loss': ['categorical_crossentropy'], \r\nmadlib$#                                       'optimizer_params_list': [ \r\nmadlib$#                                           {'optimizer': ['Adam'],'lr': [0.001, 0.1, 'log']},\r\nmadlib$#                                           {'optimizer': ['RMSprop'],'lr': [0.001, 0.1, 'log']}\r\nmadlib$#                                       ],\r\nmadlib$#                                       'metrics': ['accuracy']\r\nmadlib$#                                   } $$,                               -- compile param grid\r\nmadlib(#                                   $${'batch_size': [4, 8], 'epochs': [1]}$$,  -- fit params grid\r\nmadlib(#                                   'hyperband',                        -- autoML method\r\nmadlib(#                                   'R=9, eta=3, skip_last=1',          -- autoML params\r\nmadlib(#                                   NULL,                               -- random state\r\nmadlib(#                                   NULL,                               -- object table\r\nmadlib(#                                   FALSE,                              -- use GPUs\r\nmadlib(#                                   'iris_test_packed',                 -- validation table\r\nmadlib(#                                   1,                                  -- metrics compute freq\r\nmadlib(#                                   NULL,                               -- name\r\nmadlib(#                                   NULL,                           -- descr\r\nmadlib(#                                   'xxx');                            -- caching       \r\nERROR:  invalid input syntax for type boolean: \"xxx\"\r\nLINE 24:                                   'xxx');\r\n                                           ^\r\n```\r\n\r\nLGTM","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/763279085/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/763286193","html_url":"https://github.com/apache/madlib/pull/530#issuecomment-763286193","issue_url":"https://api.github.com/repos/apache/madlib/issues/530","id":763286193,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzI4NjE5Mw==","user":{"login":"kaknikhil","id":11729207,"node_id":"MDQ6VXNlcjExNzI5MjA3","avatar_url":"https://avatars.githubusercontent.com/u/11729207?v=4","gravatar_id":"","url":"https://api.github.com/users/kaknikhil","html_url":"https://github.com/kaknikhil","followers_url":"https://api.github.com/users/kaknikhil/followers","following_url":"https://api.github.com/users/kaknikhil/following{/other_user}","gists_url":"https://api.github.com/users/kaknikhil/gists{/gist_id}","starred_url":"https://api.github.com/users/kaknikhil/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaknikhil/subscriptions","organizations_url":"https://api.github.com/users/kaknikhil/orgs","repos_url":"https://api.github.com/users/kaknikhil/repos","events_url":"https://api.github.com/users/kaknikhil/events{/privacy}","received_events_url":"https://api.github.com/users/kaknikhil/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-20T02:33:17Z","updated_at":"2021-01-20T02:33:17Z","author_association":"CONTRIBUTOR","body":"> tested for functionality (not performance diff) and seems fine.\r\n> \r\n> Not sure if this is the error message you intend:\r\n> \r\n> ```\r\n> madlib=# SELECT madlib.madlib_keras_automl('iris_train_packed',                -- source table\r\n> madlib(#                                   'automl_output',                    -- model output table\r\n> madlib(#                                   'model_arch_library',               -- model architecture table\r\n> madlib(#                                   'automl_mst_table',                 -- model selection output table\r\n> madlib(#                                   ARRAY[1,2],                         -- model IDs\r\n> madlib(#                                   $${\r\n> madlib$#                                       'loss': ['categorical_crossentropy'], \r\n> madlib$#                                       'optimizer_params_list': [ \r\n> madlib$#                                           {'optimizer': ['Adam'],'lr': [0.001, 0.1, 'log']},\r\n> madlib$#                                           {'optimizer': ['RMSprop'],'lr': [0.001, 0.1, 'log']}\r\n> madlib$#                                       ],\r\n> madlib$#                                       'metrics': ['accuracy']\r\n> madlib$#                                   } $$,                               -- compile param grid\r\n> madlib(#                                   $${'batch_size': [4, 8], 'epochs': [1]}$$,  -- fit params grid\r\n> madlib(#                                   'hyperband',                        -- autoML method\r\n> madlib(#                                   'R=9, eta=3, skip_last=1',          -- autoML params\r\n> madlib(#                                   NULL,                               -- random state\r\n> madlib(#                                   NULL,                               -- object table\r\n> madlib(#                                   FALSE,                              -- use GPUs\r\n> madlib(#                                   'iris_test_packed',                 -- validation table\r\n> madlib(#                                   1,                                  -- metrics compute freq\r\n> madlib(#                                   NULL,                               -- name\r\n> madlib(#                                   NULL,                         -- descr\r\n> madlib(#                                   xxx);                             -- caching \r\n> ERROR:  column \"xxx\" does not exist\r\n> LINE 24:                                   xxx);\r\n>                                            ^\r\n> ```\r\n> \r\n> This error message seems fine though:\r\n> \r\n> ```\r\n> madlib=# \r\n> madlib=# \r\n> madlib=# SELECT madlib.madlib_keras_automl('iris_train_packed',                -- source table\r\n> madlib(#                                   'automl_output',                    -- model output table\r\n> madlib(#                                   'model_arch_library',               -- model architecture table\r\n> madlib(#                                   'automl_mst_table',                 -- model selection output table\r\n> madlib(#                                   ARRAY[1,2],                         -- model IDs\r\n> madlib(#                                   $${\r\n> madlib$#                                       'loss': ['categorical_crossentropy'], \r\n> madlib$#                                       'optimizer_params_list': [ \r\n> madlib$#                                           {'optimizer': ['Adam'],'lr': [0.001, 0.1, 'log']},\r\n> madlib$#                                           {'optimizer': ['RMSprop'],'lr': [0.001, 0.1, 'log']}\r\n> madlib$#                                       ],\r\n> madlib$#                                       'metrics': ['accuracy']\r\n> madlib$#                                   } $$,                               -- compile param grid\r\n> madlib(#                                   $${'batch_size': [4, 8], 'epochs': [1]}$$,  -- fit params grid\r\n> madlib(#                                   'hyperband',                        -- autoML method\r\n> madlib(#                                   'R=9, eta=3, skip_last=1',          -- autoML params\r\n> madlib(#                                   NULL,                               -- random state\r\n> madlib(#                                   NULL,                               -- object table\r\n> madlib(#                                   FALSE,                              -- use GPUs\r\n> madlib(#                                   'iris_test_packed',                 -- validation table\r\n> madlib(#                                   1,                                  -- metrics compute freq\r\n> madlib(#                                   NULL,                               -- name\r\n> madlib(#                                   NULL,                           -- descr\r\n> madlib(#                                   'xxx');                            -- caching       \r\n> ERROR:  invalid input syntax for type boolean: \"xxx\"\r\n> LINE 24:                                   'xxx');\r\n>                                            ^\r\n> ```\r\n> \r\n> LGTM\r\n\r\nYes since these are invalid values for the argument type, these error messages are thrown by postgres itself before we even get to our python function. These messages will also be thrown for other arguments in this and other madlib functions","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/763286193/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/763323623","html_url":"https://github.com/apache/madlib/pull/530#issuecomment-763323623","issue_url":"https://api.github.com/repos/apache/madlib/issues/530","id":763323623,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzMyMzYyMw==","user":{"login":"fmcquillan99","id":10538173,"node_id":"MDQ6VXNlcjEwNTM4MTcz","avatar_url":"https://avatars.githubusercontent.com/u/10538173?v=4","gravatar_id":"","url":"https://api.github.com/users/fmcquillan99","html_url":"https://github.com/fmcquillan99","followers_url":"https://api.github.com/users/fmcquillan99/followers","following_url":"https://api.github.com/users/fmcquillan99/following{/other_user}","gists_url":"https://api.github.com/users/fmcquillan99/gists{/gist_id}","starred_url":"https://api.github.com/users/fmcquillan99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmcquillan99/subscriptions","organizations_url":"https://api.github.com/users/fmcquillan99/orgs","repos_url":"https://api.github.com/users/fmcquillan99/repos","events_url":"https://api.github.com/users/fmcquillan99/events{/privacy}","received_events_url":"https://api.github.com/users/fmcquillan99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-20T04:33:11Z","updated_at":"2021-01-20T04:33:11Z","author_association":"NONE","body":"ok, thanks for the clarification","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/763323623/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/765030529","html_url":"https://github.com/apache/madlib/pull/531#issuecomment-765030529","issue_url":"https://api.github.com/repos/apache/madlib/issues/531","id":765030529,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NTAzMDUyOQ==","user":{"login":"fmcquillan99","id":10538173,"node_id":"MDQ6VXNlcjEwNTM4MTcz","avatar_url":"https://avatars.githubusercontent.com/u/10538173?v=4","gravatar_id":"","url":"https://api.github.com/users/fmcquillan99","html_url":"https://github.com/fmcquillan99","followers_url":"https://api.github.com/users/fmcquillan99/followers","following_url":"https://api.github.com/users/fmcquillan99/following{/other_user}","gists_url":"https://api.github.com/users/fmcquillan99/gists{/gist_id}","starred_url":"https://api.github.com/users/fmcquillan99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmcquillan99/subscriptions","organizations_url":"https://api.github.com/users/fmcquillan99/orgs","repos_url":"https://api.github.com/users/fmcquillan99/repos","events_url":"https://api.github.com/users/fmcquillan99/events{/privacy}","received_events_url":"https://api.github.com/users/fmcquillan99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-22T00:32:14Z","updated_at":"2021-01-22T00:33:48Z","author_association":"NONE","body":"(1)\r\n```\r\nmadlib=# SELECT madlib.madlib_keras_fit_multiple_model('iris_train_packed',    -- source_table\r\nmadlib(#                                               'iris_multi_model',     -- model_output_table\r\nmadlib(#                                               'mst_table',            -- model_selection_table\r\nmadlib(#                                                10,                     -- num_iterations\r\nmadlib(#                                                FALSE,                 -- use gpus\r\nmadlib(#                                               'iris_test_packed',     -- validation dataset\r\nmadlib(#                                                1,                     -- metrics compute frequency\r\nmadlib(#                                                FALSE,                 -- warm start\r\nmadlib(#                                               'Sophie L.',            -- name\r\nmadlib(#                                               'Model selection for iris dataset'  -- description\r\nmadlib(#                                              );\r\nINFO:  \r\n\tTime for training in iteration 1: 5.08531904221 sec\r\nDETAIL:  \r\n\tTraining set after iteration 1:\r\n\tmst_key=1: metric=0.658333361149, loss=1.1474006176\r\n\tmst_key=3: metric=0.10000000149, loss=1.38732385635\r\n\tmst_key=2: metric=0.333333343267, loss=1.0933380127\r\n\tmst_key=4: metric=0.533333361149, loss=1.7163516283\r\n\tTime for evaluating training dataset in iteration 1: 1.03906393051\r\n\t\r\n\tValidation set after iteration 1:\r\n\tmst_key=1: metric=0.699999988079, loss=1.10724759102\r\n\tmst_key=3: metric=0.166666671634, loss=1.39472186565\r\n\tmst_key=2: metric=0.333333343267, loss=1.08243787289\r\n\tmst_key=4: metric=0.533333361149, loss=1.8540776968\r\n\tTime for evaluating validation dataset in iteration 1: 1.13996315002\r\nCONTEXT:  PL/Python function \"madlib_keras_fit_multiple_model\"\r\nINFO:  \r\n\tTime for training in iteration 2: 3.52112603188 sec\r\nDETAIL:  \r\n\tTraining set after iteration 2:\r\n\tmst_key=1: metric=0.658333361149, loss=1.14587247372\r\n\tmst_key=3: metric=0.108333334327, loss=1.32700014114\r\n\tmst_key=2: metric=0.333333343267, loss=1.08806085587\r\n\tmst_key=4: metric=0.625, loss=1.65616095066\r\n\tTime for evaluating training dataset in iteration 2: 1.04296994209\r\n\t\r\n\tValidation set after iteration 2:\r\n\tmst_key=1: metric=0.699999988079, loss=1.10603606701\r\n\tmst_key=3: metric=0.166666671634, loss=1.3331912756\r\n\tmst_key=2: metric=0.333333343267, loss=1.07862055302\r\n\tmst_key=4: metric=0.566666662693, loss=1.79157197475\r\n\tTime for evaluating validation dataset in iteration 2: 1.17975687981\r\netc.\r\n```\r\nOK\r\n\r\n(2)\r\n```\r\nmadlib=# SELECT madlib.madlib_keras_fit_multiple_model('iris_train_packed',    -- source_table\r\nmadlib(#                                               'iris_multi_model',     -- model_output_table\r\nmadlib(#                                               'mst_table',            -- model_selection_table\r\nmadlib(#                                                10,                     -- num_iterations\r\nmadlib(#                                                FALSE,                 -- use gpus\r\nmadlib(#                                               'iris_test_packed',     -- validation dataset\r\nmadlib(#                                                3,                     -- metrics compute frequency\r\nmadlib(#                                                FALSE,                 -- warm start\r\nmadlib(#                                               'Sophie L.',            -- name\r\nmadlib(#                                               'Model selection for iris dataset'  -- description\r\nmadlib(#                                              );\r\nINFO:  \r\n\tTime for training in iteration 1: 5.23196315765 sec\r\nCONTEXT:  PL/Python function \"madlib_keras_fit_multiple_model\"\r\nINFO:  \r\n\tTime for training in iteration 2: 3.06432795525 sec\r\nCONTEXT:  PL/Python function \"madlib_keras_fit_multiple_model\"\r\nINFO:  \r\n\tTime for training in iteration 3: 3.11480093002 sec\r\nDETAIL:  \r\n\tTraining set after iteration 3:\r\n\tmst_key=1: metric=0.341666668653, loss=1.00513792038\r\n\tmst_key=3: metric=0.341666668653, loss=1.14255702496\r\n\tmst_key=2: metric=0.333333343267, loss=1.30739760399\r\n\tmst_key=4: metric=0.341666668653, loss=1.01052212715\r\n\tTime for evaluating training dataset in iteration 3: 1.07409715652\r\n\t\r\n\tValidation set after iteration 3:\r\n\tmst_key=1: metric=0.300000011921, loss=1.03619933128\r\n\tmst_key=3: metric=0.300000011921, loss=1.15146791935\r\n\tmst_key=2: metric=0.333333343267, loss=1.27005898952\r\n\tmst_key=4: metric=0.300000011921, loss=1.08076310158\r\n\tTime for evaluating validation dataset in iteration 3: 1.44217610359\r\netc\r\n```\r\nOK\r\n\r\n(3)\r\n```\r\nmadlib=# SELECT madlib.madlib_keras_fit_multiple_model('iris_train_packed',    -- source_table\r\nmadlib(#                                               'iris_multi_model',     -- model_output_table\r\nmadlib(#                                               'mst_table',            -- model_selection_table\r\nmadlib(#                                               5,                     -- num_iterations\r\nmadlib(#                                               FALSE                   -- use gpus\r\nmadlib(#                                              );\r\nINFO:  \r\n\tTime for training in iteration 1: 3.21357607841 sec\r\nCONTEXT:  PL/Python function \"madlib_keras_fit_multiple_model\"\r\nINFO:  \r\n\tTime for training in iteration 2: 3.24296498299 sec\r\nCONTEXT:  PL/Python function \"madlib_keras_fit_multiple_model\"\r\nINFO:  \r\n\tTime for training in iteration 3: 3.2322010994 sec\r\nCONTEXT:  PL/Python function \"madlib_keras_fit_multiple_model\"\r\nINFO:  \r\n\tTime for training in iteration 4: 3.33785796165 sec\r\nCONTEXT:  PL/Python function \"madlib_keras_fit_multiple_model\"\r\nINFO:  \r\n\tTime for training in iteration 5: 3.1472928524 sec\r\nDETAIL:  \r\n\tTraining set after iteration 5:\r\n\tmst_key=1: metric=0.675000011921, loss=1.01427876949\r\n\tmst_key=3: metric=0.341666668653, loss=0.958754897118\r\n\tmst_key=2: metric=0.324999988079, loss=1.13000130653\r\n\tmst_key=4: metric=0.341666668653, loss=1.0127518177\r\n\tTime for evaluating training dataset in iteration 5: 1.03426170349\r\nCONTEXT:  PL/Python function \"madlib_keras_fit_multiple_model\"\r\n madlib_keras_fit_multiple_model \r\n---------------------------------\r\n \r\n(1 row)\r\n```\r\nOK\r\n\r\nFor the last test (3):\r\n```\r\n3.214 | training in iteration 1\r\n3.243 | training in iteration 2\r\n3.232 | training in iteration 3\r\n3.338 | training in iteration 4\r\n3.147 | training in iteration 5\r\n1.034 | evaluating training dataset in iteration 5\r\n\r\n17.21 | total\r\n\r\n18.89 | E2E run time\r\n\r\n1.681 | other overhead time\r\n```\r\n\r\nLooks reasonable \r\n\r\nLGTM\r\n\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/765030529/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/767014388","html_url":"https://github.com/apache/madlib/pull/532#issuecomment-767014388","issue_url":"https://api.github.com/repos/apache/madlib/issues/532","id":767014388,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NzAxNDM4OA==","user":{"login":"reductionista","id":2644901,"node_id":"MDQ6VXNlcjI2NDQ5MDE=","avatar_url":"https://avatars.githubusercontent.com/u/2644901?v=4","gravatar_id":"","url":"https://api.github.com/users/reductionista","html_url":"https://github.com/reductionista","followers_url":"https://api.github.com/users/reductionista/followers","following_url":"https://api.github.com/users/reductionista/following{/other_user}","gists_url":"https://api.github.com/users/reductionista/gists{/gist_id}","starred_url":"https://api.github.com/users/reductionista/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/reductionista/subscriptions","organizations_url":"https://api.github.com/users/reductionista/orgs","repos_url":"https://api.github.com/users/reductionista/repos","events_url":"https://api.github.com/users/reductionista/events{/privacy}","received_events_url":"https://api.github.com/users/reductionista/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-25T18:17:51Z","updated_at":"2021-01-25T18:17:51Z","author_association":"CONTRIBUTOR","body":"LGTM","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/767014388/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/768754511","html_url":"https://github.com/apache/madlib/pull/533#issuecomment-768754511","issue_url":"https://api.github.com/repos/apache/madlib/issues/533","id":768754511,"node_id":"MDEyOklzc3VlQ29tbWVudDc2ODc1NDUxMQ==","user":{"login":"reductionista","id":2644901,"node_id":"MDQ6VXNlcjI2NDQ5MDE=","avatar_url":"https://avatars.githubusercontent.com/u/2644901?v=4","gravatar_id":"","url":"https://api.github.com/users/reductionista","html_url":"https://github.com/reductionista","followers_url":"https://api.github.com/users/reductionista/followers","following_url":"https://api.github.com/users/reductionista/following{/other_user}","gists_url":"https://api.github.com/users/reductionista/gists{/gist_id}","starred_url":"https://api.github.com/users/reductionista/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/reductionista/subscriptions","organizations_url":"https://api.github.com/users/reductionista/orgs","repos_url":"https://api.github.com/users/reductionista/repos","events_url":"https://api.github.com/users/reductionista/events{/privacy}","received_events_url":"https://api.github.com/users/reductionista/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-28T02:35:29Z","updated_at":"2021-01-28T02:35:29Z","author_association":"CONTRIBUTOR","body":"LGTM!","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/768754511/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/774363010","html_url":"https://github.com/apache/madlib/pull/538#issuecomment-774363010","issue_url":"https://api.github.com/repos/apache/madlib/issues/538","id":774363010,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NDM2MzAxMA==","user":{"login":"khannaekta","id":15749573,"node_id":"MDQ6VXNlcjE1NzQ5NTcz","avatar_url":"https://avatars.githubusercontent.com/u/15749573?v=4","gravatar_id":"","url":"https://api.github.com/users/khannaekta","html_url":"https://github.com/khannaekta","followers_url":"https://api.github.com/users/khannaekta/followers","following_url":"https://api.github.com/users/khannaekta/following{/other_user}","gists_url":"https://api.github.com/users/khannaekta/gists{/gist_id}","starred_url":"https://api.github.com/users/khannaekta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/khannaekta/subscriptions","organizations_url":"https://api.github.com/users/khannaekta/orgs","repos_url":"https://api.github.com/users/khannaekta/repos","events_url":"https://api.github.com/users/khannaekta/events{/privacy}","received_events_url":"https://api.github.com/users/khannaekta/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-06T00:45:22Z","updated_at":"2021-02-06T00:45:22Z","author_association":"CONTRIBUTOR","body":"retest this please","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/774363010/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/775400222","html_url":"https://github.com/apache/madlib/pull/538#issuecomment-775400222","issue_url":"https://api.github.com/repos/apache/madlib/issues/538","id":775400222,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NTQwMDIyMg==","user":{"login":"kaknikhil","id":11729207,"node_id":"MDQ6VXNlcjExNzI5MjA3","avatar_url":"https://avatars.githubusercontent.com/u/11729207?v=4","gravatar_id":"","url":"https://api.github.com/users/kaknikhil","html_url":"https://github.com/kaknikhil","followers_url":"https://api.github.com/users/kaknikhil/followers","following_url":"https://api.github.com/users/kaknikhil/following{/other_user}","gists_url":"https://api.github.com/users/kaknikhil/gists{/gist_id}","starred_url":"https://api.github.com/users/kaknikhil/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaknikhil/subscriptions","organizations_url":"https://api.github.com/users/kaknikhil/orgs","repos_url":"https://api.github.com/users/kaknikhil/repos","events_url":"https://api.github.com/users/kaknikhil/events{/privacy}","received_events_url":"https://api.github.com/users/kaknikhil/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-08T19:50:53Z","updated_at":"2021-02-08T19:50:53Z","author_association":"CONTRIBUTOR","body":"retest this please","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/775400222/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/775406797","html_url":"https://github.com/apache/madlib/pull/538#issuecomment-775406797","issue_url":"https://api.github.com/repos/apache/madlib/issues/538","id":775406797,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NTQwNjc5Nw==","user":{"login":"kaknikhil","id":11729207,"node_id":"MDQ6VXNlcjExNzI5MjA3","avatar_url":"https://avatars.githubusercontent.com/u/11729207?v=4","gravatar_id":"","url":"https://api.github.com/users/kaknikhil","html_url":"https://github.com/kaknikhil","followers_url":"https://api.github.com/users/kaknikhil/followers","following_url":"https://api.github.com/users/kaknikhil/following{/other_user}","gists_url":"https://api.github.com/users/kaknikhil/gists{/gist_id}","starred_url":"https://api.github.com/users/kaknikhil/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaknikhil/subscriptions","organizations_url":"https://api.github.com/users/kaknikhil/orgs","repos_url":"https://api.github.com/users/kaknikhil/repos","events_url":"https://api.github.com/users/kaknikhil/events{/privacy}","received_events_url":"https://api.github.com/users/kaknikhil/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-08T20:00:13Z","updated_at":"2021-02-08T20:00:13Z","author_association":"CONTRIBUTOR","body":"retest this please","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/775406797/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/775433987","html_url":"https://github.com/apache/madlib/pull/538#issuecomment-775433987","issue_url":"https://api.github.com/repos/apache/madlib/issues/538","id":775433987,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NTQzMzk4Nw==","user":{"login":"kaknikhil","id":11729207,"node_id":"MDQ6VXNlcjExNzI5MjA3","avatar_url":"https://avatars.githubusercontent.com/u/11729207?v=4","gravatar_id":"","url":"https://api.github.com/users/kaknikhil","html_url":"https://github.com/kaknikhil","followers_url":"https://api.github.com/users/kaknikhil/followers","following_url":"https://api.github.com/users/kaknikhil/following{/other_user}","gists_url":"https://api.github.com/users/kaknikhil/gists{/gist_id}","starred_url":"https://api.github.com/users/kaknikhil/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaknikhil/subscriptions","organizations_url":"https://api.github.com/users/kaknikhil/orgs","repos_url":"https://api.github.com/users/kaknikhil/repos","events_url":"https://api.github.com/users/kaknikhil/events{/privacy}","received_events_url":"https://api.github.com/users/kaknikhil/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-08T20:31:57Z","updated_at":"2021-02-08T20:31:57Z","author_association":"CONTRIBUTOR","body":"test this please","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/775433987/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/775526232","html_url":"https://github.com/apache/madlib/pull/540#issuecomment-775526232","issue_url":"https://api.github.com/repos/apache/madlib/issues/540","id":775526232,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NTUyNjIzMg==","user":{"login":"kaknikhil","id":11729207,"node_id":"MDQ6VXNlcjExNzI5MjA3","avatar_url":"https://avatars.githubusercontent.com/u/11729207?v=4","gravatar_id":"","url":"https://api.github.com/users/kaknikhil","html_url":"https://github.com/kaknikhil","followers_url":"https://api.github.com/users/kaknikhil/followers","following_url":"https://api.github.com/users/kaknikhil/following{/other_user}","gists_url":"https://api.github.com/users/kaknikhil/gists{/gist_id}","starred_url":"https://api.github.com/users/kaknikhil/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaknikhil/subscriptions","organizations_url":"https://api.github.com/users/kaknikhil/orgs","repos_url":"https://api.github.com/users/kaknikhil/repos","events_url":"https://api.github.com/users/kaknikhil/events{/privacy}","received_events_url":"https://api.github.com/users/kaknikhil/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-08T23:13:18Z","updated_at":"2021-02-08T23:13:18Z","author_association":"CONTRIBUTOR","body":"test comment","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/775526232/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/775529245","html_url":"https://github.com/apache/madlib/pull/540#issuecomment-775529245","issue_url":"https://api.github.com/repos/apache/madlib/issues/540","id":775529245,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NTUyOTI0NQ==","user":{"login":"kaknikhil","id":11729207,"node_id":"MDQ6VXNlcjExNzI5MjA3","avatar_url":"https://avatars.githubusercontent.com/u/11729207?v=4","gravatar_id":"","url":"https://api.github.com/users/kaknikhil","html_url":"https://github.com/kaknikhil","followers_url":"https://api.github.com/users/kaknikhil/followers","following_url":"https://api.github.com/users/kaknikhil/following{/other_user}","gists_url":"https://api.github.com/users/kaknikhil/gists{/gist_id}","starred_url":"https://api.github.com/users/kaknikhil/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaknikhil/subscriptions","organizations_url":"https://api.github.com/users/kaknikhil/orgs","repos_url":"https://api.github.com/users/kaknikhil/repos","events_url":"https://api.github.com/users/kaknikhil/events{/privacy}","received_events_url":"https://api.github.com/users/kaknikhil/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-08T23:20:03Z","updated_at":"2021-02-08T23:20:03Z","author_association":"CONTRIBUTOR","body":"comment","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/775529245/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/775530711","html_url":"https://github.com/apache/madlib/pull/540#issuecomment-775530711","issue_url":"https://api.github.com/repos/apache/madlib/issues/540","id":775530711,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NTUzMDcxMQ==","user":{"login":"kaknikhil","id":11729207,"node_id":"MDQ6VXNlcjExNzI5MjA3","avatar_url":"https://avatars.githubusercontent.com/u/11729207?v=4","gravatar_id":"","url":"https://api.github.com/users/kaknikhil","html_url":"https://github.com/kaknikhil","followers_url":"https://api.github.com/users/kaknikhil/followers","following_url":"https://api.github.com/users/kaknikhil/following{/other_user}","gists_url":"https://api.github.com/users/kaknikhil/gists{/gist_id}","starred_url":"https://api.github.com/users/kaknikhil/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaknikhil/subscriptions","organizations_url":"https://api.github.com/users/kaknikhil/orgs","repos_url":"https://api.github.com/users/kaknikhil/repos","events_url":"https://api.github.com/users/kaknikhil/events{/privacy}","received_events_url":"https://api.github.com/users/kaknikhil/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-08T23:23:28Z","updated_at":"2021-02-08T23:23:28Z","author_association":"CONTRIBUTOR","body":"another comment","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/775530711/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/775533392","html_url":"https://github.com/apache/madlib/pull/540#issuecomment-775533392","issue_url":"https://api.github.com/repos/apache/madlib/issues/540","id":775533392,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NTUzMzM5Mg==","user":{"login":"kaknikhil","id":11729207,"node_id":"MDQ6VXNlcjExNzI5MjA3","avatar_url":"https://avatars.githubusercontent.com/u/11729207?v=4","gravatar_id":"","url":"https://api.github.com/users/kaknikhil","html_url":"https://github.com/kaknikhil","followers_url":"https://api.github.com/users/kaknikhil/followers","following_url":"https://api.github.com/users/kaknikhil/following{/other_user}","gists_url":"https://api.github.com/users/kaknikhil/gists{/gist_id}","starred_url":"https://api.github.com/users/kaknikhil/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaknikhil/subscriptions","organizations_url":"https://api.github.com/users/kaknikhil/orgs","repos_url":"https://api.github.com/users/kaknikhil/repos","events_url":"https://api.github.com/users/kaknikhil/events{/privacy}","received_events_url":"https://api.github.com/users/kaknikhil/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-08T23:30:02Z","updated_at":"2021-02-08T23:30:02Z","author_association":"CONTRIBUTOR","body":"one more comment","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/775533392/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/776347962","html_url":"https://github.com/apache/madlib/pull/538#issuecomment-776347962","issue_url":"https://api.github.com/repos/apache/madlib/issues/538","id":776347962,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NjM0Nzk2Mg==","user":{"login":"khannaekta","id":15749573,"node_id":"MDQ6VXNlcjE1NzQ5NTcz","avatar_url":"https://avatars.githubusercontent.com/u/15749573?v=4","gravatar_id":"","url":"https://api.github.com/users/khannaekta","html_url":"https://github.com/khannaekta","followers_url":"https://api.github.com/users/khannaekta/followers","following_url":"https://api.github.com/users/khannaekta/following{/other_user}","gists_url":"https://api.github.com/users/khannaekta/gists{/gist_id}","starred_url":"https://api.github.com/users/khannaekta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/khannaekta/subscriptions","organizations_url":"https://api.github.com/users/khannaekta/orgs","repos_url":"https://api.github.com/users/khannaekta/repos","events_url":"https://api.github.com/users/khannaekta/events{/privacy}","received_events_url":"https://api.github.com/users/khannaekta/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-10T00:43:32Z","updated_at":"2021-02-10T00:43:32Z","author_association":"CONTRIBUTOR","body":"Closing test PR","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/776347962/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/776377369","html_url":"https://github.com/apache/madlib/pull/538#issuecomment-776377369","issue_url":"https://api.github.com/repos/apache/madlib/issues/538","id":776377369,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NjM3NzM2OQ==","user":{"login":"kaknikhil","id":11729207,"node_id":"MDQ6VXNlcjExNzI5MjA3","avatar_url":"https://avatars.githubusercontent.com/u/11729207?v=4","gravatar_id":"","url":"https://api.github.com/users/kaknikhil","html_url":"https://github.com/kaknikhil","followers_url":"https://api.github.com/users/kaknikhil/followers","following_url":"https://api.github.com/users/kaknikhil/following{/other_user}","gists_url":"https://api.github.com/users/kaknikhil/gists{/gist_id}","starred_url":"https://api.github.com/users/kaknikhil/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaknikhil/subscriptions","organizations_url":"https://api.github.com/users/kaknikhil/orgs","repos_url":"https://api.github.com/users/kaknikhil/repos","events_url":"https://api.github.com/users/kaknikhil/events{/privacy}","received_events_url":"https://api.github.com/users/kaknikhil/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-10T02:01:08Z","updated_at":"2021-02-10T02:01:08Z","author_association":"CONTRIBUTOR","body":"test comment","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/776377369/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/776377715","html_url":"https://github.com/apache/madlib/pull/538#issuecomment-776377715","issue_url":"https://api.github.com/repos/apache/madlib/issues/538","id":776377715,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NjM3NzcxNQ==","user":{"login":"kaknikhil","id":11729207,"node_id":"MDQ6VXNlcjExNzI5MjA3","avatar_url":"https://avatars.githubusercontent.com/u/11729207?v=4","gravatar_id":"","url":"https://api.github.com/users/kaknikhil","html_url":"https://github.com/kaknikhil","followers_url":"https://api.github.com/users/kaknikhil/followers","following_url":"https://api.github.com/users/kaknikhil/following{/other_user}","gists_url":"https://api.github.com/users/kaknikhil/gists{/gist_id}","starred_url":"https://api.github.com/users/kaknikhil/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaknikhil/subscriptions","organizations_url":"https://api.github.com/users/kaknikhil/orgs","repos_url":"https://api.github.com/users/kaknikhil/repos","events_url":"https://api.github.com/users/kaknikhil/events{/privacy}","received_events_url":"https://api.github.com/users/kaknikhil/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-10T02:01:59Z","updated_at":"2021-02-10T02:01:59Z","author_association":"CONTRIBUTOR","body":"test this please","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/776377715/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/777158955","html_url":"https://github.com/apache/madlib/pull/544#issuecomment-777158955","issue_url":"https://api.github.com/repos/apache/madlib/issues/544","id":777158955,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NzE1ODk1NQ==","user":{"login":"khannaekta","id":15749573,"node_id":"MDQ6VXNlcjE1NzQ5NTcz","avatar_url":"https://avatars.githubusercontent.com/u/15749573?v=4","gravatar_id":"","url":"https://api.github.com/users/khannaekta","html_url":"https://github.com/khannaekta","followers_url":"https://api.github.com/users/khannaekta/followers","following_url":"https://api.github.com/users/khannaekta/following{/other_user}","gists_url":"https://api.github.com/users/khannaekta/gists{/gist_id}","starred_url":"https://api.github.com/users/khannaekta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/khannaekta/subscriptions","organizations_url":"https://api.github.com/users/khannaekta/orgs","repos_url":"https://api.github.com/users/khannaekta/repos","events_url":"https://api.github.com/users/khannaekta/events{/privacy}","received_events_url":"https://api.github.com/users/khannaekta/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-11T01:55:36Z","updated_at":"2021-02-11T01:55:36Z","author_association":"CONTRIBUTOR","body":"test this please. ","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/777158955/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/781538750","html_url":"https://github.com/apache/madlib/pull/546#issuecomment-781538750","issue_url":"https://api.github.com/repos/apache/madlib/issues/546","id":781538750,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MTUzODc1MA==","user":{"login":"fmcquillan99","id":10538173,"node_id":"MDQ6VXNlcjEwNTM4MTcz","avatar_url":"https://avatars.githubusercontent.com/u/10538173?v=4","gravatar_id":"","url":"https://api.github.com/users/fmcquillan99","html_url":"https://github.com/fmcquillan99","followers_url":"https://api.github.com/users/fmcquillan99/followers","following_url":"https://api.github.com/users/fmcquillan99/following{/other_user}","gists_url":"https://api.github.com/users/fmcquillan99/gists{/gist_id}","starred_url":"https://api.github.com/users/fmcquillan99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmcquillan99/subscriptions","organizations_url":"https://api.github.com/users/fmcquillan99/orgs","repos_url":"https://api.github.com/users/fmcquillan99/repos","events_url":"https://api.github.com/users/fmcquillan99/events{/privacy}","received_events_url":"https://api.github.com/users/fmcquillan99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-18T18:14:10Z","updated_at":"2021-02-18T18:14:10Z","author_association":"NONE","body":"ready to merge","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/781538750/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/781540432","html_url":"https://github.com/apache/madlib/pull/545#issuecomment-781540432","issue_url":"https://api.github.com/repos/apache/madlib/issues/545","id":781540432,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MTU0MDQzMg==","user":{"login":"fmcquillan99","id":10538173,"node_id":"MDQ6VXNlcjEwNTM4MTcz","avatar_url":"https://avatars.githubusercontent.com/u/10538173?v=4","gravatar_id":"","url":"https://api.github.com/users/fmcquillan99","html_url":"https://github.com/fmcquillan99","followers_url":"https://api.github.com/users/fmcquillan99/followers","following_url":"https://api.github.com/users/fmcquillan99/following{/other_user}","gists_url":"https://api.github.com/users/fmcquillan99/gists{/gist_id}","starred_url":"https://api.github.com/users/fmcquillan99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmcquillan99/subscriptions","organizations_url":"https://api.github.com/users/fmcquillan99/orgs","repos_url":"https://api.github.com/users/fmcquillan99/repos","events_url":"https://api.github.com/users/fmcquillan99/events{/privacy}","received_events_url":"https://api.github.com/users/fmcquillan99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-18T18:16:51Z","updated_at":"2021-02-18T18:16:51Z","author_association":"NONE","body":"ready to merge","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/781540432/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/783803053","html_url":"https://github.com/apache/madlib/pull/534#issuecomment-783803053","issue_url":"https://api.github.com/repos/apache/madlib/issues/534","id":783803053,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MzgwMzA1Mw==","user":{"login":"fmcquillan99","id":10538173,"node_id":"MDQ6VXNlcjEwNTM4MTcz","avatar_url":"https://avatars.githubusercontent.com/u/10538173?v=4","gravatar_id":"","url":"https://api.github.com/users/fmcquillan99","html_url":"https://github.com/fmcquillan99","followers_url":"https://api.github.com/users/fmcquillan99/followers","following_url":"https://api.github.com/users/fmcquillan99/following{/other_user}","gists_url":"https://api.github.com/users/fmcquillan99/gists{/gist_id}","starred_url":"https://api.github.com/users/fmcquillan99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmcquillan99/subscriptions","organizations_url":"https://api.github.com/users/fmcquillan99/orgs","repos_url":"https://api.github.com/users/fmcquillan99/repos","events_url":"https://api.github.com/users/fmcquillan99/events{/privacy}","received_events_url":"https://api.github.com/users/fmcquillan99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-23T01:39:34Z","updated_at":"2021-02-23T01:39:34Z","author_association":"NONE","body":"@orhankislal \r\n\r\nmissing 'loss_type' in output table from\r\n.../workspace/madlib/build_docker/doc/user/html/group__grp__keras.html#keras_fit\r\n\r\nI think we missed this in \r\nhttps://github.com/apache/madlib/pull/511\r\nwhere we added to info table for multi_fit() but forgot fit()\r\n\r\ncan you add it in please?  thx\r\n\r\n```\r\n-[ RECORD 1 ]-------------+--------------------------------------------------------------------------\r\nsource_table              | iris_train_packed\r\nmodel                     | iris_model\r\ndependent_varname         | {class_text}\r\nindependent_varname       | {attributes}\r\nmodel_arch_table          | model_arch_library\r\nmodel_id                  | 1\r\ncompile_params            |  loss='categorical_crossentropy', optimizer='adam', metrics=['accuracy'] \r\nfit_params                |  batch_size=5, epochs=3 \r\nnum_iterations            | 10\r\nvalidation_table          | \r\nobject_table              | \r\nmetrics_compute_frequency | 10\r\nname                      | \r\ndescription               | \r\nmodel_type                | madlib_keras\r\nmodel_size                | 0.7900390625\r\nstart_training_time       | 2021-02-22 22:39:59.223927\r\nend_training_time         | 2021-02-22 22:40:02.695402\r\nmetrics_elapsed_time      | {3.47141289710999}\r\nmadlib_version            | 1.18.0-dev\r\nnum_classes               | {3}\r\ndependent_vartype         | {\"character varying\"}\r\nnormalizing_const         | 1\r\nmetrics_type              | {accuracy}\r\nloss_type\t\t\t\t  | xxxyyyzzz                        <- **** missing ****\r\ntraining_metrics_final    | 0.833333313465118\r\ntraining_loss_final       | 0.745647132396698\r\ntraining_metrics          | {0.833333313465118}\r\ntraining_loss             | {0.745647132396698}\r\nvalidation_metrics_final  | \r\nvalidation_loss_final     | \r\nvalidation_metrics        | \r\nvalidation_loss           | \r\nmetrics_iters             | {10}\r\nclass_text_class_values   | {Iris-setosa,Iris-versicolor,Iris-virginica}\r\n```","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/783803053/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/784564784","html_url":"https://github.com/apache/madlib/pull/534#issuecomment-784564784","issue_url":"https://api.github.com/repos/apache/madlib/issues/534","id":784564784,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NDU2NDc4NA==","user":{"login":"fmcquillan99","id":10538173,"node_id":"MDQ6VXNlcjEwNTM4MTcz","avatar_url":"https://avatars.githubusercontent.com/u/10538173?v=4","gravatar_id":"","url":"https://api.github.com/users/fmcquillan99","html_url":"https://github.com/fmcquillan99","followers_url":"https://api.github.com/users/fmcquillan99/followers","following_url":"https://api.github.com/users/fmcquillan99/following{/other_user}","gists_url":"https://api.github.com/users/fmcquillan99/gists{/gist_id}","starred_url":"https://api.github.com/users/fmcquillan99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmcquillan99/subscriptions","organizations_url":"https://api.github.com/users/fmcquillan99/orgs","repos_url":"https://api.github.com/users/fmcquillan99/repos","events_url":"https://api.github.com/users/fmcquillan99/events{/privacy}","received_events_url":"https://api.github.com/users/fmcquillan99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-23T22:40:02Z","updated_at":"2021-02-23T22:40:26Z","author_association":"NONE","body":"yes looks good now with `loss_type` in output\r\n\r\n```SELECT * FROM iris_model_summary;\r\n-[ RECORD 1 ]-------------+--------------------------------------------------------------------------\r\nsource_table              | iris_train_packed\r\nmodel                     | iris_model\r\ndependent_varname         | {class_text}\r\nindependent_varname       | {attributes}\r\nmodel_arch_table          | model_arch_library\r\nmodel_id                  | 1\r\ncompile_params            |  loss='categorical_crossentropy', optimizer='adam', metrics=['accuracy'] \r\nfit_params                |  batch_size=5, epochs=3 \r\nnum_iterations            | 10\r\nvalidation_table          | \r\nobject_table              | \r\nmetrics_compute_frequency | 10\r\nname                      | \r\ndescription               | \r\nmodel_type                | madlib_keras\r\nmodel_size                | 0.7900390625\r\nstart_training_time       | 2021-02-23 22:33:45.814856\r\nend_training_time         | 2021-02-23 22:33:49.155229\r\nmetrics_elapsed_time      | {3.34029412269592}\r\nmadlib_version            | 1.18.0-dev\r\nnum_classes               | {3}\r\ndependent_vartype         | {\"character varying\"}\r\nnormalizing_const         | 1\r\nmetrics_type              | {accuracy}\r\nloss_type                 | categorical_crossentropy\r\ntraining_metrics_final    | 0.941666662693024\r\ntraining_loss_final       | 0.362120628356934\r\ntraining_metrics          | {0.941666662693024}\r\ntraining_loss             | {0.362120628356934}\r\nvalidation_metrics_final  | \r\nvalidation_loss_final     | \r\nvalidation_metrics        | \r\nvalidation_loss           | \r\nmetrics_iters             | {10}\r\nclass_text_class_values   | {Iris-setosa,Iris-versicolor,Iris-virginica}\r\n```","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/784564784/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/784616302","html_url":"https://github.com/apache/madlib/pull/524#issuecomment-784616302","issue_url":"https://api.github.com/repos/apache/madlib/issues/524","id":784616302,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NDYxNjMwMg==","user":{"login":"fmcquillan99","id":10538173,"node_id":"MDQ6VXNlcjEwNTM4MTcz","avatar_url":"https://avatars.githubusercontent.com/u/10538173?v=4","gravatar_id":"","url":"https://api.github.com/users/fmcquillan99","html_url":"https://github.com/fmcquillan99","followers_url":"https://api.github.com/users/fmcquillan99/followers","following_url":"https://api.github.com/users/fmcquillan99/following{/other_user}","gists_url":"https://api.github.com/users/fmcquillan99/gists{/gist_id}","starred_url":"https://api.github.com/users/fmcquillan99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmcquillan99/subscriptions","organizations_url":"https://api.github.com/users/fmcquillan99/orgs","repos_url":"https://api.github.com/users/fmcquillan99/repos","events_url":"https://api.github.com/users/fmcquillan99/events{/privacy}","received_events_url":"https://api.github.com/users/fmcquillan99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-23T23:56:27Z","updated_at":"2021-02-23T23:56:27Z","author_association":"NONE","body":"(1) \r\nturn off verbose write to console\r\n```madlib=# SELECT madlib.madlib_keras_fit('iris_train_packed',   -- source table\r\nmadlib(#                                'iris_model',          -- model output table\r\nmadlib(#                                'model_arch_library',  -- model arch table\r\nmadlib(#                                 1,                    -- model arch id\r\nmadlib(#                                 $$ loss='categorical_crossentropy', optimizer='adam', metrics=['accuracy'] $$,  -- compile_params\r\nmadlib(#                                 $$ batch_size=5, epochs=3, callbacks=[TensorBoard(log_dir=\"/tmp/tensorflow/scalars\")]$$,  -- fit_params\r\nmadlib(#                                 10                    -- num_iterations\r\nmadlib(#                               );\r\nINFO:  \r\n\tTime for training in iteration 1: 2.63317084312 sec\r\nCONTEXT:  PL/Python function \"madlib_keras_fit\"\r\nINFO:  \r\n\tTime for training in iteration 2: 0.106519937515 sec\r\nCONTEXT:  PL/Python function \"madlib_keras_fit\"\r\nINFO:  \r\n\tTime for training in iteration 3: 0.105093002319 sec\r\nCONTEXT:  PL/Python function \"madlib_keras_fit\"\r\nINFO:  \r\n\tTime for training in iteration 4: 0.102034807205 sec\r\nCONTEXT:  PL/Python function \"madlib_keras_fit\"\r\nINFO:  \r\n\tTime for training in iteration 5: 0.100094079971 sec\r\nCONTEXT:  PL/Python function \"madlib_keras_fit\"\r\nINFO:  \r\n\tTime for training in iteration 6: 0.102514982224 sec\r\nCONTEXT:  PL/Python function \"madlib_keras_fit\"\r\nINFO:  \r\n\tTime for training in iteration 7: 0.103103876114 sec\r\nCONTEXT:  PL/Python function \"madlib_keras_fit\"\r\nINFO:  \r\n\tTime for training in iteration 8: 0.101779222488 sec\r\nCONTEXT:  PL/Python function \"madlib_keras_fit\"\r\nINFO:  \r\n\tTime for training in iteration 9: 0.099191904068 sec\r\nCONTEXT:  PL/Python function \"madlib_keras_fit\"\r\nINFO:  \r\n        select (madlib.internal_keras_evaluate(\r\nDETAIL:  \r\n                                            ARRAY[class_text],\r\n                                            ARRAY[attributes],\r\n                                            ARRAY[class_text_shape],\r\n                                            ARRAY[attributes_shape],\r\n                                            $MAD$\r\n{\"class_name\": \"Sequential\", \"keras_version\": \"2.1.6\", \"config\": [{\"class_name\": \"Dense\", \"config\": {\"kernel_initializer\": {\"class_name\": \"VarianceScaling\", \"config\": {\"distribution\": \"uniform\", \"scale\": 1.0, \"seed\": null, \"mode\": \"fan_avg\"}}, \"name\": \"dense_1\", \"kernel_constraint\": null, \"bias_regularizer\": null, \"bias_constraint\": null, \"dtype\": \"float32\", \"activation\": \"relu\", \"trainable\": true, \"kernel_regularizer\": null, \"bias_initializer\": {\"class_name\": \"Zeros\", \"config\": {}}, \"units\": 10, \"batch_input_shape\": [null, 4], \"use_bias\": true, \"activity_regularizer\": null}}, {\"class_name\": \"Dense\", \"config\": {\"kernel_initializer\": {\"class_name\": \"VarianceScaling\", \"config\": {\"distribution\": \"uniform\", \"scale\": 1.0, \"seed\": null, \"mode\": \"fan_avg\"}}, \"name\": \"dense_2\", \"kernel_constraint\": null, \"bias_regularizer\": null, \"bias_constraint\": null, \"activation\": \"relu\", \"trainable\": true, \"kernel_regularizer\": null, \"bias_initializer\": {\"class_name\": \"Zeros\", \"config\": {}}, \"units\": 10, \"use_bias\": true, \"activity_regularizer\": null}}, {\"class_name\": \"Dense\", \"config\": {\"kernel_initializer\": {\"class_name\": \"VarianceScaling\", \"config\": {\"distribution\": \"uniform\", \"scale\": 1.0, \"seed\": null, \"mode\": \"fan_avg\"}}, \"name\": \"dense_3\", \"kernel_constraint\": null, \"bias_regularizer\": null, \"bias_constraint\": null, \"activation\": \"softmax\", \"trainable\": true, \"kernel_regularizer\": null, \"bias_initializer\": {\"class_name\": \"Zeros\", \"config\": {}}, \"units\": 3, \"use_bias\": true, \"activity_regularizer\": null}}], \"backend\": \"tensorflow\"}\r\n$MAD$,\r\n                                            $1,\r\n                                            $__madlib__$ loss='categorical_crossentropy', optimizer='adam', metrics=['accuracy'] $__madlib__$,\r\n                                            __table__.__dist_key__,\r\n                                            ARRAY[1, 0],\r\n                                            __table__.gp_segment_id,\r\n                                            ARRAY[2, 2],\r\n                                            ARRAY[60, 60],\r\n                                            ARRAY[0, 0],\r\n                                            True,\r\n                                            $2\r\n                                            )) as loss_metric\r\n        from iris_train_packed AS __table__\r\nCONTEXT:  PL/Python function \"madlib_keras_fit\"\r\nINFO:  \r\n\tTime for training in iteration 10: 0.101819038391 sec\r\nDETAIL:  \r\n\tTime for evaluating training dataset in iteration 10: 0.0550060272217 sec\r\n\tTraining set metric after iteration 10: 0.458333343267\r\n\tTraining set loss after iteration 10: 0.788652122021\r\nCONTEXT:  PL/Python function \"madlib_keras_fit\"\r\n madlib_keras_fit \r\n------------------\r\n \r\n(1 row)\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/784616302/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/784665248","html_url":"https://github.com/apache/madlib/pull/524#issuecomment-784665248","issue_url":"https://api.github.com/repos/apache/madlib/issues/524","id":784665248,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NDY2NTI0OA==","user":{"login":"fmcquillan99","id":10538173,"node_id":"MDQ6VXNlcjEwNTM4MTcz","avatar_url":"https://avatars.githubusercontent.com/u/10538173?v=4","gravatar_id":"","url":"https://api.github.com/users/fmcquillan99","html_url":"https://github.com/fmcquillan99","followers_url":"https://api.github.com/users/fmcquillan99/followers","following_url":"https://api.github.com/users/fmcquillan99/following{/other_user}","gists_url":"https://api.github.com/users/fmcquillan99/gists{/gist_id}","starred_url":"https://api.github.com/users/fmcquillan99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmcquillan99/subscriptions","organizations_url":"https://api.github.com/users/fmcquillan99/orgs","repos_url":"https://api.github.com/users/fmcquillan99/repos","events_url":"https://api.github.com/users/fmcquillan99/events{/privacy}","received_events_url":"https://api.github.com/users/fmcquillan99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T01:28:40Z","updated_at":"2021-02-24T01:29:06Z","author_association":"NONE","body":"(2) error when generating MSTs with TensorBoard:\r\n```\r\nmadlib=# SELECT madlib.generate_model_configs(\r\nmadlib(#                                         'model_arch_library', -- model architecture table\r\nmadlib(#                                         'mst_table',          -- model selection table output\r\nmadlib(#                                          ARRAY[1,2],          -- model ids from model architecture table\r\nmadlib(#                                          $$\r\nmadlib$#                                             {'loss': ['categorical_crossentropy'],\r\nmadlib$#                                              'optimizer_params_list': [ {'optimizer': ['Adam', 'SGD'], 'lr': [0.001, 0.01]} ],\r\nmadlib$#                                              'metrics': ['accuracy']}\r\nmadlib$#                                          $$,                  -- compile_param_grid\r\nmadlib(#                                          $$\r\nmadlib$#                                          { 'batch_size': [64, 128],\r\nmadlib$#                                            'epochs': [10],\r\nmadlib$#                                            'callbacks': ['[TensorBoard(log_dir=\"/tmp/logs/fit\")]']\r\nmadlib$#                                          }\r\nmadlib$#                                          $$,                  -- fit_param_grid\r\nmadlib(#                                          'grid'               -- search_type\r\nmadlib(#                                          );\r\nERROR:  plpy.Error: DL: Cannot search from a distribution with grid search (plpython.c:5038)\r\nCONTEXT:  Traceback (most recent call last):\r\n  PL/Python function \"generate_model_configs\", line 21, in <module>\r\n    mst_loader = madlib_keras_model_selection.MstSearch(**globals())\r\n  PL/Python function \"generate_model_configs\", line 42, in wrapper\r\n  PL/Python function \"generate_model_configs\", line 309, in __init__\r\n  PL/Python function \"generate_model_configs\", line 364, in validate_inputs\r\n  PL/Python function \"generate_model_configs\", line 105, in _assert\r\nPL/Python function \"generate_model_configs\"\r\n```","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/784665248/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/784667171","html_url":"https://github.com/apache/madlib/pull/524#issuecomment-784667171","issue_url":"https://api.github.com/repos/apache/madlib/issues/524","id":784667171,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NDY2NzE3MQ==","user":{"login":"fmcquillan99","id":10538173,"node_id":"MDQ6VXNlcjEwNTM4MTcz","avatar_url":"https://avatars.githubusercontent.com/u/10538173?v=4","gravatar_id":"","url":"https://api.github.com/users/fmcquillan99","html_url":"https://github.com/fmcquillan99","followers_url":"https://api.github.com/users/fmcquillan99/followers","following_url":"https://api.github.com/users/fmcquillan99/following{/other_user}","gists_url":"https://api.github.com/users/fmcquillan99/gists{/gist_id}","starred_url":"https://api.github.com/users/fmcquillan99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmcquillan99/subscriptions","organizations_url":"https://api.github.com/users/fmcquillan99/orgs","repos_url":"https://api.github.com/users/fmcquillan99/repos","events_url":"https://api.github.com/users/fmcquillan99/events{/privacy}","received_events_url":"https://api.github.com/users/fmcquillan99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T01:32:55Z","updated_at":"2021-02-24T01:35:56Z","author_association":"NONE","body":"(3). autoML doesn't seem to work either\r\n```\r\nmadlib=# SELECT madlib.madlib_keras_automl('iris_train_packed',                -- source table\r\nmadlib(#                                   'automl_output',                    -- model output table\r\nmadlib(#                                   'model_arch_library',               -- model architecture table\r\nmadlib(#                                   'automl_mst_table',                 -- model selection output table\r\nmadlib(#                                   ARRAY[1,2],                         -- model IDs\r\nmadlib(#                                   $${\r\nmadlib$#                                       'loss': ['categorical_crossentropy'],\r\nmadlib$#                                       'optimizer_params_list': [\r\nmadlib$#                                           {'optimizer': ['Adam'],'lr': [0.001, 0.1, 'log']},\r\nmadlib$#                                           {'optimizer': ['RMSprop'],'lr': [0.001, 0.1, 'log']}\r\nmadlib$#                                       ],\r\nmadlib$#                                       'metrics': ['accuracy']\r\nmadlib$#                                   } $$,                               -- compile param grid\r\nmadlib(#                                   $${'batch_size': [4, 8], 'epochs': [1], 'callbacks': ['[TensorBoard(log_dir=\"/tmp/logs/fit\")]'}$$,  -- fit params grid\r\nmadlib(#                                   'hyperband',                        -- autoML method\r\nmadlib(#                                   'R=9, eta=3, skip_last=0',          -- autoML params\r\nmadlib(#                                   NULL,                               -- random state\r\nmadlib(#                                   NULL,                               -- object table\r\nmadlib(#                                   FALSE,                              -- use GPUs\r\nmadlib(#                                   'iris_test_packed',                 -- validation table\r\nmadlib(#                                   1,                                  -- metrics compute freq\r\nmadlib(#                                   NULL,                               -- name\r\nmadlib(#                                   NULL);                              -- descr\r\nERROR:  plpy.Error: Invalid syntax in 'fit_params_dict' (plpython.c:5038)\r\nCONTEXT:  Traceback (most recent call last):\r\n  PL/Python function \"madlib_keras_automl\", line 23, in <module>\r\n    schedule_loader = madlib_keras_automl_hyperband.AutoMLHyperband(**globals())\r\n  PL/Python function \"madlib_keras_automl\", line 165, in __init__\r\n  PL/Python function \"madlib_keras_automl\", line 214, in find_hyperband_config\r\n  PL/Python function \"madlib_keras_automl\", line 42, in wrapper\r\n  PL/Python function \"madlib_keras_automl\", line 308, in __init__\r\nPL/Python function \"madlib_keras_automl\"\r\n```","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/784667171/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/785163577","html_url":"https://github.com/apache/madlib/pull/524#issuecomment-785163577","issue_url":"https://api.github.com/repos/apache/madlib/issues/524","id":785163577,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTE2MzU3Nw==","user":{"login":"orhankislal","id":9490520,"node_id":"MDQ6VXNlcjk0OTA1MjA=","avatar_url":"https://avatars.githubusercontent.com/u/9490520?v=4","gravatar_id":"","url":"https://api.github.com/users/orhankislal","html_url":"https://github.com/orhankislal","followers_url":"https://api.github.com/users/orhankislal/followers","following_url":"https://api.github.com/users/orhankislal/following{/other_user}","gists_url":"https://api.github.com/users/orhankislal/gists{/gist_id}","starred_url":"https://api.github.com/users/orhankislal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/orhankislal/subscriptions","organizations_url":"https://api.github.com/users/orhankislal/orgs","repos_url":"https://api.github.com/users/orhankislal/repos","events_url":"https://api.github.com/users/orhankislal/events{/privacy}","received_events_url":"https://api.github.com/users/orhankislal/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T15:37:56Z","updated_at":"2021-02-24T15:38:06Z","author_association":"CONTRIBUTOR","body":"> (1)\r\n> turn off verbose write to console\r\n> \r\nThis is unrelated to this PR. The fix is already included in a different PR.\r\n","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/785163577/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/785168625","html_url":"https://github.com/apache/madlib/pull/524#issuecomment-785168625","issue_url":"https://api.github.com/repos/apache/madlib/issues/524","id":785168625,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTE2ODYyNQ==","user":{"login":"orhankislal","id":9490520,"node_id":"MDQ6VXNlcjk0OTA1MjA=","avatar_url":"https://avatars.githubusercontent.com/u/9490520?v=4","gravatar_id":"","url":"https://api.github.com/users/orhankislal","html_url":"https://github.com/orhankislal","followers_url":"https://api.github.com/users/orhankislal/followers","following_url":"https://api.github.com/users/orhankislal/following{/other_user}","gists_url":"https://api.github.com/users/orhankislal/gists{/gist_id}","starred_url":"https://api.github.com/users/orhankislal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/orhankislal/subscriptions","organizations_url":"https://api.github.com/users/orhankislal/orgs","repos_url":"https://api.github.com/users/orhankislal/repos","events_url":"https://api.github.com/users/orhankislal/events{/privacy}","received_events_url":"https://api.github.com/users/orhankislal/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T15:44:54Z","updated_at":"2021-02-24T15:44:54Z","author_association":"CONTRIBUTOR","body":"> ERROR:  plpy.Error: DL: Cannot search from a distribution with grid search (plpython.c:5038)\r\n\r\nThis happens because our code checks if the string `log` appears anywhere in the fit or compile params during validation. The folder I tested with did not have `log` but your test does which caused the issue. I'll fix it.","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/785168625/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/785182965","html_url":"https://github.com/apache/madlib/pull/524#issuecomment-785182965","issue_url":"https://api.github.com/repos/apache/madlib/issues/524","id":785182965,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTE4Mjk2NQ==","user":{"login":"fmcquillan99","id":10538173,"node_id":"MDQ6VXNlcjEwNTM4MTcz","avatar_url":"https://avatars.githubusercontent.com/u/10538173?v=4","gravatar_id":"","url":"https://api.github.com/users/fmcquillan99","html_url":"https://github.com/fmcquillan99","followers_url":"https://api.github.com/users/fmcquillan99/followers","following_url":"https://api.github.com/users/fmcquillan99/following{/other_user}","gists_url":"https://api.github.com/users/fmcquillan99/gists{/gist_id}","starred_url":"https://api.github.com/users/fmcquillan99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmcquillan99/subscriptions","organizations_url":"https://api.github.com/users/fmcquillan99/orgs","repos_url":"https://api.github.com/users/fmcquillan99/repos","events_url":"https://api.github.com/users/fmcquillan99/events{/privacy}","received_events_url":"https://api.github.com/users/fmcquillan99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T16:04:31Z","updated_at":"2021-02-24T16:04:31Z","author_association":"NONE","body":"I see, please make a general fix not just for the specific case of `log`","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/785182965/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/785190051","html_url":"https://github.com/apache/madlib/pull/524#issuecomment-785190051","issue_url":"https://api.github.com/repos/apache/madlib/issues/524","id":785190051,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTE5MDA1MQ==","user":{"login":"orhankislal","id":9490520,"node_id":"MDQ6VXNlcjk0OTA1MjA=","avatar_url":"https://avatars.githubusercontent.com/u/9490520?v=4","gravatar_id":"","url":"https://api.github.com/users/orhankislal","html_url":"https://github.com/orhankislal","followers_url":"https://api.github.com/users/orhankislal/followers","following_url":"https://api.github.com/users/orhankislal/following{/other_user}","gists_url":"https://api.github.com/users/orhankislal/gists{/gist_id}","starred_url":"https://api.github.com/users/orhankislal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/orhankislal/subscriptions","organizations_url":"https://api.github.com/users/orhankislal/orgs","repos_url":"https://api.github.com/users/orhankislal/repos","events_url":"https://api.github.com/users/orhankislal/events{/privacy}","received_events_url":"https://api.github.com/users/orhankislal/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T16:14:36Z","updated_at":"2021-02-24T16:14:36Z","author_association":"CONTRIBUTOR","body":"> I see, please make a general fix not just for the specific case of `log`\r\n\r\nWill do!","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/785190051/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/785238377","html_url":"https://github.com/apache/madlib/pull/524#issuecomment-785238377","issue_url":"https://api.github.com/repos/apache/madlib/issues/524","id":785238377,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTIzODM3Nw==","user":{"login":"orhankislal","id":9490520,"node_id":"MDQ6VXNlcjk0OTA1MjA=","avatar_url":"https://avatars.githubusercontent.com/u/9490520?v=4","gravatar_id":"","url":"https://api.github.com/users/orhankislal","html_url":"https://github.com/orhankislal","followers_url":"https://api.github.com/users/orhankislal/followers","following_url":"https://api.github.com/users/orhankislal/following{/other_user}","gists_url":"https://api.github.com/users/orhankislal/gists{/gist_id}","starred_url":"https://api.github.com/users/orhankislal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/orhankislal/subscriptions","organizations_url":"https://api.github.com/users/orhankislal/orgs","repos_url":"https://api.github.com/users/orhankislal/repos","events_url":"https://api.github.com/users/orhankislal/events{/privacy}","received_events_url":"https://api.github.com/users/orhankislal/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T17:22:04Z","updated_at":"2021-02-24T17:22:04Z","author_association":"CONTRIBUTOR","body":"> (3). autoML doesn't seem to work either\r\n> madlib(#                                   $${'batch_size': [4, 8], 'epochs': [1], 'callbacks': ['[TensorBoard(log_dir=\"/tmp/logs/fit\")]'}$$,  -- fit params grid\r\n\r\nYou are missing the closing ] of callbacks `'callbacks': ['[TensorBoard(log_dir=\"/tmp/logs/fit\")]'` -> `'callbacks': ['[TensorBoard(log_dir=\"/tmp/logs/fit\")]']`\r\n","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/785238377/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/785321018","html_url":"https://github.com/apache/madlib/pull/524#issuecomment-785321018","issue_url":"https://api.github.com/repos/apache/madlib/issues/524","id":785321018,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTMyMTAxOA==","user":{"login":"fmcquillan99","id":10538173,"node_id":"MDQ6VXNlcjEwNTM4MTcz","avatar_url":"https://avatars.githubusercontent.com/u/10538173?v=4","gravatar_id":"","url":"https://api.github.com/users/fmcquillan99","html_url":"https://github.com/fmcquillan99","followers_url":"https://api.github.com/users/fmcquillan99/followers","following_url":"https://api.github.com/users/fmcquillan99/following{/other_user}","gists_url":"https://api.github.com/users/fmcquillan99/gists{/gist_id}","starred_url":"https://api.github.com/users/fmcquillan99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmcquillan99/subscriptions","organizations_url":"https://api.github.com/users/fmcquillan99/orgs","repos_url":"https://api.github.com/users/fmcquillan99/repos","events_url":"https://api.github.com/users/fmcquillan99/events{/privacy}","received_events_url":"https://api.github.com/users/fmcquillan99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T19:33:42Z","updated_at":"2021-02-24T20:03:45Z","author_association":"NONE","body":"LGTM\r\n\r\nI added a couple user doc comments about callbacks and TensorBoard support as part of \r\nhttps://github.com/apache/madlib/pull/534\r\n\r\n@kaknikhil can you please review this PR?  thx","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/785321018/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/785337568","html_url":"https://github.com/apache/madlib/pull/534#issuecomment-785337568","issue_url":"https://api.github.com/repos/apache/madlib/issues/534","id":785337568,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTMzNzU2OA==","user":{"login":"fmcquillan99","id":10538173,"node_id":"MDQ6VXNlcjEwNTM4MTcz","avatar_url":"https://avatars.githubusercontent.com/u/10538173?v=4","gravatar_id":"","url":"https://api.github.com/users/fmcquillan99","html_url":"https://github.com/fmcquillan99","followers_url":"https://api.github.com/users/fmcquillan99/followers","following_url":"https://api.github.com/users/fmcquillan99/following{/other_user}","gists_url":"https://api.github.com/users/fmcquillan99/gists{/gist_id}","starred_url":"https://api.github.com/users/fmcquillan99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmcquillan99/subscriptions","organizations_url":"https://api.github.com/users/fmcquillan99/orgs","repos_url":"https://api.github.com/users/fmcquillan99/repos","events_url":"https://api.github.com/users/fmcquillan99/events{/privacy}","received_events_url":"https://api.github.com/users/fmcquillan99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T20:03:01Z","updated_at":"2021-02-24T20:03:01Z","author_association":"NONE","body":"@kaknikhil Can you please review?  Focus less on user doc content and more on software changes, thx","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/785337568/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/785497297","html_url":"https://github.com/apache/madlib/pull/551#issuecomment-785497297","issue_url":"https://api.github.com/repos/apache/madlib/issues/551","id":785497297,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTQ5NzI5Nw==","user":{"login":"reductionista","id":2644901,"node_id":"MDQ6VXNlcjI2NDQ5MDE=","avatar_url":"https://avatars.githubusercontent.com/u/2644901?v=4","gravatar_id":"","url":"https://api.github.com/users/reductionista","html_url":"https://github.com/reductionista","followers_url":"https://api.github.com/users/reductionista/followers","following_url":"https://api.github.com/users/reductionista/following{/other_user}","gists_url":"https://api.github.com/users/reductionista/gists{/gist_id}","starred_url":"https://api.github.com/users/reductionista/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/reductionista/subscriptions","organizations_url":"https://api.github.com/users/reductionista/orgs","repos_url":"https://api.github.com/users/reductionista/repos","events_url":"https://api.github.com/users/reductionista/events{/privacy}","received_events_url":"https://api.github.com/users/reductionista/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-25T00:58:24Z","updated_at":"2021-02-25T00:58:24Z","author_association":"CONTRIBUTOR","body":"LGTM","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/785497297/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/786764040","html_url":"https://github.com/apache/madlib/pull/555#issuecomment-786764040","issue_url":"https://api.github.com/repos/apache/madlib/issues/555","id":786764040,"node_id":"MDEyOklzc3VlQ29tbWVudDc4Njc2NDA0MA==","user":{"login":"orhankislal","id":9490520,"node_id":"MDQ6VXNlcjk0OTA1MjA=","avatar_url":"https://avatars.githubusercontent.com/u/9490520?v=4","gravatar_id":"","url":"https://api.github.com/users/orhankislal","html_url":"https://github.com/orhankislal","followers_url":"https://api.github.com/users/orhankislal/followers","following_url":"https://api.github.com/users/orhankislal/following{/other_user}","gists_url":"https://api.github.com/users/orhankislal/gists{/gist_id}","starred_url":"https://api.github.com/users/orhankislal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/orhankislal/subscriptions","organizations_url":"https://api.github.com/users/orhankislal/orgs","repos_url":"https://api.github.com/users/orhankislal/repos","events_url":"https://api.github.com/users/orhankislal/events{/privacy}","received_events_url":"https://api.github.com/users/orhankislal/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-26T16:50:45Z","updated_at":"2021-02-26T16:50:45Z","author_association":"CONTRIBUTOR","body":"This PR is created to squash the commits and rebase on master while keeping the old commit messages just in case.","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/786764040/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/789121252","html_url":"https://github.com/apache/madlib/pull/534#issuecomment-789121252","issue_url":"https://api.github.com/repos/apache/madlib/issues/534","id":789121252,"node_id":"MDEyOklzc3VlQ29tbWVudDc4OTEyMTI1Mg==","user":{"login":"fmcquillan99","id":10538173,"node_id":"MDQ6VXNlcjEwNTM4MTcz","avatar_url":"https://avatars.githubusercontent.com/u/10538173?v=4","gravatar_id":"","url":"https://api.github.com/users/fmcquillan99","html_url":"https://github.com/fmcquillan99","followers_url":"https://api.github.com/users/fmcquillan99/followers","following_url":"https://api.github.com/users/fmcquillan99/following{/other_user}","gists_url":"https://api.github.com/users/fmcquillan99/gists{/gist_id}","starred_url":"https://api.github.com/users/fmcquillan99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmcquillan99/subscriptions","organizations_url":"https://api.github.com/users/fmcquillan99/orgs","repos_url":"https://api.github.com/users/fmcquillan99/repos","events_url":"https://api.github.com/users/fmcquillan99/events{/privacy}","received_events_url":"https://api.github.com/users/fmcquillan99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-02T18:33:35Z","updated_at":"2021-03-02T18:33:35Z","author_association":"NONE","body":"LGTM","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/789121252/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/790183101","html_url":"https://github.com/apache/madlib/pull/554#issuecomment-790183101","issue_url":"https://api.github.com/repos/apache/madlib/issues/554","id":790183101,"node_id":"MDEyOklzc3VlQ29tbWVudDc5MDE4MzEwMQ==","user":{"login":"fmcquillan99","id":10538173,"node_id":"MDQ6VXNlcjEwNTM4MTcz","avatar_url":"https://avatars.githubusercontent.com/u/10538173?v=4","gravatar_id":"","url":"https://api.github.com/users/fmcquillan99","html_url":"https://github.com/fmcquillan99","followers_url":"https://api.github.com/users/fmcquillan99/followers","following_url":"https://api.github.com/users/fmcquillan99/following{/other_user}","gists_url":"https://api.github.com/users/fmcquillan99/gists{/gist_id}","starred_url":"https://api.github.com/users/fmcquillan99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmcquillan99/subscriptions","organizations_url":"https://api.github.com/users/fmcquillan99/orgs","repos_url":"https://api.github.com/users/fmcquillan99/repos","events_url":"https://api.github.com/users/fmcquillan99/events{/privacy}","received_events_url":"https://api.github.com/users/fmcquillan99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-04T00:24:29Z","updated_at":"2021-03-04T00:24:29Z","author_association":"NONE","body":"If I run this 1x it works\r\n```\r\n# import database connector psycopg2 and create connection cursor\r\nimport psycopg2 as p2\r\nconn = p2.connect('postgresql://gpadmin@localhost:8000/madlib')\r\ncur = conn.cursor()\r\n\r\n# import Dill and define functions\r\nimport dill\r\n\r\n# custom loss\r\ndef squared_error(y_true, y_pred):\r\n    import tensorflow.keras.backend as K\r\n    return K.square(y_pred - y_true)\r\npb_squared_error=dill.dumps(squared_error)\r\n\r\n# custom metric\r\ndef rmse(y_true, y_pred):\r\n    import tensorflow.keras.backend as K\r\n    return K.sqrt(K.mean(K.square(y_pred - y_true), axis=-1))\r\npb_rmse=dill.dumps(rmse)\r\n\r\n# call load function\r\ncur.execute(\"DROP TABLE IF EXISTS custom_function_table\")\r\ncur.execute(\"SELECT madlib.load_custom_function('custom_function_table',  %s,'squared_error', 'squared error')\", [p2.Binary(pb_squared_error)])\r\ncur.execute(\"SELECT madlib.load_custom_function('custom_function_table',  %s,'rmse', 'root mean square error')\", [p2.Binary(pb_rmse)])\r\nconn.commit()\r\n```\r\nBut if I run it a second time I get this error:\r\n```\r\n---------------------------------------------------------------------------\r\nInternalError_                            Traceback (most recent call last)\r\n<ipython-input-20-03935b6aea23> in <module>()\r\n     21 # call load function\r\n     22 cur.execute(\"DROP TABLE IF EXISTS custom_function_table\")\r\n---> 23 cur.execute(\"SELECT madlib.load_custom_function('custom_function_table',  %s,'squared_error', 'squared error')\", [p2.Binary(pb_squared_error)])\r\n     24 cur.execute(\"SELECT madlib.load_custom_function('custom_function_table',  %s,'rmse', 'root mean square error')\", [p2.Binary(pb_rmse)])\r\n     25 conn.commit()\r\n\r\nInternalError_: plpy.Error: Function 'squared_error' already exists in madlib.custom_function_table (plpython.c:5038)\r\nCONTEXT:  Traceback (most recent call last):\r\n  PL/Python function \"load_custom_function\", line 21, in <module>\r\n    madlib_keras_custom_function.load_custom_function(**globals())\r\n  PL/Python function \"load_custom_function\", line 42, in wrapper\r\n  PL/Python function \"load_custom_function\", line 120, in load_custom_function\r\nPL/Python function \"load_custom_function\"\r\n```\r\n\r\nIt look like it created the `custom_function_table` in the madlib schema even though I was working in the public schema. So the `DROP TABLE IF EXISTS custom_function_table`  did not work.  If I change it to `DROP TABLE IF EXISTS madlib.custom_function_table` then it does work.\r\n\r\nIs that the intended behavior?","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/790183101/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/790190171","html_url":"https://github.com/apache/madlib/pull/554#issuecomment-790190171","issue_url":"https://api.github.com/repos/apache/madlib/issues/554","id":790190171,"node_id":"MDEyOklzc3VlQ29tbWVudDc5MDE5MDE3MQ==","user":{"login":"fmcquillan99","id":10538173,"node_id":"MDQ6VXNlcjEwNTM4MTcz","avatar_url":"https://avatars.githubusercontent.com/u/10538173?v=4","gravatar_id":"","url":"https://api.github.com/users/fmcquillan99","html_url":"https://github.com/fmcquillan99","followers_url":"https://api.github.com/users/fmcquillan99/followers","following_url":"https://api.github.com/users/fmcquillan99/following{/other_user}","gists_url":"https://api.github.com/users/fmcquillan99/gists{/gist_id}","starred_url":"https://api.github.com/users/fmcquillan99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmcquillan99/subscriptions","organizations_url":"https://api.github.com/users/fmcquillan99/orgs","repos_url":"https://api.github.com/users/fmcquillan99/repos","events_url":"https://api.github.com/users/fmcquillan99/events{/privacy}","received_events_url":"https://api.github.com/users/fmcquillan99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-04T00:37:32Z","updated_at":"2021-03-04T00:38:13Z","author_association":"NONE","body":"Also if I prepend with schema to the table in the load utility\r\n```\r\ncur.execute(\"DROP TABLE IF EXISTS madlib.custom_function_table\")\r\ncur.execute(\"SELECT madlib.load_custom_function('madlib.custom_function_table',  %s,'squared_error', 'squared error')\", [p2.Binary(pb_squared_error)])\r\ncur.execute(\"SELECT madlib.load_custom_function('madlib.custom_function_table',  %s,'rmse', 'root mean square error')\", [p2.Binary(pb_rmse)])\r\nconn.commit()\r\n```\r\nI get this error\r\n```\r\n---------------------------------------------------------------------------\r\nInternalError_                            Traceback (most recent call last)\r\n<ipython-input-5-c77ecf220203> in <module>()\r\n     21 # call load function\r\n     22 cur.execute(\"DROP TABLE IF EXISTS madlib.custom_function_table\")\r\n---> 23 cur.execute(\"SELECT madlib.load_custom_function('madlib.custom_function_table',  %s,'squared_error', 'squared error')\", [p2.Binary(pb_squared_error)])\r\n     24 cur.execute(\"SELECT madlib.load_custom_function('madlib.custom_function_table',  %s,'rmse', 'root mean square error')\", [p2.Binary(pb_rmse)])\r\n     25 conn.commit()\r\n\r\nInternalError_: plpy.Error: Incorrect table name (madlib.\"madlib.custom_function_table\") provided! Table name should be of the form: <schema name>.<table name> (plpython.c:5038)\r\nCONTEXT:  Traceback (most recent call last):\r\n  PL/Python function \"load_custom_function\", line 21, in <module>\r\n    madlib_keras_custom_function.load_custom_function(**globals())\r\n  PL/Python function \"load_custom_function\", line 42, in wrapper\r\n  PL/Python function \"load_custom_function\", line 121, in load_custom_function\r\nPL/Python function \"load_custom_function\"\r\n```\r\nso I am not sure how to use this utility or what the rules are.","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/790190171/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/790402878","html_url":"https://github.com/apache/madlib/pull/554#issuecomment-790402878","issue_url":"https://api.github.com/repos/apache/madlib/issues/554","id":790402878,"node_id":"MDEyOklzc3VlQ29tbWVudDc5MDQwMjg3OA==","user":{"login":"orhankislal","id":9490520,"node_id":"MDQ6VXNlcjk0OTA1MjA=","avatar_url":"https://avatars.githubusercontent.com/u/9490520?v=4","gravatar_id":"","url":"https://api.github.com/users/orhankislal","html_url":"https://github.com/orhankislal","followers_url":"https://api.github.com/users/orhankislal/followers","following_url":"https://api.github.com/users/orhankislal/following{/other_user}","gists_url":"https://api.github.com/users/orhankislal/gists{/gist_id}","starred_url":"https://api.github.com/users/orhankislal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/orhankislal/subscriptions","organizations_url":"https://api.github.com/users/orhankislal/orgs","repos_url":"https://api.github.com/users/orhankislal/repos","events_url":"https://api.github.com/users/orhankislal/events{/privacy}","received_events_url":"https://api.github.com/users/orhankislal/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-04T07:49:36Z","updated_at":"2021-03-04T07:49:36Z","author_association":"CONTRIBUTOR","body":"> It look like it created the `custom_function_table` in the madlib schema even though I was working in the public schema. So the `DROP TABLE IF EXISTS custom_function_table` did not work. If I change it to `DROP TABLE IF EXISTS madlib.custom_function_table` then it does work.\r\n> \r\n> Is that the intended behavior?\r\n\r\nYes, this is the intended behavior. The custom_function_table is created in the madlib schema, it doesn't matter what your search_path looks like. Your code tries to drop the non-existent `public.custom_function_table` and then tries to load the `squared_error` function a second time on the `madlib.custom_function_table` table which fails as expected. \r\nSince you are an admin, you are allowed to drop tables from the `madlib` schema.\r\n","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/790402878/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/790406426","html_url":"https://github.com/apache/madlib/pull/554#issuecomment-790406426","issue_url":"https://api.github.com/repos/apache/madlib/issues/554","id":790406426,"node_id":"MDEyOklzc3VlQ29tbWVudDc5MDQwNjQyNg==","user":{"login":"orhankislal","id":9490520,"node_id":"MDQ6VXNlcjk0OTA1MjA=","avatar_url":"https://avatars.githubusercontent.com/u/9490520?v=4","gravatar_id":"","url":"https://api.github.com/users/orhankislal","html_url":"https://github.com/orhankislal","followers_url":"https://api.github.com/users/orhankislal/followers","following_url":"https://api.github.com/users/orhankislal/following{/other_user}","gists_url":"https://api.github.com/users/orhankislal/gists{/gist_id}","starred_url":"https://api.github.com/users/orhankislal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/orhankislal/subscriptions","organizations_url":"https://api.github.com/users/orhankislal/orgs","repos_url":"https://api.github.com/users/orhankislal/repos","events_url":"https://api.github.com/users/orhankislal/events{/privacy}","received_events_url":"https://api.github.com/users/orhankislal/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-04T07:56:06Z","updated_at":"2021-03-04T07:56:06Z","author_association":"CONTRIBUTOR","body":"> Also if I prepend with schema to the table in the load utility\r\n> ...\r\n> I get this error\r\n> ...\r\n> so I am not sure how to use this utility or what the rules are.\r\n\r\nThe rule is to just give a table name without any schema. We append the madlib schema and create the table there. If you want to delete a function, there is `delete_custom_function` with the same rule (no schema in the table name). This will actually drop the table if you remove every custom function therein. If you don't want to delete the functions one-by-one and want to completely get rid of the table right away, then you'll have to do it manually by using the madlib schema. If that seems confusing, we can add a new function to drop the whole table as well. ","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/790406426/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/790936348","html_url":"https://github.com/apache/madlib/pull/554#issuecomment-790936348","issue_url":"https://api.github.com/repos/apache/madlib/issues/554","id":790936348,"node_id":"MDEyOklzc3VlQ29tbWVudDc5MDkzNjM0OA==","user":{"login":"reductionista","id":2644901,"node_id":"MDQ6VXNlcjI2NDQ5MDE=","avatar_url":"https://avatars.githubusercontent.com/u/2644901?v=4","gravatar_id":"","url":"https://api.github.com/users/reductionista","html_url":"https://github.com/reductionista","followers_url":"https://api.github.com/users/reductionista/followers","following_url":"https://api.github.com/users/reductionista/following{/other_user}","gists_url":"https://api.github.com/users/reductionista/gists{/gist_id}","starred_url":"https://api.github.com/users/reductionista/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/reductionista/subscriptions","organizations_url":"https://api.github.com/users/reductionista/orgs","repos_url":"https://api.github.com/users/reductionista/repos","events_url":"https://api.github.com/users/reductionista/events{/privacy}","received_events_url":"https://api.github.com/users/reductionista/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-04T20:57:42Z","updated_at":"2021-03-04T21:41:12Z","author_association":"CONTRIBUTOR","body":"> The rule is to just give a table name without any schema. We append the madlib schema and create the table there. If you want > to delete a function, there is `delete_custom_function` with the same rule (no schema in the table name). This will actually drop > the table if you remove every custom function therein. If you don't want to delete the functions one-by-one and want to \r\n> completely get rid of the table right away, then you'll have to do it manually by using the madlib schema. If that seems\r\n> confusing, we can add a new function to drop the whole table as well.\r\n\r\nI still think the ideal behavior would be to let both the admin and the user pass in any path to any table in any schema they want, either fully qualified or relative to their search_path.  I think this would be simpler and probably less risky, as well as allowing the admin more flexibility in where they want to have the table stored.\r\n\r\nBut if it's easier to leave it the way it is for this release, then I'm fine with that... as long as we're sure there aren't any loopholes.  I think the main thing we need to be sure of, in either case, is that the table we check permissions on is the same one we read from--so let's make sure any modification of what they pass in happens before the check rather than after.","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/790936348/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/792925492","html_url":"https://github.com/apache/madlib/pull/558#issuecomment-792925492","issue_url":"https://api.github.com/repos/apache/madlib/issues/558","id":792925492,"node_id":"MDEyOklzc3VlQ29tbWVudDc5MjkyNTQ5Mg==","user":{"login":"fmcquillan99","id":10538173,"node_id":"MDQ6VXNlcjEwNTM4MTcz","avatar_url":"https://avatars.githubusercontent.com/u/10538173?v=4","gravatar_id":"","url":"https://api.github.com/users/fmcquillan99","html_url":"https://github.com/fmcquillan99","followers_url":"https://api.github.com/users/fmcquillan99/followers","following_url":"https://api.github.com/users/fmcquillan99/following{/other_user}","gists_url":"https://api.github.com/users/fmcquillan99/gists{/gist_id}","starred_url":"https://api.github.com/users/fmcquillan99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmcquillan99/subscriptions","organizations_url":"https://api.github.com/users/fmcquillan99/orgs","repos_url":"https://api.github.com/users/fmcquillan99/repos","events_url":"https://api.github.com/users/fmcquillan99/events{/privacy}","received_events_url":"https://api.github.com/users/fmcquillan99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-08T17:26:05Z","updated_at":"2021-03-08T17:26:05Z","author_association":"NONE","body":"This works for me with the following model arch on cifar10:\r\n```\r\nfrom __future__ import print_function\r\nfrom tensorflow import keras\r\nfrom tensorflow.keras.datasets import cifar10\r\nfrom tensorflow.keras.preprocessing.image import ImageDataGenerator\r\nfrom tensorflow.keras.models import Sequential\r\nfrom tensorflow.keras.layers import Dense, Dropout, Activation, Flatten\r\nfrom tensorflow.keras.layers import Conv2D, MaxPooling2D\r\nimport os\r\n\r\nbatch_size = 32\r\nnum_classes = 10\r\nepochs = 2\r\ndata_augmentation = True\r\nnum_predictions = 20\r\n#save_dir = os.path.join(os.getcwd(), 'saved_models')\r\n#model_name = 'keras_cifar10_trained_model.h5'\r\n\r\n# The data, split between train and test sets:\r\n(x_train, y_train), (x_test, y_test) = cifar10.load_data()\r\nprint('x_train shape:', x_train.shape)\r\nprint(x_train.shape[0], 'train samples')\r\nprint(x_test.shape[0], 'test samples')\r\n\r\n# Convert class vectors to binary class matrices.\r\ny_train = keras.utils.to_categorical(y_train, num_classes)\r\ny_test = keras.utils.to_categorical(y_test, num_classes)\r\n\r\nmodel = Sequential()\r\nmodel.add(Conv2D(32, (3, 3), padding='same',\r\n                 input_shape=x_train.shape[1:]))\r\nmodel.add(Activation('relu'))\r\nmodel.add(Conv2D(32, (3, 3)))\r\nmodel.add(Activation('relu'))\r\nmodel.add(MaxPooling2D(pool_size=(2, 2)))\r\nmodel.add(Dropout(0.25))\r\n\r\nmodel.add(Conv2D(64, (3, 3), padding='same'))\r\nmodel.add(Activation('relu'))\r\nmodel.add(Conv2D(64, (3, 3)))\r\nmodel.add(Activation('relu'))\r\nmodel.add(MaxPooling2D(pool_size=(2, 2)))\r\nmodel.add(Dropout(0.25))\r\n\r\nmodel.add(Flatten())\r\nmodel.add(Dense(512))\r\nmodel.add(Activation('relu'))\r\nmodel.add(Dropout(0.5))\r\nmodel.add(Dense(num_classes))\r\nmodel.add(Activation('softmax'))\r\n\r\n# initiate RMSprop optimizer\r\nopt = keras.optimizers.RMSprop(lr=0.0001, decay=1e-6)\r\n\r\n# Let's train the model using RMSprop\r\nmodel.compile(loss='categorical_crossentropy',\r\n              optimizer=opt,\r\n              metrics=['accuracy']);\r\n```\r\nLGTM","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/792925492/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/794693836","html_url":"https://github.com/apache/madlib/pull/558#issuecomment-794693836","issue_url":"https://api.github.com/repos/apache/madlib/issues/558","id":794693836,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NDY5MzgzNg==","user":{"login":"kaknikhil","id":11729207,"node_id":"MDQ6VXNlcjExNzI5MjA3","avatar_url":"https://avatars.githubusercontent.com/u/11729207?v=4","gravatar_id":"","url":"https://api.github.com/users/kaknikhil","html_url":"https://github.com/kaknikhil","followers_url":"https://api.github.com/users/kaknikhil/followers","following_url":"https://api.github.com/users/kaknikhil/following{/other_user}","gists_url":"https://api.github.com/users/kaknikhil/gists{/gist_id}","starred_url":"https://api.github.com/users/kaknikhil/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaknikhil/subscriptions","organizations_url":"https://api.github.com/users/kaknikhil/orgs","repos_url":"https://api.github.com/users/kaknikhil/repos","events_url":"https://api.github.com/users/kaknikhil/events{/privacy}","received_events_url":"https://api.github.com/users/kaknikhil/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-10T01:14:40Z","updated_at":"2021-03-10T01:17:13Z","author_association":"CONTRIBUTOR","body":"changes LGTM but I would suggest adding a few unit tests to InputValidatorTestCase to make sure it is well tested since this code also affects non multi io code.\r\n\r\n```\r\n    def test_validate_class_values_last_layer_not_dense(self):\r\n        num_classes = 3\r\n        model = Sequential()\r\n        model.add(Conv2D(2, kernel_size=(1, 1), activation='relu',\r\n                         input_shape=(1,1,1,), padding='same'))\r\n        model.add(Dense(num_classes))\r\n        model.add(Activation('relu'))\r\n        model.add(Activation('softmax'))\r\n\r\n        self.subject.validate_class_values(\r\n            self.module_name, [range(num_classes)], 'prob', model.to_json())\r\n\r\n    def test_validate_class_values_last_layer_not_dense_multiio(self):\r\n        num_classes = 3\r\n        model = Sequential()\r\n        model.add(Conv2D(2, kernel_size=(1, 1), activation='relu',\r\n                         input_shape=(1,1,1,), padding='same'))\r\n        model.add(Dense(num_classes))\r\n        model.add(Dense(num_classes))\r\n        model.add(Activation('relu'))\r\n        model.add(Activation('softmax'))\r\n\r\n        self.subject.validate_class_values(\r\n            self.module_name, [range(num_classes), range(num_classes)], 'prob', model.to_json())\r\n\r\n    def test_validate_class_values_mismatch(self):\r\n        expected_error_regex = \".*do not match.*architecture\"\r\n        num_classes = 3\r\n\r\n        # only one dense layer but len(dep_var) = 2\r\n        model = Sequential()\r\n        model.add(Conv2D(2, kernel_size=(1, 1), activation='relu',\r\n                         input_shape=(1,1,1,), padding='same'))\r\n        model.add(Dense(num_classes))\r\n        model.add(Activation('relu'))\r\n        with self.assertRaisesRegexp(plpy.PLPYException, expected_error_regex):\r\n            self.subject.validate_class_values(\r\n                self.module_name, [range(num_classes), range(num_classes)], 'prob', model.to_json())\r\n\r\n        # two dense layers\r\n        model = Sequential()\r\n        model.add(Conv2D(2, kernel_size=(1, 1), activation='relu',\r\n                         input_shape=(1,1,1,), padding='same'))\r\n        model.add(Dense(2))\r\n        model.add(Dense(num_classes))\r\n        with self.assertRaisesRegexp(plpy.PLPYException, expected_error_regex):\r\n            self.subject.validate_class_values(\r\n                self.module_name, [range(num_classes), range(num_classes)], 'prob', model.to_json())\r\n\r\n    def test_validate_class_values_no_units(self):\r\n        expected_error_regex = \".*Unable.*classes.*architecture\"\r\n        num_classes = 3\r\n        #model arch is missing a dense layer\r\n        model = Sequential()\r\n        model.add(Activation('relu'))\r\n        model.add(Conv2D(2, kernel_size=(1, 1), activation='relu',\r\n                         input_shape=(1,1,1,), padding='same'))\r\n        with self.assertRaisesRegexp(plpy.PLPYException, expected_error_regex):\r\n            self.subject.validate_class_values(\r\n                self.module_name, [range(num_classes)], 'prob', model.to_json())\r\n        with self.assertRaisesRegexp(plpy.PLPYException, expected_error_regex):\r\n            self.subject.validate_class_values(\r\n                self.module_name, [range(num_classes), range(num_classes)], 'prob', model.to_json())\r\n```","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/794693836/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/794730957","html_url":"https://github.com/apache/madlib/pull/559#issuecomment-794730957","issue_url":"https://api.github.com/repos/apache/madlib/issues/559","id":794730957,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NDczMDk1Nw==","user":{"login":"kaknikhil","id":11729207,"node_id":"MDQ6VXNlcjExNzI5MjA3","avatar_url":"https://avatars.githubusercontent.com/u/11729207?v=4","gravatar_id":"","url":"https://api.github.com/users/kaknikhil","html_url":"https://github.com/kaknikhil","followers_url":"https://api.github.com/users/kaknikhil/followers","following_url":"https://api.github.com/users/kaknikhil/following{/other_user}","gists_url":"https://api.github.com/users/kaknikhil/gists{/gist_id}","starred_url":"https://api.github.com/users/kaknikhil/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaknikhil/subscriptions","organizations_url":"https://api.github.com/users/kaknikhil/orgs","repos_url":"https://api.github.com/users/kaknikhil/repos","events_url":"https://api.github.com/users/kaknikhil/events{/privacy}","received_events_url":"https://api.github.com/users/kaknikhil/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-10T01:56:56Z","updated_at":"2021-03-10T01:56:56Z","author_association":"CONTRIBUTOR","body":"LGTM","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/794730957/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/794739940","html_url":"https://github.com/apache/madlib/pull/558#issuecomment-794739940","issue_url":"https://api.github.com/repos/apache/madlib/issues/558","id":794739940,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NDczOTk0MA==","user":{"login":"kaknikhil","id":11729207,"node_id":"MDQ6VXNlcjExNzI5MjA3","avatar_url":"https://avatars.githubusercontent.com/u/11729207?v=4","gravatar_id":"","url":"https://api.github.com/users/kaknikhil","html_url":"https://github.com/kaknikhil","followers_url":"https://api.github.com/users/kaknikhil/followers","following_url":"https://api.github.com/users/kaknikhil/following{/other_user}","gists_url":"https://api.github.com/users/kaknikhil/gists{/gist_id}","starred_url":"https://api.github.com/users/kaknikhil/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaknikhil/subscriptions","organizations_url":"https://api.github.com/users/kaknikhil/orgs","repos_url":"https://api.github.com/users/kaknikhil/repos","events_url":"https://api.github.com/users/kaknikhil/events{/privacy}","received_events_url":"https://api.github.com/users/kaknikhil/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-10T02:07:26Z","updated_at":"2021-03-10T02:08:23Z","author_association":"CONTRIBUTOR","body":"@orhankislal @fmcquillan99 \r\n\r\nAlso noticed that we haven't documented the `dependent_count` argument that was added to `madlib_keras_predict_byom`. We will also need to update the user docs for it\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/794739940/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/796321033","html_url":"https://github.com/apache/madlib/pull/560#issuecomment-796321033","issue_url":"https://api.github.com/repos/apache/madlib/issues/560","id":796321033,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NjMyMTAzMw==","user":{"login":"fmcquillan99","id":10538173,"node_id":"MDQ6VXNlcjEwNTM4MTcz","avatar_url":"https://avatars.githubusercontent.com/u/10538173?v=4","gravatar_id":"","url":"https://api.github.com/users/fmcquillan99","html_url":"https://github.com/fmcquillan99","followers_url":"https://api.github.com/users/fmcquillan99/followers","following_url":"https://api.github.com/users/fmcquillan99/following{/other_user}","gists_url":"https://api.github.com/users/fmcquillan99/gists{/gist_id}","starred_url":"https://api.github.com/users/fmcquillan99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmcquillan99/subscriptions","organizations_url":"https://api.github.com/users/fmcquillan99/orgs","repos_url":"https://api.github.com/users/fmcquillan99/repos","events_url":"https://api.github.com/users/fmcquillan99/events{/privacy}","received_events_url":"https://api.github.com/users/fmcquillan99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T00:30:14Z","updated_at":"2021-03-11T01:18:45Z","author_association":"NONE","body":"(1)\r\n```\r\n# import database connector psycopg2 and create connection cursor\r\nimport psycopg2 as p2\r\nconn = p2.connect('postgresql://gpadmin@localhost:8000/madlib')\r\ncur = conn.cursor()\r\n\r\n# import Dill and define functions\r\nimport dill\r\n\r\n# custom loss\r\ndef __squared_error(y_true, y_pred):\r\n    import tensorflow.keras.backend as K \r\n    return K.square(y_pred - y_true)\r\npb_squared_error=dill.dumps(squared_error)\r\n\r\n# custom metric\r\ndef _rmse(y_true, y_pred):\r\n    import tensorflow.keras.backend as K \r\n    return K.sqrt(K.mean(K.square(y_pred - y_true), axis=-1))\r\npb_rmse=dill.dumps(rmse)\r\n\r\n# call load function\r\ncur.execute(\"DROP TABLE IF EXISTS madlib.custom_function_table\")\r\ncur.execute(\"SELECT madlib.load_custom_function('custom_function_table',  %s,'__squared_error', 'squared error')\", [p2.Binary(pb_squared_error)])\r\ncur.execute(\"SELECT madlib.load_custom_function('custom_function_table',  %s,'_rmse', 'root mean square error')\", [p2.Binary(pb_rmse)])\r\nconn.commit()\r\n```\r\n```\r\nSELECT madlib.load_top_k_accuracy_function('custom_function_table',\r\n                                           2);\r\nSELECT madlib.load_top_k_accuracy_function('custom_function_table',\r\n                                           3);\r\nSELECT madlib.load_top_k_accuracy_function('custom_function_table',\r\n                                           5);\r\n```\r\n```\r\nSELECT id, name, description FROM madlib.custom_function_table ORDER BY id;\r\n```\r\n```\r\n id |      name       |      description       \r\n----+-----------------+------------------------\r\n  1 | __squared_error | squared error\r\n  2 | _rmse           | root mean square error\r\n  3 | top_2_accuracy  | returns top_2_accuracy\r\n  4 | top_3_accuracy  | returns top_3_accuracy\r\n  5 | top_5_accuracy  | returns top_5_accuracy\r\n(5 rows)\r\n```\r\n```\r\nDROP TABLE IF EXISTS iris_model, iris_model_summary;\r\n\r\nSELECT madlib.madlib_keras_fit('iris_train_packed',   -- source table\r\n                               'iris_model',          -- model output table\r\n                               'model_arch_library',  -- model arch table\r\n                                1,                    -- model arch id\r\n                                $$ loss='__squared_error', optimizer='adam', metrics=['_rmse'] $$,  -- compile_params\r\n                                $$ batch_size=5, epochs=3 $$,  -- fit_params\r\n                                10,                    -- num_iterations\r\n                                NULL,                  -- use_gpus,\r\n                                NULL,                  -- validation_table,\r\n                                NULL,                  -- metrics_compute_frequency,\r\n                                NULL,                  -- warm_start,\r\n                                NULL,                  -- name,\r\n                                NULL,                  -- description,\r\n                                'custom_function_table' -- object_table\r\n                              );\r\n```\r\nworks OK\r\n```\r\nSELECT * FROM iris_model_summary;\r\n```\r\n```\r\n-[ RECORD 1 ]-------------+--------------------------------------------------------------\r\nsource_table              | iris_train_packed\r\nmodel                     | iris_model\r\ndependent_varname         | {class_text}\r\nindependent_varname       | {attributes}\r\nmodel_arch_table          | model_arch_library\r\nmodel_id                  | 1\r\ncompile_params            |  loss='__squared_error', optimizer='adam', metrics=['_rmse'] \r\nfit_params                |  batch_size=5, epochs=3 \r\nnum_iterations            | 10\r\nvalidation_table          | \r\nobject_table              | madlib.custom_function_table\r\nmetrics_compute_frequency | 10\r\nname                      | \r\ndescription               | \r\nmodel_type                | madlib_keras\r\nmodel_size                | 0.7900390625\r\nstart_training_time       | 2021-03-11 00:35:24.12472\r\nend_training_time         | 2021-03-11 00:35:26.849639\r\nmetrics_elapsed_time      | {2.724858045578}\r\nmadlib_version            | 1.18.0-dev\r\nnum_classes               | {3}\r\ndependent_vartype         | {\"character varying\"}\r\nnormalizing_const         | 1\r\nmetrics_type              | {_rmse}\r\nloss_type                 | __squared_error\r\ntraining_metrics_final    | 0.228817746043205\r\ntraining_loss_final       | 0.0709948241710663\r\ntraining_metrics          | {0.228817746043205}\r\ntraining_loss             | {0.0709948241710663}\r\nvalidation_metrics_final  | \r\nvalidation_loss_final     | \r\nvalidation_metrics        | \r\nvalidation_loss           | \r\nmetrics_iters             | {10}\r\nclass_text_class_values   | {Iris-setosa,Iris-versicolor,Iris-virginica}\r\n```\r\n\r\n(2)\r\nsame `madlib.custom_function_table` as above\r\n```\r\nDROP TABLE IF EXISTS iris_model, iris_model_summary;\r\n\r\nSELECT madlib.madlib_keras_fit('iris_train_packed',   -- source table\r\n                               'iris_model',          -- model output table\r\n                               'model_arch_library',  -- model arch table\r\n                                1,                    -- model arch id\r\n                                $$ loss='categorical_crossentropy', optimizer='adam', metrics=['top_k_categorical_accuracy'] $$,  -- compile_params\r\n                                $$ batch_size=5, epochs=3 $$,  -- fit_params\r\n                                10,                    -- num_iterations\r\n                                NULL,                  -- use_gpus,\r\n                                NULL,                  -- validation_table,\r\n                                NULL,                  -- metrics_compute_frequency,\r\n                                NULL,                  -- warm_start,\r\n                                NULL,                  -- name,\r\n                                NULL,                  -- description,\r\n                                NULL                   -- object_table\r\n                              );\r\n```\r\nworks OK\r\n```\r\nSELECT * FROM iris_model_summary;\r\n```\r\n```\r\n-[ RECORD 1 ]-------------+--------------------------------------------------------------------------------------------\r\nsource_table              | iris_train_packed\r\nmodel                     | iris_model\r\ndependent_varname         | {class_text}\r\nindependent_varname       | {attributes}\r\nmodel_arch_table          | model_arch_library\r\nmodel_id                  | 1\r\ncompile_params            |  loss='categorical_crossentropy', optimizer='adam', metrics=['top_k_categorical_accuracy'] \r\nfit_params                |  batch_size=5, epochs=3 \r\nnum_iterations            | 10\r\nvalidation_table          | \r\nobject_table              | \r\nmetrics_compute_frequency | 10\r\nname                      | \r\ndescription               | \r\nmodel_type                | madlib_keras\r\nmodel_size                | 0.7900390625\r\nstart_training_time       | 2021-03-11 00:32:13.816587\r\nend_training_time         | 2021-03-11 00:32:16.636334\r\nmetrics_elapsed_time      | {2.81966114044189}\r\nmadlib_version            | 1.18.0-dev\r\nnum_classes               | {3}\r\ndependent_vartype         | {\"character varying\"}\r\nnormalizing_const         | 1\r\nmetrics_type              | {top_k_categorical_accuracy}\r\nloss_type                 | categorical_crossentropy\r\ntraining_metrics_final    | 1\r\ntraining_loss_final       | 0.347711235284805\r\ntraining_metrics          | {1}\r\ntraining_loss             | {0.347711235284805}\r\nvalidation_metrics_final  | \r\nvalidation_loss_final     | \r\nvalidation_metrics        | \r\nvalidation_loss           | \r\nmetrics_iters             | {10}\r\nclass_text_class_values   | {Iris-setosa,Iris-versicolor,Iris-virginica}\r\n```\r\nLGTM\r\n","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/796321033/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/796348743","html_url":"https://github.com/apache/madlib/pull/556#issuecomment-796348743","issue_url":"https://api.github.com/repos/apache/madlib/issues/556","id":796348743,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NjM0ODc0Mw==","user":{"login":"reductionista","id":2644901,"node_id":"MDQ6VXNlcjI2NDQ5MDE=","avatar_url":"https://avatars.githubusercontent.com/u/2644901?v=4","gravatar_id":"","url":"https://api.github.com/users/reductionista","html_url":"https://github.com/reductionista","followers_url":"https://api.github.com/users/reductionista/followers","following_url":"https://api.github.com/users/reductionista/following{/other_user}","gists_url":"https://api.github.com/users/reductionista/gists{/gist_id}","starred_url":"https://api.github.com/users/reductionista/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/reductionista/subscriptions","organizations_url":"https://api.github.com/users/reductionista/orgs","repos_url":"https://api.github.com/users/reductionista/repos","events_url":"https://api.github.com/users/reductionista/events{/privacy}","received_events_url":"https://api.github.com/users/reductionista/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T01:19:40Z","updated_at":"2021-03-11T01:19:40Z","author_association":"CONTRIBUTOR","body":"Without the cmake flag set, it passes all install-check and dev-check tests on these platforms:\r\n\r\nCentOS 6.10 / gcc (GCC) 4.4.7 20120313 (Red Hat 4.4.7-23) / cmake 3.5.2\r\nCentOS 6.10 / (GCC) 6.2.0, 64-bit / cmake 3.5.2\r\nCentos 7 / (GCC) 6.2.0, 64-bit / cmake 3.5.2\r\nUbuntu 16 / gcc 6.2.0 / cmake 3.5.2\r\nUbuntu 18 / gcc 6.2.0 / cmake 3.5.2\r\nMacOS Catalina / gcc  / cmake \r\nMacOS Big Sur / gcc (Homebrew GCC 8.2.0) 8.2.0 / cmake 3.18.4\r\n\r\nWith CXX11=1 set, it compiles and passes most of the install-check and dev-check tests on these platforms:\r\n\r\nCentOS 6.10 / gcc (GCC) 4.4.7 20120313 (Red Hat 4.4.7-23) / cmake 3.5.2\r\nCentOS 6.10 / (GCC) 6.2.0, 64-bit / cmake 3.5.2\r\nCentos 7 / (GCC) 6.2.0, 64-bit / cmake 3.5.2\r\nUbuntu 16 / gcc 6.2.0 / cmake 3.5.2\r\nUbuntu 18 / gcc 6.2.0 / cmake 3.5.2\r\nMacOS Big Sur / Apple clang version 12.0.0 (clang-1200.0.32.29) / cmake 3.18.4\r\n\r\nC++11 support is still \"experimental\" so we're okay for now with some tests failing for C++11 in kmeans, linalg, and recursive_partition.  Lowering the optimization helps get rid of some of them, but not all.","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/796348743/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/827124252","html_url":"https://github.com/apache/madlib/pull/564#issuecomment-827124252","issue_url":"https://api.github.com/repos/apache/madlib/issues/564","id":827124252,"node_id":"MDEyOklzc3VlQ29tbWVudDgyNzEyNDI1Mg==","user":{"login":"fmcquillan99","id":10538173,"node_id":"MDQ6VXNlcjEwNTM4MTcz","avatar_url":"https://avatars.githubusercontent.com/u/10538173?v=4","gravatar_id":"","url":"https://api.github.com/users/fmcquillan99","html_url":"https://github.com/fmcquillan99","followers_url":"https://api.github.com/users/fmcquillan99/followers","following_url":"https://api.github.com/users/fmcquillan99/following{/other_user}","gists_url":"https://api.github.com/users/fmcquillan99/gists{/gist_id}","starred_url":"https://api.github.com/users/fmcquillan99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmcquillan99/subscriptions","organizations_url":"https://api.github.com/users/fmcquillan99/orgs","repos_url":"https://api.github.com/users/fmcquillan99/repos","events_url":"https://api.github.com/users/fmcquillan99/events{/privacy}","received_events_url":"https://api.github.com/users/fmcquillan99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-26T20:25:29Z","updated_at":"2021-04-26T20:25:29Z","author_association":"NONE","body":"Elsewhere I have seen different defaults used\r\n\r\ne.g., https://keras.io/api/optimizers/adam/ \r\n```\r\nbeta1 = 0.9\r\nbeta2 = 0.999\r\nepsilon=1e-07\r\n```\r\n\r\ne.g., https://keras.io/api/optimizers/rmsprop/\r\n```\r\nrho=0.9,\r\nmomentum=0.0\r\nepsilon=1e-07\r\n```\r\nIs there a reason we have deviated from these values?   e.g., seems we are using epsilon=1e-18","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/827124252/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/827240953","html_url":"https://github.com/apache/madlib/pull/564#issuecomment-827240953","issue_url":"https://api.github.com/repos/apache/madlib/issues/564","id":827240953,"node_id":"MDEyOklzc3VlQ29tbWVudDgyNzI0MDk1Mw==","user":{"login":"kaknikhil","id":11729207,"node_id":"MDQ6VXNlcjExNzI5MjA3","avatar_url":"https://avatars.githubusercontent.com/u/11729207?v=4","gravatar_id":"","url":"https://api.github.com/users/kaknikhil","html_url":"https://github.com/kaknikhil","followers_url":"https://api.github.com/users/kaknikhil/followers","following_url":"https://api.github.com/users/kaknikhil/following{/other_user}","gists_url":"https://api.github.com/users/kaknikhil/gists{/gist_id}","starred_url":"https://api.github.com/users/kaknikhil/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaknikhil/subscriptions","organizations_url":"https://api.github.com/users/kaknikhil/orgs","repos_url":"https://api.github.com/users/kaknikhil/repos","events_url":"https://api.github.com/users/kaknikhil/events{/privacy}","received_events_url":"https://api.github.com/users/kaknikhil/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-27T01:21:05Z","updated_at":"2021-04-27T01:21:05Z","author_association":"CONTRIBUTOR","body":"@fmcquillan99 Do you think it makes sense to mention in the user docs that rmsprop and adam do not support momentum and that the dataset should always be minibatched ?","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/827240953/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/madlib/issues/comments/827262792","html_url":"https://github.com/apache/madlib/pull/564#issuecomment-827262792","issue_url":"https://api.github.com/repos/apache/madlib/issues/564","id":827262792,"node_id":"MDEyOklzc3VlQ29tbWVudDgyNzI2Mjc5Mg==","user":{"login":"fmcquillan99","id":10538173,"node_id":"MDQ6VXNlcjEwNTM4MTcz","avatar_url":"https://avatars.githubusercontent.com/u/10538173?v=4","gravatar_id":"","url":"https://api.github.com/users/fmcquillan99","html_url":"https://github.com/fmcquillan99","followers_url":"https://api.github.com/users/fmcquillan99/followers","following_url":"https://api.github.com/users/fmcquillan99/following{/other_user}","gists_url":"https://api.github.com/users/fmcquillan99/gists{/gist_id}","starred_url":"https://api.github.com/users/fmcquillan99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmcquillan99/subscriptions","organizations_url":"https://api.github.com/users/fmcquillan99/orgs","repos_url":"https://api.github.com/users/fmcquillan99/repos","events_url":"https://api.github.com/users/fmcquillan99/events{/privacy}","received_events_url":"https://api.github.com/users/fmcquillan99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-27T02:14:10Z","updated_at":"2021-04-27T02:14:10Z","author_association":"NONE","body":"yes I think we should be more explicit about that.  It's mentioned sort of in the intro paragraph at the top, but we should put it in the optimizer section too.","reactions":{"url":"https://api.github.com/repos/apache/madlib/issues/comments/827262792/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]