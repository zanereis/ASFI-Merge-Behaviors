[{"url":"https://api.github.com/repos/apache/druid/issues/comments/446001565","html_url":"https://github.com/apache/druid/pull/6672#issuecomment-446001565","issue_url":"https://api.github.com/repos/apache/druid/issues/6672","id":446001565,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0NjAwMTU2NQ==","user":{"login":"jihoonson","id":2322288,"node_id":"MDQ6VXNlcjIzMjIyODg=","avatar_url":"https://avatars.githubusercontent.com/u/2322288?v=4","gravatar_id":"","url":"https://api.github.com/users/jihoonson","html_url":"https://github.com/jihoonson","followers_url":"https://api.github.com/users/jihoonson/followers","following_url":"https://api.github.com/users/jihoonson/following{/other_user}","gists_url":"https://api.github.com/users/jihoonson/gists{/gist_id}","starred_url":"https://api.github.com/users/jihoonson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jihoonson/subscriptions","organizations_url":"https://api.github.com/users/jihoonson/orgs","repos_url":"https://api.github.com/users/jihoonson/repos","events_url":"https://api.github.com/users/jihoonson/events{/privacy}","received_events_url":"https://api.github.com/users/jihoonson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-10T22:39:18Z","updated_at":"2018-12-10T22:39:18Z","author_association":"CONTRIBUTOR","body":"Hi @Tagar, would you please check @gianm's last comment (https://github.com/apache/incubator-druid/pull/6672#discussion_r238850966)?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/446001565/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/446001857","html_url":"https://github.com/apache/druid/pull/6674#issuecomment-446001857","issue_url":"https://api.github.com/repos/apache/druid/issues/6674","id":446001857,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0NjAwMTg1Nw==","user":{"login":"jihoonson","id":2322288,"node_id":"MDQ6VXNlcjIzMjIyODg=","avatar_url":"https://avatars.githubusercontent.com/u/2322288?v=4","gravatar_id":"","url":"https://api.github.com/users/jihoonson","html_url":"https://github.com/jihoonson","followers_url":"https://api.github.com/users/jihoonson/followers","following_url":"https://api.github.com/users/jihoonson/following{/other_user}","gists_url":"https://api.github.com/users/jihoonson/gists{/gist_id}","starred_url":"https://api.github.com/users/jihoonson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jihoonson/subscriptions","organizations_url":"https://api.github.com/users/jihoonson/orgs","repos_url":"https://api.github.com/users/jihoonson/repos","events_url":"https://api.github.com/users/jihoonson/events{/privacy}","received_events_url":"https://api.github.com/users/jihoonson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-10T22:40:30Z","updated_at":"2018-12-10T22:40:30Z","author_association":"CONTRIBUTOR","body":"Hi @Tagar, just want to check how this is going. If you have any further questions, please feel free ask me.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/446001857/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/446013303","html_url":"https://github.com/apache/druid/pull/6676#issuecomment-446013303","issue_url":"https://api.github.com/repos/apache/druid/issues/6676","id":446013303,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0NjAxMzMwMw==","user":{"login":"jihoonson","id":2322288,"node_id":"MDQ6VXNlcjIzMjIyODg=","avatar_url":"https://avatars.githubusercontent.com/u/2322288?v=4","gravatar_id":"","url":"https://api.github.com/users/jihoonson","html_url":"https://github.com/jihoonson","followers_url":"https://api.github.com/users/jihoonson/followers","following_url":"https://api.github.com/users/jihoonson/following{/other_user}","gists_url":"https://api.github.com/users/jihoonson/gists{/gist_id}","starred_url":"https://api.github.com/users/jihoonson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jihoonson/subscriptions","organizations_url":"https://api.github.com/users/jihoonson/orgs","repos_url":"https://api.github.com/users/jihoonson/repos","events_url":"https://api.github.com/users/jihoonson/events{/privacy}","received_events_url":"https://api.github.com/users/jihoonson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-10T23:24:49Z","updated_at":"2018-12-10T23:24:49Z","author_association":"CONTRIBUTOR","body":"@QiuMM, thank you for updating quickly and sorry for the delayed review. \r\n\r\nI've checked the latest changes, and would like to make one more suggestion. The changed coordinator API (`getSegmentServerview`) now returns a list of `ImmutableSegmentLoadInfo`s with a `dropped` flag. This is an incompatible change because this is a documented public API and its return type has been changed. (Sorry, I didn't notice that before and recommended to change the existing one.) It means this PR should be labelled Design Review.\r\n\r\nHowever, I think it's not necessary and there might be an easier way to fix this issue. I would suggest to add a new API for only this internal use case without changing the existing one. If you do this, you don't have to worry about compatibility. Also, if the new API just returns a boolean result which indicates that the given segment is handed off, is waiting for hand off, or will never be handed off, the API is lighter than returning the entire server view which is better in terms of efficiency. What do you think?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/446013303/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/446047318","html_url":"https://github.com/apache/druid/pull/6708#issuecomment-446047318","issue_url":"https://api.github.com/repos/apache/druid/issues/6708","id":446047318,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0NjA0NzMxOA==","user":{"login":"hellobabygogo","id":8693129,"node_id":"MDQ6VXNlcjg2OTMxMjk=","avatar_url":"https://avatars.githubusercontent.com/u/8693129?v=4","gravatar_id":"","url":"https://api.github.com/users/hellobabygogo","html_url":"https://github.com/hellobabygogo","followers_url":"https://api.github.com/users/hellobabygogo/followers","following_url":"https://api.github.com/users/hellobabygogo/following{/other_user}","gists_url":"https://api.github.com/users/hellobabygogo/gists{/gist_id}","starred_url":"https://api.github.com/users/hellobabygogo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hellobabygogo/subscriptions","organizations_url":"https://api.github.com/users/hellobabygogo/orgs","repos_url":"https://api.github.com/users/hellobabygogo/repos","events_url":"https://api.github.com/users/hellobabygogo/events{/privacy}","received_events_url":"https://api.github.com/users/hellobabygogo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-11T02:16:47Z","updated_at":"2018-12-11T02:16:47Z","author_association":"NONE","body":"> -1, this change is not needed, did you remember to set the \"type\" property for allowAll?\r\n> \r\n> e.g.\r\n> \r\n> ```\r\n> druid.auth.authenticatorChain=[\"allowAll\", \"basic\"]\r\n> ...\r\n> druid.auth.authenticator.allowAll.type=allowAll\r\n> ```\r\n\r\nthank you very much !","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/446047318/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/446058299","html_url":"https://github.com/apache/druid/issues/6723#issuecomment-446058299","issue_url":"https://api.github.com/repos/apache/druid/issues/6723","id":446058299,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0NjA1ODI5OQ==","user":{"login":"QiuMM","id":15156517,"node_id":"MDQ6VXNlcjE1MTU2NTE3","avatar_url":"https://avatars.githubusercontent.com/u/15156517?v=4","gravatar_id":"","url":"https://api.github.com/users/QiuMM","html_url":"https://github.com/QiuMM","followers_url":"https://api.github.com/users/QiuMM/followers","following_url":"https://api.github.com/users/QiuMM/following{/other_user}","gists_url":"https://api.github.com/users/QiuMM/gists{/gist_id}","starred_url":"https://api.github.com/users/QiuMM/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/QiuMM/subscriptions","organizations_url":"https://api.github.com/users/QiuMM/orgs","repos_url":"https://api.github.com/users/QiuMM/repos","events_url":"https://api.github.com/users/QiuMM/events{/privacy}","received_events_url":"https://api.github.com/users/QiuMM/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-11T03:20:24Z","updated_at":"2018-12-11T03:20:24Z","author_association":"MEMBER","body":"Please check the [redis cache doc](https://github.com/apache/incubator-druid/blob/master/docs/content/development/extensions-contrib/redis-cache.md) to learn how to use it. Below is a example:\r\n```\r\n# Use cache\r\ndruid.historical.cache.useCache=true\r\ndruid.historical.cache.populateCache=true\r\ndruid.historical.cache.unCacheable=[\"select\", \"scan\"]\r\n\r\ndruid.cache.type=redis\r\ndruid.cache.host=127.0.0.1\r\ndruid.cache.port=8080\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/446058299/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/446058964","html_url":"https://github.com/apache/druid/pull/6676#issuecomment-446058964","issue_url":"https://api.github.com/repos/apache/druid/issues/6676","id":446058964,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0NjA1ODk2NA==","user":{"login":"QiuMM","id":15156517,"node_id":"MDQ6VXNlcjE1MTU2NTE3","avatar_url":"https://avatars.githubusercontent.com/u/15156517?v=4","gravatar_id":"","url":"https://api.github.com/users/QiuMM","html_url":"https://github.com/QiuMM","followers_url":"https://api.github.com/users/QiuMM/followers","following_url":"https://api.github.com/users/QiuMM/following{/other_user}","gists_url":"https://api.github.com/users/QiuMM/gists{/gist_id}","starred_url":"https://api.github.com/users/QiuMM/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/QiuMM/subscriptions","organizations_url":"https://api.github.com/users/QiuMM/orgs","repos_url":"https://api.github.com/users/QiuMM/repos","events_url":"https://api.github.com/users/QiuMM/events{/privacy}","received_events_url":"https://api.github.com/users/QiuMM/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-11T03:24:33Z","updated_at":"2018-12-11T03:24:33Z","author_association":"MEMBER","body":"@jihoonson thanks for your review, your suggestion sounds good to me, I'll update it ASAP.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/446058964/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/446065211","html_url":"https://github.com/apache/druid/pull/6708#issuecomment-446065211","issue_url":"https://api.github.com/repos/apache/druid/issues/6708","id":446065211,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0NjA2NTIxMQ==","user":{"login":"jon-wei","id":8729063,"node_id":"MDQ6VXNlcjg3MjkwNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8729063?v=4","gravatar_id":"","url":"https://api.github.com/users/jon-wei","html_url":"https://github.com/jon-wei","followers_url":"https://api.github.com/users/jon-wei/followers","following_url":"https://api.github.com/users/jon-wei/following{/other_user}","gists_url":"https://api.github.com/users/jon-wei/gists{/gist_id}","starred_url":"https://api.github.com/users/jon-wei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jon-wei/subscriptions","organizations_url":"https://api.github.com/users/jon-wei/orgs","repos_url":"https://api.github.com/users/jon-wei/repos","events_url":"https://api.github.com/users/jon-wei/events{/privacy}","received_events_url":"https://api.github.com/users/jon-wei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-11T04:05:20Z","updated_at":"2018-12-11T04:05:20Z","author_association":"CONTRIBUTOR","body":"@hellobabygogo cool, glad you got it working!","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/446065211/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/446072294","html_url":"https://github.com/apache/druid/pull/6719#issuecomment-446072294","issue_url":"https://api.github.com/repos/apache/druid/issues/6719","id":446072294,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0NjA3MjI5NA==","user":{"login":"dyf6372","id":1322134,"node_id":"MDQ6VXNlcjEzMjIxMzQ=","avatar_url":"https://avatars.githubusercontent.com/u/1322134?v=4","gravatar_id":"","url":"https://api.github.com/users/dyf6372","html_url":"https://github.com/dyf6372","followers_url":"https://api.github.com/users/dyf6372/followers","following_url":"https://api.github.com/users/dyf6372/following{/other_user}","gists_url":"https://api.github.com/users/dyf6372/gists{/gist_id}","starred_url":"https://api.github.com/users/dyf6372/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dyf6372/subscriptions","organizations_url":"https://api.github.com/users/dyf6372/orgs","repos_url":"https://api.github.com/users/dyf6372/repos","events_url":"https://api.github.com/users/dyf6372/events{/privacy}","received_events_url":"https://api.github.com/users/dyf6372/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-11T04:54:37Z","updated_at":"2018-12-11T04:54:37Z","author_association":"CONTRIBUTOR","body":"> While 35% is spent in the .get call is true but most of that time 34% is consumed by the Druid comparator code, so not sure how the snapTreeMap is going to solve this? can you present some results or benchmarks ?\r\n\r\n@b-slim I'm not sure, I think it may decrease the number of compare or optimize the concurrency. Since the project seems to be not alive, I agree that it's may not a good idea to use this code now.  However, it's really necessary for me to improve the performance in index since we have more than 1200 peon task for one cluster and data growth is fast. I'll try it in my cluster and if it's really work without any mistake I'll give the detail result or benchmark in the future. \r\n","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/446072294/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/446074929","html_url":"https://github.com/apache/druid/pull/6709#issuecomment-446074929","issue_url":"https://api.github.com/repos/apache/druid/issues/6709","id":446074929,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0NjA3NDkyOQ==","user":{"login":"dyf6372","id":1322134,"node_id":"MDQ6VXNlcjEzMjIxMzQ=","avatar_url":"https://avatars.githubusercontent.com/u/1322134?v=4","gravatar_id":"","url":"https://api.github.com/users/dyf6372","html_url":"https://github.com/dyf6372","followers_url":"https://api.github.com/users/dyf6372/followers","following_url":"https://api.github.com/users/dyf6372/following{/other_user}","gists_url":"https://api.github.com/users/dyf6372/gists{/gist_id}","starred_url":"https://api.github.com/users/dyf6372/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dyf6372/subscriptions","organizations_url":"https://api.github.com/users/dyf6372/orgs","repos_url":"https://api.github.com/users/dyf6372/repos","events_url":"https://api.github.com/users/dyf6372/events{/privacy}","received_events_url":"https://api.github.com/users/dyf6372/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-11T05:12:18Z","updated_at":"2018-12-11T05:12:49Z","author_association":"CONTRIBUTOR","body":"@asdf2014 just like what your said, I declare a constant named TEXT_PLAIN_UTF8 instead of `\"text/plain; charset=UTF-8\"`, and add a Checkstyle Regex rule that prohibits adding `@Produces(\"text/plain\")`. \r\n@asdf2014  @leventov Please help me review whether the new change is ok? If it is fine, I will raise a follow-up pr to apply this to JSON.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/446074929/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/446089398","html_url":"https://github.com/apache/druid/issues/6722#issuecomment-446089398","issue_url":"https://api.github.com/repos/apache/druid/issues/6722","id":446089398,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0NjA4OTM5OA==","user":{"login":"dyf6372","id":1322134,"node_id":"MDQ6VXNlcjEzMjIxMzQ=","avatar_url":"https://avatars.githubusercontent.com/u/1322134?v=4","gravatar_id":"","url":"https://api.github.com/users/dyf6372","html_url":"https://github.com/dyf6372","followers_url":"https://api.github.com/users/dyf6372/followers","following_url":"https://api.github.com/users/dyf6372/following{/other_user}","gists_url":"https://api.github.com/users/dyf6372/gists{/gist_id}","starred_url":"https://api.github.com/users/dyf6372/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dyf6372/subscriptions","organizations_url":"https://api.github.com/users/dyf6372/orgs","repos_url":"https://api.github.com/users/dyf6372/repos","events_url":"https://api.github.com/users/dyf6372/events{/privacy}","received_events_url":"https://api.github.com/users/dyf6372/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-11T06:37:37Z","updated_at":"2018-12-11T06:37:37Z","author_association":"CONTRIBUTOR","body":"It's a good issue since I saw the same error before. I think use iterator instead of for loop in code1 maybe is a better choice.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/446089398/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/446094758","html_url":"https://github.com/apache/druid/issues/6723#issuecomment-446094758","issue_url":"https://api.github.com/repos/apache/druid/issues/6723","id":446094758,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0NjA5NDc1OA==","user":{"login":"love1693294577","id":21165046,"node_id":"MDQ6VXNlcjIxMTY1MDQ2","avatar_url":"https://avatars.githubusercontent.com/u/21165046?v=4","gravatar_id":"","url":"https://api.github.com/users/love1693294577","html_url":"https://github.com/love1693294577","followers_url":"https://api.github.com/users/love1693294577/followers","following_url":"https://api.github.com/users/love1693294577/following{/other_user}","gists_url":"https://api.github.com/users/love1693294577/gists{/gist_id}","starred_url":"https://api.github.com/users/love1693294577/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/love1693294577/subscriptions","organizations_url":"https://api.github.com/users/love1693294577/orgs","repos_url":"https://api.github.com/users/love1693294577/repos","events_url":"https://api.github.com/users/love1693294577/events{/privacy}","received_events_url":"https://api.github.com/users/love1693294577/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-11T07:04:26Z","updated_at":"2018-12-11T07:04:26Z","author_association":"NONE","body":"> Please check the [redis cache doc](https://github.com/apache/incubator-druid/blob/master/docs/content/development/extensions-contrib/redis-cache.md) to learn how to use it. Below is a example:\r\n> \r\n> ```\r\n> # Use cache\r\n> druid.historical.cache.useCache=true\r\n> druid.historical.cache.populateCache=true\r\n> druid.historical.cache.unCacheable=[\"select\", \"scan\"]\r\n> \r\n> druid.cache.type=redis\r\n> druid.cache.host=127.0.0.1\r\n> druid.cache.port=8080\r\n> ```\r\n\r\nYes\r\n\r\nI just want to turn on the buffer of the historic\r\nI configured it in all common.runtime.properties\r\nDruid.cache.host=xx.xxx.xxx.13\r\nDruid.cache.port=6379\r\nAnd configured in all historical nodes\r\ndruid.historical.cache.useCache=true\r\ndruid.historical.cache.populateCache=true\r\nDruid.historical.cache.unCacheable=[]\r\nDruid.cache.type=redis\r\nBut there is still no buffered data in redis\r\nI tried to configure the broker's buffer, but there is no configuration in the historical, this has buffered data in redis, and there is buffer information for the segment.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/446094758/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/446105885","html_url":"https://github.com/apache/druid/issues/6722#issuecomment-446105885","issue_url":"https://api.github.com/repos/apache/druid/issues/6722","id":446105885,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0NjEwNTg4NQ==","user":{"login":"QiuMM","id":15156517,"node_id":"MDQ6VXNlcjE1MTU2NTE3","avatar_url":"https://avatars.githubusercontent.com/u/15156517?v=4","gravatar_id":"","url":"https://api.github.com/users/QiuMM","html_url":"https://github.com/QiuMM","followers_url":"https://api.github.com/users/QiuMM/followers","following_url":"https://api.github.com/users/QiuMM/following{/other_user}","gists_url":"https://api.github.com/users/QiuMM/gists{/gist_id}","starred_url":"https://api.github.com/users/QiuMM/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/QiuMM/subscriptions","organizations_url":"https://api.github.com/users/QiuMM/orgs","repos_url":"https://api.github.com/users/QiuMM/repos","events_url":"https://api.github.com/users/QiuMM/events{/privacy}","received_events_url":"https://api.github.com/users/QiuMM/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-11T07:56:10Z","updated_at":"2018-12-11T08:54:13Z","author_association":"MEMBER","body":"@dyf6372 you are right, according to the implementations of ConcurrentHashMap, I found using iterator to traverse the `sinks` can avoid this bug.  But the iterator must be obtained by `entrySet().iterator()`,  using `keySet().iterator()` will face the same issue. I have tested it and it worked!","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/446105885/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/446119032","html_url":"https://github.com/apache/druid/issues/6723#issuecomment-446119032","issue_url":"https://api.github.com/repos/apache/druid/issues/6723","id":446119032,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0NjExOTAzMg==","user":{"login":"QiuMM","id":15156517,"node_id":"MDQ6VXNlcjE1MTU2NTE3","avatar_url":"https://avatars.githubusercontent.com/u/15156517?v=4","gravatar_id":"","url":"https://api.github.com/users/QiuMM","html_url":"https://github.com/QiuMM","followers_url":"https://api.github.com/users/QiuMM/followers","following_url":"https://api.github.com/users/QiuMM/following{/other_user}","gists_url":"https://api.github.com/users/QiuMM/gists{/gist_id}","starred_url":"https://api.github.com/users/QiuMM/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/QiuMM/subscriptions","organizations_url":"https://api.github.com/users/QiuMM/orgs","repos_url":"https://api.github.com/users/QiuMM/repos","events_url":"https://api.github.com/users/QiuMM/events{/privacy}","received_events_url":"https://api.github.com/users/QiuMM/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-11T08:46:03Z","updated_at":"2018-12-11T09:29:46Z","author_association":"MEMBER","body":"> I tried to configure the broker's buffer, but there is no configuration in the historical, this has buffered data in redis, and there is buffer information for the segment.\r\n\r\nSorry, I didn't understand you. Did you mean the cache work on broker but not work on historical? Besides, can you provide your historical node's startup logs ?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/446119032/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/446211138","html_url":"https://github.com/apache/druid/pull/6336#issuecomment-446211138","issue_url":"https://api.github.com/repos/apache/druid/issues/6336","id":446211138,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0NjIxMTEzOA==","user":{"login":"QiuMM","id":15156517,"node_id":"MDQ6VXNlcjE1MTU2NTE3","avatar_url":"https://avatars.githubusercontent.com/u/15156517?v=4","gravatar_id":"","url":"https://api.github.com/users/QiuMM","html_url":"https://github.com/QiuMM","followers_url":"https://api.github.com/users/QiuMM/followers","following_url":"https://api.github.com/users/QiuMM/following{/other_user}","gists_url":"https://api.github.com/users/QiuMM/gists{/gist_id}","starred_url":"https://api.github.com/users/QiuMM/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/QiuMM/subscriptions","organizations_url":"https://api.github.com/users/QiuMM/orgs","repos_url":"https://api.github.com/users/QiuMM/repos","events_url":"https://api.github.com/users/QiuMM/events{/privacy}","received_events_url":"https://api.github.com/users/QiuMM/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-11T13:57:50Z","updated_at":"2018-12-12T05:49:10Z","author_association":"MEMBER","body":"@FaxianZhao @jihoonson I think this PR should be reverted, after merged this PR, it takes very long long time to open the overlord console. In my scenario, there are 1200 peon tasks and we use mysql as the metastore. In this PR, use `TaskLockbox#doInCriticalSection` to perform allocating pending segments which seems would block other things. After revert this, my overlord works fine again.\r\n\r\n![lark20181211-215648](https://user-images.githubusercontent.com/15156517/49805286-bd20e380-fd8f-11e8-9c9e-4d44d2cf7b18.png)\r\n","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/446211138/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/446284013","html_url":"https://github.com/apache/druid/pull/6719#issuecomment-446284013","issue_url":"https://api.github.com/repos/apache/druid/issues/6719","id":446284013,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0NjI4NDAxMw==","user":{"login":"b-slim","id":7376396,"node_id":"MDQ6VXNlcjczNzYzOTY=","avatar_url":"https://avatars.githubusercontent.com/u/7376396?v=4","gravatar_id":"","url":"https://api.github.com/users/b-slim","html_url":"https://github.com/b-slim","followers_url":"https://api.github.com/users/b-slim/followers","following_url":"https://api.github.com/users/b-slim/following{/other_user}","gists_url":"https://api.github.com/users/b-slim/gists{/gist_id}","starred_url":"https://api.github.com/users/b-slim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/b-slim/subscriptions","organizations_url":"https://api.github.com/users/b-slim/orgs","repos_url":"https://api.github.com/users/b-slim/repos","events_url":"https://api.github.com/users/b-slim/events{/privacy}","received_events_url":"https://api.github.com/users/b-slim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-11T17:14:34Z","updated_at":"2018-12-11T17:14:34Z","author_association":"CONTRIBUTOR","body":"@dyf6372 Thanks for doing this.\r\nBTW there is this ongoing effort https://github.com/apache/incubator-druid/pull/6327\r\nMaybe worth taking a look and perhaps joint effort if it make sense.\r\nHappy coding !","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/446284013/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/446298770","html_url":"https://github.com/apache/druid/pull/6724#issuecomment-446298770","issue_url":"https://api.github.com/repos/apache/druid/issues/6724","id":446298770,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0NjI5ODc3MA==","user":{"login":"fjy","id":428325,"node_id":"MDQ6VXNlcjQyODMyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/428325?v=4","gravatar_id":"","url":"https://api.github.com/users/fjy","html_url":"https://github.com/fjy","followers_url":"https://api.github.com/users/fjy/followers","following_url":"https://api.github.com/users/fjy/following{/other_user}","gists_url":"https://api.github.com/users/fjy/gists{/gist_id}","starred_url":"https://api.github.com/users/fjy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fjy/subscriptions","organizations_url":"https://api.github.com/users/fjy/orgs","repos_url":"https://api.github.com/users/fjy/repos","events_url":"https://api.github.com/users/fjy/events{/privacy}","received_events_url":"https://api.github.com/users/fjy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-11T17:57:21Z","updated_at":"2018-12-11T17:57:21Z","author_association":"CONTRIBUTOR","body":"@QiuMM is it possible to add a test?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/446298770/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/446306703","html_url":"https://github.com/apache/druid/pull/6724#issuecomment-446306703","issue_url":"https://api.github.com/repos/apache/druid/issues/6724","id":446306703,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0NjMwNjcwMw==","user":{"login":"QiuMM","id":15156517,"node_id":"MDQ6VXNlcjE1MTU2NTE3","avatar_url":"https://avatars.githubusercontent.com/u/15156517?v=4","gravatar_id":"","url":"https://api.github.com/users/QiuMM","html_url":"https://github.com/QiuMM","followers_url":"https://api.github.com/users/QiuMM/followers","following_url":"https://api.github.com/users/QiuMM/following{/other_user}","gists_url":"https://api.github.com/users/QiuMM/gists{/gist_id}","starred_url":"https://api.github.com/users/QiuMM/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/QiuMM/subscriptions","organizations_url":"https://api.github.com/users/QiuMM/orgs","repos_url":"https://api.github.com/users/QiuMM/repos","events_url":"https://api.github.com/users/QiuMM/events{/privacy}","received_events_url":"https://api.github.com/users/QiuMM/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-11T18:20:56Z","updated_at":"2018-12-11T18:44:45Z","author_association":"MEMBER","body":"@fjy no, because I think It's hard to simulate since this issue happens infrequently which depends on the execution order of code, i.e affected by thread scheduling. Besides, I think there is no need to do, the correctness of this fix is guaranteed by the `ConcurrentHashMap`, we should trust it. The reason why this bug was introduced is that we did not use `ConcurrentHashMap` in a right way before.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/446306703/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/446317648","html_url":"https://github.com/apache/druid/issues/6725#issuecomment-446317648","issue_url":"https://api.github.com/repos/apache/druid/issues/6725","id":446317648,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0NjMxNzY0OA==","user":{"login":"QiuMM","id":15156517,"node_id":"MDQ6VXNlcjE1MTU2NTE3","avatar_url":"https://avatars.githubusercontent.com/u/15156517?v=4","gravatar_id":"","url":"https://api.github.com/users/QiuMM","html_url":"https://github.com/QiuMM","followers_url":"https://api.github.com/users/QiuMM/followers","following_url":"https://api.github.com/users/QiuMM/following{/other_user}","gists_url":"https://api.github.com/users/QiuMM/gists{/gist_id}","starred_url":"https://api.github.com/users/QiuMM/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/QiuMM/subscriptions","organizations_url":"https://api.github.com/users/QiuMM/orgs","repos_url":"https://api.github.com/users/QiuMM/repos","events_url":"https://api.github.com/users/QiuMM/events{/privacy}","received_events_url":"https://api.github.com/users/QiuMM/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-11T18:52:50Z","updated_at":"2018-12-11T18:52:50Z","author_association":"MEMBER","body":"Starting a new coordinator/overlord in a different node, then kill the old ones. The new ones will work as leader.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/446317648/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/446321302","html_url":"https://github.com/apache/druid/issues/6725#issuecomment-446321302","issue_url":"https://api.github.com/repos/apache/druid/issues/6725","id":446321302,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0NjMyMTMwMg==","user":{"login":"maver1ck","id":4006010,"node_id":"MDQ6VXNlcjQwMDYwMTA=","avatar_url":"https://avatars.githubusercontent.com/u/4006010?v=4","gravatar_id":"","url":"https://api.github.com/users/maver1ck","html_url":"https://github.com/maver1ck","followers_url":"https://api.github.com/users/maver1ck/followers","following_url":"https://api.github.com/users/maver1ck/following{/other_user}","gists_url":"https://api.github.com/users/maver1ck/gists{/gist_id}","starred_url":"https://api.github.com/users/maver1ck/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maver1ck/subscriptions","organizations_url":"https://api.github.com/users/maver1ck/orgs","repos_url":"https://api.github.com/users/maver1ck/repos","events_url":"https://api.github.com/users/maver1ck/events{/privacy}","received_events_url":"https://api.github.com/users/maver1ck/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-11T19:02:52Z","updated_at":"2018-12-11T19:02:52Z","author_association":"CONTRIBUTOR","body":"I now about this.\r\nBut if it's possible to move leader before killing it ?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/446321302/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/446345565","html_url":"https://github.com/apache/druid/issues/6718#issuecomment-446345565","issue_url":"https://api.github.com/repos/apache/druid/issues/6718","id":446345565,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0NjM0NTU2NQ==","user":{"login":"jon-wei","id":8729063,"node_id":"MDQ6VXNlcjg3MjkwNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8729063?v=4","gravatar_id":"","url":"https://api.github.com/users/jon-wei","html_url":"https://github.com/jon-wei","followers_url":"https://api.github.com/users/jon-wei/followers","following_url":"https://api.github.com/users/jon-wei/following{/other_user}","gists_url":"https://api.github.com/users/jon-wei/gists{/gist_id}","starred_url":"https://api.github.com/users/jon-wei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jon-wei/subscriptions","organizations_url":"https://api.github.com/users/jon-wei/orgs","repos_url":"https://api.github.com/users/jon-wei/repos","events_url":"https://api.github.com/users/jon-wei/events{/privacy}","received_events_url":"https://api.github.com/users/jon-wei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-11T20:13:08Z","updated_at":"2018-12-11T20:15:43Z","author_association":"CONTRIBUTOR","body":"Hi @ciukstar, I was able to reproduce this, to your question from the mailing list:\r\n\r\n> Is this a bug or a configuration issue?\r\n\r\nThis is a bug.\r\n\r\nI've also found that there can be issues where segments are not loaded on historicals from deep storage when the datasource name has a space in it, so for the time being I would avoid using spaces as well.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/446345565/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/446373831","html_url":"https://github.com/apache/druid/issues/6320#issuecomment-446373831","issue_url":"https://api.github.com/repos/apache/druid/issues/6320","id":446373831,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0NjM3MzgzMQ==","user":{"login":"b-slim","id":7376396,"node_id":"MDQ6VXNlcjczNzYzOTY=","avatar_url":"https://avatars.githubusercontent.com/u/7376396?v=4","gravatar_id":"","url":"https://api.github.com/users/b-slim","html_url":"https://github.com/b-slim","followers_url":"https://api.github.com/users/b-slim/followers","following_url":"https://api.github.com/users/b-slim/following{/other_user}","gists_url":"https://api.github.com/users/b-slim/gists{/gist_id}","starred_url":"https://api.github.com/users/b-slim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/b-slim/subscriptions","organizations_url":"https://api.github.com/users/b-slim/orgs","repos_url":"https://api.github.com/users/b-slim/repos","events_url":"https://api.github.com/users/b-slim/events{/privacy}","received_events_url":"https://api.github.com/users/b-slim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-11T21:45:01Z","updated_at":"2018-12-11T21:45:01Z","author_association":"CONTRIBUTOR","body":"Very High level questions:\r\n\r\n- When collecting the results of the inner query to compute the moving AVG, is it done in a streaming fashion or you are materializing/buffering the entire result set to run the bucket based trailing aggregate?\r\n-  In your example i see `\"type\": \"longMean\"` and the result is a floating point number, that seems odd to me.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/446373831/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/446375728","html_url":"https://github.com/apache/druid/issues/6320#issuecomment-446375728","issue_url":"https://api.github.com/repos/apache/druid/issues/6320","id":446375728,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0NjM3NTcyOA==","user":{"login":"b-slim","id":7376396,"node_id":"MDQ6VXNlcjczNzYzOTY=","avatar_url":"https://avatars.githubusercontent.com/u/7376396?v=4","gravatar_id":"","url":"https://api.github.com/users/b-slim","html_url":"https://github.com/b-slim","followers_url":"https://api.github.com/users/b-slim/followers","following_url":"https://api.github.com/users/b-slim/following{/other_user}","gists_url":"https://api.github.com/users/b-slim/gists{/gist_id}","starred_url":"https://api.github.com/users/b-slim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/b-slim/subscriptions","organizations_url":"https://api.github.com/users/b-slim/orgs","repos_url":"https://api.github.com/users/b-slim/repos","events_url":"https://api.github.com/users/b-slim/events{/privacy}","received_events_url":"https://api.github.com/users/b-slim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-11T21:50:49Z","updated_at":"2018-12-11T21:50:49Z","author_association":"CONTRIBUTOR","body":"One more question:\r\nIn your example i see that the first data point has \r\n```json\r\n\"event\" : {\r\n    \"delta30Min\" : 30490,\r\n    \"trailing30MinChanges\" : 4355.714285714285\r\n  }\r\n```\r\nnot sure what am missing here but isn't for the first data point `delta30Min` should be equal to `trailing30MinChanges`\r\n","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/446375728/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/446376562","html_url":"https://github.com/apache/druid/issues/6320#issuecomment-446376562","issue_url":"https://api.github.com/repos/apache/druid/issues/6320","id":446376562,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0NjM3NjU2Mg==","user":{"login":"b-slim","id":7376396,"node_id":"MDQ6VXNlcjczNzYzOTY=","avatar_url":"https://avatars.githubusercontent.com/u/7376396?v=4","gravatar_id":"","url":"https://api.github.com/users/b-slim","html_url":"https://github.com/b-slim","followers_url":"https://api.github.com/users/b-slim/followers","following_url":"https://api.github.com/users/b-slim/following{/other_user}","gists_url":"https://api.github.com/users/b-slim/gists{/gist_id}","starred_url":"https://api.github.com/users/b-slim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/b-slim/subscriptions","organizations_url":"https://api.github.com/users/b-slim/orgs","repos_url":"https://api.github.com/users/b-slim/repos","events_url":"https://api.github.com/users/b-slim/events{/privacy}","received_events_url":"https://api.github.com/users/b-slim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-11T21:53:29Z","updated_at":"2018-12-11T21:53:29Z","author_association":"CONTRIBUTOR","body":"And Another question:\r\nIn general Druid users use a column called count in conjunction with the XXXSum column to derive AVG when Rolling up of rows occurs, does your feature take that into consideration?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/446376562/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/446392815","html_url":"https://github.com/apache/druid/pull/6629#issuecomment-446392815","issue_url":"https://api.github.com/repos/apache/druid/issues/6629","id":446392815,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0NjM5MjgxNQ==","user":{"login":"jihoonson","id":2322288,"node_id":"MDQ6VXNlcjIzMjIyODg=","avatar_url":"https://avatars.githubusercontent.com/u/2322288?v=4","gravatar_id":"","url":"https://api.github.com/users/jihoonson","html_url":"https://github.com/jihoonson","followers_url":"https://api.github.com/users/jihoonson/followers","following_url":"https://api.github.com/users/jihoonson/following{/other_user}","gists_url":"https://api.github.com/users/jihoonson/gists{/gist_id}","starred_url":"https://api.github.com/users/jihoonson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jihoonson/subscriptions","organizations_url":"https://api.github.com/users/jihoonson/orgs","repos_url":"https://api.github.com/users/jihoonson/repos","events_url":"https://api.github.com/users/jihoonson/events{/privacy}","received_events_url":"https://api.github.com/users/jihoonson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-11T22:50:07Z","updated_at":"2018-12-11T22:50:07Z","author_association":"CONTRIBUTOR","body":"> My main question in the implementation is as follows: There is already a large body of effort and thought in the java.lang.Thread* and java.util.concurrent packages that seem to be purposefully avoided here. I haven't been able to fully dig into ParallelMergeCombineSequence yet, but it seems like a lot of the java concepts should be able to be used here. I'll try to give some examples when I can\r\n\r\n@drcrallen thank you for taking a look. I'll check your comments soon. For this question, if you talk about ForkJoinPool, I don't think it's appropriate for this kind of use case. The algorithm implemented in this PR is a sort of pipelining combining sorted data. Each thread combines data from its children, and the parent and its children threads can be run at the same time. I took this approach because the final results should be streamed to the query client.\r\n\r\nHowever, I think ForkJoinPool is appropriate for divide-and-conquer style algorithms. For example, it's useful when summing a large sequence of integers. It can automatically split the sequence into several small chunks, and sum them in parallel. The results of summing small chunks should be aggregated again. Here, summing small chunks and aggregating their results can't be done at the same time. What do you think?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/446392815/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/446407900","html_url":"https://github.com/apache/druid/pull/6605#issuecomment-446407900","issue_url":"https://api.github.com/repos/apache/druid/issues/6605","id":446407900,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0NjQwNzkwMA==","user":{"login":"glasser","id":16724,"node_id":"MDQ6VXNlcjE2NzI0","avatar_url":"https://avatars.githubusercontent.com/u/16724?v=4","gravatar_id":"","url":"https://api.github.com/users/glasser","html_url":"https://github.com/glasser","followers_url":"https://api.github.com/users/glasser/followers","following_url":"https://api.github.com/users/glasser/following{/other_user}","gists_url":"https://api.github.com/users/glasser/gists{/gist_id}","starred_url":"https://api.github.com/users/glasser/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glasser/subscriptions","organizations_url":"https://api.github.com/users/glasser/orgs","repos_url":"https://api.github.com/users/glasser/repos","events_url":"https://api.github.com/users/glasser/events{/privacy}","received_events_url":"https://api.github.com/users/glasser/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-11T23:53:07Z","updated_at":"2018-12-11T23:53:07Z","author_association":"CONTRIBUTOR","body":"@deiwin This is great and we're looking forward to using it instead of a custom http->datadog relay once it's released!\r\n\r\nOne note — it would be great if it were possible to pass a non-empty list of tags for the constantTags via config (instead of EMPTY_ARRAY) — we'd use this to set which Druid environment is running. Is this something you might be able to add, or should I try to figure out enough about how Druid config works to add it?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/446407900/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/446425813","html_url":"https://github.com/apache/druid/issues/6723#issuecomment-446425813","issue_url":"https://api.github.com/repos/apache/druid/issues/6723","id":446425813,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0NjQyNTgxMw==","user":{"login":"love1693294577","id":21165046,"node_id":"MDQ6VXNlcjIxMTY1MDQ2","avatar_url":"https://avatars.githubusercontent.com/u/21165046?v=4","gravatar_id":"","url":"https://api.github.com/users/love1693294577","html_url":"https://github.com/love1693294577","followers_url":"https://api.github.com/users/love1693294577/followers","following_url":"https://api.github.com/users/love1693294577/following{/other_user}","gists_url":"https://api.github.com/users/love1693294577/gists{/gist_id}","starred_url":"https://api.github.com/users/love1693294577/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/love1693294577/subscriptions","organizations_url":"https://api.github.com/users/love1693294577/orgs","repos_url":"https://api.github.com/users/love1693294577/repos","events_url":"https://api.github.com/users/love1693294577/events{/privacy}","received_events_url":"https://api.github.com/users/love1693294577/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-12T01:22:19Z","updated_at":"2018-12-12T01:22:19Z","author_association":"NONE","body":"> > I tried to configure the broker's buffer, but there is no configuration in the historical, this has buffered data in redis, and there is buffer information for the segment.\r\n> \r\n> Sorry, I didn't understand you. Did you mean the cache work on broker but not work on historical? Besides, can you provide your historical node's startup logs ?\r\n\r\nOk I solved this problem because I didn't configure the historical druid-redis-cache to have a historical intermediate result set.\r\nBut I still have a place I don't understand. After configuring the broker redis buffer, in addition to querying the intermediate result set information, the broker also has segment buffer information.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/446425813/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/446450729","html_url":"https://github.com/apache/druid/issues/6723#issuecomment-446450729","issue_url":"https://api.github.com/repos/apache/druid/issues/6723","id":446450729,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0NjQ1MDcyOQ==","user":{"login":"QiuMM","id":15156517,"node_id":"MDQ6VXNlcjE1MTU2NTE3","avatar_url":"https://avatars.githubusercontent.com/u/15156517?v=4","gravatar_id":"","url":"https://api.github.com/users/QiuMM","html_url":"https://github.com/QiuMM","followers_url":"https://api.github.com/users/QiuMM/followers","following_url":"https://api.github.com/users/QiuMM/following{/other_user}","gists_url":"https://api.github.com/users/QiuMM/gists{/gist_id}","starred_url":"https://api.github.com/users/QiuMM/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/QiuMM/subscriptions","organizations_url":"https://api.github.com/users/QiuMM/orgs","repos_url":"https://api.github.com/users/QiuMM/repos","events_url":"https://api.github.com/users/QiuMM/events{/privacy}","received_events_url":"https://api.github.com/users/QiuMM/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-12T03:39:19Z","updated_at":"2018-12-12T03:39:19Z","author_association":"MEMBER","body":"> the broker also has segment buffer information.\r\n\r\nI think you may talk about segment metadata information. If you enabled sql on your broker, it will do [segment metadata queries](http://druid.io/docs/latest/querying/segmentmetadataquery.html) to obtain information about segment schema. These queries' result would be cached if you enabled the cache.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/446450729/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/446452075","html_url":"https://github.com/apache/druid/pull/6724#issuecomment-446452075","issue_url":"https://api.github.com/repos/apache/druid/issues/6724","id":446452075,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0NjQ1MjA3NQ==","user":{"login":"QiuMM","id":15156517,"node_id":"MDQ6VXNlcjE1MTU2NTE3","avatar_url":"https://avatars.githubusercontent.com/u/15156517?v=4","gravatar_id":"","url":"https://api.github.com/users/QiuMM","html_url":"https://github.com/QiuMM","followers_url":"https://api.github.com/users/QiuMM/followers","following_url":"https://api.github.com/users/QiuMM/following{/other_user}","gists_url":"https://api.github.com/users/QiuMM/gists{/gist_id}","starred_url":"https://api.github.com/users/QiuMM/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/QiuMM/subscriptions","organizations_url":"https://api.github.com/users/QiuMM/orgs","repos_url":"https://api.github.com/users/QiuMM/repos","events_url":"https://api.github.com/users/QiuMM/events{/privacy}","received_events_url":"https://api.github.com/users/QiuMM/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-12T03:47:55Z","updated_at":"2018-12-12T03:47:55Z","author_association":"MEMBER","body":"FYI, after used this patch, we never see the bug again.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/446452075/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/446504892","html_url":"https://github.com/apache/druid/pull/6605#issuecomment-446504892","issue_url":"https://api.github.com/repos/apache/druid/issues/6605","id":446504892,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0NjUwNDg5Mg==","user":{"login":"deiwin","id":2261897,"node_id":"MDQ6VXNlcjIyNjE4OTc=","avatar_url":"https://avatars.githubusercontent.com/u/2261897?v=4","gravatar_id":"","url":"https://api.github.com/users/deiwin","html_url":"https://github.com/deiwin","followers_url":"https://api.github.com/users/deiwin/followers","following_url":"https://api.github.com/users/deiwin/following{/other_user}","gists_url":"https://api.github.com/users/deiwin/gists{/gist_id}","starred_url":"https://api.github.com/users/deiwin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/deiwin/subscriptions","organizations_url":"https://api.github.com/users/deiwin/orgs","repos_url":"https://api.github.com/users/deiwin/repos","events_url":"https://api.github.com/users/deiwin/events{/privacy}","received_events_url":"https://api.github.com/users/deiwin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-12T08:34:54Z","updated_at":"2018-12-12T08:34:54Z","author_association":"CONTRIBUTOR","body":"> This is great and we're looking forward to using it instead of a custom http->datadog relay once it's released!\r\n\r\nGlad to hear!\r\n\r\n> One note — it would be great if it were possible to pass a non-empty list of tags for the constantTags via config (instead of EMPTY_ARRAY) — we'd use this to set which Druid environment is running. Is this something you might be able to add, or should I try to figure out enough about how Druid config works to add it?\r\n\r\nThere's configuration changes in this PR. It should be quite straight forward for you to replicate them for your needs to open another PR.\r\n\r\nWe're not currently interested in that feature, because we configure the constant tags on the agents and so don't need to send them from Druid.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/446504892/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/446755165","html_url":"https://github.com/apache/druid/pull/6728#issuecomment-446755165","issue_url":"https://api.github.com/repos/apache/druid/issues/6728","id":446755165,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0Njc1NTE2NQ==","user":{"login":"clintropolis","id":1577461,"node_id":"MDQ6VXNlcjE1Nzc0NjE=","avatar_url":"https://avatars.githubusercontent.com/u/1577461?v=4","gravatar_id":"","url":"https://api.github.com/users/clintropolis","html_url":"https://github.com/clintropolis","followers_url":"https://api.github.com/users/clintropolis/followers","following_url":"https://api.github.com/users/clintropolis/following{/other_user}","gists_url":"https://api.github.com/users/clintropolis/gists{/gist_id}","starred_url":"https://api.github.com/users/clintropolis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintropolis/subscriptions","organizations_url":"https://api.github.com/users/clintropolis/orgs","repos_url":"https://api.github.com/users/clintropolis/repos","events_url":"https://api.github.com/users/clintropolis/events{/privacy}","received_events_url":"https://api.github.com/users/clintropolis/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-12T21:42:57Z","updated_at":"2018-12-12T21:42:57Z","author_association":"MEMBER","body":"This will need to be backported to 0.13 release branch in order to make sure the website docs get updated with the new release. As I understand this does not need a new release, just needs to be in the branch I think.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/446755165/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/446790205","html_url":"https://github.com/apache/druid/pull/6674#issuecomment-446790205","issue_url":"https://api.github.com/repos/apache/druid/issues/6674","id":446790205,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0Njc5MDIwNQ==","user":{"login":"Tagar","id":3013418,"node_id":"MDQ6VXNlcjMwMTM0MTg=","avatar_url":"https://avatars.githubusercontent.com/u/3013418?v=4","gravatar_id":"","url":"https://api.github.com/users/Tagar","html_url":"https://github.com/Tagar","followers_url":"https://api.github.com/users/Tagar/followers","following_url":"https://api.github.com/users/Tagar/following{/other_user}","gists_url":"https://api.github.com/users/Tagar/gists{/gist_id}","starred_url":"https://api.github.com/users/Tagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Tagar/subscriptions","organizations_url":"https://api.github.com/users/Tagar/orgs","repos_url":"https://api.github.com/users/Tagar/repos","events_url":"https://api.github.com/users/Tagar/events{/privacy}","received_events_url":"https://api.github.com/users/Tagar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-12T23:58:42Z","updated_at":"2018-12-12T23:58:42Z","author_association":"NONE","body":"@jihoonson thanks for the reminder. \r\nI wouldn't have time soon to have a look at this one. \r\nIf somebody else takes over, it's okay with me.\r\nOr I will have a look at this later. \r\nThanks!","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/446790205/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/446790428","html_url":"https://github.com/apache/druid/pull/6672#issuecomment-446790428","issue_url":"https://api.github.com/repos/apache/druid/issues/6672","id":446790428,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0Njc5MDQyOA==","user":{"login":"Tagar","id":3013418,"node_id":"MDQ6VXNlcjMwMTM0MTg=","avatar_url":"https://avatars.githubusercontent.com/u/3013418?v=4","gravatar_id":"","url":"https://api.github.com/users/Tagar","html_url":"https://github.com/Tagar","followers_url":"https://api.github.com/users/Tagar/followers","following_url":"https://api.github.com/users/Tagar/following{/other_user}","gists_url":"https://api.github.com/users/Tagar/gists{/gist_id}","starred_url":"https://api.github.com/users/Tagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Tagar/subscriptions","organizations_url":"https://api.github.com/users/Tagar/orgs","repos_url":"https://api.github.com/users/Tagar/repos","events_url":"https://api.github.com/users/Tagar/events{/privacy}","received_events_url":"https://api.github.com/users/Tagar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-12T23:59:50Z","updated_at":"2018-12-12T23:59:50Z","author_association":"NONE","body":"@jihoonson I might have a look at this one later, once I have time.. \r\nThanks!","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/446790428/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/446838782","html_url":"https://github.com/apache/druid/pull/6731#issuecomment-446838782","issue_url":"https://api.github.com/repos/apache/druid/issues/6731","id":446838782,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0NjgzODc4Mg==","user":{"login":"vogievetsky","id":177816,"node_id":"MDQ6VXNlcjE3NzgxNg==","avatar_url":"https://avatars.githubusercontent.com/u/177816?v=4","gravatar_id":"","url":"https://api.github.com/users/vogievetsky","html_url":"https://github.com/vogievetsky","followers_url":"https://api.github.com/users/vogievetsky/followers","following_url":"https://api.github.com/users/vogievetsky/following{/other_user}","gists_url":"https://api.github.com/users/vogievetsky/gists{/gist_id}","starred_url":"https://api.github.com/users/vogievetsky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vogievetsky/subscriptions","organizations_url":"https://api.github.com/users/vogievetsky/orgs","repos_url":"https://api.github.com/users/vogievetsky/repos","events_url":"https://api.github.com/users/vogievetsky/events{/privacy}","received_events_url":"https://api.github.com/users/vogievetsky/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-13T04:27:11Z","updated_at":"2018-12-13T04:27:11Z","author_association":"CONTRIBUTOR","body":"I know some of the page titles are not perfect but it is way better than nothing","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/446838782/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/446885935","html_url":"https://github.com/apache/druid/issues/6723#issuecomment-446885935","issue_url":"https://api.github.com/repos/apache/druid/issues/6723","id":446885935,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0Njg4NTkzNQ==","user":{"login":"love1693294577","id":21165046,"node_id":"MDQ6VXNlcjIxMTY1MDQ2","avatar_url":"https://avatars.githubusercontent.com/u/21165046?v=4","gravatar_id":"","url":"https://api.github.com/users/love1693294577","html_url":"https://github.com/love1693294577","followers_url":"https://api.github.com/users/love1693294577/followers","following_url":"https://api.github.com/users/love1693294577/following{/other_user}","gists_url":"https://api.github.com/users/love1693294577/gists{/gist_id}","starred_url":"https://api.github.com/users/love1693294577/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/love1693294577/subscriptions","organizations_url":"https://api.github.com/users/love1693294577/orgs","repos_url":"https://api.github.com/users/love1693294577/repos","events_url":"https://api.github.com/users/love1693294577/events{/privacy}","received_events_url":"https://api.github.com/users/love1693294577/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-13T08:39:31Z","updated_at":"2018-12-13T08:39:31Z","author_association":"NONE","body":"> > the broker also has segment buffer information.\r\n> \r\n> I think you may talk about segment metadata information. If you enabled sql on your broker, it will do [segment metadata queries](http://druid.io/docs/latest/querying/segmentmetadataquery.html) to obtain information about segment schema. These queries' result would be cached if you enabled the cache.\r\n\r\nOk, I understand, thank you. Have the opportunity to exchange and learn together. I'm in Beijing","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/446885935/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/446901698","html_url":"https://github.com/apache/druid/issues/6723#issuecomment-446901698","issue_url":"https://api.github.com/repos/apache/druid/issues/6723","id":446901698,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0NjkwMTY5OA==","user":{"login":"QiuMM","id":15156517,"node_id":"MDQ6VXNlcjE1MTU2NTE3","avatar_url":"https://avatars.githubusercontent.com/u/15156517?v=4","gravatar_id":"","url":"https://api.github.com/users/QiuMM","html_url":"https://github.com/QiuMM","followers_url":"https://api.github.com/users/QiuMM/followers","following_url":"https://api.github.com/users/QiuMM/following{/other_user}","gists_url":"https://api.github.com/users/QiuMM/gists{/gist_id}","starred_url":"https://api.github.com/users/QiuMM/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/QiuMM/subscriptions","organizations_url":"https://api.github.com/users/QiuMM/orgs","repos_url":"https://api.github.com/users/QiuMM/repos","events_url":"https://api.github.com/users/QiuMM/events{/privacy}","received_events_url":"https://api.github.com/users/QiuMM/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-13T09:33:00Z","updated_at":"2018-12-13T09:33:50Z","author_association":"MEMBER","body":"@love1693294577  sounds good, welcome! You can contact me via email csurjqmm@gmail.com.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/446901698/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/447132125","html_url":"https://github.com/apache/druid/pull/6605#issuecomment-447132125","issue_url":"https://api.github.com/repos/apache/druid/issues/6605","id":447132125,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0NzEzMjEyNQ==","user":{"login":"glasser","id":16724,"node_id":"MDQ6VXNlcjE2NzI0","avatar_url":"https://avatars.githubusercontent.com/u/16724?v=4","gravatar_id":"","url":"https://api.github.com/users/glasser","html_url":"https://github.com/glasser","followers_url":"https://api.github.com/users/glasser/followers","following_url":"https://api.github.com/users/glasser/following{/other_user}","gists_url":"https://api.github.com/users/glasser/gists{/gist_id}","starred_url":"https://api.github.com/users/glasser/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glasser/subscriptions","organizations_url":"https://api.github.com/users/glasser/orgs","repos_url":"https://api.github.com/users/glasser/repos","events_url":"https://api.github.com/users/glasser/events{/privacy}","received_events_url":"https://api.github.com/users/glasser/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-13T21:46:03Z","updated_at":"2018-12-13T21:46:03Z","author_association":"CONTRIBUTOR","body":"Makes sense — we run in Kubernetes where datadog-agents work with multiple namespaces on the same node.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/447132125/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/447145376","html_url":"https://github.com/apache/druid/pull/6734#issuecomment-447145376","issue_url":"https://api.github.com/repos/apache/druid/issues/6734","id":447145376,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0NzE0NTM3Ng==","user":{"login":"jon-wei","id":8729063,"node_id":"MDQ6VXNlcjg3MjkwNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8729063?v=4","gravatar_id":"","url":"https://api.github.com/users/jon-wei","html_url":"https://github.com/jon-wei","followers_url":"https://api.github.com/users/jon-wei/followers","following_url":"https://api.github.com/users/jon-wei/following{/other_user}","gists_url":"https://api.github.com/users/jon-wei/gists{/gist_id}","starred_url":"https://api.github.com/users/jon-wei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jon-wei/subscriptions","organizations_url":"https://api.github.com/users/jon-wei/orgs","repos_url":"https://api.github.com/users/jon-wei/repos","events_url":"https://api.github.com/users/jon-wei/events{/privacy}","received_events_url":"https://api.github.com/users/jon-wei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-13T22:34:20Z","updated_at":"2018-12-13T22:34:20Z","author_association":"CONTRIBUTOR","body":"closing, already being handled by #6637","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/447145376/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/447258515","html_url":"https://github.com/apache/druid/issues/6442#issuecomment-447258515","issue_url":"https://api.github.com/repos/apache/druid/issues/6442","id":447258515,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0NzI1ODUxNQ==","user":{"login":"pantaoran","id":7800702,"node_id":"MDQ6VXNlcjc4MDA3MDI=","avatar_url":"https://avatars.githubusercontent.com/u/7800702?v=4","gravatar_id":"","url":"https://api.github.com/users/pantaoran","html_url":"https://github.com/pantaoran","followers_url":"https://api.github.com/users/pantaoran/followers","following_url":"https://api.github.com/users/pantaoran/following{/other_user}","gists_url":"https://api.github.com/users/pantaoran/gists{/gist_id}","starred_url":"https://api.github.com/users/pantaoran/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pantaoran/subscriptions","organizations_url":"https://api.github.com/users/pantaoran/orgs","repos_url":"https://api.github.com/users/pantaoran/repos","events_url":"https://api.github.com/users/pantaoran/events{/privacy}","received_events_url":"https://api.github.com/users/pantaoran/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-14T08:53:40Z","updated_at":"2018-12-14T08:55:48Z","author_association":"NONE","body":"> @pdeva when 0.13.0 is released, the docs will be updated and /latest should point to the new docs that describe where to put the mysql driver.\r\n\r\nThis sounded reasonable, but it has not happened. I have a tool watching for Druid releases and alerting me to them, so now that it has been released, I wanted to read the release notes. However, many links still point to now non-existing `/docs/0.13.0-incubating/` pages, so I can't read the new documentation. I tried replacing the tag with `latest`, but then I still see `0.12.3` documentation.\r\n\r\nCould you please be careful to really point the `latest` documentation correctly when doing releases? I've had issues with this several times in the past already. It can't possibly be in your best interest to publish exciting new releases only to have many dead links in the release notes. Thank you :-)","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/447258515/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/447264062","html_url":"https://github.com/apache/druid/issues/6737#issuecomment-447264062","issue_url":"https://api.github.com/repos/apache/druid/issues/6737","id":447264062,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0NzI2NDA2Mg==","user":{"login":"helianthuslulu","id":4606832,"node_id":"MDQ6VXNlcjQ2MDY4MzI=","avatar_url":"https://avatars.githubusercontent.com/u/4606832?v=4","gravatar_id":"","url":"https://api.github.com/users/helianthuslulu","html_url":"https://github.com/helianthuslulu","followers_url":"https://api.github.com/users/helianthuslulu/followers","following_url":"https://api.github.com/users/helianthuslulu/following{/other_user}","gists_url":"https://api.github.com/users/helianthuslulu/gists{/gist_id}","starred_url":"https://api.github.com/users/helianthuslulu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/helianthuslulu/subscriptions","organizations_url":"https://api.github.com/users/helianthuslulu/orgs","repos_url":"https://api.github.com/users/helianthuslulu/repos","events_url":"https://api.github.com/users/helianthuslulu/events{/privacy}","received_events_url":"https://api.github.com/users/helianthuslulu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-14T09:15:34Z","updated_at":"2018-12-14T09:15:34Z","author_association":"NONE","body":"The problem has solved, because historical node（druid03）'s firewall is running.....After I **turned off firewall** ，The world got better...(*￣︶￣)","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/447264062/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/447265695","html_url":"https://github.com/apache/druid/issues/6442#issuecomment-447265695","issue_url":"https://api.github.com/repos/apache/druid/issues/6442","id":447265695,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0NzI2NTY5NQ==","user":{"login":"aleksi75","id":37665177,"node_id":"MDQ6VXNlcjM3NjY1MTc3","avatar_url":"https://avatars.githubusercontent.com/u/37665177?v=4","gravatar_id":"","url":"https://api.github.com/users/aleksi75","html_url":"https://github.com/aleksi75","followers_url":"https://api.github.com/users/aleksi75/followers","following_url":"https://api.github.com/users/aleksi75/following{/other_user}","gists_url":"https://api.github.com/users/aleksi75/gists{/gist_id}","starred_url":"https://api.github.com/users/aleksi75/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aleksi75/subscriptions","organizations_url":"https://api.github.com/users/aleksi75/orgs","repos_url":"https://api.github.com/users/aleksi75/repos","events_url":"https://api.github.com/users/aleksi75/events{/privacy}","received_events_url":"https://api.github.com/users/aleksi75/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-14T09:22:08Z","updated_at":"2018-12-14T09:22:08Z","author_association":"CONTRIBUTOR","body":"I don't think that 0.13.0 is officially released. If you look here: http://druid.io/downloads.html, the latest stable release is 0.12.3. ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/447265695/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/447324984","html_url":"https://github.com/apache/druid/issues/6442#issuecomment-447324984","issue_url":"https://api.github.com/repos/apache/druid/issues/6442","id":447324984,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0NzMyNDk4NA==","user":{"login":"pantaoran","id":7800702,"node_id":"MDQ6VXNlcjc4MDA3MDI=","avatar_url":"https://avatars.githubusercontent.com/u/7800702?v=4","gravatar_id":"","url":"https://api.github.com/users/pantaoran","html_url":"https://github.com/pantaoran","followers_url":"https://api.github.com/users/pantaoran/followers","following_url":"https://api.github.com/users/pantaoran/following{/other_user}","gists_url":"https://api.github.com/users/pantaoran/gists{/gist_id}","starred_url":"https://api.github.com/users/pantaoran/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pantaoran/subscriptions","organizations_url":"https://api.github.com/users/pantaoran/orgs","repos_url":"https://api.github.com/users/pantaoran/repos","events_url":"https://api.github.com/users/pantaoran/events{/privacy}","received_events_url":"https://api.github.com/users/pantaoran/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-14T13:26:26Z","updated_at":"2018-12-14T13:26:26Z","author_association":"NONE","body":"Interesting, I had not considered that possibility. All I'm looking at are the releases on GitHub.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/447324984/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/447331035","html_url":"https://github.com/apache/druid/issues/6442#issuecomment-447331035","issue_url":"https://api.github.com/repos/apache/druid/issues/6442","id":447331035,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0NzMzMTAzNQ==","user":{"login":"aleksi75","id":37665177,"node_id":"MDQ6VXNlcjM3NjY1MTc3","avatar_url":"https://avatars.githubusercontent.com/u/37665177?v=4","gravatar_id":"","url":"https://api.github.com/users/aleksi75","html_url":"https://github.com/aleksi75","followers_url":"https://api.github.com/users/aleksi75/followers","following_url":"https://api.github.com/users/aleksi75/following{/other_user}","gists_url":"https://api.github.com/users/aleksi75/gists{/gist_id}","starred_url":"https://api.github.com/users/aleksi75/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aleksi75/subscriptions","organizations_url":"https://api.github.com/users/aleksi75/orgs","repos_url":"https://api.github.com/users/aleksi75/repos","events_url":"https://api.github.com/users/aleksi75/events{/privacy}","received_events_url":"https://api.github.com/users/aleksi75/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-14T13:50:32Z","updated_at":"2018-12-14T13:50:32Z","author_association":"CONTRIBUTOR","body":"Me too =) ...but I have to use the compiled package and so I found (sadly) that there is none","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/447331035/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/447412202","html_url":"https://github.com/apache/druid/issues/6442#issuecomment-447412202","issue_url":"https://api.github.com/repos/apache/druid/issues/6442","id":447412202,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0NzQxMjIwMg==","user":{"login":"dclim","id":11050882,"node_id":"MDQ6VXNlcjExMDUwODgy","avatar_url":"https://avatars.githubusercontent.com/u/11050882?v=4","gravatar_id":"","url":"https://api.github.com/users/dclim","html_url":"https://github.com/dclim","followers_url":"https://api.github.com/users/dclim/followers","following_url":"https://api.github.com/users/dclim/following{/other_user}","gists_url":"https://api.github.com/users/dclim/gists{/gist_id}","starred_url":"https://api.github.com/users/dclim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dclim/subscriptions","organizations_url":"https://api.github.com/users/dclim/orgs","repos_url":"https://api.github.com/users/dclim/repos","events_url":"https://api.github.com/users/dclim/events{/privacy}","received_events_url":"https://api.github.com/users/dclim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-14T18:27:33Z","updated_at":"2018-12-14T18:27:33Z","author_association":"CONTRIBUTOR","body":"@pantaoran apologies for the confusion, @aleksi75 is correct that 0.13.0 isn't officially released quite yet, we're just working on some final steps to prepare. I probably was a bit quick on creating the release tag (I was trying to get the 0.13.0 links and documentation tested in a staging environment and created the tag so the corresponding links would work). The Druid website will be updated and announcements will be sent out when it's official (which should be very soon).","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/447412202/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/447502051","html_url":"https://github.com/apache/druid/pull/6431#issuecomment-447502051","issue_url":"https://api.github.com/repos/apache/druid/issues/6431","id":447502051,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0NzUwMjA1MQ==","user":{"login":"jsun98","id":11185501,"node_id":"MDQ6VXNlcjExMTg1NTAx","avatar_url":"https://avatars.githubusercontent.com/u/11185501?v=4","gravatar_id":"","url":"https://api.github.com/users/jsun98","html_url":"https://github.com/jsun98","followers_url":"https://api.github.com/users/jsun98/followers","following_url":"https://api.github.com/users/jsun98/following{/other_user}","gists_url":"https://api.github.com/users/jsun98/gists{/gist_id}","starred_url":"https://api.github.com/users/jsun98/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jsun98/subscriptions","organizations_url":"https://api.github.com/users/jsun98/orgs","repos_url":"https://api.github.com/users/jsun98/repos","events_url":"https://api.github.com/users/jsun98/events{/privacy}","received_events_url":"https://api.github.com/users/jsun98/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-14T22:49:18Z","updated_at":"2018-12-14T22:49:18Z","author_association":"CONTRIBUTOR","body":"@jihoonson thanks for the comments! I've fixed most of the stuff you mentioned and also left some discussion ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/447502051/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/447524967","html_url":"https://github.com/apache/druid/pull/6740#issuecomment-447524967","issue_url":"https://api.github.com/repos/apache/druid/issues/6740","id":447524967,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0NzUyNDk2Nw==","user":{"login":"sascha-coenen","id":1635350,"node_id":"MDQ6VXNlcjE2MzUzNTA=","avatar_url":"https://avatars.githubusercontent.com/u/1635350?v=4","gravatar_id":"","url":"https://api.github.com/users/sascha-coenen","html_url":"https://github.com/sascha-coenen","followers_url":"https://api.github.com/users/sascha-coenen/followers","following_url":"https://api.github.com/users/sascha-coenen/following{/other_user}","gists_url":"https://api.github.com/users/sascha-coenen/gists{/gist_id}","starred_url":"https://api.github.com/users/sascha-coenen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sascha-coenen/subscriptions","organizations_url":"https://api.github.com/users/sascha-coenen/orgs","repos_url":"https://api.github.com/users/sascha-coenen/repos","events_url":"https://api.github.com/users/sascha-coenen/events{/privacy}","received_events_url":"https://api.github.com/users/sascha-coenen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-15T01:27:02Z","updated_at":"2018-12-15T01:27:02Z","author_association":"NONE","body":"Hi. I'm running Druid on Kubernetes and the fact that the Curator library is not dealing with connection disruptions properly is the one single remaining issue that prevents my setup from being resilient. So I love your motion as it is much needed. I'm not a committer, so I cannot comment on whether the approach chosen is sound, but in one way or another, something has to be done for sure.\r\n\r\nAs as side note, out of shear curiosity I wonder whether there is any good reason to use Curator at all. I know that there are plans to move away from Zookeeper, but it is not Zookeeper that is causing all the issues - it is the Curator client library that is the culprit. I wonder why the Druid Devs don't just throw out Curator and be done with it. Would be much easier than getting rid of Zookeeper, which they can still do, but as a migration path action, I would throw out Curator first. \r\n\r\nThe most natural thing to do would have been to fix the following Curator issue:\r\nhttps://issues.apache.org/jira/browse/CURATOR-229\r\nBut this issue has been reported in 2015 and it still did not get fixed although it is a severe bug that is impeding many people. \r\n\r\nDruid is also not using the most recent version of Curator if I'm not mistaken. Version 4.0.1 has been released in Feb 2018 while Druid master uses 4.0.0. ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/447524967/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/447543421","html_url":"https://github.com/apache/druid/pull/6740#issuecomment-447543421","issue_url":"https://api.github.com/repos/apache/druid/issues/6740","id":447543421,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0NzU0MzQyMQ==","user":{"login":"michael-trelinski","id":4055823,"node_id":"MDQ6VXNlcjQwNTU4MjM=","avatar_url":"https://avatars.githubusercontent.com/u/4055823?v=4","gravatar_id":"","url":"https://api.github.com/users/michael-trelinski","html_url":"https://github.com/michael-trelinski","followers_url":"https://api.github.com/users/michael-trelinski/followers","following_url":"https://api.github.com/users/michael-trelinski/following{/other_user}","gists_url":"https://api.github.com/users/michael-trelinski/gists{/gist_id}","starred_url":"https://api.github.com/users/michael-trelinski/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/michael-trelinski/subscriptions","organizations_url":"https://api.github.com/users/michael-trelinski/orgs","repos_url":"https://api.github.com/users/michael-trelinski/repos","events_url":"https://api.github.com/users/michael-trelinski/events{/privacy}","received_events_url":"https://api.github.com/users/michael-trelinski/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-15T07:01:17Z","updated_at":"2018-12-15T07:01:17Z","author_association":"CONTRIBUTOR","body":"Hi Sascha,\n\nThank you for your interest in my PR.\n\nI would like to make a couple of comments (some are non-sequiters) about why I did what I did:\n\n1.  Fixing this in Curator (or Zookeeper) would affect a whole lot of systems (and systems of systems).  I believe I have tested this well, but I would prefer not to interfere with every other system that uses Zookeeper on the planet’s stability.  If Curator is interested in my workaround, they may have it.  As it is now (pending PR approval), it would be available by explicitly enabling a config file option and sandboxes the change only to Druid.  I feel that this is the best way to roll out something this monumental.\n\n2.  After researching the problem (and also simulating why the RetryPolicy implementations didn’t catch this problem completely), I determined that Zookeeper itself is never really sure when a connection to a server is down or the service is down.  In my opinion, Curator had the best foundation for handling this scenario.\n\n3.  Our reason for this fix had a very specific cause: our DNS response for our Zookeeper servers changed IP addresses, and Java seemed to cache them forever.  Even with the BoundedExponentialBackoff retry policy timing out/giving up, Zookeeper would loop forever and keep a thread alive, which would prevent a clean JVM exit.  We would prefer that the service die (and allow a daemon to restart it) rather than produce bad data.  This may not fit everyone’s use case.\n\n4.  I am excited for my first meaty Druid PR, and I hope that the community accepts this change.\n\nThank you.\n\nBest,\nMike\n\n> On Dec 14, 2018, at 5:27 PM, Sascha Coenen <notifications@github.com> wrote:\n> \n> Hi. I'm running Druid on Kubernetes and the fact that the Curator library is not dealing with connection disruptions properly is the one single remaining issue that prevents my setup from being resilient. So I love your motion as it is much needed. I'm not a committer, so I cannot comment on whether the approach chosen is sound, but in one way or another, something has to be done for sure.\n> \n> As as side note, out of shear curiosity I wonder whether there is any good reason to use Curator at all. I know that there are plans to move away from Zookeeper, but it is not Zookeeper that is causing all the issues - it is the Curator client library that is the culprit. I wonder why the Druid Devs don't just throw out Curator and be done with it. Would be much easier than getting rid of Zookeeper, which they can still do, but as a migration path action, I would throw out Curator first.\n> \n> The most natural thing to do would have been to fix the following Curator issue:\n> https://issues.apache.org/jira/browse/CURATOR-229\n> But this issue has been reported in 2015 and it still did not get fixed although it is a severe bug that is impeding many people.\n> \n> Druid is also not using the most recent version of Curator if I'm not mistaken. Version 4.0.1 has been released in Feb 2018 while Druid master uses 4.0.0.\n> \n> —\n> You are receiving this because you authored the thread.\n> Reply to this email directly, view it on GitHub, or mute the thread.\n","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/447543421/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/447616309","html_url":"https://github.com/apache/druid/pull/6740#issuecomment-447616309","issue_url":"https://api.github.com/repos/apache/druid/issues/6740","id":447616309,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0NzYxNjMwOQ==","user":{"login":"kaijianding","id":8663725,"node_id":"MDQ6VXNlcjg2NjM3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/8663725?v=4","gravatar_id":"","url":"https://api.github.com/users/kaijianding","html_url":"https://github.com/kaijianding","followers_url":"https://api.github.com/users/kaijianding/followers","following_url":"https://api.github.com/users/kaijianding/following{/other_user}","gists_url":"https://api.github.com/users/kaijianding/gists{/gist_id}","starred_url":"https://api.github.com/users/kaijianding/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaijianding/subscriptions","organizations_url":"https://api.github.com/users/kaijianding/orgs","repos_url":"https://api.github.com/users/kaijianding/repos","events_url":"https://api.github.com/users/kaijianding/events{/privacy}","received_events_url":"https://api.github.com/users/kaijianding/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-16T04:07:23Z","updated_at":"2018-12-16T04:07:23Z","author_association":"CONTRIBUTOR","body":"+1\r\nLGTM\r\nI did the same thing in my production environment to let druid process exit when zookeeper server is down for a very long time. This PR is definitely useful.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/447616309/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/448028867","html_url":"https://github.com/apache/druid/issues/6743#issuecomment-448028867","issue_url":"https://api.github.com/repos/apache/druid/issues/6743","id":448028867,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0ODAyODg2Nw==","user":{"login":"AlexanderSaydakov","id":13126686,"node_id":"MDQ6VXNlcjEzMTI2Njg2","avatar_url":"https://avatars.githubusercontent.com/u/13126686?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexanderSaydakov","html_url":"https://github.com/AlexanderSaydakov","followers_url":"https://api.github.com/users/AlexanderSaydakov/followers","following_url":"https://api.github.com/users/AlexanderSaydakov/following{/other_user}","gists_url":"https://api.github.com/users/AlexanderSaydakov/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexanderSaydakov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexanderSaydakov/subscriptions","organizations_url":"https://api.github.com/users/AlexanderSaydakov/orgs","repos_url":"https://api.github.com/users/AlexanderSaydakov/repos","events_url":"https://api.github.com/users/AlexanderSaydakov/events{/privacy}","received_events_url":"https://api.github.com/users/AlexanderSaydakov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-17T22:50:00Z","updated_at":"2018-12-17T22:50:00Z","author_association":"CONTRIBUTOR","body":"I don't see any way around this given the existing protocol. Druid asks the maximum size. And there is no distinction between the size in memory (slot in BufferAggregator) and serialized size in the segment. The 250KB is the absolute maximum size in memory, so that sketches always fit into those BufferAggregator slots. The method to get this size is getMaxIntermediateSize() in AggregatorFactory (note \"intermediate\" in the name).\r\nA serialized result should be about 130KB max. If the intention is to have the serialized size in IncrementalIndex, then, perhaps, another method in AggregatorFactory can be introduced (say, getMaxSerializedSize() or something like that)","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/448028867/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/448030739","html_url":"https://github.com/apache/druid/issues/6743#issuecomment-448030739","issue_url":"https://api.github.com/repos/apache/druid/issues/6743","id":448030739,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0ODAzMDczOQ==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-17T22:57:18Z","updated_at":"2018-12-17T22:57:18Z","author_association":"CONTRIBUTOR","body":"@AlexanderSaydakov One weird thing about how the ingestion-time row size estimator works is that it's using on-heap Aggregators, but it estimates size via the AggregatorFactory `getMaxIntermediateSize()` method that is meant to be the max size of a buffer needed for the BufferAggregator.\r\n\r\nOne thing we could do is add a method to Aggregator (the on-heap interface) that estimates the current on-heap footprint. It can vary in a way that BufferAggregator, currently, can't.\r\n\r\nAnother thing we could do is implement growable BufferAggregators and switch IncrementalIndex to use those instead. It has come up before, see proposal from @himanshug in https://github.com/apache/incubator-druid/issues/2963, but isn't implemented.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/448030739/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/448074220","html_url":"https://github.com/apache/druid/issues/6442#issuecomment-448074220","issue_url":"https://api.github.com/repos/apache/druid/issues/6442","id":448074220,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0ODA3NDIyMA==","user":{"login":"love1693294577","id":21165046,"node_id":"MDQ6VXNlcjIxMTY1MDQ2","avatar_url":"https://avatars.githubusercontent.com/u/21165046?v=4","gravatar_id":"","url":"https://api.github.com/users/love1693294577","html_url":"https://github.com/love1693294577","followers_url":"https://api.github.com/users/love1693294577/followers","following_url":"https://api.github.com/users/love1693294577/following{/other_user}","gists_url":"https://api.github.com/users/love1693294577/gists{/gist_id}","starred_url":"https://api.github.com/users/love1693294577/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/love1693294577/subscriptions","organizations_url":"https://api.github.com/users/love1693294577/orgs","repos_url":"https://api.github.com/users/love1693294577/repos","events_url":"https://api.github.com/users/love1693294577/events{/privacy}","received_events_url":"https://api.github.com/users/love1693294577/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-18T02:30:17Z","updated_at":"2018-12-18T02:30:17Z","author_association":"NONE","body":"> @pantaoran apologies for the confusion, @aleksi75 is correct that 0.13.0 isn't officially released quite yet, we're just working on some final steps to prepare. I probably was a bit quick on creating the release tag (I was trying to get the 0.13.0 links and documentation tested in a staging environment and created the tag so the corresponding links would work). The Druid website will be updated and announcements will be sent out when it's official (which should be very soon).\r\n\r\nHello, for this precise calculation, what are your good methods and plans?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/448074220/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/448190567","html_url":"https://github.com/apache/druid/issues/6752#issuecomment-448190567","issue_url":"https://api.github.com/repos/apache/druid/issues/6752","id":448190567,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0ODE5MDU2Nw==","user":{"login":"dragonls","id":2565118,"node_id":"MDQ6VXNlcjI1NjUxMTg=","avatar_url":"https://avatars.githubusercontent.com/u/2565118?v=4","gravatar_id":"","url":"https://api.github.com/users/dragonls","html_url":"https://github.com/dragonls","followers_url":"https://api.github.com/users/dragonls/followers","following_url":"https://api.github.com/users/dragonls/following{/other_user}","gists_url":"https://api.github.com/users/dragonls/gists{/gist_id}","starred_url":"https://api.github.com/users/dragonls/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dragonls/subscriptions","organizations_url":"https://api.github.com/users/dragonls/orgs","repos_url":"https://api.github.com/users/dragonls/repos","events_url":"https://api.github.com/users/dragonls/events{/privacy}","received_events_url":"https://api.github.com/users/dragonls/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-18T11:33:20Z","updated_at":"2018-12-18T11:33:20Z","author_association":"CONTRIBUTOR","body":"Use JDK8 instead of JDK7.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/448190567/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/448282601","html_url":"https://github.com/apache/druid/pull/6750#issuecomment-448282601","issue_url":"https://api.github.com/repos/apache/druid/issues/6750","id":448282601,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0ODI4MjYwMQ==","user":{"login":"drcrallen","id":8213081,"node_id":"MDQ6VXNlcjgyMTMwODE=","avatar_url":"https://avatars.githubusercontent.com/u/8213081?v=4","gravatar_id":"","url":"https://api.github.com/users/drcrallen","html_url":"https://github.com/drcrallen","followers_url":"https://api.github.com/users/drcrallen/followers","following_url":"https://api.github.com/users/drcrallen/following{/other_user}","gists_url":"https://api.github.com/users/drcrallen/gists{/gist_id}","starred_url":"https://api.github.com/users/drcrallen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/drcrallen/subscriptions","organizations_url":"https://api.github.com/users/drcrallen/orgs","repos_url":"https://api.github.com/users/drcrallen/repos","events_url":"https://api.github.com/users/drcrallen/events{/privacy}","received_events_url":"https://api.github.com/users/drcrallen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-18T16:31:27Z","updated_at":"2018-12-18T16:31:27Z","author_association":"CONTRIBUTOR","body":"@clintropolis I saw you had an issue filed upstream for Roaring, did that get resolved?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/448282601/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/448287980","html_url":"https://github.com/apache/druid/pull/6750#issuecomment-448287980","issue_url":"https://api.github.com/repos/apache/druid/issues/6750","id":448287980,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0ODI4Nzk4MA==","user":{"login":"drcrallen","id":8213081,"node_id":"MDQ6VXNlcjgyMTMwODE=","avatar_url":"https://avatars.githubusercontent.com/u/8213081?v=4","gravatar_id":"","url":"https://api.github.com/users/drcrallen","html_url":"https://github.com/drcrallen","followers_url":"https://api.github.com/users/drcrallen/followers","following_url":"https://api.github.com/users/drcrallen/following{/other_user}","gists_url":"https://api.github.com/users/drcrallen/gists{/gist_id}","starred_url":"https://api.github.com/users/drcrallen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/drcrallen/subscriptions","organizations_url":"https://api.github.com/users/drcrallen/orgs","repos_url":"https://api.github.com/users/drcrallen/repos","events_url":"https://api.github.com/users/drcrallen/events{/privacy}","received_events_url":"https://api.github.com/users/drcrallen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-18T16:46:28Z","updated_at":"2018-12-18T16:46:28Z","author_association":"CONTRIBUTOR","body":"Also, what about the other way, can bitmaps produced by 0.7.30 be read by 0.5.18?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/448287980/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/448367795","html_url":"https://github.com/apache/druid/issues/6442#issuecomment-448367795","issue_url":"https://api.github.com/repos/apache/druid/issues/6442","id":448367795,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0ODM2Nzc5NQ==","user":{"login":"dclim","id":11050882,"node_id":"MDQ6VXNlcjExMDUwODgy","avatar_url":"https://avatars.githubusercontent.com/u/11050882?v=4","gravatar_id":"","url":"https://api.github.com/users/dclim","html_url":"https://github.com/dclim","followers_url":"https://api.github.com/users/dclim/followers","following_url":"https://api.github.com/users/dclim/following{/other_user}","gists_url":"https://api.github.com/users/dclim/gists{/gist_id}","starred_url":"https://api.github.com/users/dclim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dclim/subscriptions","organizations_url":"https://api.github.com/users/dclim/orgs","repos_url":"https://api.github.com/users/dclim/repos","events_url":"https://api.github.com/users/dclim/events{/privacy}","received_events_url":"https://api.github.com/users/dclim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-18T20:58:13Z","updated_at":"2018-12-18T20:58:13Z","author_association":"CONTRIBUTOR","body":"@pantaoran @aleksi75 @love1693294577 just wanted to let you know that 0.13.0-incubating is now officially released! You can get it from: http://druid.io/downloads.html","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/448367795/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/448372032","html_url":"https://github.com/apache/druid/pull/6750#issuecomment-448372032","issue_url":"https://api.github.com/repos/apache/druid/issues/6750","id":448372032,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0ODM3MjAzMg==","user":{"login":"clintropolis","id":1577461,"node_id":"MDQ6VXNlcjE1Nzc0NjE=","avatar_url":"https://avatars.githubusercontent.com/u/1577461?v=4","gravatar_id":"","url":"https://api.github.com/users/clintropolis","html_url":"https://github.com/clintropolis","followers_url":"https://api.github.com/users/clintropolis/followers","following_url":"https://api.github.com/users/clintropolis/following{/other_user}","gists_url":"https://api.github.com/users/clintropolis/gists{/gist_id}","starred_url":"https://api.github.com/users/clintropolis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintropolis/subscriptions","organizations_url":"https://api.github.com/users/clintropolis/orgs","repos_url":"https://api.github.com/users/clintropolis/repos","events_url":"https://api.github.com/users/clintropolis/events{/privacy}","received_events_url":"https://api.github.com/users/clintropolis/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-18T21:11:35Z","updated_at":"2018-12-18T21:11:35Z","author_association":"MEMBER","body":">I saw you had an issue filed upstream for Roaring, did that get resolved?\r\n\r\nThe issue is resolved :+1: \r\n\r\nHowever, it might be worth stalling this PR to wait for another new release because newer patches have made roaring a multi-release jar to allow it to take advantage of some jdk 11 stuff when possible. This is cool, but requires bumping the version of `animal-sniffer-maven-plugin` to 1.16 on our end, because current version we are using breaks with the jdk 11 stuff.\r\n\r\n> Also, what about the other way, can bitmaps produced by 0.7.30 be read by 0.5.18?\r\n\r\nHeh, good point will test. ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/448372032/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/448387901","html_url":"https://github.com/apache/druid/issues/6442#issuecomment-448387901","issue_url":"https://api.github.com/repos/apache/druid/issues/6442","id":448387901,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0ODM4NzkwMQ==","user":{"login":"pdeva","id":3190176,"node_id":"MDQ6VXNlcjMxOTAxNzY=","avatar_url":"https://avatars.githubusercontent.com/u/3190176?v=4","gravatar_id":"","url":"https://api.github.com/users/pdeva","html_url":"https://github.com/pdeva","followers_url":"https://api.github.com/users/pdeva/followers","following_url":"https://api.github.com/users/pdeva/following{/other_user}","gists_url":"https://api.github.com/users/pdeva/gists{/gist_id}","starred_url":"https://api.github.com/users/pdeva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pdeva/subscriptions","organizations_url":"https://api.github.com/users/pdeva/orgs","repos_url":"https://api.github.com/users/pdeva/repos","events_url":"https://api.github.com/users/pdeva/events{/privacy}","received_events_url":"https://api.github.com/users/pdeva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-18T22:04:01Z","updated_at":"2018-12-18T22:04:01Z","author_association":"CONTRIBUTOR","body":"what does 'incubating' stand for in the release name in this case?\r\nis this release not ready for production?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/448387901/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/448411535","html_url":"https://github.com/apache/druid/pull/6750#issuecomment-448411535","issue_url":"https://api.github.com/repos/apache/druid/issues/6750","id":448411535,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0ODQxMTUzNQ==","user":{"login":"clintropolis","id":1577461,"node_id":"MDQ6VXNlcjE1Nzc0NjE=","avatar_url":"https://avatars.githubusercontent.com/u/1577461?v=4","gravatar_id":"","url":"https://api.github.com/users/clintropolis","html_url":"https://github.com/clintropolis","followers_url":"https://api.github.com/users/clintropolis/followers","following_url":"https://api.github.com/users/clintropolis/following{/other_user}","gists_url":"https://api.github.com/users/clintropolis/gists{/gist_id}","starred_url":"https://api.github.com/users/clintropolis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintropolis/subscriptions","organizations_url":"https://api.github.com/users/clintropolis/orgs","repos_url":"https://api.github.com/users/clintropolis/repos","events_url":"https://api.github.com/users/clintropolis/events{/privacy}","received_events_url":"https://api.github.com/users/clintropolis/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-18T23:30:34Z","updated_at":"2018-12-18T23:30:34Z","author_association":"MEMBER","body":"It appears that segments written with 0.7.30 are readable with 0.5.18 in my tests :+1:","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/448411535/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/448412863","html_url":"https://github.com/apache/druid/pull/6754#issuecomment-448412863","issue_url":"https://api.github.com/repos/apache/druid/issues/6754","id":448412863,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0ODQxMjg2Mw==","user":{"login":"jihoonson","id":2322288,"node_id":"MDQ6VXNlcjIzMjIyODg=","avatar_url":"https://avatars.githubusercontent.com/u/2322288?v=4","gravatar_id":"","url":"https://api.github.com/users/jihoonson","html_url":"https://github.com/jihoonson","followers_url":"https://api.github.com/users/jihoonson/followers","following_url":"https://api.github.com/users/jihoonson/following{/other_user}","gists_url":"https://api.github.com/users/jihoonson/gists{/gist_id}","starred_url":"https://api.github.com/users/jihoonson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jihoonson/subscriptions","organizations_url":"https://api.github.com/users/jihoonson/orgs","repos_url":"https://api.github.com/users/jihoonson/repos","events_url":"https://api.github.com/users/jihoonson/events{/privacy}","received_events_url":"https://api.github.com/users/jihoonson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-18T23:36:53Z","updated_at":"2018-12-18T23:36:53Z","author_association":"CONTRIBUTOR","body":"@clintropolis thanks, fixed.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/448412863/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/448413616","html_url":"https://github.com/apache/druid/issues/6442#issuecomment-448413616","issue_url":"https://api.github.com/repos/apache/druid/issues/6442","id":448413616,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0ODQxMzYxNg==","user":{"login":"dclim","id":11050882,"node_id":"MDQ6VXNlcjExMDUwODgy","avatar_url":"https://avatars.githubusercontent.com/u/11050882?v=4","gravatar_id":"","url":"https://api.github.com/users/dclim","html_url":"https://github.com/dclim","followers_url":"https://api.github.com/users/dclim/followers","following_url":"https://api.github.com/users/dclim/following{/other_user}","gists_url":"https://api.github.com/users/dclim/gists{/gist_id}","starred_url":"https://api.github.com/users/dclim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dclim/subscriptions","organizations_url":"https://api.github.com/users/dclim/orgs","repos_url":"https://api.github.com/users/dclim/repos","events_url":"https://api.github.com/users/dclim/events{/privacy}","received_events_url":"https://api.github.com/users/dclim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-18T23:40:35Z","updated_at":"2018-12-18T23:40:35Z","author_association":"CONTRIBUTOR","body":"@pdeva 'incubating' denotes that Druid is currently under the Apache Incubator program (as opposed to having graduated to a full-fledged top level Apache project). All projects enter the Apache foundation through the incubator. It has nothing to do with quality or suitability for production. All GA druid releases are suitable for production usage.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/448413616/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/448433057","html_url":"https://github.com/apache/druid/issues/6752#issuecomment-448433057","issue_url":"https://api.github.com/repos/apache/druid/issues/6752","id":448433057,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0ODQzMzA1Nw==","user":{"login":"huahuang12","id":45962263,"node_id":"MDQ6VXNlcjQ1OTYyMjYz","avatar_url":"https://avatars.githubusercontent.com/u/45962263?v=4","gravatar_id":"","url":"https://api.github.com/users/huahuang12","html_url":"https://github.com/huahuang12","followers_url":"https://api.github.com/users/huahuang12/followers","following_url":"https://api.github.com/users/huahuang12/following{/other_user}","gists_url":"https://api.github.com/users/huahuang12/gists{/gist_id}","starred_url":"https://api.github.com/users/huahuang12/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huahuang12/subscriptions","organizations_url":"https://api.github.com/users/huahuang12/orgs","repos_url":"https://api.github.com/users/huahuang12/repos","events_url":"https://api.github.com/users/huahuang12/events{/privacy}","received_events_url":"https://api.github.com/users/huahuang12/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-19T01:15:20Z","updated_at":"2018-12-19T01:15:20Z","author_association":"NONE","body":"The druid0.9.2 official website is available with jdk1.7\r\nJdk1.7 was used before the server went down.\r\nThis error will also occur if kafka offset is lost before\r\n\r\n> 使用JDK8而不是JDK7。\r\ndruid0.9.2官网上介绍是可以使用jdk1.7的\r\n在服务器宕机重启之前，都可以正常运行，\r\n之前kafka offset丢失，也会出现52 这个错误，所以可以肯定不是版本的问题，还是谢谢你\r\n\r\nThe druid0.9.2 official website is available with jdk1.7\r\nBefore the server is down and restarted, it can run normally.\r\nBefore, kafka offset was lost, and the error 52 would appear, so I'm sure it's not the version problem. Thank you again","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/448433057/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/448435898","html_url":"https://github.com/apache/druid/issues/6752#issuecomment-448435898","issue_url":"https://api.github.com/repos/apache/druid/issues/6752","id":448435898,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0ODQzNTg5OA==","user":{"login":"jon-wei","id":8729063,"node_id":"MDQ6VXNlcjg3MjkwNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8729063?v=4","gravatar_id":"","url":"https://api.github.com/users/jon-wei","html_url":"https://github.com/jon-wei","followers_url":"https://api.github.com/users/jon-wei/followers","following_url":"https://api.github.com/users/jon-wei/following{/other_user}","gists_url":"https://api.github.com/users/jon-wei/gists{/gist_id}","starred_url":"https://api.github.com/users/jon-wei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jon-wei/subscriptions","organizations_url":"https://api.github.com/users/jon-wei/orgs","repos_url":"https://api.github.com/users/jon-wei/repos","events_url":"https://api.github.com/users/jon-wei/events{/privacy}","received_events_url":"https://api.github.com/users/jon-wei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-19T01:29:19Z","updated_at":"2018-12-19T01:29:19Z","author_association":"CONTRIBUTOR","body":"The caffeine cache extension requires and was built with JDK8, even when the rest of Druid was built using JDK7:\r\n\r\nhttps://github.com/apache/incubator-druid/pull/3028\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/448435898/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/448437392","html_url":"https://github.com/apache/druid/issues/6752#issuecomment-448437392","issue_url":"https://api.github.com/repos/apache/druid/issues/6752","id":448437392,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0ODQzNzM5Mg==","user":{"login":"huahuang12","id":45962263,"node_id":"MDQ6VXNlcjQ1OTYyMjYz","avatar_url":"https://avatars.githubusercontent.com/u/45962263?v=4","gravatar_id":"","url":"https://api.github.com/users/huahuang12","html_url":"https://github.com/huahuang12","followers_url":"https://api.github.com/users/huahuang12/followers","following_url":"https://api.github.com/users/huahuang12/following{/other_user}","gists_url":"https://api.github.com/users/huahuang12/gists{/gist_id}","starred_url":"https://api.github.com/users/huahuang12/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huahuang12/subscriptions","organizations_url":"https://api.github.com/users/huahuang12/orgs","repos_url":"https://api.github.com/users/huahuang12/repos","events_url":"https://api.github.com/users/huahuang12/events{/privacy}","received_events_url":"https://api.github.com/users/huahuang12/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-19T01:36:49Z","updated_at":"2018-12-19T01:36:49Z","author_association":"NONE","body":"> 咖啡因缓存扩展需要并使用JDK8构建，即使其余的Druid是使用JDK7构建的：\r\n> \r\n> [＃3028](https://github.com/apache/incubator-druid/pull/3028)\r\n\r\n但是 我之前一直使用的jdk1.7可以正常运行不会出现这个错误，\r\n出现这个错误我进行过尝试，kafka offset丢失，时间格式错误也会出现这个错误\r\n所以我觉得是可以排除jdk版本的问题。\r\n谢谢你\r\nHowever, jdk1.7, which I have been using before, works without this error.\r\nI have tried this error before. Kafka offset is lost, and time format error will also result in this error\r\nSo I think it's possible to troubleshoot JDK versions.\r\nThank you","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/448437392/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/448438481","html_url":"https://github.com/apache/druid/issues/6752#issuecomment-448438481","issue_url":"https://api.github.com/repos/apache/druid/issues/6752","id":448438481,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0ODQzODQ4MQ==","user":{"login":"jon-wei","id":8729063,"node_id":"MDQ6VXNlcjg3MjkwNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8729063?v=4","gravatar_id":"","url":"https://api.github.com/users/jon-wei","html_url":"https://github.com/jon-wei","followers_url":"https://api.github.com/users/jon-wei/followers","following_url":"https://api.github.com/users/jon-wei/following{/other_user}","gists_url":"https://api.github.com/users/jon-wei/gists{/gist_id}","starred_url":"https://api.github.com/users/jon-wei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jon-wei/subscriptions","organizations_url":"https://api.github.com/users/jon-wei/orgs","repos_url":"https://api.github.com/users/jon-wei/repos","events_url":"https://api.github.com/users/jon-wei/events{/privacy}","received_events_url":"https://api.github.com/users/jon-wei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-19T01:42:09Z","updated_at":"2018-12-19T01:42:09Z","author_association":"CONTRIBUTOR","body":"You'll need to either use Java 8 or disable the caffeine cache.\r\n\r\nPlease note that the doc page (http://druid.io/docs/0.9.2/development/extensions-core/caffeine-cache.html) mentions: \r\n\r\n> A highly performant local cache implementation for Druid based on Caffeine. Requires a JRE8u60 or higher\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/448438481/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/448480269","html_url":"https://github.com/apache/druid/issues/6017#issuecomment-448480269","issue_url":"https://api.github.com/repos/apache/druid/issues/6017","id":448480269,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0ODQ4MDI2OQ==","user":{"login":"shivtools","id":12538052,"node_id":"MDQ6VXNlcjEyNTM4MDUy","avatar_url":"https://avatars.githubusercontent.com/u/12538052?v=4","gravatar_id":"","url":"https://api.github.com/users/shivtools","html_url":"https://github.com/shivtools","followers_url":"https://api.github.com/users/shivtools/followers","following_url":"https://api.github.com/users/shivtools/following{/other_user}","gists_url":"https://api.github.com/users/shivtools/gists{/gist_id}","starred_url":"https://api.github.com/users/shivtools/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shivtools/subscriptions","organizations_url":"https://api.github.com/users/shivtools/orgs","repos_url":"https://api.github.com/users/shivtools/repos","events_url":"https://api.github.com/users/shivtools/events{/privacy}","received_events_url":"https://api.github.com/users/shivtools/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-19T06:06:16Z","updated_at":"2018-12-19T06:06:16Z","author_association":"CONTRIBUTOR","body":"Hey @gianm, I wanted to take up this ticket and would appreciate if you could provide a little more insight into the following questions: \r\n\r\n1. When you refer to adding a new method that accepts invalid queries as byte arrays, I'm assuming that you're referring to this [method](https://github.com/apache/incubator-druid/blob/7a09cde4de1953eee75c5033e863cfde8f94d6c1/server/src/main/java/org/apache/druid/server/QueryLifecycle.java#L328-L334)?\r\n2. Would we also have to modify the [Query](https://github.com/apache/incubator-druid/blob/master/processing/src/main/java/org/apache/druid/query/Query.java) object such that it can store information about the query string? I guess I'm trying to understand how to get to the bytes of the query that you refer to in your comment.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/448480269/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/448499188","html_url":"https://github.com/apache/druid/issues/6442#issuecomment-448499188","issue_url":"https://api.github.com/repos/apache/druid/issues/6442","id":448499188,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0ODQ5OTE4OA==","user":{"login":"aleksi75","id":37665177,"node_id":"MDQ6VXNlcjM3NjY1MTc3","avatar_url":"https://avatars.githubusercontent.com/u/37665177?v=4","gravatar_id":"","url":"https://api.github.com/users/aleksi75","html_url":"https://github.com/aleksi75","followers_url":"https://api.github.com/users/aleksi75/followers","following_url":"https://api.github.com/users/aleksi75/following{/other_user}","gists_url":"https://api.github.com/users/aleksi75/gists{/gist_id}","starred_url":"https://api.github.com/users/aleksi75/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aleksi75/subscriptions","organizations_url":"https://api.github.com/users/aleksi75/orgs","repos_url":"https://api.github.com/users/aleksi75/repos","events_url":"https://api.github.com/users/aleksi75/events{/privacy}","received_events_url":"https://api.github.com/users/aleksi75/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-19T07:42:17Z","updated_at":"2018-12-19T07:42:17Z","author_association":"CONTRIBUTOR","body":"> \r\n> \r\n> @pantaoran @aleksi75 @love1693294577 just wanted to let you know that 0.13.0-incubating is now officially released! You can get it from: http://druid.io/downloads.html\r\nYippie a yeah. \r\n","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/448499188/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/448786744","html_url":"https://github.com/apache/druid/pull/6760#issuecomment-448786744","issue_url":"https://api.github.com/repos/apache/druid/issues/6760","id":448786744,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0ODc4Njc0NA==","user":{"login":"glasser","id":16724,"node_id":"MDQ6VXNlcjE2NzI0","avatar_url":"https://avatars.githubusercontent.com/u/16724?v=4","gravatar_id":"","url":"https://api.github.com/users/glasser","html_url":"https://github.com/glasser","followers_url":"https://api.github.com/users/glasser/followers","following_url":"https://api.github.com/users/glasser/following{/other_user}","gists_url":"https://api.github.com/users/glasser/gists{/gist_id}","starred_url":"https://api.github.com/users/glasser/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glasser/subscriptions","organizations_url":"https://api.github.com/users/glasser/orgs","repos_url":"https://api.github.com/users/glasser/repos","events_url":"https://api.github.com/users/glasser/events{/privacy}","received_events_url":"https://api.github.com/users/glasser/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-19T23:26:29Z","updated_at":"2018-12-19T23:26:29Z","author_association":"CONTRIBUTOR","body":"When I went to upgrade our project to 0.13.0, some Kotlin code failed to compile because we were assuming this method did not return null.  I was confused by the comment that said it didn't return null, but then found @nishantmonu51 's work here. This fixes the comments.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/448786744/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/448816707","html_url":"https://github.com/apache/druid/issues/6743#issuecomment-448816707","issue_url":"https://api.github.com/repos/apache/druid/issues/6743","id":448816707,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0ODgxNjcwNw==","user":{"login":"leerho","id":12941506,"node_id":"MDQ6VXNlcjEyOTQxNTA2","avatar_url":"https://avatars.githubusercontent.com/u/12941506?v=4","gravatar_id":"","url":"https://api.github.com/users/leerho","html_url":"https://github.com/leerho","followers_url":"https://api.github.com/users/leerho/followers","following_url":"https://api.github.com/users/leerho/following{/other_user}","gists_url":"https://api.github.com/users/leerho/gists{/gist_id}","starred_url":"https://api.github.com/users/leerho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leerho/subscriptions","organizations_url":"https://api.github.com/users/leerho/orgs","repos_url":"https://api.github.com/users/leerho/repos","events_url":"https://api.github.com/users/leerho/events{/privacy}","received_events_url":"https://api.github.com/users/leerho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-20T01:05:56Z","updated_at":"2018-12-20T01:05:56Z","author_association":"CONTRIBUTOR","body":"@gianm \r\n\r\nI don't have a deep understanding of the inner workings of the memory allocation strategy in Druid, but I should point out that the current model of allocating equal sized slots in a Buffer where each slot is the maximum possible size of a sketch Is very likely a horrible waste of memory space.  \r\n\r\nSketches, are designed to start very small in their memory requirements and then grow gradually as the size of the input stream grows. Unique counting sketches (Theta, HLL, CPC) actually reach a maximum size, beyond which they do not grow at all.  Quantile sketches can continue to grow but very very slowly (sub-logarithmically with the size of the input stream).\r\n\r\nFor example, a Theta Sketch configured with LgK = 14 (~16K) has a maximum size of about 256KB. However, with only one entry it consumes only 16 Bytes.\r\n\r\nOur experience in using sketches in large systems is that the size of the input streams that feed the sketches tend to follow a power-law distribution.  Which means given a system total number of sketches of one million, the vast majority of sketches will have very few entries, and just a few sketches will be full size.   \r\n\r\n> Note: If the sketches ingested into Druid are pre-aggregated sectors, for example, this power-law distribution in space required for the sketches is not as strong, as most of the sketches will already be at max size.  But in this case you are dealing with far fewer sketches, so the memory management concern may not be as severe.\r\n\r\nTo illustrate this power-law effect, I have created a toy model of space utilization in the attached excel spreadsheet:\r\n\r\n[DruidModel_pwrLaw.xlsx](https://github.com/apache/incubator-druid/files/2696971/DruidModel_pwrLaw.xlsx)\r\n\r\nFor this model I assumed a power-law distribution of stream sizes from one unique to 134M uniques and a configured sketch size LgK = 14.  I adjusted the parameters so that the total number of sketches in the system is about one million.  \r\n\r\nWith these assumptions, the actual storage bytes required by all of the sketches is about 440MB.  However, allocating the full size of 256KB for every sketch would require nearly 35GB.  This results in a space utilization of about 1.27%!  This is a huge waste of memory! \r\n\r\n***\r\nWhat I would recommend is that if we could work together, we could come up with a much more efficient memory management model for sketches in Druid that would allow you to recapture most if not all of that wasted space.  This will likely require some changes in Druid as well as a change in how sketches use and allocate memory.\r\n\r\nOne idea I have is to allow each sketch to self-allocate the space it needs as it grows. The sketch would be responsible for allocating new space and deallocating old space (especially for off-heap). \r\nWhat would live in the equal-sized slots of the Druid buffer would be a small, fixed sized \"wrapper\" with a pointer and a few other values, where the data structure of the sketch would be in an off-heap space managed by the sketch itself.  This means that Druid memory manager would have to allow for some amount of off-heap space that it is not controlling.  In the toy model above, that would be about 440MB of off-heap space.  The benefit is that Druid would get back nearly 35GB of off-heap space for other uses.  It seems like a big win to me, but I don't understand what changes would have to happen in Druid to make this work. \r\n\r\nWe can certainly do the sketch work, but you (or someone deep into Druid) would have to make the appropriate changes in Druid.  One important aspect of the Druid work would be to provide some simple tools to analyze the actual distributions of stream sizes, sketch sizes and space utilizations before and after the change. This meta-data would be invaluable feedback for us to understand specific Druid customers' situations, and help us tune the system for even better performance going forward.\r\n\r\nWhat do you think?\r\n\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/448816707/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/448840691","html_url":"https://github.com/apache/druid/issues/6752#issuecomment-448840691","issue_url":"https://api.github.com/repos/apache/druid/issues/6752","id":448840691,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0ODg0MDY5MQ==","user":{"login":"huahuang12","id":45962263,"node_id":"MDQ6VXNlcjQ1OTYyMjYz","avatar_url":"https://avatars.githubusercontent.com/u/45962263?v=4","gravatar_id":"","url":"https://api.github.com/users/huahuang12","html_url":"https://github.com/huahuang12","followers_url":"https://api.github.com/users/huahuang12/followers","following_url":"https://api.github.com/users/huahuang12/following{/other_user}","gists_url":"https://api.github.com/users/huahuang12/gists{/gist_id}","starred_url":"https://api.github.com/users/huahuang12/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huahuang12/subscriptions","organizations_url":"https://api.github.com/users/huahuang12/orgs","repos_url":"https://api.github.com/users/huahuang12/repos","events_url":"https://api.github.com/users/huahuang12/events{/privacy}","received_events_url":"https://api.github.com/users/huahuang12/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-20T02:55:38Z","updated_at":"2018-12-20T02:55:38Z","author_association":"NONE","body":"> 您需要使用Java 8或禁用咖啡因缓存。\r\n> \r\n> 请注意，doc页面（http://druid.io/docs/0.9.2/development/extensions-core/caffeine-cache.html）提到：\r\n> \r\n> > 基于Caffeine的德鲁伊高性能本地缓存实现。需要JRE8u60或更高版本\r\n\r\nI rebuilt the operating environment with jdk1.8, and when I first started tranquility kafka, I could normally write kafka data into druid. When I modified the Java variable to 1.7, the following error occurred when I started tranquility kafka service again.Tranquility - distribution - 0.8.0 lib directory. IO druid. The druid - processing - 0.9.0. Jar is no IO/druid/query/lookup/LookupExtractorFactory class, because it belongs to the druid lib directory of the druid - processing - 0.9.2. Jar package, why is this case?\r\n\r\n我使用jdk1.8重新搭建了运行环境，第一次启动 tranquility kafka可以正常将kafka数据写入druid,当我修改java变量 ，为1.7版本，再次启动  tranquility kafka 服务出现如下错误，tranquility-distribution-0.8.0 lib目录下io.druid.druid-processing-0.9.0.jar 确实没有 io/druid/query/lookup/LookupExtractorFactory 类，因为它属于druid lib 目录下的druid-processing-0.9.2.jar 包，为什么会出现这种情况呢？\r\n\r\n\r\n2018-12-20 10:29:15,119 [KafkaConsumer-1] INFO  i.d.initialization.Initialization - Loading extension [mysql-metadata-storage] for class [io.druid.initialization.DruidModule]\r\n2018-12-20 10:29:15,120 [KafkaConsumer-1] INFO  i.d.initialization.Initialization - added URL[file:/bigdata/druid-0.9.2/extensions/mysql-metadata-storage/mysql-connector-java-5.1.38.jar]\r\n2018-12-20 10:29:15,120 [KafkaConsumer-1] INFO  i.d.initialization.Initialization - added URL[file:/bigdata/druid-0.9.2/extensions/mysql-metadata-storage/mysql-metadata-storage-0.9.2.jar]\r\n2018-12-20 10:29:15,123 [KafkaConsumer-1] INFO  i.d.initialization.Initialization - Adding local file system extension module [io.druid.metadata.storage.mysql.MySQLMetadataStorageModule] for class [io.druid.initialization.DruidModule]\r\n2018-12-20 10:29:15,162 [KafkaConsumer-1] ERROR c.m.tranquility.kafka.KafkaConsumer - Exception: \r\njava.lang.NoClassDefFoundError: io/druid/query/lookup/LookupExtractorFactory\r\n\tat java.lang.ClassLoader.defineClass1(Native Method) ~[na:1.8.0_131]\r\n\tat java.lang.ClassLoader.defineClass(ClassLoader.java:763) ~[na:1.8.0_131]\r\n\tat java.security.SecureClassLoader.defineClass(SecureClassLoader.java:142) ~[na:1.8.0_131]\r\n\tat java.net.URLClassLoader.defineClass(URLClassLoader.java:467) ~[na:1.8.0_131]\r\n\tat java.net.URLClassLoader.access$100(URLClassLoader.java:73) ~[na:1.8.0_131]\r\n\tat java.net.URLClassLoader$1.run(URLClassLoader.java:368) ~[na:1.8.0_131]\r\n\tat java.net.URLClassLoader$1.run(URLClassLoader.java:362) ~[na:1.8.0_131]\r\n\tat java.security.AccessController.doPrivileged(Native Method) ~[na:1.8.0_131]\r\n\tat java.net.URLClassLoader.findClass(URLClassLoader.java:361) ~[na:1.8.0_131]\r\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:424) ~[na:1.8.0_131]\r\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:357) ~[na:1.8.0_131]\r\n\tat io.druid.server.lookup.LookupExtractionModule$1.setupModule(LookupExtractionModule.java:43) ~[na:na]\r\n\tat com.fasterxml.jackson.databind.ObjectMapper.registerModule(ObjectMapper.java:549) ~[com.fasterxml.jackson.core.jackson-databind-2.4.6.jar:2.4.6]\r\n\tat com.metamx.tranquility.druid.DruidGuicer$$anonfun$registerWithJackson$1$1.apply(DruidGuicer.scala:82) ~[io.druid.tranquility-core-0.8.0.jar:0.8.0]\r\n\tat com.metamx.tranquility.druid.DruidGuicer$$anonfun$registerWithJackson$1$1.apply(DruidGuicer.scala:81) ~[io.druid.tranquility-core-0.8.0.jar:0.8.0]\r\n\tat scala.collection.Iterator$class.foreach(Iterator.scala:742) ~[org.scala-lang.scala-library-2.11.7.jar:na]\r\n\tat scala.collection.AbstractIterator.foreach(Iterator.scala:1194) ~[org.scala-lang.scala-library-2.11.7.jar:na]\r\n\tat scala.collection.IterableLike$class.foreach(IterableLike.scala:72) ~[org.scala-lang.scala-library-2.11.7.jar:na]\r\n\tat scala.collection.AbstractIterable.foreach(Iterable.scala:54) ~[org.scala-lang.scala-library-2.11.7.jar:na]\r\n\tat com.metamx.tranquility.druid.DruidGuicer.registerWithJackson$1(DruidGuicer.scala:80) ~[io.druid.tranquility-core-0.8.0.jar:0.8.0]\r\n\tat com.metamx.tranquility.druid.DruidGuicer.com$metamx$tranquility$druid$DruidGuicer$$toGuiceModule$1(DruidGuicer.scala:89) ~[io.druid.tranquility-core-0.8.0.jar:0.8.0]\r\n\tat com.metamx.tranquility.druid.DruidGuicer$$anonfun$3.apply(DruidGuicer.scala:127) ~[io.druid.tranquility-core-0.8.0.jar:0.8.0]\r\n\tat com.metamx.tranquility.druid.DruidGuicer$$anonfun$3.apply(DruidGuicer.scala:127) ~[io.druid.tranquility-core-0.8.0.jar:0.8.0]\r\n\tat scala.collection.immutable.Stream$$anonfun$map$1.apply(Stream.scala:418) ~[org.scala-lang.scala-library-2.11.7.jar:na]\r\n\tat scala.collection.immutable.Stream$$anonfun$map$1.apply(Stream.scala:418) ~[org.scala-lang.scala-library-2.11.7.jar:na]\r\n\tat scala.collection.immutable.Stream$Cons.tail(Stream.scala:1233) ~[org.scala-lang.scala-library-2.11.7.jar:na]\r\n\tat scala.collection.immutable.Stream$Cons.tail(Stream.scala:1223) ~[org.scala-lang.scala-library-2.11.7.jar:na]\r\n\tat scala.collection.generic.Growable$class.loop$1(Growable.scala:54) ~[org.scala-lang.scala-library-2.11.7.jar:na]\r\n","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/448840691/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/448973169","html_url":"https://github.com/apache/druid/issues/6752#issuecomment-448973169","issue_url":"https://api.github.com/repos/apache/druid/issues/6752","id":448973169,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0ODk3MzE2OQ==","user":{"login":"dragonls","id":2565118,"node_id":"MDQ6VXNlcjI1NjUxMTg=","avatar_url":"https://avatars.githubusercontent.com/u/2565118?v=4","gravatar_id":"","url":"https://api.github.com/users/dragonls","html_url":"https://github.com/dragonls","followers_url":"https://api.github.com/users/dragonls/followers","following_url":"https://api.github.com/users/dragonls/following{/other_user}","gists_url":"https://api.github.com/users/dragonls/gists{/gist_id}","starred_url":"https://api.github.com/users/dragonls/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dragonls/subscriptions","organizations_url":"https://api.github.com/users/dragonls/orgs","repos_url":"https://api.github.com/users/dragonls/repos","events_url":"https://api.github.com/users/dragonls/events{/privacy}","received_events_url":"https://api.github.com/users/dragonls/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-20T11:53:28Z","updated_at":"2018-12-20T11:53:28Z","author_association":"CONTRIBUTOR","body":"It seems that the tranquility is loading extension from druid 0.9.2, while the codes in druid 0.9.2 are using the class io.druid.query.lookup.LookupExtractorFactory. Try using the druid 0.9.2 codes in front of druid 0.9.0, i.e. put the druid-processing-0.9.2.jar in front of druid-processing-0.9.0.jar in classpath.\r\nWhy not try the newer version of Druid? Just curious.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/448973169/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/449077624","html_url":"https://github.com/apache/druid/pull/6702#issuecomment-449077624","issue_url":"https://api.github.com/repos/apache/druid/issues/6702","id":449077624,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0OTA3NzYyNA==","user":{"login":"leventov","id":609240,"node_id":"MDQ6VXNlcjYwOTI0MA==","avatar_url":"https://avatars.githubusercontent.com/u/609240?v=4","gravatar_id":"","url":"https://api.github.com/users/leventov","html_url":"https://github.com/leventov","followers_url":"https://api.github.com/users/leventov/followers","following_url":"https://api.github.com/users/leventov/following{/other_user}","gists_url":"https://api.github.com/users/leventov/gists{/gist_id}","starred_url":"https://api.github.com/users/leventov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leventov/subscriptions","organizations_url":"https://api.github.com/users/leventov/orgs","repos_url":"https://api.github.com/users/leventov/repos","events_url":"https://api.github.com/users/leventov/events{/privacy}","received_events_url":"https://api.github.com/users/leventov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-20T17:37:19Z","updated_at":"2018-12-20T17:37:19Z","author_association":"MEMBER","body":"@kaijianding originally I created this endpoint to be used on brokers only, but then generalized to other node types, because why not. What do you think if I change the code so that the new endpoint is added only on brokers and coordinators for now? \r\n\r\nUnfortunately #6683 seems to be far from merging, and the next Druid release process should be started between 10th and 20th of January. I think it would be useful to add the new endpoint at least on brokers and coordinators.\r\n\r\n> Is it better to add similar listener mechanism when DruidNodeAnnouncer.announce(DiscoveryDruidNode) is called?\r\n\r\nI didn't understand what could be added when that method is called. Could you please elaborate?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/449077624/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/449086376","html_url":"https://github.com/apache/druid/pull/6765#issuecomment-449086376","issue_url":"https://api.github.com/repos/apache/druid/issues/6765","id":449086376,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0OTA4NjM3Ng==","user":{"login":"dclim","id":11050882,"node_id":"MDQ6VXNlcjExMDUwODgy","avatar_url":"https://avatars.githubusercontent.com/u/11050882?v=4","gravatar_id":"","url":"https://api.github.com/users/dclim","html_url":"https://github.com/dclim","followers_url":"https://api.github.com/users/dclim/followers","following_url":"https://api.github.com/users/dclim/following{/other_user}","gists_url":"https://api.github.com/users/dclim/gists{/gist_id}","starred_url":"https://api.github.com/users/dclim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dclim/subscriptions","organizations_url":"https://api.github.com/users/dclim/orgs","repos_url":"https://api.github.com/users/dclim/repos","events_url":"https://api.github.com/users/dclim/events{/privacy}","received_events_url":"https://api.github.com/users/dclim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-20T18:07:28Z","updated_at":"2018-12-20T18:07:28Z","author_association":"CONTRIBUTOR","body":"👍 ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/449086376/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/449090264","html_url":"https://github.com/apache/druid/pull/6764#issuecomment-449090264","issue_url":"https://api.github.com/repos/apache/druid/issues/6764","id":449090264,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0OTA5MDI2NA==","user":{"login":"b-slim","id":7376396,"node_id":"MDQ6VXNlcjczNzYzOTY=","avatar_url":"https://avatars.githubusercontent.com/u/7376396?v=4","gravatar_id":"","url":"https://api.github.com/users/b-slim","html_url":"https://github.com/b-slim","followers_url":"https://api.github.com/users/b-slim/followers","following_url":"https://api.github.com/users/b-slim/following{/other_user}","gists_url":"https://api.github.com/users/b-slim/gists{/gist_id}","starred_url":"https://api.github.com/users/b-slim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/b-slim/subscriptions","organizations_url":"https://api.github.com/users/b-slim/orgs","repos_url":"https://api.github.com/users/b-slim/repos","events_url":"https://api.github.com/users/b-slim/events{/privacy}","received_events_url":"https://api.github.com/users/b-slim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-20T18:21:16Z","updated_at":"2018-12-20T18:21:16Z","author_association":"CONTRIBUTOR","body":"@richardstartin can you please fix \r\n```\r\nSelected: Unused declaration (1)\r\nprocessing/src/main/java/org/apache/druid/collections/bitmap\r\nWrappedRoaringBitmap.java (1)\r\n54: WrappedRoaringBitmap() Parameter compressRunOnSerialization is not used in either this method or any of its derived methods\r\n```\r\nto have a clean build. Thanks","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/449090264/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/449090463","html_url":"https://github.com/apache/druid/pull/6740#issuecomment-449090463","issue_url":"https://api.github.com/repos/apache/druid/issues/6740","id":449090463,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0OTA5MDQ2Mw==","user":{"login":"leventov","id":609240,"node_id":"MDQ6VXNlcjYwOTI0MA==","avatar_url":"https://avatars.githubusercontent.com/u/609240?v=4","gravatar_id":"","url":"https://api.github.com/users/leventov","html_url":"https://github.com/leventov","followers_url":"https://api.github.com/users/leventov/followers","following_url":"https://api.github.com/users/leventov/following{/other_user}","gists_url":"https://api.github.com/users/leventov/gists{/gist_id}","starred_url":"https://api.github.com/users/leventov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leventov/subscriptions","organizations_url":"https://api.github.com/users/leventov/orgs","repos_url":"https://api.github.com/users/leventov/repos","events_url":"https://api.github.com/users/leventov/events{/privacy}","received_events_url":"https://api.github.com/users/leventov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-20T18:22:00Z","updated_at":"2018-12-20T18:22:00Z","author_association":"MEMBER","body":"Added `Design Review` tag because this PR adds a config parameter.\r\n\r\n@kaijianding please add such \"important\" tags (along with `Incompatible`) when you are the first committer who visits a PR.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/449090463/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/449100919","html_url":"https://github.com/apache/druid/pull/6764#issuecomment-449100919","issue_url":"https://api.github.com/repos/apache/druid/issues/6764","id":449100919,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0OTEwMDkxOQ==","user":{"login":"richardstartin","id":16439049,"node_id":"MDQ6VXNlcjE2NDM5MDQ5","avatar_url":"https://avatars.githubusercontent.com/u/16439049?v=4","gravatar_id":"","url":"https://api.github.com/users/richardstartin","html_url":"https://github.com/richardstartin","followers_url":"https://api.github.com/users/richardstartin/followers","following_url":"https://api.github.com/users/richardstartin/following{/other_user}","gists_url":"https://api.github.com/users/richardstartin/gists{/gist_id}","starred_url":"https://api.github.com/users/richardstartin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/richardstartin/subscriptions","organizations_url":"https://api.github.com/users/richardstartin/orgs","repos_url":"https://api.github.com/users/richardstartin/repos","events_url":"https://api.github.com/users/richardstartin/events{/privacy}","received_events_url":"https://api.github.com/users/richardstartin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-20T18:58:30Z","updated_at":"2018-12-20T19:59:11Z","author_association":"MEMBER","body":"@b-slim this is more of a working heads up (i.e. I think you can probably build your roaring bitmaps faster) rather than something I would expect you to merge. The fact that run compression can be applied incrementally so you don't need to do it when you serialise the bitmaps ripples out fairly quickly to \"BitmapSerdeFactory\" JSON formats, and I can't offer a view on how they should be kept backward compatible. If you update, please feel free to use this commit as a reference.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/449100919/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/449146550","html_url":"https://github.com/apache/druid/issues/6743#issuecomment-449146550","issue_url":"https://api.github.com/repos/apache/druid/issues/6743","id":449146550,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0OTE0NjU1MA==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-20T21:49:48Z","updated_at":"2018-12-20T21:49:48Z","author_association":"CONTRIBUTOR","body":"> I don't have a deep understanding of the inner workings of the memory allocation strategy in Druid, but I should point out that the current model of allocating equal sized slots in a Buffer where each slot is the maximum possible size of a sketch Is very likely a horrible waste of memory space.\r\n\r\nYeah, it's not ideal, especially not for some of the newer sketches. (The granddaddy of Druid sketches, hyperUnique, doesn't have a very high max memory footprint, so it was less of an issue back then.)\r\n\r\n> What I would recommend is that if we could work together, we could come up with a much more efficient memory management model for sketches in Druid that would allow you to recapture most if not all of that wasted space. This will likely require some changes in Druid as well as a change in how sketches use and allocate memory.\r\n\r\nThat would be awesome.\r\n\r\nRather than the Druid memory manager allowing for off-heap space that it doesn't control, what if Druid _did_ control it, but basically delegated that control to the sketch? Druid's query engine works by allocating a fixed-size \"processing buffer\" to each compute thread. When a thread processes a segment, it allocates all the memory it needs out of that buffer. After the segment is done being processed, the results are transferred elsewhere, and the processing buffer is reused for the next segment to be processed. The processing buffers are typically 500MB to 2GB in size, and they are preallocated at server startup to avoid \"surprises\" (one buffer per compute thread, which is a fixed-size pool generally set to the number of processors).\r\n\r\nRight now, as I'm guessing you know, the protocol for aggregators getting space in that buffer is something like:\r\n\r\n1. Druid calls AggregatorFactory's getMaxIntermediateSize method to figure out how much memory to allocate per aggregator.\r\n2. Druid allocates that much memory per grouping tuple.\r\n3. Druid calls BufferAggregator's \"init\", \"aggregate\", and \"get\" methods to interact with the memory it has allocated.\r\n\r\nRiffing off your idea, what I'm thinking is carving out a chunk of the processing buffer to be managed by the BufferAggregator impl:\r\n\r\n1. Druid calls a new AggregatorFactory \"getTypicalIntermediateSize\" method to figure out a \"typical\" size per aggregator, and getMaxIntermediateSize to figure out the max.\r\n2. Druid computes how many grouping tuples it could store in the buffer if each one had aggregators of the \"typical\" size. Call it N.\r\n3. Druid carves out an arena of size N * getTypicalIntermediateSize from the processing buffer, and passes it to the AggregatorFactory's \"factorizeBuffered\" method, which creates a BufferAggregator that is free to use that arena.\r\n4. For each grouping tuple, Druid stores not the aggregated value, but just the information needed to find the actual data in the arena.\r\n\r\nWe could also tweak this protocol to avoid the arena if \"typical\" equals \"max\", so primitive aggregators don't need to become more complex, and so we save the extra overhead for the pointer into the arena.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/449146550/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/449159637","html_url":"https://github.com/apache/druid/issues/6320#issuecomment-449159637","issue_url":"https://api.github.com/repos/apache/druid/issues/6320","id":449159637,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0OTE1OTYzNw==","user":{"login":"yurmix","id":1529282,"node_id":"MDQ6VXNlcjE1MjkyODI=","avatar_url":"https://avatars.githubusercontent.com/u/1529282?v=4","gravatar_id":"","url":"https://api.github.com/users/yurmix","html_url":"https://github.com/yurmix","followers_url":"https://api.github.com/users/yurmix/followers","following_url":"https://api.github.com/users/yurmix/following{/other_user}","gists_url":"https://api.github.com/users/yurmix/gists{/gist_id}","starred_url":"https://api.github.com/users/yurmix/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yurmix/subscriptions","organizations_url":"https://api.github.com/users/yurmix/orgs","repos_url":"https://api.github.com/users/yurmix/repos","events_url":"https://api.github.com/users/yurmix/events{/privacy}","received_events_url":"https://api.github.com/users/yurmix/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-20T22:43:38Z","updated_at":"2018-12-20T22:43:38Z","author_association":"CONTRIBUTOR","body":"Thanks @b-slim, sorry for the very late response, here are my answers:\r\n\r\n> When collecting the results of the inner query to compute the moving AVG, is it done in a streaming fashion or you are materializing/buffering the entire result set to run the bucket based trailing aggregate?\r\n\r\nThe query uses `Sequence` all the way, but effectively I've seen that all groupBy iteration finishes before movingAverage iteration starts.\r\nPlease see [`MovingAverageQueryRunner@run()`](https://github.com/apache/incubator-druid/pull/6430/files#diff-41837c2a60693bdeee35530e5dcfc6d5R91).\r\n\r\n> In your example i see `\"type\": \"longMean\"` and the result is a floating point number, that seems odd to me.\r\n\r\n`longMean` consumes `Long` Aggregator but returns `Double`. I can see how this is confusing and I'll look into changing that.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/449159637/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/449161171","html_url":"https://github.com/apache/druid/issues/6320#issuecomment-449161171","issue_url":"https://api.github.com/repos/apache/druid/issues/6320","id":449161171,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0OTE2MTE3MQ==","user":{"login":"yurmix","id":1529282,"node_id":"MDQ6VXNlcjE1MjkyODI=","avatar_url":"https://avatars.githubusercontent.com/u/1529282?v=4","gravatar_id":"","url":"https://api.github.com/users/yurmix","html_url":"https://github.com/yurmix","followers_url":"https://api.github.com/users/yurmix/followers","following_url":"https://api.github.com/users/yurmix/following{/other_user}","gists_url":"https://api.github.com/users/yurmix/gists{/gist_id}","starred_url":"https://api.github.com/users/yurmix/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yurmix/subscriptions","organizations_url":"https://api.github.com/users/yurmix/orgs","repos_url":"https://api.github.com/users/yurmix/repos","events_url":"https://api.github.com/users/yurmix/events{/privacy}","received_events_url":"https://api.github.com/users/yurmix/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-20T22:50:48Z","updated_at":"2018-12-20T22:50:48Z","author_association":"CONTRIBUTOR","body":"@b-slim :\r\n\r\n> In your example i see that the first data point has <...> not sure what am missing here but isn't for the first data point `delta30Min` should be equal to `trailing30MinChanges`\r\n\r\nThe formula for the `longMean` averager is roughtly `sum(range(n))/n`, where `n` is the number of buckets. \r\nHere's the computation for the first record:\r\n`trailing30MinChange = sum(delta30Min[i-6..i0])/7 = sum(delta30Min[i0..i0])/7 = sum(delta30Min[i0])/7 = 30490/7 = 4355.714285714285`.\r\n\r\nThere are two happening regarding to `intervals` which I should clarify:\r\n\r\n* movingAverage takes the `intervals` defined by the user and expands with an offset it when running groupBy query. This allows the averager to iterate over all N buckets contributing to a record, even for periods not part of the original `intervals`. The additional time range will not be displayed but its data will contribute to the aggregator result. This is done [here](https://github.com/apache/incubator-druid/pull/6430/files#diff-41837c2a60693bdeee35530e5dcfc6d5R109)).\r\n\r\n* When querying the datasource's \"beginning of time\", there will be a noticable drop of value for the first few rows, as you noticed in your comment. This is because the prior buckets for these records are empty.\r\n\r\nTo clarify, here's an example of a datasource and a result:\r\n\r\nDatasource:\r\n\r\ndate       | metric\r\n-----------|-------\r\n12/23/2017 | 3     \r\n12/24/2017 | 3     \r\n12/25/2017 | 3     \r\n12/26/2017 | 3     \r\n12/27/2017 | 3     \r\n12/28/2017 | 3     \r\n12/29/2017 | 3     \r\n12/30/2017 | 3     \r\n12/31/2017 | 3     \r\n01/01/2018 | 9     \r\n01/02/2018 | 9     \r\n01/03/2018 | 9     \r\n01/04/2018 | 9     \r\n01/05/2018 | 9     \r\n01/06/2018 | 9     \r\n01/07/2018 | 9     \r\n01/08/2018 | 9     \r\n01/09/2018 | 9     \r\n\r\nQuery #1 - Last 7 days averager, Interval Jan-2018:\r\n`{\"queryType\": \"movingAverage\", \"granularity\" :{\"period\":\"P1D\"}, \"intervals\": [\"2018-01-01/2018-01-09\"], \"averagers\": {\"buckets\":7}}`\r\n(I skipped a few parameters here).\r\n\r\nResult #1:\r\n\r\ndate       | metric | averager \r\n-----------|--------|----------\r\n01/01/2018 | 9      | 3.9      \r\n01/02/2018 | 9      | 4.7      \r\n01/03/2018 | 9      | 5.6      \r\n01/04/2018 | 9      | 6.4      \r\n01/05/2018 | 9      | 7.3      \r\n01/06/2018 | 9      | 8.1      \r\n01/07/2018 | 9      | 9.0      \r\n01/08/2018 | 9      | 9.0      \r\n01/09/2018 | 9      | 9.0      \r\n\r\nQuery #2 - Last 7 days averager, All time:\r\n`{\"queryType\": \"movingAverage\", \"granularity\" :{\"period\":\"P1D\"}, \"intervals\": [\"2017-01-23/2018-01-09\"], \"averagers\": {\"buckets\":7}}`\r\n\r\nResult #2:\r\n\r\ndate       | metric | averager \r\n-----------|--------|----------\r\n12/23/2017 | 3      | 0.4      \r\n12/24/2017 | 3      | 0.9      \r\n12/25/2017 | 3      | 1.3      \r\n12/26/2017 | 3      | 1.7      \r\n12/27/2017 | 3      | 2.1      \r\n12/28/2017 | 3      | 2.6      \r\n12/29/2017 | 3      | 3.0      \r\n12/30/2017 | 3      | 3.0      \r\n12/31/2017 | 3      | 3.0      \r\n01/01/2018 | 9      | 3.9      \r\n01/02/2018 | 9      | 4.7      \r\n01/03/2018 | 9      | 5.6      \r\n01/04/2018 | 9      | 6.4      \r\n01/05/2018 | 9      | 7.3      \r\n01/06/2018 | 9      | 8.1      \r\n01/07/2018 | 9      | 9.0      \r\n01/08/2018 | 9      | 9.0      \r\n01/09/2018 | 9      | 9.0      \r\n","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/449161171/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/449163639","html_url":"https://github.com/apache/druid/issues/6320#issuecomment-449163639","issue_url":"https://api.github.com/repos/apache/druid/issues/6320","id":449163639,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0OTE2MzYzOQ==","user":{"login":"yurmix","id":1529282,"node_id":"MDQ6VXNlcjE1MjkyODI=","avatar_url":"https://avatars.githubusercontent.com/u/1529282?v=4","gravatar_id":"","url":"https://api.github.com/users/yurmix","html_url":"https://github.com/yurmix","followers_url":"https://api.github.com/users/yurmix/followers","following_url":"https://api.github.com/users/yurmix/following{/other_user}","gists_url":"https://api.github.com/users/yurmix/gists{/gist_id}","starred_url":"https://api.github.com/users/yurmix/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yurmix/subscriptions","organizations_url":"https://api.github.com/users/yurmix/orgs","repos_url":"https://api.github.com/users/yurmix/repos","events_url":"https://api.github.com/users/yurmix/events{/privacy}","received_events_url":"https://api.github.com/users/yurmix/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-20T23:02:11Z","updated_at":"2018-12-20T23:02:11Z","author_association":"CONTRIBUTOR","body":"@b-slim \r\n\r\n> In general Druid users use a column called count in conjunction with the XXXSum column to derive AVG when Rolling up of rows occurs, does your feature take that into consideration?\r\n\r\nI'm not sure if I understand correctly, I'll try to answer though.\r\nWith Aggregators and Post-Aggregators, one could count and sum values using two aggregators, then combine them in a post aggregator to get the average. (Not a moving average but a simple arithmetic average).\r\n\r\nAverager calculation is done completly separately from Aggregators code (although aggregator is an input to the averager computation). An example for an Averager calculation: [`DoubleMeanAverager@computeResult()`](https://github.com/apache/incubator-druid/pull/6430/files#diff-08f4829cb1dcb4ea5ebee703daa17189R32).\r\n","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/449163639/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/449164455","html_url":"https://github.com/apache/druid/pull/6670#issuecomment-449164455","issue_url":"https://api.github.com/repos/apache/druid/issues/6670","id":449164455,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0OTE2NDQ1NQ==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-20T23:04:35Z","updated_at":"2018-12-20T23:04:35Z","author_association":"CONTRIBUTOR","body":"Hey @niketh are you able to add a test to this? Thanks!!","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/449164455/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/449168269","html_url":"https://github.com/apache/druid/pull/5541#issuecomment-449168269","issue_url":"https://api.github.com/repos/apache/druid/issues/5541","id":449168269,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0OTE2ODI2OQ==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-20T23:14:53Z","updated_at":"2018-12-20T23:14:53Z","author_association":"CONTRIBUTOR","body":"Hey @Sarvesh1990, do you think you'll have an opportunity to pick this up in the future?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/449168269/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/449169266","html_url":"https://github.com/apache/druid/pull/6689#issuecomment-449169266","issue_url":"https://api.github.com/repos/apache/druid/issues/6689","id":449169266,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0OTE2OTI2Ng==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-20T23:17:42Z","updated_at":"2018-12-20T23:17:42Z","author_association":"CONTRIBUTOR","body":"Hey @pzhdfy, any chance you could add a test to this so we can commit it? Thanks!!","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/449169266/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/449170083","html_url":"https://github.com/apache/druid/pull/6676#issuecomment-449170083","issue_url":"https://api.github.com/repos/apache/druid/issues/6676","id":449170083,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0OTE3MDA4Mw==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-20T23:20:00Z","updated_at":"2018-12-20T23:20:00Z","author_association":"CONTRIBUTOR","body":"Hey @QiuMM - do you think you'll have a chance to come back to this one? Thanks!!","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/449170083/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/449172248","html_url":"https://github.com/apache/druid/pull/6683#issuecomment-449172248","issue_url":"https://api.github.com/repos/apache/druid/issues/6683","id":449172248,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0OTE3MjI0OA==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-20T23:26:24Z","updated_at":"2018-12-20T23:26:24Z","author_association":"CONTRIBUTOR","body":"From #6647,\r\n\r\n> If there are 10000 realtime tasks(not single realtime job, but like 50 jobs), then each task will create 2 * 10000 watches, finally we will get 200M watches!!\r\n\r\nThis seems strange & unnecessary, do you know why the tasks are creating watches for each other? They shouldn't be watching each other, I think, since they don't have a good reason to. Only the coordinators and brokers should be watching tasks, since they're the only ones that care about them (for lookups & segment discovery purposes).\r\n\r\nDoes Announcer set up too many watches, for some reason?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/449172248/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/449176091","html_url":"https://github.com/apache/druid/pull/6740#issuecomment-449176091","issue_url":"https://api.github.com/repos/apache/druid/issues/6740","id":449176091,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0OTE3NjA5MQ==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-20T23:36:50Z","updated_at":"2018-12-20T23:36:50Z","author_association":"CONTRIBUTOR","body":"I haven't read the patch, but just wanted to say that I am generally supportive of the idea of servers nuking themselves if really bad, and possibly unrecoverable, things happen. Like OOMEs and ZK connection loss.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/449176091/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/449177136","html_url":"https://github.com/apache/druid/pull/6748#issuecomment-449177136","issue_url":"https://api.github.com/repos/apache/druid/issues/6748","id":449177136,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0OTE3NzEzNg==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-20T23:40:03Z","updated_at":"2018-12-20T23:40:03Z","author_association":"CONTRIBUTOR","body":"Thanks for the contribution!","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/449177136/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/449201861","html_url":"https://github.com/apache/druid/pull/6431#issuecomment-449201861","issue_url":"https://api.github.com/repos/apache/druid/issues/6431","id":449201861,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0OTIwMTg2MQ==","user":{"login":"dclim","id":11050882,"node_id":"MDQ6VXNlcjExMDUwODgy","avatar_url":"https://avatars.githubusercontent.com/u/11050882?v=4","gravatar_id":"","url":"https://api.github.com/users/dclim","html_url":"https://github.com/dclim","followers_url":"https://api.github.com/users/dclim/followers","following_url":"https://api.github.com/users/dclim/following{/other_user}","gists_url":"https://api.github.com/users/dclim/gists{/gist_id}","starred_url":"https://api.github.com/users/dclim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dclim/subscriptions","organizations_url":"https://api.github.com/users/dclim/orgs","repos_url":"https://api.github.com/users/dclim/repos","events_url":"https://api.github.com/users/dclim/events{/privacy}","received_events_url":"https://api.github.com/users/dclim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-21T01:21:51Z","updated_at":"2018-12-21T01:21:51Z","author_association":"CONTRIBUTOR","body":"LGTM, thank you @jsun98!","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/449201861/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/449242555","html_url":"https://github.com/apache/druid/pull/6676#issuecomment-449242555","issue_url":"https://api.github.com/repos/apache/druid/issues/6676","id":449242555,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0OTI0MjU1NQ==","user":{"login":"QiuMM","id":15156517,"node_id":"MDQ6VXNlcjE1MTU2NTE3","avatar_url":"https://avatars.githubusercontent.com/u/15156517?v=4","gravatar_id":"","url":"https://api.github.com/users/QiuMM","html_url":"https://github.com/QiuMM","followers_url":"https://api.github.com/users/QiuMM/followers","following_url":"https://api.github.com/users/QiuMM/following{/other_user}","gists_url":"https://api.github.com/users/QiuMM/gists{/gist_id}","starred_url":"https://api.github.com/users/QiuMM/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/QiuMM/subscriptions","organizations_url":"https://api.github.com/users/QiuMM/orgs","repos_url":"https://api.github.com/users/QiuMM/repos","events_url":"https://api.github.com/users/QiuMM/events{/privacy}","received_events_url":"https://api.github.com/users/QiuMM/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-21T04:21:08Z","updated_at":"2018-12-21T04:21:08Z","author_association":"MEMBER","body":"@gianm @jihoonson sorry for the late because I'm busy with my work, I'll update this pr on this weekend.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/449242555/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/449295061","html_url":"https://github.com/apache/druid/issues/6442#issuecomment-449295061","issue_url":"https://api.github.com/repos/apache/druid/issues/6442","id":449295061,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0OTI5NTA2MQ==","user":{"login":"dragonls","id":2565118,"node_id":"MDQ6VXNlcjI1NjUxMTg=","avatar_url":"https://avatars.githubusercontent.com/u/2565118?v=4","gravatar_id":"","url":"https://api.github.com/users/dragonls","html_url":"https://github.com/dragonls","followers_url":"https://api.github.com/users/dragonls/followers","following_url":"https://api.github.com/users/dragonls/following{/other_user}","gists_url":"https://api.github.com/users/dragonls/gists{/gist_id}","starred_url":"https://api.github.com/users/dragonls/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dragonls/subscriptions","organizations_url":"https://api.github.com/users/dragonls/orgs","repos_url":"https://api.github.com/users/dragonls/repos","events_url":"https://api.github.com/users/dragonls/events{/privacy}","received_events_url":"https://api.github.com/users/dragonls/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-21T07:48:34Z","updated_at":"2018-12-21T07:48:34Z","author_association":"CONTRIBUTOR","body":"It seems that the released file is a little strange.\r\n\r\nI downloaded the file from:\r\nhttp://mirrors.hust.edu.cn/apache/incubator/druid/0.13.0-incubating/apache-druid-0.13.0-incubating-bin.tar.gz\r\nhttp://mirrors.hust.edu.cn/apache/incubator/druid/0.13.0-incubating/apache-druid-0.13.0-incubating-bin.tar.gz\r\nSHA1: e923fa8d2f4c79b28218a401f11aa2d379f46c59\r\n\r\nBut the file seems abnormal:\r\n![image](https://user-images.githubusercontent.com/2565118/50330793-85f0c600-0537-11e9-9f2b-9ec9c6dd2400.png)\r\n![image](https://user-images.githubusercontent.com/2565118/50330804-9012c480-0537-11e9-8a0d-ccdc847bb252.png)\r\n\r\nThere are some files having the incomplete file names. Is that something wrong during the distribution?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/449295061/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/449304373","html_url":"https://github.com/apache/druid/issues/6442#issuecomment-449304373","issue_url":"https://api.github.com/repos/apache/druid/issues/6442","id":449304373,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0OTMwNDM3Mw==","user":{"login":"pantaoran","id":7800702,"node_id":"MDQ6VXNlcjc4MDA3MDI=","avatar_url":"https://avatars.githubusercontent.com/u/7800702?v=4","gravatar_id":"","url":"https://api.github.com/users/pantaoran","html_url":"https://github.com/pantaoran","followers_url":"https://api.github.com/users/pantaoran/followers","following_url":"https://api.github.com/users/pantaoran/following{/other_user}","gists_url":"https://api.github.com/users/pantaoran/gists{/gist_id}","starred_url":"https://api.github.com/users/pantaoran/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pantaoran/subscriptions","organizations_url":"https://api.github.com/users/pantaoran/orgs","repos_url":"https://api.github.com/users/pantaoran/repos","events_url":"https://api.github.com/users/pantaoran/events{/privacy}","received_events_url":"https://api.github.com/users/pantaoran/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-21T08:15:48Z","updated_at":"2018-12-21T08:15:48Z","author_association":"NONE","body":"@dragonls I downloaded the file from 2 different mirrors, the SHA1 sum is the same as yours.\r\nWhen I extract it, everything seems fine. Did something go wrong during your decompression?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/449304373/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/449312902","html_url":"https://github.com/apache/druid/issues/6442#issuecomment-449312902","issue_url":"https://api.github.com/repos/apache/druid/issues/6442","id":449312902,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0OTMxMjkwMg==","user":{"login":"dragonls","id":2565118,"node_id":"MDQ6VXNlcjI1NjUxMTg=","avatar_url":"https://avatars.githubusercontent.com/u/2565118?v=4","gravatar_id":"","url":"https://api.github.com/users/dragonls","html_url":"https://github.com/dragonls","followers_url":"https://api.github.com/users/dragonls/followers","following_url":"https://api.github.com/users/dragonls/following{/other_user}","gists_url":"https://api.github.com/users/dragonls/gists{/gist_id}","starred_url":"https://api.github.com/users/dragonls/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dragonls/subscriptions","organizations_url":"https://api.github.com/users/dragonls/orgs","repos_url":"https://api.github.com/users/dragonls/repos","events_url":"https://api.github.com/users/dragonls/events{/privacy}","received_events_url":"https://api.github.com/users/dragonls/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-21T08:41:44Z","updated_at":"2018-12-21T08:48:07Z","author_association":"CONTRIBUTOR","body":"Emmm, interesting...\r\nMaybe there is something wrong during my decompression. Anyway, @pantaoran thanks a lot.\r\n\r\nI tried `tar -zxvf xxx.tar.gz`, all results are ok. Maybe that is a bug in 7zip.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/449312902/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/449342360","html_url":"https://github.com/apache/druid/pull/6689#issuecomment-449342360","issue_url":"https://api.github.com/repos/apache/druid/issues/6689","id":449342360,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0OTM0MjM2MA==","user":{"login":"pzhdfy","id":2594619,"node_id":"MDQ6VXNlcjI1OTQ2MTk=","avatar_url":"https://avatars.githubusercontent.com/u/2594619?v=4","gravatar_id":"","url":"https://api.github.com/users/pzhdfy","html_url":"https://github.com/pzhdfy","followers_url":"https://api.github.com/users/pzhdfy/followers","following_url":"https://api.github.com/users/pzhdfy/following{/other_user}","gists_url":"https://api.github.com/users/pzhdfy/gists{/gist_id}","starred_url":"https://api.github.com/users/pzhdfy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pzhdfy/subscriptions","organizations_url":"https://api.github.com/users/pzhdfy/orgs","repos_url":"https://api.github.com/users/pzhdfy/repos","events_url":"https://api.github.com/users/pzhdfy/events{/privacy}","received_events_url":"https://api.github.com/users/pzhdfy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-21T10:05:04Z","updated_at":"2018-12-21T10:05:04Z","author_association":"CONTRIBUTOR","body":"> Hey @pzhdfy, any chance you could add a test to this so we can commit it? Thanks!!\r\n\r\nhi @gianm  ,I have add the unit test","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/449342360/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/449470109","html_url":"https://github.com/apache/druid/issues/6718#issuecomment-449470109","issue_url":"https://api.github.com/repos/apache/druid/issues/6718","id":449470109,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0OTQ3MDEwOQ==","user":{"login":"ciukstar","id":8271154,"node_id":"MDQ6VXNlcjgyNzExNTQ=","avatar_url":"https://avatars.githubusercontent.com/u/8271154?v=4","gravatar_id":"","url":"https://api.github.com/users/ciukstar","html_url":"https://github.com/ciukstar","followers_url":"https://api.github.com/users/ciukstar/followers","following_url":"https://api.github.com/users/ciukstar/following{/other_user}","gists_url":"https://api.github.com/users/ciukstar/gists{/gist_id}","starred_url":"https://api.github.com/users/ciukstar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ciukstar/subscriptions","organizations_url":"https://api.github.com/users/ciukstar/orgs","repos_url":"https://api.github.com/users/ciukstar/repos","events_url":"https://api.github.com/users/ciukstar/events{/privacy}","received_events_url":"https://api.github.com/users/ciukstar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-21T18:55:56Z","updated_at":"2018-12-21T18:55:56Z","author_association":"NONE","body":"Hi, @jon-wei! \r\nI want to ask if [this is the PR #6761](https://github.com/apache/incubator-druid/pull/6761) that fixes issue #6718 (this issue)?\r\n\r\nThanks!","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/449470109/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/449479630","html_url":"https://github.com/apache/druid/pull/6431#issuecomment-449479630","issue_url":"https://api.github.com/repos/apache/druid/issues/6431","id":449479630,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0OTQ3OTYzMA==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-21T19:36:40Z","updated_at":"2018-12-21T19:36:40Z","author_association":"CONTRIBUTOR","body":"It looks to me like this patch is ready to go. @b-slim are you ok with merging this now and doing some of the followups you suggested (like API changes) in #6496?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/449479630/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/449480787","html_url":"https://github.com/apache/druid/pull/6431#issuecomment-449480787","issue_url":"https://api.github.com/repos/apache/druid/issues/6431","id":449480787,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0OTQ4MDc4Nw==","user":{"login":"b-slim","id":7376396,"node_id":"MDQ6VXNlcjczNzYzOTY=","avatar_url":"https://avatars.githubusercontent.com/u/7376396?v=4","gravatar_id":"","url":"https://api.github.com/users/b-slim","html_url":"https://github.com/b-slim","followers_url":"https://api.github.com/users/b-slim/followers","following_url":"https://api.github.com/users/b-slim/following{/other_user}","gists_url":"https://api.github.com/users/b-slim/gists{/gist_id}","starred_url":"https://api.github.com/users/b-slim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/b-slim/subscriptions","organizations_url":"https://api.github.com/users/b-slim/orgs","repos_url":"https://api.github.com/users/b-slim/repos","events_url":"https://api.github.com/users/b-slim/events{/privacy}","received_events_url":"https://api.github.com/users/b-slim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-21T19:41:51Z","updated_at":"2018-12-21T19:41:51Z","author_association":"CONTRIBUTOR","body":"I don't think i can get to re-review the entire thing before next year, so if there is enough consensus that this is good to go, then good it is.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/449480787/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/449484462","html_url":"https://github.com/apache/druid/pull/6370#issuecomment-449484462","issue_url":"https://api.github.com/repos/apache/druid/issues/6370","id":449484462,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0OTQ4NDQ2Mg==","user":{"login":"jihoonson","id":2322288,"node_id":"MDQ6VXNlcjIzMjIyODg=","avatar_url":"https://avatars.githubusercontent.com/u/2322288?v=4","gravatar_id":"","url":"https://api.github.com/users/jihoonson","html_url":"https://github.com/jihoonson","followers_url":"https://api.github.com/users/jihoonson/followers","following_url":"https://api.github.com/users/jihoonson/following{/other_user}","gists_url":"https://api.github.com/users/jihoonson/gists{/gist_id}","starred_url":"https://api.github.com/users/jihoonson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jihoonson/subscriptions","organizations_url":"https://api.github.com/users/jihoonson/orgs","repos_url":"https://api.github.com/users/jihoonson/repos","events_url":"https://api.github.com/users/jihoonson/events{/privacy}","received_events_url":"https://api.github.com/users/jihoonson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-21T19:57:56Z","updated_at":"2018-12-21T19:57:56Z","author_association":"CONTRIBUTOR","body":"I think at least we should rename `SegmentIdentifier` to something else since it's confusing. I don't think the rename should be done in this PR. What do you think?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/449484462/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/449490568","html_url":"https://github.com/apache/druid/issues/6743#issuecomment-449490568","issue_url":"https://api.github.com/repos/apache/druid/issues/6743","id":449490568,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0OTQ5MDU2OA==","user":{"login":"leerho","id":12941506,"node_id":"MDQ6VXNlcjEyOTQxNTA2","avatar_url":"https://avatars.githubusercontent.com/u/12941506?v=4","gravatar_id":"","url":"https://api.github.com/users/leerho","html_url":"https://github.com/leerho","followers_url":"https://api.github.com/users/leerho/followers","following_url":"https://api.github.com/users/leerho/following{/other_user}","gists_url":"https://api.github.com/users/leerho/gists{/gist_id}","starred_url":"https://api.github.com/users/leerho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leerho/subscriptions","organizations_url":"https://api.github.com/users/leerho/orgs","repos_url":"https://api.github.com/users/leerho/repos","events_url":"https://api.github.com/users/leerho/events{/privacy}","received_events_url":"https://api.github.com/users/leerho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-21T20:28:11Z","updated_at":"2018-12-21T20:33:38Z","author_association":"CONTRIBUTOR","body":"@gianm \r\n\r\n> The granddaddy of Druid sketches, hyperUnique, doesn't have a very high max memory footprint, so it was less of an issue back then.\r\n\r\nI think you are referring to the [HyperLogLog (HLL) sketch implementation](https://github.com/apache/incubator-druid/blob/master/hll/src/main/java/org/apache/druid/hll/HyperLogLogCollector.java) that was developed for Druid some years ago.   There are several things you need to understand about that implementation.\r\n- The implementation is flawed and has been from the beginning.  It can produce erroneous results that can be 7 times worse than what it should be had it been implemented correctly.  These errors show up during merge operations and is documented in [characterization studies](https://datasketches.github.io/docs/HLL/HllSketchVsDruidHyperLogLogCollector.html) we performed this past year.  I strongly advise that this Druid HLL sketch be deprecated and removed from Druid.  The unsuspecting user will have no warning whatsoever when this sketch is producing incorrect results. \r\n- The HLL implementation in the DataSketches library is not only much more accurate, but it is faster as well and is approximately the same size.  We can work with you to create a PR that would possibly redirect references to the old Druid HLL sketch to our implementation that fixes these problems.\r\n- HLL sketches are small in size because of the nature of the underlying HLL algorithm.  If users were to choose the DataSketches HLL implementation it also would be small in size.  However, the HLL algorithm is not designed to allow Intersections.  If the use-case for counting uniques only requires merging and does not require Intersection operations then the HLL algorithm is a reasonable choice (although there is now an algorithm that is superior to HLL in terms of accuracy per space, and we can provide that as an option to your users as well.)  The Theta Sketch from the DS library is a larger sketch (and the one that I was modeling earlier in this thread), but it is designed from the outset to enable set Intersection and set difference operations.  Because set expressions are so powerful from an analysis point-of-view, many users choose the Theta Sketch in spite of its larger size.  This has also been our experience at Yahoo.\r\n***\r\nI'm not sure I follow your proposal and may be missing something. Nonetheless, one of the challenges of just carving out a chunk of the processing buffer to be managed by by the individual BufferAggregators is that in order truly gain back the \"unused memory\" would require memory management sophistication similar to the design of a malloc(), free() and a garbage collector, which is non-trivial.  Imagine each sketch with an internal hash-table. As individual sketches grow they need to obtain a larger chunk of memory for a bigger hash-table, move their data into the larger chunk and free the previous chunk.  If those freed chunks don't get reused, then we will not achieve the optimum memory savings.  Allowing the sketches to allocate and free memory directly from the operating system allows us to leverage the already existing and very sophisticated malloc() and free() of the underlying C-libraries and the OS itself.  \r\n\r\nBTW, there is already a mechanism in the JVM to track usage of off-heap memory used by DirectByteBuffers.  We use this same mechanism to track allocations we make against off-heap memory even though we don't use DirectByteBuffers.  So the JVM knows and tracks this usage already.  Druid could also monitor these same JVM counters if it wanted or needed to. ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/449490568/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/449506713","html_url":"https://github.com/apache/druid/issues/6718#issuecomment-449506713","issue_url":"https://api.github.com/repos/apache/druid/issues/6718","id":449506713,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0OTUwNjcxMw==","user":{"login":"jon-wei","id":8729063,"node_id":"MDQ6VXNlcjg3MjkwNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8729063?v=4","gravatar_id":"","url":"https://api.github.com/users/jon-wei","html_url":"https://github.com/jon-wei","followers_url":"https://api.github.com/users/jon-wei/followers","following_url":"https://api.github.com/users/jon-wei/following{/other_user}","gists_url":"https://api.github.com/users/jon-wei/gists{/gist_id}","starred_url":"https://api.github.com/users/jon-wei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jon-wei/subscriptions","organizations_url":"https://api.github.com/users/jon-wei/orgs","repos_url":"https://api.github.com/users/jon-wei/repos","events_url":"https://api.github.com/users/jon-wei/events{/privacy}","received_events_url":"https://api.github.com/users/jon-wei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-21T21:49:05Z","updated_at":"2018-12-21T21:49:05Z","author_association":"CONTRIBUTOR","body":"Hi @ciukstar,\r\n\r\nPR #6761 will fix the specific Kafka Indexing Service problem described in this issue, but you'll hit other ingestion errors if you're using S3/HDFS deep storage with Cyrillic/spaced names (I am currently working a patch to fix those issues as well)","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/449506713/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/449508912","html_url":"https://github.com/apache/druid/issues/6320#issuecomment-449508912","issue_url":"https://api.github.com/repos/apache/druid/issues/6320","id":449508912,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0OTUwODkxMg==","user":{"login":"yurmix","id":1529282,"node_id":"MDQ6VXNlcjE1MjkyODI=","avatar_url":"https://avatars.githubusercontent.com/u/1529282?v=4","gravatar_id":"","url":"https://api.github.com/users/yurmix","html_url":"https://github.com/yurmix","followers_url":"https://api.github.com/users/yurmix/followers","following_url":"https://api.github.com/users/yurmix/following{/other_user}","gists_url":"https://api.github.com/users/yurmix/gists{/gist_id}","starred_url":"https://api.github.com/users/yurmix/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yurmix/subscriptions","organizations_url":"https://api.github.com/users/yurmix/orgs","repos_url":"https://api.github.com/users/yurmix/repos","events_url":"https://api.github.com/users/yurmix/events{/privacy}","received_events_url":"https://api.github.com/users/yurmix/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-21T22:00:32Z","updated_at":"2018-12-21T22:00:32Z","author_association":"CONTRIBUTOR","body":"Also worth noting is the written documentation: \r\nhttps://github.com/apache/incubator-druid/blob/1d9884792cb162433fc2d3b9c6728e132d9b5853/docs/content/development/extensions-contrib/moving-average-query.md","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/449508912/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/449662105","html_url":"https://github.com/apache/druid/issues/5543#issuecomment-449662105","issue_url":"https://api.github.com/repos/apache/druid/issues/5543","id":449662105,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0OTY2MjEwNQ==","user":{"login":"csimplestring","id":5042273,"node_id":"MDQ6VXNlcjUwNDIyNzM=","avatar_url":"https://avatars.githubusercontent.com/u/5042273?v=4","gravatar_id":"","url":"https://api.github.com/users/csimplestring","html_url":"https://github.com/csimplestring","followers_url":"https://api.github.com/users/csimplestring/followers","following_url":"https://api.github.com/users/csimplestring/following{/other_user}","gists_url":"https://api.github.com/users/csimplestring/gists{/gist_id}","starred_url":"https://api.github.com/users/csimplestring/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/csimplestring/subscriptions","organizations_url":"https://api.github.com/users/csimplestring/orgs","repos_url":"https://api.github.com/users/csimplestring/repos","events_url":"https://api.github.com/users/csimplestring/events{/privacy}","received_events_url":"https://api.github.com/users/csimplestring/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-23T20:42:20Z","updated_at":"2018-12-23T20:42:45Z","author_association":"NONE","body":"Hi, does IngestSegmentFirehose work for the native parallel batch indexing?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/449662105/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/449754900","html_url":"https://github.com/apache/druid/pull/6683#issuecomment-449754900","issue_url":"https://api.github.com/repos/apache/druid/issues/6683","id":449754900,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0OTc1NDkwMA==","user":{"login":"kaijianding","id":8663725,"node_id":"MDQ6VXNlcjg2NjM3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/8663725?v=4","gravatar_id":"","url":"https://api.github.com/users/kaijianding","html_url":"https://github.com/kaijianding","followers_url":"https://api.github.com/users/kaijianding/followers","following_url":"https://api.github.com/users/kaijianding/following{/other_user}","gists_url":"https://api.github.com/users/kaijianding/gists{/gist_id}","starred_url":"https://api.github.com/users/kaijianding/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaijianding/subscriptions","organizations_url":"https://api.github.com/users/kaijianding/orgs","repos_url":"https://api.github.com/users/kaijianding/repos","events_url":"https://api.github.com/users/kaijianding/events{/privacy}","received_events_url":"https://api.github.com/users/kaijianding/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-12-24T16:58:06Z","updated_at":"2018-12-24T16:58:06Z","author_association":"CONTRIBUTOR","body":"@gianm I'm not familiar with curator code, but it seems because we watch the parent path to get child events, curator adds watch for each child path","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/449754900/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]