[{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1115224063","html_url":"https://github.com/apache/hudi/issues/3954#issuecomment-1115224063","issue_url":"https://api.github.com/repos/apache/hudi/issues/3954","id":1115224063,"node_id":"IC_kwDOBI7nWM5CePf_","user":{"login":"jasondavindev","id":33331415,"node_id":"MDQ6VXNlcjMzMzMxNDE1","avatar_url":"https://avatars.githubusercontent.com/u/33331415?v=4","gravatar_id":"","url":"https://api.github.com/users/jasondavindev","html_url":"https://github.com/jasondavindev","followers_url":"https://api.github.com/users/jasondavindev/followers","following_url":"https://api.github.com/users/jasondavindev/following{/other_user}","gists_url":"https://api.github.com/users/jasondavindev/gists{/gist_id}","starred_url":"https://api.github.com/users/jasondavindev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasondavindev/subscriptions","organizations_url":"https://api.github.com/users/jasondavindev/orgs","repos_url":"https://api.github.com/users/jasondavindev/repos","events_url":"https://api.github.com/users/jasondavindev/events{/privacy}","received_events_url":"https://api.github.com/users/jasondavindev/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-02T18:29:41Z","updated_at":"2022-05-02T18:29:41Z","author_association":"NONE","body":"@kazdy https://github.com/apache/hudi/issues/5484","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1115224063/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1115295390","html_url":"https://github.com/apache/hudi/pull/5423#issuecomment-1115295390","issue_url":"https://api.github.com/repos/apache/hudi/issues/5423","id":1115295390,"node_id":"IC_kwDOBI7nWM5Ceg6e","user":{"login":"alexeykudinkin","id":428277,"node_id":"MDQ6VXNlcjQyODI3Nw==","avatar_url":"https://avatars.githubusercontent.com/u/428277?v=4","gravatar_id":"","url":"https://api.github.com/users/alexeykudinkin","html_url":"https://github.com/alexeykudinkin","followers_url":"https://api.github.com/users/alexeykudinkin/followers","following_url":"https://api.github.com/users/alexeykudinkin/following{/other_user}","gists_url":"https://api.github.com/users/alexeykudinkin/gists{/gist_id}","starred_url":"https://api.github.com/users/alexeykudinkin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexeykudinkin/subscriptions","organizations_url":"https://api.github.com/users/alexeykudinkin/orgs","repos_url":"https://api.github.com/users/alexeykudinkin/repos","events_url":"https://api.github.com/users/alexeykudinkin/events{/privacy}","received_events_url":"https://api.github.com/users/alexeykudinkin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-02T19:49:14Z","updated_at":"2022-05-02T19:49:14Z","author_association":"CONTRIBUTOR","body":"@Baibaiwuguo can you please add more details in the PR and the Jira explaining the issues you're having right now, steps to reproduce? ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1115295390/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1115302883","html_url":"https://github.com/apache/hudi/issues/5451#issuecomment-1115302883","issue_url":"https://api.github.com/repos/apache/hudi/issues/5451","id":1115302883,"node_id":"IC_kwDOBI7nWM5Ceivj","user":{"login":"umehrot2","id":8647012,"node_id":"MDQ6VXNlcjg2NDcwMTI=","avatar_url":"https://avatars.githubusercontent.com/u/8647012?v=4","gravatar_id":"","url":"https://api.github.com/users/umehrot2","html_url":"https://github.com/umehrot2","followers_url":"https://api.github.com/users/umehrot2/followers","following_url":"https://api.github.com/users/umehrot2/following{/other_user}","gists_url":"https://api.github.com/users/umehrot2/gists{/gist_id}","starred_url":"https://api.github.com/users/umehrot2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/umehrot2/subscriptions","organizations_url":"https://api.github.com/users/umehrot2/orgs","repos_url":"https://api.github.com/users/umehrot2/repos","events_url":"https://api.github.com/users/umehrot2/events{/privacy}","received_events_url":"https://api.github.com/users/umehrot2/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-02T19:58:39Z","updated_at":"2022-05-02T19:58:39Z","author_association":"CONTRIBUTOR","body":"@jdattani I see how it can be a bit confusing. The `partition_key` here actually means the value to use for the column, and not the column name itself. The column name is fixed to be `key`.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1115302883/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1115303685","html_url":"https://github.com/apache/hudi/issues/5451#issuecomment-1115303685","issue_url":"https://api.github.com/repos/apache/hudi/issues/5451","id":1115303685,"node_id":"IC_kwDOBI7nWM5Cei8F","user":{"login":"umehrot2","id":8647012,"node_id":"MDQ6VXNlcjg2NDcwMTI=","avatar_url":"https://avatars.githubusercontent.com/u/8647012?v=4","gravatar_id":"","url":"https://api.github.com/users/umehrot2","html_url":"https://github.com/umehrot2","followers_url":"https://api.github.com/users/umehrot2/followers","following_url":"https://api.github.com/users/umehrot2/following{/other_user}","gists_url":"https://api.github.com/users/umehrot2/gists{/gist_id}","starred_url":"https://api.github.com/users/umehrot2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/umehrot2/subscriptions","organizations_url":"https://api.github.com/users/umehrot2/orgs","repos_url":"https://api.github.com/users/umehrot2/repos","events_url":"https://api.github.com/users/umehrot2/events{/privacy}","received_events_url":"https://api.github.com/users/umehrot2/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-02T19:59:37Z","updated_at":"2022-05-02T19:59:37Z","author_association":"CONTRIBUTOR","body":"Created a couple of Jiras to improve the naming/docs and to package the jars in a bundle so customers don't have to pass these AWS specific jars manually:\r\n\r\nhttps://issues.apache.org/jira/browse/HUDI-4011\r\nhttps://issues.apache.org/jira/browse/HUDI-4010","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1115303685/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1115332685","html_url":"https://github.com/apache/hudi/issues/5481#issuecomment-1115332685","issue_url":"https://api.github.com/repos/apache/hudi/issues/5481","id":1115332685,"node_id":"IC_kwDOBI7nWM5CeqBN","user":{"login":"yihua","id":2497195,"node_id":"MDQ6VXNlcjI0OTcxOTU=","avatar_url":"https://avatars.githubusercontent.com/u/2497195?v=4","gravatar_id":"","url":"https://api.github.com/users/yihua","html_url":"https://github.com/yihua","followers_url":"https://api.github.com/users/yihua/followers","following_url":"https://api.github.com/users/yihua/following{/other_user}","gists_url":"https://api.github.com/users/yihua/gists{/gist_id}","starred_url":"https://api.github.com/users/yihua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yihua/subscriptions","organizations_url":"https://api.github.com/users/yihua/orgs","repos_url":"https://api.github.com/users/yihua/repos","events_url":"https://api.github.com/users/yihua/events{/privacy}","received_events_url":"https://api.github.com/users/yihua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-02T20:27:20Z","updated_at":"2022-05-02T20:27:20Z","author_association":"CONTRIBUTOR","body":"@MikeBuh Thanks for providing the detailed configs and Spark UI screenshots.  Based on the information you provided, it looks like each Spark executor takes more input data than it can handle well in memory.  You may try to use the following Spark and Hudi configs and retry the real-time version of the job (assuming 7GB per upsert batch):\r\n```\r\nhoodie.upsert.shuffle.parallelism=70\r\nconf spark.sql.shuffle.partitions: 70\r\nconf spark.default.parallelism: 70\r\n```\r\nIf you still hit the memory bottleneck, you may increase both the driver and executor memory:\r\n```\r\ndriver-memory: 12g\r\nexecutor-memory: 8g\r\n```","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1115332685/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1115347064","html_url":"https://github.com/apache/hudi/issues/5482#issuecomment-1115347064","issue_url":"https://api.github.com/repos/apache/hudi/issues/5482","id":1115347064,"node_id":"IC_kwDOBI7nWM5Ceth4","user":{"login":"yihua","id":2497195,"node_id":"MDQ6VXNlcjI0OTcxOTU=","avatar_url":"https://avatars.githubusercontent.com/u/2497195?v=4","gravatar_id":"","url":"https://api.github.com/users/yihua","html_url":"https://github.com/yihua","followers_url":"https://api.github.com/users/yihua/followers","following_url":"https://api.github.com/users/yihua/following{/other_user}","gists_url":"https://api.github.com/users/yihua/gists{/gist_id}","starred_url":"https://api.github.com/users/yihua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yihua/subscriptions","organizations_url":"https://api.github.com/users/yihua/orgs","repos_url":"https://api.github.com/users/yihua/repos","events_url":"https://api.github.com/users/yihua/events{/privacy}","received_events_url":"https://api.github.com/users/yihua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-02T20:42:27Z","updated_at":"2022-05-02T20:42:27Z","author_association":"CONTRIBUTOR","body":"@parisni Could you also provide the steps, commands, and code that do the ingestion, e.g., Deltastreamer, Spark datasource or Spark SQL?\r\n\r\nAlso, do the timeouts prevent the ingestion from proceeding?  Could you also search the logs to see what requests are sent to `192.168.1.61:33361`?  These are timeline server requests, and they are retried automatically.\r\n\r\nGiven that the metadata table is enabled and async table services are enabled as well (`hoodie.clean.async=true`), the following configs need to be added.  The full guide is [here](https://hudi.apache.org/docs/metadata).\r\n```\r\nhoodie.write.concurrency.mode=optimistic_concurrency_control\r\nhoodie.cleaner.policy.failed.writes=LAZY\r\nhoodie.write.lock.provider=<lock provider name depending on deployment model>\r\n```","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1115347064/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1115351450","html_url":"https://github.com/apache/hudi/issues/5469#issuecomment-1115351450","issue_url":"https://api.github.com/repos/apache/hudi/issues/5469","id":1115351450,"node_id":"IC_kwDOBI7nWM5Ceuma","user":{"login":"yihua","id":2497195,"node_id":"MDQ6VXNlcjI0OTcxOTU=","avatar_url":"https://avatars.githubusercontent.com/u/2497195?v=4","gravatar_id":"","url":"https://api.github.com/users/yihua","html_url":"https://github.com/yihua","followers_url":"https://api.github.com/users/yihua/followers","following_url":"https://api.github.com/users/yihua/following{/other_user}","gists_url":"https://api.github.com/users/yihua/gists{/gist_id}","starred_url":"https://api.github.com/users/yihua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yihua/subscriptions","organizations_url":"https://api.github.com/users/yihua/orgs","repos_url":"https://api.github.com/users/yihua/repos","events_url":"https://api.github.com/users/yihua/events{/privacy}","received_events_url":"https://api.github.com/users/yihua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-02T20:47:55Z","updated_at":"2022-05-02T20:47:55Z","author_association":"CONTRIBUTOR","body":"@jasondavindev Thanks for confirming.  If this is solved by Hudi 0.11.0 release and there is no other ask for this issue, feel free to close it.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1115351450/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1115354373","html_url":"https://github.com/apache/hudi/issues/5484#issuecomment-1115354373","issue_url":"https://api.github.com/repos/apache/hudi/issues/5484","id":1115354373,"node_id":"IC_kwDOBI7nWM5CevUF","user":{"login":"yihua","id":2497195,"node_id":"MDQ6VXNlcjI0OTcxOTU=","avatar_url":"https://avatars.githubusercontent.com/u/2497195?v=4","gravatar_id":"","url":"https://api.github.com/users/yihua","html_url":"https://github.com/yihua","followers_url":"https://api.github.com/users/yihua/followers","following_url":"https://api.github.com/users/yihua/following{/other_user}","gists_url":"https://api.github.com/users/yihua/gists{/gist_id}","starred_url":"https://api.github.com/users/yihua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yihua/subscriptions","organizations_url":"https://api.github.com/users/yihua/orgs","repos_url":"https://api.github.com/users/yihua/repos","events_url":"https://api.github.com/users/yihua/events{/privacy}","received_events_url":"https://api.github.com/users/yihua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-02T20:50:59Z","updated_at":"2022-05-02T20:50:59Z","author_association":"CONTRIBUTOR","body":"@umehrot2 @rahil-c could you guys assist here around the AWS Glue catalog?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1115354373/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1115355171","html_url":"https://github.com/apache/hudi/issues/5484#issuecomment-1115355171","issue_url":"https://api.github.com/repos/apache/hudi/issues/5484","id":1115355171,"node_id":"IC_kwDOBI7nWM5Cevgj","user":{"login":"yihua","id":2497195,"node_id":"MDQ6VXNlcjI0OTcxOTU=","avatar_url":"https://avatars.githubusercontent.com/u/2497195?v=4","gravatar_id":"","url":"https://api.github.com/users/yihua","html_url":"https://github.com/yihua","followers_url":"https://api.github.com/users/yihua/followers","following_url":"https://api.github.com/users/yihua/following{/other_user}","gists_url":"https://api.github.com/users/yihua/gists{/gist_id}","starred_url":"https://api.github.com/users/yihua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yihua/subscriptions","organizations_url":"https://api.github.com/users/yihua/orgs","repos_url":"https://api.github.com/users/yihua/repos","events_url":"https://api.github.com/users/yihua/events{/privacy}","received_events_url":"https://api.github.com/users/yihua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-02T20:51:56Z","updated_at":"2022-05-02T20:51:56Z","author_association":"CONTRIBUTOR","body":"cc @nsivabalan","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1115355171/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1115361949","html_url":"https://github.com/apache/hudi/issues/5451#issuecomment-1115361949","issue_url":"https://api.github.com/repos/apache/hudi/issues/5451","id":1115361949,"node_id":"IC_kwDOBI7nWM5CexKd","user":{"login":"yihua","id":2497195,"node_id":"MDQ6VXNlcjI0OTcxOTU=","avatar_url":"https://avatars.githubusercontent.com/u/2497195?v=4","gravatar_id":"","url":"https://api.github.com/users/yihua","html_url":"https://github.com/yihua","followers_url":"https://api.github.com/users/yihua/followers","following_url":"https://api.github.com/users/yihua/following{/other_user}","gists_url":"https://api.github.com/users/yihua/gists{/gist_id}","starred_url":"https://api.github.com/users/yihua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yihua/subscriptions","organizations_url":"https://api.github.com/users/yihua/orgs","repos_url":"https://api.github.com/users/yihua/repos","events_url":"https://api.github.com/users/yihua/events{/privacy}","received_events_url":"https://api.github.com/users/yihua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-02T20:59:57Z","updated_at":"2022-05-02T20:59:57Z","author_association":"CONTRIBUTOR","body":"@jdattani Have you tried the suggestion and see if it works?  Feel free to close this issue once all good.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1115361949/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1115438721","html_url":"https://github.com/apache/hudi/issues/5484#issuecomment-1115438721","issue_url":"https://api.github.com/repos/apache/hudi/issues/5484","id":1115438721,"node_id":"IC_kwDOBI7nWM5CfD6B","user":{"login":"umehrot2","id":8647012,"node_id":"MDQ6VXNlcjg2NDcwMTI=","avatar_url":"https://avatars.githubusercontent.com/u/8647012?v=4","gravatar_id":"","url":"https://api.github.com/users/umehrot2","html_url":"https://github.com/umehrot2","followers_url":"https://api.github.com/users/umehrot2/followers","following_url":"https://api.github.com/users/umehrot2/following{/other_user}","gists_url":"https://api.github.com/users/umehrot2/gists{/gist_id}","starred_url":"https://api.github.com/users/umehrot2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/umehrot2/subscriptions","organizations_url":"https://api.github.com/users/umehrot2/orgs","repos_url":"https://api.github.com/users/umehrot2/repos","events_url":"https://api.github.com/users/umehrot2/events{/privacy}","received_events_url":"https://api.github.com/users/umehrot2/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-02T22:41:04Z","updated_at":"2022-05-02T22:41:04Z","author_association":"CONTRIBUTOR","body":"@jasondavindev I think the the glue catalog is not getting enabled. `spark.hadoop.hive.metastore.client.factory.class=com.amazonaws.glue.catalog.metastore.AWSGlueDataCatalogHiveClientFactory` is not kicking in. So either you are misconfiguring it somehow or its a bug in EMR on EKS https://catalog.us-east-1.prod.workshops.aws/workshops/1f91e1d4-5587-40ff-8d5d-54fc86e0ddc1/en-US/intermediate/aws-glue-metastore-integration.\r\n\r\nBased on the error it is trying to instantiate `SessionHiveMetaStoreClient` instead of glue's metastore client. And that is why it is expecting a running hive metastore server. If you are unable to resolve this, the best approach would be to create an AWS support ticket for EMR on EKS team.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1115438721/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1115491470","html_url":"https://github.com/apache/hudi/issues/5485#issuecomment-1115491470","issue_url":"https://api.github.com/repos/apache/hudi/issues/5485","id":1115491470,"node_id":"IC_kwDOBI7nWM5CfQyO","user":{"login":"yihua","id":2497195,"node_id":"MDQ6VXNlcjI0OTcxOTU=","avatar_url":"https://avatars.githubusercontent.com/u/2497195?v=4","gravatar_id":"","url":"https://api.github.com/users/yihua","html_url":"https://github.com/yihua","followers_url":"https://api.github.com/users/yihua/followers","following_url":"https://api.github.com/users/yihua/following{/other_user}","gists_url":"https://api.github.com/users/yihua/gists{/gist_id}","starred_url":"https://api.github.com/users/yihua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yihua/subscriptions","organizations_url":"https://api.github.com/users/yihua/orgs","repos_url":"https://api.github.com/users/yihua/repos","events_url":"https://api.github.com/users/yihua/events{/privacy}","received_events_url":"https://api.github.com/users/yihua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-03T00:20:30Z","updated_at":"2022-05-03T00:22:48Z","author_association":"CONTRIBUTOR","body":"@leobiscassi Thanks for providing the detailed steps.  There are three things:\r\n\r\n(1) When using Deltastreamer, the `s3a://` prefix should be used, to avoid `_$folder$` suffix.\r\n(2) Hudi 0.9.0-amzn-1 does not support `date`-typed partition field.  The support is only added recently #5432.  However, you can still using String-typed partition field.\r\n(3) the parquet files you generated do not have the `date` field in the schema, i.e., when each individual parquet file is directly read, the `date` field is not there.  `ParquetDFSSource` directly reads each parquet file and does not recover the partition path from the `sample-data` path.  That's why you see `1970-01-01` as the partition path since the `date` is not found and the default value is that.\r\n\r\nBelow is an example that can actually achieve what you need:\r\n\r\n```\r\nfrom pyspark.sql import SparkSession\r\nfrom datetime import date\r\ndata = [\r\n    {'date': date(2022, 1, 5),  'date2': '2022-01-05',  'ts': '2022-04-10T09:47:54+00:00', 'name': 'Fake Name 1', 'email': 'fakename1@email.com'},\r\n    {'date': date(2022, 1, 4),  'date2': '2022-01-04',  'ts': '2022-04-10T09:47:54+00:00', 'name': 'Fake Name 2', 'email': 'fakename2@email.com'},\r\n    {'date': date(2022, 1, 3),  'date2': '2022-01-03',  'ts': '2022-04-10T09:47:54+00:00', 'name': 'Fake Name 3', 'email': 'fakename3@email.com'},\r\n    {'date': date(2022, 2, 5),  'date2': '2022-02-05',  'ts': '2022-04-10T09:47:54+00:00', 'name': 'Fake Name 4', 'email': 'fakename4@email.com'},\r\n    {'date': date(2022, 3, 5),  'date2': '2022-03-05',  'ts': '2022-04-10T09:47:54+00:00', 'name': 'Fake Name 5', 'email': 'fakename5@email.com'},\r\n    {'date': date(2022, 5, 10), 'date2': '2022-05-10',  'ts': '2022-04-10T09:47:54+00:00', 'name': 'Fake Name 6', 'email': 'fakename6@email.com'},\r\n    {'date': date(2022, 5, 1),  'date2': '2022-05-01',  'ts': '2022-04-10T09:47:54+00:00', 'name': 'Fake Name 7', 'email': 'fakename7@email.com'},\r\n]\r\nspark = SparkSession.builder.getOrCreate()\r\ndf = spark.createDataFrame(data)\r\ndf.write.partitionBy('date').parquet('sample-data')\r\n```\r\nThe above data is written to `s3a://hudi-testing-tmp/sample-data/`.\r\n\r\n```\r\nspark-submit --class org.apache.hudi.utilities.deltastreamer.HoodieDeltaStreamer \\\r\n            --jars /usr/lib/spark/external/lib/spark-avro.jar \\\r\n            --master yarn \\\r\n            --deploy-mode client \\\r\n            --conf spark.sql.hive.convertMetastoreParquet=false /usr/lib/hudi/hudi-utilities-bundle.jar \\\r\n            --table-type COPY_ON_WRITE \\\r\n            --source-ordering-field ts \\\r\n            --source-class org.apache.hudi.utilities.sources.ParquetDFSSource \\\r\n            --target-table sample_data_custom \\\r\n            --target-base-path s3a://hudi-testing-tmp/sample-data-hudi/ \\\r\n            --hoodie-conf hoodie.deltastreamer.source.dfs.root=s3a://hudi-testing-tmp/sample-data/ \\\r\n            --hoodie-conf hoodie.datasource.write.recordkey.field=ts,email \\\r\n            --hoodie-conf hoodie.datasource.write.hive_style_partitioning=true \\\r\n            --op UPSERT \\\r\n            --hoodie-conf hoodie.datasource.write.partitionpath.field=date2:timestamp \\\r\n            --hoodie-conf hoodie.deltastreamer.keygen.timebased.timestamp.type=DATE_STRING \\\r\n            --hoodie-conf hoodie.deltastreamer.keygen.timebased.input.dateformat=\"yyyy-MM-dd\" \\\r\n            --hoodie-conf hoodie.deltastreamer.keygen.timebased.output.dateformat=\"yyyy-MM-dd\" \\\r\n            --hoodie-conf hoodie.datasource.write.keygenerator.class=org.apache.hudi.keygen.CustomKeyGenerator\r\n```\r\nAfter the job finishes, you can see:\r\n```\r\naws s3 ls s3://hudi-testing-tmp/sample-data-hudi/\r\n                           PRE .hoodie/\r\n                           PRE date2=2022-01-03/\r\n                           PRE date2=2022-01-04/\r\n                           PRE date2=2022-01-05/\r\n                           PRE date2=2022-02-05/\r\n                           PRE date2=2022-03-05/\r\n                           PRE date2=2022-05-01/\r\n                           PRE date2=2022-05-10/\r\n```","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1115491470/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1115492097","html_url":"https://github.com/apache/hudi/issues/5485#issuecomment-1115492097","issue_url":"https://api.github.com/repos/apache/hudi/issues/5485","id":1115492097,"node_id":"IC_kwDOBI7nWM5CfQ8B","user":{"login":"yihua","id":2497195,"node_id":"MDQ6VXNlcjI0OTcxOTU=","avatar_url":"https://avatars.githubusercontent.com/u/2497195?v=4","gravatar_id":"","url":"https://api.github.com/users/yihua","html_url":"https://github.com/yihua","followers_url":"https://api.github.com/users/yihua/followers","following_url":"https://api.github.com/users/yihua/following{/other_user}","gists_url":"https://api.github.com/users/yihua/gists{/gist_id}","starred_url":"https://api.github.com/users/yihua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yihua/subscriptions","organizations_url":"https://api.github.com/users/yihua/orgs","repos_url":"https://api.github.com/users/yihua/repos","events_url":"https://api.github.com/users/yihua/events{/privacy}","received_events_url":"https://api.github.com/users/yihua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-03T00:21:39Z","updated_at":"2022-05-03T00:21:39Z","author_association":"CONTRIBUTOR","body":"You can also find more information about all key generators [here](https://hudi.apache.org/blog/2021/02/13/hudi-key-generators/).","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1115492097/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1115493552","html_url":"https://github.com/apache/hudi/pull/5472#issuecomment-1115493552","issue_url":"https://api.github.com/repos/apache/hudi/issues/5472","id":1115493552,"node_id":"IC_kwDOBI7nWM5CfRSw","user":{"login":"vingov","id":1142498,"node_id":"MDQ6VXNlcjExNDI0OTg=","avatar_url":"https://avatars.githubusercontent.com/u/1142498?v=4","gravatar_id":"","url":"https://api.github.com/users/vingov","html_url":"https://github.com/vingov","followers_url":"https://api.github.com/users/vingov/followers","following_url":"https://api.github.com/users/vingov/following{/other_user}","gists_url":"https://api.github.com/users/vingov/gists{/gist_id}","starred_url":"https://api.github.com/users/vingov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vingov/subscriptions","organizations_url":"https://api.github.com/users/vingov/orgs","repos_url":"https://api.github.com/users/vingov/repos","events_url":"https://api.github.com/users/vingov/events{/privacy}","received_events_url":"https://api.github.com/users/vingov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-03T00:24:26Z","updated_at":"2022-05-03T00:24:26Z","author_association":"CONTRIBUTOR","body":"@vc or @bhasudha - please review this dbt blog","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1115493552/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1115755994","html_url":"https://github.com/apache/hudi/issues/5046#issuecomment-1115755994","issue_url":"https://api.github.com/repos/apache/hudi/issues/5046","id":1115755994,"node_id":"IC_kwDOBI7nWM5CgRXa","user":{"login":"yihua","id":2497195,"node_id":"MDQ6VXNlcjI0OTcxOTU=","avatar_url":"https://avatars.githubusercontent.com/u/2497195?v=4","gravatar_id":"","url":"https://api.github.com/users/yihua","html_url":"https://github.com/yihua","followers_url":"https://api.github.com/users/yihua/followers","following_url":"https://api.github.com/users/yihua/following{/other_user}","gists_url":"https://api.github.com/users/yihua/gists{/gist_id}","starred_url":"https://api.github.com/users/yihua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yihua/subscriptions","organizations_url":"https://api.github.com/users/yihua/orgs","repos_url":"https://api.github.com/users/yihua/repos","events_url":"https://api.github.com/users/yihua/events{/privacy}","received_events_url":"https://api.github.com/users/yihua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-03T05:40:51Z","updated_at":"2022-05-03T05:40:51Z","author_association":"CONTRIBUTOR","body":"Let’s track the fix to this issue in HUDI-3467.  Closing this issue.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1115755994/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1115758936","html_url":"https://github.com/apache/hudi/issues/5146#issuecomment-1115758936","issue_url":"https://api.github.com/repos/apache/hudi/issues/5146","id":1115758936,"node_id":"IC_kwDOBI7nWM5CgSFY","user":{"login":"yihua","id":2497195,"node_id":"MDQ6VXNlcjI0OTcxOTU=","avatar_url":"https://avatars.githubusercontent.com/u/2497195?v=4","gravatar_id":"","url":"https://api.github.com/users/yihua","html_url":"https://github.com/yihua","followers_url":"https://api.github.com/users/yihua/followers","following_url":"https://api.github.com/users/yihua/following{/other_user}","gists_url":"https://api.github.com/users/yihua/gists{/gist_id}","starred_url":"https://api.github.com/users/yihua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yihua/subscriptions","organizations_url":"https://api.github.com/users/yihua/orgs","repos_url":"https://api.github.com/users/yihua/repos","events_url":"https://api.github.com/users/yihua/events{/privacy}","received_events_url":"https://api.github.com/users/yihua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-03T05:47:37Z","updated_at":"2022-05-03T05:47:37Z","author_association":"CONTRIBUTOR","body":"@melin Thanks for the feature request.  Feel free to create a Jira ticket [here](https://issues.apache.org/jira/projects/HUDI/issues) to track this.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1115758936/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1115761056","html_url":"https://github.com/apache/hudi/issues/5248#issuecomment-1115761056","issue_url":"https://api.github.com/repos/apache/hudi/issues/5248","id":1115761056,"node_id":"IC_kwDOBI7nWM5CgSmg","user":{"login":"yihua","id":2497195,"node_id":"MDQ6VXNlcjI0OTcxOTU=","avatar_url":"https://avatars.githubusercontent.com/u/2497195?v=4","gravatar_id":"","url":"https://api.github.com/users/yihua","html_url":"https://github.com/yihua","followers_url":"https://api.github.com/users/yihua/followers","following_url":"https://api.github.com/users/yihua/following{/other_user}","gists_url":"https://api.github.com/users/yihua/gists{/gist_id}","starred_url":"https://api.github.com/users/yihua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yihua/subscriptions","organizations_url":"https://api.github.com/users/yihua/orgs","repos_url":"https://api.github.com/users/yihua/repos","events_url":"https://api.github.com/users/yihua/events{/privacy}","received_events_url":"https://api.github.com/users/yihua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-03T05:52:17Z","updated_at":"2022-05-03T05:52:17Z","author_association":"CONTRIBUTOR","body":"We’re going to track the fix in HUDI-4001.  Closing this issue.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1115761056/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1115792891","html_url":"https://github.com/apache/hudi/issues/5481#issuecomment-1115792891","issue_url":"https://api.github.com/repos/apache/hudi/issues/5481","id":1115792891,"node_id":"IC_kwDOBI7nWM5CgaX7","user":{"login":"MikeBuh","id":91965061,"node_id":"U_kgDOBXtGhQ","avatar_url":"https://avatars.githubusercontent.com/u/91965061?v=4","gravatar_id":"","url":"https://api.github.com/users/MikeBuh","html_url":"https://github.com/MikeBuh","followers_url":"https://api.github.com/users/MikeBuh/followers","following_url":"https://api.github.com/users/MikeBuh/following{/other_user}","gists_url":"https://api.github.com/users/MikeBuh/gists{/gist_id}","starred_url":"https://api.github.com/users/MikeBuh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MikeBuh/subscriptions","organizations_url":"https://api.github.com/users/MikeBuh/orgs","repos_url":"https://api.github.com/users/MikeBuh/repos","events_url":"https://api.github.com/users/MikeBuh/events{/privacy}","received_events_url":"https://api.github.com/users/MikeBuh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-03T06:57:58Z","updated_at":"2022-05-03T06:58:43Z","author_association":"NONE","body":"@yihua Thank-you for the reply on this however please note the following: \r\n- real-time is working fine, I just included those to showcase what it is currently using for new data\r\n- batch reload is having the issues and failing with out of memory errors (error code 137) \r\n- the Spark UI screenshots and detailed configs are related to this reload job\r\n- perhaps I was not clear, the resources used by the reload job are the default EMR ones specified in that config (re-adding below to have full clarity):\r\n\r\n**Spark Parameters**\r\n> spark.driver.cores: 5\r\n> spark.driver.memory: 24100m\r\n> spark.driver.memoryOverhead: 2680m\r\n> \r\n> spark.executor.instances: 10\r\n> spark.executor.cores: 5\r\n> spark.executor.memory: 24100m\r\n> spark.executor.memoryOverhead: 2680m\r\n> spark.memory.storageFraction: 0.6\r\n> spark.memory.fraction: 0.7\r\n> spark.default.parallelism: 100\r\n> spark.sql.shuffle.partitions: 100\r\n> spark.kryoserializer.buffer.max: 128m\r\n> \r\n> spark.driver.extraJavaOptions: -Xloggc:/var/log/spark-GClog.log -XX:+PrintGC -XX:+UseG1GC -XX:+UnlockDiagnosticVMOptions -XX:+G1SummarizeConcMark -XX:InitiatingHeapOccupancyPercent=35 -verbose:gc -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:OnOutOfMemoryError='kill -9 %p'\r\n>\r\n> spark.executor.extraJavaOptions: -Xloggc:/var/log/spark-GClog.log -XX:+PrintGC -XX:+UseG1GC -XX:+UnlockDiagnosticVMOptions -XX:+G1SummarizeConcMark -XX:InitiatingHeapOccupancyPercent=35 -verbose:gc -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:OnOutOfMemoryError='kill -9 %p'\r\n\r\n**Hudi Parameters**\r\n> hoodie.index.type: BLOOM\r\n> hoodie.datasource.write.operation: UPSERT\r\n> hoodie.upsert.shuffle.parallelism: 100\r\n> hoodie.payload.ordering.field: hoodie.datasource.write.precombine.field\r\n> hoodie.datasource.write.payload.class: org.apache.hudi.common.model.DefaultHoodieRecordPayload\r\n\r\nThanks once again for your prompt reply and I hope you can assist me with this. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1115792891/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1115985596","html_url":"https://github.com/apache/hudi/pull/5486#issuecomment-1115985596","issue_url":"https://api.github.com/repos/apache/hudi/issues/5486","id":1115985596,"node_id":"IC_kwDOBI7nWM5ChJa8","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-03T11:19:27Z","updated_at":"2022-05-03T11:19:27Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"b2d8289028755c11522407086f9fc21540765ea8\",\n    \"status\" : \"SUCCESS\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8415\",\n    \"triggerID\" : \"b2d8289028755c11522407086f9fc21540765ea8\",\n    \"triggerType\" : \"PUSH\"\n  } ]\n}-->\n## CI report:\n\n* b2d8289028755c11522407086f9fc21540765ea8 Azure: [SUCCESS](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8415) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1115985596/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1115996169","html_url":"https://github.com/apache/hudi/issues/5452#issuecomment-1115996169","issue_url":"https://api.github.com/repos/apache/hudi/issues/5452","id":1115996169,"node_id":"IC_kwDOBI7nWM5ChMAJ","user":{"login":"santoshsb","id":15146609,"node_id":"MDQ6VXNlcjE1MTQ2NjA5","avatar_url":"https://avatars.githubusercontent.com/u/15146609?v=4","gravatar_id":"","url":"https://api.github.com/users/santoshsb","html_url":"https://github.com/santoshsb","followers_url":"https://api.github.com/users/santoshsb/followers","following_url":"https://api.github.com/users/santoshsb/following{/other_user}","gists_url":"https://api.github.com/users/santoshsb/gists{/gist_id}","starred_url":"https://api.github.com/users/santoshsb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/santoshsb/subscriptions","organizations_url":"https://api.github.com/users/santoshsb/orgs","repos_url":"https://api.github.com/users/santoshsb/repos","events_url":"https://api.github.com/users/santoshsb/events{/privacy}","received_events_url":"https://api.github.com/users/santoshsb/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-03T11:32:55Z","updated_at":"2022-05-03T11:32:55Z","author_association":"NONE","body":"@xiarixiaoyao FYI, we just tested this issue by building the release branch 0.11.0, here is the JSON string and the schema.\r\n`{\r\n  \"resourceType\": \"Patient\",\r\n  \"id\": \"596c7a94-bada-4303-85d4-7067c586999e\",\r\n  \"lastUpdated\": \"2022-04-20T15:18:18.90836+05:30\",\r\n  \"source\": \"4a0701fe-5c3b-482b-895d-875fcbd2148a\",\r\n  \"name\": [\r\n    {\r\n      \"use\": \"official\",\r\n      \"family\": \"Haley279\",\r\n      \"given\": [\r\n        \"Vinita997\"\r\n      ]\r\n    }\r\n  ],\r\n  \"gender\": \"female\",\r\n  \"birthDate\": \"2005-08-30\",\r\n  \"multipleBirthBoolean\": false,\r\n  \"communication\": [\r\n    {\r\n      \"language\": {\r\n        \"coding\": [\r\n          {\r\n            \"system\": \"urn:ietf:bcp:47\",\r\n            \"code\": \"en-US\",\r\n            \"display\": \"English\"\r\n          }\r\n        ],\r\n        \"text\": \"English\"\r\n      }\r\n    }\r\n  ]\r\n}`\r\n\r\nSCHEMA\r\n\r\nscala> hudiPatientDF.printSchema\r\nroot\r\n |-- _hoodie_commit_time: string (nullable = true)\r\n |-- _hoodie_commit_seqno: string (nullable = true)\r\n |-- _hoodie_record_key: string (nullable = true)\r\n |-- _hoodie_partition_path: string (nullable = true)\r\n |-- _hoodie_file_name: string (nullable = true)\r\n |-- birthDate: string (nullable = true)\r\n |-- communication: array (nullable = true)\r\n |    |-- element: struct (containsNull = true)\r\n |    |    |-- language: struct (nullable = true)\r\n |    |    |    |-- coding: array (nullable = true)\r\n |    |    |    |    |-- element: struct (containsNull = true)\r\n |    |    |    |    |    |-- code: string (nullable = true)\r\n |    |    |    |    |    |-- display: string (nullable = true)\r\n |    |    |    |    |    |-- system: string (nullable = true)\r\n |    |    |    |-- text: string (nullable = true)\r\n |-- gender: string (nullable = true)\r\n |-- id: string (nullable = true)\r\n |-- lastUpdated: string (nullable = true)\r\n |-- multipleBirthBoolean: boolean (nullable = true)\r\n |-- name: array (nullable = true)\r\n |    |-- element: struct (containsNull = true)\r\n |    |    |-- family: string (nullable = true)\r\n |    |    |-- given: array (nullable = true)\r\n |    |    |    |-- element: string (containsNull = true)\r\n |    |    |-- use: string (nullable = true)\r\n |-- resourceType: string (nullable = true)\r\n |-- source: string (nullable = true)\r\n\r\nWe inserted the above JSON string and Updated the same, and it threw the following error which is same as above.\r\n\r\n`Caused by: org.apache.hudi.exception.HoodieException: unable to read next record from parquet file\r\n  at org.apache.hudi.common.util.ParquetReaderIterator.hasNext(ParquetReaderIterator.java:53)\r\n  at org.apache.hudi.common.util.queue.IteratorBasedQueueProducer.produce(IteratorBasedQueueProducer.java:45)\r\n  at org.apache.hudi.common.util.queue.BoundedInMemoryExecutor.lambda$null$0(BoundedInMemoryExecutor.java:105)\r\n  at java.util.concurrent.FutureTask.run(FutureTask.java:266)\r\n  at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)\r\n  ... 4 more\r\nCaused by: org.apache.parquet.io.InvalidRecordException: Parquet/Avro schema mismatch: Avro field 'coding' not found\r\n  at org.apache.parquet.avro.AvroRecordConverter.getAvroField(AvroRecordConverter.java:221)\r\n  at org.apache.parquet.avro.AvroRecordConverter.<init>(AvroRecordConverter.java:126)\r\n  at org.apache.parquet.avro.AvroRecordConverter.newConverter(AvroRecordConverter.java:284)\r\n  at org.apache.parquet.avro.AvroRecordConverter.newConverter(AvroRecordConverter.java:228)\r\n  at org.apache.parquet.avro.AvroRecordConverter.access$100(AvroRecordConverter.java:74)\r\n  at org.apache.parquet.avro.AvroRecordConverter$AvroCollectionConverter$ElementConverter.<init>(AvroRecordConverter.java:539)\r\n  at org.apache.parquet.avro.AvroRecordConverter$AvroCollectionConverter.<init>(AvroRecordConverter.java:489)\r\n  at org.apache.parquet.avro.AvroRecordConverter.newConverter(AvroRecordConverter.java:293)\r\n  at org.apache.parquet.avro.AvroRecordConverter.<init>(AvroRecordConverter.java:137)\r\n  at org.apache.parquet.avro.AvroRecordConverter.<init>(AvroRecordConverter.java:91)\r\n  at org.apache.parquet.avro.AvroRecordMaterializer.<init>(AvroRecordMaterializer.java:33)\r\n  at org.apache.parquet.avro.AvroReadSupport.prepareForRead(AvroReadSupport.java:142)\r\n  at org.apache.parquet.hadoop.InternalParquetRecordReader.initialize(InternalParquetRecordReader.java:185)\r\n  at org.apache.parquet.hadoop.ParquetReader.initReader(ParquetReader.java:156)\r\n  at org.apache.parquet.hadoop.ParquetReader.read(ParquetReader.java:135)\r\n  at org.apache.hudi.common.util.ParquetReaderIterator.hasNext(ParquetReaderIterator.java:48)`\r\n\r\nThanks,\r\nSantosh","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1115996169/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1116034784","html_url":"https://github.com/apache/hudi/pull/5487#issuecomment-1116034784","issue_url":"https://api.github.com/repos/apache/hudi/issues/5487","id":1116034784,"node_id":"IC_kwDOBI7nWM5ChVbg","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-03T12:19:55Z","updated_at":"2022-05-03T12:19:55Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"a979b6db18d7162d7a42034fecaab7c1e67c4f65\",\n    \"status\" : \"SUCCESS\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8416\",\n    \"triggerID\" : \"a979b6db18d7162d7a42034fecaab7c1e67c4f65\",\n    \"triggerType\" : \"PUSH\"\n  } ]\n}-->\n## CI report:\n\n* a979b6db18d7162d7a42034fecaab7c1e67c4f65 Azure: [SUCCESS](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8416) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1116034784/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1116043168","html_url":"https://github.com/apache/hudi/issues/5484#issuecomment-1116043168","issue_url":"https://api.github.com/repos/apache/hudi/issues/5484","id":1116043168,"node_id":"IC_kwDOBI7nWM5ChXeg","user":{"login":"jasondavindev","id":33331415,"node_id":"MDQ6VXNlcjMzMzMxNDE1","avatar_url":"https://avatars.githubusercontent.com/u/33331415?v=4","gravatar_id":"","url":"https://api.github.com/users/jasondavindev","html_url":"https://github.com/jasondavindev","followers_url":"https://api.github.com/users/jasondavindev/followers","following_url":"https://api.github.com/users/jasondavindev/following{/other_user}","gists_url":"https://api.github.com/users/jasondavindev/gists{/gist_id}","starred_url":"https://api.github.com/users/jasondavindev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasondavindev/subscriptions","organizations_url":"https://api.github.com/users/jasondavindev/orgs","repos_url":"https://api.github.com/users/jasondavindev/repos","events_url":"https://api.github.com/users/jasondavindev/events{/privacy}","received_events_url":"https://api.github.com/users/jasondavindev/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-03T12:28:38Z","updated_at":"2022-05-03T12:57:23Z","author_association":"NONE","body":"@umehrot2  I known this config is working because when I run `spark.catalog.listDatabases()` the correct result is shown and when I create tables using `.write.saveAsTable()` no errors are raised. But when Hudi tries to write an error is raised.\r\n\r\nGlue initialization logs\r\n\r\n```\r\nINFO HiveConf: Found configuration file file:/etc/spark/conf/hive-site.xml\r\nINFO HiveUtils: Initializing HiveMetastoreConnection version 2.3.7-amzn-4 using Spark classes.\r\nINFO HiveConf: Found configuration file file:/etc/spark/conf/hive-site.xml\r\nINFO SessionState: Created HDFS directory: /tmp/hive/hadoop\r\nINFO SessionState: Created local directory: /tmp/hadoop\r\nINFO SessionState: Created HDFS directory: /tmp/hive/hadoop/72e3c43b-0b2e-***********\r\nINFO SessionState: Created local directory: /tmp/hadoop/72e3c43b-0b2e-***********\r\nINFO SessionState: Created HDFS directory: /tmp/hive/hadoop/72e3c43b-0b2e-***********/_tmp_space.db\r\nINFO HiveClientImpl: Warehouse location for Hive client (version 2.3.7) is file:/home/hadoop/spark-warehouse\r\nINFO AWSGlueClientFactory: Using region from ec2 metadata : us-east-1\r\nINFO DefaultAWSCredentialsProviderFactory: Unable to create provider using constructor: WebIdentityTokenCredentialsProvider(java.net.URI, org.apache.hadoop.conf.Configuration)\r\nINFO ClientConfigurationFactory: Set initial getObject socket timeout to 2000 ms.\r\nINFO InMemoryFileIndex: It took 77 ms to list leaf files for 1 paths.\r\nINFO GlueMetastoreClientDelegate: Enabled to skip drop table partitions\r\n```","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1116043168/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1116057329","html_url":"https://github.com/apache/hudi/issues/5482#issuecomment-1116057329","issue_url":"https://api.github.com/repos/apache/hudi/issues/5482","id":1116057329,"node_id":"IC_kwDOBI7nWM5Cha7x","user":{"login":"parisni","id":9535350,"node_id":"MDQ6VXNlcjk1MzUzNTA=","avatar_url":"https://avatars.githubusercontent.com/u/9535350?v=4","gravatar_id":"","url":"https://api.github.com/users/parisni","html_url":"https://github.com/parisni","followers_url":"https://api.github.com/users/parisni/followers","following_url":"https://api.github.com/users/parisni/following{/other_user}","gists_url":"https://api.github.com/users/parisni/gists{/gist_id}","starred_url":"https://api.github.com/users/parisni/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/parisni/subscriptions","organizations_url":"https://api.github.com/users/parisni/orgs","repos_url":"https://api.github.com/users/parisni/repos","events_url":"https://api.github.com/users/parisni/events{/privacy}","received_events_url":"https://api.github.com/users/parisni/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-03T12:45:06Z","updated_at":"2022-05-03T12:45:43Z","author_association":"CONTRIBUTOR","body":"I cannot really share the whole code, but parts of it.\r\n\r\n> Also, do the timeouts prevent the ingestion from proceeding? \r\n\r\nyes : I only get 5 commit done but I am trying 6 operations\r\n\r\nThen I added a concurrency lock store based on dynamodb.\r\n\r\nHere are the logs after the timeout (about 2 min to wait). (this is a minio based local s3 provider). I checked and the file it tries to open exists.\r\n\r\n```\r\norg.apache.hudi.exception.HoodieIOException: IOException when reading logfile HoodieLogFile{pathStr='s3a://test-bucket/s3_path/table/.hoodie/metadata/column_stats/.col-stats-0001_00000000000000.log.4_0-128-201', fileLen=-1}\r\n\tat org.apache.hudi.common.table.log.HoodieLogFileReader.hasNext(HoodieLogFileReader.java:352)\r\n\tat org.apache.hudi.common.table.log.HoodieLogFormatReader.hasNext(HoodieLogFormatReader.java:99)\r\n\tat org.apache.hudi.common.table.log.HoodieLogFormatReader.hasNext(HoodieLogFormatReader.java:116)\r\n\tat org.apache.hudi.common.table.log.AbstractHoodieLogRecordReader.scanInternal(AbstractHoodieLogRecordReader.java:223)\r\n\tat org.apache.hudi.common.table.log.AbstractHoodieLogRecordReader.scan(AbstractHoodieLogRecordReader.java:192)\r\n\tat org.apache.hudi.common.table.log.HoodieMergedLogRecordScanner.performScan(HoodieMergedLogRecordScanner.java:110)\r\n\tat org.apache.hudi.common.table.log.HoodieMergedLogRecordScanner.<init>(HoodieMergedLogRecordScanner.java:103)\r\n\tat org.apache.hudi.common.table.log.HoodieMergedLogRecordScanner$Builder.build(HoodieMergedLogRecordScanner.java:324)\r\n\tat org.apache.hudi.table.action.compact.HoodieCompactor.compact(HoodieCompactor.java:198)\r\n\tat org.apache.hudi.table.action.compact.HoodieCompactor.lambda$compact$57154431$1(HoodieCompactor.java:138)\r\n\tat org.apache.spark.api.java.JavaPairRDD$.$anonfun$toScalaFunction$1(JavaPairRDD.scala:1040)\r\n\tat scala.collection.Iterator$$anon$10.next(Iterator.scala:459)\r\n\tat scala.collection.Iterator$$anon$11.nextCur(Iterator.scala:484)\r\n\tat scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:490)\r\n\tat org.apache.spark.storage.memory.MemoryStore.putIterator(MemoryStore.scala:221)\r\n\tat org.apache.spark.storage.memory.MemoryStore.putIteratorAsBytes(MemoryStore.scala:349)\r\n\tat org.apache.spark.storage.BlockManager.$anonfun$doPutIterator$1(BlockManager.scala:1182)\r\n\tat org.apache.spark.storage.BlockManager.doPut(BlockManager.scala:1091)\r\n\tat org.apache.spark.storage.BlockManager.doPutIterator(BlockManager.scala:1156)\r\n\tat org.apache.spark.storage.BlockManager.getOrElseUpdate(BlockManager.scala:882)\r\n\tat org.apache.spark.rdd.RDD.getOrCompute(RDD.scala:357)\r\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:308)\r\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)\r\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:346)\r\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:310)\r\n\tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:90)\r\n\tat org.apache.spark.scheduler.Task.run(Task.scala:123)\r\n\tat org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$3(Executor.scala:414)\r\n\tat org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)\r\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:417)\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n\tat java.lang.Thread.run(Thread.java:748)\r\nCaused by: java.io.InterruptedIOException: Reopen at position 0 on s3a://test-bucket/s3_path/table/.hoodie/metadata/column_stats/.col-stats-0001_00000000000000.log.4_0-128-201: com.amazonaws.SdkClientException: Unable to execute HTTP request: Timeout waiting for connection from pool\r\n\tat org.apache.hadoop.fs.s3a.S3AUtils.translateException(S3AUtils.java:125)\r\n\tat org.apache.hadoop.fs.s3a.S3AInputStream.reopen(S3AInputStream.java:155)\r\n\tat org.apache.hadoop.fs.s3a.S3AInputStream.lazySeek(S3AInputStream.java:281)\r\n\tat org.apache.hadoop.fs.s3a.S3AInputStream.read(S3AInputStream.java:364)\r\n\tat java.io.DataInputStream.read(DataInputStream.java:149)\r\n\tat java.io.DataInputStream.readFully(DataInputStream.java:195)\r\n\tat org.apache.hudi.common.table.log.HoodieLogFileReader.hasNextMagic(HoodieLogFileReader.java:379)\r\n\tat org.apache.hudi.common.table.log.HoodieLogFileReader.readMagic(HoodieLogFileReader.java:365)\r\n\tat org.apache.hudi.common.table.log.HoodieLogFileReader.hasNext(HoodieLogFileReader.java:350)\r\n\t... 32 more\r\nCaused by: com.amazonaws.SdkClientException: Unable to execute HTTP request: Timeout waiting for connection from pool\r\n\tat com.amazonaws.http.AmazonHttpClient$RequestExecutor.handleRetryableException(AmazonHttpClient.java:1175)\r\n\tat com.amazonaws.http.AmazonHttpClient$RequestExecutor.executeHelper(AmazonHttpClient.java:1121)\r\n\tat com.amazonaws.http.AmazonHttpClient$RequestExecutor.doExecute(AmazonHttpClient.java:770)\r\n\tat com.amazonaws.http.AmazonHttpClient$RequestExecutor.executeWithTimer(AmazonHttpClient.java:744)\r\n\tat com.amazonaws.http.AmazonHttpClient$RequestExecutor.execute(AmazonHttpClient.java:726)\r\n\tat com.amazonaws.http.AmazonHttpClient$RequestExecutor.access$500(AmazonHttpClient.java:686)\r\n\tat com.amazonaws.http.AmazonHttpClient$RequestExecutionBuilderImpl.execute(AmazonHttpClient.java:668)\r\n\tat com.amazonaws.http.AmazonHttpClient.execute(AmazonHttpClient.java:532)\r\n\tat com.amazonaws.http.AmazonHttpClient.execute(AmazonHttpClient.java:512)\r\n\tat com.amazonaws.services.s3.AmazonS3Client.invoke(AmazonS3Client.java:4926)\r\n\tat com.amazonaws.services.s3.AmazonS3Client.invoke(AmazonS3Client.java:4872)\r\n\tat com.amazonaws.services.s3.AmazonS3Client.getObject(AmazonS3Client.java:1472)\r\n\tat org.apache.hadoop.fs.s3a.S3AInputStream.reopen(S3AInputStream.java:148)\r\n\t... 39 more\r\nCaused by: org.apache.http.conn.ConnectionPoolTimeoutException: Timeout waiting for connection from pool\r\n\tat org.apache.http.impl.conn.PoolingHttpClientConnectionManager.leaseConnection(PoolingHttpClientConnectionManager.java:286)\r\n\tat org.apache.http.impl.conn.PoolingHttpClientConnectionManager$1.get(PoolingHttpClientConnectionManager.java:263)\r\n\tat sun.reflect.GeneratedMethodAccessor17.invoke(Unknown Source)\r\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.lang.reflect.Method.invoke(Method.java:498)\r\n\tat com.amazonaws.http.conn.ClientConnectionRequestFactory$Handler.invoke(ClientConnectionRequestFactory.java:70)\r\n\tat com.amazonaws.http.conn.$Proxy46.get(Unknown Source)\r\n\tat org.apache.http.impl.execchain.MainClientExec.execute(MainClientExec.java:190)\r\n\tat org.apache.http.impl.execchain.ProtocolExec.execute(ProtocolExec.java:184)\r\n\tat org.apache.http.impl.client.InternalHttpClient.doExecute(InternalHttpClient.java:184)\r\n\tat org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:82)\r\n\tat org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:55)\r\n\tat com.amazonaws.http.apache.client.impl.SdkHttpClient.execute(SdkHttpClient.java:72)\r\n\tat com.amazonaws.http.AmazonHttpClient$RequestExecutor.executeOneRequest(AmazonHttpClient.java:1297)\r\n\tat com.amazonaws.http.AmazonHttpClient$RequestExecutor.executeHelper(AmazonHttpClient.java:1113)\r\n\t... 50 more\r\n``` ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1116057329/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1116086600","html_url":"https://github.com/apache/hudi/issues/5455#issuecomment-1116086600","issue_url":"https://api.github.com/repos/apache/hudi/issues/5455","id":1116086600,"node_id":"IC_kwDOBI7nWM5ChiFI","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-03T13:17:17Z","updated_at":"2022-05-03T13:17:17Z","author_association":"CONTRIBUTOR","body":"@bhasudha : Do we need to add any faq on this end? will let you take a call. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1116086600/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1116157734","html_url":"https://github.com/apache/hudi/issues/5485#issuecomment-1116157734","issue_url":"https://api.github.com/repos/apache/hudi/issues/5485","id":1116157734,"node_id":"IC_kwDOBI7nWM5Chzcm","user":{"login":"leobiscassi","id":1977418,"node_id":"MDQ6VXNlcjE5Nzc0MTg=","avatar_url":"https://avatars.githubusercontent.com/u/1977418?v=4","gravatar_id":"","url":"https://api.github.com/users/leobiscassi","html_url":"https://github.com/leobiscassi","followers_url":"https://api.github.com/users/leobiscassi/followers","following_url":"https://api.github.com/users/leobiscassi/following{/other_user}","gists_url":"https://api.github.com/users/leobiscassi/gists{/gist_id}","starred_url":"https://api.github.com/users/leobiscassi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leobiscassi/subscriptions","organizations_url":"https://api.github.com/users/leobiscassi/orgs","repos_url":"https://api.github.com/users/leobiscassi/repos","events_url":"https://api.github.com/users/leobiscassi/events{/privacy}","received_events_url":"https://api.github.com/users/leobiscassi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-03T14:20:47Z","updated_at":"2022-05-03T14:20:47Z","author_association":"NONE","body":"Hi @yihua, thanks for the answer! About the your points:\r\n(1) Thank you, I didn't notice this possibility, these folders are annoying 😓 \r\n\r\n(2) (3)  \r\n> the parquet files you generated do not have the date field in the schema, i.e., when each individual parquet file is directly read, the date field is not there.\r\n\r\nFor Apache Spark the partitions are meant to be part of the schema, so every time we read `s3://hudi-issue-raw-zone/sample-data/` the schema of DataFrame is fields on the parquet + partitions, what you are saying is that independent of the datatype / style of the partitions from source dataset they won't be considered as fields, since Hudi Delta Streamer just list all the parquet files from the base path and read them directly, is that right to assume?\r\n\r\n> Hudi 0.9.0-amzn-1 does not support date-typed partition field. The support is only added recently https://github.com/apache/hudi/pull/5432. However, you can still using String-typed partition field.\r\n\r\nBy this you mean that `hudi 0.9.0-amzn-1` doesn't support `date` typed partition field as partition on target, right? But the funny thing is: if I create the same sample data without partitioning I can write the data as hudi table without do the conversion from `date` to `string`, like the following code snippet:\r\n\r\n1. Building the new sample data\r\n```python\r\nfrom pyspark.sql import SparkSession\r\nfrom datetime import date\r\n\r\ndata = [\r\n    {'date': date(2022, 1, 5), 'ts': '2022-04-10T09:47:54+00:00', 'name': 'Fake Name 1', 'email': 'fakename1@email.com'},\r\n    {'date': date(2022, 1, 4), 'ts': '2022-04-10T09:47:54+00:00', 'name': 'Fake Name 2', 'email': 'fakename2@email.com'},\r\n    {'date': date(2022, 1, 3), 'ts': '2022-04-10T09:47:54+00:00', 'name': 'Fake Name 3', 'email': 'fakename3@email.com'},\r\n    {'date': date(2022, 2, 5), 'ts': '2022-04-10T09:47:54+00:00', 'name': 'Fake Name 4', 'email': 'fakename4@email.com'},\r\n    {'date': date(2022, 3, 5), 'ts': '2022-04-10T09:47:54+00:00', 'name': 'Fake Name 5', 'email': 'fakename5@email.com'},\r\n    {'date': date(2022, 5, 10), 'ts': '2022-04-10T09:47:54+00:00', 'name': 'Fake Name 6', 'email': 'fakename6@email.com'},\r\n    {'date': date(2022, 5, 1), 'ts': '2022-04-10T09:47:54+00:00', 'name': 'Fake Name 7', 'email': 'fakename7@email.com'},\r\n]\r\n\r\nspark = SparkSession.builder.getOrCreate()\r\ndf = spark.createDataFrame(data)\r\ndf.write.parquet('sample-data-without-partition')\r\n```\r\n2. Running Hudi Delta Streamer Job\r\n```bash\r\nspark-submit --class org.apache.hudi.utilities.deltastreamer.HoodieDeltaStreamer \\\r\n            --jars /usr/lib/spark/external/lib/spark-avro.jar \\\r\n            --master yarn \\\r\n            --deploy-mode client \\\r\n            --conf spark.sql.hive.convertMetastoreParquet=false /usr/lib/hudi/hudi-utilities-bundle.jar \\\r\n            --table-type COPY_ON_WRITE \\\r\n            --source-ordering-field ts \\\r\n            --source-class org.apache.hudi.utilities.sources.ParquetDFSSource \\\r\n            --target-table sample_data_complex_partition \\\r\n            --target-base-path s3a://hudi-issue-standard-zone/sample-data-complex-partition/ \\\r\n            --hoodie-conf hoodie.deltastreamer.source.dfs.root=s3a://hudi-issue-raw-zone/sample-data-without-partition/ \\\r\n            --hoodie-conf hoodie.datasource.write.recordkey.field=ts,email \\\r\n            --hoodie-conf hoodie.datasource.write.hive_style_partitioning=true \\\r\n            --op UPSERT \\\r\n            --hoodie-conf hoodie.datasource.write.partitionpath.field=date \\\r\n            --hoodie-conf hoodie.datasource.write.keygenerator.class=org.apache.hudi.keygen.ComplexKeyGenerator\r\n```\r\n3. Result dataset on S3\r\n```bash\r\naws s3 ls s3://hudi-issue-standard-zone/sample-data-complex-partition/\r\n                           PRE .hoodie/\r\n                           PRE date=2022-01-03/\r\n                           PRE date=2022-01-04/\r\n                           PRE date=2022-01-05/\r\n                           PRE date=2022-02-05/\r\n                           PRE date=2022-03-05/\r\n                           PRE date=2022-05-01/\r\n                           PRE date=2022-05-10/\r\n```\r\n\r\nThere is a reason why hudi delta streamer choose doesn't behavior like spark (considering the partitions as part of the schema)? I'm asking this because I particularly have some datasets that have some fields just as partitions, so we kind loose data in these scenarios. The way me and the team I work on do a work around this is using the SQL Transformer and the `INPUT_FILE_NAME()` SparkSQL built-in function and extracting the data with regex and/or substrings, do you recommend another way or even don't use hudi delta streamer in these scenarios?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1116157734/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1116162592","html_url":"https://github.com/apache/hudi/pull/5436#issuecomment-1116162592","issue_url":"https://api.github.com/repos/apache/hudi/issues/5436","id":1116162592,"node_id":"IC_kwDOBI7nWM5Ch0og","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-03T14:24:30Z","updated_at":"2022-05-03T14:54:08Z","author_association":"MEMBER","body":"@danny0405 catching up here. Lets keep the discussions on GH (I ll leave some comments on the doc as well) so everyone in the community can discover more easily? Ideally, love for @YannByron and you to drive this forward. Happy to help. \r\n\r\nand respectfully, we need not be concerned about which other project does what. Let's remember that incremental queries in Hudi is what everything else is based off :) - we are the original trail blazers here. let's do the right decision for Hudi that fits into it better. I would really really wish for us to think more along how databases do it - they are far far more mature than any of the lakehouse frameworks. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1116162592/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1116452731","html_url":"https://github.com/apache/hudi/issues/5481#issuecomment-1116452731","issue_url":"https://api.github.com/repos/apache/hudi/issues/5481","id":1116452731,"node_id":"IC_kwDOBI7nWM5Ci7d7","user":{"login":"yihua","id":2497195,"node_id":"MDQ6VXNlcjI0OTcxOTU=","avatar_url":"https://avatars.githubusercontent.com/u/2497195?v=4","gravatar_id":"","url":"https://api.github.com/users/yihua","html_url":"https://github.com/yihua","followers_url":"https://api.github.com/users/yihua/followers","following_url":"https://api.github.com/users/yihua/following{/other_user}","gists_url":"https://api.github.com/users/yihua/gists{/gist_id}","starred_url":"https://api.github.com/users/yihua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yihua/subscriptions","organizations_url":"https://api.github.com/users/yihua/orgs","repos_url":"https://api.github.com/users/yihua/repos","events_url":"https://api.github.com/users/yihua/events{/privacy}","received_events_url":"https://api.github.com/users/yihua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-03T18:57:03Z","updated_at":"2022-05-03T18:57:03Z","author_association":"CONTRIBUTOR","body":"@MikeBuh Thanks for the clarification.  What is the input size of your batch reload?  The similar principle can be applied here for calculating the parallelism.  To be conservative at first, you can calculate the parallelism to use by deriving [input size / 100MB].  Say if the input size is 50GB, you can try parallelism as 500 as below:\r\n```\r\nspark.default.parallelism: 500\r\nspark.sql.shuffle.partitions: 500\r\nhoodie.upsert.shuffle.parallelism: 500\r\n```\r\nYou should also increase the Kryo serializer buffer:\r\n```\r\nspark.kryoserializer.buffer.max: 1024m\r\n```\r\nThe executor and driver memory should be good as they are already large enough.\r\n\r\nOnce you get a successful run, you may further reduce the parallelism to find the sweet spot so that more memory can be leveraged without OOM.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1116452731/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1116479729","html_url":"https://github.com/apache/hudi/issues/5485#issuecomment-1116479729","issue_url":"https://api.github.com/repos/apache/hudi/issues/5485","id":1116479729,"node_id":"IC_kwDOBI7nWM5CjCDx","user":{"login":"yihua","id":2497195,"node_id":"MDQ6VXNlcjI0OTcxOTU=","avatar_url":"https://avatars.githubusercontent.com/u/2497195?v=4","gravatar_id":"","url":"https://api.github.com/users/yihua","html_url":"https://github.com/yihua","followers_url":"https://api.github.com/users/yihua/followers","following_url":"https://api.github.com/users/yihua/following{/other_user}","gists_url":"https://api.github.com/users/yihua/gists{/gist_id}","starred_url":"https://api.github.com/users/yihua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yihua/subscriptions","organizations_url":"https://api.github.com/users/yihua/orgs","repos_url":"https://api.github.com/users/yihua/repos","events_url":"https://api.github.com/users/yihua/events{/privacy}","received_events_url":"https://api.github.com/users/yihua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-03T19:27:26Z","updated_at":"2022-05-03T19:27:26Z","author_association":"CONTRIBUTOR","body":"> what you are saying is that independent of the datatype / style of the partitions from source dataset they won't be considered as fields, since Hudi Delta Streamer just list all the parquet files from the base path and read them directly, is that right to assume?\r\n\r\nThat's correct.  If you want Spark like read to include the partition field from the partition path, you may consider SqlSource or SQL transformer.\r\n\r\n> By this you mean that hudi 0.9.0-amzn-1 doesn't support date typed partition field as partition on target, right? But the funny thing is: if I create the same sample data without partitioning I can write the data as hudi table without do the conversion from date to string, like the following code snippet\r\n\r\nIn the snippet you provided, `ComplexKeyGenerator` is used which goes through a different code path.  `CustomKeyGenerator` leverages `TimestampBasedAvroKeyGenerator` for timestamp field which does not support date typed partition field in 0.9.0.  That is what I meant.  Maybe I was not clear in my previous statement.\r\n\r\n> There is a reason why hudi delta streamer choose doesn't behavior like spark (considering the partitions as part of the schema)?\r\n\r\n`ParquetDFSSource` treats the source as plain parquet files.  As you said, for your use case, you can use SQL transformer to wire in the Spark like logic for the partition field with the Deltastreamer.\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1116479729/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1116656782","html_url":"https://github.com/apache/hudi/issues/5485#issuecomment-1116656782","issue_url":"https://api.github.com/repos/apache/hudi/issues/5485","id":1116656782,"node_id":"IC_kwDOBI7nWM5CjtSO","user":{"login":"leobiscassi","id":1977418,"node_id":"MDQ6VXNlcjE5Nzc0MTg=","avatar_url":"https://avatars.githubusercontent.com/u/1977418?v=4","gravatar_id":"","url":"https://api.github.com/users/leobiscassi","html_url":"https://github.com/leobiscassi","followers_url":"https://api.github.com/users/leobiscassi/followers","following_url":"https://api.github.com/users/leobiscassi/following{/other_user}","gists_url":"https://api.github.com/users/leobiscassi/gists{/gist_id}","starred_url":"https://api.github.com/users/leobiscassi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leobiscassi/subscriptions","organizations_url":"https://api.github.com/users/leobiscassi/orgs","repos_url":"https://api.github.com/users/leobiscassi/repos","events_url":"https://api.github.com/users/leobiscassi/events{/privacy}","received_events_url":"https://api.github.com/users/leobiscassi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-03T21:05:43Z","updated_at":"2022-05-03T21:05:43Z","author_association":"NONE","body":"> That's correct. If you want Spark like read to include the partition field from the partition path, you may consider SqlSource or SQL transformer.\r\n\r\nWhen I use the `ParquetDFSSource` with the SQL transformer I have exactly the same issue w/ the partitions, so the only way I have to extract this is with `INPUT_FILE_NAME()`+ custom logic.\r\n\r\n> In the snippet you provided, ComplexKeyGenerator is used which goes through a different code path. CustomKeyGenerator leverages TimestampBasedAvroKeyGenerator for timestamp field which does not support date typed partition field in 0.9.0. That is what I meant. Maybe I was not clear in my previous statement.\r\n\r\nGot it, thanks for the explanation.\r\n\r\n> ParquetDFSSource treats the source as plain parquet files. As you said, for your use case, you can use SQL transformer to wire in the Spark like logic for the partition field with the Deltastreamer.\r\n\r\nIt would be great add this information about the behavior w/ partitions on the docs, I spent a lot of time trying to see if I was missing some configuration that leads to this behavior. I didn't found anything there, there is something like this on the docs? If there isn't I could submit a PR adding this explanation w/ examples if you think it makes sense.\r\n\r\nThank you for the clarification @yihua!","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1116656782/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1116735024","html_url":"https://github.com/apache/hudi/pull/5436#issuecomment-1116735024","issue_url":"https://api.github.com/repos/apache/hudi/issues/5436","id":1116735024,"node_id":"IC_kwDOBI7nWM5CkAYw","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-03T22:54:59Z","updated_at":"2022-05-03T22:54:59Z","author_association":"MEMBER","body":"@danny0405 @YannByron \r\n\r\nI see the major sticking point is - \r\n\r\nOption A) separate `.cdc` folder, that contains the CDC log (similar to redo logs in databases)\r\nOption B) doing it using `_hoodie_operation` flag, effectively the CDC log is stored inline with the data.\r\n\r\nFew considerations that I think did not come across that well in the discussion above. \r\n\r\n@YannByron \r\n\r\n- Danny's concerns around double writing to the .cdc log and then the actual data file centers not around transactionality, but all the work we need to now do to implement skipping of such partial data written in the CDC read path. This comes for free if we leverage the data files (base/log) as the CDC log itself.  \r\n- Also similar on the management of `.cdc` i.e cleaning, clustering, small files - every problem we solve for data files, we need to solve for CDC log again \r\n- Writing every byte 2 times (even if the data changing every day is a fraction of the total table size), will cost multi-million dollars more for existing large users! (I am not exaggerating here :), I have seen what some hudi user's scales look like). This is Danny's main concern as well I think.\r\n\r\n@danny0405 \r\n- Yann's concerns are around the cost of \"joining\" different file slices together to generate the CDC stream, which is a valid concern as well. There is more \"compute\" cost paid per CDC query in this approach. \r\n\r\nIf you press me, I am still leaning on Option B and do it inline (i.e trade off the simplicity of implementation + reduced storage cost) over potentially (I'll explain why I say this) better CDC read efficiency. \r\n\r\n- Option A works for databases, but if you notice most warehouses did not support a change log kind of mechanism, due to storage concerns. Lakes store way more data than even warehouses. \r\n- The 10x efficiency gain here is going to be about moving from batch queries to CDC/Incremental queries and within these, the added joining of file slices for CDC may not be as bad as we think. We should benchmark some of the join costs for option B, that's a fair concern to address upfront. \r\n- Honestly, Option B is much simple to implement on top of Hudi. We already have most pieces there. \r\n\r\nTrue to my point earlier about databases - to treat them as the north star here . There is a common technique called \"Supplemental logging\" where the database proactively adds extra fields (i.e before image of a record) to the redo log, to avoid this overhead for CDC logs. https://docs.oracle.com/database/121/SUTIL/GUID-D2DDD67C-E1CC-45A6-A2A7-198E4C142FA3.htm#SUTIL1583 . We can consider implementing something like this for MOR tables (which has an extensible data block format), to reduce this overhead of joining for CDC reads. COW tables, may not be able do this per see (or may be by introducing a new _hoodie_before field that contains the entire previous row image). @YannByron I am just saying that what you raise can be solved in Option B as well. \r\n\r\nThis is an awesome conversation folks! Glad we have such amazing talent in the community!  Lets work together and finalize this!\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1116735024/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1116735323","html_url":"https://github.com/apache/hudi/issues/5485#issuecomment-1116735323","issue_url":"https://api.github.com/repos/apache/hudi/issues/5485","id":1116735323,"node_id":"IC_kwDOBI7nWM5CkAdb","user":{"login":"yihua","id":2497195,"node_id":"MDQ6VXNlcjI0OTcxOTU=","avatar_url":"https://avatars.githubusercontent.com/u/2497195?v=4","gravatar_id":"","url":"https://api.github.com/users/yihua","html_url":"https://github.com/yihua","followers_url":"https://api.github.com/users/yihua/followers","following_url":"https://api.github.com/users/yihua/following{/other_user}","gists_url":"https://api.github.com/users/yihua/gists{/gist_id}","starred_url":"https://api.github.com/users/yihua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yihua/subscriptions","organizations_url":"https://api.github.com/users/yihua/orgs","repos_url":"https://api.github.com/users/yihua/repos","events_url":"https://api.github.com/users/yihua/events{/privacy}","received_events_url":"https://api.github.com/users/yihua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-03T22:55:32Z","updated_at":"2022-05-03T22:55:32Z","author_association":"CONTRIBUTOR","body":"@leobiscassi no problem.  I agree that the docs can be improved around the key generator and partition field.  If you already have sth in mind, I encourage you to put up a PR on improving the docs.  @bhasudha and I can help review the PR.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1116735323/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1116735679","html_url":"https://github.com/apache/hudi/issues/5485#issuecomment-1116735679","issue_url":"https://api.github.com/repos/apache/hudi/issues/5485","id":1116735679,"node_id":"IC_kwDOBI7nWM5CkAi_","user":{"login":"yihua","id":2497195,"node_id":"MDQ6VXNlcjI0OTcxOTU=","avatar_url":"https://avatars.githubusercontent.com/u/2497195?v=4","gravatar_id":"","url":"https://api.github.com/users/yihua","html_url":"https://github.com/yihua","followers_url":"https://api.github.com/users/yihua/followers","following_url":"https://api.github.com/users/yihua/following{/other_user}","gists_url":"https://api.github.com/users/yihua/gists{/gist_id}","starred_url":"https://api.github.com/users/yihua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yihua/subscriptions","organizations_url":"https://api.github.com/users/yihua/orgs","repos_url":"https://api.github.com/users/yihua/repos","events_url":"https://api.github.com/users/yihua/events{/privacy}","received_events_url":"https://api.github.com/users/yihua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-03T22:56:13Z","updated_at":"2022-05-03T22:56:13Z","author_association":"CONTRIBUTOR","body":"Feel free to close the issue if all good.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1116735679/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1116753207","html_url":"https://github.com/apache/hudi/pull/5366#issuecomment-1116753207","issue_url":"https://api.github.com/repos/apache/hudi/issues/5366","id":1116753207,"node_id":"IC_kwDOBI7nWM5CkE03","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-03T23:22:55Z","updated_at":"2022-05-03T23:22:55Z","author_association":"MEMBER","body":"@bschell is this still WIP ?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1116753207/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1116871276","html_url":"https://github.com/apache/hudi/issues/5485#issuecomment-1116871276","issue_url":"https://api.github.com/repos/apache/hudi/issues/5485","id":1116871276,"node_id":"IC_kwDOBI7nWM5Ckhps","user":{"login":"leobiscassi","id":1977418,"node_id":"MDQ6VXNlcjE5Nzc0MTg=","avatar_url":"https://avatars.githubusercontent.com/u/1977418?v=4","gravatar_id":"","url":"https://api.github.com/users/leobiscassi","html_url":"https://github.com/leobiscassi","followers_url":"https://api.github.com/users/leobiscassi/followers","following_url":"https://api.github.com/users/leobiscassi/following{/other_user}","gists_url":"https://api.github.com/users/leobiscassi/gists{/gist_id}","starred_url":"https://api.github.com/users/leobiscassi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leobiscassi/subscriptions","organizations_url":"https://api.github.com/users/leobiscassi/orgs","repos_url":"https://api.github.com/users/leobiscassi/repos","events_url":"https://api.github.com/users/leobiscassi/events{/privacy}","received_events_url":"https://api.github.com/users/leobiscassi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-04T02:23:56Z","updated_at":"2022-05-04T02:23:56Z","author_association":"NONE","body":"@yihua nice, I'll work on this and submit a PR, thanks. 👍🏽","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1116871276/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1116900488","html_url":"https://github.com/apache/hudi/issues/5281#issuecomment-1116900488","issue_url":"https://api.github.com/repos/apache/hudi/issues/5281","id":1116900488,"node_id":"IC_kwDOBI7nWM5CkoyI","user":{"login":"ksoullpwk","id":6355792,"node_id":"MDQ6VXNlcjYzNTU3OTI=","avatar_url":"https://avatars.githubusercontent.com/u/6355792?v=4","gravatar_id":"","url":"https://api.github.com/users/ksoullpwk","html_url":"https://github.com/ksoullpwk","followers_url":"https://api.github.com/users/ksoullpwk/followers","following_url":"https://api.github.com/users/ksoullpwk/following{/other_user}","gists_url":"https://api.github.com/users/ksoullpwk/gists{/gist_id}","starred_url":"https://api.github.com/users/ksoullpwk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ksoullpwk/subscriptions","organizations_url":"https://api.github.com/users/ksoullpwk/orgs","repos_url":"https://api.github.com/users/ksoullpwk/repos","events_url":"https://api.github.com/users/ksoullpwk/events{/privacy}","received_events_url":"https://api.github.com/users/ksoullpwk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-04T03:49:54Z","updated_at":"2022-05-04T03:49:54Z","author_association":"NONE","body":"My expected scope for this issue is only for the properties file. For the rest part for handling the data, I think it should be done by users.\r\n\r\nThe issue is I didn't know about this hidden file until it was cleaned by life cycle policy. And it takes some time to revert it back (what I did is copying this file from another Hudi table and fix the table properties).\r\n\r\nIf we have no plan to fix it, it might be better to add some warning into the document about life cycle policy might affect your properties file and give them some example settings.\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1116900488/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1116915923","html_url":"https://github.com/apache/hudi/issues/5298#issuecomment-1116915923","issue_url":"https://api.github.com/repos/apache/hudi/issues/5298","id":1116915923,"node_id":"IC_kwDOBI7nWM5CksjT","user":{"login":"rahil-c","id":32500120,"node_id":"MDQ6VXNlcjMyNTAwMTIw","avatar_url":"https://avatars.githubusercontent.com/u/32500120?v=4","gravatar_id":"","url":"https://api.github.com/users/rahil-c","html_url":"https://github.com/rahil-c","followers_url":"https://api.github.com/users/rahil-c/followers","following_url":"https://api.github.com/users/rahil-c/following{/other_user}","gists_url":"https://api.github.com/users/rahil-c/gists{/gist_id}","starred_url":"https://api.github.com/users/rahil-c/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rahil-c/subscriptions","organizations_url":"https://api.github.com/users/rahil-c/orgs","repos_url":"https://api.github.com/users/rahil-c/repos","events_url":"https://api.github.com/users/rahil-c/events{/privacy}","received_events_url":"https://api.github.com/users/rahil-c/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-04T04:27:01Z","updated_at":"2022-05-04T04:27:01Z","author_association":"CONTRIBUTOR","body":"@kasured If you have opened a case with AWS EMR support, we have a backport of the fix for hudi 0.9.0 we can provide you. Let us know so we can close this thread out for now.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1116915923/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1116919671","html_url":"https://github.com/apache/hudi/issues/5484#issuecomment-1116919671","issue_url":"https://api.github.com/repos/apache/hudi/issues/5484","id":1116919671,"node_id":"IC_kwDOBI7nWM5Cktd3","user":{"login":"rahil-c","id":32500120,"node_id":"MDQ6VXNlcjMyNTAwMTIw","avatar_url":"https://avatars.githubusercontent.com/u/32500120?v=4","gravatar_id":"","url":"https://api.github.com/users/rahil-c","html_url":"https://github.com/rahil-c","followers_url":"https://api.github.com/users/rahil-c/followers","following_url":"https://api.github.com/users/rahil-c/following{/other_user}","gists_url":"https://api.github.com/users/rahil-c/gists{/gist_id}","starred_url":"https://api.github.com/users/rahil-c/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rahil-c/subscriptions","organizations_url":"https://api.github.com/users/rahil-c/orgs","repos_url":"https://api.github.com/users/rahil-c/repos","events_url":"https://api.github.com/users/rahil-c/events{/privacy}","received_events_url":"https://api.github.com/users/rahil-c/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-04T04:35:02Z","updated_at":"2022-05-04T04:35:42Z","author_association":"CONTRIBUTOR","body":"Hi @jasondavindev, just curious on your setup of using hudi 0.11 on AWS EMR? The most recently offered version of Hudi on EMR is`0.9.0` https://docs.aws.amazon.com/emr/latest/ReleaseGuide/emr-hudi.html. If you are dropping the hudi jars from open source directly in your EMR env, this is officially not supported since EMR's Hudi will be using internal versions of Hadoop, Spark, Hive as opposed to directly from open source, which can lead to issues.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1116919671/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1116990374","html_url":"https://github.com/apache/hudi/issues/5481#issuecomment-1116990374","issue_url":"https://api.github.com/repos/apache/hudi/issues/5481","id":1116990374,"node_id":"IC_kwDOBI7nWM5Ck-um","user":{"login":"MikeBuh","id":91965061,"node_id":"U_kgDOBXtGhQ","avatar_url":"https://avatars.githubusercontent.com/u/91965061?v=4","gravatar_id":"","url":"https://api.github.com/users/MikeBuh","html_url":"https://github.com/MikeBuh","followers_url":"https://api.github.com/users/MikeBuh/followers","following_url":"https://api.github.com/users/MikeBuh/following{/other_user}","gists_url":"https://api.github.com/users/MikeBuh/gists{/gist_id}","starred_url":"https://api.github.com/users/MikeBuh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MikeBuh/subscriptions","organizations_url":"https://api.github.com/users/MikeBuh/orgs","repos_url":"https://api.github.com/users/MikeBuh/repos","events_url":"https://api.github.com/users/MikeBuh/events{/privacy}","received_events_url":"https://api.github.com/users/MikeBuh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-04T07:04:23Z","updated_at":"2022-05-04T07:04:23Z","author_association":"NONE","body":"Hi @yihua the batches I am trying to load are around 9GB each. For the latest test I have tried to load only 2 of these batches but not even one of them managed to be processed successfully. I tried 2 runs and both failed with the executor running out of memory. \r\n\r\nFor both runs I was using the same Spark resources, with the only difference being the parallelism (both for Spark and Hudi): \r\n\r\n**Common Spark Parameters**\r\n> spark.driver.cores: 5\r\n> spark.driver.memory: 24100m\r\n> spark.driver.memoryOverhead: 2680m\r\n> \r\n> spark.executor.instances: 10\r\n> spark.executor.cores: 5\r\n> spark.executor.memory: 24100m\r\n> spark.executor.memoryOverhead: 2680m\r\n> spark.memory.storageFraction: 0.6\r\n> spark.memory.fraction: 0.7\r\n> \r\n> spark.kryoserializer.buffer.max: 1024m\r\n> \r\n> spark.driver.extraJavaOptions: -Xloggc:/var/log/spark-GClog.log -XX:+PrintGC -XX:+UseG1GC -XX:+UnlockDiagnosticVMOptions -XX:+G1SummarizeConcMark -XX:InitiatingHeapOccupancyPercent=35 -verbose:gc -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:OnOutOfMemoryError='kill -9 %p'\r\n> \r\n> spark.executor.extraJavaOptions: -Xloggc:/var/log/spark-GClog.log -XX:+PrintGC -XX:+UseG1GC -XX:+UnlockDiagnosticVMOptions -XX:+G1SummarizeConcMark -XX:InitiatingHeapOccupancyPercent=35 -verbose:gc -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:OnOutOfMemoryError='kill -9 %p'\r\n\r\n**Run 1 Parallelism** \r\n> spark.default.parallelism: 100\r\n> spark.sql.shuffle.partitions: 100\r\n> hoodie.upsert.shuffle.parallelism: 100\r\n\r\n**Run 2 Parallelism** \r\n> spark.default.parallelism: 250\r\n> spark.sql.shuffle.partitions: 250\r\n> hoodie.upsert.shuffle.parallelism: 250\r\n\r\nFollowing the above and unfortunate persisting failures, might any of the following effect the performance and/or have anything to do with the required resources? \r\n- size of target table: I noticed that reloading the same batches to a near empty table is more successful \r\n- file sizes: maybe having less but larger files in the target table can help when comparing and updating \r\n- compaction and cleanup: if these are heavy operations that need lots of memory then perhaps they can be tweaked \r\n\r\nThanks once again for your reply","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1116990374/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1117242801","html_url":"https://github.com/apache/hudi/issues/5452#issuecomment-1117242801","issue_url":"https://api.github.com/repos/apache/hudi/issues/5452","id":1117242801,"node_id":"IC_kwDOBI7nWM5Cl8Wx","user":{"login":"santoshsb","id":15146609,"node_id":"MDQ6VXNlcjE1MTQ2NjA5","avatar_url":"https://avatars.githubusercontent.com/u/15146609?v=4","gravatar_id":"","url":"https://api.github.com/users/santoshsb","html_url":"https://github.com/santoshsb","followers_url":"https://api.github.com/users/santoshsb/followers","following_url":"https://api.github.com/users/santoshsb/following{/other_user}","gists_url":"https://api.github.com/users/santoshsb/gists{/gist_id}","starred_url":"https://api.github.com/users/santoshsb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/santoshsb/subscriptions","organizations_url":"https://api.github.com/users/santoshsb/orgs","repos_url":"https://api.github.com/users/santoshsb/repos","events_url":"https://api.github.com/users/santoshsb/events{/privacy}","received_events_url":"https://api.github.com/users/santoshsb/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-04T12:15:56Z","updated_at":"2022-05-04T12:17:26Z","author_association":"NONE","body":"@xiarixiaoyao @yihua we currently don't see this issue when we use the following configuration option --conf 'spark.hadoop.parquet.avro.write-old-list-structure=false'. Should be good to close this, though we are facing another issue with nested columns, will raise a different ticket for that ?\r\n\r\nThanks for all the support,\r\nSantosh","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1117242801/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1117254417","html_url":"https://github.com/apache/hudi/issues/5494#issuecomment-1117254417","issue_url":"https://api.github.com/repos/apache/hudi/issues/5494","id":1117254417,"node_id":"IC_kwDOBI7nWM5Cl_MR","user":{"login":"BalaMahesh","id":25053668,"node_id":"MDQ6VXNlcjI1MDUzNjY4","avatar_url":"https://avatars.githubusercontent.com/u/25053668?v=4","gravatar_id":"","url":"https://api.github.com/users/BalaMahesh","html_url":"https://github.com/BalaMahesh","followers_url":"https://api.github.com/users/BalaMahesh/followers","following_url":"https://api.github.com/users/BalaMahesh/following{/other_user}","gists_url":"https://api.github.com/users/BalaMahesh/gists{/gist_id}","starred_url":"https://api.github.com/users/BalaMahesh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BalaMahesh/subscriptions","organizations_url":"https://api.github.com/users/BalaMahesh/orgs","repos_url":"https://api.github.com/users/BalaMahesh/repos","events_url":"https://api.github.com/users/BalaMahesh/events{/privacy}","received_events_url":"https://api.github.com/users/BalaMahesh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-04T12:28:09Z","updated_at":"2022-05-04T12:28:09Z","author_association":"NONE","body":"@yihua @nsivabalan please suggest on this scenario.. where could be the possible issue. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1117254417/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1117269863","html_url":"https://github.com/apache/hudi/issues/5452#issuecomment-1117269863","issue_url":"https://api.github.com/repos/apache/hudi/issues/5452","id":1117269863,"node_id":"IC_kwDOBI7nWM5CmC9n","user":{"login":"santoshsb","id":15146609,"node_id":"MDQ6VXNlcjE1MTQ2NjA5","avatar_url":"https://avatars.githubusercontent.com/u/15146609?v=4","gravatar_id":"","url":"https://api.github.com/users/santoshsb","html_url":"https://github.com/santoshsb","followers_url":"https://api.github.com/users/santoshsb/followers","following_url":"https://api.github.com/users/santoshsb/following{/other_user}","gists_url":"https://api.github.com/users/santoshsb/gists{/gist_id}","starred_url":"https://api.github.com/users/santoshsb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/santoshsb/subscriptions","organizations_url":"https://api.github.com/users/santoshsb/orgs","repos_url":"https://api.github.com/users/santoshsb/repos","events_url":"https://api.github.com/users/santoshsb/events{/privacy}","received_events_url":"https://api.github.com/users/santoshsb/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-04T12:44:56Z","updated_at":"2022-05-04T12:51:05Z","author_association":"NONE","body":"@xiarixiaoyao FYI, the createNewDF code throws the following error \r\n`Caused by: java.lang.RuntimeException: java.lang.String is not a valid external type for schema of array<string>\r\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$SpecificUnsafeProjection.ValidateExternalType_2$(Unknown Source)\r\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$SpecificUnsafeProjection.MapObjects_1$(Unknown Source)\r\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$SpecificUnsafeProjection.createNamedStruct_0_1$(Unknown Source)\r\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$SpecificUnsafeProjection.MapObjects_2$(Unknown Source)\r\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$SpecificUnsafeProjection.writeFields_1_3$(Unknown Source)\r\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$SpecificUnsafeProjection.apply(Unknown Source)\r\n\tat org.apache.spark.sql.catalyst.encoders.ExpressionEncoder$Serializer.apply(ExpressionEncoder.scala:207)`\r\n\r\nWith the following data, Inserted (Schema simplified to highlight the issue),\r\n`{\r\n  \"resourceType\": \"Patient\",\r\n  \"id\": \"beca9a29-49bb-40e4-adff-4dbb4d664972\",\r\n  \"lastUpdated\": \"2022-02-14T15:18:18.90836+05:30\",\r\n  \"source\": \"4a0701fe-5c3b-482b-895d-875fcbd2148a\",\r\n  \"name\": [\r\n    {\r\n      \"use\": \"official\",\r\n      \"family\": \"Keeling57\",\r\n      \"given\": [\r\n        \"Serina556\"\r\n      ],\r\n      \"prefix\": [\r\n        \"Ms.\"\r\n      ]\r\n    }\r\n  ]\r\n}`\r\n\r\nUpdate \r\n`{\r\n  \"resourceType\": \"Patient\",\r\n  \"id\": \"beca9a29-49bb-40e4-adff-4dbb4d664972\",\r\n  \"lastUpdated\": \"2022-02-14T15:18:18.90836+05:30\",\r\n  \"source\": \"4a0701fe-5c3b-482b-895d-875fcbd2148a\",\r\n  \"name\": [\r\n    {\r\n      \"use\": \"official\",\r\n      \"family\": \"Keeling57\",\r\n      \"given\": [\r\n        \"Serina556\"\r\n      ]\r\n    }\r\n  ]\r\n}`\r\n\r\nWhile updating with the second JSON the prefix is missing and based on the createNewDF it should add that column (verified) with null, null is treated as string and the type is array of string ?\r\n\r\nThanks,\r\nSantosh","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1117269863/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1117274636","html_url":"https://github.com/apache/hudi/issues/5484#issuecomment-1117274636","issue_url":"https://api.github.com/repos/apache/hudi/issues/5484","id":1117274636,"node_id":"IC_kwDOBI7nWM5CmEIM","user":{"login":"jasondavindev","id":33331415,"node_id":"MDQ6VXNlcjMzMzMxNDE1","avatar_url":"https://avatars.githubusercontent.com/u/33331415?v=4","gravatar_id":"","url":"https://api.github.com/users/jasondavindev","html_url":"https://github.com/jasondavindev","followers_url":"https://api.github.com/users/jasondavindev/followers","following_url":"https://api.github.com/users/jasondavindev/following{/other_user}","gists_url":"https://api.github.com/users/jasondavindev/gists{/gist_id}","starred_url":"https://api.github.com/users/jasondavindev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasondavindev/subscriptions","organizations_url":"https://api.github.com/users/jasondavindev/orgs","repos_url":"https://api.github.com/users/jasondavindev/repos","events_url":"https://api.github.com/users/jasondavindev/events{/privacy}","received_events_url":"https://api.github.com/users/jasondavindev/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-04T12:49:43Z","updated_at":"2022-05-05T12:32:29Z","author_association":"NONE","body":"Yes, I'm dropping the Hudi jars directly in EMR since 0.10.0 version. In the 0.10.0 version Hudi can read and write to Glue Data Catalog, but after upgrade to 0.11 it can't.\r\nAre there other ways to sync with Glue Data catalog? As mentioned, I tried https://hudi.apache.org/docs/configurations#hoodiemetasyncclienttoolclass but didn't worked.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1117274636/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1117349404","html_url":"https://github.com/apache/hudi/pull/5495#issuecomment-1117349404","issue_url":"https://api.github.com/repos/apache/hudi/issues/5495","id":1117349404,"node_id":"IC_kwDOBI7nWM5CmWYc","user":{"login":"dongkelun","id":13376555,"node_id":"MDQ6VXNlcjEzMzc2NTU1","avatar_url":"https://avatars.githubusercontent.com/u/13376555?v=4","gravatar_id":"","url":"https://api.github.com/users/dongkelun","html_url":"https://github.com/dongkelun","followers_url":"https://api.github.com/users/dongkelun/followers","following_url":"https://api.github.com/users/dongkelun/following{/other_user}","gists_url":"https://api.github.com/users/dongkelun/gists{/gist_id}","starred_url":"https://api.github.com/users/dongkelun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongkelun/subscriptions","organizations_url":"https://api.github.com/users/dongkelun/orgs","repos_url":"https://api.github.com/users/dongkelun/repos","events_url":"https://api.github.com/users/dongkelun/events{/privacy}","received_events_url":"https://api.github.com/users/dongkelun/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-04T13:59:51Z","updated_at":"2022-05-04T13:59:51Z","author_association":"CONTRIBUTOR","body":"@hudi-bot run azure","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1117349404/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1117374695","html_url":"https://github.com/apache/hudi/issues/5451#issuecomment-1117374695","issue_url":"https://api.github.com/repos/apache/hudi/issues/5451","id":1117374695,"node_id":"IC_kwDOBI7nWM5Cmcjn","user":{"login":"jdattani","id":14809344,"node_id":"MDQ6VXNlcjE0ODA5MzQ0","avatar_url":"https://avatars.githubusercontent.com/u/14809344?v=4","gravatar_id":"","url":"https://api.github.com/users/jdattani","html_url":"https://github.com/jdattani","followers_url":"https://api.github.com/users/jdattani/followers","following_url":"https://api.github.com/users/jdattani/following{/other_user}","gists_url":"https://api.github.com/users/jdattani/gists{/gist_id}","starred_url":"https://api.github.com/users/jdattani/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jdattani/subscriptions","organizations_url":"https://api.github.com/users/jdattani/orgs","repos_url":"https://api.github.com/users/jdattani/repos","events_url":"https://api.github.com/users/jdattani/events{/privacy}","received_events_url":"https://api.github.com/users/jdattani/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-04T14:21:31Z","updated_at":"2022-05-04T14:21:31Z","author_association":"NONE","body":"@yihua  @umehrot2 The issue was resolved after defining dynamodb partition key name to \"key\". Thanks for your inputs. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1117374695/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1117404915","html_url":"https://github.com/apache/hudi/pull/5073#issuecomment-1117404915","issue_url":"https://api.github.com/repos/apache/hudi/issues/5073","id":1117404915,"node_id":"IC_kwDOBI7nWM5Cmj7z","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-04T14:40:30Z","updated_at":"2022-05-04T14:40:30Z","author_association":"CONTRIBUTOR","body":"@codope : addressed all comments","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1117404915/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1117554758","html_url":"https://github.com/apache/hudi/pull/5495#issuecomment-1117554758","issue_url":"https://api.github.com/repos/apache/hudi/issues/5495","id":1117554758,"node_id":"IC_kwDOBI7nWM5CnIhG","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-04T16:24:47Z","updated_at":"2022-05-04T16:24:47Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"c61e3471fc94c4928c52bd202d193f1824e506a1\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8419\",\n    \"triggerID\" : \"c61e3471fc94c4928c52bd202d193f1824e506a1\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"f4d769501949a48c8b4247ed817c2746357833eb\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8420\",\n    \"triggerID\" : \"f4d769501949a48c8b4247ed817c2746357833eb\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"f4d769501949a48c8b4247ed817c2746357833eb\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8420\",\n    \"triggerID\" : \"1117349404\",\n    \"triggerType\" : \"MANUAL\"\n  }, {\n    \"hash\" : \"eb986f7d06692d7232aa3b18f49de270855bb628\",\n    \"status\" : \"SUCCESS\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8422\",\n    \"triggerID\" : \"eb986f7d06692d7232aa3b18f49de270855bb628\",\n    \"triggerType\" : \"PUSH\"\n  } ]\n}-->\n## CI report:\n\n* eb986f7d06692d7232aa3b18f49de270855bb628 Azure: [SUCCESS](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8422) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1117554758/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1117590096","html_url":"https://github.com/apache/hudi/pull/5073#issuecomment-1117590096","issue_url":"https://api.github.com/repos/apache/hudi/issues/5073","id":1117590096,"node_id":"IC_kwDOBI7nWM5CnRJQ","user":{"login":"codope","id":16440354,"node_id":"MDQ6VXNlcjE2NDQwMzU0","avatar_url":"https://avatars.githubusercontent.com/u/16440354?v=4","gravatar_id":"","url":"https://api.github.com/users/codope","html_url":"https://github.com/codope","followers_url":"https://api.github.com/users/codope/followers","following_url":"https://api.github.com/users/codope/following{/other_user}","gists_url":"https://api.github.com/users/codope/gists{/gist_id}","starred_url":"https://api.github.com/users/codope/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codope/subscriptions","organizations_url":"https://api.github.com/users/codope/orgs","repos_url":"https://api.github.com/users/codope/repos","events_url":"https://api.github.com/users/codope/events{/privacy}","received_events_url":"https://api.github.com/users/codope/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-04T17:01:06Z","updated_at":"2022-05-04T17:01:06Z","author_association":"MEMBER","body":"Looks like flaky test: `testRollbackWithDeltaAndCompactionCommit`\r\nI don't think this patch affects it, but can you please check it? ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1117590096/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1117657341","html_url":"https://github.com/apache/hudi/issues/4552#issuecomment-1117657341","issue_url":"https://api.github.com/repos/apache/hudi/issues/4552","id":1117657341,"node_id":"IC_kwDOBI7nWM5Cnhj9","user":{"login":"jasondavindev","id":33331415,"node_id":"MDQ6VXNlcjMzMzMxNDE1","avatar_url":"https://avatars.githubusercontent.com/u/33331415?v=4","gravatar_id":"","url":"https://api.github.com/users/jasondavindev","html_url":"https://github.com/jasondavindev","followers_url":"https://api.github.com/users/jasondavindev/followers","following_url":"https://api.github.com/users/jasondavindev/following{/other_user}","gists_url":"https://api.github.com/users/jasondavindev/gists{/gist_id}","starred_url":"https://api.github.com/users/jasondavindev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasondavindev/subscriptions","organizations_url":"https://api.github.com/users/jasondavindev/orgs","repos_url":"https://api.github.com/users/jasondavindev/repos","events_url":"https://api.github.com/users/jasondavindev/events{/privacy}","received_events_url":"https://api.github.com/users/jasondavindev/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-04T18:15:17Z","updated_at":"2022-05-04T18:15:17Z","author_association":"NONE","body":"https://github.com/apache/hudi/issues/5469\r\nThe 0.11.0 version fixed it.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1117657341/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1117987755","html_url":"https://github.com/apache/hudi/issues/5494#issuecomment-1117987755","issue_url":"https://api.github.com/repos/apache/hudi/issues/5494","id":1117987755,"node_id":"IC_kwDOBI7nWM5CoyOr","user":{"login":"alexeykudinkin","id":428277,"node_id":"MDQ6VXNlcjQyODI3Nw==","avatar_url":"https://avatars.githubusercontent.com/u/428277?v=4","gravatar_id":"","url":"https://api.github.com/users/alexeykudinkin","html_url":"https://github.com/alexeykudinkin","followers_url":"https://api.github.com/users/alexeykudinkin/followers","following_url":"https://api.github.com/users/alexeykudinkin/following{/other_user}","gists_url":"https://api.github.com/users/alexeykudinkin/gists{/gist_id}","starred_url":"https://api.github.com/users/alexeykudinkin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexeykudinkin/subscriptions","organizations_url":"https://api.github.com/users/alexeykudinkin/orgs","repos_url":"https://api.github.com/users/alexeykudinkin/repos","events_url":"https://api.github.com/users/alexeykudinkin/events{/privacy}","received_events_url":"https://api.github.com/users/alexeykudinkin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-04T22:20:42Z","updated_at":"2022-05-04T22:20:42Z","author_association":"CONTRIBUTOR","body":"@BalaMahesh i've tried to reproduce this issue using your steps, and i'm not able to -- DeltaStreamer is starting as expected. Can you please provide full Spark Driver log (feel free to strip out all sensitive info from it)?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1117987755/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118079346","html_url":"https://github.com/apache/hudi/issues/5494#issuecomment-1118079346","issue_url":"https://api.github.com/repos/apache/hudi/issues/5494","id":1118079346,"node_id":"IC_kwDOBI7nWM5CpIly","user":{"login":"BalaMahesh","id":25053668,"node_id":"MDQ6VXNlcjI1MDUzNjY4","avatar_url":"https://avatars.githubusercontent.com/u/25053668?v=4","gravatar_id":"","url":"https://api.github.com/users/BalaMahesh","html_url":"https://github.com/BalaMahesh","followers_url":"https://api.github.com/users/BalaMahesh/followers","following_url":"https://api.github.com/users/BalaMahesh/following{/other_user}","gists_url":"https://api.github.com/users/BalaMahesh/gists{/gist_id}","starred_url":"https://api.github.com/users/BalaMahesh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BalaMahesh/subscriptions","organizations_url":"https://api.github.com/users/BalaMahesh/orgs","repos_url":"https://api.github.com/users/BalaMahesh/repos","events_url":"https://api.github.com/users/BalaMahesh/events{/privacy}","received_events_url":"https://api.github.com/users/BalaMahesh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-05T01:23:45Z","updated_at":"2022-05-05T01:23:45Z","author_association":"NONE","body":"@alexeykudinkin  This is the full command and logs\r\n\r\n./spark-submit  --jars packaging/hudi-spark-bundle/target/hudi-spark3.2-bundle_2.12-0.11.0.jar  --class org.apache.hudi.utilities.deltastreamer.HoodieDeltaStreamer packaging/hudi-utilities-slim-bundle/target/hudi-utilities-slim-bundle_2.12-0.11.0.jar --props file:////hudi/properties/gl_started.properties --schemaprovider-class org.apache.hudi.utilities.schema.FilebasedSchemaProvider --source-class org.apache.hudi.utilities.sources.JsonKafkaSource --target-base-path gs://xx/hudi/gl_cow/ --target-table hudi.gl_cow --op INSERT --table-type COPY_ON_WRITE --source-ordering-field time --continuous  --transformer-class org.apache.hudi.utilities.transform.AddDateHourColumnTransformer --source-limit 150\r\n```\r\n22/05/04 10:21:25 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable\r\nlog4j:WARN No appenders could be found for logger (org.apache.hudi.utilities.deltastreamer.SchedulerConfGenerator).\r\nlog4j:WARN Please initialize the log4j system properly.\r\nlog4j:WARN See http://logging.apache.org/log4j/1.2/faq.html#noconfig for more info.\r\nUsing Spark's default log4j profile: org/apache/spark/log4j-defaults.properties\r\n22/05/04 10:21:26 INFO SparkContext: Running Spark version 3.2.1\r\n22/05/04 10:21:26 INFO ResourceUtils: ==============================================================\r\n22/05/04 10:21:26 INFO ResourceUtils: No custom resources configured for spark.driver.\r\n22/05/04 10:21:26 INFO ResourceUtils: ==============================================================\r\n22/05/04 10:21:26 INFO SparkContext: Submitted application: delta-streamer-hudi.gl_cow\r\n22/05/04 10:21:26 INFO ResourceProfile: Default ResourceProfile created, executor resources: Map(cores -> name: cores, amount: 1, script: , vendor: , memory -> name: memory, amount: 1024, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)\r\n22/05/04 10:21:26 INFO ResourceProfile: Limiting resource is cpu\r\n22/05/04 10:21:26 INFO ResourceProfileManager: Added ResourceProfile id: 0\r\n22/05/04 10:21:26 INFO SecurityManager: Changing view acls to: xx\r\n22/05/04 10:21:26 INFO SecurityManager: Changing modify acls to: xx\r\n22/05/04 10:21:26 INFO SecurityManager: Changing view acls groups to: \r\n22/05/04 10:21:26 INFO SecurityManager: Changing modify acls groups to: \r\n22/05/04 10:21:26 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(xx); groups with view permissions: Set(); users  with modify permissions: Set(xx); groups with modify permissions: Set()\r\n22/05/04 10:21:26 INFO deprecation: mapred.output.compression.codec is deprecated. Instead, use mapreduce.output.fileoutputformat.compress.codec\r\n22/05/04 10:21:26 INFO deprecation: mapred.output.compress is deprecated. Instead, use mapreduce.output.fileoutputformat.compress\r\n22/05/04 10:21:26 INFO deprecation: mapred.output.compression.type is deprecated. Instead, use mapreduce.output.fileoutputformat.compress.type\r\n22/05/04 10:21:26 INFO Utils: Successfully started service 'sparkDriver' on port 49423.\r\n22/05/04 10:21:26 INFO SparkEnv: Registering MapOutputTracker\r\n22/05/04 10:21:26 INFO SparkEnv: Registering BlockManagerMaster\r\n22/05/04 10:21:26 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information\r\n22/05/04 10:21:26 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up\r\n22/05/04 10:21:26 INFO SparkEnv: Registering BlockManagerMasterHeartbeat\r\n22/05/04 10:21:26 INFO DiskBlockManager: Created local directory at /private/var/folders/6w/4y9hyhmj4d15hdqlnd74rp5c0000gp/T/blockmgr-2c16d6dd-7a31-44da-b728-bc8bfe8c11e7\r\n22/05/04 10:21:26 INFO MemoryStore: MemoryStore started with capacity 366.3 MiB\r\n22/05/04 10:21:26 INFO SparkEnv: Registering OutputCommitCoordinator\r\n22/05/04 10:21:27 INFO Utils: Successfully started service 'SparkUI' on port 8090.\r\n22/05/04 10:21:27 INFO SparkUI: Bound SparkUI to 0.0.0.0, and started at http://xx-x0-2:8090\r\n22/05/04 10:21:27 INFO SparkContext: Added JAR file://packaging/hudi-spark-bundle/target/hudi-spark3.2-bundle_2.12-0.11.0.jar at spark://xxx-x0-2:49423/jars/hudi-spark3.2-bundle_2.12-0.11.0.jar with timestamp 1651639886168\r\n22/05/04 10:21:27 INFO SparkContext: Added JAR file:packaging/hudi-utilities-slim-bundle/target/hudi-utilities-slim-bundle_2.12-0.11.0.jar at spark://xx-x0-2:49423/jars/hudi-utilities-slim-bundle_2.12-0.11.0.jar with timestamp 1651639886168\r\n22/05/04 10:21:27 INFO Executor: Starting executor ID driver on host xx-x0-2\r\n22/05/04 10:21:27 INFO Executor: Fetching spark://xx-x0-2:49423/jars/hudi-spark3.2-bundle_2.12-0.11.0.jar with timestamp 1651639886168\r\n22/05/04 10:21:27 INFO TransportClientFactory: Successfully created connection to xx-x0-2/192.168.0.188:49423 after 36 ms (0 ms spent in bootstraps)\r\n22/05/04 10:21:27 INFO Utils: Fetching spark://xx-x0-2:49423/jars/hudi-spark3.2-bundle_2.12-0.11.0.jar to /private/var/folders/6w/4y9hyhmj4d15hdqlnd74rp5c0000gp/T/spark-0552e0b7-1da6-4a5e-b1a7-3e440743cddb/userFiles-f4a62876-1c52-41f9-91e9-a0a8efa42b86/fetchFileTemp2640123694101165597.tmp\r\n22/05/04 10:21:27 INFO Executor: Adding file:/private/var/folders/6w/4y9hyhmj4d15hdqlnd74rp5c0000gp/T/spark-0552e0b7-1da6-4a5e-b1a7-3e440743cddb/userFiles-f4a62876-1c52-41f9-91e9-a0a8efa42b86/hudi-spark3.2-bundle_2.12-0.11.0.jar to class loader\r\n22/05/04 10:21:27 INFO Executor: Fetching spark://xx-x0-2:49423/jars/hudi-utilities-slim-bundle_2.12-0.11.0.jar with timestamp 1651639886168\r\n22/05/04 10:21:27 INFO Utils: Fetching spark://xx-x0-2:49423/jars/hudi-utilities-slim-bundle_2.12-0.11.0.jar to /private/var/folders/6w/4y9hyhmj4d15hdqlnd74rp5c0000gp/T/spark-0552e0b7-1da6-4a5e-b1a7-3e440743cddb/userFiles-f4a62876-1c52-41f9-91e9-a0a8efa42b86/fetchFileTemp7928452199573881385.tmp\r\n22/05/04 10:21:27 INFO Executor: Adding file:/private/var/folders/6w/4y9hyhmj4d15hdqlnd74rp5c0000gp/T/spark-0552e0b7-1da6-4a5e-b1a7-3e440743cddb/userFiles-f4a62876-1c52-41f9-91e9-a0a8efa42b86/hudi-utilities-slim-bundle_2.12-0.11.0.jar to class loader\r\n22/05/04 10:21:27 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 49425.\r\n22/05/04 10:21:27 INFO NettyBlockTransferService: Server created on xx-x0-2:49425\r\n22/05/04 10:21:27 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy\r\n22/05/04 10:21:28 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, xx-x0-2, 49425, None)\r\n22/05/04 10:21:28 INFO BlockManagerMasterEndpoint: Registering block manager xx-x0-2:49425 with 366.3 MiB RAM, BlockManagerId(driver, xx-x0-2, 49425, None)\r\n22/05/04 10:21:28 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, xx-x0-2, 49425, None)\r\n22/05/04 10:21:28 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, xx-x0-2, 49425, None)\r\n22/05/04 10:21:28 WARN DFSPropertiesConfiguration: Cannot find HUDI_CONF_DIR, please set it as the dir of hudi-defaults.conf\r\n22/05/04 10:21:28 WARN DFSPropertiesConfiguration: Properties file file:/etc/hudi/conf/hudi-defaults.conf not found. Ignoring to load props file\r\n22/05/04 10:21:34 INFO SparkUI: Stopped Spark web UI at http://xx-x0-2:8090\r\n22/05/04 10:21:34 INFO MapOutputTrackerMasterEndpoint: MapOutputTrackerMasterEndpoint stopped!\r\n22/05/04 10:21:34 INFO MemoryStore: MemoryStore cleared\r\n22/05/04 10:21:34 INFO BlockManager: BlockManager stopped\r\n22/05/04 10:21:34 INFO BlockManagerMaster: BlockManagerMaster stopped\r\n22/05/04 10:21:34 INFO OutputCommitCoordinator$OutputCommitCoordinatorEndpoint: OutputCommitCoordinator stopped!\r\n22/05/04 10:21:34 INFO SparkContext: Successfully stopped SparkContext\r\nException in thread \"main\" java.lang.NoSuchFieldError: DROP_PARTITION_COLUMNS\r\n\tat org.apache.hudi.DataSourceWriteOptions$.<init>(DataSourceOptions.scala:488)\r\n\tat org.apache.hudi.DataSourceWriteOptions$.<clinit>(DataSourceOptions.scala)\r\n\tat org.apache.hudi.DataSourceWriteOptions.RECONCILE_SCHEMA(DataSourceOptions.scala)\r\n\tat org.apache.hudi.utilities.deltastreamer.HoodieDeltaStreamer.combineProperties(HoodieDeltaStreamer.java:160)\r\n\tat org.apache.hudi.utilities.deltastreamer.HoodieDeltaStreamer.<init>(HoodieDeltaStreamer.java:130)\r\n\tat org.apache.hudi.utilities.deltastreamer.HoodieDeltaStreamer.<init>(HoodieDeltaStreamer.java:115)\r\n\tat org.apache.hudi.utilities.deltastreamer.HoodieDeltaStreamer.main(HoodieDeltaStreamer.java:549)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.lang.reflect.Method.invoke(Method.java:498)\r\n\tat org.apache.spark.deploy.JavaMainApplication.start(SparkApplication.scala:52)\r\n\tat org.apache.spark.deploy.SparkSubmit.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:955)\r\n\tat org.apache.spark.deploy.SparkSubmit.doRunMain$1(SparkSubmit.scala:180)\r\n\tat org.apache.spark.deploy.SparkSubmit.submit(SparkSubmit.scala:203)\r\n\tat org.apache.spark.deploy.SparkSubmit.doSubmit(SparkSubmit.scala:90)\r\n\tat org.apache.spark.deploy.SparkSubmit$$anon$2.doSubmit(SparkSubmit.scala:1043)\r\n\tat org.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:1052)\r\n\tat org.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)\r\n22/05/04 10:21:34 INFO ShutdownHookManager: Shutdown hook called\r\n22/05/04 10:21:34 INFO ShutdownHookManager: Deleting directory /private/var/folders/6w/4y9hyhmj4d15hdqlnd74rp5c0000gp/T/spark-629bf96a-39b1-4764-9c9b-8a3075506818\r\n22/05/04 10:21:34 INFO ShutdownHookManager: Deleting directory /private/var/folders/6w/4y9hyhmj4d15hdqlnd74rp5c0000gp/T/spark-0552e0b7-1da6-4a5e-b1a7-3e440743cddb\r\n```","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118079346/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118084714","html_url":"https://github.com/apache/hudi/issues/5494#issuecomment-1118084714","issue_url":"https://api.github.com/repos/apache/hudi/issues/5494","id":1118084714,"node_id":"IC_kwDOBI7nWM5CpJ5q","user":{"login":"BalaMahesh","id":25053668,"node_id":"MDQ6VXNlcjI1MDUzNjY4","avatar_url":"https://avatars.githubusercontent.com/u/25053668?v=4","gravatar_id":"","url":"https://api.github.com/users/BalaMahesh","html_url":"https://github.com/BalaMahesh","followers_url":"https://api.github.com/users/BalaMahesh/followers","following_url":"https://api.github.com/users/BalaMahesh/following{/other_user}","gists_url":"https://api.github.com/users/BalaMahesh/gists{/gist_id}","starred_url":"https://api.github.com/users/BalaMahesh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BalaMahesh/subscriptions","organizations_url":"https://api.github.com/users/BalaMahesh/orgs","repos_url":"https://api.github.com/users/BalaMahesh/repos","events_url":"https://api.github.com/users/BalaMahesh/events{/privacy}","received_events_url":"https://api.github.com/users/BalaMahesh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-05T01:36:15Z","updated_at":"2022-05-05T01:36:15Z","author_association":"NONE","body":"I am trying to run 0.11.0 with the same config used for 0.10.1. Earlier it used to be hudi-utilities-bundle that we run, but now it is changed to hudi-utilities-slim-bundle along with hudi-sparkx.y-bundle . Somewhere the code recompilation/library versions are screwed is what I am feeling. But it is giving me hard time to figure that out.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118084714/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118100800","html_url":"https://github.com/apache/hudi/issues/5452#issuecomment-1118100800","issue_url":"https://api.github.com/repos/apache/hudi/issues/5452","id":1118100800,"node_id":"IC_kwDOBI7nWM5CpN1A","user":{"login":"xiarixiaoyao","id":13514703,"node_id":"MDQ6VXNlcjEzNTE0NzAz","avatar_url":"https://avatars.githubusercontent.com/u/13514703?v=4","gravatar_id":"","url":"https://api.github.com/users/xiarixiaoyao","html_url":"https://github.com/xiarixiaoyao","followers_url":"https://api.github.com/users/xiarixiaoyao/followers","following_url":"https://api.github.com/users/xiarixiaoyao/following{/other_user}","gists_url":"https://api.github.com/users/xiarixiaoyao/gists{/gist_id}","starred_url":"https://api.github.com/users/xiarixiaoyao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xiarixiaoyao/subscriptions","organizations_url":"https://api.github.com/users/xiarixiaoyao/orgs","repos_url":"https://api.github.com/users/xiarixiaoyao/repos","events_url":"https://api.github.com/users/xiarixiaoyao/events{/privacy}","received_events_url":"https://api.github.com/users/xiarixiaoyao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-05T02:14:51Z","updated_at":"2022-05-05T02:14:51Z","author_association":"CONTRIBUTOR","body":"@santoshsb \r\ncreateNewDF  cannot support rewrite DataFrame with nested schema change.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118100800/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118106033","html_url":"https://github.com/apache/hudi/issues/5494#issuecomment-1118106033","issue_url":"https://api.github.com/repos/apache/hudi/issues/5494","id":1118106033,"node_id":"IC_kwDOBI7nWM5CpPGx","user":{"login":"BalaMahesh","id":25053668,"node_id":"MDQ6VXNlcjI1MDUzNjY4","avatar_url":"https://avatars.githubusercontent.com/u/25053668?v=4","gravatar_id":"","url":"https://api.github.com/users/BalaMahesh","html_url":"https://github.com/BalaMahesh","followers_url":"https://api.github.com/users/BalaMahesh/followers","following_url":"https://api.github.com/users/BalaMahesh/following{/other_user}","gists_url":"https://api.github.com/users/BalaMahesh/gists{/gist_id}","starred_url":"https://api.github.com/users/BalaMahesh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BalaMahesh/subscriptions","organizations_url":"https://api.github.com/users/BalaMahesh/orgs","repos_url":"https://api.github.com/users/BalaMahesh/repos","events_url":"https://api.github.com/users/BalaMahesh/events{/privacy}","received_events_url":"https://api.github.com/users/BalaMahesh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-05T02:27:34Z","updated_at":"2022-05-05T02:27:34Z","author_association":"NONE","body":"@alexeykudinkin.  Apologies for the trouble, I accidentally placed hudi-hadoop-mr-bundle-0.10.1.jar in my spark class path earlier and HoodieTableConfig is being picked from that location and not able to find latest compiled class. I am closing this issue. Thanks for the your comments.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118106033/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118113422","html_url":"https://github.com/apache/hudi/pull/5498#issuecomment-1118113422","issue_url":"https://api.github.com/repos/apache/hudi/issues/5498","id":1118113422,"node_id":"IC_kwDOBI7nWM5CpQ6O","user":{"login":"qianchutao","id":72595723,"node_id":"MDQ6VXNlcjcyNTk1NzIz","avatar_url":"https://avatars.githubusercontent.com/u/72595723?v=4","gravatar_id":"","url":"https://api.github.com/users/qianchutao","html_url":"https://github.com/qianchutao","followers_url":"https://api.github.com/users/qianchutao/followers","following_url":"https://api.github.com/users/qianchutao/following{/other_user}","gists_url":"https://api.github.com/users/qianchutao/gists{/gist_id}","starred_url":"https://api.github.com/users/qianchutao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/qianchutao/subscriptions","organizations_url":"https://api.github.com/users/qianchutao/orgs","repos_url":"https://api.github.com/users/qianchutao/repos","events_url":"https://api.github.com/users/qianchutao/events{/privacy}","received_events_url":"https://api.github.com/users/qianchutao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-05T02:46:57Z","updated_at":"2022-05-05T02:46:57Z","author_association":"CONTRIBUTOR","body":"@hudi-bot run azure","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118113422/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118113743","html_url":"https://github.com/apache/hudi/pull/5498#issuecomment-1118113743","issue_url":"https://api.github.com/repos/apache/hudi/issues/5498","id":1118113743,"node_id":"IC_kwDOBI7nWM5CpQ_P","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-05T02:47:56Z","updated_at":"2022-05-05T02:47:56Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"14b72be4bb7c82f23a29957a1ad0c7a09d438bda\",\n    \"status\" : \"PENDING\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8430\",\n    \"triggerID\" : \"14b72be4bb7c82f23a29957a1ad0c7a09d438bda\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"14b72be4bb7c82f23a29957a1ad0c7a09d438bda\",\n    \"status\" : \"UNKNOWN\",\n    \"url\" : \"TBD\",\n    \"triggerID\" : \"1118113422\",\n    \"triggerType\" : \"MANUAL\"\n  } ]\n}-->\n## CI report:\n\n* 14b72be4bb7c82f23a29957a1ad0c7a09d438bda Azure: [PENDING](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8430) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118113743/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118177780","html_url":"https://github.com/apache/hudi/issues/5500#issuecomment-1118177780","issue_url":"https://api.github.com/repos/apache/hudi/issues/5500","id":1118177780,"node_id":"IC_kwDOBI7nWM5Cpgn0","user":{"login":"wf19970425","id":48647300,"node_id":"MDQ6VXNlcjQ4NjQ3MzAw","avatar_url":"https://avatars.githubusercontent.com/u/48647300?v=4","gravatar_id":"","url":"https://api.github.com/users/wf19970425","html_url":"https://github.com/wf19970425","followers_url":"https://api.github.com/users/wf19970425/followers","following_url":"https://api.github.com/users/wf19970425/following{/other_user}","gists_url":"https://api.github.com/users/wf19970425/gists{/gist_id}","starred_url":"https://api.github.com/users/wf19970425/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wf19970425/subscriptions","organizations_url":"https://api.github.com/users/wf19970425/orgs","repos_url":"https://api.github.com/users/wf19970425/repos","events_url":"https://api.github.com/users/wf19970425/events{/privacy}","received_events_url":"https://api.github.com/users/wf19970425/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-05T05:09:29Z","updated_at":"2022-05-05T05:09:29Z","author_association":"NONE","body":"If metadata table is enabled, the scanning time will increase.  Is that reasonable?  ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118177780/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118203393","html_url":"https://github.com/apache/hudi/issues/5382#issuecomment-1118203393","issue_url":"https://api.github.com/repos/apache/hudi/issues/5382","id":1118203393,"node_id":"IC_kwDOBI7nWM5Cpm4B","user":{"login":"danny0405","id":7644508,"node_id":"MDQ6VXNlcjc2NDQ1MDg=","avatar_url":"https://avatars.githubusercontent.com/u/7644508?v=4","gravatar_id":"","url":"https://api.github.com/users/danny0405","html_url":"https://github.com/danny0405","followers_url":"https://api.github.com/users/danny0405/followers","following_url":"https://api.github.com/users/danny0405/following{/other_user}","gists_url":"https://api.github.com/users/danny0405/gists{/gist_id}","starred_url":"https://api.github.com/users/danny0405/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danny0405/subscriptions","organizations_url":"https://api.github.com/users/danny0405/orgs","repos_url":"https://api.github.com/users/danny0405/repos","events_url":"https://api.github.com/users/danny0405/events{/privacy}","received_events_url":"https://api.github.com/users/danny0405/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-05T06:04:52Z","updated_at":"2022-05-05T06:04:52Z","author_association":"CONTRIBUTOR","body":"Can you show the create table descriptor in Hive CLI to see the table input format ? What input format does the table use ?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118203393/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118216623","html_url":"https://github.com/apache/hudi/pull/5078#issuecomment-1118216623","issue_url":"https://api.github.com/repos/apache/hudi/issues/5078","id":1118216623,"node_id":"IC_kwDOBI7nWM5CpqGv","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-05T06:26:48Z","updated_at":"2022-05-05T06:26:48Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"b52f52d1db2656d600026961c52fac6f865743fa\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=7110\",\n    \"triggerID\" : \"b52f52d1db2656d600026961c52fac6f865743fa\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"9fac106587c2652d77d4753875e8759952781a55\",\n    \"status\" : \"UNKNOWN\",\n    \"url\" : \"TBD\",\n    \"triggerID\" : \"9fac106587c2652d77d4753875e8759952781a55\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"3d3442f90adbe39157fe55a215b60dacfbb1d2ca\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=7111\",\n    \"triggerID\" : \"3d3442f90adbe39157fe55a215b60dacfbb1d2ca\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"08d86460efaf9ab648ecdd50a1cf3c8087ac1786\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=7115\",\n    \"triggerID\" : \"08d86460efaf9ab648ecdd50a1cf3c8087ac1786\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"87a5cf42e33fa9ba33475da02bbcd88db1386c20\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=7312\",\n    \"triggerID\" : \"87a5cf42e33fa9ba33475da02bbcd88db1386c20\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"5078d29eb429d7eca46c3d5c3aa72d94e088d43e\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8068\",\n    \"triggerID\" : \"5078d29eb429d7eca46c3d5c3aa72d94e088d43e\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"30f755ce655f7f7da22b80526f6c9ad7aabbcbf4\",\n    \"status\" : \"SUCCESS\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8431\",\n    \"triggerID\" : \"30f755ce655f7f7da22b80526f6c9ad7aabbcbf4\",\n    \"triggerType\" : \"PUSH\"\n  } ]\n}-->\n## CI report:\n\n* 9fac106587c2652d77d4753875e8759952781a55 UNKNOWN\n* 30f755ce655f7f7da22b80526f6c9ad7aabbcbf4 Azure: [SUCCESS](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8431) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118216623/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118217639","html_url":"https://github.com/apache/hudi/issues/5460#issuecomment-1118217639","issue_url":"https://api.github.com/repos/apache/hudi/issues/5460","id":1118217639,"node_id":"IC_kwDOBI7nWM5CpqWn","user":{"login":"zhilinli123","id":76689593,"node_id":"MDQ6VXNlcjc2Njg5NTkz","avatar_url":"https://avatars.githubusercontent.com/u/76689593?v=4","gravatar_id":"","url":"https://api.github.com/users/zhilinli123","html_url":"https://github.com/zhilinli123","followers_url":"https://api.github.com/users/zhilinli123/followers","following_url":"https://api.github.com/users/zhilinli123/following{/other_user}","gists_url":"https://api.github.com/users/zhilinli123/gists{/gist_id}","starred_url":"https://api.github.com/users/zhilinli123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhilinli123/subscriptions","organizations_url":"https://api.github.com/users/zhilinli123/orgs","repos_url":"https://api.github.com/users/zhilinli123/repos","events_url":"https://api.github.com/users/zhilinli123/events{/privacy}","received_events_url":"https://api.github.com/users/zhilinli123/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-05T06:28:54Z","updated_at":"2022-05-05T06:28:54Z","author_association":"NONE","body":" \r\n<img width=\"1884\" alt=\"image\" src=\"https://user-images.githubusercontent.com/76689593/166872145-73004006-f46d-4b93-a646-2b234604cbb5.png\">\r\n[20220505133151119.tar.gz](https://github.com/apache/hudi/files/8629071/20220505133151119.tar.gz)\r\n[temp.tar.gz](https://github.com/apache/hudi/files/8629072/temp.tar.gz)\r\n@yihua @danny0405  You guys, I've downloaded the timeline 20220505133151119. Does that help?\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118217639/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118248202","html_url":"https://github.com/apache/hudi/issues/5382#issuecomment-1118248202","issue_url":"https://api.github.com/repos/apache/hudi/issues/5382","id":1118248202,"node_id":"IC_kwDOBI7nWM5Cpx0K","user":{"login":"lihuahui5683","id":31878723,"node_id":"MDQ6VXNlcjMxODc4NzIz","avatar_url":"https://avatars.githubusercontent.com/u/31878723?v=4","gravatar_id":"","url":"https://api.github.com/users/lihuahui5683","html_url":"https://github.com/lihuahui5683","followers_url":"https://api.github.com/users/lihuahui5683/followers","following_url":"https://api.github.com/users/lihuahui5683/following{/other_user}","gists_url":"https://api.github.com/users/lihuahui5683/gists{/gist_id}","starred_url":"https://api.github.com/users/lihuahui5683/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lihuahui5683/subscriptions","organizations_url":"https://api.github.com/users/lihuahui5683/orgs","repos_url":"https://api.github.com/users/lihuahui5683/repos","events_url":"https://api.github.com/users/lihuahui5683/events{/privacy}","received_events_url":"https://api.github.com/users/lihuahui5683/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-05T07:23:40Z","updated_at":"2022-05-05T07:23:40Z","author_association":"NONE","body":"```sql\r\nCREATE EXTERNAL TABLE `role_sync_hive_rt`(\r\n   `_hoodie_commit_time` string COMMENT '',\r\n   `_hoodie_commit_seqno` string COMMENT '',\r\n   `_hoodie_record_key` string COMMENT '',\r\n   `_hoodie_partition_path` string COMMENT '',\r\n   `_hoodie_file_name` string COMMENT '',\r\n   `_hoodie_operation` string COMMENT '',\r\n   `channel_id` bigint COMMENT '',\r\n   `org_game_id` string COMMENT '',\r\n   `pf` int COMMENT '',\r\n   `org_server_id` string COMMENT '',  \r\n   `org_user_id` string COMMENT '',\r\n   `org_role_id` string COMMENT '',\r\n   `role_name` string COMMENT '',\r\n   `role_lvl` int COMMENT '',\r\n   `vip_lvl` int COMMENT '',\r\n   `role_strength` bigint COMMENT '', \r\n   `role_create_time` bigint COMMENT '',\r\n   `first_pay_lvl` int COMMENT '',\r\n   `first_pay_date` bigint COMMENT '', \r\n   `pay_money` decimal(10,2) COMMENT '',\r\n   `pay_num` bigint COMMENT '',\r\n   `last_pay_date` bigint COMMENT '', \r\n   `last_login_date` bigint COMMENT '')\r\n PARTITIONED BY (\r\n   `dt` string COMMENT '')\r\n ROW FORMAT SERDE\r\n   'org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe'\r\n WITH SERDEPROPERTIES (\r\n   'hoodie.query.as.ro.table'='false',\r\n   'path'='hdfs://dalan/hudi/role_sync_hive')\r\n STORED AS INPUTFORMAT\r\n   'org.apache.hudi.hadoop.realtime.HoodieParquetRealtimeInputFormat'\r\n OUTPUTFORMAT\r\n   'org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat'\r\n LOCATION\r\n   'hdfs://dalan/hudi/role_sync_hive' \r\n TBLPROPERTIES (\r\n   'last_commit_time_sync'='20220505150827925',\r\n   'spark.sql.sources.provider'='hudi',\r\n   'spark.sql.sources.schema.numPartCols'='1',\r\n   'spark.sql.sources.schema.numParts'='1',\r\n   'spark.sql.sources.schema.part.0'='{\"type\":\"struct\",\"fields\":[{\"name\":\"_hoodie_commit_time\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"_hoodie_commit_seqno\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"_hoodie_record_key\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"_hoodie_partition_path\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"_hoodie_file_name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"_hoodie_operation\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"channel_id\",\"type\":\"long\",\"nullable\":false,\"metadata\":{}},{\"name\":\"org_game_id\",\"type\":\"string\",\"nullable\":false,\"metadata\":{}},{\"name\":\"pf\",\"type\":\"integer\",\"nullable\":false,\"metadata\":{}},{\"name\":\"org_server_id\",\"type\":\"string\",\"nullable\":false,\"metadata\":{}},{\"name\":\"org_user_id\",\"type\":\"string\",\"nullable\":false,\"metadata\":{}},{\"name\":\"org_role_id\",\"type\":\"string\",\"nullable\":false,\"metadata\":{}},{\"name\":\"role_name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"role_lvl\",\"type\":\"integer\",\"nullable\":true,\"metadata\":{}},{\"name\":\"vip_lvl\",\"type\":\"integer\",\"nullable\":true,\"metadata\":{}},{\"name\":\"role_strength\",\"type\":\"long\",\"nullable\":true,\"metadata\":{}},{\"name\":\"role_create_time\",\"type\":\"timestamp\",\"nullable\":true,\"metadata\":{}},{\"name\":\"first_pay_lvl\",\"type\":\"integer\",\"nullable\":true,\"metadata\":{}},{\"name\":\"first_pay_date\",\"type\":\"long\",\"nullable\":true,\"metadata\":{}},{\"name\":\"pay_money\",\"type\":\"decimal(10,2)\",\"nullable\":true,\"metadata\":{}},{\"name\":\"pay_num\",\"type\":\"long\",\"nullable\":true,\"metadata\":{}},{\"name\":\"last_pay_date\",\"type\":\"long\",\"nullable\":true,\"metadata\":{}},{\"name\":\"last_login_date\",\"type\":\"long\",\"nullable\":true,\"metadata\":{}},{\"name\":\"dt\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]}',\r\n   'spark.sql.sources.schema.partCol.0'='dt',\r\n   'transient_lastDdlTime'='1651734483');\r\n```","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118248202/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118249391","html_url":"https://github.com/apache/hudi/pull/5499#issuecomment-1118249391","issue_url":"https://api.github.com/repos/apache/hudi/issues/5499","id":1118249391,"node_id":"IC_kwDOBI7nWM5CpyGv","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-05T07:25:39Z","updated_at":"2022-05-05T07:25:39Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"3e492e1ade8e33a36fd0c5cf880f17786e6601d3\",\n    \"status\" : \"SUCCESS\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8433\",\n    \"triggerID\" : \"3e492e1ade8e33a36fd0c5cf880f17786e6601d3\",\n    \"triggerType\" : \"PUSH\"\n  } ]\n}-->\n## CI report:\n\n* 3e492e1ade8e33a36fd0c5cf880f17786e6601d3 Azure: [SUCCESS](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8433) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118249391/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118251606","html_url":"https://github.com/apache/hudi/pull/5199#issuecomment-1118251606","issue_url":"https://api.github.com/repos/apache/hudi/issues/5199","id":1118251606,"node_id":"IC_kwDOBI7nWM5CpypW","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-05T07:28:53Z","updated_at":"2022-05-05T07:28:53Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"27e94c1167b9ccf04e5ad97d5f8a29fecfadb516\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8183\",\n    \"triggerID\" : \"27e94c1167b9ccf04e5ad97d5f8a29fecfadb516\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"ae7e668eb24de9605953282172f4b25ff2ca6ee4\",\n    \"status\" : \"SUCCESS\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8432\",\n    \"triggerID\" : \"ae7e668eb24de9605953282172f4b25ff2ca6ee4\",\n    \"triggerType\" : \"PUSH\"\n  } ]\n}-->\n## CI report:\n\n* ae7e668eb24de9605953282172f4b25ff2ca6ee4 Azure: [SUCCESS](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8432) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118251606/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118279137","html_url":"https://github.com/apache/hudi/pull/5199#issuecomment-1118279137","issue_url":"https://api.github.com/repos/apache/hudi/issues/5199","id":1118279137,"node_id":"IC_kwDOBI7nWM5Cp5Xh","user":{"login":"watermelon12138","id":49849410,"node_id":"MDQ6VXNlcjQ5ODQ5NDEw","avatar_url":"https://avatars.githubusercontent.com/u/49849410?v=4","gravatar_id":"","url":"https://api.github.com/users/watermelon12138","html_url":"https://github.com/watermelon12138","followers_url":"https://api.github.com/users/watermelon12138/followers","following_url":"https://api.github.com/users/watermelon12138/following{/other_user}","gists_url":"https://api.github.com/users/watermelon12138/gists{/gist_id}","starred_url":"https://api.github.com/users/watermelon12138/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/watermelon12138/subscriptions","organizations_url":"https://api.github.com/users/watermelon12138/orgs","repos_url":"https://api.github.com/users/watermelon12138/repos","events_url":"https://api.github.com/users/watermelon12138/events{/privacy}","received_events_url":"https://api.github.com/users/watermelon12138/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-05T08:05:18Z","updated_at":"2022-05-05T08:05:18Z","author_association":"CONTRIBUTOR","body":"> @watermelon12138 could you check why CI fails?\r\nHello，CI success now，I look forward to your review of my code，Thanks.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118279137/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118279865","html_url":"https://github.com/apache/hudi/pull/5199#issuecomment-1118279865","issue_url":"https://api.github.com/repos/apache/hudi/issues/5199","id":1118279865,"node_id":"IC_kwDOBI7nWM5Cp5i5","user":{"login":"watermelon12138","id":49849410,"node_id":"MDQ6VXNlcjQ5ODQ5NDEw","avatar_url":"https://avatars.githubusercontent.com/u/49849410?v=4","gravatar_id":"","url":"https://api.github.com/users/watermelon12138","html_url":"https://github.com/watermelon12138","followers_url":"https://api.github.com/users/watermelon12138/followers","following_url":"https://api.github.com/users/watermelon12138/following{/other_user}","gists_url":"https://api.github.com/users/watermelon12138/gists{/gist_id}","starred_url":"https://api.github.com/users/watermelon12138/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/watermelon12138/subscriptions","organizations_url":"https://api.github.com/users/watermelon12138/orgs","repos_url":"https://api.github.com/users/watermelon12138/repos","events_url":"https://api.github.com/users/watermelon12138/events{/privacy}","received_events_url":"https://api.github.com/users/watermelon12138/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-05T08:06:20Z","updated_at":"2022-05-05T08:06:20Z","author_association":"CONTRIBUTOR","body":"@yihua \r\nHello，CI success now，I look forward to your review of my code，Thanks.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118279865/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118335375","html_url":"https://github.com/apache/hudi/issues/5503#issuecomment-1118335375","issue_url":"https://api.github.com/repos/apache/hudi/issues/5503","id":1118335375,"node_id":"IC_kwDOBI7nWM5CqHGP","user":{"login":"wf19970425","id":48647300,"node_id":"MDQ6VXNlcjQ4NjQ3MzAw","avatar_url":"https://avatars.githubusercontent.com/u/48647300?v=4","gravatar_id":"","url":"https://api.github.com/users/wf19970425","html_url":"https://github.com/wf19970425","followers_url":"https://api.github.com/users/wf19970425/followers","following_url":"https://api.github.com/users/wf19970425/following{/other_user}","gists_url":"https://api.github.com/users/wf19970425/gists{/gist_id}","starred_url":"https://api.github.com/users/wf19970425/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wf19970425/subscriptions","organizations_url":"https://api.github.com/users/wf19970425/orgs","repos_url":"https://api.github.com/users/wf19970425/repos","events_url":"https://api.github.com/users/wf19970425/events{/privacy}","received_events_url":"https://api.github.com/users/wf19970425/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-05T09:09:34Z","updated_at":"2022-05-05T09:09:34Z","author_association":"NONE","body":"I also encountered the same problem, but I met it when Hudi combined with flink to restart. I suspect it is the problem of dependency conflict. My error report is as follows：\r\nCaused by: org.apache.hudi.exception.HoodieUpsertException: Error upsetting bucketType UPDATE for partition :files\r\n\tat org.apache.hudi.table.action.commit.BaseFlinkCommitActionExecutor.handleUpsertPartition(BaseFlinkCommitActionExecutor.java:204)\r\n\tat org.apache.hudi.table.action.commit.BaseFlinkCommitActionExecutor.execute(BaseFlinkCommitActionExecutor.java:108)\r\n\tat org.apache.hudi.table.action.commit.delta.FlinkUpsertPreppedDeltaCommitActionExecutor.execute(FlinkUpsertPreppedDeltaCommitActionExecutor.java:50)\r\n\tat org.apache.hudi.table.HoodieFlinkMergeOnReadTable.upsertPrepped(HoodieFlinkMergeOnReadTable.java:84)\r\n\tat org.apache.hudi.client.HoodieFlinkWriteClient.upsertPreppedRecords(HoodieFlinkWriteClient.java:161)\r\n\tat org.apache.hudi.metadata.FlinkHoodieBackedTableMetadataWriter.commit(FlinkHoodieBackedTableMetadataWriter.java:144)\r\n\tat org.apache.hudi.metadata.HoodieBackedTableMetadataWriter.update(HoodieBackedTableMetadataWriter.java:924)\r\n\tat org.apache.hudi.table.action.BaseActionExecutor.lambda$writeTableMetadata$2(BaseActionExecutor.java:77)\r\n\tat org.apache.hudi.common.util.Option.ifPresent(Option.java:97)\r\n\tat org.apache.hudi.table.action.BaseActionExecutor.writeTableMetadata(BaseActionExecutor.java:77)\r\n\tat org.apache.hudi.table.action.rollback.BaseRollbackActionExecutor.finishRollback(BaseRollbackActionExecutor.java:255)\r\n\tat org.apache.hudi.table.action.rollback.BaseRollbackActionExecutor.runRollback(BaseRollbackActionExecutor.java:124)\r\n\tat org.apache.hudi.table.action.rollback.BaseRollbackActionExecutor.execute(BaseRollbackActionExecutor.java:145)\r\n\tat org.apache.hudi.table.HoodieFlinkMergeOnReadTable.rollback(HoodieFlinkMergeOnReadTable.java:132)\r\n\tat org.apache.hudi.client.BaseHoodieWriteClient.rollback(BaseHoodieWriteClient.java:766)\r\n\t... 12 more\r\nCaused by: java.lang.ExceptionInInitializerError\r\n\tat org.apache.hudi.common.table.log.block.HoodieHFileDataBlock.serializeRecords(HoodieHFileDataBlock.java:141)\r\n\tat org.apache.hudi.common.table.log.block.HoodieDataBlock.getContentBytes(HoodieDataBlock.java:131)\r\n\tat org.apache.hudi.common.table.log.HoodieLogFormatWriter.appendBlocks(HoodieLogFormatWriter.java:162)\r\n\tat org.apache.hudi.io.HoodieAppendHandle.appendDataAndDeleteBlocks(HoodieAppendHandle.java:404)\r\n\tat org.apache.hudi.io.HoodieAppendHandle.doAppend(HoodieAppendHandle.java:382)\r\n\tat org.apache.hudi.table.action.commit.delta.BaseFlinkDeltaCommitActionExecutor.handleUpdate(BaseFlinkDeltaCommitActionExecutor.java:52)\r\n\tat org.apache.hudi.table.action.commit.BaseFlinkCommitActionExecutor.handleUpsertPartition(BaseFlinkCommitActionExecutor.java:196)\r\n\t... 26 more\r\nCaused by: java.lang.RuntimeException: Could not create  interface org.apache.hudi.org.apache.hadoop.hbase.regionserver.MetricsRegionServerSourceFactory Is the hadoop compatibility jar on the classpath?\r\n\tat org.apache.hudi.org.apache.hadoop.hbase.CompatibilitySingletonFactory.getInstance(CompatibilitySingletonFactory.java:75)\r\n\tat org.apache.hudi.org.apache.hadoop.hbase.io.MetricsIO.<init>(MetricsIO.java:32)\r\n\tat org.apache.hudi.org.apache.hadoop.hbase.io.hfile.HFile.<clinit>(HFile.java:176)\r\n\t... 33 more\r\nCaused by: java.util.NoSuchElementException\r\n\tat java.util.ServiceLoader$LazyIterator.nextService(ServiceLoader.java:365)\r\n\tat java.util.ServiceLoader$LazyIterator.next(ServiceLoader.java:404)\r\n\tat java.util.ServiceLoader$1.next(ServiceLoader.java:480)\r\n\tat org.apache.hudi.org.apache.hadoop.hbase.CompatibilitySingletonFactory.getInstance(CompatibilitySingletonFactory.java:61)\r\n\t... 35 more","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118335375/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118336069","html_url":"https://github.com/apache/hudi/issues/5503#issuecomment-1118336069","issue_url":"https://api.github.com/repos/apache/hudi/issues/5503","id":1118336069,"node_id":"IC_kwDOBI7nWM5CqHRF","user":{"login":"wf19970425","id":48647300,"node_id":"MDQ6VXNlcjQ4NjQ3MzAw","avatar_url":"https://avatars.githubusercontent.com/u/48647300?v=4","gravatar_id":"","url":"https://api.github.com/users/wf19970425","html_url":"https://github.com/wf19970425","followers_url":"https://api.github.com/users/wf19970425/followers","following_url":"https://api.github.com/users/wf19970425/following{/other_user}","gists_url":"https://api.github.com/users/wf19970425/gists{/gist_id}","starred_url":"https://api.github.com/users/wf19970425/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wf19970425/subscriptions","organizations_url":"https://api.github.com/users/wf19970425/orgs","repos_url":"https://api.github.com/users/wf19970425/repos","events_url":"https://api.github.com/users/wf19970425/events{/privacy}","received_events_url":"https://api.github.com/users/wf19970425/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-05T09:10:25Z","updated_at":"2022-05-05T09:10:25Z","author_association":"NONE","body":"The metadata tables setting is also enabled\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118336069/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118340000","html_url":"https://github.com/apache/hudi/issues/5382#issuecomment-1118340000","issue_url":"https://api.github.com/repos/apache/hudi/issues/5382","id":1118340000,"node_id":"IC_kwDOBI7nWM5CqIOg","user":{"login":"danny0405","id":7644508,"node_id":"MDQ6VXNlcjc2NDQ1MDg=","avatar_url":"https://avatars.githubusercontent.com/u/7644508?v=4","gravatar_id":"","url":"https://api.github.com/users/danny0405","html_url":"https://github.com/danny0405","followers_url":"https://api.github.com/users/danny0405/followers","following_url":"https://api.github.com/users/danny0405/following{/other_user}","gists_url":"https://api.github.com/users/danny0405/gists{/gist_id}","starred_url":"https://api.github.com/users/danny0405/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danny0405/subscriptions","organizations_url":"https://api.github.com/users/danny0405/orgs","repos_url":"https://api.github.com/users/danny0405/repos","events_url":"https://api.github.com/users/danny0405/events{/privacy}","received_events_url":"https://api.github.com/users/danny0405/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-05T09:15:04Z","updated_at":"2022-05-05T09:15:04Z","author_association":"CONTRIBUTOR","body":"Did you notice that there is chinese document here ? https://www.yuque.com/docs/share/879349ce-7de4-4284-9126-9c2a3c93a91d?#mmgZE\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118340000/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118343711","html_url":"https://github.com/apache/hudi/issues/5500#issuecomment-1118343711","issue_url":"https://api.github.com/repos/apache/hudi/issues/5500","id":1118343711,"node_id":"IC_kwDOBI7nWM5CqJIf","user":{"login":"wf19970425","id":48647300,"node_id":"MDQ6VXNlcjQ4NjQ3MzAw","avatar_url":"https://avatars.githubusercontent.com/u/48647300?v=4","gravatar_id":"","url":"https://api.github.com/users/wf19970425","html_url":"https://github.com/wf19970425","followers_url":"https://api.github.com/users/wf19970425/followers","following_url":"https://api.github.com/users/wf19970425/following{/other_user}","gists_url":"https://api.github.com/users/wf19970425/gists{/gist_id}","starred_url":"https://api.github.com/users/wf19970425/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wf19970425/subscriptions","organizations_url":"https://api.github.com/users/wf19970425/orgs","repos_url":"https://api.github.com/users/wf19970425/repos","events_url":"https://api.github.com/users/wf19970425/events{/privacy}","received_events_url":"https://api.github.com/users/wf19970425/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-05T09:19:40Z","updated_at":"2022-05-05T09:19:40Z","author_association":"NONE","body":"Can you help me?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118343711/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118350373","html_url":"https://github.com/apache/hudi/pull/5506#issuecomment-1118350373","issue_url":"https://api.github.com/repos/apache/hudi/issues/5506","id":1118350373,"node_id":"IC_kwDOBI7nWM5CqKwl","user":{"login":"jinxing64","id":4058918,"node_id":"MDQ6VXNlcjQwNTg5MTg=","avatar_url":"https://avatars.githubusercontent.com/u/4058918?v=4","gravatar_id":"","url":"https://api.github.com/users/jinxing64","html_url":"https://github.com/jinxing64","followers_url":"https://api.github.com/users/jinxing64/followers","following_url":"https://api.github.com/users/jinxing64/following{/other_user}","gists_url":"https://api.github.com/users/jinxing64/gists{/gist_id}","starred_url":"https://api.github.com/users/jinxing64/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jinxing64/subscriptions","organizations_url":"https://api.github.com/users/jinxing64/orgs","repos_url":"https://api.github.com/users/jinxing64/repos","events_url":"https://api.github.com/users/jinxing64/events{/privacy}","received_events_url":"https://api.github.com/users/jinxing64/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-05T09:26:55Z","updated_at":"2022-05-05T09:26:55Z","author_association":"CONTRIBUTOR","body":"Hi @leesf \r\nI touched you code, please give a check when you have time. Thanks a lot !","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118350373/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118384126","html_url":"https://github.com/apache/hudi/issues/5382#issuecomment-1118384126","issue_url":"https://api.github.com/repos/apache/hudi/issues/5382","id":1118384126,"node_id":"IC_kwDOBI7nWM5CqS_-","user":{"login":"lihuahui5683","id":31878723,"node_id":"MDQ6VXNlcjMxODc4NzIz","avatar_url":"https://avatars.githubusercontent.com/u/31878723?v=4","gravatar_id":"","url":"https://api.github.com/users/lihuahui5683","html_url":"https://github.com/lihuahui5683","followers_url":"https://api.github.com/users/lihuahui5683/followers","following_url":"https://api.github.com/users/lihuahui5683/following{/other_user}","gists_url":"https://api.github.com/users/lihuahui5683/gists{/gist_id}","starred_url":"https://api.github.com/users/lihuahui5683/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lihuahui5683/subscriptions","organizations_url":"https://api.github.com/users/lihuahui5683/orgs","repos_url":"https://api.github.com/users/lihuahui5683/repos","events_url":"https://api.github.com/users/lihuahui5683/events{/privacy}","received_events_url":"https://api.github.com/users/lihuahui5683/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-05T10:08:43Z","updated_at":"2022-05-05T10:08:43Z","author_association":"NONE","body":"I have read this document, but I still can't solve this problem. Is it possible that the Hive version is too low?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118384126/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118411526","html_url":"https://github.com/apache/hudi/pull/5464#issuecomment-1118411526","issue_url":"https://api.github.com/repos/apache/hudi/issues/5464","id":1118411526,"node_id":"IC_kwDOBI7nWM5CqZsG","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-05T10:45:17Z","updated_at":"2022-05-05T10:45:17Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"578d03bf52a55c34f5f162728db64ab3c6cf129e\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8387\",\n    \"triggerID\" : \"578d03bf52a55c34f5f162728db64ab3c6cf129e\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"636d10e4d61c76f04dae08da247651fcd019b7ad\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8436\",\n    \"triggerID\" : \"636d10e4d61c76f04dae08da247651fcd019b7ad\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"523c84e2eae12e127b2be09be70cabe87984f603\",\n    \"status\" : \"SUCCESS\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8439\",\n    \"triggerID\" : \"523c84e2eae12e127b2be09be70cabe87984f603\",\n    \"triggerType\" : \"PUSH\"\n  } ]\n}-->\n## CI report:\n\n* 523c84e2eae12e127b2be09be70cabe87984f603 Azure: [SUCCESS](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8439) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118411526/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118422593","html_url":"https://github.com/apache/hudi/issues/5382#issuecomment-1118422593","issue_url":"https://api.github.com/repos/apache/hudi/issues/5382","id":1118422593,"node_id":"IC_kwDOBI7nWM5CqcZB","user":{"login":"danny0405","id":7644508,"node_id":"MDQ6VXNlcjc2NDQ1MDg=","avatar_url":"https://avatars.githubusercontent.com/u/7644508?v=4","gravatar_id":"","url":"https://api.github.com/users/danny0405","html_url":"https://github.com/danny0405","followers_url":"https://api.github.com/users/danny0405/followers","following_url":"https://api.github.com/users/danny0405/following{/other_user}","gists_url":"https://api.github.com/users/danny0405/gists{/gist_id}","starred_url":"https://api.github.com/users/danny0405/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danny0405/subscriptions","organizations_url":"https://api.github.com/users/danny0405/orgs","repos_url":"https://api.github.com/users/danny0405/repos","events_url":"https://api.github.com/users/danny0405/events{/privacy}","received_events_url":"https://api.github.com/users/danny0405/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-05T11:00:41Z","updated_at":"2022-05-05T11:00:41Z","author_association":"CONTRIBUTOR","body":"Did you set up the input format manually ? Hive 2.1.1 is not low, many people in out dingTalk group uses that.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118422593/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118455860","html_url":"https://github.com/apache/hudi/issues/5382#issuecomment-1118455860","issue_url":"https://api.github.com/repos/apache/hudi/issues/5382","id":1118455860,"node_id":"IC_kwDOBI7nWM5Cqkg0","user":{"login":"lihuahui5683","id":31878723,"node_id":"MDQ6VXNlcjMxODc4NzIz","avatar_url":"https://avatars.githubusercontent.com/u/31878723?v=4","gravatar_id":"","url":"https://api.github.com/users/lihuahui5683","html_url":"https://github.com/lihuahui5683","followers_url":"https://api.github.com/users/lihuahui5683/followers","following_url":"https://api.github.com/users/lihuahui5683/following{/other_user}","gists_url":"https://api.github.com/users/lihuahui5683/gists{/gist_id}","starred_url":"https://api.github.com/users/lihuahui5683/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lihuahui5683/subscriptions","organizations_url":"https://api.github.com/users/lihuahui5683/orgs","repos_url":"https://api.github.com/users/lihuahui5683/repos","events_url":"https://api.github.com/users/lihuahui5683/events{/privacy}","received_events_url":"https://api.github.com/users/lihuahui5683/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-05T11:45:40Z","updated_at":"2022-05-05T11:45:40Z","author_association":"NONE","body":"yes，I set `hive.input.format=org.apache.hudi.hadoop.hive.HoodieCombineHiveInputFormat;`\r\nThe picture below is the process I performed:\r\n![image](https://user-images.githubusercontent.com/31878723/166916026-0906b907-7892-4f1d-b3c7-a588630f5e7c.png)\r\n![image](https://user-images.githubusercontent.com/31878723/166916213-c3c3ec10-2f20-48b4-8596-e609d2a3f7ad.png)\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118455860/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118478759","html_url":"https://github.com/apache/hudi/pull/5445#issuecomment-1118478759","issue_url":"https://api.github.com/repos/apache/hudi/issues/5445","id":1118478759,"node_id":"IC_kwDOBI7nWM5CqqGn","user":{"login":"JerryYue-M","id":10253313,"node_id":"MDQ6VXNlcjEwMjUzMzEz","avatar_url":"https://avatars.githubusercontent.com/u/10253313?v=4","gravatar_id":"","url":"https://api.github.com/users/JerryYue-M","html_url":"https://github.com/JerryYue-M","followers_url":"https://api.github.com/users/JerryYue-M/followers","following_url":"https://api.github.com/users/JerryYue-M/following{/other_user}","gists_url":"https://api.github.com/users/JerryYue-M/gists{/gist_id}","starred_url":"https://api.github.com/users/JerryYue-M/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JerryYue-M/subscriptions","organizations_url":"https://api.github.com/users/JerryYue-M/orgs","repos_url":"https://api.github.com/users/JerryYue-M/repos","events_url":"https://api.github.com/users/JerryYue-M/events{/privacy}","received_events_url":"https://api.github.com/users/JerryYue-M/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-05T12:16:03Z","updated_at":"2022-05-05T12:16:03Z","author_association":"CONTRIBUTOR","body":"@danny0405 all discussions had resolved\r\npls review it again, thanks\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118478759/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118497479","html_url":"https://github.com/apache/hudi/pull/5508#issuecomment-1118497479","issue_url":"https://api.github.com/repos/apache/hudi/issues/5508","id":1118497479,"node_id":"IC_kwDOBI7nWM5CqurH","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-05T12:38:15Z","updated_at":"2022-05-05T12:38:15Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"7b0cae541cd82649c1ff3eef57dfb24b1bcf4d9c\",\n    \"status\" : \"FAILURE\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8443\",\n    \"triggerID\" : \"7b0cae541cd82649c1ff3eef57dfb24b1bcf4d9c\",\n    \"triggerType\" : \"PUSH\"\n  } ]\n}-->\n## CI report:\n\n* 7b0cae541cd82649c1ff3eef57dfb24b1bcf4d9c Azure: [FAILURE](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8443) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118497479/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118504685","html_url":"https://github.com/apache/hudi/pull/5048#issuecomment-1118504685","issue_url":"https://api.github.com/repos/apache/hudi/issues/5048","id":1118504685,"node_id":"IC_kwDOBI7nWM5Cqwbt","user":{"login":"boneanxs","id":10115332,"node_id":"MDQ6VXNlcjEwMTE1MzMy","avatar_url":"https://avatars.githubusercontent.com/u/10115332?v=4","gravatar_id":"","url":"https://api.github.com/users/boneanxs","html_url":"https://github.com/boneanxs","followers_url":"https://api.github.com/users/boneanxs/followers","following_url":"https://api.github.com/users/boneanxs/following{/other_user}","gists_url":"https://api.github.com/users/boneanxs/gists{/gist_id}","starred_url":"https://api.github.com/users/boneanxs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/boneanxs/subscriptions","organizations_url":"https://api.github.com/users/boneanxs/orgs","repos_url":"https://api.github.com/users/boneanxs/repos","events_url":"https://api.github.com/users/boneanxs/events{/privacy}","received_events_url":"https://api.github.com/users/boneanxs/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-05T12:46:36Z","updated_at":"2022-05-05T12:46:36Z","author_association":"CONTRIBUTOR","body":"> @boneanxs is this more like a transient issue for readers? There could be cases where empty or partial complete instant file is left in the timeline. There are fixes to it: https://github.com/apache/hudi/pull/4016 https://github.com/apache/hudi/pull/5261 . Do they solve your problem?\r\n\r\n@yihua sorry for a late reply,\r\nIt's not the same issue, this will cause data loss when doing incremental reading.\r\n\r\n> Given that HDFS is append-only, while cloud storage like S3 guarantees atomic file overwrites, it is better to put such different logic in file system abstraction and APIs, instead of leaking them into Hudi core logic like timeline, to make it easier to maintain and understand.\r\n\r\nDo you mean move this logic in `HoodieWrapperFileSystem`? As there are two steps to write commit data(create file first and then write the data), I don't get any ideas to put it in fie system, can you please give me some hint?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118504685/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118567331","html_url":"https://github.com/apache/hudi/pull/5508#issuecomment-1118567331","issue_url":"https://api.github.com/repos/apache/hudi/issues/5508","id":1118567331,"node_id":"IC_kwDOBI7nWM5Cq_uj","user":{"login":"danny0405","id":7644508,"node_id":"MDQ6VXNlcjc2NDQ1MDg=","avatar_url":"https://avatars.githubusercontent.com/u/7644508?v=4","gravatar_id":"","url":"https://api.github.com/users/danny0405","html_url":"https://github.com/danny0405","followers_url":"https://api.github.com/users/danny0405/followers","following_url":"https://api.github.com/users/danny0405/following{/other_user}","gists_url":"https://api.github.com/users/danny0405/gists{/gist_id}","starred_url":"https://api.github.com/users/danny0405/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danny0405/subscriptions","organizations_url":"https://api.github.com/users/danny0405/orgs","repos_url":"https://api.github.com/users/danny0405/repos","events_url":"https://api.github.com/users/danny0405/events{/privacy}","received_events_url":"https://api.github.com/users/danny0405/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-05T13:40:21Z","updated_at":"2022-05-05T13:40:21Z","author_association":"CONTRIBUTOR","body":"Close because `BaseRollbackActionExecutor.runRollback` already did that.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118567331/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118579317","html_url":"https://github.com/apache/hudi/pull/5506#issuecomment-1118579317","issue_url":"https://api.github.com/repos/apache/hudi/issues/5506","id":1118579317,"node_id":"IC_kwDOBI7nWM5CrCp1","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-05T13:50:07Z","updated_at":"2022-05-05T13:50:07Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"00114df1c0184fc769bcbf2595014935aeff3281\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8442\",\n    \"triggerID\" : \"00114df1c0184fc769bcbf2595014935aeff3281\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"6f6ffdafc1e6ade28a7d340024905374353032af\",\n    \"status\" : \"SUCCESS\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8444\",\n    \"triggerID\" : \"6f6ffdafc1e6ade28a7d340024905374353032af\",\n    \"triggerType\" : \"PUSH\"\n  } ]\n}-->\n## CI report:\n\n* 6f6ffdafc1e6ade28a7d340024905374353032af Azure: [SUCCESS](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8444) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118579317/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118619225","html_url":"https://github.com/apache/hudi/issues/4604#issuecomment-1118619225","issue_url":"https://api.github.com/repos/apache/hudi/issues/4604","id":1118619225,"node_id":"IC_kwDOBI7nWM5CrMZZ","user":{"login":"andykrk","id":24304947,"node_id":"MDQ6VXNlcjI0MzA0OTQ3","avatar_url":"https://avatars.githubusercontent.com/u/24304947?v=4","gravatar_id":"","url":"https://api.github.com/users/andykrk","html_url":"https://github.com/andykrk","followers_url":"https://api.github.com/users/andykrk/followers","following_url":"https://api.github.com/users/andykrk/following{/other_user}","gists_url":"https://api.github.com/users/andykrk/gists{/gist_id}","starred_url":"https://api.github.com/users/andykrk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andykrk/subscriptions","organizations_url":"https://api.github.com/users/andykrk/orgs","repos_url":"https://api.github.com/users/andykrk/repos","events_url":"https://api.github.com/users/andykrk/events{/privacy}","received_events_url":"https://api.github.com/users/andykrk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-05T14:24:55Z","updated_at":"2022-05-05T14:24:55Z","author_association":"NONE","body":"@nsivabalan We need to park this item temporarily. We may get some additional resources to work on that on our side after this. I will keep you posted on that.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118619225/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118698058","html_url":"https://github.com/apache/hudi/pull/5505#issuecomment-1118698058","issue_url":"https://api.github.com/repos/apache/hudi/issues/5505","id":1118698058,"node_id":"IC_kwDOBI7nWM5CrfpK","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-05T15:28:00Z","updated_at":"2022-05-05T15:28:00Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"f424ced01b08d5f4581139aec6ecde6b68d6b4aa\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8441\",\n    \"triggerID\" : \"f424ced01b08d5f4581139aec6ecde6b68d6b4aa\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"688503b426fd812bde2e053795048d6509ccf7ec\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8445\",\n    \"triggerID\" : \"688503b426fd812bde2e053795048d6509ccf7ec\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"28c50bbaacaa1b70811f02c3a1e02138dfd09e15\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8447\",\n    \"triggerID\" : \"28c50bbaacaa1b70811f02c3a1e02138dfd09e15\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"e6575ef2e0082baa6608f8c3f75a4ec6d1312662\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8449\",\n    \"triggerID\" : \"e6575ef2e0082baa6608f8c3f75a4ec6d1312662\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"ad175e8b93bc54e10a846cbcb8caad988ce8280b\",\n    \"status\" : \"SUCCESS\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8452\",\n    \"triggerID\" : \"ad175e8b93bc54e10a846cbcb8caad988ce8280b\",\n    \"triggerType\" : \"PUSH\"\n  } ]\n}-->\n## CI report:\n\n* ad175e8b93bc54e10a846cbcb8caad988ce8280b Azure: [SUCCESS](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8452) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118698058/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118719037","html_url":"https://github.com/apache/hudi/pull/5510#issuecomment-1118719037","issue_url":"https://api.github.com/repos/apache/hudi/issues/5510","id":1118719037,"node_id":"IC_kwDOBI7nWM5Crkw9","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-05T15:42:19Z","updated_at":"2022-05-05T15:42:19Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"ec40e1e3c0495c301a964a1fa1a740dc6a1d0e00\",\n    \"status\" : \"FAILURE\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8450\",\n    \"triggerID\" : \"ec40e1e3c0495c301a964a1fa1a740dc6a1d0e00\",\n    \"triggerType\" : \"PUSH\"\n  } ]\n}-->\n## CI report:\n\n* ec40e1e3c0495c301a964a1fa1a740dc6a1d0e00 Azure: [FAILURE](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8450) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118719037/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118812053","html_url":"https://github.com/apache/hudi/pull/5287#issuecomment-1118812053","issue_url":"https://api.github.com/repos/apache/hudi/issues/5287","id":1118812053,"node_id":"IC_kwDOBI7nWM5Cr7eV","user":{"login":"alexeykudinkin","id":428277,"node_id":"MDQ6VXNlcjQyODI3Nw==","avatar_url":"https://avatars.githubusercontent.com/u/428277?v=4","gravatar_id":"","url":"https://api.github.com/users/alexeykudinkin","html_url":"https://github.com/alexeykudinkin","followers_url":"https://api.github.com/users/alexeykudinkin/followers","following_url":"https://api.github.com/users/alexeykudinkin/following{/other_user}","gists_url":"https://api.github.com/users/alexeykudinkin/gists{/gist_id}","starred_url":"https://api.github.com/users/alexeykudinkin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexeykudinkin/subscriptions","organizations_url":"https://api.github.com/users/alexeykudinkin/orgs","repos_url":"https://api.github.com/users/alexeykudinkin/repos","events_url":"https://api.github.com/users/alexeykudinkin/events{/privacy}","received_events_url":"https://api.github.com/users/alexeykudinkin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-05T16:46:27Z","updated_at":"2022-05-05T16:46:27Z","author_association":"CONTRIBUTOR","body":"LGTM","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1118812053/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1119021233","html_url":"https://github.com/apache/hudi/pull/4264#issuecomment-1119021233","issue_url":"https://api.github.com/repos/apache/hudi/issues/4264","id":1119021233,"node_id":"IC_kwDOBI7nWM5Csuix","user":{"login":"alexeykudinkin","id":428277,"node_id":"MDQ6VXNlcjQyODI3Nw==","avatar_url":"https://avatars.githubusercontent.com/u/428277?v=4","gravatar_id":"","url":"https://api.github.com/users/alexeykudinkin","html_url":"https://github.com/alexeykudinkin","followers_url":"https://api.github.com/users/alexeykudinkin/followers","following_url":"https://api.github.com/users/alexeykudinkin/following{/other_user}","gists_url":"https://api.github.com/users/alexeykudinkin/gists{/gist_id}","starred_url":"https://api.github.com/users/alexeykudinkin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexeykudinkin/subscriptions","organizations_url":"https://api.github.com/users/alexeykudinkin/orgs","repos_url":"https://api.github.com/users/alexeykudinkin/repos","events_url":"https://api.github.com/users/alexeykudinkin/events{/privacy}","received_events_url":"https://api.github.com/users/alexeykudinkin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-05T20:34:40Z","updated_at":"2022-05-05T20:34:40Z","author_association":"CONTRIBUTOR","body":"LGTM, @nsivabalan @yihua can you please help land that one?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1119021233/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1119074796","html_url":"https://github.com/apache/hudi/issues/4700#issuecomment-1119074796","issue_url":"https://api.github.com/repos/apache/hudi/issues/4700","id":1119074796,"node_id":"IC_kwDOBI7nWM5Cs7ns","user":{"login":"vicuna96","id":31972447,"node_id":"MDQ6VXNlcjMxOTcyNDQ3","avatar_url":"https://avatars.githubusercontent.com/u/31972447?v=4","gravatar_id":"","url":"https://api.github.com/users/vicuna96","html_url":"https://github.com/vicuna96","followers_url":"https://api.github.com/users/vicuna96/followers","following_url":"https://api.github.com/users/vicuna96/following{/other_user}","gists_url":"https://api.github.com/users/vicuna96/gists{/gist_id}","starred_url":"https://api.github.com/users/vicuna96/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vicuna96/subscriptions","organizations_url":"https://api.github.com/users/vicuna96/orgs","repos_url":"https://api.github.com/users/vicuna96/repos","events_url":"https://api.github.com/users/vicuna96/events{/privacy}","received_events_url":"https://api.github.com/users/vicuna96/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-05T21:44:47Z","updated_at":"2022-05-05T21:44:47Z","author_association":"NONE","body":"Hi @xiarixiaoyao , @nsivabalan , is there any known workaround for this? It does seem like the problem is that it's trying to use the implementation from org.spark-project.hive:hive-metastore:1.2.1.spark2, which is included in Spark 2.4.7 environment under $SPARK_HOME/jars (and hence in the dataproc image mentioned above). Do you have any advice on how to shadow those packages? It would be very helpful.\r\nThanks!","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1119074796/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1119208823","html_url":"https://github.com/apache/hudi/pull/5073#issuecomment-1119208823","issue_url":"https://api.github.com/repos/apache/hudi/issues/5073","id":1119208823,"node_id":"IC_kwDOBI7nWM5CtcV3","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-06T02:35:37Z","updated_at":"2022-05-06T02:35:37Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"a085e7f1d75101a4d2518602deb93eae7cc56226\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=7092\",\n    \"triggerID\" : \"a085e7f1d75101a4d2518602deb93eae7cc56226\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"e0f566ef3af6582da6f846185c749c1205eef292\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=7147\",\n    \"triggerID\" : \"e0f566ef3af6582da6f846185c749c1205eef292\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"abd0e8921cb2765288fc086bf3421a3ecae0c6d3\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8274\",\n    \"triggerID\" : \"abd0e8921cb2765288fc086bf3421a3ecae0c6d3\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"2e170509cffd77d4124ecbe337cd018c96a621fd\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8423\",\n    \"triggerID\" : \"2e170509cffd77d4124ecbe337cd018c96a621fd\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"7042acc0eeee9b38acd8741c89ca77e99bdacaa6\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8459\",\n    \"triggerID\" : \"7042acc0eeee9b38acd8741c89ca77e99bdacaa6\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"a1322fbeb11fe5bb71cd5d70f13147bf8a036996\",\n    \"status\" : \"FAILURE\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8460\",\n    \"triggerID\" : \"a1322fbeb11fe5bb71cd5d70f13147bf8a036996\",\n    \"triggerType\" : \"PUSH\"\n  } ]\n}-->\n## CI report:\n\n* a1322fbeb11fe5bb71cd5d70f13147bf8a036996 Azure: [FAILURE](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8460) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1119208823/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1119271257","html_url":"https://github.com/apache/hudi/issues/5484#issuecomment-1119271257","issue_url":"https://api.github.com/repos/apache/hudi/issues/5484","id":1119271257,"node_id":"IC_kwDOBI7nWM5CtrlZ","user":{"login":"parisni","id":9535350,"node_id":"MDQ6VXNlcjk1MzUzNTA=","avatar_url":"https://avatars.githubusercontent.com/u/9535350?v=4","gravatar_id":"","url":"https://api.github.com/users/parisni","html_url":"https://github.com/parisni","followers_url":"https://api.github.com/users/parisni/followers","following_url":"https://api.github.com/users/parisni/following{/other_user}","gists_url":"https://api.github.com/users/parisni/gists{/gist_id}","starred_url":"https://api.github.com/users/parisni/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/parisni/subscriptions","organizations_url":"https://api.github.com/users/parisni/orgs","repos_url":"https://api.github.com/users/parisni/repos","events_url":"https://api.github.com/users/parisni/events{/privacy}","received_events_url":"https://api.github.com/users/parisni/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-06T05:26:18Z","updated_at":"2022-05-06T05:26:18Z","author_association":"CONTRIBUTOR","body":"what about removing that `'hoodie.meta.sync.client.tool.class': 'org.apache.hudi.aws.sync.AwsGlueCatalogSyncTool'` ? This will work as 0.10 with the regular hive sync connector, which just work with glue","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1119271257/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1119273063","html_url":"https://github.com/apache/hudi/issues/5382#issuecomment-1119273063","issue_url":"https://api.github.com/repos/apache/hudi/issues/5382","id":1119273063,"node_id":"IC_kwDOBI7nWM5CtsBn","user":{"login":"danny0405","id":7644508,"node_id":"MDQ6VXNlcjc2NDQ1MDg=","avatar_url":"https://avatars.githubusercontent.com/u/7644508?v=4","gravatar_id":"","url":"https://api.github.com/users/danny0405","html_url":"https://github.com/danny0405","followers_url":"https://api.github.com/users/danny0405/followers","following_url":"https://api.github.com/users/danny0405/following{/other_user}","gists_url":"https://api.github.com/users/danny0405/gists{/gist_id}","starred_url":"https://api.github.com/users/danny0405/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danny0405/subscriptions","organizations_url":"https://api.github.com/users/danny0405/orgs","repos_url":"https://api.github.com/users/danny0405/repos","events_url":"https://api.github.com/users/danny0405/events{/privacy}","received_events_url":"https://api.github.com/users/danny0405/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-06T05:30:27Z","updated_at":"2022-05-06T05:30:27Z","author_association":"CONTRIBUTOR","body":"Can you ask for help in the dingTalk group, some people might solve this problem already.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1119273063/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1119273974","html_url":"https://github.com/apache/hudi/pull/5402#issuecomment-1119273974","issue_url":"https://api.github.com/repos/apache/hudi/issues/5402","id":1119273974,"node_id":"IC_kwDOBI7nWM5CtsP2","user":{"login":"yihua","id":2497195,"node_id":"MDQ6VXNlcjI0OTcxOTU=","avatar_url":"https://avatars.githubusercontent.com/u/2497195?v=4","gravatar_id":"","url":"https://api.github.com/users/yihua","html_url":"https://github.com/yihua","followers_url":"https://api.github.com/users/yihua/followers","following_url":"https://api.github.com/users/yihua/following{/other_user}","gists_url":"https://api.github.com/users/yihua/gists{/gist_id}","starred_url":"https://api.github.com/users/yihua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yihua/subscriptions","organizations_url":"https://api.github.com/users/yihua/orgs","repos_url":"https://api.github.com/users/yihua/repos","events_url":"https://api.github.com/users/yihua/events{/privacy}","received_events_url":"https://api.github.com/users/yihua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-06T05:32:54Z","updated_at":"2022-05-06T05:32:54Z","author_association":"CONTRIBUTOR","body":"@hudi-bot run azure","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1119273974/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1119274099","html_url":"https://github.com/apache/hudi/issues/5513#issuecomment-1119274099","issue_url":"https://api.github.com/repos/apache/hudi/issues/5513","id":1119274099,"node_id":"IC_kwDOBI7nWM5CtsRz","user":{"login":"danny0405","id":7644508,"node_id":"MDQ6VXNlcjc2NDQ1MDg=","avatar_url":"https://avatars.githubusercontent.com/u/7644508?v=4","gravatar_id":"","url":"https://api.github.com/users/danny0405","html_url":"https://github.com/danny0405","followers_url":"https://api.github.com/users/danny0405/followers","following_url":"https://api.github.com/users/danny0405/following{/other_user}","gists_url":"https://api.github.com/users/danny0405/gists{/gist_id}","starred_url":"https://api.github.com/users/danny0405/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danny0405/subscriptions","organizations_url":"https://api.github.com/users/danny0405/orgs","repos_url":"https://api.github.com/users/danny0405/repos","events_url":"https://api.github.com/users/danny0405/events{/privacy}","received_events_url":"https://api.github.com/users/danny0405/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-06T05:33:12Z","updated_at":"2022-05-06T05:33:12Z","author_association":"CONTRIBUTOR","body":"You need to set up the key generator clazz correctly.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1119274099/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1119280273","html_url":"https://github.com/apache/hudi/issues/5513#issuecomment-1119280273","issue_url":"https://api.github.com/repos/apache/hudi/issues/5513","id":1119280273,"node_id":"IC_kwDOBI7nWM5CttyR","user":{"login":"aiwenmo","id":32723967,"node_id":"MDQ6VXNlcjMyNzIzOTY3","avatar_url":"https://avatars.githubusercontent.com/u/32723967?v=4","gravatar_id":"","url":"https://api.github.com/users/aiwenmo","html_url":"https://github.com/aiwenmo","followers_url":"https://api.github.com/users/aiwenmo/followers","following_url":"https://api.github.com/users/aiwenmo/following{/other_user}","gists_url":"https://api.github.com/users/aiwenmo/gists{/gist_id}","starred_url":"https://api.github.com/users/aiwenmo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aiwenmo/subscriptions","organizations_url":"https://api.github.com/users/aiwenmo/orgs","repos_url":"https://api.github.com/users/aiwenmo/repos","events_url":"https://api.github.com/users/aiwenmo/events{/privacy}","received_events_url":"https://api.github.com/users/aiwenmo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-06T05:49:32Z","updated_at":"2022-05-06T05:49:32Z","author_association":"NONE","body":"> You need to set up the key generator clazz correctly.\r\n\r\nthx. Your method is also OK.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1119280273/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1119363425","html_url":"https://github.com/apache/hudi/pull/5458#issuecomment-1119363425","issue_url":"https://api.github.com/repos/apache/hudi/issues/5458","id":1119363425,"node_id":"IC_kwDOBI7nWM5CuCFh","user":{"login":"miomiocat","id":11596570,"node_id":"MDQ6VXNlcjExNTk2NTcw","avatar_url":"https://avatars.githubusercontent.com/u/11596570?v=4","gravatar_id":"","url":"https://api.github.com/users/miomiocat","html_url":"https://github.com/miomiocat","followers_url":"https://api.github.com/users/miomiocat/followers","following_url":"https://api.github.com/users/miomiocat/following{/other_user}","gists_url":"https://api.github.com/users/miomiocat/gists{/gist_id}","starred_url":"https://api.github.com/users/miomiocat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/miomiocat/subscriptions","organizations_url":"https://api.github.com/users/miomiocat/orgs","repos_url":"https://api.github.com/users/miomiocat/repos","events_url":"https://api.github.com/users/miomiocat/events{/privacy}","received_events_url":"https://api.github.com/users/miomiocat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-06T08:08:36Z","updated_at":"2022-05-06T08:08:36Z","author_association":"CONTRIBUTOR","body":"> The fix looks ok to me. @miomiocat could you add some functional tests around non-partitioned tables, e.g., `show fsview latest` on non-partitioned table in `TestFileSystemViewCommand`?\r\n\r\nthanks for your reply.\r\n\r\nUTs added, PTAL","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1119363425/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1119418504","html_url":"https://github.com/apache/hudi/pull/5471#issuecomment-1119418504","issue_url":"https://api.github.com/repos/apache/hudi/issues/5471","id":1119418504,"node_id":"IC_kwDOBI7nWM5CuPiI","user":{"login":"Chosen123Wang","id":39905818,"node_id":"MDQ6VXNlcjM5OTA1ODE4","avatar_url":"https://avatars.githubusercontent.com/u/39905818?v=4","gravatar_id":"","url":"https://api.github.com/users/Chosen123Wang","html_url":"https://github.com/Chosen123Wang","followers_url":"https://api.github.com/users/Chosen123Wang/followers","following_url":"https://api.github.com/users/Chosen123Wang/following{/other_user}","gists_url":"https://api.github.com/users/Chosen123Wang/gists{/gist_id}","starred_url":"https://api.github.com/users/Chosen123Wang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Chosen123Wang/subscriptions","organizations_url":"https://api.github.com/users/Chosen123Wang/orgs","repos_url":"https://api.github.com/users/Chosen123Wang/repos","events_url":"https://api.github.com/users/Chosen123Wang/events{/privacy}","received_events_url":"https://api.github.com/users/Chosen123Wang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-06T09:18:17Z","updated_at":"2022-05-06T09:18:17Z","author_association":"NONE","body":"I added this line of code ,and still report this error \r\nhudi 0.11.0-release      flink 1.14.3","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1119418504/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1119420615","html_url":"https://github.com/apache/hudi/issues/5457#issuecomment-1119420615","issue_url":"https://api.github.com/repos/apache/hudi/issues/5457","id":1119420615,"node_id":"IC_kwDOBI7nWM5CuQDH","user":{"login":"Chosen123Wang","id":39905818,"node_id":"MDQ6VXNlcjM5OTA1ODE4","avatar_url":"https://avatars.githubusercontent.com/u/39905818?v=4","gravatar_id":"","url":"https://api.github.com/users/Chosen123Wang","html_url":"https://github.com/Chosen123Wang","followers_url":"https://api.github.com/users/Chosen123Wang/followers","following_url":"https://api.github.com/users/Chosen123Wang/following{/other_user}","gists_url":"https://api.github.com/users/Chosen123Wang/gists{/gist_id}","starred_url":"https://api.github.com/users/Chosen123Wang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Chosen123Wang/subscriptions","organizations_url":"https://api.github.com/users/Chosen123Wang/orgs","repos_url":"https://api.github.com/users/Chosen123Wang/repos","events_url":"https://api.github.com/users/Chosen123Wang/events{/privacy}","received_events_url":"https://api.github.com/users/Chosen123Wang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-06T09:20:46Z","updated_at":"2022-05-06T09:20:46Z","author_association":"NONE","body":"> @Chosen123Wang Could you try this fix to see if it solves your issue: #5471?\r\n\r\nI added this line of code ,and still report this error \r\nhudi 0.11.0-release      flink 1.14.3","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1119420615/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1119430279","html_url":"https://github.com/apache/hudi/issues/3834#issuecomment-1119430279","issue_url":"https://api.github.com/repos/apache/hudi/issues/3834","id":1119430279,"node_id":"IC_kwDOBI7nWM5CuSaH","user":{"login":"Limess","id":3199181,"node_id":"MDQ6VXNlcjMxOTkxODE=","avatar_url":"https://avatars.githubusercontent.com/u/3199181?v=4","gravatar_id":"","url":"https://api.github.com/users/Limess","html_url":"https://github.com/Limess","followers_url":"https://api.github.com/users/Limess/followers","following_url":"https://api.github.com/users/Limess/following{/other_user}","gists_url":"https://api.github.com/users/Limess/gists{/gist_id}","starred_url":"https://api.github.com/users/Limess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Limess/subscriptions","organizations_url":"https://api.github.com/users/Limess/orgs","repos_url":"https://api.github.com/users/Limess/repos","events_url":"https://api.github.com/users/Limess/events{/privacy}","received_events_url":"https://api.github.com/users/Limess/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-06T09:32:02Z","updated_at":"2022-05-06T09:32:12Z","author_association":"NONE","body":"For others experiencing this issue, I have just recreated this issue with Hudi 0.11.0 and the current Athena version [April 22, 2022](https://docs.aws.amazon.com/athena/latest/ug/release-note-2022-04-22.html).\r\n\r\nAs expected it still needs a fix on the AWS Athena side to remedy (I haven't checked with open source Presto)","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1119430279/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1119450103","html_url":"https://github.com/apache/hudi/issues/5457#issuecomment-1119450103","issue_url":"https://api.github.com/repos/apache/hudi/issues/5457","id":1119450103,"node_id":"IC_kwDOBI7nWM5CuXP3","user":{"login":"Chosen123Wang","id":39905818,"node_id":"MDQ6VXNlcjM5OTA1ODE4","avatar_url":"https://avatars.githubusercontent.com/u/39905818?v=4","gravatar_id":"","url":"https://api.github.com/users/Chosen123Wang","html_url":"https://github.com/Chosen123Wang","followers_url":"https://api.github.com/users/Chosen123Wang/followers","following_url":"https://api.github.com/users/Chosen123Wang/following{/other_user}","gists_url":"https://api.github.com/users/Chosen123Wang/gists{/gist_id}","starred_url":"https://api.github.com/users/Chosen123Wang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Chosen123Wang/subscriptions","organizations_url":"https://api.github.com/users/Chosen123Wang/orgs","repos_url":"https://api.github.com/users/Chosen123Wang/repos","events_url":"https://api.github.com/users/Chosen123Wang/events{/privacy}","received_events_url":"https://api.github.com/users/Chosen123Wang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-06T09:57:11Z","updated_at":"2022-05-06T09:57:11Z","author_association":"NONE","body":"> I have encountered such errors，this is because different classloader loads a same class，you need check you library\r\n\r\nWhat dependencies do I need to check ？","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1119450103/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1119565996","html_url":"https://github.com/apache/hudi/pull/5512#issuecomment-1119565996","issue_url":"https://api.github.com/repos/apache/hudi/issues/5512","id":1119565996,"node_id":"IC_kwDOBI7nWM5Cuzis","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-06T12:30:30Z","updated_at":"2022-05-06T12:30:30Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"2acc8007cc153d7d4a228e126ef706e5bb25cfbb\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8454\",\n    \"triggerID\" : \"2acc8007cc153d7d4a228e126ef706e5bb25cfbb\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"c7324b8703ec68a4fd57195028d7977ab6862ac5\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8458\",\n    \"triggerID\" : \"c7324b8703ec68a4fd57195028d7977ab6862ac5\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"6118e9ed99f2defa265167dbd923fa384bcba729\",\n    \"status\" : \"SUCCESS\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8466\",\n    \"triggerID\" : \"6118e9ed99f2defa265167dbd923fa384bcba729\",\n    \"triggerType\" : \"PUSH\"\n  } ]\n}-->\n## CI report:\n\n* 6118e9ed99f2defa265167dbd923fa384bcba729 Azure: [SUCCESS](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8466) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1119565996/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1119566865","html_url":"https://github.com/apache/hudi/issues/5484#issuecomment-1119566865","issue_url":"https://api.github.com/repos/apache/hudi/issues/5484","id":1119566865,"node_id":"IC_kwDOBI7nWM5CuzwR","user":{"login":"jasondavindev","id":33331415,"node_id":"MDQ6VXNlcjMzMzMxNDE1","avatar_url":"https://avatars.githubusercontent.com/u/33331415?v=4","gravatar_id":"","url":"https://api.github.com/users/jasondavindev","html_url":"https://github.com/jasondavindev","followers_url":"https://api.github.com/users/jasondavindev/followers","following_url":"https://api.github.com/users/jasondavindev/following{/other_user}","gists_url":"https://api.github.com/users/jasondavindev/gists{/gist_id}","starred_url":"https://api.github.com/users/jasondavindev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasondavindev/subscriptions","organizations_url":"https://api.github.com/users/jasondavindev/orgs","repos_url":"https://api.github.com/users/jasondavindev/repos","events_url":"https://api.github.com/users/jasondavindev/events{/privacy}","received_events_url":"https://api.github.com/users/jasondavindev/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-06T12:31:29Z","updated_at":"2022-05-06T12:31:29Z","author_association":"NONE","body":"With or without that config doesn't worked","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1119566865/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1119745190","html_url":"https://github.com/apache/hudi/pull/5509#issuecomment-1119745190","issue_url":"https://api.github.com/repos/apache/hudi/issues/5509","id":1119745190,"node_id":"IC_kwDOBI7nWM5CvfSm","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-06T15:32:55Z","updated_at":"2022-05-06T15:32:55Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"99e207f779a258ff32c57c9d1b962d772213c081\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8448\",\n    \"triggerID\" : \"99e207f779a258ff32c57c9d1b962d772213c081\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"85be21c2ec99670eb9e0e697259e407d78bf4524\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8461\",\n    \"triggerID\" : \"85be21c2ec99670eb9e0e697259e407d78bf4524\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"72d8e841f8a48543aab26f9e3ff1c88c4d593138\",\n    \"status\" : \"FAILURE\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8471\",\n    \"triggerID\" : \"72d8e841f8a48543aab26f9e3ff1c88c4d593138\",\n    \"triggerType\" : \"PUSH\"\n  } ]\n}-->\n## CI report:\n\n* 72d8e841f8a48543aab26f9e3ff1c88c4d593138 Azure: [FAILURE](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8471) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1119745190/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1119839815","html_url":"https://github.com/apache/hudi/pull/5518#issuecomment-1119839815","issue_url":"https://api.github.com/repos/apache/hudi/issues/5518","id":1119839815,"node_id":"IC_kwDOBI7nWM5Cv2ZH","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-06T17:32:14Z","updated_at":"2022-05-06T17:32:14Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"6ab7908e49f84fef758b77ccc3167d5a97e26bb1\",\n    \"status\" : \"SUCCESS\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8474\",\n    \"triggerID\" : \"6ab7908e49f84fef758b77ccc3167d5a97e26bb1\",\n    \"triggerType\" : \"PUSH\"\n  } ]\n}-->\n## CI report:\n\n* 6ab7908e49f84fef758b77ccc3167d5a97e26bb1 Azure: [SUCCESS](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8474) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1119839815/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1119873863","html_url":"https://github.com/apache/hudi/issues/5469#issuecomment-1119873863","issue_url":"https://api.github.com/repos/apache/hudi/issues/5469","id":1119873863,"node_id":"IC_kwDOBI7nWM5Cv-tH","user":{"login":"jasondavindev","id":33331415,"node_id":"MDQ6VXNlcjMzMzMxNDE1","avatar_url":"https://avatars.githubusercontent.com/u/33331415?v=4","gravatar_id":"","url":"https://api.github.com/users/jasondavindev","html_url":"https://github.com/jasondavindev","followers_url":"https://api.github.com/users/jasondavindev/followers","following_url":"https://api.github.com/users/jasondavindev/following{/other_user}","gists_url":"https://api.github.com/users/jasondavindev/gists{/gist_id}","starred_url":"https://api.github.com/users/jasondavindev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasondavindev/subscriptions","organizations_url":"https://api.github.com/users/jasondavindev/orgs","repos_url":"https://api.github.com/users/jasondavindev/repos","events_url":"https://api.github.com/users/jasondavindev/events{/privacy}","received_events_url":"https://api.github.com/users/jasondavindev/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-06T18:21:24Z","updated_at":"2022-05-06T18:21:24Z","author_association":"NONE","body":"When used INSERT operation instead BULK_INSERT, no records are affected by the bug. Thus the BULK_INSERT has a bug.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1119873863/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]