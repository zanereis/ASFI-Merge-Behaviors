[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1763676271","html_url":"https://github.com/apache/iceberg/pull/8834#issuecomment-1763676271","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8834","id":1763676271,"node_id":"IC_kwDOCW7NX85pH5Bv","user":{"login":"advancedxy","id":807537,"node_id":"MDQ6VXNlcjgwNzUzNw==","avatar_url":"https://avatars.githubusercontent.com/u/807537?v=4","gravatar_id":"","url":"https://api.github.com/users/advancedxy","html_url":"https://github.com/advancedxy","followers_url":"https://api.github.com/users/advancedxy/followers","following_url":"https://api.github.com/users/advancedxy/following{/other_user}","gists_url":"https://api.github.com/users/advancedxy/gists{/gist_id}","starred_url":"https://api.github.com/users/advancedxy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/advancedxy/subscriptions","organizations_url":"https://api.github.com/users/advancedxy/orgs","repos_url":"https://api.github.com/users/advancedxy/repos","events_url":"https://api.github.com/users/advancedxy/events{/privacy}","received_events_url":"https://api.github.com/users/advancedxy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-16T03:40:14Z","updated_at":"2023-10-16T03:40:14Z","author_association":"CONTRIBUTOR","body":"Other than to revert the optimize in https://github.com/apache/iceberg/pull/8336, is it better to invalidate the cached `splitOffsetList`? The proposed change is in the `org.apache.iceberg.BaseFile#put` function:\r\n```java\r\n...\r\n      case 12:\r\n        this.upperBounds = SerializableByteBufferMap.wrap((Map<Integer, ByteBuffer>) value);\r\n        return;\r\n      case 13:\r\n        this.keyMetadata = ByteBuffers.toByteArray((ByteBuffer) value);\r\n        return;\r\n      case 14:\r\n        this.splitOffsets = ArrayUtil.toLongArray((List<Long>) value);\r\n        this.splitOffsetList = null; // invalidate the cache\r\n        return;\r\n      case 15:\r\n        this.equalityIds = ArrayUtil.toIntArray((List<Integer>) value);\r\n....\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1763676271/reactions","total_count":2,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":2,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1763706777","html_url":"https://github.com/apache/iceberg/pull/7161#issuecomment-1763706777","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7161","id":1763706777,"node_id":"IC_kwDOCW7NX85pIAeZ","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-16T04:28:55Z","updated_at":"2023-10-16T04:31:23Z","author_association":"CONTRIBUTOR","body":"is the partition time an event time or ingestion/processing time? or asking in a different way, how many active minutes do the Flink writer job process for every commit cycle?\r\n\r\nI feel this ongoing work might work better for you\r\nhttps://docs.google.com/document/d/13N8cMqPi-ZPSKbkXGOBMPOzbv2Fua59j8bIjjtxLWqo\r\nhttps://www.youtube.com/watch?v=GJplmOO7ULA\r\n\r\nUsing bucketing column seems a temp solution to handle (1) skewed data distribution across hours and minutes (2)[ skewed partition distribution from simple keyBy hash distribution](https://github.com/apache/iceberg/pull/4228).\r\n\r\nOn the other hand, I also recognize this change imposed a behavior change that doesn't work for your use case. We can revert the distribution mode change in the `FlinkSink` class. To enable the custom bucketing partitioner, users will have to manually apply the custom `keyBy`.\r\n\r\n```\r\ninput.keyBy(new PartitionKeySelector(partitionSpec, iSchema, flinkRowType))\r\n```\r\n\r\n@kengtin can you create a PR for reverting the FlinkSink change?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1763706777/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1763814466","html_url":"https://github.com/apache/iceberg/issues/8832#issuecomment-1763814466","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8832","id":1763814466,"node_id":"IC_kwDOCW7NX85pIaxC","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-16T06:31:18Z","updated_at":"2023-10-16T06:31:18Z","author_association":"CONTRIBUTOR","body":"Sounds like a similar issue to https://github.com/apache/iceberg/issues/8321. @amogh-jahagirdar should we get #8321 reviewed first and then we can address any leftovers in this PR?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1763814466/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1763815524","html_url":"https://github.com/apache/iceberg/pull/8837#issuecomment-1763815524","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8837","id":1763815524,"node_id":"IC_kwDOCW7NX85pIbBk","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-16T06:32:17Z","updated_at":"2023-10-16T06:32:17Z","author_association":"CONTRIBUTOR","body":"@dependabot rebase","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1763815524/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1763895873","html_url":"https://github.com/apache/iceberg/issues/8832#issuecomment-1763895873","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8832","id":1763895873,"node_id":"IC_kwDOCW7NX85pIupB","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-16T07:35:23Z","updated_at":"2023-10-16T07:35:23Z","author_association":"CONTRIBUTOR","body":"For context, we've also noticed this when porting the JDBC Catalog to Python and decided to leave out the wildcard over there.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1763895873/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1764106743","html_url":"https://github.com/apache/iceberg/issues/8832#issuecomment-1764106743","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8832","id":1764106743,"node_id":"IC_kwDOCW7NX85pJiH3","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-16T09:45:06Z","updated_at":"2023-10-16T09:45:06Z","author_association":"CONTRIBUTOR","body":"> Sounds like a similar issue to #8321. @amogh-jahagirdar should we get #8321 reviewed first and then we can address any leftovers in this PR?\r\n\r\nOoh missed #8321, yes lets get that in first! ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1764106743/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1764118823","html_url":"https://github.com/apache/iceberg/pull/8833#issuecomment-1764118823","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8833","id":1764118823,"node_id":"IC_kwDOCW7NX85pJlEn","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-16T09:52:22Z","updated_at":"2023-10-16T09:52:22Z","author_association":"CONTRIBUTOR","body":"Looks like a similar PR was already put up in the past https://github.com/apache/iceberg/pull/8340, we can just review that.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1764118823/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1764216831","html_url":"https://github.com/apache/iceberg/pull/8834#issuecomment-1764216831","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8834","id":1764216831,"node_id":"IC_kwDOCW7NX85pJ8__","user":{"login":"bryanck","id":5475421,"node_id":"MDQ6VXNlcjU0NzU0MjE=","avatar_url":"https://avatars.githubusercontent.com/u/5475421?v=4","gravatar_id":"","url":"https://api.github.com/users/bryanck","html_url":"https://github.com/bryanck","followers_url":"https://api.github.com/users/bryanck/followers","following_url":"https://api.github.com/users/bryanck/following{/other_user}","gists_url":"https://api.github.com/users/bryanck/gists{/gist_id}","starred_url":"https://api.github.com/users/bryanck/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bryanck/subscriptions","organizations_url":"https://api.github.com/users/bryanck/orgs","repos_url":"https://api.github.com/users/bryanck/repos","events_url":"https://api.github.com/users/bryanck/events{/privacy}","received_events_url":"https://api.github.com/users/bryanck/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-16T10:54:11Z","updated_at":"2023-10-16T10:54:11Z","author_association":"CONTRIBUTOR","body":"> Other than to revert the optimize in #8336, is it better to invalidate the cached `splitOffsetList`? The proposed change is in the `org.apache.iceberg.BaseFile#put` function:\r\n> `\r\n\r\nThe goal of this PR is to revert the code to a known working state. There are a couple of optimizations that could be made (e.g. to equality IDs also) but felt that belongs in a separate PR.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1764216831/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1764246045","html_url":"https://github.com/apache/iceberg/pull/6252#issuecomment-1764246045","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6252","id":1764246045,"node_id":"IC_kwDOCW7NX85pKEId","user":{"login":"atifiu","id":48252551,"node_id":"MDQ6VXNlcjQ4MjUyNTUx","avatar_url":"https://avatars.githubusercontent.com/u/48252551?v=4","gravatar_id":"","url":"https://api.github.com/users/atifiu","html_url":"https://github.com/atifiu","followers_url":"https://api.github.com/users/atifiu/followers","following_url":"https://api.github.com/users/atifiu/following{/other_user}","gists_url":"https://api.github.com/users/atifiu/gists{/gist_id}","starred_url":"https://api.github.com/users/atifiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/atifiu/subscriptions","organizations_url":"https://api.github.com/users/atifiu/orgs","repos_url":"https://api.github.com/users/atifiu/repos","events_url":"https://api.github.com/users/atifiu/events{/privacy}","received_events_url":"https://api.github.com/users/atifiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-16T11:13:52Z","updated_at":"2023-10-16T11:13:52Z","author_association":"NONE","body":"@huaxingao Based on your suggestion, I have narrowed the filter criteria so that even considering the timezone problem, we dont filter on more than two partitions so that filter can be pushed down completely or filter complete partition by adjusting the time timestamp according to UTC time but in either case I see post-scan filters and no aggregate pushdown. Although I do see in the log. Please let me know what I am missing here.\r\n\r\n> \"Evaluating completely on Iceberg side: IsNotNull(initial_page_view_dtm)\"\r\n\r\n```\r\n23/10/16 06:36:08 INFO SparkScanBuilder: Evaluating completely on Iceberg side: IsNotNull(initial_page_view_dtm)\r\n23/10/16 06:36:08 INFO V2ScanRelationPushDown:\r\nPushing operators to spark_catalog.schema.table1\r\nPushed Filters: IsNotNull(initial_page_view_dtm), GreaterThanOrEqual(initial_page_view_dtm,2023-06-02 06:00:00.0), LessThanOrEqual(initial_page_view_dtm,2023-06-02 08:59:59.0)\r\nPost-Scan Filters: (initial_page_view_dtm#3 >= 2023-06-02 06:00:00),(initial_page_view_dtm#3 <= 2023-06-02 08:59:59)\r\n\r\n23/10/16 06:36:08 INFO V2ScanRelationPushDown:\r\nOutput: pageviewdate#0, initial_page_view_dtm#3\r\n\r\n23/10/16 06:36:09 INFO SnapshotScan: Scanning table spark_catalog.schema.table1 snapshot 3251312493606204579 created at 2023-10-05T08:25:16.490+00:00 with filter ((initial_page_view_dtm IS NOT NULL AND initial_page_view_dtm >= (16-digit-int)) AND initial_page_view_dtm <= (16-digit-int))\r\n23/10/16 06:36:09 INFO LoggingMetricsReporter: Received metrics report: ScanReport{tableName=spark_catalog.schema.table1, snapshotId=3251312493606204579, filter=((not_null(ref(name=\"initial_page_view_dtm\")) and ref(name=\"initial_page_view_dtm\") >= \"(16-digit-int)\") and ref(name=\"initial_page_view_dtm\") <= \"(16-digit-int)\"), schemaId=0, projectedFieldIds=[1, 4], projectedFieldNames=[pageviewdate, initial_page_view_dtm], scanMetrics=ScanMetricsResult{totalPlanningDuration=TimerResult{timeUnit=NANOSECONDS, totalDuration=PT0.383991592S, count=1}, resultDataFiles=CounterResult{unit=COUNT, value=1}, resultDeleteFiles=CounterResult{unit=COUNT, value=0}, totalDataManifests=CounterResult{unit=COUNT, value=68}, totalDeleteManifests=CounterResult{unit=COUNT, value=0}, scannedDataManifests=CounterResult{unit=COUNT, value=1}, skippedDataManifests=CounterResult{unit=COUNT, value=67}, totalFileSizeInBytes=CounterResult{unit=BYTES, value=340185692}, totalDeleteFileSizeInBytes=CounterResult{unit=BYTES, value=0}, skippedDataFiles=CounterResult{unit=COUNT, value=30}, skippedDeleteFiles=CounterResult{unit=COUNT, value=0}, scannedDeleteManifests=CounterResult{unit=COUNT, value=0}, skippedDeleteManifests=CounterResult{unit=COUNT, value=0}, indexedDeleteFiles=CounterResult{unit=COUNT, value=0}, equalityDeleteFiles=CounterResult{unit=COUNT, value=0}, positionalDeleteFiles=CounterResult{unit=COUNT, value=0}}, metadata={engine-version=3.3.1, iceberg-version=Apache Iceberg 1.3.0 (commit 7dbdfd33a667a721fbb21c7c7d06fec9daa30b88), app-id=application_1689900894764_104752, engine-name=spark}}\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1764246045/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1764363047","html_url":"https://github.com/apache/iceberg/pull/8834#issuecomment-1764363047","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8834","id":1764363047,"node_id":"IC_kwDOCW7NX85pKgsn","user":{"login":"advancedxy","id":807537,"node_id":"MDQ6VXNlcjgwNzUzNw==","avatar_url":"https://avatars.githubusercontent.com/u/807537?v=4","gravatar_id":"","url":"https://api.github.com/users/advancedxy","html_url":"https://github.com/advancedxy","followers_url":"https://api.github.com/users/advancedxy/followers","following_url":"https://api.github.com/users/advancedxy/following{/other_user}","gists_url":"https://api.github.com/users/advancedxy/gists{/gist_id}","starred_url":"https://api.github.com/users/advancedxy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/advancedxy/subscriptions","organizations_url":"https://api.github.com/users/advancedxy/orgs","repos_url":"https://api.github.com/users/advancedxy/repos","events_url":"https://api.github.com/users/advancedxy/events{/privacy}","received_events_url":"https://api.github.com/users/advancedxy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-16T12:24:59Z","updated_at":"2023-10-16T12:24:59Z","author_association":"CONTRIBUTOR","body":"> > Other than to revert the optimize in #8336, is it better to invalidate the cached `splitOffsetList`? The proposed change is in the `org.apache.iceberg.BaseFile#put` function:\r\n> > `\r\n> \r\n> The goal of this PR is to revert the code to a known working state. There are a couple of optimizations that could be made (e.g. to equality IDs also) but felt that belongs in a separate PR.\r\n\r\nIf the current PR is intended to be included in the hot fix version 1.4.1, then I think it's the safe way to revert the code.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1764363047/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1764681891","html_url":"https://github.com/apache/iceberg/pull/8808#issuecomment-1764681891","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8808","id":1764681891,"node_id":"IC_kwDOCW7NX85pLuij","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-16T15:02:30Z","updated_at":"2023-10-16T15:02:30Z","author_association":"CONTRIBUTOR","body":"> Some systems like older versions of Impala do not annotate String type as UTF-8 columns in Parquet files. When importing these Parquet files into Iceberg, reading these Binary columns will encounter type errors.\r\n\r\nThe code changes LGTM, but I wonder whether this issue isn't something that should be fixed in Impala itself?\r\nAlso curious what other think about fixing this in Iceberg @pvary @stevenzwu @Fokko ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1764681891/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1764861269","html_url":"https://github.com/apache/iceberg/pull/6252#issuecomment-1764861269","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6252","id":1764861269,"node_id":"IC_kwDOCW7NX85pMaVV","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-16T16:35:04Z","updated_at":"2023-10-16T16:35:04Z","author_association":"CONTRIBUTOR","body":"@atifiu Based on the log, only `IsNotNull(initial_page_view_dtm)` is completely evaluated on iceberg side. Both `(initial_page_view_dtm#3 >= 2023-06-02 06:00:00)` and `initial_page_view_dtm#3 <= 2023-06-02 08:59:59` are still evaluated on Spark side, that's why aggregates can't be pushed down. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1764861269/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1764912976","html_url":"https://github.com/apache/iceberg/pull/6252#issuecomment-1764912976","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6252","id":1764912976,"node_id":"IC_kwDOCW7NX85pMm9Q","user":{"login":"atifiu","id":48252551,"node_id":"MDQ6VXNlcjQ4MjUyNTUx","avatar_url":"https://avatars.githubusercontent.com/u/48252551?v=4","gravatar_id":"","url":"https://api.github.com/users/atifiu","html_url":"https://github.com/atifiu","followers_url":"https://api.github.com/users/atifiu/followers","following_url":"https://api.github.com/users/atifiu/following{/other_user}","gists_url":"https://api.github.com/users/atifiu/gists{/gist_id}","starred_url":"https://api.github.com/users/atifiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/atifiu/subscriptions","organizations_url":"https://api.github.com/users/atifiu/orgs","repos_url":"https://api.github.com/users/atifiu/repos","events_url":"https://api.github.com/users/atifiu/events{/privacy}","received_events_url":"https://api.github.com/users/atifiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-16T17:07:50Z","updated_at":"2023-10-16T17:07:50Z","author_association":"NONE","body":"@huaxingao So finally it is working but without `between `and `<=` operators. Yes, I have to tweak my query to adjust the timezone so that entire partition is picked by query.\r\n\r\n```\r\n23/10/16 13:03:17 INFO SparkScanBuilder: Evaluating completely on Iceberg side: IsNotNull(page_view_dtm)\r\n23/10/16 13:03:17 INFO SparkScanBuilder: Evaluating completely on Iceberg side: GreaterThanOrEqual(page_view_dtm,2022-12-31 19:00:00.0)\r\n23/10/16 13:03:17 INFO SparkScanBuilder: Evaluating completely on Iceberg side: LessThan(page_view_dtm,2023-01-01 19:00:00.0)\r\n23/10/16 13:03:17 INFO V2ScanRelationPushDown:\r\nPushing operators to spark_catalog.schema.table1\r\nPushed Filters: IsNotNull(page_view_dtm), GreaterThanOrEqual(page_view_dtm,2022-12-31 19:00:00.0), LessThan(page_view_dtm,2023-01-01 19:00:00.0)\r\nPost-Scan Filters:\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1764912976/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1765093921","html_url":"https://github.com/apache/iceberg/issues/7800#issuecomment-1765093921","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7800","id":1765093921,"node_id":"IC_kwDOCW7NX85pNTIh","user":{"login":"kangyang-wang","id":112408379,"node_id":"U_kgDOBrM3Ow","avatar_url":"https://avatars.githubusercontent.com/u/112408379?v=4","gravatar_id":"","url":"https://api.github.com/users/kangyang-wang","html_url":"https://github.com/kangyang-wang","followers_url":"https://api.github.com/users/kangyang-wang/followers","following_url":"https://api.github.com/users/kangyang-wang/following{/other_user}","gists_url":"https://api.github.com/users/kangyang-wang/gists{/gist_id}","starred_url":"https://api.github.com/users/kangyang-wang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kangyang-wang/subscriptions","organizations_url":"https://api.github.com/users/kangyang-wang/orgs","repos_url":"https://api.github.com/users/kangyang-wang/repos","events_url":"https://api.github.com/users/kangyang-wang/events{/privacy}","received_events_url":"https://api.github.com/users/kangyang-wang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-16T18:53:04Z","updated_at":"2023-10-16T18:53:04Z","author_association":"NONE","body":"Got the same issue here while trying to write to s3... Any solutions?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1765093921/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1765308407","html_url":"https://github.com/apache/iceberg/issues/8702#issuecomment-1765308407","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8702","id":1765308407,"node_id":"IC_kwDOCW7NX85pOHf3","user":{"login":"matternc","id":11986058,"node_id":"MDQ6VXNlcjExOTg2MDU4","avatar_url":"https://avatars.githubusercontent.com/u/11986058?v=4","gravatar_id":"","url":"https://api.github.com/users/matternc","html_url":"https://github.com/matternc","followers_url":"https://api.github.com/users/matternc/followers","following_url":"https://api.github.com/users/matternc/following{/other_user}","gists_url":"https://api.github.com/users/matternc/gists{/gist_id}","starred_url":"https://api.github.com/users/matternc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/matternc/subscriptions","organizations_url":"https://api.github.com/users/matternc/orgs","repos_url":"https://api.github.com/users/matternc/repos","events_url":"https://api.github.com/users/matternc/events{/privacy}","received_events_url":"https://api.github.com/users/matternc/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-16T21:30:26Z","updated_at":"2023-10-16T21:30:26Z","author_association":"NONE","body":"Further to this, i have actually had a lot of trouble getting delete from or merge into working with removing duplicate rows. Today the only way i have been able to remove deuplicates its by selecting a dataset and then using the Dataframe.dropDuplicates function in spark. Finally using the dynamic overwrite to rewrite the partition.\r\n\r\nDoes anyone know of a better way to do this. Everything i have done with merge into or delete from always results in all records being removed instead of just the duplicated rows.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1765308407/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1765411414","html_url":"https://github.com/apache/iceberg/issues/8847#issuecomment-1765411414","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8847","id":1765411414,"node_id":"IC_kwDOCW7NX85pOgpW","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-16T23:15:43Z","updated_at":"2023-10-16T23:15:43Z","author_association":"CONTRIBUTOR","body":"@stevenzwu, can you help us understand what is a problem with this and why it should be removed from the 1.4.1 release?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1765411414/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1765429213","html_url":"https://github.com/apache/iceberg/issues/8847#issuecomment-1765429213","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8847","id":1765429213,"node_id":"IC_kwDOCW7NX85pOk_d","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-16T23:38:06Z","updated_at":"2023-10-16T23:48:11Z","author_association":"CONTRIBUTOR","body":"@rdblue here is the recap from the discussions: https://github.com/apache/iceberg/pull/7161#issuecomment-1761169778\r\n\r\nPR #7161 automatically apply the custom bucketing partitioner to distribute buckets to writer tasks in a balanced way.[ It only looks at the bucket column](https://github.com/apache/iceberg/blob/main/flink/v1.17/flink/src/main/java/org/apache/iceberg/flink/sink/FlinkSink.java#L528-L531) (ignoring other partition columns) with the assumption that the bucket column is the main thing we need to distribute. \r\n\r\nBut a user reports that they have a partition spec like date, hour, minute, bucket(8). PR #7161 imposed a new default behavior that changed the distribution from simple keyBy on tuples with all partition columns to a custom partitioner with only bucket column. To me, the partition strategy is questionable. Bucket column is used here mainly to work around the OOM issue caused by skewed data distribution across partition columns and unbalanced value distribution from simple keyBy.\r\n\r\nIn the end, I feel it is safer to revert the behavior change from PR #7161 and ask users to manually apply the customer partitioner for the bucket column. Previously, we were thinking about automatically enable it when the partition spec has a bucketing column and hash distribution is set in table property.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1765429213/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1765457345","html_url":"https://github.com/apache/iceberg/issues/7280#issuecomment-1765457345","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7280","id":1765457345,"node_id":"IC_kwDOCW7NX85pOr3B","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-10-17T00:11:09Z","updated_at":"2023-10-17T00:11:09Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1765457345/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1765457375","html_url":"https://github.com/apache/iceberg/issues/7271#issuecomment-1765457375","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7271","id":1765457375,"node_id":"IC_kwDOCW7NX85pOr3f","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-10-17T00:11:11Z","updated_at":"2023-10-17T00:11:11Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1765457375/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1765460065","html_url":"https://github.com/apache/iceberg/issues/8847#issuecomment-1765460065","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8847","id":1765460065,"node_id":"IC_kwDOCW7NX85pOshh","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-17T00:14:19Z","updated_at":"2023-10-17T00:14:19Z","author_association":"CONTRIBUTOR","body":"Thanks, @stevenzwu! I agree that reverting the behavior change makes the most sense. We should be careful about default behavior changes and rolling back the change (but not the feature) sounds reasonable.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1765460065/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1765475158","html_url":"https://github.com/apache/iceberg/issues/8846#issuecomment-1765475158","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8846","id":1765475158,"node_id":"IC_kwDOCW7NX85pOwNW","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-17T00:34:58Z","updated_at":"2023-10-17T00:34:58Z","author_association":"MEMBER","body":"This is supported in Iceberg 1.4","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1765475158/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1765491318","html_url":"https://github.com/apache/iceberg/pull/7291#issuecomment-1765491318","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7291","id":1765491318,"node_id":"IC_kwDOCW7NX85pO0J2","user":{"login":"camper42","id":3177898,"node_id":"MDQ6VXNlcjMxNzc4OTg=","avatar_url":"https://avatars.githubusercontent.com/u/3177898?v=4","gravatar_id":"","url":"https://api.github.com/users/camper42","html_url":"https://github.com/camper42","followers_url":"https://api.github.com/users/camper42/followers","following_url":"https://api.github.com/users/camper42/following{/other_user}","gists_url":"https://api.github.com/users/camper42/gists{/gist_id}","starred_url":"https://api.github.com/users/camper42/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/camper42/subscriptions","organizations_url":"https://api.github.com/users/camper42/orgs","repos_url":"https://api.github.com/users/camper42/repos","events_url":"https://api.github.com/users/camper42/events{/privacy}","received_events_url":"https://api.github.com/users/camper42/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-17T01:00:23Z","updated_at":"2023-10-17T01:02:26Z","author_association":"NONE","body":"Any progress on this PR? We're having the same problem. our partition looks like `log_file_date=2023-10-16 00%3A00%3A00`","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1765491318/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1765499071","html_url":"https://github.com/apache/iceberg/pull/8808#issuecomment-1765499071","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8808","id":1765499071,"node_id":"IC_kwDOCW7NX85pO2C_","user":{"login":"fengjiajie","id":16379560,"node_id":"MDQ6VXNlcjE2Mzc5NTYw","avatar_url":"https://avatars.githubusercontent.com/u/16379560?v=4","gravatar_id":"","url":"https://api.github.com/users/fengjiajie","html_url":"https://github.com/fengjiajie","followers_url":"https://api.github.com/users/fengjiajie/followers","following_url":"https://api.github.com/users/fengjiajie/following{/other_user}","gists_url":"https://api.github.com/users/fengjiajie/gists{/gist_id}","starred_url":"https://api.github.com/users/fengjiajie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fengjiajie/subscriptions","organizations_url":"https://api.github.com/users/fengjiajie/orgs","repos_url":"https://api.github.com/users/fengjiajie/repos","events_url":"https://api.github.com/users/fengjiajie/events{/privacy}","received_events_url":"https://api.github.com/users/fengjiajie/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-17T01:11:35Z","updated_at":"2023-10-17T01:11:35Z","author_association":"CONTRIBUTOR","body":"> > Some systems like older versions of Impala do not annotate String type as UTF-8 columns in Parquet files. When importing these Parquet files into Iceberg, reading these Binary columns will encounter type errors.\r\n> \r\n> The code changes LGTM, but I wonder whether this issue isn't something that should be fixed in Impala itself? Also curious what other think about fixing this in Iceberg @pvary @stevenzwu @Fokko\r\n\r\nHi @nastra, thank you for the feedback.\r\nImpala is just an example. There are other Parquet data generated by various systems over the years that we want to add to the Iceberg table and read using Flink.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1765499071/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1765512670","html_url":"https://github.com/apache/iceberg/issues/3703#issuecomment-1765512670","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3703","id":1765512670,"node_id":"IC_kwDOCW7NX85pO5Xe","user":{"login":"RLashofRegas","id":35323472,"node_id":"MDQ6VXNlcjM1MzIzNDcy","avatar_url":"https://avatars.githubusercontent.com/u/35323472?v=4","gravatar_id":"","url":"https://api.github.com/users/RLashofRegas","html_url":"https://github.com/RLashofRegas","followers_url":"https://api.github.com/users/RLashofRegas/followers","following_url":"https://api.github.com/users/RLashofRegas/following{/other_user}","gists_url":"https://api.github.com/users/RLashofRegas/gists{/gist_id}","starred_url":"https://api.github.com/users/RLashofRegas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RLashofRegas/subscriptions","organizations_url":"https://api.github.com/users/RLashofRegas/orgs","repos_url":"https://api.github.com/users/RLashofRegas/repos","events_url":"https://api.github.com/users/RLashofRegas/events{/privacy}","received_events_url":"https://api.github.com/users/RLashofRegas/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-17T01:30:43Z","updated_at":"2023-10-17T01:30:43Z","author_association":"NONE","body":"@dchristle What was your solution that fixed the `Cannot broadcast the table that is larger than 8GB` issue? I just ran into the same problem on expire snapshots. I am using `max_concurrent_deletes => {concurrency}, stream_results => true` but this has made no difference.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1765512670/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1765530967","html_url":"https://github.com/apache/iceberg/pull/7161#issuecomment-1765530967","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7161","id":1765530967,"node_id":"IC_kwDOCW7NX85pO91X","user":{"login":"chenwyi2","id":19389434,"node_id":"MDQ6VXNlcjE5Mzg5NDM0","avatar_url":"https://avatars.githubusercontent.com/u/19389434?v=4","gravatar_id":"","url":"https://api.github.com/users/chenwyi2","html_url":"https://github.com/chenwyi2","followers_url":"https://api.github.com/users/chenwyi2/followers","following_url":"https://api.github.com/users/chenwyi2/following{/other_user}","gists_url":"https://api.github.com/users/chenwyi2/gists{/gist_id}","starred_url":"https://api.github.com/users/chenwyi2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenwyi2/subscriptions","organizations_url":"https://api.github.com/users/chenwyi2/orgs","repos_url":"https://api.github.com/users/chenwyi2/repos","events_url":"https://api.github.com/users/chenwyi2/events{/privacy}","received_events_url":"https://api.github.com/users/chenwyi2/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-17T01:53:40Z","updated_at":"2023-10-17T01:53:40Z","author_association":"NONE","body":"In normal conditition, only the data of current minute will be written. However, if the data is delayed, for example, at 11:50, the data has not been written until  11:55, then at 11:56 will commit data composed by 11:51,11:52,...11:56, in this situation some small fies can be created","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1765530967/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1765624174","html_url":"https://github.com/apache/iceberg/pull/8844#issuecomment-1765624174","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8844","id":1765624174,"node_id":"IC_kwDOCW7NX85pPUlu","user":{"login":"rice668","id":6520673,"node_id":"MDQ6VXNlcjY1MjA2NzM=","avatar_url":"https://avatars.githubusercontent.com/u/6520673?v=4","gravatar_id":"","url":"https://api.github.com/users/rice668","html_url":"https://github.com/rice668","followers_url":"https://api.github.com/users/rice668/followers","following_url":"https://api.github.com/users/rice668/following{/other_user}","gists_url":"https://api.github.com/users/rice668/gists{/gist_id}","starred_url":"https://api.github.com/users/rice668/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rice668/subscriptions","organizations_url":"https://api.github.com/users/rice668/orgs","repos_url":"https://api.github.com/users/rice668/repos","events_url":"https://api.github.com/users/rice668/events{/privacy}","received_events_url":"https://api.github.com/users/rice668/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-17T03:57:50Z","updated_at":"2023-10-17T03:58:39Z","author_association":"CONTRIBUTOR","body":"@nastra Thanks for your review, code updated done. Does the latest code looks good to you ?  ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1765624174/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1765657323","html_url":"https://github.com/apache/iceberg/pull/8844#issuecomment-1765657323","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8844","id":1765657323,"node_id":"IC_kwDOCW7NX85pPcrr","user":{"login":"lirui-apache","id":5210788,"node_id":"MDQ6VXNlcjUyMTA3ODg=","avatar_url":"https://avatars.githubusercontent.com/u/5210788?v=4","gravatar_id":"","url":"https://api.github.com/users/lirui-apache","html_url":"https://github.com/lirui-apache","followers_url":"https://api.github.com/users/lirui-apache/followers","following_url":"https://api.github.com/users/lirui-apache/following{/other_user}","gists_url":"https://api.github.com/users/lirui-apache/gists{/gist_id}","starred_url":"https://api.github.com/users/lirui-apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lirui-apache/subscriptions","organizations_url":"https://api.github.com/users/lirui-apache/orgs","repos_url":"https://api.github.com/users/lirui-apache/repos","events_url":"https://api.github.com/users/lirui-apache/events{/privacy}","received_events_url":"https://api.github.com/users/lirui-apache/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-17T04:43:16Z","updated_at":"2023-10-17T04:43:16Z","author_association":"CONTRIBUTOR","body":"Thanks @zhangminglei for working on this. I guess we also need to update the doc in `CatalogProperties` to indicate the change.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1765657323/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1765662039","html_url":"https://github.com/apache/iceberg/issues/8847#issuecomment-1765662039","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8847","id":1765662039,"node_id":"IC_kwDOCW7NX85pPd1X","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-17T04:50:03Z","updated_at":"2023-10-17T04:50:03Z","author_association":"CONTRIBUTOR","body":"> We should be careful about default behavior changes \r\n\r\nagree. This is on me with the wrong assumption that bucketing column is the only thing need to be distributed.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1765662039/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1765668208","html_url":"https://github.com/apache/iceberg/issues/8849#issuecomment-1765668208","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8849","id":1765668208,"node_id":"IC_kwDOCW7NX85pPfVw","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-17T04:57:50Z","updated_at":"2023-10-17T04:57:50Z","author_association":"MEMBER","body":"> long currentRef = table.currentSnapshot().snapshotId();\r\n\r\nSince the `audit-branch` is empty we have `table.currentSnapshot()` as null and it leads to NPE, this should be fixed. I will take a look.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1765668208/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1765768056","html_url":"https://github.com/apache/iceberg/issues/5565#issuecomment-1765768056","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5565","id":1765768056,"node_id":"IC_kwDOCW7NX85pP3t4","user":{"login":"AlbertoSoto25","id":95859702,"node_id":"U_kgDOBbaz9g","avatar_url":"https://avatars.githubusercontent.com/u/95859702?v=4","gravatar_id":"","url":"https://api.github.com/users/AlbertoSoto25","html_url":"https://github.com/AlbertoSoto25","followers_url":"https://api.github.com/users/AlbertoSoto25/followers","following_url":"https://api.github.com/users/AlbertoSoto25/following{/other_user}","gists_url":"https://api.github.com/users/AlbertoSoto25/gists{/gist_id}","starred_url":"https://api.github.com/users/AlbertoSoto25/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlbertoSoto25/subscriptions","organizations_url":"https://api.github.com/users/AlbertoSoto25/orgs","repos_url":"https://api.github.com/users/AlbertoSoto25/repos","events_url":"https://api.github.com/users/AlbertoSoto25/events{/privacy}","received_events_url":"https://api.github.com/users/AlbertoSoto25/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-17T06:43:36Z","updated_at":"2023-10-17T06:44:17Z","author_association":"NONE","body":"> Hello again @singhpk234 ,\r\n> \r\n> I was able to fix the issue by rewriting all the code based on official AWS docs, append function started to working again. I was not able to fix the `sparkSession.catalog.tableExists(s\"$catalog.$dbName.$tableName\")`, so I did a workaround that is working as expected:\r\n> \r\n> ```\r\n>   def doesTableExistIceberg(spark: SparkSession, table: String): Boolean = {\r\n>       println(s\"Checking if table $table exists\")\r\n>       Try {spark.read.table(table)} match {\r\n>     case Success(i) => true\r\n>     case Failure(s) => println(s\"Failed. Reason: $s\"); false\r\n> }\r\n> ```\r\n> \r\n> Thanks for your help\r\n\r\nHi, could you show us the doc in order to achieve it? I need the same implementation as you and I cannot find it.\r\n\r\nThanks","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1765768056/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1765789016","html_url":"https://github.com/apache/iceberg/issues/8849#issuecomment-1765789016","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8849","id":1765789016,"node_id":"IC_kwDOCW7NX85pP81Y","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-17T07:00:52Z","updated_at":"2023-10-17T07:00:52Z","author_association":"MEMBER","body":"Hmm, It is not just the null check addition in the procedure, later it fails because reference MAIN does not exist during replace branch. \r\n\r\nhttps://github.com/apache/iceberg/blob/46cad6ddaeff8104d96defab25206a4ff7e01629/core/src/main/java/org/apache/iceberg/UpdateSnapshotReferencesOperation.java#L123\r\n\r\nThe reason is we create the main branch only during first snapshot creation. \r\nBut in this scenario there is no main branch exist for replace operation. \r\nI thought of blocking this scenario by throwing an exception. But since we support creating empty branch (from https://github.com/apache/iceberg/pull/8072/), we should also support replacing to/from empty branch. \r\n\r\nI am thinking to add an empty/dummy snapshot for create table operation with MAIN reference in a sparate PR to tackle this.\r\nLet me know what you guys think, @amogh-jahagirdar, @ConeyLiu , @rdblue  ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1765789016/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1765832884","html_url":"https://github.com/apache/iceberg/issues/8850#issuecomment-1765832884","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8850","id":1765832884,"node_id":"IC_kwDOCW7NX85pQHi0","user":{"login":"liurenjie1024","id":2771941,"node_id":"MDQ6VXNlcjI3NzE5NDE=","avatar_url":"https://avatars.githubusercontent.com/u/2771941?v=4","gravatar_id":"","url":"https://api.github.com/users/liurenjie1024","html_url":"https://github.com/liurenjie1024","followers_url":"https://api.github.com/users/liurenjie1024/followers","following_url":"https://api.github.com/users/liurenjie1024/following{/other_user}","gists_url":"https://api.github.com/users/liurenjie1024/gists{/gist_id}","starred_url":"https://api.github.com/users/liurenjie1024/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liurenjie1024/subscriptions","organizations_url":"https://api.github.com/users/liurenjie1024/orgs","repos_url":"https://api.github.com/users/liurenjie1024/repos","events_url":"https://api.github.com/users/liurenjie1024/events{/privacy}","received_events_url":"https://api.github.com/users/liurenjie1024/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-17T07:33:12Z","updated_at":"2023-10-17T07:33:12Z","author_association":"CONTRIBUTOR","body":"I'll take this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1765832884/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1765938139","html_url":"https://github.com/apache/iceberg/issues/8802#issuecomment-1765938139","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8802","id":1765938139,"node_id":"IC_kwDOCW7NX85pQhPb","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-17T08:35:24Z","updated_at":"2023-10-17T08:35:24Z","author_association":"CONTRIBUTOR","body":"> > Sometimes we need to do similar thing in Flink Source, and we ended up creating our own comparator for this which compares Iceberg splits (which are a wrapper above ScanTasks).\r\n> \r\n> I'm sorry, I didn't quite understand this point. Could you please explain it in more detail?\r\n\r\nWe fetch all the tasks for a given plan here (and covert it to an IcebergSplit using `fromCombinedScanTask`):\r\nhttps://github.com/apache/iceberg/blob/46cad6ddaeff8104d96defab25206a4ff7e01629/flink/v1.17/flink/src/main/java/org/apache/iceberg/flink/source/FlinkSplitPlanner.java#L73-L82\r\n\r\nAnd we use  a [SerializableComparator](https://github.com/apache/iceberg/blob/46cad6ddaeff8104d96defab25206a4ff7e01629/flink/v1.17/flink/src/main/java/org/apache/iceberg/flink/source/split/SplitComparators.java#L33) to order the splits before assigning them:\r\nhttps://github.com/apache/iceberg/blob/46cad6ddaeff8104d96defab25206a4ff7e01629/flink/v1.17/flink/src/main/java/org/apache/iceberg/flink/source/assigner/DefaultSplitAssigner.java#L44-L46\r\n\r\nI hope this helps!\r\n\r\nThanks,\r\nPeter","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1765938139/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1765954472","html_url":"https://github.com/apache/iceberg/pull/8808#issuecomment-1765954472","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8808","id":1765954472,"node_id":"IC_kwDOCW7NX85pQlOo","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-17T08:44:45Z","updated_at":"2023-10-17T08:44:45Z","author_association":"CONTRIBUTOR","body":"This is a small change, so it might not be too hard to keep the different Flink version changes in sync, but usually we introduce the changes on the latest Flink, and then create a different backport PR to backport them to the older Flink versions.\r\n\r\nThis is better for the reviewer, as the change is smaller and easier to focus on the issues, and better for the contributor since when changes are required then they are not needed to be continuously merged to the other branches. And when the backport time comes, it is easier to check the backport specific changes.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1765954472/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1766049159","html_url":"https://github.com/apache/iceberg/issues/8511#issuecomment-1766049159","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8511","id":1766049159,"node_id":"IC_kwDOCW7NX85pQ8WH","user":{"login":"372242283","id":43502242,"node_id":"MDQ6VXNlcjQzNTAyMjQy","avatar_url":"https://avatars.githubusercontent.com/u/43502242?v=4","gravatar_id":"","url":"https://api.github.com/users/372242283","html_url":"https://github.com/372242283","followers_url":"https://api.github.com/users/372242283/followers","following_url":"https://api.github.com/users/372242283/following{/other_user}","gists_url":"https://api.github.com/users/372242283/gists{/gist_id}","starred_url":"https://api.github.com/users/372242283/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/372242283/subscriptions","organizations_url":"https://api.github.com/users/372242283/orgs","repos_url":"https://api.github.com/users/372242283/repos","events_url":"https://api.github.com/users/372242283/events{/privacy}","received_events_url":"https://api.github.com/users/372242283/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-17T09:39:57Z","updated_at":"2023-10-17T09:39:57Z","author_association":"NONE","body":"I also encountered this issue by checking that the field 'COMMENT' in the table 'COLUMNS-V2' in HMS is null and not written in\r\n![image](https://github.com/apache/iceberg/assets/43502242/81df718d-69ed-4066-a924-284485c129a5)\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1766049159/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1766051674","html_url":"https://github.com/apache/iceberg/pull/8766#issuecomment-1766051674","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8766","id":1766051674,"node_id":"IC_kwDOCW7NX85pQ89a","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-17T09:41:32Z","updated_at":"2023-10-17T09:41:54Z","author_association":"CONTRIBUTOR","body":"For me it looks like the file was created by the daemon:\r\n```\r\n  ls -lah /var/run/docker.sock\r\nlrwxr-xr-x  1 root  daemon    46B Oct 16 16:32 /var/run/docker.sock -> /Users/fokkodriesprong/.docker/run/docker.sock\r\n  last reboot                         \r\nreboot time                                Mon Oct 16 16:29\r\n```\r\n(I started docker just after my reboot)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1766051674/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1766072686","html_url":"https://github.com/apache/iceberg/pull/8766#issuecomment-1766072686","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8766","id":1766072686,"node_id":"IC_kwDOCW7NX85pRCFu","user":{"login":"jbonofre","id":158903,"node_id":"MDQ6VXNlcjE1ODkwMw==","avatar_url":"https://avatars.githubusercontent.com/u/158903?v=4","gravatar_id":"","url":"https://api.github.com/users/jbonofre","html_url":"https://github.com/jbonofre","followers_url":"https://api.github.com/users/jbonofre/followers","following_url":"https://api.github.com/users/jbonofre/following{/other_user}","gists_url":"https://api.github.com/users/jbonofre/gists{/gist_id}","starred_url":"https://api.github.com/users/jbonofre/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jbonofre/subscriptions","organizations_url":"https://api.github.com/users/jbonofre/orgs","repos_url":"https://api.github.com/users/jbonofre/repos","events_url":"https://api.github.com/users/jbonofre/events{/privacy}","received_events_url":"https://api.github.com/users/jbonofre/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-17T09:53:32Z","updated_at":"2023-10-17T09:53:32Z","author_association":"MEMBER","body":"@Fokko I think anyone using docker-desktop on Mac will have the same issue. So it applies for 99% of the MacOS users. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1766072686/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1766080354","html_url":"https://github.com/apache/iceberg/pull/8766#issuecomment-1766080354","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8766","id":1766080354,"node_id":"IC_kwDOCW7NX85pRD9i","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-17T09:58:02Z","updated_at":"2023-10-17T09:58:02Z","author_association":"CONTRIBUTOR","body":"@jbonofre  I'm running docker desktop as well","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1766080354/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1766082002","html_url":"https://github.com/apache/iceberg/pull/8766#issuecomment-1766082002","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8766","id":1766082002,"node_id":"IC_kwDOCW7NX85pREXS","user":{"login":"jbonofre","id":158903,"node_id":"MDQ6VXNlcjE1ODkwMw==","avatar_url":"https://avatars.githubusercontent.com/u/158903?v=4","gravatar_id":"","url":"https://api.github.com/users/jbonofre","html_url":"https://github.com/jbonofre","followers_url":"https://api.github.com/users/jbonofre/followers","following_url":"https://api.github.com/users/jbonofre/following{/other_user}","gists_url":"https://api.github.com/users/jbonofre/gists{/gist_id}","starred_url":"https://api.github.com/users/jbonofre/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jbonofre/subscriptions","organizations_url":"https://api.github.com/users/jbonofre/orgs","repos_url":"https://api.github.com/users/jbonofre/repos","events_url":"https://api.github.com/users/jbonofre/events{/privacy}","received_events_url":"https://api.github.com/users/jbonofre/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-17T09:59:10Z","updated_at":"2023-10-17T09:59:10Z","author_association":"MEMBER","body":"@Fokko and you don't have the symbolic link ? Did you install docker-desktop from homebrew cask ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1766082002/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1766144239","html_url":"https://github.com/apache/iceberg/pull/8808#issuecomment-1766144239","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8808","id":1766144239,"node_id":"IC_kwDOCW7NX85pRTjv","user":{"login":"fengjiajie","id":16379560,"node_id":"MDQ6VXNlcjE2Mzc5NTYw","avatar_url":"https://avatars.githubusercontent.com/u/16379560?v=4","gravatar_id":"","url":"https://api.github.com/users/fengjiajie","html_url":"https://github.com/fengjiajie","followers_url":"https://api.github.com/users/fengjiajie/followers","following_url":"https://api.github.com/users/fengjiajie/following{/other_user}","gists_url":"https://api.github.com/users/fengjiajie/gists{/gist_id}","starred_url":"https://api.github.com/users/fengjiajie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fengjiajie/subscriptions","organizations_url":"https://api.github.com/users/fengjiajie/orgs","repos_url":"https://api.github.com/users/fengjiajie/repos","events_url":"https://api.github.com/users/fengjiajie/events{/privacy}","received_events_url":"https://api.github.com/users/fengjiajie/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-17T10:37:24Z","updated_at":"2023-10-17T10:37:24Z","author_association":"CONTRIBUTOR","body":"> This is a small change, so it might not be too hard to keep the different Flink version changes in sync, but usually we introduce the changes on the latest Flink, and then create a different backport PR to backport them to the older Flink versions.\r\n> \r\n> This is better for the reviewer, as the change is smaller and easier to focus on the issues, and better for the contributor since when changes are required then they are not needed to be continuously merged to the other branches. And when the backport time comes, it is easier to check the backport specific changes.\r\n\r\nThank you for your review suggestions. I have made the changes to only include flink 1.17.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1766144239/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1766177686","html_url":"https://github.com/apache/iceberg/issues/8511#issuecomment-1766177686","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8511","id":1766177686,"node_id":"IC_kwDOCW7NX85pRbuW","user":{"login":"huyuanfeng2018","id":40817998,"node_id":"MDQ6VXNlcjQwODE3OTk4","avatar_url":"https://avatars.githubusercontent.com/u/40817998?v=4","gravatar_id":"","url":"https://api.github.com/users/huyuanfeng2018","html_url":"https://github.com/huyuanfeng2018","followers_url":"https://api.github.com/users/huyuanfeng2018/followers","following_url":"https://api.github.com/users/huyuanfeng2018/following{/other_user}","gists_url":"https://api.github.com/users/huyuanfeng2018/gists{/gist_id}","starred_url":"https://api.github.com/users/huyuanfeng2018/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huyuanfeng2018/subscriptions","organizations_url":"https://api.github.com/users/huyuanfeng2018/orgs","repos_url":"https://api.github.com/users/huyuanfeng2018/repos","events_url":"https://api.github.com/users/huyuanfeng2018/events{/privacy}","received_events_url":"https://api.github.com/users/huyuanfeng2018/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-17T10:59:17Z","updated_at":"2023-10-17T11:03:17Z","author_association":"CONTRIBUTOR","body":"@stevenzwu In flink1.16 and before, it was impossible to parse the comment in the table creation statement. Starting from 1.17, the flink community completed this part of the logic, so I think iceberg should support parsing this part of the information and adding the comment to the field. WDYT, I can do this part\r\nhttps://issues.apache.org/jira/browse/FLINK-29679","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1766177686/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1766265102","html_url":"https://github.com/apache/iceberg/pull/8854#issuecomment-1766265102","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8854","id":1766265102,"node_id":"IC_kwDOCW7NX85pRxEO","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-17T11:55:11Z","updated_at":"2023-10-17T11:55:11Z","author_association":"CONTRIBUTOR","body":"also cc @rakesh-das08 let me know your thoughts on this fix!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1766265102/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1766286164","html_url":"https://github.com/apache/iceberg/pull/6252#issuecomment-1766286164","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6252","id":1766286164,"node_id":"IC_kwDOCW7NX85pR2NU","user":{"login":"atifiu","id":48252551,"node_id":"MDQ6VXNlcjQ4MjUyNTUx","avatar_url":"https://avatars.githubusercontent.com/u/48252551?v=4","gravatar_id":"","url":"https://api.github.com/users/atifiu","html_url":"https://github.com/atifiu","followers_url":"https://api.github.com/users/atifiu/followers","following_url":"https://api.github.com/users/atifiu/following{/other_user}","gists_url":"https://api.github.com/users/atifiu/gists{/gist_id}","starred_url":"https://api.github.com/users/atifiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/atifiu/subscriptions","organizations_url":"https://api.github.com/users/atifiu/orgs","repos_url":"https://api.github.com/users/atifiu/repos","events_url":"https://api.github.com/users/atifiu/events{/privacy}","received_events_url":"https://api.github.com/users/atifiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-17T12:08:51Z","updated_at":"2023-10-17T12:08:51Z","author_association":"NONE","body":"@amogh-jahagirdar I think I know how these delete files are generated even though copy on write is defined at table level. I have executed the delete from Trino and since it only supports merge on read these delete files are generated. Now I am finding it really difficult to remove these delete files. Will try removing partition to see if they will be removed or not.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1766286164/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1766306045","html_url":"https://github.com/apache/iceberg/pull/8625#issuecomment-1766306045","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8625","id":1766306045,"node_id":"IC_kwDOCW7NX85pR7D9","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-17T12:21:29Z","updated_at":"2023-10-17T12:21:29Z","author_association":"CONTRIBUTOR","body":"I just realized that this would also speed up operations snapshot expiration, because we do need to access the manifest files, but don't need to use the metrics.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1766306045/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1766321748","html_url":"https://github.com/apache/iceberg/pull/8854#issuecomment-1766321748","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8854","id":1766321748,"node_id":"IC_kwDOCW7NX85pR-5U","user":{"login":"rakesh-das08","id":16017562,"node_id":"MDQ6VXNlcjE2MDE3NTYy","avatar_url":"https://avatars.githubusercontent.com/u/16017562?v=4","gravatar_id":"","url":"https://api.github.com/users/rakesh-das08","html_url":"https://github.com/rakesh-das08","followers_url":"https://api.github.com/users/rakesh-das08/followers","following_url":"https://api.github.com/users/rakesh-das08/following{/other_user}","gists_url":"https://api.github.com/users/rakesh-das08/gists{/gist_id}","starred_url":"https://api.github.com/users/rakesh-das08/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rakesh-das08/subscriptions","organizations_url":"https://api.github.com/users/rakesh-das08/orgs","repos_url":"https://api.github.com/users/rakesh-das08/repos","events_url":"https://api.github.com/users/rakesh-das08/events{/privacy}","received_events_url":"https://api.github.com/users/rakesh-das08/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-17T12:30:29Z","updated_at":"2023-10-17T12:30:29Z","author_association":"CONTRIBUTOR","body":"@amogh-jahagirdar the fix LGTM. Thanks for fixing this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1766321748/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1766378641","html_url":"https://github.com/apache/iceberg/pull/8625#issuecomment-1766378641","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8625","id":1766378641,"node_id":"IC_kwDOCW7NX85pSMyR","user":{"login":"rustyconover","id":731941,"node_id":"MDQ6VXNlcjczMTk0MQ==","avatar_url":"https://avatars.githubusercontent.com/u/731941?v=4","gravatar_id":"","url":"https://api.github.com/users/rustyconover","html_url":"https://github.com/rustyconover","followers_url":"https://api.github.com/users/rustyconover/followers","following_url":"https://api.github.com/users/rustyconover/following{/other_user}","gists_url":"https://api.github.com/users/rustyconover/gists{/gist_id}","starred_url":"https://api.github.com/users/rustyconover/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rustyconover/subscriptions","organizations_url":"https://api.github.com/users/rustyconover/orgs","repos_url":"https://api.github.com/users/rustyconover/repos","events_url":"https://api.github.com/users/rustyconover/events{/privacy}","received_events_url":"https://api.github.com/users/rustyconover/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-17T13:04:21Z","updated_at":"2023-10-17T13:04:21Z","author_association":"CONTRIBUTOR","body":"Yes it would!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1766378641/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1766410898","html_url":"https://github.com/apache/iceberg/pull/8854#issuecomment-1766410898","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8854","id":1766410898,"node_id":"IC_kwDOCW7NX85pSUqS","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-17T13:23:02Z","updated_at":"2023-10-17T13:23:02Z","author_association":"MEMBER","body":"logged the flaky test: #8855 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1766410898/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1766722846","html_url":"https://github.com/apache/iceberg/issues/8847#issuecomment-1766722846","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8847","id":1766722846,"node_id":"IC_kwDOCW7NX85pTg0e","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-17T16:03:20Z","updated_at":"2023-10-17T16:03:20Z","author_association":"CONTRIBUTOR","body":"Closing this as #8848 has been merged to main and I backported it to 1.4.x in https://github.com/apache/iceberg/pull/8858","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1766722846/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1766749771","html_url":"https://github.com/apache/iceberg/pull/8860#issuecomment-1766749771","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8860","id":1766749771,"node_id":"IC_kwDOCW7NX85pTnZL","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-17T16:18:53Z","updated_at":"2023-10-17T16:18:53Z","author_association":"CONTRIBUTOR","body":"cc @bryanck ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1766749771/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1766762691","html_url":"https://github.com/apache/iceberg/pull/8843#issuecomment-1766762691","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8843","id":1766762691,"node_id":"IC_kwDOCW7NX85pTqjD","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-17T16:25:39Z","updated_at":"2023-10-17T16:25:39Z","author_association":"CONTRIBUTOR","body":"@nastra and @singhpk234, is this safe for a patch release? It seems like a behavior change that would only be safe if the behavior is always the same when creating multiple credentials providers.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1766762691/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1766792091","html_url":"https://github.com/apache/iceberg/issues/7154#issuecomment-1766792091","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7154","id":1766792091,"node_id":"IC_kwDOCW7NX85pTxub","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-17T16:41:35Z","updated_at":"2023-10-17T16:41:35Z","author_association":"CONTRIBUTOR","body":"I've opened https://github.com/apache/iceberg/pull/8853 and https://github.com/apache/iceberg/pull/8852 to give an idea about places that are good candidates to replace with Awaitility. I believe there are more similar places in the codebase that can be fixed as part of #7154","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1766792091/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1766801596","html_url":"https://github.com/apache/iceberg/pull/8843#issuecomment-1766801596","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8843","id":1766801596,"node_id":"IC_kwDOCW7NX85pT0C8","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-17T16:47:56Z","updated_at":"2023-10-17T16:47:56Z","author_association":"CONTRIBUTOR","body":"> @nastra and @singhpk234, is this safe for a patch release? It seems like a behavior change that would only be safe if the behavior is always the same when creating multiple credentials providers.\r\n\r\nIt appears that multiple people ran into this issue with 1.3.1 on [Slack and on the ML](https://lists.apache.org/thread/1nwb11v1qn1nr86stofkvqlb32fp0q9d). I don't think those people have an easy way to resolve the issue on their own (without building a custom jar with the proposed fix)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1766801596/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1766827281","html_url":"https://github.com/apache/iceberg/pull/8843#issuecomment-1766827281","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8843","id":1766827281,"node_id":"IC_kwDOCW7NX85pT6UR","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-17T17:05:18Z","updated_at":"2023-10-17T17:05:18Z","author_association":"CONTRIBUTOR","body":"> would only be safe if the behavior is always the same when creating multiple credentials providers.\r\n\r\n@rdblue I think it is a safe change from a static global singleton to creating new objects for object lifecycle management","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1766827281/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1766844420","html_url":"https://github.com/apache/iceberg/pull/8803#issuecomment-1766844420","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8803","id":1766844420,"node_id":"IC_kwDOCW7NX85pT-gE","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-17T17:16:30Z","updated_at":"2023-10-17T17:16:30Z","author_association":"CONTRIBUTOR","body":"@pvary I think we probably want to push the `copyStatsForColumns` down to ManifestReader. https://github.com/apache/iceberg/blob/main/core/src/main/java/org/apache/iceberg/ManifestReader.java#L299","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1766844420/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1766912688","html_url":"https://github.com/apache/iceberg/pull/8799#issuecomment-1766912688","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8799","id":1766912688,"node_id":"IC_kwDOCW7NX85pUPKw","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-17T18:06:47Z","updated_at":"2023-10-17T18:06:47Z","author_association":"CONTRIBUTOR","body":"cc @aokolnychyi  @RussellSpitzer ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1766912688/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1767000250","html_url":"https://github.com/apache/iceberg/pull/8843#issuecomment-1767000250","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8843","id":1767000250,"node_id":"IC_kwDOCW7NX85pUki6","user":{"login":"singhpk234","id":35593236,"node_id":"MDQ6VXNlcjM1NTkzMjM2","avatar_url":"https://avatars.githubusercontent.com/u/35593236?v=4","gravatar_id":"","url":"https://api.github.com/users/singhpk234","html_url":"https://github.com/singhpk234","followers_url":"https://api.github.com/users/singhpk234/followers","following_url":"https://api.github.com/users/singhpk234/following{/other_user}","gists_url":"https://api.github.com/users/singhpk234/gists{/gist_id}","starred_url":"https://api.github.com/users/singhpk234/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/singhpk234/subscriptions","organizations_url":"https://api.github.com/users/singhpk234/orgs","repos_url":"https://api.github.com/users/singhpk234/repos","events_url":"https://api.github.com/users/singhpk234/events{/privacy}","received_events_url":"https://api.github.com/users/singhpk234/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-17T19:06:13Z","updated_at":"2023-10-17T19:08:25Z","author_association":"CONTRIBUTOR","body":"> It seems like a behavior change that would only be safe if the behavior is always the same when creating multiple credentials providers.\r\n\r\nchecked the DEFAULT_CREDENTIALS_PROVIDER singleton supplied earlier, it will be same as that what we would be creating now via `DefaultCredentialsProvider.builder().build()` as far a creds looks up is concerned (no behaviour change), never the less we have been creating a new cred provider instance when ever we supply accessKey or accessKeyId via `StaticCredentialsProvider.create(AwsCreds)`. Considering all of above we should be good imho to include it in the patch release :) !!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1767000250/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1767003787","html_url":"https://github.com/apache/iceberg/pull/8799#issuecomment-1767003787","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8799","id":1767003787,"node_id":"IC_kwDOCW7NX85pUlaL","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-17T19:08:49Z","updated_at":"2023-10-17T19:08:49Z","author_association":"CONTRIBUTOR","body":"What's the argument for including this in 1.4.1? It seems like a behavior change that isn't fixing a regression.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1767003787/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1767011681","html_url":"https://github.com/apache/iceberg/pull/8860#issuecomment-1767011681","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8860","id":1767011681,"node_id":"IC_kwDOCW7NX85pUnVh","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-17T19:15:02Z","updated_at":"2023-10-17T19:15:02Z","author_association":"CONTRIBUTOR","body":"Merged. Thanks for getting this read, @amogh-jahagirdar!\r\n\r\nFor context, this catches bad metadata written by 1.4.0 and ignores it. This is needed if tables have bad split offsets in order to be read by Spark, Hive, and Flink.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1767011681/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1767090521","html_url":"https://github.com/apache/iceberg/pull/8799#issuecomment-1767090521","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8799","id":1767090521,"node_id":"IC_kwDOCW7NX85pU6lZ","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-17T20:07:12Z","updated_at":"2023-10-17T20:07:12Z","author_association":"CONTRIBUTOR","body":"Hi @rdblue, yes, we don't have to include it in 1.4.1 if it is behavior change. I'd consider it more a bug fix though. But open for ideas.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1767090521/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1767331436","html_url":"https://github.com/apache/iceberg/issues/3703#issuecomment-1767331436","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3703","id":1767331436,"node_id":"IC_kwDOCW7NX85pV1Zs","user":{"login":"RLashofRegas","id":35323472,"node_id":"MDQ6VXNlcjM1MzIzNDcy","avatar_url":"https://avatars.githubusercontent.com/u/35323472?v=4","gravatar_id":"","url":"https://api.github.com/users/RLashofRegas","html_url":"https://github.com/RLashofRegas","followers_url":"https://api.github.com/users/RLashofRegas/followers","following_url":"https://api.github.com/users/RLashofRegas/following{/other_user}","gists_url":"https://api.github.com/users/RLashofRegas/gists{/gist_id}","starred_url":"https://api.github.com/users/RLashofRegas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RLashofRegas/subscriptions","organizations_url":"https://api.github.com/users/RLashofRegas/orgs","repos_url":"https://api.github.com/users/RLashofRegas/repos","events_url":"https://api.github.com/users/RLashofRegas/events{/privacy}","received_events_url":"https://api.github.com/users/RLashofRegas/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-17T23:08:08Z","updated_at":"2023-10-17T23:08:08Z","author_association":"NONE","body":"@RussellSpitzer You mentioned you were working on a patch that might affect this. Should I expect the issue I mentioned above to go away if we upgraded to a more recent version of Iceberg? Currently on 0.14.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1767331436/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1767362201","html_url":"https://github.com/apache/iceberg/issues/3703#issuecomment-1767362201","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3703","id":1767362201,"node_id":"IC_kwDOCW7NX85pV86Z","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-17T23:42:38Z","updated_at":"2023-10-17T23:42:38Z","author_association":"MEMBER","body":"Not for broadcast, for that you just need to disable broadcast join in spark ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1767362201/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1767364918","html_url":"https://github.com/apache/iceberg/issues/8862#issuecomment-1767364918","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8862","id":1767364918,"node_id":"IC_kwDOCW7NX85pV9k2","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-17T23:46:01Z","updated_at":"2023-10-17T23:46:01Z","author_association":"MEMBER","body":"It is distributed in file discovery. Do you mean have the deletes distributed? Previously we didn't want to do this because it's very difficult to control parallelism of delete requests ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1767364918/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1767384603","html_url":"https://github.com/apache/iceberg/issues/7288#issuecomment-1767384603","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7288","id":1767384603,"node_id":"IC_kwDOCW7NX85pWCYb","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-10-18T00:11:06Z","updated_at":"2023-10-18T00:11:06Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1767384603/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1767384651","html_url":"https://github.com/apache/iceberg/issues/7285#issuecomment-1767384651","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7285","id":1767384651,"node_id":"IC_kwDOCW7NX85pWCZL","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-10-18T00:11:09Z","updated_at":"2023-10-18T00:11:09Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1767384651/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1767384670","html_url":"https://github.com/apache/iceberg/issues/7238#issuecomment-1767384670","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7238","id":1767384670,"node_id":"IC_kwDOCW7NX85pWCZe","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-10-18T00:11:11Z","updated_at":"2023-10-18T00:11:11Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1767384670/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1767476206","html_url":"https://github.com/apache/iceberg/issues/8859#issuecomment-1767476206","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8859","id":1767476206,"node_id":"IC_kwDOCW7NX85pWYvu","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-18T01:45:38Z","updated_at":"2023-10-18T01:45:38Z","author_association":"CONTRIBUTOR","body":"@atifiu Do you have a program that can reproduce the issue?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1767476206/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1767664345","html_url":"https://github.com/apache/iceberg/pull/8808#issuecomment-1767664345","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8808","id":1767664345,"node_id":"IC_kwDOCW7NX85pXGrZ","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-18T05:23:32Z","updated_at":"2023-10-18T05:23:32Z","author_association":"CONTRIBUTOR","body":"@fengjiajie: Checked the codepath for the Spark readers and I have 2 questions:\r\n- What about ORC and Avro files? Don't we have the same issue there?\r\n- Would it worth to add the same fix for the Spark reader as well?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1767664345/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1767679787","html_url":"https://github.com/apache/iceberg/pull/8857#issuecomment-1767679787","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8857","id":1767679787,"node_id":"IC_kwDOCW7NX85pXKcr","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-18T05:39:43Z","updated_at":"2023-10-18T05:39:43Z","author_association":"MEMBER","body":"cc: @snazy, @dimas-b  ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1767679787/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1767680941","html_url":"https://github.com/apache/iceberg/pull/8857#issuecomment-1767680941","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8857","id":1767680941,"node_id":"IC_kwDOCW7NX85pXKut","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-18T05:41:00Z","updated_at":"2023-10-18T05:41:00Z","author_association":"MEMBER","body":"> It also switches to Nessie API V2 for the commit operation.\r\n\r\nI didn't see this change (mentioned in PR description). It currently works for both v1 and v2 right?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1767680941/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1767681093","html_url":"https://github.com/apache/iceberg/issues/8862#issuecomment-1767681093","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8862","id":1767681093,"node_id":"IC_kwDOCW7NX85pXKxF","user":{"login":"tmnd1991","id":7031242,"node_id":"MDQ6VXNlcjcwMzEyNDI=","avatar_url":"https://avatars.githubusercontent.com/u/7031242?v=4","gravatar_id":"","url":"https://api.github.com/users/tmnd1991","html_url":"https://github.com/tmnd1991","followers_url":"https://api.github.com/users/tmnd1991/followers","following_url":"https://api.github.com/users/tmnd1991/following{/other_user}","gists_url":"https://api.github.com/users/tmnd1991/gists{/gist_id}","starred_url":"https://api.github.com/users/tmnd1991/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tmnd1991/subscriptions","organizations_url":"https://api.github.com/users/tmnd1991/orgs","repos_url":"https://api.github.com/users/tmnd1991/repos","events_url":"https://api.github.com/users/tmnd1991/events{/privacy}","received_events_url":"https://api.github.com/users/tmnd1991/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-18T05:41:11Z","updated_at":"2023-10-18T05:41:11Z","author_association":"NONE","body":"Hi @RussellSpitzer , yes I mean having the delete operations distributed. I guess its difficult because you dont know how many spark executor cores you might have in any given moment, am I right?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1767681093/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1767711923","html_url":"https://github.com/apache/iceberg/pull/8852#issuecomment-1767711923","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8852","id":1767711923,"node_id":"IC_kwDOCW7NX85pXSSz","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-18T06:07:48Z","updated_at":"2023-10-18T06:07:48Z","author_association":"CONTRIBUTOR","body":"thanks for reviewing @amogh-jahagirdar and @nk1506. @nk1506 would you be interested in backporting this to older Flink versions?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1767711923/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1767727777","html_url":"https://github.com/apache/iceberg/pull/8843#issuecomment-1767727777","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8843","id":1767727777,"node_id":"IC_kwDOCW7NX85pXWKh","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-18T06:14:08Z","updated_at":"2023-10-18T06:14:08Z","author_association":"CONTRIBUTOR","body":"Thanks everyone for the feedback. I'll go ahead and include this in the 1.4.1 RC","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1767727777/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1767764825","html_url":"https://github.com/apache/iceberg/pull/8808#issuecomment-1767764825","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8808","id":1767764825,"node_id":"IC_kwDOCW7NX85pXfNZ","user":{"login":"fengjiajie","id":16379560,"node_id":"MDQ6VXNlcjE2Mzc5NTYw","avatar_url":"https://avatars.githubusercontent.com/u/16379560?v=4","gravatar_id":"","url":"https://api.github.com/users/fengjiajie","html_url":"https://github.com/fengjiajie","followers_url":"https://api.github.com/users/fengjiajie/followers","following_url":"https://api.github.com/users/fengjiajie/following{/other_user}","gists_url":"https://api.github.com/users/fengjiajie/gists{/gist_id}","starred_url":"https://api.github.com/users/fengjiajie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fengjiajie/subscriptions","organizations_url":"https://api.github.com/users/fengjiajie/orgs","repos_url":"https://api.github.com/users/fengjiajie/repos","events_url":"https://api.github.com/users/fengjiajie/events{/privacy}","received_events_url":"https://api.github.com/users/fengjiajie/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-18T06:35:18Z","updated_at":"2023-10-18T07:29:39Z","author_association":"CONTRIBUTOR","body":"> @fengjiajie: Checked the codepath for the Spark readers and I have 2 questions:\r\n> \r\n> * What about ORC and Avro files? Don't we have the same issue there?\r\n> * Would it worth to add the same fix for the Spark reader as well?\r\n\r\n@pvary  The issue is that the type of the read result should be determined by the column type definition in Iceberg, rather than the data type within the Parquet file.\r\n\r\n- It seems that ORC is not experiencing this issue because it creates value reader based on the iceberg column types.\r\n- Avro reads the fields entirely based on the file type, which seems to be problematic. However, it doesn't have significant issues under Parquet because Avro natively supports STRING and BYTES types, whereas Parquet only has the Binary type (whether the field is a String is determined by additional annotations or external metadata).\r\n- The data type read should be consistent with the iceberg column type, so I think Spark should also incorporate this modification.\r\n- Additionally, Iceberg has a UUID type, which seems to be supported in Spark but not in Flink: https://github.com/apache/iceberg/pull/7496","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1767764825/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1767781293","html_url":"https://github.com/apache/iceberg/pull/8808#issuecomment-1767781293","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8808","id":1767781293,"node_id":"IC_kwDOCW7NX85pXjOt","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-18T06:48:29Z","updated_at":"2023-10-18T06:48:29Z","author_association":"CONTRIBUTOR","body":"> Additionally, Iceberg has a UUID type, which seems to be supported in Spark but not in Flink: https://github.com/apache/iceberg/pull/7496\r\n\r\nSo Spark itself doesn't support UUIDs as a type, but rather expresses them as Strings. That's what #7496 added/fixed for Spark","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1767781293/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1767792634","html_url":"https://github.com/apache/iceberg/issues/8515#issuecomment-1767792634","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8515","id":1767792634,"node_id":"IC_kwDOCW7NX85pXl_6","user":{"login":"zeddit","id":30164206,"node_id":"MDQ6VXNlcjMwMTY0MjA2","avatar_url":"https://avatars.githubusercontent.com/u/30164206?v=4","gravatar_id":"","url":"https://api.github.com/users/zeddit","html_url":"https://github.com/zeddit","followers_url":"https://api.github.com/users/zeddit/followers","following_url":"https://api.github.com/users/zeddit/following{/other_user}","gists_url":"https://api.github.com/users/zeddit/gists{/gist_id}","starred_url":"https://api.github.com/users/zeddit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zeddit/subscriptions","organizations_url":"https://api.github.com/users/zeddit/orgs","repos_url":"https://api.github.com/users/zeddit/repos","events_url":"https://api.github.com/users/zeddit/events{/privacy}","received_events_url":"https://api.github.com/users/zeddit/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-18T06:57:45Z","updated_at":"2023-10-18T07:00:06Z","author_association":"NONE","body":"@Fokko sorry for the late reply. \r\nI wonder if 0.5.0 will release soon, and how could I get and install a rc one the test the performance.\r\nHave you got any performance data for me to take as a reference. \r\ngreat thanks.\r\n\r\nI have test my environment with `reading large parquet files directly with pyarrow library`, it shows me about 700MB/s throughput, it's just the bandwidth for my s3 backend storage.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1767792634/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1767870060","html_url":"https://github.com/apache/iceberg/issues/8859#issuecomment-1767870060","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8859","id":1767870060,"node_id":"IC_kwDOCW7NX85pX45s","user":{"login":"atifiu","id":48252551,"node_id":"MDQ6VXNlcjQ4MjUyNTUx","avatar_url":"https://avatars.githubusercontent.com/u/48252551?v=4","gravatar_id":"","url":"https://api.github.com/users/atifiu","html_url":"https://github.com/atifiu","followers_url":"https://api.github.com/users/atifiu/followers","following_url":"https://api.github.com/users/atifiu/following{/other_user}","gists_url":"https://api.github.com/users/atifiu/gists{/gist_id}","starred_url":"https://api.github.com/users/atifiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/atifiu/subscriptions","organizations_url":"https://api.github.com/users/atifiu/orgs","repos_url":"https://api.github.com/users/atifiu/repos","events_url":"https://api.github.com/users/atifiu/events{/privacy}","received_events_url":"https://api.github.com/users/atifiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-18T07:44:38Z","updated_at":"2023-10-18T07:44:38Z","author_association":"NONE","body":"@huaxingao No. Because this is happening only with large table 4TB+. For smaller tables it's working fine. Even on large table if I place filter it works.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1767870060/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1768005075","html_url":"https://github.com/apache/iceberg/issues/8863#issuecomment-1768005075","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8863","id":1768005075,"node_id":"IC_kwDOCW7NX85pYZ3T","user":{"login":"camper42","id":3177898,"node_id":"MDQ6VXNlcjMxNzc4OTg=","avatar_url":"https://avatars.githubusercontent.com/u/3177898?v=4","gravatar_id":"","url":"https://api.github.com/users/camper42","html_url":"https://github.com/camper42","followers_url":"https://api.github.com/users/camper42/followers","following_url":"https://api.github.com/users/camper42/following{/other_user}","gists_url":"https://api.github.com/users/camper42/gists{/gist_id}","starred_url":"https://api.github.com/users/camper42/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/camper42/subscriptions","organizations_url":"https://api.github.com/users/camper42/orgs","repos_url":"https://api.github.com/users/camper42/repos","events_url":"https://api.github.com/users/camper42/events{/privacy}","received_events_url":"https://api.github.com/users/camper42/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-18T09:01:36Z","updated_at":"2023-10-18T09:01:36Z","author_association":"NONE","body":"can reproduce with snapshot:\r\n![image](https://github.com/apache/iceberg/assets/3177898/4fe173fc-89ab-4d51-be50-23f74d51bf73)\r\n\r\nprevious failure on migrated table:\r\n![image](https://github.com/apache/iceberg/assets/3177898/e8b642b9-9ba4-437c-964d-b16508a43703)\r\n![image](https://github.com/apache/iceberg/assets/3177898/655d87f5-1fc4-4f42-9ea4-055142a47279)\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1768005075/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1768023880","html_url":"https://github.com/apache/iceberg/pull/8803#issuecomment-1768023880","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8803","id":1768023880,"node_id":"IC_kwDOCW7NX85pYedI","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-18T09:12:45Z","updated_at":"2023-10-18T09:12:45Z","author_association":"CONTRIBUTOR","body":"> @pvary I think we probably want to push the `copyStatsForColumns` down to ManifestReader. https://github.com/apache/iceberg/blob/main/core/src/main/java/org/apache/iceberg/ManifestReader.java#L299\r\n\r\nThat is for reading the data from the manifest file.\r\nIf we want at statistics for at least one column, then the manifest file reading schema should contain the stat fields, like:\r\n```\r\n  private static final Set<String> STATS_COLUMNS =\r\n      ImmutableSet.of(\r\n          \"value_counts\",\r\n          \"null_value_counts\",\r\n          \"nan_value_counts\",\r\n          \"lower_bounds\",\r\n          \"upper_bounds\",\r\n          \"record_count\");\r\n```\r\n\r\nSo we can not do filtering here. We need to read the stat fields from the manifest file, and then filter later for columns where we do not need it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1768023880/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1768027199","html_url":"https://github.com/apache/iceberg/issues/5565#issuecomment-1768027199","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5565","id":1768027199,"node_id":"IC_kwDOCW7NX85pYfQ_","user":{"login":"t0ma-sz","id":23321688,"node_id":"MDQ6VXNlcjIzMzIxNjg4","avatar_url":"https://avatars.githubusercontent.com/u/23321688?v=4","gravatar_id":"","url":"https://api.github.com/users/t0ma-sz","html_url":"https://github.com/t0ma-sz","followers_url":"https://api.github.com/users/t0ma-sz/followers","following_url":"https://api.github.com/users/t0ma-sz/following{/other_user}","gists_url":"https://api.github.com/users/t0ma-sz/gists{/gist_id}","starred_url":"https://api.github.com/users/t0ma-sz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/t0ma-sz/subscriptions","organizations_url":"https://api.github.com/users/t0ma-sz/orgs","repos_url":"https://api.github.com/users/t0ma-sz/repos","events_url":"https://api.github.com/users/t0ma-sz/events{/privacy}","received_events_url":"https://api.github.com/users/t0ma-sz/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-18T09:14:40Z","updated_at":"2023-10-18T09:14:40Z","author_association":"NONE","body":"@AlbertoSoto25 I believe originally it was there: https://docs.aws.amazon.com/glue/latest/dg/aws-glue-programming-etl-format-iceberg.html , but as it was some time ago most probably docs have been changed, but at least you could try to reuse parts of code that are there.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1768027199/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1768070435","html_url":"https://github.com/apache/iceberg/issues/8863#issuecomment-1768070435","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8863","id":1768070435,"node_id":"IC_kwDOCW7NX85pYp0j","user":{"login":"camper42","id":3177898,"node_id":"MDQ6VXNlcjMxNzc4OTg=","avatar_url":"https://avatars.githubusercontent.com/u/3177898?v=4","gravatar_id":"","url":"https://api.github.com/users/camper42","html_url":"https://github.com/camper42","followers_url":"https://api.github.com/users/camper42/followers","following_url":"https://api.github.com/users/camper42/following{/other_user}","gists_url":"https://api.github.com/users/camper42/gists{/gist_id}","starred_url":"https://api.github.com/users/camper42/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/camper42/subscriptions","organizations_url":"https://api.github.com/users/camper42/orgs","repos_url":"https://api.github.com/users/camper42/repos","events_url":"https://api.github.com/users/camper42/events{/privacy}","received_events_url":"https://api.github.com/users/camper42/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-18T09:39:44Z","updated_at":"2023-10-18T09:39:44Z","author_association":"NONE","body":"I'm lost.... seems both snapshot and migrate use `SparkTableUtil.importSparkTable`.\r\nif read error on migrated table, it should failed on snapshot table. but no error when read from snapshot table.\r\n\r\n\r\nand I try to:\r\n1. cp failed partition to a new table (new_test)\r\n2. REPAIR TABLE new_test\r\n3. snapshot + rewrite -> no error\r\n4. migrate + rewrite -> no error","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1768070435/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1768112327","html_url":"https://github.com/apache/iceberg/pull/1276#issuecomment-1768112327","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1276","id":1768112327,"node_id":"IC_kwDOCW7NX85pY0DH","user":{"login":"link3280","id":13482005,"node_id":"MDQ6VXNlcjEzNDgyMDA1","avatar_url":"https://avatars.githubusercontent.com/u/13482005?v=4","gravatar_id":"","url":"https://api.github.com/users/link3280","html_url":"https://github.com/link3280","followers_url":"https://api.github.com/users/link3280/followers","following_url":"https://api.github.com/users/link3280/following{/other_user}","gists_url":"https://api.github.com/users/link3280/gists{/gist_id}","starred_url":"https://api.github.com/users/link3280/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/link3280/subscriptions","organizations_url":"https://api.github.com/users/link3280/orgs","repos_url":"https://api.github.com/users/link3280/repos","events_url":"https://api.github.com/users/link3280/events{/privacy}","received_events_url":"https://api.github.com/users/link3280/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-18T10:04:19Z","updated_at":"2023-10-18T10:04:19Z","author_association":"CONTRIBUTOR","body":"@HeartSaVioR @HeartSaVioR Hi, I'm new to Iceberg and getting this error message. Does it mean we should not configure a non-default spark catalog as `SparkSessionCatalog`? Thanks in advance!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1768112327/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1768137430","html_url":"https://github.com/apache/iceberg/issues/8864#issuecomment-1768137430","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8864","id":1768137430,"node_id":"IC_kwDOCW7NX85pY6LW","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-18T10:18:50Z","updated_at":"2023-10-18T10:18:50Z","author_association":"CONTRIBUTOR","body":"That doesn't look right. @zhangminglei are you interested in providing a PR?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1768137430/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1768138708","html_url":"https://github.com/apache/iceberg/issues/8810#issuecomment-1768138708","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8810","id":1768138708,"node_id":"IC_kwDOCW7NX85pY6fU","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-18T10:19:40Z","updated_at":"2023-10-18T10:19:40Z","author_association":"CONTRIBUTOR","body":"Thanks for fixing this one @PickBas ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1768138708/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1768245115","html_url":"https://github.com/apache/iceberg/pull/8857#issuecomment-1768245115","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8857","id":1768245115,"node_id":"IC_kwDOCW7NX85pZUd7","user":{"login":"adutra","id":463876,"node_id":"MDQ6VXNlcjQ2Mzg3Ng==","avatar_url":"https://avatars.githubusercontent.com/u/463876?v=4","gravatar_id":"","url":"https://api.github.com/users/adutra","html_url":"https://github.com/adutra","followers_url":"https://api.github.com/users/adutra/followers","following_url":"https://api.github.com/users/adutra/following{/other_user}","gists_url":"https://api.github.com/users/adutra/gists{/gist_id}","starred_url":"https://api.github.com/users/adutra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adutra/subscriptions","organizations_url":"https://api.github.com/users/adutra/orgs","repos_url":"https://api.github.com/users/adutra/repos","events_url":"https://api.github.com/users/adutra/events{/privacy}","received_events_url":"https://api.github.com/users/adutra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-18T11:24:32Z","updated_at":"2023-10-18T11:24:32Z","author_association":"CONTRIBUTOR","body":"> > It also switches to Nessie API V2 for the commit operation.\r\n> \r\n> I didn't see this change (mentioned in PR description). It currently works for both v1 and v2 right?\r\n\r\nYou are right, this operation is common to V1 and V2, my bad.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1768245115/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1768291556","html_url":"https://github.com/apache/iceberg/pull/8808#issuecomment-1768291556","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8808","id":1768291556,"node_id":"IC_kwDOCW7NX85pZfzk","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-18T11:55:45Z","updated_at":"2023-10-18T11:55:45Z","author_association":"CONTRIBUTOR","body":"> * It seems that ORC is not experiencing this issue because it creates value reader based on the iceberg column types.\r\n> * Avro reads the fields entirely based on the file type, which seems to be problematic. However, it doesn't have significant issues under Parquet because Avro natively supports STRING and BYTES types, whereas Parquet only has the Binary type (whether the field is a String is determined by additional annotations or external metadata).\r\n\r\nThanks for the explanation!\r\n\r\n> * The data type read should be consistent with the iceberg column type, so I think Spark should also incorporate this modification.\r\n\r\nHow hard would it be to incorporate this to the Spark reader as well?\r\nI am uncomfortable with these kind of fixes which are applied only to one of the engines.\r\nIf it is not too complicated we should add it here, if not, then we need to create a different PR.\r\n\r\n> * Additionally, Iceberg has a UUID type, which seems to be supported in Spark but not in Flink: [Spark 3.3: Add read and write support for UUIDs#7496](https://github.com/apache/iceberg/pull/7496)\r\n\r\nI think this is a bigger nut to crack. Probably worth another PR in Flink to fix this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1768291556/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1768297698","html_url":"https://github.com/apache/iceberg/pull/5544#issuecomment-1768297698","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5544","id":1768297698,"node_id":"IC_kwDOCW7NX85pZhTi","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-18T11:58:42Z","updated_at":"2023-10-18T11:58:42Z","author_association":"CONTRIBUTOR","body":"@ggershinsky: Do we want to add Flink tests alongside the Spark tests as well?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1768297698/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1768304382","html_url":"https://github.com/apache/iceberg/issues/8864#issuecomment-1768304382","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8864","id":1768304382,"node_id":"IC_kwDOCW7NX85pZi7-","user":{"login":"rice668","id":6520673,"node_id":"MDQ6VXNlcjY1MjA2NzM=","avatar_url":"https://avatars.githubusercontent.com/u/6520673?v=4","gravatar_id":"","url":"https://api.github.com/users/rice668","html_url":"https://github.com/rice668","followers_url":"https://api.github.com/users/rice668/followers","following_url":"https://api.github.com/users/rice668/following{/other_user}","gists_url":"https://api.github.com/users/rice668/gists{/gist_id}","starred_url":"https://api.github.com/users/rice668/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rice668/subscriptions","organizations_url":"https://api.github.com/users/rice668/orgs","repos_url":"https://api.github.com/users/rice668/repos","events_url":"https://api.github.com/users/rice668/events{/privacy}","received_events_url":"https://api.github.com/users/rice668/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-18T12:03:11Z","updated_at":"2023-10-18T12:03:11Z","author_association":"CONTRIBUTOR","body":"Yes. I am interested.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1768304382/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":1,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1768384984","html_url":"https://github.com/apache/iceberg/pull/5544#issuecomment-1768384984","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5544","id":1768384984,"node_id":"IC_kwDOCW7NX85pZ2nY","user":{"login":"ggershinsky","id":12033212,"node_id":"MDQ6VXNlcjEyMDMzMjEy","avatar_url":"https://avatars.githubusercontent.com/u/12033212?v=4","gravatar_id":"","url":"https://api.github.com/users/ggershinsky","html_url":"https://github.com/ggershinsky","followers_url":"https://api.github.com/users/ggershinsky/followers","following_url":"https://api.github.com/users/ggershinsky/following{/other_user}","gists_url":"https://api.github.com/users/ggershinsky/gists{/gist_id}","starred_url":"https://api.github.com/users/ggershinsky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ggershinsky/subscriptions","organizations_url":"https://api.github.com/users/ggershinsky/orgs","repos_url":"https://api.github.com/users/ggershinsky/repos","events_url":"https://api.github.com/users/ggershinsky/events{/privacy}","received_events_url":"https://api.github.com/users/ggershinsky/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-18T12:49:58Z","updated_at":"2023-10-18T12:49:58Z","author_association":"CONTRIBUTOR","body":"The current PR sequence develops the encryption tools using Spark as a usecase. But once the toolset converges, we'll certainly need the Flink support and unitests.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1768384984/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1768545557","html_url":"https://github.com/apache/iceberg/issues/8859#issuecomment-1768545557","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8859","id":1768545557,"node_id":"IC_kwDOCW7NX85pad0V","user":{"login":"paulpaul1076","id":4533296,"node_id":"MDQ6VXNlcjQ1MzMyOTY=","avatar_url":"https://avatars.githubusercontent.com/u/4533296?v=4","gravatar_id":"","url":"https://api.github.com/users/paulpaul1076","html_url":"https://github.com/paulpaul1076","followers_url":"https://api.github.com/users/paulpaul1076/followers","following_url":"https://api.github.com/users/paulpaul1076/following{/other_user}","gists_url":"https://api.github.com/users/paulpaul1076/gists{/gist_id}","starred_url":"https://api.github.com/users/paulpaul1076/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/paulpaul1076/subscriptions","organizations_url":"https://api.github.com/users/paulpaul1076/orgs","repos_url":"https://api.github.com/users/paulpaul1076/repos","events_url":"https://api.github.com/users/paulpaul1076/events{/privacy}","received_events_url":"https://api.github.com/users/paulpaul1076/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-18T14:09:27Z","updated_at":"2023-10-18T14:09:27Z","author_association":"NONE","body":"There should be a wrapped exception and explains what exactly happened in the parallel task.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1768545557/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1768659309","html_url":"https://github.com/apache/iceberg/issues/8859#issuecomment-1768659309","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8859","id":1768659309,"node_id":"IC_kwDOCW7NX85pa5lt","user":{"login":"atifiu","id":48252551,"node_id":"MDQ6VXNlcjQ4MjUyNTUx","avatar_url":"https://avatars.githubusercontent.com/u/48252551?v=4","gravatar_id":"","url":"https://api.github.com/users/atifiu","html_url":"https://github.com/atifiu","followers_url":"https://api.github.com/users/atifiu/followers","following_url":"https://api.github.com/users/atifiu/following{/other_user}","gists_url":"https://api.github.com/users/atifiu/gists{/gist_id}","starred_url":"https://api.github.com/users/atifiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/atifiu/subscriptions","organizations_url":"https://api.github.com/users/atifiu/orgs","repos_url":"https://api.github.com/users/atifiu/repos","events_url":"https://api.github.com/users/atifiu/events{/privacy}","received_events_url":"https://api.github.com/users/atifiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-18T15:02:54Z","updated_at":"2023-10-18T15:02:54Z","author_association":"NONE","body":"@paulpaul1076 I have now pasted the complete error stack.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1768659309/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1768737358","html_url":"https://github.com/apache/iceberg/pull/8867#issuecomment-1768737358","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8867","id":1768737358,"node_id":"IC_kwDOCW7NX85pbMpO","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-18T15:28:25Z","updated_at":"2023-10-18T15:28:25Z","author_association":"CONTRIBUTOR","body":"looks like https://github.com/apache/iceberg/pull/8666 was opened recently that fixed the exact same thing. @jbonofre could you please review https://github.com/apache/iceberg/pull/8666 and I'll do the same? Thanks for looking into this","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1768737358/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1768741516","html_url":"https://github.com/apache/iceberg/pull/8867#issuecomment-1768741516","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8867","id":1768741516,"node_id":"IC_kwDOCW7NX85pbNqM","user":{"login":"jbonofre","id":158903,"node_id":"MDQ6VXNlcjE1ODkwMw==","avatar_url":"https://avatars.githubusercontent.com/u/158903?v=4","gravatar_id":"","url":"https://api.github.com/users/jbonofre","html_url":"https://github.com/jbonofre","followers_url":"https://api.github.com/users/jbonofre/followers","following_url":"https://api.github.com/users/jbonofre/following{/other_user}","gists_url":"https://api.github.com/users/jbonofre/gists{/gist_id}","starred_url":"https://api.github.com/users/jbonofre/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jbonofre/subscriptions","organizations_url":"https://api.github.com/users/jbonofre/orgs","repos_url":"https://api.github.com/users/jbonofre/repos","events_url":"https://api.github.com/users/jbonofre/events{/privacy}","received_events_url":"https://api.github.com/users/jbonofre/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-18T15:30:40Z","updated_at":"2023-10-18T15:30:40Z","author_association":"MEMBER","body":"@nastra good catch ! I missed this one.\r\n\r\nI close this one.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1768741516/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1768776022","html_url":"https://github.com/apache/iceberg/pull/8803#issuecomment-1768776022","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8803","id":1768776022,"node_id":"IC_kwDOCW7NX85pbWFW","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-18T15:49:52Z","updated_at":"2023-10-18T15:49:52Z","author_association":"CONTRIBUTOR","body":"> > @pvary I think we probably want to push the `copyStatsForColumns` down to ManifestReader. https://github.com/apache/iceberg/blob/main/core/src/main/java/org/apache/iceberg/ManifestReader.java#L299\r\n> \r\n> That is for reading the data from the manifest file. If we want at statistics for at least one column, then the manifest file reading schema should contain the stat fields, like:\r\n> \r\n> ```\r\n>   private static final Set<String> STATS_COLUMNS =\r\n>       ImmutableSet.of(\r\n>           \"value_counts\",\r\n>           \"null_value_counts\",\r\n>           \"nan_value_counts\",\r\n>           \"lower_bounds\",\r\n>           \"upper_bounds\",\r\n>           \"record_count\");\r\n> ```\r\n> \r\n> So we can not do filtering here. We need to read the stat fields from the manifest file, and then filter later for columns where we do not need it.\r\n\r\nIf we look at this line\r\nhttps://github.com/apache/iceberg/blob/main/core/src/main/java/org/apache/iceberg/ManifestReader.java#L299\r\n\r\nit calls this method from `ContentFile`\r\n```\r\n  default F copy(boolean withStats) {\r\n    return withStats ? copy() : copyWithoutStats();\r\n  }\r\n```\r\n\r\nif we push down the selection to the ManifestReader, it can call the new `copyWithSpecificStats` method that you added in this PR.\r\n\r\nI understand the current code is for metadata column selection/projection, not the columns selected to include stats","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1768776022/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1768982745","html_url":"https://github.com/apache/iceberg/issues/8859#issuecomment-1768982745","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8859","id":1768982745,"node_id":"IC_kwDOCW7NX85pcIjZ","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-18T17:07:41Z","updated_at":"2023-10-18T17:07:41Z","author_association":"CONTRIBUTOR","body":"Seems it caused by OOM","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1768982745/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1769001351","html_url":"https://github.com/apache/iceberg/issues/8859#issuecomment-1769001351","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8859","id":1769001351,"node_id":"IC_kwDOCW7NX85pcNGH","user":{"login":"atifiu","id":48252551,"node_id":"MDQ6VXNlcjQ4MjUyNTUx","avatar_url":"https://avatars.githubusercontent.com/u/48252551?v=4","gravatar_id":"","url":"https://api.github.com/users/atifiu","html_url":"https://github.com/atifiu","followers_url":"https://api.github.com/users/atifiu/followers","following_url":"https://api.github.com/users/atifiu/following{/other_user}","gists_url":"https://api.github.com/users/atifiu/gists{/gist_id}","starred_url":"https://api.github.com/users/atifiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/atifiu/subscriptions","organizations_url":"https://api.github.com/users/atifiu/orgs","repos_url":"https://api.github.com/users/atifiu/repos","events_url":"https://api.github.com/users/atifiu/events{/privacy}","received_events_url":"https://api.github.com/users/atifiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-18T17:20:31Z","updated_at":"2023-10-18T17:20:31Z","author_association":"NONE","body":"@huaxingao I am unable to understand why OOM when not filtering the data but when filtering the data with selecting all the partitions without skipping anything works fine. Ideally in both cases we are referring to same amount of data.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1769001351/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1769112959","html_url":"https://github.com/apache/iceberg/pull/8870#issuecomment-1769112959","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8870","id":1769112959,"node_id":"IC_kwDOCW7NX85pcoV_","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-18T18:36:59Z","updated_at":"2023-10-18T18:37:34Z","author_association":"CONTRIBUTOR","body":"cc @bryanck @okayhooni  I just took another look at the issue and see that the DB URI `s3://test_bucket/temp_beta` does *not* have a trailing slash, so maybe my fix is insufficient. Can you confirm that in Glue your default DB location does not have a trailing slash?\r\n\r\nIn the end, I think we'll still need this fix because without it there's double slash possibilities but I would need to dig further to find the root cause for the issue's specific case","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1769112959/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1769209631","html_url":"https://github.com/apache/iceberg/issues/8862#issuecomment-1769209631","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8862","id":1769209631,"node_id":"IC_kwDOCW7NX85pc_8f","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-18T19:44:59Z","updated_at":"2023-10-18T19:44:59Z","author_association":"MEMBER","body":"Yep, in our experience we have also seen a single driver is sufficient to issue a very large number of deletes. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1769209631/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1769215467","html_url":"https://github.com/apache/iceberg/issues/8869#issuecomment-1769215467","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8869","id":1769215467,"node_id":"IC_kwDOCW7NX85pdBXr","user":{"login":"sungwy","id":107272191,"node_id":"U_kgDOBmTX_w","avatar_url":"https://avatars.githubusercontent.com/u/107272191?v=4","gravatar_id":"","url":"https://api.github.com/users/sungwy","html_url":"https://github.com/sungwy","followers_url":"https://api.github.com/users/sungwy/followers","following_url":"https://api.github.com/users/sungwy/following{/other_user}","gists_url":"https://api.github.com/users/sungwy/gists{/gist_id}","starred_url":"https://api.github.com/users/sungwy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sungwy/subscriptions","organizations_url":"https://api.github.com/users/sungwy/orgs","repos_url":"https://api.github.com/users/sungwy/repos","events_url":"https://api.github.com/users/sungwy/events{/privacy}","received_events_url":"https://api.github.com/users/sungwy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-18T19:49:31Z","updated_at":"2023-10-18T19:49:31Z","author_association":"CONTRIBUTOR","body":"@danielcweeks and @Fokko \r\n\r\nI've raised this issue to continue our discussion on the previously closed PyIceberg PR on this parent repository. I've done some follow up research regarding the authorization flows since then, and I still believe that introducing an enhancement that allows our tools to fetch access tokens from a separate authorization server would encourage the adoption of the Rest Catalog even more.\r\n\r\nPlease let me know if you think this is a good idea for the Java (Spark/Trino) RestCatalog as well as for PyIceberg","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1769215467/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1769293387","html_url":"https://github.com/apache/iceberg/issues/8869#issuecomment-1769293387","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8869","id":1769293387,"node_id":"IC_kwDOCW7NX85pdUZL","user":{"login":"haizhou-zhao","id":6187287,"node_id":"MDQ6VXNlcjYxODcyODc=","avatar_url":"https://avatars.githubusercontent.com/u/6187287?v=4","gravatar_id":"","url":"https://api.github.com/users/haizhou-zhao","html_url":"https://github.com/haizhou-zhao","followers_url":"https://api.github.com/users/haizhou-zhao/followers","following_url":"https://api.github.com/users/haizhou-zhao/following{/other_user}","gists_url":"https://api.github.com/users/haizhou-zhao/gists{/gist_id}","starred_url":"https://api.github.com/users/haizhou-zhao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/haizhou-zhao/subscriptions","organizations_url":"https://api.github.com/users/haizhou-zhao/orgs","repos_url":"https://api.github.com/users/haizhou-zhao/repos","events_url":"https://api.github.com/users/haizhou-zhao/events{/privacy}","received_events_url":"https://api.github.com/users/haizhou-zhao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-18T20:44:55Z","updated_at":"2023-10-18T20:44:55Z","author_association":"CONTRIBUTOR","body":"@syun64 In my org, we have very similar situation where we, unfortunately, can only use an internal procedure to grab auth token (that is quite different from OIDC flow). Based on what you talked about, I believe we are doing quite similar things as you mentioned, that we setup a different auth server, and has to reimplement our own internal version of RestSessionCatalog and OAuth2Util so that our Spark/Flink Iceberg users can leverage our internal process to refresh token on the fly.\r\n\r\nThat being said, I do see the value of separating out the interface of auth away from the interface of resources and define an auth protocol (interface) to allow more degrees of freedom for auth implementation.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1769293387/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1769370005","html_url":"https://github.com/apache/iceberg/pull/8871#issuecomment-1769370005","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8871","id":1769370005,"node_id":"IC_kwDOCW7NX85pdnGV","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-18T21:45:35Z","updated_at":"2023-10-18T21:46:13Z","author_association":"CONTRIBUTOR","body":"actually nvm, I think this does go against established practices since we have some checkstyle rules preventing it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1769370005/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]