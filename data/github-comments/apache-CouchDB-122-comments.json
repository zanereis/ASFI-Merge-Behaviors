[{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1737715766","html_url":"https://github.com/apache/couchdb/pull/4710#issuecomment-1737715766","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4710","id":1737715766,"node_id":"IC_kwDOAAMmUc5nk3A2","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-27T16:23:28Z","updated_at":"2023-09-27T16:23:28Z","author_association":"MEMBER","body":"@willholley aha! I missed it the first time. I agree that those two suggested toggles just complicate things. I suggest it's just the opt-in in the `_find` request body for now. couchdb could flip the default in code in a future major release (but I think it's unlikely).\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1737715766/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1739893117","html_url":"https://github.com/apache/couchdb/issues/4783#issuecomment-1739893117","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4783","id":1739893117,"node_id":"IC_kwDOAAMmUc5ntKl9","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-28T19:32:37Z","updated_at":"2023-09-28T19:32:37Z","author_association":"CONTRIBUTOR","body":"Thanks for reporting the issue and for the fix @telesoho! It's much appreciated.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1739893117/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1739998375","html_url":"https://github.com/apache/couchdb/pull/1443#issuecomment-1739998375","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1443","id":1739998375,"node_id":"IC_kwDOAAMmUc5ntkSn","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-28T21:01:39Z","updated_at":"2023-09-28T21:01:39Z","author_association":"CONTRIBUTOR","body":"Closing due to lack of activity and since we already implemented it","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1739998375/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1740001781","html_url":"https://github.com/apache/couchdb/pull/4750#issuecomment-1740001781","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4750","id":1740001781,"node_id":"IC_kwDOAAMmUc5ntlH1","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-28T21:05:06Z","updated_at":"2023-09-28T21:05:06Z","author_association":"CONTRIBUTOR","body":"Closing as there wasn't as much interest in this","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1740001781/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1740586890","html_url":"https://github.com/apache/couchdb/pull/4782#issuecomment-1740586890","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4782","id":1740586890,"node_id":"IC_kwDOAAMmUc5nvz-K","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-29T09:28:45Z","updated_at":"2023-09-29T09:28:45Z","author_association":"MEMBER","body":"The problem with search-backed mango queries is the execute/1 function that slurps up all the matches in a loop before passing them over for processing. We should fix that. If we do, then there will be no need for `documents_seen` as we can de-dupe as we iterate (and, critically, terminate the loop early once we have accumulated enough hits).\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1740586890/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1740647102","html_url":"https://github.com/apache/couchdb/pull/4782#issuecomment-1740647102","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4782","id":1740647102,"node_id":"IC_kwDOAAMmUc5nwCq-","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-29T10:12:31Z","updated_at":"2023-09-29T10:12:31Z","author_association":"MEMBER","body":"ignore last comment. re-reading this and happy that execute/1, execute/3, handle_hit/3 exit when we've seen `Limit` number of rows.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1740647102/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1740735984","html_url":"https://github.com/apache/couchdb/issues/840#issuecomment-1740735984","issue_url":"https://api.github.com/repos/apache/couchdb/issues/840","id":1740735984,"node_id":"IC_kwDOAAMmUc5nwYXw","user":{"login":"EmreKorpe","id":16029286,"node_id":"MDQ6VXNlcjE2MDI5Mjg2","avatar_url":"https://avatars.githubusercontent.com/u/16029286?v=4","gravatar_id":"","url":"https://api.github.com/users/EmreKorpe","html_url":"https://github.com/EmreKorpe","followers_url":"https://api.github.com/users/EmreKorpe/followers","following_url":"https://api.github.com/users/EmreKorpe/following{/other_user}","gists_url":"https://api.github.com/users/EmreKorpe/gists{/gist_id}","starred_url":"https://api.github.com/users/EmreKorpe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EmreKorpe/subscriptions","organizations_url":"https://api.github.com/users/EmreKorpe/orgs","repos_url":"https://api.github.com/users/EmreKorpe/repos","events_url":"https://api.github.com/users/EmreKorpe/events{/privacy}","received_events_url":"https://api.github.com/users/EmreKorpe/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-29T11:24:57Z","updated_at":"2023-09-29T11:25:33Z","author_association":"NONE","body":"> I am having CouchDB 2.1.1 for mac and having same issue. When I start couchDB then it start opening new tab with address http://127.0.0.1:5984/_utils/ and refused to connect. It continue to open until I force quit it. I tried to do according to your reply but Didn't find local.ini file. Please let me know the path of this file for mac\r\n> Please find crash log file\r\n> [CouchDB2.log](https://github.com/apache/couchdb/files/1997747/CouchDB2.log)\r\n\r\nHello, did you find any solution? @navneet21sharma ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1740735984/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1740741850","html_url":"https://github.com/apache/couchdb/issues/1325#issuecomment-1740741850","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1325","id":1740741850,"node_id":"IC_kwDOAAMmUc5nwZza","user":{"login":"cmit-emrekorpe","id":144841311,"node_id":"U_kgDOCKIaXw","avatar_url":"https://avatars.githubusercontent.com/u/144841311?v=4","gravatar_id":"","url":"https://api.github.com/users/cmit-emrekorpe","html_url":"https://github.com/cmit-emrekorpe","followers_url":"https://api.github.com/users/cmit-emrekorpe/followers","following_url":"https://api.github.com/users/cmit-emrekorpe/following{/other_user}","gists_url":"https://api.github.com/users/cmit-emrekorpe/gists{/gist_id}","starred_url":"https://api.github.com/users/cmit-emrekorpe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cmit-emrekorpe/subscriptions","organizations_url":"https://api.github.com/users/cmit-emrekorpe/orgs","repos_url":"https://api.github.com/users/cmit-emrekorpe/repos","events_url":"https://api.github.com/users/cmit-emrekorpe/events{/privacy}","received_events_url":"https://api.github.com/users/cmit-emrekorpe/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-29T11:30:32Z","updated_at":"2023-09-29T11:30:32Z","author_association":"NONE","body":"@navneet21sharma how did you find solution?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1740741850/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1740796644","html_url":"https://github.com/apache/couchdb/issues/1254#issuecomment-1740796644","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1254","id":1740796644,"node_id":"IC_kwDOAAMmUc5nwnLk","user":{"login":"NagaPranavi9","id":114210162,"node_id":"U_kgDOBs61cg","avatar_url":"https://avatars.githubusercontent.com/u/114210162?v=4","gravatar_id":"","url":"https://api.github.com/users/NagaPranavi9","html_url":"https://github.com/NagaPranavi9","followers_url":"https://api.github.com/users/NagaPranavi9/followers","following_url":"https://api.github.com/users/NagaPranavi9/following{/other_user}","gists_url":"https://api.github.com/users/NagaPranavi9/gists{/gist_id}","starred_url":"https://api.github.com/users/NagaPranavi9/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/NagaPranavi9/subscriptions","organizations_url":"https://api.github.com/users/NagaPranavi9/orgs","repos_url":"https://api.github.com/users/NagaPranavi9/repos","events_url":"https://api.github.com/users/NagaPranavi9/events{/privacy}","received_events_url":"https://api.github.com/users/NagaPranavi9/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-29T12:17:01Z","updated_at":"2023-09-29T12:17:01Z","author_association":"NONE","body":"Is it implemented? If yes, May I know in which version of couchdb it is implemented...as I had the same requirement, so I just want to know.\r\nThank you  ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1740796644/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1740800792","html_url":"https://github.com/apache/couchdb/issues/1254#issuecomment-1740800792","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1254","id":1740800792,"node_id":"IC_kwDOAAMmUc5nwoMY","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-29T12:19:35Z","updated_at":"2023-09-29T12:19:35Z","author_association":"MEMBER","body":"@NagaPranavi9 it is not implemented yet, we'll close the issue as and when that happens.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1740800792/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1743750354","html_url":"https://github.com/apache/couchdb/pull/4787#issuecomment-1743750354","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4787","id":1743750354,"node_id":"IC_kwDOAAMmUc5n74TS","user":{"login":"jiahuili430","id":54631519,"node_id":"MDQ6VXNlcjU0NjMxNTE5","avatar_url":"https://avatars.githubusercontent.com/u/54631519?v=4","gravatar_id":"","url":"https://api.github.com/users/jiahuili430","html_url":"https://github.com/jiahuili430","followers_url":"https://api.github.com/users/jiahuili430/followers","following_url":"https://api.github.com/users/jiahuili430/following{/other_user}","gists_url":"https://api.github.com/users/jiahuili430/gists{/gist_id}","starred_url":"https://api.github.com/users/jiahuili430/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiahuili430/subscriptions","organizations_url":"https://api.github.com/users/jiahuili430/orgs","repos_url":"https://api.github.com/users/jiahuili430/repos","events_url":"https://api.github.com/users/jiahuili430/events{/privacy}","received_events_url":"https://api.github.com/users/jiahuili430/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-02T20:54:14Z","updated_at":"2023-10-02T20:54:14Z","author_association":"CONTRIBUTOR","body":"Thank you, @nickva ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1743750354/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1744871270","html_url":"https://github.com/apache/couchdb/pull/4782#issuecomment-1744871270","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4782","id":1744871270,"node_id":"IC_kwDOAAMmUc5oAJ9m","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-03T12:31:20Z","updated_at":"2023-10-03T12:31:20Z","author_association":"CONTRIBUTOR","body":"Thanks @nickva for the comment on the type specifications.  I forgot to check them with Dialyzer before marking the PR ready for review, although I believe most of them are logically right.  Except for maybe the one about the partitions.\r\n\r\nThe series of _\"will never be called\"_ and _\"has no local return\"_ warnings are probably due to the number of `no_return()` types.  I had to add them because of the frequent use of `throw()` in the control flow, which I do not consider idiomatic.  I think I understand the reasons — `throw()` is a very convenient way to break out from loops, for example — but in Erlang we could do it better.\r\n\r\nBy taking your advice, I have removed the type specifications from this PR and I will create another one, possibly together with a refactor.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1744871270/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1745606437","html_url":"https://github.com/apache/couchdb/pull/4772#issuecomment-1745606437","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4772","id":1745606437,"node_id":"IC_kwDOAAMmUc5oC9cl","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-03T19:39:18Z","updated_at":"2023-10-03T19:39:52Z","author_association":"MEMBER","body":"I dislike the inability to do a merge commit. For larger pull requests I deliberately split them into multiple commits that are easy to review (at the time but, importantly, retrospectively). CouchDB may not be usable at each step, only before or after the set. Flattening these commits to form a fake linear history will lose that context, will yield broken builds at some of those commits, and the history does not actually reflect the history that the project took.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1745606437/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1746606791","html_url":"https://github.com/apache/couchdb/pull/4782#issuecomment-1746606791","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4782","id":1746606791,"node_id":"IC_kwDOAAMmUc5oGxrH","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-04T10:38:07Z","updated_at":"2023-10-04T10:38:07Z","author_association":"CONTRIBUTOR","body":"@rnewson I have checked the use of `mango_cursor_text:update_bookmark/2` and my impression is that the bookmark will be kept updated continuously.  The duplication check happens after that. (*)  It is not put behind any condition so why would it be called less times?  On the other hand, it might be called more times than necessary and the invocation could be pushed down as follows:\r\n\r\n```diff\r\n--- a/src/mango/src/mango_cursor_text.erl\r\n+++ b/src/mango/src/mango_cursor_text.erl\r\n@@ -184,17 +184,17 @@ handle_hit(CAcc0, Sort, Doc) ->\r\n         execution_stats = Stats,\r\n         documents_seen = Seen\r\n     } = CAcc0,\r\n-    CAcc1 = update_bookmark(CAcc0, Sort),\r\n     Stats1 = mango_execution_stats:incr_docs_examined(Stats),\r\n     couch_stats:increment_counter([mango, docs_examined]),\r\n-    CAcc2 = CAcc1#cacc{execution_stats = Stats1},\r\n-    case mango_selector:match(CAcc2#cacc.selector, Doc) of\r\n+    CAcc1 = CAcc0#cacc{execution_stats = Stats1},\r\n+    case mango_selector:match(CAcc1#cacc.selector, Doc) of\r\n         true ->\r\n             DocId = mango_doc:get_field(Doc, <<\"_id\">>),\r\n             case sets:is_element(DocId, Seen) of\r\n                 true ->\r\n-                    CAcc2;\r\n+                    CAcc1;\r\n                 false ->\r\n+                    CAcc2 = update_bookmark(CAcc1, Sort),\r\n                     CAcc3 = CAcc2#cacc{\r\n                         documents_seen = sets:add_element(DocId, Seen)\r\n                     },\r\n@@ -216,7 +216,7 @@ handle_hit(CAcc0, Sort, Doc) ->\r\n                     end\r\n             end;\r\n         false ->\r\n-            CAcc2\r\n+            CAcc1\r\n     end.\r\n```\r\n\r\nDid you mean something like this?\r\n\r\n(*) Except for `Limit == 1` but that is how the code originally worked, and it is documented in the comment.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1746606791/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1746610204","html_url":"https://github.com/apache/couchdb/pull/4782#issuecomment-1746610204","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4782","id":1746610204,"node_id":"IC_kwDOAAMmUc5oGygc","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-04T10:40:28Z","updated_at":"2023-10-04T10:40:28Z","author_association":"MEMBER","body":"I was unclear. I am questioning whether we should still update the bookmark when we detect a duplicate or not.\r\n\r\nwith this PR we will. But I think we shouldn't?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1746610204/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1746620535","html_url":"https://github.com/apache/couchdb/pull/4782#issuecomment-1746620535","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4782","id":1746620535,"node_id":"IC_kwDOAAMmUc5oG1B3","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-04T10:47:08Z","updated_at":"2023-10-04T10:47:08Z","author_association":"CONTRIBUTOR","body":"Yeah, that sounds like a good idea to me.  My diff above does that exactly.  Thanks for the clarification.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1746620535/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1746754778","html_url":"https://github.com/apache/couchdb/pull/4772#issuecomment-1746754778","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4772","id":1746754778,"node_id":"IC_kwDOAAMmUc5oHVza","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-04T12:14:32Z","updated_at":"2023-10-04T12:14:32Z","author_association":"CONTRIBUTOR","body":"Okay, than I would like to know, how others review commits. \r\n\r\nFor my side, I use the GH UI and check all changes (from all commits) as a whole and if it's a larger change, then I used the checkmark that I viewed the file. If no changes are made again (in the meantime) I would give my approval/request/comment ... \r\n\r\nI think it's totally okay to give seperate commits during development, but if it should land in main, then it should be squashed to exactly one \"atomic\" commit. One feature/fix one commit. If something is wrong with that, it can be easily reverted or fixed.\r\n\r\nThis way would solve two of your hints. CouchDB is always usable after each commit and there are no \"sub-feature/bug-commits\" on the history. If a \"sub-feature/bug\" is important for history, then it should become an own commit.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1746754778/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1746824227","html_url":"https://github.com/apache/couchdb/pull/4774#issuecomment-1746824227","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4774","id":1746824227,"node_id":"IC_kwDOAAMmUc5oHmwj","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-04T12:55:56Z","updated_at":"2023-10-04T12:55:56Z","author_association":"CONTRIBUTOR","body":"Based on the recent conclusion of #4710, @rnewson are you fine with having this PR merged?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1746824227/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1746831047","html_url":"https://github.com/apache/couchdb/pull/4774#issuecomment-1746831047","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4774","id":1746831047,"node_id":"IC_kwDOAAMmUc5oHobH","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-04T12:59:56Z","updated_at":"2023-10-04T12:59:56Z","author_association":"CONTRIBUTOR","body":"Thanks @rnewson !","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1746831047/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1746978799","html_url":"https://github.com/apache/couchdb/pull/4782#issuecomment-1746978799","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4782","id":1746978799,"node_id":"IC_kwDOAAMmUc5oIMfv","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-04T14:20:24Z","updated_at":"2023-10-04T14:20:24Z","author_association":"CONTRIBUTOR","body":"It does seem wrong to update the bookmark with the duplicate IDs. We're effectively getting index results from a newer database snapshot than the one we opened in the request (the index got ahead of the database, so to speak). So, we wouldn't want to update the bookmark or do anything with the duplicate IDs except just ignore them.\r\n\r\nIf we reworked these indexes to store document IDs and update sequences, when we read those documents we would check that `IndexSeq =< DbSeq` and discard anything else. Then we wouldn't need to accumulate a `Seen` set. That however, is a larger rewrite with possibly backward compatibility implications.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1746978799/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1746995296","html_url":"https://github.com/apache/couchdb/pull/4782#issuecomment-1746995296","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4782","id":1746995296,"node_id":"IC_kwDOAAMmUc5oIQhg","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-04T14:29:09Z","updated_at":"2023-10-04T14:29:09Z","author_association":"CONTRIBUTOR","body":"Thanks @nickva for the comment, that is an important piece of information.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1746995296/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1747071353","html_url":"https://github.com/apache/couchdb/pull/4782#issuecomment-1747071353","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4782","id":1747071353,"node_id":"IC_kwDOAAMmUc5oIjF5","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-04T15:03:44Z","updated_at":"2023-10-04T15:03:44Z","author_association":"MEMBER","body":"perhaps it would be prudent to record `seq` in nouveau as there are no \"real\" indexes yet, just in case we might find a use for it.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1747071353/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1747104628","html_url":"https://github.com/apache/couchdb/pull/4782#issuecomment-1747104628","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4782","id":1747104628,"node_id":"IC_kwDOAAMmUc5oIrN0","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-04T15:16:50Z","updated_at":"2023-10-04T15:16:50Z","author_association":"CONTRIBUTOR","body":"@rnewson in the scope of this PR?  I am not that experienced with `nouveau` and I have no idea how to do that.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1747104628/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1747149062","html_url":"https://github.com/apache/couchdb/pull/4782#issuecomment-1747149062","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4782","id":1747149062,"node_id":"IC_kwDOAAMmUc5oI2EG","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-04T15:36:49Z","updated_at":"2023-10-04T15:36:49Z","author_association":"MEMBER","body":"no, not in this PR. I will take care of that.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1747149062/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1747298830","html_url":"https://github.com/apache/couchdb/pull/4710#issuecomment-1747298830","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4710","id":1747298830,"node_id":"IC_kwDOAAMmUc5oJaoO","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-04T16:58:49Z","updated_at":"2023-10-04T16:58:49Z","author_association":"CONTRIBUTOR","body":"Please note that #4792 has been opened as an alternative proposal in response to the comments in this conversation.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1747298830/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1747379730","html_url":"https://github.com/apache/couchdb/issues/4790#issuecomment-1747379730","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4790","id":1747379730,"node_id":"IC_kwDOAAMmUc5oJuYS","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-04T17:54:43Z","updated_at":"2023-10-04T17:54:43Z","author_association":"CONTRIBUTOR","body":"It seems like nodes are having a hard time staying connected. Is networking connectivity between cluster nodes fairly stable?\r\n\r\nTry to upgrade to the latest Apache CouchDB as there is periodic forced re-connection module. The setting is `[cluster] reconnect_interval_sec = 37`. You could lower it, for instance to 5 seconds or so.\r\n\r\nThere is also `[fabric] request_timeout = 60000` (unit in milliseconds). Could try to either increase or decrease the value to see what effect it has.\r\n\r\nHint: you can use three backward ticks to enclose logs so they are rendered as pre-formatted text.  ` ``` `\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1747379730/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1747525314","html_url":"https://github.com/apache/couchdb/pull/4794#issuecomment-1747525314","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4794","id":1747525314,"node_id":"IC_kwDOAAMmUc5oKR7C","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-04T19:41:48Z","updated_at":"2023-10-04T20:24:46Z","author_association":"CONTRIBUTOR","body":"With the fix it should look like:\r\n\r\n```\r\n(node1@127.0.0.1)1> mem3_shards:opts_for_db(<<\"doesnotexist\">>).\r\n** exception error: database_does_not_exist\r\n     in function  mem3_shards:opts_for_db/1\r\n        called as mem3_shards:opts_for_db(<<\"doesnotexist\">>)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1747525314/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1748109735","html_url":"https://github.com/apache/couchdb/issues/4797#issuecomment-1748109735","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4797","id":1748109735,"node_id":"IC_kwDOAAMmUc5oMgmn","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-05T05:52:59Z","updated_at":"2023-10-05T05:52:59Z","author_association":"CONTRIBUTOR","body":"Thank you for your report.\r\n\r\nmacOS binaries are provided as a courtesy by Neighbourhood.ie. They currently seem to provide only the latest 3.3.2 release as indicated in https://neighbourhood.ie/download-apache-couchdb-mac. If you see 3.3.2 on their download-apache-couchdb-mac page when you get both zip files, they will (unsurprisingly) have the exact same contents.\r\n\r\nThe issue for Apache CouchDB website is that it indicates that both 3.3.2 and 3.2.3 versions are available. We should fix it by removing the 3.2.3 link, and perhaps provide a generic \"Download macOS binaries from `$link-to-neighbourhood.ie`\".\r\n\r\n ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1748109735/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1748147400","html_url":"https://github.com/apache/couchdb/issues/4797#issuecomment-1748147400","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4797","id":1748147400,"node_id":"IC_kwDOAAMmUc5oMpzI","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-05T06:09:22Z","updated_at":"2023-10-05T06:09:22Z","author_association":"CONTRIBUTOR","body":"Hi,\r\n\r\nit seems that the redirection isn't working (@janl).\r\n@wjblume If you use [this](https://neighbourhood.ie/couchdb-support/download-binaries) link, you get a list af available versions.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1748147400/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1748231071","html_url":"https://github.com/apache/couchdb/issues/4790#issuecomment-1748231071","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4790","id":1748231071,"node_id":"IC_kwDOAAMmUc5oM-Of","user":{"login":"alessio-congedo","id":62748970,"node_id":"MDQ6VXNlcjYyNzQ4OTcw","avatar_url":"https://avatars.githubusercontent.com/u/62748970?v=4","gravatar_id":"","url":"https://api.github.com/users/alessio-congedo","html_url":"https://github.com/alessio-congedo","followers_url":"https://api.github.com/users/alessio-congedo/followers","following_url":"https://api.github.com/users/alessio-congedo/following{/other_user}","gists_url":"https://api.github.com/users/alessio-congedo/gists{/gist_id}","starred_url":"https://api.github.com/users/alessio-congedo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alessio-congedo/subscriptions","organizations_url":"https://api.github.com/users/alessio-congedo/orgs","repos_url":"https://api.github.com/users/alessio-congedo/repos","events_url":"https://api.github.com/users/alessio-congedo/events{/privacy}","received_events_url":"https://api.github.com/users/alessio-congedo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-05T07:18:22Z","updated_at":"2023-10-05T07:18:22Z","author_association":"NONE","body":"> It seems like nodes are having a hard time staying connected. Is networking connectivity between cluster nodes fairly stable?\r\n> \r\n> Try to upgrade to the latest Apache CouchDB as there is periodic forced re-connection module. The setting is `[cluster] reconnect_interval_sec = 37`. You could lower it, for instance to 5 seconds or so.\r\n> \r\n> There is also `[fabric] request_timeout = 60000` (unit in milliseconds). Could try to either increase or decrease the value to see what effect it has.\r\n> \r\n> Hint: you can use three backward ticks to enclose logs so they are rendered as pre-formatted text. `` ``` ``\r\n\r\nHi Nickva,\r\nthanks for replying.\r\nthe advice of three backwards is excellent. 👍 \r\nHow can you explain the fact that it's always the same node that crashes?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1748231071/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1748466934","html_url":"https://github.com/apache/couchdb/pull/4782#issuecomment-1748466934","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4782","id":1748466934,"node_id":"IC_kwDOAAMmUc5oN3z2","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-05T09:22:55Z","updated_at":"2023-10-05T09:22:55Z","author_association":"CONTRIBUTOR","body":"@rnewson are okay with the PR?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1748466934/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1748515337","html_url":"https://github.com/apache/couchdb/pull/4782#issuecomment-1748515337","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4782","id":1748515337,"node_id":"IC_kwDOAAMmUc5oODoJ","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-05T09:52:55Z","updated_at":"2023-10-05T09:52:55Z","author_association":"MEMBER","body":"+1","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1748515337/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1749149277","html_url":"https://github.com/apache/couchdb/pull/4792#issuecomment-1749149277","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4792","id":1749149277,"node_id":"IC_kwDOAAMmUc5oQeZd","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-05T15:35:45Z","updated_at":"2023-10-05T15:35:45Z","author_association":"CONTRIBUTOR","body":"Yes, I agree.  @rnewson, @willholley, @ricellis please comment if you have the time.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1749149277/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1749221731","html_url":"https://github.com/apache/couchdb/pull/4792#issuecomment-1749221731","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4792","id":1749221731,"node_id":"IC_kwDOAAMmUc5oQwFj","user":{"login":"ricellis","id":10698320,"node_id":"MDQ6VXNlcjEwNjk4MzIw","avatar_url":"https://avatars.githubusercontent.com/u/10698320?v=4","gravatar_id":"","url":"https://api.github.com/users/ricellis","html_url":"https://github.com/ricellis","followers_url":"https://api.github.com/users/ricellis/followers","following_url":"https://api.github.com/users/ricellis/following{/other_user}","gists_url":"https://api.github.com/users/ricellis/gists{/gist_id}","starred_url":"https://api.github.com/users/ricellis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ricellis/subscriptions","organizations_url":"https://api.github.com/users/ricellis/orgs","repos_url":"https://api.github.com/users/ricellis/repos","events_url":"https://api.github.com/users/ricellis/events{/privacy}","received_events_url":"https://api.github.com/users/ricellis/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-05T16:09:54Z","updated_at":"2023-10-05T16:09:54Z","author_association":"NONE","body":"I was under the impression that `allow_fallback` was going to apply to all `_find` requests not just those with `use_index`. I know @willholley disagreed with that overloading, but I thought that was only related to the cluster toggles. I didn't think there was an objection to disallowing `all_docs` fallback as long as applied consistently.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1749221731/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1749536999","html_url":"https://github.com/apache/couchdb/pull/4800#issuecomment-1749536999","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4800","id":1749536999,"node_id":"IC_kwDOAAMmUc5oR9Dn","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-05T19:42:30Z","updated_at":"2023-10-05T19:42:30Z","author_association":"CONTRIBUTOR","body":"It has been superseded by #4801, so I am now closing this.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1749536999/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1749630756","html_url":"https://github.com/apache/couchdb/issues/4802#issuecomment-1749630756","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4802","id":1749630756,"node_id":"IC_kwDOAAMmUc5oST8k","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-05T20:56:31Z","updated_at":"2023-10-05T20:56:31Z","author_association":"MEMBER","body":"which kind of index did you define?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1749630756/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1749632649","html_url":"https://github.com/apache/couchdb/issues/4802#issuecomment-1749632649","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4802","id":1749632649,"node_id":"IC_kwDOAAMmUc5oSUaJ","user":{"login":"gruberjl","id":10526354,"node_id":"MDQ6VXNlcjEwNTI2MzU0","avatar_url":"https://avatars.githubusercontent.com/u/10526354?v=4","gravatar_id":"","url":"https://api.github.com/users/gruberjl","html_url":"https://github.com/gruberjl","followers_url":"https://api.github.com/users/gruberjl/followers","following_url":"https://api.github.com/users/gruberjl/following{/other_user}","gists_url":"https://api.github.com/users/gruberjl/gists{/gist_id}","starred_url":"https://api.github.com/users/gruberjl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gruberjl/subscriptions","organizations_url":"https://api.github.com/users/gruberjl/orgs","repos_url":"https://api.github.com/users/gruberjl/repos","events_url":"https://api.github.com/users/gruberjl/events{/privacy}","received_events_url":"https://api.github.com/users/gruberjl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-05T20:58:13Z","updated_at":"2023-10-05T20:58:13Z","author_association":"NONE","body":"I didn't define any index.\r\n\r\nNevermind. I think I figured it out. The correct approach Is:\r\n\r\n```\r\n{\r\n   \"selector\": {\r\n      \"_id\": {\r\n         \"$gte\": \"course|\",\r\n         \"$lt\": \"course|\\ufff0\"\r\n      }\r\n   }\r\n}\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1749632649/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1749640843","html_url":"https://github.com/apache/couchdb/issues/4802#issuecomment-1749640843","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4802","id":1749640843,"node_id":"IC_kwDOAAMmUc5oSWaL","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-05T21:05:30Z","updated_at":"2023-10-05T21:05:30Z","author_association":"MEMBER","body":" hm not sure about that. ```curl -g 'foo:bar@localhost:15984/db1/_all_docs?startkey=\"foo1|\"&endkey=\"foo1}\"'``` works just fine. the (more obscure) selector-based _find version should return the same results.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1749640843/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1749652587","html_url":"https://github.com/apache/couchdb/issues/4802#issuecomment-1749652587","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4802","id":1749652587,"node_id":"IC_kwDOAAMmUc5oSZRr","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-05T21:13:10Z","updated_at":"2023-10-05T21:13:31Z","author_association":"MEMBER","body":"check the `_explain` output to see if your `_find` request is as efficient as the direct `_all_docs` request above. specifically look at the `mrargs` section to see if startkey/endkey are set. If not, couchdb is reading the entire db and then filtering afterward, which is much less efficient than `_all_docs?startkey=\"foo1|\"&endkey=\"foo1}\"`.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1749652587/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1750533629","html_url":"https://github.com/apache/couchdb/pull/4799#issuecomment-1750533629","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4799","id":1750533629,"node_id":"IC_kwDOAAMmUc5oVwX9","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-06T12:09:48Z","updated_at":"2023-10-06T12:09:48Z","author_association":"CONTRIBUTOR","body":"restarted the CI and it runs through ...","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1750533629/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1750686995","html_url":"https://github.com/apache/couchdb/issues/4802#issuecomment-1750686995","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4802","id":1750686995,"node_id":"IC_kwDOAAMmUc5oWV0T","user":{"login":"gruberjl","id":10526354,"node_id":"MDQ6VXNlcjEwNTI2MzU0","avatar_url":"https://avatars.githubusercontent.com/u/10526354?v=4","gravatar_id":"","url":"https://api.github.com/users/gruberjl","html_url":"https://github.com/gruberjl","followers_url":"https://api.github.com/users/gruberjl/followers","following_url":"https://api.github.com/users/gruberjl/following{/other_user}","gists_url":"https://api.github.com/users/gruberjl/gists{/gist_id}","starred_url":"https://api.github.com/users/gruberjl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gruberjl/subscriptions","organizations_url":"https://api.github.com/users/gruberjl/orgs","repos_url":"https://api.github.com/users/gruberjl/repos","events_url":"https://api.github.com/users/gruberjl/events{/privacy}","received_events_url":"https://api.github.com/users/gruberjl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-06T13:30:45Z","updated_at":"2023-10-06T13:30:45Z","author_association":"NONE","body":"I was using all docs but I had to switch because I need to filter on another field too.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1750686995/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1750910036","html_url":"https://github.com/apache/couchdb/pull/4799#issuecomment-1750910036","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4799","id":1750910036,"node_id":"IC_kwDOAAMmUc5oXMRU","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-06T15:28:27Z","updated_at":"2023-10-06T15:28:27Z","author_association":"CONTRIBUTOR","body":"Thanks @big-r81! \r\n\r\nI see it at https://ci-couchdb.apache.org/blue/organizations/jenkins/jenkins-cm1%2FFullPlatformMatrix/detail/jenkins-hex-cache/11/pipeline\r\n\r\nMaybe I'll try a few more rebuilds to see how it does. Eventually caches should spread across all the nodes.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1750910036/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1750975026","html_url":"https://github.com/apache/couchdb/issues/4802#issuecomment-1750975026","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4802","id":1750975026,"node_id":"IC_kwDOAAMmUc5oXcIy","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-06T15:54:51Z","updated_at":"2023-10-06T15:54:51Z","author_association":"MEMBER","body":"we tracked this down. the way _id strings are sorted is different to how other indexed strings are sorted, which explains the difference.\r\n\r\nwithout an index the performance of `_find` can be quite poor, it is a database scan each time. I'd advise against relying on unindexed querying for anything important.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1750975026/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1751043360","html_url":"https://github.com/apache/couchdb/pull/4799#issuecomment-1751043360","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4799","id":1751043360,"node_id":"IC_kwDOAAMmUc5oXs0g","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-06T16:22:46Z","updated_at":"2023-10-06T16:22:46Z","author_association":"CONTRIBUTOR","body":"That sounds like a good idea. \r\n\r\n1. Can you check if the caches are filled?\r\n2. So we have a mechanism to clean up the caches?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1751043360/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1751115363","html_url":"https://github.com/apache/couchdb/pull/4799#issuecomment-1751115363","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4799","id":1751115363,"node_id":"IC_kwDOAAMmUc5oX-Zj","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-06T17:02:08Z","updated_at":"2023-10-06T17:02:08Z","author_association":"CONTRIBUTOR","body":"One still failed in the same place on s390x worker....\r\n\r\n> Can you check if the caches are filled?\r\n\r\nWe can check manually by logging into the workers, the ones we have access too, at least. We can see if there are any files in the cache.\r\n\r\n> So we have a mechanism to clean up the caches?\r\n\r\nHmm we don't have anything like that. We could make separate jenkins task to do that. Like we have that jenkins docker image cleaning task.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1751115363/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1751198726","html_url":"https://github.com/apache/couchdb/pull/4799#issuecomment-1751198726","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4799","id":1751198726,"node_id":"IC_kwDOAAMmUc5oYSwG","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-06T18:01:33Z","updated_at":"2023-10-06T18:01:33Z","author_association":"CONTRIBUTOR","body":"I also added a MIX_HOME dir as a cache option. Let's see if that makes any difference.\r\n\r\nOtherwise, I think we might want to reach out the Z Linux (s390x arch) team. It could either be a compatibility issue or somehow the CI IP range might be throttled.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1751198726/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1751223909","html_url":"https://github.com/apache/couchdb/pull/4799#issuecomment-1751223909","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4799","id":1751223909,"node_id":"IC_kwDOAAMmUc5oYY5l","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-06T18:24:19Z","updated_at":"2023-10-06T18:24:19Z","author_association":"CONTRIBUTOR","body":"The caching seems to at least speed up the 'Build Release Tarball' step. I noticed on main it takes about 6 minutes and with caches it's about 5 minutes. Builds overall seem to have gotten 4-6 minutes faster.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1751223909/reactions","total_count":2,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":1,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1751270719","html_url":"https://github.com/apache/couchdb/pull/4799#issuecomment-1751270719","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4799","id":1751270719,"node_id":"IC_kwDOAAMmUc5oYkU_","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-06T18:53:02Z","updated_at":"2023-10-06T18:53:02Z","author_association":"CONTRIBUTOR","body":"I made an issue in the Z Linux community: https://github.com/linuxone-community-cloud/tickets/issues/58\r\n\r\nFor now I think we'll disable the s390x worker until that's figure out.\r\n\r\nThe ARM Debian worker can also be disabled for now based on talking to the maintainer. We still have the FreeBSD arm workers to we'll be testing the architecture there,","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1751270719/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1751455476","html_url":"https://github.com/apache/couchdb/pull/4799#issuecomment-1751455476","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4799","id":1751455476,"node_id":"IC_kwDOAAMmUc5oZRb0","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-06T22:13:10Z","updated_at":"2023-10-06T22:13:10Z","author_association":"CONTRIBUTOR","body":"<img width=\"630\" alt=\"Screenshot 2023-10-06 at 5 49 19 PM\" src=\"https://github.com/apache/couchdb/assets/211822/ff6b8497-bab0-4ab4-bbb6-cdee863f7590\">\r\n\r\nWell we got 3 builds in a row. Should we merge it?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1751455476/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1752297282","html_url":"https://github.com/apache/couchdb/issues/4797#issuecomment-1752297282","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4797","id":1752297282,"node_id":"IC_kwDOAAMmUc5oce9C","user":{"login":"wjblume","id":13815576,"node_id":"MDQ6VXNlcjEzODE1NTc2","avatar_url":"https://avatars.githubusercontent.com/u/13815576?v=4","gravatar_id":"","url":"https://api.github.com/users/wjblume","html_url":"https://github.com/wjblume","followers_url":"https://api.github.com/users/wjblume/followers","following_url":"https://api.github.com/users/wjblume/following{/other_user}","gists_url":"https://api.github.com/users/wjblume/gists{/gist_id}","starred_url":"https://api.github.com/users/wjblume/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wjblume/subscriptions","organizations_url":"https://api.github.com/users/wjblume/orgs","repos_url":"https://api.github.com/users/wjblume/repos","events_url":"https://api.github.com/users/wjblume/events{/privacy}","received_events_url":"https://api.github.com/users/wjblume/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-09T03:27:36Z","updated_at":"2023-10-09T03:27:36Z","author_association":"NONE","body":"@big-r81,\r\nThanks, that link got me 3.3.2 and 3.2.3 versions that at least differed.  The 3.3.2 was the same as I got from the original link, and failed to load.  The couchdb.logs indicated that it had a dependency that had a dependency, that... depended on Homebrew being installed.  After installing Homebrew (twice) the install *.pkg seemed to leave out a lot.  I finally did a shell install and got things working, mostly... :-}","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1752297282/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1752303505","html_url":"https://github.com/apache/couchdb/issues/4797#issuecomment-1752303505","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4797","id":1752303505,"node_id":"IC_kwDOAAMmUc5ocgeR","user":{"login":"wjblume","id":13815576,"node_id":"MDQ6VXNlcjEzODE1NTc2","avatar_url":"https://avatars.githubusercontent.com/u/13815576?v=4","gravatar_id":"","url":"https://api.github.com/users/wjblume","html_url":"https://github.com/wjblume","followers_url":"https://api.github.com/users/wjblume/followers","following_url":"https://api.github.com/users/wjblume/following{/other_user}","gists_url":"https://api.github.com/users/wjblume/gists{/gist_id}","starred_url":"https://api.github.com/users/wjblume/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wjblume/subscriptions","organizations_url":"https://api.github.com/users/wjblume/orgs","repos_url":"https://api.github.com/users/wjblume/repos","events_url":"https://api.github.com/users/wjblume/events{/privacy}","received_events_url":"https://api.github.com/users/wjblume/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-09T03:38:55Z","updated_at":"2023-10-09T03:38:55Z","author_association":"NONE","body":"Ah, 3.2.3 does NOT have Homebrew dependencies.  Build error on 3.3.2?\r\n\r\nThis is the macOS ARM versions.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1752303505/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1752392185","html_url":"https://github.com/apache/couchdb/issues/4797#issuecomment-1752392185","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4797","id":1752392185,"node_id":"IC_kwDOAAMmUc5oc2H5","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-09T06:06:33Z","updated_at":"2023-10-09T06:06:33Z","author_association":"CONTRIBUTOR","body":"> The couchdb.logs indicated that it had a dependency that had a dependency, that... depended on Homebrew being installed. After installing Homebrew (twice) the install *.pkg seemed to leave out a lot.\r\n\r\nCan you share the log file?\r\nWhich *.pkg do you mean? ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1752392185/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1752970378","html_url":"https://github.com/apache/couchdb/pull/4792#issuecomment-1752970378","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4792","id":1752970378,"node_id":"IC_kwDOAAMmUc5ofDSK","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-09T13:01:26Z","updated_at":"2023-10-09T13:01:26Z","author_association":"CONTRIBUTOR","body":"I do not want to respond on behalf of @willholley but in my understanding, in [his respective comment](https://github.com/apache/couchdb/pull/4710#issuecomment-1737168382) he opposed to extending the `allow_fallback` mechanism to `_all_docs`: _\"I'm less keen on overloading it to removing the use of the `_all_docs` index\"_.  He also included a historical reference to suggest that it would not give us much: _\"Mango did originally prevent the `_all_docs` fallback unless the query contained a clause that would require it. [..] lots of users just blindly added a `{ _id: { \"$gt\": 0 } }` clause to [..] work around the restriction.\"_","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1752970378/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1755747390","html_url":"https://github.com/apache/couchdb/issues/3887#issuecomment-1755747390","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3887","id":1755747390,"node_id":"IC_kwDOAAMmUc5oppQ-","user":{"login":"catgirlinspace","id":13684891,"node_id":"MDQ6VXNlcjEzNjg0ODkx","avatar_url":"https://avatars.githubusercontent.com/u/13684891?v=4","gravatar_id":"","url":"https://api.github.com/users/catgirlinspace","html_url":"https://github.com/catgirlinspace","followers_url":"https://api.github.com/users/catgirlinspace/followers","following_url":"https://api.github.com/users/catgirlinspace/following{/other_user}","gists_url":"https://api.github.com/users/catgirlinspace/gists{/gist_id}","starred_url":"https://api.github.com/users/catgirlinspace/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/catgirlinspace/subscriptions","organizations_url":"https://api.github.com/users/catgirlinspace/orgs","repos_url":"https://api.github.com/users/catgirlinspace/repos","events_url":"https://api.github.com/users/catgirlinspace/events{/privacy}","received_events_url":"https://api.github.com/users/catgirlinspace/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-10T15:58:39Z","updated_at":"2023-10-10T15:58:39Z","author_association":"NONE","body":"@nickva Not sure if that's the bug actually, as I'm getting this same error when using internal domains from fly.io that have AAAA records. I'm able to `curl` the same thing just fine, but CouchDB fails to replicate. \r\n```\r\n2023-10-10T15:37:03.329 app[5683d554a54dd8] iad [info] [error] 2023-10-10T15:37:03.329220Z nonode@nohost <0.2198.1> -------- Replicator, request GET to \"http://5683d554a54dd8.vm.kitty-couchdb.internal:5984/kitty/\" failed due to error {error,{conn_failed,{error,nxdomain}}}\r\n\r\n2023-10-10T15:37:03.330 app[5683d554a54dd8] iad [info] [error] 2023-10-10T15:37:03.329678Z nonode@nohost <0.2198.1> -------- exit:{nxdomain,<<\"could not resolve http://5683d554a54dd8.vm.kitty-couchdb.internal:5984/kitty/\">>}: Replication c69137545c9630b0fc5f26941816e28b+continuous+create_target failed to start \"http://5683d554a54dd8.vm.kitty-couchdb.internal:5984/kitty/\" -> \"http://e784936a2e2768.vm.kitty-couchdb.internal:5984/kitty/\" doc <<\"shards/80000000-ffffffff/_replicator.1696915972\">>:<<\"f0283eeea4248b169847e01f30001169\">> stack:[{couch_replicator_api_wrap,db_open,3,[{file,\"src/couch_replicator_api_wrap.erl\"},{line,122}]},{couch_replicator_scheduler_job,init_state,1,[{file,\"src/couch_replicator_scheduler_job.erl\"},{line,634}]}]\r\n```\r\n\r\n```\r\nroot@5683d554a54dd8:/# curl http://5683d554a54dd8.vm.kitty-couchdb.internal:5984/_up\r\n{\"status\":\"ok\",\"seeds\":{}}\r\n```\r\n\r\n(`5683d554a54dd8` is the machine with the local database, `e784936a2e2768` is the machine being replicated to)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1755747390/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1755847211","html_url":"https://github.com/apache/couchdb/issues/3887#issuecomment-1755847211","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3887","id":1755847211,"node_id":"IC_kwDOAAMmUc5oqBor","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-10T16:49:02Z","updated_at":"2023-10-10T16:49:02Z","author_association":"MEMBER","body":"Is it fixed by 882e7161acb692d3e721c7653d8cdc2e5e65d2ef?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1755847211/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1755852807","html_url":"https://github.com/apache/couchdb/issues/3887#issuecomment-1755852807","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3887","id":1755852807,"node_id":"IC_kwDOAAMmUc5oqDAH","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-10T16:50:47Z","updated_at":"2023-10-10T16:50:47Z","author_association":"CONTRIBUTOR","body":"Good find @rnewson \r\n\r\nThat patch hasn't been released yet I think. @catgirlinspace would you be able to build Apache CouchDB `main` from source?\r\n\r\nIf you can, then you can try it out with this option:\r\n\r\n```ini\r\n[replicator]\r\nibrowse_options = [{prefer_ipv6, true}]\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1755852807/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1755867763","html_url":"https://github.com/apache/couchdb/issues/3887#issuecomment-1755867763","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3887","id":1755867763,"node_id":"IC_kwDOAAMmUc5oqGpz","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-10T16:56:15Z","updated_at":"2023-10-10T16:56:15Z","author_association":"MEMBER","body":"also its implied the nodes are ipv6-only so if this is a cluster I don't think they can connect without a separate change in `vm.args` to switch the distribution protocol module to `inet6_tcp' (https://www.erlang.org/doc/man/erl#proto_dist)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1755867763/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1756136122","html_url":"https://github.com/apache/couchdb/issues/3887#issuecomment-1756136122","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3887","id":1756136122,"node_id":"IC_kwDOAAMmUc5orIK6","user":{"login":"catgirlinspace","id":13684891,"node_id":"MDQ6VXNlcjEzNjg0ODkx","avatar_url":"https://avatars.githubusercontent.com/u/13684891?v=4","gravatar_id":"","url":"https://api.github.com/users/catgirlinspace","html_url":"https://github.com/catgirlinspace","followers_url":"https://api.github.com/users/catgirlinspace/followers","following_url":"https://api.github.com/users/catgirlinspace/following{/other_user}","gists_url":"https://api.github.com/users/catgirlinspace/gists{/gist_id}","starred_url":"https://api.github.com/users/catgirlinspace/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/catgirlinspace/subscriptions","organizations_url":"https://api.github.com/users/catgirlinspace/orgs","repos_url":"https://api.github.com/users/catgirlinspace/repos","events_url":"https://api.github.com/users/catgirlinspace/events{/privacy}","received_events_url":"https://api.github.com/users/catgirlinspace/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-10T19:59:24Z","updated_at":"2023-10-10T19:59:24Z","author_association":"NONE","body":"not at home to try that atm, but I'll try using a build of main tonight!\n\nUnrelated but feels like an ok opportunity to ask since it was mentioned--is there much of a difference between replication and the clustering? Can I write to any node and it replicates to all the others with both methods or does that only work with one of them? ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1756136122/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1756164815","html_url":"https://github.com/apache/couchdb/issues/3887#issuecomment-1756164815","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3887","id":1756164815,"node_id":"IC_kwDOAAMmUc5orPLP","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-10T20:21:16Z","updated_at":"2023-10-10T20:21:16Z","author_association":"CONTRIBUTOR","body":"Clustering is a way to connect multiple Apache CouchDB nodes using Erlang's native clustering mechanism over TCP connections. At the HTTP API level it looks like a single Apache CouchDB instance. With clustering you could get 1) better performance, by having nodes process requests in parallel, and 2) reliability by having 2 extra document copies on separate nodes. If one or two node go down, you can still access you data. However there is more setup involved, with some firewall rules. See https://docs.couchdb.org/en/stable/cluster/index.html for more info. Clustering works best on reliable, low latency, network connections.\r\n\r\nReplication is a way to replicate data between any Apache CouchDB compatible endpoints. It's a peer-to-peer setup, which is kind of a unique feature amongst databases. All the data is replicated via the HTTP API interface. You can run replication jobs on any Apache CouchDB instance and it can replicate between any two other CouchDB instances.  Replication can be bi-directional (A->B, B->A), or you can set up any other topology you like: a star, with a central instance, or a circle, etc. Replication is suitable even for high latency or unreliable networks, with intermittent connectivity. There are checkpoints and retries, which are all configurable.\r\n\r\n> Can I write to any node and it replicates to all the others with both methods or does that only work with one of them?\r\n\r\nIn case of replications, you can achieve that with a bi-directional replication. If you have CouchDB instances A  and B. You can replicate from A to B and then also from B to A. Those two replication jobs, then can also run on A, B, or even a third cluster C! You can read more about it in: https://docs.couchdb.org/en/stable/replication/index.html But you'd also have to be aware of conflicts since the same document could be updated concurrently on A and B.  You can read more about it here: https://docs.couchdb.org/en/stable/replication/conflicts.html","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1756164815/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1756182484","html_url":"https://github.com/apache/couchdb/issues/4797#issuecomment-1756182484","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4797","id":1756182484,"node_id":"IC_kwDOAAMmUc5orTfU","user":{"login":"wjblume","id":13815576,"node_id":"MDQ6VXNlcjEzODE1NTc2","avatar_url":"https://avatars.githubusercontent.com/u/13815576?v=4","gravatar_id":"","url":"https://api.github.com/users/wjblume","html_url":"https://github.com/wjblume","followers_url":"https://api.github.com/users/wjblume/followers","following_url":"https://api.github.com/users/wjblume/following{/other_user}","gists_url":"https://api.github.com/users/wjblume/gists{/gist_id}","starred_url":"https://api.github.com/users/wjblume/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wjblume/subscriptions","organizations_url":"https://api.github.com/users/wjblume/orgs","repos_url":"https://api.github.com/users/wjblume/repos","events_url":"https://api.github.com/users/wjblume/events{/privacy}","received_events_url":"https://api.github.com/users/wjblume/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-10T20:31:47Z","updated_at":"2023-10-10T20:31:47Z","author_association":"NONE","body":"The macOS ARM 3.3.2 files from here:\r\nFollowing this, path both the the 3.3.2 and 3.2.3 macOS ARM's are still identical, actually 3.3.2\r\nhttps://couchdb.apache.org/#download\r\n\r\nThe 3.3.2 macOS from here is broken.  The 3.2.3 works.\r\nhttps://neighbourhood.ie/download-apache-couchdb-mac\r\n\r\nLOG ERROR:\r\n[error] 2023-10-10T20:28:36.815736Z couchdb@localhost <0.265.0> -------- Unable to load crypto library. Failed with error:\r\n\"load_failed, Failed to load NIF library: 'dlopen(/Applications/Apache CouchDB.app/Contents/Resources/couchdbx-core/bin/../lib/crypto-5.2/priv/lib/crypto.so, 0x0002): Library not loaded: '/opt/homebrew/opt/openssl@3/lib/libcrypto.3.dylib'\r\n  Referenced from: '/Applications/Apache CouchDB.app/Contents/Resources/couchdbx-core/lib/crypto-5.2/priv/lib/crypto.so'","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1756182484/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1756488038","html_url":"https://github.com/apache/couchdb/issues/3887#issuecomment-1756488038","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3887","id":1756488038,"node_id":"IC_kwDOAAMmUc5oseFm","user":{"login":"catgirlinspace","id":13684891,"node_id":"MDQ6VXNlcjEzNjg0ODkx","avatar_url":"https://avatars.githubusercontent.com/u/13684891?v=4","gravatar_id":"","url":"https://api.github.com/users/catgirlinspace","html_url":"https://github.com/catgirlinspace","followers_url":"https://api.github.com/users/catgirlinspace/followers","following_url":"https://api.github.com/users/catgirlinspace/following{/other_user}","gists_url":"https://api.github.com/users/catgirlinspace/gists{/gist_id}","starred_url":"https://api.github.com/users/catgirlinspace/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/catgirlinspace/subscriptions","organizations_url":"https://api.github.com/users/catgirlinspace/orgs","repos_url":"https://api.github.com/users/catgirlinspace/repos","events_url":"https://api.github.com/users/catgirlinspace/events{/privacy}","received_events_url":"https://api.github.com/users/catgirlinspace/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-11T00:09:02Z","updated_at":"2023-10-11T00:09:02Z","author_association":"NONE","body":"Ah, that makes a lot more sense, thank you!! Would be good to maybe put that somewhere in the docs possibly. I didn't see an explanation like this anywhere when I was looking. \r\n\r\nFor having A, B, and C nodes, how would I setup replication? Would I want like a triangle, where each vertex is a node and each side has bi-directional replication? ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1756488038/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1756491509","html_url":"https://github.com/apache/couchdb/issues/3887#issuecomment-1756491509","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3887","id":1756491509,"node_id":"IC_kwDOAAMmUc5ose71","user":{"login":"catgirlinspace","id":13684891,"node_id":"MDQ6VXNlcjEzNjg0ODkx","avatar_url":"https://avatars.githubusercontent.com/u/13684891?v=4","gravatar_id":"","url":"https://api.github.com/users/catgirlinspace","html_url":"https://github.com/catgirlinspace","followers_url":"https://api.github.com/users/catgirlinspace/followers","following_url":"https://api.github.com/users/catgirlinspace/following{/other_user}","gists_url":"https://api.github.com/users/catgirlinspace/gists{/gist_id}","starred_url":"https://api.github.com/users/catgirlinspace/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/catgirlinspace/subscriptions","organizations_url":"https://api.github.com/users/catgirlinspace/orgs","repos_url":"https://api.github.com/users/catgirlinspace/repos","events_url":"https://api.github.com/users/catgirlinspace/events{/privacy}","received_events_url":"https://api.github.com/users/catgirlinspace/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-11T00:13:58Z","updated_at":"2023-10-11T00:13:58Z","author_association":"NONE","body":"@nickva good news-- building CouchDB from `main` and using the config option you provided fixed it!!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1756491509/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1756624159","html_url":"https://github.com/apache/couchdb/pull/4804#issuecomment-1756624159","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4804","id":1756624159,"node_id":"IC_kwDOAAMmUc5os_Uf","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-11T02:11:47Z","updated_at":"2023-10-11T02:11:47Z","author_association":"CONTRIBUTOR","body":"Also remove Sphinx from the list since it's automatically installed by the pip requirements.txt file in docs app.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1756624159/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1756661265","html_url":"https://github.com/apache/couchdb/issues/3887#issuecomment-1756661265","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3887","id":1756661265,"node_id":"IC_kwDOAAMmUc5otIYR","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-11T02:41:54Z","updated_at":"2023-10-11T02:41:54Z","author_association":"CONTRIBUTOR","body":"> good news-- building CouchDB from main and using the config option you provided fixed it!!\r\n\r\nThat's great to hear. Credit also goes to @rnewson for both fixing the ipv6 setting and remembering that it was the correct answer for this issue! \r\n\r\n> For having A, B, and C nodes, how would I setup replication? Would I want like a triangle, where each vertex is a node and each side has bi-directional replication?\r\n\r\nA triangle would work with 3 bi-directional links (a total of 6 links):\r\n   * On A run: A -> B, A-> C\r\n   * On B run: B -> A, B -> C\r\n   * On C run: C -> A, C -> B\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1756661265/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1756686422","html_url":"https://github.com/apache/couchdb/issues/3887#issuecomment-1756686422","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3887","id":1756686422,"node_id":"IC_kwDOAAMmUc5otOhW","user":{"login":"catgirlinspace","id":13684891,"node_id":"MDQ6VXNlcjEzNjg0ODkx","avatar_url":"https://avatars.githubusercontent.com/u/13684891?v=4","gravatar_id":"","url":"https://api.github.com/users/catgirlinspace","html_url":"https://github.com/catgirlinspace","followers_url":"https://api.github.com/users/catgirlinspace/followers","following_url":"https://api.github.com/users/catgirlinspace/following{/other_user}","gists_url":"https://api.github.com/users/catgirlinspace/gists{/gist_id}","starred_url":"https://api.github.com/users/catgirlinspace/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/catgirlinspace/subscriptions","organizations_url":"https://api.github.com/users/catgirlinspace/orgs","repos_url":"https://api.github.com/users/catgirlinspace/repos","events_url":"https://api.github.com/users/catgirlinspace/events{/privacy}","received_events_url":"https://api.github.com/users/catgirlinspace/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-11T03:02:37Z","updated_at":"2023-10-11T03:02:37Z","author_association":"NONE","body":"Ah, I'll try that, thanks! Might also make a PR to the docs on replication to add this stuff (unless you want to?). Feels like this is information that should be there but I couldn't find it. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1756686422/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1756696635","html_url":"https://github.com/apache/couchdb/issues/3887#issuecomment-1756696635","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3887","id":1756696635,"node_id":"IC_kwDOAAMmUc5otRA7","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-11T03:09:46Z","updated_at":"2023-10-11T03:09:46Z","author_association":"CONTRIBUTOR","body":"> Might also make a PR to the docs on replication to add this stuff \r\n\r\nThat would be great, please do. Contributions are always welcome!\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1756696635/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1757988161","html_url":"https://github.com/apache/couchdb/issues/4797#issuecomment-1757988161","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4797","id":1757988161,"node_id":"IC_kwDOAAMmUc5oyMVB","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-11T15:42:50Z","updated_at":"2023-10-11T15:42:50Z","author_association":"CONTRIBUTOR","body":"Ok, it should work if you install OpenSSL from Homebrew…","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1757988161/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1758098029","html_url":"https://github.com/apache/couchdb/pull/4792#issuecomment-1758098029","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4792","id":1758098029,"node_id":"IC_kwDOAAMmUc5oynJt","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-11T16:49:03Z","updated_at":"2023-10-11T16:49:03Z","author_association":"MEMBER","body":"if `allow_fallback: false` will allow fallback, then it will not be merged.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1758098029/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1758104147","html_url":"https://github.com/apache/couchdb/pull/4792#issuecomment-1758104147","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4792","id":1758104147,"node_id":"IC_kwDOAAMmUc5oyopT","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-11T16:53:01Z","updated_at":"2023-10-11T16:53:01Z","author_association":"CONTRIBUTOR","body":"@rnewson do you mean that we shall extend this change to disabling the `_all_docs` fallback as well?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1758104147/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1758105504","html_url":"https://github.com/apache/couchdb/pull/4792#issuecomment-1758105504","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4792","id":1758105504,"node_id":"IC_kwDOAAMmUc5oyo-g","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-11T16:53:57Z","updated_at":"2023-10-11T16:53:57Z","author_association":"MEMBER","body":"Yes. Remember this an opt-in in the request body by the user. They are asking us to not fallback; they want an error instead of inefficient execution. I do not understand @willholley's objection to this.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1758105504/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1758467716","html_url":"https://github.com/apache/couchdb/pull/4792#issuecomment-1758467716","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4792","id":1758467716,"node_id":"IC_kwDOAAMmUc5o0BaE","user":{"login":"willholley","id":97787,"node_id":"MDQ6VXNlcjk3Nzg3","avatar_url":"https://avatars.githubusercontent.com/u/97787?v=4","gravatar_id":"","url":"https://api.github.com/users/willholley","html_url":"https://github.com/willholley","followers_url":"https://api.github.com/users/willholley/followers","following_url":"https://api.github.com/users/willholley/following{/other_user}","gists_url":"https://api.github.com/users/willholley/gists{/gist_id}","starred_url":"https://api.github.com/users/willholley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/willholley/subscriptions","organizations_url":"https://api.github.com/users/willholley/orgs","repos_url":"https://api.github.com/users/willholley/repos","events_url":"https://api.github.com/users/willholley/events{/privacy}","received_events_url":"https://api.github.com/users/willholley/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-11T20:15:46Z","updated_at":"2023-10-11T20:15:46Z","author_association":"MEMBER","body":"I don't think this issue / PR has anything to do with query efficiency - only fixing the unclear semantics of `use_index`.\r\n\r\nI'm open to a discussion about if we want to / how to prevent use of inefficient indexes or, but that's much broader problem space in which I don't see `_all_docs` as any different to user-defined indexes.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1758467716/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1764424454","html_url":"https://github.com/apache/couchdb/pull/4806#issuecomment-1764424454","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4806","id":1764424454,"node_id":"IC_kwDOAAMmUc5pKvsG","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-16T12:53:43Z","updated_at":"2023-10-16T12:53:43Z","author_association":"CONTRIBUTOR","body":"I tested this with and without Clouseau and I can confirm the results.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1764424454/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1765685906","html_url":"https://github.com/apache/couchdb/issues/4809#issuecomment-1765685906","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4809","id":1765685906,"node_id":"IC_kwDOAAMmUc5pPjqS","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-17T05:19:20Z","updated_at":"2023-10-17T05:19:20Z","author_association":"CONTRIBUTOR","body":"This seems to reproduce it:\r\n\r\n```\r\ndiff --git a/src/couch_index/src/couch_index_server.erl b/src/couch_index/src/couch_index_server.erl\r\nindex 35df43d2a..a40ea0e2a 100644\r\n--- a/src/couch_index/src/couch_index_server.erl\r\n+++ b/src/couch_index/src/couch_index_server.erl\r\n@@ -171,6 +171,7 @@ handle_call({async_open, {DbName, DDocId, Sig}, {ok, Pid}}, {OpenerPid, _}, Stat\r\n     [{_, Waiters}] = ets:lookup(State#st.by_sig, {DbName, Sig}),\r\n     [gen_server:reply(From, {ok, Pid}) || From <- Waiters],\r\n     link(Pid),\r\n+    timer:sleep(100),\r\n     ets:delete(State#st.openers, OpenerPid),\r\n     add_to_ets(DbName, Sig, DDocId, Pid, State),\r\n     {reply, ok, State};\r\n```\r\n\r\nAsync open returns too early an index process to the caller. In the index server we have an opener still in openers and haven't added the new process to the other ets tables.\r\n\r\nAt this point the caller gets the index Pid and kills it. This kills both index and the still linked opener. \r\n\r\nClient calls `get_index(...)` again, while that call is in the queue, the index server continues the `async_open` handler and deletes the `ets:delete(State#st.openers, OpenerPid)`. Then starts handling `EXIT` messages.\r\n\r\nFirst is the indexer `EXIT` message. This is handled in:\r\n```erlang\r\n    case ets:lookup(Server#st.by_pid, Pid) of\r\n        [{Pid, {DbName, Sig}}] -> ...\r\n```\r\n\r\nHowever when the opener `EXIT` is handled, we don't find the `Pid` in the `by_pid` or the openers table and we crash the gen_server.\r\n```erlang\r\n            case ets:lookup(Server#st.openers, Pid) of\r\n                ... ->  ...;\r\n                [] ->\r\n                    exit(Reason)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1765685906/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1767999956","html_url":"https://github.com/apache/couchdb/pull/4810#issuecomment-1767999956","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4810","id":1767999956,"node_id":"IC_kwDOAAMmUc5pYYnU","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-18T08:58:41Z","updated_at":"2023-10-18T08:58:41Z","author_association":"CONTRIBUTOR","body":"Great work!  I think it would be worth to cover the `text` indexes with tests in this PR otherwise it can easily go forgotten.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1767999956/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1773068107","html_url":"https://github.com/apache/couchdb/pull/4814#issuecomment-1773068107","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4814","id":1773068107,"node_id":"IC_kwDOAAMmUc5prt9L","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-20T16:47:54Z","updated_at":"2023-10-20T16:47:54Z","author_association":"MEMBER","body":"I'd considered https://github.com/esl/fast_pbkdf2/ before I noticed they'd made it part of crypto.erl. It just hadn't occurred to me that it would be worse. I will switch to fast_pbkdf2 instead, which does the NIF yieldy goop we need.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1773068107/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1773072702","html_url":"https://github.com/apache/couchdb/pull/4814#issuecomment-1773072702","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4814","id":1773072702,"node_id":"IC_kwDOAAMmUc5prvE-","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-20T16:51:36Z","updated_at":"2023-10-20T16:51:36Z","author_association":"MEMBER","body":"I deliberately separated into multiple commits but I feel adding pbkdf2-sha256 with high iterations without the cache would lead to problems for folks.\r\n\r\nthe password cache could be optional, I could add a toggle so admins that want to can disable it. given that the work effort for a cached item is quite small (though not as small as the single-pass sha1) I didn't think it was necessary, but it's also easy to add.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1773072702/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1773108294","html_url":"https://github.com/apache/couchdb/pull/4814#issuecomment-1773108294","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4814","id":1773108294,"node_id":"IC_kwDOAAMmUc5pr3xG","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-20T17:15:34Z","updated_at":"2023-10-20T17:15:34Z","author_association":"CONTRIBUTOR","body":"> I'd considered https://github.com/esl/fast_pbkdf2/ before I noticed they'd made it part of crypto.erl. It just hadn't occurred to me that it would be worse. I will switch to fast_pbkdf2 instead, which does the NIF yieldy goop we need.\r\n\r\nOr even upgrading our pbkdf2 could work too but yeah that one does seem to do better.\r\n\r\nHere is an escript which shows the abnormal behavior:\r\n\r\n```erlang\r\n#!/usr/bin/env escript\r\n%% -*- erlang -*-\r\n\r\n-mode(compile).\r\n\r\nhash() ->\r\n    crypto:pbkdf2_hmac(sha256, <<\"password\">>, <<\"salt\">>, 1500000, 32),\r\n    %timer:sleep(1),\r\n    %erlang:yield(),\r\n    hash().\r\n\r\nspawn_hasher() ->\r\n    spawn_link(fun() ->\r\n        timer:sleep(round(rand:uniform() * 10)),\r\n        hash()\r\n    end).\r\n\r\nmain([TimeSecStr, HashersStr]) ->\r\n    TimeSec = list_to_integer(TimeSecStr),\r\n    Hashers = list_to_integer(HashersStr),\r\n    HasherPids = [spawn_hasher() || _ <- lists:seq(1, Hashers)],\r\n    io:format(\" * ~p hashers started, measuring scheduler usage for ~p seconds~n\", [Hashers, TimeSec]),\r\n    T0 = erlang:monotonic_time(millisecond),\r\n    msacc:start(TimeSec * 1000),\r\n    T1 = erlang:monotonic_time(millisecond),\r\n    io:format(\" * killing ~p hashers~n\", [Hashers]),\r\n    [begin unlink(Pid), exit(Pid, kill) end || Pid <- HasherPids],\r\n    io:format(\" * displaying msacc stats~n\", []),\r\n    msacc:print(msacc:stats(), #{system => true}),\r\n    io:format(\" * time it took to run: ~p~n\", [(T1-T0)/1000]),\r\n    io:format(\" * done~n\").\r\n```\r\n\r\n\r\nIt should be done in about 10 second but it just block and until I stopped it by hand:\r\n```\r\n% time ./pbkdfprocs.escript 10 4\r\n * 4 hashers started, measuring scheduler usage for 10 seconds\r\n^C\r\n./pbkdfprocs.escript 10 4  51.52s user 0.38s system 99% cpu 52.347 total\r\n```\r\n\r\nI'll make an OTP issue, otherwise the function, as is, is completely unusable for its intended purpose.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1773108294/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1773223659","html_url":"https://github.com/apache/couchdb/pull/4814#issuecomment-1773223659","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4814","id":1773223659,"node_id":"IC_kwDOAAMmUc5psT7r","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-20T18:43:38Z","updated_at":"2023-10-20T18:43:38Z","author_association":"CONTRIBUTOR","body":"Upstream OTP issue: https://github.com/erlang/otp/issues/7769","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1773223659/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1773247146","html_url":"https://github.com/apache/couchdb/issues/4815#issuecomment-1773247146","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4815","id":1773247146,"node_id":"IC_kwDOAAMmUc5psZqq","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-20T18:57:43Z","updated_at":"2023-10-20T18:57:43Z","author_association":"CONTRIBUTOR","body":"Hi,\r\n\r\nlooking at https://docs.couchdb.org/en/stable/config-ref.html#cap-log there is no `compaction_log_level` key. Try to set `level` properly.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1773247146/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1773263772","html_url":"https://github.com/apache/couchdb/pull/4814#issuecomment-1773263772","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4814","id":1773263772,"node_id":"IC_kwDOAAMmUc5psduc","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-20T19:07:28Z","updated_at":"2023-10-20T19:07:28Z","author_association":"CONTRIBUTOR","body":"Some additional infos about the iteration count: https://cheatsheetseries.owasp.org/cheatsheets/Password_Storage_Cheat_Sheet.html#pbkdf2","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1773263772/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1773280319","html_url":"https://github.com/apache/couchdb/issues/4815#issuecomment-1773280319","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4815","id":1773280319,"node_id":"IC_kwDOAAMmUc5pshw_","user":{"login":"Sdas0000","id":138152510,"node_id":"U_kgDOCDwKPg","avatar_url":"https://avatars.githubusercontent.com/u/138152510?v=4","gravatar_id":"","url":"https://api.github.com/users/Sdas0000","html_url":"https://github.com/Sdas0000","followers_url":"https://api.github.com/users/Sdas0000/followers","following_url":"https://api.github.com/users/Sdas0000/following{/other_user}","gists_url":"https://api.github.com/users/Sdas0000/gists{/gist_id}","starred_url":"https://api.github.com/users/Sdas0000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Sdas0000/subscriptions","organizations_url":"https://api.github.com/users/Sdas0000/orgs","repos_url":"https://api.github.com/users/Sdas0000/repos","events_url":"https://api.github.com/users/Sdas0000/events{/privacy}","received_events_url":"https://api.github.com/users/Sdas0000/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-20T19:21:33Z","updated_at":"2023-10-20T19:21:33Z","author_association":"NONE","body":"It is in default.ini \r\n\r\nhttps://github.com/apache/couchdb/blob/main/rel/overlay/etc/default.ini\r\n\r\nLine number 96 \r\n \r\n; Sets the log level for informational compaction related entries.\r\n;compaction_log_level = info\r\n\r\n\r\n\r\n\r\nI think it is coded : \r\n\r\n167 | {Key, Starting1} ->\r\n-- | --\r\n168 | Level = smoosh_utils:log_level(\"compaction_log_level\", \"notice\"),\r\n169 | LogMsg = \"~s: Started compaction for ~s\",\r\n \r\n252 | Capacity = smoosh_utils:capacity(State#state.name),\r\n253 | Level = smoosh_utils:log_level(\"compaction_log_level\", \"notice\"),\r\n254 | LogMsg = \"~s: enqueueing ~p to compact with priority ~p\",\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1773280319/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1773335087","html_url":"https://github.com/apache/couchdb/issues/4815#issuecomment-1773335087","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4815","id":1773335087,"node_id":"IC_kwDOAAMmUc5psvIv","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-20T20:10:09Z","updated_at":"2023-10-20T20:10:09Z","author_association":"CONTRIBUTOR","body":"The `default.ini` has two(!) places where we configure the compaction log level. One is in the `[couchdb]` section, and the other is in the `[smoosh]` section. The one in `[couchdb]` indicates when compaction actually happens, even if triggered manually via `/_compact` endpoint; and the one in `[smoosh]`, is for entries emitted by the smoosh auto-compactor service.\r\n\r\nTry setting both to `warning` (or both to`error`) and see if you see any emitted logs. Depending how you set the values, if it's at runtime you may want to call `_reload` or simply restart your nodes: https://docs.couchdb.org/en/stable/api/server/configuration.html#node-node-name-config-reload\r\n\r\nGood find @big-r81 that we never documented that config value. They are kind of low level that's probably why bit might be nice to document them nevertheless.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1773335087/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1773480674","html_url":"https://github.com/apache/couchdb/pull/4814#issuecomment-1773480674","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4814","id":1773480674,"node_id":"IC_kwDOAAMmUc5ptSri","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-20T22:47:39Z","updated_at":"2023-10-20T22:47:39Z","author_association":"CONTRIBUTOR","body":"> I deliberately separated into multiple commits but I feel adding pbkdf2-sha256 with high iterations without the cache would lead to problems for folks.\r\n> \r\n\r\nThe cache would be for the increased default iteration count? It would make sense to add it even for a sha1 higher iteration count. sha256 is a bit more expensive but still within the same order of magnitude as sha1.\r\n\r\n```\r\n> timer:tc(fun() ->  crypto:pbkdf2_hmac(sha256, <<\"password\">>, <<\"salt\">>, 10000, 32) end).\r\n{7010,\r\n <<94,192,43,145,164,181,156,111,89,221,95,190,76,166,73,\r\n   236,228,250,133,104,205,184,186,54,207,65,66,...>>}\r\n\r\n> timer:tc(fun() ->  crypto:pbkdf2_hmac(sha, <<\"password\">>, <<\"salt\">>, 10000, 20) end).\r\n{4951,\r\n <<162,194,100,97,134,130,132,116,183,84,89,26,84,124,24,\r\n   241,50,216,141,116>>}\r\n```\r\n\r\n> the password cache could be optional, I could add a toggle so admins that want to can disable it. given that the work effort for a cached item is quite small (though not as small as the single-pass sha1) I didn't think it was necessary, but it's also easy to add.\r\n\r\nThe main concern there is that concurrent requests will check the single ets table, which also ends up being updated constantly with the atime `accessed` operations.  It seems if users have generated random 128 bit salts and password for  API keys, they should be able to use a sha256 or sha512 with a low iteration number to avoid an extra hash and ets table check.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1773480674/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1773768295","html_url":"https://github.com/apache/couchdb/pull/4810#issuecomment-1773768295","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4810","id":1773768295,"node_id":"IC_kwDOAAMmUc5puY5n","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-21T11:55:59Z","updated_at":"2023-10-21T11:55:59Z","author_association":"CONTRIBUTOR","body":"I miss the parts related to the documentation.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1773768295/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1773770413","html_url":"https://github.com/apache/couchdb/pull/4810#issuecomment-1773770413","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4810","id":1773770413,"node_id":"IC_kwDOAAMmUc5puZat","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-21T12:05:39Z","updated_at":"2023-10-21T12:05:39Z","author_association":"CONTRIBUTOR","body":"Please add `text` tests for the integration test suite.  I am fine if they do not fully work (like a draft) I can test them and provide feedback.  For your information, I am currently working on introducing support for testing with Clouseau in the PRs -- you can also wait for that.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1773770413/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1775287246","html_url":"https://github.com/apache/couchdb/issues/4818#issuecomment-1775287246","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4818","id":1775287246,"node_id":"IC_kwDOAAMmUc5p0LvO","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-23T14:07:25Z","updated_at":"2023-10-23T14:07:25Z","author_association":"CONTRIBUTOR","body":"Duplicate of #4724.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1775287246/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1775419779","html_url":"https://github.com/apache/couchdb/issues/4819#issuecomment-1775419779","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4819","id":1775419779,"node_id":"IC_kwDOAAMmUc5p0sGD","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-23T15:07:50Z","updated_at":"2023-10-23T15:07:50Z","author_association":"CONTRIBUTOR","body":"Hi, can you append your log file?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1775419779/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1775466495","html_url":"https://github.com/apache/couchdb/issues/4790#issuecomment-1775466495","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4790","id":1775466495,"node_id":"IC_kwDOAAMmUc5p03f_","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-23T15:30:35Z","updated_at":"2023-10-23T15:30:35Z","author_association":"CONTRIBUTOR","body":"@alessio-congedo \r\n\r\n> How can you explain the fact that it's always the same node that crashes?\r\n\r\nNot sure I can explain that from the logs. It seems like other nodes also have connectivity issues and timeouts. I see some disconnects between 440 <-> 410:\r\n\r\n```\r\ncouchdb@host410.XXXXXXXX.local <0.32575.6885> -------- \r\n fabric_worker_timeout open_revs,'couchdb@host440.XXXXXXXX.local',\r\n <<\"shards/80000000-ffffffff/xxxxxxxxxxx_xxxxxxxxxxx-store.1624883181\">>\r\n```\r\n\r\nSee if perhaps you'd also add an ioq bypass for `shard_sync = false` and increase fabric request timeouts: https://github.com/apache/couchdb/blob/main/rel/overlay/etc/default.ini#L374-L376\r\n\r\nIf you're running in a kube environment check that each of the containers have the same and enough CPU and disk IO resources/bandwidth available.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1775466495/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1776133932","html_url":"https://github.com/apache/couchdb/issues/3887#issuecomment-1776133932","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3887","id":1776133932,"node_id":"IC_kwDOAAMmUc5p3acs","user":{"login":"ajithcnambiar","id":7530033,"node_id":"MDQ6VXNlcjc1MzAwMzM=","avatar_url":"https://avatars.githubusercontent.com/u/7530033?v=4","gravatar_id":"","url":"https://api.github.com/users/ajithcnambiar","html_url":"https://github.com/ajithcnambiar","followers_url":"https://api.github.com/users/ajithcnambiar/followers","following_url":"https://api.github.com/users/ajithcnambiar/following{/other_user}","gists_url":"https://api.github.com/users/ajithcnambiar/gists{/gist_id}","starred_url":"https://api.github.com/users/ajithcnambiar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajithcnambiar/subscriptions","organizations_url":"https://api.github.com/users/ajithcnambiar/orgs","repos_url":"https://api.github.com/users/ajithcnambiar/repos","events_url":"https://api.github.com/users/ajithcnambiar/events{/privacy}","received_events_url":"https://api.github.com/users/ajithcnambiar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-23T22:40:01Z","updated_at":"2023-10-23T22:40:01Z","author_association":"NONE","body":"I also faced the same issue while migrating to the IPv6 cluster. \r\nWhen can we expect a release with this fix? \r\nThanks, everyone🙏 \r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1776133932/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1777115697","html_url":"https://github.com/apache/couchdb/pull/4810#issuecomment-1777115697","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4810","id":1777115697,"node_id":"IC_kwDOAAMmUc5p7KIx","user":{"login":"willholley","id":97787,"node_id":"MDQ6VXNlcjk3Nzg3","avatar_url":"https://avatars.githubusercontent.com/u/97787?v=4","gravatar_id":"","url":"https://api.github.com/users/willholley","html_url":"https://github.com/willholley","followers_url":"https://api.github.com/users/willholley/followers","following_url":"https://api.github.com/users/willholley/following{/other_user}","gists_url":"https://api.github.com/users/willholley/gists{/gist_id}","starred_url":"https://api.github.com/users/willholley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/willholley/subscriptions","organizations_url":"https://api.github.com/users/willholley/orgs","repos_url":"https://api.github.com/users/willholley/repos","events_url":"https://api.github.com/users/willholley/events{/privacy}","received_events_url":"https://api.github.com/users/willholley/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-24T12:32:10Z","updated_at":"2023-10-24T12:32:10Z","author_association":"MEMBER","body":"> Please add `text` tests for the integration test suite. I am fine if they do not fully work (like a draft) I can test them and provide feedback. For your information, I am currently working on introducing support for testing with Clouseau in the PRs -- you can also wait for that.\r\n\r\nIt would certainly be helpful to have Clouseau in the CI and, presumably, then in the dev container which uses the same CI images.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1777115697/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1777336779","html_url":"https://github.com/apache/couchdb/pull/4810#issuecomment-1777336779","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4810","id":1777336779,"node_id":"IC_kwDOAAMmUc5p8AHL","user":{"login":"willholley","id":97787,"node_id":"MDQ6VXNlcjk3Nzg3","avatar_url":"https://avatars.githubusercontent.com/u/97787?v=4","gravatar_id":"","url":"https://api.github.com/users/willholley","html_url":"https://github.com/willholley","followers_url":"https://api.github.com/users/willholley/followers","following_url":"https://api.github.com/users/willholley/following{/other_user}","gists_url":"https://api.github.com/users/willholley/gists{/gist_id}","starred_url":"https://api.github.com/users/willholley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/willholley/subscriptions","organizations_url":"https://api.github.com/users/willholley/orgs","repos_url":"https://api.github.com/users/willholley/repos","events_url":"https://api.github.com/users/willholley/events{/privacy}","received_events_url":"https://api.github.com/users/willholley/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-24T14:27:50Z","updated_at":"2023-10-24T14:27:50Z","author_association":"MEMBER","body":"> Please add `text` tests for the integration test suite. I am fine if they do not fully work (like a draft) I can test them and provide feedback. For your information, I am currently working on introducing support for testing with Clouseau in the PRs -- you can also wait for that.\r\n\r\nThe `03-operator-test.py` updates include integration tests for text indexes that check the result is as expected. I didn't add integration tests that check the args passed to Lucene, but these are covered by eunit tests (it's much simpler than the mrargs parameters which involve a range scan).","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1777336779/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1777990429","html_url":"https://github.com/apache/couchdb/pull/4406#issuecomment-1777990429","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4406","id":1777990429,"node_id":"IC_kwDOAAMmUc5p-fsd","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-24T20:31:42Z","updated_at":"2024-09-23T20:53:13Z","author_association":"CONTRIBUTOR","body":"Moved into #4398 ...","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1777990429/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1779085227","html_url":"https://github.com/apache/couchdb/issues/4819#issuecomment-1779085227","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4819","id":1779085227,"node_id":"IC_kwDOAAMmUc5qCq-r","user":{"login":"rummitta","id":142016616,"node_id":"U_kgDOCHcAaA","avatar_url":"https://avatars.githubusercontent.com/u/142016616?v=4","gravatar_id":"","url":"https://api.github.com/users/rummitta","html_url":"https://github.com/rummitta","followers_url":"https://api.github.com/users/rummitta/followers","following_url":"https://api.github.com/users/rummitta/following{/other_user}","gists_url":"https://api.github.com/users/rummitta/gists{/gist_id}","starred_url":"https://api.github.com/users/rummitta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rummitta/subscriptions","organizations_url":"https://api.github.com/users/rummitta/orgs","repos_url":"https://api.github.com/users/rummitta/repos","events_url":"https://api.github.com/users/rummitta/events{/privacy}","received_events_url":"https://api.github.com/users/rummitta/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-25T11:44:17Z","updated_at":"2023-10-25T11:44:17Z","author_association":"NONE","body":"hi,\r\nwe are not getting the error now. The earlier couch db pod log seems to have rolled over. We will monitor this issue and get back in case it occurs again.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1779085227/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1779595383","html_url":"https://github.com/apache/couchdb/pull/4810#issuecomment-1779595383","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4810","id":1779595383,"node_id":"IC_kwDOAAMmUc5qEnh3","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-25T15:59:46Z","updated_at":"2023-10-25T15:59:46Z","author_association":"CONTRIBUTOR","body":"Okay.  Right now there is a failing test case (for the `text` indexes):\r\n\r\n```console\r\n======================================================================\r\nFAIL: test_beginswith (03-operator-test.OperatorTextTests.test_beginswith)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/Users/gaborpali/projects/github/couchdb/src/mango/test/03-operator-test.py\", line 146, in test_beginswith\r\n    self.assertEqual(len(docs), 2)\r\nAssertionError: 0 != 2\r\n\r\n----------------------------------------------------------------------\r\nRan 384 tests in 37.973s\r\n\r\nFAILED (failures=1, skipped=1)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1779595383/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1780088174","html_url":"https://github.com/apache/couchdb/pull/4822#issuecomment-1780088174","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4822","id":1780088174,"node_id":"IC_kwDOAAMmUc5qGf1u","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-25T21:34:16Z","updated_at":"2023-10-25T21:34:16Z","author_association":"CONTRIBUTOR","body":"For reference: https://github.com/mochi/mochiweb/releases/tag/v3.2.1","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1780088174/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1781298717","html_url":"https://github.com/apache/couchdb/pull/4814#issuecomment-1781298717","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4814","id":1781298717,"node_id":"IC_kwDOAAMmUc5qLHYd","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-26T14:57:06Z","updated_at":"2023-10-26T14:57:06Z","author_association":"MEMBER","body":"@nickva I've made the cache a configurable option. for deployments that are confident they avoid basic auth they can disable it without negative consequences.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1781298717/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1781301946","html_url":"https://github.com/apache/couchdb/pull/4814#issuecomment-1781301946","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4814","id":1781301946,"node_id":"IC_kwDOAAMmUc5qLIK6","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-26T14:58:53Z","updated_at":"2023-10-26T14:58:53Z","author_association":"MEMBER","body":"noting I just rebased after making an important internal change. the salt value for the internal cache is now the same as the one from the users doc. This ensures that the entry is not used if a user changes their password (as their salt value is re-randomised). We were already preserving the salt value on upgrade to account to avoid conflicts being introduced. If a customer updates their password themselves (by editing their user doc) a new salt is generated.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1781301946/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1781372183","html_url":"https://github.com/apache/couchdb/pull/4814#issuecomment-1781372183","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4814","id":1781372183,"node_id":"IC_kwDOAAMmUc5qLZUX","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-26T15:37:53Z","updated_at":"2023-10-26T15:37:53Z","author_association":"CONTRIBUTOR","body":"> I've made the cache a configurable option. for deployments that are confident they avoid basic auth they can disable it without negative consequences\r\n\r\nMakes sense.\r\n\r\nAlso, good idea to go with https://github.com/esl/fast_pbkdf2/ for now. I made a PR for Erlang/OTP to fix the blocking issue https://github.com/erlang/otp/pull/7770 so far it seems to be in review and not sure what's blocking it. Hoping that would make it to maint and the next 24/25/26 patch releases.\r\n\r\nOne, perhaps minor or temporary, issue with fast_pbkdf2 is that it's not FIPS-140 validated. In other words, even if the hashing code may be copy-pasted from OpenSSL library, it might not be accepted as \"compliant\". Not that we necessarily strive to be compliant with FIPS 140, but we do have the extra feature and mode for it, so we would then prevent users from using that feature if we go with a native hashing primitives.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1781372183/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1781399634","html_url":"https://github.com/apache/couchdb/pull/4810#issuecomment-1781399634","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4810","id":1781399634,"node_id":"IC_kwDOAAMmUc5qLgBS","user":{"login":"willholley","id":97787,"node_id":"MDQ6VXNlcjk3Nzg3","avatar_url":"https://avatars.githubusercontent.com/u/97787?v=4","gravatar_id":"","url":"https://api.github.com/users/willholley","html_url":"https://github.com/willholley","followers_url":"https://api.github.com/users/willholley/followers","following_url":"https://api.github.com/users/willholley/following{/other_user}","gists_url":"https://api.github.com/users/willholley/gists{/gist_id}","starred_url":"https://api.github.com/users/willholley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/willholley/subscriptions","organizations_url":"https://api.github.com/users/willholley/orgs","repos_url":"https://api.github.com/users/willholley/repos","events_url":"https://api.github.com/users/willholley/events{/privacy}","received_events_url":"https://api.github.com/users/willholley/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-26T15:53:30Z","updated_at":"2023-10-26T15:53:30Z","author_association":"MEMBER","body":"@pgj I think I've addressed all the comments, though will need to squash the commits","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1781399634/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1781799017","html_url":"https://github.com/apache/couchdb/pull/4814#issuecomment-1781799017","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4814","id":1781799017,"node_id":"IC_kwDOAAMmUc5qNBhp","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-26T19:48:14Z","updated_at":"2023-10-26T19:48:14Z","author_association":"MEMBER","body":"hm, on FIPS-140 the fundamental algorithms (the SHA family) are invoked from openssl, which in such an environment is where the FIPS-140 \"compliance\" comes from. It will prevent the use of MD5 etc. not sure it's necessary to use PBKDF2 at that level, but it's a good point and needs confirmation either way.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1781799017/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]