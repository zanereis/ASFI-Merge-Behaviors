[{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411108103","html_url":"https://github.com/apache/couchdb/issues/1475#issuecomment-411108103","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1475","id":411108103,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTEwODEwMw==","user":{"login":"empeje","id":11813607,"node_id":"MDQ6VXNlcjExODEzNjA3","avatar_url":"https://avatars.githubusercontent.com/u/11813607?v=4","gravatar_id":"","url":"https://api.github.com/users/empeje","html_url":"https://github.com/empeje","followers_url":"https://api.github.com/users/empeje/followers","following_url":"https://api.github.com/users/empeje/following{/other_user}","gists_url":"https://api.github.com/users/empeje/gists{/gist_id}","starred_url":"https://api.github.com/users/empeje/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/empeje/subscriptions","organizations_url":"https://api.github.com/users/empeje/orgs","repos_url":"https://api.github.com/users/empeje/repos","events_url":"https://api.github.com/users/empeje/events{/privacy}","received_events_url":"https://api.github.com/users/empeje/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-07T15:57:29Z","updated_at":"2018-08-07T15:57:29Z","author_association":"NONE","body":"Thanks @wohali ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411108103/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411109512","html_url":"https://github.com/apache/couchdb/issues/1515#issuecomment-411109512","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1515","id":411109512,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTEwOTUxMg==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-07T16:01:38Z","updated_at":"2018-08-07T16:01:38Z","author_association":"MEMBER","body":"@davisp mentions:\r\n>Improved Erlang Release Building\r\n>It'd be nice to have something in the build system that allowed for custom combinations of Erlang applications to be used in the release (Erlang definition, not ASF). This would be useful for our \"popular configurations\" that @janl mentioned (ie, Dreyfus/Clouseau and GeoCouch being examples).","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411109512/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411111501","html_url":"https://github.com/apache/couchdb/issues/1498#issuecomment-411111501","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1498","id":411111501,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTExMTUwMQ==","user":{"login":"willholley","id":97787,"node_id":"MDQ6VXNlcjk3Nzg3","avatar_url":"https://avatars.githubusercontent.com/u/97787?v=4","gravatar_id":"","url":"https://api.github.com/users/willholley","html_url":"https://github.com/willholley","followers_url":"https://api.github.com/users/willholley/followers","following_url":"https://api.github.com/users/willholley/following{/other_user}","gists_url":"https://api.github.com/users/willholley/gists{/gist_id}","starred_url":"https://api.github.com/users/willholley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/willholley/subscriptions","organizations_url":"https://api.github.com/users/willholley/orgs","repos_url":"https://api.github.com/users/willholley/repos","events_url":"https://api.github.com/users/willholley/events{/privacy}","received_events_url":"https://api.github.com/users/willholley/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-07T16:07:18Z","updated_at":"2018-08-07T16:07:18Z","author_association":"MEMBER","body":"@wohali JSON Patch / [RFC 6902](https://tools.ietf.org/html/rfc6902) specifies an array of operations to apply to a document. Each operation consists of an operation type (`add`, `remove`, `replace`, `delete`, `move`, `copy`, `test`), a path (expressed as a JSON pointer) and operation-specific parameters. The operations are applied in sequence to the specified document, e.g.:\r\n\r\n```\r\n[\r\n  { \"op\": \"replace\", \"path\": \"/baz\", \"value\": \"boo\" },\r\n  { \"op\": \"add\", \"path\": \"/hello\", \"value\": [\"world\"] },\r\n  { \"op\": \"remove\", \"path\": \"/foo\" }\r\n]\r\n```\r\n\r\nIt seems like an extension of Paul's proposal, with the benefit that there is existing tooling/support as it's an established format.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411111501/reactions","total_count":3,"+1":3,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411113729","html_url":"https://github.com/apache/couchdb/issues/1532#issuecomment-411113729","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1532","id":411113729,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTExMzcyOQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-07T16:13:59Z","updated_at":"2018-08-07T16:13:59Z","author_association":"MEMBER","body":"Noting that if we implement #1280 or #1498, the syntax for this could become very simple.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411113729/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411175383","html_url":"https://github.com/apache/couchdb/pull/1443#issuecomment-411175383","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1443","id":411175383,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTE3NTM4Mw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-07T19:34:15Z","updated_at":"2018-08-07T19:34:15Z","author_association":"MEMBER","body":"@janl not sure why tests are failing here, care to take a look?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411175383/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411256369","html_url":"https://github.com/apache/couchdb/issues/1494#issuecomment-411256369","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1494","id":411256369,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTI1NjM2OQ==","user":{"login":"monica18p","id":6171473,"node_id":"MDQ6VXNlcjYxNzE0NzM=","avatar_url":"https://avatars.githubusercontent.com/u/6171473?v=4","gravatar_id":"","url":"https://api.github.com/users/monica18p","html_url":"https://github.com/monica18p","followers_url":"https://api.github.com/users/monica18p/followers","following_url":"https://api.github.com/users/monica18p/following{/other_user}","gists_url":"https://api.github.com/users/monica18p/gists{/gist_id}","starred_url":"https://api.github.com/users/monica18p/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/monica18p/subscriptions","organizations_url":"https://api.github.com/users/monica18p/orgs","repos_url":"https://api.github.com/users/monica18p/repos","events_url":"https://api.github.com/users/monica18p/events{/privacy}","received_events_url":"https://api.github.com/users/monica18p/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-08T01:43:25Z","updated_at":"2018-08-08T01:43:25Z","author_association":"NONE","body":"Thanks @nickva for the clarification. It really helped 👍 ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411256369/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411276223","html_url":"https://github.com/apache/couchdb/issues/1226#issuecomment-411276223","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1226","id":411276223,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTI3NjIyMw==","user":{"login":"boerwastaken","id":15187983,"node_id":"MDQ6VXNlcjE1MTg3OTgz","avatar_url":"https://avatars.githubusercontent.com/u/15187983?v=4","gravatar_id":"","url":"https://api.github.com/users/boerwastaken","html_url":"https://github.com/boerwastaken","followers_url":"https://api.github.com/users/boerwastaken/followers","following_url":"https://api.github.com/users/boerwastaken/following{/other_user}","gists_url":"https://api.github.com/users/boerwastaken/gists{/gist_id}","starred_url":"https://api.github.com/users/boerwastaken/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/boerwastaken/subscriptions","organizations_url":"https://api.github.com/users/boerwastaken/orgs","repos_url":"https://api.github.com/users/boerwastaken/repos","events_url":"https://api.github.com/users/boerwastaken/events{/privacy}","received_events_url":"https://api.github.com/users/boerwastaken/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-08T03:53:54Z","updated_at":"2018-08-08T03:53:54Z","author_association":"NONE","body":"It looks to me like [the documentation for couchdb 2.1.2 (and probably other version's) views is joyfully out of sync with respect to presence of the etag response header](http://docs.couchdb.org/en/2.1.2/api/ddoc/views.html?highlight=etag).\r\n\r\nI think it might have been nice if the etag mentions had been removed from the documentation as the same time the generation of those etags were being taken out of the code. \r\nIt took me a while to find this issue when I was pulling my hairs out over not seeing the etags I was yearning for.\r\n\r\nI also did a cursory search for changelogs mentioning that the etags had been dropped. Was it ever mentioned? For me those mean the difference between an app being usable and unusable (I'm in a developing country with sub-sub-subpar networks).","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411276223/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411277255","html_url":"https://github.com/apache/couchdb/pull/1423#issuecomment-411277255","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1423","id":411277255,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTI3NzI1NQ==","user":{"login":"tonysun83","id":6991573,"node_id":"MDQ6VXNlcjY5OTE1NzM=","avatar_url":"https://avatars.githubusercontent.com/u/6991573?v=4","gravatar_id":"","url":"https://api.github.com/users/tonysun83","html_url":"https://github.com/tonysun83","followers_url":"https://api.github.com/users/tonysun83/followers","following_url":"https://api.github.com/users/tonysun83/following{/other_user}","gists_url":"https://api.github.com/users/tonysun83/gists{/gist_id}","starred_url":"https://api.github.com/users/tonysun83/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tonysun83/subscriptions","organizations_url":"https://api.github.com/users/tonysun83/orgs","repos_url":"https://api.github.com/users/tonysun83/repos","events_url":"https://api.github.com/users/tonysun83/events{/privacy}","received_events_url":"https://api.github.com/users/tonysun83/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-08T04:01:01Z","updated_at":"2018-08-08T04:01:01Z","author_association":"CONTRIBUTOR","body":"+1, great work @garrensmith ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411277255/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411277813","html_url":"https://github.com/apache/couchdb/issues/1226#issuecomment-411277813","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1226","id":411277813,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTI3NzgxMw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-08T04:05:09Z","updated_at":"2018-08-08T04:05:09Z","author_association":"MEMBER","body":"@boerwastaken I'm sorry for your frustration. We are a volunteer project with limited resources, some things fall through the cracks.\r\n\r\nThis is a feature that was dropped with 2.0.0, see https://issues.apache.org/jira/browse/COUCHDB-2859 for the old bug tracker where this was first mentioned. There's even a bug filed against 1.6.1 where view etags don't work right, see https://issues.apache.org/jira/browse/COUCHDB-2880 for the report.\r\n\r\nPull requests to improve the documentation at https://github.com/apache/couchdb-documentation are always welcome. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411277813/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411312308","html_url":"https://github.com/apache/couchdb/issues/1534#issuecomment-411312308","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1534","id":411312308,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTMxMjMwOA==","user":{"login":"johs","id":48370,"node_id":"MDQ6VXNlcjQ4Mzcw","avatar_url":"https://avatars.githubusercontent.com/u/48370?v=4","gravatar_id":"","url":"https://api.github.com/users/johs","html_url":"https://github.com/johs","followers_url":"https://api.github.com/users/johs/followers","following_url":"https://api.github.com/users/johs/following{/other_user}","gists_url":"https://api.github.com/users/johs/gists{/gist_id}","starred_url":"https://api.github.com/users/johs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/johs/subscriptions","organizations_url":"https://api.github.com/users/johs/orgs","repos_url":"https://api.github.com/users/johs/repos","events_url":"https://api.github.com/users/johs/events{/privacy}","received_events_url":"https://api.github.com/users/johs/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-08T07:24:04Z","updated_at":"2018-08-08T09:12:50Z","author_association":"NONE","body":"Items on this wish list adds up to removing the ability to use CouchDB for \"vanilla Couch\"  as @nolanlawson called it in this blog post from 2013 and discussion from 2014: \"to use I’m even more pro-Couch than when I wrote this article. It may be true that ultimately your webapp will grow in complexity to the point where you’re forced to put a proxy server in front of CouchDB to smooth out its rougher edges, but I think you’ll still be amazed how far you can get with vanilla Couch.\"\r\n\r\nDesign documents and couch_httpd_proxy used to the onboarding feature, the reason why is very well described in Nolan's blog post.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411312308/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411336763","html_url":"https://github.com/apache/couchdb/issues/1534#issuecomment-411336763","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1534","id":411336763,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTMzNjc2Mw==","user":{"login":"AlexanderKaraberov","id":3254818,"node_id":"MDQ6VXNlcjMyNTQ4MTg=","avatar_url":"https://avatars.githubusercontent.com/u/3254818?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexanderKaraberov","html_url":"https://github.com/AlexanderKaraberov","followers_url":"https://api.github.com/users/AlexanderKaraberov/followers","following_url":"https://api.github.com/users/AlexanderKaraberov/following{/other_user}","gists_url":"https://api.github.com/users/AlexanderKaraberov/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexanderKaraberov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexanderKaraberov/subscriptions","organizations_url":"https://api.github.com/users/AlexanderKaraberov/orgs","repos_url":"https://api.github.com/users/AlexanderKaraberov/repos","events_url":"https://api.github.com/users/AlexanderKaraberov/events{/privacy}","received_events_url":"https://api.github.com/users/AlexanderKaraberov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-08T08:58:02Z","updated_at":"2018-08-08T09:01:59Z","author_association":"CONTRIBUTOR","body":"Hi @wohali \r\nI wonder what are the proposed alternatives to:\r\n\r\n> VDUs?\r\n   Update functions?\r\n\r\nEmbedded directly into the couch core Erlang functions? I'm asking because in our production environment we are using a heavily customised to our use case Erlang `validate_doc_update` functions and even implemented a custom logic in our fork of CouchDB to support `validate_doc_read` functions. So I'm interested where is `VDU` stuff heading to?\r\n\r\nAlso, \r\n\r\n> View changes (never worked right)\r\n\r\nI saw in the related dev-mailing list discussion that the plan was to remove them in order to implement mrview's `seq` and `keyseq` indexes in a proper way, and include this functionality back into the project afterwards. Is this true?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411336763/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411362831","html_url":"https://github.com/apache/couchdb/issues/1544#issuecomment-411362831","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1544","id":411362831,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTM2MjgzMQ==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-08T10:37:28Z","updated_at":"2018-08-08T10:37:28Z","author_association":"MEMBER","body":"> 2.2 rc2 worked as I remember\r\n\r\n@wactbprot could you verify that’s the case?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411362831/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411368168","html_url":"https://github.com/apache/couchdb/issues/1545#issuecomment-411368168","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1545","id":411368168,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTM2ODE2OA==","user":{"login":"estellederrien","id":17199283,"node_id":"MDQ6VXNlcjE3MTk5Mjgz","avatar_url":"https://avatars.githubusercontent.com/u/17199283?v=4","gravatar_id":"","url":"https://api.github.com/users/estellederrien","html_url":"https://github.com/estellederrien","followers_url":"https://api.github.com/users/estellederrien/followers","following_url":"https://api.github.com/users/estellederrien/following{/other_user}","gists_url":"https://api.github.com/users/estellederrien/gists{/gist_id}","starred_url":"https://api.github.com/users/estellederrien/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/estellederrien/subscriptions","organizations_url":"https://api.github.com/users/estellederrien/orgs","repos_url":"https://api.github.com/users/estellederrien/repos","events_url":"https://api.github.com/users/estellederrien/events{/privacy}","received_events_url":"https://api.github.com/users/estellederrien/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-08T11:00:48Z","updated_at":"2018-08-08T11:06:24Z","author_association":"NONE","body":"I cant create the couchdb user, please help, geco group doesnt exist, why did you add --geco ?\r\n\r\nI ve tried to create the gecos group, it still not working, why ?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411368168/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411372882","html_url":"https://github.com/apache/couchdb/issues/1352#issuecomment-411372882","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1352","id":411372882,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTM3Mjg4Mg==","user":{"login":"mmoya","id":36318,"node_id":"MDQ6VXNlcjM2MzE4","avatar_url":"https://avatars.githubusercontent.com/u/36318?v=4","gravatar_id":"","url":"https://api.github.com/users/mmoya","html_url":"https://github.com/mmoya","followers_url":"https://api.github.com/users/mmoya/followers","following_url":"https://api.github.com/users/mmoya/following{/other_user}","gists_url":"https://api.github.com/users/mmoya/gists{/gist_id}","starred_url":"https://api.github.com/users/mmoya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mmoya/subscriptions","organizations_url":"https://api.github.com/users/mmoya/orgs","repos_url":"https://api.github.com/users/mmoya/repos","events_url":"https://api.github.com/users/mmoya/events{/privacy}","received_events_url":"https://api.github.com/users/mmoya/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-08T11:22:52Z","updated_at":"2018-08-08T11:23:07Z","author_association":"NONE","body":"@janl, it'd be nice to have those PRs referencing this issue (or viceversa).","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411372882/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411376875","html_url":"https://github.com/apache/couchdb/issues/1544#issuecomment-411376875","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1544","id":411376875,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTM3Njg3NQ==","user":{"login":"wactbprot","id":113518,"node_id":"MDQ6VXNlcjExMzUxOA==","avatar_url":"https://avatars.githubusercontent.com/u/113518?v=4","gravatar_id":"","url":"https://api.github.com/users/wactbprot","html_url":"https://github.com/wactbprot","followers_url":"https://api.github.com/users/wactbprot/followers","following_url":"https://api.github.com/users/wactbprot/following{/other_user}","gists_url":"https://api.github.com/users/wactbprot/gists{/gist_id}","starred_url":"https://api.github.com/users/wactbprot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wactbprot/subscriptions","organizations_url":"https://api.github.com/users/wactbprot/orgs","repos_url":"https://api.github.com/users/wactbprot/repos","events_url":"https://api.github.com/users/wactbprot/events{/privacy}","received_events_url":"https://api.github.com/users/wactbprot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-08T11:41:07Z","updated_at":"2018-08-08T11:41:07Z","author_association":"NONE","body":"We rebuild rc1, rc2 and rc3: I remembered wrong, all the same. The problem is introduced with 2.2.0-rc1.\r\nDuring the tests we noticed that maybe the request header plays a role: the GETs with good old w3m work. I'll do some research on this...","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411376875/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411377070","html_url":"https://github.com/apache/couchdb/issues/1352#issuecomment-411377070","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1352","id":411377070,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTM3NzA3MA==","user":{"login":"jiangphcn","id":18000622,"node_id":"MDQ6VXNlcjE4MDAwNjIy","avatar_url":"https://avatars.githubusercontent.com/u/18000622?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangphcn","html_url":"https://github.com/jiangphcn","followers_url":"https://api.github.com/users/jiangphcn/followers","following_url":"https://api.github.com/users/jiangphcn/following{/other_user}","gists_url":"https://api.github.com/users/jiangphcn/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangphcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangphcn/subscriptions","organizations_url":"https://api.github.com/users/jiangphcn/orgs","repos_url":"https://api.github.com/users/jiangphcn/repos","events_url":"https://api.github.com/users/jiangphcn/events{/privacy}","received_events_url":"https://api.github.com/users/jiangphcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-08T11:42:01Z","updated_at":"2018-08-08T11:42:01Z","author_association":"CONTRIBUTOR","body":"Added reference to https://github.com/apache/couchdb/pull/1370","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411377070/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411377769","html_url":"https://github.com/apache/couchdb/issues/1544#issuecomment-411377769","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1544","id":411377769,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTM3Nzc2OQ==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-08T11:45:19Z","updated_at":"2018-08-08T11:45:19Z","author_association":"MEMBER","body":"@wactbprot thanks!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411377769/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411382650","html_url":"https://github.com/apache/couchdb/issues/1534#issuecomment-411382650","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1534","id":411382650,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTM4MjY1MA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-08T12:07:32Z","updated_at":"2018-08-08T22:58:42Z","author_association":"MEMBER","body":"Don't ask me, I'm just the transcriber of the content. The proposals came from @chewbranca and @davisp. But yes, @AlexanderKaraberov I believe that's the plan for view changes, IF (and that's a big IF) it can be made to work correctly.\r\n\r\nI can't speak for anyone other than myself, but I'd be surprised if VDUs and update functions would be removed unless something useful can replace them, like declarative Mango-style replacements. Further see #1532, #1533 which could serve as the basis for a replacement as well.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411382650/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411383470","html_url":"https://github.com/apache/couchdb/issues/1545#issuecomment-411383470","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1545","id":411383470,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTM4MzQ3MA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-08T12:11:19Z","updated_at":"2018-08-08T12:11:19Z","author_association":"MEMBER","body":"@nicolas15000 Looks like your adduser command has a different syntax.\r\n\r\nFor GNU adduser, `--system --group` will create a group with the same name and ID as the system user.\r\n\r\nWhich OS are you on?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411383470/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411384708","html_url":"https://github.com/apache/couchdb/issues/1547#issuecomment-411384708","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1547","id":411384708,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTM4NDcwOA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-08T12:16:31Z","updated_at":"2018-08-08T12:16:31Z","author_association":"MEMBER","body":"@nicolas15000 the \"snap\" installer is currently out of date and unsupported.\r\n\r\nYou should try the .deb package, it's super easy to install. Please follow these instructions:\r\n\r\nhttp://docs.couchdb.org/en/2.2.0/install/unix.html#installation-using-the-apache-couchdb-convenience-binary-packages","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411384708/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411385638","html_url":"https://github.com/apache/couchdb/issues/1545#issuecomment-411385638","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1545","id":411385638,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTM4NTYzOA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-08T12:20:18Z","updated_at":"2018-08-08T12:20:18Z","author_association":"MEMBER","body":"On Ubuntu bionic (18.04):\r\n\r\n```\r\nroot@67bec2d34961:/# adduser --system --group foo\r\nAdding system user `foo' (UID 102) ...\r\nAdding new group `foo' (GID 103) ...\r\nAdding new user `foo' (UID 102) with group `foo' ...\r\nCreating home directory `/home/foo' ...\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411385638/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411386686","html_url":"https://github.com/apache/couchdb/issues/1497#issuecomment-411386686","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1497","id":411386686,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTM4NjY4Ng==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-08T12:24:32Z","updated_at":"2018-08-08T12:24:32Z","author_association":"MEMBER","body":"since all this went down, we kinda sorta decided we don’t want to go down the cowboy route. Alternatives are TBD.\r\n\r\nSince haproxy has H2 support now, and since it is useful to run it even in front of a single instance CouchDB, we have some time to get to this.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411386686/reactions","total_count":2,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":2,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411387209","html_url":"https://github.com/apache/couchdb/issues/1498#issuecomment-411387209","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1498","id":411387209,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTM4NzIwOQ==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-08T12:26:39Z","updated_at":"2018-08-08T12:26:39Z","author_association":"MEMBER","body":"@willholley I’m glad to see JSON Patch here, it looks like a format one would have badly NIH’d on the fly if it didn’t already exist. This sounds like a way forward.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411387209/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411387508","html_url":"https://github.com/apache/couchdb/issues/1547#issuecomment-411387508","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1547","id":411387508,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTM4NzUwOA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-08T12:27:54Z","updated_at":"2018-08-08T12:27:54Z","author_association":"MEMBER","body":"The outdated 2.0.0 unsupported CouchDB snap package has been unpublished. Thanks for the nudge.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411387508/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411390446","html_url":"https://github.com/apache/couchdb/issues/1514#issuecomment-411390446","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1514","id":411390446,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTM5MDQ0Ng==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-08T12:38:49Z","updated_at":"2018-08-08T12:39:03Z","author_association":"MEMBER","body":"> With the discussion to move ChakraCore into the system, do we really want to bother with continuing to support a query server protocol at all? I'm not so sure.\r\n\r\nThe hook up is still via the same protocol, just not streaming over stdio","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411390446/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411391231","html_url":"https://github.com/apache/couchdb/issues/1520#issuecomment-411391231","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1520","id":411391231,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTM5MTIzMQ==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-08T12:41:35Z","updated_at":"2018-08-08T12:41:35Z","author_association":"MEMBER","body":"cc @chewbranca ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411391231/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411391517","html_url":"https://github.com/apache/couchdb/issues/1544#issuecomment-411391517","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1544","id":411391517,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTM5MTUxNw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-08T12:42:31Z","updated_at":"2018-08-08T12:42:31Z","author_association":"MEMBER","body":"@wactbprot Are you using `eval` in your function? This was disabled by default in 2.1.1:\r\n\r\nhttps://github.com/apache/couchdb/pull/916\r\n\r\nFrom the release notes:\r\n\r\n> #916: couchjs now disables eval() and the Function() constructor by default. To restore the original behaviour, add the `--eval` flag to the definition of the javascript query server in your `local.ini` file.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411391517/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411391580","html_url":"https://github.com/apache/couchdb/issues/1544#issuecomment-411391580","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1544","id":411391580,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTM5MTU4MA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-08T12:42:43Z","updated_at":"2018-08-08T12:42:43Z","author_association":"MEMBER","body":"FYI I just tested a very basic `list` function and it worked fine here.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411391580/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411391977","html_url":"https://github.com/apache/couchdb/issues/1548#issuecomment-411391977","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1548","id":411391977,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTM5MTk3Nw==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-08T12:44:11Z","updated_at":"2018-08-08T12:44:11Z","author_association":"MEMBER","body":"@nicolas15000 can you paste the exact steps you’ve followed from download to `./configure`?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411391977/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411392404","html_url":"https://github.com/apache/couchdb/issues/1546#issuecomment-411392404","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1546","id":411392404,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTM5MjQwNA==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-08T12:45:44Z","updated_at":"2018-08-08T12:45:44Z","author_association":"MEMBER","body":"The packages take care of setting up CouchDB properly and not in `/home`, but in `/opt/couchdb`. The instructions you’re seeing are for a manual set up without the epel packages.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411392404/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411392923","html_url":"https://github.com/apache/couchdb/issues/1524#issuecomment-411392923","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1524","id":411392923,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTM5MjkyMw==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-08T12:47:40Z","updated_at":"2018-08-08T12:47:40Z","author_association":"MEMBER","body":"I think this is captured in the _access proposal best: https://lists.apache.org/thread.html/6aa77dd8e5974a3a540758c6902ccb509ab5a2e4802ecf4fd724a5e4@%3Cdev.couchdb.apache.org%3E","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411392923/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411392942","html_url":"https://github.com/apache/couchdb/issues/1548#issuecomment-411392942","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1548","id":411392942,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTM5Mjk0Mg==","user":{"login":"estellederrien","id":17199283,"node_id":"MDQ6VXNlcjE3MTk5Mjgz","avatar_url":"https://avatars.githubusercontent.com/u/17199283?v=4","gravatar_id":"","url":"https://api.github.com/users/estellederrien","html_url":"https://github.com/estellederrien","followers_url":"https://api.github.com/users/estellederrien/followers","following_url":"https://api.github.com/users/estellederrien/following{/other_user}","gists_url":"https://api.github.com/users/estellederrien/gists{/gist_id}","starred_url":"https://api.github.com/users/estellederrien/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/estellederrien/subscriptions","organizations_url":"https://api.github.com/users/estellederrien/orgs","repos_url":"https://api.github.com/users/estellederrien/repos","events_url":"https://api.github.com/users/estellederrien/events{/privacy}","received_events_url":"https://api.github.com/users/estellederrien/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-08T12:47:44Z","updated_at":"2018-08-08T12:48:55Z","author_association":"NONE","body":"Im on nicolas2@nicolas2-virtual-machine:/$ \r\n\r\n\r\n**part 1 :** ive done that :+1: \r\n\r\nDebian/Ubuntu: Run the command:\r\n\r\n$ echo \"deb https://apache.bintray.com/couchdb-deb {distribution} main\" \\\r\n    | sudo tee -a /etc/apt/sources.list\r\n\r\nand replace {distribution} with the appropriate choice for your OS version:\r\n\r\n**Part 2** \r\n\r\nDebian/Ubuntu: First, install the repository key:\r\n\r\n$ curl -L https://couchdb.apache.org/repo/bintray-pubkey.asc \\\r\n    | sudo apt-key add -\r\n\r\nThen update the repository cache and install the package:\r\n\r\n$ sudo apt-get update && sudo apt-get install couchdb\r\n\r\n**part 3** \r\n\r\n2.1.3.1. Debian-based Systems\r\n\r\nYou can install the dependencies by running:\r\n\r\nsudo apt-get --no-install-recommends -y install \\\r\n    build-essential pkg-config erlang \\\r\n    libicu-dev libmozjs185-dev libcurl4-openssl-dev\r\n\r\n\r\n**then finally i type** \r\n\r\n`./configure`\r\nThis is the unbutu response +1\r\n`bash : ./configure: no such file or directory`\r\n\r\nIt doesnt work ,` ./configure `doesnt exist.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411392942/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411393435","html_url":"https://github.com/apache/couchdb/issues/1528#issuecomment-411393435","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1528","id":411393435,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTM5MzQzNQ==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-08T12:49:33Z","updated_at":"2018-08-08T12:49:33Z","author_association":"MEMBER","body":"this is probably not happening now that we’re converging on elixir.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411393435/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411393659","html_url":"https://github.com/apache/couchdb/issues/1545#issuecomment-411393659","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1545","id":411393659,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTM5MzY1OQ==","user":{"login":"estellederrien","id":17199283,"node_id":"MDQ6VXNlcjE3MTk5Mjgz","avatar_url":"https://avatars.githubusercontent.com/u/17199283?v=4","gravatar_id":"","url":"https://api.github.com/users/estellederrien","html_url":"https://github.com/estellederrien","followers_url":"https://api.github.com/users/estellederrien/followers","following_url":"https://api.github.com/users/estellederrien/following{/other_user}","gists_url":"https://api.github.com/users/estellederrien/gists{/gist_id}","starred_url":"https://api.github.com/users/estellederrien/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/estellederrien/subscriptions","organizations_url":"https://api.github.com/users/estellederrien/orgs","repos_url":"https://api.github.com/users/estellederrien/repos","events_url":"https://api.github.com/users/estellederrien/events{/privacy}","received_events_url":"https://api.github.com/users/estellederrien/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-08T12:50:16Z","updated_at":"2018-08-08T12:50:16Z","author_association":"NONE","body":"Hello, finally, its is because when you install couchdb from the ubuntu installation graphic app, it puts it inside a readonly directory called snap, then you cant change anything","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411393659/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411394556","html_url":"https://github.com/apache/couchdb/issues/1534#issuecomment-411394556","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1534","id":411394556,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTM5NDU1Ng==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-08T12:53:22Z","updated_at":"2018-08-08T12:53:22Z","author_association":"MEMBER","body":"> Design documents and couch_httpd_proxy used to the onboarding feature, the reason why is very well described in Nolan's blog post.\r\n\r\nwe’ve been over this a couple of times now. This is all on the way out unless someone comes and takes responsibility for it initially and going forward. That means writing and actively maintaining Erlang code. That nobody since 2012 or so stepped up to do this is enough of an indicator that these features can go, especially with some of the partially broken already in 2.x.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411394556/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411394811","html_url":"https://github.com/apache/couchdb/issues/1539#issuecomment-411394811","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1539","id":411394811,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTM5NDgxMQ==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-08T12:54:17Z","updated_at":"2018-08-08T12:54:17Z","author_association":"MEMBER","body":"I have a node.js based proxy prototype of this (closed source at the moment) that could help with inspiration. I might be able to share its test suite in the future.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411394811/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411395290","html_url":"https://github.com/apache/couchdb/issues/1548#issuecomment-411395290","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1548","id":411395290,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTM5NTI5MA==","user":{"login":"estellederrien","id":17199283,"node_id":"MDQ6VXNlcjE3MTk5Mjgz","avatar_url":"https://avatars.githubusercontent.com/u/17199283?v=4","gravatar_id":"","url":"https://api.github.com/users/estellederrien","html_url":"https://github.com/estellederrien","followers_url":"https://api.github.com/users/estellederrien/followers","following_url":"https://api.github.com/users/estellederrien/following{/other_user}","gists_url":"https://api.github.com/users/estellederrien/gists{/gist_id}","starred_url":"https://api.github.com/users/estellederrien/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/estellederrien/subscriptions","organizations_url":"https://api.github.com/users/estellederrien/orgs","repos_url":"https://api.github.com/users/estellederrien/repos","events_url":"https://api.github.com/users/estellederrien/events{/privacy}","received_events_url":"https://api.github.com/users/estellederrien/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-08T12:56:05Z","updated_at":"2018-08-08T12:58:29Z","author_association":"NONE","body":"Ho i think i just have somthing, doing this seems to work :+1: \r\n`$ sudo apt-get install couchdb`\r\n\r\nfrom the part 2 , please notice i  have removed \r\n`$ sudo apt-get update &&`\r\n\r\nThen i have a small CMD type windows who purpose me to set a cluster, and finnally change the name of my machine .\r\n\r\nplease notice that when installing couchdb from the ubuntu software graphical interface, it installs it in a readonly directory so you can't edit vm.args, i've been stuck 1 week because of that. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411395290/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411395370","html_url":"https://github.com/apache/couchdb/issues/1548#issuecomment-411395370","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1548","id":411395370,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTM5NTM3MA==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-08T12:56:21Z","updated_at":"2018-08-08T12:56:21Z","author_association":"MEMBER","body":"@nicolas15000 after `apt-get install couchdb` CouchDB will be installed and you should be able to start it with `server couchdb start` or a variant thereof. You don’t have to do any more steps, especially not `./configure`. You’re mixing up instructions for installing CouchDB from source and CouchDB as a binary package. Stick to the latter one,","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411395370/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411395740","html_url":"https://github.com/apache/couchdb/issues/1545#issuecomment-411395740","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1545","id":411395740,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTM5NTc0MA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-08T12:57:42Z","updated_at":"2018-08-08T12:57:42Z","author_association":"MEMBER","body":"@nicolas15000 Thanks for the info. As mentioned, the snap is outdated and unsupported, we've unpublished it from the snapcraft store.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411395740/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411408631","html_url":"https://github.com/apache/couchdb/issues/1544#issuecomment-411408631","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1544","id":411408631,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTQwODYzMQ==","user":{"login":"wactbprot","id":113518,"node_id":"MDQ6VXNlcjExMzUxOA==","avatar_url":"https://avatars.githubusercontent.com/u/113518?v=4","gravatar_id":"","url":"https://api.github.com/users/wactbprot","html_url":"https://github.com/wactbprot","followers_url":"https://api.github.com/users/wactbprot/followers","following_url":"https://api.github.com/users/wactbprot/following{/other_user}","gists_url":"https://api.github.com/users/wactbprot/gists{/gist_id}","starred_url":"https://api.github.com/users/wactbprot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wactbprot/subscriptions","organizations_url":"https://api.github.com/users/wactbprot/orgs","repos_url":"https://api.github.com/users/wactbprot/repos","events_url":"https://api.github.com/users/wactbprot/events{/privacy}","received_events_url":"https://api.github.com/users/wactbprot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-08T13:39:25Z","updated_at":"2018-08-08T13:39:25Z","author_association":"NONE","body":"What we have so far is this: \r\n- we tried firefox with a simple list function; the following header (shift+page reload) work 100%:\r\n```\r\nHost: localhost:5984\r\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:61.0) Gecko/20100101 Firefox/61.0\r\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\nAccept-Language: de,en-US;q=0.7,en;q=0.3\r\nAccept-Encoding: gzip, deflate\r\nConnection: keep-alive\r\nUpgrade-Insecure-Requests: 1\r\nPragma: no-cache\r\nCache-Control: no-cache\r\n```\r\nwithout the last two params (normal page reload)  our list returns the error above in ~40%. \r\n\r\n- with chromium neither:\r\n```\r\nHost: localhost:5984\r\nConnection: keep-alive\r\nCache-Control: max-age=0\r\nUpgrade-Insecure-Requests: 1\r\nDNT: 1\r\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.84 Safari/537.36\r\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8\r\nAccept-Encoding: gzip, deflate, br\r\nAccept-Language: de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7\r\n```\r\nnor:\r\n```\r\nHost: localhost:5984\r\nConnection: keep-alive\r\nPragma: no-cache\r\nCache-Control: no-cache\r\nUpgrade-Insecure-Requests: 1\r\nDNT: 1\r\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.84 Safari/537.36\r\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8\r\nAccept-Encoding: gzip, deflate, br\r\nAccept-Language: de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7\r\n```\r\nworks 100%.  ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411408631/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411411091","html_url":"https://github.com/apache/couchdb/issues/1544#issuecomment-411411091","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1544","id":411411091,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTQxMTA5MQ==","user":{"login":"wactbprot","id":113518,"node_id":"MDQ6VXNlcjExMzUxOA==","avatar_url":"https://avatars.githubusercontent.com/u/113518?v=4","gravatar_id":"","url":"https://api.github.com/users/wactbprot","html_url":"https://github.com/wactbprot","followers_url":"https://api.github.com/users/wactbprot/followers","following_url":"https://api.github.com/users/wactbprot/following{/other_user}","gists_url":"https://api.github.com/users/wactbprot/gists{/gist_id}","starred_url":"https://api.github.com/users/wactbprot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wactbprot/subscriptions","organizations_url":"https://api.github.com/users/wactbprot/orgs","repos_url":"https://api.github.com/users/wactbprot/repos","events_url":"https://api.github.com/users/wactbprot/events{/privacy}","received_events_url":"https://api.github.com/users/wactbprot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-08T13:46:55Z","updated_at":"2018-08-08T13:46:55Z","author_association":"NONE","body":"> @wactbprot Are you using eval in your function? This was disabled by default in 2.1.1:\r\n\r\nno, no ``eval()`` in use","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411411091/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411413979","html_url":"https://github.com/apache/couchdb/issues/1544#issuecomment-411413979","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1544","id":411413979,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTQxMzk3OQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-08T13:55:02Z","updated_at":"2018-08-08T13:55:02Z","author_association":"MEMBER","body":"@wactbprot Can you provide a complete example, including the request being issued? Ideally if you can reproduce this with `curl` and not a browser, I'd appreciate it.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411413979/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411418248","html_url":"https://github.com/apache/couchdb/issues/1544#issuecomment-411418248","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1544","id":411418248,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTQxODI0OA==","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-08T14:07:03Z","updated_at":"2018-08-08T14:07:03Z","author_association":"MEMBER","body":"we need the actual list function please. I've also tested a simple list function with 2.2.0 and it works as expected.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411418248/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411418596","html_url":"https://github.com/apache/couchdb/issues/1544#issuecomment-411418596","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1544","id":411418596,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTQxODU5Ng==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-08T14:08:07Z","updated_at":"2018-08-08T14:08:07Z","author_association":"MEMBER","body":"and sample docs","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411418596/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411418829","html_url":"https://github.com/apache/couchdb/issues/1544#issuecomment-411418829","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1544","id":411418829,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTQxODgyOQ==","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-08T14:08:50Z","updated_at":"2018-08-08T14:08:50Z","author_association":"MEMBER","body":"I've also tested with req.query itself, and that worked too;\r\n\r\ncurl foo:bar@localhost:15984/db1/_design/foo -XPUT -d '{\"_id\":\"_design/foo\",\"_rev\":\"3-3b014c7cc4ce97cb961af560fba50e27\",\"views\":{\"bar\":{\"map\":\"function(doc){emit(doc._id);}\"}},\"lists\":{\"baz\":\"function(head,req){start();while(row=getRow()){send(toJSON(req.query));}}\"}}'\r\n\r\ncurl 'foo:bar@localhost:15984/db1/_design/foo/_list/baz/bar?foo=bar'\r\n{\"foo\":\"bar\"}{\"foo\":\"bar\"}{\"foo\":\"bar\"}{\"foo\":\"bar\"}%","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411418829/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411421705","html_url":"https://github.com/apache/couchdb/issues/1544#issuecomment-411421705","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1544","id":411421705,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTQyMTcwNQ==","user":{"login":"wactbprot","id":113518,"node_id":"MDQ6VXNlcjExMzUxOA==","avatar_url":"https://avatars.githubusercontent.com/u/113518?v=4","gravatar_id":"","url":"https://api.github.com/users/wactbprot","html_url":"https://github.com/wactbprot","followers_url":"https://api.github.com/users/wactbprot/followers","following_url":"https://api.github.com/users/wactbprot/following{/other_user}","gists_url":"https://api.github.com/users/wactbprot/gists{/gist_id}","starred_url":"https://api.github.com/users/wactbprot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wactbprot/subscriptions","organizations_url":"https://api.github.com/users/wactbprot/orgs","repos_url":"https://api.github.com/users/wactbprot/repos","events_url":"https://api.github.com/users/wactbprot/events{/privacy}","received_events_url":"https://api.github.com/users/wactbprot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-08T14:17:18Z","updated_at":"2018-08-08T14:17:31Z","author_association":"NONE","body":"- first: no ``eval()`` but ``require()`` ...? \r\n> Can you provide a complete example, including the request being issued?\r\n\r\nhm, I'll try if the error occurs on a empty database ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411421705/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411458470","html_url":"https://github.com/apache/couchdb/issues/1544#issuecomment-411458470","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1544","id":411458470,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTQ1ODQ3MA==","user":{"login":"wactbprot","id":113518,"node_id":"MDQ6VXNlcjExMzUxOA==","avatar_url":"https://avatars.githubusercontent.com/u/113518?v=4","gravatar_id":"","url":"https://api.github.com/users/wactbprot","html_url":"https://github.com/wactbprot","followers_url":"https://api.github.com/users/wactbprot/followers","following_url":"https://api.github.com/users/wactbprot/following{/other_user}","gists_url":"https://api.github.com/users/wactbprot/gists{/gist_id}","starred_url":"https://api.github.com/users/wactbprot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wactbprot/subscriptions","organizations_url":"https://api.github.com/users/wactbprot/orgs","repos_url":"https://api.github.com/users/wactbprot/repos","events_url":"https://api.github.com/users/wactbprot/events{/privacy}","received_events_url":"https://api.github.com/users/wactbprot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-08T15:59:05Z","updated_at":"2018-08-08T15:59:05Z","author_association":"NONE","body":"I can not reproduce the error with new created list functions. The problem remains with the old ones.\r\nI deleted and re-deployed the old function; same behavior. I striped down the old list function to a \r\n``start()`` and ``send()`` and get (sometimes):\r\n```{\r\nerror: \"render_error\",\r\nreason: \"function raised error: (new TypeError(\"req.query is undefined\", \"lists.sum\", 19)) stacktrace: ([object Object],\"noproc\")@lists.sum:19 \r\nrunList(function (head, req) {start({headers: {'Content-type': \"text/html; charset=utf-8\"}});send(req.query.startkey);},[object Object],[object Array])@./share/server/main.js:998 (function (head, req) {start({headers: {'Content-type': \"text/html; charset=utf-8\"}});send(req.query.startkey);},[object Object],[object Array])@./share/server/main.js:1064 (\"_design/az\",[object Array],[object Array])@./share/server/main.js:1537 ()@./share/server/main.js:1582 ()@./share/server/main.js:1603 @./share/server/main.js:1 \"\r\n}```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411458470/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411464228","html_url":"https://github.com/apache/couchdb/issues/1544#issuecomment-411464228","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1544","id":411464228,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTQ2NDIyOA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-08T16:15:40Z","updated_at":"2018-08-08T16:15:40Z","author_association":"MEMBER","body":"@wactbprot Please share:\r\n\r\n* Your OS & version\r\n* How you installed CouchDB (docker, packages, Windows/Mac binary, from source, etc.)\r\n* How you installed SpiderMonkey 1.8.5 (Apache packages, vendor packages, from source, etc.)\r\n* A full list and view function that replicates this problem if you please","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411464228/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411464934","html_url":"https://github.com/apache/couchdb/issues/1548#issuecomment-411464934","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1548","id":411464934,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTQ2NDkzNA==","user":{"login":"estellederrien","id":17199283,"node_id":"MDQ6VXNlcjE3MTk5Mjgz","avatar_url":"https://avatars.githubusercontent.com/u/17199283?v=4","gravatar_id":"","url":"https://api.github.com/users/estellederrien","html_url":"https://github.com/estellederrien","followers_url":"https://api.github.com/users/estellederrien/followers","following_url":"https://api.github.com/users/estellederrien/following{/other_user}","gists_url":"https://api.github.com/users/estellederrien/gists{/gist_id}","starred_url":"https://api.github.com/users/estellederrien/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/estellederrien/subscriptions","organizations_url":"https://api.github.com/users/estellederrien/orgs","repos_url":"https://api.github.com/users/estellederrien/repos","events_url":"https://api.github.com/users/estellederrien/events{/privacy}","received_events_url":"https://api.github.com/users/estellederrien/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-08T16:17:50Z","updated_at":"2018-08-08T16:17:50Z","author_association":"NONE","body":"Thank you, it is working now, the problem was coming because i was installing from the graphical interface, should have installed with apt get","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411464934/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411501187","html_url":"https://github.com/apache/couchdb/issues/1544#issuecomment-411501187","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1544","id":411501187,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTUwMTE4Nw==","user":{"login":"rolfn","id":1469001,"node_id":"MDQ6VXNlcjE0NjkwMDE=","avatar_url":"https://avatars.githubusercontent.com/u/1469001?v=4","gravatar_id":"","url":"https://api.github.com/users/rolfn","html_url":"https://github.com/rolfn","followers_url":"https://api.github.com/users/rolfn/followers","following_url":"https://api.github.com/users/rolfn/following{/other_user}","gists_url":"https://api.github.com/users/rolfn/gists{/gist_id}","starred_url":"https://api.github.com/users/rolfn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rolfn/subscriptions","organizations_url":"https://api.github.com/users/rolfn/orgs","repos_url":"https://api.github.com/users/rolfn/repos","events_url":"https://api.github.com/users/rolfn/events{/privacy}","received_events_url":"https://api.github.com/users/rolfn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-08T18:12:49Z","updated_at":"2018-08-08T18:16:26Z","author_association":"NONE","body":"I am a co-worker of wactbprot and can give some answer:\r\n\r\n> Your OS & version\r\n\r\nopenSUSE 42.3 and openSUSE tumbleweed\r\n\r\n> How you installed CouchDB\r\n\r\nI created a rpm file similar to the Fedora rpm file. This worked in the past from 2.0.0 to 2.1.2 without errors.\r\n\r\n> How you installed SpiderMonkey 1.8.5\r\n\r\nI created a rpm file `couch-js` with the source files from [/apache/couchdb-pkg/tree/master/js/rpm](/apache/couchdb-pkg/tree/master/js/rpm)\r\n\r\nIf an Ubuntu 16.4 package for CouchDB 2.2.0 is available we can test the list problem again on this platform.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411501187/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411514897","html_url":"https://github.com/apache/couchdb/issues/1534#issuecomment-411514897","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1534","id":411514897,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTUxNDg5Nw==","user":{"login":"ermouth","id":1540047,"node_id":"MDQ6VXNlcjE1NDAwNDc=","avatar_url":"https://avatars.githubusercontent.com/u/1540047?v=4","gravatar_id":"","url":"https://api.github.com/users/ermouth","html_url":"https://github.com/ermouth","followers_url":"https://api.github.com/users/ermouth/followers","following_url":"https://api.github.com/users/ermouth/following{/other_user}","gists_url":"https://api.github.com/users/ermouth/gists{/gist_id}","starred_url":"https://api.github.com/users/ermouth/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ermouth/subscriptions","organizations_url":"https://api.github.com/users/ermouth/orgs","repos_url":"https://api.github.com/users/ermouth/repos","events_url":"https://api.github.com/users/ermouth/events{/privacy}","received_events_url":"https://api.github.com/users/ermouth/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-08T18:56:56Z","updated_at":"2018-08-08T18:56:56Z","author_association":"CONTRIBUTOR","body":"> That nobody since 2012 or so stepped up to do this\r\n\r\nOh, please. I personally tried to, and PMC reception was subzero cold. No one wants 15 PMCs directly hostile to couchapps telling him what to do, or telling ‘oh, we r sorry, we have only 8 month to new release so features list is frozen’. Taking in account ~half of PMC now consists of people only known for adding +1 under regular initiatives to amputate/deprecate/slowdown this or that, and for having no real projects with Couch, I have no doubt no one will volunteer.\r\n\r\nAlso taking in account I personally know 6 companies having custom builds of CouchDB with QS-related features and fixes, and all say they never contribute fixes/features to this repo because of PMC toxic attitude to couchappers (let me skip ML quotations). \r\n\r\nSo may be the case is not about having no QS maintainers? May be the case is PMC carefully crafting Stockholm syndrome in those who could (or even tried to) contribute?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411514897/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411547750","html_url":"https://github.com/apache/couchdb/issues/1534#issuecomment-411547750","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1534","id":411547750,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTU0Nzc1MA==","user":{"login":"nolanlawson","id":283842,"node_id":"MDQ6VXNlcjI4Mzg0Mg==","avatar_url":"https://avatars.githubusercontent.com/u/283842?v=4","gravatar_id":"","url":"https://api.github.com/users/nolanlawson","html_url":"https://github.com/nolanlawson","followers_url":"https://api.github.com/users/nolanlawson/followers","following_url":"https://api.github.com/users/nolanlawson/following{/other_user}","gists_url":"https://api.github.com/users/nolanlawson/gists{/gist_id}","starred_url":"https://api.github.com/users/nolanlawson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nolanlawson/subscriptions","organizations_url":"https://api.github.com/users/nolanlawson/orgs","repos_url":"https://api.github.com/users/nolanlawson/repos","events_url":"https://api.github.com/users/nolanlawson/events{/privacy}","received_events_url":"https://api.github.com/users/nolanlawson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-08T20:50:35Z","updated_at":"2018-08-08T20:50:35Z","author_association":"MEMBER","body":"I assume [this blog post](https://nolanlawson.com/2013/11/15/couchdb-doesnt-want-to-be-your-database-it-wants-to-be-your-web-site/) is the one being referenced? I don't really want to wade into the couchapps debate (certainly not with a blog post I wrote in 2013 😛), but FWIW many of these same features have been discussed getting deprecated in PouchDB and pouchdb-server for years. @daleharvey can probably provide a more up-to-date perspective on that.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411547750/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411579793","html_url":"https://github.com/apache/couchdb/issues/1534#issuecomment-411579793","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1534","id":411579793,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTU3OTc5Mw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-08T22:56:40Z","updated_at":"2018-08-08T23:02:06Z","author_association":"MEMBER","body":"@ermouth This is a formal code of conduct warning. You need to assume good faith in this discussion, and I don't believe you are doing so. You are just continuing to bring more anger and rancor to the community. I recognize you are angry and want to fight for something you believe in, but if you continue in this accusatory and belligerent manner, I will remove you from this discussion.\r\n\r\nThe CouchDB contributors and PMC members you mention that \"just +1\" have a lot of commits to the project behind the scenes - especially if you look at couchdb-fauxton (Garren, Antonio, and Alexis are very active contributors) and the Cloudant CouchDB repo (Mike Rhodes, Adam Kocoloski, Robert Newson, Ilya Khlopotov, Nick Vatamaniuc, and Paul Davis, to name just a few) from which a lot of important PRs come.  It also includes non-Cloudant people like Dave Cottlehuber and Andy Wenk, whose contributions in terms of organisation, coordination and release management are very welcome. These very people - the people who are **doing the work on CouchDB and contributing regularly** - are the ones who get to decide what happens on the project. That's how Apache works.\r\n\r\nWe have to make a pragmatic, practical decision about how to proceed with the resources we have, the resources we attract and the direction we're looking to go in. Couchapp functionality is no longer the focus of CouchDB, for all the reasons previously stated.\r\n\r\nYou want to contribute to couchapps still? Great - either submit a PR with your proposed changes and improvements, or stop complaining. Those are the choices I are giving you. I am personally asking you - not anyone else in this thread or any other company, and as nicely as I can - to submit your PRs in good faith and I will personally look at them in good faith.\r\n\r\nAs an aside, If you know of 6 companies that refuse to contribute code here, as much effort as I could try to put in and heal wounds and mend differences, it's their choice if they contribute or not - and as our VP points out, they haven't for many years now. The AL2.0 means they are more than welcome to maintain their own fork, as long as they do not call it Couch-anything or Apache-anything.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411579793/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411582890","html_url":"https://github.com/apache/couchdb/issues/1549#issuecomment-411582890","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1549","id":411582890,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTU4Mjg5MA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-08T23:11:21Z","updated_at":"2018-08-08T23:11:21Z","author_association":"MEMBER","body":"Hi @CWX-iggy, thanks for your issue.\r\n\r\nUnfortunately, you need to know that the `$in` operator has to do a full scan on every query on every document in the index. This cannot be pre-determined given the way Mango builds indexes. Mango will index the full contents of the field you are searching on (here, `league`) but has to at query time do a manual comparison of the contents of that index, per-document, with your parameters at query time. You will experience similar poor performance with other inexact operators, such as the `$regex` operator. @tonysun83 can you confirm my understanding of Mango indexing here?\r\n\r\nI agree this is not clearly called out in the documentation, and for that I apologise. Would you agree with me converting your issue to one that would let us improve our documentation on this point?\r\n\r\nYour choices to improve performance are to use [Mango partial indexing](http://docs.couchdb.org/en/2.2.0/api/database/find.html#partial-indexes) to reduce the number of documents in your index (best option), use `$eq` or another _exact_ operator instead of `$in` (next best, but you may not be able to capture your query, or try something like Clouseau/Dreyfus for full text search capability instead (hardest to set up, requires JDK6 and Apache Lucene, but is more flexible in terms of partial term searching). This last option lets you use text-based Mango indexes if you want to stay with Mango.\r\n\r\nI recommend starting with partial indexing. You can use this to make multiple sub-indexes that reduce the likelihood of few documents being found. Partial indexes are especially good to filter documents by type, for which it looks like your `meta.type` or `league` fields might be good candidates. You may even find that running 2 mango queries (for instance, across 2 `league`s) across 2 partial indexes and then merging the results in your client / app layers will be faster than running the single query across the entire content database.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411582890/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411583531","html_url":"https://github.com/apache/couchdb/issues/1549#issuecomment-411583531","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1549","id":411583531,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTU4MzUzMQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-08T23:14:41Z","updated_at":"2018-08-08T23:17:45Z","author_association":"MEMBER","body":"One other thing I noticed - your query may not be using the right index. Can you check with `/db/_explain` that the index is indeed being used? I don't see you indexing the field you're querying against here, i.e. `league`.\r\n\r\nDocumentation on the explain endpoint is here: http://docs.couchdb.org/en/2.2.0/api/database/find.html#db-explain","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411583531/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411585530","html_url":"https://github.com/apache/couchdb/issues/1534#issuecomment-411585530","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1534","id":411585530,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTU4NTUzMA==","user":{"login":"natevw","id":265902,"node_id":"MDQ6VXNlcjI2NTkwMg==","avatar_url":"https://avatars.githubusercontent.com/u/265902?v=4","gravatar_id":"","url":"https://api.github.com/users/natevw","html_url":"https://github.com/natevw","followers_url":"https://api.github.com/users/natevw/followers","following_url":"https://api.github.com/users/natevw/following{/other_user}","gists_url":"https://api.github.com/users/natevw/gists{/gist_id}","starred_url":"https://api.github.com/users/natevw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/natevw/subscriptions","organizations_url":"https://api.github.com/users/natevw/orgs","repos_url":"https://api.github.com/users/natevw/repos","events_url":"https://api.github.com/users/natevw/events{/privacy}","received_events_url":"https://api.github.com/users/natevw/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-08T23:24:45Z","updated_at":"2018-08-08T23:39:16Z","author_association":"NONE","body":"As someone who fell in love with Couch 0.x/1.x in large part because of the CouchApp dream, I say:\r\n\r\nYes, please. Backfill those rabbit holes!\r\n\r\nRemoving _show/_list/_update, all the rewrites/proxy stuff, and probably even validate_doc_update (and filtered replication??) will make it clear how the present CouchDB intends to be used: **below** an application layer, i.e. as a *database*.\r\n\r\nI missed the unspoken transition and also got hurt holding out for improvements in an area which the maintainers were no longer interested in. Officially deprecating and eventually breaking all the novel/experimental use cases — which are still wandering around \"undead\" in the form of old blog posts and early guides — should help focus future adoption imo.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411585530/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411585594","html_url":"https://github.com/apache/couchdb/issues/1544#issuecomment-411585594","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1544","id":411585594,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTU4NTU5NA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-08T23:25:07Z","updated_at":"2018-08-08T23:25:07Z","author_association":"MEMBER","body":"Hi @rofln,\r\n\r\nYes, Ubuntu 16.04 packages for 2.2.0 are available right now. Please test and let us know if you see the problem there as well. My guess is something about your openSUSE build of `couchjs` is interfering, but I can't be sure.\r\n\r\nYou can also test whether or not adding the `--eval` flag to the definition of the javascript query server in your local.ini file helps, though if you're not using `eval()` or `Function()` it shoudln't. This was a change in 2.1.1, #916 , so you should have seen the effect already, but it's worth validating.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411585594/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411604442","html_url":"https://github.com/apache/couchdb/issues/1549#issuecomment-411604442","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1549","id":411604442,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTYwNDQ0Mg==","user":{"login":"ghost","id":10137,"node_id":"MDQ6VXNlcjEwMTM3","avatar_url":"https://avatars.githubusercontent.com/u/10137?v=4","gravatar_id":"","url":"https://api.github.com/users/ghost","html_url":"https://github.com/ghost","followers_url":"https://api.github.com/users/ghost/followers","following_url":"https://api.github.com/users/ghost/following{/other_user}","gists_url":"https://api.github.com/users/ghost/gists{/gist_id}","starred_url":"https://api.github.com/users/ghost/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ghost/subscriptions","organizations_url":"https://api.github.com/users/ghost/orgs","repos_url":"https://api.github.com/users/ghost/repos","events_url":"https://api.github.com/users/ghost/events{/privacy}","received_events_url":"https://api.github.com/users/ghost/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-09T01:08:27Z","updated_at":"2018-08-09T01:08:27Z","author_association":"NONE","body":"@wohali I suspect that may the issue - no index on league (or priority). How do I specify multiple `use_index`? This doesn't seem to work:\r\n\r\n`{...\"use_index\": [\"_design/filter_by_league\",\"_design/sort_by_date\"]}`\r\n\r\nThis is the response from `/db/_explain`\r\n```\r\n{\r\n    \"error\": \"error\",\r\n    \"reason\": \"{invalid_object,{<<\\\"\\ufffd\\ufffd\\ufffd\\ufffd\\\">>}}\"\r\n}\r\n```\r\nFauxton simply reports error fetching query plan.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411604442/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411610854","html_url":"https://github.com/apache/couchdb/issues/1226#issuecomment-411610854","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1226","id":411610854,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTYxMDg1NA==","user":{"login":"boerwastaken","id":15187983,"node_id":"MDQ6VXNlcjE1MTg3OTgz","avatar_url":"https://avatars.githubusercontent.com/u/15187983?v=4","gravatar_id":"","url":"https://api.github.com/users/boerwastaken","html_url":"https://github.com/boerwastaken","followers_url":"https://api.github.com/users/boerwastaken/followers","following_url":"https://api.github.com/users/boerwastaken/following{/other_user}","gists_url":"https://api.github.com/users/boerwastaken/gists{/gist_id}","starred_url":"https://api.github.com/users/boerwastaken/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/boerwastaken/subscriptions","organizations_url":"https://api.github.com/users/boerwastaken/orgs","repos_url":"https://api.github.com/users/boerwastaken/repos","events_url":"https://api.github.com/users/boerwastaken/events{/privacy}","received_events_url":"https://api.github.com/users/boerwastaken/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-09T01:48:16Z","updated_at":"2018-08-09T01:48:16Z","author_association":"NONE","body":"Thanks @wohali. From my tests a month or so ago, against Couchdb 1.7.2 (non-clustered) I didn't run into any surprises wrt etags, they were behaving exactly as I needed them to behave. So I'm back on 1.7.2. Time to relax ;-)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411610854/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411625086","html_url":"https://github.com/apache/couchdb/issues/1549#issuecomment-411625086","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1549","id":411625086,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTYyNTA4Ng==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-09T03:28:40Z","updated_at":"2018-08-09T03:30:24Z","author_association":"MEMBER","body":"You can't. Mango underneath is using the same index file format as MapReduce - you're still querying only a single index at once. You'll need to index all the fields you need in a single index.\r\n\r\nThat's weird on your /db/_explain response, you may need to upgrade to 2.2.0 for some bugfixes. Or I just realized - you might be trying to send it the query with a list-based `use_index`, which is invalid as I explained.\r\n\r\nClosing as this isn't strictly a Mango issue.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411625086/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411625108","html_url":"https://github.com/apache/couchdb/issues/1549#issuecomment-411625108","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1549","id":411625108,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTYyNTEwOA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-09T03:28:49Z","updated_at":"2018-08-09T03:28:49Z","author_association":"MEMBER","body":"Happy to keep discussing it with you in this ticket if you like.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411625108/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411642145","html_url":"https://github.com/apache/couchdb/issues/1544#issuecomment-411642145","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1544","id":411642145,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTY0MjE0NQ==","user":{"login":"rolfn","id":1469001,"node_id":"MDQ6VXNlcjE0NjkwMDE=","avatar_url":"https://avatars.githubusercontent.com/u/1469001?v=4","gravatar_id":"","url":"https://api.github.com/users/rolfn","html_url":"https://github.com/rolfn","followers_url":"https://api.github.com/users/rolfn/followers","following_url":"https://api.github.com/users/rolfn/following{/other_user}","gists_url":"https://api.github.com/users/rolfn/gists{/gist_id}","starred_url":"https://api.github.com/users/rolfn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rolfn/subscriptions","organizations_url":"https://api.github.com/users/rolfn/orgs","repos_url":"https://api.github.com/users/rolfn/repos","events_url":"https://api.github.com/users/rolfn/events{/privacy}","received_events_url":"https://api.github.com/users/rolfn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-09T05:35:35Z","updated_at":"2018-08-09T05:35:35Z","author_association":"NONE","body":"> My guess is something about your openSUSE build of couchjs is interfering, but I can't be sure.\r\n\r\nI don't think that this can be the reason. We use the same (!) `couchjs` code for CouchDB 2.1.2 too without any problems.\r\n\r\nMore tests will be following.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411642145/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411657758","html_url":"https://github.com/apache/couchdb/issues/1549#issuecomment-411657758","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1549","id":411657758,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTY1Nzc1OA==","user":{"login":"garrensmith","id":179458,"node_id":"MDQ6VXNlcjE3OTQ1OA==","avatar_url":"https://avatars.githubusercontent.com/u/179458?v=4","gravatar_id":"","url":"https://api.github.com/users/garrensmith","html_url":"https://github.com/garrensmith","followers_url":"https://api.github.com/users/garrensmith/followers","following_url":"https://api.github.com/users/garrensmith/following{/other_user}","gists_url":"https://api.github.com/users/garrensmith/gists{/gist_id}","starred_url":"https://api.github.com/users/garrensmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/garrensmith/subscriptions","organizations_url":"https://api.github.com/users/garrensmith/orgs","repos_url":"https://api.github.com/users/garrensmith/repos","events_url":"https://api.github.com/users/garrensmith/events{/privacy}","received_events_url":"https://api.github.com/users/garrensmith/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-09T07:00:41Z","updated_at":"2018-08-09T07:00:41Z","author_association":"MEMBER","body":"@wohali is right that the query that takes long is doing a full index scan on `_all_docs` as you can see from the stats:\r\n\r\n```\r\n\"execution_stats\": {\r\n        \"total_keys_examined\": 0,\r\n        \"total_docs_examined\": 24856,\r\n        \"total_quorum_docs_examined\": 0,\r\n        \"results_returned\": 0,\r\n        \"execution_time_ms\": 34390.737\r\n    }\r\n```\r\n\r\nThe one that is faster is because it uses the `\"publishTime\"` index. Mango needs a way to know to select that index on your queries. The best way to do that is to add a publishTime into your selector even if its something like `publishTime: {$gt: null}`. That way it should always select that index. You can also add in the `use_index` to specify that index.\r\n\r\nBut running _explain on your queries will give you some information around what is happening internally and which index is being selected.\r\n\r\nSince you using `league` in your query it might be worth adding that into the index as well even if you only use it with the $in selector. That way only the docs with a league field and a publishTime field will be in your index.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411657758/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411680675","html_url":"https://github.com/apache/couchdb/issues/1549#issuecomment-411680675","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1549","id":411680675,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTY4MDY3NQ==","user":{"login":"willholley","id":97787,"node_id":"MDQ6VXNlcjk3Nzg3","avatar_url":"https://avatars.githubusercontent.com/u/97787?v=4","gravatar_id":"","url":"https://api.github.com/users/willholley","html_url":"https://github.com/willholley","followers_url":"https://api.github.com/users/willholley/followers","following_url":"https://api.github.com/users/willholley/following{/other_user}","gists_url":"https://api.github.com/users/willholley/gists{/gist_id}","starred_url":"https://api.github.com/users/willholley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/willholley/subscriptions","organizations_url":"https://api.github.com/users/willholley/orgs","repos_url":"https://api.github.com/users/willholley/repos","events_url":"https://api.github.com/users/willholley/events{/privacy}","received_events_url":"https://api.github.com/users/willholley/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-09T08:32:45Z","updated_at":"2018-08-09T08:32:45Z","author_association":"MEMBER","body":"just to clarify why the index is being used in the first instance, `\"sort\":[{\"publishTime\":\"desc\"}]` adds an implicit `\"publishTime\": { \"$exists\": true }` to the `\"selector\"`. If you're not specifying the `sort` in subsequent queries, you could add the selector clause explicitly to allow the index to be used (as @garrensmith suggested above).\r\n\r\nIt sounds like the most performant option would be to create an index on `[\"league\", \"publishTime\"]` and issue multiple requests - one for each league. You'd then need to merge/sort the results on the client.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411680675/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411684033","html_url":"https://github.com/apache/couchdb/issues/1544#issuecomment-411684033","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1544","id":411684033,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTY4NDAzMw==","user":{"login":"wactbprot","id":113518,"node_id":"MDQ6VXNlcjExMzUxOA==","avatar_url":"https://avatars.githubusercontent.com/u/113518?v=4","gravatar_id":"","url":"https://api.github.com/users/wactbprot","html_url":"https://github.com/wactbprot","followers_url":"https://api.github.com/users/wactbprot/followers","following_url":"https://api.github.com/users/wactbprot/following{/other_user}","gists_url":"https://api.github.com/users/wactbprot/gists{/gist_id}","starred_url":"https://api.github.com/users/wactbprot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wactbprot/subscriptions","organizations_url":"https://api.github.com/users/wactbprot/orgs","repos_url":"https://api.github.com/users/wactbprot/repos","events_url":"https://api.github.com/users/wactbprot/events{/privacy}","received_events_url":"https://api.github.com/users/wactbprot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-09T08:44:47Z","updated_at":"2018-08-09T08:44:47Z","author_association":"NONE","body":"The Ubuntu 16.04 packages for 2.2.0 shows the same erroneous behavior as the opensuse packages \"compiled\" by us. ``--eval`` doesn't change anything. Once again: the problem definitive occurs with ``2.2.0-rc1``. We are not able to provide a simple example for testing etc; we belive, that a certain degree of complexity is part of the problem. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411684033/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411684871","html_url":"https://github.com/apache/couchdb/issues/1544#issuecomment-411684871","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1544","id":411684871,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTY4NDg3MQ==","user":{"login":"wactbprot","id":113518,"node_id":"MDQ6VXNlcjExMzUxOA==","avatar_url":"https://avatars.githubusercontent.com/u/113518?v=4","gravatar_id":"","url":"https://api.github.com/users/wactbprot","html_url":"https://github.com/wactbprot","followers_url":"https://api.github.com/users/wactbprot/followers","following_url":"https://api.github.com/users/wactbprot/following{/other_user}","gists_url":"https://api.github.com/users/wactbprot/gists{/gist_id}","starred_url":"https://api.github.com/users/wactbprot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wactbprot/subscriptions","organizations_url":"https://api.github.com/users/wactbprot/orgs","repos_url":"https://api.github.com/users/wactbprot/repos","events_url":"https://api.github.com/users/wactbprot/events{/privacy}","received_events_url":"https://api.github.com/users/wactbprot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-09T08:48:01Z","updated_at":"2018-08-09T08:48:01Z","author_association":"NONE","body":"Any ideas what we can do or test? So far we have to stay at 2.1.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411684871/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411693410","html_url":"https://github.com/apache/couchdb/issues/1534#issuecomment-411693410","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1534","id":411693410,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTY5MzQxMA==","user":{"login":"johs","id":48370,"node_id":"MDQ6VXNlcjQ4Mzcw","avatar_url":"https://avatars.githubusercontent.com/u/48370?v=4","gravatar_id":"","url":"https://api.github.com/users/johs","html_url":"https://github.com/johs","followers_url":"https://api.github.com/users/johs/followers","following_url":"https://api.github.com/users/johs/following{/other_user}","gists_url":"https://api.github.com/users/johs/gists{/gist_id}","starred_url":"https://api.github.com/users/johs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/johs/subscriptions","organizations_url":"https://api.github.com/users/johs/orgs","repos_url":"https://api.github.com/users/johs/repos","events_url":"https://api.github.com/users/johs/events{/privacy}","received_events_url":"https://api.github.com/users/johs/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-09T09:17:09Z","updated_at":"2018-08-09T09:17:09Z","author_association":"NONE","body":"I share the frustration of @ermouth over the fact that his work with the rewrite function was not included in the 1.7.  The requirement for active contribution from @janl has been very clear, and was met with efforts from @ermouth and @giowild in the past, the promise that was expected to follow the requirement is no longer credible. \r\n\r\nThe establishment of the couchapp mailing list led to a peak in interest, but with no proposals being accepted this came to a halt. The list no longer on the web site, another of those undead items. 1.7 and 2.0 could have been good for couch apps, but with one missing rewrite functions and the other missing couch_httpd_proxy, we already use a patched version of 1.6.2. \r\n\r\n@natevw said it in a funny way \"Backfill those rabbit holes!\" since the quicky-breeding onboarding of CouchDB is what I always saw as the win-win. Getting hurt holding out for improvements in an areas which the maintainers are no longer interested is the problem that we as users must take responsibility for. \r\n\r\nA fork is the only option left.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411693410/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411699085","html_url":"https://github.com/apache/couchdb/issues/1534#issuecomment-411699085","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1534","id":411699085,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTY5OTA4NQ==","user":{"login":"daleharvey","id":37787,"node_id":"MDQ6VXNlcjM3Nzg3","avatar_url":"https://avatars.githubusercontent.com/u/37787?v=4","gravatar_id":"","url":"https://api.github.com/users/daleharvey","html_url":"https://github.com/daleharvey","followers_url":"https://api.github.com/users/daleharvey/followers","following_url":"https://api.github.com/users/daleharvey/following{/other_user}","gists_url":"https://api.github.com/users/daleharvey/gists{/gist_id}","starred_url":"https://api.github.com/users/daleharvey/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/daleharvey/subscriptions","organizations_url":"https://api.github.com/users/daleharvey/orgs","repos_url":"https://api.github.com/users/daleharvey/repos","events_url":"https://api.github.com/users/daleharvey/events{/privacy}","received_events_url":"https://api.github.com/users/daleharvey/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-09T09:37:12Z","updated_at":"2018-08-09T09:37:12Z","author_association":"CONTRIBUTOR","body":"I dont even think a fork is needed, with PouchDB I got lucky with having the hindsight of seeing how CouchApps played out, PouchDB core got to start out as what CouchDB is moving towards, being a solid database and that makes it easier for people to write things like pouchdb-server or rxdb which provide more application level constructs","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411699085/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411750389","html_url":"https://github.com/apache/couchdb/issues/1544#issuecomment-411750389","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1544","id":411750389,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTc1MDM4OQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-09T13:05:25Z","updated_at":"2018-08-09T13:05:25Z","author_association":"MEMBER","body":"@wactbprot Thanks for the confirmation that you see the same issue in 2.2.0 as we build it.\r\n\r\nWe need a reproducible test case. Please provide us with documents and a list function that reproduce the problem. We'll be more than happy to fix the problem once we have a way to reproduce it.\r\n\r\nLooking at the source code, nothing obvious has changed in our couchjs or _list implementations between the releases:\r\n\r\nhttps://github.com/apache/couchdb/tree/master/src/couch/priv/couch_js\r\nhttps://github.com/apache/couchdb/tree/master/share/server\r\nhttps://github.com/apache/couchdb/blob/master/src/chttpd/src/chttpd_show.erl\r\n\r\nso there's no \"smoking gun\" here.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411750389/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411751809","html_url":"https://github.com/apache/couchdb/issues/1550#issuecomment-411751809","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1550","id":411751809,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTc1MTgwOQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-09T13:10:14Z","updated_at":"2018-08-09T13:10:14Z","author_association":"MEMBER","body":"Hi @adrienverge ,\r\n\r\nI suspect this is an incompatibility of the new _session support with the `require_valid_user=true` setting.\r\n\r\nAs a temporary workaround, you can disable the new _session support in the replicator by setting:\r\n\r\n```\r\n[replicator]\r\nauth_plugins = couch_replicator_auth_noop\r\n```\r\n\r\nBefore making that change, do you have the same issue if you:\r\n\r\n* Post a document to the `_replicator` DB using `curl` from the command line?\r\n* Post to the `/_replicate` endpoint using `curl` from the command line?\r\n* Post a document to the `_replicator` DB using Fauxton?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411751809/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411753804","html_url":"https://github.com/apache/couchdb/issues/1534#issuecomment-411753804","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1534","id":411753804,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTc1MzgwNA==","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-09T13:17:07Z","updated_at":"2018-08-09T13:17:07Z","author_association":"MEMBER","body":"A gentle reminder from me that the opening comment on this issue is _proposals_ for things to remove. We should use the issue to discuss which things we will actually remove, when we'd remove them, and what, if anything, would replace them.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411753804/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411755136","html_url":"https://github.com/apache/couchdb/issues/1534#issuecomment-411755136","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1534","id":411755136,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTc1NTEzNg==","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-09T13:21:50Z","updated_at":"2018-08-09T13:21:50Z","author_association":"MEMBER","body":"For my part, here's my take on each item;\r\n\r\nWe should definitely remove;\r\n\r\n* View changes (the feature is not accessible and the plumbing that exists is flawed)\r\n* couch_external_*\r\n* couch_httpd_proxy\r\n* OS daemons\r\n\r\nWe should probably remove;\r\n\r\n* _list\r\n* _show\r\n* _update\r\n* rewrites\r\n* vhosts\r\n* the magical databases (_users, _replicator) and expose an API instead.\r\n\r\nWe should not remove;\r\n\r\n* VDU (though it could be replaced with a better system)\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411755136/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411761920","html_url":"https://github.com/apache/couchdb/issues/1550#issuecomment-411761920","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1550","id":411761920,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTc2MTkyMA==","user":{"login":"adrienverge","id":5244945,"node_id":"MDQ6VXNlcjUyNDQ5NDU=","avatar_url":"https://avatars.githubusercontent.com/u/5244945?v=4","gravatar_id":"","url":"https://api.github.com/users/adrienverge","html_url":"https://github.com/adrienverge","followers_url":"https://api.github.com/users/adrienverge/followers","following_url":"https://api.github.com/users/adrienverge/following{/other_user}","gists_url":"https://api.github.com/users/adrienverge/gists{/gist_id}","starred_url":"https://api.github.com/users/adrienverge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adrienverge/subscriptions","organizations_url":"https://api.github.com/users/adrienverge/orgs","repos_url":"https://api.github.com/users/adrienverge/repos","events_url":"https://api.github.com/users/adrienverge/events{/privacy}","received_events_url":"https://api.github.com/users/adrienverge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-09T13:43:45Z","updated_at":"2018-08-09T13:43:45Z","author_association":"CONTRIBUTOR","body":"Hi @wohali, thanks for your answer.\r\n\r\n- You're right, removing `require_valid_user = true` solves the problem.\r\n\r\n- ```\r\n  curl -X POST -u root:password http://127.0.0.1:15984/_replicator \\\r\n       -H \"Content-Type: application/json\" \\\r\n       -d '{\"_id\": \"rep_1\", \"source\":\"existing_db\", \"target\":\"new_db\", \"create_target\": true}'\r\n  ```\r\n\r\n  → The document is created, but the copy DB is not created (hence not replicated).\r\n\r\n\r\n- ```\r\n  curl -X POST -u root:password http://127.0.0.1:15984/_replicate \\\r\n       -H \"Content-Type: application/json\" \\\r\n       -d '{\"source\":\"existing_db\", \"target\":\"new_db\"}'\r\n  ```\r\n\r\n  ```\r\n  {\"error\":\"replication_auth_error\",\"reason\":\"{session_request_unauthorized,\\\"http://127.0.0.1:15984/_session\\\",\\\"root\\\"}\"}\r\n  ```\r\n\r\n- Post a document to the `_replicator` DB using Fauxton:\r\n  → The document is created, but the copy DB is not created (hence not replicated).\r\n\r\nDo I understand correctly that this is a temporary problem that happens in our special use-case (`require_valid_user = true`), and should be fixed in a future release? Or do we have a real forward-incompatibility in our configuration, and we must change it?\r\n\r\nThanks!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411761920/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411762614","html_url":"https://github.com/apache/couchdb/issues/1550#issuecomment-411762614","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1550","id":411762614,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTc2MjYxNA==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-09T13:45:46Z","updated_at":"2018-08-09T13:45:46Z","author_association":"MEMBER","body":"cc @nickva: do you think we can add a “use basic auth against _session if no session id exists yet“ mode for this?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411762614/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411777979","html_url":"https://github.com/apache/couchdb/issues/1550#issuecomment-411777979","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1550","id":411777979,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTc3Nzk3OQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-09T14:30:25Z","updated_at":"2018-08-09T14:30:25Z","author_association":"MEMBER","body":"@adrienverge Yes, you understand correctly, this is a bug, we'll work out how to fix it.\r\n\r\nCouch should be falling back to the non-session based authentication when the session-based authentication fails, but for some reason, it's not. \r\n\r\nThe workaround is a perfectly fine thing to do, it's not forward-incompatible. When session-based auth is fixed to work with `require_valid_user=true`, you'll be able to re-add that functionality back in by removing the 2 lines from your `local.ini` file.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411777979/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411784894","html_url":"https://github.com/apache/couchdb/issues/1544#issuecomment-411784894","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1544","id":411784894,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTc4NDg5NA==","user":{"login":"wactbprot","id":113518,"node_id":"MDQ6VXNlcjExMzUxOA==","avatar_url":"https://avatars.githubusercontent.com/u/113518?v=4","gravatar_id":"","url":"https://api.github.com/users/wactbprot","html_url":"https://github.com/wactbprot","followers_url":"https://api.github.com/users/wactbprot/followers","following_url":"https://api.github.com/users/wactbprot/following{/other_user}","gists_url":"https://api.github.com/users/wactbprot/gists{/gist_id}","starred_url":"https://api.github.com/users/wactbprot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wactbprot/subscriptions","organizations_url":"https://api.github.com/users/wactbprot/orgs","repos_url":"https://api.github.com/users/wactbprot/repos","events_url":"https://api.github.com/users/wactbprot/events{/privacy}","received_events_url":"https://api.github.com/users/wactbprot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-09T14:50:12Z","updated_at":"2018-08-09T14:50:12Z","author_association":"NONE","body":"> We need a reproducible test case. Please provide us with documents and a list function that reproduce the problem. We'll be more than happy to fix the problem once we have a way to reproduce it.\r\n\r\nWe really understand that. However:  \r\n\r\n> We are not able to provide a simple example for testing etc;\r\n\r\n I spend several hours with the attempt. We were not even able to find a pattern of request fails.\r\n\r\nOnly one example: \r\nIf I use chromium the request fails in half of the requests as reported. If I use curl with the same request header (chrom has the opportunity to generate the curl equivalent) the request works 100%.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411784894/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411785425","html_url":"https://github.com/apache/couchdb/issues/1544#issuecomment-411785425","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1544","id":411785425,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTc4NTQyNQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-09T14:51:46Z","updated_at":"2018-08-09T14:51:46Z","author_association":"MEMBER","body":"Hm, that is interesting.\r\n\r\nDo you have any sort of reverse web proxy in front of CouchDB? This might be an incompatibility with e.g. nginx, which is commonly misconfigured. We recommend HAProxy for best compatibility - it's what most of the CouchDB clusters at scale use.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411785425/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411788237","html_url":"https://github.com/apache/couchdb/issues/1544#issuecomment-411788237","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1544","id":411788237,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTc4ODIzNw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-09T14:59:28Z","updated_at":"2018-08-09T14:59:28Z","author_association":"MEMBER","body":"Follow-up question: Are you using CouchDB's native SSL support (httpsd)?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411788237/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411788489","html_url":"https://github.com/apache/couchdb/issues/1544#issuecomment-411788489","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1544","id":411788489,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTc4ODQ4OQ==","user":{"login":"wactbprot","id":113518,"node_id":"MDQ6VXNlcjExMzUxOA==","avatar_url":"https://avatars.githubusercontent.com/u/113518?v=4","gravatar_id":"","url":"https://api.github.com/users/wactbprot","html_url":"https://github.com/wactbprot","followers_url":"https://api.github.com/users/wactbprot/followers","following_url":"https://api.github.com/users/wactbprot/following{/other_user}","gists_url":"https://api.github.com/users/wactbprot/gists{/gist_id}","starred_url":"https://api.github.com/users/wactbprot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wactbprot/subscriptions","organizations_url":"https://api.github.com/users/wactbprot/orgs","repos_url":"https://api.github.com/users/wactbprot/repos","events_url":"https://api.github.com/users/wactbprot/events{/privacy}","received_events_url":"https://api.github.com/users/wactbprot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-09T15:00:11Z","updated_at":"2018-08-09T15:00:11Z","author_association":"NONE","body":"No proxy no SSL, in most of the tests I use a simple request to localhost w/o auth.\r\n\r\nMay I ask the other way around: can you try to find out or imagine under which conditions the second parameter of the anonymous list function catn become noproc? Is noproc a Erlang atom?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411788489/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411788663","html_url":"https://github.com/apache/couchdb/issues/1544#issuecomment-411788663","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1544","id":411788663,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTc4ODY2Mw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-09T15:00:40Z","updated_at":"2018-08-09T15:00:40Z","author_association":"MEMBER","body":"@wactbprot I'm just the issue triager, someone else will be along in a bit to dig deeper on this.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411788663/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411788832","html_url":"https://github.com/apache/couchdb/issues/1544#issuecomment-411788832","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1544","id":411788832,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTc4ODgzMg==","user":{"login":"wactbprot","id":113518,"node_id":"MDQ6VXNlcjExMzUxOA==","avatar_url":"https://avatars.githubusercontent.com/u/113518?v=4","gravatar_id":"","url":"https://api.github.com/users/wactbprot","html_url":"https://github.com/wactbprot","followers_url":"https://api.github.com/users/wactbprot/followers","following_url":"https://api.github.com/users/wactbprot/following{/other_user}","gists_url":"https://api.github.com/users/wactbprot/gists{/gist_id}","starred_url":"https://api.github.com/users/wactbprot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wactbprot/subscriptions","organizations_url":"https://api.github.com/users/wactbprot/orgs","repos_url":"https://api.github.com/users/wactbprot/repos","events_url":"https://api.github.com/users/wactbprot/events{/privacy}","received_events_url":"https://api.github.com/users/wactbprot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-09T15:01:06Z","updated_at":"2018-08-09T15:01:06Z","author_association":"NONE","body":"great!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411788832/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411789756","html_url":"https://github.com/apache/couchdb/issues/1550#issuecomment-411789756","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1550","id":411789756,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTc4OTc1Ng==","user":{"login":"adrienverge","id":5244945,"node_id":"MDQ6VXNlcjUyNDQ5NDU=","avatar_url":"https://avatars.githubusercontent.com/u/5244945?v=4","gravatar_id":"","url":"https://api.github.com/users/adrienverge","html_url":"https://github.com/adrienverge","followers_url":"https://api.github.com/users/adrienverge/followers","following_url":"https://api.github.com/users/adrienverge/following{/other_user}","gists_url":"https://api.github.com/users/adrienverge/gists{/gist_id}","starred_url":"https://api.github.com/users/adrienverge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adrienverge/subscriptions","organizations_url":"https://api.github.com/users/adrienverge/orgs","repos_url":"https://api.github.com/users/adrienverge/repos","events_url":"https://api.github.com/users/adrienverge/events{/privacy}","received_events_url":"https://api.github.com/users/adrienverge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-09T15:03:42Z","updated_at":"2018-08-09T15:03:42Z","author_association":"CONTRIBUTOR","body":"Thanks, it's clear!\r\n\r\nIn this case I'll simply wait for the next version. Feel free to ask if you need someone to test the fix!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411789756/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411790429","html_url":"https://github.com/apache/couchdb/issues/1544#issuecomment-411790429","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1544","id":411790429,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTc5MDQyOQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-09T15:05:47Z","updated_at":"2018-08-09T15:34:54Z","author_association":"MEMBER","body":"The trimmed-down list function, in a design document:\r\n\r\n```json\r\n{\r\n  \"language\": \"javascript\",\r\n  \"views\": {\r\n    \"variants\": {\r\n      \"map\": \"function(doc) {emit(doc.foo, doc.bar);}\"\r\n    }\r\n  },\r\n  \"lists\": {\r\n    \"results\": \"function(head, req) { start({ \\\"headers\\\": {\\\"Content-type\\\": \\\"text/html; charset=utf-8\\\"}}); send(req.query.startkey); }\"\r\n  }\r\n}\r\n```\r\n\r\nOn a single line:\r\n\r\n```\r\n'{\"language\":\"javascript\",\"views\":{\"variants\":{\"map\":\"function(doc) {emit(doc.foo, doc.bar);}\"}},\"lists\":{\"results\":\"function(head, req) { start({ \\\"headers\\\": {\\\"Content-type\\\": \\\"text/html; charset=utf-8\\\"}}); send(req.query.startkey); }\"}}'\r\n```\r\n\r\nAny sort of document will do for this.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411790429/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411791134","html_url":"https://github.com/apache/couchdb/issues/1544#issuecomment-411791134","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1544","id":411791134,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTc5MTEzNA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-09T15:07:47Z","updated_at":"2018-08-09T15:07:47Z","author_association":"MEMBER","body":"One last idea - if you turn up couchdb logging to debug level, do you see anything useful in the logs when this fails?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411791134/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411801932","html_url":"https://github.com/apache/couchdb/issues/1544#issuecomment-411801932","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1544","id":411801932,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTgwMTkzMg==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-09T15:39:29Z","updated_at":"2018-08-09T15:39:57Z","author_association":"MEMBER","body":"@wactbprot here is my current test case. The [above doc](https://github.com/apache/couchdb/issues/1544#issuecomment-411790429) is stored into `/abc/_design/lists-1544`. I then created a few sample docs in the `/abc/` db, though it doesn't matter for this list function.\r\n\r\nI have a file `headers.txt` with the following content:\r\n\r\n```\r\nHost: localhost:5984\r\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:61.0) Gecko/20100101 Firefox/61.0\r\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\nAccept-Language: de,en-US;q=0.7,en;q=0.3\r\nAccept-Encoding: gzip, deflate\r\nConnection: keep-alive\r\nUpgrade-Insecure-Requests: 1\r\n```\r\n\r\nI'm then issuing the following command (note: my couchdb is running on port 15984)\r\n\r\n```bash\r\nwhile true; do curl -v -H \"$(cat headers.txt)\" localhost:15984/abc/_design/lists-1544/_list/results/variants?startkey=\\\"abc\\\" 2>&1 | grep render_error; done\r\n```\r\n\r\nSo far every request is succeeding. Are you able to confirm whether the above fails for you at all?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411801932/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411813435","html_url":"https://github.com/apache/couchdb/pull/1543#issuecomment-411813435","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1543","id":411813435,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTgxMzQzNQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-09T16:14:41Z","updated_at":"2018-08-09T16:14:41Z","author_association":"MEMBER","body":"I would recommend removing the `_restart` handler from `rel/overlay/etc/default.ini` while you're at it, the code in `couch_httpd_misc_handlers:handle_restart_req`, and for the win, update the JS test suite to use this instead of the `printf \"restart\"` approach.\r\n\r\nOnce you do that, we can completely remove the stdout handling code from `dev/run` in #1406.\r\n\r\nFYI @iilyak if you create these branches on the main `apache/couchdb` repo instead of in the `cloudant/couchdb` one, I can check in changes on your branches to help you, rather than asking you to do all the work :) Otherwise, I'd have to issue PRs against `cloudant/couchdb` otherwise, and that feels clunky.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411813435/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411814228","html_url":"https://github.com/apache/couchdb/pull/1543#issuecomment-411814228","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1543","id":411814228,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTgxNDIyOA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-09T16:17:05Z","updated_at":"2018-08-09T16:17:52Z","author_association":"MEMBER","body":"Here's the code in the js suite that would need to be changed:\r\n\r\nhttps://github.com/apache/couchdb/blob/master/test/javascript/test_setup.js#L86\r\nhttps://github.com/apache/couchdb/blob/master/test/javascript/run#L88-L92\r\n\r\nShould be a snap to replace the first with a call to `CouchDB.request()` (see https://github.com/apache/couchdb/blob/master/test/javascript/test_setup.js#L73-L77 for an example) and the second just needs the special handling removed.\r\n\r\nDoing this would also let you confirm that the endpoint you're adding works with an actual test case or two. :wink: ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411814228/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411814791","html_url":"https://github.com/apache/couchdb/issues/1544#issuecomment-411814791","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1544","id":411814791,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTgxNDc5MQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-09T16:18:46Z","updated_at":"2018-08-09T16:18:46Z","author_association":"MEMBER","body":"OK, I ran the test like that for 40 minutes, with no reproduction. @rnewson ran tests too. Neither one of us were able to reproduce with this harness. Sorry :(","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411814791/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411859434","html_url":"https://github.com/apache/couchdb/issues/1544#issuecomment-411859434","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1544","id":411859434,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTg1OTQzNA==","user":{"login":"ermouth","id":1540047,"node_id":"MDQ6VXNlcjE1NDAwNDc=","avatar_url":"https://avatars.githubusercontent.com/u/1540047?v=4","gravatar_id":"","url":"https://api.github.com/users/ermouth","html_url":"https://github.com/ermouth","followers_url":"https://api.github.com/users/ermouth/followers","following_url":"https://api.github.com/users/ermouth/following{/other_user}","gists_url":"https://api.github.com/users/ermouth/gists{/gist_id}","starred_url":"https://api.github.com/users/ermouth/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ermouth/subscriptions","organizations_url":"https://api.github.com/users/ermouth/orgs","repos_url":"https://api.github.com/users/ermouth/repos","events_url":"https://api.github.com/users/ermouth/events{/privacy}","received_events_url":"https://api.github.com/users/ermouth/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-09T18:50:23Z","updated_at":"2018-08-09T19:46:52Z","author_association":"CONTRIBUTOR","body":"We were able to reproduce more or less reliably in this way:\r\n\r\n* make a VM, we use Parallels, 2 cores, 1GB, Xenial in this case\r\n* build 2.2 cluster from sources and run, 1 machine with 3 nodes, default cfg\r\n* log in using browser outside of VM; we use Photon to log in, however it seems insignificant\r\n* create a bucket, no security\r\n* replicate some docs into new bucket (we put 250 docs, about 15 Mb JSON in total)\r\n* make a ddoc with a simple list (very similar to the above) and a view, emitting all docs under same key with full body, like `emit('abc', doc);` \r\n* tap view to build the index\r\n* put request string with _list into browser address bar\r\n* run list in browser tab\r\n* log out\r\n* **put VM on pause for 5+ minutes** – key point\r\n* wake up VM\r\n* Update: Clicking _all_dbs button in Fauxton in this point (it makes 3 `_session` requests) seem to guarantee an error in the next step\r\n* reload page with list several times.\r\n\r\nVery likely you will see error message like in the issue, often several times. Eventually things become ok.\r\n\r\nNot sure, but seems longer VM pauses somehow increase probability of seeing error.\r\n\r\nHope it helps.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411859434/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411877867","html_url":"https://github.com/apache/couchdb/issues/1544#issuecomment-411877867","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1544","id":411877867,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTg3Nzg2Nw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-09T19:57:21Z","updated_at":"2018-08-09T19:57:21Z","author_association":"MEMBER","body":"@ermouth are you able to upload a `couch.log` file of this, preferably running at debug level, that captures the problem?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411877867/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411882344","html_url":"https://github.com/apache/couchdb/issues/1550#issuecomment-411882344","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1550","id":411882344,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTg4MjM0NA==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-09T20:13:12Z","updated_at":"2018-08-09T20:13:12Z","author_association":"CONTRIBUTOR","body":"@wohali @adrienverge \r\n\r\nIn the default case, session based auth plugin would fall back to basic auth if when it tries to use /_session endpoint it gets back a 404 (it doesn't exist). It assumes that endpoint doesn't support session and falls back to using basic auth.\r\n\r\nIn case of `require_valid_user=true` when it initializes is sends a POST request to _session with the user and name in the form body\r\n\r\n```\r\nPOST /_session HTTP/1.1\r\nContent-Type: application/x-www-form-urlencoded\r\n\r\nname=adm&password=pass\r\n```\r\n\r\nThat fails with a 401. On a 401 failure, session plugin assumes it is a bad username or password. \r\n\r\nI made PR to specifically handle the case when 401 response is because of the `require_valid_user=true` setting and fall back to using basic auth only.\r\n\r\nhttps://github.com/apache/couchdb/pull/1551","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411882344/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411885321","html_url":"https://github.com/apache/couchdb/issues/1544#issuecomment-411885321","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1544","id":411885321,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTg4NTMyMQ==","user":{"login":"ermouth","id":1540047,"node_id":"MDQ6VXNlcjE1NDAwNDc=","avatar_url":"https://avatars.githubusercontent.com/u/1540047?v=4","gravatar_id":"","url":"https://api.github.com/users/ermouth","html_url":"https://github.com/ermouth","followers_url":"https://api.github.com/users/ermouth/followers","following_url":"https://api.github.com/users/ermouth/following{/other_user}","gists_url":"https://api.github.com/users/ermouth/gists{/gist_id}","starred_url":"https://api.github.com/users/ermouth/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ermouth/subscriptions","organizations_url":"https://api.github.com/users/ermouth/orgs","repos_url":"https://api.github.com/users/ermouth/repos","events_url":"https://api.github.com/users/ermouth/events{/privacy}","received_events_url":"https://api.github.com/users/ermouth/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-09T20:24:09Z","updated_at":"2018-08-09T20:24:09Z","author_association":"CONTRIBUTOR","body":"```\r\n[notice] 2018-08-09T20:20:35.356925Z node1@127.0.0.1 <0.9175.0> 9c7987e49e 192.168.0.221:15984 192.168.0.204 root PUT /_node/node1%40127.0.0.1/_config/log/writer 200 ok 3\r\n[debug] 2018-08-09T20:20:35.455855Z node1@127.0.0.1 <0.9175.0> 0409c2af50 cache miss for root\r\n[debug] 2018-08-09T20:20:35.456600Z node1@127.0.0.1 <0.9175.0> 0409c2af50 no record of user root\r\n[debug] 2018-08-09T20:20:35.456628Z node1@127.0.0.1 <0.9175.0> 0409c2af50 timeout 600\r\n[debug] 2018-08-09T20:20:35.456644Z node1@127.0.0.1 <0.9175.0> 0409c2af50 Successful cookie auth as: \"root\"\r\n[notice] 2018-08-09T20:20:35.458489Z node1@127.0.0.1 <0.9175.0> 0409c2af50 192.168.0.221:15984 192.168.0.204 root PUT /_node/node2%40127.0.0.1/_config/log/file 200 ok 3\r\n[debug] 2018-08-09T20:20:35.556848Z node1@127.0.0.1 <0.9175.0> 62ab441846 cache miss for root\r\n[debug] 2018-08-09T20:20:35.557291Z node1@127.0.0.1 <0.9175.0> 62ab441846 no record of user root\r\n[debug] 2018-08-09T20:20:35.557322Z node1@127.0.0.1 <0.9175.0> 62ab441846 timeout 600\r\n[debug] 2018-08-09T20:20:35.557339Z node1@127.0.0.1 <0.9175.0> 62ab441846 Successful cookie auth as: \"root\"\r\n[notice] 2018-08-09T20:20:35.564042Z node1@127.0.0.1 <0.9175.0> 62ab441846 192.168.0.221:15984 192.168.0.204 root PUT /_node/node2%40127.0.0.1/_config/log/level 200 ok 7\r\n[debug] 2018-08-09T20:20:35.658361Z node1@127.0.0.1 <0.9175.0> a13da427b3 cache miss for root\r\n[debug] 2018-08-09T20:20:35.658757Z node1@127.0.0.1 <0.9175.0> a13da427b3 no record of user root\r\n[debug] 2018-08-09T20:20:35.658786Z node1@127.0.0.1 <0.9175.0> a13da427b3 timeout 600\r\n[debug] 2018-08-09T20:20:35.658803Z node1@127.0.0.1 <0.9175.0> a13da427b3 Successful cookie auth as: \"root\"\r\n[notice] 2018-08-09T20:20:35.667073Z node1@127.0.0.1 <0.9175.0> a13da427b3 192.168.0.221:15984 192.168.0.204 root PUT /_node/node2%40127.0.0.1/_config/log/writer 200 ok 9\r\n[debug] 2018-08-09T20:20:35.762182Z node1@127.0.0.1 <0.9175.0> 2498b74eea cache miss for root\r\n[debug] 2018-08-09T20:20:35.762574Z node1@127.0.0.1 <0.9175.0> 2498b74eea no record of user root\r\n[debug] 2018-08-09T20:20:35.762603Z node1@127.0.0.1 <0.9175.0> 2498b74eea timeout 600\r\n[debug] 2018-08-09T20:20:35.762620Z node1@127.0.0.1 <0.9175.0> 2498b74eea Successful cookie auth as: \"root\"\r\n[notice] 2018-08-09T20:20:35.770663Z node1@127.0.0.1 <0.9175.0> 2498b74eea 192.168.0.221:15984 192.168.0.204 root PUT /_node/node3%40127.0.0.1/_config/log/file 200 ok 9\r\n[debug] 2018-08-09T20:20:35.861057Z node1@127.0.0.1 <0.9175.0> 6a3749131f cache miss for root\r\n[debug] 2018-08-09T20:20:35.861563Z node1@127.0.0.1 <0.9175.0> 6a3749131f no record of user root\r\n[debug] 2018-08-09T20:20:35.861595Z node1@127.0.0.1 <0.9175.0> 6a3749131f timeout 600\r\n[debug] 2018-08-09T20:20:35.861611Z node1@127.0.0.1 <0.9175.0> 6a3749131f Successful cookie auth as: \"root\"\r\n[notice] 2018-08-09T20:20:35.868442Z node1@127.0.0.1 <0.9175.0> 6a3749131f 192.168.0.221:15984 192.168.0.204 root PUT /_node/node3%40127.0.0.1/_config/log/level 200 ok 7\r\n[debug] 2018-08-09T20:20:35.965554Z node1@127.0.0.1 <0.9175.0> 7a783ab565 cache miss for root\r\n[debug] 2018-08-09T20:20:35.966116Z node1@127.0.0.1 <0.9175.0> 7a783ab565 no record of user root\r\n[debug] 2018-08-09T20:20:35.966147Z node1@127.0.0.1 <0.9175.0> 7a783ab565 timeout 600\r\n[debug] 2018-08-09T20:20:35.966164Z node1@127.0.0.1 <0.9175.0> 7a783ab565 Successful cookie auth as: \"root\"\r\n[notice] 2018-08-09T20:20:35.968346Z node1@127.0.0.1 <0.9175.0> 7a783ab565 192.168.0.221:15984 192.168.0.204 root PUT /_node/node3%40127.0.0.1/_config/log/writer 200 ok 3\r\n[debug] 2018-08-09T20:20:35.975998Z node1@127.0.0.1 <0.9175.0> 12c3cb6078 cache miss for root\r\n[debug] 2018-08-09T20:20:35.976776Z node1@127.0.0.1 <0.9175.0> 12c3cb6078 no record of user root\r\n[debug] 2018-08-09T20:20:35.976914Z node1@127.0.0.1 <0.9175.0> 12c3cb6078 timeout 600\r\n[debug] 2018-08-09T20:20:35.976972Z node1@127.0.0.1 <0.9175.0> 12c3cb6078 Successful cookie auth as: \"root\"\r\n[notice] 2018-08-09T20:20:35.977352Z node1@127.0.0.1 <0.9175.0> 12c3cb6078 192.168.0.221:15984 192.168.0.204 root GET /_membership 200 ok 2\r\n[debug] 2018-08-09T20:20:35.982064Z node1@127.0.0.1 <0.9175.0> 580192c3c9 cache miss for root\r\n[debug] 2018-08-09T20:20:35.982683Z node1@127.0.0.1 <0.9175.0> 580192c3c9 no record of user root\r\n[debug] 2018-08-09T20:20:35.982714Z node1@127.0.0.1 <0.9175.0> 580192c3c9 timeout 600\r\n[debug] 2018-08-09T20:20:35.982733Z node1@127.0.0.1 <0.9175.0> 580192c3c9 Successful cookie auth as: \"root\"\r\n[notice] 2018-08-09T20:20:35.983986Z node1@127.0.0.1 <0.9175.0> 580192c3c9 192.168.0.221:15984 192.168.0.204 root GET /_node/node1%40127.0.0.1/_config 200 ok 2\r\n[debug] 2018-08-09T20:20:54.398303Z node1@127.0.0.1 <0.9175.0> 3abfaec7ee cache miss for root\r\n[debug] 2018-08-09T20:20:54.399690Z node1@127.0.0.1 <0.9175.0> 3abfaec7ee no record of user root\r\n[debug] 2018-08-09T20:20:54.399721Z node1@127.0.0.1 <0.9175.0> 3abfaec7ee timeout 600\r\n[debug] 2018-08-09T20:20:54.399743Z node1@127.0.0.1 <0.9175.0> 3abfaec7ee Successful cookie auth as: \"root\"\r\n[debug] 2018-08-09T20:20:54.409505Z node1@127.0.0.1 <0.10406.0> -------- OS Process Start :: #Port<0.29670>\r\n[debug] 2018-08-09T20:20:54.409797Z node1@127.0.0.1 <0.10406.0> -------- OS Process #Port<0.29670> Input  :: [\"ddoc\",\"new\",\"_design/lists2\",{\"_id\":\"_design/lists2\",\"_rev\":\"1-fe570f308484db16fb22e1fe6a2d803b\",\"language\":\"javascript\",\"views\":{\"variants3\":{\"map\":\"function(doc) {emit(doc.type , doc);}\"}},\"lists\":{\"results\":\"function(head, req) { start({ \\\"headers\\\": {\\\"Content-type\\\": \\\"text/html; charset=utf-8\\\"}}); var i=0; send (JSON.stringify(req.query)); while (getRow()) {i+=1}; send(i+'\\\\n\\\\n');  send (JSON.stringify(req.query)); }\",\"r\":\"function (head,req) { start({ \\\"headers\\\": {\\\"Content-type\\\": \\\"text/html; charset=utf-8\\\"}}); getRow(); send (JSON.stringify(req)); }\"}}]\r\n[debug] 2018-08-09T20:20:54.435704Z node1@127.0.0.1 <0.10406.0> -------- OS Process #Port<0.29670> Output :: true\r\n[debug] 2018-08-09T20:20:54.435914Z node1@127.0.0.1 <0.10406.0> -------- OS Process #Port<0.29670> Input  :: [\"reset\",{\"reduce_limit\":true,\"timeout\":5000}]\r\n[debug] 2018-08-09T20:20:54.437088Z node1@127.0.0.1 <0.10406.0> -------- OS Process #Port<0.29670> Output :: true\r\n[debug] 2018-08-09T20:20:54.441677Z node2@127.0.0.1 <0.10547.0> -------- Opening index for db: shards/40000000-5fffffff/zx.1533837982 idx: _design/lists2 sig: \"fcc86cc6cd04545f85bfd0803f6abfc9\"\r\n[debug] 2018-08-09T20:20:54.442628Z node3@127.0.0.1 <0.11553.0> -------- Opening index for db: shards/40000000-5fffffff/zx.1533837982 idx: _design/lists2 sig: \"fcc86cc6cd04545f85bfd0803f6abfc9\"\r\n[debug] 2018-08-09T20:20:54.443686Z node1@127.0.0.1 <0.10418.0> -------- Opening index for db: shards/00000000-1fffffff/zx.1533837982 idx: _design/lists2 sig: \"fcc86cc6cd04545f85bfd0803f6abfc9\"\r\n[debug] 2018-08-09T20:20:54.445450Z node1@127.0.0.1 <0.10420.0> -------- Opening index for db: shards/40000000-5fffffff/zx.1533837982 idx: _design/lists2 sig: \"fcc86cc6cd04545f85bfd0803f6abfc9\"\r\n[debug] 2018-08-09T20:20:54.445183Z node3@127.0.0.1 <0.11554.0> -------- Opening index for db: shards/00000000-1fffffff/zx.1533837982 idx: _design/lists2 sig: \"fcc86cc6cd04545f85bfd0803f6abfc9\"\r\n[debug] 2018-08-09T20:20:54.447518Z node1@127.0.0.1 <0.10452.0> -------- Opening index for db: shards/a0000000-bfffffff/zx.1533837982 idx: _design/lists2 sig: \"fcc86cc6cd04545f85bfd0803f6abfc9\"\r\n[debug] 2018-08-09T20:20:54.447554Z node1@127.0.0.1 <0.10453.0> -------- Opening index for db: shards/60000000-7fffffff/zx.1533837982 idx: _design/lists2 sig: \"fcc86cc6cd04545f85bfd0803f6abfc9\"\r\n[debug] 2018-08-09T20:20:54.443470Z node2@127.0.0.1 <0.10549.0> -------- Opening index for db: shards/00000000-1fffffff/zx.1533837982 idx: _design/lists2 sig: \"fcc86cc6cd04545f85bfd0803f6abfc9\"\r\n[debug] 2018-08-09T20:20:54.455017Z node3@127.0.0.1 <0.11585.0> -------- Opening index for db: shards/a0000000-bfffffff/zx.1533837982 idx: _design/lists2 sig: \"fcc86cc6cd04545f85bfd0803f6abfc9\"\r\n[debug] 2018-08-09T20:20:54.455684Z node3@127.0.0.1 <0.11589.0> -------- Opening index for db: shards/20000000-3fffffff/zx.1533837982 idx: _design/lists2 sig: \"fcc86cc6cd04545f85bfd0803f6abfc9\"\r\n[debug] 2018-08-09T20:20:54.456879Z node3@127.0.0.1 <0.11581.0> -------- Opening index for db: shards/c0000000-dfffffff/zx.1533837982 idx: _design/lists2 sig: \"fcc86cc6cd04545f85bfd0803f6abfc9\"\r\n[debug] 2018-08-09T20:20:54.456994Z node2@127.0.0.1 <0.10579.0> -------- Opening index for db: shards/60000000-7fffffff/zx.1533837982 idx: _design/lists2 sig: \"fcc86cc6cd04545f85bfd0803f6abfc9\"\r\n[debug] 2018-08-09T20:20:54.456913Z node3@127.0.0.1 <0.11583.0> -------- Opening index for db: shards/60000000-7fffffff/zx.1533837982 idx: _design/lists2 sig: \"fcc86cc6cd04545f85bfd0803f6abfc9\"\r\n[debug] 2018-08-09T20:20:54.457033Z node2@127.0.0.1 <0.10577.0> -------- Opening index for db: shards/e0000000-ffffffff/zx.1533837982 idx: _design/lists2 sig: \"fcc86cc6cd04545f85bfd0803f6abfc9\"\r\n[debug] 2018-08-09T20:20:54.457602Z node2@127.0.0.1 <0.10576.0> -------- Opening index for db: shards/c0000000-dfffffff/zx.1533837982 idx: _design/lists2 sig: \"fcc86cc6cd04545f85bfd0803f6abfc9\"\r\n[debug] 2018-08-09T20:20:54.457688Z node3@127.0.0.1 <0.11598.0> -------- Opening index for db: shards/e0000000-ffffffff/zx.1533837982 idx: _design/lists2 sig: \"fcc86cc6cd04545f85bfd0803f6abfc9\"\r\n[debug] 2018-08-09T20:20:54.457843Z node2@127.0.0.1 <0.10587.0> -------- Opening index for db: shards/a0000000-bfffffff/zx.1533837982 idx: _design/lists2 sig: \"fcc86cc6cd04545f85bfd0803f6abfc9\"\r\n[debug] 2018-08-09T20:20:54.458505Z node2@127.0.0.1 <0.10585.0> -------- Opening index for db: shards/80000000-9fffffff/zx.1533837982 idx: _design/lists2 sig: \"fcc86cc6cd04545f85bfd0803f6abfc9\"\r\n[debug] 2018-08-09T20:20:54.458850Z node2@127.0.0.1 <0.10586.0> -------- Opening index for db: shards/20000000-3fffffff/zx.1533837982 idx: _design/lists2 sig: \"fcc86cc6cd04545f85bfd0803f6abfc9\"\r\n[debug] 2018-08-09T20:20:54.461261Z node3@127.0.0.1 <0.11599.0> -------- Opening index for db: shards/80000000-9fffffff/zx.1533837982 idx: _design/lists2 sig: \"fcc86cc6cd04545f85bfd0803f6abfc9\"\r\n[debug] 2018-08-09T20:20:54.463292Z node1@127.0.0.1 <0.10451.0> -------- Opening index for db: shards/80000000-9fffffff/zx.1533837982 idx: _design/lists2 sig: \"fcc86cc6cd04545f85bfd0803f6abfc9\"\r\n[debug] 2018-08-09T20:20:54.463377Z node1@127.0.0.1 <0.10458.0> -------- Opening index for db: shards/e0000000-ffffffff/zx.1533837982 idx: _design/lists2 sig: \"fcc86cc6cd04545f85bfd0803f6abfc9\"\r\n[debug] 2018-08-09T20:20:54.463455Z node1@127.0.0.1 <0.10446.0> -------- Opening index for db: shards/20000000-3fffffff/zx.1533837982 idx: _design/lists2 sig: \"fcc86cc6cd04545f85bfd0803f6abfc9\"\r\n[debug] 2018-08-09T20:20:54.464030Z node1@127.0.0.1 <0.10465.0> -------- Opening index for db: shards/c0000000-dfffffff/zx.1533837982 idx: _design/lists2 sig: \"fcc86cc6cd04545f85bfd0803f6abfc9\"\r\n[debug] 2018-08-09T20:20:54.474253Z node1@127.0.0.1 <0.10406.0> -------- OS Process #Port<0.29670> Input  :: [\"ddoc\",\"_design/lists2\",[\"lists\",\"results\"],[{\"total_rows\":260,\"offset\":0},\"noproc\"]]\r\n[debug] 2018-08-09T20:20:54.476042Z node1@127.0.0.1 <0.10406.0> -------- OS Process #Port<0.29670> Output :: [\"log\",\"function raised error: (new TypeError(\\\"chunk is undefined\\\", \\\"/home/parallels/couchdb/share/server/main.js\\\", 860)) \\u000astacktrace: send((void 0))@/home/parallels/couchdb/share/server/main.js:860\\u000a([object Object],\\\"noproc\\\")@lists.results:1\\u000arunList(function (head, req) {start({headers: {'Content-type': \\\"text/html; charset=utf-8\\\"}});var i = 0;send(JSON.stringify(req.query));while (getRow()) {i += 1;}send(i + \\\"\\\\n\\\\n\\\");send(JSON.stringify(req.query));},[object Object],[object Array])@/home/parallels/couchdb/share/server/main.js:998\\u000a(function (head, req) {start({headers: {'Content-type': \\\"text/html; charset=utf-8\\\"}});var i = 0;send(JSON.stringify(req.query));while (getRow()) {i += 1;}send(i + \\\"\\\\n\\\\n\\\");send(JSON.stringify(req.query));},[object Object],[object Array])@/home/parallels/couchdb/share/server/main.js:1064\\u000a(\\\"_design/lists2\\\",[object Array],[object Array])@/home/parallels/couchdb/share/server/main.js:1537\\u000a()@/home/parallels/couchdb/share/server/main.js:1582\\u000a()@/home/parallels/couchdb/share/server/main.js:1603\\u000a@/home/parallels/couchdb/share/server/main.js:1\\u000a\"]\r\n[info] 2018-08-09T20:20:54.476171Z node1@127.0.0.1 <0.10406.0> -------- OS Process #Port<0.29670> Log :: function raised error: (new TypeError(\"chunk is undefined\", \"/home/parallels/couchdb/share/server/main.js\", 860)) \r\nstacktrace: send((void 0))@/home/parallels/couchdb/share/server/main.js:860\r\n([object Object],\"noproc\")@lists.results:1\r\nrunList(function (head, req) {start({headers: {'Content-type': \"text/html; charset=utf-8\"}});var i = 0;send(JSON.stringify(req.query));while (getRow()) {i += 1;}send(i + \"\\n\\n\");send(JSON.stringify(req.query));},[object Object],[object Array])@/home/parallels/couchdb/share/server/main.js:998\r\n(function (head, req) {start({headers: {'Content-type': \"text/html; charset=utf-8\"}});var i = 0;send(JSON.stringify(req.query));while (getRow()) {i += 1;}send(i + \"\\n\\n\");send(JSON.stringify(req.query));},[object Object],[object Array])@/home/parallels/couchdb/share/server/main.js:1064\r\n(\"_design/lists2\",[object Array],[object Array])@/home/parallels/couchdb/share/server/main.js:1537\r\n()@/home/parallels/couchdb/share/server/main.js:1582\r\n()@/home/parallels/couchdb/share/server/main.js:1603\r\n@/home/parallels/couchdb/share/server/main.js:1\r\n\r\n[debug] 2018-08-09T20:20:54.476272Z node1@127.0.0.1 <0.10406.0> -------- OS Process #Port<0.29670> Output :: [\"error\",\"render_error\",\"function raised error: (new TypeError(\\\"chunk is undefined\\\", \\\"/home/parallels/couchdb/share/server/main.js\\\", 860)) \\u000astacktrace: send((void 0))@/home/parallels/couchdb/share/server/main.js:860\\u000a([object Object],\\\"noproc\\\")@lists.results:1\\u000arunList(function (head, req) {start({headers: {'Content-type': \\\"text/html; charset=utf-8\\\"}});var i = 0;send(JSON.stringify(req.query));while (getRow()) {i += 1;}send(i + \\\"\\\\n\\\\n\\\");send(JSON.stringify(req.query));},[object Object],[object Array])@/home/parallels/couchdb/share/server/main.js:998\\u000a(function (head, req) {start({headers: {'Content-type': \\\"text/html; charset=utf-8\\\"}});var i = 0;send(JSON.stringify(req.query));while (getRow()) {i += 1;}send(i + \\\"\\\\n\\\\n\\\");send(JSON.stringify(req.query));},[object Object],[object Array])@/home/parallels/couchdb/share/server/main.js:1064\\u000a(\\\"_design/lists2\\\",[object Array],[object Array])@/home/parallels/couchdb/share/server/main.js:1537\\u000a()@/home/parallels/couchdb/share/server/main.js:1582\\u000a()@/home/parallels/couchdb/share/server/main.js:1603\\u000a@/home/parallels/couchdb/share/server/main.js:1\\u000a\"]\r\n[error] 2018-08-09T20:20:54.477098Z node1@127.0.0.1 <0.9175.0> 3abfaec7ee OS Process Error <0.10406.0> :: {<<\"render_error\">>,<<\"function raised error: (new TypeError(\\\"chunk is undefined\\\", \\\"/home/parallels/couchdb/share/server/main.js\\\", 860)) \\nstacktrace: send((void 0))@/home/parallels/couchdb/share/server/main.js:860\\n([object Object],\\\"noproc\\\")@lists.results:1\\nrunList(function (head, req) {start({headers: {'Content-type': \\\"text/html; charset=utf-8\\\"}});var i = 0;send(JSON.stringify(req.query));while (getRow()) {i += 1;}send(i + \\\"\\\\n\\\\n\\\");send(JSON.stringify(req.query));},[object Object],[object Array])@/home/parallels/couchdb/share/server/main.js:998\\n(function (head, req) {start({headers: {'Content-type': \\\"text/html; charset=utf-8\\\"}});var i = 0;send(JSON.stringify(req.query));while (getRow()) {i += 1;}send(i + \\\"\\\\n\\\\n\\\");send(JSON.stringify(req.query));},[object Object],[object Array])@/home/parallels/couchdb/share/server/main.js:1064\\n(\\\"_design/lists2\\\",[object Array],[object Array])@/home/parallels/couchdb/share/server/main.js:1537\\n()@/home/parallels/couchdb/share/server/main.js:1582\\n()@/home/parallels/couchdb/share/server/main.js:1603\\n@/home/parallels/couchdb/share/server/main.js:1\\n\">>}\r\n[notice] 2018-08-09T20:20:54.477467Z node1@127.0.0.1 <0.9175.0> 3abfaec7ee 192.168.0.221:15984 192.168.0.204 root GET /zx/_design/lists2/_list/results/variants3?startkey=%22d100%22&limit=2 500 ok 79\r\n[debug] 2018-08-09T20:20:55.801987Z node2@127.0.0.1 <0.10549.0> -------- Index shutdown by monitor notice for db: shards/00000000-1fffffff/zx.1533837982 idx: _design/lists2\r\n[debug] 2018-08-09T20:20:55.802428Z node2@127.0.0.1 <0.10549.0> -------- Closing index for db: shards/00000000-1fffffff/zx.1533837982 idx: _design/lists2 sig: \"fcc86cc6cd04545f85bfd0803f6abfc9\" because normal\r\n```\r\n\r\nDdoc is bit different, but very slightly.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411885321/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411889657","html_url":"https://github.com/apache/couchdb/issues/1544#issuecomment-411889657","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1544","id":411889657,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTg4OTY1Nw==","user":{"login":"ermouth","id":1540047,"node_id":"MDQ6VXNlcjE1NDAwNDc=","avatar_url":"https://avatars.githubusercontent.com/u/1540047?v=4","gravatar_id":"","url":"https://api.github.com/users/ermouth","html_url":"https://github.com/ermouth","followers_url":"https://api.github.com/users/ermouth/followers","following_url":"https://api.github.com/users/ermouth/following{/other_user}","gists_url":"https://api.github.com/users/ermouth/gists{/gist_id}","starred_url":"https://api.github.com/users/ermouth/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ermouth/subscriptions","organizations_url":"https://api.github.com/users/ermouth/orgs","repos_url":"https://api.github.com/users/ermouth/repos","events_url":"https://api.github.com/users/ermouth/events{/privacy}","received_events_url":"https://api.github.com/users/ermouth/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-09T20:40:16Z","updated_at":"2018-08-09T20:40:16Z","author_association":"CONTRIBUTOR","body":"Another one [log2.log](https://github.com/apache/couchdb/files/2275839/log2.log)\r\n\r\nHere I reload Photon, and then immediately have errors several times, and then finally have expected response.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411889657/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411940660","html_url":"https://github.com/apache/couchdb/issues/1544#issuecomment-411940660","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1544","id":411940660,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTk0MDY2MA==","user":{"login":"ermouth","id":1540047,"node_id":"MDQ6VXNlcjE1NDAwNDc=","avatar_url":"https://avatars.githubusercontent.com/u/1540047?v=4","gravatar_id":"","url":"https://api.github.com/users/ermouth","html_url":"https://github.com/ermouth","followers_url":"https://api.github.com/users/ermouth/followers","following_url":"https://api.github.com/users/ermouth/following{/other_user}","gists_url":"https://api.github.com/users/ermouth/gists{/gist_id}","starred_url":"https://api.github.com/users/ermouth/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ermouth/subscriptions","organizations_url":"https://api.github.com/users/ermouth/orgs","repos_url":"https://api.github.com/users/ermouth/repos","events_url":"https://api.github.com/users/ermouth/events{/privacy}","received_events_url":"https://api.github.com/users/ermouth/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-10T00:40:20Z","updated_at":"2018-08-10T00:40:20Z","author_association":"CONTRIBUTOR","body":"`OS Process #Port<0.29670> Input  :: [\"ddoc\",\"_design/lists2\",[\"lists\",\"results\"],[{\"total_rows\":260,\"offset\":0},\"noproc\"]]`\r\n\r\nHere I see noproc msg instead of req obj. Seems it’s the only place able to return `\"noproc\"` string instead of req obj is https://github.com/apache/couchdb/blob/2.2.x/src/couch_mrview/src/couch_mrview_show.erl#L367-L377. However, I can’t see how it happens because I don’t clearly understand what this code does.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/411940660/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/412021546","html_url":"https://github.com/apache/couchdb/pull/1551#issuecomment-412021546","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1551","id":412021546,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMjAyMTU0Ng==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-10T08:55:53Z","updated_at":"2018-08-10T08:55:53Z","author_association":"MEMBER","body":"LGTM as a quick-fix. It’d be nice of course to send basic auth to `/_session` to make use of the optimisation even with `require_valid_user=true`.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/412021546/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/412031780","html_url":"https://github.com/apache/couchdb/issues/1544#issuecomment-412031780","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1544","id":412031780,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMjAzMTc4MA==","user":{"login":"wactbprot","id":113518,"node_id":"MDQ6VXNlcjExMzUxOA==","avatar_url":"https://avatars.githubusercontent.com/u/113518?v=4","gravatar_id":"","url":"https://api.github.com/users/wactbprot","html_url":"https://github.com/wactbprot","followers_url":"https://api.github.com/users/wactbprot/followers","following_url":"https://api.github.com/users/wactbprot/following{/other_user}","gists_url":"https://api.github.com/users/wactbprot/gists{/gist_id}","starred_url":"https://api.github.com/users/wactbprot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wactbprot/subscriptions","organizations_url":"https://api.github.com/users/wactbprot/orgs","repos_url":"https://api.github.com/users/wactbprot/repos","events_url":"https://api.github.com/users/wactbprot/events{/privacy}","received_events_url":"https://api.github.com/users/wactbprot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-10T09:36:09Z","updated_at":"2018-08-10T09:36:09Z","author_association":"NONE","body":"We found the region where the problem is introduced:\r\n```\r\nf6a771147ba488f80a7d29491263d19088d0eefb (t13) Implement pluggable storage engines\r\n8e34ce382dcdf16a2d68a0f0ac45f300c91e6844 (t12) Add legacy storage engine implementation\r\nfb2b046b288405f60a261552cacd57584fce72fd (t16) Add couch_db_engine module\r\n364ea209250df169f0c7425cf0003e20a5a2d28d (t15) Remove old rolling reboot upgrade code\r\n083239353e919e897b97e8a96ee07cb42ca4eccd (t14) Prevent chttpd multipart zombie processes\r\n6d959a7acab7d0ff110c7799f3295b6193f45c2f (t17) Avoid unconditional retries in replicator's http client\r\n302bd8b8b193186b920c56c918bb2bb7edc4be8a (t11) feat: update mochiweb to 2.17.0\r\n49\r\n```\r\n* branch t11 works\r\n* branch t13 don't\r\n* the branches in between don't compile\r\n ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/412031780/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/412069162","html_url":"https://github.com/apache/couchdb/issues/1544#issuecomment-412069162","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1544","id":412069162,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMjA2OTE2Mg==","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-10T12:35:17Z","updated_at":"2018-08-10T12:35:17Z","author_association":"MEMBER","body":"@wactbprot @ermouth Can you try the above patch (https://github.com/apache/couchdb/pull/1553)?\r\n\r\nI think what's happening is that an error from somewhere _else_ is getting swapped for the req.query value. The patch above should ensure we wait for the right 'DOWN' message.\r\n\r\nI expect a) you no longer get the error reported b) your log shows a _new_ error that I would very much like to see.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/412069162/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/412073693","html_url":"https://github.com/apache/couchdb/issues/1552#issuecomment-412073693","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1552","id":412073693,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMjA3MzY5Mw==","user":{"login":"detroitenglish","id":18492423,"node_id":"MDQ6VXNlcjE4NDkyNDIz","avatar_url":"https://avatars.githubusercontent.com/u/18492423?v=4","gravatar_id":"","url":"https://api.github.com/users/detroitenglish","html_url":"https://github.com/detroitenglish","followers_url":"https://api.github.com/users/detroitenglish/followers","following_url":"https://api.github.com/users/detroitenglish/following{/other_user}","gists_url":"https://api.github.com/users/detroitenglish/gists{/gist_id}","starred_url":"https://api.github.com/users/detroitenglish/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/detroitenglish/subscriptions","organizations_url":"https://api.github.com/users/detroitenglish/orgs","repos_url":"https://api.github.com/users/detroitenglish/repos","events_url":"https://api.github.com/users/detroitenglish/events{/privacy}","received_events_url":"https://api.github.com/users/detroitenglish/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-10T12:54:38Z","updated_at":"2018-08-10T12:54:38Z","author_association":"NONE","body":"See documentation section [10.3.6.1.8. Condition Operators](http://docs.couchdb.org/en/stable/api/database/find.html#condition-operators):\r\n\r\n> Warning\r\n> Regular expressions do not work with indexes, so they should not be used to filter large data sets.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/412073693/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/412078912","html_url":"https://github.com/apache/couchdb/issues/1552#issuecomment-412078912","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1552","id":412078912,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMjA3ODkxMg==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-10T13:16:10Z","updated_at":"2018-08-10T13:16:10Z","author_association":"MEMBER","body":"Exactly what @detroitenglish said - `$regex` will always do a full database scan. You can tell your query isn't using an index by making the same query against the `/dbname/_explain` endpoint, which will show which indexes are being used (and, I believe in 2.2, warns about the `$regex` operator...but I might be wrong.)\r\n\r\nYour options are:\r\n\r\n1. Create partial indexes using `$regex` and then query those with exact operators,\r\n1. Use `$or` to search each of the fields via an exact, `$eq` based approach\r\n1. Consider using the `$in` operator, but keep in mind this will still have to fully scan all documents in an index (thus, being faster than `$regex`, but will be slower than an exact-based search)\r\n1. Build a custom CouchDB that includes the dreyfus/clouseau support (which is Apache Lucene based) and do a full-text search using the `$text` operator\r\n\r\nHopefully one of these options will help.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/412078912/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/412110877","html_url":"https://github.com/apache/couchdb/pull/1551#issuecomment-412110877","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1551","id":412110877,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMjExMDg3Nw==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-08-10T15:05:35Z","updated_at":"2018-08-10T15:05:35Z","author_association":"CONTRIBUTOR","body":"Ah good point @wohali , @janl I'll take another look. I was afraid it would complicated the logic too much. And it felt strange having to send credentials in two different formats.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/412110877/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]