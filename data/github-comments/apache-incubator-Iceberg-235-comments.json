[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1451076561","html_url":"https://github.com/apache/iceberg/issues/5567#issuecomment-1451076561","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5567","id":1451076561,"node_id":"IC_kwDOCW7NX85WfavR","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T00:13:32Z","updated_at":"2023-03-02T00:13:32Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1451076561/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1451076596","html_url":"https://github.com/apache/iceberg/issues/5557#issuecomment-1451076596","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5557","id":1451076596,"node_id":"IC_kwDOCW7NX85Wfav0","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T00:13:34Z","updated_at":"2023-03-02T00:13:34Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1451076596/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1451121645","html_url":"https://github.com/apache/iceberg/pull/6980#issuecomment-1451121645","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6980","id":1451121645,"node_id":"IC_kwDOCW7NX85Wflvt","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T01:03:26Z","updated_at":"2023-03-02T01:03:26Z","author_association":"COLLABORATOR","body":"Also FYI @aokolnychyi , @RussellSpitzer ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1451121645/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1451144778","html_url":"https://github.com/apache/iceberg/issues/6974#issuecomment-1451144778","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6974","id":1451144778,"node_id":"IC_kwDOCW7NX85WfrZK","user":{"login":"shivaprasad-basavaraj","id":35128660,"node_id":"MDQ6VXNlcjM1MTI4NjYw","avatar_url":"https://avatars.githubusercontent.com/u/35128660?v=4","gravatar_id":"","url":"https://api.github.com/users/shivaprasad-basavaraj","html_url":"https://github.com/shivaprasad-basavaraj","followers_url":"https://api.github.com/users/shivaprasad-basavaraj/followers","following_url":"https://api.github.com/users/shivaprasad-basavaraj/following{/other_user}","gists_url":"https://api.github.com/users/shivaprasad-basavaraj/gists{/gist_id}","starred_url":"https://api.github.com/users/shivaprasad-basavaraj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shivaprasad-basavaraj/subscriptions","organizations_url":"https://api.github.com/users/shivaprasad-basavaraj/orgs","repos_url":"https://api.github.com/users/shivaprasad-basavaraj/repos","events_url":"https://api.github.com/users/shivaprasad-basavaraj/events{/privacy}","received_events_url":"https://api.github.com/users/shivaprasad-basavaraj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T01:35:36Z","updated_at":"2023-03-02T01:35:36Z","author_association":"NONE","body":"Sorry for the gaffe. I had setup the tables in iceberg incorrectly leading to the errors.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1451144778/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1451190748","html_url":"https://github.com/apache/iceberg/pull/6789#issuecomment-1451190748","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6789","id":1451190748,"node_id":"IC_kwDOCW7NX85Wf2nc","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T02:45:55Z","updated_at":"2023-03-02T02:45:55Z","author_association":"MEMBER","body":"@dimas-b: Thanks for the review. I have replied to the comments. Please check. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1451190748/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1451250830","html_url":"https://github.com/apache/iceberg/issues/6514#issuecomment-1451250830","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6514","id":1451250830,"node_id":"IC_kwDOCW7NX85WgFSO","user":{"login":"fqaiser94","id":20507243,"node_id":"MDQ6VXNlcjIwNTA3MjQz","avatar_url":"https://avatars.githubusercontent.com/u/20507243?v=4","gravatar_id":"","url":"https://api.github.com/users/fqaiser94","html_url":"https://github.com/fqaiser94","followers_url":"https://api.github.com/users/fqaiser94/followers","following_url":"https://api.github.com/users/fqaiser94/following{/other_user}","gists_url":"https://api.github.com/users/fqaiser94/gists{/gist_id}","starred_url":"https://api.github.com/users/fqaiser94/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fqaiser94/subscriptions","organizations_url":"https://api.github.com/users/fqaiser94/orgs","repos_url":"https://api.github.com/users/fqaiser94/repos","events_url":"https://api.github.com/users/fqaiser94/events{/privacy}","received_events_url":"https://api.github.com/users/fqaiser94/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T03:39:52Z","updated_at":"2023-03-02T03:39:52Z","author_association":"CONTRIBUTOR","body":"Hi @stevenzwu, \r\n\r\nGreat job presenting at subsurface conference today :) \r\nRegarding your comments: \r\n\r\n> Regarding the Kafka data file committer use case, it is non-desirable to have all the parallel threads committing to the Iceberg table. If the parallelism is 100 or 1,000, there will be a lot of collisions and retries. The conditional commit can ensure the correctness. But it can be inefficient or infeasible with high parallelism. Flink Iceberg sink coalescing all data files to a single committer task so that there is only one committer thread (in a Flink job) committing to the iceberg table.\r\n\r\nI fully agree with you on all the points you've stated here. \r\nIf the parallelism is high, conditional commits will be extremely inefficient to the point of infeasible even though it guarantees \"correctness.\"\r\nIn general, it is best to have just a single thread committing updates to an iceberg table, which is what Flink Iceberg Sink does.\r\nThis is also exactly what we try to do in our custom system. \r\nOur issue however is that we cannot guarantee that there will **always** be exactly a single thread committing a given datafile to the iceberg table. \r\nIn **_rare_** situations, and for only a **_brief_** moment in time, there may be more than one thread attempting to commit **_the same set of datafiles_** to the same iceberg table **_at the same time_**. \r\nDue to the distributed nature of our datafile-committer application, it is impossible to completely avoid this type of situation ever happening, we can only make them rare. \r\nThis is where we want to use conditional commits as a last line of defence to ensure that only one of these threads is successful in committing the datafile during these rare and brief moments of instability. \r\n\r\nI hope this explanation clarifies why conditional commits is still useful for datafile-committer use-cases like ours where you can guarantee that the majority of the time there will not be any conflicts. \r\n\r\n> if we go with the conditional commit approach and fail the second commit with lower watermark, how would the second application handle the failure? we can also get into the situation where the second application may never able to commit. if it's watermark is forever behind the first application, the condition check will always be false. not sure if this is a desirable behavior.\r\n\r\nThe desired behaviour here will likely vary depending on the use-case. \r\nFor example, for our use-case, the second application which is hit with a failure would abandon trying to commit that set of datafiles and move on to the next set of datafiles. \r\nDue to the nature of our application, we're guaranteed to eventually (and quickly) converge to a stable condition where each instance will be left handling messages that cannot conflict. \r\n\r\nAs far as the iceberg library is concerned, IMO it should just provide the fundamental building block i.e. a way for iceberg-api users to express the conditions under which a commit should proceed, and leave how to handle failures up to the API users. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1451250830/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1451252578","html_url":"https://github.com/apache/iceberg/pull/6513#issuecomment-1451252578","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6513","id":1451252578,"node_id":"IC_kwDOCW7NX85WgFti","user":{"login":"fqaiser94","id":20507243,"node_id":"MDQ6VXNlcjIwNTA3MjQz","avatar_url":"https://avatars.githubusercontent.com/u/20507243?v=4","gravatar_id":"","url":"https://api.github.com/users/fqaiser94","html_url":"https://github.com/fqaiser94","followers_url":"https://api.github.com/users/fqaiser94/followers","following_url":"https://api.github.com/users/fqaiser94/following{/other_user}","gists_url":"https://api.github.com/users/fqaiser94/gists{/gist_id}","starred_url":"https://api.github.com/users/fqaiser94/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fqaiser94/subscriptions","organizations_url":"https://api.github.com/users/fqaiser94/orgs","repos_url":"https://api.github.com/users/fqaiser94/repos","events_url":"https://api.github.com/users/fqaiser94/events{/privacy}","received_events_url":"https://api.github.com/users/fqaiser94/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T03:43:09Z","updated_at":"2023-03-02T03:43:09Z","author_association":"CONTRIBUTOR","body":"@stevenzwu sorry, I've [responded](https://github.com/apache/iceberg/issues/6514#issuecomment-1451250830) in the issue now, let's continue the conversation there. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1451252578/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1451320449","html_url":"https://github.com/apache/iceberg/pull/6789#issuecomment-1451320449","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6789","id":1451320449,"node_id":"IC_kwDOCW7NX85WgWSB","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T05:25:31Z","updated_at":"2023-03-02T05:42:01Z","author_association":"MEMBER","body":"This flaky error again !\r\n\r\n```\r\n* What went wrong:\r\nExecution failed for task ':iceberg-spark:iceberg-spark-3.3_2.12:checkstyleMain'.\r\n> A failure occurred while executing org.gradle.api.plugins.quality.internal.CheckstyleAction\r\n   > An unexpected error occurred configuring and executing Checkstyle.\r\n      > java.lang.Error: Error was thrown while processing /home/runner/work/iceberg/iceberg/spark/v3.3/spark/src/main/java/org/apache/iceberg/spark/source/SparkScanBuilder.java\r\n```\r\n\r\nopened this to get more info:\r\nhttps://github.com/apache/iceberg/pull/6982","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1451320449/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1451328932","html_url":"https://github.com/apache/iceberg/pull/6982#issuecomment-1451328932","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6982","id":1451328932,"node_id":"IC_kwDOCW7NX85WgYWk","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T05:39:46Z","updated_at":"2023-03-02T05:42:31Z","author_association":"MEMBER","body":"cc: @Fokko, @nastra, @jackye1995, @XN137    ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1451328932/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1451379254","html_url":"https://github.com/apache/iceberg/pull/6983#issuecomment-1451379254","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6983","id":1451379254,"node_id":"IC_kwDOCW7NX85Wgko2","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T06:47:53Z","updated_at":"2023-03-02T06:47:53Z","author_association":"MEMBER","body":"cc: @Fokko  , @huaxingao ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1451379254/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1451383325","html_url":"https://github.com/apache/iceberg/pull/6012#issuecomment-1451383325","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6012","id":1451383325,"node_id":"IC_kwDOCW7NX85Wglod","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T06:53:26Z","updated_at":"2023-03-02T06:53:26Z","author_association":"CONTRIBUTOR","body":"I also added this to our 1.2 milestone. I think we should be able to merge it tomorrow.\r\nThanks for making this happen, @flyrain!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1451383325/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1451385438","html_url":"https://github.com/apache/iceberg/pull/6983#issuecomment-1451385438","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6983","id":1451385438,"node_id":"IC_kwDOCW7NX85WgmJe","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T06:56:06Z","updated_at":"2023-03-02T06:56:06Z","author_association":"CONTRIBUTOR","body":"@ajantha-bhat Thanks for catching the problem!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1451385438/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1451405698","html_url":"https://github.com/apache/iceberg/pull/6982#issuecomment-1451405698","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6982","id":1451405698,"node_id":"IC_kwDOCW7NX85WgrGC","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T07:21:17Z","updated_at":"2023-03-02T07:21:17Z","author_association":"MEMBER","body":"@XN137 and @jackye1995: Thanks for the review. I have changed to  `--stacktrace, --debug` to find out the problem in future. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1451405698/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1451411478","html_url":"https://github.com/apache/iceberg/pull/6982#issuecomment-1451411478","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6982","id":1451411478,"node_id":"IC_kwDOCW7NX85WgsgW","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T07:27:48Z","updated_at":"2023-03-02T07:29:13Z","author_association":"CONTRIBUTOR","body":"Rather than merging this PR with debugging enabled, I'd rather vote for rerunning CI on this PR until we run into the issue, as otherwise this will be spamming logs. That being said, I'm leaning towards -1 on merging this. Also it might actually leak security information according to Gradle: ` Debug level logging will leak security sensitive information!`","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1451411478/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1451418564","html_url":"https://github.com/apache/iceberg/pull/6982#issuecomment-1451418564","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6982","id":1451418564,"node_id":"IC_kwDOCW7NX85WguPE","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T07:32:50Z","updated_at":"2023-03-02T07:32:50Z","author_association":"MEMBER","body":"changed to `--info` now. I will rerun the PR until I face the problem ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1451418564/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1451430014","html_url":"https://github.com/apache/iceberg/issues/6824#issuecomment-1451430014","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6824","id":1451430014,"node_id":"IC_kwDOCW7NX85WgxB-","user":{"login":"lurnagao-dahua","id":91278331,"node_id":"MDQ6VXNlcjkxMjc4MzMx","avatar_url":"https://avatars.githubusercontent.com/u/91278331?v=4","gravatar_id":"","url":"https://api.github.com/users/lurnagao-dahua","html_url":"https://github.com/lurnagao-dahua","followers_url":"https://api.github.com/users/lurnagao-dahua/followers","following_url":"https://api.github.com/users/lurnagao-dahua/following{/other_user}","gists_url":"https://api.github.com/users/lurnagao-dahua/gists{/gist_id}","starred_url":"https://api.github.com/users/lurnagao-dahua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lurnagao-dahua/subscriptions","organizations_url":"https://api.github.com/users/lurnagao-dahua/orgs","repos_url":"https://api.github.com/users/lurnagao-dahua/repos","events_url":"https://api.github.com/users/lurnagao-dahua/events{/privacy}","received_events_url":"https://api.github.com/users/lurnagao-dahua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T07:43:51Z","updated_at":"2023-03-02T07:43:51Z","author_association":"CONTRIBUTOR","body":"> #6451 Try to helps in most of the case #6570 might be interesting for you as well\r\n\r\nHiï¼ŒThis doesn't seem to solve the problem","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1451430014/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1451550761","html_url":"https://github.com/apache/iceberg/issues/6973#issuecomment-1451550761","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6973","id":1451550761,"node_id":"IC_kwDOCW7NX85WhOgp","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T09:21:31Z","updated_at":"2023-03-02T09:22:14Z","author_association":"CONTRIBUTOR","body":"@alaturqua thanks for raising this issue.\r\n\r\nSome steps on how I would add ORC support. First I would refactor the code:\r\nhttps://github.com/apache/iceberg/blob/35692a360ffd2d1b9107ec6018f9fd97fda04671/python/pyiceberg/io/pyarrow.py#L484-L519\r\n\r\nBy removing the `pq` package from there, and read in a PyArrow fragment instead:\r\n```python\r\nimport pyarrow.dataset as ds\r\nfrom pyarrow.fs import S3FileSystem\r\n\r\nwith fs.open_input_file(path) as fout:\r\n    # First get the fragment\r\n    fragment = parquet_format.make_fragment(fout, None)\r\n    print(f\"Schema: {fragment.physical_schema}\")\r\n    arrow_table = ds.Scanner.from_fragment(\r\n        fragment=fragment,\r\n        ... # add other arguments as well\r\n    ).to_table()\r\n```\r\n\r\nWe need to add logic to decide the `Format` based on the extension of the file, we can read in different fragments:\r\n- https://arrow.apache.org/docs/python/generated/pyarrow.dataset.ParquetFileFormat.html\r\n- https://arrow.apache.org/docs/python/generated/pyarrow.dataset.OrcFileFormat.html\r\n\r\nThe fragment has this option to say `physicial_schema` that will return the schema in PyArrow.\r\n\r\nNote: For Parquet we actually fetch the Iceberg schema in JSON format from the metadata currently. https://github.com/apache/iceberg/issues/6505 Will provide the logic to convert a PyArrow schema into an Iceberg schema.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1451550761/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1451566878","html_url":"https://github.com/apache/iceberg/issues/6978#issuecomment-1451566878","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6978","id":1451566878,"node_id":"IC_kwDOCW7NX85WhSce","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T09:33:04Z","updated_at":"2023-03-02T13:57:38Z","author_association":"CONTRIBUTOR","body":"I had a look at this and I think I understand what's going on here. \r\n\r\nIn  `sql(\"SELECT * from %s.files VERSION AS OF %s\", tableName, olderSnapshotId )` we're trying to do time-travel on the `FilesTable` but giving it the snapshot ID of the actual table, since `olderSnapshotId` is the snapshot from `tableName`. \r\n\r\nThe error therefore makes sense to me, since the schema of the `FilesTable` didn't evolve, but we're expecting it to return the schema for `olderSnapshotId`.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1451566878/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1451621220","html_url":"https://github.com/apache/iceberg/pull/6875#issuecomment-1451621220","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6875","id":1451621220,"node_id":"IC_kwDOCW7NX85Whftk","user":{"login":"snazy","id":957468,"node_id":"MDQ6VXNlcjk1NzQ2OA==","avatar_url":"https://avatars.githubusercontent.com/u/957468?v=4","gravatar_id":"","url":"https://api.github.com/users/snazy","html_url":"https://github.com/snazy","followers_url":"https://api.github.com/users/snazy/followers","following_url":"https://api.github.com/users/snazy/following{/other_user}","gists_url":"https://api.github.com/users/snazy/gists{/gist_id}","starred_url":"https://api.github.com/users/snazy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/snazy/subscriptions","organizations_url":"https://api.github.com/users/snazy/orgs","repos_url":"https://api.github.com/users/snazy/repos","events_url":"https://api.github.com/users/snazy/events{/privacy}","received_events_url":"https://api.github.com/users/snazy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T10:12:28Z","updated_at":"2023-03-02T10:12:28Z","author_association":"MEMBER","body":" @Fokko could you merge this one?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1451621220/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1451638558","html_url":"https://github.com/apache/iceberg/issues/5424#issuecomment-1451638558","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5424","id":1451638558,"node_id":"IC_kwDOCW7NX85Whj8e","user":{"login":"suisenkotoba","id":32249565,"node_id":"MDQ6VXNlcjMyMjQ5NTY1","avatar_url":"https://avatars.githubusercontent.com/u/32249565?v=4","gravatar_id":"","url":"https://api.github.com/users/suisenkotoba","html_url":"https://github.com/suisenkotoba","followers_url":"https://api.github.com/users/suisenkotoba/followers","following_url":"https://api.github.com/users/suisenkotoba/following{/other_user}","gists_url":"https://api.github.com/users/suisenkotoba/gists{/gist_id}","starred_url":"https://api.github.com/users/suisenkotoba/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/suisenkotoba/subscriptions","organizations_url":"https://api.github.com/users/suisenkotoba/orgs","repos_url":"https://api.github.com/users/suisenkotoba/repos","events_url":"https://api.github.com/users/suisenkotoba/events{/privacy}","received_events_url":"https://api.github.com/users/suisenkotoba/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T10:26:07Z","updated_at":"2023-03-03T01:04:48Z","author_association":"NONE","body":"anyone has any luck with this? I faced the same issue, I could not find what caused this. \r\nI am not sure if there's something wrong with my spark configuration. I use spark  3.3 on dataproc ([image version 2.1](https://cloud.google.com/dataproc/docs/concepts/versioning/dataproc-release-2.1)) with iceberg 1.1.0. The dataproc cluster already had dataproc metastore attached. I already added iceberg extension in my spark config, and even use table version 2, but I still get error `MERGE INTO TABLE is not supported temporarily`\r\nThis is my python code:\r\n```python\r\nfrom pyspark.sql import SparkSession\r\nfrom pyspark import SparkConf\r\nfrom pyspark.sql.types import LongType, BooleanType, StructField, StructType\r\n\r\n\r\nconf = (\r\n        SparkConf()\r\n        .setAppName('test_iceberg')\r\n        .set('spark.sql.extensions', 'org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions')\r\n        .set('spark.sql.catalog.spark_catalog', 'org.apache.iceberg.spark.SparkSessionCatalog')\r\n        .set('spark.sql.catalog.spark_catalog.type', 'hive')\r\n        .set(f'spark.sql.catalog.dev', 'org.apache.iceberg.spark.SparkCatalog')\r\n        .set(f'spark.sql.catalog.dev.type', 'hive')\r\n    )\r\nspark = SparkSession.builder.enableHiveSupport().config(conf=conf).getOrCreate()\r\n\r\ndf = spark.read.option(\"mergeSchema\", \"true\").parquet('gs://poc-kafka/mis').sort(\"timestamp\")\r\n\r\n# Create iceberg table \r\nschema = df.select(\"value.after.*\").schema\r\nadditional_fields = [StructField('start_at', LongType(), True), \r\n               StructField('end_at', LongType(), True), \r\n               StructField('is_current', BooleanType(), True)]\r\nschema = StructType(schema.fields + additional_fields)\r\nempty_df = spark.createDataFrame([], schema)\r\nspark.sql(\"CREATE DATABASE IF NOT EXISTS dev.dummy\")\r\nempty_df.createOrReplaceTempView(\"empty\")\r\nspark.sql(\"CREATE TABLE IF NOT EXISTS dev.dummy.fruit USING iceberg  \"\r\n         \"TBLPROPERTIES ('format-version'='2') \"\r\n         \"AS (SELECT * FROM empty) \")\r\n\r\n# Merge table\r\ndf.createOrReplaceTempView(\"changelog\")\r\nsql = \"MERGE INTO dev.dummy.fruit d \" \\\r\n      \"USING (SELECT value.after.*, value.op op, \" \\\r\n      \"            value.source.ts_ms start_at, True is_current, \" \\\r\n      \"            NULL end_at \" \\\r\n      \"        FROM changelog) s \" \\\r\n      \"ON d.id = s.id \" \\\r\n      \"WHEN MATCHED THEN UPDATE SET d.is_current = False, d.end_at = s.start_at \" \\\r\n      \"WHEN NOT MATCHED THEN INSERT * \"\r\nspark.sql(sql)\r\n\r\n```\r\n\r\nThis is the traceback I got:\r\n```\r\n/usr/lib/spark/python/pyspark/sql/session.py in sql(self, sqlQuery, **kwargs)\r\n   1032             sqlQuery = formatter.format(sqlQuery, **kwargs)\r\n   1033         try:\r\n-> 1034             return DataFrame(self._jsparkSession.sql(sqlQuery), self)\r\n   1035         finally:\r\n   1036             if len(kwargs) > 0:\r\n\r\n/usr/lib/spark/python/lib/py4j-0.10.9.5-src.zip/py4j/java_gateway.py in __call__(self, *args)\r\n   1319 \r\n   1320         answer = self.gateway_client.send_command(command)\r\n-> 1321         return_value = get_return_value(\r\n   1322             answer, self.gateway_client, self.target_id, self.name)\r\n   1323 \r\n\r\n/usr/lib/spark/python/pyspark/sql/utils.py in deco(*a, **kw)\r\n    188     def deco(*a: Any, **kw: Any) -> Any:\r\n    189         try:\r\n--> 190             return f(*a, **kw)\r\n    191         except Py4JJavaError as e:\r\n    192             converted = convert_exception(e.java_exception)\r\n\r\n/usr/lib/spark/python/lib/py4j-0.10.9.5-src.zip/py4j/protocol.py in get_return_value(answer, gateway_client, target_id, name)\r\n    324             value = OUTPUT_CONVERTER[type](answer[2:], gateway_client)\r\n    325             if answer[1] == REFERENCE_TYPE:\r\n--> 326                 raise Py4JJavaError(\r\n    327                     \"An error occurred while calling {0}{1}{2}.\\n\".\r\n    328                     format(target_id, \".\", name), value)\r\n\r\nPy4JJavaError: An error occurred while calling o67.sql.\r\n: java.lang.UnsupportedOperationException: MERGE INTO TABLE is not supported temporarily.\r\n    at org.apache.spark.sql.errors.QueryExecutionErrors$.ddlUnsupportedTemporarilyError(QueryExecutionErrors.scala:891)\r\n    at org.apache.spark.sql.execution.SparkStrategies$BasicOperators$.apply(SparkStrategies.scala:821)\r\n    at org.apache.spark.sql.catalyst.planning.QueryPlanner.$anonfun$plan$1(QueryPlanner.scala:63)\r\n    at scala.collection.Iterator$$anon$11.nextCur(Iterator.scala:486)\r\n    at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:492)\r\n    at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:491)\r\n    at org.apache.spark.sql.catalyst.planning.QueryPlanner.plan(QueryPlanner.scala:93)\r\n    at org.apache.spark.sql.execution.SparkStrategies.plan(SparkStrategies.scala:69)\r\n    at org.apache.spark.sql.catalyst.planning.QueryPlanner.$anonfun$plan$3(QueryPlanner.scala:78)\r\n    at scala.collection.TraversableOnce$folder$1.apply(TraversableOnce.scala:196)\r\n    at scala.collection.TraversableOnce$folder$1.apply(TraversableOnce.scala:194)\r\n    at scala.collection.Iterator.foreach(Iterator.scala:943)\r\n    at scala.collection.Iterator.foreach$(Iterator.scala:943)\r\n    at scala.collection.AbstractIterator.foreach(Iterator.scala:1431)\r\n    at scala.collection.TraversableOnce.foldLeft(TraversableOnce.scala:199)\r\n    at scala.collection.TraversableOnce.foldLeft$(TraversableOnce.scala:192)\r\n    at scala.collection.AbstractIterator.foldLeft(Iterator.scala:1431)\r\n    at org.apache.spark.sql.catalyst.planning.QueryPlanner.$anonfun$plan$2(QueryPlanner.scala:75)\r\n    at scala.collection.Iterator$$anon$11.nextCur(Iterator.scala:486)\r\n    at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:492)\r\n    at org.apache.spark.sql.catalyst.planning.QueryPlanner.plan(QueryPlanner.scala:93)\r\n    at org.apache.spark.sql.execution.SparkStrategies.plan(SparkStrategies.scala:69)\r\n    at org.apache.spark.sql.execution.QueryExecution$.createSparkPlan(QueryExecution.scala:459)\r\n    at org.apache.spark.sql.execution.QueryExecution.$anonfun$sparkPlan$1(QueryExecution.scala:145)\r\n    at org.apache.spark.sql.catalyst.QueryPlanningTracker.measurePhase(QueryPlanningTracker.scala:111)\r\n    at org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$2(QueryExecution.scala:185)\r\n    at org.apache.spark.sql.execution.QueryExecution$.withInternalError(QueryExecution.scala:510)\r\n    at org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$1(QueryExecution.scala:185)\r\n    at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:779)\r\n    at org.apache.spark.sql.execution.QueryExecution.executePhase(QueryExecution.scala:184)\r\n    at org.apache.spark.sql.execution.QueryExecution.sparkPlan$lzycompute(QueryExecution.scala:145)\r\n    at org.apache.spark.sql.execution.QueryExecution.sparkPlan(QueryExecution.scala:138)\r\n    at org.apache.spark.sql.execution.QueryExecution.$anonfun$executedPlan$1(QueryExecution.scala:158)\r\n    at org.apache.spark.sql.catalyst.QueryPlanningTracker.measurePhase(QueryPlanningTracker.scala:111)\r\n    at org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$2(QueryExecution.scala:185)\r\n    at org.apache.spark.sql.execution.QueryExecution$.withInternalError(QueryExecution.scala:510)\r\n    at org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$1(QueryExecution.scala:185)\r\n    at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:779)\r\n    at org.apache.spark.sql.execution.QueryExecution.executePhase(QueryExecution.scala:184)\r\n    at org.apache.spark.sql.execution.QueryExecution.executedPlan$lzycompute(QueryExecution.scala:158)\r\n    at org.apache.spark.sql.execution.QueryExecution.executedPlan(QueryExecution.scala:151)\r\n    at org.apache.spark.sql.execution.QueryExecution.simpleString(QueryExecution.scala:204)\r\n    at org.apache.spark.sql.execution.QueryExecution.org$apache$spark$sql$execution$QueryExecution$$explainString(QueryExecution.scala:249)\r\n    at org.apache.spark.sql.execution.QueryExecution.explainString(QueryExecution.scala:218)\r\n    at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:103)\r\n    at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:169)\r\n    at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:95)\r\n    at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:779)\r\n    at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:64)\r\n    at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:98)\r\n    at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:94)\r\n    at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:584)\r\n    at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(TreeNode.scala:176)\r\n    at org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:584)\r\n    at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:30)\r\n    at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)\r\n    at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)\r\n    at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:30)\r\n    at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:30)\r\n    at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:560)\r\n    at org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:94)\r\n    at org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:81)\r\n    at org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:79)\r\n    at org.apache.spark.sql.Dataset.<init>(Dataset.scala:220)\r\n    at org.apache.spark.sql.Dataset$.$anonfun$ofRows$2(Dataset.scala:100)\r\n    at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:779)\r\n    at org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:97)\r\n    at org.apache.spark.sql.SparkSession.$anonfun$sql$1(SparkSession.scala:622)\r\n    at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:779)\r\n    at org.apache.spark.sql.SparkSession.sql(SparkSession.scala:617)\r\n    at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n    at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n    at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n    at java.base/java.lang.reflect.Method.invoke(Method.java:566)\r\n    at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\r\n    at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\r\n    at py4j.Gateway.invoke(Gateway.java:282)\r\n    at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\r\n    at py4j.commands.CallCommand.execute(CallCommand.java:79)\r\n    at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\r\n    at py4j.ClientServerConnection.run(ClientServerConnection.java:106)\r\n    at java.base/java.lang.Thread.run(Thread.java:829)\r\n```\r\nIf it helps, this is the dataproc cluster properties I included when creating the cluster:\r\n`--properties='^#^dataproc:pip.packages=google-cloud-secret-manager==2.15.0,numpy==1.24.1#spark:spark.jars=https://jdbc.postgresql.org/download/postgresql-42.5.1.jar,https://search.maven.org/remotecontent?filepath=org/apache/iceberg/iceberg-spark-runtime-3.3_2.13/1.1.0/iceberg-spark-runtime-3.3_2.13-1.1.0.jar#core:fs.defaultFS=gs://de-dev-dataproc-fs'`\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1451638558/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1451652760","html_url":"https://github.com/apache/iceberg/pull/6789#issuecomment-1451652760","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6789","id":1451652760,"node_id":"IC_kwDOCW7NX85WhnaY","user":{"login":"snazy","id":957468,"node_id":"MDQ6VXNlcjk1NzQ2OA==","avatar_url":"https://avatars.githubusercontent.com/u/957468?v=4","gravatar_id":"","url":"https://api.github.com/users/snazy","html_url":"https://github.com/snazy","followers_url":"https://api.github.com/users/snazy/followers","following_url":"https://api.github.com/users/snazy/following{/other_user}","gists_url":"https://api.github.com/users/snazy/gists{/gist_id}","starred_url":"https://api.github.com/users/snazy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/snazy/subscriptions","organizations_url":"https://api.github.com/users/snazy/orgs","repos_url":"https://api.github.com/users/snazy/repos","events_url":"https://api.github.com/users/snazy/events{/privacy}","received_events_url":"https://api.github.com/users/snazy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T10:37:10Z","updated_at":"2023-03-02T10:37:10Z","author_association":"MEMBER","body":"While the code looks technically correct, this change introduces an unnecessary extra round-trip. Usually, people work on the HEAD of a Nessie _branch_, which, for most Nessie operations, does _not_ require the client to know the HEAD's commit-ID and pass it back to the server.\r\n\r\nIMO the `NessieIcebergClient` needs to be able to handle the case of referencing the HEAD of a branch for `NessieCatalog` (and only pass the branch/tag name to the Nessie server), but be able provide an instance of `NessieIcebergClient` _with_ the expected hash / commit ID for `newTableOps`, `renameTable`, `dropTable`, etc.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1451652760/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1451735431","html_url":"https://github.com/apache/iceberg/pull/6272#issuecomment-1451735431","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6272","id":1451735431,"node_id":"IC_kwDOCW7NX85Wh7mH","user":{"login":"XN137","id":1204398,"node_id":"MDQ6VXNlcjEyMDQzOTg=","avatar_url":"https://avatars.githubusercontent.com/u/1204398?v=4","gravatar_id":"","url":"https://api.github.com/users/XN137","html_url":"https://github.com/XN137","followers_url":"https://api.github.com/users/XN137/followers","following_url":"https://api.github.com/users/XN137/following{/other_user}","gists_url":"https://api.github.com/users/XN137/gists{/gist_id}","starred_url":"https://api.github.com/users/XN137/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/XN137/subscriptions","organizations_url":"https://api.github.com/users/XN137/orgs","repos_url":"https://api.github.com/users/XN137/repos","events_url":"https://api.github.com/users/XN137/events{/privacy}","received_events_url":"https://api.github.com/users/XN137/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T11:43:45Z","updated_at":"2023-03-02T11:43:45Z","author_association":"CONTRIBUTOR","body":"only version left:\r\n```\r\nâžœ  iceberg git:(workflow-upgrade-ubuntu) rg -o --no-filename \"runs-on:.*\" .github | sort -u\r\nruns-on: ubuntu-22.04\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1451735431/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1451766906","html_url":"https://github.com/apache/iceberg/pull/6931#issuecomment-1451766906","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6931","id":1451766906,"node_id":"IC_kwDOCW7NX85WiDR6","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T12:08:59Z","updated_at":"2023-03-02T12:08:59Z","author_association":"CONTRIBUTOR","body":"Thanks @nastra for bumping this, and @singhpk234 for the review!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1451766906/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1451868392","html_url":"https://github.com/apache/iceberg/pull/6982#issuecomment-1451868392","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6982","id":1451868392,"node_id":"IC_kwDOCW7NX85WicDo","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T13:29:35Z","updated_at":"2023-03-02T13:29:35Z","author_association":"MEMBER","body":"no luck in reproducing yet!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1451868392/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1451946473","html_url":"https://github.com/apache/iceberg/issues/6978#issuecomment-1451946473","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6978","id":1451946473,"node_id":"IC_kwDOCW7NX85WivHp","user":{"login":"sungwy","id":107272191,"node_id":"U_kgDOBmTX_w","avatar_url":"https://avatars.githubusercontent.com/u/107272191?v=4","gravatar_id":"","url":"https://api.github.com/users/sungwy","html_url":"https://github.com/sungwy","followers_url":"https://api.github.com/users/sungwy/followers","following_url":"https://api.github.com/users/sungwy/following{/other_user}","gists_url":"https://api.github.com/users/sungwy/gists{/gist_id}","starred_url":"https://api.github.com/users/sungwy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sungwy/subscriptions","organizations_url":"https://api.github.com/users/sungwy/orgs","repos_url":"https://api.github.com/users/sungwy/repos","events_url":"https://api.github.com/users/sungwy/events{/privacy}","received_events_url":"https://api.github.com/users/sungwy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T14:22:24Z","updated_at":"2023-03-02T14:50:49Z","author_association":"CONTRIBUTOR","body":"Hi @nastra really appreciate you taking the time to take a look at this PR. I was a bit confused at first, and it took some time to identify the issue and relate it to schema evolution, so here's an attempt at clearing up any confusion one might have when taking a look at this issue...\r\n\r\nFirstly, my understanding is that the concept of snapshot_id is consistent between the actual iceberg table, and its corresponding state of its metadata tables that represent it at a certain point in time. Time travel on metadata tables based on the snapshot_id is actually an advertised feature of Iceberg within its [docs](https://iceberg.apache.org/docs/1.1.0/spark-queries/#time-travel-with-metadata-tables).\r\n\r\nYour observation that the schema of the filesTable didn't evolve and that that's the cause of the issue is absolutely correct. But I want to make a distinction between the schema_id of the actual iceberg table, the metadata table and their consistent snapshot_ids. Here's a table describing the timeline of events that is described by my test:\r\n\r\n| event                  | create table | add row (id, data) | add column, add row (id, data, data2) |\r\n|------------------------|--------------|--------------------|---------------------------------------|\r\n| snapshot id (random)   | 6234         | 9023               | 8234                                  |\r\n| actual table schema id | 0            | 0                  | 1                                     |\r\n| files table schema id  | 0            | 0                  | 0                                     |\r\n\r\nThe schema ID of the actual table does not change until there is schema evolution. And this is consistent with @szehon-ho 's observation that there is no issue when you try to run time travel queries on the metadata table when there is no schema evolution, even when you add an extra row and increment the snapshot ID.\r\n\r\nHowever, when the schema evolves in the actual table, because #1508 makes a strong assumption that we are only looking at the schema ID of the actual table, we are using that schema ID to read the files metadata table, instead of using the schema ID of files table at that snapshot. Interesting thing is, that we are still able to query the files table for the first two snapshots in this series of events (6234 and 9023) even after the table has evolved, because the schema IDs within that snapshot are consistent across it's actual table and its metadata tables.\r\ni.e. this issue happens on snapshots where the _schema id of the actual table_ diverges from the _schema id of the files table_","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1451946473/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1451962697","html_url":"https://github.com/apache/iceberg/issues/6978#issuecomment-1451962697","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6978","id":1451962697,"node_id":"IC_kwDOCW7NX85WizFJ","user":{"login":"sungwy","id":107272191,"node_id":"U_kgDOBmTX_w","avatar_url":"https://avatars.githubusercontent.com/u/107272191?v=4","gravatar_id":"","url":"https://api.github.com/users/sungwy","html_url":"https://github.com/sungwy","followers_url":"https://api.github.com/users/sungwy/followers","following_url":"https://api.github.com/users/sungwy/following{/other_user}","gists_url":"https://api.github.com/users/sungwy/gists{/gist_id}","starred_url":"https://api.github.com/users/sungwy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sungwy/subscriptions","organizations_url":"https://api.github.com/users/sungwy/orgs","repos_url":"https://api.github.com/users/sungwy/repos","events_url":"https://api.github.com/users/sungwy/events{/privacy}","received_events_url":"https://api.github.com/users/sungwy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T14:33:05Z","updated_at":"2023-03-02T15:04:54Z","author_association":"CONTRIBUTOR","body":"I have a couple of thoughts around what the \"correct\" fix would be for this issue... as @szehon-ho mentioned on PR #6980 it would absolutely be nice for us to be able to support looking up metadata tables using their corresponding snapshot's schema as well. \r\n\r\nFor additional context, the ability to read data using the snapshot's schema was introduced in 0.13.0 Release, which allowed users to view the actual table using the schema of the table in that point in time. This wasn't a feature that was supported for actual tables or metadata tables before. Also, the metadata table's schema can only be updated if a user operates on a specific iceberg table across multiple versions of iceberg jar. This can happen, but only happens with a clear intention to increment the infrastructure stack in a data pipeline, instead of a running pipeline consistently and passively invoking schema evolution on the table.\r\n\r\nSince this is a feature regression, I think it would be very important to put in a fix to at least make the metadata table readable upon schema evolution of the actual table by conditionally using the `icebergTable.schema()` if the table is an `instanceof BaseMetadataTable`. This will at least fix this bug and revert metadata table time travel to a useable state. And then, we can continue to look into the proper way to introduce the concept of snapshot-schema based time travel for metadata tables.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1451962697/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1452082339","html_url":"https://github.com/apache/iceberg/pull/6982#issuecomment-1452082339","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6982","id":1452082339,"node_id":"IC_kwDOCW7NX85WjQSj","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T15:44:29Z","updated_at":"2023-03-02T15:44:29Z","author_association":"MEMBER","body":"Discovered a new flaky test ðŸ¤¦ \r\nhttps://github.com/apache/iceberg/issues/6988","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1452082339/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1452099059","html_url":"https://github.com/apache/iceberg/issues/6988#issuecomment-1452099059","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6988","id":1452099059,"node_id":"IC_kwDOCW7NX85WjUXz","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T15:55:08Z","updated_at":"2023-03-02T15:55:08Z","author_association":"MEMBER","body":"cc: @nastra ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1452099059/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1452103443","html_url":"https://github.com/apache/iceberg/issues/6988#issuecomment-1452103443","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6988","id":1452103443,"node_id":"IC_kwDOCW7NX85WjVcT","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T15:57:44Z","updated_at":"2023-03-02T15:57:44Z","author_association":"MEMBER","body":"same test Failed again with a different error\r\nhttps://github.com/apache/iceberg/actions/runs/4315717107/jobs/7530487403\r\n\r\n```\r\nTestRESTCatalog > testCatalogTokenRefreshFailsAndUsesCredentialForRefresh() FAILED\r\n    Argument(s) are different! Wanted:\r\n    rESTCatalogAdapter.execute(\r\n        GET,\r\n        \"v1/namespaces/ns/tables/table\",\r\n        <any>,\r\n        <any>,\r\n        class org.apache.iceberg.rest.responses.LoadTableResponse,\r\n        {\"Authorization\" = \"***\"},\r\n        <any>\r\n    );\r\n    -> at org.apache.iceberg.rest.RESTCatalogAdapter.execute(RESTCatalogAdapter.java:374)\r\n    Actual invocations have different arguments:\r\n    rESTCatalogAdapter.postForm(\r\n        \"v1/oauth/tokens\",\r\n        {\"grant_type\" = \"client_credentials\", \"client_id\" = \"catalog\", \"client_secret\" = \"secret\", \"scope\" = \"catalog\"},\r\n        class org.apache.iceberg.rest.responses.OAuthTokenResponse,\r\n        {},\r\n        org.apache.iceberg.rest.ErrorHandlers$OAuthErrorHandler@69860811\r\n    );\r\n    -> at org.apache.iceberg.rest.auth.OAuth2Util.fetchToken(OAuth2Util.java:191)\r\n    rESTCatalogAdapter.execute(\r\n        POST,\r\n        \"v1/oauth/tokens\",\r\n        null,\r\n        {\"grant_type\" = \"client_credentials\", \"client_id\" = \"catalog\", \"client_secret\" = \"secret\", \"scope\" = \"catalog\"},\r\n        class org.apache.iceberg.rest.responses.OAuthTokenResponse,\r\n        {},\r\n        org.apache.iceberg.rest.ErrorHandlers$OAuthErrorHandler@69860811\r\n    );\r\n    -> at org.apache.iceberg.rest.RESTCatalogAdapter.postForm(RESTCatalogAdapter.java:455)\r\n    rESTCatalogAdapter.handleRequest(\r\n        TOKENS,\r\n        {},\r\n        {\"grant_type\" = \"client_credentials\", \"client_id\" = \"catalog\", \"client_secret\" = \"secret\", \"scope\" = \"catalog\"},\r\n        class org.apache.iceberg.rest.responses.OAuthTokenResponse\r\n    );\r\n    -> at org.apache.iceberg.rest.RESTCatalogAdapter.execute(RESTCatalogAdapter.java:384)\r\n    rESTCatalogAdapter.get(\r\n        \"v1/config\",\r\n        {},\r\n        class org.apache.iceberg.rest.responses.ConfigResponse,\r\n        {\"Authorization\" = \"***\"},\r\n        org.apache.iceberg.rest.ErrorHandlers$DefaultErrorHandler@3ad80206\r\n    );\r\n    -> at org.apache.iceberg.rest.RESTSessionCatalog.fetchConfig(RESTSessionCatalog.java:791)\r\n    rESTCatalogAdapter.execute(\r\n        GET,\r\n        \"v1/config\",\r\n        {},\r\n        null,\r\n        class org.apache.iceberg.rest.responses.ConfigResponse,\r\n        {\"Authorization\" = \"***\"},\r\n        org.apache.iceberg.rest.ErrorHandlers$DefaultErrorHandler@3ad80206\r\n    );\r\n    -> at org.apache.iceberg.rest.RESTCatalogAdapter.get(RESTCatalogAdapter.java:440)\r\n    rESTCatalogAdapter.handleRequest(\r\n        CONFIG,\r\n        {},\r\n        null,\r\n        class org.apache.iceberg.rest.responses.ConfigResponse\r\n    );\r\n    -> at org.apache.iceberg.rest.RESTCatalogAdapter.execute(RESTCatalogAdapter.java:384)\r\n    rESTCatalogAdapter.close(\r\n    \r\n    );\r\n    -> at org.apache.iceberg.rest.RESTSessionCatalog.initialize(RESTSessionCatalog.java:162)\r\n    rESTCatalogAdapter.postForm(\r\n        \"v1/oauth/tokens\",\r\n        {\"grant_type\" = \"urn:ietf:params:oauth:grant-type:token-exchange\", \"scope\" = \"catalog\", \"subject_token\" = \"client-credentials-token:sub=catalog\", \"subject_token_type\" = \"urn:ietf:params:oauth:token-type:access_token\"},\r\n        class org.apache.iceberg.rest.responses.OAuthTokenResponse,\r\n        {\"Authorization\" = \"***\"},\r\n        org.apache.iceberg.rest.ErrorHandlers$OAuthErrorHandler@69860811\r\n    );\r\n    -> at org.apache.iceberg.rest.auth.OAuth2Util.refreshToken(OAuth2Util.java:145)\r\n    rESTCatalogAdapter.execute(\r\n        POST,\r\n        \"v1/oauth/tokens\",\r\n        null,\r\n        {\"grant_type\" = \"urn:ietf:params:oauth:grant-type:token-exchange\", \"scope\" = \"catalog\", \"subject_token\" = \"client-credentials-token:sub=catalog\", \"subject_token_type\" = \"urn:ietf:params:oauth:token-type:access_token\"},\r\n        class org.apache.iceberg.rest.responses.OAuthTokenResponse,\r\n        {\"Authorization\" = \"***\"},\r\n        org.apache.iceberg.rest.ErrorHandlers$OAuthErrorHandler@69860811\r\n    );\r\n    -> at org.apache.iceberg.rest.RESTCatalogAdapter.postForm(RESTCatalogAdapter.java:455)\r\n    rESTCatalogAdapter.postForm(\r\n        \"v1/oauth/tokens\",\r\n        {\"grant_type\" = \"urn:ietf:params:oauth:grant-type:token-exchange\", \"scope\" = \"catalog\", \"subject_token\" = \"client-credentials-token:sub=catalog\", \"subject_token_type\" = \"urn:ietf:params:oauth:token-type:access_token\"},\r\n        class org.apache.iceberg.rest.responses.OAuthTokenResponse,\r\n        {\"Authorization\" = \"***\"},\r\n        org.apache.iceberg.rest.ErrorHandlers$OAuthErrorHandler@69860811\r\n    );\r\n    -> at org.apache.iceberg.rest.auth.OAuth2Util.refreshToken(OAuth2Util.java:145)\r\n    rESTCatalogAdapter.get(\r\n        \"v1/namespaces/ns/tables/table\",\r\n        {\"snapshots\" = \"all\"},\r\n        class org.apache.iceberg.rest.responses.LoadTableResponse,\r\n        org.apache.iceberg.rest.RESTSessionCatalog$$Lambda$800/545707113@2b4675db,\r\n        org.apache.iceberg.rest.ErrorHandlers$TableErrorHandler@1737834\r\n    );\r\n    -> at org.apache.iceberg.rest.RESTSessionCatalog.loadInternal(RESTSessionCatalog.java:[287](https://github.com/apache/iceberg/actions/runs/4315717107/jobs/7530487403#step:6:288))\r\n    rESTCatalogAdapter.execute(\r\n        POST,\r\n        \"v1/oauth/tokens\",\r\n        null,\r\n        {\"grant_type\" = \"urn:ietf:params:oauth:grant-type:token-exchange\", \"scope\" = \"catalog\", \"subject_token\" = \"client-credentials-token:sub=catalog\", \"subject_token_type\" = \"urn:ietf:params:oauth:token-type:access_token\"},\r\n        class org.apache.iceberg.rest.responses.OAuthTokenResponse,\r\n        {\"Authorization\" = \"***\"},\r\n        org.apache.iceberg.rest.ErrorHandlers$OAuthErrorHandler@69860811\r\n    );\r\n    -> at org.apache.iceberg.rest.RESTCatalogAdapter.postForm(RESTCatalogAdapter.java:455)\r\n    rESTCatalogAdapter.postForm(\r\n        \"v1/oauth/tokens\",\r\n        {\"grant_type\" = \"urn:ietf:params:oauth:grant-type:token-exchange\", \"scope\" = \"catalog\", \"subject_token\" = \"client-credentials-token:sub=catalog\", \"subject_token_type\" = \"urn:ietf:params:oauth:token-type:access_token\"},\r\n        class org.apache.iceberg.rest.responses.OAuthTokenResponse,\r\n        {\"Authorization\" = \"Basic Y2F0YWxvZzpzZWNyZXQ=\"},\r\n        org.apache.iceberg.rest.ErrorHandlers$OAuthErrorHandler@69860811\r\n    );\r\n    -> at org.apache.iceberg.rest.auth.OAuth2Util.refreshToken(OAuth2Util.java:145)\r\n    rESTCatalogAdapter.execute(\r\n        POST,\r\n        \"v1/oauth/tokens\",\r\n        null,\r\n        {\"grant_type\" = \"urn:ietf:params:oauth:grant-type:token-exchange\", \"scope\" = \"catalog\", \"subject_token\" = \"client-credentials-token:sub=catalog\", \"subject_token_type\" = \"urn:ietf:params:oauth:token-type:access_token\"},\r\n        class org.apache.iceberg.rest.responses.OAuthTokenResponse,\r\n        {\"Authorization\" = \"Basic Y2F0YWxvZzpzZWNyZXQ=\"},\r\n        org.apache.iceberg.rest.ErrorHandlers$OAuthErrorHandler@69860811\r\n    );\r\n    -> at org.apache.iceberg.rest.RESTCatalogAdapter.postForm(RESTCatalogAdapter.java:455)\r\n    rESTCatalogAdapter.get(\r\n        \"v1/namespaces/ns/tables/table\",\r\n        {\"snapshots\" = \"all\"},\r\n        class org.apache.iceberg.rest.responses.LoadTableResponse,\r\n        {\"Authorization\" = \"***\"},\r\n        org.apache.iceberg.rest.ErrorHandlers$TableErrorHandler@1737834\r\n    );\r\n    -> at org.apache.iceberg.rest.RESTClient.get(RESTClient.java:96)\r\n    rESTCatalogAdapter.execute(\r\n        GET,\r\n        \"v1/namespaces/ns/tables/table\",\r\n        {\"snapshots\" = \"all\"},\r\n        null,\r\n        class org.apache.iceberg.rest.responses.LoadTableResponse,\r\n        {\"Authorization\" = \"***\"},\r\n        org.apache.iceberg.rest.ErrorHandlers$TableErrorHandler@1737834\r\n    );\r\n    -> at org.apache.iceberg.rest.RESTCatalogAdapter.get(RESTCatalogAdapter.java:440)\r\n    rESTCatalogAdapter.handleRequest(\r\n        LOAD_TABLE,\r\n        {\"snapshots\" = \"all\", \"namespace\" = \"ns\", \"table\" = \"table\"},\r\n        null,\r\n        class org.apache.iceberg.rest.responses.LoadTableResponse\r\n    );\r\n    -> at org.apache.iceberg.rest.RESTCatalogAdapter.execute(RESTCatalogAdapter.java:384)\r\n    rESTCatalogAdapter.handleRequest(\r\n        TOKENS,\r\n        {},\r\n        {\"grant_type\" = \"urn:ietf:params:oauth:grant-type:token-exchange\", \"scope\" = \"catalog\", \"subject_token\" = \"client-credentials-token:sub=catalog\", \"subject_token_type\" = \"urn:ietf:params:oauth:token-type:access_token\"},\r\n        class org.apache.iceberg.rest.responses.OAuthTokenResponse\r\n    );\r\n    -> at org.apache.iceberg.rest.RESTCatalogAdapter.execute(RESTCatalogAdapter.java:384)\r\n        at org.apache.iceberg.rest.RESTCatalogAdapter.execute(RESTCatalogAdapter.java:[374](https://github.com/apache/iceberg/actions/runs/4315717107/jobs/7530487403#step:6:375))\r\n        at org.apache.iceberg.rest.TestRESTCatalog.testCatalogTokenRefreshFailsAndUsesCredentialForRefresh(TestRESTCatalog.java:1523)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1452103443/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1452169417","html_url":"https://github.com/apache/iceberg/pull/6682#issuecomment-1452169417","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6682","id":1452169417,"node_id":"IC_kwDOCW7NX85WjljJ","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T16:34:56Z","updated_at":"2023-03-02T16:34:56Z","author_association":"MEMBER","body":"Thanks @amogh-jahagirdar , @dramaticlly  and @aokolnychyi I'll merge when tests pass. I'll do the Backport Pr's after my subsurface talk.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1452169417/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1452248263","html_url":"https://github.com/apache/iceberg/pull/3450#issuecomment-1452248263","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3450","id":1452248263,"node_id":"IC_kwDOCW7NX85Wj4zH","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T17:29:49Z","updated_at":"2023-03-02T17:29:49Z","author_association":"CONTRIBUTOR","body":"@jun-he I'll close this one if you don't mind :)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1452248263/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1452284032","html_url":"https://github.com/apache/iceberg/pull/6981#issuecomment-1452284032","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6981","id":1452284032,"node_id":"IC_kwDOCW7NX85WkBiA","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T17:54:27Z","updated_at":"2023-03-02T17:54:27Z","author_association":"CONTRIBUTOR","body":"cc @rdblue @aokolnychyi ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1452284032/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1452388434","html_url":"https://github.com/apache/iceberg/pull/6977#issuecomment-1452388434","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6977","id":1452388434,"node_id":"IC_kwDOCW7NX85WkbBS","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T18:52:09Z","updated_at":"2023-03-02T18:52:09Z","author_association":"CONTRIBUTOR","body":"> Should we also remove the usage of `AssertHelpers`? Could be a separate PR.\r\n\r\nThat would be ideal in the long run, but the diff will be quite big, because it's being used at lots of places. At the very least I think we can start and not use it in new tests.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1452388434/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1452429305","html_url":"https://github.com/apache/iceberg/issues/6978#issuecomment-1452429305","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6978","id":1452429305,"node_id":"IC_kwDOCW7NX85Wkk_5","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T19:20:31Z","updated_at":"2023-03-02T19:22:09Z","author_association":"COLLABORATOR","body":"yea i agree with @syun64 , time travel for metadata tables is quite useful.  For example, we can today query files table as of some timestamp, and it will return files of that timestamp.  Same for other metadata.\r\n\r\nThe problem comes from https://github.com/apache/iceberg/pull/1508 which for all time-travel, attempt to apply the schema at that time.  While its a good idea, its just not supported yet for metadata tables, as they have dont have concept of historical schemas, though I feel they could.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1452429305/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1452438965","html_url":"https://github.com/apache/iceberg/pull/6955#issuecomment-1452438965","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6955","id":1452438965,"node_id":"IC_kwDOCW7NX85WknW1","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T19:29:53Z","updated_at":"2023-03-02T19:30:12Z","author_association":"COLLABORATOR","body":"Approve for workflow run, cc @haizhou-zhao to take a look","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1452438965/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1452443545","html_url":"https://github.com/apache/iceberg/pull/6955#issuecomment-1452443545","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6955","id":1452443545,"node_id":"IC_kwDOCW7NX85WkoeZ","user":{"login":"haizhou-zhao","id":6187287,"node_id":"MDQ6VXNlcjYxODcyODc=","avatar_url":"https://avatars.githubusercontent.com/u/6187287?v=4","gravatar_id":"","url":"https://api.github.com/users/haizhou-zhao","html_url":"https://github.com/haizhou-zhao","followers_url":"https://api.github.com/users/haizhou-zhao/followers","following_url":"https://api.github.com/users/haizhou-zhao/following{/other_user}","gists_url":"https://api.github.com/users/haizhou-zhao/gists{/gist_id}","starred_url":"https://api.github.com/users/haizhou-zhao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/haizhou-zhao/subscriptions","organizations_url":"https://api.github.com/users/haizhou-zhao/orgs","repos_url":"https://api.github.com/users/haizhou-zhao/repos","events_url":"https://api.github.com/users/haizhou-zhao/events{/privacy}","received_events_url":"https://api.github.com/users/haizhou-zhao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T19:34:22Z","updated_at":"2023-03-02T19:34:22Z","author_association":"CONTRIBUTOR","body":"looks good to me. thanks @zhouyifan279 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1452443545/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1452605481","html_url":"https://github.com/apache/iceberg/pull/6849#issuecomment-1452605481","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6849","id":1452605481,"node_id":"IC_kwDOCW7NX85WlQAp","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T21:58:52Z","updated_at":"2023-03-02T21:58:52Z","author_association":"COLLABORATOR","body":"Merged, thanks @dramaticlly ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1452605481/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":1,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1452654261","html_url":"https://github.com/apache/iceberg/pull/6980#issuecomment-1452654261","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6980","id":1452654261,"node_id":"IC_kwDOCW7NX85Wlb61","user":{"login":"sungwy","id":107272191,"node_id":"U_kgDOBmTX_w","avatar_url":"https://avatars.githubusercontent.com/u/107272191?v=4","gravatar_id":"","url":"https://api.github.com/users/sungwy","html_url":"https://github.com/sungwy","followers_url":"https://api.github.com/users/sungwy/followers","following_url":"https://api.github.com/users/sungwy/following{/other_user}","gists_url":"https://api.github.com/users/sungwy/gists{/gist_id}","starred_url":"https://api.github.com/users/sungwy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sungwy/subscriptions","organizations_url":"https://api.github.com/users/sungwy/orgs","repos_url":"https://api.github.com/users/sungwy/repos","events_url":"https://api.github.com/users/sungwy/events{/privacy}","received_events_url":"https://api.github.com/users/sungwy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T22:35:16Z","updated_at":"2023-03-02T22:35:16Z","author_association":"CONTRIBUTOR","body":"@szehon-ho I think that should cover all of the requested changes.. Please let me know if this is good to approve! Since this is a pretty important bug fix, I'm hoping we could slot it in for the next release...\r\nI can create ones for Spark-3.2 and Spark-3.1 once you sign off on this PR","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1452654261/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1452668054","html_url":"https://github.com/apache/iceberg/pull/6980#issuecomment-1452668054","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6980","id":1452668054,"node_id":"IC_kwDOCW7NX85WlfSW","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T22:45:51Z","updated_at":"2023-03-02T22:48:02Z","author_association":"COLLABORATOR","body":"Makes sense, I added it to Iceberg 1.2 milestone.  I made a follow up issue to implement this feature for some tables that will be affected , like files table.  https://github.com/apache/iceberg/issues/6991.\r\n\r\nAs other reviewers also commented, so will leave a chance for them to take another look.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1452668054/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1452744278","html_url":"https://github.com/apache/iceberg/pull/6513#issuecomment-1452744278","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6513","id":1452744278,"node_id":"IC_kwDOCW7NX85Wlx5W","user":{"login":"fqaiser94","id":20507243,"node_id":"MDQ6VXNlcjIwNTA3MjQz","avatar_url":"https://avatars.githubusercontent.com/u/20507243?v=4","gravatar_id":"","url":"https://api.github.com/users/fqaiser94","html_url":"https://github.com/fqaiser94","followers_url":"https://api.github.com/users/fqaiser94/followers","following_url":"https://api.github.com/users/fqaiser94/following{/other_user}","gists_url":"https://api.github.com/users/fqaiser94/gists{/gist_id}","starred_url":"https://api.github.com/users/fqaiser94/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fqaiser94/subscriptions","organizations_url":"https://api.github.com/users/fqaiser94/orgs","repos_url":"https://api.github.com/users/fqaiser94/repos","events_url":"https://api.github.com/users/fqaiser94/events{/privacy}","received_events_url":"https://api.github.com/users/fqaiser94/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T23:58:00Z","updated_at":"2023-03-02T23:58:00Z","author_association":"CONTRIBUTOR","body":"All comments have been addressed. \r\nThis is now ready for a second round of reviews. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1452744278/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1452747850","html_url":"https://github.com/apache/iceberg/pull/6513#issuecomment-1452747850","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6513","id":1452747850,"node_id":"IC_kwDOCW7NX85WlyxK","user":{"login":"fqaiser94","id":20507243,"node_id":"MDQ6VXNlcjIwNTA3MjQz","avatar_url":"https://avatars.githubusercontent.com/u/20507243?v=4","gravatar_id":"","url":"https://api.github.com/users/fqaiser94","html_url":"https://github.com/fqaiser94","followers_url":"https://api.github.com/users/fqaiser94/followers","following_url":"https://api.github.com/users/fqaiser94/following{/other_user}","gists_url":"https://api.github.com/users/fqaiser94/gists{/gist_id}","starred_url":"https://api.github.com/users/fqaiser94/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fqaiser94/subscriptions","organizations_url":"https://api.github.com/users/fqaiser94/orgs","repos_url":"https://api.github.com/users/fqaiser94/repos","events_url":"https://api.github.com/users/fqaiser94/events{/privacy}","received_events_url":"https://api.github.com/users/fqaiser94/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-03T00:02:25Z","updated_at":"2023-03-03T00:12:07Z","author_association":"CONTRIBUTOR","body":"Sorry @nastra @jackye1995, I didn't mean to remove you both as reviewers.\r\nFor some reason, the UI won't even let me add you folks back as reviewers ðŸ˜µâ€ðŸ’« \r\nPlease feel free to add yourselves back as reviewers.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1452747850/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1452804397","html_url":"https://github.com/apache/iceberg/pull/6987#issuecomment-1452804397","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6987","id":1452804397,"node_id":"IC_kwDOCW7NX85WmAkt","user":{"login":"slfan1989","id":55643692,"node_id":"MDQ6VXNlcjU1NjQzNjky","avatar_url":"https://avatars.githubusercontent.com/u/55643692?v=4","gravatar_id":"","url":"https://api.github.com/users/slfan1989","html_url":"https://github.com/slfan1989","followers_url":"https://api.github.com/users/slfan1989/followers","following_url":"https://api.github.com/users/slfan1989/following{/other_user}","gists_url":"https://api.github.com/users/slfan1989/gists{/gist_id}","starred_url":"https://api.github.com/users/slfan1989/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/slfan1989/subscriptions","organizations_url":"https://api.github.com/users/slfan1989/orgs","repos_url":"https://api.github.com/users/slfan1989/repos","events_url":"https://api.github.com/users/slfan1989/events{/privacy}","received_events_url":"https://api.github.com/users/slfan1989/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-03T01:30:00Z","updated_at":"2023-03-03T01:30:00Z","author_association":"CONTRIBUTOR","body":"@stevenzwu Can you help review this pr? Thank you very much!\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1452804397/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1452820853","html_url":"https://github.com/apache/iceberg/issues/5538#issuecomment-1452820853","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5538","id":1452820853,"node_id":"IC_kwDOCW7NX85WmEl1","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-03-03T01:52:04Z","updated_at":"2023-03-03T01:52:04Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1452820853/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1452820876","html_url":"https://github.com/apache/iceberg/issues/5527#issuecomment-1452820876","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5527","id":1452820876,"node_id":"IC_kwDOCW7NX85WmEmM","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-03-03T01:52:06Z","updated_at":"2023-03-03T01:52:06Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1452820876/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1452838544","html_url":"https://github.com/apache/iceberg/pull/6993#issuecomment-1452838544","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6993","id":1452838544,"node_id":"IC_kwDOCW7NX85WmI6Q","user":{"login":"sungwy","id":107272191,"node_id":"U_kgDOBmTX_w","avatar_url":"https://avatars.githubusercontent.com/u/107272191?v=4","gravatar_id":"","url":"https://api.github.com/users/sungwy","html_url":"https://github.com/sungwy","followers_url":"https://api.github.com/users/sungwy/followers","following_url":"https://api.github.com/users/sungwy/following{/other_user}","gists_url":"https://api.github.com/users/sungwy/gists{/gist_id}","starred_url":"https://api.github.com/users/sungwy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sungwy/subscriptions","organizations_url":"https://api.github.com/users/sungwy/orgs","repos_url":"https://api.github.com/users/sungwy/repos","events_url":"https://api.github.com/users/sungwy/events{/privacy}","received_events_url":"https://api.github.com/users/sungwy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-03T02:06:59Z","updated_at":"2023-03-03T02:06:59Z","author_association":"CONTRIBUTOR","body":"@szehon-ho may I ask you for a review on this one as well?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1452838544/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1452854677","html_url":"https://github.com/apache/iceberg/pull/6994#issuecomment-1452854677","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6994","id":1452854677,"node_id":"IC_kwDOCW7NX85WmM2V","user":{"login":"sungwy","id":107272191,"node_id":"U_kgDOBmTX_w","avatar_url":"https://avatars.githubusercontent.com/u/107272191?v=4","gravatar_id":"","url":"https://api.github.com/users/sungwy","html_url":"https://github.com/sungwy","followers_url":"https://api.github.com/users/sungwy/followers","following_url":"https://api.github.com/users/sungwy/following{/other_user}","gists_url":"https://api.github.com/users/sungwy/gists{/gist_id}","starred_url":"https://api.github.com/users/sungwy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sungwy/subscriptions","organizations_url":"https://api.github.com/users/sungwy/orgs","repos_url":"https://api.github.com/users/sungwy/repos","events_url":"https://api.github.com/users/sungwy/events{/privacy}","received_events_url":"https://api.github.com/users/sungwy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-03T02:19:17Z","updated_at":"2023-03-03T02:19:17Z","author_association":"CONTRIBUTOR","body":"@szehon-ho may I ask you for a review on this one as well? This one is thankfully almost identical to its 3.3 equivalent - I'm hoping that makes it easier for you to review!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1452854677/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1452913391","html_url":"https://github.com/apache/iceberg/issues/6853#issuecomment-1452913391","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6853","id":1452913391,"node_id":"IC_kwDOCW7NX85WmbLv","user":{"login":"youngxinler","id":36697727,"node_id":"MDQ6VXNlcjM2Njk3NzI3","avatar_url":"https://avatars.githubusercontent.com/u/36697727?v=4","gravatar_id":"","url":"https://api.github.com/users/youngxinler","html_url":"https://github.com/youngxinler","followers_url":"https://api.github.com/users/youngxinler/followers","following_url":"https://api.github.com/users/youngxinler/following{/other_user}","gists_url":"https://api.github.com/users/youngxinler/gists{/gist_id}","starred_url":"https://api.github.com/users/youngxinler/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/youngxinler/subscriptions","organizations_url":"https://api.github.com/users/youngxinler/orgs","repos_url":"https://api.github.com/users/youngxinler/repos","events_url":"https://api.github.com/users/youngxinler/events{/privacy}","received_events_url":"https://api.github.com/users/youngxinler/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-03T03:35:56Z","updated_at":"2023-03-03T03:35:56Z","author_association":"CONTRIBUTOR","body":">My question is; if we couldn't make use of year or month values directly while querying, then whats the point of creating partitions on those segments? Honestly would like to know, when and how it would be leveraged/actually used.\r\n\r\nIMO: partitions on those segments is useful,  it also works on partition query to filter files,  I also think that when using date equality comparison, the format should be converted first, otherwise the equal condition will cause ambiguity,  it's better that should use from_unixtime(ts / 1000, 'YYYY') = '2021' or cast(ts as date) = '20210101'  to get equal date data.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1452913391/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1452979642","html_url":"https://github.com/apache/iceberg/pull/6965#issuecomment-1452979642","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6965","id":1452979642,"node_id":"IC_kwDOCW7NX85WmrW6","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-03T05:05:33Z","updated_at":"2023-03-03T05:05:33Z","author_association":"CONTRIBUTOR","body":"I can get to this PR on Monday.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1452979642/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1452992870","html_url":"https://github.com/apache/iceberg/pull/6982#issuecomment-1452992870","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6982","id":1452992870,"node_id":"IC_kwDOCW7NX85Wmulm","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-03T05:22:40Z","updated_at":"2023-03-03T05:22:40Z","author_association":"MEMBER","body":"I rebased and pushed to this branch when the PR was closed. So, I can't reopen the PR. will open a new PR again to debug this. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1452992870/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1453015813","html_url":"https://github.com/apache/iceberg/issues/6505#issuecomment-1453015813","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6505","id":1453015813,"node_id":"IC_kwDOCW7NX85Wm0MF","user":{"login":"JonasJ-ap","id":55990951,"node_id":"MDQ6VXNlcjU1OTkwOTUx","avatar_url":"https://avatars.githubusercontent.com/u/55990951?v=4","gravatar_id":"","url":"https://api.github.com/users/JonasJ-ap","html_url":"https://github.com/JonasJ-ap","followers_url":"https://api.github.com/users/JonasJ-ap/followers","following_url":"https://api.github.com/users/JonasJ-ap/following{/other_user}","gists_url":"https://api.github.com/users/JonasJ-ap/gists{/gist_id}","starred_url":"https://api.github.com/users/JonasJ-ap/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JonasJ-ap/subscriptions","organizations_url":"https://api.github.com/users/JonasJ-ap/orgs","repos_url":"https://api.github.com/users/JonasJ-ap/repos","events_url":"https://api.github.com/users/JonasJ-ap/events{/privacy}","received_events_url":"https://api.github.com/users/JonasJ-ap/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-03T05:58:02Z","updated_at":"2023-03-03T05:58:02Z","author_association":"CONTRIBUTOR","body":"I created a draft PR #6997 containing a raw visitor to support inferring iceberg schema and verified that the new feature could solve the problem described above and in #6647. @amogh-jahagirdar Please let me know if you are working on this or still interested in picking this up. I am willing to re-pick this issue if you do not have enough time.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1453015813/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1453092256","html_url":"https://github.com/apache/iceberg/issues/6303#issuecomment-1453092256","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6303","id":1453092256,"node_id":"IC_kwDOCW7NX85WnG2g","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-03T07:25:10Z","updated_at":"2023-03-03T07:25:10Z","author_association":"CONTRIBUTOR","body":"Great design! I think we can continue adding new issues so that guys can choose the tasks they want to work on.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1453092256/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1453166224","html_url":"https://github.com/apache/iceberg/issues/6505#issuecomment-1453166224","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6505","id":1453166224,"node_id":"IC_kwDOCW7NX85WnY6Q","user":{"login":"bigluck","id":1511095,"node_id":"MDQ6VXNlcjE1MTEwOTU=","avatar_url":"https://avatars.githubusercontent.com/u/1511095?v=4","gravatar_id":"","url":"https://api.github.com/users/bigluck","html_url":"https://github.com/bigluck","followers_url":"https://api.github.com/users/bigluck/followers","following_url":"https://api.github.com/users/bigluck/following{/other_user}","gists_url":"https://api.github.com/users/bigluck/gists{/gist_id}","starred_url":"https://api.github.com/users/bigluck/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bigluck/subscriptions","organizations_url":"https://api.github.com/users/bigluck/orgs","repos_url":"https://api.github.com/users/bigluck/repos","events_url":"https://api.github.com/users/bigluck/events{/privacy}","received_events_url":"https://api.github.com/users/bigluck/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-03T08:38:48Z","updated_at":"2023-03-03T08:38:48Z","author_association":"NONE","body":"Ciao @Fokko, maybe I'm facing a similar issue, but I'm a bit confused.\r\nI'm using Glue and I'm querying an iceberg table created with Dremio.\r\n\r\nThe table in question derives from the open dataset of NY taxis.\r\n\r\n```python\r\nimport os\r\nfrom pyiceberg.catalog import load_glue\r\n\r\ncatalog = load_glue(name='biglake', conf={})\r\ntable = catalog.load_table('biglake.taxi_dremio_by_month')\r\n\r\nprint(table.identifier)\r\nprint(table.metadata)\r\nprint(table.metadata_location)\r\n\r\ncon = table.scan().to_duckdb(table_name='taxi')\r\nprint(con.execute('SELECT COUNT(*) FROM taxi').fetchall())\r\n```\r\n\r\nThis is the output:\r\n\r\n```\r\n('biglake', 'taxi_dremio_by_month')\r\n\r\nlocation='s3://my-s3-bucket/biglake/taxi_dremio_by_month'\r\ntable_uuid=UUID('80a4d129-4919-4b2a-8784-ec845a853130')\r\nlast_updated_ms=1677495898549\r\nlast_column_id=24\r\nschemas=[\r\n\tSchema(\r\n\t\tNestedField(field_id=1, name='hvfhs_license_num', field_type=StringType(), required=False),\r\n\t\tNestedField(field_id=2, name='dispatching_base_num', field_type=StringType(), required=False),\r\n\t\tNestedField(field_id=3, name='originating_base_num', field_type=StringType(), required=False),\r\n\t\tNestedField(field_id=4, name='request_datetime', field_type=TimestamptzType(), required=False),\r\n\t\tNestedField(field_id=5, name='on_scene_datetime', field_type=TimestamptzType(), required=False),\r\n\t\tNestedField(field_id=6, name='pickup_datetime', field_type=TimestamptzType(), required=False),\r\n\t\tNestedField(field_id=7, name='dropoff_datetime', field_type=TimestamptzType(), required=False),\r\n\t\tNestedField(field_id=8, name='PULocationID', field_type=LongType(), required=False),\r\n\t\tNestedField(field_id=9, name='DOLocationID', field_type=LongType(), required=False),\r\n\t\tNestedField(field_id=10, name='trip_miles', field_type=DoubleType(), required=False),\r\n\t\tNestedField(field_id=11, name='trip_time', field_type=LongType(), required=False),\r\n\t\tNestedField(field_id=12, name='base_passenger_fare', field_type=DoubleType(), required=False),\r\n\t\tNestedField(field_id=13, name='tolls', field_type=DoubleType(), required=False),\r\n\t\tNestedField(field_id=14, name='bcf', field_type=DoubleType(), required=False),\r\n\t\tNestedField(field_id=15, name='sales_tax', field_type=DoubleType(), required=False),\r\n\t\tNestedField(field_id=16, name='congestion_surcharge', field_type=DoubleType(), required=False),\r\n\t\tNestedField(field_id=17, name='airport_fee', field_type=IntegerType(), required=False),\r\n\t\tNestedField(field_id=18, name='tips', field_type=DoubleType(), required=False),\r\n\t\tNestedField(field_id=19, name='driver_pay', field_type=DoubleType(), required=False),\r\n\t\tNestedField(field_id=20, name='shared_request_flag', field_type=StringType(), required=False),\r\n\t\tNestedField(field_id=21, name='shared_match_flag', field_type=StringType(), required=False),\r\n\t\tNestedField(field_id=22, name='access_a_ride_flag', field_type=StringType(), required=False),\r\n\t\tNestedField(field_id=23, name='wav_request_flag', field_type=StringType(), required=False),\r\n\t\tNestedField(field_id=24, name='wav_match_flag', field_type=StringType(), required=False),\r\n\t\tschema_id=0,\r\n\t\tidentifier_field_ids=[]\r\n\t)\r\n]\r\ncurrent_schema_id=0\r\npartition_specs=[\r\n\tPartitionSpec(\r\n\t\tPartitionField(source_id=4, field_id=1000, transform=MonthTransform(), name='request_datetime_month'),\r\n\t\tspec_id=0\r\n\t)\r\n]\r\ndefault_spec_id=0\r\nlast_partition_id=1000\r\nproperties={\r\n\t'compatibility.snapshot-id-inheritance.enabled': 'true',\r\n\t'commit.manifest.target-size-bytes': '153600'\r\n}\r\ncurrent_snapshot_id=666682962113515828\r\nsnapshots=[\r\n\tSnapshot(\r\n\t\tsnapshot_id=666682962113515828,\r\n\t\tparent_snapshot_id=None,\r\n\t\tsequence_number=None,\r\n\t\ttimestamp_ms=1677495898549,\r\n\t\tmanifest_list='s3://my-s3-bucket/biglake/taxi_dremio_by_month/metadata/snap-666682962113515828-1-133eb191-5a2e-43da-a773-9f87eeb6b495.avro',\r\n\t\tsummary=Summary(\r\n\t\t\tOperation.APPEND, **{\r\n\t\t\t\t'added-data-files': '260',\r\n\t\t\t\t'added-records': '745287023',\r\n\t\t\t\t'total-records': '745287023',\r\n\t\t\t\t'total-files-size': '0',\r\n\t\t\t\t'total-data-files': '260',\r\n\t\t\t\t'total-delete-files': '0',\r\n\t\t\t\t'total-position-deletes': '0',\r\n\t\t\t\t'total-equality-deletes': '0'\r\n\t\t\t}\r\n\t\t),\r\n\t\tschema_id=0\r\n\t)\r\n]\r\nsnapshot_log=[\r\n\tSnapshotLogEntry(\r\n\t\tsnapshot_id='666682962113515828',\r\n\t\ttimestamp_ms=1677495898549\r\n\t)\r\n]\r\nmetadata_log=[]\r\nsort_orders=[SortOrder(order_id=0)]\r\ndefault_sort_order_id=0\r\nrefs={\r\n\t'main': SnapshotRef(\r\n\t\tsnapshot_id=666682962113515828,\r\n\t\tsnapshot_ref_type=SnapshotRefType.BRANCH,\r\n\t\tmin_snapshots_to_keep=None,\r\n\t\tmax_snapshot_age_ms=None,\r\n\t\tmax_ref_age_ms=None\r\n\t)\r\n}\r\nformat_version=1\r\nschema_=Schema(\r\n\tNestedField(field_id=1, name='hvfhs_license_num', field_type=StringType(), required=False),\r\n\tNestedField(field_id=2, name='dispatching_base_num', field_type=StringType(), required=False),\r\n\tNestedField(field_id=3, name='originating_base_num', field_type=StringType(), required=False),\r\n\tNestedField(field_id=4, name='request_datetime', field_type=TimestamptzType(), required=False),\r\n\tNestedField(field_id=5, name='on_scene_datetime', field_type=TimestamptzType(), required=False),\r\n\tNestedField(field_id=6, name='pickup_datetime', field_type=TimestamptzType(), required=False),\r\n\tNestedField(field_id=7, name='dropoff_datetime', field_type=TimestamptzType(), required=False),\r\n\tNestedField(field_id=8, name='PULocationID', field_type=LongType(), required=False),\r\n\tNestedField(field_id=9, name='DOLocationID', field_type=LongType(), required=False),\r\n\tNestedField(field_id=10, name='trip_miles', field_type=DoubleType(), required=False),\r\n\tNestedField(field_id=11, name='trip_time', field_type=LongType(), required=False),\r\n\tNestedField(field_id=12, name='base_passenger_fare', field_type=DoubleType(), required=False),\r\n\tNestedField(field_id=13, name='tolls', field_type=DoubleType(), required=False),\r\n\tNestedField(field_id=14, name='bcf', field_type=DoubleType(), required=False),\r\n\tNestedField(field_id=15, name='sales_tax', field_type=DoubleType(), required=False),\r\n\tNestedField(field_id=16, name='congestion_surcharge', field_type=DoubleType(), required=False),\r\n\tNestedField(field_id=17, name='airport_fee', field_type=IntegerType(), required=False),\r\n\tNestedField(field_id=18, name='tips', field_type=DoubleType(), required=False),\r\n\tNestedField(field_id=19, name='driver_pay', field_type=DoubleType(), required=False),\r\n\tNestedField(field_id=20, name='shared_request_flag', field_type=StringType(), required=False),\r\n\tNestedField(field_id=21, name='shared_match_flag', field_type=StringType(), required=False),\r\n\tNestedField(field_id=22, name='access_a_ride_flag', field_type=StringType(), required=False),\r\n\tNestedField(field_id=23, name='wav_request_flag', field_type=StringType(), required=False),\r\n\tNestedField(field_id=24, name='wav_match_flag', field_type=StringType(), required=False),\r\n\tschema_id=0,\r\n\tidentifier_field_ids=[]\r\n)\r\npartition_spec=[\r\n\t{\r\n\t\t'name': 'request_datetime_month',\r\n\t\t'transform': 'month',\r\n\t\t'source-id': 4,\r\n\t\t'field-id': 1000\r\n\t}\r\n]\r\n\r\ns3://my-s3-bucket/biglake/taxi_dremio_by_month/metadata/00000-2cf6fb41-1c37-4e7c-a35b-3ab1c4670b45.metadata.json\r\n```\r\n\r\nAnd then it crashes:\r\n```\r\nTraceback (most recent call last):\r\n  File \"/home/ubuntu/src/query.py\", line 17, in <module>\r\n    con = table.scan().to_duckdb(table_name='taxi')\r\n  File \"/home/ubuntu/src/.venv/lib/python3.10/site-packages/pyiceberg/table/__init__.py\", line 360, in to_duckdb\r\n    con.register(table_name, self.to_arrow())\r\n  File \"/home/ubuntu/src/.venv/lib/python3.10/site-packages/pyiceberg/table/__init__.py\", line 349, in to_arrow\r\n    return project_table(\r\n  File \"/home/ubuntu/src/.venv/lib/python3.10/site-packages/pyiceberg/io/pyarrow.py\", line 552, in project_table\r\n    tables = pool.starmap(\r\n  File \"/usr/lib/python3.10/multiprocessing/pool.py\", line 375, in starmap\r\n    return self._map_async(func, iterable, starmapstar, chunksize).get()\r\n  File \"/usr/lib/python3.10/multiprocessing/pool.py\", line 774, in get\r\n    raise self._value\r\n  File \"/usr/lib/python3.10/multiprocessing/pool.py\", line 125, in worker\r\n    result = (True, func(*args, **kwds))\r\n  File \"/usr/lib/python3.10/multiprocessing/pool.py\", line 51, in starmapstar\r\n    return list(itertools.starmap(args[0], args[1]))\r\n  File \"/home/ubuntu/src/.venv/lib/python3.10/site-packages/pyiceberg/io/pyarrow.py\", line 491, in _file_to_table\r\n    raise ValueError(\r\nValueError: Iceberg schema is not embedded into the Parquet file, see https://github.com/apache/iceberg/issues/6505\r\n```\r\n\r\nI'm confused because the query is a simple `COUNT(*)`, and I thought pyiceber would read the metadata stored on the metadata folder to get the number of records.\r\n\r\n<img width=\"1336\" alt=\"Screenshot 2023-03-03 at 09 31 39\" src=\"https://user-images.githubusercontent.com/1511095/222671001-9cbdd901-3a7e-4b80-a8a5-385aa1f34653.png\">\r\n\r\nI've also tested PR #6997, but the python operator crashed:\r\n\r\n```\r\ns3://my-s3-bucket/biglake/taxi_dremio_by_month/metadata/00000-2cf6fb41-1c37-4e7c-a35b-3ab1c4670b45.metadata.json\r\nKilled\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1453166224/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":1},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1453177072","html_url":"https://github.com/apache/iceberg/issues/2586#issuecomment-1453177072","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2586","id":1453177072,"node_id":"IC_kwDOCW7NX85Wnbjw","user":{"login":"badbye","id":3295865,"node_id":"MDQ6VXNlcjMyOTU4NjU=","avatar_url":"https://avatars.githubusercontent.com/u/3295865?v=4","gravatar_id":"","url":"https://api.github.com/users/badbye","html_url":"https://github.com/badbye","followers_url":"https://api.github.com/users/badbye/followers","following_url":"https://api.github.com/users/badbye/following{/other_user}","gists_url":"https://api.github.com/users/badbye/gists{/gist_id}","starred_url":"https://api.github.com/users/badbye/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/badbye/subscriptions","organizations_url":"https://api.github.com/users/badbye/orgs","repos_url":"https://api.github.com/users/badbye/repos","events_url":"https://api.github.com/users/badbye/events{/privacy}","received_events_url":"https://api.github.com/users/badbye/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-03T08:48:14Z","updated_at":"2023-03-03T08:48:14Z","author_association":"NONE","body":"Hi @x-malet @tpolong @kbendick ,  we have developed a project named GeoLake. You can try it in this docker environment: https://github.com/spatialx-project/docker-spark-geolake\r\n\r\nwe will release our code soon in this repo: https://github.com/spatialx-project/geolake. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1453177072/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1453177507","html_url":"https://github.com/apache/iceberg/issues/2586#issuecomment-1453177507","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2586","id":1453177507,"node_id":"IC_kwDOCW7NX85Wnbqj","user":{"login":"tpolong","id":13393721,"node_id":"MDQ6VXNlcjEzMzkzNzIx","avatar_url":"https://avatars.githubusercontent.com/u/13393721?v=4","gravatar_id":"","url":"https://api.github.com/users/tpolong","html_url":"https://github.com/tpolong","followers_url":"https://api.github.com/users/tpolong/followers","following_url":"https://api.github.com/users/tpolong/following{/other_user}","gists_url":"https://api.github.com/users/tpolong/gists{/gist_id}","starred_url":"https://api.github.com/users/tpolong/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tpolong/subscriptions","organizations_url":"https://api.github.com/users/tpolong/orgs","repos_url":"https://api.github.com/users/tpolong/repos","events_url":"https://api.github.com/users/tpolong/events{/privacy}","received_events_url":"https://api.github.com/users/tpolong/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-03T08:48:37Z","updated_at":"2023-03-03T08:48:37Z","author_association":"NONE","body":"æ‚¨å¥½ï¼Œæ‚¨çš„é‚®ä»¶å·²æ”¶åˆ°ï¼Œè°¢è°¢ï¼","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1453177507/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1453302730","html_url":"https://github.com/apache/iceberg/pull/6382#issuecomment-1453302730","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6382","id":1453302730,"node_id":"IC_kwDOCW7NX85Wn6PK","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-03T10:25:22Z","updated_at":"2023-03-03T10:27:19Z","author_association":"CONTRIBUTOR","body":"Left some comments, and I will think about them more deeply in the next few days. Thank you.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1453302730/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1453357137","html_url":"https://github.com/apache/iceberg/issues/6505#issuecomment-1453357137","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6505","id":1453357137,"node_id":"IC_kwDOCW7NX85WoHhR","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-03T11:02:31Z","updated_at":"2023-03-03T11:02:31Z","author_association":"CONTRIBUTOR","body":"@bigluck Thanks for giving it a try.\r\n\r\n> I'm confused because the query is a simple COUNT(*), and I thought pyiceber would read the metadata stored on the metadata folder to get the number of records.\r\n\r\nUnfortunately, with the current DuckDB implementation, it pulls in all the (relevant) data. Since there is no filter on the scan, this means the entire table.\r\n\r\nHow big is the table? Could it be that it runs out of memory? Running `echo $?` will tell you the exit code of the process, which might indicate an out-of-memory situation.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1453357137/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1453505015","html_url":"https://github.com/apache/iceberg/issues/6505#issuecomment-1453505015","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6505","id":1453505015,"node_id":"IC_kwDOCW7NX85Worn3","user":{"login":"bigluck","id":1511095,"node_id":"MDQ6VXNlcjE1MTEwOTU=","avatar_url":"https://avatars.githubusercontent.com/u/1511095?v=4","gravatar_id":"","url":"https://api.github.com/users/bigluck","html_url":"https://github.com/bigluck","followers_url":"https://api.github.com/users/bigluck/followers","following_url":"https://api.github.com/users/bigluck/following{/other_user}","gists_url":"https://api.github.com/users/bigluck/gists{/gist_id}","starred_url":"https://api.github.com/users/bigluck/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bigluck/subscriptions","organizations_url":"https://api.github.com/users/bigluck/orgs","repos_url":"https://api.github.com/users/bigluck/repos","events_url":"https://api.github.com/users/bigluck/events{/privacy}","received_events_url":"https://api.github.com/users/bigluck/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-03T13:05:18Z","updated_at":"2023-03-03T13:05:18Z","author_association":"NONE","body":"Oh, I've got it, thanks @Fokko .\r\nThe EC2 I'm using is a `t2.medium`, 2 vCPU/4GB RAM.\r\nIt's not big, so it can be the root cause (I'm querying the full hvfhs dataset, ~745,287,023 records)\r\n\r\nThe exit code is 137, OOM :)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1453505015/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1453537505","html_url":"https://github.com/apache/iceberg/pull/6955#issuecomment-1453537505","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6955","id":1453537505,"node_id":"IC_kwDOCW7NX85Wozjh","user":{"login":"zhouyifan279","id":88070094,"node_id":"MDQ6VXNlcjg4MDcwMDk0","avatar_url":"https://avatars.githubusercontent.com/u/88070094?v=4","gravatar_id":"","url":"https://api.github.com/users/zhouyifan279","html_url":"https://github.com/zhouyifan279","followers_url":"https://api.github.com/users/zhouyifan279/followers","following_url":"https://api.github.com/users/zhouyifan279/following{/other_user}","gists_url":"https://api.github.com/users/zhouyifan279/gists{/gist_id}","starred_url":"https://api.github.com/users/zhouyifan279/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhouyifan279/subscriptions","organizations_url":"https://api.github.com/users/zhouyifan279/orgs","repos_url":"https://api.github.com/users/zhouyifan279/repos","events_url":"https://api.github.com/users/zhouyifan279/events{/privacy}","received_events_url":"https://api.github.com/users/zhouyifan279/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-03T13:30:57Z","updated_at":"2023-03-03T13:30:57Z","author_association":"CONTRIBUTOR","body":"> Left a style comment, if its ok with @haizhou-zhao @gaborkaszab , fine with me\r\n\r\n@szehon-ho @gaborkaszab Revised code as suggested.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1453537505/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1453552671","html_url":"https://github.com/apache/iceberg/issues/6904#issuecomment-1453552671","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6904","id":1453552671,"node_id":"IC_kwDOCW7NX85Wo3Qf","user":{"login":"lexluo09","id":39718951,"node_id":"MDQ6VXNlcjM5NzE4OTUx","avatar_url":"https://avatars.githubusercontent.com/u/39718951?v=4","gravatar_id":"","url":"https://api.github.com/users/lexluo09","html_url":"https://github.com/lexluo09","followers_url":"https://api.github.com/users/lexluo09/followers","following_url":"https://api.github.com/users/lexluo09/following{/other_user}","gists_url":"https://api.github.com/users/lexluo09/gists{/gist_id}","starred_url":"https://api.github.com/users/lexluo09/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lexluo09/subscriptions","organizations_url":"https://api.github.com/users/lexluo09/orgs","repos_url":"https://api.github.com/users/lexluo09/repos","events_url":"https://api.github.com/users/lexluo09/events{/privacy}","received_events_url":"https://api.github.com/users/lexluo09/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-03T13:43:39Z","updated_at":"2023-03-03T13:43:39Z","author_association":"NONE","body":"I got it , thank you very much for your answer .\r\n@findepi   @nastra","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1453552671/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1453817442","html_url":"https://github.com/apache/iceberg/pull/6992#issuecomment-1453817442","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6992","id":1453817442,"node_id":"IC_kwDOCW7NX85Wp35i","user":{"login":"gustavoatt","id":1475634,"node_id":"MDQ6VXNlcjE0NzU2MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/1475634?v=4","gravatar_id":"","url":"https://api.github.com/users/gustavoatt","html_url":"https://github.com/gustavoatt","followers_url":"https://api.github.com/users/gustavoatt/followers","following_url":"https://api.github.com/users/gustavoatt/following{/other_user}","gists_url":"https://api.github.com/users/gustavoatt/gists{/gist_id}","starred_url":"https://api.github.com/users/gustavoatt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gustavoatt/subscriptions","organizations_url":"https://api.github.com/users/gustavoatt/orgs","repos_url":"https://api.github.com/users/gustavoatt/repos","events_url":"https://api.github.com/users/gustavoatt/events{/privacy}","received_events_url":"https://api.github.com/users/gustavoatt/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-03T16:54:35Z","updated_at":"2023-03-03T16:54:35Z","author_association":"CONTRIBUTOR","body":"@ajantha-bhat @Fokko can I ask for y'all review here? (I see that you have made recent changes or reviewed the expire snapshots procedure in the past). ðŸ™ðŸ½ ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1453817442/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454050963","html_url":"https://github.com/apache/iceberg/pull/7002#issuecomment-1454050963","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7002","id":1454050963,"node_id":"IC_kwDOCW7NX85Wqw6T","user":{"login":"alaturqua","id":17232317,"node_id":"MDQ6VXNlcjE3MjMyMzE3","avatar_url":"https://avatars.githubusercontent.com/u/17232317?v=4","gravatar_id":"","url":"https://api.github.com/users/alaturqua","html_url":"https://github.com/alaturqua","followers_url":"https://api.github.com/users/alaturqua/followers","following_url":"https://api.github.com/users/alaturqua/following{/other_user}","gists_url":"https://api.github.com/users/alaturqua/gists{/gist_id}","starred_url":"https://api.github.com/users/alaturqua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alaturqua/subscriptions","organizations_url":"https://api.github.com/users/alaturqua/orgs","repos_url":"https://api.github.com/users/alaturqua/repos","events_url":"https://api.github.com/users/alaturqua/events{/privacy}","received_events_url":"https://api.github.com/users/alaturqua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-03T19:49:15Z","updated_at":"2023-03-03T19:49:15Z","author_association":"CONTRIBUTOR","body":"> \r\n\r\nThe solution you suggested sounds better. I will add and push again.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454050963/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454079500","html_url":"https://github.com/apache/iceberg/pull/6012#issuecomment-1454079500","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6012","id":1454079500,"node_id":"IC_kwDOCW7NX85Wq34M","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-03T20:17:36Z","updated_at":"2023-03-03T20:17:36Z","author_association":"CONTRIBUTOR","body":"Thanks a lot for the review @aokolnychyi. Resolved all of them and ready for another look.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454079500/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454114897","html_url":"https://github.com/apache/iceberg/pull/6069#issuecomment-1454114897","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6069","id":1454114897,"node_id":"IC_kwDOCW7NX85WrAhR","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-03T20:53:39Z","updated_at":"2023-03-03T20:53:39Z","author_association":"CONTRIBUTOR","body":"Hey @dhruv-pratap. I'm closing this draft as this has already been implemented. Feel free to open a new PR if you feel something is missing.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454114897/reactions","total_count":2,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454164075","html_url":"https://github.com/apache/iceberg/pull/6012#issuecomment-1454164075","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6012","id":1454164075,"node_id":"IC_kwDOCW7NX85WrMhr","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-03T21:41:33Z","updated_at":"2023-03-03T21:41:33Z","author_association":"CONTRIBUTOR","body":"retest this please\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454164075/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454164621","html_url":"https://github.com/apache/iceberg/pull/6012#issuecomment-1454164621","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6012","id":1454164621,"node_id":"IC_kwDOCW7NX85WrMqN","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-03T21:42:13Z","updated_at":"2023-03-03T21:42:13Z","author_association":"CONTRIBUTOR","body":"The pipeline error is not related.\r\n```\r\n> A failure occurred while executing org.gradle.api.plugins.quality.internal.CheckstyleAction\r\n   > An unexpected error occurred configuring and executing Checkstyle.\r\n      > java.lang.Error: Error was thrown while processing /home/runner/work/iceberg/iceberg/spark/v3.3/spark/src/main/java/org/apache/iceberg/spark/source/SparkPartitioningAwareScan.java\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454164621/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454175242","html_url":"https://github.com/apache/iceberg/pull/7003#issuecomment-1454175242","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7003","id":1454175242,"node_id":"IC_kwDOCW7NX85WrPQK","user":{"login":"singhpk234","id":35593236,"node_id":"MDQ6VXNlcjM1NTkzMjM2","avatar_url":"https://avatars.githubusercontent.com/u/35593236?v=4","gravatar_id":"","url":"https://api.github.com/users/singhpk234","html_url":"https://github.com/singhpk234","followers_url":"https://api.github.com/users/singhpk234/followers","following_url":"https://api.github.com/users/singhpk234/following{/other_user}","gists_url":"https://api.github.com/users/singhpk234/gists{/gist_id}","starred_url":"https://api.github.com/users/singhpk234/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/singhpk234/subscriptions","organizations_url":"https://api.github.com/users/singhpk234/orgs","repos_url":"https://api.github.com/users/singhpk234/repos","events_url":"https://api.github.com/users/singhpk234/events{/privacy}","received_events_url":"https://api.github.com/users/singhpk234/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-03T21:55:22Z","updated_at":"2023-03-03T21:55:22Z","author_association":"CONTRIBUTOR","body":"fix failures due to https://github.com/adobe/S3Mock/issues/880, seems like sdk v2 since 2.18 updated.\r\n\r\n> There may be some behavior changes related to endpoint resolution as as the the endpoint resolution is now \r\nstandardised across SDKs so this release also bumps the minor version of the SDK to 2.18.\r\n\r\n> Notably, there are some changes in S3: when including and endpoint override, the SDK will use virtual bucket addressing as long as the bucket is a valid DNS label. This is different from the previous behavior where this only happens if the endpoint override begins with 's3'.\r\n\r\n\r\nWill run AWS integration tests as well shortly if UNIT tests passes.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454175242/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454178427","html_url":"https://github.com/apache/iceberg/pull/6986#issuecomment-1454178427","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6986","id":1454178427,"node_id":"IC_kwDOCW7NX85WrQB7","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-03T21:59:01Z","updated_at":"2023-03-03T21:59:01Z","author_association":"CONTRIBUTOR","body":"We try to keep Netty in sync with the Spark and Arrow transitive dependencies. What effect does this have on Spark modules?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454178427/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454181053","html_url":"https://github.com/apache/iceberg/pull/6972#issuecomment-1454181053","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6972","id":1454181053,"node_id":"IC_kwDOCW7NX85WrQq9","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-03T22:01:59Z","updated_at":"2023-03-03T22:01:59Z","author_association":"CONTRIBUTOR","body":"Looks good. Is it possible to test?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454181053/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454182193","html_url":"https://github.com/apache/iceberg/pull/6971#issuecomment-1454182193","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6971","id":1454182193,"node_id":"IC_kwDOCW7NX85WrQ8x","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-03T22:03:20Z","updated_at":"2023-03-03T22:03:20Z","author_association":"CONTRIBUTOR","body":"Is it possible to test this?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454182193/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454188931","html_url":"https://github.com/apache/iceberg/pull/6969#issuecomment-1454188931","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6969","id":1454188931,"node_id":"IC_kwDOCW7NX85WrSmD","user":{"login":"dependabot[bot]","id":49699333,"node_id":"MDM6Qm90NDk2OTkzMzM=","avatar_url":"https://avatars.githubusercontent.com/in/29110?v=4","gravatar_id":"","url":"https://api.github.com/users/dependabot%5Bbot%5D","html_url":"https://github.com/apps/dependabot","followers_url":"https://api.github.com/users/dependabot%5Bbot%5D/followers","following_url":"https://api.github.com/users/dependabot%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/dependabot%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/dependabot%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dependabot%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/dependabot%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/dependabot%5Bbot%5D/repos","events_url":"https://api.github.com/users/dependabot%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/dependabot%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-03-03T22:07:45Z","updated_at":"2023-03-03T22:07:45Z","author_association":"CONTRIBUTOR","body":"OK, I won't notify you again about this release, but will get in touch when a new version is available. If you'd rather skip all updates until the next major or minor version, let me know by commenting `@dependabot ignore this major version` or `@dependabot ignore this minor version`. You can also ignore all major, minor, or patch releases for a dependency by adding an [`ignore` condition](https://docs.github.com/en/code-security/supply-chain-security/configuration-options-for-dependency-updates#ignore) with the desired `update_types` to your config file.\n\nIf you change your mind, just re-open this PR and I'll resolve any conflicts on it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454188931/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454190147","html_url":"https://github.com/apache/iceberg/pull/6967#issuecomment-1454190147","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6967","id":1454190147,"node_id":"IC_kwDOCW7NX85WrS5D","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-03T22:08:38Z","updated_at":"2023-03-03T22:08:38Z","author_association":"CONTRIBUTOR","body":"@zhongyujiang can you please add more to the description about what is included here and how you solved the problems with record materialization?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454190147/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454191104","html_url":"https://github.com/apache/iceberg/pull/6962#issuecomment-1454191104","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6962","id":1454191104,"node_id":"IC_kwDOCW7NX85WrTIA","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-03T22:09:28Z","updated_at":"2023-03-03T22:09:28Z","author_association":"CONTRIBUTOR","body":"@nastra can you take a look at this?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454191104/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454191381","html_url":"https://github.com/apache/iceberg/pull/6939#issuecomment-1454191381","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6939","id":1454191381,"node_id":"IC_kwDOCW7NX85WrTMV","user":{"login":"dependabot[bot]","id":49699333,"node_id":"MDM6Qm90NDk2OTkzMzM=","avatar_url":"https://avatars.githubusercontent.com/in/29110?v=4","gravatar_id":"","url":"https://api.github.com/users/dependabot%5Bbot%5D","html_url":"https://github.com/apps/dependabot","followers_url":"https://api.github.com/users/dependabot%5Bbot%5D/followers","following_url":"https://api.github.com/users/dependabot%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/dependabot%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/dependabot%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dependabot%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/dependabot%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/dependabot%5Bbot%5D/repos","events_url":"https://api.github.com/users/dependabot%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/dependabot%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-03-03T22:09:45Z","updated_at":"2023-03-03T22:09:45Z","author_association":"CONTRIBUTOR","body":"OK, I won't notify you again about this release, but will get in touch when a new version is available. If you'd rather skip all updates until the next major or minor version, let me know by commenting `@dependabot ignore this major version` or `@dependabot ignore this minor version`. You can also ignore all major, minor, or patch releases for a dependency by adding an [`ignore` condition](https://docs.github.com/en/code-security/supply-chain-security/configuration-options-for-dependency-updates#ignore) with the desired `update_types` to your config file.\n\nIf you change your mind, just re-open this PR and I'll resolve any conflicts on it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454191381/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454281169","html_url":"https://github.com/apache/iceberg/pull/6012#issuecomment-1454281169","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6012","id":1454281169,"node_id":"IC_kwDOCW7NX85WrpHR","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-03T23:59:54Z","updated_at":"2023-03-03T23:59:54Z","author_association":"CONTRIBUTOR","body":"retest this please","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454281169/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454289366","html_url":"https://github.com/apache/iceberg/issues/5487#issuecomment-1454289366","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5487","id":1454289366,"node_id":"IC_kwDOCW7NX85WrrHW","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-03-04T00:11:35Z","updated_at":"2023-03-04T00:11:35Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454289366/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454346679","html_url":"https://github.com/apache/iceberg/issues/5801#issuecomment-1454346679","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5801","id":1454346679,"node_id":"IC_kwDOCW7NX85Wr5G3","user":{"login":"djouallah","id":12554469,"node_id":"MDQ6VXNlcjEyNTU0NDY5","avatar_url":"https://avatars.githubusercontent.com/u/12554469?v=4","gravatar_id":"","url":"https://api.github.com/users/djouallah","html_url":"https://github.com/djouallah","followers_url":"https://api.github.com/users/djouallah/followers","following_url":"https://api.github.com/users/djouallah/following{/other_user}","gists_url":"https://api.github.com/users/djouallah/gists{/gist_id}","starred_url":"https://api.github.com/users/djouallah/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/djouallah/subscriptions","organizations_url":"https://api.github.com/users/djouallah/orgs","repos_url":"https://api.github.com/users/djouallah/repos","events_url":"https://api.github.com/users/djouallah/events{/privacy}","received_events_url":"https://api.github.com/users/djouallah/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-04T02:48:27Z","updated_at":"2023-03-04T02:51:27Z","author_association":"NONE","body":"either there is a bug or it is really loading a table not a view , testing it in colab and it is Out of memory \r\n\r\nmaybe the issue is elsewhere, Limit don't seems to be pushed down","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454346679/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454348433","html_url":"https://github.com/apache/iceberg/pull/6936#issuecomment-1454348433","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6936","id":1454348433,"node_id":"IC_kwDOCW7NX85Wr5iR","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-04T02:54:40Z","updated_at":"2023-03-04T02:54:40Z","author_association":"CONTRIBUTOR","body":"thanks @wangyinsheng for the contribution and @nastra for the review","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454348433/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454470646","html_url":"https://github.com/apache/iceberg/issues/6995#issuecomment-1454470646","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6995","id":1454470646,"node_id":"IC_kwDOCW7NX85WsXX2","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-04T05:27:16Z","updated_at":"2023-03-04T05:27:16Z","author_association":"COLLABORATOR","body":"There is a pr for this https://github.com/apache/iceberg/pull/6661.\r\n\r\nBut for now, you can check out data_files and delete_files table.  Just group both by partition, do count(*).\r\n\r\nThe problem is now, RewriteDataFiles applies but doesn't remove delete files.  I'm planning to work on that now, via implementing RewritePositionDeleteFiles (minor compaction of delete files), which will during the rewrite, drop obsolete  position deletes.  It's in progress.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454470646/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454507241","html_url":"https://github.com/apache/iceberg/pull/6012#issuecomment-1454507241","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6012","id":1454507241,"node_id":"IC_kwDOCW7NX85WsgTp","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-04T05:59:03Z","updated_at":"2023-03-04T05:59:03Z","author_association":"CONTRIBUTOR","body":"Thanks, @flyrain! I am excited to test this out in real use cases.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454507241/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454632236","html_url":"https://github.com/apache/iceberg/issues/5801#issuecomment-1454632236","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5801","id":1454632236,"node_id":"IC_kwDOCW7NX85Ws-0s","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-04T07:30:25Z","updated_at":"2023-03-04T07:30:25Z","author_association":"CONTRIBUTOR","body":"@djouallah you are right on that. \r\n\r\nCurrently, it is still a two-stage rocket, you first need to prune the data using the PyIceberg `row_filter`:\r\n\r\n```python\r\ncatalog = load_catalog('default')\r\ntbl = catalog.load_table('nyc.taxis')\r\n\r\nsc = tbl.scan(row_filter=And(\r\n    GreaterThanOrEqual(\"tpep_pickup_datetime\", \"2022-01-01T00:00:00.000000+00:00\")\r\n    LessThan(\"tpep_pickup_datetime\", \"2022-02-01T00:00:00.000000+00:00\")\r\n).to_arrow() # Same for .to_duckdb()\r\n```\r\n\r\nThis will load all the data from January. If you don't pass in a `row_filter`, it will pull in the current version of the table. Right now, it won't push the predicate down to the Iceberg layer, unfortunately. This is something that we're working on but requires tighter integration with PyArrow and DuckDB.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454632236/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454645179","html_url":"https://github.com/apache/iceberg/issues/5801#issuecomment-1454645179","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5801","id":1454645179,"node_id":"IC_kwDOCW7NX85WtB-7","user":{"login":"djouallah","id":12554469,"node_id":"MDQ6VXNlcjEyNTU0NDY5","avatar_url":"https://avatars.githubusercontent.com/u/12554469?v=4","gravatar_id":"","url":"https://api.github.com/users/djouallah","html_url":"https://github.com/djouallah","followers_url":"https://api.github.com/users/djouallah/followers","following_url":"https://api.github.com/users/djouallah/following{/other_user}","gists_url":"https://api.github.com/users/djouallah/gists{/gist_id}","starred_url":"https://api.github.com/users/djouallah/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/djouallah/subscriptions","organizations_url":"https://api.github.com/users/djouallah/orgs","repos_url":"https://api.github.com/users/djouallah/repos","events_url":"https://api.github.com/users/djouallah/events{/privacy}","received_events_url":"https://api.github.com/users/djouallah/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-04T07:38:39Z","updated_at":"2023-03-04T07:59:10Z","author_association":"NONE","body":"@Fokko that's fine, the confusion is in the title of the bug report, Pyarrow dataset means a view, but currently to_duckdb() load a table that's two different thing, that's the same point raised by @ianmcook \r\n\r\nthe row_filter does not work anyway in 0.3, so basically we end up with crashing the local session as it loads the whole table \r\n\r\ndo you mind changing the title of the bug and replace dataset with table.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454645179/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454657153","html_url":"https://github.com/apache/iceberg/pull/6012#issuecomment-1454657153","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6012","id":1454657153,"node_id":"IC_kwDOCW7NX85WtE6B","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-04T07:52:09Z","updated_at":"2023-03-04T07:52:09Z","author_association":"CONTRIBUTOR","body":"Thanks a lot @aokolnychyi! I will address these comments in a followup PR. It is a milestone. I'm also excited to see how people use it. Thanks everybody for the review, @RussellSpitzer @chenjunjiedada @hililiwei @rdblue!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454657153/reactions","total_count":2,"+1":0,"-1":0,"laugh":0,"hooray":2,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454661186","html_url":"https://github.com/apache/iceberg/pull/6986#issuecomment-1454661186","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6986","id":1454661186,"node_id":"IC_kwDOCW7NX85WtF5C","user":{"login":"XN137","id":1204398,"node_id":"MDQ6VXNlcjEyMDQzOTg=","avatar_url":"https://avatars.githubusercontent.com/u/1204398?v=4","gravatar_id":"","url":"https://api.github.com/users/XN137","html_url":"https://github.com/XN137","followers_url":"https://api.github.com/users/XN137/followers","following_url":"https://api.github.com/users/XN137/following{/other_user}","gists_url":"https://api.github.com/users/XN137/gists{/gist_id}","starred_url":"https://api.github.com/users/XN137/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/XN137/subscriptions","organizations_url":"https://api.github.com/users/XN137/orgs","repos_url":"https://api.github.com/users/XN137/repos","events_url":"https://api.github.com/users/XN137/events{/privacy}","received_events_url":"https://api.github.com/users/XN137/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-04T08:13:09Z","updated_at":"2023-03-04T08:13:09Z","author_association":"CONTRIBUTOR","body":"this is still a draft so not ready for review\r\n\r\nthat being said, the current version `4.1.68.Final` is a version downgrade since the recent arrow upgrade... so i am guessing the current version pin only continues to work because neither spark nor arrow are using APIs that are only available in their newer netty versions.\r\n\r\nalso not sure why we pin the version ourselves when we want to keep it in sync with one (both?) of the other dependencies, when we could let one of those dependencies pull in \"their version\"\r\n\r\ndid we ever hit netty compatibility issues that are not covered by iceberg CI ?\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454661186/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454674475","html_url":"https://github.com/apache/iceberg/pull/6972#issuecomment-1454674475","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6972","id":1454674475,"node_id":"IC_kwDOCW7NX85WtJIr","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-04T09:19:21Z","updated_at":"2023-03-04T09:19:35Z","author_association":"CONTRIBUTOR","body":"> Is it possible to test?\r\n\r\n@rdblue certainly, added a test.\r\n\r\nThanks for the review!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454674475/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454675576","html_url":"https://github.com/apache/iceberg/issues/5801#issuecomment-1454675576","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5801","id":1454675576,"node_id":"IC_kwDOCW7NX85WtJZ4","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-04T09:24:04Z","updated_at":"2023-03-04T09:24:04Z","author_association":"CONTRIBUTOR","body":"> the row_filter does not work anyway in 0.3\r\n\r\nCan you elaborate? Or even better, create a ticket for this?\r\n\r\n> do you mind changing the title of the bug and replace dataset with table.\r\n\r\nNo problem at all","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454675576/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454676021","html_url":"https://github.com/apache/iceberg/pull/6971#issuecomment-1454676021","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6971","id":1454676021,"node_id":"IC_kwDOCW7NX85WtJg1","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-04T09:25:53Z","updated_at":"2023-03-04T09:25:53Z","author_association":"CONTRIBUTOR","body":"@rdblue this one is a bit tricky to test since it was just missing the argument.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454676021/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454687734","html_url":"https://github.com/apache/iceberg/pull/7009#issuecomment-1454687734","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7009","id":1454687734,"node_id":"IC_kwDOCW7NX85WtMX2","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-04T10:11:28Z","updated_at":"2023-03-04T10:11:28Z","author_association":"MEMBER","body":"duplicate of #7006 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454687734/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454716340","html_url":"https://github.com/apache/iceberg/issues/7001#issuecomment-1454716340","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7001","id":1454716340,"node_id":"IC_kwDOCW7NX85WtTW0","user":{"login":"alaturqua","id":17232317,"node_id":"MDQ6VXNlcjE3MjMyMzE3","avatar_url":"https://avatars.githubusercontent.com/u/17232317?v=4","gravatar_id":"","url":"https://api.github.com/users/alaturqua","html_url":"https://github.com/alaturqua","followers_url":"https://api.github.com/users/alaturqua/followers","following_url":"https://api.github.com/users/alaturqua/following{/other_user}","gists_url":"https://api.github.com/users/alaturqua/gists{/gist_id}","starred_url":"https://api.github.com/users/alaturqua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alaturqua/subscriptions","organizations_url":"https://api.github.com/users/alaturqua/orgs","repos_url":"https://api.github.com/users/alaturqua/repos","events_url":"https://api.github.com/users/alaturqua/events{/privacy}","received_events_url":"https://api.github.com/users/alaturqua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-04T12:02:01Z","updated_at":"2023-03-04T12:02:01Z","author_association":"CONTRIBUTOR","body":"Fixed with merge:\r\nhttps://github.com/apache/iceberg/pull/7002","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454716340/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454731654","html_url":"https://github.com/apache/iceberg/issues/7012#issuecomment-1454731654","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7012","id":1454731654,"node_id":"IC_kwDOCW7NX85WtXGG","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-04T12:58:15Z","updated_at":"2023-03-04T12:58:15Z","author_association":"CONTRIBUTOR","body":"Thanks for reporting this @djouallah \r\n\r\nI tried to reproduce this on my end, but unfortunally was unable to trigger the issue on the main branch and on PyIceberg 0.3.0:\r\n\r\n![image](https://user-images.githubusercontent.com/1134248/222903127-152b580f-1528-4bfd-9614-f72974ecbe39.png)\r\n\r\n\r\nCould you give more information on how you ran into this? Is this on your local machine or in some environment?\r\n\r\nCould you share the PyArrow version?\r\n\r\n```python\r\npython3\r\nPython 3.11.2 (main, Feb 16 2023, 02:55:59) [Clang 14.0.0 (clang-1400.0.29.202)] on darwin\r\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\r\n>>> import pyarrow\r\n>>> pyarrow.__version__\r\n'11.0.0'\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454731654/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454735515","html_url":"https://github.com/apache/iceberg/issues/7012#issuecomment-1454735515","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7012","id":1454735515,"node_id":"IC_kwDOCW7NX85WtYCb","user":{"login":"djouallah","id":12554469,"node_id":"MDQ6VXNlcjEyNTU0NDY5","avatar_url":"https://avatars.githubusercontent.com/u/12554469?v=4","gravatar_id":"","url":"https://api.github.com/users/djouallah","html_url":"https://github.com/djouallah","followers_url":"https://api.github.com/users/djouallah/followers","following_url":"https://api.github.com/users/djouallah/following{/other_user}","gists_url":"https://api.github.com/users/djouallah/gists{/gist_id}","starred_url":"https://api.github.com/users/djouallah/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/djouallah/subscriptions","organizations_url":"https://api.github.com/users/djouallah/orgs","repos_url":"https://api.github.com/users/djouallah/repos","events_url":"https://api.github.com/users/djouallah/events{/privacy}","received_events_url":"https://api.github.com/users/djouallah/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-04T13:11:27Z","updated_at":"2023-03-04T13:11:27Z","author_association":"NONE","body":"sorry was running from pip install git, maybe delete your credential :)\r\nsorry for the noise ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454735515/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454737520","html_url":"https://github.com/apache/iceberg/issues/7012#issuecomment-1454737520","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7012","id":1454737520,"node_id":"IC_kwDOCW7NX85WtYhw","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-04T13:19:13Z","updated_at":"2023-03-04T13:19:13Z","author_association":"CONTRIBUTOR","body":"Whoops! Thanks for notifying me about the credential. No problem at all, great to hear that it has been resolved.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454737520/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454932852","html_url":"https://github.com/apache/iceberg/issues/5611#issuecomment-1454932852","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5611","id":1454932852,"node_id":"IC_kwDOCW7NX85WuIN0","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-03-05T00:15:12Z","updated_at":"2023-03-05T00:15:12Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454932852/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454932864","html_url":"https://github.com/apache/iceberg/issues/5607#issuecomment-1454932864","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5607","id":1454932864,"node_id":"IC_kwDOCW7NX85WuIOA","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-03-05T00:15:14Z","updated_at":"2023-03-05T00:15:14Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454932864/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454932872","html_url":"https://github.com/apache/iceberg/issues/5579#issuecomment-1454932872","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5579","id":1454932872,"node_id":"IC_kwDOCW7NX85WuIOI","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-03-05T00:15:17Z","updated_at":"2023-03-05T00:15:17Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454932872/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454951574","html_url":"https://github.com/apache/iceberg/pull/6760#issuecomment-1454951574","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6760","id":1454951574,"node_id":"IC_kwDOCW7NX85WuMyW","user":{"login":"ludlows","id":6441333,"node_id":"MDQ6VXNlcjY0NDEzMzM=","avatar_url":"https://avatars.githubusercontent.com/u/6441333?v=4","gravatar_id":"","url":"https://api.github.com/users/ludlows","html_url":"https://github.com/ludlows","followers_url":"https://api.github.com/users/ludlows/followers","following_url":"https://api.github.com/users/ludlows/following{/other_user}","gists_url":"https://api.github.com/users/ludlows/gists{/gist_id}","starred_url":"https://api.github.com/users/ludlows/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ludlows/subscriptions","organizations_url":"https://api.github.com/users/ludlows/orgs","repos_url":"https://api.github.com/users/ludlows/repos","events_url":"https://api.github.com/users/ludlows/events{/privacy}","received_events_url":"https://api.github.com/users/ludlows/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-05T01:32:57Z","updated_at":"2023-03-05T01:32:57Z","author_association":"CONTRIBUTOR","body":"Hi @szehon-ho ,\r\n\r\nI added a test case for this PR. you may comment some lines of code to reproduce the bug in file [RewriteDataFilesProcedure.java](https://github.com/ludlows/iceberg/blob/rewritr_data_file-exit-where-false/spark/v3.3/spark/src/main/java/org/apache/iceberg/spark/procedures/RewriteDataFilesProcedure.java)  :\r\n```java\r\n// if (where != null && SparkExpressionConverter.checkWhereAlwaysFalse(spark(), quotedFullIdentifier, where)) {\r\n//            RewriteDataFiles.Result result = new BaseRewriteDataFilesResult(Lists.newArrayList());\r\n//            return toOutputRows(result);\r\n// }\r\n``` \r\nlet me know if you have any questions. \r\nthanks. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454951574/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454981586","html_url":"https://github.com/apache/iceberg/issues/7005#issuecomment-1454981586","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7005","id":1454981586,"node_id":"IC_kwDOCW7NX85WuUHS","user":{"login":"pkhetrapal","id":12616990,"node_id":"MDQ6VXNlcjEyNjE2OTkw","avatar_url":"https://avatars.githubusercontent.com/u/12616990?v=4","gravatar_id":"","url":"https://api.github.com/users/pkhetrapal","html_url":"https://github.com/pkhetrapal","followers_url":"https://api.github.com/users/pkhetrapal/followers","following_url":"https://api.github.com/users/pkhetrapal/following{/other_user}","gists_url":"https://api.github.com/users/pkhetrapal/gists{/gist_id}","starred_url":"https://api.github.com/users/pkhetrapal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pkhetrapal/subscriptions","organizations_url":"https://api.github.com/users/pkhetrapal/orgs","repos_url":"https://api.github.com/users/pkhetrapal/repos","events_url":"https://api.github.com/users/pkhetrapal/events{/privacy}","received_events_url":"https://api.github.com/users/pkhetrapal/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-05T03:48:44Z","updated_at":"2023-03-05T03:48:44Z","author_association":"NONE","body":"```\r\nmerge_insert_sql = f\"\"\"\r\n    MERGE INTO table1 t \r\n    USING (SELECT * FROM global_temp.table2) s \r\n    ON t._ID = s._ID\r\n    WHEN NOT MATCHED THEN INSERT *\r\n\"\"\"\r\nspark.sql(merge_insert_sql)\r\n```\r\n\r\nThis inserts the records twice - not sure why though\r\n\r\n```\r\nmerge_sql = f\"\"\"\r\n    MERGE INTO table1 t \r\n    USING (SELECT * FROM global_temp.table2) s \r\n    ON t._ID = s._ID\r\n    WHEN MATCHED AND s.UPDATED_AT > t.UPDATED_AT THEN UPDATE SET *\r\n\tWHEN MATCHED AND s.UPDATED_AT <= t.UPDATED_AT THEN UPDATE SET t._ID = s._ID\r\n    WHEN NOT MATCHED THEN INSERT *\r\nspark.sql(merge_sql)\r\n```\r\nThis inserts the records twice as well but the below one works fine\r\n\r\n```\r\nmerge_sql = f\"\"\"\r\n    MERGE INTO table1 t \r\n    USING (SELECT * FROM global_temp.table2) s \r\n    ON t._ID = s._ID\r\n    WHEN MATCHED AND s.UPDATED_AT > t.UPDATED_AT THEN UPDATE SET *\r\n\tWHEN MATCHED THEN UPDATE SET t._ID = s._ID\r\n    WHEN NOT MATCHED THEN INSERT *\r\nspark.sql(merge_sql)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1454981586/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1455009238","html_url":"https://github.com/apache/iceberg/issues/6979#issuecomment-1455009238","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6979","id":1455009238,"node_id":"IC_kwDOCW7NX85Wua3W","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-05T07:05:21Z","updated_at":"2023-03-05T07:06:27Z","author_association":"CONTRIBUTOR","body":"@pkhetrapal Thanks for reaching out. Would be great if you could include the steps that you took to reproduce the issue. It works on my machine: \r\n\r\n![image](https://user-images.githubusercontent.com/1134248/222946691-b292dbd6-f603-4105-b43a-3147ad584542.png)\r\n\r\nIn Iceberg this schema change is considered compatible (unless `phone` would be non-null).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1455009238/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1455046746","html_url":"https://github.com/apache/iceberg/pull/7014#issuecomment-1455046746","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7014","id":1455046746,"node_id":"IC_kwDOCW7NX85WukBa","user":{"login":"wangyinsheng","id":13392313,"node_id":"MDQ6VXNlcjEzMzkyMzEz","avatar_url":"https://avatars.githubusercontent.com/u/13392313?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyinsheng","html_url":"https://github.com/wangyinsheng","followers_url":"https://api.github.com/users/wangyinsheng/followers","following_url":"https://api.github.com/users/wangyinsheng/following{/other_user}","gists_url":"https://api.github.com/users/wangyinsheng/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyinsheng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyinsheng/subscriptions","organizations_url":"https://api.github.com/users/wangyinsheng/orgs","repos_url":"https://api.github.com/users/wangyinsheng/repos","events_url":"https://api.github.com/users/wangyinsheng/events{/privacy}","received_events_url":"https://api.github.com/users/wangyinsheng/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-05T10:13:15Z","updated_at":"2023-03-05T10:13:15Z","author_association":"CONTRIBUTOR","body":"@nastra will you please take a look this pr ?  And I did not change any code of spark, but  the CI gives errors when check style for spark,  please give some help, thanks","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1455046746/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1455092781","html_url":"https://github.com/apache/iceberg/issues/3665#issuecomment-1455092781","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3665","id":1455092781,"node_id":"IC_kwDOCW7NX85WuvQt","user":{"login":"giucris","id":9114810,"node_id":"MDQ6VXNlcjkxMTQ4MTA=","avatar_url":"https://avatars.githubusercontent.com/u/9114810?v=4","gravatar_id":"","url":"https://api.github.com/users/giucris","html_url":"https://github.com/giucris","followers_url":"https://api.github.com/users/giucris/followers","following_url":"https://api.github.com/users/giucris/following{/other_user}","gists_url":"https://api.github.com/users/giucris/gists{/gist_id}","starred_url":"https://api.github.com/users/giucris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/giucris/subscriptions","organizations_url":"https://api.github.com/users/giucris/orgs","repos_url":"https://api.github.com/users/giucris/repos","events_url":"https://api.github.com/users/giucris/events{/privacy}","received_events_url":"https://api.github.com/users/giucris/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-05T13:29:57Z","updated_at":"2023-03-05T13:29:57Z","author_association":"NONE","body":"Hi @RussellSpitzer @huaxingao\r\n\r\nIf this functionality is still required and Spark side is still pending, I might try to implement it (as a Scala developer I would really like to have the merge API). \r\n\r\nI just need to have a chat with someone who knows the Scala code base to clarify some missing pieces in my analysis. \r\n\r\nI see two possible implementations, both following the implicit approach.\r\n\r\nOption 1: \r\n* implicits that extends DataSet[T] with a new method mergeTo(table,condition)\r\n* implicits that extends DataFrameWriterV2[T] with the following method:\r\n    * whenMatched(condition:Option[String],actions:Seq[String])\r\n    * whenNotMatched(condition:Option[String],actions:Seq[String])\r\n    * merge() that will calls the final operations\r\n\r\n```scala\r\nds\r\n.mergeTo(table,condition)\r\n.whenMatched(something here)\r\n.whenNotMatched(something here)\r\n.merge()\r\n```\r\n\r\nOption 2: \r\n* implicits that extends DataFrameWriterV2[T] with the following method:\r\n    * mergeWhen(condition:Option[String]) \r\n    * whenMatched(condition:Option[String],actions:Seq[String])\r\n    * whenNotMatched(condition:Option[String],actions:Seq[String])\r\n    * merge() that will calls the final operations\r\n\r\n```scala\r\nds\r\n.writeTo(table)\r\n.mergeWhen(condition)\r\n.whenMatched(something here)\r\n.whenNotMatched(something here)\r\n.merge()\r\n```\r\nThe difference between the two approaches is in the syntax of the API: on the first one we generate a new 'mergeTo' method, on the other we refer to the already existing 'writeTo'.\r\n\r\nLooking at the actual code base I see that a MergeInto operation has already been resolved in a Spark LogicalPlan, probably we could reuse this logic and just call the executePlan on the final merge call\r\n\r\n ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1455092781/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1455119519","html_url":"https://github.com/apache/iceberg/pull/7020#issuecomment-1455119519","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7020","id":1455119519,"node_id":"IC_kwDOCW7NX85Wu1yf","user":{"login":"yabola","id":31469905,"node_id":"MDQ6VXNlcjMxNDY5OTA1","avatar_url":"https://avatars.githubusercontent.com/u/31469905?v=4","gravatar_id":"","url":"https://api.github.com/users/yabola","html_url":"https://github.com/yabola","followers_url":"https://api.github.com/users/yabola/followers","following_url":"https://api.github.com/users/yabola/following{/other_user}","gists_url":"https://api.github.com/users/yabola/gists{/gist_id}","starred_url":"https://api.github.com/users/yabola/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yabola/subscriptions","organizations_url":"https://api.github.com/users/yabola/orgs","repos_url":"https://api.github.com/users/yabola/repos","events_url":"https://api.github.com/users/yabola/events{/privacy}","received_events_url":"https://api.github.com/users/yabola/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-05T15:15:43Z","updated_at":"2023-03-05T15:15:43Z","author_association":"CONTRIBUTOR","body":"` class file for sun.misc.Unsafe not found` UT error...","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1455119519/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]