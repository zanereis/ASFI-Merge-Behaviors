[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/839837544","html_url":"https://github.com/apache/iceberg/pull/2584#issuecomment-839837544","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2584","id":839837544,"node_id":"MDEyOklzc3VlQ29tbWVudDgzOTgzNzU0NA==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-12T14:52:33Z","updated_at":"2021-05-12T14:52:33Z","author_association":"MEMBER","body":"> Thank you very much，I have another question, can you help me answer it：When I'm merge into operation on the same table ，appear error。can i Obtain the state of the table to determine？thanks\r\n\r\nI'm not sure what are you asking? Are you having a conflict error where it says the merge operation is violating the constraint of another opertaion?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/839837544/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/839888358","html_url":"https://github.com/apache/iceberg/pull/2544#issuecomment-839888358","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2544","id":839888358,"node_id":"MDEyOklzc3VlQ29tbWVudDgzOTg4ODM1OA==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-12T15:57:37Z","updated_at":"2021-05-12T15:57:37Z","author_association":"CONTRIBUTOR","body":"This PR is open for quite a long time and major concerns are resolved, we will merge this and address further comments in new PRs to keep things moving, thanks for the reviews.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/839888358/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/839985487","html_url":"https://github.com/apache/iceberg/pull/1870#issuecomment-839985487","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1870","id":839985487,"node_id":"MDEyOklzc3VlQ29tbWVudDgzOTk4NTQ4Nw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-12T18:04:12Z","updated_at":"2021-05-12T18:04:12Z","author_association":"CONTRIBUTOR","body":"Thanks, @ismailsimsek! I'll take another look. Sorry for the delay, I've been OOO for a little while.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/839985487/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/840016827","html_url":"https://github.com/apache/iceberg/issues/2580#issuecomment-840016827","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2580","id":840016827,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MDAxNjgyNw==","user":{"login":"indranildey-sfdc","id":65305061,"node_id":"MDQ6VXNlcjY1MzA1MDYx","avatar_url":"https://avatars.githubusercontent.com/u/65305061?v=4","gravatar_id":"","url":"https://api.github.com/users/indranildey-sfdc","html_url":"https://github.com/indranildey-sfdc","followers_url":"https://api.github.com/users/indranildey-sfdc/followers","following_url":"https://api.github.com/users/indranildey-sfdc/following{/other_user}","gists_url":"https://api.github.com/users/indranildey-sfdc/gists{/gist_id}","starred_url":"https://api.github.com/users/indranildey-sfdc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/indranildey-sfdc/subscriptions","organizations_url":"https://api.github.com/users/indranildey-sfdc/orgs","repos_url":"https://api.github.com/users/indranildey-sfdc/repos","events_url":"https://api.github.com/users/indranildey-sfdc/events{/privacy}","received_events_url":"https://api.github.com/users/indranildey-sfdc/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-12T18:47:50Z","updated_at":"2021-05-12T18:47:50Z","author_association":"NONE","body":"any update on this issue,","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/840016827/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/840025913","html_url":"https://github.com/apache/iceberg/pull/2585#issuecomment-840025913","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2585","id":840025913,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MDAyNTkxMw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-12T19:02:48Z","updated_at":"2021-05-12T19:02:48Z","author_association":"CONTRIBUTOR","body":"cc @yyanyy @jackye1995 too who reviewed the original change.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/840025913/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/840227645","html_url":"https://github.com/apache/iceberg/pull/2584#issuecomment-840227645","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2584","id":840227645,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MDIyNzY0NQ==","user":{"login":"bihaiyang","id":39689341,"node_id":"MDQ6VXNlcjM5Njg5MzQx","avatar_url":"https://avatars.githubusercontent.com/u/39689341?v=4","gravatar_id":"","url":"https://api.github.com/users/bihaiyang","html_url":"https://github.com/bihaiyang","followers_url":"https://api.github.com/users/bihaiyang/followers","following_url":"https://api.github.com/users/bihaiyang/following{/other_user}","gists_url":"https://api.github.com/users/bihaiyang/gists{/gist_id}","starred_url":"https://api.github.com/users/bihaiyang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bihaiyang/subscriptions","organizations_url":"https://api.github.com/users/bihaiyang/orgs","repos_url":"https://api.github.com/users/bihaiyang/repos","events_url":"https://api.github.com/users/bihaiyang/events{/privacy}","received_events_url":"https://api.github.com/users/bihaiyang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-13T01:52:27Z","updated_at":"2021-05-13T01:52:27Z","author_association":"NONE","body":"> > Thank you very much，I have another question, can you help me answer it：When I'm merge into operation on the same table ，appear error。can i Obtain the state of the table to determine？thanks\r\n> \r\n> I'm not sure what are you asking? Are you having a conflict error where it says the merge operation is violating the constraint of another opertaion?\r\n\r\nThank you for your reply ，Yes Yes, that's the kind of mistake，Is there a better solution to this？Or I can get the merge operation state\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/840227645/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/840238396","html_url":"https://github.com/apache/iceberg/pull/2584#issuecomment-840238396","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2584","id":840238396,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MDIzODM5Ng==","user":{"login":"Reo-LEI","id":17312872,"node_id":"MDQ6VXNlcjE3MzEyODcy","avatar_url":"https://avatars.githubusercontent.com/u/17312872?v=4","gravatar_id":"","url":"https://api.github.com/users/Reo-LEI","html_url":"https://github.com/Reo-LEI","followers_url":"https://api.github.com/users/Reo-LEI/followers","following_url":"https://api.github.com/users/Reo-LEI/following{/other_user}","gists_url":"https://api.github.com/users/Reo-LEI/gists{/gist_id}","starred_url":"https://api.github.com/users/Reo-LEI/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Reo-LEI/subscriptions","organizations_url":"https://api.github.com/users/Reo-LEI/orgs","repos_url":"https://api.github.com/users/Reo-LEI/repos","events_url":"https://api.github.com/users/Reo-LEI/events{/privacy}","received_events_url":"https://api.github.com/users/Reo-LEI/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-13T02:19:07Z","updated_at":"2021-05-13T02:19:07Z","author_association":"CONTRIBUTOR","body":"> @Reo-LEI @221770490011111 Could you please take a look?\r\n\r\nAwesome!! I will do some tests on this patch today. Thank you very much for your follow-up","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/840238396/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/840244016","html_url":"https://github.com/apache/iceberg/pull/2230#issuecomment-840244016","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2230","id":840244016,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MDI0NDAxNg==","user":{"login":"haormj","id":18750674,"node_id":"MDQ6VXNlcjE4NzUwNjc0","avatar_url":"https://avatars.githubusercontent.com/u/18750674?v=4","gravatar_id":"","url":"https://api.github.com/users/haormj","html_url":"https://github.com/haormj","followers_url":"https://api.github.com/users/haormj/followers","following_url":"https://api.github.com/users/haormj/following{/other_user}","gists_url":"https://api.github.com/users/haormj/gists{/gist_id}","starred_url":"https://api.github.com/users/haormj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/haormj/subscriptions","organizations_url":"https://api.github.com/users/haormj/orgs","repos_url":"https://api.github.com/users/haormj/repos","events_url":"https://api.github.com/users/haormj/events{/privacy}","received_events_url":"https://api.github.com/users/haormj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-13T02:32:52Z","updated_at":"2021-05-13T02:32:52Z","author_association":"CONTRIBUTOR","body":"@openinx @rdblue thanks for your work on this, this feature helps me a lot, could you provide the merged schedule?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/840244016/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/840289429","html_url":"https://github.com/apache/iceberg/pull/2230#issuecomment-840289429","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2230","id":840289429,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MDI4OTQyOQ==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-13T04:33:07Z","updated_at":"2021-05-13T04:33:07Z","author_association":"MEMBER","body":"@haormj ,  I would expect this feature could be merged in the next release 0.12.  That means we will need more bandwidth to get this reviewing work done.  will try to email @rdblue  to see if he has any bandwidth.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/840289429/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/840294393","html_url":"https://github.com/apache/iceberg/pull/2230#issuecomment-840294393","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2230","id":840294393,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MDI5NDM5Mw==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-13T04:47:22Z","updated_at":"2021-05-13T04:47:22Z","author_association":"CONTRIBUTOR","body":"I can help review when you think it's ready. And one more suggestion, because OSS can also refer to any generic object storage service, I think it is clearer to name this with prefix `Aliyun`, such as `AliyunOSSFileIO`. What do you think?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/840294393/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/840351410","html_url":"https://github.com/apache/iceberg/pull/2230#issuecomment-840351410","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2230","id":840351410,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MDM1MTQxMA==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-13T06:45:24Z","updated_at":"2021-05-13T06:45:24Z","author_association":"MEMBER","body":"It will be great if @jackye1995 has any extra bandwith !  Renaming the OSS to `AliyunOSS` sounds good to me,  I'd look around the whole PR to see how could I make this PR to be ready for reviewing.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/840351410/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/840356830","html_url":"https://github.com/apache/iceberg/issues/2586#issuecomment-840356830","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2586","id":840356830,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MDM1NjgzMA==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-13T06:54:19Z","updated_at":"2021-05-13T06:54:47Z","author_association":"CONTRIBUTOR","body":"I'm not necessarily opposed to the idea, but support for geospatial types seems like something that would need to be added to the various query engines (Trino, spark, etc).\r\n\r\nIf they supported geospatial data structures, or if they even had the geospatial functions like postgres-gis does, then I think it would definitely make sense to add support for them into Iceberg.\r\n\r\nHowever, Iceberg is simply a table format for use by the various big data query engines (spark, Trino, flink, hive, ...). Without 1st class support for the geospatial types in those engines, I can't see what you'd be able to do with the stored geometry data types other than fall back to binary or string types for manipulation.\r\n\r\nIt's spark / Trino that is responsible for the query processing. Iceberg is more for the table definition as well as the source and the sink (and occasionally things like specialized joins, specialized commands to update the tables metadata which goes along with being a table definition, etc).\r\n\r\nSo I can't see support for geometric shapes being added into iceberg unless the major query engines that we support added them.\r\n\r\nI know there's spark-gis (spark is very popular so there are many spark libraries), but is geospatial data supported outside of the occasional 3rd party spark lib? Like, does Trino have support for geometry operations (intersections, overlaps, contains, whatever)?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/840356830/reactions","total_count":1,"+1":0,"-1":1,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/840365461","html_url":"https://github.com/apache/iceberg/issues/2557#issuecomment-840365461","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2557","id":840365461,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MDM2NTQ2MQ==","user":{"login":"snazy","id":957468,"node_id":"MDQ6VXNlcjk1NzQ2OA==","avatar_url":"https://avatars.githubusercontent.com/u/957468?v=4","gravatar_id":"","url":"https://api.github.com/users/snazy","html_url":"https://github.com/snazy","followers_url":"https://api.github.com/users/snazy/followers","following_url":"https://api.github.com/users/snazy/following{/other_user}","gists_url":"https://api.github.com/users/snazy/gists{/gist_id}","starred_url":"https://api.github.com/users/snazy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/snazy/subscriptions","organizations_url":"https://api.github.com/users/snazy/orgs","repos_url":"https://api.github.com/users/snazy/repos","events_url":"https://api.github.com/users/snazy/events{/privacy}","received_events_url":"https://api.github.com/users/snazy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-13T07:08:23Z","updated_at":"2021-05-13T07:08:23Z","author_association":"MEMBER","body":"I think, it's fine to \"hide\" these logs by default. Will try to write something that hides the HTTP-access-logs by default.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/840365461/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/840402067","html_url":"https://github.com/apache/iceberg/pull/2584#issuecomment-840402067","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2584","id":840402067,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MDQwMjA2Nw==","user":{"login":"bihaiyang","id":39689341,"node_id":"MDQ6VXNlcjM5Njg5MzQx","avatar_url":"https://avatars.githubusercontent.com/u/39689341?v=4","gravatar_id":"","url":"https://api.github.com/users/bihaiyang","html_url":"https://github.com/bihaiyang","followers_url":"https://api.github.com/users/bihaiyang/followers","following_url":"https://api.github.com/users/bihaiyang/following{/other_user}","gists_url":"https://api.github.com/users/bihaiyang/gists{/gist_id}","starred_url":"https://api.github.com/users/bihaiyang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bihaiyang/subscriptions","organizations_url":"https://api.github.com/users/bihaiyang/orgs","repos_url":"https://api.github.com/users/bihaiyang/repos","events_url":"https://api.github.com/users/bihaiyang/events{/privacy}","received_events_url":"https://api.github.com/users/bihaiyang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-13T08:19:27Z","updated_at":"2021-05-13T08:19:27Z","author_association":"NONE","body":"> > > Thank you very much，I have another question, can you help me answer it：When I'm merge into operation on the same table ，appear error。can i Obtain the state of the table to determine？thanks\r\n> > \r\n> > \r\n> > I'm not sure what are you asking? Are you having a conflict error where it says the merge operation is violating the constraint of another opertaion?\r\n> \r\n> Thank you for your reply ，Yes Yes, that's the kind of mistake，Is there a better solution to this？Or I can get the merge operation state\r\n\r\nthis is  Specific error：\r\n2021-05-13 16:16:50java.sql.SQLException: Error running query: org.apache.iceberg.exceptions.ValidationException: Found conflicting files that can contain records matching true: [alluxio://alluxio-master-0.default.svc.cluster.local:19998/cdp.db/dim_cust_user_mid/data/00000-4074","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/840402067/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/840569396","html_url":"https://github.com/apache/iceberg/pull/2584#issuecomment-840569396","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2584","id":840569396,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MDU2OTM5Ng==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-13T13:41:53Z","updated_at":"2021-05-13T13:41:53Z","author_association":"MEMBER","body":"> > > > Thank you very much，I have another question, can you help me answer it：When I'm merge into operation on the same table ，appear error。can i Obtain the state of the table to determine？thanks\r\n> > > \r\n> > > \r\n> > > I'm not sure what are you asking? Are you having a conflict error where it says the merge operation is violating the constraint of another opertaion?\r\n> > \r\n> > \r\n> > Thank you for your reply ，Yes Yes, that's the kind of mistake，Is there a better solution to this？Or I can get the merge operation state\r\n> \r\n> this is Specific error：\r\n> 2021-05-13 16:16:50java.sql.SQLException: Error running query: org.apache.iceberg.exceptions.ValidationException: Found conflicting files that can contain records matching true: [alluxio://alluxio-master-0.default.svc.cluster.local:19998/cdp.db/dim_cust_user_mid/data/00000-4074\r\n\r\nIt would probably best for you to ask about this on the mailing list, but the issue here is that another operation committed while the Merge was being created. This invalidated the merge that had been created causing it to fail.\r\n\r\nA trivial example\r\n\r\nUser A changes Row (1, 2) to (2, 2)\r\nUser B changes Row (1, 2) to (4, 2)\r\n\r\nIf both users attempt to do this at the same time one must fail, since both operations cannot both have happened. The validation step in iceberg automatically causes whoever finishes second to fail.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/840569396/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/840593904","html_url":"https://github.com/apache/iceberg/issues/2586#issuecomment-840593904","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2586","id":840593904,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MDU5MzkwNA==","user":{"login":"x-malet","id":7076617,"node_id":"MDQ6VXNlcjcwNzY2MTc=","avatar_url":"https://avatars.githubusercontent.com/u/7076617?v=4","gravatar_id":"","url":"https://api.github.com/users/x-malet","html_url":"https://github.com/x-malet","followers_url":"https://api.github.com/users/x-malet/followers","following_url":"https://api.github.com/users/x-malet/following{/other_user}","gists_url":"https://api.github.com/users/x-malet/gists{/gist_id}","starred_url":"https://api.github.com/users/x-malet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/x-malet/subscriptions","organizations_url":"https://api.github.com/users/x-malet/orgs","repos_url":"https://api.github.com/users/x-malet/repos","events_url":"https://api.github.com/users/x-malet/events{/privacy}","received_events_url":"https://api.github.com/users/x-malet/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-13T14:19:55Z","updated_at":"2021-05-13T14:19:55Z","author_association":"NONE","body":"Hi @kbendick, thanks for your answer.  Yeah there is support for geospatial data in Trino ( [trino geospartial func](https://trino.io/docs/current/functions/geospatial.html) ) and spark have now a major projet supported by apache ( [Apache Sedona](http://sedona.apache.org/) )  and the problem is that, ever time you want to process a massive dataset stored in binary, you have to translate it from binary to geometry and  then process it.\r\n\r\nOn the other hand, I think that storing a geometry in a binary format is more exchangeable between systems and allow more flexibility...","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/840593904/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/840613206","html_url":"https://github.com/apache/iceberg/pull/2584#issuecomment-840613206","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2584","id":840613206,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MDYxMzIwNg==","user":{"login":"bihaiyang","id":39689341,"node_id":"MDQ6VXNlcjM5Njg5MzQx","avatar_url":"https://avatars.githubusercontent.com/u/39689341?v=4","gravatar_id":"","url":"https://api.github.com/users/bihaiyang","html_url":"https://github.com/bihaiyang","followers_url":"https://api.github.com/users/bihaiyang/followers","following_url":"https://api.github.com/users/bihaiyang/following{/other_user}","gists_url":"https://api.github.com/users/bihaiyang/gists{/gist_id}","starred_url":"https://api.github.com/users/bihaiyang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bihaiyang/subscriptions","organizations_url":"https://api.github.com/users/bihaiyang/orgs","repos_url":"https://api.github.com/users/bihaiyang/repos","events_url":"https://api.github.com/users/bihaiyang/events{/privacy}","received_events_url":"https://api.github.com/users/bihaiyang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-13T14:49:45Z","updated_at":"2021-05-13T14:49:45Z","author_association":"NONE","body":"> > > > > Thank you very much，I have another question, can you help me answer it：When I'm merge into operation on the same table ，appear error。can i Obtain the state of the table to determine？thanks\r\n> > > > \r\n> > > > \r\n> > > > I'm not sure what are you asking? Are you having a conflict error where it says the merge operation is violating the constraint of another opertaion?\r\n> > > \r\n> > > \r\n> > > Thank you for your reply ，Yes Yes, that's the kind of mistake，Is there a better solution to this？Or I can get the merge operation state\r\n> > \r\n> > \r\n> > this is Specific error：\r\n> > 2021-05-13 16:16:50java.sql.SQLException: Error running query: org.apache.iceberg.exceptions.ValidationException: Found conflicting files that can contain records matching true: [alluxio://alluxio-master-0.default.svc.cluster.local:19998/cdp.db/dim_cust_user_mid/data/00000-4074\r\n> \r\n> It would probably best for you to ask about this on the mailing list, but the issue here is that another operation committed while the Merge was being created. This invalidated the merge that had been created causing it to fail.\r\n> \r\n> A trivial example\r\n> \r\n> User A changes Row (1, 2) to (2, 2)\r\n> User B changes Row (1, 2) to (4, 2)\r\n> \r\n> If both users attempt to do this at the same time one must fail, since both operations cannot both have happened. The validation step in iceberg automatically causes whoever finishes second to fail.\r\n\r\nThank you very much for your reply\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/840613206/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/840735796","html_url":"https://github.com/apache/iceberg/pull/2585#issuecomment-840735796","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2585","id":840735796,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MDczNTc5Ng==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-13T18:08:57Z","updated_at":"2021-05-13T18:08:57Z","author_association":"CONTRIBUTOR","body":"Looks ready to go. Let's wait for tests.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/840735796/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/840772473","html_url":"https://github.com/apache/iceberg/pull/2585#issuecomment-840772473","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2585","id":840772473,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MDc3MjQ3Mw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-13T19:11:06Z","updated_at":"2021-05-13T19:11:06Z","author_association":"CONTRIBUTOR","body":"Thanks, @RussellSpitzer! Thanks for reviewing, @jackye1995 @rdblue @stevenzwu @chenjunjiedada!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/840772473/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/840772481","html_url":"https://github.com/apache/iceberg/pull/2585#issuecomment-840772481","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2585","id":840772481,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MDc3MjQ4MQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-13T19:11:07Z","updated_at":"2021-05-13T19:11:07Z","author_association":"MEMBER","body":"Thanks everybody!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/840772481/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/840821492","html_url":"https://github.com/apache/iceberg/pull/2591#issuecomment-840821492","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2591","id":840821492,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MDgyMTQ5Mg==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-13T20:41:46Z","updated_at":"2021-05-13T20:41:57Z","author_association":"MEMBER","body":"@jackye1995 @rdblue @stevenzwu @chenjunjiedada Here is the big one, Implementation 95% there, tests are in progress","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/840821492/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/840825248","html_url":"https://github.com/apache/iceberg/pull/2592#issuecomment-840825248","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2592","id":840825248,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MDgyNTI0OA==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-13T20:48:49Z","updated_at":"2021-05-13T20:48:49Z","author_association":"CONTRIBUTOR","body":"cc @aokolnychyi @rdblue @RussellSpitzer","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/840825248/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/840856172","html_url":"https://github.com/apache/iceberg/pull/2577#issuecomment-840856172","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2577","id":840856172,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MDg1NjE3Mg==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-13T21:52:00Z","updated_at":"2021-05-13T21:52:19Z","author_association":"CONTRIBUTOR","body":"I think that this can be configured via `spark.locality.wait`. I think if you set it to zero, it will just automatically give up looking for a data local node. At least that's what I've done when reading from S3 with yarn (which is by definition not local).\r\n\r\n```\r\nNumber of milliseconds to wait to launch a data-local task before giving up and launching it on a less-local node.\r\nThe same wait will be used to step through multiple locality levels (process-local, node-local, rack-local and then any).\r\nIt is also possible to customize the waiting time for each level by setting spark.locality.wait.node, etc.\r\nYou should increase this setting if your tasks are long and see poor locality, but the default usually works well.\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/840856172/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/840861832","html_url":"https://github.com/apache/iceberg/pull/2577#issuecomment-840861832","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2577","id":840861832,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MDg2MTgzMg==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-13T22:04:58Z","updated_at":"2021-05-13T22:04:58Z","author_association":"CONTRIBUTOR","body":"Also, if we introduced this, would we be removing the possibility of all of the different locality levels that are provided by Yarn?\r\n\r\nhttps://spark.apache.org/docs/latest/tuning.html#data-locality\r\n\r\nFrom the scheduling configs, you can see that the options provided by spark are much more complex:\r\nhttps://spark.apache.org/docs/latest/configuration.html#scheduling\r\n\r\nspark.locality.wait.node\r\nspark.locality.wait.process\r\nspark.locality.wait.rack\r\n\r\nI think that the 30s upper limit you are seeing is potentially being derived from `spark.scheduler.maxRegisteredResourcesWaitingTime`, which is by default 30s. The docs for that state:\r\n```\r\nMaximum amount of time to wait for resources to register before scheduling begins.\r\n```\r\n\r\nSo I'm guessing that is where the 30s thing came into play (before spark started scheduling tasks).\r\n\r\nCan you try setting spark.locallity.wait.rack or .node and see if that helps? I've only tried this on S3, so I'm not 100% sure if this will help you.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/840861832/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/840902665","html_url":"https://github.com/apache/iceberg/pull/2305#issuecomment-840902665","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2305","id":840902665,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MDkwMjY2NQ==","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-14T00:02:18Z","updated_at":"2021-05-14T00:02:18Z","author_association":"CONTRIBUTOR","body":"@openinx if we are committed to have vectorized reader in `iceberg-flink` that @zhangjun0x01 is working on (PR #2566 ), then I will update this PR and avoid the dep/extension from `FileSourceSplit` and `BulkFormat`. The only reason I did it is to reuse the vectorized readers from Flink.\r\n\r\nI am also wondering if the vectorized readers support deletes filtering? I know Flink vectorized readers impl for sure won't support as it is an Iceberg concept.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/840902665/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/841119237","html_url":"https://github.com/apache/iceberg/issues/2567#issuecomment-841119237","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2567","id":841119237,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MTExOTIzNw==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-14T09:09:39Z","updated_at":"2021-05-14T09:09:39Z","author_association":"CONTRIBUTOR","body":"Thanks @dixingxing0!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/841119237/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/841139053","html_url":"https://github.com/apache/iceberg/issues/2567#issuecomment-841139053","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2567","id":841139053,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MTEzOTA1Mw==","user":{"login":"dixingxing0","id":1303530,"node_id":"MDQ6VXNlcjEzMDM1MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1303530?v=4","gravatar_id":"","url":"https://api.github.com/users/dixingxing0","html_url":"https://github.com/dixingxing0","followers_url":"https://api.github.com/users/dixingxing0/followers","following_url":"https://api.github.com/users/dixingxing0/following{/other_user}","gists_url":"https://api.github.com/users/dixingxing0/gists{/gist_id}","starred_url":"https://api.github.com/users/dixingxing0/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dixingxing0/subscriptions","organizations_url":"https://api.github.com/users/dixingxing0/orgs","repos_url":"https://api.github.com/users/dixingxing0/repos","events_url":"https://api.github.com/users/dixingxing0/events{/privacy}","received_events_url":"https://api.github.com/users/dixingxing0/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-14T09:49:02Z","updated_at":"2021-05-14T09:49:02Z","author_association":"CONTRIBUTOR","body":"Hi @pvary, after i did more testing, i found my solution not working as expected.\r\n\r\nI've return an dummy field with `Integer` type when IcebergRecordObjectInspector#getStructFieldRef  raise 'cannot find field xxx_guid', but `Integer` type can not working with all SQL functions, e.g. CONCAT_WS(xxx_guid, '###') will raise an exception:\r\n```\r\norg.apache.hadoop.hive.ql.exec.UDFArgumentTypeException: Argument 72 of function CONCAT_WS must be \"string or array<string>\"\r\n```\r\n\r\nSo, I think we still need another general solution.\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/841139053/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/841151547","html_url":"https://github.com/apache/iceberg/pull/2584#issuecomment-841151547","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2584","id":841151547,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MTE1MTU0Nw==","user":{"login":"Reo-LEI","id":17312872,"node_id":"MDQ6VXNlcjE3MzEyODcy","avatar_url":"https://avatars.githubusercontent.com/u/17312872?v=4","gravatar_id":"","url":"https://api.github.com/users/Reo-LEI","html_url":"https://github.com/Reo-LEI","followers_url":"https://api.github.com/users/Reo-LEI/followers","following_url":"https://api.github.com/users/Reo-LEI/following{/other_user}","gists_url":"https://api.github.com/users/Reo-LEI/gists{/gist_id}","starred_url":"https://api.github.com/users/Reo-LEI/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Reo-LEI/subscriptions","organizations_url":"https://api.github.com/users/Reo-LEI/orgs","repos_url":"https://api.github.com/users/Reo-LEI/repos","events_url":"https://api.github.com/users/Reo-LEI/events{/privacy}","received_events_url":"https://api.github.com/users/Reo-LEI/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-14T10:13:34Z","updated_at":"2021-05-14T10:13:34Z","author_association":"CONTRIBUTOR","body":"> @Reo-LEI @221770490011111 Could you please take a look?\r\n\r\nThis patch can pass my test case and run correctly on product env. I think this problem is resolved. Thanks for your fix! @RussellSpitzer ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/841151547/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/841165790","html_url":"https://github.com/apache/iceberg/issues/2567#issuecomment-841165790","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2567","id":841165790,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MTE2NTc5MA==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-14T10:43:30Z","updated_at":"2021-05-14T10:44:18Z","author_association":"CONTRIBUTOR","body":"@dixingxing0: By any chance, could you create a failing unit test for it? That would greatly help in fixing the problem. Currently I am not able to repro the issue so first we would need that.\r\n\r\nThanks,\r\nPeter","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/841165790/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/841291217","html_url":"https://github.com/apache/iceberg/issues/2593#issuecomment-841291217","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2593","id":841291217,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MTI5MTIxNw==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-14T14:48:45Z","updated_at":"2021-05-14T14:48:45Z","author_association":"MEMBER","body":"This means 1 of two things,\r\nEither the target of the table is not an Iceberg table, or the Spark Extensions was not set when the session was created.\r\n\r\nIn your case I believe it's number 2, since Spark-Shell already starts up a SparkContext I believe you will in the above code just be deriving a new session from that context, so some of your config options will be treated as runtime rather than as creation time options. This should only be an issue for\r\n`spark.jars.packages` and `spark.sql.extensions`\r\nI believe you should be setting these earlier in the initialization, for spark-shell this means either on the CLI or in a spark-defaults file.\r\n\r\nYou already cover \"spark.jars.packages\" with your --packages command so the only thing to add is \r\n\"--conf spark.sql.extension=org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions\"\r\n\r\nWhich should fix your issue\r\n\r\nSee the docs https://iceberg.apache.org/getting-started/#adding-catalogs \r\nFor an example. \r\n\r\nThe catalogs do not need to be configured before the session is initilzaed so you can leave that code as is if you like but I would recommend setting everything on the CLI or by using\r\nspark.conf.set()\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/841291217/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/841345789","html_url":"https://github.com/apache/iceberg/issues/2593#issuecomment-841345789","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2593","id":841345789,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MTM0NTc4OQ==","user":{"login":"MariusCostin","id":84188720,"node_id":"MDQ6VXNlcjg0MTg4NzIw","avatar_url":"https://avatars.githubusercontent.com/u/84188720?v=4","gravatar_id":"","url":"https://api.github.com/users/MariusCostin","html_url":"https://github.com/MariusCostin","followers_url":"https://api.github.com/users/MariusCostin/followers","following_url":"https://api.github.com/users/MariusCostin/following{/other_user}","gists_url":"https://api.github.com/users/MariusCostin/gists{/gist_id}","starred_url":"https://api.github.com/users/MariusCostin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MariusCostin/subscriptions","organizations_url":"https://api.github.com/users/MariusCostin/orgs","repos_url":"https://api.github.com/users/MariusCostin/repos","events_url":"https://api.github.com/users/MariusCostin/events{/privacy}","received_events_url":"https://api.github.com/users/MariusCostin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-14T16:17:22Z","updated_at":"2021-05-14T16:23:27Z","author_association":"NONE","body":"Thanks Russell for the help. Both tables are iceberg tables as I can read from them and they are saved in S3 with the proper metadata. I might not be doing something correctly or something is not set properly.\r\n\r\nI tried to create the app like you suggested: \r\n\r\nspark-shell --packages org.apache.iceberg:iceberg-spark3-runtime:0.11.1,software.amazon.awssdk:bundle:2.15.40,software.amazon.awssdk:url-connection-client:2.15.40 --conf spark.sql.extension=org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions --conf spark.sql.catalog.spark_catalog=org.apache.iceberg.spark.SparkSessionCatalog --conf spark.sql.catalog.spark_catalog.type=hive --conf spark.sql.catalog.local=org.apache.iceberg.spark.SparkCatalog --conf spark.sql.catalog.local.type=hadoop --conf spark.sql.catalog.local.warehouse=s3://randombucket/iceberg\r\n\r\nSame output as below:\r\n![image](https://user-images.githubusercontent.com/84188720/118298932-cd04fa80-b4e8-11eb-9ab2-290b87b83a9d.png)\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/841345789/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/841375686","html_url":"https://github.com/apache/iceberg/issues/2593#issuecomment-841375686","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2593","id":841375686,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MTM3NTY4Ng==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-14T17:02:25Z","updated_at":"2021-05-14T17:03:15Z","author_association":"MEMBER","body":"Sorry I copied the typo, it's \r\nspark.sql.extensions not spark.sql.extension\r\n\r\nhttps://spark.apache.org/docs/latest/api/java/org/apache/spark/sql/SparkSessionExtensions.html","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/841375686/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/841386263","html_url":"https://github.com/apache/iceberg/pull/2496#issuecomment-841386263","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2496","id":841386263,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MTM4NjI2Mw==","user":{"login":"shenodaguirguis","id":45050883,"node_id":"MDQ6VXNlcjQ1MDUwODgz","avatar_url":"https://avatars.githubusercontent.com/u/45050883?v=4","gravatar_id":"","url":"https://api.github.com/users/shenodaguirguis","html_url":"https://github.com/shenodaguirguis","followers_url":"https://api.github.com/users/shenodaguirguis/followers","following_url":"https://api.github.com/users/shenodaguirguis/following{/other_user}","gists_url":"https://api.github.com/users/shenodaguirguis/gists{/gist_id}","starred_url":"https://api.github.com/users/shenodaguirguis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shenodaguirguis/subscriptions","organizations_url":"https://api.github.com/users/shenodaguirguis/orgs","repos_url":"https://api.github.com/users/shenodaguirguis/repos","events_url":"https://api.github.com/users/shenodaguirguis/events{/privacy}","received_events_url":"https://api.github.com/users/shenodaguirguis/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-14T17:14:42Z","updated_at":"2021-05-17T16:48:35Z","author_association":"NONE","body":"hi @RussellSpitzer , @rymurr @shardulm94, I worked on a prototype to verify the planned changes will fix the issue, and I created a draft-PR to share, for reference. This prototype  gives an idea how things will look like.  I also tested complex types in this prototype Here it is: https://github.com/linkedin/iceberg/pull/70\r\n(note: I skipped the ser/deser code changes in that prototype).  \r\n\r\nI have just pushed a new commit to this PR, after addressing the comments. This also reflects the commit we merged to the linkedin branch.  Please take a look.\r\nCC: @wmoustafa ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/841386263/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/841430136","html_url":"https://github.com/apache/iceberg/pull/2520#issuecomment-841430136","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2520","id":841430136,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MTQzMDEzNg==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-14T18:39:46Z","updated_at":"2021-05-14T18:39:46Z","author_association":"CONTRIBUTOR","body":"Sorry I was a bit distracted and did not update this PR for a while.\r\n\r\n@rdblue thanks for the suggestion for refactoring, I actually thought about the approach you considered, and my major concern is that we are creating 2 different code paths for using or not using encryption. On the other hand, for data file encryption, Iceberg is currently having a single unified code path for always using encryption, with the default encryption manager to be the plaintext manager. I think it would be good to keep things consistent. \r\n\r\nI completely agree that the use of a global default encryption manager class is not necessary, and I will remove that. What I hope to achieve is that the method `ManifestFiles.read(ManifestFile manifest, FileIO io, Map<Integer, PartitionSpec> specsById)` is completely not used and deprecated, and all the callers should use the method with encryption, and supply `table.encryption()` as the input to the encryption manager. I was trying to avoid too many single line changes in this PR, but my final intention became not clear, so I will update based on that and we can reevaluate the situation.\r\n\r\nFor what @flyrain and @RussellSpitzer concern, I think I can make it better by directly passing in `EncryptedOutputFIle.encryptingOutputFile()` to minimize interface change, will notify you guys once I update.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/841430136/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/841445736","html_url":"https://github.com/apache/iceberg/issues/2593#issuecomment-841445736","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2593","id":841445736,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MTQ0NTczNg==","user":{"login":"MariusCostin","id":84188720,"node_id":"MDQ6VXNlcjg0MTg4NzIw","avatar_url":"https://avatars.githubusercontent.com/u/84188720?v=4","gravatar_id":"","url":"https://api.github.com/users/MariusCostin","html_url":"https://github.com/MariusCostin","followers_url":"https://api.github.com/users/MariusCostin/followers","following_url":"https://api.github.com/users/MariusCostin/following{/other_user}","gists_url":"https://api.github.com/users/MariusCostin/gists{/gist_id}","starred_url":"https://api.github.com/users/MariusCostin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MariusCostin/subscriptions","organizations_url":"https://api.github.com/users/MariusCostin/orgs","repos_url":"https://api.github.com/users/MariusCostin/repos","events_url":"https://api.github.com/users/MariusCostin/events{/privacy}","received_events_url":"https://api.github.com/users/MariusCostin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-14T19:07:18Z","updated_at":"2021-05-14T19:07:18Z","author_association":"NONE","body":"Thanks Russell, that was it! ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/841445736/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/841477504","html_url":"https://github.com/apache/iceberg/pull/2595#issuecomment-841477504","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2595","id":841477504,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MTQ3NzUwNA==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-14T20:13:46Z","updated_at":"2021-05-14T20:13:46Z","author_association":"CONTRIBUTOR","body":"cc @aokolnychyi @RussellSpitzer @flyrain @karuppayya @raptond @rdblue ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/841477504/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/841538934","html_url":"https://github.com/apache/iceberg/pull/2520#issuecomment-841538934","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2520","id":841538934,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MTUzODkzNA==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-14T22:50:18Z","updated_at":"2021-05-14T22:54:05Z","author_association":"CONTRIBUTOR","body":"@rdblue @flyrain @RussellSpitzer I have updated this PR with all the changes I expected to make in several PRs, it is a lot of files but I think it makes the discussion much easier to show them in a single place.\r\n\r\nThe key thing we need to determine is: should we separate the code path for manifest read/write with and without encryption. My stand is that we should not separate it, because:\r\n1. data file read/write does not separate it\r\n2. managing things in a single  code path is much easier in long run\r\n\r\nWith this assumption, the key principles I followed for the changes are:\r\n1. for every method in `ManifestFiles`, create a new version that takes encryption manager, and deprecate the old methods\r\n2. change the callers of old methods all the way to the top, and deprecate any related public methods.\r\n3. use `EncryptionManagers.plaintext()` for all those deprecated methods so that we don't create a lot of redundant plain text manager.\r\n\r\nRegarding the concern brought up by @RussellSpitzer and @flyrain , my current take is that we have to pass `EncryptedOutputFile` all the way down to the place where the `encryptedOutputFile.keyMetadata()` is written by the engine to the actual manifest list. This does make the naming a bit awkward as @flyrain suggested, but I think this is the same strategy taken by the data file write path, where we can notice that the `FileAppenderFactory` also have those methods containing `EncryptedOutputFile` for exactly the same purpose.\r\n\r\nRegarding `EncryptionManagers` that @rdblue talked about removing, as I said in point 3 before, now I am treating it as the static factory to get a plain text manager singleton and that is only used for deprecated methods. I do expect to have a second usage of the factory, similar to `LocationProviders`, to add a method `EncryptionManagers.load(...)` to load a custom encryption manager and allow a `Catalog` to initialize a custom encryption manager for a `TableOperations`.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/841538934/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/841585247","html_url":"https://github.com/apache/iceberg/pull/2520#issuecomment-841585247","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2520","id":841585247,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MTU4NTI0Nw==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-15T02:18:21Z","updated_at":"2021-05-15T02:18:21Z","author_association":"CONTRIBUTOR","body":"restart test","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/841585247/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/841749911","html_url":"https://github.com/apache/iceberg/issues/2308#issuecomment-841749911","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2308","id":841749911,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MTc0OTkxMQ==","user":{"login":"moon-fall","id":7753372,"node_id":"MDQ6VXNlcjc3NTMzNzI=","avatar_url":"https://avatars.githubusercontent.com/u/7753372?v=4","gravatar_id":"","url":"https://api.github.com/users/moon-fall","html_url":"https://github.com/moon-fall","followers_url":"https://api.github.com/users/moon-fall/followers","following_url":"https://api.github.com/users/moon-fall/following{/other_user}","gists_url":"https://api.github.com/users/moon-fall/gists{/gist_id}","starred_url":"https://api.github.com/users/moon-fall/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/moon-fall/subscriptions","organizations_url":"https://api.github.com/users/moon-fall/orgs","repos_url":"https://api.github.com/users/moon-fall/repos","events_url":"https://api.github.com/users/moon-fall/events{/privacy}","received_events_url":"https://api.github.com/users/moon-fall/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-16T01:23:12Z","updated_at":"2021-05-16T01:23:12Z","author_association":"CONTRIBUTOR","body":"I encountering this data error problem when i start a flink job to write data and another to RewriteFiles，I also think the rewritten files should use the old seqNum，I don't find PR for this issue .Has the plan been decided on? I think it's necessary to solve this problem.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/841749911/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/841821197","html_url":"https://github.com/apache/iceberg/issues/2357#issuecomment-841821197","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2357","id":841821197,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MTgyMTE5Nw==","user":{"login":"minchowang","id":33626973,"node_id":"MDQ6VXNlcjMzNjI2OTcz","avatar_url":"https://avatars.githubusercontent.com/u/33626973?v=4","gravatar_id":"","url":"https://api.github.com/users/minchowang","html_url":"https://github.com/minchowang","followers_url":"https://api.github.com/users/minchowang/followers","following_url":"https://api.github.com/users/minchowang/following{/other_user}","gists_url":"https://api.github.com/users/minchowang/gists{/gist_id}","starred_url":"https://api.github.com/users/minchowang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/minchowang/subscriptions","organizations_url":"https://api.github.com/users/minchowang/orgs","repos_url":"https://api.github.com/users/minchowang/repos","events_url":"https://api.github.com/users/minchowang/events{/privacy}","received_events_url":"https://api.github.com/users/minchowang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-16T13:56:48Z","updated_at":"2021-05-16T13:56:48Z","author_association":"NONE","body":"@junsionzhang Hi, zhangjun.  How did you solve the problem that create iceberg table in the hive ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/841821197/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/841885028","html_url":"https://github.com/apache/iceberg/pull/2565#issuecomment-841885028","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2565","id":841885028,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MTg4NTAyOA==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-16T22:14:41Z","updated_at":"2021-05-16T22:14:41Z","author_association":"CONTRIBUTOR","body":"We have merged the hive doc PR, so I have added updates based on that.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/841885028/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/841925758","html_url":"https://github.com/apache/iceberg/pull/2577#issuecomment-841925758","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2577","id":841925758,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MTkyNTc1OA==","user":{"login":"jshmchenxi","id":11854435,"node_id":"MDQ6VXNlcjExODU0NDM1","avatar_url":"https://avatars.githubusercontent.com/u/11854435?v=4","gravatar_id":"","url":"https://api.github.com/users/jshmchenxi","html_url":"https://github.com/jshmchenxi","followers_url":"https://api.github.com/users/jshmchenxi/followers","following_url":"https://api.github.com/users/jshmchenxi/following{/other_user}","gists_url":"https://api.github.com/users/jshmchenxi/gists{/gist_id}","starred_url":"https://api.github.com/users/jshmchenxi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jshmchenxi/subscriptions","organizations_url":"https://api.github.com/users/jshmchenxi/orgs","repos_url":"https://api.github.com/users/jshmchenxi/repos","events_url":"https://api.github.com/users/jshmchenxi/events{/privacy}","received_events_url":"https://api.github.com/users/jshmchenxi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-17T01:57:32Z","updated_at":"2021-05-17T01:57:32Z","author_association":"CONTRIBUTOR","body":"@kbendick Hi! Thank you for your kind suggestion!\r\nI looked through the problem and found that the delay happens during spark-sql planning phase (eg. before the spark job was started).\r\nThe `spark.locality.wait.*` configurations should take effect during the spark job lifetime, so I'm afraid it cannot help with the problem.\r\nI've added multi-threaded mechanism for ReadTask initialize to solve this. Would you have another look? Thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/841925758/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/841934851","html_url":"https://github.com/apache/iceberg/pull/2577#issuecomment-841934851","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2577","id":841934851,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MTkzNDg1MQ==","user":{"login":"jshmchenxi","id":11854435,"node_id":"MDQ6VXNlcjExODU0NDM1","avatar_url":"https://avatars.githubusercontent.com/u/11854435?v=4","gravatar_id":"","url":"https://api.github.com/users/jshmchenxi","html_url":"https://github.com/jshmchenxi","followers_url":"https://api.github.com/users/jshmchenxi/followers","following_url":"https://api.github.com/users/jshmchenxi/following{/other_user}","gists_url":"https://api.github.com/users/jshmchenxi/gists{/gist_id}","starred_url":"https://api.github.com/users/jshmchenxi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jshmchenxi/subscriptions","organizations_url":"https://api.github.com/users/jshmchenxi/orgs","repos_url":"https://api.github.com/users/jshmchenxi/repos","events_url":"https://api.github.com/users/jshmchenxi/events{/privacy}","received_events_url":"https://api.github.com/users/jshmchenxi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-17T02:23:02Z","updated_at":"2021-05-17T08:02:47Z","author_association":"CONTRIBUTOR","body":"@openinx  @rdblue  Hi, this could be a performance bottleneck when reading iceberg table with spark-sql. Would you have a look, please?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/841934851/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/841936884","html_url":"https://github.com/apache/iceberg/pull/2584#issuecomment-841936884","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2584","id":841936884,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MTkzNjg4NA==","user":{"login":"bihaiyang","id":39689341,"node_id":"MDQ6VXNlcjM5Njg5MzQx","avatar_url":"https://avatars.githubusercontent.com/u/39689341?v=4","gravatar_id":"","url":"https://api.github.com/users/bihaiyang","html_url":"https://github.com/bihaiyang","followers_url":"https://api.github.com/users/bihaiyang/followers","following_url":"https://api.github.com/users/bihaiyang/following{/other_user}","gists_url":"https://api.github.com/users/bihaiyang/gists{/gist_id}","starred_url":"https://api.github.com/users/bihaiyang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bihaiyang/subscriptions","organizations_url":"https://api.github.com/users/bihaiyang/orgs","repos_url":"https://api.github.com/users/bihaiyang/repos","events_url":"https://api.github.com/users/bihaiyang/events{/privacy}","received_events_url":"https://api.github.com/users/bihaiyang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-17T02:29:20Z","updated_at":"2021-05-17T02:29:20Z","author_association":"NONE","body":"> > @Reo-LEI @221770490011111 Could you please take a look?\r\n> \r\n> This patch can pass my test case and run correctly on product env. I think this problem is resolved. Thanks for your fix! @RussellSpitzer\r\n\r\nAwesome!! Are you using this branch RussellSpitzer:FixDynamicFilterEmptyMerge？@Reo-LEI","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/841936884/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/841939131","html_url":"https://github.com/apache/iceberg/pull/2584#issuecomment-841939131","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2584","id":841939131,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MTkzOTEzMQ==","user":{"login":"Reo-LEI","id":17312872,"node_id":"MDQ6VXNlcjE3MzEyODcy","avatar_url":"https://avatars.githubusercontent.com/u/17312872?v=4","gravatar_id":"","url":"https://api.github.com/users/Reo-LEI","html_url":"https://github.com/Reo-LEI","followers_url":"https://api.github.com/users/Reo-LEI/followers","following_url":"https://api.github.com/users/Reo-LEI/following{/other_user}","gists_url":"https://api.github.com/users/Reo-LEI/gists{/gist_id}","starred_url":"https://api.github.com/users/Reo-LEI/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Reo-LEI/subscriptions","organizations_url":"https://api.github.com/users/Reo-LEI/orgs","repos_url":"https://api.github.com/users/Reo-LEI/repos","events_url":"https://api.github.com/users/Reo-LEI/events{/privacy}","received_events_url":"https://api.github.com/users/Reo-LEI/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-17T02:36:23Z","updated_at":"2021-05-17T02:36:23Z","author_association":"CONTRIBUTOR","body":"> > > @Reo-LEI @221770490011111 Could you please take a look?\r\n> > \r\n> > \r\n> > This patch can pass my test case and run correctly on product env. I think this problem is resolved. Thanks for your fix! @RussellSpitzer\r\n> \r\n> Awesome!! Are you using this branch RussellSpitzer:FixDynamicFilterEmptyMerge？@Reo-LEI\r\n\r\nNope, I maintain an internal branch, and merge this PR into my branch.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/841939131/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/841972814","html_url":"https://github.com/apache/iceberg/pull/2565#issuecomment-841972814","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2565","id":841972814,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MTk3MjgxNA==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-17T04:20:12Z","updated_at":"2021-05-17T04:20:12Z","author_association":"CONTRIBUTOR","body":"@pvary @marton-bod updated and fixed all tests, should be good for another review, thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/841972814/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/842005197","html_url":"https://github.com/apache/iceberg/pull/2584#issuecomment-842005197","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2584","id":842005197,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MjAwNTE5Nw==","user":{"login":"bihaiyang","id":39689341,"node_id":"MDQ6VXNlcjM5Njg5MzQx","avatar_url":"https://avatars.githubusercontent.com/u/39689341?v=4","gravatar_id":"","url":"https://api.github.com/users/bihaiyang","html_url":"https://github.com/bihaiyang","followers_url":"https://api.github.com/users/bihaiyang/followers","following_url":"https://api.github.com/users/bihaiyang/following{/other_user}","gists_url":"https://api.github.com/users/bihaiyang/gists{/gist_id}","starred_url":"https://api.github.com/users/bihaiyang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bihaiyang/subscriptions","organizations_url":"https://api.github.com/users/bihaiyang/orgs","repos_url":"https://api.github.com/users/bihaiyang/repos","events_url":"https://api.github.com/users/bihaiyang/events{/privacy}","received_events_url":"https://api.github.com/users/bihaiyang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-17T05:41:25Z","updated_at":"2021-05-17T05:41:25Z","author_association":"NONE","body":"> > > > @Reo-LEI @221770490011111 Could you please take a look?\r\n> > > \r\n> > > \r\n> > > This patch can pass my test case and run correctly on product env. I think this problem is resolved. Thanks for your fix! @RussellSpitzer\r\n> > \r\n> > \r\n> > Awesome!! Are you using this branch RussellSpitzer:FixDynamicFilterEmptyMerge？@Reo-LEI\r\n> \r\n> Nope, I maintain an internal branch, and merge this PR into my branch.\r\n\r\nthanks","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/842005197/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/842367150","html_url":"https://github.com/apache/iceberg/pull/2551#issuecomment-842367150","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2551","id":842367150,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MjM2NzE1MA==","user":{"login":"gszadovszky","id":20421188,"node_id":"MDQ6VXNlcjIwNDIxMTg4","avatar_url":"https://avatars.githubusercontent.com/u/20421188?v=4","gravatar_id":"","url":"https://api.github.com/users/gszadovszky","html_url":"https://github.com/gszadovszky","followers_url":"https://api.github.com/users/gszadovszky/followers","following_url":"https://api.github.com/users/gszadovszky/following{/other_user}","gists_url":"https://api.github.com/users/gszadovszky/gists{/gist_id}","starred_url":"https://api.github.com/users/gszadovszky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gszadovszky/subscriptions","organizations_url":"https://api.github.com/users/gszadovszky/orgs","repos_url":"https://api.github.com/users/gszadovszky/repos","events_url":"https://api.github.com/users/gszadovszky/events{/privacy}","received_events_url":"https://api.github.com/users/gszadovszky/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-17T14:22:46Z","updated_at":"2021-05-17T14:22:46Z","author_association":"CONTRIBUTOR","body":"I think, it is fine to extend the API with package-private methods for testing purposes. It makes the testing simpler and easier to implement. Meanwhile, I am open to invest on writing the test without the need of this extension if you think it is required.\r\n@rdblue, what do you think?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/842367150/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/842471467","html_url":"https://github.com/apache/iceberg/pull/2584#issuecomment-842471467","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2584","id":842471467,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MjQ3MTQ2Nw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-17T16:40:17Z","updated_at":"2021-05-17T16:40:17Z","author_association":"CONTRIBUTOR","body":"This has been open for a while. I think it is a safe solution for now but we should reconsider our dynamic filters in the future.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/842471467/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/842471648","html_url":"https://github.com/apache/iceberg/pull/2584#issuecomment-842471648","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2584","id":842471648,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MjQ3MTY0OA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-17T16:40:35Z","updated_at":"2021-05-17T16:40:35Z","author_association":"CONTRIBUTOR","body":"Thanks, @RussellSpitzer! Thanks for reviewing, @kbendick!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/842471648/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/842503304","html_url":"https://github.com/apache/iceberg/pull/2551#issuecomment-842503304","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2551","id":842503304,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MjUwMzMwNA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-17T17:30:02Z","updated_at":"2021-05-17T17:30:02Z","author_association":"CONTRIBUTOR","body":"@gszadovszky, I think the package-private method is fine. But we need to make sure that this doesn't stop testing v1 since that's what people primarily use. Could you add v1/v2 as a test parameter so all the tests run on both?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/842503304/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/842538769","html_url":"https://github.com/apache/iceberg/issues/2599#issuecomment-842538769","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2599","id":842538769,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MjUzODc2OQ==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-17T18:27:50Z","updated_at":"2021-05-17T18:27:50Z","author_association":"CONTRIBUTOR","body":"This probably only comes up in the MetadataTable class, so not sure if it would be easier to update the base class or just that one place. I will take a look and submit a patch.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/842538769/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/842693596","html_url":"https://github.com/apache/iceberg/pull/2564#issuecomment-842693596","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2564","id":842693596,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MjY5MzU5Ng==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-17T22:54:06Z","updated_at":"2021-05-17T22:54:06Z","author_association":"CONTRIBUTOR","body":"Thanks, @karuppayya! Thanks for reviewing, @flyrain @kbendick @RussellSpitzer!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/842693596/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/842712499","html_url":"https://github.com/apache/iceberg/pull/2600#issuecomment-842712499","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2600","id":842712499,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MjcxMjQ5OQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-17T23:36:07Z","updated_at":"2021-05-17T23:36:07Z","author_association":"CONTRIBUTOR","body":"Thanks, @RussellSpitzer!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/842712499/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/842716939","html_url":"https://github.com/apache/iceberg/pull/2577#issuecomment-842716939","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2577","id":842716939,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MjcxNjkzOQ==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-17T23:48:24Z","updated_at":"2021-05-17T23:48:24Z","author_association":"CONTRIBUTOR","body":"> @kbendick Hi! Thank you for your kind suggestion!\r\n> I looked through the problem and found that the delay happens during spark-sql planning phase (eg. before the spark job was started).\r\n> The `spark.locality.wait.*` configurations should take effect during the spark job lifetime, so I'm afraid it cannot help with the problem.\r\n> I've added multi-threaded mechanism for ReadTask initialize to solve this. Would you have another look? Thanks!\r\n\r\nAh ok. That makes sense re: the current spark.locality.wait.* entries. I will try to take a look at this later today, but I might not be the best person to be reviewing this portion of the code. Will give it a look though.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/842716939/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/842750725","html_url":"https://github.com/apache/iceberg/pull/2410#issuecomment-842750725","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2410","id":842750725,"node_id":"MDEyOklzc3VlQ29tbWVudDg0Mjc1MDcyNQ==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-18T01:20:17Z","updated_at":"2021-05-18T01:20:17Z","author_association":"MEMBER","body":"@stevenzwu @jackye1995 , any other concerns ? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/842750725/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/842804809","html_url":"https://github.com/apache/iceberg/issues/2481#issuecomment-842804809","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2481","id":842804809,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MjgwNDgwOQ==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-18T03:52:52Z","updated_at":"2021-05-18T03:52:52Z","author_association":"CONTRIBUTOR","body":"Yeah this is a common case that I also see many people trying to achieve through Iceberg. \r\n\r\nFor exposing to Spark and Hive, would view help? We can create \"snapshot view\" for people to query, for example:\r\n\r\n```sql\r\nCREATE VIEW my_table_2020 AS SELECT * FROM my_table@1234567890;\r\n```\r\n\r\nThen dropping the view would not affect anything of the underlying snapshot.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/842804809/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/842805725","html_url":"https://github.com/apache/iceberg/issues/2482#issuecomment-842805725","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2482","id":842805725,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MjgwNTcyNQ==","user":{"login":"jshmchenxi","id":11854435,"node_id":"MDQ6VXNlcjExODU0NDM1","avatar_url":"https://avatars.githubusercontent.com/u/11854435?v=4","gravatar_id":"","url":"https://api.github.com/users/jshmchenxi","html_url":"https://github.com/jshmchenxi","followers_url":"https://api.github.com/users/jshmchenxi/followers","following_url":"https://api.github.com/users/jshmchenxi/following{/other_user}","gists_url":"https://api.github.com/users/jshmchenxi/gists{/gist_id}","starred_url":"https://api.github.com/users/jshmchenxi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jshmchenxi/subscriptions","organizations_url":"https://api.github.com/users/jshmchenxi/orgs","repos_url":"https://api.github.com/users/jshmchenxi/repos","events_url":"https://api.github.com/users/jshmchenxi/events{/privacy}","received_events_url":"https://api.github.com/users/jshmchenxi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-18T03:56:13Z","updated_at":"2021-05-18T03:56:13Z","author_association":"CONTRIBUTOR","body":"@openinx Hi, we have also run into this problem. \r\nDo you think it a good idea when expiring a snapshot, we should set the `parentId` of its children to `null`? \r\nIn this way the validation can succeed and since parent snapshot is expired, setting `parentId` to `null` might be reasonable.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/842805725/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/842815033","html_url":"https://github.com/apache/iceberg/issues/2602#issuecomment-842815033","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2602","id":842815033,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MjgxNTAzMw==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-18T04:26:12Z","updated_at":"2021-05-18T04:26:12Z","author_association":"MEMBER","body":"Probably https://github.com/apache/iceberg/issues/2317\r\nWill be fixed in the next major release (0.12), but you can always backport the fix now or do your own local release.\r\n\r\nYou can also recover (somewhat) by altering the table's metadata.json property to point towards an older metadata.json file","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/842815033/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/842816241","html_url":"https://github.com/apache/iceberg/issues/2481#issuecomment-842816241","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2481","id":842816241,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MjgxNjI0MQ==","user":{"login":"jzhuge","id":1883812,"node_id":"MDQ6VXNlcjE4ODM4MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1883812?v=4","gravatar_id":"","url":"https://api.github.com/users/jzhuge","html_url":"https://github.com/jzhuge","followers_url":"https://api.github.com/users/jzhuge/followers","following_url":"https://api.github.com/users/jzhuge/following{/other_user}","gists_url":"https://api.github.com/users/jzhuge/gists{/gist_id}","starred_url":"https://api.github.com/users/jzhuge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jzhuge/subscriptions","organizations_url":"https://api.github.com/users/jzhuge/orgs","repos_url":"https://api.github.com/users/jzhuge/repos","events_url":"https://api.github.com/users/jzhuge/events{/privacy}","received_events_url":"https://api.github.com/users/jzhuge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-18T04:29:57Z","updated_at":"2021-05-18T04:29:57Z","author_association":"MEMBER","body":"If Iceberg's TableCatalog also supports ViewCatalog, we may be able to create this \"snapshot\" view on the fly.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/842816241/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/842885930","html_url":"https://github.com/apache/iceberg/issues/2482#issuecomment-842885930","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2482","id":842885930,"node_id":"MDEyOklzc3VlQ29tbWVudDg0Mjg4NTkzMA==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-18T06:29:00Z","updated_at":"2021-05-18T06:29:00Z","author_association":"MEMBER","body":"> Do you think it a good idea when expiring a snapshot, we should set the parentId of its children to null?\r\n\r\nI think setting the parentId to be null could be one of the solution, but I'd like to check what's the specific PR if you have one.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/842885930/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/842886389","html_url":"https://github.com/apache/iceberg/issues/2602#issuecomment-842886389","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2602","id":842886389,"node_id":"MDEyOklzc3VlQ29tbWVudDg0Mjg4NjM4OQ==","user":{"login":"coolderli","id":38486782,"node_id":"MDQ6VXNlcjM4NDg2Nzgy","avatar_url":"https://avatars.githubusercontent.com/u/38486782?v=4","gravatar_id":"","url":"https://api.github.com/users/coolderli","html_url":"https://github.com/coolderli","followers_url":"https://api.github.com/users/coolderli/followers","following_url":"https://api.github.com/users/coolderli/following{/other_user}","gists_url":"https://api.github.com/users/coolderli/gists{/gist_id}","starred_url":"https://api.github.com/users/coolderli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coolderli/subscriptions","organizations_url":"https://api.github.com/users/coolderli/orgs","repos_url":"https://api.github.com/users/coolderli/repos","events_url":"https://api.github.com/users/coolderli/events{/privacy}","received_events_url":"https://api.github.com/users/coolderli/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-18T06:29:43Z","updated_at":"2021-05-18T06:29:43Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer  I have merged  #2317 and #2328. In my case, It will return FAILURE status not UNKNOWN status. I think it can be solved by more retries, In #2596, I tried to put check-status in TableProperties. \r\nMaybe It could always return UNKNOWN when committed failed, or return FAILURE but not delete files.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/842886389/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/842891794","html_url":"https://github.com/apache/iceberg/issues/2456#issuecomment-842891794","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2456","id":842891794,"node_id":"MDEyOklzc3VlQ29tbWVudDg0Mjg5MTc5NA==","user":{"login":"coolderli","id":38486782,"node_id":"MDQ6VXNlcjM4NDg2Nzgy","avatar_url":"https://avatars.githubusercontent.com/u/38486782?v=4","gravatar_id":"","url":"https://api.github.com/users/coolderli","html_url":"https://github.com/coolderli","followers_url":"https://api.github.com/users/coolderli/followers","following_url":"https://api.github.com/users/coolderli/following{/other_user}","gists_url":"https://api.github.com/users/coolderli/gists{/gist_id}","starred_url":"https://api.github.com/users/coolderli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coolderli/subscriptions","organizations_url":"https://api.github.com/users/coolderli/orgs","repos_url":"https://api.github.com/users/coolderli/repos","events_url":"https://api.github.com/users/coolderli/events{/privacy}","received_events_url":"https://api.github.com/users/coolderli/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-18T06:37:37Z","updated_at":"2021-05-18T06:37:37Z","author_association":"CONTRIBUTOR","body":"I have the same problem. Is this check too strict？Can we provide a configuration to turn off this check？","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/842891794/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/842934448","html_url":"https://github.com/apache/iceberg/issues/2482#issuecomment-842934448","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2482","id":842934448,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MjkzNDQ0OA==","user":{"login":"jshmchenxi","id":11854435,"node_id":"MDQ6VXNlcjExODU0NDM1","avatar_url":"https://avatars.githubusercontent.com/u/11854435?v=4","gravatar_id":"","url":"https://api.github.com/users/jshmchenxi","html_url":"https://github.com/jshmchenxi","followers_url":"https://api.github.com/users/jshmchenxi/followers","following_url":"https://api.github.com/users/jshmchenxi/following{/other_user}","gists_url":"https://api.github.com/users/jshmchenxi/gists{/gist_id}","starred_url":"https://api.github.com/users/jshmchenxi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jshmchenxi/subscriptions","organizations_url":"https://api.github.com/users/jshmchenxi/orgs","repos_url":"https://api.github.com/users/jshmchenxi/repos","events_url":"https://api.github.com/users/jshmchenxi/events{/privacy}","received_events_url":"https://api.github.com/users/jshmchenxi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-18T07:38:34Z","updated_at":"2021-05-18T07:38:34Z","author_association":"CONTRIBUTOR","body":"@openinx I have created a PR and will test it in our environment.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/842934448/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/842937212","html_url":"https://github.com/apache/iceberg/pull/2598#issuecomment-842937212","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2598","id":842937212,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MjkzNzIxMg==","user":{"login":"marton-bod","id":19599214,"node_id":"MDQ6VXNlcjE5NTk5MjE0","avatar_url":"https://avatars.githubusercontent.com/u/19599214?v=4","gravatar_id":"","url":"https://api.github.com/users/marton-bod","html_url":"https://github.com/marton-bod","followers_url":"https://api.github.com/users/marton-bod/followers","following_url":"https://api.github.com/users/marton-bod/following{/other_user}","gists_url":"https://api.github.com/users/marton-bod/gists{/gist_id}","starred_url":"https://api.github.com/users/marton-bod/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marton-bod/subscriptions","organizations_url":"https://api.github.com/users/marton-bod/orgs","repos_url":"https://api.github.com/users/marton-bod/repos","events_url":"https://api.github.com/users/marton-bod/events{/privacy}","received_events_url":"https://api.github.com/users/marton-bod/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-18T07:42:59Z","updated_at":"2021-05-18T07:42:59Z","author_association":"COLLABORATOR","body":"Thanks for this patch! I think the refactor makes sense, even if there were no classpath issues. One thing though, I think we should also add their opposite, serialization operations into this new class. For example, we serialize the table into the config in `HiveIcebergStorageHandler#overlayTableProperties`, which would now belong more naturally to this util class as well.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/842937212/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/842960211","html_url":"https://github.com/apache/iceberg/pull/2551#issuecomment-842960211","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2551","id":842960211,"node_id":"MDEyOklzc3VlQ29tbWVudDg0Mjk2MDIxMQ==","user":{"login":"gszadovszky","id":20421188,"node_id":"MDQ6VXNlcjIwNDIxMTg4","avatar_url":"https://avatars.githubusercontent.com/u/20421188?v=4","gravatar_id":"","url":"https://api.github.com/users/gszadovszky","html_url":"https://github.com/gszadovszky","followers_url":"https://api.github.com/users/gszadovszky/followers","following_url":"https://api.github.com/users/gszadovszky/following{/other_user}","gists_url":"https://api.github.com/users/gszadovszky/gists{/gist_id}","starred_url":"https://api.github.com/users/gszadovszky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gszadovszky/subscriptions","organizations_url":"https://api.github.com/users/gszadovszky/orgs","repos_url":"https://api.github.com/users/gszadovszky/repos","events_url":"https://api.github.com/users/gszadovszky/events{/privacy}","received_events_url":"https://api.github.com/users/gszadovszky/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-18T08:16:23Z","updated_at":"2021-05-18T08:16:23Z","author_association":"CONTRIBUTOR","body":"Thanks @rdblue. I've thought v1/v2 is irrelevant for this test but I agree it is better to be on the safe side and it's a good idea to add writer version as a test parameter. I'll make this change soon.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/842960211/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843019974","html_url":"https://github.com/apache/iceberg/pull/2565#issuecomment-843019974","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2565","id":843019974,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MzAxOTk3NA==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-18T09:40:14Z","updated_at":"2021-05-18T09:40:14Z","author_association":"CONTRIBUTOR","body":"@lcspinter: could you please take a look, as you are to one most familiar with this code now?\r\n\r\nThanks,\r\nPeter","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843019974/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843037824","html_url":"https://github.com/apache/iceberg/pull/2410#issuecomment-843037824","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2410","id":843037824,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MzAzNzgyNA==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-18T10:06:56Z","updated_at":"2021-05-18T10:06:56Z","author_association":"MEMBER","body":"We got one +1 from apache flink expert (@stevenzwu ) and  +1 from iceberg community (@jackye1995 ) , and there's no other available iceberg committers with good flink+iceberg background now,  so I've got this PR merged in case of blocking this feature too long.   If anyone has other concern,  we could discuss in the next PR. Thanks.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843037824/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843050008","html_url":"https://github.com/apache/iceberg/issues/2601#issuecomment-843050008","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2601","id":843050008,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MzA1MDAwOA==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-18T10:23:04Z","updated_at":"2021-05-18T10:23:04Z","author_association":"CONTRIBUTOR","body":"@rakeshsayini: Which version of Hive, Iceberg are you using?\r\nAlso, are you using MR or Tez as the execution engine?\r\n\r\nThe issue seems like #2171 which should be fixed by TEZ-4248.\r\n\r\nCC: @marton-bod \r\n\r\nThanks,\r\nPeter","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843050008/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843061972","html_url":"https://github.com/apache/iceberg/issues/2481#issuecomment-843061972","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2481","id":843061972,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MzA2MTk3Mg==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-18T10:43:37Z","updated_at":"2021-05-18T10:43:37Z","author_association":"CONTRIBUTOR","body":"@jackye1995: In Hive currently there is no way to parse `my_table@1234567890`. I suspect that in Spark this would mean something like `my_table` with snapshotId=`1234567890`. Am I right?\r\n\r\n@jzhuge: What is `ViewCatalog`? Is it a Spark interface we should implement?\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843061972/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843068762","html_url":"https://github.com/apache/iceberg/pull/2598#issuecomment-843068762","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2598","id":843068762,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MzA2ODc2Mg==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-18T10:53:40Z","updated_at":"2021-05-18T10:53:40Z","author_association":"CONTRIBUTOR","body":"+1 on keeping the serialization / deserialization in one place.\r\n\r\nOtherwise looks good to me","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843068762/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843088341","html_url":"https://github.com/apache/iceberg/pull/2565#issuecomment-843088341","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2565","id":843088341,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MzA4ODM0MQ==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-18T11:27:24Z","updated_at":"2021-05-18T11:27:24Z","author_association":"CONTRIBUTOR","body":"Thanks @jackye1995 for the patch and @marton-bod , @lcspinter for the reviews!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843088341/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843088663","html_url":"https://github.com/apache/iceberg/pull/2583#issuecomment-843088663","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2583","id":843088663,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MzA4ODY2Mw==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-18T11:28:00Z","updated_at":"2021-05-18T11:28:00Z","author_association":"CONTRIBUTOR","body":"Thanks @marton-bod for the fix and @RussellSpitzer for founding it!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843088663/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843168915","html_url":"https://github.com/apache/iceberg/issues/2601#issuecomment-843168915","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2601","id":843168915,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MzE2ODkxNQ==","user":{"login":"rakeshsayini","id":65325642,"node_id":"MDQ6VXNlcjY1MzI1NjQy","avatar_url":"https://avatars.githubusercontent.com/u/65325642?v=4","gravatar_id":"","url":"https://api.github.com/users/rakeshsayini","html_url":"https://github.com/rakeshsayini","followers_url":"https://api.github.com/users/rakeshsayini/followers","following_url":"https://api.github.com/users/rakeshsayini/following{/other_user}","gists_url":"https://api.github.com/users/rakeshsayini/gists{/gist_id}","starred_url":"https://api.github.com/users/rakeshsayini/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rakeshsayini/subscriptions","organizations_url":"https://api.github.com/users/rakeshsayini/orgs","repos_url":"https://api.github.com/users/rakeshsayini/repos","events_url":"https://api.github.com/users/rakeshsayini/events{/privacy}","received_events_url":"https://api.github.com/users/rakeshsayini/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-18T13:24:19Z","updated_at":"2021-05-18T13:24:19Z","author_association":"NONE","body":"@pvary : Thanks @pvary . Following are the versions we had and seems there is no other work arounds till TEZ issue is fixed.\r\nHive 3.1\r\nSpark 3.0.2 \r\nIceBerg 0.11.1","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843168915/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843197264","html_url":"https://github.com/apache/iceberg/issues/2533#issuecomment-843197264","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2533","id":843197264,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MzE5NzI2NA==","user":{"login":"bihaiyang","id":39689341,"node_id":"MDQ6VXNlcjM5Njg5MzQx","avatar_url":"https://avatars.githubusercontent.com/u/39689341?v=4","gravatar_id":"","url":"https://api.github.com/users/bihaiyang","html_url":"https://github.com/bihaiyang","followers_url":"https://api.github.com/users/bihaiyang/followers","following_url":"https://api.github.com/users/bihaiyang/following{/other_user}","gists_url":"https://api.github.com/users/bihaiyang/gists{/gist_id}","starred_url":"https://api.github.com/users/bihaiyang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bihaiyang/subscriptions","organizations_url":"https://api.github.com/users/bihaiyang/orgs","repos_url":"https://api.github.com/users/bihaiyang/repos","events_url":"https://api.github.com/users/bihaiyang/events{/privacy}","received_events_url":"https://api.github.com/users/bihaiyang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-18T13:59:52Z","updated_at":"2021-05-18T13:59:52Z","author_association":"NONE","body":"@Reo-LEI This patch can not  pass my test case，i think It's my configuration that's wrong。Can I get your contact information？email or QQ  Or other？Thank you very much","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843197264/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843203695","html_url":"https://github.com/apache/iceberg/issues/2533#issuecomment-843203695","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2533","id":843203695,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MzIwMzY5NQ==","user":{"login":"bihaiyang","id":39689341,"node_id":"MDQ6VXNlcjM5Njg5MzQx","avatar_url":"https://avatars.githubusercontent.com/u/39689341?v=4","gravatar_id":"","url":"https://api.github.com/users/bihaiyang","html_url":"https://github.com/bihaiyang","followers_url":"https://api.github.com/users/bihaiyang/followers","following_url":"https://api.github.com/users/bihaiyang/following{/other_user}","gists_url":"https://api.github.com/users/bihaiyang/gists{/gist_id}","starred_url":"https://api.github.com/users/bihaiyang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bihaiyang/subscriptions","organizations_url":"https://api.github.com/users/bihaiyang/orgs","repos_url":"https://api.github.com/users/bihaiyang/repos","events_url":"https://api.github.com/users/bihaiyang/events{/privacy}","received_events_url":"https://api.github.com/users/bihaiyang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-18T14:07:57Z","updated_at":"2021-05-18T14:07:57Z","author_association":"NONE","body":" --jars   /opt/spark/jars/iceberg-spark3-runtime-30ec9b5.jar\r\n --conf  \r\n     spark.sql.extensions=org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions\r\n--conf\r\n      spark.sql.catalog.spark_catalog=org.apache.iceberg.spark.SparkSessionCatalog\r\n\r\nI used the decompiler tool to make sure the code was correct,i use my test case or @Reo-LEI  test case ,It didn't work。Can I talk to you for a minute ，Please\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843203695/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843203856","html_url":"https://github.com/apache/iceberg/issues/2533#issuecomment-843203856","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2533","id":843203856,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MzIwMzg1Ng==","user":{"login":"bihaiyang","id":39689341,"node_id":"MDQ6VXNlcjM5Njg5MzQx","avatar_url":"https://avatars.githubusercontent.com/u/39689341?v=4","gravatar_id":"","url":"https://api.github.com/users/bihaiyang","html_url":"https://github.com/bihaiyang","followers_url":"https://api.github.com/users/bihaiyang/followers","following_url":"https://api.github.com/users/bihaiyang/following{/other_user}","gists_url":"https://api.github.com/users/bihaiyang/gists{/gist_id}","starred_url":"https://api.github.com/users/bihaiyang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bihaiyang/subscriptions","organizations_url":"https://api.github.com/users/bihaiyang/orgs","repos_url":"https://api.github.com/users/bihaiyang/repos","events_url":"https://api.github.com/users/bihaiyang/events{/privacy}","received_events_url":"https://api.github.com/users/bihaiyang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-18T14:08:09Z","updated_at":"2021-05-18T14:08:09Z","author_association":"NONE","body":"> --jars /opt/spark/jars/iceberg-spark3-runtime-30ec9b5.jar\r\n> --conf\r\n> spark.sql.extensions=org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions\r\n> --conf\r\n> spark.sql.catalog.spark_catalog=org.apache.iceberg.spark.SparkSessionCatalog\r\n> \r\n> I used the decompiler tool to make sure the code was correct,i use my test case or @Reo-LEI test case ,It didn't work。Can I talk to you for a minute ，Please\r\n\r\n@Reo-LEI ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843203856/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843212802","html_url":"https://github.com/apache/iceberg/issues/2604#issuecomment-843212802","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2604","id":843212802,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MzIxMjgwMg==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-18T14:19:35Z","updated_at":"2021-05-18T14:19:35Z","author_association":"MEMBER","body":"I wrote this on another issue recently, I think usually you have two places where this could break.\n\nTarget table is not iceberg \nExtensions are not loaded\n\nIn this case I'm guessing you are possibly making the session before setting the extensions property. This could happen in a notebook or shell which creates the session in an init script. Could you try moving the extensions config into a command line --conf option or some other method which sets initial spark conf?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843212802/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843273321","html_url":"https://github.com/apache/iceberg/issues/2604#issuecomment-843273321","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2604","id":843273321,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MzI3MzMyMQ==","user":{"login":"liuzx8888","id":10862577,"node_id":"MDQ6VXNlcjEwODYyNTc3","avatar_url":"https://avatars.githubusercontent.com/u/10862577?v=4","gravatar_id":"","url":"https://api.github.com/users/liuzx8888","html_url":"https://github.com/liuzx8888","followers_url":"https://api.github.com/users/liuzx8888/followers","following_url":"https://api.github.com/users/liuzx8888/following{/other_user}","gists_url":"https://api.github.com/users/liuzx8888/gists{/gist_id}","starred_url":"https://api.github.com/users/liuzx8888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liuzx8888/subscriptions","organizations_url":"https://api.github.com/users/liuzx8888/orgs","repos_url":"https://api.github.com/users/liuzx8888/repos","events_url":"https://api.github.com/users/liuzx8888/events{/privacy}","received_events_url":"https://api.github.com/users/liuzx8888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-18T15:31:39Z","updated_at":"2021-05-18T15:33:44Z","author_association":"NONE","body":"@RussellSpitzer yes,it happend in my notebook idea, i can execute merge susseccful in ${SPARK_HOME}/bin/spark-sql \r\n           use like\r\n\r\n`./spark-sql --packages org.apache.iceberg:iceberg-spark3-runtime:0.11.1 \\\r\n    --conf spark.sql.extensions=org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions \\\r\n    --conf spark.sql.catalog.spark_catalog=org.apache.iceberg.spark.SparkSessionCatalog \\\r\n    --conf spark.sql.catalog.spark_catalog.type=hive \\\r\n    --conf spark.sql.catalog.local=org.apache.iceberg.spark.SparkCatalog \\\r\n    --conf spark.sql.catalog.local.type=hive \\\r\n    --conf spark.sql.catalog.local.uri=thrift://ambari6:9083 \\\r\n    --conf spark.sql.catalog.local.warehouse=hdfs://ambari5:8020/warehouse/tablespace/managed/hive` \r\n\r\nbut  i faild when  config the same property in my source code.\r\n table is iceberg I think Extensions are not loaded is quite possible, but in my IDEA program,  I do not know how to detect it. I tried to execute spark.conf.set(\"spark.sql.extensions\", \"org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions\"), but it reported an error.\r\n![image](https://user-images.githubusercontent.com/10862577/118679660-a3bdd480-b830-11eb-9581-c663a512390c.png)\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n![image](https://user-images.githubusercontent.com/10862577/118680202-1d55c280-b831-11eb-9258-8a58b2aedda2.png)\r\n\r\n\r\nNow I don't know how to load Extensions successfully\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843273321/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843280647","html_url":"https://github.com/apache/iceberg/issues/2604#issuecomment-843280647","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2604","id":843280647,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MzI4MDY0Nw==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-18T15:41:41Z","updated_at":"2021-05-18T15:41:41Z","author_association":"MEMBER","body":"The issue here is that SparkSession.getOrCreate will use any session that already exists if one does. In this case the extensions are not applied. You cannot modify the SparkConf after it has been made which is why you get the \"can't modify\" spark conf error. So in your case you have basically 2 options I think ...\r\n\r\n1. find the original session creation in your code and add the property there, if this is a notebook usually you can just set the properties in the kernel definition. If this is your own code you need to find the first init yourself.\r\n2. Force the creation of a new session (newSession) and make sure you are using that. I'm not sure this will pick up the session.conf from the old session but it couldn't hurt","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843280647/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843309591","html_url":"https://github.com/apache/iceberg/issues/2604#issuecomment-843309591","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2604","id":843309591,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MzMwOTU5MQ==","user":{"login":"liuzx8888","id":10862577,"node_id":"MDQ6VXNlcjEwODYyNTc3","avatar_url":"https://avatars.githubusercontent.com/u/10862577?v=4","gravatar_id":"","url":"https://api.github.com/users/liuzx8888","html_url":"https://github.com/liuzx8888","followers_url":"https://api.github.com/users/liuzx8888/followers","following_url":"https://api.github.com/users/liuzx8888/following{/other_user}","gists_url":"https://api.github.com/users/liuzx8888/gists{/gist_id}","starred_url":"https://api.github.com/users/liuzx8888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liuzx8888/subscriptions","organizations_url":"https://api.github.com/users/liuzx8888/orgs","repos_url":"https://api.github.com/users/liuzx8888/repos","events_url":"https://api.github.com/users/liuzx8888/events{/privacy}","received_events_url":"https://api.github.com/users/liuzx8888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-18T16:08:14Z","updated_at":"2021-05-18T16:08:14Z","author_association":"NONE","body":"@RussellSpitzer  Thanks Russell, that was it ! Now it can run normally, thank you very, very, very much, you are such a great person","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843309591/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843310367","html_url":"https://github.com/apache/iceberg/issues/2604#issuecomment-843310367","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2604","id":843310367,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MzMxMDM2Nw==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-18T16:08:46Z","updated_at":"2021-05-18T16:08:46Z","author_association":"MEMBER","body":"Ha no problem","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843310367/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843357068","html_url":"https://github.com/apache/iceberg/issues/2559#issuecomment-843357068","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2559","id":843357068,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MzM1NzA2OA==","user":{"login":"karuppayya","id":5082742,"node_id":"MDQ6VXNlcjUwODI3NDI=","avatar_url":"https://avatars.githubusercontent.com/u/5082742?v=4","gravatar_id":"","url":"https://api.github.com/users/karuppayya","html_url":"https://github.com/karuppayya","followers_url":"https://api.github.com/users/karuppayya/followers","following_url":"https://api.github.com/users/karuppayya/following{/other_user}","gists_url":"https://api.github.com/users/karuppayya/gists{/gist_id}","starred_url":"https://api.github.com/users/karuppayya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/karuppayya/subscriptions","organizations_url":"https://api.github.com/users/karuppayya/orgs","repos_url":"https://api.github.com/users/karuppayya/repos","events_url":"https://api.github.com/users/karuppayya/events{/privacy}","received_events_url":"https://api.github.com/users/karuppayya/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-18T16:53:02Z","updated_at":"2021-05-18T16:53:02Z","author_association":"CONTRIBUTOR","body":"The change is merged, closing this issue.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843357068/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843380880","html_url":"https://github.com/apache/iceberg/issues/2607#issuecomment-843380880","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2607","id":843380880,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MzM4MDg4MA==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-18T17:26:36Z","updated_at":"2021-05-18T17:26:36Z","author_association":"CONTRIBUTOR","body":"cc @RussellSpitzer ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843380880/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843466537","html_url":"https://github.com/apache/iceberg/issues/2607#issuecomment-843466537","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2607","id":843466537,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MzQ2NjUzNw==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-18T19:19:40Z","updated_at":"2021-05-18T19:19:40Z","author_association":"MEMBER","body":"@marton-bod or @pvary have you run into this? My thought was we could just propagate Catalog Options into the Hadoop configuration. We currently just move through the URIS and ClientConnections","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843466537/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843540394","html_url":"https://github.com/apache/iceberg/pull/2257#issuecomment-843540394","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2257","id":843540394,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MzU0MDM5NA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-18T20:34:24Z","updated_at":"2021-05-18T20:34:24Z","author_association":"CONTRIBUTOR","body":"@holdenk, could you please fix the formatting [here](https://github.com/apache/iceberg/pull/2257/files#r634636704)? Let's get this in.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843540394/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843612237","html_url":"https://github.com/apache/iceberg/pull/2608#issuecomment-843612237","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2608","id":843612237,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MzYxMjIzNw==","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-18T22:35:27Z","updated_at":"2021-05-18T22:35:27Z","author_association":"COLLABORATOR","body":"FYI @aokolnychyi @RussellSpitzer @flyrain  \r\n\r\n(javadoc failure doesnt look related: Could not GET 'https://plugins.gradle.org/m2/org/jetbrains/kotlin/kotlin-stdlib-jdk8/1.3.50/kotlin-stdlib-jdk8-1.3.50.jar'.)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843612237/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843649514","html_url":"https://github.com/apache/iceberg/pull/2609#issuecomment-843649514","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2609","id":843649514,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MzY0OTUxNA==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-19T00:13:56Z","updated_at":"2021-05-19T00:13:56Z","author_association":"MEMBER","body":"@jackye1995 + @openinx - Sort Based PR (Abstract Strategy Only)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843649514/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843703735","html_url":"https://github.com/apache/iceberg/pull/2257#issuecomment-843703735","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2257","id":843703735,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MzcwMzczNQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-19T02:51:43Z","updated_at":"2021-05-19T02:51:43Z","author_association":"CONTRIBUTOR","body":"Thanks, @holdenk! Thanks for reviewing, @RussellSpitzer!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843703735/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843743215","html_url":"https://github.com/apache/iceberg/issues/2610#issuecomment-843743215","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2610","id":843743215,"node_id":"MDEyOklzc3VlQ29tbWVudDg0Mzc0MzIxNQ==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-19T04:48:50Z","updated_at":"2021-05-19T04:48:50Z","author_association":"MEMBER","body":"What's your iceberg table schema?   Is it possible that the rows with the same primary key located in two different partitions/buckets ?   If sure,  then we may encounter the duplicated rows that from two different partitions/buckets because we won't dedup the same rows from different partitions , it is high cost to accomplish that. \r\n\r\nAnother thing,  all those change log events come from MYSQLbinlog or flink aggregate results ?  If they are came from binlog,  then each UPDATE will emit a `UPDATE_BEFORE` and a `UPDATE_AFTER`, currently we iceberg only support update (rather than UPSERT, that means we won't delete the existing rows  explicitily but we have pending PR to do this) rows,  in theory we won't encounter duplicate rows. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843743215/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843753730","html_url":"https://github.com/apache/iceberg/issues/2533#issuecomment-843753730","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2533","id":843753730,"node_id":"MDEyOklzc3VlQ29tbWVudDg0Mzc1MzczMA==","user":{"login":"Reo-LEI","id":17312872,"node_id":"MDQ6VXNlcjE3MzEyODcy","avatar_url":"https://avatars.githubusercontent.com/u/17312872?v=4","gravatar_id":"","url":"https://api.github.com/users/Reo-LEI","html_url":"https://github.com/Reo-LEI","followers_url":"https://api.github.com/users/Reo-LEI/followers","following_url":"https://api.github.com/users/Reo-LEI/following{/other_user}","gists_url":"https://api.github.com/users/Reo-LEI/gists{/gist_id}","starred_url":"https://api.github.com/users/Reo-LEI/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Reo-LEI/subscriptions","organizations_url":"https://api.github.com/users/Reo-LEI/orgs","repos_url":"https://api.github.com/users/Reo-LEI/repos","events_url":"https://api.github.com/users/Reo-LEI/events{/privacy}","received_events_url":"https://api.github.com/users/Reo-LEI/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-19T05:18:49Z","updated_at":"2021-05-19T05:21:05Z","author_association":"CONTRIBUTOR","body":"> --jars /opt/spark/jars/iceberg-spark3-runtime-30ec9b5.jar\r\n> --conf\r\n> spark.sql.extensions=org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions\r\n> --conf\r\n> spark.sql.catalog.spark_catalog=org.apache.iceberg.spark.SparkSessionCatalog\r\n> \r\n> I used the decompiler tool to make sure the code was correct,i use my test case or @Reo-LEI test case ,It didn't work。Can I talk to you for a minute ，Please\r\n\r\nsure, you can contact me via leinuowen@gmail.com","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843753730/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843778513","html_url":"https://github.com/apache/iceberg/issues/2533#issuecomment-843778513","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2533","id":843778513,"node_id":"MDEyOklzc3VlQ29tbWVudDg0Mzc3ODUxMw==","user":{"login":"bihaiyang","id":39689341,"node_id":"MDQ6VXNlcjM5Njg5MzQx","avatar_url":"https://avatars.githubusercontent.com/u/39689341?v=4","gravatar_id":"","url":"https://api.github.com/users/bihaiyang","html_url":"https://github.com/bihaiyang","followers_url":"https://api.github.com/users/bihaiyang/followers","following_url":"https://api.github.com/users/bihaiyang/following{/other_user}","gists_url":"https://api.github.com/users/bihaiyang/gists{/gist_id}","starred_url":"https://api.github.com/users/bihaiyang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bihaiyang/subscriptions","organizations_url":"https://api.github.com/users/bihaiyang/orgs","repos_url":"https://api.github.com/users/bihaiyang/repos","events_url":"https://api.github.com/users/bihaiyang/events{/privacy}","received_events_url":"https://api.github.com/users/bihaiyang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-19T06:15:43Z","updated_at":"2021-05-19T06:15:43Z","author_association":"NONE","body":"> > --jars /opt/spark/jars/iceberg-spark3-runtime-30ec9b5.jar\r\n> > --conf\r\n> > spark.sql.extensions=org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions\r\n> > --conf\r\n> > spark.sql.catalog.spark_catalog=org.apache.iceberg.spark.SparkSessionCatalog\r\n> > I used the decompiler tool to make sure the code was correct,i use my test case or @Reo-LEI test case ,It didn't work。Can I talk to you for a minute ，Please\r\n> \r\n> sure, you can contact me via [leinuowen@gmail.com](mailto:leinuowen@gmail.com)\r\n\r\nThank you for your help","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843778513/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843829135","html_url":"https://github.com/apache/iceberg/issues/2601#issuecomment-843829135","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2601","id":843829135,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MzgyOTEzNQ==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-19T07:32:27Z","updated_at":"2021-05-19T07:32:27Z","author_association":"CONTRIBUTOR","body":"You may want to try out upgrading the tez jar to a newer version. Tez 0.9.3 supposed to have this fix. Since it is only a minor version change from the Tez 0.9.1 originally contained in Hive 3.1.2, upgrading might be possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843829135/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843847799","html_url":"https://github.com/apache/iceberg/issues/2607#issuecomment-843847799","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2607","id":843847799,"node_id":"MDEyOklzc3VlQ29tbWVudDg0Mzg0Nzc5OQ==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-19T07:58:58Z","updated_at":"2021-05-19T07:58:58Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer: Do I understand correctly that the proposed solution would be to copy the catalog specific configurations to the HiveConf when trying to access the underlying Iceberg table?\r\n\r\nSo for example:\r\n```\r\niceberg.catalog.catalog_in_different_authority.config_to_push.hive.metastore.connect.retries=3\r\niceberg.catalog.catalog_in_different_authority.config_to_push.hive.metastore.kerberos.principal=aaa\r\niceberg.catalog.catalog_in_different_authority.config_to_push.hive.metastore.sasl.enabled=true\r\n```\r\n\r\nShould be pushed to the HiveConf used to connect to metastore, like:\r\n```\r\nhive.metastore.connect.retries=3\r\nhive.metastore.kerberos.principal=aaa\r\nhive.metastore.sasl.enabled=true\r\n```\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843847799/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843888698","html_url":"https://github.com/apache/iceberg/issues/2533#issuecomment-843888698","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2533","id":843888698,"node_id":"MDEyOklzc3VlQ29tbWVudDg0Mzg4ODY5OA==","user":{"login":"bihaiyang","id":39689341,"node_id":"MDQ6VXNlcjM5Njg5MzQx","avatar_url":"https://avatars.githubusercontent.com/u/39689341?v=4","gravatar_id":"","url":"https://api.github.com/users/bihaiyang","html_url":"https://github.com/bihaiyang","followers_url":"https://api.github.com/users/bihaiyang/followers","following_url":"https://api.github.com/users/bihaiyang/following{/other_user}","gists_url":"https://api.github.com/users/bihaiyang/gists{/gist_id}","starred_url":"https://api.github.com/users/bihaiyang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bihaiyang/subscriptions","organizations_url":"https://api.github.com/users/bihaiyang/orgs","repos_url":"https://api.github.com/users/bihaiyang/repos","events_url":"https://api.github.com/users/bihaiyang/events{/privacy}","received_events_url":"https://api.github.com/users/bihaiyang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-19T08:46:17Z","updated_at":"2021-05-19T08:46:17Z","author_association":"NONE","body":"@RussellSpitzer  \r\n```\r\nspark.sql.catalog.hive_prod = org.apache.iceberg.spark.SparkCatalog\r\nspark.sql.catalog.hive_prod.type = hive\r\nspark.sql.catalog.hive_prod.uri = thrift://metastore-host:port\r\n```\r\n\r\nThank you for your help，I want to confirm whether this parameter is required，Because my current Spark architecture is Spark-ThriftServer & Aluxio & OSS，There is no hive. Metastore. Uri; Does your piece of logic have to be configured with this class(org.apache.iceberg.spark.SparkCatalog) to execute? I'm just configuration \r\n```\r\n-- conf spark. SQL. Extensions = org. Apache. Iceberg. Spark. Extensions. IcebergSparkSessionExtensions \\\r\n--conf spark.sql.catalog.spark_catalog=org.apache.iceberg.spark.SparkSessionCatalog \\\r\n--conf spark.sql.catalog.spark_catalog.type=hive \\\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/843888698/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844000117","html_url":"https://github.com/apache/iceberg/issues/2533#issuecomment-844000117","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2533","id":844000117,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDAwMDExNw==","user":{"login":"bihaiyang","id":39689341,"node_id":"MDQ6VXNlcjM5Njg5MzQx","avatar_url":"https://avatars.githubusercontent.com/u/39689341?v=4","gravatar_id":"","url":"https://api.github.com/users/bihaiyang","html_url":"https://github.com/bihaiyang","followers_url":"https://api.github.com/users/bihaiyang/followers","following_url":"https://api.github.com/users/bihaiyang/following{/other_user}","gists_url":"https://api.github.com/users/bihaiyang/gists{/gist_id}","starred_url":"https://api.github.com/users/bihaiyang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bihaiyang/subscriptions","organizations_url":"https://api.github.com/users/bihaiyang/orgs","repos_url":"https://api.github.com/users/bihaiyang/repos","events_url":"https://api.github.com/users/bihaiyang/events{/privacy}","received_events_url":"https://api.github.com/users/bihaiyang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-19T11:12:11Z","updated_at":"2021-05-19T11:12:11Z","author_association":"NONE","body":"I think I've found the problem，Thank you very much for your follow-up!! @RussellSpitzer @aokolnychyi @Reo-LEI ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844000117/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844075792","html_url":"https://github.com/apache/iceberg/issues/2610#issuecomment-844075792","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2610","id":844075792,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDA3NTc5Mg==","user":{"login":"ayush-san","id":57655135,"node_id":"MDQ6VXNlcjU3NjU1MTM1","avatar_url":"https://avatars.githubusercontent.com/u/57655135?v=4","gravatar_id":"","url":"https://api.github.com/users/ayush-san","html_url":"https://github.com/ayush-san","followers_url":"https://api.github.com/users/ayush-san/followers","following_url":"https://api.github.com/users/ayush-san/following{/other_user}","gists_url":"https://api.github.com/users/ayush-san/gists{/gist_id}","starred_url":"https://api.github.com/users/ayush-san/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ayush-san/subscriptions","organizations_url":"https://api.github.com/users/ayush-san/orgs","repos_url":"https://api.github.com/users/ayush-san/repos","events_url":"https://api.github.com/users/ayush-san/events{/privacy}","received_events_url":"https://api.github.com/users/ayush-san/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-19T12:52:20Z","updated_at":"2021-05-19T12:52:20Z","author_association":"NONE","body":"@openinx All my tables are unpartitioned and not bucketed. \r\n\r\nThe changelog I have shared is the output of the flink aggregated data stream, but rowkind is set by debezium deserializer class. Only some updates are coming as duplicates, most of the updates are handled correctly as I am using v2 spec for the tables \r\n\r\n```\r\n// need to upgrade version to 2,otherwise 'java.lang.IllegalArgumentException: Cannot write\r\n// delete files in a v1 table'\r\nTableOperations tableOperations = ((BaseTable) icebergTable).operations();\r\nTableMetadata metadata = tableOperations.current();\r\ntableOperations.commit(metadata, metadata.upgradeToFormatVersion(2));\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844075792/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844097349","html_url":"https://github.com/apache/iceberg/issues/2607#issuecomment-844097349","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2607","id":844097349,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDA5NzM0OQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-19T13:17:01Z","updated_at":"2021-05-19T13:17:18Z","author_association":"MEMBER","body":"That's why I was thinking at the moment unless we have another way of doing so or there is another solution I haven't imagined","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844097349/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844138938","html_url":"https://github.com/apache/iceberg/issues/2607#issuecomment-844138938","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2607","id":844138938,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDEzODkzOA==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-19T14:05:28Z","updated_at":"2021-05-19T14:05:28Z","author_association":"CONTRIBUTOR","body":"Seems reasonable to me, and I do not know about other possibilities ATM","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844138938/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844165094","html_url":"https://github.com/apache/iceberg/pull/2512#issuecomment-844165094","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2512","id":844165094,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDE2NTA5NA==","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-19T14:34:04Z","updated_at":"2021-05-19T14:34:04Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer and @rdblue, can you please review this again?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844165094/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]