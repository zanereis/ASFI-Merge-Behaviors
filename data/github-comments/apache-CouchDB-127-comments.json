[{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1955248793","html_url":"https://github.com/apache/couchdb/issues/4988#issuecomment-1955248793","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4988","id":1955248793,"node_id":"IC_kwDOAAMmUc50irqZ","user":{"login":"sergey-safarov","id":2562241,"node_id":"MDQ6VXNlcjI1NjIyNDE=","avatar_url":"https://avatars.githubusercontent.com/u/2562241?v=4","gravatar_id":"","url":"https://api.github.com/users/sergey-safarov","html_url":"https://github.com/sergey-safarov","followers_url":"https://api.github.com/users/sergey-safarov/followers","following_url":"https://api.github.com/users/sergey-safarov/following{/other_user}","gists_url":"https://api.github.com/users/sergey-safarov/gists{/gist_id}","starred_url":"https://api.github.com/users/sergey-safarov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sergey-safarov/subscriptions","organizations_url":"https://api.github.com/users/sergey-safarov/orgs","repos_url":"https://api.github.com/users/sergey-safarov/repos","events_url":"https://api.github.com/users/sergey-safarov/events{/privacy}","received_events_url":"https://api.github.com/users/sergey-safarov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-20T22:49:28Z","updated_at":"2024-02-20T22:49:28Z","author_association":"NONE","body":"Before the issue was used 170Mb of swap memory\r\n\r\n![image](https://github.com/apache/couchdb/assets/2562241/d046957f-7d23-4129-b23d-cf4a6cd60102)\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1955248793/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1955460577","html_url":"https://github.com/apache/couchdb/issues/4988#issuecomment-1955460577","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4988","id":1955460577,"node_id":"IC_kwDOAAMmUc50jfXh","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-21T00:12:59Z","updated_at":"2024-02-21T03:00:23Z","author_association":"CONTRIBUTOR","body":"I don't typically run CouchDB in a docker container so this all speculative advice.\r\n\r\nA few things to try:\r\n\r\n * Adjusting couchjs process setting, lower their number with https://docs.couchdb.org/en/stable/config/query-servers.html#query_server_config/os_process_limit. Make the hard limit say 75 and soft limit 25. The default is 100 I think.\r\n \r\n * Try lowering [max_dbs_open](https://docs.couchdb.org/en/stable/maintenance/performance.html#max-dbs-open). The default is 500 so maybe try making it 400 or 300.\r\n \r\n * When running in docker, Erlang VM doesn't always do a good job auto-detecting the CPU quotas so it would start a scheduler thread for each core on the host machine. So try lowering the number of schedulers artificially in `vm.args` with `+S 4:4`, for example to use only 4 schedulers. The number of schedulers should match your CPU quota.\r\n\r\n * Erlang VM has more advanced memory management settings. There is one to use a max amount of heap, so if you have a way to test it out on a test cluster first, try something like:\r\nvm.args:\r\n```\r\n+MMscs 4096\r\n+Musac false\r\n+MMsco true\r\n```\r\nThat sets the super-carrier to 4GB max. Again, I haven't tried running with those settings but someone reported some success with that: https://elixirforum.com/t/running-elixir-with-limited-heap-size/23633/13\r\n ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1955460577/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1965487142","html_url":"https://github.com/apache/couchdb/issues/4993#issuecomment-1965487142","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4993","id":1965487142,"node_id":"IC_kwDOAAMmUc51JvQm","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-26T23:04:39Z","updated_at":"2024-02-26T23:04:39Z","author_association":"MEMBER","body":"good idea, but let's protect ourselves from client input. rejecting an x-couch-request-id that's above a certain length, say.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1965487142/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1965492535","html_url":"https://github.com/apache/couchdb/issues/4994#issuecomment-1965492535","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4994","id":1965492535,"node_id":"IC_kwDOAAMmUc51Jwk3","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-26T23:09:21Z","updated_at":"2024-02-26T23:09:21Z","author_association":"CONTRIBUTOR","body":"That happens when a view shard is opened but has a view signature that's not current. It comes from https://github.com/apache/couchdb/blob/29db2df901207d67e1975ca11a091bcb7f46abcc/src/couch_mrview/src/couch_mrview_index.erl#L141\r\n\r\nThe expected signature matches file path:\r\n\r\n```\r\nbinary:encode_hex(<<250,122,26,158,93,183,246,135,53,41,41,158,169,41,218,173>>).\r\n<<\"FA7A1A9E5DB7F6873529299EA929DAAD\">>\r\n```\r\n\r\nThe other one is:\r\n```\r\nbinary:encode_hex(<<87,225,55,84,101,143,50,221,45,61,42,165,141,102,202,177>>).\r\n<<\"57E13754658F32DD2D3D2AA58D66CAB1\">>\r\n```\r\n\r\nI don't recall seeing this error too often. Is there any chance your view shard files were moved, copied, restored from backup from an much older couch instance, or mounted on a volume shared across multiple nodes?\r\n\r\nIs it easy to reproduce? Just happened once or it's a regular occurrence?\r\n\r\n> Then it triggers CPU usage and is not responsible CouchDB 3 nodes cluster.\r\n\r\nThat's expected as the next action after the log is to reset the view shard and rebuild. So in other words, after the view rebuilds, it should be back to normal.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1965492535/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1965495755","html_url":"https://github.com/apache/couchdb/issues/4994#issuecomment-1965495755","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4994","id":1965495755,"node_id":"IC_kwDOAAMmUc51JxXL","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-26T23:12:23Z","updated_at":"2024-02-26T23:12:23Z","author_association":"MEMBER","body":"I would also ask that question: have the files been moved or renamed outside of couchdb's control? This error is not normal, and is a protection mechanism (effectively an assertion). another possibility is you have multiple nodes pointing at the same shared volume, and trashing each others state.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1965495755/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1965509117","html_url":"https://github.com/apache/couchdb/issues/4993#issuecomment-1965509117","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4993","id":1965509117,"node_id":"IC_kwDOAAMmUc51J0n9","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-26T23:25:04Z","updated_at":"2024-02-27T13:34:55Z","author_association":"CONTRIBUTOR","body":"+1 to check the length and maybe also ensure it has only alphanumeric characters, no escapes, slashes, semicolons, etc.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1965509117/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1966188788","html_url":"https://github.com/apache/couchdb/issues/4993#issuecomment-1966188788","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4993","id":1966188788,"node_id":"IC_kwDOAAMmUc51Maj0","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-27T10:00:44Z","updated_at":"2024-02-27T10:00:44Z","author_association":"MEMBER","body":"agreed on those extra checks, nick.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1966188788/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1966190075","html_url":"https://github.com/apache/couchdb/issues/4993#issuecomment-1966190075","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4993","id":1966190075,"node_id":"IC_kwDOAAMmUc51Ma37","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-27T10:01:26Z","updated_at":"2024-02-27T10:01:26Z","author_association":"MEMBER","body":"and a 400 bad request if those checks aren't met, rather than silently ignoring the header or stripping it of invalid chars, etc.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1966190075/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1966342416","html_url":"https://github.com/apache/couchdb/issues/4994#issuecomment-1966342416","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4994","id":1966342416,"node_id":"IC_kwDOAAMmUc51NAEQ","user":{"login":"sergey-safarov","id":2562241,"node_id":"MDQ6VXNlcjI1NjIyNDE=","avatar_url":"https://avatars.githubusercontent.com/u/2562241?v=4","gravatar_id":"","url":"https://api.github.com/users/sergey-safarov","html_url":"https://github.com/sergey-safarov","followers_url":"https://api.github.com/users/sergey-safarov/followers","following_url":"https://api.github.com/users/sergey-safarov/following{/other_user}","gists_url":"https://api.github.com/users/sergey-safarov/gists{/gist_id}","starred_url":"https://api.github.com/users/sergey-safarov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sergey-safarov/subscriptions","organizations_url":"https://api.github.com/users/sergey-safarov/orgs","repos_url":"https://api.github.com/users/sergey-safarov/repos","events_url":"https://api.github.com/users/sergey-safarov/events{/privacy}","received_events_url":"https://api.github.com/users/sergey-safarov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-27T11:27:57Z","updated_at":"2024-02-27T11:27:57Z","author_association":"NONE","body":">  Is there any chance your view shard files were moved, copied, restored from backup from an much older couch instance, or mounted on a volume shared across multiple nodes?\r\n\r\nI do not think we make something from the above.\r\nWe starting docker container and do not move CouchDB files.\r\nAlso, we do not use shared volumes.\r\nWe make couchdb backup using `bulk` requests but do not restore CouchdDB database at this time period.\r\n\r\n> Is it easy to reproduce?  Just happened once or it's a regular occurrence?\r\nIt is the first time.\r\n\r\n> after the view rebuilds, it should be back to normal.\r\n\r\nThis does not happen for 17 minutes and we have recreated the docker container.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1966342416/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1966345973","html_url":"https://github.com/apache/couchdb/issues/4265#issuecomment-1966345973","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4265","id":1966345973,"node_id":"IC_kwDOAAMmUc51NA71","user":{"login":"BeckmannM","id":27730162,"node_id":"MDQ6VXNlcjI3NzMwMTYy","avatar_url":"https://avatars.githubusercontent.com/u/27730162?v=4","gravatar_id":"","url":"https://api.github.com/users/BeckmannM","html_url":"https://github.com/BeckmannM","followers_url":"https://api.github.com/users/BeckmannM/followers","following_url":"https://api.github.com/users/BeckmannM/following{/other_user}","gists_url":"https://api.github.com/users/BeckmannM/gists{/gist_id}","starred_url":"https://api.github.com/users/BeckmannM/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BeckmannM/subscriptions","organizations_url":"https://api.github.com/users/BeckmannM/orgs","repos_url":"https://api.github.com/users/BeckmannM/repos","events_url":"https://api.github.com/users/BeckmannM/events{/privacy}","received_events_url":"https://api.github.com/users/BeckmannM/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-27T11:30:18Z","updated_at":"2024-02-27T11:30:18Z","author_association":"NONE","body":"So i can confirm disabling windows fast start fixes the issue for us. This is a workaround only, but this solution is suitable for us. And it proves the cause is related to erlang/windows and no couchdb issue.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1966345973/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1966355502","html_url":"https://github.com/apache/couchdb/issues/4994#issuecomment-1966355502","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4994","id":1966355502,"node_id":"IC_kwDOAAMmUc51NDQu","user":{"login":"sergey-safarov","id":2562241,"node_id":"MDQ6VXNlcjI1NjIyNDE=","avatar_url":"https://avatars.githubusercontent.com/u/2562241?v=4","gravatar_id":"","url":"https://api.github.com/users/sergey-safarov","html_url":"https://github.com/sergey-safarov","followers_url":"https://api.github.com/users/sergey-safarov/followers","following_url":"https://api.github.com/users/sergey-safarov/following{/other_user}","gists_url":"https://api.github.com/users/sergey-safarov/gists{/gist_id}","starred_url":"https://api.github.com/users/sergey-safarov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sergey-safarov/subscriptions","organizations_url":"https://api.github.com/users/sergey-safarov/orgs","repos_url":"https://api.github.com/users/sergey-safarov/repos","events_url":"https://api.github.com/users/sergey-safarov/events{/privacy}","received_events_url":"https://api.github.com/users/sergey-safarov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-27T11:36:32Z","updated_at":"2024-02-27T11:36:32Z","author_association":"NONE","body":"Just checked via AWS console, the CouchDB has \"Multi-Attach enabled: no\".\r\nSo  use volume mounted to only one node.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1966355502/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1966458894","html_url":"https://github.com/apache/couchdb/issues/4994#issuecomment-1966458894","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4994","id":1966458894,"node_id":"IC_kwDOAAMmUc51NcgO","user":{"login":"sergey-safarov","id":2562241,"node_id":"MDQ6VXNlcjI1NjIyNDE=","avatar_url":"https://avatars.githubusercontent.com/u/2562241?v=4","gravatar_id":"","url":"https://api.github.com/users/sergey-safarov","html_url":"https://github.com/sergey-safarov","followers_url":"https://api.github.com/users/sergey-safarov/followers","following_url":"https://api.github.com/users/sergey-safarov/following{/other_user}","gists_url":"https://api.github.com/users/sergey-safarov/gists{/gist_id}","starred_url":"https://api.github.com/users/sergey-safarov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sergey-safarov/subscriptions","organizations_url":"https://api.github.com/users/sergey-safarov/orgs","repos_url":"https://api.github.com/users/sergey-safarov/repos","events_url":"https://api.github.com/users/sergey-safarov/events{/privacy}","received_events_url":"https://api.github.com/users/sergey-safarov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-27T12:40:30Z","updated_at":"2024-02-27T12:40:30Z","author_association":"NONE","body":"> after the view rebuilds, it should be back to normal.\r\n\r\nAlso, an issue with the `view` file happens on one node in the cluster. But this does not explain why CPU consumed on other nodes.\r\nSo view rebuild should happen on one node and two other nodes should be not affected.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1966458894/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1966668481","html_url":"https://github.com/apache/couchdb/issues/4265#issuecomment-1966668481","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4265","id":1966668481,"node_id":"IC_kwDOAAMmUc51OPrB","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-27T14:24:59Z","updated_at":"2024-02-27T14:24:59Z","author_association":"CONTRIBUTOR","body":"It would be good to report this problem to the [Erlang/OTP](https://github.com/erlang/otp) team.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1966668481/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1966754121","html_url":"https://github.com/apache/couchdb/issues/4995#issuecomment-1966754121","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4995","id":1966754121,"node_id":"IC_kwDOAAMmUc51OklJ","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-27T15:03:33Z","updated_at":"2024-02-27T15:03:33Z","author_association":"MEMBER","body":"until=now is the default  behaviour (that is, if you don't ask for feed=continuous)\r\n\r\nFor any other value of `until` there is no solution, as you cannot construct a future update sequence string externally.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1966754121/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1966776279","html_url":"https://github.com/apache/couchdb/issues/4995#issuecomment-1966776279","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4995","id":1966776279,"node_id":"IC_kwDOAAMmUc51Op_X","user":{"login":"ronag","id":3065230,"node_id":"MDQ6VXNlcjMwNjUyMzA=","avatar_url":"https://avatars.githubusercontent.com/u/3065230?v=4","gravatar_id":"","url":"https://api.github.com/users/ronag","html_url":"https://github.com/ronag","followers_url":"https://api.github.com/users/ronag/followers","following_url":"https://api.github.com/users/ronag/following{/other_user}","gists_url":"https://api.github.com/users/ronag/gists{/gist_id}","starred_url":"https://api.github.com/users/ronag/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ronag/subscriptions","organizations_url":"https://api.github.com/users/ronag/orgs","repos_url":"https://api.github.com/users/ronag/repos","events_url":"https://api.github.com/users/ronag/events{/privacy}","received_events_url":"https://api.github.com/users/ronag/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-27T15:11:38Z","updated_at":"2024-02-27T15:11:38Z","author_association":"NONE","body":"> until=now is the default behaviour (that is, if you don't ask for feed=continuous)\r\n\r\nExactly, would like to have it for `feed=continuous` which is much more efficient than normal.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1966776279/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1967107139","html_url":"https://github.com/apache/couchdb/issues/4995#issuecomment-1967107139","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4995","id":1967107139,"node_id":"IC_kwDOAAMmUc51P6xD","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-27T16:54:01Z","updated_at":"2024-02-27T16:54:01Z","author_association":"MEMBER","body":"feed=continuous is as \"efficient\" as normal mode, it's the same code except it keeps reopening the database as it changes and sends the new updates. there is still no way for you to construct a future update sequence, and thus there's nothing you could pass as the `until` parameter. \r\n\r\nI do not understand your need.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1967107139/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1967519817","html_url":"https://github.com/apache/couchdb/issues/4995#issuecomment-1967519817","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4995","id":1967519817,"node_id":"IC_kwDOAAMmUc51RfhJ","user":{"login":"ronag","id":3065230,"node_id":"MDQ6VXNlcjMwNjUyMzA=","avatar_url":"https://avatars.githubusercontent.com/u/3065230?v=4","gravatar_id":"","url":"https://api.github.com/users/ronag","html_url":"https://github.com/ronag","followers_url":"https://api.github.com/users/ronag/followers","following_url":"https://api.github.com/users/ronag/following{/other_user}","gists_url":"https://api.github.com/users/ronag/gists{/gist_id}","starred_url":"https://api.github.com/users/ronag/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ronag/subscriptions","organizations_url":"https://api.github.com/users/ronag/orgs","repos_url":"https://api.github.com/users/ronag/repos","events_url":"https://api.github.com/users/ronag/events{/privacy}","received_events_url":"https://api.github.com/users/ronag/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-27T20:15:52Z","updated_at":"2024-02-27T20:15:52Z","author_association":"NONE","body":"normal feeds require several thousand http requests while continuous is a single streaming request. There is a significant difference in both overhead and latency. Even with tricks like keep alive and pipelining (I'm unsure how well those are actually supported).","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1967519817/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1967543675","html_url":"https://github.com/apache/couchdb/issues/4995#issuecomment-1967543675","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4995","id":1967543675,"node_id":"IC_kwDOAAMmUc51RlV7","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-27T20:33:28Z","updated_at":"2024-02-27T20:33:28Z","author_association":"MEMBER","body":"keepalive (multiple sequential send req, read resps on the same tcp connection) is supported (and encouraged!). pipelining (sending multiple requests before reading the first response) is also supported.\r\n\r\nI still don't see how you could know what value to pass to `until`. Have you seen that the changes endpoint supports a `limit` parameter? perhaps that is what you mean (`from here, return the next 10,000 updates and wait until they happen)\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1967543675/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1968330605","html_url":"https://github.com/apache/couchdb/issues/4995#issuecomment-1968330605","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4995","id":1968330605,"node_id":"IC_kwDOAAMmUc51Uldt","user":{"login":"ronag","id":3065230,"node_id":"MDQ6VXNlcjMwNjUyMzA=","avatar_url":"https://avatars.githubusercontent.com/u/3065230?v=4","gravatar_id":"","url":"https://api.github.com/users/ronag","html_url":"https://github.com/ronag","followers_url":"https://api.github.com/users/ronag/followers","following_url":"https://api.github.com/users/ronag/following{/other_user}","gists_url":"https://api.github.com/users/ronag/gists{/gist_id}","starred_url":"https://api.github.com/users/ronag/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ronag/subscriptions","organizations_url":"https://api.github.com/users/ronag/orgs","repos_url":"https://api.github.com/users/ronag/repos","events_url":"https://api.github.com/users/ronag/events{/privacy}","received_events_url":"https://api.github.com/users/ronag/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-28T06:41:30Z","updated_at":"2024-02-28T06:43:06Z","author_association":"NONE","body":"> keepalive (multiple sequential send req, read resps on the same tcp connection) is supported (and encouraged!). pipelining (sending multiple requests before reading the first response) is also supported.\r\n\r\nThat's great! However, from our tests it's still a lot slower than a continuous feed in addition to that it takes more memory (at least on client side as we need a quite large batch size for optimal perf). Especially when running in clustered mode.\r\n\r\nFeel free to close if you still don't think it makes sense.\r\n\r\n> I still don't see how you could know what value to pass to until.\r\n\r\nI would have a previously saved sequence or just pass `now`","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1968330605/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1968468248","html_url":"https://github.com/apache/couchdb/issues/1267#issuecomment-1968468248","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1267","id":1968468248,"node_id":"IC_kwDOAAMmUc51VHEY","user":{"login":"guanfeix","id":34960209,"node_id":"MDQ6VXNlcjM0OTYwMjA5","avatar_url":"https://avatars.githubusercontent.com/u/34960209?v=4","gravatar_id":"","url":"https://api.github.com/users/guanfeix","html_url":"https://github.com/guanfeix","followers_url":"https://api.github.com/users/guanfeix/followers","following_url":"https://api.github.com/users/guanfeix/following{/other_user}","gists_url":"https://api.github.com/users/guanfeix/gists{/gist_id}","starred_url":"https://api.github.com/users/guanfeix/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/guanfeix/subscriptions","organizations_url":"https://api.github.com/users/guanfeix/orgs","repos_url":"https://api.github.com/users/guanfeix/repos","events_url":"https://api.github.com/users/guanfeix/events{/privacy}","received_events_url":"https://api.github.com/users/guanfeix/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-28T08:30:24Z","updated_at":"2024-02-28T08:30:42Z","author_association":"NONE","body":"> I would reopen this issue to complete some informations for the community.I saw that a lot of people have had this problem I double the number of cpu on the server. this did not change anything and the server did not have a high load but i realized that there was some conflicts of documents in some databases. Well, after solving the conflicts of documents present in the databases, it solved the problem of fabric timeout !\r\n> \r\n> but i am surprised that this problem of fabric timeout occurs with very few conflicts. 21 conflicts on 60000 documents presents in all the databases of the instance. reminder: requests go through a _changes database filter however, about 20000 documents contains many attachments (between 1 and about 10) of several dozen mega-octets\r\n> \r\n> can you confirm that this problem of fabric timeout must be related to my problem of documents conflicts ? thanks a lot for your reply\r\n\r\nI run into the same question.May I ask you how to slove conflict in database document","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1968468248/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1969500836","html_url":"https://github.com/apache/couchdb/issues/4995#issuecomment-1969500836","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4995","id":1969500836,"node_id":"IC_kwDOAAMmUc51ZDKk","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-28T17:34:51Z","updated_at":"2024-02-28T17:34:51Z","author_association":"MEMBER","body":"are you perhaps buffering the entire response before processing it when not using feed=continuous? the response format is different, you see. for continuous we send a series of json objects separated by newlines. for normal, it's a single json object with all the docs within that. however we do intentionally put newlines between the items to make it easier to process in a streaming manner.\r\n\r\nnormal:\r\n```\r\ncurl foo:bar@localhost:25984/db1/_changes\r\n{\"results\":[\r\n{\"seq\":\"1-g1AAAABzeJzLYWBgYMpgTmHgz8tPSTVyMDQy1zMAQsMckEQiQ1L9____sxIZcCrJYwGSDA1A6j9IZQZzImMuUIDdzMIiNS0lDVNXFgCFqx2b\",\"id\":\"doc1\",\"changes\":[{\"rev\":\"1-967a00dff5e02add41819138abb3284d\"}]},\r\n{\"seq\":\"2-g1AAAACTeJzLYWBgYMpgTmHgz8tPSTVyMDQy1zMAQsMckEQiQ1L9____szKYExlzgQLsycZJyQZmSZjKcRqRxwIkGRqA1H8Uk8wsLFLTUtIwdWUBAG6aJN4\",\"id\":\"doc2\",\"changes\":[{\"rev\":\"1-967a00dff5e02add41819138abb3284d\"}]},\r\n{\"seq\":\"3-g1AAAACTeJzLYWBgYMpgTmHgz8tPSTVyMDQy1zMAQsMckEQiQ1L9____szKYE5lygQLsycZJyQZmSZjKcRqRxwIkGRqA1H-oSYxgk8wsLFLTUtIwdWUBAG8EJN8\",\"id\":\"doc3\",\"changes\":[{\"rev\":\"1-967a00dff5e02add41819138abb3284d\"}]}\r\n],\r\n\"last_seq\":\"3-g1AAAACTeJzLYWBgYMpgTmHgz8tPSTVyMDQy1zMAQsMckEQiQ1L9____szKYE5lygQLsycZJyQZmSZjKcRqRxwIkGRqA1H-oSYxgk8wsLFLTUtIwdWUBAG8EJN8\",\"pending\":0}\r\n```\r\n\r\ncontinuous\r\n```\r\ncurl 'foo:bar@localhost:25984/db1/_changes?feed=continuous'\r\n{\"seq\":\"1-g1AAAABzeJzLYWBgYMpgTmHgz8tPSTVyMDQy1zMAQsMckEQiQ1L9____szKYExlzgQLsycZJyQZmSZjKcRqRxwIkGRqA1H-QSYkMWQBNRh2D\",\"id\":\"doc2\",\"changes\":[{\"rev\":\"1-967a00dff5e02add41819138abb3284d\"}]}\r\n{\"seq\":\"2-g1AAAABzeJzLYWBgYMpgTmHgz8tPSTVyMDQy1zMAQsMckEQiQ1L9____szKYE5lygQLsycZJyQZmSZjKcRqRxwIkGRqA1H-QSYkMWQBNkB2E\",\"id\":\"doc3\",\"changes\":[{\"rev\":\"1-967a00dff5e02add41819138abb3284d\"}]}\r\n{\"seq\":\"3-g1AAAACTeJzLYWBgYMpgTmHgz8tPSTVyMDQy1zMAQsMckEQiQ1L9____szKYE5lygQLsycZJyQZmSZjKcRqRxwIkGRqA1H-oSYxgk8wsLFLTUtIwdWUBAG8EJN8\",\"id\":\"doc1\",\"changes\":[{\"rev\":\"1-967a00dff5e02add41819138abb3284d\"}]}\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1969500836/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1969501945","html_url":"https://github.com/apache/couchdb/issues/4995#issuecomment-1969501945","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4995","id":1969501945,"node_id":"IC_kwDOAAMmUc51ZDb5","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-28T17:35:27Z","updated_at":"2024-02-28T17:35:27Z","author_association":"MEMBER","body":"(obviously you'd also need to strip the comma to process \"normal\" format as a stream but this is simple.)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1969501945/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1969514308","html_url":"https://github.com/apache/couchdb/issues/4995#issuecomment-1969514308","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4995","id":1969514308,"node_id":"IC_kwDOAAMmUc51ZGdE","user":{"login":"ronag","id":3065230,"node_id":"MDQ6VXNlcjMwNjUyMzA=","avatar_url":"https://avatars.githubusercontent.com/u/3065230?v=4","gravatar_id":"","url":"https://api.github.com/users/ronag","html_url":"https://github.com/ronag","followers_url":"https://api.github.com/users/ronag/followers","following_url":"https://api.github.com/users/ronag/following{/other_user}","gists_url":"https://api.github.com/users/ronag/gists{/gist_id}","starred_url":"https://api.github.com/users/ronag/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ronag/subscriptions","organizations_url":"https://api.github.com/users/ronag/orgs","repos_url":"https://api.github.com/users/ronag/repos","events_url":"https://api.github.com/users/ronag/events{/privacy}","received_events_url":"https://api.github.com/users/ronag/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-28T17:42:50Z","updated_at":"2024-02-28T17:42:50Z","author_association":"NONE","body":"That's a good point!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1969514308/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1970965507","html_url":"https://github.com/apache/couchdb/issues/4997#issuecomment-1970965507","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4997","id":1970965507,"node_id":"IC_kwDOAAMmUc51eowD","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-29T11:46:20Z","updated_at":"2024-02-29T11:46:20Z","author_association":"MEMBER","body":"thank you for the detailed report, I will look into it.\r\n\r\nMy first thought is that the query parser is transforming your \"Administrator\" to \"administrator\", but as it was indexed as \"string\" and not \"text\" it is held as \"Administrator\" in the index itself, and thus doesn't match. \r\n\r\nassuming that's it then I agree that the query parser should not do this for string fields and I will make a fix.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1970965507/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1971194704","html_url":"https://github.com/apache/couchdb/issues/4997#issuecomment-1971194704","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4997","id":1971194704,"node_id":"IC_kwDOAAMmUc51fgtQ","user":{"login":"GMishx","id":18077542,"node_id":"MDQ6VXNlcjE4MDc3NTQy","avatar_url":"https://avatars.githubusercontent.com/u/18077542?v=4","gravatar_id":"","url":"https://api.github.com/users/GMishx","html_url":"https://github.com/GMishx","followers_url":"https://api.github.com/users/GMishx/followers","following_url":"https://api.github.com/users/GMishx/following{/other_user}","gists_url":"https://api.github.com/users/GMishx/gists{/gist_id}","starred_url":"https://api.github.com/users/GMishx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/GMishx/subscriptions","organizations_url":"https://api.github.com/users/GMishx/orgs","repos_url":"https://api.github.com/users/GMishx/repos","events_url":"https://api.github.com/users/GMishx/events{/privacy}","received_events_url":"https://api.github.com/users/GMishx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-29T13:54:08Z","updated_at":"2024-02-29T13:54:08Z","author_association":"CONTRIBUTOR","body":"But I tried to query with \"admin\", \"administrator\" and \"Administrator\" without any luck. Same holds for other values like \"User\". Thus I am suspecting something is wrong with the analyzed value from index or query not giving out the same result. Email being a special case where analyzer does not change the value, it matches.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1971194704/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1971465424","html_url":"https://github.com/apache/couchdb/issues/4997#issuecomment-1971465424","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4997","id":1971465424,"node_id":"IC_kwDOAAMmUc51gizQ","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-29T16:07:58Z","updated_at":"2024-02-29T16:07:58Z","author_association":"MEMBER","body":"Yes, I mean in the index it is \"Administrator\" but you are not able query with the \"A\" as the query parser converts with the standard analyzer. you might say 'q=foo:Administrator' but the query parser is making it a term query on \"administrator\".","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1971465424/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":1},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1971491519","html_url":"https://github.com/apache/couchdb/issues/4997#issuecomment-1971491519","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4997","id":1971491519,"node_id":"IC_kwDOAAMmUc51gpK_","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-29T16:21:09Z","updated_at":"2024-02-29T16:21:09Z","author_association":"MEMBER","body":"e.g, if you specified the \"keyword\" analyzer for the lastName field, the query parser _won't_ lowercase it for you and it should then match.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1971491519/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1971493159","html_url":"https://github.com/apache/couchdb/issues/4997#issuecomment-1971493159","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4997","id":1971493159,"node_id":"IC_kwDOAAMmUc51gpkn","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-29T16:22:04Z","updated_at":"2024-02-29T16:22:04Z","author_association":"MEMBER","body":"https://lucene.apache.org/core/9_10_0/core/org/apache/lucene/document/StringField.html vs https://lucene.apache.org/core/9_10_0/core/org/apache/lucene/document/TextField.html btw","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1971493159/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1971763958","html_url":"https://github.com/apache/couchdb/issues/4466#issuecomment-1971763958","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4466","id":1971763958,"node_id":"IC_kwDOAAMmUc51hrr2","user":{"login":"mwasson74","id":12786751,"node_id":"MDQ6VXNlcjEyNzg2NzUx","avatar_url":"https://avatars.githubusercontent.com/u/12786751?v=4","gravatar_id":"","url":"https://api.github.com/users/mwasson74","html_url":"https://github.com/mwasson74","followers_url":"https://api.github.com/users/mwasson74/followers","following_url":"https://api.github.com/users/mwasson74/following{/other_user}","gists_url":"https://api.github.com/users/mwasson74/gists{/gist_id}","starred_url":"https://api.github.com/users/mwasson74/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mwasson74/subscriptions","organizations_url":"https://api.github.com/users/mwasson74/orgs","repos_url":"https://api.github.com/users/mwasson74/repos","events_url":"https://api.github.com/users/mwasson74/events{/privacy}","received_events_url":"https://api.github.com/users/mwasson74/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-29T18:53:36Z","updated_at":"2024-02-29T18:53:36Z","author_association":"NONE","body":"Any updates on this?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1971763958/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1971771585","html_url":"https://github.com/apache/couchdb/issues/4466#issuecomment-1971771585","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4466","id":1971771585,"node_id":"IC_kwDOAAMmUc51htjB","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-29T18:56:48Z","updated_at":"2024-02-29T18:56:48Z","author_association":"CONTRIBUTOR","body":"> Any updates on this?\r\n\r\nwhats your `bind_address` in section `chttpd`?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1971771585/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1971777128","html_url":"https://github.com/apache/couchdb/issues/4466#issuecomment-1971777128","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4466","id":1971777128,"node_id":"IC_kwDOAAMmUc51hu5o","user":{"login":"mwasson74","id":12786751,"node_id":"MDQ6VXNlcjEyNzg2NzUx","avatar_url":"https://avatars.githubusercontent.com/u/12786751?v=4","gravatar_id":"","url":"https://api.github.com/users/mwasson74","html_url":"https://github.com/mwasson74","followers_url":"https://api.github.com/users/mwasson74/followers","following_url":"https://api.github.com/users/mwasson74/following{/other_user}","gists_url":"https://api.github.com/users/mwasson74/gists{/gist_id}","starred_url":"https://api.github.com/users/mwasson74/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mwasson74/subscriptions","organizations_url":"https://api.github.com/users/mwasson74/orgs","repos_url":"https://api.github.com/users/mwasson74/repos","events_url":"https://api.github.com/users/mwasson74/events{/privacy}","received_events_url":"https://api.github.com/users/mwasson74/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-29T18:59:47Z","updated_at":"2024-02-29T18:59:47Z","author_association":"NONE","body":"chttpd section:\r\n```json\r\n  \"chttpd\": {\r\n    \"bind_address\": \"0.0.0.0\",\r\n    \"enable_cors\": \"true\",\r\n    \"port\": \"5984\"\r\n  }\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1971777128/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1971779652","html_url":"https://github.com/apache/couchdb/issues/4466#issuecomment-1971779652","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4466","id":1971779652,"node_id":"IC_kwDOAAMmUc51hvhE","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-29T19:01:26Z","updated_at":"2024-02-29T19:01:26Z","author_association":"CONTRIBUTOR","body":"`0.0.0.0` doesn't work on Windows, try `127.0.0.1` or your external ip address. Then `verify` from Fauxton should work.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1971779652/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1971825004","html_url":"https://github.com/apache/couchdb/issues/4466#issuecomment-1971825004","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4466","id":1971825004,"node_id":"IC_kwDOAAMmUc51h6ls","user":{"login":"mwasson74","id":12786751,"node_id":"MDQ6VXNlcjEyNzg2NzUx","avatar_url":"https://avatars.githubusercontent.com/u/12786751?v=4","gravatar_id":"","url":"https://api.github.com/users/mwasson74","html_url":"https://github.com/mwasson74","followers_url":"https://api.github.com/users/mwasson74/followers","following_url":"https://api.github.com/users/mwasson74/following{/other_user}","gists_url":"https://api.github.com/users/mwasson74/gists{/gist_id}","starred_url":"https://api.github.com/users/mwasson74/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mwasson74/subscriptions","organizations_url":"https://api.github.com/users/mwasson74/orgs","repos_url":"https://api.github.com/users/mwasson74/repos","events_url":"https://api.github.com/users/mwasson74/events{/privacy}","received_events_url":"https://api.github.com/users/mwasson74/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-29T19:33:23Z","updated_at":"2024-02-29T19:33:23Z","author_association":"NONE","body":"That worked, thanks! However, I was trying to change it in the local.ini and restart the service and it wouldn't take. I decided to edit the value via Fauxton and then go find what changed on the server. The file that changed was `..\\CouchDB\\etc\\local.d\\10-admins.ini`. I wonder why it wouldn't take my updated config value from `..\\CouchDB\\etc\\local.ini`...? I tried removing `..\\CouchDB\\etc\\local.d\\10-admins.ini` and it certainly didn't like that so I put it back.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1971825004/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1972150681","html_url":"https://github.com/apache/couchdb/pull/4627#issuecomment-1972150681","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4627","id":1972150681,"node_id":"IC_kwDOAAMmUc51jKGZ","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-29T23:35:01Z","updated_at":"2024-03-04T05:52:47Z","author_association":"CONTRIBUTOR","body":"Some progress update:\r\n\r\n * Updated QuickJS with the latest from upstream. We carried a few patches (a CVE patch, FreeBSD compat, and some others). All those have been merged upstream now. We only have our simple Spidermonkey 1.8.5 compat patch.\r\n\r\n * For compatibility, added `javascript_quickjs` and `javascript_spidermonkey` language variants. This is to allow testing individual views using QuickJS even if the default is kept as Spidermonkey. Or after switching the default to QuickJS, to keep some views using Spidermonkey as a temporary measure.\r\n\r\n * As discussed during one of the CouchDB meetings, implemented a scanner application to help users scan their cluster automatically for QuickJS compatibility. The scanner app can run a bunch of plugins while traversing over all the dbs, shards, ddoc, etc. To start implemented the QuickJS compat plugin only, but other plugins are possible: ddoc feature detection, finding tags or fields in ddocs, etc. The QuickJS plugin, when enabled, will trawl through all the dbs, shards and ddocs and try to compile them with both QuickJS and Spidermonkey. If results differ it will report it in the logs as a warning. \r\n\r\nTODO: \r\n * The idea so to add some doc sampling and actually some docs to the view functions.\r\n *  Write some tests for scanner app","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1972150681/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1972516855","html_url":"https://github.com/apache/couchdb/issues/4997#issuecomment-1972516855","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4997","id":1972516855,"node_id":"IC_kwDOAAMmUc51kjf3","user":{"login":"GMishx","id":18077542,"node_id":"MDQ6VXNlcjE4MDc3NTQy","avatar_url":"https://avatars.githubusercontent.com/u/18077542?v=4","gravatar_id":"","url":"https://api.github.com/users/GMishx","html_url":"https://github.com/GMishx","followers_url":"https://api.github.com/users/GMishx/followers","following_url":"https://api.github.com/users/GMishx/following{/other_user}","gists_url":"https://api.github.com/users/GMishx/gists{/gist_id}","starred_url":"https://api.github.com/users/GMishx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/GMishx/subscriptions","organizations_url":"https://api.github.com/users/GMishx/orgs","repos_url":"https://api.github.com/users/GMishx/repos","events_url":"https://api.github.com/users/GMishx/events{/privacy}","received_events_url":"https://api.github.com/users/GMishx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-01T05:05:59Z","updated_at":"2024-03-01T05:05:59Z","author_association":"CONTRIBUTOR","body":"> Yes, I mean in the index it is \"Administrator\" but you are not able query with the \"A\" as the query parser converts with the standard analyzer. you might say 'q=foo:Administrator' but the query parser is making it a term query on \"administrator\".\r\n\r\nCan confirm that's the case. I modified the doc to give the `\"lastname\": \"administrator\"`, then the query `q=lastname:admin*` gave back the expected result.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1972516855/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1972519798","html_url":"https://github.com/apache/couchdb/issues/4997#issuecomment-1972519798","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4997","id":1972519798,"node_id":"IC_kwDOAAMmUc51kkN2","user":{"login":"GMishx","id":18077542,"node_id":"MDQ6VXNlcjE4MDc3NTQy","avatar_url":"https://avatars.githubusercontent.com/u/18077542?v=4","gravatar_id":"","url":"https://api.github.com/users/GMishx","html_url":"https://github.com/GMishx","followers_url":"https://api.github.com/users/GMishx/followers","following_url":"https://api.github.com/users/GMishx/following{/other_user}","gists_url":"https://api.github.com/users/GMishx/gists{/gist_id}","starred_url":"https://api.github.com/users/GMishx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/GMishx/subscriptions","organizations_url":"https://api.github.com/users/GMishx/orgs","repos_url":"https://api.github.com/users/GMishx/repos","events_url":"https://api.github.com/users/GMishx/events{/privacy}","received_events_url":"https://api.github.com/users/GMishx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-01T05:09:23Z","updated_at":"2024-03-01T05:09:23Z","author_association":"CONTRIBUTOR","body":"> https://lucene.apache.org/core/9_10_0/core/org/apache/lucene/document/StringField.html vs https://lucene.apache.org/core/9_10_0/core/org/apache/lucene/document/TextField.html btw\r\n\r\nI also modified the index to be of type `text` rather than `string` as: `index(\"text\", \"lastname\", doc.lastname, {\"store\": true});` and query started working even for uppercase \"Admin1\".\r\n\r\nIf that's expected behavior, I can update the index creation doc.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1972519798/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1972715458","html_url":"https://github.com/apache/couchdb/pull/4998#issuecomment-1972715458","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4998","id":1972715458,"node_id":"IC_kwDOAAMmUc51lT_C","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-01T08:13:55Z","updated_at":"2024-03-01T08:13:55Z","author_association":"CONTRIBUTOR","body":"Was this a complete fresh checkout? Could this relate to[ this change](https://github.com/apache/couchdb/commit/a3ca25d574c24b91c0882322afa52375be871382) (I don't think so)?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1972715458/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1973038642","html_url":"https://github.com/apache/couchdb/issues/4997#issuecomment-1973038642","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4997","id":1973038642,"node_id":"IC_kwDOAAMmUc51mi4y","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-01T11:43:01Z","updated_at":"2024-03-01T11:43:01Z","author_association":"MEMBER","body":"\"text\" type means the value is analyzed. the Lucene analyzers typically force to lower case among other effects, which explains the new success.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1973038642/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1973060385","html_url":"https://github.com/apache/couchdb/issues/4997#issuecomment-1973060385","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4997","id":1973060385,"node_id":"IC_kwDOAAMmUc51moMh","user":{"login":"GMishx","id":18077542,"node_id":"MDQ6VXNlcjE4MDc3NTQy","avatar_url":"https://avatars.githubusercontent.com/u/18077542?v=4","gravatar_id":"","url":"https://api.github.com/users/GMishx","html_url":"https://github.com/GMishx","followers_url":"https://api.github.com/users/GMishx/followers","following_url":"https://api.github.com/users/GMishx/following{/other_user}","gists_url":"https://api.github.com/users/GMishx/gists{/gist_id}","starred_url":"https://api.github.com/users/GMishx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/GMishx/subscriptions","organizations_url":"https://api.github.com/users/GMishx/orgs","repos_url":"https://api.github.com/users/GMishx/repos","events_url":"https://api.github.com/users/GMishx/events{/privacy}","received_events_url":"https://api.github.com/users/GMishx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-01T11:58:47Z","updated_at":"2024-03-01T11:58:57Z","author_association":"CONTRIBUTOR","body":"Yeah, I got to understand that from the (archived) [couchdb-lucene project](https://github.com/rnewson/couchdb-lucene?tab=readme-ov-file#string-vs-text)\r\n\r\n@rnewson , you'd still like to work on this (I can also try to check the issue) with the lower-casing of string query.\r\nOr should I close the issue as I was using wrong field type?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1973060385/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1973096332","html_url":"https://github.com/apache/couchdb/issues/4997#issuecomment-1973096332","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4997","id":1973096332,"node_id":"IC_kwDOAAMmUc51mw-M","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-01T12:23:01Z","updated_at":"2024-03-01T12:23:18Z","author_association":"MEMBER","body":"I still intend to make an enhancement. Assuming I'm right in my first comment you did nothing wrong, and I would like nouveau to do the right thing.\r\n\r\nWe know that \"string\" fields will not be analyzed, we need to tell the query parser to also not analyze the query string for \"string\" fields (and nouveau knows the index definition, so it does know which fields are \"string\"  or \"text\", etc).\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1973096332/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1973457982","html_url":"https://github.com/apache/couchdb/pull/4998#issuecomment-1973457982","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4998","id":1973457982,"node_id":"IC_kwDOAAMmUc51oJQ-","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-01T16:07:06Z","updated_at":"2024-03-01T16:07:06Z","author_association":"CONTRIBUTOR","body":"@big-r81 it was the commit from the pr:\r\n\r\n<img width=\"784\" alt=\"Screenshot 2024-03-01 at 11 05 19 AM\" src=\"https://github.com/apache/couchdb/assets/211822/1f921f0d-37de-4f76-a92c-0f7f5304b971\">\r\n\r\nI did a new configure and make but may have not done a git clean -xffd. So maybe some artifacts were left from before?\r\n\r\nAt any rate, it's not relevant for this PR just thought I'd mention it in case we see it again. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1973457982/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1978867906","html_url":"https://github.com/apache/couchdb/pull/4990#issuecomment-1978867906","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4990","id":1978867906,"node_id":"IC_kwDOAAMmUc518yDC","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-05T14:13:11Z","updated_at":"2024-03-05T14:13:11Z","author_association":"CONTRIBUTOR","body":"The Mango integration test suites (`make mango-test`) are failing, most of them are HTTP 500s:\r\n\r\n```console\r\n[2024-03-05T14:04:18.471Z] Ran 384 tests in 12.251s\r\n[2024-03-05T14:04:18.471Z] \r\n[2024-03-05T14:04:18.471Z] FAILED (failures=3, errors=75, skipped=143)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1978867906/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1978889119","html_url":"https://github.com/apache/couchdb/pull/4990#issuecomment-1978889119","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4990","id":1978889119,"node_id":"IC_kwDOAAMmUc5183Of","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-05T14:23:36Z","updated_at":"2024-03-05T14:23:36Z","author_association":"CONTRIBUTOR","body":"This seems to be the cause:\r\n\r\n```\r\n[error] 2024-03-05T14:20:35.042023Z node1@127.0.0.1 <0.757.0> ca0f3d4937 req_err(3855649447) badrecord : undefined\r\n    [<<\"mango_execution_stats:log_start/1 L106\">>,<<\"mango_cursor_view:execute/3 L220\">>,<<\"mango_httpd:handle_find_req/2 L213\">>,<<\"mango_httpd:handle_req/2 L35\">>,<<\"chttpd:handle_req_after_auth/2 L416\">>,<<\"chttpd:process_request/1 L394\">>,<<\"chttpd:handle_request_int/1 L329\">>,<<\"mochiweb_http:headers/6 L140\">>]\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1978889119/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1979741972","html_url":"https://github.com/apache/couchdb/pull/4990#issuecomment-1979741972","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4990","id":1979741972,"node_id":"IC_kwDOAAMmUc52AHcU","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-05T22:27:06Z","updated_at":"2024-03-05T22:27:06Z","author_association":"CONTRIBUTOR","body":"Okay, cool.  Looks like all the issues have been fixed.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1979741972/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1986575586","html_url":"https://github.com/apache/couchdb/pull/4984#issuecomment-1986575586","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4984","id":1986575586,"node_id":"IC_kwDOAAMmUc52aLzi","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-08T23:49:31Z","updated_at":"2024-03-08T23:49:31Z","author_association":"CONTRIBUTOR","body":"> Since we're eventually trying to report the work done by a worker up until the row it emitted, would it make sense to have the `completed` messages return the extra metadata object/stats object as well, if the `view_row_map` if flag is set?\r\n\r\nI am not sure about that.\r\n\r\nOriginally, the problem what this PR wants to solve is about the case when streaming of view rows is \"abruptly\" terminated in response to the `stop` in the callback (as a short circuit).  The proposed `{complete, #{}}` reply would be sent when the callback is receives `complete`.  But this means that everything that the worker wanted to stream has reached the destination by that time, assuming that no messages were lost in transit.\r\n\r\nOn the other hand, the change focuses on making the structure of the view rows more flexible, and it does not know anything about how this is utilized.  It is not necessarily the statistics that could be sent along the streamed rows but anything that the view callback may consider meaningful.\r\n\r\nIf statistics is sent along with the standard view row data, I think there is no need to return a closing message with metadata.  Statistical information could be sent as either deltas or absolute values, this is subject to the implementation of the given view.  They are both sufficient to keep track of statistics about the view rows.  I have tested this in the Mango rolling execution statistics PR (one of the future consumers of this change) and it worked without the need for extending the `complete` messages.\r\n\r\nThat said, I do not see any explicit need for this.  But it could be added later on, if any related use case surfaces.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1986575586/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1986728385","html_url":"https://github.com/apache/couchdb/pull/4984#issuecomment-1986728385","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4984","id":1986728385,"node_id":"IC_kwDOAAMmUc52axHB","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-09T04:47:10Z","updated_at":"2024-03-09T04:48:00Z","author_association":"CONTRIBUTOR","body":"> Originally, the problem what this PR wants to solve is about the case when streaming of view rows is \"abruptly\" terminated in response to the stop in the callback (as a short circuit). The proposed {complete, #{}} reply would be sent when the callback is receives complete. But this means that everything that the worker wanted to stream has reached the destination by that time, assuming that no messages were lost in transit.\r\n\r\nThe `stop` callback would normally be called when `limit` number of rows had been emitted by the coordinator to the client. With the new code we'd get the extra stats map to account for the work the worker did prior to emitting that row. However, the streaming may also end if we reach the end of the btree. Then, instead of a row we'd emit a `complete` message. The idea is to account for the work done since we emit the last row, until the `complete` message. Thinking of a selective filter that pics maybe every 200th row, with a total of 500 rows: if we emit row 400, we'd keep scanning until we reach 500 and emit a `complete` message, but then we'd wouldn't account for work done while scanning rows 400->500 if we never emitted any other view row during that time.\r\n\r\nNow we emit a separate execution stats message and a callback message https://github.com/apache/couchdb/blob/5c6aeabb3c35ec326714fa830caa635e896389e3/src/mango/src/mango_cursor_view.erl#L419-L422, which is fine but since we're making these messages flexible and able to carry any metadata, if it would make sense let the `complete` message also carry the extra metadata.  That way we wouldn't have to send separate execution_stats message at all, complete and view rows extra field would have a place to send back stats as well.\r\n\r\nHowever, updating all the message handlers which `complete` to check the option and also handle `{complete, #{}}` might be kind of cumbersome, since there are quite a few of them. However we already have a place where we need it and it already returns an extra Props object:\r\n\r\nhttps://github.com/apache/couchdb/blob/5c6aeabb3c35ec326714fa830caa635e896389e3/src/fabric/src/fabric_view_changes.erl#L288-L291","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1986728385/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1986812663","html_url":"https://github.com/apache/couchdb/pull/4984#issuecomment-1986812663","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4984","id":1986812663,"node_id":"IC_kwDOAAMmUc52bFr3","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-09T09:59:14Z","updated_at":"2024-03-09T09:59:14Z","author_association":"CONTRIBUTOR","body":"> the streaming may also end if we reach the end of the btree. Then, instead of a row we'd emit a `complete` message.\r\n\r\nI would not call those cases \"abruptly terminated\" because there is a chance to gracefully send out all the required messages.  The easy extension of view rows is a future-proof alternative to creating a another `view_row` record structure with the missing field (which is the execution stats in the Mango PR) each time.  This level of atomicity is required to protect the worker from failing to communicate its metadata before the stream is closed.  When no view row was streamed, the metadata reaches the coordinator, tight coupling is not a concern.\r\n\r\nYes, this leaves us with separate `execution_stats` messages, but this is just refactor it does not add much to either the correctness or the performance.  Ideally, I would keep this separation, because it is more compositional but deemed to be less performant.  Stitching a map to the `complete` message does not do much more in my understanding.\r\n\r\n> However, updating all the message handlers which `complete` to check the option and also handle `{complete, #{}}` might be kind of cumbersome, since there are quite a few of them.\r\n\r\nThat is one of reasons why I am rather hesitant to take on this advice.\r\n\r\n> However we already have a place where we need it and it already returns an extra Props object:\r\n> \r\n> https://github.com/apache/couchdb/blob/5c6aeabb3c35ec326714fa830caa635e896389e3/src/fabric/src/fabric_view_changes.erl#L288-L291\r\n\r\nI would say this is out of scope of this PR.  I assume this part of the code does not have any consistency or performance issues, introducing extended `complete` messages would only simplify the code.  Which is nice, but it would leave it for another PR.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1986812663/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1986917834","html_url":"https://github.com/apache/couchdb/issues/1611#issuecomment-1986917834","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1611","id":1986917834,"node_id":"IC_kwDOAAMmUc52bfXK","user":{"login":"sergey-safarov","id":2562241,"node_id":"MDQ6VXNlcjI1NjIyNDE=","avatar_url":"https://avatars.githubusercontent.com/u/2562241?v=4","gravatar_id":"","url":"https://api.github.com/users/sergey-safarov","html_url":"https://github.com/sergey-safarov","followers_url":"https://api.github.com/users/sergey-safarov/followers","following_url":"https://api.github.com/users/sergey-safarov/following{/other_user}","gists_url":"https://api.github.com/users/sergey-safarov/gists{/gist_id}","starred_url":"https://api.github.com/users/sergey-safarov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sergey-safarov/subscriptions","organizations_url":"https://api.github.com/users/sergey-safarov/orgs","repos_url":"https://api.github.com/users/sergey-safarov/repos","events_url":"https://api.github.com/users/sergey-safarov/events{/privacy}","received_events_url":"https://api.github.com/users/sergey-safarov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-09T17:01:44Z","updated_at":"2024-03-09T17:55:51Z","author_association":"NONE","body":"More info about the error message.\r\nNormal database security should look like\r\n```sh\r\n[root@esrp-0a ~]# curl -s http://login:pass@127.0.0.1:5984/db_name/_security| jq\r\n{\r\n  \"members\": {\r\n    \"roles\": [\r\n      \"_admin\"\r\n    ]\r\n  },\r\n  \"admins\": {\r\n    \"roles\": [\r\n      \"_admin\"\r\n    ]\r\n  }\r\n}\r\n```\r\nFor database where error present the same command produce\r\n```sh\r\n[root@esrp-0a ~]# curl -s http://login:pass@127.0.0.1:5984/db_name/_security| jq\r\n{}\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1986917834/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1986929659","html_url":"https://github.com/apache/couchdb/issues/1611#issuecomment-1986929659","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1611","id":1986929659,"node_id":"IC_kwDOAAMmUc52biP7","user":{"login":"sergey-safarov","id":2562241,"node_id":"MDQ6VXNlcjI1NjIyNDE=","avatar_url":"https://avatars.githubusercontent.com/u/2562241?v=4","gravatar_id":"","url":"https://api.github.com/users/sergey-safarov","html_url":"https://github.com/sergey-safarov","followers_url":"https://api.github.com/users/sergey-safarov/followers","following_url":"https://api.github.com/users/sergey-safarov/following{/other_user}","gists_url":"https://api.github.com/users/sergey-safarov/gists{/gist_id}","starred_url":"https://api.github.com/users/sergey-safarov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sergey-safarov/subscriptions","organizations_url":"https://api.github.com/users/sergey-safarov/orgs","repos_url":"https://api.github.com/users/sergey-safarov/repos","events_url":"https://api.github.com/users/sergey-safarov/events{/privacy}","received_events_url":"https://api.github.com/users/sergey-safarov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-09T17:50:12Z","updated_at":"2024-03-09T17:50:12Z","author_association":"NONE","body":"To display the status of security objects on my server I have created a script. Required to edit login and pass in the script.\r\n\r\n```sh\r\n#!/bin/sh\r\n\r\ndb_url=http://login:pass@127.0.0.1:5984\r\nfix_db=false\r\n\r\nescape_dbname() {\r\n\tlocal DBNAME=$1\r\n\techo $DBNAME | sed -e 's:/:%2f:g' -e 's:\\+:%2B:'\r\n}\r\n\r\nsecurity_json() {\r\ncat << EOF\r\n{\"members\":{\"roles\":[\"_admin\"]},\"admins\":{\"roles\":[\"_admin\"]}}\r\nEOF\r\n}\r\n\r\nget_db_list() {\r\ncurl -s ${db_url}/_all_dbs | jq -r '.[]'\r\n}\r\n\r\ncheck_db_security() {\r\n\tlocal dbname=$1\r\n\tlocal esc_dbname=$(escape_dbname ${dbname})\r\n\tcurl -s ${db_url}/${esc_dbname}/_security | jq 'if . == {} then false else true end'\r\n}\r\n\r\nmaybe_fix_db_security() {\r\n\tlocal dbname=$1\r\n\tlocal esc_dbname=$(escape_dbname ${dbname})\r\n\tif [ \"${fix_db}\" == \"false\" ]; then\r\n\t\techo \"need to fix database: ${dbname}\"\r\n\t\treturn\r\n\tfi\r\n\techo \"fixing database: ${dbname}\"\r\n\tsecurity_json | curl -X PUT -H 'content-type: application/json' -H 'accept: application/json' -d@- -s ${db_url}/${esc_dbname}/_security\r\n}\r\n\r\nfor i in $(get_db_list)\r\ndo\r\n\tsec_status=$(check_db_security $i)\r\n\tif [ \"${sec_status}\" == \"false\" ]; then\r\n\t\tmaybe_fix_db_security $i\r\n\tfi\r\ndone\r\n```\r\nTo fix security objects need to set \"fix_db\" variable to \"true\" value.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1986929659/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1986986167","html_url":"https://github.com/apache/couchdb/issues/4448#issuecomment-1986986167","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4448","id":1986986167,"node_id":"IC_kwDOAAMmUc52bwC3","user":{"login":"joaohf","id":278690,"node_id":"MDQ6VXNlcjI3ODY5MA==","avatar_url":"https://avatars.githubusercontent.com/u/278690?v=4","gravatar_id":"","url":"https://api.github.com/users/joaohf","html_url":"https://github.com/joaohf","followers_url":"https://api.github.com/users/joaohf/followers","following_url":"https://api.github.com/users/joaohf/following{/other_user}","gists_url":"https://api.github.com/users/joaohf/gists{/gist_id}","starred_url":"https://api.github.com/users/joaohf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/joaohf/subscriptions","organizations_url":"https://api.github.com/users/joaohf/orgs","repos_url":"https://api.github.com/users/joaohf/repos","events_url":"https://api.github.com/users/joaohf/events{/privacy}","received_events_url":"https://api.github.com/users/joaohf/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-09T21:32:48Z","updated_at":"2024-03-09T21:32:48Z","author_association":"NONE","body":"Hi @nickva \r\n\r\nI'm trying this PR as a hope to substitute mozjs in the context of meta-erlang Yocto layer.\r\n\r\nWhile testing the qjs branch I got the following error:\r\n\r\n```\r\n| Compiling /build/tmp-qemux86-64-glibc-couchdb/work/core2-64-poky-linux/couchdb/3.3.3+git/git/src/couch/priv/couch_js/86/main.cpp\r\n| /build/tmp-qemux86-64-glibc-couchdb/work/core2-64-poky-linux/couchdb/3.3.3+git/git/src/couch/priv/couch_js/86/main.cpp:24:10: fatal error: jsapi.h: No such file or directory\r\n|    24 | #include <jsapi.h>\r\n|       |          ^~~~~~~~~\r\n```\r\n\r\nIn my case, I don't have mozjs dependencies. Is that suppose to work ? I mean, could I say with couchdb is configured with quickjs engine, then couchdb does not need mozjs at all ?\r\n\r\n\r\nThanks.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1986986167/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1987006897","html_url":"https://github.com/apache/couchdb/pull/4984#issuecomment-1987006897","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4984","id":1987006897,"node_id":"IC_kwDOAAMmUc52b1Gx","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-09T23:17:10Z","updated_at":"2024-03-10T12:50:14Z","author_association":"CONTRIBUTOR","body":"> I would not call those cases \"abruptly terminated\" because there is a chance to gracefully send out all the required messages. \r\n\r\nYeah definitely. In fact, I am not sure if \"abruptly terminated\" exactly applies here in general. That part works like that by design. In the majority of cases, the `complete` message won't be sent unless scanning is towards the end of the shard for all_docs or it's a short index key range. So the \"abrupt\" case might be more common in non-test sized databases.\r\n\r\n> Yes, this leaves us with separate execution_stats messages, but this is just refactor it does not add much to either the correctness or the performance\r\n\r\nExactly. That would be more of a nice-to-have to make things more consistent. And since when we do that refactor later we'd need to introduce another `extras` option, I thought we could piggy back on this PR, but that does look a large change and so let's not bother with it currently.\r\n\r\nAlso in theory I think it could affect correctness. We are handling and processing execution stats messages out of band without going through the merge row semantics. Notice, we call the `Callback` right away https://github.com/apache/couchdb/blob/5c6aeabb3c35ec326714fa830caa635e896389e3/src/fabric/src/fabric_view_all_docs.erl#L272 unlike a view row, which goes through the merge_row + maybe_send_row mechanism https://github.com/apache/couchdb/blob/5c6aeabb3c35ec326714fa830caa635e896389e3/src/fabric/src/fabric_view_all_docs.erl#L263-L266 so, we may be be accounting the stats for row or complete messages which never participated in the generation of the response row. [1] The chances there are small so not worth bothering about probably.\r\n\r\n> That is one of reasons why I am rather hesitant to take on this advice.\r\n\r\nYup, agree, let's not worry about it in this PR.\r\n\r\n[1] This is according to our new semantics as discussed in the previous PR, that we want to account exactly for work which happened on each worker, prior to its emitted row if that row was included as part of the response, as opposed to having a probabilistic kind of a thing where we account for the approximate work as I suggested initially.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1987006897/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1987008468","html_url":"https://github.com/apache/couchdb/issues/4448#issuecomment-1987008468","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4448","id":1987008468,"node_id":"IC_kwDOAAMmUc52b1fU","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-09T23:24:58Z","updated_at":"2024-03-11T16:34:39Z","author_association":"CONTRIBUTOR","body":"@joaohf Thanks for trying it out!\r\n\r\nCurrently the branch requires both engines to be built as it's expected users would want try quickjs but have the ability to switch back to spidermonkey. There is even a compatibility background scanner app to help evaluate view functions with both to compare and report discrepancies in the log.\r\n\r\nIf everything goes well the idea is to eventually have a quickjs only build mode, but it's not there yet. I'll have to see if it's easy to add that, maybe as a `--disable-spidermonkey` option to `./configure` where it won't even try to build spidermonkey to start with and just default to quickjs.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1987008468/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1988829285","html_url":"https://github.com/apache/couchdb/issues/4448#issuecomment-1988829285","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4448","id":1988829285,"node_id":"IC_kwDOAAMmUc52iyBl","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-11T16:16:08Z","updated_at":"2024-03-11T16:16:08Z","author_association":"CONTRIBUTOR","body":"This error message above is surprising to me.  In 9536b979, I have added some checks for `configure` to verify if SpiderMonkey is present and usable at the assumed location (with the assumed version, which is 91 by default).   This check should have complained about the absence of SM.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1988829285/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1989114081","html_url":"https://github.com/apache/couchdb/pull/4984#issuecomment-1989114081","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4984","id":1989114081,"node_id":"IC_kwDOAAMmUc52j3jh","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-11T18:05:42Z","updated_at":"2024-03-11T18:05:42Z","author_association":"CONTRIBUTOR","body":"> In fact, I am not sure if \"abruptly terminated\" exactly applies here in general. That part works like that by design. In the majority of cases, the `complete` message won't be sent unless scanning is towards the end of the shard for all_docs or it's a short index key range. So the \"abrupt\" case might be more common in non-test sized databases.\r\n\r\nProbably \"abrupt\" is a strong word here.  That is just my false expectation on that `complete` should always be explicit 😛  Either way it goes, it complicates statistics calculation as it is illustrated by the motivation of the rolling execution statistics.\r\n\r\n> That would be more of a nice-to-have to make things more consistent. And since when we do that refactor later we'd need to introduce another `extras` option, I thought we could piggy back on this PR, but that does look a large change and so let's not bother with it currently.\r\n\r\nYeah, I have noticed the piggy on the back.  I am a fan of consistent code changes, but this is slightly more than that me.  As I mentioned, I consider this \"view row map\" operation mode oblivious to sending any metadata — we could even say that this is only a coincidence that the next field we may want to add is about that.  It can be combined with \"extensible complete\" of which may have its own scope of application.  I see these as two orthogonal building blocks for hosting other features.  (Compositionality.)  Tackling this problem in a separate PR can help with limiting the scope of this one, mitigating the associated (deployment) risks, and shipping the dependent feature quicker.\r\n\r\n>  in theory I think it could affect correctness. We are handling and processing execution stats messages out of band without going through the merge row semantics. [..] we may be accounting the stats for row or complete messages which never participated in the generation of the response row.\r\n\r\nMind we are switching to the discussion of the Mango rolling execution statistics here, which is only a possible application.  Note that the `execution_stats` message is only used by Mango, but for some reason, it had to be driven through (woven into, pun intended) Fabric.   I do not think we are accounting for the `complete` messages themselves there.  This type of message is used to [trigger the worker to submit its (shard-level) statistics to the coordinator](https://github.com/apache/couchdb/blob/5c6aeabb3c35ec326714fa830caa635e896389e3/src/mango/src/mango_cursor_view.erl#L409-L423).\r\n\r\nIn the Mango execution statistics, currently we have \"keys examined\", \"docs examined\", and \"results returned\".  Views are created from key ranges of (the selected) indexes.  Walking the whole view, independently of whether the corresponding row matches the selector (filter) [should always implicitly bump the count of keys examined](https://github.com/apache/couchdb/blob/5c6aeabb3c35ec326714fa830caa635e896389e3/src/mango/src/mango_cursor_view.erl#L354).  (This is the broadest.)  On the contrary, [docs examined are counted only if a document was accessed](https://github.com/apache/couchdb/blob/5c6aeabb3c35ec326714fa830caa635e896389e3/src/mango/src/mango_cursor_view.erl#L404).  (This might be narrower.)  And then if the document matches the selector, [it is counted as a result returned](https://github.com/apache/couchdb/blob/5c6aeabb3c35ec326714fa830caa635e896389e3/src/mango/src/mango_cursor_view.erl#L540).  (The narrowest set.)\r\n\r\nThe associated calculations are always performed in response to the view rows.  The `execution_stats` message is responsible for coordinating the sum (\"reduce\") of the shard-level (worker-local) statistics only.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1989114081/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1989722133","html_url":"https://github.com/apache/couchdb/issues/4448#issuecomment-1989722133","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4448","id":1989722133,"node_id":"IC_kwDOAAMmUc52mMAV","user":{"login":"joaohf","id":278690,"node_id":"MDQ6VXNlcjI3ODY5MA==","avatar_url":"https://avatars.githubusercontent.com/u/278690?v=4","gravatar_id":"","url":"https://api.github.com/users/joaohf","html_url":"https://github.com/joaohf","followers_url":"https://api.github.com/users/joaohf/followers","following_url":"https://api.github.com/users/joaohf/following{/other_user}","gists_url":"https://api.github.com/users/joaohf/gists{/gist_id}","starred_url":"https://api.github.com/users/joaohf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/joaohf/subscriptions","organizations_url":"https://api.github.com/users/joaohf/orgs","repos_url":"https://api.github.com/users/joaohf/repos","events_url":"https://api.github.com/users/joaohf/events{/privacy}","received_events_url":"https://api.github.com/users/joaohf/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-12T01:06:34Z","updated_at":"2024-03-12T01:06:34Z","author_association":"NONE","body":"Hi\r\n\r\n@pgj that will work. But, as I configure couchdb with:\r\n\r\n```\r\nNOTE: Running ./configure --js-engine=quickjs --disable-docs     --rebar /build/tmp-qemux86-64-glibc-couchdb/work/core2-64-poky-linux/couchdb/3.3.3+git/recip\r\ne-sysroot-native/usr/bin/rebar     --rebar3 /build/tmp-qemux86-64-glibc-couchdb/work/core2-64-poky-linux/couchdb/3.3.3+git/recipe-sysroot-native/usr/bin/reba\r\nr3     --erlfmt /build/tmp-qemux86-64-glibc-couchdb/work/core2-64-poky-linux/couchdb/3.3.3+git/recipe-sysroot-native/usr/bin/erlfmt\r\n```\r\n\r\nThe SM has been disabled when js-engine is quickjs https://github.com/apache/couchdb/blob/qjs/configure#L321\r\n\r\n@nickva, so could I state that SM will be necessary even for quickjs as the user needs to make a configuration choice in order to enable/disable quickjs  and will be users that would like to --disable-spidermonkey from their builds ?\r\n\r\nMy big issue with SM-91 is because it does not support python-3.12 as build environment. As I'm integrating couchdb with the latest Yocto environment (which only supports python 3.12), I have a hard decision to keep couchdb and try to patch SM-91 to use python 3.12.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1989722133/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1989933851","html_url":"https://github.com/apache/couchdb/issues/4448#issuecomment-1989933851","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4448","id":1989933851,"node_id":"IC_kwDOAAMmUc52m_sb","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-12T02:57:28Z","updated_at":"2024-03-12T03:47:54Z","author_association":"CONTRIBUTOR","body":"> @nickva, so could I state that SM will be necessary even for quickjs as the user needs to make a configuration choice in order to enable/disable quickjs and will be users that would like to --disable-spidermonkey from their builds ?\r\n\r\n@joaohf I think your case is valid, eventually it should work with SM completely unavailable, so I'll try to do add a --disable-spidermonkey configuration flag which won't even look for and try to build spidermonkey. It's just that at first, I was focused on allowing both, so users could evaluate the new JS engine and detect any compatibility issues. I'll try to add that mode after finishing the scanner part.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1989933851/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1991921571","html_url":"https://github.com/apache/couchdb/pull/4984#issuecomment-1991921571","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4984","id":1991921571,"node_id":"IC_kwDOAAMmUc52uk-j","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-12T15:28:12Z","updated_at":"2024-03-12T15:28:12Z","author_association":"CONTRIBUTOR","body":"> Mind we are switching to the discussion of the Mango rolling execution statistics here, which is only a possible application. Note that the execution_stats message is only used by Mango, but for some reason, it had to be driven through (woven into, pun intended) Fabric.\r\n\r\nIt is related to correctness that's why I mentioned the other pr. I was just pointing out that based on the discussion in the previous pr, and new semantics of how on the coordinator we want to account only for rows which participate in emitting the response to the user. With that view, having separate messages vs one message can lead to unexpected behavior. Because it may be possible for another worker to insert their message in between the two messages when streaming is about to conclude. In general, there could be a good amount of difference between the work done prior to emitting each row sent to the client, and all the work done by each worker.\r\n\r\n> but for some reason, it had to be driven through (woven into, pun intended) Fabric.\r\n\r\nThis is a side-effect of mango using fabric all_docs and view query as a layer. That extra handling of execution stats in all_docs and view query was another impetus for having a generic completion metadata. Though that would also require a bit more work to make sure it passes through the merge sort mechanism.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1991921571/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1992093154","html_url":"https://github.com/apache/couchdb/pull/4984#issuecomment-1992093154","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4984","id":1992093154,"node_id":"IC_kwDOAAMmUc52vO3i","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-12T16:38:19Z","updated_at":"2024-03-12T16:38:19Z","author_association":"CONTRIBUTOR","body":"> It is related to correctness that's why I mentioned the other pr.\r\n\r\nI am sure you are right about that.  But I think we should carry on with the related discussion in #4958 then.  Regarding this PR, could you please make some other case that is not the Mango rolling execution statistics?  The \"view row map capability\" only makes it possible to get rid of the rigidity of the record-based communication.  We could use it to send non-metadata or anything else, I just do not have any other case on my mind.  But in theory, that is entirely possible!\r\n\r\n> it may be possible for another worker to insert their message in between the two messages when streaming is about to conclude. In general, there could be a good amount of difference between the work done prior to emitting each row sent to the client, and all the work done by each worker.\r\n\r\nRight.  But is this a real problem here?  The folding of Mango execution statistics hinges upon addition, which is a commutative and non-associative operation, which even lends itself to parallelization.  The collection of the pieces happen locally without any interaction between the workers.  Probably I am missing something here.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1992093154/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1992166433","html_url":"https://github.com/apache/couchdb/pull/4984#issuecomment-1992166433","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4984","id":1992166433,"node_id":"IC_kwDOAAMmUc52vgwh","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-12T17:16:09Z","updated_at":"2024-03-12T17:16:09Z","author_association":"CONTRIBUTOR","body":"> Right.  But is this a real problem here?  The folding of Mango execution statistics hinges upon addition, which is a commutative and non-associative operation, which even lends itself to parallelization.  The collection of the pieces happen locally without any interaction between the workers.  Probably I am missing something here.\r\n\r\nIt is if we want make any correctness guarantees. It doesn't have as much to do with commutativity and non-associativity of operations but which statistics should contribute to the result. We agreed to two things as far I recall:\r\n1) We liked Bob's idea of counting only [contributing workers](https://github.com/apache/couchdb/pull/4958#issuecomment-1918072757) 2) based on your comment, not allowing uncertainty\r\n\r\n> @nickva I am afraid we cannot allow any uncertainty in the statistics if downstream consumers wanted to build uses cases on top of this mechanism that involves billing.\r\n\r\nAnd pointing out that having separate interleaved stats messages based on random arrival order from worker seems to conflict with the correctness goal. Towards the conclusion of request we could end up accounting for stats messages out-of-band so to speak, workers which did work that didn't end up contributing to the final response. However, as we discussed, the chance of this is probably low and maybe not worth worrying about. I am merely clarifying that it does impact correctness.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1992166433/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1992207021","html_url":"https://github.com/apache/couchdb/pull/4984#issuecomment-1992207021","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4984","id":1992207021,"node_id":"IC_kwDOAAMmUc52vqqt","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-12T17:38:27Z","updated_at":"2024-03-12T17:38:27Z","author_association":"CONTRIBUTOR","body":"> > But is this a real problem here? \r\n> It is if we want make any correctness guarantees. It doesn't have as much to do with commutativity and non-associativity of operations but which statistics should contribute to the result.\r\n\r\nAh, now I got it!  Thanks for your patience in explaining this to me.  I was sure that I am missing something and I was confused that the comments about #4958 got included in this discussion.  Please let me think about those in the scope of #4958 and leave them out from this PR.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1992207021/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1993147779","html_url":"https://github.com/apache/couchdb/issues/5002#issuecomment-1993147779","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5002","id":1993147779,"node_id":"IC_kwDOAAMmUc52zQWD","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-13T02:18:18Z","updated_at":"2024-03-13T02:18:18Z","author_association":"CONTRIBUTOR","body":"Nouveau will be included in 3.4.0 release.\r\n\r\nThere is not  set timeframe, but currently the main thing we're waiting on is review of the nouveau deb packaging PR in https://github.com/apache/couchdb-pkg/pull/125. I am planning on reviewing this week or weekend.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1993147779/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1995612536","html_url":"https://github.com/apache/couchdb/issues/5002#issuecomment-1995612536","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5002","id":1995612536,"node_id":"IC_kwDOAAMmUc528qF4","user":{"login":"jonasplaum","id":9090041,"node_id":"MDQ6VXNlcjkwOTAwNDE=","avatar_url":"https://avatars.githubusercontent.com/u/9090041?v=4","gravatar_id":"","url":"https://api.github.com/users/jonasplaum","html_url":"https://github.com/jonasplaum","followers_url":"https://api.github.com/users/jonasplaum/followers","following_url":"https://api.github.com/users/jonasplaum/following{/other_user}","gists_url":"https://api.github.com/users/jonasplaum/gists{/gist_id}","starred_url":"https://api.github.com/users/jonasplaum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jonasplaum/subscriptions","organizations_url":"https://api.github.com/users/jonasplaum/orgs","repos_url":"https://api.github.com/users/jonasplaum/repos","events_url":"https://api.github.com/users/jonasplaum/events{/privacy}","received_events_url":"https://api.github.com/users/jonasplaum/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-13T20:04:31Z","updated_at":"2024-03-14T12:56:57Z","author_association":"CONTRIBUTOR","body":"Thanks. This sounds good to me. I have a second question about Nouveau. We want to have one or more couchdb and corresponding nouveau nodes for our customer in different offices from our customers. We need to sync the data between the nodes, and everything should still work for every node, even if the Network between the nodes is lost. The should get synced after network restoration. We use clustering with n = NODE_COUNT and q = 1, so that we get all data on every node. This seems to work as expected, but Nouveau doesen't work if any node is down. We get the following message if a node (In this example `couchdb@deacsrewdbbt2.customer.de`) is down and is not included in the error response below: \r\n``` \r\n\"error\": \"badrecord\",\r\n    \"reason\": \"[{{shard,<<\\\"shards/00000000-ffffffff/foo.1710344337\\\">>,\\n         'couchdb@deacsrewdbbt1.customer.com',<<\\\"foo\\\">>,\\n         [0,4294967295],\\n         #Ref<0.1884847839.2480668675.227080>,\\n         [{props,[]}]},\\n  nil},\\n {{shard,<<\\\"shards/00000000-ffffffff/foo.1710344337\\\">>,\\n         'couchdb@deacsrewdbbt3.customer.com',<<\\\"foo\\\">>,\\n         [0,4294967295],\\n         #Ref<0.1884847839.2480668675.227078>,\\n         [{props,[]}]},\\n  nil}]\",\r\n    \"ref\": 3715306381\r\n``` \r\n\r\nThis is the Log part from the CouchDB Server 3 that got the request:\r\n```\r\n[error] 2024-03-14T08:26:05.582072Z couchdb@deacsrewdbbt3.customer.com <0.902.0> 844d099269 req_err(3715306381) badrecord : [{{shard,<<\"shards/00000000-ffffffff/foo.1710344337\">>,\r\n         'couchdb@deacsrewdbbt1.customer.com',<<\"foo\">>,\r\n         [0,4294967295],\r\n         #Ref<0.1884847839.2480668675.227080>,\r\n         [{props,[]}]},\r\n  nil},\r\n {{shard,<<\"shards/00000000-ffffffff/foo.1710344337\">>,\r\n         'couchdb@deacsrewdbbt3.customer.com',<<\"foo\">>,\r\n         [0,4294967295],\r\n         #Ref<0.1884847839.2480668675.227078>,\r\n         [{props,[]}]},\r\n  nil}]\r\n    [<<\"nouveau_fabric_search:handle_message/3 L84\">>,<<\"rexi_utils:process_mailbox/6 L55\">>,<<\"nouveau_fabric_search:go/4 L64\">>,<<\"nouveau_httpd:handle_search_req/6 L103\">>,<<\"nouveau_httpd:handle_search_req/3 L56\">>,<<\"chttpd:handle_req_after_auth/2 L416\">>,<<\"chttpd:process_request/1 L394\">>,<<\"chttpd:handle_request_int/1 L329\">>]\r\n[notice] 2024-03-14T08:26:05.582265Z couchdb@deacsrewdbbt3.customer.com <0.902.0> 844d099269 10.249.4.203:5984 192.168.244.83 admin GET /foo/_design/foo/_nouveau/search?q=_id:doc1706* 500 ok 38\r\n\r\n```\r\n\r\nIs it not supported by Nouveau to work only with the local node in this case, or do i need to change something for this to work?\r\n\r\nThanks.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1995612536/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1997555440","html_url":"https://github.com/apache/couchdb/issues/5004#issuecomment-1997555440","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5004","id":1997555440,"node_id":"IC_kwDOAAMmUc53EEbw","user":{"login":"huneau","id":9199240,"node_id":"MDQ6VXNlcjkxOTkyNDA=","avatar_url":"https://avatars.githubusercontent.com/u/9199240?v=4","gravatar_id":"","url":"https://api.github.com/users/huneau","html_url":"https://github.com/huneau","followers_url":"https://api.github.com/users/huneau/followers","following_url":"https://api.github.com/users/huneau/following{/other_user}","gists_url":"https://api.github.com/users/huneau/gists{/gist_id}","starred_url":"https://api.github.com/users/huneau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huneau/subscriptions","organizations_url":"https://api.github.com/users/huneau/orgs","repos_url":"https://api.github.com/users/huneau/repos","events_url":"https://api.github.com/users/huneau/events{/privacy}","received_events_url":"https://api.github.com/users/huneau/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-14T14:13:00Z","updated_at":"2024-03-14T14:13:00Z","author_association":"NONE","body":"Finally found my issue, we have in our DB some massive Documents with conflicts that cause issue with network. \r\nThat's it, hopefully, the migration will end up with success.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1997555440/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1997573484","html_url":"https://github.com/apache/couchdb/issues/5004#issuecomment-1997573484","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5004","id":1997573484,"node_id":"IC_kwDOAAMmUc53EI1s","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-14T14:21:18Z","updated_at":"2024-03-14T14:21:18Z","author_association":"CONTRIBUTOR","body":"No worries at all. You can try to reduce the replicator batch size: https://docs.couchdb.org/en/stable/config/replicator.html#replicator/worker_batch_size if you have huge documents. Make it 50 instead of the default 500, for instance. If you see timeouts, consider increasing https://docs.couchdb.org/en/stable/config/replicator.html#replicator/connection_timeout","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1997573484/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1997609511","html_url":"https://github.com/apache/couchdb/issues/4994#issuecomment-1997609511","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4994","id":1997609511,"node_id":"IC_kwDOAAMmUc53ERon","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-14T14:38:03Z","updated_at":"2024-03-14T14:38:03Z","author_association":"CONTRIBUTOR","body":"I am not sure exactly why more CPU would be consumed on the other nodes. It could be that view shards there hadn't caught up as much as the shard which was reset so they started to get built. When this view was reset perhaps there were active requests waiting to receive rows (responses) from it and so waiting view clients might have been piling up.\r\n\r\nYou can check for the number of waiting view clients with: https://docs.couchdb.org/en/stable/api/ddoc/common.html#get--db-_design-ddoc-_info\r\n\r\nTo see if it's any view builds taking place, try using https://docs.couchdb.org/en/stable/api/server/common.html#active-tasks","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1997609511/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1998869603","html_url":"https://github.com/apache/couchdb/pull/4984#issuecomment-1998869603","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4984","id":1998869603,"node_id":"IC_kwDOAAMmUc53JFRj","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-15T03:22:01Z","updated_at":"2024-03-15T03:22:01Z","author_association":"CONTRIBUTOR","body":"I noticed this CI failure in a full CI run. It seems to be in the test code in the replicator:\r\n\r\n```\r\n[2024-03-15T00:36:32.126Z]   couch_replicator_scheduler_docs_tests:70: scheduler_docs_test_prefixed_db_test_ (t_scheduler_docs_total_rows)...test/eunit/couch_replicator_scheduler_docs_tests.erl:137:<0.27855.0>: Error = <<\"unknown_error\">>\r\n[2024-03-15T00:36:32.126Z] test/eunit/couch_replicator_scheduler_docs_tests.erl:138:<0.27855.0>: binary_to_list ( Reason ) = \"function_clause\"\r\n[2024-03-15T00:36:32.126Z] *failed*\r\n[2024-03-15T00:36:32.126Z] in function erlang:map_get/2\r\n[2024-03-15T00:36:32.126Z]   called as map_get(<<\"docs\">>,\"function_clause\")\r\n[2024-03-15T00:36:32.126Z] in call from couch_replicator_scheduler_docs_tests:t_scheduler_docs_total_rows/1 (test/eunit/couch_replicator_scheduler_docs_tests.erl, line 147)\r\n[2024-03-15T00:36:32.126Z] in call from eunit_test:run_testfun/1 (eunit_test.erl, line 71)\r\n[2024-03-15T00:36:32.126Z] in call from eunit_proc:run_test/1 (eunit_proc.erl, line 531)\r\n[2024-03-15T00:36:32.126Z] in call from eunit_proc:with_timeout/3 (eunit_proc.erl, line 356)\r\n[2024-03-15T00:36:32.126Z] in call from eunit_proc:handle_test/2 (eunit_proc.erl, line 514)\r\n[2024-03-15T00:36:32.126Z] in call from eunit_proc:tests_inorder/3 (eunit_proc.erl, line 456)\r\n[2024-03-15T00:36:32.126Z] in call from eunit_proc:with_timeout/3 (eunit_proc.erl, line 346)\r\n[2024-03-15T00:36:32.126Z] **error:{badmap,\"function_clause\"}\r\n[2024-03-15T00:36:32.126Z]   output:<<\"\">>\r\n```\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1998869603/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1999081208","html_url":"https://github.com/apache/couchdb/pull/4984#issuecomment-1999081208","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4984","id":1999081208,"node_id":"IC_kwDOAAMmUc53J474","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-15T07:27:19Z","updated_at":"2024-03-15T07:27:19Z","author_association":"CONTRIBUTOR","body":"> I noticed this CI failure in a full CI run. It seems to be in the test code in the replicator\r\n\r\nOh, the good old CentOS 8.  I will check on it later.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1999081208/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2000120587","html_url":"https://github.com/apache/couchdb/pull/4984#issuecomment-2000120587","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4984","id":2000120587,"node_id":"IC_kwDOAAMmUc53N2sL","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-15T17:26:20Z","updated_at":"2024-03-15T17:26:20Z","author_association":"CONTRIBUTOR","body":"It might be just exposing a flaky test. I'll re-run the CI and we'll see if we get the same error on the same os/arch combination.\r\n\r\nThe difference from the previous case was that we used to wait longer if we didn't get the expected docs so it could get the error then take longer to possibly fix itself during the 10-15 second wait. Currently however, we exist on first error, but then the rest of the code expects a docs to be there.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2000120587/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2000188374","html_url":"https://github.com/apache/couchdb/pull/4984#issuecomment-2000188374","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4984","id":2000188374,"node_id":"IC_kwDOAAMmUc53OHPW","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-15T18:09:35Z","updated_at":"2024-03-15T18:09:35Z","author_association":"CONTRIBUTOR","body":"I was trying to reproduce this locally (with the CouchDB CI CentOS 8 container) but I could not.  Hence it seems to be a flaky case.  But I think there is an error in the code that tries to provide debug information: it is not prepared for one (or more) of possible outcomes and it breaks when it happens.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2000188374/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2000291881","html_url":"https://github.com/apache/couchdb/pull/4984#issuecomment-2000291881","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4984","id":2000291881,"node_id":"IC_kwDOAAMmUc53Oggp","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-15T19:10:56Z","updated_at":"2024-03-15T19:10:56Z","author_association":"CONTRIBUTOR","body":"Indeed it seems to be a flaky test. After re-running the CI I got the same failure on ubuntu 22.04 https://ci-couchdb.apache.org/blue/organizations/jenkins/jenkins-cm1%2FFullPlatformMatrix/detail/main/1042/pipeline/233\r\n\r\nI wonder if it's worth reverting the behavior to let it keep retrying until it's getting an actual doc, or did it always timeout and and crash when testing the PR even with the current time.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2000291881/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2000309622","html_url":"https://github.com/apache/couchdb/pull/4984#issuecomment-2000309622","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4984","id":2000309622,"node_id":"IC_kwDOAAMmUc53Ok12","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-15T19:20:06Z","updated_at":"2024-03-15T19:20:06Z","author_association":"CONTRIBUTOR","body":"I am now trying to add more debugging around this `unknown_error` to see if it can reveal a scenario when the function actually crashes.  Therefore we could ideally fix the root cause.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2000309622/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2000313812","html_url":"https://github.com/apache/couchdb/pull/4984#issuecomment-2000313812","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4984","id":2000313812,"node_id":"IC_kwDOAAMmUc53Ol3U","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-15T19:23:17Z","updated_at":"2024-03-15T19:23:17Z","author_association":"CONTRIBUTOR","body":"Based on its shape there is a chance it's coming from a remote worker node, so it's an error that serialized and sent back as a string.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2000313812/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2000319496","html_url":"https://github.com/apache/couchdb/pull/4984#issuecomment-2000319496","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4984","id":2000319496,"node_id":"IC_kwDOAAMmUc53OnQI","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-15T19:27:32Z","updated_at":"2024-03-15T19:27:32Z","author_association":"CONTRIBUTOR","body":"Opened #5006 for investigation.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2000319496/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2001885813","html_url":"https://github.com/apache/couchdb/pull/5007#issuecomment-2001885813","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5007","id":2001885813,"node_id":"IC_kwDOAAMmUc53Ulp1","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-16T07:14:25Z","updated_at":"2024-03-16T07:14:25Z","author_association":"CONTRIBUTOR","body":"I think I found the reason for the error. This should fix it: https://github.com/apache/couchdb/pull/5008","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2001885813/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2002421740","html_url":"https://github.com/apache/couchdb/issues/4213#issuecomment-2002421740","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4213","id":2002421740,"node_id":"IC_kwDOAAMmUc53Wofs","user":{"login":"trajche","id":2382019,"node_id":"MDQ6VXNlcjIzODIwMTk=","avatar_url":"https://avatars.githubusercontent.com/u/2382019?v=4","gravatar_id":"","url":"https://api.github.com/users/trajche","html_url":"https://github.com/trajche","followers_url":"https://api.github.com/users/trajche/followers","following_url":"https://api.github.com/users/trajche/following{/other_user}","gists_url":"https://api.github.com/users/trajche/gists{/gist_id}","starred_url":"https://api.github.com/users/trajche/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/trajche/subscriptions","organizations_url":"https://api.github.com/users/trajche/orgs","repos_url":"https://api.github.com/users/trajche/repos","events_url":"https://api.github.com/users/trajche/events{/privacy}","received_events_url":"https://api.github.com/users/trajche/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-17T11:35:33Z","updated_at":"2024-03-17T11:35:33Z","author_association":"NONE","body":"We wrote a script that scrapes docs and converts it to OpenAPI 3.x:\r\nhttps://github.com/digitalnodecom/couchdb-swagger\r\n\r\nYou have the [couchdb.json ](https://github.com/digitalnodecom/couchdb-swagger/blob/master/couchdb.json) file if you don't want to run the script yourself.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2002421740/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2002600417","html_url":"https://github.com/apache/couchdb/pull/5007#issuecomment-2002600417","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5007","id":2002600417,"node_id":"IC_kwDOAAMmUc53XUHh","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-17T20:04:35Z","updated_at":"2024-03-17T20:04:35Z","author_association":"CONTRIBUTOR","body":"Thanks @big-r81 nevertheless.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2002600417/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2002600838","html_url":"https://github.com/apache/couchdb/pull/5007#issuecomment-2002600838","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5007","id":2002600838,"node_id":"IC_kwDOAAMmUc53XUOG","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-17T20:05:37Z","updated_at":"2024-03-17T20:05:48Z","author_association":"CONTRIBUTOR","body":"Closing this in favor of #5007.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2002600838/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2002601325","html_url":"https://github.com/apache/couchdb/pull/5006#issuecomment-2002601325","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5006","id":2002601325,"node_id":"IC_kwDOAAMmUc53XUVt","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-17T20:07:12Z","updated_at":"2024-03-17T20:07:12Z","author_association":"CONTRIBUTOR","body":"The goal of this PR was achieved, closing it.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2002601325/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2015274977","html_url":"https://github.com/apache/couchdb/issues/5009#issuecomment-2015274977","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5009","id":2015274977,"node_id":"IC_kwDOAAMmUc54Hqfh","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-22T14:53:16Z","updated_at":"2024-03-22T14:53:16Z","author_association":"CONTRIBUTOR","body":"Thank you for your report. Yeah that looks like a bug we should fix.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2015274977/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2015336119","html_url":"https://github.com/apache/couchdb/issues/4489#issuecomment-2015336119","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4489","id":2015336119,"node_id":"IC_kwDOAAMmUc54H5a3","user":{"login":"jmta","id":20024040,"node_id":"MDQ6VXNlcjIwMDI0MDQw","avatar_url":"https://avatars.githubusercontent.com/u/20024040?v=4","gravatar_id":"","url":"https://api.github.com/users/jmta","html_url":"https://github.com/jmta","followers_url":"https://api.github.com/users/jmta/followers","following_url":"https://api.github.com/users/jmta/following{/other_user}","gists_url":"https://api.github.com/users/jmta/gists{/gist_id}","starred_url":"https://api.github.com/users/jmta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jmta/subscriptions","organizations_url":"https://api.github.com/users/jmta/orgs","repos_url":"https://api.github.com/users/jmta/repos","events_url":"https://api.github.com/users/jmta/events{/privacy}","received_events_url":"https://api.github.com/users/jmta/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-22T15:23:36Z","updated_at":"2024-03-22T15:23:36Z","author_association":"NONE","body":"Hi,\r\nThis issue appears to have returned, can I expect this JFrog instance to be back up soon?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2015336119/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2015356629","html_url":"https://github.com/apache/couchdb/issues/5011#issuecomment-2015356629","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5011","id":2015356629,"node_id":"IC_kwDOAAMmUc54H-bV","user":{"login":"cgerardin","id":76680083,"node_id":"MDQ6VXNlcjc2NjgwMDgz","avatar_url":"https://avatars.githubusercontent.com/u/76680083?v=4","gravatar_id":"","url":"https://api.github.com/users/cgerardin","html_url":"https://github.com/cgerardin","followers_url":"https://api.github.com/users/cgerardin/followers","following_url":"https://api.github.com/users/cgerardin/following{/other_user}","gists_url":"https://api.github.com/users/cgerardin/gists{/gist_id}","starred_url":"https://api.github.com/users/cgerardin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cgerardin/subscriptions","organizations_url":"https://api.github.com/users/cgerardin/orgs","repos_url":"https://api.github.com/users/cgerardin/repos","events_url":"https://api.github.com/users/cgerardin/events{/privacy}","received_events_url":"https://api.github.com/users/cgerardin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-22T15:34:49Z","updated_at":"2024-03-22T15:34:49Z","author_association":"NONE","body":"![image](https://github.com/apache/couchdb/assets/76680083/b40dcbc6-1120-4fe7-bfb8-1bd305375d52)\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2015356629/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2015359803","html_url":"https://github.com/apache/couchdb/issues/5011#issuecomment-2015359803","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5011","id":2015359803,"node_id":"IC_kwDOAAMmUc54H_M7","user":{"login":"cgerardin","id":76680083,"node_id":"MDQ6VXNlcjc2NjgwMDgz","avatar_url":"https://avatars.githubusercontent.com/u/76680083?v=4","gravatar_id":"","url":"https://api.github.com/users/cgerardin","html_url":"https://github.com/cgerardin","followers_url":"https://api.github.com/users/cgerardin/followers","following_url":"https://api.github.com/users/cgerardin/following{/other_user}","gists_url":"https://api.github.com/users/cgerardin/gists{/gist_id}","starred_url":"https://api.github.com/users/cgerardin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cgerardin/subscriptions","organizations_url":"https://api.github.com/users/cgerardin/orgs","repos_url":"https://api.github.com/users/cgerardin/repos","events_url":"https://api.github.com/users/cgerardin/events{/privacy}","received_events_url":"https://api.github.com/users/cgerardin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-22T15:36:34Z","updated_at":"2024-03-22T15:36:34Z","author_association":"NONE","body":"Duplicate of #5010","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2015359803/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2015373107","html_url":"https://github.com/apache/couchdb/issues/5010#issuecomment-2015373107","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5010","id":2015373107,"node_id":"IC_kwDOAAMmUc54ICcz","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-22T15:43:57Z","updated_at":"2024-03-22T15:43:57Z","author_association":"CONTRIBUTOR","body":"Thanks for your report. ASF infra is aware and are trying to restore the service.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2015373107/reactions","total_count":5,"+1":5,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2015379747","html_url":"https://github.com/apache/couchdb/issues/4489#issuecomment-2015379747","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4489","id":2015379747,"node_id":"IC_kwDOAAMmUc54IEEj","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-22T15:47:34Z","updated_at":"2024-03-22T15:47:34Z","author_association":"CONTRIBUTOR","body":"I would say, it's only temporary. I add a comment to the existing INFRA ticket.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2015379747/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2015429130","html_url":"https://github.com/apache/couchdb/issues/3966#issuecomment-2015429130","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3966","id":2015429130,"node_id":"IC_kwDOAAMmUc54IQIK","user":{"login":"zamb3zi","id":11073466,"node_id":"MDQ6VXNlcjExMDczNDY2","avatar_url":"https://avatars.githubusercontent.com/u/11073466?v=4","gravatar_id":"","url":"https://api.github.com/users/zamb3zi","html_url":"https://github.com/zamb3zi","followers_url":"https://api.github.com/users/zamb3zi/followers","following_url":"https://api.github.com/users/zamb3zi/following{/other_user}","gists_url":"https://api.github.com/users/zamb3zi/gists{/gist_id}","starred_url":"https://api.github.com/users/zamb3zi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zamb3zi/subscriptions","organizations_url":"https://api.github.com/users/zamb3zi/orgs","repos_url":"https://api.github.com/users/zamb3zi/repos","events_url":"https://api.github.com/users/zamb3zi/events{/privacy}","received_events_url":"https://api.github.com/users/zamb3zi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-22T16:11:25Z","updated_at":"2024-03-22T16:11:25Z","author_association":"NONE","body":"A similar issue has started happening today:\r\n```apt update\r\nGet:1 http://security.debian.org/debian-security buster/updates InRelease [34.8 kB]\r\nHit:2 http://deb.debian.org/debian buster InRelease\r\nGet:3 http://security.debian.org/debian-security buster/updates/contrib Sources [1,084 B]\r\nGet:5 http://security.debian.org/debian-security buster/updates/main Sources [373 kB]\r\nGet:6 http://security.debian.org/debian-security buster/updates/main amd64 Packages [589 kB]\r\nGet:7 http://security.debian.org/debian-security buster/updates/main Translation-en [319 kB]\r\nGet:8 http://security.debian.org/debian-security buster/updates/contrib amd64 Packages [3,460 B]\r\nGet:9 http://security.debian.org/debian-security buster/updates/contrib Translation-en [1,488 B]\r\nGet:4 https://apache.jfrog.io/artifactory/couchdb-deb buster InRelease [11.5 kB]\r\nErr:4 https://apache.jfrog.io/artifactory/couchdb-deb buster InRelease\r\n  Clearsigned file isn't valid, got 'NOSPLIT' (does the network require authentication?)\r\nReading package lists... Done\r\nE: Failed to fetch https://apache.jfrog.io/artifactory/couchdb-deb/dists/buster/InRelease  Clearsigned file isn't valid, got 'NOSPLIT' (does the network require authentication?)\r\nE: The repository 'https://apache.jfrog.io/artifactory/couchdb-deb buster InRelease' is no longer signed.\r\nN: Updating from such a repository can't be done securely, and is therefore disabled by default.\r\nN: See apt-secure(8) manpage for repository creation and user configuration details.\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2015429130/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2015435417","html_url":"https://github.com/apache/couchdb/issues/3966#issuecomment-2015435417","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3966","id":2015435417,"node_id":"IC_kwDOAAMmUc54IRqZ","user":{"login":"zamb3zi","id":11073466,"node_id":"MDQ6VXNlcjExMDczNDY2","avatar_url":"https://avatars.githubusercontent.com/u/11073466?v=4","gravatar_id":"","url":"https://api.github.com/users/zamb3zi","html_url":"https://github.com/zamb3zi","followers_url":"https://api.github.com/users/zamb3zi/followers","following_url":"https://api.github.com/users/zamb3zi/following{/other_user}","gists_url":"https://api.github.com/users/zamb3zi/gists{/gist_id}","starred_url":"https://api.github.com/users/zamb3zi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zamb3zi/subscriptions","organizations_url":"https://api.github.com/users/zamb3zi/orgs","repos_url":"https://api.github.com/users/zamb3zi/repos","events_url":"https://api.github.com/users/zamb3zi/events{/privacy}","received_events_url":"https://api.github.com/users/zamb3zi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-22T16:14:55Z","updated_at":"2024-03-22T16:14:55Z","author_association":"NONE","body":"Note: this exactly 2 years to the day to the original issue. Certificate expiry?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2015435417/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2015437522","html_url":"https://github.com/apache/couchdb/issues/3966#issuecomment-2015437522","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3966","id":2015437522,"node_id":"IC_kwDOAAMmUc54ISLS","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-22T16:16:10Z","updated_at":"2024-03-22T16:16:10Z","author_association":"CONTRIBUTOR","body":"Thank you for the report. We are aware of the problem. The ASF Infra team is already working on it, unfortunately there is nothing we can do from our side.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2015437522/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2017333360","html_url":"https://github.com/apache/couchdb/issues/3966#issuecomment-2017333360","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3966","id":2017333360,"node_id":"IC_kwDOAAMmUc54PhBw","user":{"login":"maiya22","id":164848636,"node_id":"U_kgDOCdNj_A","avatar_url":"https://avatars.githubusercontent.com/u/164848636?v=4","gravatar_id":"","url":"https://api.github.com/users/maiya22","html_url":"https://github.com/maiya22","followers_url":"https://api.github.com/users/maiya22/followers","following_url":"https://api.github.com/users/maiya22/following{/other_user}","gists_url":"https://api.github.com/users/maiya22/gists{/gist_id}","starred_url":"https://api.github.com/users/maiya22/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maiya22/subscriptions","organizations_url":"https://api.github.com/users/maiya22/orgs","repos_url":"https://api.github.com/users/maiya22/repos","events_url":"https://api.github.com/users/maiya22/events{/privacy}","received_events_url":"https://api.github.com/users/maiya22/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-25T06:47:53Z","updated_at":"2024-03-25T06:47:53Z","author_association":"NONE","body":"i am facing this issue couchdb is failing due to below error\r\n\r\netrieving key from https://couchdb.apache.org/repo/keys.asc\r\nImporting GPG key 0x7A00258D:\r\n Userid     : \"The Apache Software Foundation (Package repository signing key) <root@apache.org>\"\r\n Fingerprint: 390e f70b b1ea 12b2 7739 6295 0ee6 2fb3 7a00 258d\r\n From       : https://couchdb.apache.org/repo/keys.asc\r\nIs this ok [y/N]: y\r\nRetrieving key from https://couchdb.apache.org/repo/rpm-package-key.asc\r\ncouchdb/7/x86_64/signature                                                                                                                                             |  11 kB  00:00:03\r\nhttps://apache.jfrog.io/artifactory/couchdb-rpm/el7/x86_64/repodata/repomd.xml: [Errno -1] repomd.xml signature could not be verified for couchdb\r\nTrying other mirror.\r\n\r\n\r\n One of the configured repositories failed (couchdb),\r\n and yum doesn't have enough cached data to continue. At this point the only\r\n safe thing yum can do is fail. There are a few ways to work \"fix\" this:\r\n\r\n     1. Contact the upstream for the repository and get them to fix the problem.\r\n\r\n     2. Reconfigure the baseurl/etc. for the repository, to point to a working\r\n        upstream. This is most often useful if you are using a newer\r\n        distribution release than is supported by the repository (and the\r\n        packages for the previous distribution release still work).\r\n\r\n     3. Run the command with the repository temporarily disabled\r\n            yum --disablerepo=couchdb ...\r\n\r\n     4. Disable the repository permanently, so yum won't use it by default. Yum\r\n        will then just ignore the repository until you permanently enable it\r\n        again or use --enablerepo for temporary usage:\r\n\r\n            yum-config-manager --disable couchdb\r\n        or\r\n            subscription-manager repos --disable=couchdb\r\n\r\n     5. Configure the failing repository to be skipped, if it is unavailable.\r\n        Note that yum will try to contact the repo. when it runs most commands,\r\n        so will have to try and fail each time (and thus. yum will be be much\r\n        slower). If it is a very temporary problem though, this is often a nice\r\n        compromise:\r\n\r\n            yum-config-manager --save --setopt=couchdb.skip_if_unavailable=true\r\n\r\nfailure: repodata/repomd.xml from couchdb: [Errno 256] No more mirrors to try.\r\nhttps://apache.jfrog.io/artifactory/couchdb-rpm/el7/x86_64/repodata/repomd.xml: [Errno -1] repomd.xml signature could not be verified for couchdb\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2017333360/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2017449263","html_url":"https://github.com/apache/couchdb/issues/5002#issuecomment-2017449263","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5002","id":2017449263,"node_id":"IC_kwDOAAMmUc54P9Uv","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-25T08:22:08Z","updated_at":"2024-03-25T08:22:08Z","author_association":"MEMBER","body":"Nouveau will be marked EXPERIMENTAL in couchdb 3.4.0 as we gather feedback from the community. \r\n\r\nI certainly expect fault-tolerance from Nouveau so will look into your finding this week.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2017449263/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2017451527","html_url":"https://github.com/apache/couchdb/issues/4489#issuecomment-2017451527","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4489","id":2017451527,"node_id":"IC_kwDOAAMmUc54P94H","user":{"login":"Nithe14","id":54063054,"node_id":"MDQ6VXNlcjU0MDYzMDU0","avatar_url":"https://avatars.githubusercontent.com/u/54063054?v=4","gravatar_id":"","url":"https://api.github.com/users/Nithe14","html_url":"https://github.com/Nithe14","followers_url":"https://api.github.com/users/Nithe14/followers","following_url":"https://api.github.com/users/Nithe14/following{/other_user}","gists_url":"https://api.github.com/users/Nithe14/gists{/gist_id}","starred_url":"https://api.github.com/users/Nithe14/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Nithe14/subscriptions","organizations_url":"https://api.github.com/users/Nithe14/orgs","repos_url":"https://api.github.com/users/Nithe14/repos","events_url":"https://api.github.com/users/Nithe14/events{/privacy}","received_events_url":"https://api.github.com/users/Nithe14/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-25T08:23:44Z","updated_at":"2024-03-25T08:23:44Z","author_association":"NONE","body":"Now it redirects to landing.jfrog.com and consistently returns an HTTP 409 error. At least for the RPM repo.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2017451527/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2017496690","html_url":"https://github.com/apache/couchdb/issues/5002#issuecomment-2017496690","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5002","id":2017496690,"node_id":"IC_kwDOAAMmUc54QI5y","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-25T08:53:39Z","updated_at":"2024-03-25T08:53:39Z","author_association":"MEMBER","body":"as an aside, we strongly recommend that couchdb clusters do not span locations (offices in your case). the nodes of any given cluster should be very close together (<1ms ping time). For your use case we'd recommend a cluster per office and use of the http replication facility to sync data between offices.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2017496690/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2017498815","html_url":"https://github.com/apache/couchdb/issues/5002#issuecomment-2017498815","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5002","id":2017498815,"node_id":"IC_kwDOAAMmUc54QJa_","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-25T08:54:59Z","updated_at":"2024-03-25T08:54:59Z","author_association":"MEMBER","body":"further aside, you don't have to have a nouveau node for each couchdb node, you can safely point multiple couchdb nodes at the same nouveau node. whether this is better or worse for you will depend on what you're doing and the performance specs of the server(s) nouveau is running on. one-to-one is a sensible place to start, though.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2017498815/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2017534078","html_url":"https://github.com/apache/couchdb/issues/5002#issuecomment-2017534078","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5002","id":2017534078,"node_id":"IC_kwDOAAMmUc54QSB-","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-25T09:15:44Z","updated_at":"2024-03-25T09:15:44Z","author_association":"MEMBER","body":"I figured it out and have posted a PR to fix the fault tolerance.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2017534078/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2017566656","html_url":"https://github.com/apache/couchdb/issues/4489#issuecomment-2017566656","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4489","id":2017566656,"node_id":"IC_kwDOAAMmUc54QZ_A","user":{"login":"vectorselector","id":4980940,"node_id":"MDQ6VXNlcjQ5ODA5NDA=","avatar_url":"https://avatars.githubusercontent.com/u/4980940?v=4","gravatar_id":"","url":"https://api.github.com/users/vectorselector","html_url":"https://github.com/vectorselector","followers_url":"https://api.github.com/users/vectorselector/followers","following_url":"https://api.github.com/users/vectorselector/following{/other_user}","gists_url":"https://api.github.com/users/vectorselector/gists{/gist_id}","starred_url":"https://api.github.com/users/vectorselector/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vectorselector/subscriptions","organizations_url":"https://api.github.com/users/vectorselector/orgs","repos_url":"https://api.github.com/users/vectorselector/repos","events_url":"https://api.github.com/users/vectorselector/events{/privacy}","received_events_url":"https://api.github.com/users/vectorselector/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-25T09:28:57Z","updated_at":"2024-03-25T09:28:57Z","author_association":"NONE","body":"this issue should not be closed while the infrastructural single-point-of-failure exists, which was never addressed.\r\nthis breaks apt for production systems","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2017566656/reactions","total_count":4,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":4,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2017735278","html_url":"https://github.com/apache/couchdb/issues/5016#issuecomment-2017735278","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5016","id":2017735278,"node_id":"IC_kwDOAAMmUc54RDJu","user":{"login":"CSLTech","id":2613776,"node_id":"MDQ6VXNlcjI2MTM3NzY=","avatar_url":"https://avatars.githubusercontent.com/u/2613776?v=4","gravatar_id":"","url":"https://api.github.com/users/CSLTech","html_url":"https://github.com/CSLTech","followers_url":"https://api.github.com/users/CSLTech/followers","following_url":"https://api.github.com/users/CSLTech/following{/other_user}","gists_url":"https://api.github.com/users/CSLTech/gists{/gist_id}","starred_url":"https://api.github.com/users/CSLTech/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CSLTech/subscriptions","organizations_url":"https://api.github.com/users/CSLTech/orgs","repos_url":"https://api.github.com/users/CSLTech/repos","events_url":"https://api.github.com/users/CSLTech/events{/privacy}","received_events_url":"https://api.github.com/users/CSLTech/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-25T11:00:53Z","updated_at":"2024-03-25T11:00:53Z","author_association":"NONE","body":"See https://github.com/apache/couchdb/issues/5010 . All the apache jfrog repositories are down since friday.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2017735278/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2017894768","html_url":"https://github.com/apache/couchdb/issues/5002#issuecomment-2017894768","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5002","id":2017894768,"node_id":"IC_kwDOAAMmUc54RqFw","user":{"login":"jonasplaum","id":9090041,"node_id":"MDQ6VXNlcjkwOTAwNDE=","avatar_url":"https://avatars.githubusercontent.com/u/9090041?v=4","gravatar_id":"","url":"https://api.github.com/users/jonasplaum","html_url":"https://github.com/jonasplaum","followers_url":"https://api.github.com/users/jonasplaum/followers","following_url":"https://api.github.com/users/jonasplaum/following{/other_user}","gists_url":"https://api.github.com/users/jonasplaum/gists{/gist_id}","starred_url":"https://api.github.com/users/jonasplaum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jonasplaum/subscriptions","organizations_url":"https://api.github.com/users/jonasplaum/orgs","repos_url":"https://api.github.com/users/jonasplaum/repos","events_url":"https://api.github.com/users/jonasplaum/events{/privacy}","received_events_url":"https://api.github.com/users/jonasplaum/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-25T12:29:13Z","updated_at":"2024-03-25T12:55:02Z","author_association":"CONTRIBUTOR","body":"Thanks for the fast fix. I will test this later.\r\n\r\n> as an aside, we strongly recommend that couchdb clusters do not span locations\r\n\r\nI thought that with the following configuration there would be no problem to use a cluster instead of replication:\r\n``` yaml\r\n[cluster]\r\nq=1\r\nn=3\r\nw=1\r\nr=1\r\n```\r\nBut if thats not supported, we need to switch to replication. In this case we need to replicate database deletes in the application layer, right?\r\n> you don't have to have a nouveau node for each couchdb node\r\n\r\nWe do this, because we need every location working independent if there is a network failure between them.\r\n\r\nI still have some  questions about how i should setup couchdb for our usecase. Where should i ask this questions? This issue is not the right place. Should i use an other issue or the mailing list?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2017894768/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2018012751","html_url":"https://github.com/apache/couchdb/issues/5002#issuecomment-2018012751","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5002","id":2018012751,"node_id":"IC_kwDOAAMmUc54SG5P","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-25T13:29:47Z","updated_at":"2024-03-25T13:29:47Z","author_association":"MEMBER","body":"our slack is the best place for this kind of chat (couchdb.slack.com).\r\n\r\na couple of notes;\r\n\r\n1) the 'r' and 'w' fields under cluster do nothing, they are no longer used by the code (for several years now)\r\n2) erlang clusters (and therefore also couchdb clusters) need low latency between them, and reliable networking too. if these conditions aren't met we recommend separate clusters that use replication to push data around, as our replication system is tolerant of high latency and unreliable networking.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2018012751/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2018014335","html_url":"https://github.com/apache/couchdb/issues/5002#issuecomment-2018014335","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5002","id":2018014335,"node_id":"IC_kwDOAAMmUc54SHR_","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-25T13:30:38Z","updated_at":"2024-03-25T13:30:38Z","author_association":"MEMBER","body":"oh, and 3) yes, you would need to delete databases within each cluster separately, as db deletion is not propagated by replication.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2018014335/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2018593219","html_url":"https://github.com/apache/couchdb/issues/4489#issuecomment-2018593219","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4489","id":2018593219,"node_id":"IC_kwDOAAMmUc54UUnD","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-25T18:01:46Z","updated_at":"2024-03-25T18:01:46Z","author_association":"MEMBER","body":"if jfrog's uptime is insufficient for you (I think this incident is unlikely to occur again, fwiw) you can make your own mirror of our debian repository easily enough and pull through that instead. In some environments having an in-house mirror is a requirement.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2018593219/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2018666638","html_url":"https://github.com/apache/couchdb/issues/4213#issuecomment-2018666638","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4213","id":2018666638,"node_id":"IC_kwDOAAMmUc54UmiO","user":{"login":"RafaelFigueiredo","id":7611174,"node_id":"MDQ6VXNlcjc2MTExNzQ=","avatar_url":"https://avatars.githubusercontent.com/u/7611174?v=4","gravatar_id":"","url":"https://api.github.com/users/RafaelFigueiredo","html_url":"https://github.com/RafaelFigueiredo","followers_url":"https://api.github.com/users/RafaelFigueiredo/followers","following_url":"https://api.github.com/users/RafaelFigueiredo/following{/other_user}","gists_url":"https://api.github.com/users/RafaelFigueiredo/gists{/gist_id}","starred_url":"https://api.github.com/users/RafaelFigueiredo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RafaelFigueiredo/subscriptions","organizations_url":"https://api.github.com/users/RafaelFigueiredo/orgs","repos_url":"https://api.github.com/users/RafaelFigueiredo/repos","events_url":"https://api.github.com/users/RafaelFigueiredo/events{/privacy}","received_events_url":"https://api.github.com/users/RafaelFigueiredo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-25T18:41:41Z","updated_at":"2024-03-25T18:42:05Z","author_association":"NONE","body":"> There is a Postman collection here: https://www.postman.com/galactic-comet-36406/workspace/couchdb/collection/15985155-f511300e-848e-4ab2-a0a2-da13cb2e1065\r\n\r\n@dragos-constantin-stoica, this collection is the one I created.\r\n\r\n@trajche nice working on the generator.\r\n\r\nI was thinking of something like this https://hexdocs.pm/open_api_spex/3.4.0/readme.html, but I don't see direct support for Erlang.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2018666638/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null}]