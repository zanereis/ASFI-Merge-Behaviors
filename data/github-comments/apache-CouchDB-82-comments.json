[{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/575255673","html_url":"https://github.com/apache/couchdb/issues/2437#issuecomment-575255673","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2437","id":575255673,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NTI1NTY3Mw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-16T17:20:24Z","updated_at":"2020-01-16T17:20:24Z","author_association":"MEMBER","body":"Another failed build with this situation:\r\n\r\nhttps://ci-couchdb.apache.org/blue/organizations/jenkins/jenkins-cm1%2FFullPlatformMatrix/detail/jenkins-185-arm64/5/pipeline","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/575255673/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/575263817","html_url":"https://github.com/apache/couchdb/issues/2437#issuecomment-575263817","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2437","id":575263817,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NTI2MzgxNw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-16T17:39:23Z","updated_at":"2020-01-16T17:39:23Z","author_association":"MEMBER","body":"And:\r\n\r\nhttps://ci-couchdb.apache.org/blue/organizations/jenkins/jenkins-cm1%2FFullPlatformMatrix/detail/jenkins-185-arm64/6/pipeline\r\n\r\nNotably this time it's on x86_64.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/575263817/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/575287193","html_url":"https://github.com/apache/couchdb/pull/2410#issuecomment-575287193","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2410","id":575287193,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NTI4NzE5Mw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-16T18:39:10Z","updated_at":"2020-01-16T18:39:10Z","author_association":"MEMBER","body":"Looks nice. If you want this in 3.0, now's the time to merge it.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/575287193/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/575334199","html_url":"https://github.com/apache/couchdb/pull/2361#issuecomment-575334199","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2361","id":575334199,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NTMzNDE5OQ==","user":{"login":"jaydoane","id":51209,"node_id":"MDQ6VXNlcjUxMjA5","avatar_url":"https://avatars.githubusercontent.com/u/51209?v=4","gravatar_id":"","url":"https://api.github.com/users/jaydoane","html_url":"https://github.com/jaydoane","followers_url":"https://api.github.com/users/jaydoane/followers","following_url":"https://api.github.com/users/jaydoane/following{/other_user}","gists_url":"https://api.github.com/users/jaydoane/gists{/gist_id}","starred_url":"https://api.github.com/users/jaydoane/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaydoane/subscriptions","organizations_url":"https://api.github.com/users/jaydoane/orgs","repos_url":"https://api.github.com/users/jaydoane/repos","events_url":"https://api.github.com/users/jaydoane/events{/privacy}","received_events_url":"https://api.github.com/users/jaydoane/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-16T20:34:05Z","updated_at":"2020-01-16T20:34:05Z","author_association":"CONTRIBUTOR","body":"CouchDB emits time in ISO8601 format in several places, but I was unable to find anywhere in the code base which reads that format. For parsing ISO8601 strings with Erlang, [this library](https://github.com/erlsci/iso8601) looks like the most well-maintained of the many options coming up in a search. It uses an MIT license, so we could include it as yet another dependency. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/575334199/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/575450537","html_url":"https://github.com/apache/couchdb/pull/2465#issuecomment-575450537","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2465","id":575450537,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NTQ1MDUzNw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-17T03:38:40Z","updated_at":"2020-01-17T03:38:40Z","author_association":"MEMBER","body":"???","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/575450537/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/575460452","html_url":"https://github.com/apache/couchdb/pull/2465#issuecomment-575460452","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2465","id":575460452,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NTQ2MDQ1Mg==","user":{"login":"jiangphcn","id":18000622,"node_id":"MDQ6VXNlcjE4MDAwNjIy","avatar_url":"https://avatars.githubusercontent.com/u/18000622?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangphcn","html_url":"https://github.com/jiangphcn","followers_url":"https://api.github.com/users/jiangphcn/followers","following_url":"https://api.github.com/users/jiangphcn/following{/other_user}","gists_url":"https://api.github.com/users/jiangphcn/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangphcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangphcn/subscriptions","organizations_url":"https://api.github.com/users/jiangphcn/orgs","repos_url":"https://api.github.com/users/jiangphcn/repos","events_url":"https://api.github.com/users/jiangphcn/events{/privacy}","received_events_url":"https://api.github.com/users/jiangphcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-17T04:34:33Z","updated_at":"2020-01-17T04:34:33Z","author_association":"CONTRIBUTOR","body":"hi @wohali I am in charge of building Cloudant Release Candidate and need to cherry-pick some commits from apache/couchdb. This PR should open against https://github.com/cloudant/couchdb. So I close this PR instead. Such PR in cloudant/couchdb will not be merged to apache/couchdb.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/575460452/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/575717231","html_url":"https://github.com/apache/couchdb/pull/1944#issuecomment-575717231","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1944","id":575717231,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NTcxNzIzMQ==","user":{"login":"iilyak","id":9804420,"node_id":"MDQ6VXNlcjk4MDQ0MjA=","avatar_url":"https://avatars.githubusercontent.com/u/9804420?v=4","gravatar_id":"","url":"https://api.github.com/users/iilyak","html_url":"https://github.com/iilyak","followers_url":"https://api.github.com/users/iilyak/followers","following_url":"https://api.github.com/users/iilyak/following{/other_user}","gists_url":"https://api.github.com/users/iilyak/gists{/gist_id}","starred_url":"https://api.github.com/users/iilyak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/iilyak/subscriptions","organizations_url":"https://api.github.com/users/iilyak/orgs","repos_url":"https://api.github.com/users/iilyak/repos","events_url":"https://api.github.com/users/iilyak/events{/privacy}","received_events_url":"https://api.github.com/users/iilyak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-17T17:18:57Z","updated_at":"2020-01-17T17:18:57Z","author_association":"CONTRIBUTOR","body":"@wohali I know you are busy with 3.0. Should I rebase against latest master or wait couple months (the release process is exhausting I am sure)?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/575717231/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/575717911","html_url":"https://github.com/apache/couchdb/pull/1944#issuecomment-575717911","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1944","id":575717911,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NTcxNzkxMQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-17T17:20:50Z","updated_at":"2020-01-17T17:20:50Z","author_association":"MEMBER","body":"Hey @iilyak , it was @davisp who was initially against this. If you can get his +1, I'd love to see it in 3.0, go ahead and rebase.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/575717911/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/575766636","html_url":"https://github.com/apache/couchdb/issues/2113#issuecomment-575766636","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2113","id":575766636,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NTc2NjYzNg==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-17T19:39:13Z","updated_at":"2020-01-17T19:39:13Z","author_association":"MEMBER","body":"This is done, arm packages are up as of a while back surreptitiously and will be official with 3.0.0. Closing this issue.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/575766636/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/575814496","html_url":"https://github.com/apache/couchdb/pull/2466#issuecomment-575814496","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2466","id":575814496,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NTgxNDQ5Ng==","user":{"login":"tonysun83","id":6991573,"node_id":"MDQ6VXNlcjY5OTE1NzM=","avatar_url":"https://avatars.githubusercontent.com/u/6991573?v=4","gravatar_id":"","url":"https://api.github.com/users/tonysun83","html_url":"https://github.com/tonysun83","followers_url":"https://api.github.com/users/tonysun83/followers","following_url":"https://api.github.com/users/tonysun83/following{/other_user}","gists_url":"https://api.github.com/users/tonysun83/gists{/gist_id}","starred_url":"https://api.github.com/users/tonysun83/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tonysun83/subscriptions","organizations_url":"https://api.github.com/users/tonysun83/orgs","repos_url":"https://api.github.com/users/tonysun83/repos","events_url":"https://api.github.com/users/tonysun83/events{/privacy}","received_events_url":"https://api.github.com/users/tonysun83/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-17T22:08:41Z","updated_at":"2020-01-17T22:08:41Z","author_association":"CONTRIBUTOR","body":"text index tests all passed with no regression. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/575814496/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/575814516","html_url":"https://github.com/apache/couchdb/pull/2466#issuecomment-575814516","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2466","id":575814516,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NTgxNDUxNg==","user":{"login":"tonysun83","id":6991573,"node_id":"MDQ6VXNlcjY5OTE1NzM=","avatar_url":"https://avatars.githubusercontent.com/u/6991573?v=4","gravatar_id":"","url":"https://api.github.com/users/tonysun83","html_url":"https://github.com/tonysun83","followers_url":"https://api.github.com/users/tonysun83/followers","following_url":"https://api.github.com/users/tonysun83/following{/other_user}","gists_url":"https://api.github.com/users/tonysun83/gists{/gist_id}","starred_url":"https://api.github.com/users/tonysun83/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tonysun83/subscriptions","organizations_url":"https://api.github.com/users/tonysun83/orgs","repos_url":"https://api.github.com/users/tonysun83/repos","events_url":"https://api.github.com/users/tonysun83/events{/privacy}","received_events_url":"https://api.github.com/users/tonysun83/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-17T22:08:46Z","updated_at":"2020-01-17T22:08:46Z","author_association":"CONTRIBUTOR","body":"+1","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/575814516/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/575828735","html_url":"https://github.com/apache/couchdb/pull/2468#issuecomment-575828735","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2468","id":575828735,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NTgyODczNQ==","user":{"login":"kxepal","id":785983,"node_id":"MDQ6VXNlcjc4NTk4Mw==","avatar_url":"https://avatars.githubusercontent.com/u/785983?v=4","gravatar_id":"","url":"https://api.github.com/users/kxepal","html_url":"https://github.com/kxepal","followers_url":"https://api.github.com/users/kxepal/followers","following_url":"https://api.github.com/users/kxepal/following{/other_user}","gists_url":"https://api.github.com/users/kxepal/gists{/gist_id}","starred_url":"https://api.github.com/users/kxepal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kxepal/subscriptions","organizations_url":"https://api.github.com/users/kxepal/orgs","repos_url":"https://api.github.com/users/kxepal/repos","events_url":"https://api.github.com/users/kxepal/events{/privacy}","received_events_url":"https://api.github.com/users/kxepal/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-17T23:05:38Z","updated_at":"2020-01-17T23:05:38Z","author_association":"MEMBER","body":"Shouldn't beam process be killed by stage shutdown? Looks like we're doing Jenkins job here for him - timeout configure should kill the process correctly. At least that's what I observe in own environment.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/575828735/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/575833181","html_url":"https://github.com/apache/couchdb/pull/2468#issuecomment-575833181","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2468","id":575833181,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NTgzMzE4MQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-17T23:25:51Z","updated_at":"2020-01-17T23:25:51Z","author_association":"MEMBER","body":"It's not working, when the build fails beam.smp processes are being left behind. We're not seeing this on other platforms because we run inside Docker and Jenkins reaps the container, but we're seeing it on workstations, such as @nickva 's. It just seems to be 100% repeatable whenever Jenkins runs on FreeBSD now.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/575833181/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/575834970","html_url":"https://github.com/apache/couchdb/pull/2468#issuecomment-575834970","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2468","id":575834970,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NTgzNDk3MA==","user":{"login":"kxepal","id":785983,"node_id":"MDQ6VXNlcjc4NTk4Mw==","avatar_url":"https://avatars.githubusercontent.com/u/785983?v=4","gravatar_id":"","url":"https://api.github.com/users/kxepal","html_url":"https://github.com/kxepal","followers_url":"https://api.github.com/users/kxepal/followers","following_url":"https://api.github.com/users/kxepal/following{/other_user}","gists_url":"https://api.github.com/users/kxepal/gists{/gist_id}","starred_url":"https://api.github.com/users/kxepal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kxepal/subscriptions","organizations_url":"https://api.github.com/users/kxepal/orgs","repos_url":"https://api.github.com/users/kxepal/repos","events_url":"https://api.github.com/users/kxepal/events{/privacy}","received_events_url":"https://api.github.com/users/kxepal/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-17T23:34:34Z","updated_at":"2020-01-17T23:37:11Z","author_association":"MEMBER","body":"That's strange. Thanks! Looks like process somehow being detached from root one so Jenkins not able to kill whole tree (just a guess). I'll try to reproduce this behaviour - FreeBSD is my primary system for now.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/575834970/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/575836265","html_url":"https://github.com/apache/couchdb/pull/2456#issuecomment-575836265","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2456","id":575836265,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NTgzNjI2NQ==","user":{"login":"chewbranca","id":5326,"node_id":"MDQ6VXNlcjUzMjY=","avatar_url":"https://avatars.githubusercontent.com/u/5326?v=4","gravatar_id":"","url":"https://api.github.com/users/chewbranca","html_url":"https://github.com/chewbranca","followers_url":"https://api.github.com/users/chewbranca/followers","following_url":"https://api.github.com/users/chewbranca/following{/other_user}","gists_url":"https://api.github.com/users/chewbranca/gists{/gist_id}","starred_url":"https://api.github.com/users/chewbranca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chewbranca/subscriptions","organizations_url":"https://api.github.com/users/chewbranca/orgs","repos_url":"https://api.github.com/users/chewbranca/repos","events_url":"https://api.github.com/users/chewbranca/events{/privacy}","received_events_url":"https://api.github.com/users/chewbranca/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-17T23:41:11Z","updated_at":"2020-01-18T00:15:49Z","author_association":"CONTRIBUTOR","body":"So I've been perusing the RFC, `couch_views_skiplist.erl` and the original whitepaper, and one major difference jumps out to me: the skip list implementation here is _not_ a linked list based approach, as per traditional skip lists, but rather embeds the levels into the keys themselves to allow for walking different levels of values. The other thing that jumps out to me is that the querying algorithm utilizes a bottom up approach starting at level zero rather than a top down approach starting at max level, which seems backwards and potentially less performant, especially since right now it seems to spend a lot of time fetching individual keys.\r\n\r\nI think storing the levels in the key affords us an opportunity to heavily lean on range queries, and potentially ignore direct key lookups entirely. Essentially I was thinking you could start at max level, take the baseline supplied startkey and endkey, and then do a range query on `{...,...,$MAX_LEVEL,$start_key}..{...,...,$MAX_LEVEL,$end_key}`. Then you take the results and divide and conquer the lower and upper key spaces with similar queries at one level lower, eg lower query of `{...,...,$MAX_LEVEL - 1,$start_key}..{...,...,$MAX_LEVEL - 1,$results[0]}` and upper query of `{...,...,$MAX_LEVEL - 1,$results[-1]}..{...,...,$MAX_LEVEL - 1,$end_key}`. And then you recurse through the lower levels until you've bottomed out or `$start_key == $results[0] and $end_key == $results[-1]`. In theory this algorithm could fulfill the requests without ever needing to do individual key lookups, while maximizing the range of results queried at the upper levels.\r\n\r\nHere's a proof of concept query algorithm:\r\n\r\n```erlang\r\nquery(View, StartKey, EndKey) ->\r\n    query(View, ?MAX_LEVEL, StartKey, EndKey).\r\n\r\n\r\nquery(_, ?MIN_LEVEL, _, _) ->\r\n    [];\r\nquery(View, Level, StartKey, EndKey) ->\r\n    LevelDown = Level - 1,\r\n    Start = make_key(View, Level, StartKey),\r\n    End = make_key(View, Level, EndKey),\r\n\r\n    [First | _] = Results = fdb_range_query(Start, End),\r\n    Last = lists:last(Results),\r\n\r\n    case {StartKey < First, Last < EndKey} of\r\n        {true, true} ->\r\n            query(View, LevelDown, StartKey, First) ++ Results ++ query(View, LevelDown, Last, EndKey);\r\n        {true, false} when Last =:= EndKey ->\r\n            query(View, LevelDown, StartKey, First) ++ Results;\r\n        {false, true} when First =:= StartKey ->\r\n            Results ++ query(View, LevelDown, Last, EndKey);\r\n        {false, false} when First =:= StartKey andalso Last =:= EndKey ->\r\n            Results;\r\n        {_, _} ->\r\n            throw({error, shouldnt_be_here})\r\n    end.\r\n\r\n\r\nmake_key(View, Level, Key) ->\r\n    {View#view.db, ?DB_VIEWS, View#view.sig, ?VIEW_REDUCE_SK_RANGE, View#view.id, Level, Key}.\r\n```\r\n\r\nIt's quite possible this approach isn't practical for any number of reasons, but it jumped out to me as a potentially viable algorithm that is simple and utilizes the range query support provided by FoundationDB.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/575836265/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/575840299","html_url":"https://github.com/apache/couchdb/pull/2456#issuecomment-575840299","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2456","id":575840299,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NTg0MDI5OQ==","user":{"login":"chewbranca","id":5326,"node_id":"MDQ6VXNlcjUzMjY=","avatar_url":"https://avatars.githubusercontent.com/u/5326?v=4","gravatar_id":"","url":"https://api.github.com/users/chewbranca","html_url":"https://github.com/chewbranca","followers_url":"https://api.github.com/users/chewbranca/followers","following_url":"https://api.github.com/users/chewbranca/following{/other_user}","gists_url":"https://api.github.com/users/chewbranca/gists{/gist_id}","starred_url":"https://api.github.com/users/chewbranca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chewbranca/subscriptions","organizations_url":"https://api.github.com/users/chewbranca/orgs","repos_url":"https://api.github.com/users/chewbranca/repos","events_url":"https://api.github.com/users/chewbranca/events{/privacy}","received_events_url":"https://api.github.com/users/chewbranca/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-18T00:02:52Z","updated_at":"2020-01-18T00:02:52Z","author_association":"CONTRIBUTOR","body":"That approach would also easily support the non skip list toggle with something like\r\n\r\n```erlang\r\nquery_view(View, StartKey, EndKey, UseSkipList) ->\r\n    case UseSkipList of\r\n        true -> query(View, StartKey, EndKey);\r\n        false -> query(View, ?MIN_LEVEL, StartKey, EndKey)\r\n    end.\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/575840299/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/575841827","html_url":"https://github.com/apache/couchdb/pull/2464#issuecomment-575841827","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2464","id":575841827,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NTg0MTgyNw==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-18T00:10:31Z","updated_at":"2020-01-18T00:10:31Z","author_association":"CONTRIBUTOR","body":"@jjrodrig thank you for your contribution\r\n\r\nTest looks good. I added two small fixes to it:\r\n\r\n```\r\ndiff --git a/test/elixir/lib/couch.ex b/test/elixir/lib/couch.ex\r\nindex 994b68173..3aef07f01 100644\r\n--- a/test/elixir/lib/couch.ex\r\n+++ b/test/elixir/lib/couch.ex\r\n@@ -110,7 +110,7 @@ defmodule Couch do\r\n     end\r\n   end\r\n\r\n-  def process_response_body(headers, body) when body == [] do\r\n+  def process_response_body(_headers, body) when body == [] do\r\n     \"\"\r\n   end\r\n\r\ndiff --git a/test/javascript/tests/etags_head.js b/test/javascript/tests/etags_head.js\r\nindex 9faca4af6..6cb99e40d 100644\r\n--- a/test/javascript/tests/etags_head.js\r\n+++ b/test/javascript/tests/etags_head.js\r\n@@ -11,6 +11,7 @@\r\n // the License.\r\n\r\n couchTests.etags_head = function(debug) {\r\n+  return console.log('done in tests=test/elixir/test/etags_head_test.exs');\r\n   var db_name = get_random_db_name();\r\n   var db = new CouchDB(db_name, {\"X-Couch-Full-Commit\":\"false\"});\r\n   db.createDb();\r\n```\r\n\r\nThen squashed them into one commit and pushed them to the new PR https://github.com/apache/couchdb/pull/2469\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/575841827/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/575868479","html_url":"https://github.com/apache/couchdb/issues/2437#issuecomment-575868479","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2437","id":575868479,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NTg2ODQ3OQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-18T05:25:42Z","updated_at":"2020-01-18T05:25:42Z","author_association":"MEMBER","body":"Interesting one:\r\n\r\nhttps://ci-couchdb.apache.org/blue/organizations/jenkins/jenkins-cm1%2FPullRequests/detail/PR-2468/6/pipeline\r\n\r\n@davisp this was on 22.2, SM60, x86_64...note the error -11 in test/javascript/tests/view_update_seq.js ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/575868479/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/575891709","html_url":"https://github.com/apache/couchdb/issues/2470#issuecomment-575891709","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2470","id":575891709,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NTg5MTcwOQ==","user":{"login":"Rohitoracleindia","id":43158400,"node_id":"MDQ6VXNlcjQzMTU4NDAw","avatar_url":"https://avatars.githubusercontent.com/u/43158400?v=4","gravatar_id":"","url":"https://api.github.com/users/Rohitoracleindia","html_url":"https://github.com/Rohitoracleindia","followers_url":"https://api.github.com/users/Rohitoracleindia/followers","following_url":"https://api.github.com/users/Rohitoracleindia/following{/other_user}","gists_url":"https://api.github.com/users/Rohitoracleindia/gists{/gist_id}","starred_url":"https://api.github.com/users/Rohitoracleindia/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Rohitoracleindia/subscriptions","organizations_url":"https://api.github.com/users/Rohitoracleindia/orgs","repos_url":"https://api.github.com/users/Rohitoracleindia/repos","events_url":"https://api.github.com/users/Rohitoracleindia/events{/privacy}","received_events_url":"https://api.github.com/users/Rohitoracleindia/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-18T11:48:32Z","updated_at":"2020-01-18T11:48:32Z","author_association":"NONE","body":"CouchDB version is 2.3.1","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/575891709/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/575933639","html_url":"https://github.com/apache/couchdb/issues/1741#issuecomment-575933639","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1741","id":575933639,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NTkzMzYzOQ==","user":{"login":"jimm101","id":5701937,"node_id":"MDQ6VXNlcjU3MDE5Mzc=","avatar_url":"https://avatars.githubusercontent.com/u/5701937?v=4","gravatar_id":"","url":"https://api.github.com/users/jimm101","html_url":"https://github.com/jimm101","followers_url":"https://api.github.com/users/jimm101/followers","following_url":"https://api.github.com/users/jimm101/following{/other_user}","gists_url":"https://api.github.com/users/jimm101/gists{/gist_id}","starred_url":"https://api.github.com/users/jimm101/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimm101/subscriptions","organizations_url":"https://api.github.com/users/jimm101/orgs","repos_url":"https://api.github.com/users/jimm101/repos","events_url":"https://api.github.com/users/jimm101/events{/privacy}","received_events_url":"https://api.github.com/users/jimm101/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-18T20:02:16Z","updated_at":"2020-01-18T20:02:16Z","author_association":"NONE","body":"Same issue. Any workarounds? Is there a way to identify bad _users entries?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/575933639/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/575945580","html_url":"https://github.com/apache/couchdb/issues/2471#issuecomment-575945580","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2471","id":575945580,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NTk0NTU4MA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-18T22:52:15Z","updated_at":"2020-01-18T22:52:15Z","author_association":"MEMBER","body":"@mechanomi sadly we can't fix it ourselves, only ASF Infrastructure has the ability to edit that (and the tags). they're auto-populated by the setup script, and rather dumbly at that.\r\n\r\nBikeshed something here? Then we can open the Infra ticket to fix it.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/575945580/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/576151898","html_url":"https://github.com/apache/couchdb/issues/1995#issuecomment-576151898","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1995","id":576151898,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NjE1MTg5OA==","user":{"login":"BananaAcid","id":1894723,"node_id":"MDQ6VXNlcjE4OTQ3MjM=","avatar_url":"https://avatars.githubusercontent.com/u/1894723?v=4","gravatar_id":"","url":"https://api.github.com/users/BananaAcid","html_url":"https://github.com/BananaAcid","followers_url":"https://api.github.com/users/BananaAcid/followers","following_url":"https://api.github.com/users/BananaAcid/following{/other_user}","gists_url":"https://api.github.com/users/BananaAcid/gists{/gist_id}","starred_url":"https://api.github.com/users/BananaAcid/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BananaAcid/subscriptions","organizations_url":"https://api.github.com/users/BananaAcid/orgs","repos_url":"https://api.github.com/users/BananaAcid/repos","events_url":"https://api.github.com/users/BananaAcid/events{/privacy}","received_events_url":"https://api.github.com/users/BananaAcid/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-20T07:59:08Z","updated_at":"2020-01-20T08:00:08Z","author_association":"NONE","body":"How is couchdb restricting users on _users to be only to see their own doc? That seems to be specific for checking a doc. (Is that defined in `_design/_auth`?)\r\n\r\nIs that handling transferable to be doing a check on a users doc's property? ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/576151898/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/576171485","html_url":"https://github.com/apache/couchdb/issues/2449#issuecomment-576171485","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2449","id":576171485,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NjE3MTQ4NQ==","user":{"login":"jiangphcn","id":18000622,"node_id":"MDQ6VXNlcjE4MDAwNjIy","avatar_url":"https://avatars.githubusercontent.com/u/18000622?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangphcn","html_url":"https://github.com/jiangphcn","followers_url":"https://api.github.com/users/jiangphcn/followers","following_url":"https://api.github.com/users/jiangphcn/following{/other_user}","gists_url":"https://api.github.com/users/jiangphcn/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangphcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangphcn/subscriptions","organizations_url":"https://api.github.com/users/jiangphcn/orgs","repos_url":"https://api.github.com/users/jiangphcn/repos","events_url":"https://api.github.com/users/jiangphcn/events{/privacy}","received_events_url":"https://api.github.com/users/jiangphcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-20T08:52:47Z","updated_at":"2020-01-20T08:52:47Z","author_association":"CONTRIBUTOR","body":"status update:\r\nIT guy told me that they are not able to provision one with debian-buster for now, and try their best to provision one with Ubuntu. Also still wait for refresh cycle (hope before Chinese Spring Festival) to allow this VM to access outside.\r\n\r\n```\r\nLinux jiangpenghui 4.15.0-20-generic #21-Ubuntu SMP Tue Apr 24 06:14:44 UTC 2018 ppc64le ppc64le ppc64le GNU/Linux\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/576171485/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/576201555","html_url":"https://github.com/apache/couchdb/pull/2460#issuecomment-576201555","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2460","id":576201555,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NjIwMTU1NQ==","user":{"login":"garrensmith","id":179458,"node_id":"MDQ6VXNlcjE3OTQ1OA==","avatar_url":"https://avatars.githubusercontent.com/u/179458?v=4","gravatar_id":"","url":"https://api.github.com/users/garrensmith","html_url":"https://github.com/garrensmith","followers_url":"https://api.github.com/users/garrensmith/followers","following_url":"https://api.github.com/users/garrensmith/following{/other_user}","gists_url":"https://api.github.com/users/garrensmith/gists{/gist_id}","starred_url":"https://api.github.com/users/garrensmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/garrensmith/subscriptions","organizations_url":"https://api.github.com/users/garrensmith/orgs","repos_url":"https://api.github.com/users/garrensmith/repos","events_url":"https://api.github.com/users/garrensmith/events{/privacy}","received_events_url":"https://api.github.com/users/garrensmith/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-20T10:09:17Z","updated_at":"2020-01-20T10:09:17Z","author_association":"MEMBER","body":"I've added the map index key/value limits. If a document exceeds the key/value limit for a view in a design doc. It will be removed from that view. But if there are multiple views in a design doc, it will still be indexed in the other views in that design doc.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/576201555/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/576257566","html_url":"https://github.com/apache/couchdb/pull/2456#issuecomment-576257566","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2456","id":576257566,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NjI1NzU2Ng==","user":{"login":"garrensmith","id":179458,"node_id":"MDQ6VXNlcjE3OTQ1OA==","avatar_url":"https://avatars.githubusercontent.com/u/179458?v=4","gravatar_id":"","url":"https://api.github.com/users/garrensmith","html_url":"https://github.com/garrensmith","followers_url":"https://api.github.com/users/garrensmith/followers","following_url":"https://api.github.com/users/garrensmith/following{/other_user}","gists_url":"https://api.github.com/users/garrensmith/gists{/gist_id}","starred_url":"https://api.github.com/users/garrensmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/garrensmith/subscriptions","organizations_url":"https://api.github.com/users/garrensmith/orgs","repos_url":"https://api.github.com/users/garrensmith/repos","events_url":"https://api.github.com/users/garrensmith/events{/privacy}","received_events_url":"https://api.github.com/users/garrensmith/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-20T12:42:29Z","updated_at":"2020-01-20T12:42:29Z","author_association":"MEMBER","body":"@chewbranca I'm not sure this would work. I think the algorithm treats the skiplist a bit too much like a b-tree. I used your algorithm and did a bit of a mental run-through of the skiplist diagram from the [rfc](https://github.com/apache/couchdb-documentation/blob/8864c35dcb27c9e5996532255fa59e544dee885d/rfcs/012-fdb-reduce.md#create)\r\n\r\nThere were two things that were issues that I couldn't quite see a way around. The first one is that once we reach an endkey at a level above 0 it assumes it can stop. The issue here is that any node above level 0 contains aggregations of the keys a level below. So we can easily have aggregations of key/values that are not in the group level for that key or not in the range for the query. So far I've found we always have to go down to level 0 to check that an endkey value or group level key has the correct values. So basically a skip list allows us to skip many keys for a group level but we still have to check the final key in the group level to make sure the value does not contain aggregates of values outside the group level. \r\n\r\nThe second issue is that we would have to keep all the results in memory before doing a final rereduce right at the end. Maybe that isn't an issue, but I think on large reduce queries we will OOM on this. We could rereduce after each level read and that should reduce the number of results. But it will again require some logic to make sure all the values we have are correct.\r\n\r\nThe bottom-up design I have is definitely not the most optimal, so its great to have you thinking of different designs. But with the bottom-up design, we do find the end keys correctly and can stream group level keys to a user as we traverse the skiplist. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/576257566/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/576377216","html_url":"https://github.com/apache/couchdb/issues/2474#issuecomment-576377216","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2474","id":576377216,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NjM3NzIxNg==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-20T17:51:36Z","updated_at":"2020-01-20T17:51:36Z","author_association":"MEMBER","body":"Can you just `GET` that document+revision first, then start the changes feed right after it?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/576377216/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/576377961","html_url":"https://github.com/apache/couchdb/issues/2449#issuecomment-576377961","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2449","id":576377961,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NjM3Nzk2MQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-20T17:54:15Z","updated_at":"2020-01-20T17:54:15Z","author_association":"MEMBER","body":"@jiangphcn Happy New Year!\r\n\r\nIf you can run Docker on it, you'll be fine. That version of Ubuntu doesn't have SM60 packages, but the Debian buster ppc64le couchdbdev image has them.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/576377961/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/576401953","html_url":"https://github.com/apache/couchdb/issues/2437#issuecomment-576401953","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2437","id":576401953,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NjQwMTk1Mw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-20T19:22:00Z","updated_at":"2020-01-20T19:22:00Z","author_association":"MEMBER","body":"Most often I'm seeing this in CI on 22.2 (for PRs) and on FreeBSD (for \"full\" builds). A [recently merged change](https://github.com/apache/couchdb/commit/7214e506199f41babd09611c7ab3564291d5be06) works around our FreeBSD CI worker dying to this, but it wallpapers over the real problem.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/576401953/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/576404587","html_url":"https://github.com/apache/couchdb/issues/2437#issuecomment-576404587","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2437","id":576404587,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NjQwNDU4Nw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-20T19:31:02Z","updated_at":"2020-01-20T19:31:02Z","author_association":"MEMBER","body":"@nickva sure looks like scheduler failure. I wish I knew why :(\r\n\r\nI also want to be sure that the 100% hung beam.smp issue is the same as the \"error 32\" problem we're seeing on failing to launch `couchjs` correctly. They seem related...but can't be sure.\r\n\r\nWe looked at the source code for 21.x and 22.x for https://github.com/erlang/otp/commits/master/erts/emulator/sys/unix/erl_child_setup.c and didn't see anything in those releases. There's more recent commits but nothing released yet (per GH tags).\r\n\r\nHere's the most recent commit, which landed in OTP-21.0.9. This would be the most likely culprit... https://github.com/erlang/otp/commit/da4c24bf8fc7bb2ee0d0a66d9fcfe6344d7c0c8a#diff-d0f4c5a298602460b21bc50914237807\r\n\r\n```\r\nerl_child_setup program ignores TERM signals as of ERTS version\r\n10.0 (cff8dce). This setting was unfortunately inherited by\r\nport programs. This commit restores handling of TERM signals\r\nin port programs to the default behavior. That is, terminate the\r\nprocess.\r\n```\r\n\r\n🤔 ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/576404587/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/576434017","html_url":"https://github.com/apache/couchdb/issues/2437#issuecomment-576434017","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2437","id":576434017,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NjQzNDAxNw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-20T21:22:45Z","updated_at":"2020-01-20T21:22:45Z","author_association":"MEMBER","body":"Another hang, and again in 22.2:\r\n\r\nhttps://ci-couchdb.apache.org/blue/organizations/jenkins/jenkins-cm1%2FPullRequests/detail/PR-2472/2/pipeline","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/576434017/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/576434680","html_url":"https://github.com/apache/couchdb/issues/2437#issuecomment-576434680","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2437","id":576434680,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NjQzNDY4MA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-20T21:25:19Z","updated_at":"2020-01-20T21:25:19Z","author_association":"MEMBER","body":"Interestingly, the stream of `error 32` broken pipes seems to be predicated on this test failing:\r\n\r\n```\r\n::in function mem3_sync_event_listener:'-should_terminate/1-fun-3-'/0 (src/mem3_sync_event_listener.erl, line 312)\r\nin call from mem3_sync_event_listener:'-should_terminate/1-fun-5-'/1 (src/mem3_sync_event_listener.erl, line 312)\r\n**error:{assert,[{module,mem3_sync_event_listener},\r\n{line,312},\r\n{expression,\"false\"},\r\n{expected,true},\r\n{value,false}]}\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/576434680/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/576435270","html_url":"https://github.com/apache/couchdb/issues/2437#issuecomment-576435270","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2437","id":576435270,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NjQzNTI3MA==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-20T21:27:41Z","updated_at":"2020-01-20T21:27:41Z","author_association":"CONTRIBUTOR","body":"@wohali \r\n\r\n> I also want to be sure that the 100% hung beam.smp issue is the same as the \"error 32\" problem\r\n\r\nIt might not be. I had only looked it since I saw it happening before the \"freeze\". It might be either a coincidence, or the freeze also causes the child spawner process to die so the causation is the other way around.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/576435270/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/576438585","html_url":"https://github.com/apache/couchdb/issues/2437#issuecomment-576438585","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2437","id":576438585,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NjQzODU4NQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-20T21:42:20Z","updated_at":"2020-01-20T21:42:20Z","author_association":"MEMBER","body":"If we need to split the issues, that's fine, but both are 3.0.0 blockers IMO. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/576438585/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/576478320","html_url":"https://github.com/apache/couchdb/issues/2449#issuecomment-576478320","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2449","id":576478320,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NjQ3ODMyMA==","user":{"login":"jiangphcn","id":18000622,"node_id":"MDQ6VXNlcjE4MDAwNjIy","avatar_url":"https://avatars.githubusercontent.com/u/18000622?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangphcn","html_url":"https://github.com/jiangphcn","followers_url":"https://api.github.com/users/jiangphcn/followers","following_url":"https://api.github.com/users/jiangphcn/following{/other_user}","gists_url":"https://api.github.com/users/jiangphcn/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangphcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangphcn/subscriptions","organizations_url":"https://api.github.com/users/jiangphcn/orgs","repos_url":"https://api.github.com/users/jiangphcn/repos","events_url":"https://api.github.com/users/jiangphcn/events{/privacy}","received_events_url":"https://api.github.com/users/jiangphcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-21T01:18:24Z","updated_at":"2020-01-21T01:18:24Z","author_association":"CONTRIBUTOR","body":"thanks @wohali :-)\r\n\r\nsmart suggestion. This gives one way to test against ppc64le. I will try when this box can get access to internet. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/576478320/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/576565408","html_url":"https://github.com/apache/couchdb/issues/2474#issuecomment-576565408","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2474","id":576565408,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NjU2NTQwOA==","user":{"login":"tomasged","id":59650761,"node_id":"MDQ6VXNlcjU5NjUwNzYx","avatar_url":"https://avatars.githubusercontent.com/u/59650761?v=4","gravatar_id":"","url":"https://api.github.com/users/tomasged","html_url":"https://github.com/tomasged","followers_url":"https://api.github.com/users/tomasged/followers","following_url":"https://api.github.com/users/tomasged/following{/other_user}","gists_url":"https://api.github.com/users/tomasged/gists{/gist_id}","starred_url":"https://api.github.com/users/tomasged/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tomasged/subscriptions","organizations_url":"https://api.github.com/users/tomasged/orgs","repos_url":"https://api.github.com/users/tomasged/repos","events_url":"https://api.github.com/users/tomasged/events{/privacy}","received_events_url":"https://api.github.com/users/tomasged/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-21T08:09:28Z","updated_at":"2020-01-21T08:09:51Z","author_association":"NONE","body":"Our case is that the database is the source of truth. A user logins and that user only needs to start listening / replicating from the beginning of a bunch of documents. Normally, at 3/4 of the database.\r\n\r\nRetrieving such documents and then using changes with \"now\" could mean that between those two operations some changes are lost... I guess they should work in parallel but that just complicates things: first, changes with since=now and afterwards retrieving the documents of interest with a startKey since the IDs of the new generated documents are unknown (imagine a tree of documents with a common root). \r\n\r\nWe are used to use it with PouchDB as described in my first comment (\"since\" value of the minimum sequence of that bunch of documents minus one), but with the sequence number change for CouchDB 2.x, it destroyed that possibility I guess ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/576565408/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/576713117","html_url":"https://github.com/apache/couchdb/issues/2474#issuecomment-576713117","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2474","id":576713117,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NjcxMzExNw==","user":{"login":"lostnet","id":1422781,"node_id":"MDQ6VXNlcjE0MjI3ODE=","avatar_url":"https://avatars.githubusercontent.com/u/1422781?v=4","gravatar_id":"","url":"https://api.github.com/users/lostnet","html_url":"https://github.com/lostnet","followers_url":"https://api.github.com/users/lostnet/followers","following_url":"https://api.github.com/users/lostnet/following{/other_user}","gists_url":"https://api.github.com/users/lostnet/gists{/gist_id}","starred_url":"https://api.github.com/users/lostnet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lostnet/subscriptions","organizations_url":"https://api.github.com/users/lostnet/orgs","repos_url":"https://api.github.com/users/lostnet/repos","events_url":"https://api.github.com/users/lostnet/events{/privacy}","received_events_url":"https://api.github.com/users/lostnet/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-21T14:44:03Z","updated_at":"2020-01-21T14:44:03Z","author_association":"CONTRIBUTOR","body":"@tomasged If I've understood the problem correctly, I think you can use `/db/_changes?descending=true&since=[firstdocseq]&limit=2` to get a potential previous sequence to use in replications, then you would need to verify that you've been given at least the documents you want or re-replicate and make sure your code can live with any additional documents from different order responses..\r\n\r\nA different approach might be to rely on a view and an application layer source of order (i.e. timestamp fields?) ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/576713117/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/576714981","html_url":"https://github.com/apache/couchdb/issues/2474#issuecomment-576714981","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2474","id":576714981,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NjcxNDk4MQ==","user":{"login":"tomasged","id":59650761,"node_id":"MDQ6VXNlcjU5NjUwNzYx","avatar_url":"https://avatars.githubusercontent.com/u/59650761?v=4","gravatar_id":"","url":"https://api.github.com/users/tomasged","html_url":"https://github.com/tomasged","followers_url":"https://api.github.com/users/tomasged/followers","following_url":"https://api.github.com/users/tomasged/following{/other_user}","gists_url":"https://api.github.com/users/tomasged/gists{/gist_id}","starred_url":"https://api.github.com/users/tomasged/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tomasged/subscriptions","organizations_url":"https://api.github.com/users/tomasged/orgs","repos_url":"https://api.github.com/users/tomasged/repos","events_url":"https://api.github.com/users/tomasged/events{/privacy}","received_events_url":"https://api.github.com/users/tomasged/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-21T14:47:55Z","updated_at":"2020-01-21T14:47:55Z","author_association":"NONE","body":"Thank you both, @lostnet & @wohali . It's clear that we'll need to re-engineer the solution and be creative with what's now given.\r\n\r\nThis issue can be closed if no one else has other ideas.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/576714981/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/576754474","html_url":"https://github.com/apache/couchdb/issues/2474#issuecomment-576754474","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2474","id":576754474,"node_id":"MDEyOklzc3VlQ29tbWVudDU3Njc1NDQ3NA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-21T16:10:03Z","updated_at":"2020-01-21T16:10:03Z","author_association":"MEMBER","body":"@tomasged For reference, it's better to ask these questions on our user mailing list than here, or on our Slack, if you want a wider variety of answers. Details for subscription are at https://couchdb.apache.org/","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/576754474/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/576814116","html_url":"https://github.com/apache/couchdb/issues/2437#issuecomment-576814116","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2437","id":576814116,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NjgxNDExNg==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-21T18:24:21Z","updated_at":"2020-01-21T18:24:21Z","author_association":"MEMBER","body":"Nick noticed this commit, which I'm going to try running in a loop locally and see if I can get a repro with the patch:\r\n\r\nhttps://github.com/erlang/otp/commit/0109f91a76ea6873cf9851529d7c60b70f328f86\r\n\r\nwhich has been ported as far back as 20.x, suggesting it's a fairly serious bug.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/576814116/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/576913743","html_url":"https://github.com/apache/couchdb/issues/2437#issuecomment-576913743","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2437","id":576913743,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NjkxMzc0Mw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-21T22:24:16Z","updated_at":"2020-01-21T22:43:51Z","author_association":"MEMBER","body":"With the patch, we've gone into a hung beam again, but this time not 100% CPU.\r\n\r\nhttps://gist.github.com/wohali/5ef99e1e0ce9d06231f3b05395f4c902\r\n\r\nErlang 21.3.8.12.\r\n\r\n[ETA: Updated gist with gdb output from all the relevant threads.]\r\n\r\n[ETA 2: Killed the `couchjs` process and the tests are still stuck. @davisp calls this a \"smoking gun.\"]\r\n\r\n[ETA 3: Killed `erl_child_setup`, and it does not get reaped - zombie:\r\n\r\n```\r\njenkins   15258  0.0  0.0      0     0 ?        Zs   21:44   0:00 [erl_child_setup] <defunct>\r\n```\r\n@davisp thinks this is enough to show that this is a VM bug.]","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/576913743/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/576921440","html_url":"https://github.com/apache/couchdb/issues/2437#issuecomment-576921440","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2437","id":576921440,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NjkyMTQ0MA==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-21T22:44:32Z","updated_at":"2020-01-21T22:44:32Z","author_association":"MEMBER","body":"Could be a smoking gun at least. My current theory is that there's some sort of messaging protocol between erl_child_setup and the Erlang VM that's getting confused. beam just sitting stuck waiting on a read of a port seems not good. Will have to read more on erl_child_setup to get a figure on what it might be and hopefully figure out a test case for upstream.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/576921440/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/576929600","html_url":"https://github.com/apache/couchdb/issues/2437#issuecomment-576929600","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2437","id":576929600,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NjkyOTYwMA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-21T23:08:40Z","updated_at":"2020-01-21T23:17:38Z","author_association":"MEMBER","body":"Another test hang:\r\n\r\nhttps://gist.github.com/wohali/5c903d20c023339c00a92ec322b9d1d2\r\n\r\nLast test before hang:\r\n\r\n```\r\n    chttpd_open_revs_error_test:105: should_return_503_error_for_open_revs_post_form...ok\r\n```\r\n\r\nAfter attaching gdb to the parent `beam.smp` and retrieving the backtrace, then detatching, the hang self-cleared (!)\r\n\r\nThe tests then continued and hung again after:\r\n\r\n```\r\n    couch_mrview_collation_tests:183: should_use_collator_for_reduce_grouping...ok\r\n[os_mon] memory supervisor port (memsup): Erlang has closed\r\n[os_mon] cpu supervisor port (cpu_sup): Erlang has closed\r\n    [done in 1.117 s]\r\n  [done in 1.272 s]\r\nmodule 'couch_mrview_purge_docs_tests'\r\n  Map views\r\n```\r\n\r\nResults here: https://gist.github.com/wohali/2b6a8563658a468b5810a35b764f4a19\r\n\r\nDetaching `gdb` from `beam.smp` didn't resume this time.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/576929600/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/577119512","html_url":"https://github.com/apache/couchdb/issues/2437#issuecomment-577119512","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2437","id":577119512,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NzExOTUxMg==","user":{"login":"dch","id":284368,"node_id":"MDQ6VXNlcjI4NDM2OA==","avatar_url":"https://avatars.githubusercontent.com/u/284368?v=4","gravatar_id":"","url":"https://api.github.com/users/dch","html_url":"https://github.com/dch","followers_url":"https://api.github.com/users/dch/followers","following_url":"https://api.github.com/users/dch/following{/other_user}","gists_url":"https://api.github.com/users/dch/gists{/gist_id}","starred_url":"https://api.github.com/users/dch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dch/subscriptions","organizations_url":"https://api.github.com/users/dch/orgs","repos_url":"https://api.github.com/users/dch/repos","events_url":"https://api.github.com/users/dch/events{/privacy}","received_events_url":"https://api.github.com/users/dch/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-22T10:38:08Z","updated_at":"2020-01-22T10:38:08Z","author_association":"CONTRIBUTOR","body":"Some background reading\r\n\r\nhttp://erlang.org/pipermail/erlang-questions/2017-February/091721.html\r\n\r\n\"The only \"normal\" reason that I have found so far for erl_child_setup to\r\nexit is if the Linux OOM killed decides to terminate it. Besides that all\r\nterminations should be considered bugs in erl_child_setup.\"\r\n\r\nFrom the OTP 21 branch https://github.com/erlang/otp/commits/OTP-21.3.8.12\r\n\r\n- https://github.com/erlang/otp/commit/849361207b506ad390c2a247e4591a581bddb607\r\n- https://github.com/erlang/otp/commit/dce979e061d2c55a4fdfc47f1c5c74b948a37182\r\n\r\n& from OTP master:\r\n\r\n- https://github.com/erlang/otp/commit/1eb6bbf780edfbb64cb74a9be27290f38d26144f\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/577119512/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/577140384","html_url":"https://github.com/apache/couchdb/pull/2460#issuecomment-577140384","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2460","id":577140384,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NzE0MDM4NA==","user":{"login":"garrensmith","id":179458,"node_id":"MDQ6VXNlcjE3OTQ1OA==","avatar_url":"https://avatars.githubusercontent.com/u/179458?v=4","gravatar_id":"","url":"https://api.github.com/users/garrensmith","html_url":"https://github.com/garrensmith","followers_url":"https://api.github.com/users/garrensmith/followers","following_url":"https://api.github.com/users/garrensmith/following{/other_user}","gists_url":"https://api.github.com/users/garrensmith/gists{/gist_id}","starred_url":"https://api.github.com/users/garrensmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/garrensmith/subscriptions","organizations_url":"https://api.github.com/users/garrensmith/orgs","repos_url":"https://api.github.com/users/garrensmith/repos","events_url":"https://api.github.com/users/garrensmith/events{/privacy}","received_events_url":"https://api.github.com/users/garrensmith/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-22T11:35:08Z","updated_at":"2020-01-22T11:35:08Z","author_association":"MEMBER","body":"I've removed the key limiting code and just left the switch to 1 fdb row for 1 map row. Since this has already received a +1. I'm merging.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/577140384/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/577200406","html_url":"https://github.com/apache/couchdb/issues/2437#issuecomment-577200406","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2437","id":577200406,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NzIwMDQwNg==","user":{"login":"dch","id":284368,"node_id":"MDQ6VXNlcjI4NDM2OA==","avatar_url":"https://avatars.githubusercontent.com/u/284368?v=4","gravatar_id":"","url":"https://api.github.com/users/dch","html_url":"https://github.com/dch","followers_url":"https://api.github.com/users/dch/followers","following_url":"https://api.github.com/users/dch/following{/other_user}","gists_url":"https://api.github.com/users/dch/gists{/gist_id}","starred_url":"https://api.github.com/users/dch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dch/subscriptions","organizations_url":"https://api.github.com/users/dch/orgs","repos_url":"https://api.github.com/users/dch/repos","events_url":"https://api.github.com/users/dch/events{/privacy}","received_events_url":"https://api.github.com/users/dch/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-22T14:14:31Z","updated_at":"2020-01-22T14:14:31Z","author_association":"CONTRIBUTOR","body":"no failures in ~6h of running `gmake eunit javascript` on latest OTP20, but OTP21 & OTP22 fail reliably.\r\n\r\nI've noticed that erl_child_setup isn't actually hung, if you kill off diskup or cpusup, they;ll be correctly restarted, so perhaps this is something specific to couchjs' heavy use of stdio?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/577200406/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/577282640","html_url":"https://github.com/apache/couchdb/issues/2437#issuecomment-577282640","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2437","id":577282640,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NzI4MjY0MA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-22T16:57:15Z","updated_at":"2020-01-22T16:57:15Z","author_association":"MEMBER","body":"@dch In my tests, I was able to kill off disksup or cpusup and erl_child_setup would be hung. In another case I killed off erl_child_setup and beam.smp either hunk or segfaulted, check the links above for details.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/577282640/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/577666866","html_url":"https://github.com/apache/couchdb/issues/2481#issuecomment-577666866","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2481","id":577666866,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NzY2Njg2Ng==","user":{"login":"Sharvin26","id":17084209,"node_id":"MDQ6VXNlcjE3MDg0MjA5","avatar_url":"https://avatars.githubusercontent.com/u/17084209?v=4","gravatar_id":"","url":"https://api.github.com/users/Sharvin26","html_url":"https://github.com/Sharvin26","followers_url":"https://api.github.com/users/Sharvin26/followers","following_url":"https://api.github.com/users/Sharvin26/following{/other_user}","gists_url":"https://api.github.com/users/Sharvin26/gists{/gist_id}","starred_url":"https://api.github.com/users/Sharvin26/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Sharvin26/subscriptions","organizations_url":"https://api.github.com/users/Sharvin26/orgs","repos_url":"https://api.github.com/users/Sharvin26/repos","events_url":"https://api.github.com/users/Sharvin26/events{/privacy}","received_events_url":"https://api.github.com/users/Sharvin26/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-23T12:46:52Z","updated_at":"2020-01-23T12:47:21Z","author_association":"NONE","body":"Fixed the issue by running this command => \r\n```\r\nsudo apt-get --no-install-recommends -y install \\\r\n    build-essential pkg-config erlang \\\r\n    libicu-dev libmozjs185-dev libcurl4-openssl-dev\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/577666866/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/577761557","html_url":"https://github.com/apache/couchdb/issues/2437#issuecomment-577761557","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2437","id":577761557,"node_id":"MDEyOklzc3VlQ29tbWVudDU3Nzc2MTU1Nw==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-23T16:33:45Z","updated_at":"2020-01-23T16:33:45Z","author_association":"CONTRIBUTOR","body":"```\r\n[2020-01-23T15:08:02.163Z]   [done in 0.468 s]\r\n\r\n[2020-01-23T15:08:02.163Z] module 'mem3_reshard_test'\r\n\r\n[2020-01-23T15:08:02.163Z]   mem3 shard split db tests\r\n\r\n[2020-01-23T15:08:03.263Z]     mem3_reshard_test:86: split_one_shard...[0.459 s] ok\r\n\r\n[2020-01-23T15:08:03.963Z]     mem3_reshard_test:146: update_docs_before_topoff1...[0.466 s] ok\r\n\r\n[2020-01-23T15:44:16.999Z] Sending interrupt signal to process\r\n\r\n[2020-01-23T15:44:17.658Z] Sending interrupt signal to process\r\n\r\n[2020-01-23T15:44:26.285Z] Terminated\r\n\r\n[2020-01-23T15:44:26.285Z] make[1]: *** [Makefile:175: eunit] Terminated\r\n\r\n[2020-01-23T15:44:26.285Z] make: *** [Makefile:153: check] Terminated\r\n\r\n[2020-01-23T15:44:26.285Z]     undefined\r\n\r\n[2020-01-23T15:44:26.285Z]     *** context setup failed ***\r\n\r\n[2020-01-23T15:44:26.285Z] **in function mem3_reshard_test:with_proc/3 (test/eunit/mem3_reshard_test.erl, line 685)\r\n\r\n[2020-01-23T15:44:26.285Z] in call from mem3_reshard_test:setup/0 (test/eunit/mem3_reshard_test.erl, line 35)\r\n\r\n[2020-01-23T15:44:26.285Z] **error:{noproc,{gen_server,call,[mem3_nodes,get_nodelist]}}\r\n\r\n[2020-01-23T15:44:26.285Z] \r\n\r\n[2020-01-23T15:44:26.285Z] \r\n\r\n[2020-01-23T15:44:26.285Z]   undefined\r\n\r\n[2020-01-23T15:44:26.285Z]   *** context setup failed ***\r\n\r\n[2020-01-23T15:44:26.285Z] **in function mem3_reshard_test:with_proc/3 (test/eunit/mem3_reshard_test.erl, line 685)\r\n\r\n[2020-01-23T15:44:26.285Z] in call from mem3_reshard_test:setup/0 (test/eunit/mem3_reshard_test.erl, line 35)\r\n\r\n[2020-01-23T15:44:26.285Z] **error:{noproc,{gen_server,call,[mem3_nodes,get_nodelist]}}\r\n```\r\n\r\nAnother case of a stuck scheduler I think. It looks like one test finished, then the next one was being set up. In the setup code we call `mem3_nodes:get_node_list()` that call however never returned and everything was stuck waiting for it.\r\n\r\nI clicked either stop or restart make check and it then received a bunch of termination signals and it seems to have killed mem3_nodes gen_server and all the stuck waiting calls returned with noproc. And then the whole thing got torn down.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/577761557/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/577822691","html_url":"https://github.com/apache/couchdb/issues/2423#issuecomment-577822691","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2423","id":577822691,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NzgyMjY5MQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-23T18:54:24Z","updated_at":"2020-01-23T18:54:24Z","author_association":"MEMBER","body":"Re-opening this because we're still seeing coredumps from couchjs SM60 - but less often.\r\n\r\nThe two that have been found recently were both on `x86_64`.\r\n\r\nhttps://gist.github.com/wohali/541e05b674c894c1245634813fec7f23\r\n\r\nand\r\n\r\nhttps://gist.github.com/wohali/bbc844322d741ad7fecb39535d096e7d","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/577822691/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/577938309","html_url":"https://github.com/apache/couchdb/issues/2481#issuecomment-577938309","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2481","id":577938309,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NzkzODMwOQ==","user":{"login":"jiangphcn","id":18000622,"node_id":"MDQ6VXNlcjE4MDAwNjIy","avatar_url":"https://avatars.githubusercontent.com/u/18000622?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangphcn","html_url":"https://github.com/jiangphcn","followers_url":"https://api.github.com/users/jiangphcn/followers","following_url":"https://api.github.com/users/jiangphcn/following{/other_user}","gists_url":"https://api.github.com/users/jiangphcn/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangphcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangphcn/subscriptions","organizations_url":"https://api.github.com/users/jiangphcn/orgs","repos_url":"https://api.github.com/users/jiangphcn/repos","events_url":"https://api.github.com/users/jiangphcn/events{/privacy}","received_events_url":"https://api.github.com/users/jiangphcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-24T00:15:52Z","updated_at":"2020-01-24T00:15:52Z","author_association":"CONTRIBUTOR","body":"cool, `jsapi.h` is supposed to be found at https://github.com/apache/couchdb/blob/2.3.1-draft/src/couch/rebar.config.script#L119-L122","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/577938309/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/577941947","html_url":"https://github.com/apache/couchdb/issues/2423#issuecomment-577941947","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2423","id":577941947,"node_id":"MDEyOklzc3VlQ29tbWVudDU3Nzk0MTk0Nw==","user":{"login":"jiangphcn","id":18000622,"node_id":"MDQ6VXNlcjE4MDAwNjIy","avatar_url":"https://avatars.githubusercontent.com/u/18000622?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangphcn","html_url":"https://github.com/jiangphcn","followers_url":"https://api.github.com/users/jiangphcn/followers","following_url":"https://api.github.com/users/jiangphcn/following{/other_user}","gists_url":"https://api.github.com/users/jiangphcn/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangphcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangphcn/subscriptions","organizations_url":"https://api.github.com/users/jiangphcn/orgs","repos_url":"https://api.github.com/users/jiangphcn/repos","events_url":"https://api.github.com/users/jiangphcn/events{/privacy}","received_events_url":"https://api.github.com/users/jiangphcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-24T00:30:34Z","updated_at":"2020-01-24T00:30:34Z","author_association":"CONTRIBUTOR","body":"the line is matched to https://github.com/apache/couchdb/blob/master/src/couch/priv/couch_js/60/main.cpp#L485 which is used to `ExecuteScript`","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/577941947/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/578253358","html_url":"https://github.com/apache/couchdb/issues/2484#issuecomment-578253358","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2484","id":578253358,"node_id":"MDEyOklzc3VlQ29tbWVudDU3ODI1MzM1OA==","user":{"login":"dottorblaster","id":20770,"node_id":"MDQ6VXNlcjIwNzcw","avatar_url":"https://avatars.githubusercontent.com/u/20770?v=4","gravatar_id":"","url":"https://api.github.com/users/dottorblaster","html_url":"https://github.com/dottorblaster","followers_url":"https://api.github.com/users/dottorblaster/followers","following_url":"https://api.github.com/users/dottorblaster/following{/other_user}","gists_url":"https://api.github.com/users/dottorblaster/gists{/gist_id}","starred_url":"https://api.github.com/users/dottorblaster/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dottorblaster/subscriptions","organizations_url":"https://api.github.com/users/dottorblaster/orgs","repos_url":"https://api.github.com/users/dottorblaster/repos","events_url":"https://api.github.com/users/dottorblaster/events{/privacy}","received_events_url":"https://api.github.com/users/dottorblaster/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-24T18:48:40Z","updated_at":"2020-01-24T18:48:40Z","author_association":"MEMBER","body":"@wohali of course I can look into this, I'll do it in the next couple of days, please ping if I don't come up with a solution in a short time","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/578253358/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/578380637","html_url":"https://github.com/apache/couchdb/pull/2487#issuecomment-578380637","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2487","id":578380637,"node_id":"MDEyOklzc3VlQ29tbWVudDU3ODM4MDYzNw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-25T06:05:32Z","updated_at":"2020-01-25T06:05:32Z","author_association":"MEMBER","body":"6 hours later, a595401 is still hung but b02599e is not. I'll let it run overnight but I think this is it.\r\n\r\nThanks for the +1!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/578380637/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/578385040","html_url":"https://github.com/apache/couchdb/issues/2423#issuecomment-578385040","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2423","id":578385040,"node_id":"MDEyOklzc3VlQ29tbWVudDU3ODM4NTA0MA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-25T07:34:34Z","updated_at":"2020-01-25T07:34:34Z","author_association":"MEMBER","body":"Not a segfault, but a failure i've never seen before:\r\n\r\n```\r\n[2020-01-25T07:32:05.985Z] test/javascript/tests/reduce_builtin.js                        \r\n\r\n[2020-01-25T07:32:05.985Z]     Error: read_failure\r\n\r\n[2020-01-25T07:32:05.985Z] Trace back (most recent call first):\r\n\r\n[2020-01-25T07:32:05.985Z]     \r\n\r\n[2020-01-25T07:32:05.985Z]  551:14: test/javascript/couch.js\r\n\r\n[2020-01-25T07:32:05.985Z]       CouchError\r\n\r\n[2020-01-25T07:32:05.985Z]  514:12: test/javascript/couch.js\r\n\r\n[2020-01-25T07:32:05.985Z]       CouchDB.maybeThrowError\r\n\r\n[2020-01-25T07:32:05.985Z]  180:5: test/javascript/couch.js\r\n\r\n[2020-01-25T07:32:05.985Z]       CouchDB/this.query\r\n\r\n[2020-01-25T07:32:05.985Z]  185:19: test/javascript/tests/reduce_builtin.js\r\n\r\n[2020-01-25T07:32:05.985Z]       couchTests.reduce_builtin\r\n\r\n[2020-01-25T07:32:05.985Z]  45:5: test/javascript/cli_runner.js\r\n\r\n[2020-01-25T07:32:05.985Z]       runTest\r\n\r\n[2020-01-25T07:32:05.985Z]  56:1: test/javascript/cli_runner.js\r\n\r\n[2020-01-25T07:32:05.985Z]       \r\n\r\n[2020-01-25T07:32:05.985Z] fail: 1\r\n```\r\n\r\nhttps://ci-couchdb.apache.org/blue/organizations/jenkins/jenkins-cm1%2FFullPlatformMatrix/detail/master/54/pipeline/181\r\n\r\nDebian buster ppc64, SM60.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/578385040/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/578389980","html_url":"https://github.com/apache/couchdb/issues/2423#issuecomment-578389980","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2423","id":578389980,"node_id":"MDEyOklzc3VlQ29tbWVudDU3ODM4OTk4MA==","user":{"login":"jiangphcn","id":18000622,"node_id":"MDQ6VXNlcjE4MDAwNjIy","avatar_url":"https://avatars.githubusercontent.com/u/18000622?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangphcn","html_url":"https://github.com/jiangphcn","followers_url":"https://api.github.com/users/jiangphcn/followers","following_url":"https://api.github.com/users/jiangphcn/following{/other_user}","gists_url":"https://api.github.com/users/jiangphcn/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangphcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangphcn/subscriptions","organizations_url":"https://api.github.com/users/jiangphcn/orgs","repos_url":"https://api.github.com/users/jiangphcn/repos","events_url":"https://api.github.com/users/jiangphcn/events{/privacy}","received_events_url":"https://api.github.com/users/jiangphcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-25T09:08:04Z","updated_at":"2020-01-25T09:08:04Z","author_association":"CONTRIBUTOR","body":"thanks @wohali. it looks that this is not always happening. I re-triggered build, and got pass for above JS test in https://ci-couchdb.apache.org/blue/rest/organizations/jenkins/pipelines/jenkins-cm1/pipelines/FullPlatformMatrix/branches/master/runs/55/nodes/198/log/?start=0.\r\n\r\nhi Paul, @davisp, From `read_failure`, i only found hit in https://github.com/apache/couchdb/blob/19c67e1e52a4071e1c41e6c36cf6b6ddd2e448e2/src/fabric/src/fabric_doc_open.erl#L161.\r\n\r\n ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/578389980/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/578443244","html_url":"https://github.com/apache/couchdb/issues/2437#issuecomment-578443244","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2437","id":578443244,"node_id":"MDEyOklzc3VlQ29tbWVudDU3ODQ0MzI0NA==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-25T21:09:25Z","updated_at":"2020-01-25T21:09:25Z","author_association":"CONTRIBUTOR","body":"When the VM was stuck on Erlang 22 I sampled the stack a few times:\r\n\r\nwith `pidof rebar | xargs -n1 sudo gdb --batch -ex \"thread apply 5 bt\" -p`\r\n\r\n[sample_stuck_vm.txt](https://github.com/apache/couchdb/files/4112786/sample_stuck_vm.txt)\r\n\r\nThread 5 was the one that was actively spinning it seems so sampled just its stack.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/578443244/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/578467775","html_url":"https://github.com/apache/couchdb/pull/1927#issuecomment-578467775","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1927","id":578467775,"node_id":"MDEyOklzc3VlQ29tbWVudDU3ODQ2Nzc3NQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-26T04:33:17Z","updated_at":"2020-01-26T04:33:17Z","author_association":"MEMBER","body":"This has broken building from a `make release` build. Shouldn't be hard to fix.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/578467775/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/578493182","html_url":"https://github.com/apache/couchdb/pull/2491#issuecomment-578493182","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2491","id":578493182,"node_id":"MDEyOklzc3VlQ29tbWVudDU3ODQ5MzE4Mg==","user":{"login":"willholley","id":97787,"node_id":"MDQ6VXNlcjk3Nzg3","avatar_url":"https://avatars.githubusercontent.com/u/97787?v=4","gravatar_id":"","url":"https://api.github.com/users/willholley","html_url":"https://github.com/willholley","followers_url":"https://api.github.com/users/willholley/followers","following_url":"https://api.github.com/users/willholley/following{/other_user}","gists_url":"https://api.github.com/users/willholley/gists{/gist_id}","starred_url":"https://api.github.com/users/willholley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/willholley/subscriptions","organizations_url":"https://api.github.com/users/willholley/orgs","repos_url":"https://api.github.com/users/willholley/repos","events_url":"https://api.github.com/users/willholley/events{/privacy}","received_events_url":"https://api.github.com/users/willholley/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-26T11:33:16Z","updated_at":"2020-01-26T11:33:16Z","author_association":"MEMBER","body":"@wohali - yes we do need to release / bump Fauxton. If we can get\nhttps://github.com/apache/couchdb-fauxton/pull/1246 in that would be a\nbonus but I can't look at until tomorrow.\n\nOn Sun, 26 Jan 2020, 04:31 Joan Touzet, <notifications@github.com> wrote:\n\n> Closes #2391 <https://github.com/apache/couchdb/issues/2391> except for\n> bumping Fauxton and docs.\n>\n> @willholley <https://github.com/willholley> can you tell me if we need\n> the last couple of changes in Fauxton in 3.0.0 or not?\n>\n> @davisp <https://github.com/davisp> Do we need the changes to jiffy in\n> CouchDB? We're fairly far back on that dependency.\n> ------------------------------\n> You can view, comment on, or merge this pull request online at:\n>\n>   https://github.com/apache/couchdb/pull/2491\n> Commit Summary\n>\n>    - bump ets_lru, khash revs\n>\n> File Changes\n>\n>    - *M* .gitignore\n>    <https://github.com/apache/couchdb/pull/2491/files#diff-0> (1)\n>    - *M* rebar.config.script\n>    <https://github.com/apache/couchdb/pull/2491/files#diff-1> (4)\n>\n> Patch Links:\n>\n>    - https://github.com/apache/couchdb/pull/2491.patch\n>    - https://github.com/apache/couchdb/pull/2491.diff\n>\n> —\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/apache/couchdb/pull/2491?email_source=notifications&email_token=AAAX36YSKKJKO5UPR6NRN3TQ7UGZ7A5CNFSM4KLUYGN2YY3PNVWWK3TUL52HS4DFUVEXG43VMWVGG33NNVSW45C7NFSM4IIXKF6Q>,\n> or unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/AAAX366HKJKAONTO5LOUP5TQ7UGZ7ANCNFSM4KLUYGNQ>\n> .\n>\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/578493182/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/578551370","html_url":"https://github.com/apache/couchdb/pull/2492#issuecomment-578551370","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2492","id":578551370,"node_id":"MDEyOklzc3VlQ29tbWVudDU3ODU1MTM3MA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-26T22:47:39Z","updated_at":"2020-01-26T22:47:39Z","author_association":"MEMBER","body":"merging, as the world is blocked until this hits.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/578551370/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/578697538","html_url":"https://github.com/apache/couchdb/issues/2485#issuecomment-578697538","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2485","id":578697538,"node_id":"MDEyOklzc3VlQ29tbWVudDU3ODY5NzUzOA==","user":{"login":"willholley","id":97787,"node_id":"MDQ6VXNlcjk3Nzg3","avatar_url":"https://avatars.githubusercontent.com/u/97787?v=4","gravatar_id":"","url":"https://api.github.com/users/willholley","html_url":"https://github.com/willholley","followers_url":"https://api.github.com/users/willholley/followers","following_url":"https://api.github.com/users/willholley/following{/other_user}","gists_url":"https://api.github.com/users/willholley/gists{/gist_id}","starred_url":"https://api.github.com/users/willholley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/willholley/subscriptions","organizations_url":"https://api.github.com/users/willholley/orgs","repos_url":"https://api.github.com/users/willholley/repos","events_url":"https://api.github.com/users/willholley/events{/privacy}","received_events_url":"https://api.github.com/users/willholley/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-27T11:03:53Z","updated_at":"2020-01-27T11:03:53Z","author_association":"MEMBER","body":"@hamedminaee it sounds like your index is just taking some time to build. When you query a search index, the request will block until the index has completed building. If the index build does not complete within the timeout, it will fail with an error. Then on the second request the index has likely completed building and so succeeds.\r\n\r\nAre you able to confirm this by checking that the index has built prior to the first query? You can check using the [search info](https://docs.couchdb.org/en/latest/http-api.html#cap-/{db}/_design/{ddoc}/_search_info/{index}) endpoint. You could also check the logs for any timeout-related errors.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/578697538/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/578745886","html_url":"https://github.com/apache/couchdb/issues/2485#issuecomment-578745886","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2485","id":578745886,"node_id":"MDEyOklzc3VlQ29tbWVudDU3ODc0NTg4Ng==","user":{"login":"hmdevelopermind","id":52859974,"node_id":"MDQ6VXNlcjUyODU5OTc0","avatar_url":"https://avatars.githubusercontent.com/u/52859974?v=4","gravatar_id":"","url":"https://api.github.com/users/hmdevelopermind","html_url":"https://github.com/hmdevelopermind","followers_url":"https://api.github.com/users/hmdevelopermind/followers","following_url":"https://api.github.com/users/hmdevelopermind/following{/other_user}","gists_url":"https://api.github.com/users/hmdevelopermind/gists{/gist_id}","starred_url":"https://api.github.com/users/hmdevelopermind/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hmdevelopermind/subscriptions","organizations_url":"https://api.github.com/users/hmdevelopermind/orgs","repos_url":"https://api.github.com/users/hmdevelopermind/repos","events_url":"https://api.github.com/users/hmdevelopermind/events{/privacy}","received_events_url":"https://api.github.com/users/hmdevelopermind/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-27T13:27:58Z","updated_at":"2020-01-27T13:27:58Z","author_association":"NONE","body":"@willholley Thanks will. That is right before the first call there is no index. So if indexing is taking longer than the timeout what is the best way to handle it?\r\nCurrently in my code I added a check and as soon the timeout error happens I do another call to recover.\r\nWhat do you think?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/578745886/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/578750778","html_url":"https://github.com/apache/couchdb/issues/2485#issuecomment-578750778","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2485","id":578750778,"node_id":"MDEyOklzc3VlQ29tbWVudDU3ODc1MDc3OA==","user":{"login":"willholley","id":97787,"node_id":"MDQ6VXNlcjk3Nzg3","avatar_url":"https://avatars.githubusercontent.com/u/97787?v=4","gravatar_id":"","url":"https://api.github.com/users/willholley","html_url":"https://github.com/willholley","followers_url":"https://api.github.com/users/willholley/followers","following_url":"https://api.github.com/users/willholley/following{/other_user}","gists_url":"https://api.github.com/users/willholley/gists{/gist_id}","starred_url":"https://api.github.com/users/willholley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/willholley/subscriptions","organizations_url":"https://api.github.com/users/willholley/orgs","repos_url":"https://api.github.com/users/willholley/repos","events_url":"https://api.github.com/users/willholley/events{/privacy}","received_events_url":"https://api.github.com/users/willholley/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-27T13:39:43Z","updated_at":"2020-01-27T13:39:43Z","author_association":"MEMBER","body":"@hamedminaee at what point are you creating your index? The expectation is that index creation is a rare operation and would typically be handled outside of the querying code.\r\n\r\nIn terms of how you handle your index not being up to date, that's somewhat dependent on your application. If it makes sense, you could retry the query a number of times. Another option is to use the `stale` flag which will bypass the check that the index is up to date on the server, if you want a response quickly and don't mind the results potentially being out of date.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/578750778/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/578764573","html_url":"https://github.com/apache/couchdb/issues/2485#issuecomment-578764573","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2485","id":578764573,"node_id":"MDEyOklzc3VlQ29tbWVudDU3ODc2NDU3Mw==","user":{"login":"hmdevelopermind","id":52859974,"node_id":"MDQ6VXNlcjUyODU5OTc0","avatar_url":"https://avatars.githubusercontent.com/u/52859974?v=4","gravatar_id":"","url":"https://api.github.com/users/hmdevelopermind","html_url":"https://github.com/hmdevelopermind","followers_url":"https://api.github.com/users/hmdevelopermind/followers","following_url":"https://api.github.com/users/hmdevelopermind/following{/other_user}","gists_url":"https://api.github.com/users/hmdevelopermind/gists{/gist_id}","starred_url":"https://api.github.com/users/hmdevelopermind/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hmdevelopermind/subscriptions","organizations_url":"https://api.github.com/users/hmdevelopermind/orgs","repos_url":"https://api.github.com/users/hmdevelopermind/repos","events_url":"https://api.github.com/users/hmdevelopermind/events{/privacy}","received_events_url":"https://api.github.com/users/hmdevelopermind/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-27T14:12:12Z","updated_at":"2020-01-27T14:12:12Z","author_association":"NONE","body":"@willholley  Sorry I think I misunderstood your question at the beginning \r\nIn terms of index creation we create the index as soon as we insert the document to the database not at query time. \r\n```\r\n public async create(\r\n    databaseName: String) {\r\n    const status = await this._db.create(databaseName)\r\n    if (status.ok) {\r\n      const db = this._db.use(databaseName)\r\n      const docs = await db.insert(DesignDocumentGenerator.searchAll)\r\n      if (docs.ok) {\r\n        this._logger.debug({\r\n          log: \"Insert design document with STIX index\",\r\n        });\r\n        return db\r\n      }\r\n      throw \"Can't create index\"\r\n    }\r\n    throw \"Can't create database\"\r\n  }\r\n```\r\nHowever if I get that correctly the indexing process starts as soon as we query that document for the first and that is where it takes a bit of time to build the indexes.\r\nSo if thats the case does that mean that we should make a dummy get query for the inserted doc at the insertion time to initiate the indexing process rather than relying on user to make a call?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/578764573/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/578768269","html_url":"https://github.com/apache/couchdb/issues/2485#issuecomment-578768269","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2485","id":578768269,"node_id":"MDEyOklzc3VlQ29tbWVudDU3ODc2ODI2OQ==","user":{"login":"willholley","id":97787,"node_id":"MDQ6VXNlcjk3Nzg3","avatar_url":"https://avatars.githubusercontent.com/u/97787?v=4","gravatar_id":"","url":"https://api.github.com/users/willholley","html_url":"https://github.com/willholley","followers_url":"https://api.github.com/users/willholley/followers","following_url":"https://api.github.com/users/willholley/following{/other_user}","gists_url":"https://api.github.com/users/willholley/gists{/gist_id}","starred_url":"https://api.github.com/users/willholley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/willholley/subscriptions","organizations_url":"https://api.github.com/users/willholley/orgs","repos_url":"https://api.github.com/users/willholley/repos","events_url":"https://api.github.com/users/willholley/events{/privacy}","received_events_url":"https://api.github.com/users/willholley/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-27T14:18:42Z","updated_at":"2020-01-27T14:18:42Z","author_association":"MEMBER","body":"@hamedminaee indexes should be warmed in the background, though that process may not happen quickly enough for you if you're inserting a document and then immediately querying for it.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/578768269/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/578836379","html_url":"https://github.com/apache/couchdb/issues/2485#issuecomment-578836379","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2485","id":578836379,"node_id":"MDEyOklzc3VlQ29tbWVudDU3ODgzNjM3OQ==","user":{"login":"hmdevelopermind","id":52859974,"node_id":"MDQ6VXNlcjUyODU5OTc0","avatar_url":"https://avatars.githubusercontent.com/u/52859974?v=4","gravatar_id":"","url":"https://api.github.com/users/hmdevelopermind","html_url":"https://github.com/hmdevelopermind","followers_url":"https://api.github.com/users/hmdevelopermind/followers","following_url":"https://api.github.com/users/hmdevelopermind/following{/other_user}","gists_url":"https://api.github.com/users/hmdevelopermind/gists{/gist_id}","starred_url":"https://api.github.com/users/hmdevelopermind/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hmdevelopermind/subscriptions","organizations_url":"https://api.github.com/users/hmdevelopermind/orgs","repos_url":"https://api.github.com/users/hmdevelopermind/repos","events_url":"https://api.github.com/users/hmdevelopermind/events{/privacy}","received_events_url":"https://api.github.com/users/hmdevelopermind/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-27T16:39:40Z","updated_at":"2020-01-27T16:39:40Z","author_association":"NONE","body":"@willholley  so in that case if we need to quickly query the result after insertion what is the best way to handle it(if there is a way)? ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/578836379/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/578838137","html_url":"https://github.com/apache/couchdb/issues/2485#issuecomment-578838137","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2485","id":578838137,"node_id":"MDEyOklzc3VlQ29tbWVudDU3ODgzODEzNw==","user":{"login":"willholley","id":97787,"node_id":"MDQ6VXNlcjk3Nzg3","avatar_url":"https://avatars.githubusercontent.com/u/97787?v=4","gravatar_id":"","url":"https://api.github.com/users/willholley","html_url":"https://github.com/willholley","followers_url":"https://api.github.com/users/willholley/followers","following_url":"https://api.github.com/users/willholley/following{/other_user}","gists_url":"https://api.github.com/users/willholley/gists{/gist_id}","starred_url":"https://api.github.com/users/willholley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/willholley/subscriptions","organizations_url":"https://api.github.com/users/willholley/orgs","repos_url":"https://api.github.com/users/willholley/repos","events_url":"https://api.github.com/users/willholley/events{/privacy}","received_events_url":"https://api.github.com/users/willholley/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-27T16:43:15Z","updated_at":"2020-01-27T16:43:15Z","author_association":"MEMBER","body":"I'd suggest a simpler index and/or use Query (`_find` endpoint) instead for the query (indexing performance is better as it doesn't need to marshall data to JavaScript).","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/578838137/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/578936785","html_url":"https://github.com/apache/couchdb/issues/2485#issuecomment-578936785","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2485","id":578936785,"node_id":"MDEyOklzc3VlQ29tbWVudDU3ODkzNjc4NQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-27T20:26:55Z","updated_at":"2020-01-27T20:26:55Z","author_association":"MEMBER","body":"@hamedminaee Will is not correct about indexes being warmed in the background in your version of CouchDB; this is only true with Cloudant and CouchDB 3.0.0+.\r\n\r\nYou must access your index the first time if you want to build an index after creating it, in CouchDB 2.x.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/578936785/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/578984046","html_url":"https://github.com/apache/couchdb/issues/2493#issuecomment-578984046","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2493","id":578984046,"node_id":"MDEyOklzc3VlQ29tbWVudDU3ODk4NDA0Ng==","user":{"login":"kocolosk","id":16679,"node_id":"MDQ6VXNlcjE2Njc5","avatar_url":"https://avatars.githubusercontent.com/u/16679?v=4","gravatar_id":"","url":"https://api.github.com/users/kocolosk","html_url":"https://github.com/kocolosk","followers_url":"https://api.github.com/users/kocolosk/followers","following_url":"https://api.github.com/users/kocolosk/following{/other_user}","gists_url":"https://api.github.com/users/kocolosk/gists{/gist_id}","starred_url":"https://api.github.com/users/kocolosk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kocolosk/subscriptions","organizations_url":"https://api.github.com/users/kocolosk/orgs","repos_url":"https://api.github.com/users/kocolosk/repos","events_url":"https://api.github.com/users/kocolosk/events{/privacy}","received_events_url":"https://api.github.com/users/kocolosk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-27T22:23:09Z","updated_at":"2020-01-27T22:23:09Z","author_association":"MEMBER","body":"Fascinating. You said that \r\n\r\n> When I removed `couch_db:monitor(AuthDb)` line and called `gen_server:call(couch_auth_cache, reinit_cache, infinity).` in a loop in the `remsh` afterwards for the sake of testing it still created all those duplicated monitors.\r\n\r\nI can't reproduce that part on master (d59d84ac78e5). If I remove the `couch_db:monitor/1` invocation and call reinit_cache in a loop I only see the one monitor for the file descriptor at any point in time.\r\n\r\nIf, however, I leave the `couch_db:monitor/1` invocation in place I *do* see monitors piling up against the `couch_db_updater` process when I call reinit in a loop. Is it possible that those monitors were the ones you saw during your debugging, and that the `couch_file` monitors you observed in production have a different root cause?\r\n\r\nTaking a step back, it's not at all obvious to me that we still need `couch_auth_cache` as a running service, especially now that the backdoor HTTP port has been removed. I think the `chttpd_auth_cache` module is the one doing the actual user caching. I'd be curious to hear from others on the dev team, but I'm wondering if we can just shut this thing down. Reading through the code it's clear that this module hasn't kept up with the times.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/578984046/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/578994076","html_url":"https://github.com/apache/couchdb/issues/2493#issuecomment-578994076","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2493","id":578994076,"node_id":"MDEyOklzc3VlQ29tbWVudDU3ODk5NDA3Ng==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-27T22:52:27Z","updated_at":"2020-01-27T22:52:27Z","author_association":"MEMBER","body":"@kocolosk, @rnewson would know for sure when it comes to the removal of 5986 and this, but is the auth all handled by chttpd or is there a secondary check once it hits what's left of couch_httpd? if the former I concur with you.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/578994076/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/579003677","html_url":"https://github.com/apache/couchdb/issues/2437#issuecomment-579003677","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2437","id":579003677,"node_id":"MDEyOklzc3VlQ29tbWVudDU3OTAwMzY3Nw==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-27T23:22:13Z","updated_at":"2020-01-27T23:22:13Z","author_association":"CONTRIBUTOR","body":"Upstream Erlang/OTP bug filed https://bugs.erlang.org/browse/ERL-1152","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/579003677/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/579214468","html_url":"https://github.com/apache/couchdb/issues/2493#issuecomment-579214468","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2493","id":579214468,"node_id":"MDEyOklzc3VlQ29tbWVudDU3OTIxNDQ2OA==","user":{"login":"iilyak","id":9804420,"node_id":"MDQ6VXNlcjk4MDQ0MjA=","avatar_url":"https://avatars.githubusercontent.com/u/9804420?v=4","gravatar_id":"","url":"https://api.github.com/users/iilyak","html_url":"https://github.com/iilyak","followers_url":"https://api.github.com/users/iilyak/followers","following_url":"https://api.github.com/users/iilyak/following{/other_user}","gists_url":"https://api.github.com/users/iilyak/gists{/gist_id}","starred_url":"https://api.github.com/users/iilyak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/iilyak/subscriptions","organizations_url":"https://api.github.com/users/iilyak/orgs","repos_url":"https://api.github.com/users/iilyak/repos","events_url":"https://api.github.com/users/iilyak/events{/privacy}","received_events_url":"https://api.github.com/users/iilyak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-28T12:05:41Z","updated_at":"2020-01-28T12:05:41Z","author_association":"CONTRIBUTOR","body":"Which version of erlang you are running. The reason I ask because there was a major issue with behavior of monitor/demonitor feature in 20.3.8.5 ([see ERL-751](https://bugs.erlang.org/browse/ERL-751))","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/579214468/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/579325741","html_url":"https://github.com/apache/couchdb/issues/2485#issuecomment-579325741","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2485","id":579325741,"node_id":"MDEyOklzc3VlQ29tbWVudDU3OTMyNTc0MQ==","user":{"login":"kocolosk","id":16679,"node_id":"MDQ6VXNlcjE2Njc5","avatar_url":"https://avatars.githubusercontent.com/u/16679?v=4","gravatar_id":"","url":"https://api.github.com/users/kocolosk","html_url":"https://github.com/kocolosk","followers_url":"https://api.github.com/users/kocolosk/followers","following_url":"https://api.github.com/users/kocolosk/following{/other_user}","gists_url":"https://api.github.com/users/kocolosk/gists{/gist_id}","starred_url":"https://api.github.com/users/kocolosk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kocolosk/subscriptions","organizations_url":"https://api.github.com/users/kocolosk/orgs","repos_url":"https://api.github.com/users/kocolosk/repos","events_url":"https://api.github.com/users/kocolosk/events{/privacy}","received_events_url":"https://api.github.com/users/kocolosk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-28T16:08:06Z","updated_at":"2020-01-28T16:08:06Z","author_association":"MEMBER","body":"@wohali it looks like @hamedminaee is running a build of 8ac108a, which should include the automatic index warming. I don't see any bug fixes in master after that commit.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/579325741/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/579370645","html_url":"https://github.com/apache/couchdb/issues/2493#issuecomment-579370645","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2493","id":579370645,"node_id":"MDEyOklzc3VlQ29tbWVudDU3OTM3MDY0NQ==","user":{"login":"AlexanderKaraberov","id":3254818,"node_id":"MDQ6VXNlcjMyNTQ4MTg=","avatar_url":"https://avatars.githubusercontent.com/u/3254818?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexanderKaraberov","html_url":"https://github.com/AlexanderKaraberov","followers_url":"https://api.github.com/users/AlexanderKaraberov/followers","following_url":"https://api.github.com/users/AlexanderKaraberov/following{/other_user}","gists_url":"https://api.github.com/users/AlexanderKaraberov/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexanderKaraberov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexanderKaraberov/subscriptions","organizations_url":"https://api.github.com/users/AlexanderKaraberov/orgs","repos_url":"https://api.github.com/users/AlexanderKaraberov/repos","events_url":"https://api.github.com/users/AlexanderKaraberov/events{/privacy}","received_events_url":"https://api.github.com/users/AlexanderKaraberov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-28T17:43:36Z","updated_at":"2020-01-28T17:55:07Z","author_association":"CONTRIBUTOR","body":"Hello @kocolosk, and thank you for a fast reply!\r\n\r\n>  If I remove the couch_db:monitor/1 invocation and call reinit_cache in a loop I only see the one monitor for the file descriptor at any point in time.\r\n\r\nUnfortunately this is not a case for me. I'm not running current `master` however I've compared a version of `couch_auth_cache` from our `2.3.0` fork with the current `master` and there are no differences. So here's a normal scenario when I've only launched CouchDB server:\r\n<img width=\"688\" alt=\"standard\" src=\"https://user-images.githubusercontent.com/3254818/73288725-cd965680-41fb-11ea-802e-c932675dc23a.png\">\r\n\r\nYou might see that there are two monitors currently active for the `couch_auth_cache` process, one is `couch_file` (`<0.320.0>`) and one is `couch_db_updater` (`<0.319.0>`). Now I repeatedly call `reinit_cache` and both of those monitors are duplicated each time:\r\n\r\n<img width=\"393\" alt=\"dupes\" src=\"https://user-images.githubusercontent.com/3254818/73289187-8bb9e000-41fc-11ea-9d73-1602aea1626f.png\">\r\n\r\nNow when I remove the `couch_db:monitor/1` invocation and repeat the same procedure again I can see that only `couch_file` monitors are duplicated:\r\n\r\n<img width=\"478\" alt=\"couch_file\" src=\"https://user-images.githubusercontent.com/3254818/73289427-fbc86600-41fc-11ea-989b-16b89391d7d7.png\">\r\n\r\nIn fact this matches with what I've seen on our production nodes where there were only `couch_file` monitors duplicates (several million of them) but no duplicated `couch_db_updater` monitors.\r\n\r\n>  Is it possible that those monitors were the ones you saw during your debugging, and that the couch_file monitors you observed in production have a different root cause?\r\n\r\nI'm not fully excluding this possibility. However one interesting correlation as per my first post is that accumulating of these monitors and subsequent slow `pread_iolist` calls exactly correspond to a spike in `couchdb.auth_cache_misses`. What else could trigger this if not a cold cache?\r\n\r\nPotentially I'm missing some changes between `master` and 2.3.0 which addressed this issue?\r\n\r\n> Taking a step back, it's not at all obvious to me that we still need couch_auth_cache as a running service, especially now that the backdoor HTTP port has been removed. \r\n\r\nThis is actually great news. If someone from the dev team can indeed confirm that I can shutdown this process safely without any impact it would be wonderful. I'm no so interested in fixing the root cause of this especially taking into consideration that this is an outdated (legacy) module. I merely don't want this issue to return.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/579370645/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/579371506","html_url":"https://github.com/apache/couchdb/issues/2493#issuecomment-579371506","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2493","id":579371506,"node_id":"MDEyOklzc3VlQ29tbWVudDU3OTM3MTUwNg==","user":{"login":"AlexanderKaraberov","id":3254818,"node_id":"MDQ6VXNlcjMyNTQ4MTg=","avatar_url":"https://avatars.githubusercontent.com/u/3254818?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexanderKaraberov","html_url":"https://github.com/AlexanderKaraberov","followers_url":"https://api.github.com/users/AlexanderKaraberov/followers","following_url":"https://api.github.com/users/AlexanderKaraberov/following{/other_user}","gists_url":"https://api.github.com/users/AlexanderKaraberov/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexanderKaraberov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexanderKaraberov/subscriptions","organizations_url":"https://api.github.com/users/AlexanderKaraberov/orgs","repos_url":"https://api.github.com/users/AlexanderKaraberov/repos","events_url":"https://api.github.com/users/AlexanderKaraberov/events{/privacy}","received_events_url":"https://api.github.com/users/AlexanderKaraberov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-28T17:45:45Z","updated_at":"2020-01-28T17:45:45Z","author_association":"CONTRIBUTOR","body":"Hello @iilyak ,\r\n\r\nSome servers are running `21.3.8.8` and some `21.3.8.11` so that bug shouldn't be related.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/579371506/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/579458016","html_url":"https://github.com/apache/couchdb/pull/2456#issuecomment-579458016","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2456","id":579458016,"node_id":"MDEyOklzc3VlQ29tbWVudDU3OTQ1ODAxNg==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-28T21:12:10Z","updated_at":"2020-01-28T21:12:10Z","author_association":"MEMBER","body":"I finally had some downtime to start looking into this more closely. So far I've only spent a couple hours reading through and thinking about things so hopefully this comes out semi-coherently.\r\n\r\nSo far I'm just focusing on the skiplist implementation. First off, as @chewbranca's confusion points out, we should probably scrub all references to skiplists because these are different enough that it'll just lead to confusion when people attempt to compare them. I'd at least mention RankedSets and include links to the Java implementation in fdb-record-layer [1]. RankedSets is a bit overly specific given we've got arbitrary reduce functions. But maybe `reduced_sets` would be good enough?\r\n\r\nI started reading on the update side of things first and it looks like you've basically nailed it. I think we should change around a few definitions though. If we refer to the map index's key/value pairs as level 0 and then keep the rest as written we'll have covered custom javascript reduce functions and all of the builtin reduce functions. Which is way more awesome than when I was thinking we were going to have to invent some sort of un-reduce function which would have been super error prone. Brilliant work there!\r\n\r\nThe query/traversal side of things is going to need some work. I think there's a bit of confusion around how group levels work that got mixed into the traversal code. To simplify the implementation and development here you should write a function that will correctly answer a group=true query with a start and end key. Once you have an implementation of that function, turning it into a `foldl` style API will be straightforward. And then once you have that API you'll basically just be copying the group logic from couch_btree. The algorithm that @chewbranca sketched should be a good starting place here.\r\n\r\nOnce you've got all that done, adding the removal logic is as simple as cribbing off the Java `RankedSet.remove` method.\r\n\r\nThat's about it from me for now. Good work!\r\n\r\n[1] https://github.com/FoundationDB/fdb-record-layer/blob/master/fdb-extensions/src/main/java/com/apple/foundationdb/async/RankedSet.java","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/579458016/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/579461875","html_url":"https://github.com/apache/couchdb/pull/2456#issuecomment-579461875","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2456","id":579461875,"node_id":"MDEyOklzc3VlQ29tbWVudDU3OTQ2MTg3NQ==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-28T21:21:18Z","updated_at":"2020-01-28T21:24:47Z","author_association":"MEMBER","body":"Also I should have mentioned, that algorithmically the example that @chewbranca wrote is a good starting place. @garrensmith is quite right that we'll have to worry about RAM usage and what not. Eventually, the `fdb_range_query` part will be limited in the number of rows returned and then we'll have to handle that complication. However, for the first pass I'd ignore those concerns and write it as simply as currently sketched.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/579461875/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/579463531","html_url":"https://github.com/apache/couchdb/issues/2441#issuecomment-579463531","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2441","id":579463531,"node_id":"MDEyOklzc3VlQ29tbWVudDU3OTQ2MzUzMQ==","user":{"login":"noahbailey","id":43625401,"node_id":"MDQ6VXNlcjQzNjI1NDAx","avatar_url":"https://avatars.githubusercontent.com/u/43625401?v=4","gravatar_id":"","url":"https://api.github.com/users/noahbailey","html_url":"https://github.com/noahbailey","followers_url":"https://api.github.com/users/noahbailey/followers","following_url":"https://api.github.com/users/noahbailey/following{/other_user}","gists_url":"https://api.github.com/users/noahbailey/gists{/gist_id}","starred_url":"https://api.github.com/users/noahbailey/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/noahbailey/subscriptions","organizations_url":"https://api.github.com/users/noahbailey/orgs","repos_url":"https://api.github.com/users/noahbailey/repos","events_url":"https://api.github.com/users/noahbailey/events{/privacy}","received_events_url":"https://api.github.com/users/noahbailey/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-28T21:25:23Z","updated_at":"2020-01-28T21:25:23Z","author_association":"NONE","body":"I have a very similar issue, also on 2.3.1 but on Ubuntu 16.04 and 18.04 virtual machines. \r\nThe memory usage grows for several weeks before it crashes for about 3 seconds and restarts the service. It's completely recoverable (at least for us) and doesn't cause any sort of outage but it is concerning. \r\n\r\n![Screenshot_20200128_162359](https://user-images.githubusercontent.com/43625401/73306665-b13dee00-41ea-11ea-8373-45f51188b370.png)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/579463531/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/579505404","html_url":"https://github.com/apache/couchdb/issues/2493#issuecomment-579505404","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2493","id":579505404,"node_id":"MDEyOklzc3VlQ29tbWVudDU3OTUwNTQwNA==","user":{"login":"kocolosk","id":16679,"node_id":"MDQ6VXNlcjE2Njc5","avatar_url":"https://avatars.githubusercontent.com/u/16679?v=4","gravatar_id":"","url":"https://api.github.com/users/kocolosk","html_url":"https://github.com/kocolosk","followers_url":"https://api.github.com/users/kocolosk/followers","following_url":"https://api.github.com/users/kocolosk/following{/other_user}","gists_url":"https://api.github.com/users/kocolosk/gists{/gist_id}","starred_url":"https://api.github.com/users/kocolosk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kocolosk/subscriptions","organizations_url":"https://api.github.com/users/kocolosk/orgs","repos_url":"https://api.github.com/users/kocolosk/repos","events_url":"https://api.github.com/users/kocolosk/events{/privacy}","received_events_url":"https://api.github.com/users/kocolosk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-28T22:51:10Z","updated_at":"2020-01-28T22:51:10Z","author_association":"MEMBER","body":"Reviewing the code it seemed to me that `couch_auth_cache` was safe to remove as a running service, so that’s what I did in #2498. I had to disable a few tests that were written to run against the “backdoor” port, but didn’t see any issues with the rest of the test suite. If you feel like cherry-picking f4356a32d37e0c26b1423026bd17fc0c94c6dcb5 I suspect you can do so safely","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/579505404/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/579573119","html_url":"https://github.com/apache/couchdb/pull/2400#issuecomment-579573119","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2400","id":579573119,"node_id":"MDEyOklzc3VlQ29tbWVudDU3OTU3MzExOQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-29T03:14:20Z","updated_at":"2020-01-29T03:14:20Z","author_association":"MEMBER","body":"@davisp think I collided with a couple of yours here, can you help revisit?\r\n\r\nLet's take the upstream/master discussion to dev@ since it seems to have blindsided @iilyak (Sorry about that, Ilya!)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/579573119/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/579592896","html_url":"https://github.com/apache/couchdb/issues/2500#issuecomment-579592896","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2500","id":579592896,"node_id":"MDEyOklzc3VlQ29tbWVudDU3OTU5Mjg5Ng==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-29T04:58:59Z","updated_at":"2020-01-29T04:58:59Z","author_association":"MEMBER","body":"Needless to say this also extends to being able to access a ddoc shard, e.g. `GET /_node/{nodename}/{db-shard}/{ddoc}/_info`.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/579592896/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/579656736","html_url":"https://github.com/apache/couchdb/issues/2493#issuecomment-579656736","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2493","id":579656736,"node_id":"MDEyOklzc3VlQ29tbWVudDU3OTY1NjczNg==","user":{"login":"AlexanderKaraberov","id":3254818,"node_id":"MDQ6VXNlcjMyNTQ4MTg=","avatar_url":"https://avatars.githubusercontent.com/u/3254818?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexanderKaraberov","html_url":"https://github.com/AlexanderKaraberov","followers_url":"https://api.github.com/users/AlexanderKaraberov/followers","following_url":"https://api.github.com/users/AlexanderKaraberov/following{/other_user}","gists_url":"https://api.github.com/users/AlexanderKaraberov/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexanderKaraberov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexanderKaraberov/subscriptions","organizations_url":"https://api.github.com/users/AlexanderKaraberov/orgs","repos_url":"https://api.github.com/users/AlexanderKaraberov/repos","events_url":"https://api.github.com/users/AlexanderKaraberov/events{/privacy}","received_events_url":"https://api.github.com/users/AlexanderKaraberov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-29T08:54:21Z","updated_at":"2020-01-29T10:01:10Z","author_association":"CONTRIBUTOR","body":"Thanks! This looks good to me. I'll give it a try","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/579656736/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/579705033","html_url":"https://github.com/apache/couchdb/issues/2493#issuecomment-579705033","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2493","id":579705033,"node_id":"MDEyOklzc3VlQ29tbWVudDU3OTcwNTAzMw==","user":{"login":"AlexanderKaraberov","id":3254818,"node_id":"MDQ6VXNlcjMyNTQ4MTg=","avatar_url":"https://avatars.githubusercontent.com/u/3254818?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexanderKaraberov","html_url":"https://github.com/AlexanderKaraberov","followers_url":"https://api.github.com/users/AlexanderKaraberov/followers","following_url":"https://api.github.com/users/AlexanderKaraberov/following{/other_user}","gists_url":"https://api.github.com/users/AlexanderKaraberov/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexanderKaraberov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexanderKaraberov/subscriptions","organizations_url":"https://api.github.com/users/AlexanderKaraberov/orgs","repos_url":"https://api.github.com/users/AlexanderKaraberov/repos","events_url":"https://api.github.com/users/AlexanderKaraberov/events{/privacy}","received_events_url":"https://api.github.com/users/AlexanderKaraberov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-29T11:04:04Z","updated_at":"2020-01-29T11:20:22Z","author_association":"CONTRIBUTOR","body":"I will close this ticket because the linked PR will prevent my issue from happening again in future, and I'm glad to hear that `couch_auth_cache` will be removed soon. Feel free to reopen if you have some additional insights or piece of advice.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/579705033/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/579814053","html_url":"https://github.com/apache/couchdb/issues/2500#issuecomment-579814053","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2500","id":579814053,"node_id":"MDEyOklzc3VlQ29tbWVudDU3OTgxNDA1Mw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-29T15:33:32Z","updated_at":"2020-01-29T15:33:32Z","author_association":"MEMBER","body":"Looks like we're not parsing the URL sufficiently intelligently to support this, per the logfile:\r\n\r\n```\r\nerror] 2020-01-29T15:32:02.998063Z node1@127.0.0.1 <0.1421.0> -------- Could not open file /home/joant/couchdb/dev/lib/node1/data/shards.couch: no such file or directory\r\n[notice] 2020-01-29T15:32:02.999013Z node1@127.0.0.1 <0.1385.0> 208178fff9 localhost:15984 127.0.0.1 admin GET /_node/_local/shards/00000000-7fffffff/abc.1580273428 404 ok 5\r\n[info] 2020-01-29T15:32:02.999583Z node1@127.0.0.1 <0.1420.0> -------- open_result error {not_found,no_db_file} for shards\r\n[error] 2020-01-29T15:32:10.914265Z node1@127.0.0.1 <0.1559.0> -------- Could not open file /home/joant/couchdb/dev/lib/node1/data/shards.couch: no such file or directory\r\n[info] 2020-01-29T15:32:10.914852Z node1@127.0.0.1 <0.1558.0> -------- open_result error {not_found,no_db_file} for shards\r\n[notice] 2020-01-29T15:32:10.915021Z node1@127.0.0.1 <0.1519.0> e92985c5e2 localhost:15984 127.0.0.1 admin GET /_node/_local/shards%2f00000000-7fffffff%2fabc.1580273428 404 ok 4\r\n```\r\n\r\nI'll see if I can work around this.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/579814053/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/579903872","html_url":"https://github.com/apache/couchdb/issues/2218#issuecomment-579903872","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2218","id":579903872,"node_id":"MDEyOklzc3VlQ29tbWVudDU3OTkwMzg3Mg==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-29T18:50:34Z","updated_at":"2020-01-29T18:50:34Z","author_association":"MEMBER","body":"All done!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/579903872/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/579904846","html_url":"https://github.com/apache/couchdb/issues/2423#issuecomment-579904846","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2423","id":579904846,"node_id":"MDEyOklzc3VlQ29tbWVudDU3OTkwNDg0Ng==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-29T18:52:59Z","updated_at":"2020-01-29T18:52:59Z","author_association":"MEMBER","body":"Tentatively closing this. I'm seeing various failures, esp. in `mem3`, but these don't appear to be SM60 related anymore.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/579904846/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/579968760","html_url":"https://github.com/apache/couchdb/pull/2502#issuecomment-579968760","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2502","id":579968760,"node_id":"MDEyOklzc3VlQ29tbWVudDU3OTk2ODc2MA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-29T21:30:17Z","updated_at":"2020-01-29T21:30:17Z","author_association":"MEMBER","body":"@nickva For posterity, as I said on IRC, this endpoint is only to support what we need for admin purposes. Right now that's inspecting the top-level of a shard, as well the system databases. I'd like to add support for looking at view shard _info objects, but it's not a 3.0 blocker.\r\n\r\nWhat I'll do is see if we can just return an error when trying to retrieve attachments via this interface, rather than trying to support them for unknown purposes.\r\n\r\nTomorrow.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/579968760/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/579990854","html_url":"https://github.com/apache/couchdb/pull/2502#issuecomment-579990854","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2502","id":579990854,"node_id":"MDEyOklzc3VlQ29tbWVudDU3OTk5MDg1NA==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-29T22:27:04Z","updated_at":"2020-01-29T22:27:04Z","author_association":"CONTRIBUTOR","body":"@wohali pushed a fix, it turned out not as bad as I suspected\r\n\r\n```\r\nhttp  $DB/_node/_local/shards%2f80000000-ffffffff%2fdeebee.1580329759/dok2/att1\r\n\r\n{\r\n    \"x\": \"y\"\r\n}\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/579990854/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/580151284","html_url":"https://github.com/apache/couchdb/pull/1927#issuecomment-580151284","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1927","id":580151284,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MDE1MTI4NA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-30T09:01:16Z","updated_at":"2020-01-30T09:01:16Z","author_association":"MEMBER","body":"@dch Hey, I'm sorry, I've run out of steam on this - the code seems broken in a fundamental way that makes the results of `make dist` uncompilable, even after my latest pushed change.\r\n\r\n`rebar` keeps complaining from the result that it thinks it's in git, but isn't.\r\n\r\nI think I'm going to punt on this for the 3.0.0 RCs, unless you have time to look. Let me know in the next 24 hours or I'll be removing this from the 3.0.0 worklist.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/580151284/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/580153142","html_url":"https://github.com/apache/couchdb/pull/2502#issuecomment-580153142","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2502","id":580153142,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MDE1MzE0Mg==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-30T09:05:49Z","updated_at":"2020-01-30T09:05:49Z","author_association":"MEMBER","body":"Going to hold this for another 1-2 days to see if I can't get in the ability to inspect specific view shards, not just the view shard that hosts the ddoc itself. If I can't manage that, I'll merge this as is.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/580153142/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/580797432","html_url":"https://github.com/apache/couchdb/pull/2504#issuecomment-580797432","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2504","id":580797432,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MDc5NzQzMg==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-31T16:12:16Z","updated_at":"2020-01-31T16:12:16Z","author_association":"MEMBER","body":"@big-r81 Does this change still work for starting CouchDB from symlinks?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/580797432/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/580800733","html_url":"https://github.com/apache/couchdb/pull/2504#issuecomment-580800733","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2504","id":580800733,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MDgwMDczMw==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-31T16:19:12Z","updated_at":"2020-01-31T16:21:52Z","author_association":"MEMBER","body":"I did test the exact sequence from the original PR that @big-r81 posted and that worked just fine :)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/580800733/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/580802331","html_url":"https://github.com/apache/couchdb/pull/2504#issuecomment-580802331","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2504","id":580802331,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MDgwMjMzMQ==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-31T16:22:22Z","updated_at":"2020-01-31T16:22:22Z","author_association":"MEMBER","body":"@wohali starting CouchDB from not the system service is rather rare on windows, would not worry too much about it","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/580802331/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/580807494","html_url":"https://github.com/apache/couchdb/pull/2400#issuecomment-580807494","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2400","id":580807494,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MDgwNzQ5NA==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-31T16:33:03Z","updated_at":"2020-01-31T16:33:03Z","author_association":"MEMBER","body":"Its just b64url and jiffy that are changed now.\r\n\r\n@kocolosk I undid the ioq upgrade because @wohali said you wanted to hold off on that.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/580807494/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/580831456","html_url":"https://github.com/apache/couchdb/pull/1927#issuecomment-580831456","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1927","id":580831456,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MDgzMTQ1Ng==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-31T17:32:51Z","updated_at":"2020-01-31T17:32:51Z","author_association":"MEMBER","body":"Replaced by #2506.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/580831456/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/580854297","html_url":"https://github.com/apache/couchdb/pull/2507#issuecomment-580854297","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2507","id":580854297,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MDg1NDI5Nw==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-31T18:30:45Z","updated_at":"2020-01-31T18:30:45Z","author_association":"MEMBER","body":"Moved this commit to #2400\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/580854297/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/580970757","html_url":"https://github.com/apache/couchdb/pull/2502#issuecomment-580970757","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2502","id":580970757,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MDk3MDc1Nw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-01T00:51:57Z","updated_at":"2020-02-01T00:51:57Z","author_association":"MEMBER","body":"Big thanks to @kocolosk who nudged me in the right direction on IRC for per-view-shard endpoint exposure. Like @nickva 's change, it turned out to be very little code to support this.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/580970757/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/580976739","html_url":"https://github.com/apache/couchdb/pull/2486#issuecomment-580976739","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2486","id":580976739,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MDk3NjczOQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-01T01:41:34Z","updated_at":"2020-02-01T01:41:34Z","author_association":"MEMBER","body":"Hrm, why did this merge without triggering the `python-black` failure that required #2505 to land?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/580976739/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/581139740","html_url":"https://github.com/apache/couchdb/issues/1499#issuecomment-581139740","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1499","id":581139740,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MTEzOTc0MA==","user":{"login":"rdewolff","id":130704,"node_id":"MDQ6VXNlcjEzMDcwNA==","avatar_url":"https://avatars.githubusercontent.com/u/130704?v=4","gravatar_id":"","url":"https://api.github.com/users/rdewolff","html_url":"https://github.com/rdewolff","followers_url":"https://api.github.com/users/rdewolff/followers","following_url":"https://api.github.com/users/rdewolff/following{/other_user}","gists_url":"https://api.github.com/users/rdewolff/gists{/gist_id}","starred_url":"https://api.github.com/users/rdewolff/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdewolff/subscriptions","organizations_url":"https://api.github.com/users/rdewolff/orgs","repos_url":"https://api.github.com/users/rdewolff/repos","events_url":"https://api.github.com/users/rdewolff/events{/privacy}","received_events_url":"https://api.github.com/users/rdewolff/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-02T14:15:23Z","updated_at":"2020-02-02T14:15:23Z","author_association":"NONE","body":"It would be amazing to see GraphQL support to CouchDB!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/581139740/reactions","total_count":15,"+1":15,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/581418890","html_url":"https://github.com/apache/couchdb/issues/2449#issuecomment-581418890","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2449","id":581418890,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MTQxODg5MA==","user":{"login":"jiangphcn","id":18000622,"node_id":"MDQ6VXNlcjE4MDAwNjIy","avatar_url":"https://avatars.githubusercontent.com/u/18000622?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangphcn","html_url":"https://github.com/jiangphcn","followers_url":"https://api.github.com/users/jiangphcn/followers","following_url":"https://api.github.com/users/jiangphcn/following{/other_user}","gists_url":"https://api.github.com/users/jiangphcn/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangphcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangphcn/subscriptions","organizations_url":"https://api.github.com/users/jiangphcn/orgs","repos_url":"https://api.github.com/users/jiangphcn/repos","events_url":"https://api.github.com/users/jiangphcn/events{/privacy}","received_events_url":"https://api.github.com/users/jiangphcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-03T13:41:33Z","updated_at":"2020-02-03T13:41:33Z","author_association":"CONTRIBUTOR","body":"hi @wohali Due to Chinese Spring festival and spread of nCoV, I just got the box to be able to access to internet today. \r\n\r\nAfter installing `docker` and pulling image `couchdbdev/ppc64le-debian-buster-erlang-20.3.8.24-1`, I am able to perform ppc64le-related test in this box.\r\n\r\n```\r\njenkins@86d57457b2e4:~/couchdb$ uname -a\r\nLinux 86d57457b2e4 4.15.0-20-generic #21-Ubuntu SMP Tue Apr 24 06:14:44 UTC 2018 ppc64le GNU/Linux\r\n```\r\nSo far, soak test looks to be fine when keeping running `while true; do make javascript; done`.  This lasts about 3+ hours.\r\n\r\n```\r\ntest/javascript/tests/all_docs.js                              ported to elixir\r\ntest/javascript/tests/attachment_names.js                      ported to elixir\r\ntest/javascript/tests/attachment_paths.js                      ported to elixir\r\ntest/javascript/tests/attachment_ranges.js                     ported to elixir\r\ntest/javascript/tests/attachment_views.js                      ported to elixir\r\ntest/javascript/tests/attachments.js                           ported to elixir\r\ntest/javascript/tests/attachments_multipart.js                 ported to elixir\r\ntest/javascript/tests/auth_cache.js                            ported to elixir\r\ntest/javascript/tests/basics.js                                ported to elixir\r\ntest/javascript/tests/batch_save.js                            ported to elixir\r\ntest/javascript/tests/bulk_docs.js                             ported to elixir\r\ntest/javascript/tests/changes.js                               pass\r\ntest/javascript/tests/coffee.js                                ported to elixir\r\ntest/javascript/tests/compact.js                               ported to elixir\r\ntest/javascript/tests/config.js                                ported to elixir\r\ntest/javascript/tests/conflicts.js                             ported to elixir\r\ntest/javascript/tests/cookie_auth.js                           ported to elixir\r\ntest/javascript/tests/copy_doc.js                              ported to elixir\r\ntest/javascript/tests/design_docs.js                           pass\r\ntest/javascript/tests/design_docs_query.js                     pass\r\ntest/javascript/tests/design_options.js                        pass\r\ntest/javascript/tests/design_paths.js                          pass\r\ntest/javascript/tests/erlang_views.js                          pass\r\ntest/javascript/tests/etags_head.js                            ported to elixir\r\ntest/javascript/tests/etags_views.js                           skipped\r\ntest/javascript/tests/form_submit.js                           pass\r\ntest/javascript/tests/http.js                                  pass\r\ntest/javascript/tests/invalid_docids.js                        ported to elixir\r\ntest/javascript/tests/jsonp.js                                 pass\r\ntest/javascript/tests/large_docs.js                            ported to elixir\r\ntest/javascript/tests/list_views.js                            pass\r\ntest/javascript/tests/lots_of_docs.js                          ported to elixir\r\ntest/javascript/tests/method_override.js                       pass\r\ntest/javascript/tests/multiple_rows.js                         ported to elixir\r\ntest/javascript/tests/proxyauth.js                             pass\r\ntest/javascript/tests/purge.js                                 pass\r\ntest/javascript/tests/reader_acl.js                            pass\r\ntest/javascript/tests/recreate_doc.js                          pass\r\ntest/javascript/tests/reduce.js                                ported to elixir\r\ntest/javascript/tests/reduce_builtin.js                        pass\r\ntest/javascript/tests/reduce_false.js                          pass\r\ntest/javascript/tests/reduce_false_temp.js                     pass\r\ntest/javascript/tests/replicator_db_bad_rep_id.js              pass\r\ntest/javascript/tests/replicator_db_by_doc_id.js               pass\r\ntest/javascript/tests/replicator_db_compact_rep_db.js          skipped\r\ntest/javascript/tests/replicator_db_continuous.js              skipped\r\ntest/javascript/tests/replicator_db_credential_delegation.js   skipped\r\ntest/javascript/tests/replicator_db_field_validation.js        skipped\r\ntest/javascript/tests/replicator_db_filtered.js                skipped\r\ntest/javascript/tests/replicator_db_identical.js               skipped\r\ntest/javascript/tests/replicator_db_identical_continuous.js    skipped\r\ntest/javascript/tests/replicator_db_invalid_filter.js          skipped\r\ntest/javascript/tests/replicator_db_security.js                skipped\r\ntest/javascript/tests/replicator_db_simple.js                  skipped\r\ntest/javascript/tests/replicator_db_successive.js              skipped\r\ntest/javascript/tests/replicator_db_survives.js                skipped\r\ntest/javascript/tests/replicator_db_swap_rep_db.js             skipped\r\ntest/javascript/tests/replicator_db_update_security.js         skipped\r\ntest/javascript/tests/replicator_db_user_ctx.js                skipped\r\ntest/javascript/tests/replicator_db_write_auth.js              skipped\r\ntest/javascript/tests/rev_stemming.js                          pass\r\ntest/javascript/tests/rewrite.js                               pass\r\ntest/javascript/tests/rewrite_js.js                            pass\r\ntest/javascript/tests/security_validation.js                   pass\r\ntest/javascript/tests/show_documents.js                        pass\r\ntest/javascript/tests/stats.js                                 skipped\r\ntest/javascript/tests/update_documents.js                      pass\r\ntest/javascript/tests/users_db.js                              ported to elixir\r\ntest/javascript/tests/users_db_security.js                     pass\r\ntest/javascript/tests/utf8.js                                  ported to elixir\r\ntest/javascript/tests/uuids.js                                 ported to elixir\r\ntest/javascript/tests/view_collation.js                        ported to elixir\r\ntest/javascript/tests/view_collation_raw.js                    pass\r\ntest/javascript/tests/view_compaction.js                       pass\r\ntest/javascript/tests/view_conflicts.js                        pass\r\ntest/javascript/tests/view_errors.js                           pass\r\ntest/javascript/tests/view_include_docs.js                     pass\r\ntest/javascript/tests/view_multi_key_all_docs.js               pass\r\ntest/javascript/tests/view_multi_key_design.js                 pass\r\ntest/javascript/tests/view_multi_key_temp.js                   pass\r\ntest/javascript/tests/view_offsets.js                          pass\r\ntest/javascript/tests/view_pagination.js                       pass\r\ntest/javascript/tests/view_sandboxing.js                       pass\r\ntest/javascript/tests/view_update_seq.js                       pass\r\n=======================================================\r\nJavaScript tests complete.\r\n  Failed: 0.  Skipped or passed: 84.\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/581418890/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/581476973","html_url":"https://github.com/apache/couchdb/pull/2515#issuecomment-581476973","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2515","id":581476973,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MTQ3Njk3Mw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-03T15:45:23Z","updated_at":"2020-02-03T15:45:23Z","author_association":"MEMBER","body":"@willholley Will you be able to assist with https://github.com/apache/couchdb-documentation/issues/493 as well?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/581476973/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]