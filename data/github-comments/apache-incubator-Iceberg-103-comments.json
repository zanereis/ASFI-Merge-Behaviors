[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/889048483","html_url":"https://github.com/apache/iceberg/issues/2889#issuecomment-889048483","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2889","id":889048483,"node_id":"IC_kwDOCW7NX840_c2j","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-29T11:44:44Z","updated_at":"2021-07-29T11:44:44Z","author_association":"MEMBER","body":"I think this merged [PR](https://github.com/apache/iceberg/pull/2410) can help you experience the flink + iceberg CDC integration work.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/889048483/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/889126183","html_url":"https://github.com/apache/iceberg/issues/2870#issuecomment-889126183","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2870","id":889126183,"node_id":"IC_kwDOCW7NX840_v0n","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-29T13:05:07Z","updated_at":"2021-07-29T13:05:07Z","author_association":"MEMBER","body":"Closed via #2875 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/889126183/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/889262287","html_url":"https://github.com/apache/iceberg/pull/2782#issuecomment-889262287","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2782","id":889262287,"node_id":"IC_kwDOCW7NX841ARDP","user":{"login":"ayushchauhan0811","id":10010065,"node_id":"MDQ6VXNlcjEwMDEwMDY1","avatar_url":"https://avatars.githubusercontent.com/u/10010065?v=4","gravatar_id":"","url":"https://api.github.com/users/ayushchauhan0811","html_url":"https://github.com/ayushchauhan0811","followers_url":"https://api.github.com/users/ayushchauhan0811/followers","following_url":"https://api.github.com/users/ayushchauhan0811/following{/other_user}","gists_url":"https://api.github.com/users/ayushchauhan0811/gists{/gist_id}","starred_url":"https://api.github.com/users/ayushchauhan0811/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ayushchauhan0811/subscriptions","organizations_url":"https://api.github.com/users/ayushchauhan0811/orgs","repos_url":"https://api.github.com/users/ayushchauhan0811/repos","events_url":"https://api.github.com/users/ayushchauhan0811/events{/privacy}","received_events_url":"https://api.github.com/users/ayushchauhan0811/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-29T15:52:07Z","updated_at":"2021-07-29T15:52:07Z","author_association":"NONE","body":"@RussellSpitzer What are your thoughts on this?  ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/889262287/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/889264234","html_url":"https://github.com/apache/iceberg/pull/2782#issuecomment-889264234","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2782","id":889264234,"node_id":"IC_kwDOCW7NX841ARhq","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-29T15:54:37Z","updated_at":"2021-07-29T15:58:32Z","author_association":"MEMBER","body":"This is close to the approach being worked on in the StructuredStreaming project, so rather than supporting all operations we just ignore the ones we can't reasonably handle. https://github.com/apache/iceberg/pull/2752 https://github.com/apache/iceberg/issues/2788\r\n\r\nI think it makes sense to allow a similar thing here.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/889264234/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/889271554","html_url":"https://github.com/apache/iceberg/pull/2782#issuecomment-889271554","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2782","id":889271554,"node_id":"IC_kwDOCW7NX841ATUC","user":{"login":"ayushchauhan0811","id":10010065,"node_id":"MDQ6VXNlcjEwMDEwMDY1","avatar_url":"https://avatars.githubusercontent.com/u/10010065?v=4","gravatar_id":"","url":"https://api.github.com/users/ayushchauhan0811","html_url":"https://github.com/ayushchauhan0811","followers_url":"https://api.github.com/users/ayushchauhan0811/followers","following_url":"https://api.github.com/users/ayushchauhan0811/following{/other_user}","gists_url":"https://api.github.com/users/ayushchauhan0811/gists{/gist_id}","starred_url":"https://api.github.com/users/ayushchauhan0811/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ayushchauhan0811/subscriptions","organizations_url":"https://api.github.com/users/ayushchauhan0811/orgs","repos_url":"https://api.github.com/users/ayushchauhan0811/repos","events_url":"https://api.github.com/users/ayushchauhan0811/events{/privacy}","received_events_url":"https://api.github.com/users/ayushchauhan0811/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-29T16:03:26Z","updated_at":"2021-07-29T16:03:26Z","author_association":"NONE","body":"yes make sense, we can follow the same approach here too. I will update the PR and work on updating tests too ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/889271554/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/889460164","html_url":"https://github.com/apache/iceberg/pull/2873#issuecomment-889460164","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2873","id":889460164,"node_id":"IC_kwDOCW7NX841BBXE","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-29T21:09:08Z","updated_at":"2021-07-29T21:09:08Z","author_association":"CONTRIBUTOR","body":"Thanks for the initial review round, I'll update the PR later today.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/889460164/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/889482340","html_url":"https://github.com/apache/iceberg/pull/2736#issuecomment-889482340","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2736","id":889482340,"node_id":"IC_kwDOCW7NX841BGxk","user":{"login":"karuppayya","id":5082742,"node_id":"MDQ6VXNlcjUwODI3NDI=","avatar_url":"https://avatars.githubusercontent.com/u/5082742?v=4","gravatar_id":"","url":"https://api.github.com/users/karuppayya","html_url":"https://github.com/karuppayya","followers_url":"https://api.github.com/users/karuppayya/followers","following_url":"https://api.github.com/users/karuppayya/following{/other_user}","gists_url":"https://api.github.com/users/karuppayya/gists{/gist_id}","starred_url":"https://api.github.com/users/karuppayya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/karuppayya/subscriptions","organizations_url":"https://api.github.com/users/karuppayya/orgs","repos_url":"https://api.github.com/users/karuppayya/repos","events_url":"https://api.github.com/users/karuppayya/events{/privacy}","received_events_url":"https://api.github.com/users/karuppayya/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-29T21:47:00Z","updated_at":"2021-07-29T21:47:00Z","author_association":"CONTRIBUTOR","body":"This PR requires more changes, closing it for now. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/889482340/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/889534826","html_url":"https://github.com/apache/iceberg/pull/2873#issuecomment-889534826","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2873","id":889534826,"node_id":"IC_kwDOCW7NX841BTlq","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-30T00:03:26Z","updated_at":"2021-07-30T00:03:26Z","author_association":"CONTRIBUTOR","body":"@openinx, I've updated the PR to set the metrics config for equality deletes in Parquet. Unfortunately, `Avro` delete write builders don't support it just yet, I'll submit a separate PR for that. I'll work on setting a correct config for position deletes next.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/889534826/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/889535397","html_url":"https://github.com/apache/iceberg/pull/2873#issuecomment-889535397","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2873","id":889535397,"node_id":"IC_kwDOCW7NX841BTul","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-30T00:04:42Z","updated_at":"2021-07-30T00:04:42Z","author_association":"CONTRIBUTOR","body":"One open question is about position delete sort order [here](https://github.com/apache/iceberg/pull/2873#discussion_r677780139).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/889535397/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/889538973","html_url":"https://github.com/apache/iceberg/pull/2892#issuecomment-889538973","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2892","id":889538973,"node_id":"IC_kwDOCW7NX841BUmd","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-30T00:14:42Z","updated_at":"2021-07-30T00:14:42Z","author_association":"CONTRIBUTOR","body":"I wanted to post this in case anyone finds it useful, but I don't think this is actually needed. That's why it is a draft. See https://github.com/apache/iceberg/pull/2865#discussion_r679563193 for more details.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/889538973/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/889539367","html_url":"https://github.com/apache/iceberg/pull/2891#issuecomment-889539367","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2891","id":889539367,"node_id":"IC_kwDOCW7NX841BUsn","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-30T00:15:48Z","updated_at":"2021-07-30T00:15:48Z","author_association":"CONTRIBUTOR","body":"Is this specific to Java? Are -NaN values ordered in other languages?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/889539367/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/889539738","html_url":"https://github.com/apache/iceberg/pull/549#issuecomment-889539738","issue_url":"https://api.github.com/repos/apache/iceberg/issues/549","id":889539738,"node_id":"IC_kwDOCW7NX841BUya","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-30T00:16:51Z","updated_at":"2021-07-30T00:16:51Z","author_association":"CONTRIBUTOR","body":"Hi @jzhuge, not sure I understand. Do I add these lines to my Spark application or Spark itself?\r\n```\r\n    ImmutableListSerializer.registerSerializers(kryo);\r\n    ImmutableMapSerializer.registerSerializers(kryo);\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/889539738/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/889553074","html_url":"https://github.com/apache/iceberg/pull/2886#issuecomment-889553074","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2886","id":889553074,"node_id":"IC_kwDOCW7NX841BYCy","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-30T00:58:47Z","updated_at":"2021-07-30T04:50:34Z","author_association":"CONTRIBUTOR","body":"@openinx I addressed your comments in the last commit. it is a good call to add a unit test. Through the unit test, I also found that uid wasn't set the map operator. Latest commit addressed it. Because I don't want to change the `Builder` class to a generic type, I added a `mappedRowDataInput` variable to distinguish this extra mapper case so that we can add the uid and name in the `build()` method.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/889553074/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/889595040","html_url":"https://github.com/apache/iceberg/pull/549#issuecomment-889595040","issue_url":"https://api.github.com/repos/apache/iceberg/issues/549","id":889595040,"node_id":"IC_kwDOCW7NX841BiSg","user":{"login":"jzhuge","id":1883812,"node_id":"MDQ6VXNlcjE4ODM4MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1883812?v=4","gravatar_id":"","url":"https://api.github.com/users/jzhuge","html_url":"https://github.com/jzhuge","followers_url":"https://api.github.com/users/jzhuge/followers","following_url":"https://api.github.com/users/jzhuge/following{/other_user}","gists_url":"https://api.github.com/users/jzhuge/gists{/gist_id}","starred_url":"https://api.github.com/users/jzhuge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jzhuge/subscriptions","organizations_url":"https://api.github.com/users/jzhuge/orgs","repos_url":"https://api.github.com/users/jzhuge/repos","events_url":"https://api.github.com/users/jzhuge/events{/privacy}","received_events_url":"https://api.github.com/users/jzhuge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-30T03:09:35Z","updated_at":"2021-07-30T03:09:35Z","author_association":"MEMBER","body":"Spark itself if you can","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/889595040/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/889649391","html_url":"https://github.com/apache/iceberg/pull/2891#issuecomment-889649391","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2891","id":889649391,"node_id":"IC_kwDOCW7NX841Bvjv","user":{"login":"electrum","id":9230,"node_id":"MDQ6VXNlcjkyMzA=","avatar_url":"https://avatars.githubusercontent.com/u/9230?v=4","gravatar_id":"","url":"https://api.github.com/users/electrum","html_url":"https://github.com/electrum","followers_url":"https://api.github.com/users/electrum/followers","following_url":"https://api.github.com/users/electrum/following{/other_user}","gists_url":"https://api.github.com/users/electrum/gists{/gist_id}","starred_url":"https://api.github.com/users/electrum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/electrum/subscriptions","organizations_url":"https://api.github.com/users/electrum/orgs","repos_url":"https://api.github.com/users/electrum/repos","events_url":"https://api.github.com/users/electrum/events{/privacy}","received_events_url":"https://api.github.com/users/electrum/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-30T05:59:03Z","updated_at":"2021-07-30T05:59:03Z","author_association":"CONTRIBUTOR","body":"This brings up the question of how different NaN representations should be handled in Iceberg. Should writers canonicalize them? What do ORC and Parquet do for non-canonical values?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/889649391/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/889669914","html_url":"https://github.com/apache/iceberg/issues/2764#issuecomment-889669914","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2764","id":889669914,"node_id":"IC_kwDOCW7NX841B0ka","user":{"login":"skandasa23","id":86716100,"node_id":"MDQ6VXNlcjg2NzE2MTAw","avatar_url":"https://avatars.githubusercontent.com/u/86716100?v=4","gravatar_id":"","url":"https://api.github.com/users/skandasa23","html_url":"https://github.com/skandasa23","followers_url":"https://api.github.com/users/skandasa23/followers","following_url":"https://api.github.com/users/skandasa23/following{/other_user}","gists_url":"https://api.github.com/users/skandasa23/gists{/gist_id}","starred_url":"https://api.github.com/users/skandasa23/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/skandasa23/subscriptions","organizations_url":"https://api.github.com/users/skandasa23/orgs","repos_url":"https://api.github.com/users/skandasa23/repos","events_url":"https://api.github.com/users/skandasa23/events{/privacy}","received_events_url":"https://api.github.com/users/skandasa23/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-30T06:46:44Z","updated_at":"2021-07-30T06:46:44Z","author_association":"NONE","body":"[Deleted my previous comment, hadn't tried out overwrite earlier]\r\nThank you @rdblue for the comment, makes sense to mark the operation as overwrite.\r\nI'd a look at the code [here](https://github.com/apache/iceberg/blob/90225d6c9413016d611e2ce5eff37db1bc1b4fc5/core/src/main/java/org/apache/iceberg/IncrementalDataTableScan.java#L113), for incremental downstream consumers only \"append\" snapshots are being considered , delete is ignored and overwrite results in exception. \r\nIs there a plan to propagate the mutations of delete/overwrite operations as well in future? @rdsr thoughts?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/889669914/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/889685056","html_url":"https://github.com/apache/iceberg/pull/2891#issuecomment-889685056","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2891","id":889685056,"node_id":"IC_kwDOCW7NX841B4RA","user":{"login":"findepi","id":144328,"node_id":"MDQ6VXNlcjE0NDMyOA==","avatar_url":"https://avatars.githubusercontent.com/u/144328?v=4","gravatar_id":"","url":"https://api.github.com/users/findepi","html_url":"https://github.com/findepi","followers_url":"https://api.github.com/users/findepi/followers","following_url":"https://api.github.com/users/findepi/following{/other_user}","gists_url":"https://api.github.com/users/findepi/gists{/gist_id}","starred_url":"https://api.github.com/users/findepi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/findepi/subscriptions","organizations_url":"https://api.github.com/users/findepi/orgs","repos_url":"https://api.github.com/users/findepi/repos","events_url":"https://api.github.com/users/findepi/events{/privacy}","received_events_url":"https://api.github.com/users/findepi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-30T07:16:43Z","updated_at":"2021-07-30T07:16:43Z","author_association":"MEMBER","body":"> Is this specific to Java? Are -NaN values ordered in other languages?\r\n\r\n@rdblue this i do not know. Since the spec points at Java sorting as the 'reference', so i focused on that.\r\n\r\n> This brings up the question of how different NaN representations should be handled in Iceberg. Should writers canonicalize them? \r\n\r\n@electrum this is a good question, and i was thinking about this too.\r\nit seems that, from Trino perspective, it doesn't matter much, because we treat all NaN values as indistinguishable. The canonicalzation is applied at comparison time, in the engine, so storage is not required to canonicalize. Of course, it would be better to have writers canonicalize, but I am concerned we will be never able to assume that at read time, because of pre-existing data.\r\n\r\nHowever, even if we follow this path, we still could want to define how NaNs interact with `distinct_counts` in manifest.\r\nOr, we would ignore `distinct_counts` whenever `nan_value_counts > 0`.\r\n(I don't know yet, whether this is important. We may or may not use `distinct_counts`.)\r\n\r\n> What do ORC and Parquet do for non-canonical values?\r\n\r\n@electrum you mean the reference writer implementations? i don't know.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/889685056/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/889716701","html_url":"https://github.com/apache/iceberg/issues/2896#issuecomment-889716701","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2896","id":889716701,"node_id":"IC_kwDOCW7NX841B__d","user":{"login":"hameizi","id":18445460,"node_id":"MDQ6VXNlcjE4NDQ1NDYw","avatar_url":"https://avatars.githubusercontent.com/u/18445460?v=4","gravatar_id":"","url":"https://api.github.com/users/hameizi","html_url":"https://github.com/hameizi","followers_url":"https://api.github.com/users/hameizi/followers","following_url":"https://api.github.com/users/hameizi/following{/other_user}","gists_url":"https://api.github.com/users/hameizi/gists{/gist_id}","starred_url":"https://api.github.com/users/hameizi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hameizi/subscriptions","organizations_url":"https://api.github.com/users/hameizi/orgs","repos_url":"https://api.github.com/users/hameizi/repos","events_url":"https://api.github.com/users/hameizi/events{/privacy}","received_events_url":"https://api.github.com/users/hameizi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-30T08:06:03Z","updated_at":"2021-07-30T08:06:03Z","author_association":"CONTRIBUTOR","body":"@aokolnychyi Could you help take a look?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/889716701/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/889757984","html_url":"https://github.com/apache/iceberg/pull/2897#issuecomment-889757984","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2897","id":889757984,"node_id":"IC_kwDOCW7NX841CKEg","user":{"login":"coolderli","id":38486782,"node_id":"MDQ6VXNlcjM4NDg2Nzgy","avatar_url":"https://avatars.githubusercontent.com/u/38486782?v=4","gravatar_id":"","url":"https://api.github.com/users/coolderli","html_url":"https://github.com/coolderli","followers_url":"https://api.github.com/users/coolderli/followers","following_url":"https://api.github.com/users/coolderli/following{/other_user}","gists_url":"https://api.github.com/users/coolderli/gists{/gist_id}","starred_url":"https://api.github.com/users/coolderli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coolderli/subscriptions","organizations_url":"https://api.github.com/users/coolderli/orgs","repos_url":"https://api.github.com/users/coolderli/repos","events_url":"https://api.github.com/users/coolderli/events{/privacy}","received_events_url":"https://api.github.com/users/coolderli/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-30T09:14:25Z","updated_at":"2021-07-30T09:14:25Z","author_association":"CONTRIBUTOR","body":"cc @rdblue ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/889757984/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/889771040","html_url":"https://github.com/apache/iceberg/pull/2881#issuecomment-889771040","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2881","id":889771040,"node_id":"IC_kwDOCW7NX841CNQg","user":{"login":"saurabhagas","id":5038921,"node_id":"MDQ6VXNlcjUwMzg5MjE=","avatar_url":"https://avatars.githubusercontent.com/u/5038921?v=4","gravatar_id":"","url":"https://api.github.com/users/saurabhagas","html_url":"https://github.com/saurabhagas","followers_url":"https://api.github.com/users/saurabhagas/followers","following_url":"https://api.github.com/users/saurabhagas/following{/other_user}","gists_url":"https://api.github.com/users/saurabhagas/gists{/gist_id}","starred_url":"https://api.github.com/users/saurabhagas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/saurabhagas/subscriptions","organizations_url":"https://api.github.com/users/saurabhagas/orgs","repos_url":"https://api.github.com/users/saurabhagas/repos","events_url":"https://api.github.com/users/saurabhagas/events{/privacy}","received_events_url":"https://api.github.com/users/saurabhagas/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-30T09:38:02Z","updated_at":"2021-07-30T09:38:02Z","author_association":"NONE","body":"Thanks @rymurr and other reviewers for accepting the change.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/889771040/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/889841931","html_url":"https://github.com/apache/iceberg/pull/2372#issuecomment-889841931","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2372","id":889841931,"node_id":"IC_kwDOCW7NX841CekL","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-30T11:54:24Z","updated_at":"2021-07-30T11:54:24Z","author_association":"COLLABORATOR","body":"@openinx I updated the PR according to your comments in #2364. This is an independent one that not depends on others.  I think we can handle this one first.\r\n\r\ncc @rdblue @jackye1995","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/889841931/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/889849331","html_url":"https://github.com/apache/iceberg/pull/2850#issuecomment-889849331","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2850","id":889849331,"node_id":"IC_kwDOCW7NX841CgXz","user":{"login":"sshkvar","id":3986221,"node_id":"MDQ6VXNlcjM5ODYyMjE=","avatar_url":"https://avatars.githubusercontent.com/u/3986221?v=4","gravatar_id":"","url":"https://api.github.com/users/sshkvar","html_url":"https://github.com/sshkvar","followers_url":"https://api.github.com/users/sshkvar/followers","following_url":"https://api.github.com/users/sshkvar/following{/other_user}","gists_url":"https://api.github.com/users/sshkvar/gists{/gist_id}","starred_url":"https://api.github.com/users/sshkvar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sshkvar/subscriptions","organizations_url":"https://api.github.com/users/sshkvar/orgs","repos_url":"https://api.github.com/users/sshkvar/repos","events_url":"https://api.github.com/users/sshkvar/events{/privacy}","received_events_url":"https://api.github.com/users/sshkvar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-30T12:08:53Z","updated_at":"2021-07-30T12:08:53Z","author_association":"CONTRIBUTOR","body":"This PR adds ability to have unique table location. \r\nIn this case each new table will have unique path on s3. \r\nBased on it example from my previous message will looks:\r\n1. User create table with name `table1` (location: `s3://iceberg/table1-eecec917-53b8-4d28-a900-c88061fc7ac2`)\r\n2. Then rename it to `table2` (location not change during update `s3://iceberg/table1-eecec917-53b8-4d28-a900-c88061fc7ac2`) \r\n3. Create new table with name `table1` (location: `s3://iceberg/table1-309f7903-c4b2-4df1-b890-a481bb47c4c5`)\r\n\r\nAs we have unique location we can perform remove orphan files (compaction) for bot tables safety.\r\nLooks like it can be pretty general case. \r\n@RussellSpitzer @kbendick what do you think? Is it make sense to add such property to Hive catalog? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/889849331/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/889875773","html_url":"https://github.com/apache/iceberg/issues/2896#issuecomment-889875773","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2896","id":889875773,"node_id":"IC_kwDOCW7NX841Cm09","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-30T12:59:06Z","updated_at":"2021-07-30T12:59:06Z","author_association":"MEMBER","body":"My guess would be a schema issue during import. Can you validate the schema created by iceberg and the schema of the original files?\r\n\r\nI would also go one by one through the columns (pruning out all but one column) and determine if there is an alignment issue or whether it is just one column.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/889875773/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/889902475","html_url":"https://github.com/apache/iceberg/pull/2881#issuecomment-889902475","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2881","id":889902475,"node_id":"IC_kwDOCW7NX841CtWL","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-30T13:43:43Z","updated_at":"2021-07-30T13:43:43Z","author_association":"MEMBER","body":"@rymurr , I think we will need to check whether the contributor are following the commit message pattern: `[iceberg-module]: [commit log message]`.  For example, this commit message should be rewrite as `API: Close the underlying iterator in ClosingIterator correctly`.  If the contributor did not follow the pattern, we committer will need to change it to (I think it's also good to add this to the apache iceberg [document](https://iceberg.apache.org/community/#contributing)).  We don't need to revert this committed PR, please have an extra check next time :-) . \r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/889902475/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/889934154","html_url":"https://github.com/apache/iceberg/issues/2895#issuecomment-889934154","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2895","id":889934154,"node_id":"IC_kwDOCW7NX841C1FK","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-30T14:33:27Z","updated_at":"2021-07-30T14:33:27Z","author_association":"MEMBER","body":"Looks like this is because a DynamicPartitionOverwrite operation with 0 files is broken.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/889934154/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/889938717","html_url":"https://github.com/apache/iceberg/issues/2895#issuecomment-889938717","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2895","id":889938717,"node_id":"IC_kwDOCW7NX841C2Md","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-30T14:40:47Z","updated_at":"2021-07-30T14:40:47Z","author_association":"MEMBER","body":"Looks like we can fix it by either allowing empty replace statements or by never making empty replace statements","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/889938717/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/889944454","html_url":"https://github.com/apache/iceberg/pull/2881#issuecomment-889944454","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2881","id":889944454,"node_id":"IC_kwDOCW7NX841C3mG","user":{"login":"rymurr","id":2022305,"node_id":"MDQ6VXNlcjIwMjIzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/2022305?v=4","gravatar_id":"","url":"https://api.github.com/users/rymurr","html_url":"https://github.com/rymurr","followers_url":"https://api.github.com/users/rymurr/followers","following_url":"https://api.github.com/users/rymurr/following{/other_user}","gists_url":"https://api.github.com/users/rymurr/gists{/gist_id}","starred_url":"https://api.github.com/users/rymurr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rymurr/subscriptions","organizations_url":"https://api.github.com/users/rymurr/orgs","repos_url":"https://api.github.com/users/rymurr/repos","events_url":"https://api.github.com/users/rymurr/events{/privacy}","received_events_url":"https://api.github.com/users/rymurr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-30T14:49:57Z","updated_at":"2021-07-30T14:49:57Z","author_association":"CONTRIBUTOR","body":"ahh, thanks for the check @openinx you are absolutely right. I will be more cautious next time.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/889944454/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/890039428","html_url":"https://github.com/apache/iceberg/pull/2897#issuecomment-890039428","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2897","id":890039428,"node_id":"IC_kwDOCW7NX841DOyE","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-30T17:20:00Z","updated_at":"2021-07-30T17:20:00Z","author_association":"CONTRIBUTOR","body":"Thanks, @coolderli! Good to have this added to the docs.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/890039428/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/890152309","html_url":"https://github.com/apache/iceberg/issues/2764#issuecomment-890152309","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2764","id":890152309,"node_id":"IC_kwDOCW7NX841DqV1","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-30T21:03:01Z","updated_at":"2021-07-30T21:03:01Z","author_association":"CONTRIBUTOR","body":"Bulk operations are difficult to propagate as mutations. Most of the early incremental consumption focuses on the easy case, appends, for that reason. But there are ways to make it work. For example, you could read all the deleted files and all the added files in an overwrite and use a full outer join to label each row deleted, added, or kept and then feed those rows into incremental processing. That join is expensive, though.\r\n\r\nAnother strategy is to read just the added files and consider all of the changes sort of an `upsert` operation. As long as you know that all of the data coming in replaces 0 or 1 rows, then you may not need to know what the previous row was. The problem is that this makes assumptions about the operation that happened and doesn't apply to all cases. For your deduplication case, it wouldn't tell you when duplicate rows are removed.\r\n\r\nI think the easier solution is turning a row-delta commit into changes because you can read the deleted rows and added rows directly without needing to process (and usually discard) the kept rows.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/890152309/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/890277167","html_url":"https://github.com/apache/iceberg/pull/2863#issuecomment-890277167","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2863","id":890277167,"node_id":"IC_kwDOCW7NX841EI0v","user":{"login":"Reo-LEI","id":17312872,"node_id":"MDQ6VXNlcjE3MzEyODcy","avatar_url":"https://avatars.githubusercontent.com/u/17312872?v=4","gravatar_id":"","url":"https://api.github.com/users/Reo-LEI","html_url":"https://github.com/Reo-LEI","followers_url":"https://api.github.com/users/Reo-LEI/followers","following_url":"https://api.github.com/users/Reo-LEI/following{/other_user}","gists_url":"https://api.github.com/users/Reo-LEI/gists{/gist_id}","starred_url":"https://api.github.com/users/Reo-LEI/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Reo-LEI/subscriptions","organizations_url":"https://api.github.com/users/Reo-LEI/orgs","repos_url":"https://api.github.com/users/Reo-LEI/repos","events_url":"https://api.github.com/users/Reo-LEI/events{/privacy}","received_events_url":"https://api.github.com/users/Reo-LEI/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-31T02:12:30Z","updated_at":"2021-07-31T02:12:30Z","author_association":"CONTRIBUTOR","body":"ping @openinx @rdblue ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/890277167/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/890282150","html_url":"https://github.com/apache/iceberg/pull/2898#issuecomment-890282150","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2898","id":890282150,"node_id":"IC_kwDOCW7NX841EKCm","user":{"login":"coolderli","id":38486782,"node_id":"MDQ6VXNlcjM4NDg2Nzgy","avatar_url":"https://avatars.githubusercontent.com/u/38486782?v=4","gravatar_id":"","url":"https://api.github.com/users/coolderli","html_url":"https://github.com/coolderli","followers_url":"https://api.github.com/users/coolderli/followers","following_url":"https://api.github.com/users/coolderli/following{/other_user}","gists_url":"https://api.github.com/users/coolderli/gists{/gist_id}","starred_url":"https://api.github.com/users/coolderli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coolderli/subscriptions","organizations_url":"https://api.github.com/users/coolderli/orgs","repos_url":"https://api.github.com/users/coolderli/repos","events_url":"https://api.github.com/users/coolderli/events{/privacy}","received_events_url":"https://api.github.com/users/coolderli/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-31T03:05:09Z","updated_at":"2021-07-31T03:05:09Z","author_association":"CONTRIBUTOR","body":"I think this may be avoided by setting `write.distribution-mode` to `hash`.\r\nhttps://github.com/apache/iceberg/blob/master/flink/src/main/java/org/apache/iceberg/flink/sink/FlinkSink.java#L322","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/890282150/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/890304519","html_url":"https://github.com/apache/iceberg/pull/2873#issuecomment-890304519","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2873","id":890304519,"node_id":"IC_kwDOCW7NX841EPgH","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-31T07:18:31Z","updated_at":"2021-07-31T07:18:31Z","author_association":"CONTRIBUTOR","body":"Thanks for reviewing, everyone! ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/890304519/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/890355891","html_url":"https://github.com/apache/iceberg/pull/2898#issuecomment-890355891","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2898","id":890355891,"node_id":"IC_kwDOCW7NX841EcCz","user":{"login":"Reo-LEI","id":17312872,"node_id":"MDQ6VXNlcjE3MzEyODcy","avatar_url":"https://avatars.githubusercontent.com/u/17312872?v=4","gravatar_id":"","url":"https://api.github.com/users/Reo-LEI","html_url":"https://github.com/Reo-LEI","followers_url":"https://api.github.com/users/Reo-LEI/followers","following_url":"https://api.github.com/users/Reo-LEI/following{/other_user}","gists_url":"https://api.github.com/users/Reo-LEI/gists{/gist_id}","starred_url":"https://api.github.com/users/Reo-LEI/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Reo-LEI/subscriptions","organizations_url":"https://api.github.com/users/Reo-LEI/orgs","repos_url":"https://api.github.com/users/Reo-LEI/repos","events_url":"https://api.github.com/users/Reo-LEI/events{/privacy}","received_events_url":"https://api.github.com/users/Reo-LEI/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-31T14:22:14Z","updated_at":"2021-07-31T14:22:14Z","author_association":"CONTRIBUTOR","body":"> I think this may be avoided by setting `write.distribution-mode` to `hash`.\r\n> https://github.com/apache/iceberg/blob/master/flink/src/main/java/org/apache/iceberg/flink/sink/FlinkSink.java#L322\r\n\r\nActually set `write.distribution-mode = hash` can not resolve this. Because CDC data shoule be distributed to primary key but not partition fields. For example, an iceberg table has equalityFields (dt, hour, id) and partition fields (dt, hour). If set `write.distribution-mode = hash`, the CDC data will be keyBy (dt, hour), and we can not ensure same id CDC data will send to same `IcebergStreamWriter`. \r\n\r\nAnd the second reason is , for FlinkSQL, `rowDataInput` contain a `FlinkCDCSource ` opr and a `Filter` opr. The `FlinkCDCSource ` opr parallelism is 1 and the `Filter` opr parallelism use job default parallelism. If we only keyBy `rowDataInput` output data to `IcebergStreamWriter`, we will get a job graph as follow: \r\n```\r\n                              +---> Filter ---+      +---> IcebergStreamWriter ---+\r\nFlinkCDCSource ---rebalance---+---> Filter ---+-hash-+---> IcebergStreamWriter ---+---rebalance---> IcebergFilesCommitter\r\n                              +---> Filter ---+      +---> IcebergStreamWriter ---+\r\n```\r\nAs result, the CDC data will be rebalance to `Filter`. That will make CDC data disorder(e.g. same `IcebergStreamWriter` will receive +U before -U), and we will get some strange result. So we need to keep the `Filter` have same parallelism to it's input opr.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/890355891/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/890389829","html_url":"https://github.com/apache/iceberg/issues/2902#issuecomment-890389829","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2902","id":890389829,"node_id":"IC_kwDOCW7NX841EkVF","user":{"login":"GrigorievNick","id":16338643,"node_id":"MDQ6VXNlcjE2MzM4NjQz","avatar_url":"https://avatars.githubusercontent.com/u/16338643?v=4","gravatar_id":"","url":"https://api.github.com/users/GrigorievNick","html_url":"https://github.com/GrigorievNick","followers_url":"https://api.github.com/users/GrigorievNick/followers","following_url":"https://api.github.com/users/GrigorievNick/following{/other_user}","gists_url":"https://api.github.com/users/GrigorievNick/gists{/gist_id}","starred_url":"https://api.github.com/users/GrigorievNick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/GrigorievNick/subscriptions","organizations_url":"https://api.github.com/users/GrigorievNick/orgs","repos_url":"https://api.github.com/users/GrigorievNick/repos","events_url":"https://api.github.com/users/GrigorievNick/events{/privacy}","received_events_url":"https://api.github.com/users/GrigorievNick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-31T18:52:44Z","updated_at":"2021-07-31T18:52:44Z","author_association":"CONTRIBUTOR","body":"May be this is same issue https://github.com/apache/iceberg/issues/2374?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/890389829/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/890517576","html_url":"https://github.com/apache/iceberg/pull/2898#issuecomment-890517576","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2898","id":890517576,"node_id":"IC_kwDOCW7NX841FDhI","user":{"login":"Reo-LEI","id":17312872,"node_id":"MDQ6VXNlcjE3MzEyODcy","avatar_url":"https://avatars.githubusercontent.com/u/17312872?v=4","gravatar_id":"","url":"https://api.github.com/users/Reo-LEI","html_url":"https://github.com/Reo-LEI","followers_url":"https://api.github.com/users/Reo-LEI/followers","following_url":"https://api.github.com/users/Reo-LEI/following{/other_user}","gists_url":"https://api.github.com/users/Reo-LEI/gists{/gist_id}","starred_url":"https://api.github.com/users/Reo-LEI/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Reo-LEI/subscriptions","organizations_url":"https://api.github.com/users/Reo-LEI/orgs","repos_url":"https://api.github.com/users/Reo-LEI/repos","events_url":"https://api.github.com/users/Reo-LEI/events{/privacy}","received_events_url":"https://api.github.com/users/Reo-LEI/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-01T13:07:52Z","updated_at":"2021-08-01T13:07:52Z","author_association":"CONTRIBUTOR","body":"Could you take look of this? @openinx ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/890517576/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/890557948","html_url":"https://github.com/apache/iceberg/pull/2867#issuecomment-890557948","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2867","id":890557948,"node_id":"IC_kwDOCW7NX841FNX8","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-01T17:23:28Z","updated_at":"2021-08-01T17:23:28Z","author_association":"CONTRIBUTOR","body":"@hameizi, could you update the PR description with details about this feature? Auto-compaction is not very specific so I'd like to hear how you implemented it and what that means.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/890557948/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/890564959","html_url":"https://github.com/apache/iceberg/pull/1744#issuecomment-890564959","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1744","id":890564959,"node_id":"IC_kwDOCW7NX841FPFf","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-01T18:18:04Z","updated_at":"2021-08-01T18:18:04Z","author_association":"CONTRIBUTOR","body":"If I remember correctly, the main problem here was a mismatch between the expected schema and the actual schema when reading from Avro files. That was caused by some unexpected behaviors across a few helpers:\r\n1. `TypeUtil.select` (that uses `PruneColumns`) has behavior like SQL projection using IDs. Any field that is selected by ID is completely projected. For example, selecting `{4}` from the schema `3: id bigint, 4: location struct<5: lat double, 6: long double>` is like `SELECT location` and produces `4: location struct<5: lat double, 6 long double>` as the projected schema. As a result, empty structs can't be selected by this method (or in SQL).\r\n2. `TypeUtil.getProjectedIds` (that uses `GetProjectedIds`) is written expecting the current behavior from `TypeUtil.select`. When finding the IDs needed to describe a projection, it will return all leaf field IDs. Because empty structs contain no leaf fields, there are no IDs returned for an empty struct. Reusing the example above, if the requested projection were `4: location struct<>` (no fields) then the result is `{}` rather than `{4}` because `select` would return all fields of `location`.\r\n3. Record types are position based and readers assume that the expected schema will match the read schema, even though the read schema is produced using the file schema, conversions, and calls to the two methods above. An empty struct in the requested schema will be silently removed, producing a mismatch in the field positions. When reading with `id bigint, location struct<>, data string`, the data produced will be `id bigint, data string`, resulting in an `ArrayIndexOutOfBounds` exception or a `ClassCastException` depending on the rest of the projection.\r\n4. There is a bug that sometimes avoids this problem by accidentally projecting empty structs, but this is not reliable because sometimes the empty struct should not be produced or else it introduces the opposite problem: projecting `id bigint, data string` actually produces `id bigint, location struct<>, data string`.\r\n\r\nHopefully that captures the issues here.\r\n\r\nFirst, I think that `select` behavior is correct. This matches the behavior where a list of selected fields should be turned into a list of IDs and completely projected. Selecting a struct should select all of its fields, as expected by `SELECT location`. The problem is that this is that we assume that the output of `getProjectedIds` will be used for `select` and so it can't return any non-leaf field IDs.\r\n\r\nTo fix this, I propose the following:\r\n* Update the behavior of `getProjectedIds` to return an ID for empty structs. The ID should indicate that the struct must be returned without any fields, unless there are sub-fields selected by a nested field ID.\r\n* Add a `TypeUtil.project` method that is the opposite of `getProjectedIds`. The combination of `getProjectedIds` and `project` should always be the same schema, with empty structs.\r\n* Update all calls to `select` and avoid passing the result of `getProjectedIds` because of the behavior change. In some cases, this will actually fix behavior: `StructProjection.create(Schema base, Schema projection)` should use `project` to preserve empty structs, for example. But other places, like `BaseTableScan.lazyColumnProjection` can avoid calling `getProjectedIds` because it isn't needed (and would change behavior).\r\n* Update most calls that need to produce a schema matching the expected schema to use `project` instead of `select` so that empty structs are preserved.\r\n* Fix the second bug, which is unrelated but also incorrect.\r\n\r\nI think that should fix this. To me, that seems like a couple of PRs: one to add `TypeUtil.project` that will produce empty structs instead of fully-selected structs (maybe just a boolean option to configure `PruneColumns`). Then one PR to update the behavior of `getProjectedIds` and fix `select` calls that use the result to correctly call `project` or avoid `getProjectedIds`. And finally, one PR to fix the second bug.\r\n\r\nDoes that sound reasonable?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/890564959/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/890568188","html_url":"https://github.com/apache/iceberg/pull/2892#issuecomment-890568188","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2892","id":890568188,"node_id":"IC_kwDOCW7NX841FP38","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-01T18:48:16Z","updated_at":"2021-08-01T18:48:16Z","author_association":"CONTRIBUTOR","body":"@openinx, if you want to add this, please merge it. Otherwise we'll move forward with the release without it. Thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/890568188/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/890589132","html_url":"https://github.com/apache/iceberg/pull/1963#issuecomment-890589132","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1963","id":890589132,"node_id":"IC_kwDOCW7NX841FU_M","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-01T21:23:28Z","updated_at":"2021-08-01T21:23:28Z","author_association":"CONTRIBUTOR","body":"Any update on this one, @yyanyy?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/890589132/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/890592412","html_url":"https://github.com/apache/iceberg/pull/2891#issuecomment-890592412","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2891","id":890592412,"node_id":"IC_kwDOCW7NX841FVyc","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-01T21:53:45Z","updated_at":"2021-08-01T21:53:45Z","author_association":"CONTRIBUTOR","body":"@electrum, I was leaving this vague. My inclination is to not to require canonicalization. It's more work and there may be legitimate uses of signalling NaNs. Plus, I just looked into signalling NaN values and they are evidently not part of the IEEE 754 spec and differ between processors:\r\n\r\n> Encodings of qNaN and sNaN are not specified in IEEE 754 and implemented differently on different processors. ([wikipedia](https://en.wikipedia.org/wiki/Single-precision_floating-point_format#Single-precision_examples))\r\n\r\n@findepi, in IEEE 754, the sign bit is independent of whether a value is NaN (exponent bits are all set and significand is non-zero). That means there are legitimate -NaN values and it would be reasonable for another language to sort them that way. I think that there is no need to change the handling of -NaN values in the spec.\r\n\r\nIt's also reasonable for Java to not distinguish between -NaN and NaN values and to only produce positive NaNs. The only update I would make is to ensure that the Java implementation only writes positive NaN values to align with its sort. In most cases, no changes are needed because we track NaN values through counts after identifying them with `Float.isNaN` or `Double.isNaN`. The only cases that would need to be updated are when engines write -NaN values into files *and* are sorting them. Those engines would be responsible for converting -NaN to NaN or to implement the sort order according to the spec rather than using the default Java comparison.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/890592412/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/890605206","html_url":"https://github.com/apache/iceberg/pull/2284#issuecomment-890605206","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2284","id":890605206,"node_id":"IC_kwDOCW7NX841FY6W","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-01T23:23:35Z","updated_at":"2021-08-01T23:23:35Z","author_association":"CONTRIBUTOR","body":"I'm going to close this because I made the updates in #2906.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/890605206/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/890608366","html_url":"https://github.com/apache/iceberg/pull/2761#issuecomment-890608366","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2761","id":890608366,"node_id":"IC_kwDOCW7NX841FZru","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-01T23:43:36Z","updated_at":"2021-08-01T23:43:36Z","author_association":"CONTRIBUTOR","body":"> > I think there might be some arrow stuff to add, but that might be outdated. A few comments.\r\n> \r\n> I think i may have mistakenly mentioned the arrow_table_utils, which doesn't exist in open source, sorry for the confusion.\r\n\r\nAh that explains it. I went looking for it, hence the \"might be outdated\". Thanks for clarifying :) ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/890608366/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/890624681","html_url":"https://github.com/apache/iceberg/pull/2898#issuecomment-890624681","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2898","id":890624681,"node_id":"IC_kwDOCW7NX841Fdqp","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-02T00:43:08Z","updated_at":"2021-08-02T00:45:59Z","author_association":"CONTRIBUTOR","body":"Also, as my Flink is a little rusty compared to my Spark knowledge, can you please open an issue (or link it to your commit)? I can help tag some relevant people there if we don't hear from openinx after a bit here as I'd love to have other more knowledgable folks than myself contribute to the discussion. =)\r\n\r\nEDIT - Finally, we've talked a lot about the CDC case that it map side only (though with a potential rebalance or hash inside of it), but can users still get themselves into an unhappy case if they have a retract stream that they re-key or something themselves (say they do some ETL on a CDC stream)?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/890624681/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/890654658","html_url":"https://github.com/apache/iceberg/pull/2867#issuecomment-890654658","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2867","id":890654658,"node_id":"IC_kwDOCW7NX841Fk_C","user":{"login":"hameizi","id":18445460,"node_id":"MDQ6VXNlcjE4NDQ1NDYw","avatar_url":"https://avatars.githubusercontent.com/u/18445460?v=4","gravatar_id":"","url":"https://api.github.com/users/hameizi","html_url":"https://github.com/hameizi","followers_url":"https://api.github.com/users/hameizi/followers","following_url":"https://api.github.com/users/hameizi/following{/other_user}","gists_url":"https://api.github.com/users/hameizi/gists{/gist_id}","starred_url":"https://api.github.com/users/hameizi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hameizi/subscriptions","organizations_url":"https://api.github.com/users/hameizi/orgs","repos_url":"https://api.github.com/users/hameizi/repos","events_url":"https://api.github.com/users/hameizi/events{/privacy}","received_events_url":"https://api.github.com/users/hameizi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-02T02:01:56Z","updated_at":"2021-08-02T02:01:56Z","author_association":"CONTRIBUTOR","body":"> @hameizi, could you update the PR description with details about this feature? Auto-compaction is not very specific so I'd like to hear how you implemented it and what that means.\r\n\r\n@rdblue Hi, i have update the PR description.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/890654658/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/890662602","html_url":"https://github.com/apache/iceberg/issues/2896#issuecomment-890662602","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2896","id":890662602,"node_id":"IC_kwDOCW7NX841Fm7K","user":{"login":"hameizi","id":18445460,"node_id":"MDQ6VXNlcjE4NDQ1NDYw","avatar_url":"https://avatars.githubusercontent.com/u/18445460?v=4","gravatar_id":"","url":"https://api.github.com/users/hameizi","html_url":"https://github.com/hameizi","followers_url":"https://api.github.com/users/hameizi/followers","following_url":"https://api.github.com/users/hameizi/following{/other_user}","gists_url":"https://api.github.com/users/hameizi/gists{/gist_id}","starred_url":"https://api.github.com/users/hameizi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hameizi/subscriptions","organizations_url":"https://api.github.com/users/hameizi/orgs","repos_url":"https://api.github.com/users/hameizi/repos","events_url":"https://api.github.com/users/hameizi/events{/privacy}","received_events_url":"https://api.github.com/users/hameizi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-02T02:20:50Z","updated_at":"2021-08-02T02:23:23Z","author_association":"CONTRIBUTOR","body":"> My guess would be a schema issue during import. Can you validate the schema created by iceberg and the schema of the original files?\r\n> \r\n> I would also go one by one through the columns (pruning out all but one column) and determine if there is an alignment issue or whether it is just one column.\r\n\r\n@RussellSpitzer thanks for you reply, the schema is correct like below, but get the same exception too.\r\nFlink SQL> desc flink.hive_adv_game_recommend_test19;\r\n+------------+--------+------+-----+--------+-----------+\r\n|       name |   type | null | key | extras | watermark |\r\n+------------+--------+------+-----+--------+-----------+\r\n| gameidfrom |    INT | true |     |        |           |\r\n|       guid | STRING | true |     |        |           |\r\n|       uuid | STRING | true |     |        |           |\r\n|     userid | STRING | true |     |        |           |\r\n| useridfrom |    INT | true |     |        |           |\r\n|   manageid | BIGINT | true |     |        |           |\r\n|         pt | STRING | true |     |        |           |\r\n+------------+--------+------+-----+--------+-----------+\r\n7 rows in set\r\n\r\nFlink SQL> desc iceberg_hive_catalog.flink.iceberg_hive_adv_game_recommend_test19;\r\n+------------+--------+------+-----+--------+-----------+\r\n|       name |   type | null | key | extras | watermark |\r\n+------------+--------+------+-----+--------+-----------+\r\n| gameidfrom |    INT | true |     |        |           |\r\n|       guid | STRING | true |     |        |           |\r\n|       uuid | STRING | true |     |        |           |\r\n|     userid | STRING | true |     |        |           |\r\n| useridfrom |    INT | true |     |        |           |\r\n|   manageid | BIGINT | true |     |        |           |\r\n|         pt | STRING | true |     |        |           |\r\n+------------+--------+------+-----+--------+-----------+\r\n7 rows in set","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/890662602/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/890665719","html_url":"https://github.com/apache/iceberg/issues/2896#issuecomment-890665719","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2896","id":890665719,"node_id":"IC_kwDOCW7NX841Fnr3","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-02T02:31:21Z","updated_at":"2021-08-02T02:31:21Z","author_association":"MEMBER","body":"@hameizi And the schema of the actual files? And could you select just one column at a time from the table and see if any of them read correctly?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/890665719/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/890673217","html_url":"https://github.com/apache/iceberg/pull/2908#issuecomment-890673217","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2908","id":890673217,"node_id":"IC_kwDOCW7NX841FphB","user":{"login":"jun-he","id":12246263,"node_id":"MDQ6VXNlcjEyMjQ2MjYz","avatar_url":"https://avatars.githubusercontent.com/u/12246263?v=4","gravatar_id":"","url":"https://api.github.com/users/jun-he","html_url":"https://github.com/jun-he","followers_url":"https://api.github.com/users/jun-he/followers","following_url":"https://api.github.com/users/jun-he/following{/other_user}","gists_url":"https://api.github.com/users/jun-he/gists{/gist_id}","starred_url":"https://api.github.com/users/jun-he/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jun-he/subscriptions","organizations_url":"https://api.github.com/users/jun-he/orgs","repos_url":"https://api.github.com/users/jun-he/repos","events_url":"https://api.github.com/users/jun-he/events{/privacy}","received_events_url":"https://api.github.com/users/jun-he/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-02T02:58:35Z","updated_at":"2021-08-02T02:58:35Z","author_association":"COLLABORATOR","body":"@rymurr @TGooch44 Can you help to review it? Thanks.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/890673217/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/890730773","html_url":"https://github.com/apache/iceberg/pull/2910#issuecomment-890730773","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2910","id":890730773,"node_id":"IC_kwDOCW7NX841F3kV","user":{"login":"jun-he","id":12246263,"node_id":"MDQ6VXNlcjEyMjQ2MjYz","avatar_url":"https://avatars.githubusercontent.com/u/12246263?v=4","gravatar_id":"","url":"https://api.github.com/users/jun-he","html_url":"https://github.com/jun-he","followers_url":"https://api.github.com/users/jun-he/followers","following_url":"https://api.github.com/users/jun-he/following{/other_user}","gists_url":"https://api.github.com/users/jun-he/gists{/gist_id}","starred_url":"https://api.github.com/users/jun-he/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jun-he/subscriptions","organizations_url":"https://api.github.com/users/jun-he/orgs","repos_url":"https://api.github.com/users/jun-he/repos","events_url":"https://api.github.com/users/jun-he/events{/privacy}","received_events_url":"https://api.github.com/users/jun-he/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-02T05:36:43Z","updated_at":"2021-08-02T05:41:50Z","author_association":"COLLABORATOR","body":"@rymurr @TGooch44 It seems we need IN/NOT_IN predicate support and also exposing literals to be able to support all java features. Wondering if there is anyone working on those now? If no ongoing work, I will check them.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/890730773/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/890735684","html_url":"https://github.com/apache/iceberg/issues/2896#issuecomment-890735684","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2896","id":890735684,"node_id":"IC_kwDOCW7NX841F4xE","user":{"login":"hameizi","id":18445460,"node_id":"MDQ6VXNlcjE4NDQ1NDYw","avatar_url":"https://avatars.githubusercontent.com/u/18445460?v=4","gravatar_id":"","url":"https://api.github.com/users/hameizi","html_url":"https://github.com/hameizi","followers_url":"https://api.github.com/users/hameizi/followers","following_url":"https://api.github.com/users/hameizi/following{/other_user}","gists_url":"https://api.github.com/users/hameizi/gists{/gist_id}","starred_url":"https://api.github.com/users/hameizi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hameizi/subscriptions","organizations_url":"https://api.github.com/users/hameizi/orgs","repos_url":"https://api.github.com/users/hameizi/repos","events_url":"https://api.github.com/users/hameizi/events{/privacy}","received_events_url":"https://api.github.com/users/hameizi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-02T05:50:12Z","updated_at":"2021-08-02T05:50:12Z","author_association":"CONTRIBUTOR","body":"> And the schema of the actual files? And could you select just one column at a time from the table and see if any of them read correctly?\r\n\r\n@RussellSpitzer The schema of the actual files correct too. I just select one column also get the same exception. And i remove the partition column which is not pyhsics exist in the hive table file can not slove the exception too.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/890735684/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/890738961","html_url":"https://github.com/apache/iceberg/pull/2891#issuecomment-890738961","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2891","id":890738961,"node_id":"IC_kwDOCW7NX841F5kR","user":{"login":"findepi","id":144328,"node_id":"MDQ6VXNlcjE0NDMyOA==","avatar_url":"https://avatars.githubusercontent.com/u/144328?v=4","gravatar_id":"","url":"https://api.github.com/users/findepi","html_url":"https://github.com/findepi","followers_url":"https://api.github.com/users/findepi/followers","following_url":"https://api.github.com/users/findepi/following{/other_user}","gists_url":"https://api.github.com/users/findepi/gists{/gist_id}","starred_url":"https://api.github.com/users/findepi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/findepi/subscriptions","organizations_url":"https://api.github.com/users/findepi/orgs","repos_url":"https://api.github.com/users/findepi/repos","events_url":"https://api.github.com/users/findepi/events{/privacy}","received_events_url":"https://api.github.com/users/findepi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-02T05:58:52Z","updated_at":"2021-08-02T05:58:52Z","author_association":"MEMBER","body":"\r\n\r\n> It's also reasonable for Java to not distinguish between -NaN and NaN values and to only produce positive NaNs. \r\n\r\nIt would be more accurate to say that java doesn't distinguish NaN values with sign bit set and those without.\r\nIn Java, you can construct a NaN value with a bit sign set, e.g. `Double.longBitsToDouble(0xfff8000000000000L)`.\r\n\r\nIf your intention is to expect Java writers to sort these as before everything, we still need to update the spec (and Java writers).\r\nThe spec points at Java sorting as the reference implementation.\r\n\r\nIf your intention is to expect Java writers not to write NaN values with sign bit set, this is in fact the canonicalization that you wanted to avoid.\r\n\r\n\r\nAs was observed, signalling NaNs are not portable between processors, so we should exclude them from the picture.\r\nWhile NaN values can carry an additional payload (fraction bits, the sign), such use is not portable as well.\r\nThere might be legitimate use-cases for these in some applications, but it seems we cannot expect them to be respected by the engines, which do not distinguish them.\r\n\r\nThus, if e.g. Rust-based application writes -NaN values and Java application rewrites the data file (update, compaction, format change), we should expect the NaN attributes to be lost.\r\nThat can be confusing to users and users would consider this a bug, which we probably wouldn't be able to fix.\r\n\r\nIt seems it would be safer to have just one NaN concept in the Iceberg spec and treat all NaN values as indistinguishable.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/890738961/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/890843475","html_url":"https://github.com/apache/iceberg/pull/2912#issuecomment-890843475","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2912","id":890843475,"node_id":"IC_kwDOCW7NX841GTFT","user":{"login":"findepi","id":144328,"node_id":"MDQ6VXNlcjE0NDMyOA==","avatar_url":"https://avatars.githubusercontent.com/u/144328?v=4","gravatar_id":"","url":"https://api.github.com/users/findepi","html_url":"https://github.com/findepi","followers_url":"https://api.github.com/users/findepi/followers","following_url":"https://api.github.com/users/findepi/following{/other_user}","gists_url":"https://api.github.com/users/findepi/gists{/gist_id}","starred_url":"https://api.github.com/users/findepi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/findepi/subscriptions","organizations_url":"https://api.github.com/users/findepi/orgs","repos_url":"https://api.github.com/users/findepi/repos","events_url":"https://api.github.com/users/findepi/events{/privacy}","received_events_url":"https://api.github.com/users/findepi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-02T08:41:56Z","updated_at":"2021-08-02T08:41:56Z","author_association":"MEMBER","body":"i wasn't rebased. This has been fixed already by 83886c87f516afed7e625bed7f5749838217138c.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/890843475/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/890881350","html_url":"https://github.com/apache/iceberg/pull/2913#issuecomment-890881350","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2913","id":890881350,"node_id":"IC_kwDOCW7NX841GcVG","user":{"login":"findepi","id":144328,"node_id":"MDQ6VXNlcjE0NDMyOA==","avatar_url":"https://avatars.githubusercontent.com/u/144328?v=4","gravatar_id":"","url":"https://api.github.com/users/findepi","html_url":"https://github.com/findepi","followers_url":"https://api.github.com/users/findepi/followers","following_url":"https://api.github.com/users/findepi/following{/other_user}","gists_url":"https://api.github.com/users/findepi/gists{/gist_id}","starred_url":"https://api.github.com/users/findepi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/findepi/subscriptions","organizations_url":"https://api.github.com/users/findepi/orgs","repos_url":"https://api.github.com/users/findepi/repos","events_url":"https://api.github.com/users/findepi/events{/privacy}","received_events_url":"https://api.github.com/users/findepi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-02T09:38:02Z","updated_at":"2021-08-02T09:38:02Z","author_association":"MEMBER","body":"cc @rdblue @electrum @joshthoward @grantatspothero  ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/890881350/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/890940364","html_url":"https://github.com/apache/iceberg/pull/2910#issuecomment-890940364","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2910","id":890940364,"node_id":"IC_kwDOCW7NX841GqvM","user":{"login":"TGooch44","id":1591711,"node_id":"MDQ6VXNlcjE1OTE3MTE=","avatar_url":"https://avatars.githubusercontent.com/u/1591711?v=4","gravatar_id":"","url":"https://api.github.com/users/TGooch44","html_url":"https://github.com/TGooch44","followers_url":"https://api.github.com/users/TGooch44/followers","following_url":"https://api.github.com/users/TGooch44/following{/other_user}","gists_url":"https://api.github.com/users/TGooch44/gists{/gist_id}","starred_url":"https://api.github.com/users/TGooch44/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TGooch44/subscriptions","organizations_url":"https://api.github.com/users/TGooch44/orgs","repos_url":"https://api.github.com/users/TGooch44/repos","events_url":"https://api.github.com/users/TGooch44/events{/privacy}","received_events_url":"https://api.github.com/users/TGooch44/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-02T11:12:29Z","updated_at":"2021-08-02T11:12:29Z","author_association":"CONTRIBUTOR","body":"> imho classes full of static methods are very weird in python. This module should just contain functions\r\n\r\nI'll take the blame for setting this precedent here.  I agree with @rymurr though,  these are better off as just plain functions.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/890940364/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891122748","html_url":"https://github.com/apache/iceberg/issues/2917#issuecomment-891122748","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2917","id":891122748,"node_id":"IC_kwDOCW7NX841HXQ8","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-02T15:33:20Z","updated_at":"2021-08-02T15:33:20Z","author_association":"MEMBER","body":"Reading specific files isn't really supported at the moment although you may be able to repurpose the Rewrite code to handle it... To do so you would have to make BaseFileScanTasks which you could do by converting the File metadata rows into DataFiles (See SparkDataFile) and then putting those into the manager ....\r\n\r\nI think one of the key issues is that the way we read the files is also state dependent on the table at that time so we have to know what spec we are using, for the residual evaluator you can just put in an always true evaluator.\r\n\r\n---\r\n\r\nIf you just want to read  files it may make sense to just pass the file paths to the normal spark reading code rather than doing it through the Iceberg Datasource. Something like \r\n\r\nhttps://github.com/apache/spark/blob/master/sql/core/src/main/scala/org/apache/spark/sql/DataFrameReader.scala#L595\r\nspark.read.parquet(files:_*)\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891122748/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891125532","html_url":"https://github.com/apache/iceberg/pull/2867#issuecomment-891125532","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2867","id":891125532,"node_id":"IC_kwDOCW7NX841HX8c","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-02T15:37:24Z","updated_at":"2021-08-02T15:37:24Z","author_association":"CONTRIBUTOR","body":"@hameizi, could you please be more specific? How does this determine which files to rewrite? In what tasks are they rewritten? Does this introduce new operators? Are files rewritten before initial commit or afterward in a replace commit?\r\n\r\nThere are a lot of details for a feature like this that need to be clear.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891125532/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891130393","html_url":"https://github.com/apache/iceberg/pull/2898#issuecomment-891130393","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2898","id":891130393,"node_id":"IC_kwDOCW7NX841HZIZ","user":{"login":"Reo-LEI","id":17312872,"node_id":"MDQ6VXNlcjE3MzEyODcy","avatar_url":"https://avatars.githubusercontent.com/u/17312872?v=4","gravatar_id":"","url":"https://api.github.com/users/Reo-LEI","html_url":"https://github.com/Reo-LEI","followers_url":"https://api.github.com/users/Reo-LEI/followers","following_url":"https://api.github.com/users/Reo-LEI/following{/other_user}","gists_url":"https://api.github.com/users/Reo-LEI/gists{/gist_id}","starred_url":"https://api.github.com/users/Reo-LEI/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Reo-LEI/subscriptions","organizations_url":"https://api.github.com/users/Reo-LEI/orgs","repos_url":"https://api.github.com/users/Reo-LEI/repos","events_url":"https://api.github.com/users/Reo-LEI/events{/privacy}","received_events_url":"https://api.github.com/users/Reo-LEI/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-02T15:44:40Z","updated_at":"2021-08-02T15:44:40Z","author_association":"CONTRIBUTOR","body":"Thanks for your review and give me a lot of advice @kbendick . I open an issue #2918 to illustrate this problem more detailly, I hope that can help you to understand this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891130393/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891135950","html_url":"https://github.com/apache/iceberg/issues/2917#issuecomment-891135950","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2917","id":891135950,"node_id":"IC_kwDOCW7NX841HafO","user":{"login":"GrigorievNick","id":16338643,"node_id":"MDQ6VXNlcjE2MzM4NjQz","avatar_url":"https://avatars.githubusercontent.com/u/16338643?v=4","gravatar_id":"","url":"https://api.github.com/users/GrigorievNick","html_url":"https://github.com/GrigorievNick","followers_url":"https://api.github.com/users/GrigorievNick/followers","following_url":"https://api.github.com/users/GrigorievNick/following{/other_user}","gists_url":"https://api.github.com/users/GrigorievNick/gists{/gist_id}","starred_url":"https://api.github.com/users/GrigorievNick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/GrigorievNick/subscriptions","organizations_url":"https://api.github.com/users/GrigorievNick/orgs","repos_url":"https://api.github.com/users/GrigorievNick/repos","events_url":"https://api.github.com/users/GrigorievNick/events{/privacy}","received_events_url":"https://api.github.com/users/GrigorievNick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-02T15:52:43Z","updated_at":"2021-08-02T15:54:22Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer Thx, the first approach is exactly what I am looking for, and because I know manifests and snapshots I will be able to reproduce the exact state.\r\nThe goal of this task is to implement file coupling based on a specific column in the table and flatMap iceberg files to rows.\r\n\r\n>If you just want to read files it may make sense to just pass the file paths to the normal spark reading code rather than doing it through the Iceberg Datasource. Something like\r\n\r\n I was not able to use it with ORC files.\r\n ```\r\nType 3 has an unknown kind.\r\njava.io.IOException: Type 3 has an unknown kind.\r\n```\r\nOrc table create statement\r\n```\r\nCREATE TABLE $testTable (\r\n    id bigint, \r\n    data string, \r\n    ts timestamp,\r\n    idRange String) \r\nUSING iceberg \r\nPARTITIONED BY (idRange, days(ts))\r\nTBLPROPERTIES (write.format.default='orc')\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891135950/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891138179","html_url":"https://github.com/apache/iceberg/pull/2898#issuecomment-891138179","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2898","id":891138179,"node_id":"IC_kwDOCW7NX841HbCD","user":{"login":"Reo-LEI","id":17312872,"node_id":"MDQ6VXNlcjE3MzEyODcy","avatar_url":"https://avatars.githubusercontent.com/u/17312872?v=4","gravatar_id":"","url":"https://api.github.com/users/Reo-LEI","html_url":"https://github.com/Reo-LEI","followers_url":"https://api.github.com/users/Reo-LEI/followers","following_url":"https://api.github.com/users/Reo-LEI/following{/other_user}","gists_url":"https://api.github.com/users/Reo-LEI/gists{/gist_id}","starred_url":"https://api.github.com/users/Reo-LEI/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Reo-LEI/subscriptions","organizations_url":"https://api.github.com/users/Reo-LEI/orgs","repos_url":"https://api.github.com/users/Reo-LEI/repos","events_url":"https://api.github.com/users/Reo-LEI/events{/privacy}","received_events_url":"https://api.github.com/users/Reo-LEI/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-02T15:55:50Z","updated_at":"2021-08-02T15:56:01Z","author_association":"CONTRIBUTOR","body":"> Additionally, I am wondering if there is possibly a need for different key selectors in the case of `range` partitioning. If one has an UPSERT stream of adds and deletes in general, will they be affected by this issue as well?\r\n\r\nI think we don't need a key selector for `range` partitioning, because iceberg-flink don't support `range` partitioning yet. And I think `range` partitioning is not easy to impl in streaming system, and we can't ignore this case now.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891138179/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891139997","html_url":"https://github.com/apache/iceberg/issues/2919#issuecomment-891139997","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2919","id":891139997,"node_id":"IC_kwDOCW7NX841Hbed","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-02T15:58:26Z","updated_at":"2021-08-02T15:58:26Z","author_association":"CONTRIBUTOR","body":"@massquantity: I think that is the issue here is that the new catalog configuration will work with Iceberg 0.12 or the current master. It is not yet working with 0.11.1 which is the current version","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891139997/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891149318","html_url":"https://github.com/apache/iceberg/issues/2919#issuecomment-891149318","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2919","id":891149318,"node_id":"IC_kwDOCW7NX841HdwG","user":{"login":"massquantity","id":28751760,"node_id":"MDQ6VXNlcjI4NzUxNzYw","avatar_url":"https://avatars.githubusercontent.com/u/28751760?v=4","gravatar_id":"","url":"https://api.github.com/users/massquantity","html_url":"https://github.com/massquantity","followers_url":"https://api.github.com/users/massquantity/followers","following_url":"https://api.github.com/users/massquantity/following{/other_user}","gists_url":"https://api.github.com/users/massquantity/gists{/gist_id}","starred_url":"https://api.github.com/users/massquantity/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/massquantity/subscriptions","organizations_url":"https://api.github.com/users/massquantity/orgs","repos_url":"https://api.github.com/users/massquantity/repos","events_url":"https://api.github.com/users/massquantity/events{/privacy}","received_events_url":"https://api.github.com/users/massquantity/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-02T16:10:10Z","updated_at":"2021-08-02T16:10:10Z","author_association":"NONE","body":"@pvary Thanks for your reply. So I need to build from source? Can you specify which line is the `new catalog configuration` ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891149318/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891160498","html_url":"https://github.com/apache/iceberg/issues/2899#issuecomment-891160498","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2899","id":891160498,"node_id":"IC_kwDOCW7NX841Hgey","user":{"login":"candily","id":761113,"node_id":"MDQ6VXNlcjc2MTExMw==","avatar_url":"https://avatars.githubusercontent.com/u/761113?v=4","gravatar_id":"","url":"https://api.github.com/users/candily","html_url":"https://github.com/candily","followers_url":"https://api.github.com/users/candily/followers","following_url":"https://api.github.com/users/candily/following{/other_user}","gists_url":"https://api.github.com/users/candily/gists{/gist_id}","starred_url":"https://api.github.com/users/candily/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/candily/subscriptions","organizations_url":"https://api.github.com/users/candily/orgs","repos_url":"https://api.github.com/users/candily/repos","events_url":"https://api.github.com/users/candily/events{/privacy}","received_events_url":"https://api.github.com/users/candily/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-02T16:25:14Z","updated_at":"2021-08-02T16:25:14Z","author_association":"NONE","body":"I see the same when trying https://iceberg.apache.org/spark-writes/#writing-to-partitioned-tables. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891160498/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891164131","html_url":"https://github.com/apache/iceberg/issues/2919#issuecomment-891164131","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2919","id":891164131,"node_id":"IC_kwDOCW7NX841HhXj","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-02T16:30:39Z","updated_at":"2021-08-02T16:30:39Z","author_association":"CONTRIBUTOR","body":"```\r\nSET iceberg.catalog.glue.catalog-impl=org.apache.iceberg.aws.glue.GlueCatalog;\r\nSET iceberg.catalog.glue.warehouse=s3://bucket_name/key;\r\nSET iceberg.catalog.glue.lock-impl=org.apache.iceberg.aws.glue.DynamoLockManager;\r\nSET iceberg.catalog.glue.lock.table=myGlueLockTable;\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891164131/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891165008","html_url":"https://github.com/apache/iceberg/pull/2898#issuecomment-891165008","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2898","id":891165008,"node_id":"IC_kwDOCW7NX841HhlQ","user":{"login":"Reo-LEI","id":17312872,"node_id":"MDQ6VXNlcjE3MzEyODcy","avatar_url":"https://avatars.githubusercontent.com/u/17312872?v=4","gravatar_id":"","url":"https://api.github.com/users/Reo-LEI","html_url":"https://github.com/Reo-LEI","followers_url":"https://api.github.com/users/Reo-LEI/followers","following_url":"https://api.github.com/users/Reo-LEI/following{/other_user}","gists_url":"https://api.github.com/users/Reo-LEI/gists{/gist_id}","starred_url":"https://api.github.com/users/Reo-LEI/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Reo-LEI/subscriptions","organizations_url":"https://api.github.com/users/Reo-LEI/orgs","repos_url":"https://api.github.com/users/Reo-LEI/repos","events_url":"https://api.github.com/users/Reo-LEI/events{/privacy}","received_events_url":"https://api.github.com/users/Reo-LEI/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-02T16:32:01Z","updated_at":"2021-08-02T16:32:01Z","author_association":"CONTRIBUTOR","body":"> EDIT - Finally, we've talked a lot about the CDC case that it map side only (though with a potential rebalance or hash inside of it), but can users still get themselves into an unhappy case if they have a retract stream that they re-key or something themselves (say they do some ETL on a CDC stream)?\r\n\r\nCould you give me some examples for this case? For upsert and retract stream, I think these streams should keyBy `equalityFields`(primary key) to keep update the same row with same pk. \r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891165008/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891175192","html_url":"https://github.com/apache/iceberg/issues/2919#issuecomment-891175192","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2919","id":891175192,"node_id":"IC_kwDOCW7NX841HkEY","user":{"login":"massquantity","id":28751760,"node_id":"MDQ6VXNlcjI4NzUxNzYw","avatar_url":"https://avatars.githubusercontent.com/u/28751760?v=4","gravatar_id":"","url":"https://api.github.com/users/massquantity","html_url":"https://github.com/massquantity","followers_url":"https://api.github.com/users/massquantity/followers","following_url":"https://api.github.com/users/massquantity/following{/other_user}","gists_url":"https://api.github.com/users/massquantity/gists{/gist_id}","starred_url":"https://api.github.com/users/massquantity/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/massquantity/subscriptions","organizations_url":"https://api.github.com/users/massquantity/orgs","repos_url":"https://api.github.com/users/massquantity/repos","events_url":"https://api.github.com/users/massquantity/events{/privacy}","received_events_url":"https://api.github.com/users/massquantity/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-02T16:49:16Z","updated_at":"2021-08-02T16:49:16Z","author_association":"NONE","body":"All right, thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891175192/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891301787","html_url":"https://github.com/apache/iceberg/issues/2917#issuecomment-891301787","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2917","id":891301787,"node_id":"IC_kwDOCW7NX841IC-b","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-02T20:12:52Z","updated_at":"2021-08-02T20:12:52Z","author_association":"CONTRIBUTOR","body":"Could the unknown kind come from using capital `String` for your type for `idRange`?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891301787/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891344911","html_url":"https://github.com/apache/iceberg/pull/2887#issuecomment-891344911","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2887","id":891344911,"node_id":"IC_kwDOCW7NX841INgP","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-02T21:25:40Z","updated_at":"2021-08-02T21:25:40Z","author_association":"CONTRIBUTOR","body":"@openinx thanks for the suggestion, I added tests for Spark, Flink and Hive.\r\n\r\n@rdblue I agree with the suggestions for the reserved table properties, I was a bit hesitated about if I should generalize it at this stage or not. If we want to do that, I have moved those static variables to `TableProperties` which I think is a better place to expose it, please let me know if you agree with this placement or not.\r\n\r\nFor the builder pattern, yes I absolutely agree that we should have a builder given the number of arguments in the static methods and the variation of inputs. I can do that with a separated PR, and I was hoping this can get into 0.12.0 since we have voted to finalize format v2. It would be a bit awkward if the spec is finalized but people cannot try it out. Please let me know if this is possible. If so I can focus on getting this PR merged first, and then I can do a best effort to get the builder in, which can be before or after 0.12.0.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891344911/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891355561","html_url":"https://github.com/apache/iceberg/pull/2890#issuecomment-891355561","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2890","id":891355561,"node_id":"IC_kwDOCW7NX841IQGp","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-02T21:46:03Z","updated_at":"2021-08-02T21:46:03Z","author_association":"CONTRIBUTOR","body":"There have been multiple discussions around this. I'll try to fetch the old thread on slack later today.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891355561/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891396065","html_url":"https://github.com/apache/iceberg/pull/2906#issuecomment-891396065","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2906","id":891396065,"node_id":"IC_kwDOCW7NX841IZ_h","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-02T23:19:23Z","updated_at":"2021-08-02T23:19:23Z","author_association":"CONTRIBUTOR","body":"Thanks for reviewing, @jackye1995! I'm updating the tests as this catches more. It's just a few places that were changed by the behavior fix.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891396065/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891437334","html_url":"https://github.com/apache/iceberg/pull/2923#issuecomment-891437334","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2923","id":891437334,"node_id":"IC_kwDOCW7NX841IkEW","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-03T01:20:26Z","updated_at":"2021-08-03T01:20:26Z","author_association":"CONTRIBUTOR","body":"cc @openinx @stevenzwu ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891437334/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891437770","html_url":"https://github.com/apache/iceberg/pull/2924#issuecomment-891437770","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2924","id":891437770,"node_id":"IC_kwDOCW7NX841IkLK","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-03T01:21:45Z","updated_at":"2021-08-03T01:21:45Z","author_association":"CONTRIBUTOR","body":"cc @stevenzwu @openinx ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891437770/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891437982","html_url":"https://github.com/apache/iceberg/pull/2924#issuecomment-891437982","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2924","id":891437982,"node_id":"IC_kwDOCW7NX841IkOe","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-03T01:22:27Z","updated_at":"2021-08-03T01:22:27Z","author_association":"CONTRIBUTOR","body":"I need a writer factory for Flink so that I can introduce new task writers.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891437982/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891459373","html_url":"https://github.com/apache/iceberg/pull/2867#issuecomment-891459373","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2867","id":891459373,"node_id":"IC_kwDOCW7NX841Ipct","user":{"login":"hameizi","id":18445460,"node_id":"MDQ6VXNlcjE4NDQ1NDYw","avatar_url":"https://avatars.githubusercontent.com/u/18445460?v=4","gravatar_id":"","url":"https://api.github.com/users/hameizi","html_url":"https://github.com/hameizi","followers_url":"https://api.github.com/users/hameizi/followers","following_url":"https://api.github.com/users/hameizi/following{/other_user}","gists_url":"https://api.github.com/users/hameizi/gists{/gist_id}","starred_url":"https://api.github.com/users/hameizi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hameizi/subscriptions","organizations_url":"https://api.github.com/users/hameizi/orgs","repos_url":"https://api.github.com/users/hameizi/repos","events_url":"https://api.github.com/users/hameizi/events{/privacy}","received_events_url":"https://api.github.com/users/hameizi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-03T02:16:27Z","updated_at":"2021-08-03T02:16:27Z","author_association":"CONTRIBUTOR","body":"> @hameizi, could you please be more specific? How does this determine which files to rewrite? In what tasks are they rewritten? Does this introduce new operators? Are files rewritten before initial commit or afterward in a replace commit?\r\n> \r\n> There are a lot of details for a feature like this that need to be clear.\r\n\r\n@rdblue Hi, i have update the PR description.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891459373/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891459560","html_url":"https://github.com/apache/iceberg/issues/2903#issuecomment-891459560","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2903","id":891459560,"node_id":"IC_kwDOCW7NX841Ipfo","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-03T02:16:46Z","updated_at":"2021-08-03T02:16:46Z","author_association":"CONTRIBUTOR","body":"@GrigorievNick You have a few options.\r\n\r\nYou can set `'write.storage-object.enabled'=true` in the table properties, which will append some randomness to the beginning of the path for the data. This would still keep the folder hierarchy, but would allow you to spread data files across multiple partitions.\r\n\r\nTo be able to have full control over the data layout, you can implement your own LocationProvider and then set `write.location-provider.impl`. Here is a test that uses a custom location provider: https://github.com/apache/iceberg/blob/90225d6c9413016d611e2ce5eff37db1bc1b4fc5/core/src/test/java/org/apache/iceberg/TestLocationProvider.java\r\n\r\nSee also the documentation on writing your own file io implementation, location provider, or catalog: https://iceberg.apache.org/custom-catalog/#custom-file-io-implementation\r\n\r\nHowever, altering the files outside of Iceberg is going to cause issues as the data files are stored in the metadata lists. So I don't know how accomplishable your ultimate goal is. Perhaps others can weigh in, but the custom location provider (or more likely custom FileIO and LocationProvider - which are relatively small interfaces) could be used to at least get all of the data into a flat folder structure. But coalescing the files after the fact is something that you'd need to do with some sort of Iceberg API (e.g. maybe read in the files to coalesce, create a temporary view of that data, and then use `MERGE INTO` or `INSERT` to handle the write), so that appropriate metadata is written.\r\n\r\nHope that helps.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891459560/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891486040","html_url":"https://github.com/apache/iceberg/pull/2898#issuecomment-891486040","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2898","id":891486040,"node_id":"IC_kwDOCW7NX841Iv9Y","user":{"login":"coolderli","id":38486782,"node_id":"MDQ6VXNlcjM4NDg2Nzgy","avatar_url":"https://avatars.githubusercontent.com/u/38486782?v=4","gravatar_id":"","url":"https://api.github.com/users/coolderli","html_url":"https://github.com/coolderli","followers_url":"https://api.github.com/users/coolderli/followers","following_url":"https://api.github.com/users/coolderli/following{/other_user}","gists_url":"https://api.github.com/users/coolderli/gists{/gist_id}","starred_url":"https://api.github.com/users/coolderli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coolderli/subscriptions","organizations_url":"https://api.github.com/users/coolderli/orgs","repos_url":"https://api.github.com/users/coolderli/repos","events_url":"https://api.github.com/users/coolderli/events{/privacy}","received_events_url":"https://api.github.com/users/coolderli/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-03T03:15:48Z","updated_at":"2021-08-03T03:15:48Z","author_association":"CONTRIBUTOR","body":"\r\n> Actually set `write.distribution-mode = hash` can not resolve this. Because CDC data shoule be distributed to primary key but not partition fields. For example, an iceberg table has equalityFields (dt, hour, id) and partition fields (dt, hour). If set `write.distribution-mode = hash`, the CDC data will be keyBy (dt, hour), and we can not ensure same id CDC data will send to same `IcebergStreamWriter`.\r\n\r\nI'm a litter confused. Assume that the upstream data is orderly, if the CDC data are key by (dt, hour), the same id should be send to the same `IcebergStreamWriter`.\r\n\r\n`dt=2021-08-03, hour=10, id=1` and `dt=2021-08-03, hour=10, id=2` should be the same `IcebergStreamWriter`. I think a partition is just a subset of the primary key. If anything is wrong, please let me know. Thanks!\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891486040/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891494467","html_url":"https://github.com/apache/iceberg/issues/1554#issuecomment-891494467","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1554","id":891494467,"node_id":"IC_kwDOCW7NX841IyBD","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-03T03:38:15Z","updated_at":"2021-08-03T03:38:15Z","author_association":"CONTRIBUTOR","body":"resolve by PR #2923 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891494467/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891562500","html_url":"https://github.com/apache/iceberg/pull/2916#issuecomment-891562500","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2916","id":891562500,"node_id":"IC_kwDOCW7NX841JCoE","user":{"login":"coolderli","id":38486782,"node_id":"MDQ6VXNlcjM4NDg2Nzgy","avatar_url":"https://avatars.githubusercontent.com/u/38486782?v=4","gravatar_id":"","url":"https://api.github.com/users/coolderli","html_url":"https://github.com/coolderli","followers_url":"https://api.github.com/users/coolderli/followers","following_url":"https://api.github.com/users/coolderli/following{/other_user}","gists_url":"https://api.github.com/users/coolderli/gists{/gist_id}","starred_url":"https://api.github.com/users/coolderli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coolderli/subscriptions","organizations_url":"https://api.github.com/users/coolderli/orgs","repos_url":"https://api.github.com/users/coolderli/repos","events_url":"https://api.github.com/users/coolderli/events{/privacy}","received_events_url":"https://api.github.com/users/coolderli/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-03T06:11:59Z","updated_at":"2021-08-03T06:11:59Z","author_association":"CONTRIBUTOR","body":"I have another question. why `DEFAULT_RECORDS_NUM_THRESHOLD` is set to `100_000L`. Is there any experience about how to set this value?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891562500/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891572481","html_url":"https://github.com/apache/iceberg/pull/2916#issuecomment-891572481","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2916","id":891572481,"node_id":"IC_kwDOCW7NX841JFEB","user":{"login":"hameizi","id":18445460,"node_id":"MDQ6VXNlcjE4NDQ1NDYw","avatar_url":"https://avatars.githubusercontent.com/u/18445460?v=4","gravatar_id":"","url":"https://api.github.com/users/hameizi","html_url":"https://github.com/hameizi","followers_url":"https://api.github.com/users/hameizi/followers","following_url":"https://api.github.com/users/hameizi/following{/other_user}","gists_url":"https://api.github.com/users/hameizi/gists{/gist_id}","starred_url":"https://api.github.com/users/hameizi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hameizi/subscriptions","organizations_url":"https://api.github.com/users/hameizi/orgs","repos_url":"https://api.github.com/users/hameizi/repos","events_url":"https://api.github.com/users/hameizi/events{/privacy}","received_events_url":"https://api.github.com/users/hameizi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-03T06:30:13Z","updated_at":"2021-08-03T06:30:13Z","author_association":"CONTRIBUTOR","body":"> I have another question. why `DEFAULT_RECORDS_NUM_THRESHOLD` is set to `100_000L`. Is there any experience about how to set this value?\r\n\r\nThis value depend on the scene that whether your flink job will update one primary key frequently in one checkpoint and whether you have enough memory in flink job because these pos-delete is cached in memory before they are flush in pos-delete file. If in your sence you found there is too much pos-delete in one checkpoint inteval you can try config this configuration and add you flink job memory. At most sence 100_000 is enough. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891572481/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891584337","html_url":"https://github.com/apache/iceberg/pull/2898#issuecomment-891584337","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2898","id":891584337,"node_id":"IC_kwDOCW7NX841JH9R","user":{"login":"Reo-LEI","id":17312872,"node_id":"MDQ6VXNlcjE3MzEyODcy","avatar_url":"https://avatars.githubusercontent.com/u/17312872?v=4","gravatar_id":"","url":"https://api.github.com/users/Reo-LEI","html_url":"https://github.com/Reo-LEI","followers_url":"https://api.github.com/users/Reo-LEI/followers","following_url":"https://api.github.com/users/Reo-LEI/following{/other_user}","gists_url":"https://api.github.com/users/Reo-LEI/gists{/gist_id}","starred_url":"https://api.github.com/users/Reo-LEI/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Reo-LEI/subscriptions","organizations_url":"https://api.github.com/users/Reo-LEI/orgs","repos_url":"https://api.github.com/users/Reo-LEI/repos","events_url":"https://api.github.com/users/Reo-LEI/events{/privacy}","received_events_url":"https://api.github.com/users/Reo-LEI/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-03T06:52:59Z","updated_at":"2021-08-03T06:52:59Z","author_association":"CONTRIBUTOR","body":"> > Actually set `write.distribution-mode = hash` can not resolve this. Because CDC data shoule be distributed to primary key but not partition fields. For example, an iceberg table has equalityFields (dt, hour, id) and partition fields (dt, hour). If set `write.distribution-mode = hash`, the CDC data will be keyBy (dt, hour), and we can not ensure same id CDC data will send to same `IcebergStreamWriter`.\r\n> \r\n> I'm a litter confused. Assume that the upstream data is orderly, if the CDC data are key by (dt, hour), the same id should be send to the same `IcebergStreamWriter`.\r\n> \r\n> `dt=2021-08-03, hour=10, id=1` and `dt=2021-08-03, hour=10, id=2` should be the same `IcebergStreamWriter`. I think a partition is just a subset of the primary key. If anything is wrong, please let me know. Thanks!\r\n\r\nI think my example is inappropriate for CDC case which upstream of `IcebergStreamingWriter` is orderly. Because CDC data have -U record, that partition values can let record route to correct writer and delet the old record. \r\n\r\nI think  set `write.distribution-mode = hash` will work only on iceberg table have partition fields and inpurt stream is CDC case. Onec inpurt stream is upsert stream or iceberg table is an unpartitioned table which don't have any partition fields,  set `write.distribution-mode = hash` will fail.\r\n\r\nThe reason I don't agree with use `write.distribution-mode = hash` to avoid this problem is `write.distribution-mode` is use to reduce the number of small file but not to resolve row-level delete. We should not bind distribution-mode to row-level delete.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891584337/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891641862","html_url":"https://github.com/apache/iceberg/issues/2917#issuecomment-891641862","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2917","id":891641862,"node_id":"IC_kwDOCW7NX841JWAG","user":{"login":"GrigorievNick","id":16338643,"node_id":"MDQ6VXNlcjE2MzM4NjQz","avatar_url":"https://avatars.githubusercontent.com/u/16338643?v=4","gravatar_id":"","url":"https://api.github.com/users/GrigorievNick","html_url":"https://github.com/GrigorievNick","followers_url":"https://api.github.com/users/GrigorievNick/followers","following_url":"https://api.github.com/users/GrigorievNick/following{/other_user}","gists_url":"https://api.github.com/users/GrigorievNick/gists{/gist_id}","starred_url":"https://api.github.com/users/GrigorievNick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/GrigorievNick/subscriptions","organizations_url":"https://api.github.com/users/GrigorievNick/orgs","repos_url":"https://api.github.com/users/GrigorievNick/repos","events_url":"https://api.github.com/users/GrigorievNick/events{/privacy}","received_events_url":"https://api.github.com/users/GrigorievNick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-03T08:21:39Z","updated_at":"2021-08-03T08:21:39Z","author_association":"CONTRIBUTOR","body":"@kbendick Thank you, it's definitely an issue. \r\nSo thx you guys for the help, both your answers id definitely what I am looking for.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891641862/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891647675","html_url":"https://github.com/apache/iceberg/issues/2903#issuecomment-891647675","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2903","id":891647675,"node_id":"IC_kwDOCW7NX841JXa7","user":{"login":"GrigorievNick","id":16338643,"node_id":"MDQ6VXNlcjE2MzM4NjQz","avatar_url":"https://avatars.githubusercontent.com/u/16338643?v=4","gravatar_id":"","url":"https://api.github.com/users/GrigorievNick","html_url":"https://github.com/GrigorievNick","followers_url":"https://api.github.com/users/GrigorievNick/followers","following_url":"https://api.github.com/users/GrigorievNick/following{/other_user}","gists_url":"https://api.github.com/users/GrigorievNick/gists{/gist_id}","starred_url":"https://api.github.com/users/GrigorievNick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/GrigorievNick/subscriptions","organizations_url":"https://api.github.com/users/GrigorievNick/orgs","repos_url":"https://api.github.com/users/GrigorievNick/repos","events_url":"https://api.github.com/users/GrigorievNick/events{/privacy}","received_events_url":"https://api.github.com/users/GrigorievNick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-03T08:30:03Z","updated_at":"2021-08-03T10:57:45Z","author_association":"CONTRIBUTOR","body":">You can set 'write.storage-object.enabled'=true in the table properties, which will append some randomness to the beginning of the path for the data. This would still keep the folder hierarchy but would allow you to spread data files across multiple partitions.\r\n\r\nif every file will have a random prefix, it will satisfy my requirements. (As I understand that because of s3 policy, they try to create partition based on the first 3 symbols.)\r\nbut unfortunately, I am not able to see any changes when specify `'write.storage-object.enabled'=true` .\r\n@kbendick what iceberg version have it? I even can't find this string in the[ code](https://github.com/apache/iceberg/blob/master/core/src/main/java/org/apache/iceberg/TableProperties.java).\r\n\r\n>To be able to have full control over the data layout, you can implement your own LocationProvider and then set write.location-provider.impl. Here is a test that uses a custom location provider: https://github.com/apache/iceberg/blob/90225d6c9413016d611e2ce5eff37db1bc1b4fc5/core/src/test/java/org/apache/iceberg/TestLocationProvider.java\r\n\r\nThank you for your answer, I will try to do it.\r\n\r\n>But coalescing the files after the fact is something that you'd need to do with some sort of Iceberg API (e.g. maybe read in the files to coalesce, create a temporary view of that data, and then use MERGE INTO or INSERT to handle the write), so that appropriate metadata is written.\r\n\r\nI think I can write my custom rewrite based on current rewrite actions.\r\nThe actions list for split partitions:\r\n1. Scan statistics and find which partition is too big.\r\n2. Calculate new ranges.\r\n3. Taking to attention that files are sorted by column which used to build ranges. I can find the specific files which must be split into new partitions.\r\n4. Split a file into 2.\r\n5. Take all files from previous partitions, and create two new manifests with new data.\r\n6. mark all files in the previous manifest deleted.\r\n\r\nBut this is possible only if data is physically stored in one folder, and only metadata control partition layout.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891647675/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891648628","html_url":"https://github.com/apache/iceberg/issues/2927#issuecomment-891648628","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2927","id":891648628,"node_id":"IC_kwDOCW7NX841JXp0","user":{"login":"TangYan-1","id":76996884,"node_id":"MDQ6VXNlcjc2OTk2ODg0","avatar_url":"https://avatars.githubusercontent.com/u/76996884?v=4","gravatar_id":"","url":"https://api.github.com/users/TangYan-1","html_url":"https://github.com/TangYan-1","followers_url":"https://api.github.com/users/TangYan-1/followers","following_url":"https://api.github.com/users/TangYan-1/following{/other_user}","gists_url":"https://api.github.com/users/TangYan-1/gists{/gist_id}","starred_url":"https://api.github.com/users/TangYan-1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TangYan-1/subscriptions","organizations_url":"https://api.github.com/users/TangYan-1/orgs","repos_url":"https://api.github.com/users/TangYan-1/repos","events_url":"https://api.github.com/users/TangYan-1/events{/privacy}","received_events_url":"https://api.github.com/users/TangYan-1/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-03T08:31:25Z","updated_at":"2021-08-03T08:31:25Z","author_association":"NONE","body":"<img width=\"1424\" alt=\"Screen Shot 2021-08-03 at 4 29 50 PM\" src=\"https://user-images.githubusercontent.com/76996884/127984138-da249e32-1e8c-45b3-b7da-e66f1efdcbf4.png\">\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891648628/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891657091","html_url":"https://github.com/apache/iceberg/issues/2927#issuecomment-891657091","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2927","id":891657091,"node_id":"IC_kwDOCW7NX841JZuD","user":{"login":"TangYan-1","id":76996884,"node_id":"MDQ6VXNlcjc2OTk2ODg0","avatar_url":"https://avatars.githubusercontent.com/u/76996884?v=4","gravatar_id":"","url":"https://api.github.com/users/TangYan-1","html_url":"https://github.com/TangYan-1","followers_url":"https://api.github.com/users/TangYan-1/followers","following_url":"https://api.github.com/users/TangYan-1/following{/other_user}","gists_url":"https://api.github.com/users/TangYan-1/gists{/gist_id}","starred_url":"https://api.github.com/users/TangYan-1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TangYan-1/subscriptions","organizations_url":"https://api.github.com/users/TangYan-1/orgs","repos_url":"https://api.github.com/users/TangYan-1/repos","events_url":"https://api.github.com/users/TangYan-1/events{/privacy}","received_events_url":"https://api.github.com/users/TangYan-1/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-03T08:43:35Z","updated_at":"2021-08-03T08:43:35Z","author_association":"NONE","body":"My hive version is 2.1.1-cdh6.3.0","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891657091/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891661349","html_url":"https://github.com/apache/iceberg/issues/2927#issuecomment-891661349","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2927","id":891661349,"node_id":"IC_kwDOCW7NX841Jawl","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-03T08:49:58Z","updated_at":"2021-08-03T08:50:20Z","author_association":"CONTRIBUTOR","body":"@TangYan-1: Based on the `DESCRIBE TABLE` output, I guess the problem is that you have to set the catalog configuration in Hive as well as a session config before executing the query:\r\n```\r\nset iceberg.mr.catalog = hive;\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891661349/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891666657","html_url":"https://github.com/apache/iceberg/issues/2927#issuecomment-891666657","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2927","id":891666657,"node_id":"IC_kwDOCW7NX841JcDh","user":{"login":"TangYan-1","id":76996884,"node_id":"MDQ6VXNlcjc2OTk2ODg0","avatar_url":"https://avatars.githubusercontent.com/u/76996884?v=4","gravatar_id":"","url":"https://api.github.com/users/TangYan-1","html_url":"https://github.com/TangYan-1","followers_url":"https://api.github.com/users/TangYan-1/followers","following_url":"https://api.github.com/users/TangYan-1/following{/other_user}","gists_url":"https://api.github.com/users/TangYan-1/gists{/gist_id}","starred_url":"https://api.github.com/users/TangYan-1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TangYan-1/subscriptions","organizations_url":"https://api.github.com/users/TangYan-1/orgs","repos_url":"https://api.github.com/users/TangYan-1/repos","events_url":"https://api.github.com/users/TangYan-1/events{/privacy}","received_events_url":"https://api.github.com/users/TangYan-1/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-03T08:57:33Z","updated_at":"2021-08-03T08:57:33Z","author_association":"NONE","body":"@pvary  Thanks for your quick reply. The query can work after adding 'set iceberg.mr.catalog = hive;'. But I found a new issue, when  I use SELECT * from iceberg_table_hive_createdbyspark2 where id='1', the query fails in the below new errrors.\r\njava.lang.NoSuchMethodError: org.apache.hadoop.hive.ql.io.sarg.ConvertAstToSearchArg.create(Lorg/apache/hadoop/conf/Configuration;Lorg/apache/hadoop/hive/ql/plan/ExprNodeGenericFuncDesc;)Lorg/apache/hadoop/hive/ql/io/sarg/SearchArgument;\r\n\tat org.apache.iceberg.mr.hive.HiveIcebergInputFormat.getSplits(HiveIcebergInputFormat.java:59) ~[iceberg-hive-runtime-0.11.1.jar:?]\r\n\tat org.apache.hadoop.hive.ql.io.HiveInputFormat.addSplitsForGroup(HiveInputFormat.java:349) ~[hive-exec-2.1.1-cdh6.3.0.jar:2.1.1-cdh6.3.0]\r\nCould you please share any clues?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891666657/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891672012","html_url":"https://github.com/apache/iceberg/issues/2927#issuecomment-891672012","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2927","id":891672012,"node_id":"IC_kwDOCW7NX841JdXM","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-03T09:04:54Z","updated_at":"2021-08-03T09:04:54Z","author_association":"CONTRIBUTOR","body":"`ConvertAstToSearchArg` does not have the method with the correct parameters available. https://issues.apache.org/jira/browse/HIVE-15269 introduces this parameters and it is only available since Hive 2.2.0 \r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891672012/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891673666","html_url":"https://github.com/apache/iceberg/issues/2927#issuecomment-891673666","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2927","id":891673666,"node_id":"IC_kwDOCW7NX841JdxC","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-03T09:07:09Z","updated_at":"2021-08-03T09:07:09Z","author_association":"CONTRIBUTOR","body":"The Apache Iceberg tests are run with Hive 2.3.8 and Hive 3.1.2 so you can try it out with those versions, and we are also working on a CDH version.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891673666/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891770152","html_url":"https://github.com/apache/iceberg/issues/2764#issuecomment-891770152","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2764","id":891770152,"node_id":"IC_kwDOCW7NX841J1Uo","user":{"login":"skandasa23","id":86716100,"node_id":"MDQ6VXNlcjg2NzE2MTAw","avatar_url":"https://avatars.githubusercontent.com/u/86716100?v=4","gravatar_id":"","url":"https://api.github.com/users/skandasa23","html_url":"https://github.com/skandasa23","followers_url":"https://api.github.com/users/skandasa23/followers","following_url":"https://api.github.com/users/skandasa23/following{/other_user}","gists_url":"https://api.github.com/users/skandasa23/gists{/gist_id}","starred_url":"https://api.github.com/users/skandasa23/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/skandasa23/subscriptions","organizations_url":"https://api.github.com/users/skandasa23/orgs","repos_url":"https://api.github.com/users/skandasa23/repos","events_url":"https://api.github.com/users/skandasa23/events{/privacy}","received_events_url":"https://api.github.com/users/skandasa23/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-03T11:29:47Z","updated_at":"2021-08-03T11:29:47Z","author_association":"NONE","body":"Thank you for the detailed comments @rdblue , issue [2782](https://github.com/apache/iceberg/pull/2782) seems to be tracking the delete/overwrite mutations already, wasn't aware of it earlier. \r\nrow-delta commit - guess you are talking about merge on read semantics?\r\nI'm newer to Iceberg and catching up on newer rewrite commits. Will check those and get back on the approach for deduplication support while compaction.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891770152/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891943246","html_url":"https://github.com/apache/iceberg/pull/2826#issuecomment-891943246","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2826","id":891943246,"node_id":"IC_kwDOCW7NX841KflO","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-03T15:29:05Z","updated_at":"2021-08-03T15:29:05Z","author_association":"CONTRIBUTOR","body":"> Looks good to me, If it is possible I would try to separate out the build changes from the format changes if possible. Like first doing a bump of baseline if we can do that without the gradle change then doing the gradle change.\r\n> \r\n> But I don't have strong feelings about that, and if all of our artifacts are the same before and after this Patch I think we are ok. I would recommend we double check the spark31 - spark tests to make sure their runtime class-paths are still correct.\r\n\r\nI tried to do that by creating 4 commits and keeping relevant things related to each other within a particular commit. I'm not sure doing the commits in reverse order is better here as I see those as logical steps: 1) Upgrade to Gradle 7 with related plugins that don't work otherwise 2) fix formatting or errorprone stuff separately due to newer versions in separate commits","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891943246/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891978223","html_url":"https://github.com/apache/iceberg/pull/2867#issuecomment-891978223","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2867","id":891978223,"node_id":"IC_kwDOCW7NX841KoHv","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-03T16:13:30Z","updated_at":"2021-08-03T16:13:30Z","author_association":"CONTRIBUTOR","body":"From the description, it sounds like the rewrite happens in the committer task rather than in parallel. Is there a good way to make this happen in parallel instead?\r\n\r\nWhat we discussed elsewhere was doing a compaction by adding a new parallel stage and second committer after the initial committer. The current commit task would output committed `DataFile` instances after the commit succeeds. Then those would be sent to compaction writers using `keyBy` and the partition. Once a compacted data file is large enough, the compaction writer will emit it as a `DataFile` along with the `DataFile` instances that were compacted. Those would be collected by the compaction committer, which would commit a rewrite every checkpoint where there is at least one compacted file.\r\n\r\nI think that we should plan on having some parallelism here, or else this is not going to be a very useful feature.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891978223/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891984101","html_url":"https://github.com/apache/iceberg/pull/2913#issuecomment-891984101","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2913","id":891984101,"node_id":"IC_kwDOCW7NX841Kpjl","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-03T16:21:34Z","updated_at":"2021-08-03T16:21:34Z","author_association":"CONTRIBUTOR","body":"Thanks, @findepi!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891984101/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891995749","html_url":"https://github.com/apache/iceberg/pull/2925#issuecomment-891995749","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2925","id":891995749,"node_id":"IC_kwDOCW7NX841KsZl","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-03T16:38:59Z","updated_at":"2021-08-03T16:38:59Z","author_association":"COLLABORATOR","body":"@rdblue  if you could look when you have time, thanks","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/891995749/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/892005971","html_url":"https://github.com/apache/iceberg/pull/2926#issuecomment-892005971","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2926","id":892005971,"node_id":"IC_kwDOCW7NX841Ku5T","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-03T16:54:34Z","updated_at":"2021-08-03T16:55:07Z","author_association":"COLLABORATOR","body":"@rdblue @RussellSpitzer fyi when you guys get some time, thanks","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/892005971/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/892029157","html_url":"https://github.com/apache/iceberg/pull/2923#issuecomment-892029157","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2923","id":892029157,"node_id":"IC_kwDOCW7NX841K0jl","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-03T17:30:04Z","updated_at":"2021-08-03T17:30:04Z","author_association":"CONTRIBUTOR","body":"Thanks for reviewing, @stevenzwu!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/892029157/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/892030925","html_url":"https://github.com/apache/iceberg/pull/2887#issuecomment-892030925","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2887","id":892030925,"node_id":"IC_kwDOCW7NX841K0_N","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-03T17:32:47Z","updated_at":"2021-08-03T17:32:47Z","author_association":"CONTRIBUTOR","body":"@rdblue fixed based on your comments, should be good for another look","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/892030925/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/892031173","html_url":"https://github.com/apache/iceberg/pull/2906#issuecomment-892031173","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2906","id":892031173,"node_id":"IC_kwDOCW7NX841K1DF","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-03T17:33:11Z","updated_at":"2021-08-03T17:33:11Z","author_association":"CONTRIBUTOR","body":"Late +1 from me too.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/892031173/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/892032453","html_url":"https://github.com/apache/iceberg/pull/2867#issuecomment-892032453","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2867","id":892032453,"node_id":"IC_kwDOCW7NX841K1XF","user":{"login":"hameizi","id":18445460,"node_id":"MDQ6VXNlcjE4NDQ1NDYw","avatar_url":"https://avatars.githubusercontent.com/u/18445460?v=4","gravatar_id":"","url":"https://api.github.com/users/hameizi","html_url":"https://github.com/hameizi","followers_url":"https://api.github.com/users/hameizi/followers","following_url":"https://api.github.com/users/hameizi/following{/other_user}","gists_url":"https://api.github.com/users/hameizi/gists{/gist_id}","starred_url":"https://api.github.com/users/hameizi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hameizi/subscriptions","organizations_url":"https://api.github.com/users/hameizi/orgs","repos_url":"https://api.github.com/users/hameizi/repos","events_url":"https://api.github.com/users/hameizi/events{/privacy}","received_events_url":"https://api.github.com/users/hameizi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-03T17:35:12Z","updated_at":"2021-08-03T17:35:12Z","author_association":"CONTRIBUTOR","body":"I have been make compaction in parallel formerly ,but i abort it because i think it will cause maybe be there is not just one compaction are executing because of current compaction overtime. In addition in this PR the compaction will not block handle data in flink job because the data channel will be not block just when snapshot function completed so for handle data compaction is in parallel in this PR.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/892032453/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/892035688","html_url":"https://github.com/apache/iceberg/pull/2929#issuecomment-892035688","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2929","id":892035688,"node_id":"IC_kwDOCW7NX841K2Jo","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-03T17:40:16Z","updated_at":"2021-08-03T17:40:16Z","author_association":"CONTRIBUTOR","body":"cc @openinx @rdblue @RussellSpitzer @kbendick @flyrain @karuppayya","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/892035688/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/892069400","html_url":"https://github.com/apache/iceberg/pull/2926#issuecomment-892069400","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2926","id":892069400,"node_id":"IC_kwDOCW7NX841K-YY","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-03T18:30:00Z","updated_at":"2021-08-03T18:30:00Z","author_association":"COLLABORATOR","body":"Thanks for fast response!  Not that i know of","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/892069400/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/892118079","html_url":"https://github.com/apache/iceberg/pull/2929#issuecomment-892118079","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2929","id":892118079,"node_id":"IC_kwDOCW7NX841LKQ_","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-03T19:48:05Z","updated_at":"2021-08-03T19:48:05Z","author_association":"CONTRIBUTOR","body":"Good catch, @aokolnychyi. Any context on where you found this and what kinds of issues it may have caused?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/892118079/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/892128210","html_url":"https://github.com/apache/iceberg/pull/2929#issuecomment-892128210","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2929","id":892128210,"node_id":"IC_kwDOCW7NX841LMvS","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-03T20:03:57Z","updated_at":"2021-08-03T20:05:17Z","author_association":"CONTRIBUTOR","body":"I was using this in new writers I have locally to keep track of what partitions we've seen. I had partitions as nulls for unpartitioned writes and it lead to inability to retrieve an existing writer.\r\n\r\nDon't have a place in the existing codebase that is affected (did not check, to be precise).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/892128210/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]