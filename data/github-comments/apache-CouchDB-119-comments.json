[{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1617668261","html_url":"https://github.com/apache/couchdb/issues/2873#issuecomment-1617668261","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2873","id":1617668261,"node_id":"IC_kwDOAAMmUc5ga6il","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-03T08:58:58Z","updated_at":"2023-07-03T08:58:58Z","author_association":"MEMBER","body":"Unless someone can point to an RFC or other authoritative source I don't think CouchDB will support receiving JWT's in a cookie. We require them to be sent as bearer tokens.  ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1617668261/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1617828335","html_url":"https://github.com/apache/couchdb/issues/4649#issuecomment-1617828335","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4649","id":1617828335,"node_id":"IC_kwDOAAMmUc5gbhnv","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-03T10:21:04Z","updated_at":"2023-07-03T10:21:33Z","author_association":"MEMBER","body":"Hi Ronnie,\r\n\r\nThe use of \"id\" versus \"_id\" in different places in the CouchDB api has been there since the beginning, and is intentional. We are not changing it, not least because users may have legitimately used \"id\" and \"rev\" properties in their bodies.\r\n\r\nThe rule is simple, where user content _could_ appear, CouchDB uses underscore prefix (and prohibits users from doing so). Where it is unambiguous, in the example you cite or the \"id\" parameter in _all_docs response, we omit the underscore prefix.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1617828335/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1618537625","html_url":"https://github.com/apache/couchdb/issues/4635#issuecomment-1618537625","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4635","id":1618537625,"node_id":"IC_kwDOAAMmUc5geOyZ","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-03T14:55:30Z","updated_at":"2023-07-03T14:55:30Z","author_association":"MEMBER","body":"Not a bug.\r\n\r\nCouchDB expects to own the full url path and does not support a prefix. Replication will fail, etc.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1618537625/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1618642521","html_url":"https://github.com/apache/couchdb/issues/2873#issuecomment-1618642521","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2873","id":1618642521,"node_id":"IC_kwDOAAMmUc5geoZZ","user":{"login":"ronnievsmith","id":12751611,"node_id":"MDQ6VXNlcjEyNzUxNjEx","avatar_url":"https://avatars.githubusercontent.com/u/12751611?v=4","gravatar_id":"","url":"https://api.github.com/users/ronnievsmith","html_url":"https://github.com/ronnievsmith","followers_url":"https://api.github.com/users/ronnievsmith/followers","following_url":"https://api.github.com/users/ronnievsmith/following{/other_user}","gists_url":"https://api.github.com/users/ronnievsmith/gists{/gist_id}","starred_url":"https://api.github.com/users/ronnievsmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ronnievsmith/subscriptions","organizations_url":"https://api.github.com/users/ronnievsmith/orgs","repos_url":"https://api.github.com/users/ronnievsmith/repos","events_url":"https://api.github.com/users/ronnievsmith/events{/privacy}","received_events_url":"https://api.github.com/users/ronnievsmith/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-03T15:24:10Z","updated_at":"2023-07-03T15:24:38Z","author_association":"NONE","body":"CouchDB itself uses authentication tokens as _HTTPOnly_ cookies. The `AuthSession` cookie below is from Couch.\r\n\r\nSomebody on the CouchDB development team understands the need for implementing accepting JWT's via cookies.\r\n\r\n<img width=\"706\" alt=\"image\" src=\"https://github.com/apache/couchdb/assets/12751611/5cbdb113-ca9a-47b4-ab58-8b8cc9ba1899\">\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1618642521/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1618947557","html_url":"https://github.com/apache/couchdb/issues/2873#issuecomment-1618947557","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2873","id":1618947557,"node_id":"IC_kwDOAAMmUc5gfy3l","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-03T17:54:09Z","updated_at":"2023-07-03T17:54:09Z","author_association":"MEMBER","body":"There is no \"need\" for us to do so. We are well-versed in the various cookie properties, including HttpOnly.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1618947557/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1618977062","html_url":"https://github.com/apache/couchdb/issues/2873#issuecomment-1618977062","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2873","id":1618977062,"node_id":"IC_kwDOAAMmUc5gf6Em","user":{"login":"ronnievsmith","id":12751611,"node_id":"MDQ6VXNlcjEyNzUxNjEx","avatar_url":"https://avatars.githubusercontent.com/u/12751611?v=4","gravatar_id":"","url":"https://api.github.com/users/ronnievsmith","html_url":"https://github.com/ronnievsmith","followers_url":"https://api.github.com/users/ronnievsmith/followers","following_url":"https://api.github.com/users/ronnievsmith/following{/other_user}","gists_url":"https://api.github.com/users/ronnievsmith/gists{/gist_id}","starred_url":"https://api.github.com/users/ronnievsmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ronnievsmith/subscriptions","organizations_url":"https://api.github.com/users/ronnievsmith/orgs","repos_url":"https://api.github.com/users/ronnievsmith/repos","events_url":"https://api.github.com/users/ronnievsmith/events{/privacy}","received_events_url":"https://api.github.com/users/ronnievsmith/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-03T18:22:11Z","updated_at":"2023-07-03T18:22:11Z","author_association":"NONE","body":"I'm not understanding why you refuse to allow app developers to take advantage of http cookies as bearers of auth tokens just like Couch does?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1618977062/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1618983984","html_url":"https://github.com/apache/couchdb/issues/4663#issuecomment-1618983984","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4663","id":1618983984,"node_id":"IC_kwDOAAMmUc5gf7ww","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-03T18:30:16Z","updated_at":"2023-07-03T18:30:35Z","author_association":"MEMBER","body":"The JWT handler (and the much older proxy handler) exists to externalise authentication/authorization decisions, including whether a user has admin privileges. The CouchDB administrator needs to make several privileged changes to enable this behaviour. Enabling the handler itself, and then populating `[jwt_keys]` they trust to issue JWT tokens.\r\n\r\nI'd be happy to merge an enhancement to the handler that rejects JWT tokens with the `_admin` role as an option (off by default for backward compatibility reasons), if you were so minded.\r\n\r\nI think what won't work is 'validating' the token against the `[admins]` in the .ini file as that only contains a (salted) password hash; the JWT obviously doesn't include the password that we'd hash to compare it against. Perhaps you have some other idea in mind for this double-check? (though it can't be solely on the _name_ of the admin).","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1618983984/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1619018951","html_url":"https://github.com/apache/couchdb/issues/4663#issuecomment-1619018951","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4663","id":1619018951,"node_id":"IC_kwDOAAMmUc5ggETH","user":{"login":"ronnievsmith","id":12751611,"node_id":"MDQ6VXNlcjEyNzUxNjEx","avatar_url":"https://avatars.githubusercontent.com/u/12751611?v=4","gravatar_id":"","url":"https://api.github.com/users/ronnievsmith","html_url":"https://github.com/ronnievsmith","followers_url":"https://api.github.com/users/ronnievsmith/followers","following_url":"https://api.github.com/users/ronnievsmith/following{/other_user}","gists_url":"https://api.github.com/users/ronnievsmith/gists{/gist_id}","starred_url":"https://api.github.com/users/ronnievsmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ronnievsmith/subscriptions","organizations_url":"https://api.github.com/users/ronnievsmith/orgs","repos_url":"https://api.github.com/users/ronnievsmith/repos","events_url":"https://api.github.com/users/ronnievsmith/events{/privacy}","received_events_url":"https://api.github.com/users/ronnievsmith/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-03T19:04:21Z","updated_at":"2023-07-03T19:04:21Z","author_association":"NONE","body":"There is value in validating that the `sub` is configured as a server admin. The particular server admin password can exist even if not used/read for JWT authentication.\r\n\r\nAs an aside, understood regarding the provenance of the JWT handler.  _Authorization_, or `role` based access, is configured on CouchDB no matter what, e.g. each database's `_security` endpoint, or _permissions_. Mapping users to CouchDB roles seems like it should always exist on CouchDB and developers can architect in this fashion _as-is_ via design documents as far as I understand.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1619018951/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1619027071","html_url":"https://github.com/apache/couchdb/issues/4663#issuecomment-1619027071","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4663","id":1619027071,"node_id":"IC_kwDOAAMmUc5ggGR_","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-03T19:11:26Z","updated_at":"2023-07-03T19:11:26Z","author_association":"MEMBER","body":"> There is value in validating that the sub is configured as a server admin\r\n\r\nHow do you propose doing so? (usernames are not secrets).\r\n\r\nI do not understand your aside.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1619027071/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1619039064","html_url":"https://github.com/apache/couchdb/issues/4663#issuecomment-1619039064","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4663","id":1619039064,"node_id":"IC_kwDOAAMmUc5ggJNY","user":{"login":"ronnievsmith","id":12751611,"node_id":"MDQ6VXNlcjEyNzUxNjEx","avatar_url":"https://avatars.githubusercontent.com/u/12751611?v=4","gravatar_id":"","url":"https://api.github.com/users/ronnievsmith","html_url":"https://github.com/ronnievsmith","followers_url":"https://api.github.com/users/ronnievsmith/followers","following_url":"https://api.github.com/users/ronnievsmith/following{/other_user}","gists_url":"https://api.github.com/users/ronnievsmith/gists{/gist_id}","starred_url":"https://api.github.com/users/ronnievsmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ronnievsmith/subscriptions","organizations_url":"https://api.github.com/users/ronnievsmith/orgs","repos_url":"https://api.github.com/users/ronnievsmith/repos","events_url":"https://api.github.com/users/ronnievsmith/events{/privacy}","received_events_url":"https://api.github.com/users/ronnievsmith/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-03T19:19:37Z","updated_at":"2023-07-03T19:21:00Z","author_association":"NONE","body":"Server admin usernames are only available to server admins.\r\n\r\nUpon HTTP request, \r\n\r\n1. read/validate JWT\r\n2. if `sub` `role` exists, splice/remove `_admin` from roles\r\n3. for each configured server admin \r\n 3a. If `sub` equals userID push `_admin` to `sub` `roles` array\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1619039064/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1619052403","html_url":"https://github.com/apache/couchdb/issues/4663#issuecomment-1619052403","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4663","id":1619052403,"node_id":"IC_kwDOAAMmUc5ggMdz","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-03T19:35:18Z","updated_at":"2023-07-03T19:35:18Z","author_association":"MEMBER","body":"hm, nope, I can't go for that. usernames are not secrets (even if the list of usernames is access controlled).\r\n\r\nThat leaves us with an option to simply reject JWT tokens with the `_admin` role as an option.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1619052403/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1619065193","html_url":"https://github.com/apache/couchdb/issues/4663#issuecomment-1619065193","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4663","id":1619065193,"node_id":"IC_kwDOAAMmUc5ggPlp","user":{"login":"ronnievsmith","id":12751611,"node_id":"MDQ6VXNlcjEyNzUxNjEx","avatar_url":"https://avatars.githubusercontent.com/u/12751611?v=4","gravatar_id":"","url":"https://api.github.com/users/ronnievsmith","html_url":"https://github.com/ronnievsmith","followers_url":"https://api.github.com/users/ronnievsmith/followers","following_url":"https://api.github.com/users/ronnievsmith/following{/other_user}","gists_url":"https://api.github.com/users/ronnievsmith/gists{/gist_id}","starred_url":"https://api.github.com/users/ronnievsmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ronnievsmith/subscriptions","organizations_url":"https://api.github.com/users/ronnievsmith/orgs","repos_url":"https://api.github.com/users/ronnievsmith/repos","events_url":"https://api.github.com/users/ronnievsmith/events{/privacy}","received_events_url":"https://api.github.com/users/ronnievsmith/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-03T19:50:08Z","updated_at":"2023-07-03T19:50:08Z","author_association":"NONE","body":"The JWT signature acts as the password. Couch verifying that the `sub` is configured as an `_admin` does not make a username a secret or a password but adds additional security in that server admins must be explicitly configured.\r\n\r\nThe option to reject `_admin` claims is valuable.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1619065193/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1621789256","html_url":"https://github.com/apache/couchdb/issues/4656#issuecomment-1621789256","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4656","id":1621789256,"node_id":"IC_kwDOAAMmUc5gqopI","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-05T13:44:13Z","updated_at":"2023-07-05T13:44:13Z","author_association":"CONTRIBUTOR","body":"> I don't know enough Erlang to find out what `any` maps to. But it seems like a type?\r\n\r\nThe third parameter of the `config:get/3` function is the default value when no value could be found for the key under the section (identified by the first and second parameters).  That is, `any` in this context, the default value of `bind_address` in the `http` section.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1621789256/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1622515799","html_url":"https://github.com/apache/couchdb/issues/2873#issuecomment-1622515799","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2873","id":1622515799,"node_id":"IC_kwDOAAMmUc5gtaBX","user":{"login":"ronnievsmith","id":12751611,"node_id":"MDQ6VXNlcjEyNzUxNjEx","avatar_url":"https://avatars.githubusercontent.com/u/12751611?v=4","gravatar_id":"","url":"https://api.github.com/users/ronnievsmith","html_url":"https://github.com/ronnievsmith","followers_url":"https://api.github.com/users/ronnievsmith/followers","following_url":"https://api.github.com/users/ronnievsmith/following{/other_user}","gists_url":"https://api.github.com/users/ronnievsmith/gists{/gist_id}","starred_url":"https://api.github.com/users/ronnievsmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ronnievsmith/subscriptions","organizations_url":"https://api.github.com/users/ronnievsmith/orgs","repos_url":"https://api.github.com/users/ronnievsmith/repos","events_url":"https://api.github.com/users/ronnievsmith/events{/privacy}","received_events_url":"https://api.github.com/users/ronnievsmith/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-05T21:09:49Z","updated_at":"2023-07-05T21:09:49Z","author_association":"NONE","body":"\"CouchDB supports cookie authentication\" [[source](https://docs.couchdb.org/en/stable/intro/security.html#cookie-authentication)] **_unless you use JWT authentication_**. SHOULD be added to documentation.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1622515799/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1623238691","html_url":"https://github.com/apache/couchdb/pull/4666#issuecomment-1623238691","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4666","id":1623238691,"node_id":"IC_kwDOAAMmUc5gwKgj","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-06T08:45:33Z","updated_at":"2023-07-06T08:45:33Z","author_association":"CONTRIBUTOR","body":"The [documentation](https://docs.couchdb.org/en/latest/api/server/configuration.html) suggests other types of JSON values might be allowed but I have only seen strings being used so far.  The original code also implies that strings are preferred.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1623238691/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1624021970","html_url":"https://github.com/apache/couchdb/issues/2873#issuecomment-1624021970","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2873","id":1624021970,"node_id":"IC_kwDOAAMmUc5gzJvS","user":{"login":"ronnievsmith","id":12751611,"node_id":"MDQ6VXNlcjEyNzUxNjEx","avatar_url":"https://avatars.githubusercontent.com/u/12751611?v=4","gravatar_id":"","url":"https://api.github.com/users/ronnievsmith","html_url":"https://github.com/ronnievsmith","followers_url":"https://api.github.com/users/ronnievsmith/followers","following_url":"https://api.github.com/users/ronnievsmith/following{/other_user}","gists_url":"https://api.github.com/users/ronnievsmith/gists{/gist_id}","starred_url":"https://api.github.com/users/ronnievsmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ronnievsmith/subscriptions","organizations_url":"https://api.github.com/users/ronnievsmith/orgs","repos_url":"https://api.github.com/users/ronnievsmith/repos","events_url":"https://api.github.com/users/ronnievsmith/events{/privacy}","received_events_url":"https://api.github.com/users/ronnievsmith/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-06T17:09:34Z","updated_at":"2023-07-06T17:09:34Z","author_association":"NONE","body":"Such documentation clarifies that CouchDB team understands the use case and benefit(s) for cookie authentication and explicitly refuses to extend these benefits to the JWT handler [Issue# 2873](https://github.com/apache/couchdb/issues/2873).","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1624021970/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1624041986","html_url":"https://github.com/apache/couchdb/issues/2873#issuecomment-1624041986","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2873","id":1624041986,"node_id":"IC_kwDOAAMmUc5gzOoC","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-06T17:23:23Z","updated_at":"2023-07-06T17:23:23Z","author_association":"MEMBER","body":"enough of this.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1624041986/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1625131253","html_url":"https://github.com/apache/couchdb/issues/2791#issuecomment-1625131253","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2791","id":1625131253,"node_id":"IC_kwDOAAMmUc5g3Yj1","user":{"login":"sergey-safarov","id":2562241,"node_id":"MDQ6VXNlcjI1NjIyNDE=","avatar_url":"https://avatars.githubusercontent.com/u/2562241?v=4","gravatar_id":"","url":"https://api.github.com/users/sergey-safarov","html_url":"https://github.com/sergey-safarov","followers_url":"https://api.github.com/users/sergey-safarov/followers","following_url":"https://api.github.com/users/sergey-safarov/following{/other_user}","gists_url":"https://api.github.com/users/sergey-safarov/gists{/gist_id}","starred_url":"https://api.github.com/users/sergey-safarov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sergey-safarov/subscriptions","organizations_url":"https://api.github.com/users/sergey-safarov/orgs","repos_url":"https://api.github.com/users/sergey-safarov/repos","events_url":"https://api.github.com/users/sergey-safarov/events{/privacy}","received_events_url":"https://api.github.com/users/sergey-safarov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-07T09:31:05Z","updated_at":"2023-07-07T09:31:05Z","author_association":"NONE","body":"I have reproduced the issue on `apache/couchdb:3.3.2` docker image.\r\n\r\nI tarted replicaation using json\r\n```json\r\n{\r\n  \"user_ctx\": {\r\n    \"name\": \"admin\",\r\n    \"roles\": [\r\n      \"_admin\",\r\n      \"_reader\",\r\n      \"_writer\"\r\n    ]\r\n  },\r\n  \"source\": {\r\n    \"url\": \"http://ippbx-1a.la.example.com:5984/mydb\",\r\n    \"headers\": {\r\n      \"Authorization\": \"Basic XXXXXXXXXXXX\"\r\n    }\r\n  },\r\n  \"target\": {\r\n    \"url\": \"http://127.0.0.1:5984/mydb\",\r\n    \"headers\": {\r\n      \"Authorization\": \"Basic XXXXXXXXX\"\r\n    }\r\n  },\r\n  \"create_target\": true,\r\n  \"continuous\": false\r\n}\r\n```\r\nin the CouchDB output I see\r\n\r\n> Jul 07 09:21:51 ippbx-1b.la.example.com docker[3677369]: [error] 2023-07-07T09:21:51.599467Z couchdb@ippbx-1b.la.example.com <0.6095.0> -------- couch_replicator_httpc: auth plugin initialization failed \"http://ippbx-1a.la.example.com:5984/mydb/\" {session_request_failed,\"http://ippbx-1a.la.example.com:5984/_session\",\"admin\",{conn_failed,{error,nxdomain}}}\r\nJul 07 09:21:51 ippbx-1b.la.example.com docker[3677369]: [error] 2023-07-07T09:21:51.599676Z couchdb@ippbx-1b.la.example.com <0.6095.0> -------- throw:{replication_auth_error,{session_request_failed,\"http://ippbx-1a.la.example.com:5984/_session\",\"admin\",{conn_failed,{error,nxdomain}}}}: Replication 69411eb9179c970995746a1ecd781fac+create_target failed to start \"http://ippbx-1a.la.example.com:5984/mydb/\" -> \"http://127.0.0.1:5984/mydb/\" doc <<\"shards/00000000-7fffffff/_replicator.1688721035\">>:<<\"477deb9261a9927a1d20e90f2a001b31\">> stack:[{couch_replicator_httpc,setup,1,[{file,\"src/couch_replicator_httpc.erl\"},{line,62}]},{couch_replicator_api_wrap,db_open,3,[{file,\"src/couch_replicator_api_wrap.erl\"},{line,68}]}]\r\n\r\nAnd the tcpdump output\r\n```\r\n09:23:15.476762 IP 127.0.0.1.56494 > 127.0.0.1.domain: 63155+ A? ippbx-1a.la.example.com. (40)\r\n09:23:15.476905 IP 127.0.0.1.domain > 127.0.0.1.56494: 63155* 0/1/0 (140)\r\n09:23:15.476996 IP 127.0.0.1.55970 > 127.0.0.1.domain: 52657+ A? ippbx-1a.la.example.com. (40)\r\n09:23:15.477078 IP 127.0.0.1.domain > 127.0.0.1.55970: 52657* 0/1/0 (140)\r\n```\r\nIn the vm.args\r\n```\r\n[centos@ippbx-1b ~]$ grep proto_dist /opt/couchdb/etc/vm.args\r\n-proto_dist inet6_tcp\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1625131253/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1627372010","html_url":"https://github.com/apache/couchdb/issues/2791#issuecomment-1627372010","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2791","id":1627372010,"node_id":"IC_kwDOAAMmUc5g_7nq","user":{"login":"sergey-safarov","id":2562241,"node_id":"MDQ6VXNlcjI1NjIyNDE=","avatar_url":"https://avatars.githubusercontent.com/u/2562241?v=4","gravatar_id":"","url":"https://api.github.com/users/sergey-safarov","html_url":"https://github.com/sergey-safarov","followers_url":"https://api.github.com/users/sergey-safarov/followers","following_url":"https://api.github.com/users/sergey-safarov/following{/other_user}","gists_url":"https://api.github.com/users/sergey-safarov/gists{/gist_id}","starred_url":"https://api.github.com/users/sergey-safarov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sergey-safarov/subscriptions","organizations_url":"https://api.github.com/users/sergey-safarov/orgs","repos_url":"https://api.github.com/users/sergey-safarov/repos","events_url":"https://api.github.com/users/sergey-safarov/events{/privacy}","received_events_url":"https://api.github.com/users/sergey-safarov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-08T15:05:05Z","updated_at":"2023-07-08T15:05:05Z","author_association":"NONE","body":"Issue recreated at https://github.com/apache/couchdb/issues/4668","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1627372010/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1627815927","html_url":"https://github.com/apache/couchdb/issues/4668#issuecomment-1627815927","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4668","id":1627815927,"node_id":"IC_kwDOAAMmUc5hBn_3","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-09T20:20:13Z","updated_at":"2023-07-09T20:20:13Z","author_association":"MEMBER","body":"the erlang/otp `proto_dist` parameter controls how the erlang nodes communicate with each other with the distributed erlang protocol, it is not related to the protocols the (http-based) replicator uses.\r\n\r\nSupport for replicating to ipv6-only hosts was added back in couchdb 2.3 (by upgrading ibrowse).\r\n\r\ngiven you are within an docker image, have you confirmed the environment is capable of ipv6 host resolution and routing? When you said couchdb only does an `A` lookup and not `AAAA` lookup is this speculation or do you have a confirming packet capture?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1627815927/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1628270920","html_url":"https://github.com/apache/couchdb/issues/4668#issuecomment-1628270920","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4668","id":1628270920,"node_id":"IC_kwDOAAMmUc5hDXFI","user":{"login":"sergey-safarov","id":2562241,"node_id":"MDQ6VXNlcjI1NjIyNDE=","avatar_url":"https://avatars.githubusercontent.com/u/2562241?v=4","gravatar_id":"","url":"https://api.github.com/users/sergey-safarov","html_url":"https://github.com/sergey-safarov","followers_url":"https://api.github.com/users/sergey-safarov/followers","following_url":"https://api.github.com/users/sergey-safarov/following{/other_user}","gists_url":"https://api.github.com/users/sergey-safarov/gists{/gist_id}","starred_url":"https://api.github.com/users/sergey-safarov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sergey-safarov/subscriptions","organizations_url":"https://api.github.com/users/sergey-safarov/orgs","repos_url":"https://api.github.com/users/sergey-safarov/repos","events_url":"https://api.github.com/users/sergey-safarov/events{/privacy}","received_events_url":"https://api.github.com/users/sergey-safarov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-10T05:48:53Z","updated_at":"2023-07-10T05:48:53Z","author_association":"NONE","body":"> When you said couchdb only does an A lookup and not AAAA lookup is this speculation or do you have a confirming packet capture?\r\n\r\nYes, I have started replication and in another tab, I have started `tcpdump -ni any port 53` and will able to see which DNS requests were issued to the DNS server. All requests for hostname I configured for replication is 'A'.\r\n\r\n> have you confirmed the environment is capable of ipv6 host resolution and routing\r\n\r\nPlease check my real result without \"example\" masking. The same results you will get on the your PC.\r\n```\r\n[centos@ippbx-1b ~]$ nslookup ippbx-0a.la.nga911.com\r\nServer:\t\t127.0.0.1\r\nAddress:\t127.0.0.1#53\r\n\r\nNon-authoritative answer:\r\nName:\tippbx-0a.la.nga911.com\r\nAddress: 2605:84c0:4a:604::6\r\n\r\n[centos@ippbx-1b ~]$ nslookup ippbx-0b.la.nga911.com\r\nServer:\t\t127.0.0.1\r\nAddress:\t127.0.0.1#53\r\n\r\nNon-authoritative answer:\r\nName:\tippbx-0b.la.nga911.com\r\nAddress: 2605:84c0:4a:605::6\r\n\r\n[centos@ippbx-1b ~]$ nslookup ippbx-1a.la.nga911.com\r\nServer:\t\t127.0.0.1\r\nAddress:\t127.0.0.1#53\r\n\r\nNon-authoritative answer:\r\nName:\tippbx-1a.la.nga911.com\r\nAddress: 2605:84c0:48:604::6\r\n\r\n[centos@ippbx-1b ~]$ nslookup ippbx-1b.la.nga911.com\r\nServer:\t\t127.0.0.1\r\nAddress:\t127.0.0.1#53\r\n\r\nName:\tippbx-1b.la.nga911.com\r\nAddress: 2605:84c0:48:605::6\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1628270920/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1628280339","html_url":"https://github.com/apache/couchdb/issues/4668#issuecomment-1628280339","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4668","id":1628280339,"node_id":"IC_kwDOAAMmUc5hDZYT","user":{"login":"sergey-safarov","id":2562241,"node_id":"MDQ6VXNlcjI1NjIyNDE=","avatar_url":"https://avatars.githubusercontent.com/u/2562241?v=4","gravatar_id":"","url":"https://api.github.com/users/sergey-safarov","html_url":"https://github.com/sergey-safarov","followers_url":"https://api.github.com/users/sergey-safarov/followers","following_url":"https://api.github.com/users/sergey-safarov/following{/other_user}","gists_url":"https://api.github.com/users/sergey-safarov/gists{/gist_id}","starred_url":"https://api.github.com/users/sergey-safarov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sergey-safarov/subscriptions","organizations_url":"https://api.github.com/users/sergey-safarov/orgs","repos_url":"https://api.github.com/users/sergey-safarov/repos","events_url":"https://api.github.com/users/sergey-safarov/events{/privacy}","received_events_url":"https://api.github.com/users/sergey-safarov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-10T05:54:24Z","updated_at":"2023-07-10T05:54:24Z","author_association":"NONE","body":"routing also works\r\n**standalone couchdb server with 3.3.2**\r\n```\r\n[centos@ippbx-1b ~]$ curl http://ippbx-1b.la.nga911.com:5984\r\n{\"couchdb\":\"Welcome\",\"version\":\"3.3.2\",\"git_sha\":\"11a234070\",\"uuid\":\"065b865d8615b590a225292060d6c415\",\"features\":[\"access-ready\",\"partitioned\",\"pluggable-storage-engines\",\"reshard\",\"scheduler\"],\"vendor\":{\"name\":\"The Apache Software Foundation\"}}\r\n```\r\n**couchdb cluster with 2.3.1**\r\n```\r\n[centos@ippbx-1b ~]$ curl http://ippbx-0a.la.nga911.com:5984\r\n{\"couchdb\":\"Welcome\",\"version\":\"2.3.1\",\"git_sha\":\"c298091a4\",\"uuid\":\"e79401873eae0a741ad58421c4521c1e\",\"features\":[\"pluggable-storage-engines\",\"scheduler\"],\"vendor\":{\"name\":\"The Apache Software Foundation\"}}\r\n[centos@ippbx-1b ~]$ curl http://ippbx-0b.la.nga911.com:5984\r\n{\"couchdb\":\"Welcome\",\"version\":\"2.3.1\",\"git_sha\":\"c298091a4\",\"uuid\":\"a581bad23b6f91b65710d9c2481f295a\",\"features\":[\"pluggable-storage-engines\",\"scheduler\"],\"vendor\":{\"name\":\"The Apache Software Foundation\"}}\r\n[centos@ippbx-1b ~]$ curl http://ippbx-1a.la.nga911.com:5984\r\n{\"couchdb\":\"Welcome\",\"version\":\"2.3.1\",\"git_sha\":\"c298091a4\",\"uuid\":\"355ce185adb189bc576b757410c208d3\",\"features\":[\"pluggable-storage-engines\",\"scheduler\"],\"vendor\":{\"name\":\"The Apache Software Foundation\"}}\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1628280339/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1628475272","html_url":"https://github.com/apache/couchdb/issues/4668#issuecomment-1628475272","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4668","id":1628475272,"node_id":"IC_kwDOAAMmUc5hEI-I","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-10T08:20:08Z","updated_at":"2023-07-10T08:20:08Z","author_association":"MEMBER","body":"Thanks. looks like this change in the third party http client we use (ibrowse): https://github.com/apache/couchdb-ibrowse/commit/e6a0c366fc8fc982d7981087c1e9d1e28e2a235a\r\n\r\ntry setting;\r\n\r\n```\r\n[replicator]\r\nsocket_options = [{keepalive, true}, {nodelay, false}, {prefer_ipv6, true}]\r\nvalid_socket_options = buffer,keepalive,nodelay,priority,recbuf,sndbuf,prefer_ipv6\r\n```\r\n\r\nYou'll need to restart couchdb if you edit the config files, or you can use the `/_node/_local/_config` endpoint to change the settings live.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1628475272/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1628643750","html_url":"https://github.com/apache/couchdb/issues/4668#issuecomment-1628643750","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4668","id":1628643750,"node_id":"IC_kwDOAAMmUc5hEyGm","user":{"login":"sergey-safarov","id":2562241,"node_id":"MDQ6VXNlcjI1NjIyNDE=","avatar_url":"https://avatars.githubusercontent.com/u/2562241?v=4","gravatar_id":"","url":"https://api.github.com/users/sergey-safarov","html_url":"https://github.com/sergey-safarov","followers_url":"https://api.github.com/users/sergey-safarov/followers","following_url":"https://api.github.com/users/sergey-safarov/following{/other_user}","gists_url":"https://api.github.com/users/sergey-safarov/gists{/gist_id}","starred_url":"https://api.github.com/users/sergey-safarov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sergey-safarov/subscriptions","organizations_url":"https://api.github.com/users/sergey-safarov/orgs","repos_url":"https://api.github.com/users/sergey-safarov/repos","events_url":"https://api.github.com/users/sergey-safarov/events{/privacy}","received_events_url":"https://api.github.com/users/sergey-safarov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-10T10:10:28Z","updated_at":"2023-07-10T10:10:28Z","author_association":"NONE","body":"on the server I have created file `/opt/couchdb/etc/local.d/replicator.ini` with content\r\n```\r\n[replicator]\r\n; See the `inet` Erlang module's man page for the full list of options.\r\nsocket_options = [{keepalive, true}, {nodelay, false}, {prefer_ipv6, true}]\r\n\r\n; Valid socket options. Options not in this list are ignored. The full list of\r\n; options may be found at https://www.erlang.org/doc/man/inet.html#setopts-2.\r\nvalid_socket_options = buffer,keepalive,nodelay,priority,recbuf,sndbuf,prefer_ipv6\r\n```\r\nThen I mounted this file into the docker container. The CouchDB container started with this file mounted.\r\n```bash\r\n[root@ippbx-1b ~]# docker exec couch ls -l /opt/couchdb/etc/local.d/replicator.ini\r\n-rw-r--r--. 1 couchdb couchdb 403 Jul 10 09:53 /opt/couchdb/etc/local.d/replicator.ini\r\n```\r\nStarted replications again and using tcpdump can see `A` DNS requests\r\n```\r\n10:00:49.900494 IP 127.0.0.1.42238 > 127.0.0.1.domain: 44128+ A? ippbx-1a.la.nga911.com. (40)\r\n10:00:49.900627 IP 127.0.0.1.domain > 127.0.0.1.42238: 44128* 0/1/0 (140)\r\n10:00:49.900711 IP 127.0.0.1.52185 > 127.0.0.1.domain: 8288+ A? ippbx-1a.la.nga911.com. (40)\r\n10:00:49.900828 IP 127.0.0.1.domain > 127.0.0.1.52185: 8288* 0/1/0 (140)\r\n```\r\nI also have checked local node config after CouchDB restart. I see `replicator` settings applied as expected.\r\n```\r\n[root@ippbx-1b ~]# curl -s -S  http://xxxxx:xxxxx@127.0.0.1:5984/_node/_local/_config | jq\r\n{\r\n  \"chttpd\": {\r\n    \"bind_address\": \"::\",\r\n    \"port\": \"5984\"\r\n  },\r\n  \"admins\": {\r\n    \"xxxxxx\": \"xxxxxxxxxxx\"\r\n  },\r\n  \"vendor\": {\r\n    \"name\": \"The Apache Software Foundation\"\r\n  },\r\n  \"feature_flags\": {\r\n    \"partitioned||*\": \"true\"\r\n  },\r\n  \"chttpd_auth\": {\r\n    \"hash_algorithms\": \"sha256, sha\"\r\n  },\r\n  \"replicator\": {\r\n    \"socket_options\": \"[{keepalive, true}, {nodelay, false}, {prefer_ipv6, true}]\",\r\n    \"valid_socket_options\": \"buffer,keepalive,nodelay,priority,recbuf,sndbuf,prefer_ipv6\"\r\n  },\r\n  \"log\": {\r\n    \"level\": \"error\"\r\n  },\r\n  \"indexers\": {\r\n    \"couch_mrview\": \"true\"\r\n  },\r\n  \"prometheus\": {\r\n    \"additional_port\": \"false\",\r\n    \"bind_address\": \"127.0.0.1\",\r\n    \"port\": \"17986\"\r\n  },\r\n  \"httpd\": {\r\n    \"bind_address\": \"::\",\r\n    \"port\": \"5986\"\r\n  },\r\n  \"smoosh\": {\r\n    \"state_dir\": \"./data\"\r\n  },\r\n  \"couch_httpd_auth\": {\r\n    \"authentication_db\": \"_users\",\r\n    \"secret\": \"c8bf8a8d517074d779a1a31a9dac75bd\"\r\n  },\r\n  \"couchdb_engines\": {\r\n    \"couch\": \"couch_bt_engine\"\r\n  },\r\n  \"couchdb\": {\r\n    \"database_dir\": \"./data\",\r\n    \"uuid\": \"065b865d8615b590a225292060d6c415\",\r\n    \"view_index_dir\": \"./data\"\r\n  }\r\n}\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1628643750/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1629095384","html_url":"https://github.com/apache/couchdb/issues/4668#issuecomment-1629095384","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4668","id":1629095384,"node_id":"IC_kwDOAAMmUc5hGgXY","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-10T14:30:35Z","updated_at":"2023-07-10T14:30:35Z","author_association":"MEMBER","body":"hi,\r\n\r\nI've tried this locally and it doesn't work, sorry for the bad steer.\r\n\r\nI see several bugs that prevent you from getting the necessary `{prefer_ipv6, true}` setting to where it needs to be, we'll fix in the next release.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1629095384/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1629448766","html_url":"https://github.com/apache/couchdb/pull/4666#issuecomment-1629448766","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4666","id":1629448766,"node_id":"IC_kwDOAAMmUc5hH2o-","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-10T18:00:25Z","updated_at":"2023-07-10T18:00:25Z","author_association":"CONTRIBUTOR","body":"Thank you, guys!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1629448766/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1629747380","html_url":"https://github.com/apache/couchdb/issues/4668#issuecomment-1629747380","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4668","id":1629747380,"node_id":"IC_kwDOAAMmUc5hI_i0","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-10T21:20:10Z","updated_at":"2023-07-10T21:20:10Z","author_association":"MEMBER","body":"we have a fix for the next release, thank you for filing the issue!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1629747380/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1629762918","html_url":"https://github.com/apache/couchdb/issues/4668#issuecomment-1629762918","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4668","id":1629762918,"node_id":"IC_kwDOAAMmUc5hJDVm","user":{"login":"sergey-safarov","id":2562241,"node_id":"MDQ6VXNlcjI1NjIyNDE=","avatar_url":"https://avatars.githubusercontent.com/u/2562241?v=4","gravatar_id":"","url":"https://api.github.com/users/sergey-safarov","html_url":"https://github.com/sergey-safarov","followers_url":"https://api.github.com/users/sergey-safarov/followers","following_url":"https://api.github.com/users/sergey-safarov/following{/other_user}","gists_url":"https://api.github.com/users/sergey-safarov/gists{/gist_id}","starred_url":"https://api.github.com/users/sergey-safarov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sergey-safarov/subscriptions","organizations_url":"https://api.github.com/users/sergey-safarov/orgs","repos_url":"https://api.github.com/users/sergey-safarov/repos","events_url":"https://api.github.com/users/sergey-safarov/events{/privacy}","received_events_url":"https://api.github.com/users/sergey-safarov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-10T21:35:24Z","updated_at":"2023-07-10T21:35:24Z","author_association":"NONE","body":"Should I use?\r\n```\r\n[replicator]\r\nsocket_options = [{keepalive, true}, {nodelay, false}, {prefer_ipv6, true}]\r\nvalid_socket_options = buffer,keepalive,nodelay,priority,recbuf,sndbuf,prefer_ipv6\r\nibrowse_options = [{prefer_ipv6, true}]\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1629762918/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1629802079","html_url":"https://github.com/apache/couchdb/issues/4668#issuecomment-1629802079","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4668","id":1629802079,"node_id":"IC_kwDOAAMmUc5hJM5f","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-10T22:14:03Z","updated_at":"2023-07-10T22:14:23Z","author_association":"MEMBER","body":"@sergey-safarov when there's a release with the fix all you'll need to do is;\r\n\r\n```\r\n[replicator]\r\nibrowse_options = [{prefer_ipv6, true}]\r\n```\r\n\r\nand then ipv6 will be attempted for all replications, which is appropriate for your ipv6-only setup.\r\n\r\nIn other setups you might just specify `{\"source\":\"X\", ... \"ibrowse_options\":\"[{prefer_ipv6,true}]}\"}` on certain replication docs as needed.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1629802079/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1630265536","html_url":"https://github.com/apache/couchdb/issues/4663#issuecomment-1630265536","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4663","id":1630265536,"node_id":"IC_kwDOAAMmUc5hK-DA","user":{"login":"lazedo","id":770988,"node_id":"MDQ6VXNlcjc3MDk4OA==","avatar_url":"https://avatars.githubusercontent.com/u/770988?v=4","gravatar_id":"","url":"https://api.github.com/users/lazedo","html_url":"https://github.com/lazedo","followers_url":"https://api.github.com/users/lazedo/followers","following_url":"https://api.github.com/users/lazedo/following{/other_user}","gists_url":"https://api.github.com/users/lazedo/gists{/gist_id}","starred_url":"https://api.github.com/users/lazedo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lazedo/subscriptions","organizations_url":"https://api.github.com/users/lazedo/orgs","repos_url":"https://api.github.com/users/lazedo/repos","events_url":"https://api.github.com/users/lazedo/events{/privacy}","received_events_url":"https://api.github.com/users/lazedo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-11T07:05:27Z","updated_at":"2023-07-11T07:05:27Z","author_association":"CONTRIBUTOR","body":"we added a `admin_roles` config. feel free to use/adapt the below (needs rebase)\r\n\r\n```\r\ndiff --git a/src/couch/src/couch_httpd_auth.erl b/src/couch/src/couch_httpd_auth.erl\r\nindex 24a0c15ed..07d4df4f3 100644\r\n--- a/src/couch/src/couch_httpd_auth.erl\r\n+++ b/src/couch/src/couch_httpd_auth.erl\r\n@@ -230,21 +230,10 @@ jwt_authentication_handler(Req) ->\r\n                     case lists:keyfind(<<\"sub\">>, 1, Claims) of\r\n                         false ->\r\n                             throw({unauthorized, <<\"Token missing sub claim.\">>});\r\n-                        {_, User} ->\r\n-                            Req#httpd{\r\n-                                user_ctx = #user_ctx{\r\n-                                    name = User,\r\n-                                    roles = couch_util:get_value(\r\n-                                        ?l2b(\r\n-                                            config:get(\r\n-                                                \"jwt_auth\", \"roles_claim_name\", \"_couchdb.roles\"\r\n-                                            )\r\n-                                        ),\r\n-                                        Claims,\r\n-                                        []\r\n-                                    )\r\n-                                }\r\n-                            }\r\n+                        {_, User} -> Req#httpd{user_ctx=#user_ctx{\r\n+                            name = User,\r\n+                            roles = jwt_roles(Claims)\r\n+                        }}\r\n                     end;\r\n                 {error, Reason} ->\r\n                     throw(Reason)\r\n@@ -253,6 +242,31 @@ jwt_authentication_handler(Req) ->\r\n             Req\r\n     end.\r\n \r\n+jwt_roles(Claims) ->\r\n+    RolesClaimName = ?l2b(config:get(\"jwt_auth\", \"roles_claim_name\", \"_couchdb.roles\")),\r\n+    JWTRoles = couch_util:get_value(RolesClaimName, Claims, []),\r\n+    case jwt_admin_roles() of\r\n+        [] -> lists:usort(JWTRoles);\r\n+        Roles -> jwt_verify_admin_roles(JWTRoles, Roles)\r\n+    end.\r\n+\r\n+jwt_verify_admin_roles(JWTRoles, Roles) ->\r\n+    VerifyFun = fun(JWTRole) -> lists:member(JWTRole, Roles) end,\r\n+    case lists:any(VerifyFun, JWTRoles) of\r\n+        true -> lists:usort([<<\"_admin\">> | JWTRoles]);\r\n+        false -> lists:usort(JWTRoles)\r\n+    end.\r\n+\r\n+jwt_admin_roles() ->\r\n+    AdminRoles = string:split(config:get(\"jwt_auth\", \"admin_roles\", \"\"), \",\", all),\r\n+    lists:filtermap(fun jwt_filter_map_admin_role/1, AdminRoles).\r\n+\r\n+jwt_filter_map_admin_role(Role) ->\r\n+    case string:is_empty(Role) of\r\n+        true -> false;\r\n+        false -> {true, ?l2b(Role)}\r\n+    end.\r\n+\r\n get_configured_claims() ->\r\n     Claims = config:get(\"jwt_auth\", \"required_claims\", \"\"),\r\n     Re = \"((?<key1>[a-z]+)|{(?<key2>[a-z]+)\\s*,\\s*\\\"(?<val>[^\\\"]+)\\\"})\",\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1630265536/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1630268200","html_url":"https://github.com/apache/couchdb/pull/4672#issuecomment-1630268200","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4672","id":1630268200,"node_id":"IC_kwDOAAMmUc5hK-so","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-11T07:07:40Z","updated_at":"2023-07-11T07:07:40Z","author_association":"CONTRIBUTOR","body":"Comparing performance of Folsom vs new histogram updates under 10k and 1k concurrent updates using [statbench.erl](https://gist.github.com/nickva/13cd44dbd02a8556670902f5f7da8bfe) see a 19x and 13x speed improvement, respectively.\r\n\r\n<img width=\"506\" alt=\"Screen Shot 2023-07-11 at 3 03 31 AM\" src=\"https://github.com/apache/couchdb/assets/211822/5fbc6e15-d4d0-4b3b-99ac-0a261661c4c9\">\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1630268200/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1630269935","html_url":"https://github.com/apache/couchdb/issues/4650#issuecomment-1630269935","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4650","id":1630269935,"node_id":"IC_kwDOAAMmUc5hK_Hv","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-11T07:09:03Z","updated_at":"2023-07-11T07:10:36Z","author_association":"CONTRIBUTOR","body":"Folsom and bear replacement is implemented in https://github.com/apache/couchdb/pull/4672\r\n\r\nThe full implementation preserves the same 20x speedup improvement as in the initial prototype https://github.com/apache/couchdb/pull/4672#issuecomment-1630268200","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1630269935/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1630272307","html_url":"https://github.com/apache/couchdb/pull/4638#issuecomment-1630272307","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4638","id":1630272307,"node_id":"IC_kwDOAAMmUc5hK_sz","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-11T07:11:06Z","updated_at":"2023-07-11T07:11:06Z","author_association":"MEMBER","body":"not sure what this is","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1630272307/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1630379864","html_url":"https://github.com/apache/couchdb/issues/4663#issuecomment-1630379864","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4663","id":1630379864,"node_id":"IC_kwDOAAMmUc5hLZ9Y","user":{"login":"lazedo","id":770988,"node_id":"MDQ6VXNlcjc3MDk4OA==","avatar_url":"https://avatars.githubusercontent.com/u/770988?v=4","gravatar_id":"","url":"https://api.github.com/users/lazedo","html_url":"https://github.com/lazedo","followers_url":"https://api.github.com/users/lazedo/followers","following_url":"https://api.github.com/users/lazedo/following{/other_user}","gists_url":"https://api.github.com/users/lazedo/gists{/gist_id}","starred_url":"https://api.github.com/users/lazedo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lazedo/subscriptions","organizations_url":"https://api.github.com/users/lazedo/orgs","repos_url":"https://api.github.com/users/lazedo/repos","events_url":"https://api.github.com/users/lazedo/events{/privacy}","received_events_url":"https://api.github.com/users/lazedo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-11T08:26:23Z","updated_at":"2023-07-11T08:30:07Z","author_association":"CONTRIBUTOR","body":"another alternative would be to use `JMESPath` to evaluate the _admins https://github.com/thehangedman/jmespath-erlang \r\n\r\nthe below was added to a POC of grafana\r\n```\r\nadmin_attribute_path = contains(groups[*], 'myawesomeorg:admins')\r\nrole_attribute_path = contains(groups[*], 'myawesomeorg:admins') && 'Admin' || contains(groups[*], 'myawesomeorg:eks') && 'Editor' || 'Viewer'\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1630379864/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1632247244","html_url":"https://github.com/apache/couchdb/issues/2861#issuecomment-1632247244","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2861","id":1632247244,"node_id":"IC_kwDOAAMmUc5hSh3M","user":{"login":"fardarter","id":11938053,"node_id":"MDQ6VXNlcjExOTM4MDUz","avatar_url":"https://avatars.githubusercontent.com/u/11938053?v=4","gravatar_id":"","url":"https://api.github.com/users/fardarter","html_url":"https://github.com/fardarter","followers_url":"https://api.github.com/users/fardarter/followers","following_url":"https://api.github.com/users/fardarter/following{/other_user}","gists_url":"https://api.github.com/users/fardarter/gists{/gist_id}","starred_url":"https://api.github.com/users/fardarter/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fardarter/subscriptions","organizations_url":"https://api.github.com/users/fardarter/orgs","repos_url":"https://api.github.com/users/fardarter/repos","events_url":"https://api.github.com/users/fardarter/events{/privacy}","received_events_url":"https://api.github.com/users/fardarter/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-12T10:25:34Z","updated_at":"2023-07-12T10:25:34Z","author_association":"NONE","body":"> Thank you for the quick response @wohali .\r\n> \r\n> What was the reasoning behind changing this and only allowing admins to create new users by default?\r\n> \r\n> I also saw that there is a new setting called `users_db_security_editable`, which defaults to `false`. The docs say the following:\r\n> \r\n> > When this configuration setting is set to false, reject any attempts to modify the _users database security object. Modification of this object is deprecated in 3.x and will be completely disallowed in CouchDB 4.x.\r\n> \r\n> If I interpret this correctly, editing the `_users/_security` object will not be possible anymore in the future. Since it defaults to `admins`, this will be the only option for creating users then. Given these changes, what would you say are the best practices for creating users going forward?\r\n> \r\n> I liked CouchDB, because the http API was built-in. Since I can't hardcode admin credentials into the client, I will need a middleman API then, which acts as an admin during user creation. Is that how you intend user creation to work in the future?\r\n\r\nIs the answer that the default will be false in 4.x?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1632247244/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1632723398","html_url":"https://github.com/apache/couchdb/pull/4139#issuecomment-1632723398","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4139","id":1632723398,"node_id":"IC_kwDOAAMmUc5hUWHG","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-12T15:10:20Z","updated_at":"2023-07-12T15:10:20Z","author_association":"MEMBER","body":"superseded by https://github.com/apache/couchdb/pull/4673  will port remaining relevant comments over","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1632723398/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1633913882","html_url":"https://github.com/apache/couchdb/pull/4674#issuecomment-1633913882","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4674","id":1633913882,"node_id":"IC_kwDOAAMmUc5hY4wa","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-13T09:43:34Z","updated_at":"2023-07-13T09:43:34Z","author_association":"MEMBER","body":"> sidebar: is it appropriate to move the -include install.mk directive? Its original placement was just before the install targets, but it seems necessary to know with_nouveau = X elsewhere.\r\n\r\nlooks fine to me","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1633913882/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1634244109","html_url":"https://github.com/apache/couchdb/issues/4675#issuecomment-1634244109","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4675","id":1634244109,"node_id":"IC_kwDOAAMmUc5haJYN","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-13T13:26:37Z","updated_at":"2023-07-13T13:26:37Z","author_association":"MEMBER","body":"what is missing for CouchDB to run there? to our knowledge arm64 is well supported","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1634244109/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1634244923","html_url":"https://github.com/apache/couchdb/issues/4675#issuecomment-1634244923","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4675","id":1634244923,"node_id":"IC_kwDOAAMmUc5haJk7","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-13T13:27:07Z","updated_at":"2023-07-13T13:27:07Z","author_association":"MEMBER","body":"agree, arm64 is already supported...\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1634244923/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1636726549","html_url":"https://github.com/apache/couchdb/pull/4678#issuecomment-1636726549","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4678","id":1636726549,"node_id":"IC_kwDOAAMmUc5hjncV","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-15T10:05:35Z","updated_at":"2023-07-15T10:05:35Z","author_association":"CONTRIBUTOR","body":"Update:\r\n\r\nA file handle to `dev/log/nouveau.log` is open too after running the test. The file can't be deleted for example.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1636726549/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1639003553","html_url":"https://github.com/apache/couchdb/pull/4679#issuecomment-1639003553","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4679","id":1639003553,"node_id":"IC_kwDOAAMmUc5hsTWh","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-17T23:01:52Z","updated_at":"2023-07-17T23:01:52Z","author_association":"MEMBER","body":"oops","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1639003553/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1639025060","html_url":"https://github.com/apache/couchdb/pull/4679#issuecomment-1639025060","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4679","id":1639025060,"node_id":"IC_kwDOAAMmUc5hsYmk","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-17T23:20:22Z","updated_at":"2023-07-17T23:20:22Z","author_association":"MEMBER","body":"bug introduced with 8601e40f624bf9b7f0c067073ca13040c8026978","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1639025060/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1640134210","html_url":"https://github.com/apache/couchdb/pull/4679#issuecomment-1640134210","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4679","id":1640134210,"node_id":"IC_kwDOAAMmUc5hwnZC","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-18T12:37:43Z","updated_at":"2023-07-18T12:37:43Z","author_association":"MEMBER","body":"can we leave the repro python scripts in this issue for posterity?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1640134210/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1640198515","html_url":"https://github.com/apache/couchdb/pull/4679#issuecomment-1640198515","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4679","id":1640198515,"node_id":"IC_kwDOAAMmUc5hw3Fz","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-18T13:07:54Z","updated_at":"2023-07-18T13:07:54Z","author_association":"MEMBER","body":"make a file to be used as an attachment;\r\n\r\n```\r\n#!/usr/bin/env python3\r\n\r\nfile_size = 1 * 1024 * 1024\r\nchunk_size = 8 * 1024\r\nint_size = 16\r\n\r\nwith open('att', 'bw') as f:\r\n    for i in range(file_size // chunk_size):\r\n        b = i.to_bytes(int_size, byteorder='big')\r\n        for k in range(chunk_size // int_size):\r\n            f.write(b)\r\n```\r\n\r\ncreate a database full of docs with multiple attachments\r\n\r\n```\r\n#!/usr/bin/env python3\r\n\r\nimport requests\r\n\r\nauth = ('foo', 'bar')\r\nbase = 'http://127.0.0.1:5984/db1'\r\n\r\nrequests.delete(base, auth=auth)\r\nrequests.put(base, auth=auth)\r\n\r\nfor i in range(1000):\r\n    r = requests.put('{}/doc{}'.format(base, i), data='{}', auth=auth)\r\n    print('create doc {}: {}'.format(i, r.json()))\r\n    rev = r.json()['rev']\r\n    for j in range(4):\r\n        with open('att', 'rb') as f:\r\n            r = requests.put('{}/doc{}/att{}?rev={}'.format(base, i, j, rev), data=f, auth=auth)\r\n            print('add att {} to doc {}: {}'.format(j, i, r.json()))\r\n            rev = r.json()['rev']\r\n```\r\n\r\nthen try to replicate this database to a new, empty database. observe that doc_write_failures is non-zero without the patch and reliably zero with the patch.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1640198515/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1642903896","html_url":"https://github.com/apache/couchdb/issues/4650#issuecomment-1642903896","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4650","id":1642903896,"node_id":"IC_kwDOAAMmUc5h7LlY","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-19T23:47:44Z","updated_at":"2023-07-19T23:47:44Z","author_association":"CONTRIBUTOR","body":"Main PR was merged. Close issue as \"fixed\".","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1642903896/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1642905156","html_url":"https://github.com/apache/couchdb/issues/4676#issuecomment-1642905156","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4676","id":1642905156,"node_id":"IC_kwDOAAMmUc5h7L5E","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-19T23:49:48Z","updated_at":"2023-07-19T23:49:48Z","author_association":"CONTRIBUTOR","body":"Fixed bug which generated spurious 400 bad_request doc updates https://github.com/apache/couchdb/commit/e892198483abbe0cab39d71bd2201a40f05be07b also change replicator behavior to not skip over documents on arbitrary 4xx errors https://github.com/apache/couchdb/commit/d4d49077d3ecca7d5122f4ba0961fa38f6fa597a\r\n\r\nClosing issue as resolved.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1642905156/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1643498944","html_url":"https://github.com/apache/couchdb/issues/4675#issuecomment-1643498944","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4675","id":1643498944,"node_id":"IC_kwDOAAMmUc5h9c3A","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-20T08:27:22Z","updated_at":"2023-07-20T08:27:29Z","author_association":"MEMBER","body":"reopen with more info pls\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1643498944/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1643601386","html_url":"https://github.com/apache/couchdb/pull/4674#issuecomment-1643601386","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4674","id":1643601386,"node_id":"IC_kwDOAAMmUc5h913q","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-20T09:38:00Z","updated_at":"2023-07-20T09:38:00Z","author_association":"CONTRIBUTOR","body":"For `search`, there [a separate `elixir-search` target](https://github.com/apache/couchdb/commit/395c083026f9735a2a34cda3012151ef94466136) has been added back in mid-February.  But I like the idea of merging it with `elixir` so that the test could be run depending on the configuration. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1643601386/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1643614529","html_url":"https://github.com/apache/couchdb/pull/4674#issuecomment-1643614529","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4674","id":1643614529,"node_id":"IC_kwDOAAMmUc5h95FB","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-20T09:46:58Z","updated_at":"2023-07-20T09:46:58Z","author_association":"CONTRIBUTOR","body":"Hrm, I have not noticed that `elixir` runs the search tests too.  But why does not it choke the CI all the time?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1643614529/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1646193583","html_url":"https://github.com/apache/couchdb/issues/4154#issuecomment-1646193583","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4154","id":1646193583,"node_id":"IC_kwDOAAMmUc5iHuuv","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-21T20:16:39Z","updated_at":"2023-07-21T20:16:39Z","author_association":"CONTRIBUTOR","body":"Due to the generous support from IBM's Z open source support team (@kun-lu20) in https://github.com/apache/couchdb-ci/pull/54 we have RHEL9 (clone) support with the caveat that it depends on the EPEL repo.\r\n\r\nI just uploaded the x86-64 3.3.2 centos-9 rpm to our artifactory\r\n\r\n```\r\nyum install couchdb\r\nLast metadata expiration check: 0:01:36 ago on Fri Jul 21 16:00:37 2023.\r\nDependencies resolved.\r\n=============================================================================================================================================================================================\r\n Package                                     Architecture                               Version                                            Repository                                   Size\r\n=============================================================================================================================================================================================\r\nInstalling:\r\n couchdb                                     x86_64                                     3.3.2-1.el9                                        couchdb                                      36 M\r\n\r\nTransaction Summary\r\n=============================================================================================================================================================================================\r\nInstall  1 Package\r\n\r\nTotal download size: 36 M\r\nInstalled size: 87 M\r\nIs this ok [y/N]: y\r\nDownloading Packages:\r\ncouchdb-3.3.2-1.el9.x86_64.rpm                                                                                                                               4.7 MB/s |  36 MB     00:07    \r\n---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\nTotal                                                                                                                                                        4.7 MB/s |  36 MB     00:07     \r\ncouchdb                                                                                                                                                       50 kB/s | 3.8 kB     00:00    \r\nImporting GPG key 0x7A00258D:\r\n Userid     : \"The Apache Software Foundation (Package repository signing key) <root@apache.org>\"\r\n Fingerprint: 390E F70B B1EA 12B2 7739 6295 0EE6 2FB3 7A00 258D\r\n From       : https://couchdb.apache.org/repo/keys.asc\r\nIs this ok [y/N]: y\r\nKey imported successfully\r\ncouchdb                                                                                                                                                       32 kB/s | 3.9 kB     00:00    \r\nImporting GPG key 0x9657A78E:\r\n Userid     : \"Nicolae Vatamaniuc <vatamane@apache.org>\"\r\n Fingerprint: 0BD7 A984 99C4 AB41 C910 EE65 FC04 DFBC 9657 A78E\r\n From       : https://couchdb.apache.org/repo/rpm-package-key.asc\r\nIs this ok [y/N]: y\r\nKey imported successfully\r\nRunning transaction check\r\nTransaction check succeeded.\r\nRunning transaction test\r\nTransaction test succeeded.\r\nRunning transaction\r\n  Preparing        :                                                                                                                                                                     1/1 \r\n  Running scriptlet: couchdb-3.3.2-1.el9.x86_64                                                                                                                                          1/1 \r\n  Installing       : couchdb-3.3.2-1.el9.x86_64                                                                                                                                          1/1 \r\n  Running scriptlet: couchdb-3.3.2-1.el9.x86_64                                                                                                                                          1/1 \r\nGenerating random cookie value.\r\n\r\n  Verifying        : couchdb-3.3.2-1.el9.x86_64                                                                                                                                          1/1 \r\n\r\nInstalled:\r\n  couchdb-3.3.2-1.el9.x86_64                                                                                                                                                                 \r\n\r\nComplete!\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1646193583/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1646193709","html_url":"https://github.com/apache/couchdb/issues/4154#issuecomment-1646193709","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4154","id":1646193709,"node_id":"IC_kwDOAAMmUc5iHuwt","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-21T20:16:47Z","updated_at":"2023-07-21T20:16:47Z","author_association":"CONTRIBUTOR","body":"Closing as fixed","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1646193709/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1646194508","html_url":"https://github.com/apache/couchdb/pull/4686#issuecomment-1646194508","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4686","id":1646194508,"node_id":"IC_kwDOAAMmUc5iHu9M","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-21T20:17:42Z","updated_at":"2023-07-21T20:17:42Z","author_association":"CONTRIBUTOR","body":"Due to the generous support from IBM's Z open source support team (@kun-lu20) in https://github.com/apache/couchdb-ci/pull/54 we have RHEL9 (clone) support with the caveat that it depends on the EPEL repo.\r\n\r\nI just uploaded the x86-64 3.3.2 centos-9 rpm to our artifactory\r\n\r\n```\r\nyum install couchdb\r\nLast metadata expiration check: 0:01:36 ago on Fri Jul 21 16:00:37 2023.\r\nDependencies resolved.\r\n=============================================================================================================================================================================================\r\n Package                                     Architecture                               Version                                            Repository                                   Size\r\n=============================================================================================================================================================================================\r\nInstalling:\r\n couchdb                                     x86_64                                     3.3.2-1.el9                                        couchdb                                      36 M\r\n\r\nTransaction Summary\r\n=============================================================================================================================================================================================\r\nInstall  1 Package\r\n\r\nTotal download size: 36 M\r\nInstalled size: 87 M\r\nIs this ok [y/N]: y\r\nDownloading Packages:\r\ncouchdb-3.3.2-1.el9.x86_64.rpm                                                                                                                               4.7 MB/s |  36 MB     00:07    \r\n---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\nTotal                                                                                                                                                        4.7 MB/s |  36 MB     00:07     \r\ncouchdb                                                                                                                                                       50 kB/s | 3.8 kB     00:00    \r\nImporting GPG key 0x7A00258D:\r\n Userid     : \"The Apache Software Foundation (Package repository signing key) <root@apache.org>\"\r\n Fingerprint: 390E F70B B1EA 12B2 7739 6295 0EE6 2FB3 7A00 258D\r\n From       : https://couchdb.apache.org/repo/keys.asc\r\nIs this ok [y/N]: y\r\nKey imported successfully\r\ncouchdb                                                                                                                                                       32 kB/s | 3.9 kB     00:00    \r\nImporting GPG key 0x9657A78E:\r\n Userid     : \"Nicolae Vatamaniuc <vatamane@apache.org>\"\r\n Fingerprint: 0BD7 A984 99C4 AB41 C910 EE65 FC04 DFBC 9657 A78E\r\n From       : https://couchdb.apache.org/repo/rpm-package-key.asc\r\nIs this ok [y/N]: y\r\nKey imported successfully\r\nRunning transaction check\r\nTransaction check succeeded.\r\nRunning transaction test\r\nTransaction test succeeded.\r\nRunning transaction\r\n  Preparing        :                                                                                                                                                                     1/1 \r\n  Running scriptlet: couchdb-3.3.2-1.el9.x86_64                                                                                                                                          1/1 \r\n  Installing       : couchdb-3.3.2-1.el9.x86_64                                                                                                                                          1/1 \r\n  Running scriptlet: couchdb-3.3.2-1.el9.x86_64                                                                                                                                          1/1 \r\nGenerating random cookie value.\r\n\r\n  Verifying        : couchdb-3.3.2-1.el9.x86_64                                                                                                                                          1/1 \r\n\r\nInstalled:\r\n  couchdb-3.3.2-1.el9.x86_64                                                                                                                                                                 \r\n\r\nComplete!\r\n```\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1646194508/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1646211445","html_url":"https://github.com/apache/couchdb/pull/4688#issuecomment-1646211445","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4688","id":1646211445,"node_id":"IC_kwDOAAMmUc5iHzF1","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-21T20:34:58Z","updated_at":"2023-07-21T20:34:58Z","author_association":"CONTRIBUTOR","body":"Superseeded by #4689.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1646211445/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1646511569","html_url":"https://github.com/apache/couchdb/pull/4686#issuecomment-1646511569","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4686","id":1646511569,"node_id":"IC_kwDOAAMmUc5iI8XR","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-22T07:04:27Z","updated_at":"2023-07-22T07:04:27Z","author_association":"MEMBER","body":"> \"Thanks for nothing, Mozilla\"\r\n\r\ntotes fair :) This is just happening at the same time as RedHat is trying to take the RHEL sources private, which creates uncertainty and potentially more work for us for no good reason :)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1646511569/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1646529309","html_url":"https://github.com/apache/couchdb/issues/4667#issuecomment-1646529309","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4667","id":1646529309,"node_id":"IC_kwDOAAMmUc5iJAsd","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-22T08:40:59Z","updated_at":"2023-07-22T08:40:59Z","author_association":"MEMBER","body":"since this is in the direct doc write path, shelling out to an external service will make this impossibly slow in practice. In addition, couchjs has no access to a HTTP client library (on purpose). This type of work is best done in a proxy in front of CouchDB.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1646529309/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1646829076","html_url":"https://github.com/apache/couchdb/pull/4687#issuecomment-1646829076","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4687","id":1646829076,"node_id":"IC_kwDOAAMmUc5iKJ4U","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-23T12:32:26Z","updated_at":"2023-07-23T12:32:26Z","author_association":"CONTRIBUTOR","body":"Don't we need to do more than juste create the FullSecret, like checking the [cookie](https://github.com/apache/couchdb/blob/48338247bdd5fd1410bc4aa8c70579d6eee5af45/src/couch/src/couch_httpd_auth.erl#L349-L396)?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1646829076/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1646834743","html_url":"https://github.com/apache/couchdb/pull/4678#issuecomment-1646834743","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4678","id":1646834743,"node_id":"IC_kwDOAAMmUc5iKLQ3","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-23T12:59:25Z","updated_at":"2023-07-23T12:59:25Z","author_association":"CONTRIBUTOR","body":"Fixed the open file handle issue by commit b7ca600e830e0ac6ccffbb75f92f4b3d71b0eacd.\r\n\r\nCommands:\r\n```\r\n.\\make.cmd\r\n...\r\n==> rel (compile)\r\n==> couchdb (compile)\r\n        1 file(s) copied.\r\n\r\nBUILD SUCCESSFUL in 48s\r\n```\r\n```\r\n.\\make.cmd nouveau-test\r\n...\r\nFinished in 25.0 seconds (0.00s async, 25.0s sync)\r\n22 tests, 0 failures\r\n\r\nRandomized with seed 901471\r\n```\r\n```\r\n.\\make.cmd clean\r\n...\r\nBUILD SUCCESSFUL in 3s\r\n1 actionable task: 1 executed\r\n```\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1646834743/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1646899238","html_url":"https://github.com/apache/couchdb/issues/4154#issuecomment-1646899238","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4154","id":1646899238,"node_id":"IC_kwDOAAMmUc5iKbAm","user":{"login":"konrad-ohms","id":40577406,"node_id":"MDQ6VXNlcjQwNTc3NDA2","avatar_url":"https://avatars.githubusercontent.com/u/40577406?v=4","gravatar_id":"","url":"https://api.github.com/users/konrad-ohms","html_url":"https://github.com/konrad-ohms","followers_url":"https://api.github.com/users/konrad-ohms/followers","following_url":"https://api.github.com/users/konrad-ohms/following{/other_user}","gists_url":"https://api.github.com/users/konrad-ohms/gists{/gist_id}","starred_url":"https://api.github.com/users/konrad-ohms/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/konrad-ohms/subscriptions","organizations_url":"https://api.github.com/users/konrad-ohms/orgs","repos_url":"https://api.github.com/users/konrad-ohms/repos","events_url":"https://api.github.com/users/konrad-ohms/events{/privacy}","received_events_url":"https://api.github.com/users/konrad-ohms/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-23T17:32:02Z","updated_at":"2023-07-23T17:32:02Z","author_association":"NONE","body":"Thank you Nick, for adding the support  ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1646899238/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1646903215","html_url":"https://github.com/apache/couchdb/issues/4154#issuecomment-1646903215","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4154","id":1646903215,"node_id":"IC_kwDOAAMmUc5iKb-v","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-23T17:46:37Z","updated_at":"2023-07-23T17:46:37Z","author_association":"CONTRIBUTOR","body":"The credit all goes to Kun Lu in this case. I just verified that it worked. :-)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1646903215/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1647534982","html_url":"https://github.com/apache/couchdb/pull/4691#issuecomment-1647534982","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4691","id":1647534982,"node_id":"IC_kwDOAAMmUc5iM2OG","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-24T09:19:47Z","updated_at":"2023-07-24T09:19:47Z","author_association":"MEMBER","body":"my assumption was that clouseau must already be running as elixir tests fail without it.  the only other option is that we do not fail our build when elixir tests fail, which would be terrible","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1647534982/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1647564679","html_url":"https://github.com/apache/couchdb/pull/4687#issuecomment-1647564679","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4687","id":1647564679,"node_id":"IC_kwDOAAMmUc5iM9eH","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-24T09:37:45Z","updated_at":"2023-07-24T09:37:45Z","author_association":"MEMBER","body":"@big-r81 The PR sends a cookie, there isn't one in the request to check yet. If there was the cookie auth handler would have done so.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1647564679/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1647807733","html_url":"https://github.com/apache/couchdb/issues/4154#issuecomment-1647807733","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4154","id":1647807733,"node_id":"IC_kwDOAAMmUc5iN4z1","user":{"login":"kun-lu20","id":78156688,"node_id":"MDQ6VXNlcjc4MTU2Njg4","avatar_url":"https://avatars.githubusercontent.com/u/78156688?v=4","gravatar_id":"","url":"https://api.github.com/users/kun-lu20","html_url":"https://github.com/kun-lu20","followers_url":"https://api.github.com/users/kun-lu20/followers","following_url":"https://api.github.com/users/kun-lu20/following{/other_user}","gists_url":"https://api.github.com/users/kun-lu20/gists{/gist_id}","starred_url":"https://api.github.com/users/kun-lu20/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kun-lu20/subscriptions","organizations_url":"https://api.github.com/users/kun-lu20/orgs","repos_url":"https://api.github.com/users/kun-lu20/repos","events_url":"https://api.github.com/users/kun-lu20/events{/privacy}","received_events_url":"https://api.github.com/users/kun-lu20/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-24T12:20:21Z","updated_at":"2023-07-24T12:20:21Z","author_association":"NONE","body":"Thanks @nickva ! I couldn't have done it without your help.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1647807733/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1648061905","html_url":"https://github.com/apache/couchdb/pull/4691#issuecomment-1648061905","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4691","id":1648061905,"node_id":"IC_kwDOAAMmUc5iO23R","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-24T14:49:14Z","updated_at":"2023-07-24T14:49:14Z","author_association":"CONTRIBUTOR","body":"> my assumption was that clouseau must already be running as elixir tests fail without it.  the only other option is that we do not fail our build when elixir tests fail, which would be terrible:\r\n\r\nAh that makes sense, @janl. We just never run `make elixir` in the CI. We run [make elixir-suite](https://github.com/apache/couchdb/blob/main/Makefile#L158). The default test suite doesn't include `clouseau` tests.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1648061905/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1648192134","html_url":"https://github.com/apache/couchdb/pull/4678#issuecomment-1648192134","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4678","id":1648192134,"node_id":"IC_kwDOAAMmUc5iPWqG","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-24T16:00:25Z","updated_at":"2023-07-24T16:00:25Z","author_association":"CONTRIBUTOR","body":"Thanks Nick, if you have time, you can test it before merging.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1648192134/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1649469638","html_url":"https://github.com/apache/couchdb/pull/4233#issuecomment-1649469638","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4233","id":1649469638,"node_id":"IC_kwDOAAMmUc5iUOjG","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-25T09:33:42Z","updated_at":"2023-07-25T09:33:42Z","author_association":"CONTRIBUTOR","body":"Closes #4698.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1649469638/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1649607130","html_url":"https://github.com/apache/couchdb/issues/4698#issuecomment-1649607130","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4698","id":1649607130,"node_id":"IC_kwDOAAMmUc5iUwHa","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-25T10:53:29Z","updated_at":"2023-07-25T10:53:29Z","author_association":"CONTRIBUTOR","body":"Resolved by #4233.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1649607130/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1649860342","html_url":"https://github.com/apache/couchdb/issues/4700#issuecomment-1649860342","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4700","id":1649860342,"node_id":"IC_kwDOAAMmUc5iVt72","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-25T13:35:15Z","updated_at":"2023-07-25T13:35:15Z","author_association":"CONTRIBUTOR","body":"Good idea, Jan.\r\n\r\nThere is a uuid7, too: \r\n  * https://www.ietf.org/archive/id/draft-peabody-dispatch-new-uuid-format-03.html#name-uuid-version-7\r\n  * https://pypi.org/project/uuid7/","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1649860342/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1650459692","html_url":"https://github.com/apache/couchdb/issues/4700#issuecomment-1650459692","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4700","id":1650459692,"node_id":"IC_kwDOAAMmUc5iYAQs","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-25T19:58:27Z","updated_at":"2023-07-25T19:58:27Z","author_association":"CONTRIBUTOR","body":"How would this look like in practice?  Something like a configuration option where the user may choose with algorithm to use for generating the `_id` values? ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1650459692/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1650495736","html_url":"https://github.com/apache/couchdb/issues/4700#issuecomment-1650495736","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4700","id":1650495736,"node_id":"IC_kwDOAAMmUc5iYJD4","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-25T20:18:27Z","updated_at":"2023-07-25T20:18:27Z","author_association":"CONTRIBUTOR","body":"We could pick the algorithm to use when a doc is created without an `_id` fields.\r\n\r\nAlso there is an API for users to generate block of UUIDs \r\n *  https://docs.couchdb.org/en/stable/api/server/common.html#uuids \r\n * https://docs.couchdb.org/en/stable/config/misc.html#uuids-configuration\r\n \r\nThat's mostly from the days when UUIDs libraries in clients weren't ubiquitous.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1650495736/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1651875668","html_url":"https://github.com/apache/couchdb/issues/4700#issuecomment-1651875668","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4700","id":1651875668,"node_id":"IC_kwDOAAMmUc5idZ9U","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-26T14:04:14Z","updated_at":"2023-07-26T14:04:14Z","author_association":"MEMBER","body":"> [pgj](https://github.com/pgj) commented [18 hours ago](https://github.com/apache/couchdb/issues/4700#issuecomment-1650459692)\r\nHow would this look like in practice? Something like a configuration option where the user may choose with algorithm to use for generating the _id values?\r\n\r\nwe already have that, I was hoping we can just add the new algos","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1651875668/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1651886463","html_url":"https://github.com/apache/couchdb/issues/4700#issuecomment-1651886463","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4700","id":1651886463,"node_id":"IC_kwDOAAMmUc5idcl_","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-26T14:09:58Z","updated_at":"2023-07-26T14:09:58Z","author_association":"CONTRIBUTOR","body":"Ah, I see.  Thanks for the answers.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1651886463/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1651915452","html_url":"https://github.com/apache/couchdb/pull/4702#issuecomment-1651915452","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4702","id":1651915452,"node_id":"IC_kwDOAAMmUc5idjq8","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-26T14:25:30Z","updated_at":"2023-07-26T14:25:30Z","author_association":"MEMBER","body":"note that I also took out a fair few unnecessary ?b2l and ?l2b's here as all the functions take iodata now. I confirmed locally that it makes no difference to the hmac, etc","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1651915452/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1653218993","html_url":"https://github.com/apache/couchdb/pull/4691#issuecomment-1653218993","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4691","id":1653218993,"node_id":"IC_kwDOAAMmUc5iih6x","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-27T09:14:09Z","updated_at":"2023-07-27T09:14:09Z","author_association":"MEMBER","body":"thanks Nick, I finally got there independently. I suggest we remove the old `elixir` target and we rename `elixir-suite` to `elixir`","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1653218993/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1653309176","html_url":"https://github.com/apache/couchdb/pull/4681#issuecomment-1653309176","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4681","id":1653309176,"node_id":"IC_kwDOAAMmUc5ii374","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-27T10:07:30Z","updated_at":"2023-07-27T10:07:30Z","author_association":"MEMBER","body":"> It's a nice usability improvement and a good use of disk space monitor.\r\n> \r\n> There are a few comments and notes in-line.\r\n> \r\n> The one tricky aspect I think is how this interacts with the internal replicator. If one node is becoming full, we'd return an ` insufficient_storage` error from workers there. The request overall might even skip over that error and return a 201/202 if other shard copies reply with a success. That's a good behavior on one hand, on the other hand, there a good chance updates we blocked interactively would still make it to the affected nodes via the internal replicator and would continue filling up the disk.\r\n> \r\n> Not sure what a good solution might be. These are a few random thoughts I had:\r\n> \r\n>     1. We could crash the whole update_doc request if any shard copy is almost full? But even then, it might be too late as the successful requests on other nodes would still propagate via the internal replicator to the full node.\r\n> \r\n>     2. Is there a graceful way to stop internal replicator jobs and avoid them going into a crash loop and making a mess to avoid replicating data to nodes which are getting full?\r\n> \r\n>     3. I am wondering if at least for doc writes it would make sense to keep track of cluster wide disk usage (via a gossip between `couch_disk_monitor` gen_server or something like that) and return an immediate error at the fabric level without attempting any worker doc writes. That would increase the complexity of disk monitor, but would avoid the internal replicator loophole issue?\r\n\r\nI think I will revise the block_database_writes() to be only _interactive_ writes. replicated writes will be permitted, as anti-entropy is critical. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1653309176/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1657189122","html_url":"https://github.com/apache/couchdb/pull/4670#issuecomment-1657189122","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4670","id":1657189122,"node_id":"IC_kwDOAAMmUc5ixrMC","user":{"login":"sergey-safarov","id":2562241,"node_id":"MDQ6VXNlcjI1NjIyNDE=","avatar_url":"https://avatars.githubusercontent.com/u/2562241?v=4","gravatar_id":"","url":"https://api.github.com/users/sergey-safarov","html_url":"https://github.com/sergey-safarov","followers_url":"https://api.github.com/users/sergey-safarov/followers","following_url":"https://api.github.com/users/sergey-safarov/following{/other_user}","gists_url":"https://api.github.com/users/sergey-safarov/gists{/gist_id}","starred_url":"https://api.github.com/users/sergey-safarov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sergey-safarov/subscriptions","organizations_url":"https://api.github.com/users/sergey-safarov/orgs","repos_url":"https://api.github.com/users/sergey-safarov/repos","events_url":"https://api.github.com/users/sergey-safarov/events{/privacy}","received_events_url":"https://api.github.com/users/sergey-safarov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-30T14:33:07Z","updated_at":"2023-07-30T14:33:07Z","author_association":"NONE","body":"@rnewson could you help me undrstand when fix will be backported to `3.3.x` branch? Or older branch.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1657189122/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1657262920","html_url":"https://github.com/apache/couchdb/pull/4670#issuecomment-1657262920","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4670","id":1657262920,"node_id":"IC_kwDOAAMmUc5ix9NI","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-30T20:43:34Z","updated_at":"2023-07-30T20:43:34Z","author_association":"MEMBER","body":"@sergey-safarov sorry, I do not know when there will be a release that includes this fix. I expect it to be backported to 3.3.x but not further.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1657262920/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1658027064","html_url":"https://github.com/apache/couchdb/pull/4288#issuecomment-1658027064","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4288","id":1658027064,"node_id":"IC_kwDOAAMmUc5i03w4","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-31T09:42:04Z","updated_at":"2023-07-31T09:42:04Z","author_association":"MEMBER","body":"@nickva @rnewson do we want to use this?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1658027064/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1658088383","html_url":"https://github.com/apache/couchdb/pull/4288#issuecomment-1658088383","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4288","id":1658088383,"node_id":"IC_kwDOAAMmUc5i1Gu_","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-31T10:21:20Z","updated_at":"2023-07-31T10:21:20Z","author_association":"MEMBER","body":"not sure I understand the need. couchdb is built against a specific version of spidermonkey, isn't it? can it change at runtime without breaking?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1658088383/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1658668391","html_url":"https://github.com/apache/couchdb/pull/4288#issuecomment-1658668391","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4288","id":1658668391,"node_id":"IC_kwDOAAMmUc5i3UVn","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-31T15:58:58Z","updated_at":"2023-07-31T15:58:58Z","author_association":"CONTRIBUTOR","body":"It's a neat patch as it shows the exact version of SM, and presumably might show if somehow the build was misconfigured (we thought we built it with SM 78 but actually built it with 96). But I don't know if it's worth having one extra NIFs in the system just for that. So I am more inclined not to have it.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1658668391/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1658839091","html_url":"https://github.com/apache/couchdb/pull/4288#issuecomment-1658839091","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4288","id":1658839091,"node_id":"IC_kwDOAAMmUc5i3-Az","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-31T17:26:16Z","updated_at":"2023-07-31T17:26:16Z","author_association":"MEMBER","body":"I'm inclined against for same reason. if it were in the same `./src/couch/priv/couch_js` pile of native code then maybe","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1658839091/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1658928035","html_url":"https://github.com/apache/couchdb/pull/4288#issuecomment-1658928035","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4288","id":1658928035,"node_id":"IC_kwDOAAMmUc5i4Tuj","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-31T18:25:57Z","updated_at":"2023-07-31T18:25:57Z","author_association":"CONTRIBUTOR","body":"It's fine be me too, to not having an extra nif. Before this PR, I backported this logic into `./couchjs -V` to print this version information from the command line. See #4262 for more details.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1658928035/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1659023034","html_url":"https://github.com/apache/couchdb/issues/4701#issuecomment-1659023034","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4701","id":1659023034,"node_id":"IC_kwDOAAMmUc5i4q66","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-31T19:40:53Z","updated_at":"2023-07-31T19:40:53Z","author_association":"CONTRIBUTOR","body":"@janl Can you test if #4712 will fix this for you too?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1659023034/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1660106146","html_url":"https://github.com/apache/couchdb/pull/4662#issuecomment-1660106146","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4662","id":1660106146,"node_id":"IC_kwDOAAMmUc5i8zWi","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-01T11:14:50Z","updated_at":"2023-08-01T11:14:50Z","author_association":"MEMBER","body":"> The covered attribute in the _explain output has been changed to covering so that it now matches the attribute name used in the analysis.\r\n\r\nJust checking: have we made a release since the `covered` property was introduced? If not, then renaming is not controversial, if yes, then this is strictly an API change and would at least require a lazy consensus vote on dev@.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1660106146/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1660124001","html_url":"https://github.com/apache/couchdb/pull/4662#issuecomment-1660124001","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4662","id":1660124001,"node_id":"IC_kwDOAAMmUc5i83th","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-01T11:27:36Z","updated_at":"2023-08-01T11:27:36Z","author_association":"CONTRIBUTOR","body":"I do not think that there was a CouchDB release with this property.  It was introduced to `main` on April 19 and since then only patch-level releases were made for the 3.2 and 3.3 branches for which the corresponding feature was not backported. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1660124001/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1660125334","html_url":"https://github.com/apache/couchdb/pull/4710#issuecomment-1660125334","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4710","id":1660125334,"node_id":"IC_kwDOAAMmUc5i84CW","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-01T11:28:35Z","updated_at":"2023-08-01T11:52:23Z","author_association":"MEMBER","body":"> `/$dbname/_design/$ddoc/_find/$indexname`\r\n\r\nwe already have `use_index` as the in-JSON way to specify the index. afaict, this PR just makes it mandatory.\r\n\r\nI have qualms with adding the URL-way on top of this and later possibly deprecating `use_index`, but this does not have to hold this particular PR for me.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1660125334/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1660133410","html_url":"https://github.com/apache/couchdb/pull/4710#issuecomment-1660133410","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4710","id":1660133410,"node_id":"IC_kwDOAAMmUc5i86Ai","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-01T11:34:20Z","updated_at":"2023-08-01T11:34:20Z","author_association":"CONTRIBUTOR","body":"I agree with @janl.  I would be happy to work on making the Mango interface to be consistent with that of Search (I like the idea), but not in the scope of this PR.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1660133410/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1660248244","html_url":"https://github.com/apache/couchdb/pull/4710#issuecomment-1660248244","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4710","id":1660248244,"node_id":"IC_kwDOAAMmUc5i9WC0","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-01T12:49:47Z","updated_at":"2023-08-01T12:49:47Z","author_association":"MEMBER","body":"I disagree. The mistake when use_index was added, where it was allowed to not use the index requested, is embedded now. Having a \"I really mean it\" option, that is optional, and off by default, makes this interface worse, not better.\r\n\r\nWe should either fix the associated issue (prevent use_index from not using any index other than the one requested) or not. An optional fudge is worse.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1660248244/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1660274182","html_url":"https://github.com/apache/couchdb/pull/4710#issuecomment-1660274182","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4710","id":1660274182,"node_id":"IC_kwDOAAMmUc5i9cYG","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-01T13:05:46Z","updated_at":"2023-08-01T13:05:46Z","author_association":"CONTRIBUTOR","body":"I see.  But we should keep `use_index` around as it is now for a while for backward compatibility, right?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1660274182/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1660283983","html_url":"https://github.com/apache/couchdb/pull/4710#issuecomment-1660283983","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4710","id":1660283983,"node_id":"IC_kwDOAAMmUc5i9exP","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-01T13:11:48Z","updated_at":"2023-08-01T13:11:48Z","author_association":"MEMBER","body":"> I see. But we should keep use_index around as it is now for a while for backward compatibility, right?\r\n\r\nYes.\r\n\r\n> An optional fudge is worse.\r\n\r\nI wouldn't frame it these strict terms. I see this PR as a step towards making the Mango-query-index-selection API look similar to JS views and search APIs. IF this PR doesn't get us the whole step there, thats fine by me as long as we arrive there eventually. IF we want to fix this all in one go, thats fine by me, but for BC reasons we will need a toggle of some sort for a while and time for folks to migrate off of the no longer preferred APIs.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1660283983/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1660300445","html_url":"https://github.com/apache/couchdb/pull/4710#issuecomment-1660300445","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4710","id":1660300445,"node_id":"IC_kwDOAAMmUc5i9iyd","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-01T13:19:13Z","updated_at":"2023-08-01T13:19:13Z","author_association":"MEMBER","body":"the behaviour of `use_index` can't easily be changed (or, I think we'd all agree, _fixed_), short of a major version bump.\r\n\r\nIf there was a roadmap here for couchdb 4.0 (handwaving, but imagine that use_index as an option goes away entirely. you either use `/dbname/_find` and let couchdb choose, or you use `/path/to/specific/index/_find` to choose for yourself).\r\n\r\nWithout that, it's hard to decide whether adding more options is taking us somewhere better or just somewhere more confusing. As a user I would be legitimately baffled to be told I should use `use_index_strict` when I report that my `use_index` directive is being ignored.\r\n\r\nI'm not sure if I'm -0 or -1 on this, I'm veering to -0 though. I don't like leaving `use_index` as-is (it should never have been merely a hint) and I don't like adding another argument to do what `use_index` should have done.\r\n\r\nHence I suggested having `_find` also reachable from a url that clearly is associated with a specific index resource, like we have for all the other kinds of index we have. That endpoint can return a 400 if the request parameters cannot be executed by the index.\r\n\r\nThat idea also gives users a migration path away from the flawed choosing algorithm. A future (major) release of CouchDB might then drop `/dbname/_find` entirely.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1660300445/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1660310854","html_url":"https://github.com/apache/couchdb/pull/4710#issuecomment-1660310854","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4710","id":1660310854,"node_id":"IC_kwDOAAMmUc5i9lVG","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-01T13:23:39Z","updated_at":"2023-08-01T13:23:39Z","author_association":"MEMBER","body":"In general, for API migrations we loosely agreed on: introduce a better API, eventually retire the old one, maybe.\r\n\r\nIn that light, adding the REST-URL-selects-index route is adding the better API and we can later remove raw `_find` when we think the time is right.\r\n\r\nThat is indeed cleaner than adding another toggle to change the behaviour of `use_index`. \r\n\r\nI have no problems with that approach.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1660310854/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1660311391","html_url":"https://github.com/apache/couchdb/pull/4710#issuecomment-1660311391","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4710","id":1660311391,"node_id":"IC_kwDOAAMmUc5i9ldf","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-01T13:23:54Z","updated_at":"2023-08-01T13:23:54Z","author_association":"MEMBER","body":"@janl I don't see how this is a step towards \"making the Mango-query-index-selection API look similar to JS views and search APIs\". my suggestion of adding `/path/to/specific/index/_find` does that, but expanding `/dbname/_find` does not. Can you explain the step you see?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1660311391/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1660312488","html_url":"https://github.com/apache/couchdb/pull/4710#issuecomment-1660312488","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4710","id":1660312488,"node_id":"IC_kwDOAAMmUc5i9luo","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-01T13:24:31Z","updated_at":"2023-08-01T13:24:31Z","author_association":"MEMBER","body":"@janl we commented concurrently. I agree with your last. :)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1660312488/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1660314166","html_url":"https://github.com/apache/couchdb/pull/4710#issuecomment-1660314166","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4710","id":1660314166,"node_id":"IC_kwDOAAMmUc5i9mI2","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-01T13:25:21Z","updated_at":"2023-08-01T13:25:21Z","author_association":"MEMBER","body":"noting `use_index` should be prohibited (400 Bad Request) for the `/path/to/index/_find` variant","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1660314166/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1660402380","html_url":"https://github.com/apache/couchdb/pull/4710#issuecomment-1660402380","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4710","id":1660402380,"node_id":"IC_kwDOAAMmUc5i97rM","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-01T14:04:40Z","updated_at":"2023-08-01T14:04:40Z","author_association":"CONTRIBUTOR","body":"> That idea also gives users a migration path away from the flawed choosing algorithm. A future (major) release of CouchDB might then drop `/dbname/_find` entirely.\r\n\r\nWhy to drop `/{db}/find` entirely?  Why not to fix the index selection algorithm instead?  I understand that it might be a nuisance for the users that a less optimal index is selected, but that is why I started to work on #4662 for example.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1660402380/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1660412655","html_url":"https://github.com/apache/couchdb/pull/4710#issuecomment-1660412655","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4710","id":1660412655,"node_id":"IC_kwDOAAMmUc5i9-Lv","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-01T14:10:27Z","updated_at":"2023-08-01T14:10:27Z","author_association":"MEMBER","body":"> Why to drop /{db}/find entirely? \r\n\r\nit was a mistake to allow unindexed queries. We are trying to reverse that mistake now :)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1660412655/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1660424954","html_url":"https://github.com/apache/couchdb/pull/4710#issuecomment-1660424954","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4710","id":1660424954,"node_id":"IC_kwDOAAMmUc5i-BL6","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-01T14:17:25Z","updated_at":"2023-08-01T14:17:25Z","author_association":"CONTRIBUTOR","body":"A revisited version of `/{db}/find` may refuse to run unindexed queries, it does not have to be necessarily removed because currently it makes that possible.  Or am I missing something here?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1660424954/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1660439181","html_url":"https://github.com/apache/couchdb/pull/4710#issuecomment-1660439181","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4710","id":1660439181,"node_id":"IC_kwDOAAMmUc5i-EqN","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-01T14:25:27Z","updated_at":"2023-08-01T14:25:27Z","author_association":"MEMBER","body":"sure, but why leave it if we have a better API in place?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1660439181/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1660474939","html_url":"https://github.com/apache/couchdb/pull/4710#issuecomment-1660474939","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4710","id":1660474939,"node_id":"IC_kwDOAAMmUc5i-NY7","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-01T14:44:28Z","updated_at":"2023-08-01T14:44:28Z","author_association":"CONTRIBUTOR","body":"I am not sure I got you.  In my understanding, `/{db}/find` provides the possibility of letting CouchDB choose the index for the query.  Removing this endpoint would lose this feature.  It is hard for me to compare this with explicitly naming the index in the URL  there is no \"better\" or \"worse\" API in that sense, I believe.  These are two different answers to the same problem: manual vs. automated index selection.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1660474939/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1660492011","html_url":"https://github.com/apache/couchdb/pull/4710#issuecomment-1660492011","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4710","id":1660492011,"node_id":"IC_kwDOAAMmUc5i-Rjr","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-01T14:54:04Z","updated_at":"2023-08-01T14:54:04Z","author_association":"MEMBER","body":"removing `/dbname/_find` is only a possibility (that could only happen in a major version bump). I mention it as part of framing any improvement here. Adding the index-specific`_find` is the couchdb-shaped way to achieve \"strict index selection\", as that's how it's done for map/reduce and search indexes today. If, in the future, we find that `/dbname/_find` is much less used / actively avoided / a source of confusion not joy, we could deprecate it.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1660492011/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]