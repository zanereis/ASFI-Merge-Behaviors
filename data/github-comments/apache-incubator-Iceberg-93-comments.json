[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844182334","html_url":"https://github.com/apache/iceberg/pull/2588#issuecomment-844182334","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2588","id":844182334,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDE4MjMzNA==","user":{"login":"snazy","id":957468,"node_id":"MDQ6VXNlcjk1NzQ2OA==","avatar_url":"https://avatars.githubusercontent.com/u/957468?v=4","gravatar_id":"","url":"https://api.github.com/users/snazy","html_url":"https://github.com/snazy","followers_url":"https://api.github.com/users/snazy/followers","following_url":"https://api.github.com/users/snazy/following{/other_user}","gists_url":"https://api.github.com/users/snazy/gists{/gist_id}","starred_url":"https://api.github.com/users/snazy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/snazy/subscriptions","organizations_url":"https://api.github.com/users/snazy/orgs","repos_url":"https://api.github.com/users/snazy/repos","events_url":"https://api.github.com/users/snazy/events{/privacy}","received_events_url":"https://api.github.com/users/snazy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-19T14:52:24Z","updated_at":"2021-05-19T14:52:24Z","author_association":"MEMBER","body":"Should worth to have https://github.com/projectnessie/nessie/pull/1249 merged into Nessie first and use Nessie 0.6.1 in this PR then.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844182334/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844211503","html_url":"https://github.com/apache/iceberg/issues/2601#issuecomment-844211503","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2601","id":844211503,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDIxMTUwMw==","user":{"login":"rakeshsayini","id":65325642,"node_id":"MDQ6VXNlcjY1MzI1NjQy","avatar_url":"https://avatars.githubusercontent.com/u/65325642?v=4","gravatar_id":"","url":"https://api.github.com/users/rakeshsayini","html_url":"https://github.com/rakeshsayini","followers_url":"https://api.github.com/users/rakeshsayini/followers","following_url":"https://api.github.com/users/rakeshsayini/following{/other_user}","gists_url":"https://api.github.com/users/rakeshsayini/gists{/gist_id}","starred_url":"https://api.github.com/users/rakeshsayini/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rakeshsayini/subscriptions","organizations_url":"https://api.github.com/users/rakeshsayini/orgs","repos_url":"https://api.github.com/users/rakeshsayini/repos","events_url":"https://api.github.com/users/rakeshsayini/events{/privacy}","received_events_url":"https://api.github.com/users/rakeshsayini/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-19T15:23:56Z","updated_at":"2021-05-19T15:23:56Z","author_association":"NONE","body":"Thanks @pvary : Tez did not officially release 0.9.3 yet. They released  0.10.1,but it did not have the fix related to TEZ-4248 by that time.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844211503/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844224732","html_url":"https://github.com/apache/iceberg/issues/2607#issuecomment-844224732","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2607","id":844224732,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDIyNDczMg==","user":{"login":"marton-bod","id":19599214,"node_id":"MDQ6VXNlcjE5NTk5MjE0","avatar_url":"https://avatars.githubusercontent.com/u/19599214?v=4","gravatar_id":"","url":"https://api.github.com/users/marton-bod","html_url":"https://github.com/marton-bod","followers_url":"https://api.github.com/users/marton-bod/followers","following_url":"https://api.github.com/users/marton-bod/following{/other_user}","gists_url":"https://api.github.com/users/marton-bod/gists{/gist_id}","starred_url":"https://api.github.com/users/marton-bod/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marton-bod/subscriptions","organizations_url":"https://api.github.com/users/marton-bod/orgs","repos_url":"https://api.github.com/users/marton-bod/repos","events_url":"https://api.github.com/users/marton-bod/events{/privacy}","received_events_url":"https://api.github.com/users/marton-bod/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-19T15:39:29Z","updated_at":"2021-05-19T15:39:29Z","author_association":"COLLABORATOR","body":"I like this. Maybe a simplification could be to collect all the key-value pairs we want to push under a single key? That way we wouldn't need to iterate through the whole conf object to find these.\r\n\r\nBased on the previous example:\r\n`iceberg.catalog.other_catalog.configs_to_push=hive.metastore.sasl.enabled=true,hive.metastore.kerberos.principal=aaa,hive.metastore.sasl.enabled=true`\r\n\r\nThen if we know our catalog name is `other_catalog`, all we'd need to do is look for this special set of configs under `iceberg.catalog.other_catalog.configs_to_push` (if any) and nothing else.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844224732/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844257696","html_url":"https://github.com/apache/iceberg/pull/2615#issuecomment-844257696","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2615","id":844257696,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDI1NzY5Ng==","user":{"login":"SreeramGarlapati","id":11813428,"node_id":"MDQ6VXNlcjExODEzNDI4","avatar_url":"https://avatars.githubusercontent.com/u/11813428?v=4","gravatar_id":"","url":"https://api.github.com/users/SreeramGarlapati","html_url":"https://github.com/SreeramGarlapati","followers_url":"https://api.github.com/users/SreeramGarlapati/followers","following_url":"https://api.github.com/users/SreeramGarlapati/following{/other_user}","gists_url":"https://api.github.com/users/SreeramGarlapati/gists{/gist_id}","starred_url":"https://api.github.com/users/SreeramGarlapati/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SreeramGarlapati/subscriptions","organizations_url":"https://api.github.com/users/SreeramGarlapati/orgs","repos_url":"https://api.github.com/users/SreeramGarlapati/repos","events_url":"https://api.github.com/users/SreeramGarlapati/events{/privacy}","received_events_url":"https://api.github.com/users/SreeramGarlapati/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-19T16:16:43Z","updated_at":"2021-05-19T16:16:43Z","author_association":"COLLABORATOR","body":"@RussellSpitzer @rdblue @aokolnychyi - pl. see if you folks can (n)ack this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844257696/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844268977","html_url":"https://github.com/apache/iceberg/issues/2607#issuecomment-844268977","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2607","id":844268977,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDI2ODk3Nw==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-19T16:30:05Z","updated_at":"2021-05-19T16:30:05Z","author_association":"CONTRIBUTOR","body":"I personally prefer to avoid concatenation because this would lead to parsing problems down the line which I would like to avoid.\r\n\r\nAnother option could the to add a key which contains the list of keys we want to push. Parsing a list of keys is more straightforward, but then it is more complicated to configure...\r\n```\r\niceberg.catalog.other_catalog.configs_to_push=hive.metastore.sasl.enabled,hive.metastore.kerberos.principal,hive.metastore.sasl.enabled\r\nhive.metastore.connect.retries=3\r\nhive.metastore.kerberos.principal=aaa\r\nhive.metastore.sasl.enabled=true\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844268977/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844269576","html_url":"https://github.com/apache/iceberg/pull/2615#issuecomment-844269576","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2615","id":844269576,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDI2OTU3Ng==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-19T16:30:50Z","updated_at":"2021-05-19T16:30:50Z","author_association":"MEMBER","body":"Mentioned on slack, Only thing I think we need here is to move the original StreamingOffset -> iceberg-spark2\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844269576/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844271708","html_url":"https://github.com/apache/iceberg/pull/2614#issuecomment-844271708","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2614","id":844271708,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDI3MTcwOA==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-19T16:33:25Z","updated_at":"2021-05-19T16:33:25Z","author_association":"CONTRIBUTOR","body":"@liubo1022126: Thanks for looking into this!\r\n\r\n- Could you please create the PR against the master branch, and then we can port it to the 0.11 branch if needed (depending on the releases)\r\n- Could you please add a test case which is failing before the fix and working after the fix? Maybe a new method into the `TestHiveIcebergStorageHandlerWithEngine`?\r\n\r\nI am not entirely sure that I understand the root cause of the problem.\r\nI feel that somehow the list of the projected columns are not correct. If my understanding is correct then this might be similar to #2171 but that is only for Tez execution engine.\r\nHaving a test case would greatly simplify the understanding of the issue.\r\n\r\nThanks,\r\nPeter\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844271708/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844273858","html_url":"https://github.com/apache/iceberg/issues/2607#issuecomment-844273858","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2607","id":844273858,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDI3Mzg1OA==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-19T16:36:13Z","updated_at":"2021-05-19T16:36:13Z","author_association":"MEMBER","body":"Since this is spark specific, I think i would just want it to be like the SparkConf and just have anything set as hadoop.* propagated (without hadoop)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844273858/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844316952","html_url":"https://github.com/apache/iceberg/issues/2308#issuecomment-844316952","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2308","id":844316952,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDMxNjk1Mg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-19T17:30:48Z","updated_at":"2021-05-19T17:30:48Z","author_association":"CONTRIBUTOR","body":"@openinx, I'm just back from parental leave so I'm catching up on this now. Thanks for your patience here.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844316952/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844347011","html_url":"https://github.com/apache/iceberg/pull/2608#issuecomment-844347011","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2608","id":844347011,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDM0NzAxMQ==","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-19T18:10:04Z","updated_at":"2021-05-19T18:10:04Z","author_association":"COLLABORATOR","body":"@flyrain thanks for the review, so to understand, you would prefer a result of Map of individual manifest-entry changes instead of a summary of manifest-files changed?  I was thinking that but was fearing it would be too big of a result.\r\n\r\nBut if we want this way (and extend this to a diff tool), we could change to return a List of something like:\r\n\r\nRepairedManifestEntry(ManifestFile parentFile, DataFile entry, List<String> repairedFields)\r\n\r\nIs that in line with your thoughts?\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844347011/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844349495","html_url":"https://github.com/apache/iceberg/issues/2308#issuecomment-844349495","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2308","id":844349495,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDM0OTQ5NQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-19T18:13:28Z","updated_at":"2021-05-19T18:13:28Z","author_association":"CONTRIBUTOR","body":"I just read through this so I think I'm caught up. Sounds like we are discussing two problems, one short term and one long term.\r\n\r\nThe short term issue is that we have a correctness problem when a row delete is committed while a rewrite is happening. I think we should fix this problem right away using the approach that @stevenzwu suggested: rewrite should validate that there are no new delete files for the partitions that are rewritten. If there are new delete files, then the rewrite should fail. This will prevent the rewrite from succeeding right now, but I think it is important to fix correctness issues as soon as possible.\r\n\r\nThe long-term issue is how to modify the rewrite operation so that we can avoid the conflict with new delete files. The approach discussed above is what we originally intended to use when we were designing the v2 metadata: a rewrite should track data files with an _older_ sequence number so that new delete files are applied correctly. That works for equality deletes, but not for position deletes. Since we're primarily concerned about streaming use cases, I think that is okay. We can continue to fail the rewrite if new position deletes are added.\r\n\r\nAlso, we can't update the sequence number of the new delete files. We have to change the sequence number of the rewritten data files. That's because there may be other data files that the new delete files would apply to if the delete file's sequence number was increased. For example, if the delete were an upsert instead -- a delete and an insert for the same row ID -- then moving the delete forward would cause Iceberg to drop the inserted replacement row.\r\n\r\n@yyanyy brings up a good point about how this limits the use of sequence numbers in other cases. I think that's okay. It is better to allow the table to be compacted. We'll figure out that problem as we design the secondary metadata. I think it would be okay because the new files would just not be covered by the secondary index and would need to be scanned. So it wouldn't introduce a correctness issue, just some potential staleness.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844349495/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844426726","html_url":"https://github.com/apache/iceberg/pull/2608#issuecomment-844426726","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2608","id":844426726,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDQyNjcyNg==","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-19T20:00:09Z","updated_at":"2021-05-19T20:00:09Z","author_association":"CONTRIBUTOR","body":"> @flyrain thanks for the review, so to understand, you would prefer a result of Map of individual manifest-entry changes instead of a summary of manifest-files changed? I was thinking that but was fearing it would be too big of a result.\r\n\r\nYes. Map works here. Your concern is valid. The size varies dramatically. For a table with 1TB data, if the average file size is 256M, we got 1000000/256 = 4,000 data files, we probably needs 100 bytes for each data files, which is about 400M data, that sounds too much to me as well.\r\n\r\nIn that sense, I'm OK with the current implementation, we can think about the different way to handle the future requirement.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844426726/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844454452","html_url":"https://github.com/apache/iceberg/issues/2607#issuecomment-844454452","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2607","id":844454452,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDQ1NDQ1Mg==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-19T20:38:06Z","updated_at":"2021-05-19T20:38:06Z","author_association":"CONTRIBUTOR","body":"When looking at this, I too was thinking that it would be anything from `hadoop.*`, as Russell mentioned. This way it's in line with the SparkConf.\r\n\r\nSo `iceberg.catalog.other_catalog.hadoop.hive.metastore.connect.retries` -> parsed out per catalog and mapped to `hive.metastore.connect.retries` in Spark.\r\n\r\nI'm much less familiar with the Hive codebase, but I imagine the same issue would also come up?\r\n\r\nFor reference, the places in the code where this issue comes up that I can see (at least for Spark) are here for the core Catalog code https://github.com/apache/iceberg/blob/90225d6c9413016d611e2ce5eff37db1bc1b4fc5/core/src/main/java/org/apache/iceberg/CatalogUtil.java#L179-L181 as well as here for the SparkCatalog (where we just pull the active sessions hadoop configuration): https://github.com/apache/iceberg/blob/98011e162b1837bf9153cfe14dfd3277c4fd3d1e/spark3/src/main/java/org/apache/iceberg/spark/SparkCatalog.java#L96-L101","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844454452/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844539911","html_url":"https://github.com/apache/iceberg/pull/2552#issuecomment-844539911","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2552","id":844539911,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDUzOTkxMQ==","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-19T22:29:02Z","updated_at":"2021-05-19T22:29:02Z","author_association":"CONTRIBUTOR","body":"The test failures are unrelated.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844539911/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844572271","html_url":"https://github.com/apache/iceberg/pull/2608#issuecomment-844572271","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2608","id":844572271,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDU3MjI3MQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-19T23:47:45Z","updated_at":"2021-05-19T23:47:45Z","author_association":"CONTRIBUTOR","body":"@szehon-ho, @RussellSpitzer, I'm debating whether I agree with the choice to add repair operations to the rewrite manifests action. I think it's very different and significantly more expensive to touch each data file. I think it would make sense for repairs to be done by a repair action. We can share a lot of the implementation, but I think it makes more sense to have an action dedicated to this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844572271/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844575077","html_url":"https://github.com/apache/iceberg/pull/2596#issuecomment-844575077","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2596","id":844575077,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDU3NTA3Nw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-19T23:54:56Z","updated_at":"2021-05-19T23:54:56Z","author_association":"CONTRIBUTOR","body":"This looks good to me, but we should clean up the property name if it hasn't been in a release yet.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844575077/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844578561","html_url":"https://github.com/apache/iceberg/pull/2582#issuecomment-844578561","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2582","id":844578561,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDU3ODU2MQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-20T00:02:59Z","updated_at":"2021-05-20T00:02:59Z","author_association":"CONTRIBUTOR","body":"@jshmchenxi, I think this should be done in several PRs instead of one. First, we would need to update the Parquet version, then we would want to add read support and finally we would add write support. That will help keep the changes to a size where reviewers can get through them in a reasonable amount of time.\r\n\r\nI also think that we need to more carefully consider how to configure Parquet's bloom filters. I would expect what you've added here as table properties to be column specific. Why did you choose global settings. Does this create a bloom filter with the same NDV for all columns?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844578561/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844579274","html_url":"https://github.com/apache/iceberg/pull/2581#issuecomment-844579274","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2581","id":844579274,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDU3OTI3NA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-20T00:04:31Z","updated_at":"2021-05-20T00:04:31Z","author_association":"CONTRIBUTOR","body":"Looks correct to me. Thanks, @jshmchenxi!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844579274/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844585720","html_url":"https://github.com/apache/iceberg/pull/2520#issuecomment-844585720","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2520","id":844585720,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDU4NTcyMA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-20T00:21:16Z","updated_at":"2021-05-20T00:21:16Z","author_association":"CONTRIBUTOR","body":"@jackye1995, I'm not sure it makes sense to use the plain text manager as you're suggesting. I know it mimics the choice we made for data files, but data files are a bit cleaner because they're not using similar methods to open the files. The main concern that I have is the ability to use the bulk decryption methods from the manager so planning a scan doesn't necessarily incur repeated RPCs to a key manager. As long as that is possible, then I'm flexible on the exact API here.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844585720/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844589947","html_url":"https://github.com/apache/iceberg/pull/2303#issuecomment-844589947","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2303","id":844589947,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDU4OTk0Nw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-20T00:33:16Z","updated_at":"2021-05-20T00:33:16Z","author_association":"CONTRIBUTOR","body":"Sorry for the delay. I'm back from parental leave now.\r\n\r\nI agree with @RussellSpitzer's comments on this. I don't think that we can remove delete files just because data files were rewritten. We need to ensure that there are no data files that are still referenced by the delete files. This is probably going to require some work and may require reading the delete file. We can use the `_file` stats in some cases but we need to be careful.\r\n\r\nFor now, I'd recommend letting the sequence numbers handle this. Because rewriting files will move them to a newer sequence number, the delete file won't be added to the new file's scan task when reading. It would still be considered during job planning, but I think that is okay and we don't need to aggressively drop them.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844589947/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844594531","html_url":"https://github.com/apache/iceberg/pull/2454#issuecomment-844594531","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2454","id":844594531,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDU5NDUzMQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-20T00:44:52Z","updated_at":"2021-05-20T00:44:52Z","author_association":"CONTRIBUTOR","body":"Looks better. Thanks, @jun-he!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844594531/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844595814","html_url":"https://github.com/apache/iceberg/pull/2512#issuecomment-844595814","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2512","id":844595814,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDU5NTgxNA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-20T00:47:46Z","updated_at":"2021-05-20T00:47:46Z","author_association":"CONTRIBUTOR","body":"@wypoon, it's much easier for users if we can use shims to handle API compatibility issues. Is Alias the only problem? Can we use a Spark shim to instantiate it?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844595814/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844595929","html_url":"https://github.com/apache/iceberg/issues/2610#issuecomment-844595929","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2610","id":844595929,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDU5NTkyOQ==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-20T00:47:58Z","updated_at":"2021-05-20T00:50:33Z","author_association":"MEMBER","body":"Did you have multiple parallelism in flink job to write the same keys to unpartitioned table ?   Assume there's three operations: \r\n\r\n```\r\n1.   INSERT key1 value1; \r\n2.   DELETE key1 value1 ; \r\n3.   INSERT key1 value2 ; \r\n```\r\n\r\nAs we have 2 parallelism to write those rows ( without shuffling by primary key),  then it's possible that:  The first parallelism  accept the event2 ( DELETE key1 value1) and write to the iceberg table,  the second parallelism accept the event1 and event3 and write to the iceberg table.  Then finally the `DELETE key1 value1` won't mask the event1 & event3 because it happens before them and it would only delete all those events with the same key that happens before the delete.  In this case,  we will encounter two duplicate `INSERT key1` with different values `value1` and `value2`.   The suggest solution to fix this issue is:   shuffling by the primary key before writing those rows into apache iceberg table because we could ensure that the rows with the same keys are wrote to iceberg table with the same order as they produced.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844595929/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844599303","html_url":"https://github.com/apache/iceberg/pull/2552#issuecomment-844599303","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2552","id":844599303,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDU5OTMwMw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-20T00:55:50Z","updated_at":"2021-05-20T00:55:50Z","author_association":"CONTRIBUTOR","body":"Thanks, @flyrain!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844599303/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844615564","html_url":"https://github.com/apache/iceberg/pull/2512#issuecomment-844615564","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2512","id":844615564,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDYxNTU2NA==","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-20T01:39:37Z","updated_at":"2021-05-20T01:39:37Z","author_association":"CONTRIBUTOR","body":"> @wypoon, it's much easier for users if we can use shims to handle API compatibility issues. Is Alias the only problem? Can we use a Spark shim to instantiate it?\r\n\r\nI can handle Alias by using reflection (DynConstructors) as well, but the real issue is this: other compatibility differences that are currently addressed are all found at compile-time; the problem with Alias was found at runtime, and only because there is an integration test that exercised that code path. The integration test suite is just a smoke test. There is no telling what other compatibility issues there are. That is why my preference is to build separate runtime jars.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844615564/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844616228","html_url":"https://github.com/apache/iceberg/pull/2512#issuecomment-844616228","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2512","id":844616228,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDYxNjIyOA==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-20T01:41:14Z","updated_at":"2021-05-20T01:41:14Z","author_association":"MEMBER","body":"I think that means we should finish up the pr I started which runs the old code with test code compiled against the new spark. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844616228/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844620555","html_url":"https://github.com/apache/iceberg/pull/2512#issuecomment-844620555","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2512","id":844620555,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDYyMDU1NQ==","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-20T01:52:27Z","updated_at":"2021-05-20T01:52:27Z","author_association":"CONTRIBUTOR","body":"> I think that means we should finish up the pr I started which runs the old code with test code compiled against the new spark.\r\n\r\nActually, I did try out your change. However, the unit tests in spark3 and spark3-extensions did not catch any issues. It was the integration test in spark3-runtime using the runtime jar built against 3.0 with Spark 3.1 that encountered the problem with Alias. (In that change, the integration test is run with Spark 3.0 and with Spark 3.1; there is only one runtime jar, built against 3.0.)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844620555/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844621779","html_url":"https://github.com/apache/iceberg/pull/2512#issuecomment-844621779","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2512","id":844621779,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDYyMTc3OQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-20T01:55:21Z","updated_at":"2021-05-20T01:55:21Z","author_association":"MEMBER","body":"That just means I must have done something wrong :) And we should fix it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844621779/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844622366","html_url":"https://github.com/apache/iceberg/pull/2512#issuecomment-844622366","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2512","id":844622366,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDYyMjM2Ng==","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-20T01:56:42Z","updated_at":"2021-05-20T01:56:42Z","author_association":"CONTRIBUTOR","body":"My overall point is that a runtime jar built with Spark 3.1 will not have compatibility issues with 3.1. One built with 3.0 may or may not have compatibility issues; finding issues is a function of how comprehensive the tests are. As new functionality gets written, the potential for compatibility problems will increase.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844622366/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844627070","html_url":"https://github.com/apache/iceberg/issues/2618#issuecomment-844627070","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2618","id":844627070,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDYyNzA3MA==","user":{"login":"coolderli","id":38486782,"node_id":"MDQ6VXNlcjM4NDg2Nzgy","avatar_url":"https://avatars.githubusercontent.com/u/38486782?v=4","gravatar_id":"","url":"https://api.github.com/users/coolderli","html_url":"https://github.com/coolderli","followers_url":"https://api.github.com/users/coolderli/followers","following_url":"https://api.github.com/users/coolderli/following{/other_user}","gists_url":"https://api.github.com/users/coolderli/gists{/gist_id}","starred_url":"https://api.github.com/users/coolderli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coolderli/subscriptions","organizations_url":"https://api.github.com/users/coolderli/orgs","repos_url":"https://api.github.com/users/coolderli/repos","events_url":"https://api.github.com/users/coolderli/events{/privacy}","received_events_url":"https://api.github.com/users/coolderli/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-20T02:07:57Z","updated_at":"2021-05-20T02:07:57Z","author_association":"CONTRIBUTOR","body":"I wonder if we can add a dynamic table option to spark SQL.\r\neg: [Coalesce Hints for SQL Queries](https://spark.apache.org/docs/latest/sql-performance-tuning.html#coalesce-hints-for-sql-queries)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844627070/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844629895","html_url":"https://github.com/apache/iceberg/pull/2615#issuecomment-844629895","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2615","id":844629895,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDYyOTg5NQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-20T02:15:17Z","updated_at":"2021-05-20T02:15:17Z","author_association":"MEMBER","body":"Merged! Thanks for the first contribution @SreeramGarlapati ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844629895/reactions","total_count":2,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844773834","html_url":"https://github.com/apache/iceberg/issues/2601#issuecomment-844773834","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2601","id":844773834,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDc3MzgzNA==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-20T07:07:27Z","updated_at":"2021-05-20T07:07:27Z","author_association":"CONTRIBUTOR","body":"That is sad 😢 \r\nIs it possible for you to create and try out a patched build?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844773834/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844777551","html_url":"https://github.com/apache/iceberg/issues/2607#issuecomment-844777551","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2607","id":844777551,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDc3NzU1MQ==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-20T07:11:28Z","updated_at":"2021-05-20T07:11:28Z","author_association":"CONTRIBUTOR","body":"> I'm much less familiar with the Hive codebase, but I imagine the same issue would also come up?\r\n\r\nYes this will be definitely a problem for Hive as well.\r\n\r\n> When looking at this, I too was thinking that it would be anything from `hadoop.*`, as Russell mentioned. This way it's in line with the SparkConf.\r\n\r\nThat would look quite awkward for a Hive user. It would be strange that a config starting with hadoop will be put to the HiveConf.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844777551/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844820685","html_url":"https://github.com/apache/iceberg/issues/2558#issuecomment-844820685","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2558","id":844820685,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDgyMDY4NQ==","user":{"login":"tiborkiss","id":531899,"node_id":"MDQ6VXNlcjUzMTg5OQ==","avatar_url":"https://avatars.githubusercontent.com/u/531899?v=4","gravatar_id":"","url":"https://api.github.com/users/tiborkiss","html_url":"https://github.com/tiborkiss","followers_url":"https://api.github.com/users/tiborkiss/followers","following_url":"https://api.github.com/users/tiborkiss/following{/other_user}","gists_url":"https://api.github.com/users/tiborkiss/gists{/gist_id}","starred_url":"https://api.github.com/users/tiborkiss/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tiborkiss/subscriptions","organizations_url":"https://api.github.com/users/tiborkiss/orgs","repos_url":"https://api.github.com/users/tiborkiss/repos","events_url":"https://api.github.com/users/tiborkiss/events{/privacy}","received_events_url":"https://api.github.com/users/tiborkiss/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-20T07:46:42Z","updated_at":"2021-05-20T07:46:42Z","author_association":"NONE","body":"I get stuck with this. I must use Flink 1.12 or 1.13.\r\nI am new to this codebase. I did some research in the flink repository, but I couldn't figure out why it was removed, or to find what is the solution.\r\n\r\nThe tests fails, because there are tests which assumes this FlinkCatalogFactory based code exists. It cannot be removed without removing the associated tests also.\r\n\r\nFirst, I would have to understand what was the functionality, or reason, why it was used Flink's catalog.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844820685/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844838873","html_url":"https://github.com/apache/iceberg/issues/2619#issuecomment-844838873","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2619","id":844838873,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDgzODg3Mw==","user":{"login":"dixingxing0","id":1303530,"node_id":"MDQ6VXNlcjEzMDM1MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1303530?v=4","gravatar_id":"","url":"https://api.github.com/users/dixingxing0","html_url":"https://github.com/dixingxing0","followers_url":"https://api.github.com/users/dixingxing0/followers","following_url":"https://api.github.com/users/dixingxing0/following{/other_user}","gists_url":"https://api.github.com/users/dixingxing0/gists{/gist_id}","starred_url":"https://api.github.com/users/dixingxing0/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dixingxing0/subscriptions","organizations_url":"https://api.github.com/users/dixingxing0/orgs","repos_url":"https://api.github.com/users/dixingxing0/repos","events_url":"https://api.github.com/users/dixingxing0/events{/privacy}","received_events_url":"https://api.github.com/users/dixingxing0/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-20T08:05:45Z","updated_at":"2021-05-20T08:05:56Z","author_association":"CONTRIBUTOR","body":"It seems your log is incomplete, i think it's better to have more log.\r\n\r\nSince you created this issue in iceberg project, i assume you are more inclined to think it is related to iceberg, do you have more clues about it? \r\n\r\nDid you have tried with other engine like spark sql, if spark sql also planned slow, then maybe it is irrelevant to trino.\r\n\r\nBTW, i've tried trino356 (with PR https://github.com/trinodb/trino/pull/7367), the analyze phase was much faster, like from 2s reduced to 1s  in my test case.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844838873/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844950381","html_url":"https://github.com/apache/iceberg/pull/2614#issuecomment-844950381","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2614","id":844950381,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDk1MDM4MQ==","user":{"login":"liubo1022126","id":47106533,"node_id":"MDQ6VXNlcjQ3MTA2NTMz","avatar_url":"https://avatars.githubusercontent.com/u/47106533?v=4","gravatar_id":"","url":"https://api.github.com/users/liubo1022126","html_url":"https://github.com/liubo1022126","followers_url":"https://api.github.com/users/liubo1022126/followers","following_url":"https://api.github.com/users/liubo1022126/following{/other_user}","gists_url":"https://api.github.com/users/liubo1022126/gists{/gist_id}","starred_url":"https://api.github.com/users/liubo1022126/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liubo1022126/subscriptions","organizations_url":"https://api.github.com/users/liubo1022126/orgs","repos_url":"https://api.github.com/users/liubo1022126/repos","events_url":"https://api.github.com/users/liubo1022126/events{/privacy}","received_events_url":"https://api.github.com/users/liubo1022126/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-20T10:14:18Z","updated_at":"2021-05-20T10:14:18Z","author_association":"NONE","body":"Thanks @pvary :\r\n\r\nMy problem should overlap with #2171 problem. and I will take the time to write test code for this problem\r\n\r\nIn the process of I fixing problem before, I tried to replace [projectedSchema](https://github.com/apache/iceberg/blob/0.11.x/mr/src/main/java/org/apache/iceberg/mr/hive/HiveIcebergSerDe.java#L106) with [this.inspector = IcebergObjectInspector.create(tableSchema)] **[1]**, and then I got the error `ArrayIndexOutOfBoundsException` at [getStructFieldData](https://github.com/apache/iceberg/blob/0.11.x/mr/src/main/java/org/apache/iceberg/mr/hive/serde/objectinspector/IcebergRecordObjectInspector.java#L73-L76) too, cause by [Object o] is only part of the select columns and [StructField structField] is all columns by init, which is modification of **[1]**.\r\n\r\nI think #2171 can also solve my problem. Although I did not use tez, our fundamental problem is the same.\r\n\r\nBecause I have no experience with hive, I have not found why the projectedSchema in hconf is incorrect. \r\n\r\nBut what I can sure is [hconf in method param](https://github.com/apache/hive/blob/branch-2.3/ql/src/java/org/apache/hadoop/hive/ql/exec/MapOperator.java#L419) is transfer to a Map<TableName, Conf>, two table's conf (contains hive.io.file.readcolumn.names) is same here. that's why get [selectedColumns](https://github.com/apache/iceberg/blob/0.11.x/mr/src/main/java/org/apache/iceberg/mr/hive/HiveIcebergSerDe.java#L92) wrong.\r\n\r\nBut the class variable [conf](https://github.com/apache/hive/blob/branch-2.3/ql/src/java/org/apache/hadoop/hive/ql/exec/Operator.java#L184) in super is ok, contains all tables info, can refer to [here](https://github.com/apache/hive/blob/branch-2.3/ql/src/java/org/apache/hadoop/hive/ql/exec/MapOperator.java#L350) and [here](https://github.com/apache/hive/blob/branch-2.3/ql/src/java/org/apache/hadoop/hive/ql/exec/MapOperator.java#L354)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844950381/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844985765","html_url":"https://github.com/apache/iceberg/pull/2614#issuecomment-844985765","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2614","id":844985765,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDk4NTc2NQ==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-20T11:05:01Z","updated_at":"2021-05-20T11:05:01Z","author_association":"CONTRIBUTOR","body":"> But what I can sure is [hconf in method param](https://github.com/apache/hive/blob/branch-2.3/ql/src/java/org/apache/hadoop/hive/ql/exec/MapOperator.java#L419) is transfer to a Map<TableName, Conf>, two table's conf (contains hive.io.file.readcolumn.names) is same here. that's why get [selectedColumns](https://github.com/apache/iceberg/blob/0.11.x/mr/src/main/java/org/apache/iceberg/mr/hive/HiveIcebergSerDe.java#L92) wrong.\r\n\r\nBy reading the code there `cloneConfsForNestedColPruning(hconf);` creates a map for every table, and every conf should contain the pruning info for the specific table. See:\r\n```\r\n  /**\r\n   * For each source table, combine the nested column pruning information from all its \r\n   * table scan descriptors and set it in a configuration copy. This is necessary since\r\n   * the configuration property \"READ_NESTED_COLUMN_PATH_CONF_STR\" is set on a per-table\r\n   * basis, so we can't just use a single configuration for all the tables.\r\n   */\r\n  private Map<String, Configuration> cloneConfsForNestedColPruning(Configuration hconf) {\r\n```\r\n\r\nSo you have found that the configs are not correctly set by this method and they contain the same pruning information for both tables?\r\n\r\nThanks,\r\nPeter","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/844985765/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845010561","html_url":"https://github.com/apache/iceberg/issues/2530#issuecomment-845010561","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2530","id":845010561,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NTAxMDU2MQ==","user":{"login":"Poncirus","id":34835605,"node_id":"MDQ6VXNlcjM0ODM1NjA1","avatar_url":"https://avatars.githubusercontent.com/u/34835605?v=4","gravatar_id":"","url":"https://api.github.com/users/Poncirus","html_url":"https://github.com/Poncirus","followers_url":"https://api.github.com/users/Poncirus/followers","following_url":"https://api.github.com/users/Poncirus/following{/other_user}","gists_url":"https://api.github.com/users/Poncirus/gists{/gist_id}","starred_url":"https://api.github.com/users/Poncirus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Poncirus/subscriptions","organizations_url":"https://api.github.com/users/Poncirus/orgs","repos_url":"https://api.github.com/users/Poncirus/repos","events_url":"https://api.github.com/users/Poncirus/events{/privacy}","received_events_url":"https://api.github.com/users/Poncirus/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-20T11:34:15Z","updated_at":"2021-05-20T11:34:15Z","author_association":"NONE","body":"Is this the same issue? https://issues.apache.org/jira/browse/SPARK-33867","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845010561/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845010938","html_url":"https://github.com/apache/iceberg/pull/2614#issuecomment-845010938","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2614","id":845010938,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NTAxMDkzOA==","user":{"login":"liubo1022126","id":47106533,"node_id":"MDQ6VXNlcjQ3MTA2NTMz","avatar_url":"https://avatars.githubusercontent.com/u/47106533?v=4","gravatar_id":"","url":"https://api.github.com/users/liubo1022126","html_url":"https://github.com/liubo1022126","followers_url":"https://api.github.com/users/liubo1022126/followers","following_url":"https://api.github.com/users/liubo1022126/following{/other_user}","gists_url":"https://api.github.com/users/liubo1022126/gists{/gist_id}","starred_url":"https://api.github.com/users/liubo1022126/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liubo1022126/subscriptions","organizations_url":"https://api.github.com/users/liubo1022126/orgs","repos_url":"https://api.github.com/users/liubo1022126/repos","events_url":"https://api.github.com/users/liubo1022126/events{/privacy}","received_events_url":"https://api.github.com/users/liubo1022126/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-20T11:34:35Z","updated_at":"2021-05-20T11:34:35Z","author_association":"NONE","body":"@pvary : Yes, it only reset `hive.io.file.readNestedColumn.paths` from class variable [conf](https://github.com/apache/hive/blob/branch-2.3/ql/src/java/org/apache/hadoop/hive/ql/exec/Operator.java#L184)\r\n\r\nSo as what I mentioned in Solution 2 in this Pr, we can get needColumns from [conf](https://github.com/apache/hive/blob/branch-2.3/ql/src/java/org/apache/hadoop/hive/ql/exec/Operator.java#L184) and then get it as a property in iceberg, but we also need to patch hive.\r\n\r\n> And I found that there is another way to fix these problem, and I think this way is the best. But we also need to code hive.\r\n> \r\n> With hive, in class org.apache.hadoop.hive.ql.exec.MapOperator, we can get need columns from ((TableScanOperator) conf.getAliasToWork().get(alias)).getConf().getNeededColumns(), and set it in hconf public void setChildren(Configuration hconf) use a property px.\r\n> \r\n> Then in class org.apache.iceberg.mr.hive.HiveIcebergSerDe in iceberg, we can get need columns from property px correctly.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845010938/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845015249","html_url":"https://github.com/apache/iceberg/pull/2608#issuecomment-845015249","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2608","id":845015249,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NTAxNTI0OQ==","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-20T11:40:07Z","updated_at":"2021-05-20T11:40:40Z","author_association":"COLLABORATOR","body":"Great to see you back @rdblue  :)\r\n\r\nYes, after this first implementation, I see some advantages of having dedicated RepairManifestAction.  RewriteManifestAction is compaction-oriented, and in so by design it cannot run across two separate partitionSpecs, whereas RepairManifests should be able to do so as it would not combine manifest files.  \r\n\r\nAnd yes in general, I see the two can be conceptually different like you said.  I can spend some time to look at making this separate action, and refactor common code to the base class.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845015249/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845030747","html_url":"https://github.com/apache/iceberg/pull/2614#issuecomment-845030747","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2614","id":845030747,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NTAzMDc0Nw==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-20T11:58:55Z","updated_at":"2021-05-20T11:58:55Z","author_association":"CONTRIBUTOR","body":"So basically the test case is that we have 2 tables where we have a column with the same name (maybe at the end of the column list), and we select only a few columns from each of the table, but we select the column with the same name. This would catch the issue?\r\n\r\nAm I right? Could you please create a test case, then I can check the Hive code and see what we could do with it.\r\n\r\nThanks,\r\nPeter","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845030747/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845040516","html_url":"https://github.com/apache/iceberg/pull/2614#issuecomment-845040516","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2614","id":845040516,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NTA0MDUxNg==","user":{"login":"liubo1022126","id":47106533,"node_id":"MDQ6VXNlcjQ3MTA2NTMz","avatar_url":"https://avatars.githubusercontent.com/u/47106533?v=4","gravatar_id":"","url":"https://api.github.com/users/liubo1022126","html_url":"https://github.com/liubo1022126","followers_url":"https://api.github.com/users/liubo1022126/followers","following_url":"https://api.github.com/users/liubo1022126/following{/other_user}","gists_url":"https://api.github.com/users/liubo1022126/gists{/gist_id}","starred_url":"https://api.github.com/users/liubo1022126/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liubo1022126/subscriptions","organizations_url":"https://api.github.com/users/liubo1022126/orgs","repos_url":"https://api.github.com/users/liubo1022126/repos","events_url":"https://api.github.com/users/liubo1022126/events{/privacy}","received_events_url":"https://api.github.com/users/liubo1022126/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-20T12:09:17Z","updated_at":"2021-05-20T12:09:17Z","author_association":"NONE","body":"@pvary We need a larger number of rows in both tables, the unit test class is not easy to code.\r\n\r\nI think I can write 2 tables schema and upload data textfile somewhere, anyone can test by them, what do you think about.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845040516/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845094631","html_url":"https://github.com/apache/iceberg/issues/2530#issuecomment-845094631","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2530","id":845094631,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NTA5NDYzMQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-20T12:58:25Z","updated_at":"2021-05-20T12:58:25Z","author_association":"MEMBER","body":"Looks like the same core issue but for the JDBC Connector/Dialect code\n\nOn Thu, May 20, 2021 at 6:34 AM Liao Hanwen ***@***.***>\nwrote:\n\n> Is this the same issue? https://issues.apache.org/jira/browse/SPARK-33867\n>\n> —\n> You are receiving this because you authored the thread.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/apache/iceberg/issues/2530#issuecomment-845010561>,\n> or unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/AADE2YP54TYN3DOV4MNZPKDTOTXUZANCNFSM43VHGUHQ>\n> .\n>\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845094631/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845213399","html_url":"https://github.com/apache/iceberg/pull/2614#issuecomment-845213399","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2614","id":845213399,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NTIxMzM5OQ==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-20T15:18:20Z","updated_at":"2021-05-20T15:18:20Z","author_association":"CONTRIBUTOR","body":"> I think I can write 2 tables schema and upload data textfile somewhere, anyone can test by them, what do you think about.\r\n\r\nSo if you can upload the data files somewhere and provide a unit test which reproduces the case that would be a good start. I still not sure why we need large number of rows, but if that is the only way to repro the case, then we should try it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845213399/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845417000","html_url":"https://github.com/apache/iceberg/pull/2551#issuecomment-845417000","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2551","id":845417000,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NTQxNzAwMA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-20T19:31:06Z","updated_at":"2021-05-20T19:31:06Z","author_association":"CONTRIBUTOR","body":"Thanks, @gszadovszky!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845417000/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845429034","html_url":"https://github.com/apache/iceberg/issues/2607#issuecomment-845429034","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2607","id":845429034,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NTQyOTAzNA==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-20T19:50:48Z","updated_at":"2021-05-20T19:50:48Z","author_association":"CONTRIBUTOR","body":"> > I'm much less familiar with the Hive codebase, but I imagine the same issue would also come up?\r\n> \r\n> Yes this will be definitely a problem for Hive as well.\r\n> \r\n> > When looking at this, I too was thinking that it would be anything from `hadoop.*`, as Russell mentioned. This way it's in line with the SparkConf.\r\n> \r\n> That would look quite awkward for a Hive user. It would be strange that a config starting with hadoop will be put to the HiveConf.\r\n\r\nOk. I somewhat pictured that. Given that this will be a problem for several people, another idea that I've had floating around in my head (that might not be a good one so feel free to say so) would be to have possibly multiple hive-site.xml / whatever hive conf files and have THOSE be pointed to as table properties?\r\n\r\nAdmittedly even just typing it out, I don't love it. But I'd be curious to hear what you think (and why it's as bad of an idea as I suspect it is).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845429034/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845431819","html_url":"https://github.com/apache/iceberg/pull/2282#issuecomment-845431819","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2282","id":845431819,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NTQzMTgxOQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-20T19:55:47Z","updated_at":"2021-05-20T19:55:47Z","author_association":"MEMBER","body":"@bkahloon ping :) ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845431819/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845514501","html_url":"https://github.com/apache/iceberg/pull/2372#issuecomment-845514501","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2372","id":845514501,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NTUxNDUwMQ==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-20T22:10:58Z","updated_at":"2021-05-20T22:10:58Z","author_association":"CONTRIBUTOR","body":"Finally get some time to catch up with all the delete works. In general I agree the delete marker sounds like the right way to go forward. Regarding the 4 situations that Junjie described for his use cases, which are:\r\n\r\n1. Convert all equality deletes to position deletes.\r\n2. Cluster all position deletes to one.\r\n3. Convert all equality deletes and position deletes to one position deletes.\r\n4. Remove all deletes.\r\n\r\nHowever, these are based on the assumption that:\r\n\r\n1. we should always move files from equality deletes to position deletes to data files\r\n2. we should have as few delete files as possible\r\n\r\nWhich are not 100% true in all situations. For example against 1, if we have tables that are well partitioned and sorted, and deletes are issued based on those partition and sort columns, then equality delete actually can consume way less memory and also perform better. For example against 2, having 1 single delete file means it has to be included in every single FileScanTask that might be executed by different workers and cannot share any cache, whereas if we have splitted those delete files, much fewer rows in delete files have to be read in each task. This also removed bottleneck of reading a single file with high parallelism which causes throttling in cloud storages.\r\n\r\nFor major compaction, I think there is no doubt, it's the removal of all delete files, and the RewriteDataFiles work that Russell is doing should cover major compaction use case.\r\n\r\nBut I feel everyone has a somewhat similar but different definition for minor compaction. I totally agree with Junjie that we should allow fine grained control for people to run a flexible set of actions based on the use case, and here is the definition in my mind:\r\n\r\nMajor compaction: an action that takes all files in a snapshot and produces only data files\r\nMinor compaction: an action that takes all files in a snapshot and produces only delete files that are applied on top of the existing data files\r\n\r\nIt seems to me that we should add an action similar to `RewriteDataFiles` and make another action framework, and we can implement different strategies for that action to fulfill different use cases described. What do you think?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845514501/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845518944","html_url":"https://github.com/apache/iceberg/pull/2538#issuecomment-845518944","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2538","id":845518944,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NTUxODk0NA==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-20T22:21:29Z","updated_at":"2021-05-20T22:21:29Z","author_association":"CONTRIBUTOR","body":"overall looks good to me, I left some discussion comments in the original PR.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845518944/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845608044","html_url":"https://github.com/apache/iceberg/pull/2591#issuecomment-845608044","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2591","id":845608044,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NTYwODA0NA==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-21T02:33:52Z","updated_at":"2021-05-21T02:34:34Z","author_association":"MEMBER","body":"> Overall looks good to me. I would like to revisit the RewriteStrategy idea a bit. Because we are basically going to rewrite and remove all the delete files in this action along the way, this is what I see as the method for running major compaction.\r\n> \r\nWe cannot and are not deleting delete files in this action because it's actually much more difficult to find out which delete files are no longer in use than just checking which ones are referred to by the FileScanTasks for the files we are looking at. For example, we may determine File A should be read in conjunction with Delete File 1, and that it should be split into multiple files. We cannot remove DeleteFile 1 because it may also apply to Files B, and C which we didn't even consider.\r\n\r\nTo actually determine delete files you must check the delete file against every valid file (not the other way around) and only if the delete file cannot be applied to any live files can you mark it as non-live (trying to avoid deleted deleted file).\r\n\r\nBecause of that complexity we were hoping to move DeleteFiles compaction and cleanup to another action entirely. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845608044/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845616568","html_url":"https://github.com/apache/iceberg/issues/2558#issuecomment-845616568","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2558","id":845616568,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NTYxNjU2OA==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-21T03:00:09Z","updated_at":"2021-05-21T03:00:09Z","author_association":"MEMBER","body":"> but I couldn't figure out why it was removed, or to find what is the solution.\r\n\r\nBecause the `CatalogDescriptorValidator` is a public API which was marked as `Internal`,  the `Internal` API don't guarantee the compatibility when upgrading from flink 1.12 to flink1.13,  so in theory we apache iceberg shouldn't use any of the `Internal` public API from apache flink unless we have to ( actually we've already followed the rule but still have few depended classes). \r\n\r\n> I would have to understand what was the functionality, or reason, why it was used Flink's catalog.\r\n\r\nFirstly,  we apache iceberg need a catalog to manage the iceberg tables, and the catalog also provide the global table lock so that we could implement the iceberg optimistic lock (guarantee the ACID semantic).  \r\n\r\nSecond,  it's good to integrate the iceberg catalog implementation to flink catalog interface because all flink sql are built on top of flink catalogs/tables,  then we could just use the flink catalog sql to manage the iceberg catalogs and create iceberg tables under flink managed catalog.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845616568/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845621625","html_url":"https://github.com/apache/iceberg/pull/2591#issuecomment-845621625","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2591","id":845621625,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NTYyMTYyNQ==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-21T03:15:27Z","updated_at":"2021-05-21T03:15:27Z","author_association":"CONTRIBUTOR","body":"> We cannot and are not deleting delete files in this action because it's actually much more difficult to find out which delete files are no longer in use than just checking which ones are referred to by the FileScanTasks for the files we are looking at.\r\n\r\nYes I am aware of this condition, but the delete files are applied for each file scan task anyway, it's just we cannot remove it because of the condition you described, and we have to call another action, do double work to fully remove the file. Conversely, say we have another action to only remove delete files, then we are reading those delete files anyway, and it also feels wasteful to me that we have to do another bin pack after deleting those files to make the files more optimized, and potentially cause more commit conflicts.\r\n\r\nI understand there is a good separation of concern if we do them as 2 different actions. But when I try to imagine what the compaction API looks like, it seems that I just need a different `selectFilesToRewrite` implementation of the rewrite strategy, and other things can mostly be reused with just a few small branching logic.\r\n\r\nSo instead of having another totally different action that removes delete file, the major compaction can potentially be done as just an extension to the existing strategy or a replacement to run a different strategy. For example, we can extend the current bin pack strategy with: if there are delete files in a file scan task, then the data file must be included for rewriting. We can also plug in a strategy that try to select all data files based on a certain delete file threshold, etc.\r\n\r\nWe can get more clever about that as we evolve, but the general thought I have is that having data file rewriting and delete file compaction as one base action with different strategies to satisfy different use cases seems to be a more efficient and flexible way to go.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845621625/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845628652","html_url":"https://github.com/apache/iceberg/pull/2591#issuecomment-845628652","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2591","id":845628652,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NTYyODY1Mg==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-21T03:37:06Z","updated_at":"2021-05-21T03:41:15Z","author_association":"MEMBER","body":"> > We cannot and are not deleting delete files in this action because it's actually much more difficult to find out which delete files are no longer in use than just checking which ones are referred to by the FileScanTasks for the files we are looking at.\r\n> \r\n> Yes I am aware of this condition, but the delete files are applied for each file scan task anyway, it's just we cannot remove it because of the condition you described, and we have to call another action, do double work to fully remove the file. Conversely, say we have another action to only remove delete files, then we are reading those delete files anyway, and it also feels wasteful to me that we have to do another bin pack after deleting those files to make the files more optimized, and potentially cause more commit conflicts.\r\n\r\nThey are only applied to the files we are looking at. It's not the reading of the delete files that is expensive, to determine if a delete file isn't needed we have to scan through *every* data file they may apply to. So the main pain here isn't that we have to read delete files more than once, but that to actually remove delete files you basically must do a full scan of the entire partition.\r\n\r\nFor example\r\n\r\nDelete file A may touch Files A, B , C ,D\r\nWe plan for files A and B\r\nAfter running binpack we Read A and B and write A' and B' we never touch C and D.\r\nDelete File A may now only touch C, and D \r\n\r\nIf we now want to check if we can remove Delete File A we only have to read files C and D so we actually\r\nmade progress.\r\n\r\n\r\nIt's only in the case that we run a full compaction that we know that we can remove delete files, and in that case removing delete files is basically free. We don't have to read anything and can just remove all delete files, no risk of conflicts since the files don't do anything.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845628652/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845628909","html_url":"https://github.com/apache/iceberg/pull/2282#issuecomment-845628909","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2282","id":845628909,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NTYyODkwOQ==","user":{"login":"bkahloon","id":42993708,"node_id":"MDQ6VXNlcjQyOTkzNzA4","avatar_url":"https://avatars.githubusercontent.com/u/42993708?v=4","gravatar_id":"","url":"https://api.github.com/users/bkahloon","html_url":"https://github.com/bkahloon","followers_url":"https://api.github.com/users/bkahloon/followers","following_url":"https://api.github.com/users/bkahloon/following{/other_user}","gists_url":"https://api.github.com/users/bkahloon/gists{/gist_id}","starred_url":"https://api.github.com/users/bkahloon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bkahloon/subscriptions","organizations_url":"https://api.github.com/users/bkahloon/orgs","repos_url":"https://api.github.com/users/bkahloon/repos","events_url":"https://api.github.com/users/bkahloon/events{/privacy}","received_events_url":"https://api.github.com/users/bkahloon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-21T03:37:56Z","updated_at":"2021-05-21T03:37:56Z","author_association":"CONTRIBUTOR","body":"> @bkahloon ping :)\r\n\r\nHi @RussellSpitzer , sorry I had been busy with some other obligations. I will work on the write support according to your suggestions.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845628909/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845641397","html_url":"https://github.com/apache/iceberg/pull/2591#issuecomment-845641397","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2591","id":845641397,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NTY0MTM5Nw==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-21T04:18:27Z","updated_at":"2021-05-21T04:25:05Z","author_association":"CONTRIBUTOR","body":"> If we now want to check if we can remove Delete File A we only have to read files C and D so we actually\r\nmade progress.\r\n\r\nI think this is the place I am a bit confused. A' and B' don't need delete file A for sure because sequence number of A' and B' is higher. But we don't read C and D to add delete file A to C and D's FileScanTask. It's done by reading the statistics of delete file A and determined by the partition filter. As long as there are files of lower sequence number in that partition, the delete file will be included to that file scan task if data filter also pass.\r\n\r\nThis means that if we can have a counter for each delete file and expose a method `cleanUnreferencedDeleteFiles()` called after `planFileGroups()`, we can naturally get all the files compacted just by running bin packing continuously.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845641397/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845645797","html_url":"https://github.com/apache/iceberg/pull/2591#issuecomment-845645797","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2591","id":845645797,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NTY0NTc5Nw==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-21T04:33:21Z","updated_at":"2021-05-21T04:34:17Z","author_association":"MEMBER","body":"> > If we now want to check if we can remove Delete File A we only have to read files C and D so we actually\r\n> > made progress.\r\n> \r\n> I think this is the place I am a bit confused. A' and B' don't need delete file A for sure because sequence number of A' and B' is higher. But we don't read C and D to add delete file A to C and D's FileScanTask. It's done by reading the statistics of delete file A and determined by the partition filter. As long as there are files of lower sequence number in that partition, the delete file will be included to that file scan task.\r\n> \r\n> This means that if we can have a counter for each delete file and expose a method `cleanUnreferencedDeleteFiles()` called after `planFileGroups()`, we can naturally get all the files compacted just by running bin packing continuously.\r\n\r\nWe don't read C and D to check if delete file A is used in C and D's scan task. But we don't know if Delete File A is needed without reading C and D. Delete File A may not touch any rows in files C and D or it may. We can count references, but this ends up being a problem if we don't actually include all files because we have pushed down our filters size filters to the manifest reader itself (future plans) and it only helps us in the luckiest case where we know a delete file has been completely dereferenced. If file C for example is the correct size, and we never need to rewrite it, we never clean up those deletes so we still have to make another sort of action to clean up those files.\r\n\r\nThat said, the same sweep of delete-files you are describing should probably just be performed on every action which deletes files, and not just during bin pack since that particular method of eliminating files is very cheap but also unlikely to actually pick up any delete files for removal. We talked about this previously as a possible post-merge, post-delete, post-rewrite sort of thing. But again since that kind of clean up never conflicts, we can really do it at any time without a lot of cost to perf.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845645797/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845657683","html_url":"https://github.com/apache/iceberg/pull/2591#issuecomment-845657683","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2591","id":845657683,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NTY1NzY4Mw==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-21T05:10:47Z","updated_at":"2021-05-21T05:10:47Z","author_association":"CONTRIBUTOR","body":"> We talked about this previously as a possible post-merge, post-delete, post-rewrite sort of thing. \r\n\r\nCool, that `cleanUnreferencedDeleteFiles()` was just a divergent thought, great that we already thought about it.\r\n\r\n> If file C for example is the correct size, and we never need to rewrite it, we never clean up those deletes so we still have to make another sort of action to clean up those files.\r\n\r\nYes, that goes back to what I was thinking before, if we can have an option to force check the delete file and avoid filtering it out of the rewrite, then it should work.\r\n\r\nBut I think I am starting to see where you are coming from. If this is done as a different action then we can save the write time if the file read does not contain any rows to delete in the delete file. To enable such a check in Spark, it cannot use the same code path that fully read all the rows and write it back. So it probably does not make sense to add delete functionality from that perspective. Thanks for the clarification!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845657683/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845734575","html_url":"https://github.com/apache/iceberg/issues/2455#issuecomment-845734575","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2455","id":845734575,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NTczNDU3NQ==","user":{"login":"xianhaohihi","id":83751027,"node_id":"MDQ6VXNlcjgzNzUxMDI3","avatar_url":"https://avatars.githubusercontent.com/u/83751027?v=4","gravatar_id":"","url":"https://api.github.com/users/xianhaohihi","html_url":"https://github.com/xianhaohihi","followers_url":"https://api.github.com/users/xianhaohihi/followers","following_url":"https://api.github.com/users/xianhaohihi/following{/other_user}","gists_url":"https://api.github.com/users/xianhaohihi/gists{/gist_id}","starred_url":"https://api.github.com/users/xianhaohihi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xianhaohihi/subscriptions","organizations_url":"https://api.github.com/users/xianhaohihi/orgs","repos_url":"https://api.github.com/users/xianhaohihi/repos","events_url":"https://api.github.com/users/xianhaohihi/events{/privacy}","received_events_url":"https://api.github.com/users/xianhaohihi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-21T07:42:40Z","updated_at":"2021-05-21T07:42:40Z","author_association":"NONE","body":"hi, i've met the same problem with flink 1.12 when trying sink data to iceberg, have you already solve the problem?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845734575/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845819766","html_url":"https://github.com/apache/iceberg/issues/2607#issuecomment-845819766","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2607","id":845819766,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NTgxOTc2Ng==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-21T09:30:40Z","updated_at":"2021-05-21T09:30:40Z","author_association":"CONTRIBUTOR","body":"> Ok. I somewhat pictured that. Given that this will be a problem for several people, another idea that I've had floating around in my head (that might not be a good one so feel free to say so) would be to have possibly multiple hive-site.xml / whatever hive conf files and have THOSE be pointed to as table properties?\r\n\r\nIn hive you very rarely want to touch the local FS or even the remote FS directly. Not that it is not possible, but again something that would be strange.\r\n\r\nCurrently I still would prefer the `...catalog_in_different_authority.config_to_push.hive...` solution, but I also admit it is not perfect (adding secrets to the public config and making sure everything is hidden correctly seems like a wish for disaster)\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845819766/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845826982","html_url":"https://github.com/apache/iceberg/issues/2482#issuecomment-845826982","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2482","id":845826982,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NTgyNjk4Mg==","user":{"login":"jshmchenxi","id":11854435,"node_id":"MDQ6VXNlcjExODU0NDM1","avatar_url":"https://avatars.githubusercontent.com/u/11854435?v=4","gravatar_id":"","url":"https://api.github.com/users/jshmchenxi","html_url":"https://github.com/jshmchenxi","followers_url":"https://api.github.com/users/jshmchenxi/followers","following_url":"https://api.github.com/users/jshmchenxi/following{/other_user}","gists_url":"https://api.github.com/users/jshmchenxi/gists{/gist_id}","starred_url":"https://api.github.com/users/jshmchenxi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jshmchenxi/subscriptions","organizations_url":"https://api.github.com/users/jshmchenxi/orgs","repos_url":"https://api.github.com/users/jshmchenxi/repos","events_url":"https://api.github.com/users/jshmchenxi/events{/privacy}","received_events_url":"https://api.github.com/users/jshmchenxi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-21T09:43:02Z","updated_at":"2021-05-21T09:43:02Z","author_association":"CONTRIBUTOR","body":"I found that setting parentId to null will cause some tests to fail because it loses relationship between child and parent snapshots. I tried another approach in the PR : https://github.com/apache/iceberg/pull/2603#issue-646494574","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845826982/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845828011","html_url":"https://github.com/apache/iceberg/issues/2530#issuecomment-845828011","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2530","id":845828011,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NTgyODAxMQ==","user":{"login":"Poncirus","id":34835605,"node_id":"MDQ6VXNlcjM0ODM1NjA1","avatar_url":"https://avatars.githubusercontent.com/u/34835605?v=4","gravatar_id":"","url":"https://api.github.com/users/Poncirus","html_url":"https://github.com/Poncirus","followers_url":"https://api.github.com/users/Poncirus/followers","following_url":"https://api.github.com/users/Poncirus/following{/other_user}","gists_url":"https://api.github.com/users/Poncirus/gists{/gist_id}","starred_url":"https://api.github.com/users/Poncirus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Poncirus/subscriptions","organizations_url":"https://api.github.com/users/Poncirus/orgs","repos_url":"https://api.github.com/users/Poncirus/repos","events_url":"https://api.github.com/users/Poncirus/events{/privacy}","received_events_url":"https://api.github.com/users/Poncirus/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-21T09:45:00Z","updated_at":"2021-05-21T09:45:00Z","author_association":"NONE","body":"I may find the reason.\r\nSee https://issues.apache.org/jira/browse/SPARK-31910 and https://github.com/apache/spark/pull/28729. Configure spark.sql.datetime.java8API.enabled is set to true in thrift SQL CLI, whose default setting is false.\r\nI work around this issue by adding \"set spark.sql.datetime.java8API.enabled=false;\" in my spark SQL temporarily. Looking forward to new release of iceberg.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845828011/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845836626","html_url":"https://github.com/apache/iceberg/pull/2596#issuecomment-845836626","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2596","id":845836626,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NTgzNjYyNg==","user":{"login":"coolderli","id":38486782,"node_id":"MDQ6VXNlcjM4NDg2Nzgy","avatar_url":"https://avatars.githubusercontent.com/u/38486782?v=4","gravatar_id":"","url":"https://api.github.com/users/coolderli","html_url":"https://github.com/coolderli","followers_url":"https://api.github.com/users/coolderli/followers","following_url":"https://api.github.com/users/coolderli/following{/other_user}","gists_url":"https://api.github.com/users/coolderli/gists{/gist_id}","starred_url":"https://api.github.com/users/coolderli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coolderli/subscriptions","organizations_url":"https://api.github.com/users/coolderli/orgs","repos_url":"https://api.github.com/users/coolderli/repos","events_url":"https://api.github.com/users/coolderli/events{/privacy}","received_events_url":"https://api.github.com/users/coolderli/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-21T09:59:53Z","updated_at":"2021-05-21T09:59:53Z","author_association":"CONTRIBUTOR","body":"@rdblue @aokolnychyi  I have checked the latest tag [0.11.1,](https://github.com/apache/iceberg/blob/apache-iceberg-0.11.1/core/src/main/java/org/apache/iceberg/TableProperties.java) the `commit.num-status-checks` has not been released yet. I have renamed it to `commit.status-checks.num-retries`.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845836626/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845857371","html_url":"https://github.com/apache/iceberg/pull/2621#issuecomment-845857371","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2621","id":845857371,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NTg1NzM3MQ==","user":{"login":"coolderli","id":38486782,"node_id":"MDQ6VXNlcjM4NDg2Nzgy","avatar_url":"https://avatars.githubusercontent.com/u/38486782?v=4","gravatar_id":"","url":"https://api.github.com/users/coolderli","html_url":"https://github.com/coolderli","followers_url":"https://api.github.com/users/coolderli/followers","following_url":"https://api.github.com/users/coolderli/following{/other_user}","gists_url":"https://api.github.com/users/coolderli/gists{/gist_id}","starred_url":"https://api.github.com/users/coolderli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coolderli/subscriptions","organizations_url":"https://api.github.com/users/coolderli/orgs","repos_url":"https://api.github.com/users/coolderli/repos","events_url":"https://api.github.com/users/coolderli/events{/privacy}","received_events_url":"https://api.github.com/users/coolderli/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-21T10:37:41Z","updated_at":"2021-05-21T10:37:41Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer @rdblue What do you think of this","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845857371/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845906296","html_url":"https://github.com/apache/iceberg/issues/2610#issuecomment-845906296","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2610","id":845906296,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NTkwNjI5Ng==","user":{"login":"ayush-san","id":57655135,"node_id":"MDQ6VXNlcjU3NjU1MTM1","avatar_url":"https://avatars.githubusercontent.com/u/57655135?v=4","gravatar_id":"","url":"https://api.github.com/users/ayush-san","html_url":"https://github.com/ayush-san","followers_url":"https://api.github.com/users/ayush-san/followers","following_url":"https://api.github.com/users/ayush-san/following{/other_user}","gists_url":"https://api.github.com/users/ayush-san/gists{/gist_id}","starred_url":"https://api.github.com/users/ayush-san/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ayush-san/subscriptions","organizations_url":"https://api.github.com/users/ayush-san/orgs","repos_url":"https://api.github.com/users/ayush-san/repos","events_url":"https://api.github.com/users/ayush-san/events{/privacy}","received_events_url":"https://api.github.com/users/ayush-san/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-21T12:10:42Z","updated_at":"2021-05-21T12:10:42Z","author_association":"NONE","body":"@openinx Earlier I had task parallelism of 2 in the Source Kafka table, now I have reduced it to 1. Will monitor the job if it is working fine or not\r\n![image](https://user-images.githubusercontent.com/57655135/119134765-2e821780-ba5b-11eb-9d77-76df0957357b.png)\r\n\r\nI have one question though, Will it be solved by your primary key PR? For some big tables, I need we will need parallelism of more than 1, so what should be done in that case?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845906296/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845924223","html_url":"https://github.com/apache/iceberg/pull/2538#issuecomment-845924223","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2538","id":845924223,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NTkyNDIyMw==","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-21T12:43:59Z","updated_at":"2021-05-21T12:43:59Z","author_association":"COLLABORATOR","body":"Thanks @jackye1995 !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845924223/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845924472","html_url":"https://github.com/apache/iceberg/pull/2614#issuecomment-845924472","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2614","id":845924472,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NTkyNDQ3Mg==","user":{"login":"liubo1022126","id":47106533,"node_id":"MDQ6VXNlcjQ3MTA2NTMz","avatar_url":"https://avatars.githubusercontent.com/u/47106533?v=4","gravatar_id":"","url":"https://api.github.com/users/liubo1022126","html_url":"https://github.com/liubo1022126","followers_url":"https://api.github.com/users/liubo1022126/followers","following_url":"https://api.github.com/users/liubo1022126/following{/other_user}","gists_url":"https://api.github.com/users/liubo1022126/gists{/gist_id}","starred_url":"https://api.github.com/users/liubo1022126/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liubo1022126/subscriptions","organizations_url":"https://api.github.com/users/liubo1022126/orgs","repos_url":"https://api.github.com/users/liubo1022126/repos","events_url":"https://api.github.com/users/liubo1022126/events{/privacy}","received_events_url":"https://api.github.com/users/liubo1022126/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-21T12:44:26Z","updated_at":"2021-05-21T12:44:26Z","author_association":"NONE","body":"@pvary Sorry to reply now, I was a bit busy today, right table need large number of rows, I guessing is related to cbo, affecting the execution plan. \r\n\r\n [there](https://github.com/liubo1022126/data_lib/blob/main/iceberg/pr-2614/README.md) is the Reproduce the problem and [orc_000000_0](https://github.com/liubo1022126/data_lib/tree/main/iceberg/pr-2614) is the datafile.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845924472/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845937255","html_url":"https://github.com/apache/iceberg/pull/2621#issuecomment-845937255","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2621","id":845937255,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NTkzNzI1NQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-21T13:06:43Z","updated_at":"2021-05-21T13:06:43Z","author_association":"MEMBER","body":"That makes sense to me, could you add a test to verify?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845937255/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845938873","html_url":"https://github.com/apache/iceberg/issues/2455#issuecomment-845938873","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2455","id":845938873,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NTkzODg3Mw==","user":{"login":"ashwini-tgam","id":77637230,"node_id":"MDQ6VXNlcjc3NjM3MjMw","avatar_url":"https://avatars.githubusercontent.com/u/77637230?v=4","gravatar_id":"","url":"https://api.github.com/users/ashwini-tgam","html_url":"https://github.com/ashwini-tgam","followers_url":"https://api.github.com/users/ashwini-tgam/followers","following_url":"https://api.github.com/users/ashwini-tgam/following{/other_user}","gists_url":"https://api.github.com/users/ashwini-tgam/gists{/gist_id}","starred_url":"https://api.github.com/users/ashwini-tgam/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ashwini-tgam/subscriptions","organizations_url":"https://api.github.com/users/ashwini-tgam/orgs","repos_url":"https://api.github.com/users/ashwini-tgam/repos","events_url":"https://api.github.com/users/ashwini-tgam/events{/privacy}","received_events_url":"https://api.github.com/users/ashwini-tgam/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-21T13:09:23Z","updated_at":"2021-05-21T13:09:23Z","author_association":"NONE","body":"> @ashwini-tgam The `RowDataTypeInfo` is a class that comes from flink 1.11, in flink 1.12 the class was refactored to `InternalTypeInfo` (See https://github.com/apache/iceberg/pull/1956/files#diff-752b41f006e879a05750f3723df689214cdd629d8d9f48af76ed9f99c38d49b2R38). So I think you are using flink-runtime jar that was compiled from flink 1.11 and then run the flink streaming job under flink 1.12 cluster ? Pls check you flink-runtime jar version and flink cluster version.\r\n\r\nI am using flink 1.11 in production which did not solve my issue","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845938873/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845939222","html_url":"https://github.com/apache/iceberg/issues/2455#issuecomment-845939222","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2455","id":845939222,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NTkzOTIyMg==","user":{"login":"ashwini-tgam","id":77637230,"node_id":"MDQ6VXNlcjc3NjM3MjMw","avatar_url":"https://avatars.githubusercontent.com/u/77637230?v=4","gravatar_id":"","url":"https://api.github.com/users/ashwini-tgam","html_url":"https://github.com/ashwini-tgam","followers_url":"https://api.github.com/users/ashwini-tgam/followers","following_url":"https://api.github.com/users/ashwini-tgam/following{/other_user}","gists_url":"https://api.github.com/users/ashwini-tgam/gists{/gist_id}","starred_url":"https://api.github.com/users/ashwini-tgam/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ashwini-tgam/subscriptions","organizations_url":"https://api.github.com/users/ashwini-tgam/orgs","repos_url":"https://api.github.com/users/ashwini-tgam/repos","events_url":"https://api.github.com/users/ashwini-tgam/events{/privacy}","received_events_url":"https://api.github.com/users/ashwini-tgam/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-21T13:09:55Z","updated_at":"2021-05-21T13:09:55Z","author_association":"NONE","body":"> hi, i've met the same problem with flink 1.12 when trying sink data to iceberg, have you already solve the problem?\r\n\r\nNo I am not able to solve it but in production server it worked but never worked on my local","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845939222/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845939540","html_url":"https://github.com/apache/iceberg/pull/2372#issuecomment-845939540","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2372","id":845939540,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NTkzOTU0MA==","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-21T13:10:24Z","updated_at":"2021-05-21T13:10:24Z","author_association":"COLLABORATOR","body":"@jackye1995 , The use cases you mentioned make sense to me. Really good points! I agree that we should define a `RewriteDeletes` framework to allow users to perform different strategies according to their table definitions and data status. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845939540/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845939886","html_url":"https://github.com/apache/iceberg/pull/2591#issuecomment-845939886","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2591","id":845939886,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NTkzOTg4Ng==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-21T13:10:59Z","updated_at":"2021-05-21T13:10:59Z","author_association":"MEMBER","body":"Thanks for discussing it with me, I definitely want to make this efficient and I know some of our future plans haven’t been documented yet. On thing I really want to finish is distributed planning where no machine ever gets the full scan plan.\n\nSent from my iPhone\n\n> On May 21, 2021, at 12:11 AM, Jack Ye ***@***.***> wrote:\n> \n> ﻿\n> We talked about this previously as a possible post-merge, post-delete, post-rewrite sort of thing.\n> \n> Cool, that cleanUnreferencedDeleteFiles() was just a divergent thought, great that we already thought about it.\n> \n> If file C for example is the correct size, and we never need to rewrite it, we never clean up those deletes so we still have to make another sort of action to clean up those files.\n> \n> Yes, that goes back to what I was thinking before, if we can have an option to force check the delete file and avoid filtering it out of the rewrite, then it should work.\n> \n> But I think I am starting to see where you are coming from. If this is done as a different action then we can save the write time if the file read does not contain any rows to delete in the delete file. To enable such a check in Spark, it cannot use the same code path that fully read all the rows and write it back. So it probably does not make sense to add delete functionality from that perspective. Thanks for the clarification!\n> \n> —\n> You are receiving this because you authored the thread.\n> Reply to this email directly, view it on GitHub, or unsubscribe.\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845939886/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845940866","html_url":"https://github.com/apache/iceberg/issues/2530#issuecomment-845940866","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2530","id":845940866,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NTk0MDg2Ng==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-21T13:12:44Z","updated_at":"2021-05-21T13:12:44Z","author_association":"MEMBER","body":"Ah ha! Thanks for tracking that down! I knew there had to be something floating around that caused the issue \n\nSent from my iPhone\n\n> On May 21, 2021, at 4:45 AM, Liao Hanwen ***@***.***> wrote:\n> \n> ﻿\n> I may find the reason.\n> See https://issues.apache.org/jira/browse/SPARK-31910 and apache/spark#28729. Configure spark.sql.datetime.java8API.enabled is set to true in thrift SQL CLI, whose default setting is false.\n> I work around this issue by adding \"set spark.sql.datetime.java8API.enabled=false;\" in my spark SQL temporarily. Looking forward to new release of iceberg.\n> \n> —\n> You are receiving this because you authored the thread.\n> Reply to this email directly, view it on GitHub, or unsubscribe.\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845940866/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845949077","html_url":"https://github.com/apache/iceberg/pull/2614#issuecomment-845949077","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2614","id":845949077,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NTk0OTA3Nw==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-21T13:26:23Z","updated_at":"2021-05-21T13:26:23Z","author_association":"CONTRIBUTOR","body":"@liubo1022126: Thanks for collecting these, because of some National Holidays next week I will need some time to take a look into it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/845949077/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/846239712","html_url":"https://github.com/apache/iceberg/pull/2620#issuecomment-846239712","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2620","id":846239712,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NjIzOTcxMg==","user":{"login":"rdsr","id":129474,"node_id":"MDQ6VXNlcjEyOTQ3NA==","avatar_url":"https://avatars.githubusercontent.com/u/129474?v=4","gravatar_id":"","url":"https://api.github.com/users/rdsr","html_url":"https://github.com/rdsr","followers_url":"https://api.github.com/users/rdsr/followers","following_url":"https://api.github.com/users/rdsr/following{/other_user}","gists_url":"https://api.github.com/users/rdsr/gists{/gist_id}","starred_url":"https://api.github.com/users/rdsr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdsr/subscriptions","organizations_url":"https://api.github.com/users/rdsr/orgs","repos_url":"https://api.github.com/users/rdsr/repos","events_url":"https://api.github.com/users/rdsr/events{/privacy}","received_events_url":"https://api.github.com/users/rdsr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-21T20:32:52Z","updated_at":"2021-05-21T20:32:52Z","author_association":"CONTRIBUTOR","body":"Generally looks to me, but do we know why we are not checking this in as part of #2272 ? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/846239712/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/846285011","html_url":"https://github.com/apache/iceberg/pull/2596#issuecomment-846285011","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2596","id":846285011,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NjI4NTAxMQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-21T22:02:50Z","updated_at":"2021-05-21T22:02:50Z","author_association":"CONTRIBUTOR","body":"Merged! Can you also update the table properties docs, @coolderli?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/846285011/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/846291838","html_url":"https://github.com/apache/iceberg/pull/2620#issuecomment-846291838","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2620","id":846291838,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NjI5MTgzOA==","user":{"login":"SreeramGarlapati","id":11813428,"node_id":"MDQ6VXNlcjExODEzNDI4","avatar_url":"https://avatars.githubusercontent.com/u/11813428?v=4","gravatar_id":"","url":"https://api.github.com/users/SreeramGarlapati","html_url":"https://github.com/SreeramGarlapati","followers_url":"https://api.github.com/users/SreeramGarlapati/followers","following_url":"https://api.github.com/users/SreeramGarlapati/following{/other_user}","gists_url":"https://api.github.com/users/SreeramGarlapati/gists{/gist_id}","starred_url":"https://api.github.com/users/SreeramGarlapati/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SreeramGarlapati/subscriptions","organizations_url":"https://api.github.com/users/SreeramGarlapati/orgs","repos_url":"https://api.github.com/users/SreeramGarlapati/repos","events_url":"https://api.github.com/users/SreeramGarlapati/events{/privacy}","received_events_url":"https://api.github.com/users/SreeramGarlapati/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-21T22:24:29Z","updated_at":"2021-05-21T22:24:29Z","author_association":"COLLABORATOR","body":"> Generally looks to me, but do we know why we are not checking this in as part of #2272 ?\r\n\r\n@rdsr - #2272 is spark2. Its a matter of time @XuQianJin-Stars - resolves the comments and pushes it. I am trying to push spark3 connector - for SalesForce needs & needing this change.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/846291838/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/846296998","html_url":"https://github.com/apache/iceberg/issues/2481#issuecomment-846296998","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2481","id":846296998,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NjI5Njk5OA==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-21T22:43:36Z","updated_at":"2021-05-21T22:43:36Z","author_association":"CONTRIBUTOR","body":"@pvary yeah sorry I am making up this syntax because something similar to this exists in delta lake. So it is definitely doable in Spark, but for Hive yes it is going to be hard to add extensions like this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/846296998/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/846298012","html_url":"https://github.com/apache/iceberg/pull/2620#issuecomment-846298012","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2620","id":846298012,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NjI5ODAxMg==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-21T22:47:36Z","updated_at":"2021-05-21T22:47:36Z","author_association":"MEMBER","body":"I'm ok with merging this in, but let's try to wrap future patches in more logical and testable chunks. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/846298012/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/846299193","html_url":"https://github.com/apache/iceberg/issues/2481#issuecomment-846299193","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2481","id":846299193,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NjI5OTE5Mw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-21T22:52:16Z","updated_at":"2021-05-21T22:52:16Z","author_association":"CONTRIBUTOR","body":"For this use case, we may want to consider adding git-like branches and tags instead. I think it would be cleaner to branch and then update the branch. Then you'd be able to stay within a table and reuse data files more cleanly. Sharing files across independent tables has a lot of problems.\r\n\r\nThat would also have a cleaner syntax: `catalog.db.table.branch`. That would prevent us from using some branch names, like `files` but I think overall it would be okay.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/846299193/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/846311403","html_url":"https://github.com/apache/iceberg/pull/2620#issuecomment-846311403","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2620","id":846311403,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NjMxMTQwMw==","user":{"login":"SreeramGarlapati","id":11813428,"node_id":"MDQ6VXNlcjExODEzNDI4","avatar_url":"https://avatars.githubusercontent.com/u/11813428?v=4","gravatar_id":"","url":"https://api.github.com/users/SreeramGarlapati","html_url":"https://github.com/SreeramGarlapati","followers_url":"https://api.github.com/users/SreeramGarlapati/followers","following_url":"https://api.github.com/users/SreeramGarlapati/following{/other_user}","gists_url":"https://api.github.com/users/SreeramGarlapati/gists{/gist_id}","starred_url":"https://api.github.com/users/SreeramGarlapati/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SreeramGarlapati/subscriptions","organizations_url":"https://api.github.com/users/SreeramGarlapati/orgs","repos_url":"https://api.github.com/users/SreeramGarlapati/repos","events_url":"https://api.github.com/users/SreeramGarlapati/events{/privacy}","received_events_url":"https://api.github.com/users/SreeramGarlapati/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-21T23:43:22Z","updated_at":"2021-05-21T23:44:04Z","author_association":"COLLABORATOR","body":"> I'm ok with merging this in, but let's try to wrap future patches in more logical and testable chunks.\r\n\r\nack. - will keep this in mind @RussellSpitzer.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/846311403/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/846325291","html_url":"https://github.com/apache/iceberg/pull/2582#issuecomment-846325291","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2582","id":846325291,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NjMyNTI5MQ==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-22T01:05:07Z","updated_at":"2021-05-22T01:05:07Z","author_association":"CONTRIBUTOR","body":"> @jshmchenxi, I think this should be done in several PRs instead of one. First, we would need to update the Parquet version, then we would want to add read support and finally we would add write support. That will help keep the changes to a size where reviewers can get through them in a reasonable amount of time\r\n\r\nAgreed on parquet versions. With the number of supported spark versions, it would be difficult to bring up parquet 1.12 (as great as it is) without some consideration by major stakeholders.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/846325291/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/846328080","html_url":"https://github.com/apache/iceberg/pull/2596#issuecomment-846328080","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2596","id":846328080,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NjMyODA4MA==","user":{"login":"coolderli","id":38486782,"node_id":"MDQ6VXNlcjM4NDg2Nzgy","avatar_url":"https://avatars.githubusercontent.com/u/38486782?v=4","gravatar_id":"","url":"https://api.github.com/users/coolderli","html_url":"https://github.com/coolderli","followers_url":"https://api.github.com/users/coolderli/followers","following_url":"https://api.github.com/users/coolderli/following{/other_user}","gists_url":"https://api.github.com/users/coolderli/gists{/gist_id}","starred_url":"https://api.github.com/users/coolderli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coolderli/subscriptions","organizations_url":"https://api.github.com/users/coolderli/orgs","repos_url":"https://api.github.com/users/coolderli/repos","events_url":"https://api.github.com/users/coolderli/events{/privacy}","received_events_url":"https://api.github.com/users/coolderli/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-22T01:27:03Z","updated_at":"2021-05-22T01:27:03Z","author_association":"CONTRIBUTOR","body":"@rdblue OK, I will add the document as soon as possible","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/846328080/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/846328710","html_url":"https://github.com/apache/iceberg/pull/2621#issuecomment-846328710","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2621","id":846328710,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NjMyODcxMA==","user":{"login":"coolderli","id":38486782,"node_id":"MDQ6VXNlcjM4NDg2Nzgy","avatar_url":"https://avatars.githubusercontent.com/u/38486782?v=4","gravatar_id":"","url":"https://api.github.com/users/coolderli","html_url":"https://github.com/coolderli","followers_url":"https://api.github.com/users/coolderli/followers","following_url":"https://api.github.com/users/coolderli/following{/other_user}","gists_url":"https://api.github.com/users/coolderli/gists{/gist_id}","starred_url":"https://api.github.com/users/coolderli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coolderli/subscriptions","organizations_url":"https://api.github.com/users/coolderli/orgs","repos_url":"https://api.github.com/users/coolderli/repos","events_url":"https://api.github.com/users/coolderli/events{/privacy}","received_events_url":"https://api.github.com/users/coolderli/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-22T01:31:43Z","updated_at":"2021-05-22T01:31:43Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer Ok, I'll add a unit test later.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/846328710/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/846332513","html_url":"https://github.com/apache/iceberg/issues/2481#issuecomment-846332513","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2481","id":846332513,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NjMzMjUxMw==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-22T01:59:45Z","updated_at":"2021-05-22T01:59:45Z","author_association":"CONTRIBUTOR","body":"> we may want to consider adding git-like branches and tags instead\r\n\r\n@rdblue yes that would be ideal, but Nessie is trying to achieve this git-like experience. Currently it seems like people do want to continue using their catalog and also have that experience. Was there any discussion about this conflict of interest?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/846332513/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/846382208","html_url":"https://github.com/apache/iceberg/pull/2621#issuecomment-846382208","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2621","id":846382208,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NjM4MjIwOA==","user":{"login":"coolderli","id":38486782,"node_id":"MDQ6VXNlcjM4NDg2Nzgy","avatar_url":"https://avatars.githubusercontent.com/u/38486782?v=4","gravatar_id":"","url":"https://api.github.com/users/coolderli","html_url":"https://github.com/coolderli","followers_url":"https://api.github.com/users/coolderli/followers","following_url":"https://api.github.com/users/coolderli/following{/other_user}","gists_url":"https://api.github.com/users/coolderli/gists{/gist_id}","starred_url":"https://api.github.com/users/coolderli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coolderli/subscriptions","organizations_url":"https://api.github.com/users/coolderli/orgs","repos_url":"https://api.github.com/users/coolderli/repos","events_url":"https://api.github.com/users/coolderli/events{/privacy}","received_events_url":"https://api.github.com/users/coolderli/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-22T09:34:15Z","updated_at":"2021-05-22T09:34:15Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer @rdblue I have added a unit test, could you help me review it?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/846382208/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/846382485","html_url":"https://github.com/apache/iceberg/pull/2622#issuecomment-846382485","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2622","id":846382485,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NjM4MjQ4NQ==","user":{"login":"rymurr","id":2022305,"node_id":"MDQ6VXNlcjIwMjIzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/2022305?v=4","gravatar_id":"","url":"https://api.github.com/users/rymurr","html_url":"https://github.com/rymurr","followers_url":"https://api.github.com/users/rymurr/followers","following_url":"https://api.github.com/users/rymurr/following{/other_user}","gists_url":"https://api.github.com/users/rymurr/gists{/gist_id}","starred_url":"https://api.github.com/users/rymurr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rymurr/subscriptions","organizations_url":"https://api.github.com/users/rymurr/orgs","repos_url":"https://api.github.com/users/rymurr/repos","events_url":"https://api.github.com/users/rymurr/events{/privacy}","received_events_url":"https://api.github.com/users/rymurr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-22T09:36:45Z","updated_at":"2021-05-22T09:36:45Z","author_association":"CONTRIBUTOR","body":"Looks good to me @jasonhughes248 !\n\nAny thoughts @rdblue @aokolnychyi ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/846382485/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/846410643","html_url":"https://github.com/apache/iceberg/issues/2619#issuecomment-846410643","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2619","id":846410643,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NjQxMDY0Mw==","user":{"login":"maxingui","id":30031910,"node_id":"MDQ6VXNlcjMwMDMxOTEw","avatar_url":"https://avatars.githubusercontent.com/u/30031910?v=4","gravatar_id":"","url":"https://api.github.com/users/maxingui","html_url":"https://github.com/maxingui","followers_url":"https://api.github.com/users/maxingui/followers","following_url":"https://api.github.com/users/maxingui/following{/other_user}","gists_url":"https://api.github.com/users/maxingui/gists{/gist_id}","starred_url":"https://api.github.com/users/maxingui/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maxingui/subscriptions","organizations_url":"https://api.github.com/users/maxingui/orgs","repos_url":"https://api.github.com/users/maxingui/repos","events_url":"https://api.github.com/users/maxingui/events{/privacy}","received_events_url":"https://api.github.com/users/maxingui/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-22T13:45:01Z","updated_at":"2021-05-22T13:45:01Z","author_association":"NONE","body":"thinks for you reply，my trino version is 356 too； the issue does not appear in hdfs+hadoop environment,but trino iceberg with huawei OBS accurs\r\nlog as below：\r\n[22.log](https://github.com/apache/iceberg/files/6526494/22.log)\r\n\r\n\r\n\r\n\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/846410643/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/846423023","html_url":"https://github.com/apache/iceberg/pull/2624#issuecomment-846423023","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2624","id":846423023,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NjQyMzAyMw==","user":{"login":"dongjoon-hyun","id":9700541,"node_id":"MDQ6VXNlcjk3MDA1NDE=","avatar_url":"https://avatars.githubusercontent.com/u/9700541?v=4","gravatar_id":"","url":"https://api.github.com/users/dongjoon-hyun","html_url":"https://github.com/dongjoon-hyun","followers_url":"https://api.github.com/users/dongjoon-hyun/followers","following_url":"https://api.github.com/users/dongjoon-hyun/following{/other_user}","gists_url":"https://api.github.com/users/dongjoon-hyun/gists{/gist_id}","starred_url":"https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongjoon-hyun/subscriptions","organizations_url":"https://api.github.com/users/dongjoon-hyun/orgs","repos_url":"https://api.github.com/users/dongjoon-hyun/repos","events_url":"https://api.github.com/users/dongjoon-hyun/events{/privacy}","received_events_url":"https://api.github.com/users/dongjoon-hyun/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-22T15:21:38Z","updated_at":"2021-05-22T15:28:25Z","author_association":"MEMBER","body":"Could you review this, @aokolnychyi and @RussellSpitzer ?\r\nThe failure looks irrelevant one because this is tested in my GitHub Action without any problem.\r\n- https://github.com/dongjoon-hyun/iceberg/pull/3\r\n\r\nOr, how can I re-trigger this?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/846423023/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/846441491","html_url":"https://github.com/apache/iceberg/pull/2624#issuecomment-846441491","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2624","id":846441491,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NjQ0MTQ5MQ==","user":{"login":"dongjoon-hyun","id":9700541,"node_id":"MDQ6VXNlcjk3MDA1NDE=","avatar_url":"https://avatars.githubusercontent.com/u/9700541?v=4","gravatar_id":"","url":"https://api.github.com/users/dongjoon-hyun","html_url":"https://github.com/dongjoon-hyun","followers_url":"https://api.github.com/users/dongjoon-hyun/followers","following_url":"https://api.github.com/users/dongjoon-hyun/following{/other_user}","gists_url":"https://api.github.com/users/dongjoon-hyun/gists{/gist_id}","starred_url":"https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongjoon-hyun/subscriptions","organizations_url":"https://api.github.com/users/dongjoon-hyun/orgs","repos_url":"https://api.github.com/users/dongjoon-hyun/repos","events_url":"https://api.github.com/users/dongjoon-hyun/events{/privacy}","received_events_url":"https://api.github.com/users/dongjoon-hyun/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-22T17:44:25Z","updated_at":"2021-05-22T17:44:25Z","author_association":"MEMBER","body":"Thank you, @RussellSpitzer . At this time, `extra-checks` passed!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/846441491/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/846488154","html_url":"https://github.com/apache/iceberg/pull/2624#issuecomment-846488154","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2624","id":846488154,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NjQ4ODE1NA==","user":{"login":"dongjoon-hyun","id":9700541,"node_id":"MDQ6VXNlcjk3MDA1NDE=","avatar_url":"https://avatars.githubusercontent.com/u/9700541?v=4","gravatar_id":"","url":"https://api.github.com/users/dongjoon-hyun","html_url":"https://github.com/dongjoon-hyun","followers_url":"https://api.github.com/users/dongjoon-hyun/followers","following_url":"https://api.github.com/users/dongjoon-hyun/following{/other_user}","gists_url":"https://api.github.com/users/dongjoon-hyun/gists{/gist_id}","starred_url":"https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongjoon-hyun/subscriptions","organizations_url":"https://api.github.com/users/dongjoon-hyun/orgs","repos_url":"https://api.github.com/users/dongjoon-hyun/repos","events_url":"https://api.github.com/users/dongjoon-hyun/events{/privacy}","received_events_url":"https://api.github.com/users/dongjoon-hyun/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-23T01:48:54Z","updated_at":"2021-05-23T01:48:54Z","author_association":"MEMBER","body":"Thank you!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/846488154/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/846538833","html_url":"https://github.com/apache/iceberg/pull/2614#issuecomment-846538833","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2614","id":846538833,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NjUzODgzMw==","user":{"login":"liubo1022126","id":47106533,"node_id":"MDQ6VXNlcjQ3MTA2NTMz","avatar_url":"https://avatars.githubusercontent.com/u/47106533?v=4","gravatar_id":"","url":"https://api.github.com/users/liubo1022126","html_url":"https://github.com/liubo1022126","followers_url":"https://api.github.com/users/liubo1022126/followers","following_url":"https://api.github.com/users/liubo1022126/following{/other_user}","gists_url":"https://api.github.com/users/liubo1022126/gists{/gist_id}","starred_url":"https://api.github.com/users/liubo1022126/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liubo1022126/subscriptions","organizations_url":"https://api.github.com/users/liubo1022126/orgs","repos_url":"https://api.github.com/users/liubo1022126/repos","events_url":"https://api.github.com/users/liubo1022126/events{/privacy}","received_events_url":"https://api.github.com/users/liubo1022126/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-23T10:20:03Z","updated_at":"2021-05-23T10:20:03Z","author_association":"NONE","body":"@pvary ok, have a great holiday.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/846538833/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/846631871","html_url":"https://github.com/apache/iceberg/pull/2622#issuecomment-846631871","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2622","id":846631871,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NjYzMTg3MQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-23T22:12:51Z","updated_at":"2021-05-23T22:12:51Z","author_association":"CONTRIBUTOR","body":"Thanks, @jasonhughes248! This looks like an improvement. I can share the original drawing with you if you want to edit that instead. There are also a couple of things we may want to change.\r\n\r\nFirst, I just gave a talk with what I think might be a better series of diagrams than the one here. I'd be interested in getting your feedback on that and whether we should replace the doc based on the new ones instead.\r\n[Iceberg Row-level Updates.pdf](https://github.com/apache/iceberg/files/6528986/Iceberg.Row-level.Updates.pdf)\r\n\r\nSecond, assuming that we go with the older drawing, I think we also need to show that both snapshots, `s1` and `s2` exist in the same metadata file. One of the biggest misconceptions is that each metadata file points to a single snapshot, but they actually contain a list of all valid snapshots. Aging off snapshots removes older ones from that list and updates the history, then writes a new metadata file.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/846631871/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/846632057","html_url":"https://github.com/apache/iceberg/pull/2623#issuecomment-846632057","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2623","id":846632057,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NjYzMjA1Nw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-23T22:14:30Z","updated_at":"2021-05-23T22:14:30Z","author_association":"CONTRIBUTOR","body":"Thanks for the fix, @chenjunjiedada!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/846632057/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/846633585","html_url":"https://github.com/apache/iceberg/pull/2625#issuecomment-846633585","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2625","id":846633585,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NjYzMzU4NQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-23T22:26:13Z","updated_at":"2021-05-23T22:26:13Z","author_association":"CONTRIBUTOR","body":"Thanks for separating this out, @chenjunjiedada!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/846633585/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/846641765","html_url":"https://github.com/apache/iceberg/issues/2481#issuecomment-846641765","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2481","id":846641765,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NjY0MTc2NQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-23T23:25:27Z","updated_at":"2021-05-23T23:25:27Z","author_association":"CONTRIBUTOR","body":"I've talked with @rymurr about the way that Nessie currently works and I think we generally agree that we would want to change it to use Iceberg-native branching and tagging.\r\n\r\nThe problem with Nessie's current model is that it keeps references to multiple metadata files instead of tracking everything in one place. That means:\r\n* We have to coordinate across metadata file versions even though Iceberg assumes that you don't do that: for example, that breaks the file cleanup assumptions because we compare the files that are reachable from all snapshots.\r\n* Changes that shouldn't be part of transactions may change between branches. For example, if you add a column in a branch and write data, you will have assigned a new ID and used it in a data file. If you did that in two branches in parallel, you'd use the same ID for two different columns. It may appear safe to merge the metadata trees, but it actually isn't because that would mix column data together.\r\n\r\nWe can fix those issues with Iceberg-native branching and tagging. I think that's the right option for use cases where you want to branch from current tables for testing purposes.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/846641765/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/846818484","html_url":"https://github.com/apache/iceberg/issues/2610#issuecomment-846818484","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2610","id":846818484,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NjgxODQ4NA==","user":{"login":"ayush-san","id":57655135,"node_id":"MDQ6VXNlcjU3NjU1MTM1","avatar_url":"https://avatars.githubusercontent.com/u/57655135?v=4","gravatar_id":"","url":"https://api.github.com/users/ayush-san","html_url":"https://github.com/ayush-san","followers_url":"https://api.github.com/users/ayush-san/followers","following_url":"https://api.github.com/users/ayush-san/following{/other_user}","gists_url":"https://api.github.com/users/ayush-san/gists{/gist_id}","starred_url":"https://api.github.com/users/ayush-san/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ayush-san/subscriptions","organizations_url":"https://api.github.com/users/ayush-san/orgs","repos_url":"https://api.github.com/users/ayush-san/repos","events_url":"https://api.github.com/users/ayush-san/events{/privacy}","received_events_url":"https://api.github.com/users/ayush-san/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-24T07:10:45Z","updated_at":"2021-05-24T07:10:45Z","author_association":"NONE","body":"Even after setting parallelism 1, I am getting duplicate rows.\r\n\r\n![image](https://user-images.githubusercontent.com/57655135/119309215-a46cc580-bc8b-11eb-9732-84899bf40971.png)\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/846818484/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/846872023","html_url":"https://github.com/apache/iceberg/issues/2610#issuecomment-846872023","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2610","id":846872023,"node_id":"MDEyOklzc3VlQ29tbWVudDg0Njg3MjAyMw==","user":{"login":"ayush-san","id":57655135,"node_id":"MDQ6VXNlcjU3NjU1MTM1","avatar_url":"https://avatars.githubusercontent.com/u/57655135?v=4","gravatar_id":"","url":"https://api.github.com/users/ayush-san","html_url":"https://github.com/ayush-san","followers_url":"https://api.github.com/users/ayush-san/followers","following_url":"https://api.github.com/users/ayush-san/following{/other_user}","gists_url":"https://api.github.com/users/ayush-san/gists{/gist_id}","starred_url":"https://api.github.com/users/ayush-san/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ayush-san/subscriptions","organizations_url":"https://api.github.com/users/ayush-san/orgs","repos_url":"https://api.github.com/users/ayush-san/repos","events_url":"https://api.github.com/users/ayush-san/events{/privacy}","received_events_url":"https://api.github.com/users/ayush-san/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-24T08:23:00Z","updated_at":"2021-05-24T08:23:00Z","author_association":"NONE","body":"@openinx Can this be the reason behind duplicate data https://github.com/apache/iceberg/issues/2308? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/846872023/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/846928291","html_url":"https://github.com/apache/iceberg/issues/2558#issuecomment-846928291","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2558","id":846928291,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NjkyODI5MQ==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-24T09:55:21Z","updated_at":"2021-05-24T09:55:43Z","author_association":"CONTRIBUTOR","body":"> I did few tests to verify whether the iceberg-flink-runtime jar (compiled in flink 1.12 ) could work in flink 1.13, sounds like the only one issue is [CatalogDescriptorValidator](https://github.com/apache/iceberg/blob/master/flink/src/main/java/org/apache/iceberg/flink/FlinkCatalogFactory.java#L31), it's an `Internal` API but has been removed in flink 1.13. I think we could remove the usage about `Internal` API then we could make this jar work in both flink 1.12 and flink 1.13, don't have to upgrade this version to flink 1.13.\r\n\r\nI tested that, if we upgrade to flink 1.13 ，and all UT have passed, some methods of `FlinkCatalogFactory` need to be modified, because `org.apache.flink.table.factories.CatalogFactory` interface of flink has changed, the specific code refers to this branch: https://github.com/zhangjun0x01/iceberg/tree/flink1.13  。 I think it is difficult to be compatible with flink 1.12 and 1.13 at the same time","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/846928291/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/846939908","html_url":"https://github.com/apache/iceberg/issues/2628#issuecomment-846939908","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2628","id":846939908,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NjkzOTkwOA==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-24T10:14:31Z","updated_at":"2021-05-24T10:14:31Z","author_association":"CONTRIBUTOR","body":"I have a PR for this, which I will push in the morning.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/846939908/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/846947207","html_url":"https://github.com/apache/iceberg/pull/2630#issuecomment-846947207","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2630","id":846947207,"node_id":"MDEyOklzc3VlQ29tbWVudDg0Njk0NzIwNw==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-24T10:28:10Z","updated_at":"2021-05-24T10:28:10Z","author_association":"CONTRIBUTOR","body":"cc @rymurr @jasonhughes248 to ensure that this is the proper way to get the table name for a Nessie table in `NessieTableOperations`","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/846947207/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]