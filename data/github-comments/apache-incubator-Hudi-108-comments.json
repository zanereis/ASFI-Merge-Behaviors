[{"url":"https://api.github.com/repos/apache/hudi/issues/comments/783053827","html_url":"https://github.com/apache/hudi/pull/2581#issuecomment-783053827","issue_url":"https://api.github.com/repos/apache/hudi/issues/2581","id":783053827,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MzA1MzgyNw==","user":{"login":"lamberken","id":20113411,"node_id":"MDQ6VXNlcjIwMTEzNDEx","avatar_url":"https://avatars.githubusercontent.com/u/20113411?v=4","gravatar_id":"","url":"https://api.github.com/users/lamberken","html_url":"https://github.com/lamberken","followers_url":"https://api.github.com/users/lamberken/followers","following_url":"https://api.github.com/users/lamberken/following{/other_user}","gists_url":"https://api.github.com/users/lamberken/gists{/gist_id}","starred_url":"https://api.github.com/users/lamberken/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lamberken/subscriptions","organizations_url":"https://api.github.com/users/lamberken/orgs","repos_url":"https://api.github.com/users/lamberken/repos","events_url":"https://api.github.com/users/lamberken/events{/privacy}","received_events_url":"https://api.github.com/users/lamberken/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-22T03:37:17Z","updated_at":"2021-02-22T03:37:17Z","author_association":"MEMBER","body":"hi @danny0405 is it necessary to revert `this.bucketAssigner.reset();` to `BucketAssiginFunction#snapshotState` in this patch? : )","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/783053827/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/783069192","html_url":"https://github.com/apache/hudi/pull/2581#issuecomment-783069192","issue_url":"https://api.github.com/repos/apache/hudi/issues/2581","id":783069192,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MzA2OTE5Mg==","user":{"login":"danny0405","id":7644508,"node_id":"MDQ6VXNlcjc2NDQ1MDg=","avatar_url":"https://avatars.githubusercontent.com/u/7644508?v=4","gravatar_id":"","url":"https://api.github.com/users/danny0405","html_url":"https://github.com/danny0405","followers_url":"https://api.github.com/users/danny0405/followers","following_url":"https://api.github.com/users/danny0405/following{/other_user}","gists_url":"https://api.github.com/users/danny0405/gists{/gist_id}","starred_url":"https://api.github.com/users/danny0405/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danny0405/subscriptions","organizations_url":"https://api.github.com/users/danny0405/orgs","repos_url":"https://api.github.com/users/danny0405/repos","events_url":"https://api.github.com/users/danny0405/events{/privacy}","received_events_url":"https://api.github.com/users/danny0405/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-22T04:27:03Z","updated_at":"2021-02-22T04:27:03Z","author_association":"CONTRIBUTOR","body":"> hi @danny0405 is it necessary to revert `this.bucketAssigner.reset();` to `BucketAssiginFunction#snapshotState` in this patch? : )\r\n\r\nI will do it in another patch, thanks.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/783069192/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/783085992","html_url":"https://github.com/apache/hudi/issues/2515#issuecomment-783085992","issue_url":"https://api.github.com/repos/apache/hudi/issues/2515","id":783085992,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MzA4NTk5Mg==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-22T05:11:22Z","updated_at":"2021-02-22T05:11:22Z","author_association":"MEMBER","body":"Folks, got side tracked by other work last week. Back on hudi, this week. We will get moving on this. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/783085992/reactions","total_count":2,"+1":1,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/783124508","html_url":"https://github.com/apache/hudi/pull/2473#issuecomment-783124508","issue_url":"https://api.github.com/repos/apache/hudi/issues/2473","id":783124508,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MzEyNDUwOA==","user":{"login":"danny0405","id":7644508,"node_id":"MDQ6VXNlcjc2NDQ1MDg=","avatar_url":"https://avatars.githubusercontent.com/u/7644508?v=4","gravatar_id":"","url":"https://api.github.com/users/danny0405","html_url":"https://github.com/danny0405","followers_url":"https://api.github.com/users/danny0405/followers","following_url":"https://api.github.com/users/danny0405/following{/other_user}","gists_url":"https://api.github.com/users/danny0405/gists{/gist_id}","starred_url":"https://api.github.com/users/danny0405/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danny0405/subscriptions","organizations_url":"https://api.github.com/users/danny0405/orgs","repos_url":"https://api.github.com/users/danny0405/repos","events_url":"https://api.github.com/users/danny0405/events{/privacy}","received_events_url":"https://api.github.com/users/danny0405/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-22T06:31:06Z","updated_at":"2021-02-22T06:31:06Z","author_association":"CONTRIBUTOR","body":"> I have a question about this pr, is there any reason we don't want to use Flink 1.12.0? Looks like `FlinkKafkaConsumerBase` is also avaiable in `flink-connector-kafka_2.12`.\r\n\r\nThere are some other conflicts for the Flink release 1.12.0, that means, the Flink 1.12.0 code can not run successfully on Flink 1.11.0 base jars.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/783124508/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/783182791","html_url":"https://github.com/apache/hudi/issues/2557#issuecomment-783182791","issue_url":"https://api.github.com/repos/apache/hudi/issues/2557","id":783182791,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MzE4Mjc5MQ==","user":{"login":"kingkongpoon","id":24726697,"node_id":"MDQ6VXNlcjI0NzI2Njk3","avatar_url":"https://avatars.githubusercontent.com/u/24726697?v=4","gravatar_id":"","url":"https://api.github.com/users/kingkongpoon","html_url":"https://github.com/kingkongpoon","followers_url":"https://api.github.com/users/kingkongpoon/followers","following_url":"https://api.github.com/users/kingkongpoon/following{/other_user}","gists_url":"https://api.github.com/users/kingkongpoon/gists{/gist_id}","starred_url":"https://api.github.com/users/kingkongpoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kingkongpoon/subscriptions","organizations_url":"https://api.github.com/users/kingkongpoon/orgs","repos_url":"https://api.github.com/users/kingkongpoon/repos","events_url":"https://api.github.com/users/kingkongpoon/events{/privacy}","received_events_url":"https://api.github.com/users/kingkongpoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-22T08:15:21Z","updated_at":"2021-02-22T08:15:21Z","author_association":"NONE","body":"> > When I first run the cow table (SaveMode.Overwrite), it's very fast.(about 700MB data in hdfs). but when I run an increment(SaveMode.Append), it's very slowly,and throw error\r\n> \r\n> Spark OOMs are hard to guess. Not sure if its directly related to Hudi. have you looked at the tuning guide? gc settings, memory overhead? https://cwiki.apache.org/confluence/display/HUDI/Tuning+Guide\r\n\r\nI have tried your advice , it seems to be better ,but the same code , configre and data, sometime also OOM, ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/783182791/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/783209847","html_url":"https://github.com/apache/hudi/issues/2557#issuecomment-783209847","issue_url":"https://api.github.com/repos/apache/hudi/issues/2557","id":783209847,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MzIwOTg0Nw==","user":{"login":"kingkongpoon","id":24726697,"node_id":"MDQ6VXNlcjI0NzI2Njk3","avatar_url":"https://avatars.githubusercontent.com/u/24726697?v=4","gravatar_id":"","url":"https://api.github.com/users/kingkongpoon","html_url":"https://github.com/kingkongpoon","followers_url":"https://api.github.com/users/kingkongpoon/followers","following_url":"https://api.github.com/users/kingkongpoon/following{/other_user}","gists_url":"https://api.github.com/users/kingkongpoon/gists{/gist_id}","starred_url":"https://api.github.com/users/kingkongpoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kingkongpoon/subscriptions","organizations_url":"https://api.github.com/users/kingkongpoon/orgs","repos_url":"https://api.github.com/users/kingkongpoon/repos","events_url":"https://api.github.com/users/kingkongpoon/events{/privacy}","received_events_url":"https://api.github.com/users/kingkongpoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-22T08:56:09Z","updated_at":"2021-02-22T09:16:19Z","author_association":"NONE","body":"> To help investigate better\r\n> \r\n> * Can you post the configs you used to write to hudi.\r\n> * Can you post a screen shot of spark stages. So that we know where its failing and can relate to some configs used.\r\n> * Can you give some rough idea of your dataset record keys. Is it completely random or does it have some ordering to it. what it is made of.\r\n> * I assume you are using regular bloom as index type.\r\n\r\nmy Spark code configure\r\n```\r\ninput\r\n      .write.format(\"org.apache.hudi\")\r\n      .option(\"hoodie.cleaner.commits.retained\", 1)\r\n      .option(\"hoodie.keep.min.commits\", 2)\r\n      .option(\"hoodie.keep.max.commits\", 3)\r\n      .option(\"hoodie.insert.shuffle.parallelism\", 30)\r\n      .option(\"hoodie.upsert.shuffle.parallelism\", 30)\r\n      .option(DataSourceWriteOptions.OPERATION_OPT_KEY, DataSourceWriteOptions.UPSERT_OPERATION_OPT_VAL)\r\n      .option(DataSourceWriteOptions.TABLE_TYPE_OPT_KEY, DataSourceWriteOptions.COW_TABLE_TYPE_OPT_VAL)\r\n      .option(DataSourceWriteOptions.RECORDKEY_FIELD_OPT_KEY, \"uuid\")\r\n      .option(DataSourceWriteOptions.PRECOMBINE_FIELD_OPT_KEY, \"etl_modify_time\")\r\n      .option(DataSourceWriteOptions.PARTITIONPATH_FIELD_OPT_KEY, \"created_year,created_month,created_day,brand_id\")\r\n      .option(DataSourceWriteOptions.PAYLOAD_CLASS_OPT_KEY, classOf[DefaultHoodieRecordPayload].getName)\r\n      .option(HoodiePayloadProps.PAYLOAD_ORDERING_FIELD_PROP, \"etl_modify_time\")\r\n      .option(\"hoodie.table.name\", \"std_order\") \r\n      .option(DataSourceWriteOptions.HIVE_URL_OPT_KEY, hiveserver2)\r\n      .option(DataSourceWriteOptions.HIVE_DATABASE_OPT_KEY, \"dwd_std\")\r\n      .option(DataSourceWriteOptions.HIVE_TABLE_OPT_KEY, \"std_order\")\r\n      .option(DataSourceWriteOptions.KEYGENERATOR_CLASS_OPT_KEY, classOf[ComplexKeyGenerator].getName)\r\n      .option(DataSourceWriteOptions.HIVE_PARTITION_FIELDS_OPT_KEY, \"created_year,created_month,created_day,brand_id\")\r\n      .option(DataSourceWriteOptions.HIVE_PARTITION_EXTRACTOR_CLASS_OPT_KEY, classOf[MultiPartKeysValueExtractor].getName)\r\n      .option(DataSourceWriteOptions.HIVE_SYNC_ENABLED_OPT_KEY, \"true\")\r\n      .option(HoodieIndexConfig.BLOOM_INDEX_UPDATE_PARTITION_PATH, \"true\")\r\n      .option(HoodieIndexConfig.INDEX_TYPE_PROP, HoodieIndex.IndexType.GLOBAL_BLOOM.name())\r\n      .mode(SaveMode.Overwrite)\r\n//    .mode(SaveMode.Append)\r\n      .save(basePath)\r\n\r\n```\r\n```\r\nspark-submit --master yarn --driver-memory 4G --executor-memory  8G --executor-cores 4 --num-executors 10 \r\n--conf spark.executor.memoryOverhead=4G  --conf spark.yarn.max.ex.ilures=100  \r\n--class com.qmtec.peony.newcrm.hudi.process  --jars hudi-hadoop-mr-bundle-0.7.0.jar \r\n--jars hudi-hive-sync-bundle-0.7.0.jar --jars hudi-spark-bundle_2.11-0.7.0.jar qmtec-peony-etl-hudi-1.0.jar \r\n```\r\n\r\nuuid is the tid from order table data,and it is unique,When I first wirte data in HDFS, .mode(SaveMode.Overwrite), and create hive table successfully ,the file in HDFS is about 520MB.\r\nBut when I use the same code,configure and data in .mode(SaveMode.Append), the process will throw errors\r\n```\r\n21/02/22 15:57:43 ERROR [dispatcher-event-loop-5] YarnScheduler: Lost executor 4 on emr-worker-2.cluster-47763: Container from a bad node: container_e10_1610102487810_52481_01_000005 on host: emr-worker-2.cluster-47763. Exit status: 137. Diagnostics: Container killed on request. Exit code is 137\r\nContainer exited with a non-zero exit code 137\r\nKilled by external signal\r\n.\r\n21/02/22 15:57:45 ERROR [dispatcher-event-loop-7] YarnScheduler: Lost executor 5 on emr-worker-4.cluster-47763: Container from a bad node: container_e10_1610102487810_52481_01_000006 on host: emr-worker-4.cluster-47763. Exit status: 137. Diagnostics: Container killed on request. Exit code is 137\r\nContainer exited with a non-zero exit code 137\r\nKilled by external signal\r\n.\r\n21/02/22 15:58:12 ERROR [dispatcher-event-loop-2] YarnScheduler: Lost executor 7 on emr-worker-4.cluster-47763: Container from a bad node: container_e10_1610102487810_52481_01_000009 on host: emr-worker-4.cluster-47763. Exit status: 137. Diagnostics: Container killed on request. Exit code is 137\r\nContainer exited with a non-zero exit code 137\r\nKilled by external signal\r\n.\r\n21/02/22 15:58:31 ERROR [dispatcher-event-loop-4] YarnScheduler: Lost executor 8 on emr-worker-4.cluster-47763: Container from a bad node: container_e10_1610102487810_52481_01_000010 on host: emr-worker-4.cluster-47763. Exit status: 1. Diagnostics: Exception from container-launch.\r\nContainer id: container_e10_1610102487810_52481_01_000010\r\nExit code: 1\r\nStack trace: ExitCodeException exitCode=1: \r\n\tat org.apache.hadoop.util.Shell.runCommand(Shell.java:972)\r\n\tat org.apache.hadoop.util.Shell.run(Shell.java:869)\r\n\tat org.apache.hadoop.util.Shell$ShellCommandExecutor.execute(Shell.java:1170)\r\n\tat org.apache.hadoop.yarn.server.nodemanager.DefaultContainerExecutor.launchContainer(DefaultContainerExecutor.java:235)\r\n\tat org.apache.hadoop.yarn.server.nodemanager.containermanager.launcher.ContainerLaunch.call(ContainerLaunch.java:299)\r\n\tat org.apache.hadoop.yarn.server.nodemanager.containermanager.launcher.ContainerLaunch.call(ContainerLaunch.java:83)\r\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:266)\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n\tat java.lang.Thread.run(Thread.java:748)\r\n\r\n\r\nContainer exited with a non-zero exit code 1\r\n\r\n```\r\nbut sometime it can run successfully ,it wil have two parquet files,and each parquet file are also ablout 520MB\r\nand the table root path has a .hoodie file ,when I run each time ,this file will become bigger ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/783209847/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/783449274","html_url":"https://github.com/apache/hudi/issues/2588#issuecomment-783449274","issue_url":"https://api.github.com/repos/apache/hudi/issues/2588","id":783449274,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MzQ0OTI3NA==","user":{"login":"bvaradar","id":3021376,"node_id":"MDQ6VXNlcjMwMjEzNzY=","avatar_url":"https://avatars.githubusercontent.com/u/3021376?v=4","gravatar_id":"","url":"https://api.github.com/users/bvaradar","html_url":"https://github.com/bvaradar","followers_url":"https://api.github.com/users/bvaradar/followers","following_url":"https://api.github.com/users/bvaradar/following{/other_user}","gists_url":"https://api.github.com/users/bvaradar/gists{/gist_id}","starred_url":"https://api.github.com/users/bvaradar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bvaradar/subscriptions","organizations_url":"https://api.github.com/users/bvaradar/orgs","repos_url":"https://api.github.com/users/bvaradar/repos","events_url":"https://api.github.com/users/bvaradar/events{/privacy}","received_events_url":"https://api.github.com/users/bvaradar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-22T15:20:02Z","updated_at":"2021-02-22T15:20:02Z","author_association":"CONTRIBUTOR","body":"@umehrot2 : Can you check if there is anything that can be done in Hudi to fix this in EMR  ecosystem?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/783449274/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/783468146","html_url":"https://github.com/apache/hudi/issues/2515#issuecomment-783468146","issue_url":"https://api.github.com/repos/apache/hudi/issues/2515","id":783468146,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MzQ2ODE0Ng==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-22T15:46:15Z","updated_at":"2021-02-22T15:46:15Z","author_association":"MEMBER","body":"@t0il3ts0ap The only code path for deltastreamer I see, that can pass a null schema is when the schema provider returns `null`.\r\n\r\n`--schemaprovider-class com.nnn.schema.CustomSchemaRegistryProvider `. Is there any chance this is returning null for target schema? \r\n\r\nI ll generally tighten the error handling around this, but wanted to throw it out there since you are using a custom schema provider","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/783468146/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/783534393","html_url":"https://github.com/apache/hudi/issues/2588#issuecomment-783534393","issue_url":"https://api.github.com/repos/apache/hudi/issues/2588","id":783534393,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MzUzNDM5Mw==","user":{"login":"rubenssoto","id":36298331,"node_id":"MDQ6VXNlcjM2Mjk4MzMx","avatar_url":"https://avatars.githubusercontent.com/u/36298331?v=4","gravatar_id":"","url":"https://api.github.com/users/rubenssoto","html_url":"https://github.com/rubenssoto","followers_url":"https://api.github.com/users/rubenssoto/followers","following_url":"https://api.github.com/users/rubenssoto/following{/other_user}","gists_url":"https://api.github.com/users/rubenssoto/gists{/gist_id}","starred_url":"https://api.github.com/users/rubenssoto/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rubenssoto/subscriptions","organizations_url":"https://api.github.com/users/rubenssoto/orgs","repos_url":"https://api.github.com/users/rubenssoto/repos","events_url":"https://api.github.com/users/rubenssoto/events{/privacy}","received_events_url":"https://api.github.com/users/rubenssoto/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-22T17:20:47Z","updated_at":"2021-02-22T17:24:35Z","author_association":"NONE","body":"<img width=\"1309\" alt=\"Captura de Tela 2021-02-22 às 14 19 11\" src=\"https://user-images.githubusercontent.com/36298331/108744715-07c64a80-7519-11eb-8b02-98261e74474d.png\">\r\n\r\nSometimes take a while to show the error, these jobs normally run in 5 minutes, more than 20 minutes trying to connect to hive.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/783534393/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/783558211","html_url":"https://github.com/apache/hudi/pull/2443#issuecomment-783558211","issue_url":"https://api.github.com/repos/apache/hudi/issues/2443","id":783558211,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MzU1ODIxMQ==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-22T17:58:03Z","updated_at":"2021-02-22T17:58:03Z","author_association":"CONTRIBUTOR","body":"I have pushed a commit to add tests and address the roTableRename. But not sure if we can make the Config span any exception in general or just connect exception. \r\n@vinothchandar @n3nash : Vino yang suggested we can ignore any exception w/ hive sync in general and proceed if the newly introduced config is set. As of now(in this patch), we only consider connect exceptions. Any thoughts. \r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/783558211/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/783587850","html_url":"https://github.com/apache/hudi/issues/2515#issuecomment-783587850","issue_url":"https://api.github.com/repos/apache/hudi/issues/2515","id":783587850,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MzU4Nzg1MA==","user":{"login":"low-on-mana","id":8509512,"node_id":"MDQ6VXNlcjg1MDk1MTI=","avatar_url":"https://avatars.githubusercontent.com/u/8509512?v=4","gravatar_id":"","url":"https://api.github.com/users/low-on-mana","html_url":"https://github.com/low-on-mana","followers_url":"https://api.github.com/users/low-on-mana/followers","following_url":"https://api.github.com/users/low-on-mana/following{/other_user}","gists_url":"https://api.github.com/users/low-on-mana/gists{/gist_id}","starred_url":"https://api.github.com/users/low-on-mana/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/low-on-mana/subscriptions","organizations_url":"https://api.github.com/users/low-on-mana/orgs","repos_url":"https://api.github.com/users/low-on-mana/repos","events_url":"https://api.github.com/users/low-on-mana/events{/privacy}","received_events_url":"https://api.github.com/users/low-on-mana/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-22T18:43:03Z","updated_at":"2021-02-22T18:43:32Z","author_association":"CONTRIBUTOR","body":"@vinothchandar Ya I am overriding just the target schema to null so as to use the `DataSet<Row>`'s schema. It is working fine for regular inserts and update.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/783587850/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/783707361","html_url":"https://github.com/apache/hudi/pull/2590#issuecomment-783707361","issue_url":"https://api.github.com/repos/apache/hudi/issues/2590","id":783707361,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MzcwNzM2MQ==","user":{"login":"codecov-io","id":8655789,"node_id":"MDQ6VXNlcjg2NTU3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/8655789?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-io","html_url":"https://github.com/codecov-io","followers_url":"https://api.github.com/users/codecov-io/followers","following_url":"https://api.github.com/users/codecov-io/following{/other_user}","gists_url":"https://api.github.com/users/codecov-io/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-io/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-io/subscriptions","organizations_url":"https://api.github.com/users/codecov-io/orgs","repos_url":"https://api.github.com/users/codecov-io/repos","events_url":"https://api.github.com/users/codecov-io/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-io/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-22T22:03:43Z","updated_at":"2021-02-22T22:03:43Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2590?src=pr&el=h1) Report\n> Merging [#2590](https://codecov.io/gh/apache/hudi/pull/2590?src=pr&el=desc) (4b9cf33) into [master](https://codecov.io/gh/apache/hudi/commit/26da4f546275e8ab6496537743efe73510cb723d?el=desc) (26da4f5) will **decrease** coverage by `41.23%`.\n> The diff coverage is `n/a`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2590/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2)](https://codecov.io/gh/apache/hudi/pull/2590?src=pr&el=tree)\n\n```diff\n@@             Coverage Diff              @@\n##             master   #2590       +/-   ##\n============================================\n- Coverage     50.92%   9.69%   -41.24%     \n+ Complexity     3168      48     -3120     \n============================================\n  Files           433      53      -380     \n  Lines         19812    1929    -17883     \n  Branches       2033     230     -1803     \n============================================\n- Hits          10090     187     -9903     \n+ Misses         8902    1729     -7173     \n+ Partials        820      13      -807     \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `?` | `?` | |\n| hudiclient | `?` | `?` | |\n| hudicommon | `?` | `?` | |\n| hudiflink | `?` | `?` | |\n| hudihadoopmr | `?` | `?` | |\n| hudisparkdatasource | `?` | `?` | |\n| hudisync | `?` | `?` | |\n| huditimelineservice | `?` | `?` | |\n| hudiutilities | `9.69% <ø> (-59.83%)` | `0.00 <ø> (ø)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2590?src=pr&el=tree) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...va/org/apache/hudi/utilities/IdentitySplitter.java](https://codecov.io/gh/apache/hudi/pull/2590/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL0lkZW50aXR5U3BsaXR0ZXIuamF2YQ==) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-2.00%)` | |\n| [...va/org/apache/hudi/utilities/schema/SchemaSet.java](https://codecov.io/gh/apache/hudi/pull/2590/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NjaGVtYS9TY2hlbWFTZXQuamF2YQ==) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-3.00%)` | |\n| [...a/org/apache/hudi/utilities/sources/RowSource.java](https://codecov.io/gh/apache/hudi/pull/2590/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvUm93U291cmNlLmphdmE=) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-4.00%)` | |\n| [.../org/apache/hudi/utilities/sources/AvroSource.java](https://codecov.io/gh/apache/hudi/pull/2590/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvQXZyb1NvdXJjZS5qYXZh) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-1.00%)` | |\n| [.../org/apache/hudi/utilities/sources/JsonSource.java](https://codecov.io/gh/apache/hudi/pull/2590/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvSnNvblNvdXJjZS5qYXZh) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-1.00%)` | |\n| [...rg/apache/hudi/utilities/sources/CsvDFSSource.java](https://codecov.io/gh/apache/hudi/pull/2590/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvQ3N2REZTU291cmNlLmphdmE=) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-10.00%)` | |\n| [...g/apache/hudi/utilities/sources/JsonDFSSource.java](https://codecov.io/gh/apache/hudi/pull/2590/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvSnNvbkRGU1NvdXJjZS5qYXZh) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-4.00%)` | |\n| [...apache/hudi/utilities/sources/JsonKafkaSource.java](https://codecov.io/gh/apache/hudi/pull/2590/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvSnNvbkthZmthU291cmNlLmphdmE=) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-6.00%)` | |\n| [...pache/hudi/utilities/sources/ParquetDFSSource.java](https://codecov.io/gh/apache/hudi/pull/2590/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvUGFycXVldERGU1NvdXJjZS5qYXZh) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-5.00%)` | |\n| [...lities/schema/SchemaProviderWithPostProcessor.java](https://codecov.io/gh/apache/hudi/pull/2590/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NjaGVtYS9TY2hlbWFQcm92aWRlcldpdGhQb3N0UHJvY2Vzc29yLmphdmE=) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-4.00%)` | |\n| ... and [407 more](https://codecov.io/gh/apache/hudi/pull/2590/diff?src=pr&el=tree-more) | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/783707361/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/783799632","html_url":"https://github.com/apache/hudi/pull/2532#issuecomment-783799632","issue_url":"https://api.github.com/repos/apache/hudi/issues/2532","id":783799632,"node_id":"MDEyOklzc3VlQ29tbWVudDc4Mzc5OTYzMg==","user":{"login":"satishkotha","id":2992755,"node_id":"MDQ6VXNlcjI5OTI3NTU=","avatar_url":"https://avatars.githubusercontent.com/u/2992755?v=4","gravatar_id":"","url":"https://api.github.com/users/satishkotha","html_url":"https://github.com/satishkotha","followers_url":"https://api.github.com/users/satishkotha/followers","following_url":"https://api.github.com/users/satishkotha/following{/other_user}","gists_url":"https://api.github.com/users/satishkotha/gists{/gist_id}","starred_url":"https://api.github.com/users/satishkotha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/satishkotha/subscriptions","organizations_url":"https://api.github.com/users/satishkotha/orgs","repos_url":"https://api.github.com/users/satishkotha/repos","events_url":"https://api.github.com/users/satishkotha/events{/privacy}","received_events_url":"https://api.github.com/users/satishkotha/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-23T01:28:56Z","updated_at":"2021-02-23T01:28:56Z","author_association":"MEMBER","body":"@lhjzmn Can you start a discuss thread in dev and users channel. I think removing JDBC support requires consensus in community","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/783799632/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/783806234","html_url":"https://github.com/apache/hudi/pull/2581#issuecomment-783806234","issue_url":"https://api.github.com/repos/apache/hudi/issues/2581","id":783806234,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MzgwNjIzNA==","user":{"login":"yanghua","id":2283778,"node_id":"MDQ6VXNlcjIyODM3Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/2283778?v=4","gravatar_id":"","url":"https://api.github.com/users/yanghua","html_url":"https://github.com/yanghua","followers_url":"https://api.github.com/users/yanghua/followers","following_url":"https://api.github.com/users/yanghua/following{/other_user}","gists_url":"https://api.github.com/users/yanghua/gists{/gist_id}","starred_url":"https://api.github.com/users/yanghua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yanghua/subscriptions","organizations_url":"https://api.github.com/users/yanghua/orgs","repos_url":"https://api.github.com/users/yanghua/repos","events_url":"https://api.github.com/users/yanghua/events{/privacy}","received_events_url":"https://api.github.com/users/yanghua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-23T01:49:32Z","updated_at":"2021-02-23T01:49:32Z","author_association":"CONTRIBUTOR","body":"@danny0405 please check the CI?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/783806234/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/783810812","html_url":"https://github.com/apache/hudi/issues/2589#issuecomment-783810812","issue_url":"https://api.github.com/repos/apache/hudi/issues/2589","id":783810812,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MzgxMDgxMg==","user":{"login":"bvaradar","id":3021376,"node_id":"MDQ6VXNlcjMwMjEzNzY=","avatar_url":"https://avatars.githubusercontent.com/u/3021376?v=4","gravatar_id":"","url":"https://api.github.com/users/bvaradar","html_url":"https://github.com/bvaradar","followers_url":"https://api.github.com/users/bvaradar/followers","following_url":"https://api.github.com/users/bvaradar/following{/other_user}","gists_url":"https://api.github.com/users/bvaradar/gists{/gist_id}","starred_url":"https://api.github.com/users/bvaradar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bvaradar/subscriptions","organizations_url":"https://api.github.com/users/bvaradar/orgs","repos_url":"https://api.github.com/users/bvaradar/repos","events_url":"https://api.github.com/users/bvaradar/events{/privacy}","received_events_url":"https://api.github.com/users/bvaradar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-23T02:04:46Z","updated_at":"2021-02-23T02:04:46Z","author_association":"CONTRIBUTOR","body":"@satishkotha: Can you please take a look at this ticket ?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/783810812/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/783811753","html_url":"https://github.com/apache/hudi/issues/2573#issuecomment-783811753","issue_url":"https://api.github.com/repos/apache/hudi/issues/2573","id":783811753,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MzgxMTc1Mw==","user":{"login":"bvaradar","id":3021376,"node_id":"MDQ6VXNlcjMwMjEzNzY=","avatar_url":"https://avatars.githubusercontent.com/u/3021376?v=4","gravatar_id":"","url":"https://api.github.com/users/bvaradar","html_url":"https://github.com/bvaradar","followers_url":"https://api.github.com/users/bvaradar/followers","following_url":"https://api.github.com/users/bvaradar/following{/other_user}","gists_url":"https://api.github.com/users/bvaradar/gists{/gist_id}","starred_url":"https://api.github.com/users/bvaradar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bvaradar/subscriptions","organizations_url":"https://api.github.com/users/bvaradar/orgs","repos_url":"https://api.github.com/users/bvaradar/repos","events_url":"https://api.github.com/users/bvaradar/events{/privacy}","received_events_url":"https://api.github.com/users/bvaradar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-23T02:07:31Z","updated_at":"2021-02-23T02:07:31Z","author_association":"CONTRIBUTOR","body":"@getniz : Let me know if you run into any problems\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/783811753/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/783812545","html_url":"https://github.com/apache/hudi/issues/2564#issuecomment-783812545","issue_url":"https://api.github.com/repos/apache/hudi/issues/2564","id":783812545,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MzgxMjU0NQ==","user":{"login":"bvaradar","id":3021376,"node_id":"MDQ6VXNlcjMwMjEzNzY=","avatar_url":"https://avatars.githubusercontent.com/u/3021376?v=4","gravatar_id":"","url":"https://api.github.com/users/bvaradar","html_url":"https://github.com/bvaradar","followers_url":"https://api.github.com/users/bvaradar/followers","following_url":"https://api.github.com/users/bvaradar/following{/other_user}","gists_url":"https://api.github.com/users/bvaradar/gists{/gist_id}","starred_url":"https://api.github.com/users/bvaradar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bvaradar/subscriptions","organizations_url":"https://api.github.com/users/bvaradar/orgs","repos_url":"https://api.github.com/users/bvaradar/repos","events_url":"https://api.github.com/users/bvaradar/events{/privacy}","received_events_url":"https://api.github.com/users/bvaradar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-23T02:10:28Z","updated_at":"2021-02-23T02:10:28Z","author_association":"CONTRIBUTOR","body":"@rswagatika : Running inline compaction is fine. But from the time, if compaction ran fine, there should have been a .commit (not .deltacommit) file in the timeline. But, I did not see that in the listing. I think compaction could be failing in your case. Can you look into the logs to see if there are any failures. For MOR, without compaction succeeding, cleaner won't be able to delete old files as the files are needed by compaction.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/783812545/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/783812882","html_url":"https://github.com/apache/hudi/issues/2546#issuecomment-783812882","issue_url":"https://api.github.com/repos/apache/hudi/issues/2546","id":783812882,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MzgxMjg4Mg==","user":{"login":"bvaradar","id":3021376,"node_id":"MDQ6VXNlcjMwMjEzNzY=","avatar_url":"https://avatars.githubusercontent.com/u/3021376?v=4","gravatar_id":"","url":"https://api.github.com/users/bvaradar","html_url":"https://github.com/bvaradar","followers_url":"https://api.github.com/users/bvaradar/followers","following_url":"https://api.github.com/users/bvaradar/following{/other_user}","gists_url":"https://api.github.com/users/bvaradar/gists{/gist_id}","starred_url":"https://api.github.com/users/bvaradar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bvaradar/subscriptions","organizations_url":"https://api.github.com/users/bvaradar/orgs","repos_url":"https://api.github.com/users/bvaradar/repos","events_url":"https://api.github.com/users/bvaradar/events{/privacy}","received_events_url":"https://api.github.com/users/bvaradar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-23T02:11:33Z","updated_at":"2021-02-23T02:11:33Z","author_association":"CONTRIBUTOR","body":"@robin-su : Pinging again to see if you are still looking for answers.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/783812882/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/783819474","html_url":"https://github.com/apache/hudi/pull/2581#issuecomment-783819474","issue_url":"https://api.github.com/repos/apache/hudi/issues/2581","id":783819474,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MzgxOTQ3NA==","user":{"login":"danny0405","id":7644508,"node_id":"MDQ6VXNlcjc2NDQ1MDg=","avatar_url":"https://avatars.githubusercontent.com/u/7644508?v=4","gravatar_id":"","url":"https://api.github.com/users/danny0405","html_url":"https://github.com/danny0405","followers_url":"https://api.github.com/users/danny0405/followers","following_url":"https://api.github.com/users/danny0405/following{/other_user}","gists_url":"https://api.github.com/users/danny0405/gists{/gist_id}","starred_url":"https://api.github.com/users/danny0405/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danny0405/subscriptions","organizations_url":"https://api.github.com/users/danny0405/orgs","repos_url":"https://api.github.com/users/danny0405/repos","events_url":"https://api.github.com/users/danny0405/events{/privacy}","received_events_url":"https://api.github.com/users/danny0405/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-23T02:19:16Z","updated_at":"2021-02-23T02:19:16Z","author_association":"CONTRIBUTOR","body":"> @danny0405 please check the CI?\r\n\r\nShould not be caused by this PR, re-trigger to run the tests again.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/783819474/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/783834813","html_url":"https://github.com/apache/hudi/issues/2589#issuecomment-783834813","issue_url":"https://api.github.com/repos/apache/hudi/issues/2589","id":783834813,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MzgzNDgxMw==","user":{"login":"satishkotha","id":2992755,"node_id":"MDQ6VXNlcjI5OTI3NTU=","avatar_url":"https://avatars.githubusercontent.com/u/2992755?v=4","gravatar_id":"","url":"https://api.github.com/users/satishkotha","html_url":"https://github.com/satishkotha","followers_url":"https://api.github.com/users/satishkotha/followers","following_url":"https://api.github.com/users/satishkotha/following{/other_user}","gists_url":"https://api.github.com/users/satishkotha/gists{/gist_id}","starred_url":"https://api.github.com/users/satishkotha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/satishkotha/subscriptions","organizations_url":"https://api.github.com/users/satishkotha/orgs","repos_url":"https://api.github.com/users/satishkotha/repos","events_url":"https://api.github.com/users/satishkotha/events{/privacy}","received_events_url":"https://api.github.com/users/satishkotha/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-23T02:30:07Z","updated_at":"2021-02-23T02:30:20Z","author_association":"MEMBER","body":"From the error message:\r\n\r\n> missing required field description\r\n\tat org.apache.avro.io.ResolvingDecoder.doAction(ResolvingDecoder.java:292)\r\n\tat org.apache.avro.io.parsing.Parser.advance(Parser.java:88)\r\n\r\nLooks like this new field is expected as required field by avro library. Can you double check schema after transformation?\r\n\r\n\r\n>21/02/22 08:28:13 WARN ExceptionMapper: Uncaught exception\r\njava.lang.IllegalArgumentException: Last known instant from client was 20210222075752 but server has the following timeline \r\n\r\nThe error after that looks to be a bug because of initial failure and use of EmbeddedTimelineServer.  I will need some more time to investigate that. But you work around by disable embedded timeline server by setting 'hoodie.embed.timeline.server': 'false'","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/783834813/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/783862335","html_url":"https://github.com/apache/hudi/issues/2563#issuecomment-783862335","issue_url":"https://api.github.com/repos/apache/hudi/issues/2563","id":783862335,"node_id":"MDEyOklzc3VlQ29tbWVudDc4Mzg2MjMzNQ==","user":{"login":"rubenssoto","id":36298331,"node_id":"MDQ6VXNlcjM2Mjk4MzMx","avatar_url":"https://avatars.githubusercontent.com/u/36298331?v=4","gravatar_id":"","url":"https://api.github.com/users/rubenssoto","html_url":"https://github.com/rubenssoto","followers_url":"https://api.github.com/users/rubenssoto/followers","following_url":"https://api.github.com/users/rubenssoto/following{/other_user}","gists_url":"https://api.github.com/users/rubenssoto/gists{/gist_id}","starred_url":"https://api.github.com/users/rubenssoto/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rubenssoto/subscriptions","organizations_url":"https://api.github.com/users/rubenssoto/orgs","repos_url":"https://api.github.com/users/rubenssoto/repos","events_url":"https://api.github.com/users/rubenssoto/events{/privacy}","received_events_url":"https://api.github.com/users/rubenssoto/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-23T04:07:12Z","updated_at":"2021-02-23T04:07:12Z","author_association":"NONE","body":"`Caused by: org.apache.hudi.exception.HoodieUpsertException: Failed to merge old record into new file for key 7176859 from old file s3://dl/courier_api/customer_address/3ee388f2-fa45-437a-a279-d9e3e3369bbd-0_9-137-2635_20210223033155.parquet to new file s3://ld/courier_api/customer_address/3ee388f2-fa45-437a-a279-d9e3e3369bbd-0_9-377-7189_20210223035129.parquet with writerSchema {\r\n  \"type\" : \"record\",\r\n  \"name\" : \"customer_address_record\",\r\n  \"namespace\" : \"hoodie.customer_address\",\r\n  \"fields\" : [ {\r\n    \"name\" : \"_hoodie_commit_time\",\r\n    \"type\" : [ \"null\", \"string\" ],\r\n    \"doc\" : \"\",\r\n    \"default\" : null\r\n  }, {\r\n    \"name\" : \"_hoodie_commit_seqno\",\r\n    \"type\" : [ \"null\", \"string\" ],\r\n    \"doc\" : \"\",\r\n    \"default\" : null\r\n  }, {\r\n    \"name\" : \"_hoodie_record_key\",\r\n    \"type\" : [ \"null\", \"string\" ],\r\n    \"doc\" : \"\",\r\n    \"default\" : null\r\n  }, {\r\n    \"name\" : \"_hoodie_partition_path\",\r\n    \"type\" : [ \"null\", \"string\" ],\r\n    \"doc\" : \"\",\r\n    \"default\" : null\r\n  }, {\r\n    \"name\" : \"_hoodie_file_name\",\r\n    \"type\" : [ \"null\", \"string\" ],\r\n    \"doc\" : \"\",\r\n    \"default\" : null\r\n  }, {\r\n    \"name\" : \"Op\",\r\n    \"type\" : [ \"string\", \"null\" ]\r\n  }, {\r\n    \"name\" : \"LineCreatedTimestamp\",\r\n    \"type\" : [ \"string\", \"null\" ]\r\n  }, {\r\n    \"name\" : \"created_date\",\r\n    \"type\" : [ {\r\n      \"type\" : \"long\",\r\n      \"logicalType\" : \"timestamp-micros\"\r\n    }, \"null\" ]\r\n  }, {\r\n    \"name\" : \"updated_date\",\r\n    \"type\" : [ {\r\n      \"type\" : \"long\",\r\n      \"logicalType\" : \"timestamp-micros\"\r\n    }, \"null\" ]\r\n  }, {\r\n    \"name\" : \"id\",\r\n    \"type\" : [ \"int\", \"null\" ]\r\n  }, {\r\n    \"name\" : \"address_type\",\r\n    \"type\" : [ \"string\", \"null\" ]\r\n  }, {\r\n    \"name\" : \"name\",\r\n    \"type\" : [ \"string\", \"null\" ]\r\n  }, {\r\n    \"name\" : \"customer_email\",\r\n    \"type\" : [ \"string\", \"null\" ]\r\n  }, {\r\n    \"name\" : \"street\",\r\n    \"type\" : [ \"string\", \"null\" ]\r\n  }, {\r\n    \"name\" : \"number\",\r\n    \"type\" : [ \"string\", \"null\" ]\r\n  }, {\r\n    \"name\" : \"address_line2\",\r\n    \"type\" : [ \"string\", \"null\" ]\r\n  }, {\r\n    \"name\" : \"city\",\r\n    \"type\" : [ \"string\", \"null\" ]\r\n  }, {\r\n    \"name\" : \"province\",\r\n    \"type\" : [ \"string\", \"null\" ]\r\n  }, {\r\n    \"name\" : \"zipcode\",\r\n    \"type\" : [ \"string\", \"null\" ]\r\n  }, {\r\n    \"name\" : \"country\",\r\n    \"type\" : [ \"string\", \"null\" ]\r\n  }, {\r\n    \"name\" : \"neighborhood\",\r\n    \"type\" : [ \"string\", \"null\" ]\r\n  }, {\r\n    \"name\" : \"latitude\",\r\n    \"type\" : [ \"double\", \"null\" ]\r\n  }, {\r\n    \"name\" : \"longitude\",\r\n    \"type\" : [ \"double\", \"null\" ]\r\n  }, {\r\n    \"name\" : \"commit_version\",\r\n    \"type\" : \"long\"\r\n  }, {\r\n    \"name\" : \"_hoodie_is_deleted\",\r\n    \"type\" : \"boolean\"\r\n  } ]\r\n}\r\n\tat org.apache.hudi.io.HoodieMergeHandle.write(HoodieMergeHandle.java:256)\r\n\tat org.apache.hudi.table.action.commit.AbstractMergeHelper$UpdateHandler.consumeOneRecord(AbstractMergeHelper.java:122)\r\n\tat org.apache.hudi.table.action.commit.AbstractMergeHelper$UpdateHandler.consumeOneRecord(AbstractMergeHelper.java:112)\r\n\tat org.apache.hudi.common.util.queue.BoundedInMemoryQueueConsumer.consume(BoundedInMemoryQueueConsumer.java:37)\r\n\tat org.apache.hudi.common.util.queue.BoundedInMemoryExecutor.lambda$null$2(BoundedInMemoryExecutor.java:121)\r\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:266)\r\n\t... 3 more\r\nCaused by: java.lang.RuntimeException: Null-value for required field: commit_version\r\n\tat org.apache.parquet.avro.AvroWriteSupport.writeRecordFields(AvroWriteSupport.java:194)\r\n\tat org.apache.parquet.avro.AvroWriteSupport.write(AvroWriteSupport.java:165)\r\n\tat org.apache.parquet.hadoop.InternalParquetRecordWriter.write(InternalParquetRecordWriter.java:128)\r\n\tat org.apache.parquet.hadoop.ParquetWriter.write(ParquetWriter.java:299)\r\n\tat org.apache.hudi.io.storage.HoodieParquetWriter.writeAvro(HoodieParquetWriter.java:94)\r\n\tat org.apache.hudi.io.HoodieMergeHandle.write(HoodieMergeHandle.java:251)\r\n\t... 8 more\r\n\r\nDriver stacktrace:\r\n\tat jobs.TableProcessor.start(TableProcessor.scala:104)\r\n\tat TableProcessorWrapper$.$anonfun$main$2(TableProcessorWrapper.scala:23)\r\n\tat scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)\r\n\tat scala.concurrent.Future$.$anonfun$apply$1(Future.scala:659)\r\n\tat scala.util.Success.$anonfun$map$1(Try.scala:255)\r\n\tat scala.util.Success.map(Try.scala:213)\r\n\tat scala.concurrent.Future.$anonfun$map$1(Future.scala:292)\r\n\tat scala.concurrent.impl.Promise.liftedTree1$1(Promise.scala:33)\r\n\tat scala.concurrent.impl.Promise.$anonfun$transform$1(Promise.scala:33)\r\n\tat scala.concurrent.impl.CallbackRunnable.run(Promise.scala:64)\r\n\tat java.util.concurrent.ForkJoinTask$RunnableExecuteAction.exec(ForkJoinTask.java:1402)\r\n\tat java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)\r\n\tat java.util.concurrent.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1056)\r\n\tat java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:1692)\r\n\tat java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:157)\r\n\r\n\t ApplicationMaster host: ip-10-0-53-212.us-west-2.compute.internal\r\n\t ApplicationMaster RPC port: 41723\r\n\t queue: default\r\n\t start time: 1614052265461\r\n\t final status: FAILED\r\n\t tracking URL: http://ip-10-0-49-168.us-west-2.compute.internal:20888/proxy/application_1613496813774_2805/\r\n\t user: hadoop`\r\n\r\n\r\n\r\n@nsivabalan I had this error, I have a table without the column commit_version(it is a column that I created), I add the column commit_version in my script and the new data try to update the old one.\r\n\r\nIs this problem is addressed too?\r\n\r\nThank you so much.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/783862335/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/783919732","html_url":"https://github.com/apache/hudi/issues/2573#issuecomment-783919732","issue_url":"https://api.github.com/repos/apache/hudi/issues/2573","id":783919732,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MzkxOTczMg==","user":{"login":"getniz","id":29088488,"node_id":"MDQ6VXNlcjI5MDg4NDg4","avatar_url":"https://avatars.githubusercontent.com/u/29088488?v=4","gravatar_id":"","url":"https://api.github.com/users/getniz","html_url":"https://github.com/getniz","followers_url":"https://api.github.com/users/getniz/followers","following_url":"https://api.github.com/users/getniz/following{/other_user}","gists_url":"https://api.github.com/users/getniz/gists{/gist_id}","starred_url":"https://api.github.com/users/getniz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/getniz/subscriptions","organizations_url":"https://api.github.com/users/getniz/orgs","repos_url":"https://api.github.com/users/getniz/repos","events_url":"https://api.github.com/users/getniz/events{/privacy}","received_events_url":"https://api.github.com/users/getniz/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-23T05:30:13Z","updated_at":"2021-02-23T05:30:13Z","author_association":"NONE","body":"@bvaradar I m still on it. It will take sometime for me to validate this. I ll close for this now. thanks @bvaradar ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/783919732/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/783929502","html_url":"https://github.com/apache/hudi/pull/2581#issuecomment-783929502","issue_url":"https://api.github.com/repos/apache/hudi/issues/2581","id":783929502,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MzkyOTUwMg==","user":{"login":"lamberken","id":20113411,"node_id":"MDQ6VXNlcjIwMTEzNDEx","avatar_url":"https://avatars.githubusercontent.com/u/20113411?v=4","gravatar_id":"","url":"https://api.github.com/users/lamberken","html_url":"https://github.com/lamberken","followers_url":"https://api.github.com/users/lamberken/followers","following_url":"https://api.github.com/users/lamberken/following{/other_user}","gists_url":"https://api.github.com/users/lamberken/gists{/gist_id}","starred_url":"https://api.github.com/users/lamberken/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lamberken/subscriptions","organizations_url":"https://api.github.com/users/lamberken/orgs","repos_url":"https://api.github.com/users/lamberken/repos","events_url":"https://api.github.com/users/lamberken/events{/privacy}","received_events_url":"https://api.github.com/users/lamberken/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-23T05:54:14Z","updated_at":"2021-02-23T05:54:14Z","author_association":"MEMBER","body":"Thanks @danny0405 for the base index patch, maybe there are some points to think about later, 👍 \r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/783929502/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/783951593","html_url":"https://github.com/apache/hudi/pull/2581#issuecomment-783951593","issue_url":"https://api.github.com/repos/apache/hudi/issues/2581","id":783951593,"node_id":"MDEyOklzc3VlQ29tbWVudDc4Mzk1MTU5Mw==","user":{"login":"danny0405","id":7644508,"node_id":"MDQ6VXNlcjc2NDQ1MDg=","avatar_url":"https://avatars.githubusercontent.com/u/7644508?v=4","gravatar_id":"","url":"https://api.github.com/users/danny0405","html_url":"https://github.com/danny0405","followers_url":"https://api.github.com/users/danny0405/followers","following_url":"https://api.github.com/users/danny0405/following{/other_user}","gists_url":"https://api.github.com/users/danny0405/gists{/gist_id}","starred_url":"https://api.github.com/users/danny0405/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danny0405/subscriptions","organizations_url":"https://api.github.com/users/danny0405/orgs","repos_url":"https://api.github.com/users/danny0405/repos","events_url":"https://api.github.com/users/danny0405/events{/privacy}","received_events_url":"https://api.github.com/users/danny0405/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-23T06:47:08Z","updated_at":"2021-02-23T06:47:08Z","author_association":"CONTRIBUTOR","body":"> Thanks @danny0405 for the base index patch, maybe there are some points to think about later, 👍\r\n\r\nThanks for the new ideas if you have some and welcome the contribution ~","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/783951593/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/783972684","html_url":"https://github.com/apache/hudi/issues/2448#issuecomment-783972684","issue_url":"https://api.github.com/repos/apache/hudi/issues/2448","id":783972684,"node_id":"MDEyOklzc3VlQ29tbWVudDc4Mzk3MjY4NA==","user":{"login":"root18039532923","id":45333549,"node_id":"MDQ6VXNlcjQ1MzMzNTQ5","avatar_url":"https://avatars.githubusercontent.com/u/45333549?v=4","gravatar_id":"","url":"https://api.github.com/users/root18039532923","html_url":"https://github.com/root18039532923","followers_url":"https://api.github.com/users/root18039532923/followers","following_url":"https://api.github.com/users/root18039532923/following{/other_user}","gists_url":"https://api.github.com/users/root18039532923/gists{/gist_id}","starred_url":"https://api.github.com/users/root18039532923/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/root18039532923/subscriptions","organizations_url":"https://api.github.com/users/root18039532923/orgs","repos_url":"https://api.github.com/users/root18039532923/repos","events_url":"https://api.github.com/users/root18039532923/events{/privacy}","received_events_url":"https://api.github.com/users/root18039532923/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-23T07:29:09Z","updated_at":"2021-02-23T07:29:09Z","author_association":"NONE","body":"if you set \"hoodie.compact.inline -> true\",this means compaction  changes inline, but async?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/783972684/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784025241","html_url":"https://github.com/apache/hudi/pull/2593#issuecomment-784025241","issue_url":"https://api.github.com/repos/apache/hudi/issues/2593","id":784025241,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NDAyNTI0MQ==","user":{"login":"XuQianJin-Stars","id":10494131,"node_id":"MDQ6VXNlcjEwNDk0MTMx","avatar_url":"https://avatars.githubusercontent.com/u/10494131?v=4","gravatar_id":"","url":"https://api.github.com/users/XuQianJin-Stars","html_url":"https://github.com/XuQianJin-Stars","followers_url":"https://api.github.com/users/XuQianJin-Stars/followers","following_url":"https://api.github.com/users/XuQianJin-Stars/following{/other_user}","gists_url":"https://api.github.com/users/XuQianJin-Stars/gists{/gist_id}","starred_url":"https://api.github.com/users/XuQianJin-Stars/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/XuQianJin-Stars/subscriptions","organizations_url":"https://api.github.com/users/XuQianJin-Stars/orgs","repos_url":"https://api.github.com/users/XuQianJin-Stars/repos","events_url":"https://api.github.com/users/XuQianJin-Stars/events{/privacy}","received_events_url":"https://api.github.com/users/XuQianJin-Stars/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-23T09:14:40Z","updated_at":"2021-02-23T09:14:40Z","author_association":"CONTRIBUTOR","body":"@danny0405 This feature is awesome. 👍","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784025241/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784029117","html_url":"https://github.com/apache/hudi/pull/2593#issuecomment-784029117","issue_url":"https://api.github.com/repos/apache/hudi/issues/2593","id":784029117,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NDAyOTExNw==","user":{"login":"danny0405","id":7644508,"node_id":"MDQ6VXNlcjc2NDQ1MDg=","avatar_url":"https://avatars.githubusercontent.com/u/7644508?v=4","gravatar_id":"","url":"https://api.github.com/users/danny0405","html_url":"https://github.com/danny0405","followers_url":"https://api.github.com/users/danny0405/followers","following_url":"https://api.github.com/users/danny0405/following{/other_user}","gists_url":"https://api.github.com/users/danny0405/gists{/gist_id}","starred_url":"https://api.github.com/users/danny0405/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danny0405/subscriptions","organizations_url":"https://api.github.com/users/danny0405/orgs","repos_url":"https://api.github.com/users/danny0405/repos","events_url":"https://api.github.com/users/danny0405/events{/privacy}","received_events_url":"https://api.github.com/users/danny0405/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-23T09:21:24Z","updated_at":"2021-02-23T09:21:24Z","author_association":"CONTRIBUTOR","body":"> @danny0405 This feature is awesome. 👍\r\n\r\nThanks","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784029117/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784041273","html_url":"https://github.com/apache/hudi/pull/2227#issuecomment-784041273","issue_url":"https://api.github.com/repos/apache/hudi/issues/2227","id":784041273,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NDA0MTI3Mw==","user":{"login":"liujinhui1994","id":25769285,"node_id":"MDQ6VXNlcjI1NzY5Mjg1","avatar_url":"https://avatars.githubusercontent.com/u/25769285?v=4","gravatar_id":"","url":"https://api.github.com/users/liujinhui1994","html_url":"https://github.com/liujinhui1994","followers_url":"https://api.github.com/users/liujinhui1994/followers","following_url":"https://api.github.com/users/liujinhui1994/following{/other_user}","gists_url":"https://api.github.com/users/liujinhui1994/gists{/gist_id}","starred_url":"https://api.github.com/users/liujinhui1994/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liujinhui1994/subscriptions","organizations_url":"https://api.github.com/users/liujinhui1994/orgs","repos_url":"https://api.github.com/users/liujinhui1994/repos","events_url":"https://api.github.com/users/liujinhui1994/events{/privacy}","received_events_url":"https://api.github.com/users/liujinhui1994/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-23T09:43:13Z","updated_at":"2021-02-23T09:43:13Z","author_association":"CONTRIBUTOR","body":"> @liujinhui1994 : I pushed a commit to this PR with tests to delta streamer to test transition from parquet dfs to kaka dfs :) Hope that's fine with you. If you plan to make more changes, feel free to pull in latest commits and add more commits to it.\r\n\r\nok thanks","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784041273/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784070273","html_url":"https://github.com/apache/hudi/pull/2593#issuecomment-784070273","issue_url":"https://api.github.com/repos/apache/hudi/issues/2593","id":784070273,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NDA3MDI3Mw==","user":{"login":"lamberken","id":20113411,"node_id":"MDQ6VXNlcjIwMTEzNDEx","avatar_url":"https://avatars.githubusercontent.com/u/20113411?v=4","gravatar_id":"","url":"https://api.github.com/users/lamberken","html_url":"https://github.com/lamberken","followers_url":"https://api.github.com/users/lamberken/followers","following_url":"https://api.github.com/users/lamberken/following{/other_user}","gists_url":"https://api.github.com/users/lamberken/gists{/gist_id}","starred_url":"https://api.github.com/users/lamberken/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lamberken/subscriptions","organizations_url":"https://api.github.com/users/lamberken/orgs","repos_url":"https://api.github.com/users/lamberken/repos","events_url":"https://api.github.com/users/lamberken/events{/privacy}","received_events_url":"https://api.github.com/users/lamberken/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-23T10:12:29Z","updated_at":"2021-02-23T10:14:09Z","author_association":"MEMBER","body":"hi @danny0405 thank for the patch, several checkstyle errors，use command to check `mvn checkstyle:check`\r\n\r\nChange junit4 to junit5\r\n\r\n```\r\nimport org.junit.Ignore;  -->  import org.junit.jupiter.api.Disabled;\r\n```\r\n\r\nOutput:\r\n\r\n```\r\n[ERROR] src/main/java/org/apache/hudi/operator/compact/CompactEvent.java:[35,23] (whitespace) MethodParamPad: '(' is preceded with whitespace.\r\n[ERROR] src/main/java/org/apache/hudi/operator/FlinkOptions.java:[172,67] (whitespace) WhitespaceAround: WhitespaceAround: '=' is not preceded with whitespace.\r\n[ERROR] src/main/java/org/apache/hudi/util/StreamerUtil.java:[40,8] (imports) UnusedImports: Unused import - org.apache.hudi.table.action.compact.strategy.CompactionStrategy.\r\n[ERROR] src/test/java/org/apache/hudi/operator/MergeOnReadCompactTest.java:[31,1] (imports) IllegalImport: Illegal import - org.junit.Ignore.\r\n[ERROR] src/test/java/org/apache/hudi/operator/MergeOnReadWriteTest.java:[37,1] (imports) IllegalImport: Illegal import - org.junit.Ignore.\r\n\r\n\r\n```\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784070273/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784155719","html_url":"https://github.com/apache/hudi/pull/2594#issuecomment-784155719","issue_url":"https://api.github.com/repos/apache/hudi/issues/2594","id":784155719,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NDE1NTcxOQ==","user":{"login":"codecov-io","id":8655789,"node_id":"MDQ6VXNlcjg2NTU3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/8655789?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-io","html_url":"https://github.com/codecov-io","followers_url":"https://api.github.com/users/codecov-io/followers","following_url":"https://api.github.com/users/codecov-io/following{/other_user}","gists_url":"https://api.github.com/users/codecov-io/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-io/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-io/subscriptions","organizations_url":"https://api.github.com/users/codecov-io/orgs","repos_url":"https://api.github.com/users/codecov-io/repos","events_url":"https://api.github.com/users/codecov-io/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-io/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-23T12:09:14Z","updated_at":"2021-02-23T12:09:21Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2594?src=pr&el=h1) Report\n> Merging [#2594](https://codecov.io/gh/apache/hudi/pull/2594?src=pr&el=desc) (474c259) into [master](https://codecov.io/gh/apache/hudi/commit/3ceb1b4c83d4e004c9b397bd05600c2aaf86196d?el=desc) (3ceb1b4) will **increase** coverage by `0.01%`.\n> The diff coverage is `n/a`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2594/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2)](https://codecov.io/gh/apache/hudi/pull/2594?src=pr&el=tree)\n\n```diff\n@@             Coverage Diff              @@\n##             master    #2594      +/-   ##\n============================================\n+ Coverage     51.18%   51.20%   +0.01%     \n  Complexity     3227     3227              \n============================================\n  Files           438      438              \n  Lines         20089    20089              \n  Branches       2068     2068              \n============================================\n+ Hits          10282    10286       +4     \n+ Misses         8961     8958       -3     \n+ Partials        846      845       -1     \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `36.87% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudiclient | `100.00% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudicommon | `51.37% <ø> (+0.02%)` | `0.00 <ø> (ø)` | |\n| hudiflink | `46.38% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudihadoopmr | `33.16% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudisparkdatasource | `69.75% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudisync | `48.61% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| huditimelineservice | `66.49% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudiutilities | `69.51% <ø> (+0.10%)` | `0.00 <ø> (ø)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2594?src=pr&el=tree) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...in/java/org/apache/hudi/utilities/UtilHelpers.java](https://codecov.io/gh/apache/hudi/pull/2594/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL1V0aWxIZWxwZXJzLmphdmE=) | `65.69% <0.00%> (+1.16%)` | `32.00% <0.00%> (ø%)` | |\n| [...e/hudi/common/table/log/HoodieLogFormatWriter.java](https://codecov.io/gh/apache/hudi/pull/2594/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3RhYmxlL2xvZy9Ib29kaWVMb2dGb3JtYXRXcml0ZXIuamF2YQ==) | `79.68% <0.00%> (+1.56%)` | `26.00% <0.00%> (ø%)` | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784155719/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784177304","html_url":"https://github.com/apache/hudi/pull/2534#issuecomment-784177304","issue_url":"https://api.github.com/repos/apache/hudi/issues/2534","id":784177304,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NDE3NzMwNA==","user":{"login":"pengzhiwei2018","id":42458891,"node_id":"MDQ6VXNlcjQyNDU4ODkx","avatar_url":"https://avatars.githubusercontent.com/u/42458891?v=4","gravatar_id":"","url":"https://api.github.com/users/pengzhiwei2018","html_url":"https://github.com/pengzhiwei2018","followers_url":"https://api.github.com/users/pengzhiwei2018/followers","following_url":"https://api.github.com/users/pengzhiwei2018/following{/other_user}","gists_url":"https://api.github.com/users/pengzhiwei2018/gists{/gist_id}","starred_url":"https://api.github.com/users/pengzhiwei2018/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pengzhiwei2018/subscriptions","organizations_url":"https://api.github.com/users/pengzhiwei2018/orgs","repos_url":"https://api.github.com/users/pengzhiwei2018/repos","events_url":"https://api.github.com/users/pengzhiwei2018/events{/privacy}","received_events_url":"https://api.github.com/users/pengzhiwei2018/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-23T12:47:49Z","updated_at":"2021-02-23T12:48:14Z","author_association":"NONE","body":"Hi @nsivabalan\r\nThis PR support  Builder pattern for `HoodieMetaClient`. But the problem of parameters too long for `initTableType` method is still exist. I found it is really hard to add a new table property to the `initTableType`. And I have open another PR to solve this problem at [HUDI-1636](https://github.com/apache/hudi/pull/2596). Can you please  have a look when you have time? thanks.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784177304/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784219985","html_url":"https://github.com/apache/hudi/pull/2188#issuecomment-784219985","issue_url":"https://api.github.com/repos/apache/hudi/issues/2188","id":784219985,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NDIxOTk4NQ==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-23T13:56:29Z","updated_at":"2021-02-23T13:56:29Z","author_association":"CONTRIBUTOR","body":"@n3nash : I have updated the patch w/ some minor fixes. Will land this in once CI succeeds.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784219985/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784220708","html_url":"https://github.com/apache/hudi/pull/2593#issuecomment-784220708","issue_url":"https://api.github.com/repos/apache/hudi/issues/2593","id":784220708,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NDIyMDcwOA==","user":{"login":"codecov-io","id":8655789,"node_id":"MDQ6VXNlcjg2NTU3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/8655789?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-io","html_url":"https://github.com/codecov-io","followers_url":"https://api.github.com/users/codecov-io/followers","following_url":"https://api.github.com/users/codecov-io/following{/other_user}","gists_url":"https://api.github.com/users/codecov-io/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-io/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-io/subscriptions","organizations_url":"https://api.github.com/users/codecov-io/orgs","repos_url":"https://api.github.com/users/codecov-io/repos","events_url":"https://api.github.com/users/codecov-io/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-io/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-23T13:57:30Z","updated_at":"2021-03-01T03:01:45Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2593?src=pr&el=h1) Report\n> Merging [#2593](https://codecov.io/gh/apache/hudi/pull/2593?src=pr&el=desc) (c22ac8d) into [master](https://codecov.io/gh/apache/hudi/commit/06dc7c7fd8a867a1e1da90f7dc19b0cc2da69bba?el=desc) (06dc7c7) will **increase** coverage by `18.37%`.\n> The diff coverage is `n/a`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2593/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2)](https://codecov.io/gh/apache/hudi/pull/2593?src=pr&el=tree)\n\n```diff\n@@              Coverage Diff              @@\n##             master    #2593       +/-   ##\n=============================================\n+ Coverage     51.22%   69.59%   +18.37%     \n+ Complexity     3230      364     -2866     \n=============================================\n  Files           438       53      -385     \n  Lines         20093     1944    -18149     \n  Branches       2069      235     -1834     \n=============================================\n- Hits          10292     1353     -8939     \n+ Misses         8954      458     -8496     \n+ Partials        847      133      -714     \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `?` | `?` | |\n| hudiclient | `?` | `?` | |\n| hudicommon | `?` | `?` | |\n| hudiflink | `?` | `?` | |\n| hudihadoopmr | `?` | `?` | |\n| hudisparkdatasource | `?` | `?` | |\n| hudisync | `?` | `?` | |\n| huditimelineservice | `?` | `?` | |\n| hudiutilities | `69.59% <ø> (+0.08%)` | `0.00 <ø> (ø)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2593?src=pr&el=tree) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...hudi/utilities/sources/helpers/KafkaOffsetGen.java](https://codecov.io/gh/apache/hudi/pull/2593/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvaGVscGVycy9LYWZrYU9mZnNldEdlbi5qYXZh) | `85.84% <0.00%> (-2.94%)` | `20.00% <0.00%> (+4.00%)` | :arrow_down: |\n| [...he/hudi/common/table/log/block/HoodieLogBlock.java](https://codecov.io/gh/apache/hudi/pull/2593/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3RhYmxlL2xvZy9ibG9jay9Ib29kaWVMb2dCbG9jay5qYXZh) | | | |\n| [...che/hudi/common/table/timeline/dto/LogFileDTO.java](https://codecov.io/gh/apache/hudi/pull/2593/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3RhYmxlL3RpbWVsaW5lL2R0by9Mb2dGaWxlRFRPLmphdmE=) | | | |\n| [.../hudi/common/table/view/FileSystemViewManager.java](https://codecov.io/gh/apache/hudi/pull/2593/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3RhYmxlL3ZpZXcvRmlsZVN5c3RlbVZpZXdNYW5hZ2VyLmphdmE=) | | | |\n| [...able/timeline/versioning/AbstractMigratorBase.java](https://codecov.io/gh/apache/hudi/pull/2593/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3RhYmxlL3RpbWVsaW5lL3ZlcnNpb25pbmcvQWJzdHJhY3RNaWdyYXRvckJhc2UuamF2YQ==) | | | |\n| [.../org/apache/hudi/io/storage/HoodieHFileReader.java](https://codecov.io/gh/apache/hudi/pull/2593/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvaW8vc3RvcmFnZS9Ib29kaWVIRmlsZVJlYWRlci5qYXZh) | | | |\n| [...org/apache/hudi/common/bloom/BloomFilterUtils.java](https://codecov.io/gh/apache/hudi/pull/2593/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL2Jsb29tL0Jsb29tRmlsdGVyVXRpbHMuamF2YQ==) | | | |\n| [...org/apache/hudi/common/config/TypedProperties.java](https://codecov.io/gh/apache/hudi/pull/2593/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL2NvbmZpZy9UeXBlZFByb3BlcnRpZXMuamF2YQ==) | | | |\n| [...ava/org/apache/hudi/cli/commands/TableCommand.java](https://codecov.io/gh/apache/hudi/pull/2593/diff?src=pr&el=tree#diff-aHVkaS1jbGkvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY2xpL2NvbW1hbmRzL1RhYmxlQ29tbWFuZC5qYXZh) | | | |\n| [...rg/apache/hudi/schema/FilebasedSchemaProvider.java](https://codecov.io/gh/apache/hudi/pull/2593/diff?src=pr&el=tree#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9zY2hlbWEvRmlsZWJhc2VkU2NoZW1hUHJvdmlkZXIuamF2YQ==) | | | |\n| ... and [371 more](https://codecov.io/gh/apache/hudi/pull/2593/diff?src=pr&el=tree-more) | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784220708/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784223991","html_url":"https://github.com/apache/hudi/pull/2210#issuecomment-784223991","issue_url":"https://api.github.com/repos/apache/hudi/issues/2210","id":784223991,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NDIyMzk5MQ==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-23T14:02:27Z","updated_at":"2021-02-23T14:02:44Z","author_association":"CONTRIBUTOR","body":"Update: I couldn't reproduce the CI failure locally. I need some more time to look into it. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784223991/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784233741","html_url":"https://github.com/apache/hudi/pull/2443#issuecomment-784233741","issue_url":"https://api.github.com/repos/apache/hudi/issues/2443","id":784233741,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NDIzMzc0MQ==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-23T14:16:31Z","updated_at":"2021-02-23T14:17:28Z","author_association":"CONTRIBUTOR","body":"@yanghua : I synced up w/ Vinoth on this. here is our idea. we will make the config (naming) generic for now. but lets not make it wider to ignore exceptions for sync. bcoz, if sync explicitly fails probably user need to get notified. Since this diff was raised mainly for connect execption, we will leave it as is. But in future if some customer needs to ignore sync exceptions as well, we can consider silently ignoring those as well(so that we don't introduce a new config and can use the same config). wdyt? \r\nIf you agree, only fix we need for now is to fix the config naming. I can work on it and push in a small commit. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784233741/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784265559","html_url":"https://github.com/apache/hudi/pull/2577#issuecomment-784265559","issue_url":"https://api.github.com/repos/apache/hudi/issues/2577","id":784265559,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NDI2NTU1OQ==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-23T15:03:47Z","updated_at":"2021-02-23T15:03:47Z","author_association":"CONTRIBUTOR","body":"@yanghua : removed the unwanted file. you can review","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784265559/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784266815","html_url":"https://github.com/apache/hudi/issues/2564#issuecomment-784266815","issue_url":"https://api.github.com/repos/apache/hudi/issues/2564","id":784266815,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NDI2NjgxNQ==","user":{"login":"rswagatika","id":76132270,"node_id":"MDQ6VXNlcjc2MTMyMjcw","avatar_url":"https://avatars.githubusercontent.com/u/76132270?v=4","gravatar_id":"","url":"https://api.github.com/users/rswagatika","html_url":"https://github.com/rswagatika","followers_url":"https://api.github.com/users/rswagatika/followers","following_url":"https://api.github.com/users/rswagatika/following{/other_user}","gists_url":"https://api.github.com/users/rswagatika/gists{/gist_id}","starred_url":"https://api.github.com/users/rswagatika/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rswagatika/subscriptions","organizations_url":"https://api.github.com/users/rswagatika/orgs","repos_url":"https://api.github.com/users/rswagatika/repos","events_url":"https://api.github.com/users/rswagatika/events{/privacy}","received_events_url":"https://api.github.com/users/rswagatika/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-23T15:05:28Z","updated_at":"2021-02-23T15:05:28Z","author_association":"NONE","body":"@bvaradar okay my bad I have not attached the .commit, but I see .commit from my hoodie folder as well and when I run \"compactions show all\" also I see below screenshot, so looks like compaction triggering. So I am running out of idea how can I resolve this.\r\n\r\n<img width=\"1141\" alt=\"Screen Shot 2021-02-23 at 9 00 34 AM\" src=\"https://user-images.githubusercontent.com/76132270/108862689-790c0900-75be-11eb-9686-caccf1a1548c.png\">\r\n\r\n<img width=\"562\" alt=\"Screen Shot 2021-02-23 at 9 00 39 AM\" src=\"https://user-images.githubusercontent.com/76132270/108862691-79a49f80-75be-11eb-852d-fb54f3b7cf78.png\">\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784266815/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784267568","html_url":"https://github.com/apache/hudi/pull/2562#issuecomment-784267568","issue_url":"https://api.github.com/repos/apache/hudi/issues/2562","id":784267568,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NDI2NzU2OA==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-23T15:06:33Z","updated_at":"2021-02-23T15:06:33Z","author_association":"CONTRIBUTOR","body":"@vinothchandar @n3nash : gentle ping. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784267568/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784276401","html_url":"https://github.com/apache/hudi/pull/2597#issuecomment-784276401","issue_url":"https://api.github.com/repos/apache/hudi/issues/2597","id":784276401,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NDI3NjQwMQ==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-23T15:18:57Z","updated_at":"2021-02-23T15:18:57Z","author_association":"MEMBER","body":"does date also show up now? if so, LGTM. Please land ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784276401/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784279531","html_url":"https://github.com/apache/hudi/pull/2597#issuecomment-784279531","issue_url":"https://api.github.com/repos/apache/hudi/issues/2597","id":784279531,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NDI3OTUzMQ==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-23T15:23:08Z","updated_at":"2021-02-23T15:23:08Z","author_association":"CONTRIBUTOR","body":"yes.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784279531/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784280741","html_url":"https://github.com/apache/hudi/issues/2448#issuecomment-784280741","issue_url":"https://api.github.com/repos/apache/hudi/issues/2448","id":784280741,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NDI4MDc0MQ==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-23T15:24:44Z","updated_at":"2021-02-23T15:24:44Z","author_association":"CONTRIBUTOR","body":"nope. inline means sync. if not its async. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784280741/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784284438","html_url":"https://github.com/apache/hudi/issues/2563#issuecomment-784284438","issue_url":"https://api.github.com/repos/apache/hudi/issues/2563","id":784284438,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NDI4NDQzOA==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-23T15:29:40Z","updated_at":"2021-02-23T15:29:51Z","author_association":"CONTRIBUTOR","body":"@rubenssoto : sorry bit confusing. Lets simplify this.\r\nLets say there are only two fields. F1 and F2 (commit_version). \r\nIs this your scenario. \r\nExisting dataset in hudi has only F1. \r\nand your new batch of ingestion  has schema F1, F2? \r\nCan you please clarify. \r\nBasically whats the schema of original hudi dataset. \r\nAnd whats the schema of new batch of write. \r\nCan you please clarify","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784284438/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784313085","html_url":"https://github.com/apache/hudi/issues/2563#issuecomment-784313085","issue_url":"https://api.github.com/repos/apache/hudi/issues/2563","id":784313085,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NDMxMzA4NQ==","user":{"login":"rubenssoto","id":36298331,"node_id":"MDQ6VXNlcjM2Mjk4MzMx","avatar_url":"https://avatars.githubusercontent.com/u/36298331?v=4","gravatar_id":"","url":"https://api.github.com/users/rubenssoto","html_url":"https://github.com/rubenssoto","followers_url":"https://api.github.com/users/rubenssoto/followers","following_url":"https://api.github.com/users/rubenssoto/following{/other_user}","gists_url":"https://api.github.com/users/rubenssoto/gists{/gist_id}","starred_url":"https://api.github.com/users/rubenssoto/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rubenssoto/subscriptions","organizations_url":"https://api.github.com/users/rubenssoto/orgs","repos_url":"https://api.github.com/users/rubenssoto/repos","events_url":"https://api.github.com/users/rubenssoto/events{/privacy}","received_events_url":"https://api.github.com/users/rubenssoto/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-23T16:08:01Z","updated_at":"2021-02-23T16:08:01Z","author_association":"NONE","body":"Yeah thats right...\r\n\r\nMy existing dataset has only column F1, imagine that F1 is my primary key\r\nMy new batch of data has two fields F1 and F2, in that new batch has inserts and updates\r\n\r\nWith this scenario, I had that problem.\r\n\r\n@nsivabalan ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784313085/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784313973","html_url":"https://github.com/apache/hudi/issues/2515#issuecomment-784313973","issue_url":"https://api.github.com/repos/apache/hudi/issues/2515","id":784313973,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NDMxMzk3Mw==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-23T16:09:07Z","updated_at":"2021-02-23T16:09:07Z","author_association":"MEMBER","body":"@t0il3ts0ap thanks. Got it so. you have a transformer as well. \r\n\r\nI put up #2590 which overcomes the issue. but we want the schema to be supplied from the `DataSet` even in your scenario. I am working on updating the PR with a less crude approach. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784313973/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784352656","html_url":"https://github.com/apache/hudi/issues/2564#issuecomment-784352656","issue_url":"https://api.github.com/repos/apache/hudi/issues/2564","id":784352656,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NDM1MjY1Ng==","user":{"login":"bvaradar","id":3021376,"node_id":"MDQ6VXNlcjMwMjEzNzY=","avatar_url":"https://avatars.githubusercontent.com/u/3021376?v=4","gravatar_id":"","url":"https://api.github.com/users/bvaradar","html_url":"https://github.com/bvaradar","followers_url":"https://api.github.com/users/bvaradar/followers","following_url":"https://api.github.com/users/bvaradar/following{/other_user}","gists_url":"https://api.github.com/users/bvaradar/gists{/gist_id}","starred_url":"https://api.github.com/users/bvaradar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bvaradar/subscriptions","organizations_url":"https://api.github.com/users/bvaradar/orgs","repos_url":"https://api.github.com/users/bvaradar/repos","events_url":"https://api.github.com/users/bvaradar/events{/privacy}","received_events_url":"https://api.github.com/users/bvaradar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-23T17:02:30Z","updated_at":"2021-02-23T17:02:30Z","author_association":"CONTRIBUTOR","body":"@rswagatika  : Thank you for clarification. Since \"show fsview all\" is not showing all the files for some reason and there could be more .commit files, can you list the entire dataset for the one which you think is not cleaning properly. \r\n\r\nPlease recursively list everything in the data path. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784352656/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784487451","html_url":"https://github.com/apache/hudi/issues/2564#issuecomment-784487451","issue_url":"https://api.github.com/repos/apache/hudi/issues/2564","id":784487451,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NDQ4NzQ1MQ==","user":{"login":"rswagatika","id":76132270,"node_id":"MDQ6VXNlcjc2MTMyMjcw","avatar_url":"https://avatars.githubusercontent.com/u/76132270?v=4","gravatar_id":"","url":"https://api.github.com/users/rswagatika","html_url":"https://github.com/rswagatika","followers_url":"https://api.github.com/users/rswagatika/followers","following_url":"https://api.github.com/users/rswagatika/following{/other_user}","gists_url":"https://api.github.com/users/rswagatika/gists{/gist_id}","starred_url":"https://api.github.com/users/rswagatika/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rswagatika/subscriptions","organizations_url":"https://api.github.com/users/rswagatika/orgs","repos_url":"https://api.github.com/users/rswagatika/repos","events_url":"https://api.github.com/users/rswagatika/events{/privacy}","received_events_url":"https://api.github.com/users/rswagatika/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-23T20:26:06Z","updated_at":"2021-02-23T20:26:06Z","author_association":"NONE","body":"@bvaradar let me know if this helps to understand better?\r\n\r\nmy_test/.hoodie/.aux/.bootstrap/.fileids_$folder$\r\nmy_test/.hoodie/.aux/.bootstrap/.partitions_$folder$\r\nmy_test/.hoodie/.aux/.bootstrap_$folder$\r\nmy_test/.hoodie/.aux/20210212171919.compaction.requested\r\nmy_test/.hoodie/.aux/20210212211220.compaction.requested\r\nmy_test/.hoodie/.aux_$folder$\r\nmy_test/.hoodie/.temp/20210212171919/range_partition=default/af837aeb-3881-43f0-8aa4-434502059b68-0_0-33-41_20210212171919.parquet.marker.MERGE\r\nmy_test/.hoodie/.temp/20210212171919/range_partition=default_$folder$\r\nmy_test/.hoodie/.temp/20210212171919_$folder$\r\nmy_test/.hoodie/.temp/20210212211220/range_partition=default/af837aeb-3881-43f0-8aa4-434502059b68-0_0-41-43_20210212211220.parquet.marker.MERGE\r\nmy_test/.hoodie/.temp/20210212211220/range_partition=default_$folder$\r\nmy_test/.hoodie/.temp/20210212211220_$folder$\r\nmy_test/.hoodie/.temp_$folder$\r\nmy_test/.hoodie/20210211002333.rollback\r\nmy_test/.hoodie/20210211002333.rollback.inflight\r\nmy_test/.hoodie/20210211002421.rollback\r\nmy_test/.hoodie/20210211002421.rollback.inflight\r\nmy_test/.hoodie/20210211003429.rollback\r\nmy_test/.hoodie/20210211003429.rollback.inflight\r\nmy_test/.hoodie/20210211003516.rollback\r\nmy_test/.hoodie/20210211003516.rollback.inflight\r\nmy_test/.hoodie/20210211003549.rollback\r\nmy_test/.hoodie/20210211003549.rollback.inflight\r\nmy_test/.hoodie/20210211003637.rollback\r\nmy_test/.hoodie/20210211003637.rollback.inflight\r\nmy_test/.hoodie/20210211003711.rollback\r\nmy_test/.hoodie/20210211003711.rollback.inflight\r\nmy_test/.hoodie/20210211003800.rollback\r\nmy_test/.hoodie/20210211003800.rollback.inflight\r\nmy_test/.hoodie/20210211060535.rollback\r\nmy_test/.hoodie/20210211060535.rollback.inflight\r\nmy_test/.hoodie/20210211083645.rollback\r\nmy_test/.hoodie/20210211083645.rollback.inflight\r\nmy_test/.hoodie/20210211112535.rollback\r\nmy_test/.hoodie/20210211112535.rollback.inflight\r\nmy_test/.hoodie/20210212022145.rollback\r\nmy_test/.hoodie/20210212022145.rollback.inflight\r\nmy_test/.hoodie/20210212152423.rollback\r\nmy_test/.hoodie/20210212152423.rollback.inflight\r\nmy_test/.hoodie/20210212171816.deltacommit\r\nmy_test/.hoodie/20210212171816.deltacommit.inflight\r\nmy_test/.hoodie/20210212171816.deltacommit.requested\r\nmy_test/.hoodie/20210212171919.commit\r\nmy_test/.hoodie/20210212171919.compaction.inflight\r\nmy_test/.hoodie/20210212171919.compaction.requested\r\nmy_test/.hoodie/20210212195421.deltacommit\r\nmy_test/.hoodie/20210212195421.deltacommit.inflight\r\nmy_test/.hoodie/20210212195421.deltacommit.requested\r\nmy_test/.hoodie/20210212211117.deltacommit\r\nmy_test/.hoodie/20210212211117.deltacommit.inflight\r\nmy_test/.hoodie/20210212211117.deltacommit.requested\r\nmy_test/.hoodie/20210212211220.commit\r\nmy_test/.hoodie/20210212211220.compaction.inflight\r\nmy_test/.hoodie/20210212211220.compaction.requested\r\nmy_test/.hoodie/archived/.commits_.archive.10_1-0-1\r\nmy_test/.hoodie/archived/.commits_.archive.11_1-0-1\r\nmy_test/.hoodie/archived/.commits_.archive.12_1-0-1\r\nmy_test/.hoodie/archived/.commits_.archive.13_1-0-1\r\nmy_test/.hoodie/archived/.commits_.archive.14_1-0-1\r\nmy_test/.hoodie/archived/.commits_.archive.15_1-0-1\r\nmy_test/.hoodie/archived/.commits_.archive.16_1-0-1\r\nmy_test/.hoodie/archived/.commits_.archive.17_1-0-1\r\nmy_test/.hoodie/archived/.commits_.archive.18_1-0-1\r\nmy_test/.hoodie/archived/.commits_.archive.19_1-0-1\r\nmy_test/.hoodie/archived/.commits_.archive.1_1-0-1\r\nmy_test/.hoodie/archived/.commits_.archive.20_1-0-1\r\nmy_test/.hoodie/archived/.commits_.archive.21_1-0-1\r\nmy_test/.hoodie/archived/.commits_.archive.22_1-0-1\r\nmy_test/.hoodie/archived/.commits_.archive.23_1-0-1\r\nmy_test/.hoodie/archived/.commits_.archive.24_1-0-1\r\nmy_test/.hoodie/archived/.commits_.archive.2_1-0-1\r\nmy_test/.hoodie/archived/.commits_.archive.3_1-0-1\r\nmy_test/.hoodie/archived/.commits_.archive.4_1-0-1\r\nmy_test/.hoodie/archived/.commits_.archive.5_1-0-1\r\nmy_test/.hoodie/archived/.commits_.archive.6_1-0-1\r\nmy_test/.hoodie/archived/.commits_.archive.7_1-0-1\r\nmy_test/.hoodie/archived/.commits_.archive.8_1-0-1\r\nmy_test/.hoodie/archived/.commits_.archive.9_1-0-1\r\nmy_test/.hoodie/archived_$folder$\r\nmy_test/.hoodie/hoodie.properties\r\nmy_test/.hoodie_$folder$\r\n267.3 MiB my_test/partition=default/.13b3d240-9630-470b-989d-0c6a1afe040f-0_20210211060531.log.10_5-24-7278\r\n...... and a more (around 500) log files \r\nmy_test/partition=default/.hoodie_partition_metadata\r\n359.1 MiB my_test/partition=default/13b3d240-9630-470b-989d-0c6a1afe040f-0_1-33-42_20210212153112.parquet\r\n....... and more (around 150) parquet files\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784487451/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784622220","html_url":"https://github.com/apache/hudi/pull/2598#issuecomment-784622220","issue_url":"https://api.github.com/repos/apache/hudi/issues/2598","id":784622220,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NDYyMjIyMA==","user":{"login":"codecov-io","id":8655789,"node_id":"MDQ6VXNlcjg2NTU3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/8655789?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-io","html_url":"https://github.com/codecov-io","followers_url":"https://api.github.com/users/codecov-io/followers","following_url":"https://api.github.com/users/codecov-io/following{/other_user}","gists_url":"https://api.github.com/users/codecov-io/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-io/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-io/subscriptions","organizations_url":"https://api.github.com/users/codecov-io/orgs","repos_url":"https://api.github.com/users/codecov-io/repos","events_url":"https://api.github.com/users/codecov-io/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-io/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T00:08:42Z","updated_at":"2021-03-02T18:00:27Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2598?src=pr&el=h1) Report\n> Merging [#2598](https://codecov.io/gh/apache/hudi/pull/2598?src=pr&el=desc) (9bc13c2) into [master](https://codecov.io/gh/apache/hudi/commit/0dde7f9185a350599adaab5af5738b73a15243d7?el=desc) (0dde7f9) will **decrease** coverage by `42.37%`.\n> The diff coverage is `0.00%`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2598/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2)](https://codecov.io/gh/apache/hudi/pull/2598?src=pr&el=tree)\n\n```diff\n@@             Coverage Diff              @@\n##             master   #2598       +/-   ##\n============================================\n- Coverage     51.55%   9.18%   -42.38%     \n+ Complexity     3282      48     -3234     \n============================================\n  Files           445      55      -390     \n  Lines         20317    2037    -18280     \n  Branches       2102     251     -1851     \n============================================\n- Hits          10475     187    -10288     \n+ Misses         8976    1837     -7139     \n+ Partials        866      13      -853     \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `?` | `?` | |\n| hudiclient | `?` | `?` | |\n| hudicommon | `?` | `?` | |\n| hudiflink | `?` | `?` | |\n| hudihadoopmr | `?` | `?` | |\n| hudisparkdatasource | `?` | `?` | |\n| hudisync | `?` | `?` | |\n| huditimelineservice | `?` | `?` | |\n| hudiutilities | `9.18% <0.00%> (-60.37%)` | `0.00 <0.00> (ø)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2598?src=pr&el=tree) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...i/utilities/deser/KafkaAvroSchemaDeserializer.java](https://codecov.io/gh/apache/hudi/pull/2598/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL2Rlc2VyL0thZmthQXZyb1NjaGVtYURlc2VyaWFsaXplci5qYXZh) | `0.00% <0.00%> (ø)` | `0.00 <0.00> (?)` | |\n| [.../hudi/utilities/schema/SchemaRegistryProvider.java](https://codecov.io/gh/apache/hudi/pull/2598/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NjaGVtYS9TY2hlbWFSZWdpc3RyeVByb3ZpZGVyLmphdmE=) | `0.00% <0.00%> (ø)` | `0.00 <0.00> (ø)` | |\n| [...apache/hudi/utilities/sources/AvroKafkaSource.java](https://codecov.io/gh/apache/hudi/pull/2598/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvQXZyb0thZmthU291cmNlLmphdmE=) | `0.00% <0.00%> (ø)` | `0.00 <0.00> (ø)` | |\n| [...lities/sources/helpers/AvroKafkaSourceHelpers.java](https://codecov.io/gh/apache/hudi/pull/2598/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvaGVscGVycy9BdnJvS2Fma2FTb3VyY2VIZWxwZXJzLmphdmE=) | `0.00% <0.00%> (ø)` | `0.00 <0.00> (?)` | |\n| [.../utilities/transform/SqlQueryBasedTransformer.java](https://codecov.io/gh/apache/hudi/pull/2598/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3RyYW5zZm9ybS9TcWxRdWVyeUJhc2VkVHJhbnNmb3JtZXIuamF2YQ==) | `0.00% <0.00%> (-75.00%)` | `0.00 <0.00> (-3.00)` | |\n| [...va/org/apache/hudi/utilities/IdentitySplitter.java](https://codecov.io/gh/apache/hudi/pull/2598/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL0lkZW50aXR5U3BsaXR0ZXIuamF2YQ==) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-2.00%)` | |\n| [...va/org/apache/hudi/utilities/schema/SchemaSet.java](https://codecov.io/gh/apache/hudi/pull/2598/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NjaGVtYS9TY2hlbWFTZXQuamF2YQ==) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-3.00%)` | |\n| [...a/org/apache/hudi/utilities/sources/RowSource.java](https://codecov.io/gh/apache/hudi/pull/2598/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvUm93U291cmNlLmphdmE=) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-4.00%)` | |\n| [.../org/apache/hudi/utilities/sources/AvroSource.java](https://codecov.io/gh/apache/hudi/pull/2598/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvQXZyb1NvdXJjZS5qYXZh) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-1.00%)` | |\n| [.../org/apache/hudi/utilities/sources/JsonSource.java](https://codecov.io/gh/apache/hudi/pull/2598/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvSnNvblNvdXJjZS5qYXZh) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-1.00%)` | |\n| ... and [429 more](https://codecov.io/gh/apache/hudi/pull/2598/diff?src=pr&el=tree-more) | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784622220/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784645629","html_url":"https://github.com/apache/hudi/issues/2564#issuecomment-784645629","issue_url":"https://api.github.com/repos/apache/hudi/issues/2564","id":784645629,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NDY0NTYyOQ==","user":{"login":"bvaradar","id":3021376,"node_id":"MDQ6VXNlcjMwMjEzNzY=","avatar_url":"https://avatars.githubusercontent.com/u/3021376?v=4","gravatar_id":"","url":"https://api.github.com/users/bvaradar","html_url":"https://github.com/bvaradar","followers_url":"https://api.github.com/users/bvaradar/followers","following_url":"https://api.github.com/users/bvaradar/following{/other_user}","gists_url":"https://api.github.com/users/bvaradar/gists{/gist_id}","starred_url":"https://api.github.com/users/bvaradar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bvaradar/subscriptions","organizations_url":"https://api.github.com/users/bvaradar/orgs","repos_url":"https://api.github.com/users/bvaradar/repos","events_url":"https://api.github.com/users/bvaradar/events{/privacy}","received_events_url":"https://api.github.com/users/bvaradar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T00:49:04Z","updated_at":"2021-02-24T00:49:04Z","author_association":"CONTRIBUTOR","body":"@rswagatika : I also need the full list of the parquet and log files. Basically, I am trying to manually see how many versions of \"logical file\" is present for each file and cross check with your cleaner configurations to see if cleaner is supposed to run or not.\r\n\r\nCan you also enable INFO logging of the ingestion job and attach the driver logs here\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784645629/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784650062","html_url":"https://github.com/apache/hudi/issues/2592#issuecomment-784650062","issue_url":"https://api.github.com/repos/apache/hudi/issues/2592","id":784650062,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NDY1MDA2Mg==","user":{"login":"bvaradar","id":3021376,"node_id":"MDQ6VXNlcjMwMjEzNzY=","avatar_url":"https://avatars.githubusercontent.com/u/3021376?v=4","gravatar_id":"","url":"https://api.github.com/users/bvaradar","html_url":"https://github.com/bvaradar","followers_url":"https://api.github.com/users/bvaradar/followers","following_url":"https://api.github.com/users/bvaradar/following{/other_user}","gists_url":"https://api.github.com/users/bvaradar/gists{/gist_id}","starred_url":"https://api.github.com/users/bvaradar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bvaradar/subscriptions","organizations_url":"https://api.github.com/users/bvaradar/orgs","repos_url":"https://api.github.com/users/bvaradar/repos","events_url":"https://api.github.com/users/bvaradar/events{/privacy}","received_events_url":"https://api.github.com/users/bvaradar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T00:59:27Z","updated_at":"2021-02-24T00:59:27Z","author_association":"CONTRIBUTOR","body":"@codejoyan : Would it be possible for you to give us a reproducible set of steps (just like the Quickstart : https://hudi.apache.org/docs/quick-start-guide.html ) ?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784650062/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784650181","html_url":"https://github.com/apache/hudi/pull/2541#issuecomment-784650181","issue_url":"https://api.github.com/repos/apache/hudi/issues/2541","id":784650181,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NDY1MDE4MQ==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T00:59:32Z","updated_at":"2021-02-24T00:59:32Z","author_association":"MEMBER","body":"@xushiyan Lets may be scope this PR to just emitting the metric.\r\n\r\nwe can eventually store histogram inside commit metadata. we can do a follow for that. \r\n\r\nYou can land this once the code style issues are fixed.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784650181/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784664042","html_url":"https://github.com/apache/hudi/issues/2448#issuecomment-784664042","issue_url":"https://api.github.com/repos/apache/hudi/issues/2448","id":784664042,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NDY2NDA0Mg==","user":{"login":"root18039532923","id":45333549,"node_id":"MDQ6VXNlcjQ1MzMzNTQ5","avatar_url":"https://avatars.githubusercontent.com/u/45333549?v=4","gravatar_id":"","url":"https://api.github.com/users/root18039532923","html_url":"https://github.com/root18039532923","followers_url":"https://api.github.com/users/root18039532923/followers","following_url":"https://api.github.com/users/root18039532923/following{/other_user}","gists_url":"https://api.github.com/users/root18039532923/gists{/gist_id}","starred_url":"https://api.github.com/users/root18039532923/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/root18039532923/subscriptions","organizations_url":"https://api.github.com/users/root18039532923/orgs","repos_url":"https://api.github.com/users/root18039532923/repos","events_url":"https://api.github.com/users/root18039532923/events{/privacy}","received_events_url":"https://api.github.com/users/root18039532923/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T01:25:57Z","updated_at":"2021-02-24T01:25:57Z","author_association":"NONE","body":"but I need async, if I set \"hoodie.compact.inline -> true\",that is not async.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784664042/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784693602","html_url":"https://github.com/apache/hudi/pull/2500#issuecomment-784693602","issue_url":"https://api.github.com/repos/apache/hudi/issues/2500","id":784693602,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NDY5MzYwMg==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T02:07:26Z","updated_at":"2021-02-24T02:07:26Z","author_association":"CONTRIBUTOR","body":"to your comment [here](https://github.com/apache/hudi/pull/2500#discussion_r577529761), again I evolved it based on feedback given by @vburenin . Do you mind explaining the need. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784693602/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784695940","html_url":"https://github.com/apache/hudi/issues/2588#issuecomment-784695940","issue_url":"https://api.github.com/repos/apache/hudi/issues/2588","id":784695940,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NDY5NTk0MA==","user":{"login":"rubenssoto","id":36298331,"node_id":"MDQ6VXNlcjM2Mjk4MzMx","avatar_url":"https://avatars.githubusercontent.com/u/36298331?v=4","gravatar_id":"","url":"https://api.github.com/users/rubenssoto","html_url":"https://github.com/rubenssoto","followers_url":"https://api.github.com/users/rubenssoto/followers","following_url":"https://api.github.com/users/rubenssoto/following{/other_user}","gists_url":"https://api.github.com/users/rubenssoto/gists{/gist_id}","starred_url":"https://api.github.com/users/rubenssoto/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rubenssoto/subscriptions","organizations_url":"https://api.github.com/users/rubenssoto/orgs","repos_url":"https://api.github.com/users/rubenssoto/repos","events_url":"https://api.github.com/users/rubenssoto/events{/privacy}","received_events_url":"https://api.github.com/users/rubenssoto/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T02:12:58Z","updated_at":"2021-02-24T02:12:58Z","author_association":"NONE","body":"<img width=\"1680\" alt=\"Captura de Tela 2021-02-23 às 23 09 52\" src=\"https://user-images.githubusercontent.com/36298331/108935409-68927780-762c-11eb-9c3f-591f1b626557.png\">\r\n\r\nI'm having the problem right now, on master side you could see a lot of cpu usage, but I dont understand why hive is using a lot of CPU","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784695940/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784705748","html_url":"https://github.com/apache/hudi/issues/2588#issuecomment-784705748","issue_url":"https://api.github.com/repos/apache/hudi/issues/2588","id":784705748,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NDcwNTc0OA==","user":{"login":"rubenssoto","id":36298331,"node_id":"MDQ6VXNlcjM2Mjk4MzMx","avatar_url":"https://avatars.githubusercontent.com/u/36298331?v=4","gravatar_id":"","url":"https://api.github.com/users/rubenssoto","html_url":"https://github.com/rubenssoto","followers_url":"https://api.github.com/users/rubenssoto/followers","following_url":"https://api.github.com/users/rubenssoto/following{/other_user}","gists_url":"https://api.github.com/users/rubenssoto/gists{/gist_id}","starred_url":"https://api.github.com/users/rubenssoto/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rubenssoto/subscriptions","organizations_url":"https://api.github.com/users/rubenssoto/orgs","repos_url":"https://api.github.com/users/rubenssoto/repos","events_url":"https://api.github.com/users/rubenssoto/events{/privacy}","received_events_url":"https://api.github.com/users/rubenssoto/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T02:38:25Z","updated_at":"2021-02-24T02:38:25Z","author_association":"NONE","body":"@umehrot2 @bvaradar if you have any idea, please help me, is the only problem that prevents me from turning Hudi to production.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784705748/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784713461","html_url":"https://github.com/apache/hudi/pull/1946#issuecomment-784713461","issue_url":"https://api.github.com/repos/apache/hudi/issues/1946","id":784713461,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NDcxMzQ2MQ==","user":{"login":"hddong","id":17537134,"node_id":"MDQ6VXNlcjE3NTM3MTM0","avatar_url":"https://avatars.githubusercontent.com/u/17537134?v=4","gravatar_id":"","url":"https://api.github.com/users/hddong","html_url":"https://github.com/hddong","followers_url":"https://api.github.com/users/hddong/followers","following_url":"https://api.github.com/users/hddong/following{/other_user}","gists_url":"https://api.github.com/users/hddong/gists{/gist_id}","starred_url":"https://api.github.com/users/hddong/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hddong/subscriptions","organizations_url":"https://api.github.com/users/hddong/orgs","repos_url":"https://api.github.com/users/hddong/repos","events_url":"https://api.github.com/users/hddong/events{/privacy}","received_events_url":"https://api.github.com/users/hddong/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T03:00:41Z","updated_at":"2021-02-24T03:00:41Z","author_association":"CONTRIBUTOR","body":"@yanghua @vinothchandar this PR is ready for review.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784713461/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784717451","html_url":"https://github.com/apache/hudi/pull/2596#issuecomment-784717451","issue_url":"https://api.github.com/repos/apache/hudi/issues/2596","id":784717451,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NDcxNzQ1MQ==","user":{"login":"codecov-io","id":8655789,"node_id":"MDQ6VXNlcjg2NTU3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/8655789?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-io","html_url":"https://github.com/codecov-io","followers_url":"https://api.github.com/users/codecov-io/followers","following_url":"https://api.github.com/users/codecov-io/following{/other_user}","gists_url":"https://api.github.com/users/codecov-io/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-io/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-io/subscriptions","organizations_url":"https://api.github.com/users/codecov-io/orgs","repos_url":"https://api.github.com/users/codecov-io/repos","events_url":"https://api.github.com/users/codecov-io/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-io/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T03:12:03Z","updated_at":"2021-03-01T10:17:50Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2596?src=pr&el=h1) Report\n> Merging [#2596](https://codecov.io/gh/apache/hudi/pull/2596?src=pr&el=desc) (922a82f) into [master](https://codecov.io/gh/apache/hudi/commit/43a0776c7c88a5f7beac6c8853db7e341810635a?el=desc) (43a0776) will **increase** coverage by `18.36%`.\n> The diff coverage is `69.56%`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2596/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2)](https://codecov.io/gh/apache/hudi/pull/2596?src=pr&el=tree)\n\n```diff\n@@              Coverage Diff              @@\n##             master    #2596       +/-   ##\n=============================================\n+ Coverage     51.14%   69.50%   +18.36%     \n+ Complexity     3215      364     -2851     \n=============================================\n  Files           438       53      -385     \n  Lines         20041     1961    -18080     \n  Branches       2064      235     -1829     \n=============================================\n- Hits          10250     1363     -8887     \n+ Misses         8946      465     -8481     \n+ Partials        845      133      -712     \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `?` | `?` | |\n| hudiclient | `?` | `?` | |\n| hudicommon | `?` | `?` | |\n| hudiflink | `?` | `?` | |\n| hudihadoopmr | `?` | `?` | |\n| hudisparkdatasource | `?` | `?` | |\n| hudisync | `?` | `?` | |\n| huditimelineservice | `?` | `?` | |\n| hudiutilities | `69.50% <69.56%> (+0.03%)` | `0.00 <0.00> (ø)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2596?src=pr&el=tree) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...apache/hudi/utilities/deltastreamer/DeltaSync.java](https://codecov.io/gh/apache/hudi/pull/2596/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL2RlbHRhc3RyZWFtZXIvRGVsdGFTeW5jLmphdmE=) | `70.34% <50.00%> (+0.34%)` | `53.00 <0.00> (+3.00)` | |\n| [...udi/utilities/deltastreamer/BootstrapExecutor.java](https://codecov.io/gh/apache/hudi/pull/2596/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL2RlbHRhc3RyZWFtZXIvQm9vdHN0cmFwRXhlY3V0b3IuamF2YQ==) | `82.35% <100.00%> (+2.80%)` | `6.00 <0.00> (ø)` | |\n| [...hudi/utilities/sources/helpers/KafkaOffsetGen.java](https://codecov.io/gh/apache/hudi/pull/2596/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvaGVscGVycy9LYWZrYU9mZnNldEdlbi5qYXZh) | `85.84% <0.00%> (-2.94%)` | `20.00% <0.00%> (+4.00%)` | :arrow_down: |\n| [...in/java/org/apache/hudi/utilities/UtilHelpers.java](https://codecov.io/gh/apache/hudi/pull/2596/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL1V0aWxIZWxwZXJzLmphdmE=) | `64.53% <0.00%> (-1.17%)` | `33.00% <0.00%> (+1.00%)` | :arrow_down: |\n| [...i/common/table/log/block/HoodieHFileDataBlock.java](https://codecov.io/gh/apache/hudi/pull/2596/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3RhYmxlL2xvZy9ibG9jay9Ib29kaWVIRmlsZURhdGFCbG9jay5qYXZh) | | | |\n| [...a/org/apache/hudi/io/storage/HoodieFileReader.java](https://codecov.io/gh/apache/hudi/pull/2596/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvaW8vc3RvcmFnZS9Ib29kaWVGaWxlUmVhZGVyLmphdmE=) | | | |\n| [.../hadoop/utils/HoodieRealtimeRecordReaderUtils.java](https://codecov.io/gh/apache/hudi/pull/2596/diff?src=pr&el=tree#diff-aHVkaS1oYWRvb3AtbXIvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvaGFkb29wL3V0aWxzL0hvb2RpZVJlYWx0aW1lUmVjb3JkUmVhZGVyVXRpbHMuamF2YQ==) | | | |\n| [.../common/util/queue/FunctionBasedQueueProducer.java](https://codecov.io/gh/apache/hudi/pull/2596/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3V0aWwvcXVldWUvRnVuY3Rpb25CYXNlZFF1ZXVlUHJvZHVjZXIuamF2YQ==) | | | |\n| [...i-cli/src/main/java/org/apache/hudi/cli/Table.java](https://codecov.io/gh/apache/hudi/pull/2596/diff?src=pr&el=tree#diff-aHVkaS1jbGkvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY2xpL1RhYmxlLmphdmE=) | | | |\n| [.../org/apache/hudi/cli/commands/TempViewCommand.java](https://codecov.io/gh/apache/hudi/pull/2596/diff?src=pr&el=tree#diff-aHVkaS1jbGkvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY2xpL2NvbW1hbmRzL1RlbXBWaWV3Q29tbWFuZC5qYXZh) | | | |\n| ... and [376 more](https://codecov.io/gh/apache/hudi/pull/2596/diff?src=pr&el=tree-more) | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784717451/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784727862","html_url":"https://github.com/apache/hudi/issues/2555#issuecomment-784727862","issue_url":"https://api.github.com/repos/apache/hudi/issues/2555","id":784727862,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NDcyNzg2Mg==","user":{"login":"root18039532923","id":45333549,"node_id":"MDQ6VXNlcjQ1MzMzNTQ5","avatar_url":"https://avatars.githubusercontent.com/u/45333549?v=4","gravatar_id":"","url":"https://api.github.com/users/root18039532923","html_url":"https://github.com/root18039532923","followers_url":"https://api.github.com/users/root18039532923/followers","following_url":"https://api.github.com/users/root18039532923/following{/other_user}","gists_url":"https://api.github.com/users/root18039532923/gists{/gist_id}","starred_url":"https://api.github.com/users/root18039532923/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/root18039532923/subscriptions","organizations_url":"https://api.github.com/users/root18039532923/orgs","repos_url":"https://api.github.com/users/root18039532923/repos","events_url":"https://api.github.com/users/root18039532923/events{/privacy}","received_events_url":"https://api.github.com/users/root18039532923/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T03:37:05Z","updated_at":"2021-02-24T03:37:05Z","author_association":"NONE","body":"I use bulkinsert,the size of parquet file is not able to control. need some param?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784727862/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784744552","html_url":"https://github.com/apache/hudi/pull/2532#issuecomment-784744552","issue_url":"https://api.github.com/repos/apache/hudi/issues/2532","id":784744552,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NDc0NDU1Mg==","user":{"login":"rubenssoto","id":36298331,"node_id":"MDQ6VXNlcjM2Mjk4MzMx","avatar_url":"https://avatars.githubusercontent.com/u/36298331?v=4","gravatar_id":"","url":"https://api.github.com/users/rubenssoto","html_url":"https://github.com/rubenssoto","followers_url":"https://api.github.com/users/rubenssoto/followers","following_url":"https://api.github.com/users/rubenssoto/following{/other_user}","gists_url":"https://api.github.com/users/rubenssoto/gists{/gist_id}","starred_url":"https://api.github.com/users/rubenssoto/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rubenssoto/subscriptions","organizations_url":"https://api.github.com/users/rubenssoto/orgs","repos_url":"https://api.github.com/users/rubenssoto/repos","events_url":"https://api.github.com/users/rubenssoto/events{/privacy}","received_events_url":"https://api.github.com/users/rubenssoto/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T04:19:12Z","updated_at":"2021-02-24T04:19:12Z","author_association":"NONE","body":"Hello People,\r\n\r\nIs this PR could help in my problem?\r\n\r\nhttps://github.com/apache/hudi/issues/2588\r\n\r\n@satishkotha @lhjzmn ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784744552/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784804625","html_url":"https://github.com/apache/hudi/pull/2500#issuecomment-784804625","issue_url":"https://api.github.com/repos/apache/hudi/issues/2500","id":784804625,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NDgwNDYyNQ==","user":{"login":"vburenin","id":4350891,"node_id":"MDQ6VXNlcjQzNTA4OTE=","avatar_url":"https://avatars.githubusercontent.com/u/4350891?v=4","gravatar_id":"","url":"https://api.github.com/users/vburenin","html_url":"https://github.com/vburenin","followers_url":"https://api.github.com/users/vburenin/followers","following_url":"https://api.github.com/users/vburenin/following{/other_user}","gists_url":"https://api.github.com/users/vburenin/gists{/gist_id}","starred_url":"https://api.github.com/users/vburenin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vburenin/subscriptions","organizations_url":"https://api.github.com/users/vburenin/orgs","repos_url":"https://api.github.com/users/vburenin/repos","events_url":"https://api.github.com/users/vburenin/events{/privacy}","received_events_url":"https://api.github.com/users/vburenin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T05:59:22Z","updated_at":"2021-02-24T05:59:22Z","author_association":"CONTRIBUTOR","body":"@nsivabalan I stand by my comment. The problem with all this only arise when fsDataInputStream.getWrappedStream() is not FSInputStream, so only then we start juggling trying to figure out what the type is and what to look for.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784804625/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784979698","html_url":"https://github.com/apache/hudi/issues/2284#issuecomment-784979698","issue_url":"https://api.github.com/repos/apache/hudi/issues/2284","id":784979698,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NDk3OTY5OA==","user":{"login":"saumyasuhagiya","id":2899428,"node_id":"MDQ6VXNlcjI4OTk0Mjg=","avatar_url":"https://avatars.githubusercontent.com/u/2899428?v=4","gravatar_id":"","url":"https://api.github.com/users/saumyasuhagiya","html_url":"https://github.com/saumyasuhagiya","followers_url":"https://api.github.com/users/saumyasuhagiya/followers","following_url":"https://api.github.com/users/saumyasuhagiya/following{/other_user}","gists_url":"https://api.github.com/users/saumyasuhagiya/gists{/gist_id}","starred_url":"https://api.github.com/users/saumyasuhagiya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/saumyasuhagiya/subscriptions","organizations_url":"https://api.github.com/users/saumyasuhagiya/orgs","repos_url":"https://api.github.com/users/saumyasuhagiya/repos","events_url":"https://api.github.com/users/saumyasuhagiya/events{/privacy}","received_events_url":"https://api.github.com/users/saumyasuhagiya/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T10:35:20Z","updated_at":"2021-02-24T10:35:20Z","author_association":"NONE","body":"@nsivabalan Hi.. just wanted to check any update on this.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784979698/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784995946","html_url":"https://github.com/apache/hudi/pull/2600#issuecomment-784995946","issue_url":"https://api.github.com/repos/apache/hudi/issues/2600","id":784995946,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NDk5NTk0Ng==","user":{"login":"lamberken","id":20113411,"node_id":"MDQ6VXNlcjIwMTEzNDEx","avatar_url":"https://avatars.githubusercontent.com/u/20113411?v=4","gravatar_id":"","url":"https://api.github.com/users/lamberken","html_url":"https://github.com/lamberken","followers_url":"https://api.github.com/users/lamberken/followers","following_url":"https://api.github.com/users/lamberken/following{/other_user}","gists_url":"https://api.github.com/users/lamberken/gists{/gist_id}","starred_url":"https://api.github.com/users/lamberken/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lamberken/subscriptions","organizations_url":"https://api.github.com/users/lamberken/orgs","repos_url":"https://api.github.com/users/lamberken/repos","events_url":"https://api.github.com/users/lamberken/events{/privacy}","received_events_url":"https://api.github.com/users/lamberken/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T11:02:30Z","updated_at":"2021-02-24T11:02:30Z","author_association":"MEMBER","body":"Thanks for the patch!","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784995946/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784996851","html_url":"https://github.com/apache/hudi/pull/2600#issuecomment-784996851","issue_url":"https://api.github.com/repos/apache/hudi/issues/2600","id":784996851,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NDk5Njg1MQ==","user":{"login":"codecov-io","id":8655789,"node_id":"MDQ6VXNlcjg2NTU3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/8655789?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-io","html_url":"https://github.com/codecov-io","followers_url":"https://api.github.com/users/codecov-io/followers","following_url":"https://api.github.com/users/codecov-io/following{/other_user}","gists_url":"https://api.github.com/users/codecov-io/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-io/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-io/subscriptions","organizations_url":"https://api.github.com/users/codecov-io/orgs","repos_url":"https://api.github.com/users/codecov-io/repos","events_url":"https://api.github.com/users/codecov-io/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-io/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T11:03:59Z","updated_at":"2021-02-24T11:04:15Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2600?src=pr&el=h1) Report\n> Merging [#2600](https://codecov.io/gh/apache/hudi/pull/2600?src=pr&el=desc) (ee2c582) into [master](https://codecov.io/gh/apache/hudi/commit/77ba561a6bacbf9e7dc9c1582eb068f7ad800cd9?el=desc) (77ba561) will **increase** coverage by `0.03%`.\n> The diff coverage is `86.66%`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2600/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2)](https://codecov.io/gh/apache/hudi/pull/2600?src=pr&el=tree)\n\n```diff\n@@             Coverage Diff              @@\n##             master    #2600      +/-   ##\n============================================\n+ Coverage     51.17%   51.21%   +0.03%     \n- Complexity     3226     3229       +3     \n============================================\n  Files           438      438              \n  Lines         20089    20093       +4     \n  Branches       2068     2069       +1     \n============================================\n+ Hits          10281    10291      +10     \n+ Misses         8961     8954       -7     \n- Partials        847      848       +1     \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `36.87% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudiclient | `100.00% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudicommon | `51.35% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudiflink | `46.85% <86.66%> (+0.47%)` | `0.00 <2.00> (ø)` | |\n| hudihadoopmr | `33.16% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudisparkdatasource | `69.75% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudisync | `48.61% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| huditimelineservice | `66.49% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudiutilities | `69.46% <ø> (+0.10%)` | `0.00 <ø> (ø)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2600?src=pr&el=tree) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...udi/operator/partitioner/BucketAssignFunction.java](https://codecov.io/gh/apache/hudi/pull/2600/diff?src=pr&el=tree#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9vcGVyYXRvci9wYXJ0aXRpb25lci9CdWNrZXRBc3NpZ25GdW5jdGlvbi5qYXZh) | `84.78% <86.66%> (+5.23%)` | `21.00 <2.00> (+3.00)` | |\n| [...in/java/org/apache/hudi/utilities/UtilHelpers.java](https://codecov.io/gh/apache/hudi/pull/2600/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL1V0aWxIZWxwZXJzLmphdmE=) | `65.69% <0.00%> (+1.16%)` | `32.00% <0.00%> (ø%)` | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/784996851/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785036461","html_url":"https://github.com/apache/hudi/issues/2592#issuecomment-785036461","issue_url":"https://api.github.com/repos/apache/hudi/issues/2592","id":785036461,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTAzNjQ2MQ==","user":{"login":"codejoyan","id":48707638,"node_id":"MDQ6VXNlcjQ4NzA3NjM4","avatar_url":"https://avatars.githubusercontent.com/u/48707638?v=4","gravatar_id":"","url":"https://api.github.com/users/codejoyan","html_url":"https://github.com/codejoyan","followers_url":"https://api.github.com/users/codejoyan/followers","following_url":"https://api.github.com/users/codejoyan/following{/other_user}","gists_url":"https://api.github.com/users/codejoyan/gists{/gist_id}","starred_url":"https://api.github.com/users/codejoyan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codejoyan/subscriptions","organizations_url":"https://api.github.com/users/codejoyan/orgs","repos_url":"https://api.github.com/users/codejoyan/repos","events_url":"https://api.github.com/users/codejoyan/events{/privacy}","received_events_url":"https://api.github.com/users/codejoyan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T12:17:57Z","updated_at":"2021-02-24T14:35:37Z","author_association":"CONTRIBUTOR","body":"Sure @bvaradar . Below steps will help to reproduce. \r\n**Observation:** This is failing when the dataframe has specific datatypes decimal with precision. If it is other datatypes it succeeds\r\n\r\n**Environment Details:**\r\nSpark version in HDP - 2.3.0.2.6.5.279-2\r\nHudi: hudi-spark-bundle_2.11:0.7.0\r\n\r\n**Step-1:** Create dummy data\r\n\r\n```\r\n$ hdfs dfs -cat hdfs://XXXXXw00ha/user/joyan/test_data.csv\r\ncol_1,col_2,col_3,col_4,col_5,col_6,col_7,col_8,col_9,col_10,col_11,col_12,cntry_cd,bus_dt\r\n7IN00716079317820210109153408,716,3,AB,INR,107667253,0,1,2021-02-14 20:23:54.753,useridjsb91,2021-02-14 20:23:54.753,useridjsb91,IN,2021-02-01\r\n7IN00716079317820210109153408,716,2,AB,INR,212733302,0,1,2021-02-14 20:23:54.753,useridjsb91,2021-02-14 20:23:54.753,useridjsb91,IN,2021-02-01\r\n7IN00716079317820210109153408,716,1,AB,INR,139224013,0,1,2021-02-14 20:23:54.753,useridjsb91,2021-02-14 20:23:54.753,useridjsb91,IN,2021-02-01\r\nAU700716079381819643325112243,5700,5,AB,INR,136158881,0,1,2021-02-14 20:06:38.718,useridjsb91,2021-02-14 20:06:38.718,useridjsb91,IN,2021-02-02\r\nAU700716079381819643325112243,5700,6,AB,INR,585710940,4,1.97,2021-02-14 20:06:38.718,useridjsb91,2021-02-14 20:06:38.718,useridjsb91,IN,2021-02-02\r\nAU700716079381819643325112243,5700,4,AB,INR,136158881,0,1,2021-02-14 20:06:38.718,useridjsb91,2021-02-14 20:06:38.718,useridjsb91,AU,2021-02-01\r\nAU700716079381819643325112243,5700,3,AB,INR,136158881,0,1,2021-02-14 20:06:38.718,useridjsb91,2021-02-14 20:06:38.718,useridjsb91,AU,2021-02-01\r\nAU700716079381819643325112243,5700,1,AB,INR,136158881,0,1,2021-02-14 20:06:38.718,useridjsb91,2021-02-14 20:06:38.718,useridjsb91,AU,2021-02-01\r\n```\r\n\r\n**Step-2:** Try to read the data from file, cast to appropriate datatypes and save as Hudi table\r\n```\r\n$ spark-shell \\\r\n--packages org.apache.hudi:hudi-spark-bundle_2.11:0.7.0,org.apache.spark:spark-avro_2.11:2.4.4,org.apache.avro:avro:1.8.2 \\\r\n--conf spark.driver.extraClassPath=/path/org.apache.avro_avro-1.8.2.jar \\\r\n--conf spark.executor.extraClassPath=/path/org.apache.avro_avro-1.8.2.jar \\\r\n--conf \"spark.sql.hive.convertMetastoreParquet=false\" \\\r\n--conf 'spark.serializer=org.apache.spark.serializer.KryoSerializer'\r\n\r\nimport org.apache.hudi.DataSourceWriteOptions\r\nimport org.apache.hudi.QuickstartUtils.getQuickstartWriteConfigs\r\nimport org.apache.hudi.config.{HoodieCompactionConfig, HoodieStorageConfig, HoodieWriteConfig}\r\nimport org.apache.spark.sql.{SaveMode, SparkSession}\r\nimport org.apache.spark.sql.functions.{col, concat, lit}\r\n\r\nval inputDF = spark.read.format(\"csv\").option(\"header\", \"true\").load(\"hdfs://XXXXXw00ha/user/joyan/test_data.csv\")\r\n\r\nval formattedDF = inputDF.selectExpr(\"col_1\", \"cast(col_2 as integer) col_2\",\r\n\t\"cast(col_3 as short) col_3\", \"col_4\", \"col_5\", \"cast(col_6 as byte) col_6\", \"cast(col_7 as decimal(9,2)) col_7\",\r\n\t\"cast(col_8 as decimal(9,2)) col_8\", \"cast(col_9 as timestamp) col_9\", \"col_10\", \"cast(col_11 as timestamp) col_11\",\r\n\t\"col_12\", \"cntry_cd\", \"cast(bus_dt as date) bus_dt\")\r\n\r\nformattedDF.printSchema\r\nroot\r\n |-- col_1: string (nullable = true)\r\n |-- col_2: integer (nullable = true)\r\n |-- col_3: short (nullable = true)\r\n |-- col_4: string (nullable = true)\r\n |-- col_5: string (nullable = true)\r\n |-- col_6: byte (nullable = true)\r\n |-- col_7: decimal(9,2) (nullable = true)\r\n |-- col_8: decimal(9,2) (nullable = true)\r\n |-- col_9: timestamp (nullable = true)\r\n |-- col_10: string (nullable = true)\r\n |-- col_11: timestamp (nullable = true)\r\n |-- col_12: string (nullable = true)\r\n |-- cntry_cd: string (nullable = true)\r\n |-- bus_dt: date (nullable = true)\r\n\r\n\r\nformattedDF.show\r\n+--------------------+-----+-----+-----+-----+-----+--------------------+-----------+--------------------+-----------+--------+----------+\r\n|               col_1|col_2|col_3|col_4|col_5|col_6|               col_9|     col_10|              col_11|     col_12|cntry_cd|    bus_dt|\r\n+--------------------+-----+-----+-----+-----+-----+--------------------+-----------+--------------------+-----------+--------+----------+\r\n|7IN00716079317820...|  716|    3|   AB|  INR| null|2021-02-14 20:23:...|useridjsb91|2021-02-14 20:23:...|useridjsb91|      IN|2021-02-01|\r\n|7IN00716079317820...|  716|    2|   AB|  INR| null|2021-02-14 20:23:...|useridjsb91|2021-02-14 20:23:...|useridjsb91|      IN|2021-02-01|\r\n|7IN00716079317820...|  716|    1|   AB|  INR| null|2021-02-14 20:23:...|useridjsb91|2021-02-14 20:23:...|useridjsb91|      IN|2021-02-01|\r\n|AU700716079381819...| 5700|    5|   AB|  INR| null|2021-02-14 20:06:...|useridjsb91|2021-02-14 20:06:...|useridjsb91|      IN|2021-02-02|\r\n|AU700716079381819...| 5700|    6|   AB|  INR| null|2021-02-14 20:06:...|useridjsb91|2021-02-14 20:06:...|useridjsb91|      IN|2021-02-02|\r\n|AU700716079381819...| 5700|    4|   AB|  INR| null|2021-02-14 20:06:...|useridjsb91|2021-02-14 20:06:...|useridjsb91|      AU|2021-02-01|\r\n|AU700716079381819...| 5700|    3|   AB|  INR| null|2021-02-14 20:06:...|useridjsb91|2021-02-14 20:06:...|useridjsb91|      AU|2021-02-01|\r\n|AU700716079381819...| 5700|    1|   AB|  INR| null|2021-02-14 20:06:...|useridjsb91|2021-02-14 20:06:...|useridjsb91|      AU|2021-02-01|\r\n+--------------------+-----+-----+-----+-----+-----+--------------------+-----------+--------------------+-----------+--------+----------+\r\n\r\nval transformedDF = formattedDF.withColumn(\"partitionpath\", concat(lit(\"cntry_cd=\"), col(\"cntry_cd\"), lit(\"/bus_dt=\"), col(\"bus_dt\")))\r\n\r\nval targetPath = \"gs://XXXXXXXXXXX7bb3d68/test_table_tgt\"\r\n\r\ntransformedDF.write.format(\"org.apache.hudi\").\r\noptions(getQuickstartWriteConfigs).\r\noption(DataSourceWriteOptions.PRECOMBINE_FIELD_OPT_KEY, \"col_9\").\r\noption(DataSourceWriteOptions.RECORDKEY_FIELD_OPT_KEY, \"col_2,col_1,col_3\").\r\noption(DataSourceWriteOptions.PARTITIONPATH_FIELD_OPT_KEY, \"partitionpath\").\r\noption(DataSourceWriteOptions.KEYGENERATOR_CLASS_OPT_KEY, \"org.apache.hudi.keygen.ComplexKeyGenerator\").\r\noption(\"hoodie.upsert.shuffle.parallelism\",\"2\").\r\noption(\"hoodie.insert.shuffle.parallelism\",\"2\").\r\noption(HoodieWriteConfig.TABLE_NAME, \"targetTableHudi\").\r\nmode(SaveMode.Append).\r\nsave(targetPath)\r\n\r\njava.lang.NoSuchMethodError: org.apache.spark.sql.types.Decimal$.minBytesForPrecision()[I\r\n  at org.apache.hudi.spark.org.apache.spark.sql.avro.SchemaConverters$.toAvroType(SchemaConverters.scala:156)\r\n  at org.apache.hudi.spark.org.apache.spark.sql.avro.SchemaConverters$$anonfun$5.apply(SchemaConverters.scala:176)\r\n  at org.apache.hudi.spark.org.apache.spark.sql.avro.SchemaConverters$$anonfun$5.apply(SchemaConverters.scala:174)\r\n  at scala.collection.Iterator$class.foreach(Iterator.scala:893)\r\n  at scala.collection.AbstractIterator.foreach(Iterator.scala:1336)\r\n  at scala.collection.IterableLike$class.foreach(IterableLike.scala:72)\r\n  at org.apache.spark.sql.types.StructType.foreach(StructType.scala:99)\r\n  at org.apache.hudi.spark.org.apache.spark.sql.avro.SchemaConverters$.toAvroType(SchemaConverters.scala:174)\r\n  at org.apache.hudi.AvroConversionUtils$.convertStructTypeToAvroSchema(AvroConversionUtils.scala:52)\r\n  at org.apache.hudi.HoodieSparkSqlWriter$.write(HoodieSparkSqlWriter.scala:139)\r\n  at org.apache.hudi.DefaultSource.createRelation(DefaultSource.scala:134)\r\n  at org.apache.spark.sql.execution.datasources.SaveIntoDataSourceCommand.run(SaveIntoDataSourceCommand.scala:46)\r\n  at org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult$lzycompute(commands.scala:70)\r\n  at org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult(commands.scala:68)\r\n  at org.apache.spark.sql.execution.command.ExecutedCommandExec.doExecute(commands.scala:86)\r\n  at org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:131)\r\n  at org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:127)\r\n  at org.apache.spark.sql.execution.SparkPlan$$anonfun$executeQuery$1.apply(SparkPlan.scala:155)\r\n  at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\r\n  at org.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:152)\r\n  at org.apache.spark.sql.execution.SparkPlan.execute(SparkPlan.scala:127)\r\n  at org.apache.spark.sql.execution.QueryExecution.toRdd$lzycompute(QueryExecution.scala:80)\r\n  at org.apache.spark.sql.execution.QueryExecution.toRdd(QueryExecution.scala:80)\r\n  at org.apache.spark.sql.DataFrameWriter$$anonfun$runCommand$1.apply(DataFrameWriter.scala:654)\r\n  at org.apache.spark.sql.DataFrameWriter$$anonfun$runCommand$1.apply(DataFrameWriter.scala:654)\r\n  at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:77)\r\n  at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:654)\r\n  at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:273)\r\n  at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:267)\r\n  at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:225)\r\n  ... 59 elided\r\n```","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785036461/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785121095","html_url":"https://github.com/apache/hudi/issues/2592#issuecomment-785121095","issue_url":"https://api.github.com/repos/apache/hudi/issues/2592","id":785121095,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTEyMTA5NQ==","user":{"login":"codejoyan","id":48707638,"node_id":"MDQ6VXNlcjQ4NzA3NjM4","avatar_url":"https://avatars.githubusercontent.com/u/48707638?v=4","gravatar_id":"","url":"https://api.github.com/users/codejoyan","html_url":"https://github.com/codejoyan","followers_url":"https://api.github.com/users/codejoyan/followers","following_url":"https://api.github.com/users/codejoyan/following{/other_user}","gists_url":"https://api.github.com/users/codejoyan/gists{/gist_id}","starred_url":"https://api.github.com/users/codejoyan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codejoyan/subscriptions","organizations_url":"https://api.github.com/users/codejoyan/orgs","repos_url":"https://api.github.com/users/codejoyan/repos","events_url":"https://api.github.com/users/codejoyan/events{/privacy}","received_events_url":"https://api.github.com/users/codejoyan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T14:38:57Z","updated_at":"2021-02-24T14:39:29Z","author_association":"CONTRIBUTOR","body":"The below succeeds. I removed the decimal fields only and was able to save\r\n\r\n```\r\nscala> val inputDF = spark.read.format(\"csv\").option(\"header\", \"true\").load(\"hdfs://XXXXXhw00ha/user/joyan/test_data.csv\")\r\ninputDF: org.apache.spark.sql.DataFrame = [col_1: string, col_2: string ... 12 more fields]\r\n\r\nscala> val formattedDF = inputDF.selectExpr(\"col_1\", \"cast(col_2 as integer) col_2\",\r\n     | \"cast(col_3 as short) col_3\", \"col_4\", \"col_5\", \"cast(col_6 as byte) col_6\",\r\n     | \"cast(col_9 as timestamp) col_9\", \"col_10\", \"cast(col_11 as timestamp) col_11\",\r\n     | \"col_12\", \"cntry_cd\", \"cast(bus_dt as date) bus_dt\")\r\nformattedDF: org.apache.spark.sql.DataFrame = [col_1: string, col_2: int ... 10 more fields]\r\n\r\nscala> val transformedDF = formattedDF.withColumn(\"partitionpath\", concat(lit(\"cntry_cd=\"), col(\"cntry_cd\"), lit(\"/bus_dt=\"), col(\"bus_dt\")))\r\ntransformedDF: org.apache.spark.sql.DataFrame = [col_1: string, col_2: int ... 11 more fields]\r\n\r\nscala> transformedDF.show\r\n+--------------------+-----+-----+-----+-----+-----+--------------------+-----------+--------------------+-----------+--------+----------+--------------------+\r\n|               col_1|col_2|col_3|col_4|col_5|col_6|               col_9|     col_10|              col_11|     col_12|cntry_cd|    bus_dt|       partitionpath|\r\n+--------------------+-----+-----+-----+-----+-----+--------------------+-----------+--------------------+-----------+--------+----------+--------------------+\r\n|7IN00716079317820...|  716|    3|   AB|  INR| null|2021-02-14 20:23:...|useridjsb91|2021-02-14 20:23:...|useridjsb91|      IN|2021-02-01|cntry_cd=IN/bus_d...|\r\n|7IN00716079317820...|  716|    2|   AB|  INR| null|2021-02-14 20:23:...|useridjsb91|2021-02-14 20:23:...|useridjsb91|      IN|2021-02-01|cntry_cd=IN/bus_d...|\r\n|7IN00716079317820...|  716|    1|   AB|  INR| null|2021-02-14 20:23:...|useridjsb91|2021-02-14 20:23:...|useridjsb91|      IN|2021-02-01|cntry_cd=IN/bus_d...|\r\n|AU700716079381819...| 5700|    5|   AB|  INR| null|2021-02-14 20:06:...|useridjsb91|2021-02-14 20:06:...|useridjsb91|      IN|2021-02-02|cntry_cd=IN/bus_d...|\r\n|AU700716079381819...| 5700|    6|   AB|  INR| null|2021-02-14 20:06:...|useridjsb91|2021-02-14 20:06:...|useridjsb91|      IN|2021-02-02|cntry_cd=IN/bus_d...|\r\n|AU700716079381819...| 5700|    4|   AB|  INR| null|2021-02-14 20:06:...|useridjsb91|2021-02-14 20:06:...|useridjsb91|      AU|2021-02-01|cntry_cd=AU/bus_d...|\r\n|AU700716079381819...| 5700|    3|   AB|  INR| null|2021-02-14 20:06:...|useridjsb91|2021-02-14 20:06:...|useridjsb91|      AU|2021-02-01|cntry_cd=AU/bus_d...|\r\n|AU700716079381819...| 5700|    1|   AB|  INR| null|2021-02-14 20:06:...|useridjsb91|2021-02-14 20:06:...|useridjsb91|      AU|2021-02-01|cntry_cd=AU/bus_d...|\r\n+--------------------+-----+-----+-----+-----+-----+--------------------+-----------+--------------------+-----------+--------+----------+--------------------+\r\n\r\n\r\nscala> transformedDF.write.format(\"org.apache.hudi\").\r\n     | options(getQuickstartWriteConfigs).\r\n     | option(DataSourceWriteOptions.PRECOMBINE_FIELD_OPT_KEY, \"col_9\").\r\n     | option(DataSourceWriteOptions.RECORDKEY_FIELD_OPT_KEY, \"col_2,col_1,col_3\").\r\n     | option(DataSourceWriteOptions.PARTITIONPATH_FIELD_OPT_KEY, \"partitionpath\").\r\n     | option(DataSourceWriteOptions.KEYGENERATOR_CLASS_OPT_KEY, \"org.apache.hudi.keygen.ComplexKeyGenerator\").\r\n     | option(\"hoodie.upsert.shuffle.parallelism\",\"2\").\r\n     | option(\"hoodie.insert.shuffle.parallelism\",\"2\").\r\n     | option(HoodieWriteConfig.TABLE_NAME, \"targetTableHudi\").\r\n     | mode(SaveMode.Append).\r\n     | save(targetPath)\r\n                                                                                \r\nscala> formattedDF.printSchema\r\nroot\r\n |-- col_1: string (nullable = true)\r\n |-- col_2: integer (nullable = true)\r\n |-- col_3: short (nullable = true)\r\n |-- col_4: string (nullable = true)\r\n |-- col_5: string (nullable = true)\r\n |-- col_6: byte (nullable = true)\r\n |-- col_9: timestamp (nullable = true)\r\n |-- col_10: string (nullable = true)\r\n |-- col_11: timestamp (nullable = true)\r\n |-- col_12: string (nullable = true)\r\n |-- cntry_cd: string (nullable = true)\r\n |-- bus_dt: date (nullable = true)\r\n\r\n\r\nscala> formattedDF.show\r\n+--------------------+-----+-----+-----+-----+-----+--------------------+-----------+--------------------+-----------+--------+----------+\r\n|               col_1|col_2|col_3|col_4|col_5|col_6|               col_9|     col_10|              col_11|     col_12|cntry_cd|    bus_dt|\r\n+--------------------+-----+-----+-----+-----+-----+--------------------+-----------+--------------------+-----------+--------+----------+\r\n|7IN00716079317820...|  716|    3|   AB|  INR| null|2021-02-14 20:23:...|useridjsb91|2021-02-14 20:23:...|useridjsb91|      IN|2021-02-01|\r\n|7IN00716079317820...|  716|    2|   AB|  INR| null|2021-02-14 20:23:...|useridjsb91|2021-02-14 20:23:...|useridjsb91|      IN|2021-02-01|\r\n|7IN00716079317820...|  716|    1|   AB|  INR| null|2021-02-14 20:23:...|useridjsb91|2021-02-14 20:23:...|useridjsb91|      IN|2021-02-01|\r\n|AU700716079381819...| 5700|    5|   AB|  INR| null|2021-02-14 20:06:...|useridjsb91|2021-02-14 20:06:...|useridjsb91|      IN|2021-02-02|\r\n|AU700716079381819...| 5700|    6|   AB|  INR| null|2021-02-14 20:06:...|useridjsb91|2021-02-14 20:06:...|useridjsb91|      IN|2021-02-02|\r\n|AU700716079381819...| 5700|    4|   AB|  INR| null|2021-02-14 20:06:...|useridjsb91|2021-02-14 20:06:...|useridjsb91|      AU|2021-02-01|\r\n|AU700716079381819...| 5700|    3|   AB|  INR| null|2021-02-14 20:06:...|useridjsb91|2021-02-14 20:06:...|useridjsb91|      AU|2021-02-01|\r\n|AU700716079381819...| 5700|    1|   AB|  INR| null|2021-02-14 20:06:...|useridjsb91|2021-02-14 20:06:...|useridjsb91|      AU|2021-02-01|\r\n+--------------------+-----+-----+-----+-----+-----+--------------------+-----------+--------------------+-----------+--------+----------+\r\n\r\n\r\nscala> val testSnapshotDF = spark.read.format(\"org.apache.hudi\").\r\n     | load(targetPath + \"/*/*/*\")\r\n21/02/24 14:36:27 WARN DefaultSource: Loading Base File Only View.\r\ntestSnapshotDF: org.apache.spark.sql.DataFrame = [_hoodie_commit_time: string, _hoodie_commit_seqno: string ... 16 more fields]\r\n\r\nscala> testSnapshotDF.createOrReplaceTempView(\"test_hudi_ro\")\r\n\r\nscala> spark.sql(\"select cntry_cd,bus_dt,count(1) from test_hudi_ro group by cntry_cd,bus_dt\").show\r\n+--------+----------+--------+\r\n|cntry_cd|    bus_dt|count(1)|\r\n+--------+----------+--------+\r\n|      IN|2021-02-01|       3|\r\n|      AU|2021-02-01|       3|\r\n|      IN|2021-02-02|       2|\r\n+--------+----------+--------+\r\n```","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785121095/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785124651","html_url":"https://github.com/apache/hudi/issues/2399#issuecomment-785124651","issue_url":"https://api.github.com/repos/apache/hudi/issues/2399","id":785124651,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTEyNDY1MQ==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T14:44:11Z","updated_at":"2021-02-24T14:44:11Z","author_association":"CONTRIBUTOR","body":"@afeldman1 : do you mind responding to this ticket when you can. Feel free to close it out if you were able to fix it.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785124651/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785128911","html_url":"https://github.com/apache/hudi/issues/2586#issuecomment-785128911","issue_url":"https://api.github.com/repos/apache/hudi/issues/2586","id":785128911,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTEyODkxMQ==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T14:50:21Z","updated_at":"2021-02-24T14:50:21Z","author_association":"CONTRIBUTOR","body":"@bvaradar @n3nash : let me take a stab. let me know if my understanding is right. \r\ncustomers sets file versions retained to 1. \r\nSo, if there are two writes by the time a single lengthy query completes, we could encounter this situation where in the query could throw FileNotFoundException as 2nd write would have deleted the 1st file version for all data files? \r\n\r\n@Rap70r : in the mean time, do you want to set file versions retained to be 1 necessarily? if not, can you try setting it to 3 and let us know if you could still reproduce the issue. \r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785128911/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785204336","html_url":"https://github.com/apache/hudi/issues/2586#issuecomment-785204336","issue_url":"https://api.github.com/repos/apache/hudi/issues/2586","id":785204336,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTIwNDMzNg==","user":{"login":"Rap70r","id":22181358,"node_id":"MDQ6VXNlcjIyMTgxMzU4","avatar_url":"https://avatars.githubusercontent.com/u/22181358?v=4","gravatar_id":"","url":"https://api.github.com/users/Rap70r","html_url":"https://github.com/Rap70r","followers_url":"https://api.github.com/users/Rap70r/followers","following_url":"https://api.github.com/users/Rap70r/following{/other_user}","gists_url":"https://api.github.com/users/Rap70r/gists{/gist_id}","starred_url":"https://api.github.com/users/Rap70r/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Rap70r/subscriptions","organizations_url":"https://api.github.com/users/Rap70r/orgs","repos_url":"https://api.github.com/users/Rap70r/repos","events_url":"https://api.github.com/users/Rap70r/events{/privacy}","received_events_url":"https://api.github.com/users/Rap70r/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T16:34:53Z","updated_at":"2021-02-24T16:34:53Z","author_association":"NONE","body":"Hi nsivabalan,\r\n\r\nI could try setting retention version to a higher number but the thing is we do apply incremental updates very frequently in short intervals. Like every several minutes. A reading process could be running for more than an hour. Enough time for Hudi to update several times. So that might not solve the issue entirely for long running queries.\r\nIs there a different approach we could look into? Like any caching mechanism?\r\n\r\nThank you","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785204336/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785274437","html_url":"https://github.com/apache/hudi/issues/2498#issuecomment-785274437","issue_url":"https://api.github.com/repos/apache/hudi/issues/2498","id":785274437,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTI3NDQzNw==","user":{"login":"green2k","id":6991578,"node_id":"MDQ6VXNlcjY5OTE1Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/6991578?v=4","gravatar_id":"","url":"https://api.github.com/users/green2k","html_url":"https://github.com/green2k","followers_url":"https://api.github.com/users/green2k/followers","following_url":"https://api.github.com/users/green2k/following{/other_user}","gists_url":"https://api.github.com/users/green2k/gists{/gist_id}","starred_url":"https://api.github.com/users/green2k/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/green2k/subscriptions","organizations_url":"https://api.github.com/users/green2k/orgs","repos_url":"https://api.github.com/users/green2k/repos","events_url":"https://api.github.com/users/green2k/events{/privacy}","received_events_url":"https://api.github.com/users/green2k/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T18:17:11Z","updated_at":"2021-02-24T18:17:11Z","author_association":"NONE","body":"There's exactly the same problem with Spark hosted on Databricks","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785274437/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785280880","html_url":"https://github.com/apache/hudi/pull/2590#issuecomment-785280880","issue_url":"https://api.github.com/repos/apache/hudi/issues/2590","id":785280880,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTI4MDg4MA==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T18:27:21Z","updated_at":"2021-02-24T18:27:21Z","author_association":"MEMBER","body":"cc @umehrot2 ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785280880/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785301048","html_url":"https://github.com/apache/hudi/pull/2532#issuecomment-785301048","issue_url":"https://api.github.com/repos/apache/hudi/issues/2532","id":785301048,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTMwMTA0OA==","user":{"login":"satishkotha","id":2992755,"node_id":"MDQ6VXNlcjI5OTI3NTU=","avatar_url":"https://avatars.githubusercontent.com/u/2992755?v=4","gravatar_id":"","url":"https://api.github.com/users/satishkotha","html_url":"https://github.com/satishkotha","followers_url":"https://api.github.com/users/satishkotha/followers","following_url":"https://api.github.com/users/satishkotha/following{/other_user}","gists_url":"https://api.github.com/users/satishkotha/gists{/gist_id}","starred_url":"https://api.github.com/users/satishkotha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/satishkotha/subscriptions","organizations_url":"https://api.github.com/users/satishkotha/orgs","repos_url":"https://api.github.com/users/satishkotha/repos","events_url":"https://api.github.com/users/satishkotha/events{/privacy}","received_events_url":"https://api.github.com/users/satishkotha/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T18:59:02Z","updated_at":"2021-02-24T18:59:02Z","author_association":"MEMBER","body":"> Hello People,\r\n> \r\n> Is this PR could help in my problem?\r\n> \r\n> #2588\r\n> \r\n> @satishkotha @lhjzmn\r\n\r\n@rubenssoto I dont think so. This PR is removing jdbc support to connect to Hive. Hudi already supports a way to disable jdbc (See https://hudi.apache.org/docs/configurations.html#HIVE_USE_JDBC_OPT_KEY). I dont know how you are connecting, if your hive version, supports thrift metastore interface, you can try disabling jdbc and see if that helps.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785301048/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785308206","html_url":"https://github.com/apache/hudi/pull/2598#issuecomment-785308206","issue_url":"https://api.github.com/repos/apache/hudi/issues/2598","id":785308206,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTMwODIwNg==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T19:11:01Z","updated_at":"2021-02-24T19:11:01Z","author_association":"MEMBER","body":"@vburenin thanks for this. can we create a JIRA for this?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785308206/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785308824","html_url":"https://github.com/apache/hudi/pull/2598#issuecomment-785308824","issue_url":"https://api.github.com/repos/apache/hudi/issues/2598","id":785308824,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTMwODgyNA==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T19:12:11Z","updated_at":"2021-02-24T19:12:11Z","author_association":"MEMBER","body":"the goals here all look good to me. Please give me and @nsivabalan sometime to review","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785308824/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785309398","html_url":"https://github.com/apache/hudi/pull/2598#issuecomment-785309398","issue_url":"https://api.github.com/repos/apache/hudi/issues/2598","id":785309398,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTMwOTM5OA==","user":{"login":"vburenin","id":4350891,"node_id":"MDQ6VXNlcjQzNTA4OTE=","avatar_url":"https://avatars.githubusercontent.com/u/4350891?v=4","gravatar_id":"","url":"https://api.github.com/users/vburenin","html_url":"https://github.com/vburenin","followers_url":"https://api.github.com/users/vburenin/followers","following_url":"https://api.github.com/users/vburenin/following{/other_user}","gists_url":"https://api.github.com/users/vburenin/gists{/gist_id}","starred_url":"https://api.github.com/users/vburenin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vburenin/subscriptions","organizations_url":"https://api.github.com/users/vburenin/orgs","repos_url":"https://api.github.com/users/vburenin/repos","events_url":"https://api.github.com/users/vburenin/events{/privacy}","received_events_url":"https://api.github.com/users/vburenin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T19:13:10Z","updated_at":"2021-02-24T19:13:10Z","author_association":"CONTRIBUTOR","body":"> @vburenin thanks for this. can we create a JIRA for this?\r\n\r\nIt is in process, I may need to create multiple tickets. What I am really interested in right now is a code review so I do not spent too much time going forward and writing unit tests and then endup rolling it back.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785309398/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785341004","html_url":"https://github.com/apache/hudi/pull/2601#issuecomment-785341004","issue_url":"https://api.github.com/repos/apache/hudi/issues/2601","id":785341004,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTM0MTAwNA==","user":{"login":"codecov-io","id":8655789,"node_id":"MDQ6VXNlcjg2NTU3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/8655789?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-io","html_url":"https://github.com/codecov-io","followers_url":"https://api.github.com/users/codecov-io/followers","following_url":"https://api.github.com/users/codecov-io/following{/other_user}","gists_url":"https://api.github.com/users/codecov-io/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-io/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-io/subscriptions","organizations_url":"https://api.github.com/users/codecov-io/orgs","repos_url":"https://api.github.com/users/codecov-io/repos","events_url":"https://api.github.com/users/codecov-io/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-io/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T20:09:01Z","updated_at":"2021-02-24T20:09:01Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2601?src=pr&el=h1) Report\n> Merging [#2601](https://codecov.io/gh/apache/hudi/pull/2601?src=pr&el=desc) (0e6d6b0) into [master](https://codecov.io/gh/apache/hudi/commit/77ba561a6bacbf9e7dc9c1582eb068f7ad800cd9?el=desc) (77ba561) will **decrease** coverage by `41.48%`.\n> The diff coverage is `n/a`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2601/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2)](https://codecov.io/gh/apache/hudi/pull/2601?src=pr&el=tree)\n\n```diff\n@@             Coverage Diff              @@\n##             master   #2601       +/-   ##\n============================================\n- Coverage     51.17%   9.69%   -41.49%     \n+ Complexity     3226      48     -3178     \n============================================\n  Files           438      53      -385     \n  Lines         20089    1929    -18160     \n  Branches       2068     230     -1838     \n============================================\n- Hits          10281     187    -10094     \n+ Misses         8961    1729     -7232     \n+ Partials        847      13      -834     \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `?` | `?` | |\n| hudiclient | `100.00% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudicommon | `?` | `?` | |\n| hudiflink | `?` | `?` | |\n| hudihadoopmr | `?` | `?` | |\n| hudisparkdatasource | `?` | `?` | |\n| hudisync | `?` | `?` | |\n| huditimelineservice | `?` | `?` | |\n| hudiutilities | `9.69% <ø> (-59.67%)` | `0.00 <ø> (ø)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2601?src=pr&el=tree) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...va/org/apache/hudi/utilities/IdentitySplitter.java](https://codecov.io/gh/apache/hudi/pull/2601/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL0lkZW50aXR5U3BsaXR0ZXIuamF2YQ==) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-2.00%)` | |\n| [...va/org/apache/hudi/utilities/schema/SchemaSet.java](https://codecov.io/gh/apache/hudi/pull/2601/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NjaGVtYS9TY2hlbWFTZXQuamF2YQ==) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-3.00%)` | |\n| [...a/org/apache/hudi/utilities/sources/RowSource.java](https://codecov.io/gh/apache/hudi/pull/2601/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvUm93U291cmNlLmphdmE=) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-4.00%)` | |\n| [.../org/apache/hudi/utilities/sources/AvroSource.java](https://codecov.io/gh/apache/hudi/pull/2601/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvQXZyb1NvdXJjZS5qYXZh) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-1.00%)` | |\n| [.../org/apache/hudi/utilities/sources/JsonSource.java](https://codecov.io/gh/apache/hudi/pull/2601/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvSnNvblNvdXJjZS5qYXZh) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-1.00%)` | |\n| [...rg/apache/hudi/utilities/sources/CsvDFSSource.java](https://codecov.io/gh/apache/hudi/pull/2601/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvQ3N2REZTU291cmNlLmphdmE=) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-10.00%)` | |\n| [...g/apache/hudi/utilities/sources/JsonDFSSource.java](https://codecov.io/gh/apache/hudi/pull/2601/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvSnNvbkRGU1NvdXJjZS5qYXZh) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-4.00%)` | |\n| [...apache/hudi/utilities/sources/JsonKafkaSource.java](https://codecov.io/gh/apache/hudi/pull/2601/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvSnNvbkthZmthU291cmNlLmphdmE=) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-6.00%)` | |\n| [...pache/hudi/utilities/sources/ParquetDFSSource.java](https://codecov.io/gh/apache/hudi/pull/2601/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvUGFycXVldERGU1NvdXJjZS5qYXZh) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-5.00%)` | |\n| [...lities/schema/SchemaProviderWithPostProcessor.java](https://codecov.io/gh/apache/hudi/pull/2601/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NjaGVtYS9TY2hlbWFQcm92aWRlcldpdGhQb3N0UHJvY2Vzc29yLmphdmE=) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-4.00%)` | |\n| ... and [415 more](https://codecov.io/gh/apache/hudi/pull/2601/diff?src=pr&el=tree-more) | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785341004/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785350882","html_url":"https://github.com/apache/hudi/issues/1679#issuecomment-785350882","issue_url":"https://api.github.com/repos/apache/hudi/issues/1679","id":785350882,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTM1MDg4Mg==","user":{"login":"rubenssoto","id":36298331,"node_id":"MDQ6VXNlcjM2Mjk4MzMx","avatar_url":"https://avatars.githubusercontent.com/u/36298331?v=4","gravatar_id":"","url":"https://api.github.com/users/rubenssoto","html_url":"https://github.com/rubenssoto","followers_url":"https://api.github.com/users/rubenssoto/followers","following_url":"https://api.github.com/users/rubenssoto/following{/other_user}","gists_url":"https://api.github.com/users/rubenssoto/gists{/gist_id}","starred_url":"https://api.github.com/users/rubenssoto/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rubenssoto/subscriptions","organizations_url":"https://api.github.com/users/rubenssoto/orgs","repos_url":"https://api.github.com/users/rubenssoto/repos","events_url":"https://api.github.com/users/rubenssoto/events{/privacy}","received_events_url":"https://api.github.com/users/rubenssoto/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T20:24:15Z","updated_at":"2021-02-24T20:24:15Z","author_association":"NONE","body":"@nsivabalan I had a different error\r\nHudi 0.7.0\r\nEmr 6.2\r\n\r\n`Exception in thread \"ForkJoinPool-1-worker-13\" java.lang.NoClassDefFoundError: org/apache/calcite/rel/type/RelDataTypeSystem\r\n\tat org.apache.hadoop.hive.ql.parse.SemanticAnalyzerFactory.get(SemanticAnalyzerFactory.java:318)\r\n\tat org.apache.hadoop.hive.ql.Driver.compile(Driver.java:484)\r\n\tat org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:1317)\r\n\tat org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:1457)\r\n\tat org.apache.hadoop.hive.ql.Driver.run(Driver.java:1237)\r\n\tat org.apache.hadoop.hive.ql.Driver.run(Driver.java:1227)\r\n\tat org.apache.hudi.hive.HoodieHiveClient.updateHiveSQLs(HoodieHiveClient.java:401)\r\n\tat org.apache.hudi.hive.HoodieHiveClient.updateHiveSQLUsingHiveDriver(HoodieHiveClient.java:384)\r\n\tat org.apache.hudi.hive.HoodieHiveClient.updateHiveSQL(HoodieHiveClient.java:374)\r\n\tat org.apache.hudi.hive.HoodieHiveClient.createTable(HoodieHiveClient.java:263)\r\n\tat org.apache.hudi.hive.HiveSyncTool.syncSchema(HiveSyncTool.java:181)\r\n\tat org.apache.hudi.hive.HiveSyncTool.syncHoodieTable(HiveSyncTool.java:136)\r\n\tat org.apache.hudi.hive.HiveSyncTool.syncHoodieTable(HiveSyncTool.java:94)\r\n\tat org.apache.hudi.HoodieSparkSqlWriter$.syncHive(HoodieSparkSqlWriter.scala:355)\r\n\tat org.apache.hudi.HoodieSparkSqlWriter$.$anonfun$metaSync$4(HoodieSparkSqlWriter.scala:403)\r\n\tat org.apache.hudi.HoodieSparkSqlWriter$.$anonfun$metaSync$4$adapted(HoodieSparkSqlWriter.scala:399)\r\n\tat scala.collection.mutable.HashSet.foreach(HashSet.scala:79)\r\n\tat org.apache.hudi.HoodieSparkSqlWriter$.metaSync(HoodieSparkSqlWriter.scala:399)\r\n\tat org.apache.hudi.HoodieSparkSqlWriter$.commitAndPerformPostOperations(HoodieSparkSqlWriter.scala:460)\r\n\tat org.apache.hudi.HoodieSparkSqlWriter$.write(HoodieSparkSqlWriter.scala:218)\r\n\tat org.apache.hudi.DefaultSource.createRelation(DefaultSource.scala:134)\r\n\tat org.apache.spark.sql.execution.datasources.SaveIntoDataSourceCommand.run(SaveIntoDataSourceCommand.scala:46)\r\n\tat org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult$lzycompute(commands.scala:70)\r\n\tat org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult(commands.scala:68)\r\n\tat org.apache.spark.sql.execution.command.ExecutedCommandExec.doExecute(commands.scala:90)\r\n\tat org.apache.spark.sql.execution.SparkPlan.$anonfun$execute$1(SparkPlan.scala:180)\r\n\tat org.apache.spark.sql.execution.SparkPlan.$anonfun$executeQuery$1(SparkPlan.scala:218)\r\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\r\n\tat org.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:215)\r\n\tat org.apache.spark.sql.execution.SparkPlan.execute(SparkPlan.scala:176)\r\n\tat org.apache.spark.sql.execution.QueryExecution.toRdd$lzycompute(QueryExecution.scala:124)\r\n\tat org.apache.spark.sql.execution.QueryExecution.toRdd(QueryExecution.scala:123)\r\n\tat org.apache.spark.sql.DataFrameWriter.$anonfun$runCommand$1(DataFrameWriter.scala:963)\r\n\tat org.apache.spark.sql.catalyst.QueryPlanningTracker$.withTracker(QueryPlanningTracker.scala:104)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.withTracker(SQLExecution.scala:227)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.executeQuery$1(SQLExecution.scala:107)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:132)\r\n\tat org.apache.spark.sql.catalyst.QueryPlanningTracker$.withTracker(QueryPlanningTracker.scala:104)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.withTracker(SQLExecution.scala:227)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$5(SQLExecution.scala:132)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:248)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:131)\r\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:764)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:68)\r\n\tat org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:963)\r\n\tat org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:415)\r\n\tat org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:399)\r\n\tat org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:288)\r\n\tat hudiwriter.HudiWriter.createHudiTable(HudiWriter.scala:48)\r\n\tat hudiwriter.HudiContext.writeToHudi(HudiContext.scala:46)\r\n\tat jobs.TableProcessor.start(TableProcessor.scala:86)\r\n\tat TableProcessorWrapper$.$anonfun$main$2(TableProcessorWrapper.scala:23)\r\n\tat scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)\r\n\tat scala.concurrent.Future$.$anonfun$apply$1(Future.scala:659)\r\n\tat scala.util.Success.$anonfun$map$1(Try.scala:255)\r\n\tat scala.util.Success.map(Try.scala:213)\r\n\tat scala.concurrent.Future.$anonfun$map$1(Future.scala:292)\r\n\tat scala.concurrent.impl.Promise.liftedTree1$1(Promise.scala:33)\r\n\tat scala.concurrent.impl.Promise.$anonfun$transform$1(Promise.scala:33)\r\n\tat scala.concurrent.impl.CallbackRunnable.run(Promise.scala:64)\r\n\tat java.util.concurrent.ForkJoinTask$RunnableExecuteAction.exec(ForkJoinTask.java:1402)\r\n\tat java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)\r\n\tat java.util.concurrent.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1056)\r\n\tat java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:1692)\r\n\tat java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:175)\r\nCaused by: java.lang.ClassNotFoundException: org.apache.calcite.rel.type.RelDataTypeSystem\r\n\tat java.net.URLClassLoader.findClass(URLClassLoader.java:382)\r\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:418)\r\n\tat sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:352)\r\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:351)\r\n\t... 65 more`","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785350882/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785410456","html_url":"https://github.com/apache/hudi/pull/2601#issuecomment-785410456","issue_url":"https://api.github.com/repos/apache/hudi/issues/2601","id":785410456,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTQxMDQ1Ng==","user":{"login":"vburenin","id":4350891,"node_id":"MDQ6VXNlcjQzNTA4OTE=","avatar_url":"https://avatars.githubusercontent.com/u/4350891?v=4","gravatar_id":"","url":"https://api.github.com/users/vburenin","html_url":"https://github.com/vburenin","followers_url":"https://api.github.com/users/vburenin/followers","following_url":"https://api.github.com/users/vburenin/following{/other_user}","gists_url":"https://api.github.com/users/vburenin/gists{/gist_id}","starred_url":"https://api.github.com/users/vburenin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vburenin/subscriptions","organizations_url":"https://api.github.com/users/vburenin/orgs","repos_url":"https://api.github.com/users/vburenin/repos","events_url":"https://api.github.com/users/vburenin/events{/privacy}","received_events_url":"https://api.github.com/users/vburenin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T21:55:24Z","updated_at":"2021-02-24T21:55:24Z","author_association":"CONTRIBUTOR","body":"@vc I wonder how we may want to proceed here, it looks like 1.10.1 dependency is baked into Spark, so I am struggling to make it to work properly as I am potentially getting class conflicts with 1.11.1 here. Any ideas?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785410456/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785433334","html_url":"https://github.com/apache/hudi/issues/1679#issuecomment-785433334","issue_url":"https://api.github.com/repos/apache/hudi/issues/1679","id":785433334,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTQzMzMzNA==","user":{"login":"rubenssoto","id":36298331,"node_id":"MDQ6VXNlcjM2Mjk4MzMx","avatar_url":"https://avatars.githubusercontent.com/u/36298331?v=4","gravatar_id":"","url":"https://api.github.com/users/rubenssoto","html_url":"https://github.com/rubenssoto","followers_url":"https://api.github.com/users/rubenssoto/followers","following_url":"https://api.github.com/users/rubenssoto/following{/other_user}","gists_url":"https://api.github.com/users/rubenssoto/gists{/gist_id}","starred_url":"https://api.github.com/users/rubenssoto/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rubenssoto/subscriptions","organizations_url":"https://api.github.com/users/rubenssoto/orgs","repos_url":"https://api.github.com/users/rubenssoto/repos","events_url":"https://api.github.com/users/rubenssoto/events{/privacy}","received_events_url":"https://api.github.com/users/rubenssoto/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T22:43:04Z","updated_at":"2021-02-24T22:44:08Z","author_association":"NONE","body":"I give another try on\r\nEMR 5.32\r\nHudi 0.6.0\r\n\r\n\r\n**First ERROR:**\r\n\r\n`21/02/24 22:27:25 WARN FileUtils: Error setting permissions of hdfs://ip-10-0-28-211.us-west-2.compute.internal:8020/user/spark/warehouse/raw_courier_api_hudi.db\r\njava.io.IOException: Unable to set permissions of hdfs://ip-10-0-28-211.us-west-2.compute.internal:8020/user/spark/warehouse/raw_courier_api_hudi.db\r\n\tat org.apache.hadoop.hive.shims.Hadoop23Shims.setFullFileStatus(Hadoop23Shims.java:758)\r\n\tat org.apache.hadoop.hive.common.FileUtils.mkdir(FileUtils.java:527)\r\n\tat org.apache.hadoop.hive.metastore.Warehouse.mkdirs(Warehouse.java:201)\r\n\tat com.amazonaws.glue.catalog.util.MetastoreClientUtils.makeDirs(MetastoreClientUtils.java:43)\r\n\tat com.amazonaws.glue.catalog.metastore.GlueMetastoreClientDelegate.createDatabase(GlueMetastoreClientDelegate.java:236)\r\n\tat com.amazonaws.glue.catalog.metastore.AWSCatalogMetastoreClient.createDatabase(AWSCatalogMetastoreClient.java:272)\r\n\tat org.apache.hadoop.hive.ql.metadata.Hive.createDatabase(Hive.java:316)\r\n\tat org.apache.hadoop.hive.ql.exec.DDLTask.createDatabase(DDLTask.java:3895)\r\n\tat org.apache.hadoop.hive.ql.exec.DDLTask.execute(DDLTask.java:271)\r\n\tat org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:160)\r\n\tat org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:88)\r\n\tat org.apache.hadoop.hive.ql.Driver.launchTask(Driver.java:1653)\r\n\tat org.apache.hadoop.hive.ql.Driver.execute(Driver.java:1412)\r\n\tat org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:1195)\r\n\tat org.apache.hadoop.hive.ql.Driver.run(Driver.java:1059)\r\n\tat org.apache.hadoop.hive.ql.Driver.run(Driver.java:1049)\r\n\tat org.apache.hudi.hive.HoodieHiveClient.updateHiveSQLs(HoodieHiveClient.java:384)\r\n\tat org.apache.hudi.hive.HoodieHiveClient.updateHiveSQLUsingHiveDriver(HoodieHiveClient.java:367)\r\n\tat org.apache.hudi.hive.HoodieHiveClient.updateHiveSQL(HoodieHiveClient.java:357)\r\n\tat org.apache.hudi.hive.HiveSyncTool.syncHoodieTable(HiveSyncTool.java:121)\r\n\tat org.apache.hudi.hive.HiveSyncTool.syncHoodieTable(HiveSyncTool.java:94)\r\n\tat org.apache.hudi.HoodieSparkSqlWriter$.org$apache$hudi$HoodieSparkSqlWriter$$syncHive(HoodieSparkSqlWriter.scala:321)\r\n\tat org.apache.hudi.HoodieSparkSqlWriter$$anonfun$metaSync$2.apply(HoodieSparkSqlWriter.scala:363)\r\n\tat org.apache.hudi.HoodieSparkSqlWriter$$anonfun$metaSync$2.apply(HoodieSparkSqlWriter.scala:359)\r\n\tat scala.collection.mutable.HashSet.foreach(HashSet.scala:78)\r\n\tat org.apache.hudi.HoodieSparkSqlWriter$.metaSync(HoodieSparkSqlWriter.scala:359)\r\n\tat org.apache.hudi.HoodieSparkSqlWriter$.commitAndPerformPostOperations(HoodieSparkSqlWriter.scala:417)\r\n\tat org.apache.hudi.HoodieSparkSqlWriter$.write(HoodieSparkSqlWriter.scala:205)\r\n\tat org.apache.hudi.DefaultSource.createRelation(DefaultSource.scala:125)\r\n\tat org.apache.spark.sql.execution.datasources.SaveIntoDataSourceCommand.run(SaveIntoDataSourceCommand.scala:45)\r\n\tat org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult$lzycompute(commands.scala:70)\r\n\tat org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult(commands.scala:68)\r\n\tat org.apache.spark.sql.execution.command.ExecutedCommandExec.doExecute(commands.scala:86)\r\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:173)\r\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:169)\r\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$executeQuery$1.apply(SparkPlan.scala:197)\r\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\r\n\tat org.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:194)\r\n\tat org.apache.spark.sql.execution.SparkPlan.execute(SparkPlan.scala:169)\r\n\tat org.apache.spark.sql.execution.QueryExecution.toRdd$lzycompute(QueryExecution.scala:114)\r\n\tat org.apache.spark.sql.execution.QueryExecution.toRdd(QueryExecution.scala:112)\r\n\tat org.apache.spark.sql.DataFrameWriter$$anonfun$runCommand$1.apply(DataFrameWriter.scala:696)\r\n\tat org.apache.spark.sql.DataFrameWriter$$anonfun$runCommand$1.apply(DataFrameWriter.scala:696)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.org$apache$spark$sql$execution$SQLExecution$$executeQuery$1(SQLExecution.scala:83)\r\n\tat org.apache.spark.sql.execution.SQLExecution$$anonfun$withNewExecutionId$1$$anonfun$apply$1.apply(SQLExecution.scala:94)\r\n\tat org.apache.spark.sql.execution.QueryExecutionMetrics$.withMetrics(QueryExecutionMetrics.scala:141)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.org$apache$spark$sql$execution$SQLExecution$$withMetrics(SQLExecution.scala:178)\r\n\tat org.apache.spark.sql.execution.SQLExecution$$anonfun$withNewExecutionId$1.apply(SQLExecution.scala:93)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:200)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:92)\r\n\tat org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:696)\r\n\tat org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:305)\r\n\tat org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:291)\r\n\tat org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:249)\r\n\tat hudiwriter.HudiWriter.createHudiTable(HudiWriter.scala:48)\r\n\tat hudiwriter.HudiContext.writeToHudi(HudiContext.scala:38)\r\n\tat jobs.TableProcessor.start(TableProcessor.scala:77)\r\n\tat TableProcessorWrapper$$anonfun$1$$anonfun$apply$1.apply$mcV$sp(TableProcessorWrapper.scala:23)\r\n\tat TableProcessorWrapper$$anonfun$1$$anonfun$apply$1.apply(TableProcessorWrapper.scala:23)\r\n\tat TableProcessorWrapper$$anonfun$1$$anonfun$apply$1.apply(TableProcessorWrapper.scala:23)\r\n\tat scala.concurrent.impl.Future$PromiseCompletingRunnable.liftedTree1$1(Future.scala:24)\r\n\tat scala.concurrent.impl.Future$PromiseCompletingRunnable.run(Future.scala:24)\r\n\tat java.util.concurrent.ForkJoinTask$RunnableExecuteAction.exec(ForkJoinTask.java:1402)\r\n\tat java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)\r\n\tat java.util.concurrent.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1056)\r\n\tat java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:1692)\r\n\tat java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:175)\r\nCaused by: java.lang.NumberFormatException: For input string: \"testingforemptydefaultvalue\"\r\n\tat java.lang.NumberFormatException.forInputString(NumberFormatException.java:65)\r\n\tat java.lang.Integer.parseInt(Integer.java:580)\r\n\tat java.lang.Integer.parseInt(Integer.java:615)\r\n\tat org.apache.hadoop.conf.Configuration.getInts(Configuration.java:1402)\r\n\tat org.apache.hadoop.security.UserGroupInformation.initialize(UserGroupInformation.java:332)\r\n\tat org.apache.hadoop.security.UserGroupInformation.setConfiguration(UserGroupInformation.java:355)\r\n\tat org.apache.hadoop.fs.FsShell.init(FsShell.java:96)\r\n\tat org.apache.hadoop.fs.FsShell.run(FsShell.java:296)\r\n\tat org.apache.hadoop.hive.shims.HadoopShimsSecure.run(HadoopShimsSecure.java:377)\r\n\tat org.apache.hadoop.hive.shims.Hadoop23Shims.setFullFileStatus(Hadoop23Shims.java:729)\r\n\t... 66 more`\r\n\r\n\r\n\r\n**Second  ERROR:**\r\n\r\n\r\n`Exception in thread \"ForkJoinPool-1-worker-2\" java.lang.NoClassDefFoundError: org/json/JSONException\r\n\tat org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeCreateTable(SemanticAnalyzer.java:10847)\r\n\tat org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genResolvedParseTree(SemanticAnalyzer.java:10047)\r\n\tat org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:10128)\r\n\tat org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:209)\r\n\tat org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:227)\r\n\tat org.apache.hadoop.hive.ql.Driver.compile(Driver.java:424)\r\n\tat org.apache.hadoop.hive.ql.Driver.compile(Driver.java:308)\r\n\tat org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:1122)\r\n\tat org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:1170)\r\n\tat org.apache.hadoop.hive.ql.Driver.run(Driver.java:1059)\r\n\tat org.apache.hadoop.hive.ql.Driver.run(Driver.java:1049)\r\n\tat org.apache.hudi.hive.HoodieHiveClient.updateHiveSQLs(HoodieHiveClient.java:384)\r\n\tat org.apache.hudi.hive.HoodieHiveClient.updateHiveSQLUsingHiveDriver(HoodieHiveClient.java:367)\r\n\tat org.apache.hudi.hive.HoodieHiveClient.updateHiveSQL(HoodieHiveClient.java:357)\r\n\tat org.apache.hudi.hive.HoodieHiveClient.createTable(HoodieHiveClient.java:262)\r\n\tat org.apache.hudi.hive.HiveSyncTool.syncSchema(HiveSyncTool.java:176)\r\n\tat org.apache.hudi.hive.HiveSyncTool.syncHoodieTable(HiveSyncTool.java:130)\r\n\tat org.apache.hudi.hive.HiveSyncTool.syncHoodieTable(HiveSyncTool.java:94)\r\n\tat org.apache.hudi.HoodieSparkSqlWriter$.org$apache$hudi$HoodieSparkSqlWriter$$syncHive(HoodieSparkSqlWriter.scala:321)\r\n\tat org.apache.hudi.HoodieSparkSqlWriter$$anonfun$metaSync$2.apply(HoodieSparkSqlWriter.scala:363)\r\n\tat org.apache.hudi.HoodieSparkSqlWriter$$anonfun$metaSync$2.apply(HoodieSparkSqlWriter.scala:359)\r\n\tat scala.collection.mutable.HashSet.foreach(HashSet.scala:78)\r\n\tat org.apache.hudi.HoodieSparkSqlWriter$.metaSync(HoodieSparkSqlWriter.scala:359)\r\n\tat org.apache.hudi.HoodieSparkSqlWriter$.commitAndPerformPostOperations(HoodieSparkSqlWriter.scala:417)\r\n\tat org.apache.hudi.HoodieSparkSqlWriter$.write(HoodieSparkSqlWriter.scala:205)\r\n\tat org.apache.hudi.DefaultSource.createRelation(DefaultSource.scala:125)\r\n\tat org.apache.spark.sql.execution.datasources.SaveIntoDataSourceCommand.run(SaveIntoDataSourceCommand.scala:45)\r\n\tat org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult$lzycompute(commands.scala:70)\r\n\tat org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult(commands.scala:68)\r\n\tat org.apache.spark.sql.execution.command.ExecutedCommandExec.doExecute(commands.scala:86)\r\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:173)\r\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:169)\r\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$executeQuery$1.apply(SparkPlan.scala:197)\r\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\r\n\tat org.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:194)\r\n\tat org.apache.spark.sql.execution.SparkPlan.execute(SparkPlan.scala:169)\r\n\tat org.apache.spark.sql.execution.QueryExecution.toRdd$lzycompute(QueryExecution.scala:114)\r\n\tat org.apache.spark.sql.execution.QueryExecution.toRdd(QueryExecution.scala:112)\r\n\tat org.apache.spark.sql.DataFrameWriter$$anonfun$runCommand$1.apply(DataFrameWriter.scala:696)\r\n\tat org.apache.spark.sql.DataFrameWriter$$anonfun$runCommand$1.apply(DataFrameWriter.scala:696)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.org$apache$spark$sql$execution$SQLExecution$$executeQuery$1(SQLExecution.scala:83)\r\n\tat org.apache.spark.sql.execution.SQLExecution$$anonfun$withNewExecutionId$1$$anonfun$apply$1.apply(SQLExecution.scala:94)\r\n\tat org.apache.spark.sql.execution.QueryExecutionMetrics$.withMetrics(QueryExecutionMetrics.scala:141)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.org$apache$spark$sql$execution$SQLExecution$$withMetrics(SQLExecution.scala:178)\r\n\tat org.apache.spark.sql.execution.SQLExecution$$anonfun$withNewExecutionId$1.apply(SQLExecution.scala:93)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:200)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:92)\r\n\tat org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:696)\r\n\tat org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:305)\r\n\tat org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:291)\r\n\tat org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:249)\r\n\tat hudiwriter.HudiWriter.createHudiTable(HudiWriter.scala:48)\r\n\tat hudiwriter.HudiContext.writeToHudi(HudiContext.scala:38)\r\n\tat jobs.TableProcessor.start(TableProcessor.scala:77)\r\n\tat TableProcessorWrapper$$anonfun$1$$anonfun$apply$1.apply$mcV$sp(TableProcessorWrapper.scala:23)\r\n\tat TableProcessorWrapper$$anonfun$1$$anonfun$apply$1.apply(TableProcessorWrapper.scala:23)\r\n\tat TableProcessorWrapper$$anonfun$1$$anonfun$apply$1.apply(TableProcessorWrapper.scala:23)\r\n\tat scala.concurrent.impl.Future$PromiseCompletingRunnable.liftedTree1$1(Future.scala:24)\r\n\tat scala.concurrent.impl.Future$PromiseCompletingRunnable.run(Future.scala:24)\r\n\tat java.util.concurrent.ForkJoinTask$RunnableExecuteAction.exec(ForkJoinTask.java:1402)\r\n\tat java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)\r\n\tat java.util.concurrent.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1056)\r\n\tat java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:1692)\r\n\tat java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:175)\r\nCaused by: java.lang.ClassNotFoundException: org.json.JSONException\r\n\tat java.net.URLClassLoader.findClass(URLClassLoader.java:382)\r\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:418)\r\n\tat sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:352)\r\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:351)\r\n\t... 64 more`","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785433334/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785505040","html_url":"https://github.com/apache/hudi/pull/2600#issuecomment-785505040","issue_url":"https://api.github.com/repos/apache/hudi/issues/2600","id":785505040,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTUwNTA0MA==","user":{"login":"yanghua","id":2283778,"node_id":"MDQ6VXNlcjIyODM3Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/2283778?v=4","gravatar_id":"","url":"https://api.github.com/users/yanghua","html_url":"https://github.com/yanghua","followers_url":"https://api.github.com/users/yanghua/followers","following_url":"https://api.github.com/users/yanghua/following{/other_user}","gists_url":"https://api.github.com/users/yanghua/gists{/gist_id}","starred_url":"https://api.github.com/users/yanghua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yanghua/subscriptions","organizations_url":"https://api.github.com/users/yanghua/orgs","repos_url":"https://api.github.com/users/yanghua/repos","events_url":"https://api.github.com/users/yanghua/events{/privacy}","received_events_url":"https://api.github.com/users/yanghua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-25T01:18:52Z","updated_at":"2021-02-25T01:18:52Z","author_association":"CONTRIBUTOR","body":"@lamber-ken You should have merge permission. Please go ahead.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785505040/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785506762","html_url":"https://github.com/apache/hudi/pull/2443#issuecomment-785506762","issue_url":"https://api.github.com/repos/apache/hudi/issues/2443","id":785506762,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTUwNjc2Mg==","user":{"login":"yanghua","id":2283778,"node_id":"MDQ6VXNlcjIyODM3Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/2283778?v=4","gravatar_id":"","url":"https://api.github.com/users/yanghua","html_url":"https://github.com/yanghua","followers_url":"https://api.github.com/users/yanghua/followers","following_url":"https://api.github.com/users/yanghua/following{/other_user}","gists_url":"https://api.github.com/users/yanghua/gists{/gist_id}","starred_url":"https://api.github.com/users/yanghua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yanghua/subscriptions","organizations_url":"https://api.github.com/users/yanghua/orgs","repos_url":"https://api.github.com/users/yanghua/repos","events_url":"https://api.github.com/users/yanghua/events{/privacy}","received_events_url":"https://api.github.com/users/yanghua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-25T01:23:58Z","updated_at":"2021-02-25T01:23:58Z","author_association":"CONTRIBUTOR","body":"> @yanghua : I synced up w/ Vinoth on this. here is our idea. we will make the config (naming) generic for now. but lets not make it wider to ignore exceptions for sync. bcoz, if sync explicitly fails probably user need to get notified. Since this diff was raised mainly for connect execption, we will leave it as is. But in future if some customer needs to ignore sync exceptions as well, we can consider silently ignoring those as well(so that we don't introduce a new config and can use the same config). wdyt?\r\n> If you agree, only fix we need for now is to fix the config naming. I can work on it and push in a small commit.\r\n\r\nOK, agree.\r\n\r\nThe original intention of my idea is actually to not want the failure of synchronization to affect hudi's tasks. We have experienced situations where Hive is unavailable and all jobs fail. Then we completely ignored the failure, but when it failed, we implemented log warnings.\r\n\r\nBut as a realization of the community, I agree with you.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785506762/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785510794","html_url":"https://github.com/apache/hudi/issues/2586#issuecomment-785510794","issue_url":"https://api.github.com/repos/apache/hudi/issues/2586","id":785510794,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTUxMDc5NA==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-25T01:35:06Z","updated_at":"2021-02-25T01:35:06Z","author_association":"CONTRIBUTOR","body":"Few options/questions:\r\n- does your incremental ingestion contains updates or inserts? If they are just inserts but Hudi's file sizing optimization joins w/ existing files, we can try turning off the file sizing. \r\n- In general, you can set the file versions retained based on max time for read query and max ingestions that could happen within that time frame. For eg, if you read query could take a max of 2 hours and you ingest once every 10 mins to hudi, you can set the file versions retained to 12. \r\n- Also, another option is to try MERGE_ON_READ table. here, hudi will just do delta commits which may not incur much write amplification as compared to COW. You can set file versions retained to 3 itself. delta commits doesn't come in the way of min file versions retained. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785510794/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785545020","html_url":"https://github.com/apache/hudi/pull/2227#issuecomment-785545020","issue_url":"https://api.github.com/repos/apache/hudi/issues/2227","id":785545020,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTU0NTAyMA==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-25T03:14:36Z","updated_at":"2021-02-25T03:15:17Z","author_association":"CONTRIBUTOR","body":"@yanghua : Have addressed all feedback and have added tests. Can you skim through once. Will wait for a day. if not, will go ahead and merge this in.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785545020/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785612581","html_url":"https://github.com/apache/hudi/pull/2603#issuecomment-785612581","issue_url":"https://api.github.com/repos/apache/hudi/issues/2603","id":785612581,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTYxMjU4MQ==","user":{"login":"codecov-io","id":8655789,"node_id":"MDQ6VXNlcjg2NTU3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/8655789?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-io","html_url":"https://github.com/codecov-io","followers_url":"https://api.github.com/users/codecov-io/followers","following_url":"https://api.github.com/users/codecov-io/following{/other_user}","gists_url":"https://api.github.com/users/codecov-io/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-io/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-io/subscriptions","organizations_url":"https://api.github.com/users/codecov-io/orgs","repos_url":"https://api.github.com/users/codecov-io/repos","events_url":"https://api.github.com/users/codecov-io/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-io/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-25T04:58:45Z","updated_at":"2021-02-25T04:58:45Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2603?src=pr&el=h1) Report\n> Merging [#2603](https://codecov.io/gh/apache/hudi/pull/2603?src=pr&el=desc) (90a2d1b) into [master](https://codecov.io/gh/apache/hudi/commit/97864a48c1979ca2b3f0579cf26bba81fba7e46c?el=desc) (97864a4) will **increase** coverage by `18.26%`.\n> The diff coverage is `n/a`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2603/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2)](https://codecov.io/gh/apache/hudi/pull/2603?src=pr&el=tree)\n\n```diff\n@@              Coverage Diff              @@\n##             master    #2603       +/-   ##\n=============================================\n+ Coverage     51.19%   69.46%   +18.26%     \n+ Complexity     3226      356     -2870     \n=============================================\n  Files           438       53      -385     \n  Lines         20089     1929    -18160     \n  Branches       2068      230     -1838     \n=============================================\n- Hits          10285     1340     -8945     \n+ Misses         8958      456     -8502     \n+ Partials        846      133      -713     \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `?` | `?` | |\n| hudiclient | `100.00% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudicommon | `?` | `?` | |\n| hudiflink | `?` | `?` | |\n| hudihadoopmr | `?` | `?` | |\n| hudisparkdatasource | `?` | `?` | |\n| hudisync | `?` | `?` | |\n| huditimelineservice | `?` | `?` | |\n| hudiutilities | `69.46% <ø> (ø)` | `0.00 <ø> (ø)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2603?src=pr&el=tree) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...rg/apache/hudi/common/bloom/SimpleBloomFilter.java](https://codecov.io/gh/apache/hudi/pull/2603/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL2Jsb29tL1NpbXBsZUJsb29tRmlsdGVyLmphdmE=) | | | |\n| [...ache/hudi/cli/commands/ArchivedCommitsCommand.java](https://codecov.io/gh/apache/hudi/pull/2603/diff?src=pr&el=tree#diff-aHVkaS1jbGkvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY2xpL2NvbW1hbmRzL0FyY2hpdmVkQ29tbWl0c0NvbW1hbmQuamF2YQ==) | | | |\n| [...rg/apache/hudi/exception/HoodieIndexException.java](https://codecov.io/gh/apache/hudi/pull/2603/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvZXhjZXB0aW9uL0hvb2RpZUluZGV4RXhjZXB0aW9uLmphdmE=) | | | |\n| [.../apache/hudi/hadoop/RecordReaderValueIterator.java](https://codecov.io/gh/apache/hudi/pull/2603/diff?src=pr&el=tree#diff-aHVkaS1oYWRvb3AtbXIvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvaGFkb29wL1JlY29yZFJlYWRlclZhbHVlSXRlcmF0b3IuamF2YQ==) | | | |\n| [.../hudi/common/bloom/InternalDynamicBloomFilter.java](https://codecov.io/gh/apache/hudi/pull/2603/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL2Jsb29tL0ludGVybmFsRHluYW1pY0Jsb29tRmlsdGVyLmphdmE=) | | | |\n| [.../org/apache/hudi/cli/commands/MetadataCommand.java](https://codecov.io/gh/apache/hudi/pull/2603/diff?src=pr&el=tree#diff-aHVkaS1jbGkvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY2xpL2NvbW1hbmRzL01ldGFkYXRhQ29tbWFuZC5qYXZh) | | | |\n| [...rg/apache/hudi/common/table/HoodieTableConfig.java](https://codecov.io/gh/apache/hudi/pull/2603/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3RhYmxlL0hvb2RpZVRhYmxlQ29uZmlnLmphdmE=) | | | |\n| [.../main/java/org/apache/hudi/util/AvroConvertor.java](https://codecov.io/gh/apache/hudi/pull/2603/diff?src=pr&el=tree#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS91dGlsL0F2cm9Db252ZXJ0b3IuamF2YQ==) | | | |\n| [...op/realtime/HoodieCombineRealtimeRecordReader.java](https://codecov.io/gh/apache/hudi/pull/2603/diff?src=pr&el=tree#diff-aHVkaS1oYWRvb3AtbXIvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvaGFkb29wL3JlYWx0aW1lL0hvb2RpZUNvbWJpbmVSZWFsdGltZVJlY29yZFJlYWRlci5qYXZh) | | | |\n| [...e/hudi/common/table/log/HoodieFileSliceReader.java](https://codecov.io/gh/apache/hudi/pull/2603/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3RhYmxlL2xvZy9Ib29kaWVGaWxlU2xpY2VSZWFkZXIuamF2YQ==) | | | |\n| ... and [374 more](https://codecov.io/gh/apache/hudi/pull/2603/diff?src=pr&el=tree-more) | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785612581/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785652759","html_url":"https://github.com/apache/hudi/pull/2600#issuecomment-785652759","issue_url":"https://api.github.com/repos/apache/hudi/issues/2600","id":785652759,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTY1Mjc1OQ==","user":{"login":"lamberken","id":20113411,"node_id":"MDQ6VXNlcjIwMTEzNDEx","avatar_url":"https://avatars.githubusercontent.com/u/20113411?v=4","gravatar_id":"","url":"https://api.github.com/users/lamberken","html_url":"https://github.com/lamberken","followers_url":"https://api.github.com/users/lamberken/followers","following_url":"https://api.github.com/users/lamberken/following{/other_user}","gists_url":"https://api.github.com/users/lamberken/gists{/gist_id}","starred_url":"https://api.github.com/users/lamberken/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lamberken/subscriptions","organizations_url":"https://api.github.com/users/lamberken/orgs","repos_url":"https://api.github.com/users/lamberken/repos","events_url":"https://api.github.com/users/lamberken/events{/privacy}","received_events_url":"https://api.github.com/users/lamberken/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-25T06:33:13Z","updated_at":"2021-02-25T06:33:13Z","author_association":"MEMBER","body":"Got @yanghua, thanks @danny0405 for the patch!","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785652759/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785654241","html_url":"https://github.com/apache/hudi/pull/2604#issuecomment-785654241","issue_url":"https://api.github.com/repos/apache/hudi/issues/2604","id":785654241,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTY1NDI0MQ==","user":{"login":"lamberken","id":20113411,"node_id":"MDQ6VXNlcjIwMTEzNDEx","avatar_url":"https://avatars.githubusercontent.com/u/20113411?v=4","gravatar_id":"","url":"https://api.github.com/users/lamberken","html_url":"https://github.com/lamberken","followers_url":"https://api.github.com/users/lamberken/followers","following_url":"https://api.github.com/users/lamberken/following{/other_user}","gists_url":"https://api.github.com/users/lamberken/gists{/gist_id}","starred_url":"https://api.github.com/users/lamberken/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lamberken/subscriptions","organizations_url":"https://api.github.com/users/lamberken/orgs","repos_url":"https://api.github.com/users/lamberken/repos","events_url":"https://api.github.com/users/lamberken/events{/privacy}","received_events_url":"https://api.github.com/users/lamberken/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-25T06:36:18Z","updated_at":"2021-02-25T06:36:18Z","author_association":"MEMBER","body":"@hk-lrzy thanks for yor patch, some conflicts need to be resolved.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785654241/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785655618","html_url":"https://github.com/apache/hudi/pull/2443#issuecomment-785655618","issue_url":"https://api.github.com/repos/apache/hudi/issues/2443","id":785655618,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTY1NTYxOA==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-25T06:39:02Z","updated_at":"2021-02-25T06:39:02Z","author_association":"CONTRIBUTOR","body":"got it, thanks. I have addressed all pending feedbacks. Will land once CI turns green. \r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785655618/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785704660","html_url":"https://github.com/apache/hudi/pull/2604#issuecomment-785704660","issue_url":"https://api.github.com/repos/apache/hudi/issues/2604","id":785704660,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTcwNDY2MA==","user":{"login":"codecov-io","id":8655789,"node_id":"MDQ6VXNlcjg2NTU3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/8655789?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-io","html_url":"https://github.com/codecov-io","followers_url":"https://api.github.com/users/codecov-io/followers","following_url":"https://api.github.com/users/codecov-io/following{/other_user}","gists_url":"https://api.github.com/users/codecov-io/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-io/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-io/subscriptions","organizations_url":"https://api.github.com/users/codecov-io/orgs","repos_url":"https://api.github.com/users/codecov-io/repos","events_url":"https://api.github.com/users/codecov-io/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-io/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-25T08:08:56Z","updated_at":"2021-02-25T08:08:56Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2604?src=pr&el=h1) Report\n> Merging [#2604](https://codecov.io/gh/apache/hudi/pull/2604?src=pr&el=desc) (fed6575) into [master](https://codecov.io/gh/apache/hudi/commit/06dc7c7fd8a867a1e1da90f7dc19b0cc2da69bba?el=desc) (06dc7c7) will **decrease** coverage by `41.52%`.\n> The diff coverage is `n/a`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2604/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2)](https://codecov.io/gh/apache/hudi/pull/2604?src=pr&el=tree)\n\n```diff\n@@             Coverage Diff              @@\n##             master   #2604       +/-   ##\n============================================\n- Coverage     51.22%   9.69%   -41.53%     \n+ Complexity     3230      48     -3182     \n============================================\n  Files           438      53      -385     \n  Lines         20093    1929    -18164     \n  Branches       2069     230     -1839     \n============================================\n- Hits          10292     187    -10105     \n+ Misses         8954    1729     -7225     \n+ Partials        847      13      -834     \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `?` | `?` | |\n| hudiclient | `?` | `?` | |\n| hudicommon | `?` | `?` | |\n| hudiflink | `?` | `?` | |\n| hudihadoopmr | `?` | `?` | |\n| hudisparkdatasource | `?` | `?` | |\n| hudisync | `?` | `?` | |\n| huditimelineservice | `?` | `?` | |\n| hudiutilities | `9.69% <ø> (-59.83%)` | `0.00 <ø> (ø)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2604?src=pr&el=tree) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...va/org/apache/hudi/utilities/IdentitySplitter.java](https://codecov.io/gh/apache/hudi/pull/2604/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL0lkZW50aXR5U3BsaXR0ZXIuamF2YQ==) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-2.00%)` | |\n| [...va/org/apache/hudi/utilities/schema/SchemaSet.java](https://codecov.io/gh/apache/hudi/pull/2604/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NjaGVtYS9TY2hlbWFTZXQuamF2YQ==) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-3.00%)` | |\n| [...a/org/apache/hudi/utilities/sources/RowSource.java](https://codecov.io/gh/apache/hudi/pull/2604/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvUm93U291cmNlLmphdmE=) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-4.00%)` | |\n| [.../org/apache/hudi/utilities/sources/AvroSource.java](https://codecov.io/gh/apache/hudi/pull/2604/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvQXZyb1NvdXJjZS5qYXZh) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-1.00%)` | |\n| [.../org/apache/hudi/utilities/sources/JsonSource.java](https://codecov.io/gh/apache/hudi/pull/2604/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvSnNvblNvdXJjZS5qYXZh) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-1.00%)` | |\n| [...rg/apache/hudi/utilities/sources/CsvDFSSource.java](https://codecov.io/gh/apache/hudi/pull/2604/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvQ3N2REZTU291cmNlLmphdmE=) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-10.00%)` | |\n| [...g/apache/hudi/utilities/sources/JsonDFSSource.java](https://codecov.io/gh/apache/hudi/pull/2604/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvSnNvbkRGU1NvdXJjZS5qYXZh) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-4.00%)` | |\n| [...apache/hudi/utilities/sources/JsonKafkaSource.java](https://codecov.io/gh/apache/hudi/pull/2604/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvSnNvbkthZmthU291cmNlLmphdmE=) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-6.00%)` | |\n| [...pache/hudi/utilities/sources/ParquetDFSSource.java](https://codecov.io/gh/apache/hudi/pull/2604/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvUGFycXVldERGU1NvdXJjZS5qYXZh) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-5.00%)` | |\n| [...lities/schema/SchemaProviderWithPostProcessor.java](https://codecov.io/gh/apache/hudi/pull/2604/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NjaGVtYS9TY2hlbWFQcm92aWRlcldpdGhQb3N0UHJvY2Vzc29yLmphdmE=) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-4.00%)` | |\n| ... and [414 more](https://codecov.io/gh/apache/hudi/pull/2604/diff?src=pr&el=tree-more) | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785704660/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785795722","html_url":"https://github.com/apache/hudi/issues/2439#issuecomment-785795722","issue_url":"https://api.github.com/repos/apache/hudi/issues/2439","id":785795722,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTc5NTcyMg==","user":{"login":"rakeshramakrishnan","id":6533326,"node_id":"MDQ6VXNlcjY1MzMzMjY=","avatar_url":"https://avatars.githubusercontent.com/u/6533326?v=4","gravatar_id":"","url":"https://api.github.com/users/rakeshramakrishnan","html_url":"https://github.com/rakeshramakrishnan","followers_url":"https://api.github.com/users/rakeshramakrishnan/followers","following_url":"https://api.github.com/users/rakeshramakrishnan/following{/other_user}","gists_url":"https://api.github.com/users/rakeshramakrishnan/gists{/gist_id}","starred_url":"https://api.github.com/users/rakeshramakrishnan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rakeshramakrishnan/subscriptions","organizations_url":"https://api.github.com/users/rakeshramakrishnan/orgs","repos_url":"https://api.github.com/users/rakeshramakrishnan/repos","events_url":"https://api.github.com/users/rakeshramakrishnan/events{/privacy}","received_events_url":"https://api.github.com/users/rakeshramakrishnan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-25T10:37:48Z","updated_at":"2021-02-25T10:38:13Z","author_association":"NONE","body":"@nsivabalan : There are no errors, however through hudi, the connection is made to the local hive metastore (from spark). It doesn't connect to the external hive metastore. \r\n\r\nBut, without hudi, the spark catalog fetches tables hive tables from the external metastore\r\n```\r\nspark = SparkSession.builder \\\r\n    .appName(\"test-hudi-hive-sync\") \\\r\n    .enableHiveSupport() \\\r\n    .config(\"hive.metastore.uris\", metastore_uri) \\\r\n    .getOrCreate()\r\n\r\nprint(\"Before {}\".format(spark.catalog.listTables())) ------> returns tables from `metastore_uri`\r\n```","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785795722/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785896778","html_url":"https://github.com/apache/hudi/issues/2592#issuecomment-785896778","issue_url":"https://api.github.com/repos/apache/hudi/issues/2592","id":785896778,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTg5Njc3OA==","user":{"login":"bvaradar","id":3021376,"node_id":"MDQ6VXNlcjMwMjEzNzY=","avatar_url":"https://avatars.githubusercontent.com/u/3021376?v=4","gravatar_id":"","url":"https://api.github.com/users/bvaradar","html_url":"https://github.com/bvaradar","followers_url":"https://api.github.com/users/bvaradar/followers","following_url":"https://api.github.com/users/bvaradar/following{/other_user}","gists_url":"https://api.github.com/users/bvaradar/gists{/gist_id}","starred_url":"https://api.github.com/users/bvaradar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bvaradar/subscriptions","organizations_url":"https://api.github.com/users/bvaradar/orgs","repos_url":"https://api.github.com/users/bvaradar/repos","events_url":"https://api.github.com/users/bvaradar/events{/privacy}","received_events_url":"https://api.github.com/users/bvaradar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-25T13:31:24Z","updated_at":"2021-02-25T13:31:24Z","author_association":"CONTRIBUTOR","body":"I was unable to setup spark-2.3.0 in my setup.  But,with spark-2.4.4, this works fine as below. Can you use spark-2.4.x version. spark-2.3 seems too old though ?\r\n\r\n`21/02/25 05:14:26 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable\r\nUsing Spark's default log4j profile: org/apache/spark/log4j-defaults.properties\r\nSetting default log level to \"WARN\".\r\nTo adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).\r\nSpark context Web UI available at http://ip-192-168-1-81.ec2.internal:4040\r\nSpark context available as 'sc' (master = local[*], app id = local-1614258873363).\r\nSpark session available as 'spark'.\r\nWelcome to\r\n      ____              __\r\n     / __/__  ___ _____/ /__\r\n    _\\ \\/ _ \\/ _ `/ __/  '_/\r\n   /___/ .__/\\_,_/_/ /_/\\_\\   version 2.4.4\r\n      /_/\r\n\r\nUsing Scala version 2.11.12 (Java HotSpot(TM) 64-Bit Server VM, Java 1.8.0_251)\r\nType in expressions to have them evaluated.\r\nType :help for more information.\r\n\r\nscala> import org.apache.hudi.DataSourceWriteOptions\r\nimport org.apache.hudi.DataSourceWriteOptions\r\n\r\nscala> import org.apache.hudi.QuickstartUtils.getQuickstartWriteConfigs\r\nimport org.apache.hudi.QuickstartUtils.getQuickstartWriteConfigs\r\n\r\nscala> import org.apache.hudi.config.{HoodieCompactionConfig, HoodieStorageConfig, HoodieWriteConfig}\r\nimport org.apache.hudi.config.{HoodieCompactionConfig, HoodieStorageConfig, HoodieWriteConfig}\r\n\r\nscala> import org.apache.spark.sql.{SaveMode, SparkSession}\r\nimport org.apache.spark.sql.{SaveMode, SparkSession}\r\n\r\nscala> import org.apache.spark.sql.functions.{col, concat, lit}\r\nimport org.apache.spark.sql.functions.{col, concat, lit}\r\n\r\nscala>\r\n\r\nscala> val inputDF = spark.read.format(\"csv\").option(\"header\", \"true\").load(\"file:///tmp/input.csv\")\r\ninputDF: org.apache.spark.sql.DataFrame = [col_1: string, col_2: string ... 12 more fields]\r\n\r\nscala> val formattedDF = inputDF.selectExpr(\"col_1\", \"cast(col_2 as integer) col_2\",\r\n     |   \"cast(col_3 as short) col_3\", \"col_4\", \"col_5\", \"cast(col_6 as byte) col_6\", \"cast(col_7 as decimal(9,2)) col_7\",\r\n     |   \"cast(col_8 as decimal(9,2)) col_8\", \"cast(col_9 as timestamp) col_9\", \"col_10\", \"cast(col_11 as timestamp) col_11\",\r\n     |   \"col_12\", \"cntry_cd\", \"cast(bus_dt as date) bus_dt\")\r\nformattedDF: org.apache.spark.sql.DataFrame = [col_1: string, col_2: int ... 12 more fields]\r\n\r\nscala> formattedDF.printSchema()\r\nroot\r\n |-- col_1: string (nullable = true)\r\n |-- col_2: integer (nullable = true)\r\n |-- col_3: short (nullable = true)\r\n |-- col_4: string (nullable = true)\r\n |-- col_5: string (nullable = true)\r\n |-- col_6: byte (nullable = true)\r\n |-- col_7: decimal(9,2) (nullable = true)\r\n |-- col_8: decimal(9,2) (nullable = true)\r\n |-- col_9: timestamp (nullable = true)\r\n |-- col_10: string (nullable = true)\r\n |-- col_11: timestamp (nullable = true)\r\n |-- col_12: string (nullable = true)\r\n |-- cntry_cd: string (nullable = true)\r\n |-- bus_dt: date (nullable = true)\r\n\r\n\r\nscala> formattedDF.show\r\n+--------------------+-----+-----+-----+-----+-----+-----+-----+--------------------+-----------+--------------------+-----------+--------+----------+\r\n|               col_1|col_2|col_3|col_4|col_5|col_6|col_7|col_8|               col_9|     col_10|              col_11|     col_12|cntry_cd|    bus_dt|\r\n+--------------------+-----+-----+-----+-----+-----+-----+-----+--------------------+-----------+--------------------+-----------+--------+----------+\r\n|7IN00716079317820...|  716|    3|   AB|  INR| null| 0.00| 1.00|2021-02-14 20:23:...|useridjsb91|2021-02-14 20:23:...|useridjsb91|      IN|2021-02-01|\r\n|7IN00716079317820...|  716|    2|   AB|  INR| null| 0.00| 1.00|2021-02-14 20:23:...|useridjsb91|2021-02-14 20:23:...|useridjsb91|      IN|2021-02-01|\r\n|7IN00716079317820...|  716|    1|   AB|  INR| null| 0.00| 1.00|2021-02-14 20:23:...|useridjsb91|2021-02-14 20:23:...|useridjsb91|      IN|2021-02-01|\r\n|AU700716079381819...| 5700|    5|   AB|  INR| null| 0.00| 1.00|2021-02-14 20:06:...|useridjsb91|2021-02-14 20:06:...|useridjsb91|      IN|2021-02-02|\r\n|AU700716079381819...| 5700|    6|   AB|  INR| null| 4.00| 1.97|2021-02-14 20:06:...|useridjsb91|2021-02-14 20:06:...|useridjsb91|      IN|2021-02-02|\r\n|AU700716079381819...| 5700|    4|   AB|  INR| null| 0.00| 1.00|2021-02-14 20:06:...|useridjsb91|2021-02-14 20:06:...|useridjsb91|      AU|2021-02-01|\r\n|AU700716079381819...| 5700|    3|   AB|  INR| null| 0.00| 1.00|2021-02-14 20:06:...|useridjsb91|2021-02-14 20:06:...|useridjsb91|      AU|2021-02-01|\r\n|AU700716079381819...| 5700|    1|   AB|  INR| null| 0.00| 1.00|2021-02-14 20:06:...|useridjsb91|2021-02-14 20:06:...|useridjsb91|      AU|2021-02-01|\r\n+--------------------+-----+-----+-----+-----+-----+-----+-----+--------------------+-----------+--------------------+-----------+--------+----------+\r\n\r\n\r\nscala>\r\n\r\nscala> val transformedDF = formattedDF.withColumn(\"partitionpath\", concat(lit(\"cntry_cd=\"), col(\"cntry_cd\"), lit(\"/bus_dt=\"), col(\"bus_dt\")))\r\ntransformedDF: org.apache.spark.sql.DataFrame = [col_1: string, col_2: int ... 13 more fields]\r\n\r\nscala> val targetPath = \"file:///tmp/output/\"\r\ntargetPath: String = file:///tmp/output/\r\n\r\nscala> transformedDF.write.format(\"org.apache.hudi\").\r\n     | options(getQuickstartWriteConfigs).\r\n     | option(DataSourceWriteOptions.PRECOMBINE_FIELD_OPT_KEY, \"col_9\").\r\n     | option(DataSourceWriteOptions.RECORDKEY_FIELD_OPT_KEY, \"col_2,col_1,col_3\").\r\n     | option(DataSourceWriteOptions.PARTITIONPATH_FIELD_OPT_KEY, \"partitionpath\").\r\n     | option(DataSourceWriteOptions.KEYGENERATOR_CLASS_OPT_KEY, \"org.apache.hudi.keygen.ComplexKeyGenerator\").\r\n     | option(\"hoodie.upsert.shuffle.parallelism\",\"2\").\r\n     | option(\"hoodie.insert.shuffle.parallelism\",\"2\").\r\n     | option(HoodieWriteConfig.TABLE_NAME, \"targetTableHudi\").\r\n     | mode(SaveMode.Append).\r\n     | save(targetPath)\r\n\r\nscala>`","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785896778/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785906565","html_url":"https://github.com/apache/hudi/issues/2605#issuecomment-785906565","issue_url":"https://api.github.com/repos/apache/hudi/issues/2605","id":785906565,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTkwNjU2NQ==","user":{"login":"bvaradar","id":3021376,"node_id":"MDQ6VXNlcjMwMjEzNzY=","avatar_url":"https://avatars.githubusercontent.com/u/3021376?v=4","gravatar_id":"","url":"https://api.github.com/users/bvaradar","html_url":"https://github.com/bvaradar","followers_url":"https://api.github.com/users/bvaradar/followers","following_url":"https://api.github.com/users/bvaradar/following{/other_user}","gists_url":"https://api.github.com/users/bvaradar/gists{/gist_id}","starred_url":"https://api.github.com/users/bvaradar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bvaradar/subscriptions","organizations_url":"https://api.github.com/users/bvaradar/orgs","repos_url":"https://api.github.com/users/bvaradar/repos","events_url":"https://api.github.com/users/bvaradar/events{/privacy}","received_events_url":"https://api.github.com/users/bvaradar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-25T13:47:08Z","updated_at":"2021-02-25T13:47:08Z","author_association":"CONTRIBUTOR","body":"Ideally, spark data-source should provide that option (like optionFromFile(...). Not sure if there is anything like that. \r\n\r\nCreated : https://issues.apache.org/jira/browse/HUDI-1640?filter=-2","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785906565/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785928870","html_url":"https://github.com/apache/hudi/issues/2588#issuecomment-785928870","issue_url":"https://api.github.com/repos/apache/hudi/issues/2588","id":785928870,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTkyODg3MA==","user":{"login":"bvaradar","id":3021376,"node_id":"MDQ6VXNlcjMwMjEzNzY=","avatar_url":"https://avatars.githubusercontent.com/u/3021376?v=4","gravatar_id":"","url":"https://api.github.com/users/bvaradar","html_url":"https://github.com/bvaradar","followers_url":"https://api.github.com/users/bvaradar/followers","following_url":"https://api.github.com/users/bvaradar/following{/other_user}","gists_url":"https://api.github.com/users/bvaradar/gists{/gist_id}","starred_url":"https://api.github.com/users/bvaradar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bvaradar/subscriptions","organizations_url":"https://api.github.com/users/bvaradar/orgs","repos_url":"https://api.github.com/users/bvaradar/repos","events_url":"https://api.github.com/users/bvaradar/events{/privacy}","received_events_url":"https://api.github.com/users/bvaradar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-25T14:19:42Z","updated_at":"2021-02-25T14:19:42Z","author_association":"CONTRIBUTOR","body":"@rubenssoto : The stack-trace does not contain Hudi in it. So, I dont know how to help in this regard. Regarding high cpu load on hive server, Are you also running hive queries apart from HMS integration ?\r\n\r\n@n3nash @nsivabalan : Any other ideas ?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785928870/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785930358","html_url":"https://github.com/apache/hudi/issues/2555#issuecomment-785930358","issue_url":"https://api.github.com/repos/apache/hudi/issues/2555","id":785930358,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTkzMDM1OA==","user":{"login":"bvaradar","id":3021376,"node_id":"MDQ6VXNlcjMwMjEzNzY=","avatar_url":"https://avatars.githubusercontent.com/u/3021376?v=4","gravatar_id":"","url":"https://api.github.com/users/bvaradar","html_url":"https://github.com/bvaradar","followers_url":"https://api.github.com/users/bvaradar/followers","following_url":"https://api.github.com/users/bvaradar/following{/other_user}","gists_url":"https://api.github.com/users/bvaradar/gists{/gist_id}","starred_url":"https://api.github.com/users/bvaradar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bvaradar/subscriptions","organizations_url":"https://api.github.com/users/bvaradar/orgs","repos_url":"https://api.github.com/users/bvaradar/repos","events_url":"https://api.github.com/users/bvaradar/events{/privacy}","received_events_url":"https://api.github.com/users/bvaradar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-25T14:21:58Z","updated_at":"2021-02-25T14:21:58Z","author_association":"CONTRIBUTOR","body":"For bulkinsert, you need to size the parallelism to control. Please see https://cwiki.apache.org/confluence/display/HUDI/FAQ#FAQ-Whatperformance/ingestlatencycanIexpectforHudiwriting","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785930358/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785932137","html_url":"https://github.com/apache/hudi/issues/2448#issuecomment-785932137","issue_url":"https://api.github.com/repos/apache/hudi/issues/2448","id":785932137,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTkzMjEzNw==","user":{"login":"bvaradar","id":3021376,"node_id":"MDQ6VXNlcjMwMjEzNzY=","avatar_url":"https://avatars.githubusercontent.com/u/3021376?v=4","gravatar_id":"","url":"https://api.github.com/users/bvaradar","html_url":"https://github.com/bvaradar","followers_url":"https://api.github.com/users/bvaradar/followers","following_url":"https://api.github.com/users/bvaradar/following{/other_user}","gists_url":"https://api.github.com/users/bvaradar/gists{/gist_id}","starred_url":"https://api.github.com/users/bvaradar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bvaradar/subscriptions","organizations_url":"https://api.github.com/users/bvaradar/orgs","repos_url":"https://api.github.com/users/bvaradar/repos","events_url":"https://api.github.com/users/bvaradar/events{/privacy}","received_events_url":"https://api.github.com/users/bvaradar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-25T14:24:37Z","updated_at":"2021-02-25T14:24:37Z","author_association":"CONTRIBUTOR","body":"@root18039532923 : Please look at https://hudi.apache.org/blog/async-compaction-deployment-model/ for running async compactions","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785932137/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785933427","html_url":"https://github.com/apache/hudi/issues/2588#issuecomment-785933427","issue_url":"https://api.github.com/repos/apache/hudi/issues/2588","id":785933427,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTkzMzQyNw==","user":{"login":"rubenssoto","id":36298331,"node_id":"MDQ6VXNlcjM2Mjk4MzMx","avatar_url":"https://avatars.githubusercontent.com/u/36298331?v=4","gravatar_id":"","url":"https://api.github.com/users/rubenssoto","html_url":"https://github.com/rubenssoto","followers_url":"https://api.github.com/users/rubenssoto/followers","following_url":"https://api.github.com/users/rubenssoto/following{/other_user}","gists_url":"https://api.github.com/users/rubenssoto/gists{/gist_id}","starred_url":"https://api.github.com/users/rubenssoto/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rubenssoto/subscriptions","organizations_url":"https://api.github.com/users/rubenssoto/orgs","repos_url":"https://api.github.com/users/rubenssoto/repos","events_url":"https://api.github.com/users/rubenssoto/events{/privacy}","received_events_url":"https://api.github.com/users/rubenssoto/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-25T14:26:31Z","updated_at":"2021-02-25T14:26:31Z","author_association":"NONE","body":"@bvaradar I think it is a hive issue, I'm trying to increase hive heap size, I hope it helps.\r\n\r\nI process the tables in threads, so I have almost 20 hive connections open.\r\n\r\nDo you have any experience with Hudi and Hive? Because Hudi probably execute simple queries to verify table schema\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785933427/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785941366","html_url":"https://github.com/apache/hudi/issues/2586#issuecomment-785941366","issue_url":"https://api.github.com/repos/apache/hudi/issues/2586","id":785941366,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTk0MTM2Ng==","user":{"login":"Rap70r","id":22181358,"node_id":"MDQ6VXNlcjIyMTgxMzU4","avatar_url":"https://avatars.githubusercontent.com/u/22181358?v=4","gravatar_id":"","url":"https://api.github.com/users/Rap70r","html_url":"https://github.com/Rap70r","followers_url":"https://api.github.com/users/Rap70r/followers","following_url":"https://api.github.com/users/Rap70r/following{/other_user}","gists_url":"https://api.github.com/users/Rap70r/gists{/gist_id}","starred_url":"https://api.github.com/users/Rap70r/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Rap70r/subscriptions","organizations_url":"https://api.github.com/users/Rap70r/orgs","repos_url":"https://api.github.com/users/Rap70r/repos","events_url":"https://api.github.com/users/Rap70r/events{/privacy}","received_events_url":"https://api.github.com/users/Rap70r/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-25T14:37:42Z","updated_at":"2021-02-25T14:37:42Z","author_association":"NONE","body":"Hi nsivabalan,\r\n\r\nThank you for your reply.\r\n\r\n* Incremental updates include both inserts and updates. Mostly updates.\r\n* We can try increasing retention version to a higher value and improve readers time.\r\n* We would prefer sticking with COPY_ON_WRITE for now.\r\n\r\nI was wondering if we should look into table caching in Spark: https://spark.apache.org/docs/3.0.0-preview/sql-ref-syntax-aux-cache-cache-table.html\r\n\r\nAs this would cache the entire table into disk/memory and would work with that. The only downside I can think of is space issues. Are there any other disadvantages when using cache and persist?\r\n\r\nAlso, we're looking into improving reader's speed with combination of increasing retention version value. When reading a S3 Hudi dataset structure, does the number of partition affect the speed of readers? For example, if the table is partitioned into 200 folders or 1000 folders, by choosing different columns, would that affect the speed when reading the table by using Snapshot query: https://hudi.apache.org/docs/querying_data.html#spark-snap-query\r\n\r\nThank you","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/785941366/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/786029402","html_url":"https://github.com/apache/hudi/issues/2589#issuecomment-786029402","issue_url":"https://api.github.com/repos/apache/hudi/issues/2589","id":786029402,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NjAyOTQwMg==","user":{"login":"low-on-mana","id":8509512,"node_id":"MDQ6VXNlcjg1MDk1MTI=","avatar_url":"https://avatars.githubusercontent.com/u/8509512?v=4","gravatar_id":"","url":"https://api.github.com/users/low-on-mana","html_url":"https://github.com/low-on-mana","followers_url":"https://api.github.com/users/low-on-mana/followers","following_url":"https://api.github.com/users/low-on-mana/following{/other_user}","gists_url":"https://api.github.com/users/low-on-mana/gists{/gist_id}","starred_url":"https://api.github.com/users/low-on-mana/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/low-on-mana/subscriptions","organizations_url":"https://api.github.com/users/low-on-mana/orgs","repos_url":"https://api.github.com/users/low-on-mana/repos","events_url":"https://api.github.com/users/low-on-mana/events{/privacy}","received_events_url":"https://api.github.com/users/low-on-mana/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-25T16:28:02Z","updated_at":"2021-02-26T06:56:27Z","author_association":"CONTRIBUTOR","body":"@satishkotha Ran again on fresh table, still same issue. \r\n\r\nSparkSubmit:\r\n```\r\nspark-submit \r\n--master yarn \r\n--packages org.apache.spark:spark-avro_2.12:3.0.1,org.apache.hudi:hudi-utilities-bundle_2.12:0.7.0 \r\n--class org.apache.hudi.utilities.deltastreamer.HoodieDeltaStreamer \r\n--conf spark.scheduler.mode=FAIR \r\n--conf spark.task.maxFailures=5 \r\n--conf spark.rdd.compress=true \r\n--conf spark.serializer=org.apache.spark.serializer.KryoSerializer \r\n--conf spark.shuffle.service.enabled=true \r\n--conf spark.sql.hive.convertMetastoreParquet=false \r\n--conf spark.executor.heartbeatInterval=120s \r\n--conf spark.network.timeout=600s \r\n--conf spark.yarn.max.executor.failures=5 \r\n--conf spark.sql.catalogImplementation=hive \r\n--conf \"spark.driver.extraJavaOptions=-Dlog4j.configuration=/home/hadoop/log4j-spark.properties\" \r\n--conf \"spark.executor.extraJavaOptions=-Dlog4j.configuration=/home/hadoop/log4j-spark.properties\" \r\n--deploy-mode client s3://navi-emr-poc/delta-streamer-test/jars/deltastreamer-addons-1.0-SNAPSHOT.jar \r\n--enable-sync \r\n--hoodie-conf hoodie.datasource.hive_sync.partition_extractor_class=org.apache.hudi.hive.NonPartitionedExtractor \r\n--hoodie-conf hoodie.parquet.compression.codec=snappy \r\n--hoodie-conf partition.assignment.strategy=org.apache.kafka.clients.consumer.RangeAssignor \r\n--hoodie-conf hoodie.deltastreamer.schemaprovider.spark_avro_post_processor.enable=false \r\n--hoodie-conf auto.offset.reset=latest \r\n--hoodie-conf hoodie.avro.schema.validate=true\r\n--table-type MERGE_ON_READ \r\n--source-class org.apache.hudi.utilities.sources.AvroKafkaSource \r\n--schemaprovider-class org.apache.hudi.utilities.schema.NullTargetSchemaRegistryProvider  \r\n--props s3://navi-emr-poc/delta-streamer-test/config/kafka-source-nonprod.properties \r\n--transformer-class com.navi.transform.DebeziumTransformer \r\n--continuous \r\n--hoodie-conf hoodie.deltastreamer.schemaprovider.registry.url=https://dev-dataplatform-schema-registry.np.navi-tech.in/subjects/to_be_deleted_service.public.accounts-value/versions/latest \r\n--hoodie-conf hoodie.datasource.hive_sync.database=to_be_deleted_service \r\n--hoodie-conf hoodie.datasource.hive_sync.table=accounts \r\n--hoodie-conf hoodie.datasource.write.recordkey.field=id \r\n--hoodie-conf hoodie.datasource.write.precombine.field=__lsn \r\n--hoodie-conf hoodie.datasource.write.partitionpath.field='' \r\n--hoodie-conf hoodie.deltastreamer.source.kafka.topic=to_be_deleted_service.public.accounts \r\n--hoodie-conf group.id=delta-streamer-to_be_deleted_service-accounts \r\n--source-ordering-field __lsn \r\n--target-base-path s3://navi-emr-poc/raw-data/to_be_deleted_service/accounts \r\n--target-table accounts\r\n```\r\n\r\nTransformer Code:\r\n```\r\npublic class DebeziumTransformer implements Transformer {\r\n\r\n    public Dataset<Row> apply(JavaSparkContext javaSparkContext, SparkSession sparkSession,\r\n        Dataset<Row> dataset, TypedProperties typedProperties) {\r\n\r\n        Dataset<Row> transformedDataset = dataset\r\n            .withColumn(\"__deleted\", dataset.col(\"__deleted\").cast(DataTypes.BooleanType))\r\n            .withColumnRenamed(\"__deleted\", \"_hoodie_is_deleted\")\r\n            .drop(\"__op\", \"__source_ts_ms\");\r\n\r\n        log.info(\"TRANSFORMER SCHEMA STARTS\");\r\n        transformedDataset.printSchema();\r\n        transformedDataset.show();\r\n        log.info(\"TRANSFORMER SCHEMA ENDS\");\r\n        return transformedDataset;\r\n    }\r\n}\r\n```\r\n\r\nWhen I add the column, debezium updates the schema registry instantaneously and new records start flowing. Its possible that deltastreamer gets the new schema records before even hitting schema registry.\r\n\r\n```\r\nCaused by: org.apache.avro.AvroTypeException: Found hoodie.source.hoodie_source, expecting hoodie.source.hoodie_source, missing required field test\r\n```\r\n\r\nAttaching logs:\r\n[alog.txt](https://github.com/apache/hudi/files/6044367/alog.txt)\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/786029402/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/786183618","html_url":"https://github.com/apache/hudi/issues/2149#issuecomment-786183618","issue_url":"https://api.github.com/repos/apache/hudi/issues/2149","id":786183618,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NjE4MzYxOA==","user":{"login":"toninis","id":24205345,"node_id":"MDQ6VXNlcjI0MjA1MzQ1","avatar_url":"https://avatars.githubusercontent.com/u/24205345?v=4","gravatar_id":"","url":"https://api.github.com/users/toninis","html_url":"https://github.com/toninis","followers_url":"https://api.github.com/users/toninis/followers","following_url":"https://api.github.com/users/toninis/following{/other_user}","gists_url":"https://api.github.com/users/toninis/gists{/gist_id}","starred_url":"https://api.github.com/users/toninis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/toninis/subscriptions","organizations_url":"https://api.github.com/users/toninis/orgs","repos_url":"https://api.github.com/users/toninis/repos","events_url":"https://api.github.com/users/toninis/events{/privacy}","received_events_url":"https://api.github.com/users/toninis/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-25T20:29:56Z","updated_at":"2021-02-25T20:29:56Z","author_association":"NONE","body":"@vinothchandar \nSorry I took so long to respond . It had worked and compiled successfully . I probably had missed something at the time .\n\nThanks for your response at the time .","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/786183618/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/786183675","html_url":"https://github.com/apache/hudi/issues/2240#issuecomment-786183675","issue_url":"https://api.github.com/repos/apache/hudi/issues/2240","id":786183675,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NjE4MzY3NQ==","user":{"login":"kpurella","id":67808897,"node_id":"MDQ6VXNlcjY3ODA4ODk3","avatar_url":"https://avatars.githubusercontent.com/u/67808897?v=4","gravatar_id":"","url":"https://api.github.com/users/kpurella","html_url":"https://github.com/kpurella","followers_url":"https://api.github.com/users/kpurella/followers","following_url":"https://api.github.com/users/kpurella/following{/other_user}","gists_url":"https://api.github.com/users/kpurella/gists{/gist_id}","starred_url":"https://api.github.com/users/kpurella/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kpurella/subscriptions","organizations_url":"https://api.github.com/users/kpurella/orgs","repos_url":"https://api.github.com/users/kpurella/repos","events_url":"https://api.github.com/users/kpurella/events{/privacy}","received_events_url":"https://api.github.com/users/kpurella/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-25T20:30:02Z","updated_at":"2021-02-25T20:30:02Z","author_association":"NONE","body":"@vinothchandar Sure ,i will !!","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/786183675/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/786204481","html_url":"https://github.com/apache/hudi/issues/2399#issuecomment-786204481","issue_url":"https://api.github.com/repos/apache/hudi/issues/2399","id":786204481,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NjIwNDQ4MQ==","user":{"login":"afeldman1","id":4326577,"node_id":"MDQ6VXNlcjQzMjY1Nzc=","avatar_url":"https://avatars.githubusercontent.com/u/4326577?v=4","gravatar_id":"","url":"https://api.github.com/users/afeldman1","html_url":"https://github.com/afeldman1","followers_url":"https://api.github.com/users/afeldman1/followers","following_url":"https://api.github.com/users/afeldman1/following{/other_user}","gists_url":"https://api.github.com/users/afeldman1/gists{/gist_id}","starred_url":"https://api.github.com/users/afeldman1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/afeldman1/subscriptions","organizations_url":"https://api.github.com/users/afeldman1/orgs","repos_url":"https://api.github.com/users/afeldman1/repos","events_url":"https://api.github.com/users/afeldman1/events{/privacy}","received_events_url":"https://api.github.com/users/afeldman1/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-25T21:09:32Z","updated_at":"2021-02-25T21:09:32Z","author_association":"NONE","body":"Apologies for the delayed response. And thank you to @bvaradar for the initial hint. The issue turned out to be caused not by the keys but another one of the configuration properties. When the table was originally created there was a field specified for the \"hoodie.datasource.write.precombine.field\" property. When doing the delete operation, it did not seem to make sense to have to specify this field, so I left it out of the config. It seems if the table was created with this property set, all future operations on it are required to specify the same value for this property. I'm not sure if this requirement necessarily makes sense?\r\n\r\nIn terms of @nsivabalan 's questions:\r\nThis was not related to hudi versions.\r\nThis was found before releasing this piece to production, but seems to always act the same way.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/786204481/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/786361769","html_url":"https://github.com/apache/hudi/pull/2584#issuecomment-786361769","issue_url":"https://api.github.com/repos/apache/hudi/issues/2584","id":786361769,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NjM2MTc2OQ==","user":{"login":"garyli1019","id":23007841,"node_id":"MDQ6VXNlcjIzMDA3ODQx","avatar_url":"https://avatars.githubusercontent.com/u/23007841?v=4","gravatar_id":"","url":"https://api.github.com/users/garyli1019","html_url":"https://github.com/garyli1019","followers_url":"https://api.github.com/users/garyli1019/followers","following_url":"https://api.github.com/users/garyli1019/following{/other_user}","gists_url":"https://api.github.com/users/garyli1019/gists{/gist_id}","starred_url":"https://api.github.com/users/garyli1019/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/garyli1019/subscriptions","organizations_url":"https://api.github.com/users/garyli1019/orgs","repos_url":"https://api.github.com/users/garyli1019/repos","events_url":"https://api.github.com/users/garyli1019/events{/privacy}","received_events_url":"https://api.github.com/users/garyli1019/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-26T02:14:38Z","updated_at":"2021-02-26T02:14:38Z","author_association":"MEMBER","body":"hi @satishkotha , this PR seems related to #2583 , would you take a look?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/786361769/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/786364265","html_url":"https://github.com/apache/hudi/issues/2498#issuecomment-786364265","issue_url":"https://api.github.com/repos/apache/hudi/issues/2498","id":786364265,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NjM2NDI2NQ==","user":{"login":"garyli1019","id":23007841,"node_id":"MDQ6VXNlcjIzMDA3ODQx","avatar_url":"https://avatars.githubusercontent.com/u/23007841?v=4","gravatar_id":"","url":"https://api.github.com/users/garyli1019","html_url":"https://github.com/garyli1019","followers_url":"https://api.github.com/users/garyli1019/followers","following_url":"https://api.github.com/users/garyli1019/following{/other_user}","gists_url":"https://api.github.com/users/garyli1019/gists{/gist_id}","starred_url":"https://api.github.com/users/garyli1019/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/garyli1019/subscriptions","organizations_url":"https://api.github.com/users/garyli1019/orgs","repos_url":"https://api.github.com/users/garyli1019/repos","events_url":"https://api.github.com/users/garyli1019/events{/privacy}","received_events_url":"https://api.github.com/users/garyli1019/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-26T02:21:31Z","updated_at":"2021-02-26T02:21:31Z","author_association":"MEMBER","body":"I am seeing the same problem when the compiled spark distribution is different from the runtime spark distribution. Compile hudi jar against the runtime spark distribution should fix this problem. @green2k @andormarkus ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/786364265/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]