[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080047149","html_url":"https://github.com/apache/iceberg/pull/4396#issuecomment-1080047149","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4396","id":1080047149,"node_id":"IC_kwDOCW7NX85AYDYt","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-27T23:51:04Z","updated_at":"2022-03-27T23:58:59Z","author_association":"CONTRIBUTOR","body":"Explanation of the regex (which was buried in a comment):\r\n\r\nThe added regex has two parts\r\n\r\n1. `/\\\\*.*?\\\\*/` is for catching comments of the form /* …. */. We operate in (m) multi line mode to be able to catch the case where that comment spans multiple lines. The m allows for the . to match on a new line character. The (s) for single line mode allows for the ending `*/` to not _have_ to be at the end of the line.\r\n2. `--.*?\\\\n` is for catching simple SQL comments, that start with two dashes and then consume the rest of the line they are on like -- some line terminating comment. We operate in (s) single line mode here. We don’t risk hitting multi-line mode here really, eg having a comment like that also catch the next line, because we explicitly search for the newline character (and there’s a test for that case).\r\n\r\nAll of this is separated by `|`, which acts as the OR.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080047149/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080048340","html_url":"https://github.com/apache/iceberg/pull/4392#issuecomment-1080048340","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4392","id":1080048340,"node_id":"IC_kwDOCW7NX85AYDrU","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-27T23:58:05Z","updated_at":"2022-03-27T23:58:05Z","author_association":"CONTRIBUTOR","body":"@nastra can you rebase this so we can make sure it still works on the current master?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080048340/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080048601","html_url":"https://github.com/apache/iceberg/pull/4388#issuecomment-1080048601","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4388","id":1080048601,"node_id":"IC_kwDOCW7NX85AYDvZ","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-27T23:59:40Z","updated_at":"2022-03-27T23:59:40Z","author_association":"CONTRIBUTOR","body":"Looks good to me, but isn't it a bit strange to have caching at multiple levels?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080048601/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080048832","html_url":"https://github.com/apache/iceberg/pull/4388#issuecomment-1080048832","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4388","id":1080048832,"node_id":"IC_kwDOCW7NX85AYDzA","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-28T00:00:39Z","updated_at":"2022-03-28T00:00:39Z","author_association":"CONTRIBUTOR","body":"Thanks, @samarthjain!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080048832/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080050197","html_url":"https://github.com/apache/iceberg/pull/4386#issuecomment-1080050197","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4386","id":1080050197,"node_id":"IC_kwDOCW7NX85AYEIV","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-28T00:04:36Z","updated_at":"2022-03-28T00:04:36Z","author_association":"CONTRIBUTOR","body":"Looks good overall. Thanks, @yittg!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080050197/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080093110","html_url":"https://github.com/apache/iceberg/pull/4411#issuecomment-1080093110","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4411","id":1080093110,"node_id":"IC_kwDOCW7NX85AYOm2","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-28T01:38:58Z","updated_at":"2022-03-28T01:38:58Z","author_association":"CONTRIBUTOR","body":"Thanks for the fix.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080093110/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080107259","html_url":"https://github.com/apache/iceberg/pull/4364#issuecomment-1080107259","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4364","id":1080107259,"node_id":"IC_kwDOCW7NX85AYSD7","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-28T02:12:16Z","updated_at":"2022-03-28T02:12:16Z","author_association":"CONTRIBUTOR","body":"Great, with the unnecessary test projection removed, I think this is ready. It also looks like other discussion has been resolved, so I'll merge this.\r\n\r\nFor the new test failure, I talked with Kyle offline and we'll resolve it in a separate PR since it appears to be unrelated to this problem---it is position deletes that are the issue.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080107259/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080153051","html_url":"https://github.com/apache/iceberg/pull/3784#issuecomment-1080153051","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3784","id":1080153051,"node_id":"IC_kwDOCW7NX85AYdPb","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-28T03:55:46Z","updated_at":"2022-03-28T03:55:46Z","author_association":"MEMBER","body":"Got this merged now, thanks all for reviewing, and thanks @hililiwei for the contribution !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080153051/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080160516","html_url":"https://github.com/apache/iceberg/pull/3784#issuecomment-1080160516","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3784","id":1080160516,"node_id":"IC_kwDOCW7NX85AYfEE","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-28T04:10:08Z","updated_at":"2022-03-28T04:10:08Z","author_association":"CONTRIBUTOR","body":"Thanks openinx and all for reviewing. 😃 \r\nI'm going to start port it to multiple supported flink/spark versions and do some cleanup.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080160516/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080169180","html_url":"https://github.com/apache/iceberg/pull/4418#issuecomment-1080169180","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4418","id":1080169180,"node_id":"IC_kwDOCW7NX85AYhLc","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-28T04:22:58Z","updated_at":"2022-03-28T19:32:51Z","author_association":"CONTRIBUTOR","body":"It seems that the new tests aren't passing.\r\n\r\nI will scan tomorrow to see if I missed anything when backporting. And check if anything wasn't backported previously.\r\n\r\nThis also opens the wider discussion of how much longer we'll actively support Flink 1.12 once Flink 1.15 is released. There have been several major API changes to areas that directly impact our work. Once supporting Flink 1.12 becomes a high burden, we'll have to really consider how important it is for us and our users.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080169180/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080212954","html_url":"https://github.com/apache/iceberg/pull/4416#issuecomment-1080212954","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4416","id":1080212954,"node_id":"IC_kwDOCW7NX85AYr3a","user":{"login":"jun-he","id":12246263,"node_id":"MDQ6VXNlcjEyMjQ2MjYz","avatar_url":"https://avatars.githubusercontent.com/u/12246263?v=4","gravatar_id":"","url":"https://api.github.com/users/jun-he","html_url":"https://github.com/jun-he","followers_url":"https://api.github.com/users/jun-he/followers","following_url":"https://api.github.com/users/jun-he/following{/other_user}","gists_url":"https://api.github.com/users/jun-he/gists{/gist_id}","starred_url":"https://api.github.com/users/jun-he/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jun-he/subscriptions","organizations_url":"https://api.github.com/users/jun-he/orgs","repos_url":"https://api.github.com/users/jun-he/repos","events_url":"https://api.github.com/users/jun-he/events{/privacy}","received_events_url":"https://api.github.com/users/jun-he/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-28T05:31:32Z","updated_at":"2022-03-28T05:38:17Z","author_association":"COLLABORATOR","body":"@kbendick Thanks for the comment. \r\n\r\nI knew Jython can but not sure if cython can re-use Java implementation. Or might change both Java and Python to use a native C/C++ implementation?\r\n\r\nCurrently, I tried to keep python tests same as the Java tests, which are based on the examples in the spec.\r\n\r\nIn the past, we discussed [a related topic in a PR](https://github.com/apache/iceberg/pull/2836#issuecomment-884131235). [One agreed point ](https://github.com/apache/iceberg/pull/2836#issuecomment-884771775) in the discussion is that it might not be good to start duplicating guava bugs in other languages.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080212954/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080213843","html_url":"https://github.com/apache/iceberg/pull/4416#issuecomment-1080213843","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4416","id":1080213843,"node_id":"IC_kwDOCW7NX85AYsFT","user":{"login":"jun-he","id":12246263,"node_id":"MDQ6VXNlcjEyMjQ2MjYz","avatar_url":"https://avatars.githubusercontent.com/u/12246263?v=4","gravatar_id":"","url":"https://api.github.com/users/jun-he","html_url":"https://github.com/jun-he","followers_url":"https://api.github.com/users/jun-he/followers","following_url":"https://api.github.com/users/jun-he/following{/other_user}","gists_url":"https://api.github.com/users/jun-he/gists{/gist_id}","starred_url":"https://api.github.com/users/jun-he/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jun-he/subscriptions","organizations_url":"https://api.github.com/users/jun-he/orgs","repos_url":"https://api.github.com/users/jun-he/repos","events_url":"https://api.github.com/users/jun-he/events{/privacy}","received_events_url":"https://api.github.com/users/jun-he/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-28T05:33:37Z","updated_at":"2022-03-28T05:33:37Z","author_association":"COLLABORATOR","body":"@rdblue  open a new one just for bucketing. Can you take another look? Thanks.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080213843/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080215124","html_url":"https://github.com/apache/iceberg/pull/4416#issuecomment-1080215124","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4416","id":1080215124,"node_id":"IC_kwDOCW7NX85AYsZU","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-28T05:36:40Z","updated_at":"2022-03-28T05:36:40Z","author_association":"CONTRIBUTOR","body":"Oh that’s right. I do remember that discussion @jun-he. Thanks for the reminder.\r\n\r\nWe did eventually convert to the corrected version for Java, right? I think just having a handful of pre-chosen Unicode characters and other things that should be equal across the two would be a great start then. Perhaps with an explicit link to each other so the tests are specifically for interoperability.\r\n\r\nEspecially the (admittedly rare) Unicode characters that were originally causing issues, as well as other (non-English / ASCII characters) and numbers etc.\r\n\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080215124/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080241212","html_url":"https://github.com/apache/iceberg/pull/4392#issuecomment-1080241212","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4392","id":1080241212,"node_id":"IC_kwDOCW7NX85AYyw8","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-28T06:13:09Z","updated_at":"2022-03-28T06:13:09Z","author_association":"CONTRIBUTOR","body":"@rdblue rebased the PR. Will rebase again once https://github.com/apache/iceberg/pull/4385 and https://github.com/apache/iceberg/pull/4333 are in","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080241212/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080269331","html_url":"https://github.com/apache/iceberg/issues/4398#issuecomment-1080269331","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4398","id":1080269331,"node_id":"IC_kwDOCW7NX85AY5oT","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-28T06:57:56Z","updated_at":"2022-03-28T06:57:56Z","author_association":"MEMBER","body":"The correct `iceberg.version` for flink 1.14.x is `0.13.1`, you can take a look at this reference: \r\n\r\nhttps://mvnrepository.com/artifact/org.apache.iceberg/iceberg-flink-1.14","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080269331/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080289817","html_url":"https://github.com/apache/iceberg/issues/4403#issuecomment-1080289817","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4403","id":1080289817,"node_id":"IC_kwDOCW7NX85AY-oZ","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-28T07:22:29Z","updated_at":"2022-03-28T07:22:29Z","author_association":"CONTRIBUTOR","body":"Parquet vectorization is not supported yet.\r\nIn the Hive code we have https://issues.apache.org/jira/browse/HIVE-25902 which fixes the issue.\r\nWe need a Hive release to make it available here.\r\n\r\nCould you please try out the test without vectorization?\r\n\r\nThanks,\r\nPeter","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080289817/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080504744","html_url":"https://github.com/apache/iceberg/pull/3411#issuecomment-1080504744","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3411","id":1080504744,"node_id":"IC_kwDOCW7NX85AZzGo","user":{"login":"ConeyLiu","id":12733256,"node_id":"MDQ6VXNlcjEyNzMzMjU2","avatar_url":"https://avatars.githubusercontent.com/u/12733256?v=4","gravatar_id":"","url":"https://api.github.com/users/ConeyLiu","html_url":"https://github.com/ConeyLiu","followers_url":"https://api.github.com/users/ConeyLiu/followers","following_url":"https://api.github.com/users/ConeyLiu/following{/other_user}","gists_url":"https://api.github.com/users/ConeyLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/ConeyLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ConeyLiu/subscriptions","organizations_url":"https://api.github.com/users/ConeyLiu/orgs","repos_url":"https://api.github.com/users/ConeyLiu/repos","events_url":"https://api.github.com/users/ConeyLiu/events{/privacy}","received_events_url":"https://api.github.com/users/ConeyLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-28T11:01:38Z","updated_at":"2022-03-28T11:01:38Z","author_association":"CONTRIBUTOR","body":"Rebased, thanks for the reminder. @aokolnychyi ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080504744/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080588488","html_url":"https://github.com/apache/iceberg/pull/4273#issuecomment-1080588488","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4273","id":1080588488,"node_id":"IC_kwDOCW7NX85AaHjI","user":{"login":"zhongyujiang","id":42907416,"node_id":"MDQ6VXNlcjQyOTA3NDE2","avatar_url":"https://avatars.githubusercontent.com/u/42907416?v=4","gravatar_id":"","url":"https://api.github.com/users/zhongyujiang","html_url":"https://github.com/zhongyujiang","followers_url":"https://api.github.com/users/zhongyujiang/followers","following_url":"https://api.github.com/users/zhongyujiang/following{/other_user}","gists_url":"https://api.github.com/users/zhongyujiang/gists{/gist_id}","starred_url":"https://api.github.com/users/zhongyujiang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhongyujiang/subscriptions","organizations_url":"https://api.github.com/users/zhongyujiang/orgs","repos_url":"https://api.github.com/users/zhongyujiang/repos","events_url":"https://api.github.com/users/zhongyujiang/events{/privacy}","received_events_url":"https://api.github.com/users/zhongyujiang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-28T12:27:18Z","updated_at":"2022-03-28T12:27:18Z","author_association":"CONTRIBUTOR","body":"Updated based on #4291.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080588488/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080781855","html_url":"https://github.com/apache/iceberg/issues/4403#issuecomment-1080781855","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4403","id":1080781855,"node_id":"IC_kwDOCW7NX85Aa2wf","user":{"login":"tprelle","id":59021490,"node_id":"MDQ6VXNlcjU5MDIxNDkw","avatar_url":"https://avatars.githubusercontent.com/u/59021490?v=4","gravatar_id":"","url":"https://api.github.com/users/tprelle","html_url":"https://github.com/tprelle","followers_url":"https://api.github.com/users/tprelle/followers","following_url":"https://api.github.com/users/tprelle/following{/other_user}","gists_url":"https://api.github.com/users/tprelle/gists{/gist_id}","starred_url":"https://api.github.com/users/tprelle/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tprelle/subscriptions","organizations_url":"https://api.github.com/users/tprelle/orgs","repos_url":"https://api.github.com/users/tprelle/repos","events_url":"https://api.github.com/users/tprelle/events{/privacy}","received_events_url":"https://api.github.com/users/tprelle/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-28T15:15:01Z","updated_at":"2022-03-28T15:15:01Z","author_association":"CONTRIBUTOR","body":"It's working without vectorisation ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080781855/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080804203","html_url":"https://github.com/apache/iceberg/pull/3411#issuecomment-1080804203","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3411","id":1080804203,"node_id":"IC_kwDOCW7NX85Aa8Nr","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-28T15:34:04Z","updated_at":"2022-03-28T15:34:04Z","author_association":"MEMBER","body":"Thanks @ConeyLiu !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080804203/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080805318","html_url":"https://github.com/apache/iceberg/pull/3411#issuecomment-1080805318","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3411","id":1080805318,"node_id":"IC_kwDOCW7NX85Aa8fG","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-28T15:35:05Z","updated_at":"2022-03-28T15:35:05Z","author_association":"MEMBER","body":"Also thanks to all of the reviewers who took their time to check on this PR, I know this was a tricky issue and I'm glad we had so many eyes on the issue.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080805318/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080880106","html_url":"https://github.com/apache/iceberg/pull/4416#issuecomment-1080880106","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4416","id":1080880106,"node_id":"IC_kwDOCW7NX85AbOvq","user":{"login":"jun-he","id":12246263,"node_id":"MDQ6VXNlcjEyMjQ2MjYz","avatar_url":"https://avatars.githubusercontent.com/u/12246263?v=4","gravatar_id":"","url":"https://api.github.com/users/jun-he","html_url":"https://github.com/jun-he","followers_url":"https://api.github.com/users/jun-he/followers","following_url":"https://api.github.com/users/jun-he/following{/other_user}","gists_url":"https://api.github.com/users/jun-he/gists{/gist_id}","starred_url":"https://api.github.com/users/jun-he/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jun-he/subscriptions","organizations_url":"https://api.github.com/users/jun-he/orgs","repos_url":"https://api.github.com/users/jun-he/repos","events_url":"https://api.github.com/users/jun-he/events{/privacy}","received_events_url":"https://api.github.com/users/jun-he/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-28T16:33:39Z","updated_at":"2022-03-28T16:33:39Z","author_association":"COLLABORATOR","body":"@kbendick yep, totally agree to create an additional set of data to make sure the hash value to be the same for both Java and Python. I will create a doc (eventually should add it to the iceberg doc) and work with you together to make a list. Then add tests in both Java and Python in separate PRs.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080880106/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080930019","html_url":"https://github.com/apache/iceberg/pull/4318#issuecomment-1080930019","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4318","id":1080930019,"node_id":"IC_kwDOCW7NX85Aba7j","user":{"login":"samredai","id":43911210,"node_id":"MDQ6VXNlcjQzOTExMjEw","avatar_url":"https://avatars.githubusercontent.com/u/43911210?v=4","gravatar_id":"","url":"https://api.github.com/users/samredai","html_url":"https://github.com/samredai","followers_url":"https://api.github.com/users/samredai/followers","following_url":"https://api.github.com/users/samredai/following{/other_user}","gists_url":"https://api.github.com/users/samredai/gists{/gist_id}","starred_url":"https://api.github.com/users/samredai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samredai/subscriptions","organizations_url":"https://api.github.com/users/samredai/orgs","repos_url":"https://api.github.com/users/samredai/repos","events_url":"https://api.github.com/users/samredai/events{/privacy}","received_events_url":"https://api.github.com/users/samredai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-28T17:15:56Z","updated_at":"2022-03-28T17:15:56Z","author_association":"CONTRIBUTOR","body":"@rdblue thanks for the review! I brought over the the schema and visitors from the partition spec PR which also addresses the other comments.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080930019/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080983175","html_url":"https://github.com/apache/iceberg/pull/4318#issuecomment-1080983175","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4318","id":1080983175,"node_id":"IC_kwDOCW7NX85Abn6H","user":{"login":"samredai","id":43911210,"node_id":"MDQ6VXNlcjQzOTExMjEw","avatar_url":"https://avatars.githubusercontent.com/u/43911210?v=4","gravatar_id":"","url":"https://api.github.com/users/samredai","html_url":"https://github.com/samredai","followers_url":"https://api.github.com/users/samredai/followers","following_url":"https://api.github.com/users/samredai/following{/other_user}","gists_url":"https://api.github.com/users/samredai/gists{/gist_id}","starred_url":"https://api.github.com/users/samredai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samredai/subscriptions","organizations_url":"https://api.github.com/users/samredai/orgs","repos_url":"https://api.github.com/users/samredai/repos","events_url":"https://api.github.com/users/samredai/events{/privacy}","received_events_url":"https://api.github.com/users/samredai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-28T18:14:28Z","updated_at":"2022-03-30T05:03:37Z","author_association":"CONTRIBUTOR","body":"~The latest [click](https://pypi.org/project/click/#history) release has broken black (issue [here](https://github.com/psf/black/issues/2964)). I'm sure it'll be resolved soon enough so we can ignore these test failures for now. Alternatively we can temporarily add a pin for click in the tox file: `click == 8.0.4`~\r\n\r\nThis has been resolved","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080983175/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081060464","html_url":"https://github.com/apache/iceberg/pull/4407#issuecomment-1081060464","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4407","id":1081060464,"node_id":"IC_kwDOCW7NX85Ab6xw","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-28T19:37:21Z","updated_at":"2022-03-28T19:37:21Z","author_association":"MEMBER","body":"Thanks @singhpk234 for the PR @rdblue for helping out with review! Merged","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081060464/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081104903","html_url":"https://github.com/apache/iceberg/issues/4362#issuecomment-1081104903","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4362","id":1081104903,"node_id":"IC_kwDOCW7NX85AcFoH","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-28T20:23:44Z","updated_at":"2022-03-28T20:23:44Z","author_association":"CONTRIBUTOR","body":"I support converting the values when retrieving them for display purposes. This is an issue that I think many people encounter and would be beneficial to support.\r\n\r\nI would prefer to do it as a generated column from the metadata that users can select if they so choose. Something that is resolved at runtime. Or as an option to pass to the metadata table when querying it.\r\n\r\nAs for the stated options:\r\n\r\n> New fields on \"Files\" table under a new struct: ie files.resolved_metrics.upper_bound.\r\n\r\nMy concern with actually storing an additional separate field is that the metrics themselves on very large tables can become quite a lot of data. I'm thinking of tables with possibly hundreds of columns, or tables with a very large number of files / partitions that require a lot of metadata to track.\r\n\r\nDuplicating that on disk seems like it would cause headaches.\r\n\r\n> Change existing fields on \"Files\" table (is it possible to break backward-compatibility?)\r\n\r\nI don't like the idea of changing the spec to update the type of these values as stored.\r\n\r\nThere are now a lot of engines that support Iceberg, and growing all the time (see the recent Snowflake announcement, etc).\r\n\r\nSome of these implementations are outside of our immediate awareness,  or are possibly closed source / inner sourced implementations as well. These people rely on Iceberg's specification to ensure compatibility. This would be a breaking change, mostly for display purposes / human interaction as far as I can tell. Though the primary value of the metrics is for engines to use for decision purposes at runtime.\r\n\r\nIf we change the actual data on disk, I have a feeling we'll likely have to consider both for a long time which would make the code substantially harder to reason about.\r\n\r\n--------------\r\nSo **overall** +1 to doing something about displaying the metrics data properly for users to inspect, -0 to adding a new struct mirroring the original map in the table's metadata due to size concerns and the added difficulty this will bring for us, and -1 to the idea of changing the spec entirely.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081104903/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081116195","html_url":"https://github.com/apache/iceberg/issues/4362#issuecomment-1081116195","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4362","id":1081116195,"node_id":"IC_kwDOCW7NX85AcIYj","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-28T20:35:41Z","updated_at":"2022-03-28T20:39:24Z","author_association":"MEMBER","body":"> > Change existing fields on \"Files\" table (is it possible to break backward-compatibility?)\r\n> \r\n> I don't like the idea of changing the spec to update the type of these values as stored.\r\n> \r\n> There are now a lot of engines that support Iceberg, and growing all the time (see the recent Snowflake announcement, etc).\r\n\r\nMy suggestion here was to change the metadata table view, not the underlying spec. Ie although the value is in binary, it probably has little value to the SparkSQL user to read them in binary so we may want to change them to either strings or the actual types of those columns when we return the values","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081116195/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081132003","html_url":"https://github.com/apache/iceberg/issues/4362#issuecomment-1081132003","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4362","id":1081132003,"node_id":"IC_kwDOCW7NX85AcMPj","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-28T20:52:21Z","updated_at":"2022-03-28T20:52:21Z","author_association":"CONTRIBUTOR","body":"What we did for the metadata tables in Trino was to produce structs, like @szehon-ho suggested. The idea is that you'd get a struct for each column name that contains value_count, null_count, upper_bound, lower_bound, etc. And each of those would have the correct data type.\r\n\r\nI think that's generally the right direction. The main challenge is that in Spark we originally didn't have a good way to transform the maps into rows. But now we can do it using [`DataTask`](https://iceberg.apache.org/javadoc/latest/org/apache/iceberg/DataTask.html), which we use for similar transforms elsewhere.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081132003/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081241359","html_url":"https://github.com/apache/iceberg/issues/4159#issuecomment-1081241359","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4159","id":1081241359,"node_id":"IC_kwDOCW7NX85Acm8P","user":{"login":"anuragmantri","id":13743212,"node_id":"MDQ6VXNlcjEzNzQzMjEy","avatar_url":"https://avatars.githubusercontent.com/u/13743212?v=4","gravatar_id":"","url":"https://api.github.com/users/anuragmantri","html_url":"https://github.com/anuragmantri","followers_url":"https://api.github.com/users/anuragmantri/followers","following_url":"https://api.github.com/users/anuragmantri/following{/other_user}","gists_url":"https://api.github.com/users/anuragmantri/gists{/gist_id}","starred_url":"https://api.github.com/users/anuragmantri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/anuragmantri/subscriptions","organizations_url":"https://api.github.com/users/anuragmantri/orgs","repos_url":"https://api.github.com/users/anuragmantri/repos","events_url":"https://api.github.com/users/anuragmantri/events{/privacy}","received_events_url":"https://api.github.com/users/anuragmantri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-28T23:14:25Z","updated_at":"2022-03-28T23:24:14Z","author_association":"CONTRIBUTOR","body":"Thanks for this thread. \r\n\r\n> One valuable thing to add in the Iceberg spec is the list (or set?) of all the table locations used.\r\n\r\nThis makes sense but we should define what this list means. There are some questions that come to my mind. \r\n- Do these locations mean a table can have multiple root locations simultaneously? \r\n- How does this work when object store path is used since users may have same object store path bucket for multiple tables?\r\n- In case of DR, the table is replicated to a different location. Are all of these replicated locations part of this list? \r\n\r\nIncidentally, most of these questions also came up in the [dev discussion ](https://lists.apache.org/list?dev@iceberg.apache.org:2021-8:Iceberg%20disaster%20recovery%20and%20relative%20path%20sync-up) on relative paths/DR strategy. A single location prefix support will be added as part of `Phase 1`. If you agree, maybe I can decouple location prefix support with relative paths and create PR just for that change first.\r\n\r\nSupporting multiple roots is mentioned in `Phase 2` in [this design doc](https://docs.google.com/document/d/1RDEjJAVEXg1csRzyzTuM634L88vvI0iDHNQQK3kOVR0/edit#heading=h.last3sm2iqbr). Implementation is yet to be discussed. It maybe a good idea to discuss it here.\r\n\r\nComing back to the problem, assuming we have such a list of owned table locations, how would we make sure all the files in these locations are indeed owned by Iceberg table? In other words, can we safely delete `all` files in these locations?\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081241359/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081251190","html_url":"https://github.com/apache/iceberg/pull/4405#issuecomment-1081251190","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4405","id":1081251190,"node_id":"IC_kwDOCW7NX85AcpV2","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-28T23:31:55Z","updated_at":"2022-03-28T23:31:55Z","author_association":"CONTRIBUTOR","body":"> Should this also update the `RESTClient` interface?\r\n\r\nYes. Also `HTTPClient`. Plus associated tests classes such as `RESTCatalogAdapter`.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081251190/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081263777","html_url":"https://github.com/apache/iceberg/pull/4412#issuecomment-1081263777","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4412","id":1081263777,"node_id":"IC_kwDOCW7NX85Acsah","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-28T23:59:37Z","updated_at":"2022-03-28T23:59:37Z","author_association":"CONTRIBUTOR","body":"Thanks for reviewing, @danielcweeks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081263777/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081264076","html_url":"https://github.com/apache/iceberg/pull/4413#issuecomment-1081264076","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4413","id":1081264076,"node_id":"IC_kwDOCW7NX85AcsfM","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-29T00:00:20Z","updated_at":"2022-03-29T00:00:20Z","author_association":"CONTRIBUTOR","body":"Thanks for reviewing, @danielcweeks and @kbendick!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081264076/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081268434","html_url":"https://github.com/apache/iceberg/pull/4415#issuecomment-1081268434","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4415","id":1081268434,"node_id":"IC_kwDOCW7NX85ActjS","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-29T00:08:39Z","updated_at":"2022-03-29T00:08:39Z","author_association":"CONTRIBUTOR","body":"cc @openinx @stevenzwu @hililiwei you might be interested in this additional bug I found when using Flink in upsert mode.\r\n\r\nOf these two tests, the first one _does not_ pass, and the second one does (as noted).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081268434/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081273709","html_url":"https://github.com/apache/iceberg/issues/3941#issuecomment-1081273709","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3941","id":1081273709,"node_id":"IC_kwDOCW7NX85Acu1t","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-29T00:16:46Z","updated_at":"2022-03-29T18:20:47Z","author_association":"CONTRIBUTOR","body":"@flyrain @RussellSpitzer and I chatted a little bit about the design and what a potential implementation can look like. There is a promising idea of using `_deleted` metadata column for building delete records.\r\n\r\nI'll summarize my current way of thinking.\r\n\r\n**Algorithm (per snapshot)**\r\n\r\n* Build insert records.\r\n    * Read all data files added in this snapshot and apply any matching position delete files added in the same snapshot. Equality deletes added in the same snapshot cannot apply (according to the spec).\r\n* Build delete records.\r\n    * Read all data files marked as deleted in this snapshot. All such records are considered V1 deletes.\r\n    * Build a predicate to use when looking for data records removed by position deletes.\r\n        * Scan through metadata for added position delete files and identify affected partitions (no need to open delete files).\r\n        * Build a predicate using min/max values on file path (no need to open delete files).\r\n        * [future] If the total number of position delete records is reasonably small, read all of the locations and form an IN predicate on file path.  The read can be either distributed or local.\r\n    * Build a predicate to use when looking for data records removed by equality deletes.\r\n        * Scan through metadata for added equality delete files and identify affected partitions (no need to open delete files).\r\n        * Build a predicate using min/max values on identity columns or sort keys if such are present in equality delete files.\r\n        * [future] If the total number of equality deletes is small, read all deleted values and form IN predicates on their values. To make this efficient, we may need to add support for IN predicates on multiple columns at the same time. That’s will require effort given the current expression API in Iceberg.\r\n    * Combine the two predicates using OR. This will be the predicate to look for V2 deletes.\r\n    * Read data files that have potential V2 deletes, project `_deleted` column and keep only deleted records.\r\n    * Union V1 and V2 delete records. This gives us all deletes that happened in this snapshot.\r\n* Append metadata such as `_commit_snapshot_id` or `_record_type` to both insert and delete records.\r\n* Union insert and delete records into a single DataFrame that represents a CDC log for this snapshot.\r\n\r\nThe algorithm is simple with the only downside is that it may be expensive to resolve equality deletes as they may not be scoped to any partitions. If there is a global equality delete, resolving it and finding all records that were deleted will require a full table scan. In the future, we may consider exposing an option to include equality deletes as-is without finding actually deleted records. If set to false, a delete record will only contain whatever values are in the delete file. Outputting equality deletes as-is may be enough in many cases.\r\n\r\n**How to apply changes to Iceberg tables?**\r\nWe should be able to apply a CDC log from one Iceberg table to another by simply converting the log to data and equality delete files without doing a MERGE operation.\r\n\r\n**How to apply changes to non-Iceberg tables?**\r\nUse a MERGE operation. Note: whenever a CDC log is fetched, consumers may need to collapse changes that happened across snapshots to not violate the cardinality check in MERGE.\r\n\r\n**Do we have to output _identity_columns if equality deletes are resolved?** \r\nProbably, not. That’s why we may omit the requirement for having identity columns defined (at least, for now). \r\n\r\n**What should happen if a row is added and removed in the same snapshot?**\r\nSkip such records by default. If configured to output such records, we may do so by having different `_commit_order` within the same snapshot.\r\n\r\n**Can we support pre/post images?**\r\nI think pre/post images can be computed if equality delete resolution is enabled and identity columns are defined and never changed. Then we can distribute and order records in a way that will co-locate deletes and inserts for the same key next to each other. This should be sufficient to produce pre and post images.\r\n\r\n**Shall we output unchanged rows that were copied over during copy-on-write?**\r\nI'd output copied over rows by default as it is technically correct: we remove and add back such records from the table format perspective. We may expose an option in the future to skip such records but it will require extra work. Similarly to to pre/post images, if we can co-locate deletes and inserts for the same key next to each other, we may skip delete and insert if no value has changed. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081273709/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081286111","html_url":"https://github.com/apache/iceberg/pull/4395#issuecomment-1081286111","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4395","id":1081286111,"node_id":"IC_kwDOCW7NX85Acx3f","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-29T00:43:11Z","updated_at":"2022-03-29T00:43:11Z","author_association":"CONTRIBUTOR","body":"> > Note that in order for the Spark UI to show the value of the custom metric, the custom metric class must be available in the classpath of the Spark History Server. The simplest way to do this is to put the Iceberg Spark runtime JAR in the SHS classpath. Spark's `SQLAppStatusListener` loads the custom metric class by name, instantiates it, and calls its `aggregateTaskMetrics` method to get the value of the metric. If it is not able to load the custom metric class, it shows \"N/A\".\r\n> \r\n> Yeah I was very frustrated with this when i was messing with it. Makes it hard if your history server is not running the same Spark build as your apps :(\r\n\r\nThis qualification for the history server would be a really good thing to call out in the docs somewhere if we merge this.\r\n\r\n>> In the current code we would get incorrect results for number of data files if our split size is smaller than our file size. Imagine we have a 512 mb file and 128 mb split size (and row group) this will generate 4 separate tasks for the same Data file. Counting the file 4 times.\r\n\r\n> That is a good point. Even so, such a count is still a useful metric, in that it is a measure of amount of work to do, although \"number of files\" is not the correct name for it. Of course, the actual number of files is a metric we're interested in as well.\r\n\r\nI also think there's value in this. Would it just be better to call it \"number of splits read\" or something? Provided we can give it a name that clearly delineates what is being measured, I think this has value.\r\n\r\nThough ideally metrics could be exported from the driver as well (which would need to be added to Spark).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081286111/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081291065","html_url":"https://github.com/apache/iceberg/pull/4421#issuecomment-1081291065","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4421","id":1081291065,"node_id":"IC_kwDOCW7NX85AczE5","user":{"login":"felixYyu","id":3785228,"node_id":"MDQ6VXNlcjM3ODUyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3785228?v=4","gravatar_id":"","url":"https://api.github.com/users/felixYyu","html_url":"https://github.com/felixYyu","followers_url":"https://api.github.com/users/felixYyu/followers","following_url":"https://api.github.com/users/felixYyu/following{/other_user}","gists_url":"https://api.github.com/users/felixYyu/gists{/gist_id}","starred_url":"https://api.github.com/users/felixYyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixYyu/subscriptions","organizations_url":"https://api.github.com/users/felixYyu/orgs","repos_url":"https://api.github.com/users/felixYyu/repos","events_url":"https://api.github.com/users/felixYyu/events{/privacy}","received_events_url":"https://api.github.com/users/felixYyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-29T00:53:40Z","updated_at":"2022-03-29T00:53:40Z","author_association":"CONTRIBUTOR","body":"suggested to merge the same type of issue into one pr.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081291065/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081304379","html_url":"https://github.com/apache/iceberg/pull/4301#issuecomment-1081304379","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4301","id":1081304379,"node_id":"IC_kwDOCW7NX85Ac2U7","user":{"login":"rzhang10","id":75445426,"node_id":"MDQ6VXNlcjc1NDQ1NDI2","avatar_url":"https://avatars.githubusercontent.com/u/75445426?v=4","gravatar_id":"","url":"https://api.github.com/users/rzhang10","html_url":"https://github.com/rzhang10","followers_url":"https://api.github.com/users/rzhang10/followers","following_url":"https://api.github.com/users/rzhang10/following{/other_user}","gists_url":"https://api.github.com/users/rzhang10/gists{/gist_id}","starred_url":"https://api.github.com/users/rzhang10/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rzhang10/subscriptions","organizations_url":"https://api.github.com/users/rzhang10/orgs","repos_url":"https://api.github.com/users/rzhang10/repos","events_url":"https://api.github.com/users/rzhang10/events{/privacy}","received_events_url":"https://api.github.com/users/rzhang10/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-29T01:23:05Z","updated_at":"2022-03-29T01:23:05Z","author_association":"CONTRIBUTOR","body":"One minor issue: I noticed that although this pr is making changes to the spec.md file, github doesn't give this pr a `docs` tag, is the `format/spec.md` file tracked incorrectly?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081304379/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081316013","html_url":"https://github.com/apache/iceberg/pull/4419#issuecomment-1081316013","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4419","id":1081316013,"node_id":"IC_kwDOCW7NX85Ac5Kt","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-29T01:49:00Z","updated_at":"2022-03-29T01:49:00Z","author_association":"MEMBER","body":"As this is a minor change for the specific engine version,  could you please create a single PR to include all those changes for all engine versions ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081316013/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081316501","html_url":"https://github.com/apache/iceberg/pull/4420#issuecomment-1081316501","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4420","id":1081316501,"node_id":"IC_kwDOCW7NX85Ac5SV","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-29T01:50:16Z","updated_at":"2022-03-29T01:50:16Z","author_association":"MEMBER","body":"As the [comment](https://github.com/apache/iceberg/pull/4419#issuecomment-1081316013) said, I would like to close this PR now. Thanks @hililiwei .","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081316501/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081317020","html_url":"https://github.com/apache/iceberg/pull/4421#issuecomment-1081317020","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4421","id":1081317020,"node_id":"IC_kwDOCW7NX85Ac5ac","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-29T01:51:33Z","updated_at":"2022-03-29T01:51:33Z","author_association":"MEMBER","body":"Let's close this PR now , according to @felixYyu 's comment and this [comment](https://github.com/apache/iceberg/pull/4419#issuecomment-1081316013). ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081317020/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081319615","html_url":"https://github.com/apache/iceberg/pull/3411#issuecomment-1081319615","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3411","id":1081319615,"node_id":"IC_kwDOCW7NX85Ac6C_","user":{"login":"ConeyLiu","id":12733256,"node_id":"MDQ6VXNlcjEyNzMzMjU2","avatar_url":"https://avatars.githubusercontent.com/u/12733256?v=4","gravatar_id":"","url":"https://api.github.com/users/ConeyLiu","html_url":"https://github.com/ConeyLiu","followers_url":"https://api.github.com/users/ConeyLiu/followers","following_url":"https://api.github.com/users/ConeyLiu/following{/other_user}","gists_url":"https://api.github.com/users/ConeyLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/ConeyLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ConeyLiu/subscriptions","organizations_url":"https://api.github.com/users/ConeyLiu/orgs","repos_url":"https://api.github.com/users/ConeyLiu/repos","events_url":"https://api.github.com/users/ConeyLiu/events{/privacy}","received_events_url":"https://api.github.com/users/ConeyLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-29T01:57:53Z","updated_at":"2022-03-29T01:57:53Z","author_association":"CONTRIBUTOR","body":"Thanks all!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081319615/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081326294","html_url":"https://github.com/apache/iceberg/pull/4415#issuecomment-1081326294","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4415","id":1081326294,"node_id":"IC_kwDOCW7NX85Ac7rW","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-29T02:11:07Z","updated_at":"2022-03-29T02:11:07Z","author_association":"CONTRIBUTOR","body":"> cc @openinx @stevenzwu @hililiwei you might be interested in this additional bug I found when using Flink in upsert mode.\r\n> \r\n> Of these two tests, the first one _does not_ pass, and the second one does (as noted).\r\n\r\nLooks interesting. Let me try. Thanks for Ping me. 😃 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081326294/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081329570","html_url":"https://github.com/apache/iceberg/pull/4419#issuecomment-1081329570","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4419","id":1081329570,"node_id":"IC_kwDOCW7NX85Ac8ei","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-29T02:17:49Z","updated_at":"2022-03-29T02:17:49Z","author_association":"CONTRIBUTOR","body":"> As this is a minor change for the specific engine version, could you please create a single PR to include all those changes for all engine versions ?\r\n\r\nIs the modification of Flink also submitted here or a separate PR?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081329570/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081349145","html_url":"https://github.com/apache/iceberg/pull/4419#issuecomment-1081349145","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4419","id":1081349145,"node_id":"IC_kwDOCW7NX85AdBQZ","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-29T03:00:20Z","updated_at":"2022-03-29T03:00:20Z","author_association":"MEMBER","body":"I think it's fair to make all the engine's changes into a single PR.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081349145/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081379394","html_url":"https://github.com/apache/iceberg/pull/4401#issuecomment-1081379394","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4401","id":1081379394,"node_id":"IC_kwDOCW7NX85AdIpC","user":{"login":"Ranjith-AR","id":98068359,"node_id":"U_kgDOBdhnhw","avatar_url":"https://avatars.githubusercontent.com/u/98068359?v=4","gravatar_id":"","url":"https://api.github.com/users/Ranjith-AR","html_url":"https://github.com/Ranjith-AR","followers_url":"https://api.github.com/users/Ranjith-AR/followers","following_url":"https://api.github.com/users/Ranjith-AR/following{/other_user}","gists_url":"https://api.github.com/users/Ranjith-AR/gists{/gist_id}","starred_url":"https://api.github.com/users/Ranjith-AR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Ranjith-AR/subscriptions","organizations_url":"https://api.github.com/users/Ranjith-AR/orgs","repos_url":"https://api.github.com/users/Ranjith-AR/repos","events_url":"https://api.github.com/users/Ranjith-AR/events{/privacy}","received_events_url":"https://api.github.com/users/Ranjith-AR/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-29T04:08:00Z","updated_at":"2022-03-29T09:44:02Z","author_association":"NONE","body":"> \r\n> ```sql\r\n> CREATE EXTERNAL TABLE mytable ([(col_name1 col_datatype1, ...)])\r\n> [PARTITIONED BY (col_name2 col_datatype2, ...)]\r\n> ROW FORMAT SERDE 'org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe'\r\n> STORED AS INPUTFORMAT 'org.apache.hadoop.hive.ql.io.SymlinkTextInputFormat'\r\n> OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'\r\n> LOCATION '<symlink-table-root-path>' \r\n> ```\r\n> \r\n> \r\n> The procedure looks like:\r\n> \r\n> ```\r\n> CALL catalog.system.generate_symlink_format_manifest(\r\n>   table => 'table_name', \r\n>   symlink_root_location => 's3://some/path'\r\n> );\r\n> ```\r\n> \r\n> The `symlink_root_location` is optional. The default is `<table_root>/_symlink_format_manifest/<snapshot_id>`. A snapshot ID suffix is added because if this procedure is executed twice against the same table, we don't want to mix the results if the table is updated. If users want to use a consistent root path for the symlink table, it could be input as an override.\r\n> \r\n\r\n\r\n**in the above default location \"<table_root>/_symlink_format_manifest/<snapshot_id>\", \r\nwhat is the name of the manifest file ? /<snapshot_id>_manifest ? or just  /<snapshot_id> ?\r\n\r\nin either case, does this mean whenever I regenerate the symlink_format_manifest file, i have to alter the external table location to reflect the latest manifest file ?\r\n\r\nhow to execute the procedure to override / exclude the snapshot_id prefix and generate manifest file like below\r\n\"<table_root>/_symlink_format_manifest/manifest\" ?**\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081379394/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081381420","html_url":"https://github.com/apache/iceberg/pull/4419#issuecomment-1081381420","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4419","id":1081381420,"node_id":"IC_kwDOCW7NX85AdJIs","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-29T04:12:10Z","updated_at":"2022-03-29T04:12:10Z","author_association":"CONTRIBUTOR","body":"> I think it's fair to make all the engine's changes into a single PR.\r\n\r\nUpdated code and PR description.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081381420/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081407723","html_url":"https://github.com/apache/iceberg/issues/3895#issuecomment-1081407723","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3895","id":1081407723,"node_id":"IC_kwDOCW7NX85AdPjr","user":{"login":"molsionmo","id":52347588,"node_id":"MDQ6VXNlcjUyMzQ3NTg4","avatar_url":"https://avatars.githubusercontent.com/u/52347588?v=4","gravatar_id":"","url":"https://api.github.com/users/molsionmo","html_url":"https://github.com/molsionmo","followers_url":"https://api.github.com/users/molsionmo/followers","following_url":"https://api.github.com/users/molsionmo/following{/other_user}","gists_url":"https://api.github.com/users/molsionmo/gists{/gist_id}","starred_url":"https://api.github.com/users/molsionmo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/molsionmo/subscriptions","organizations_url":"https://api.github.com/users/molsionmo/orgs","repos_url":"https://api.github.com/users/molsionmo/repos","events_url":"https://api.github.com/users/molsionmo/events{/privacy}","received_events_url":"https://api.github.com/users/molsionmo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-29T05:06:27Z","updated_at":"2022-03-29T05:06:27Z","author_association":"NONE","body":"Is it over?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081407723/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081465039","html_url":"https://github.com/apache/iceberg/pull/4342#issuecomment-1081465039","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4342","id":1081465039,"node_id":"IC_kwDOCW7NX85AddjP","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-29T06:44:03Z","updated_at":"2022-03-29T06:44:03Z","author_association":"CONTRIBUTOR","body":"@danielcweeks do you have any additional suggestions? If not I think the current approach that Ryan suggested and the current code path looks good to me.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081465039/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081476418","html_url":"https://github.com/apache/iceberg/pull/4376#issuecomment-1081476418","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4376","id":1081476418,"node_id":"IC_kwDOCW7NX85AdgVC","user":{"login":"felixYyu","id":3785228,"node_id":"MDQ6VXNlcjM3ODUyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3785228?v=4","gravatar_id":"","url":"https://api.github.com/users/felixYyu","html_url":"https://github.com/felixYyu","followers_url":"https://api.github.com/users/felixYyu/followers","following_url":"https://api.github.com/users/felixYyu/following{/other_user}","gists_url":"https://api.github.com/users/felixYyu/gists{/gist_id}","starred_url":"https://api.github.com/users/felixYyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixYyu/subscriptions","organizations_url":"https://api.github.com/users/felixYyu/orgs","repos_url":"https://api.github.com/users/felixYyu/repos","events_url":"https://api.github.com/users/felixYyu/events{/privacy}","received_events_url":"https://api.github.com/users/felixYyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-29T06:48:32Z","updated_at":"2022-03-29T06:48:32Z","author_association":"CONTRIBUTOR","body":"please review again，thanks @RussellSpitzer","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081476418/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081530559","html_url":"https://github.com/apache/iceberg/pull/3998#issuecomment-1081530559","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3998","id":1081530559,"node_id":"IC_kwDOCW7NX85Adti_","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-29T07:38:59Z","updated_at":"2022-03-29T07:38:59Z","author_association":"CONTRIBUTOR","body":"> I'm okay to add customized properties to override the table properties for a given write flink job, BUT I'm very concern that the current PR did not make the merged properties go though the whole write path because I still see lots of places in write path just use the table properties to parse the configured keys ( That means the customized properties will be useless , although we've customized it).\r\n> \r\n> For example, The [RowDataTaskWriterFactory](https://github.com/apache/iceberg/blob/340a0c5f30a7fb1e33dde4c1f082fd4cb9f7472f/flink/v1.14/flink/src/main/java/org/apache/iceberg/flink/sink/RowDataTaskWriterFactory.java#L88) will use the serialized table to initialize the `OutputFileFactory` which will use the table properties ....\r\n\r\nThanks for the correction. Let me go through as many end to end as I can and see what I'm missing.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081530559/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081545116","html_url":"https://github.com/apache/iceberg/pull/3991#issuecomment-1081545116","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3991","id":1081545116,"node_id":"IC_kwDOCW7NX85AdxGc","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-29T07:53:12Z","updated_at":"2022-03-29T08:01:20Z","author_association":"CONTRIBUTOR","body":"Hi @openinx, according to the feedback from our team's internal trial, I have updated a new version. When you are free, would you please help to have a look? thank you. 😃 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081545116/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081599447","html_url":"https://github.com/apache/iceberg/pull/4419#issuecomment-1081599447","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4419","id":1081599447,"node_id":"IC_kwDOCW7NX85Ad-XX","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-29T08:46:31Z","updated_at":"2022-03-29T08:46:31Z","author_association":"MEMBER","body":"I just checked all the ORC rolling file writer unit tests, all unit tests seems to be enabled after this PR:\r\n\r\n```\r\n➜  iceberg git:(4419) find . -type f -name '*.java'  | xargs grep -i 'Assume.*ORC'\r\n./mr/src/test/java/org/apache/iceberg/mr/hive/TestHiveIcebergStorageHandlerWithEngine.java:    assumeTrue(isVectorized && FileFormat.ORC.equals(fileFormat));\r\n./hive3/src/main/java/org/apache/iceberg/mr/hive/vector/HiveVectorizedReader.java:    // reader will assume that the ORC file ends at the task's start + length, and might fail reading the tail..\r\n./data/src/test/java/org/apache/iceberg/data/TestMetricsRowGroupFilter.java:    Assume.assumeFalse(\"ORC row group filter does not support StringStartsWith\", format == FileFormat.ORC);\r\n./data/src/test/java/org/apache/iceberg/data/TestMetricsRowGroupFilter.java:    Assume.assumeFalse(\"ORC row group filter does not support StringStartsWith\", format == FileFormat.ORC);\r\n./spark/v3.2/spark/src/test/java/org/apache/iceberg/spark/source/TestSparkMetadataColumns.java:    Assume.assumeFalse(fileFormat == FileFormat.ORC && vectorized);\r\n./spark/v3.0/spark/src/test/java/org/apache/iceberg/spark/source/TestSparkMetadataColumns.java:    Assume.assumeFalse(fileFormat == FileFormat.ORC && vectorized);\r\n./spark/v3.1/spark/src/test/java/org/apache/iceberg/spark/source/TestSparkMetadataColumns.java:    Assume.assumeFalse(fileFormat == FileFormat.ORC && vectorized);\r\n➜  iceberg git:(4419) find . -type f -name '*.scala'  | xargs grep -i 'TODO.*orc' \r\n➜  iceberg git:(4419) find . -type f -name '*.java'  | xargs grep -i 'Assume.*ORC'\r\n./mr/src/test/java/org/apache/iceberg/mr/hive/TestHiveIcebergStorageHandlerWithEngine.java:    assumeTrue(isVectorized && FileFormat.ORC.equals(fileFormat));\r\n./hive3/src/main/java/org/apache/iceberg/mr/hive/vector/HiveVectorizedReader.java:    // reader will assume that the ORC file ends at the task's start + length, and might fail reading the tail..\r\n./data/src/test/java/org/apache/iceberg/data/TestMetricsRowGroupFilter.java:    Assume.assumeFalse(\"ORC row group filter does not support StringStartsWith\", format == FileFormat.ORC);\r\n./data/src/test/java/org/apache/iceberg/data/TestMetricsRowGroupFilter.java:    Assume.assumeFalse(\"ORC row group filter does not support StringStartsWith\", format == FileFormat.ORC);\r\n./spark/v3.2/spark/src/test/java/org/apache/iceberg/spark/source/TestSparkMetadataColumns.java:    Assume.assumeFalse(fileFormat == FileFormat.ORC && vectorized);\r\n./spark/v3.0/spark/src/test/java/org/apache/iceberg/spark/source/TestSparkMetadataColumns.java:    Assume.assumeFalse(fileFormat == FileFormat.ORC && vectorized);\r\n./spark/v3.1/spark/src/test/java/org/apache/iceberg/spark/source/TestSparkMetadataColumns.java:    Assume.assumeFalse(fileFormat == FileFormat.ORC && vectorized);\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081599447/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081625703","html_url":"https://github.com/apache/iceberg/issues/3431#issuecomment-1081625703","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3431","id":1081625703,"node_id":"IC_kwDOCW7NX85AeExn","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-29T09:12:54Z","updated_at":"2022-03-29T09:12:54Z","author_association":"MEMBER","body":"Closed via https://github.com/apache/iceberg/pull/3240.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081625703/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081770090","html_url":"https://github.com/apache/iceberg/pull/4425#issuecomment-1081770090","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4425","id":1081770090,"node_id":"IC_kwDOCW7NX85AeoBq","user":{"login":"felixYyu","id":3785228,"node_id":"MDQ6VXNlcjM3ODUyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3785228?v=4","gravatar_id":"","url":"https://api.github.com/users/felixYyu","html_url":"https://github.com/felixYyu","followers_url":"https://api.github.com/users/felixYyu/followers","following_url":"https://api.github.com/users/felixYyu/following{/other_user}","gists_url":"https://api.github.com/users/felixYyu/gists{/gist_id}","starred_url":"https://api.github.com/users/felixYyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixYyu/subscriptions","organizations_url":"https://api.github.com/users/felixYyu/orgs","repos_url":"https://api.github.com/users/felixYyu/repos","events_url":"https://api.github.com/users/felixYyu/events{/privacy}","received_events_url":"https://api.github.com/users/felixYyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-29T11:46:11Z","updated_at":"2022-03-29T11:46:11Z","author_association":"CONTRIBUTOR","body":"cc @rdblue ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081770090/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081773260","html_url":"https://github.com/apache/iceberg/issues/4424#issuecomment-1081773260","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4424","id":1081773260,"node_id":"IC_kwDOCW7NX85AeozM","user":{"login":"felixYyu","id":3785228,"node_id":"MDQ6VXNlcjM3ODUyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3785228?v=4","gravatar_id":"","url":"https://api.github.com/users/felixYyu","html_url":"https://github.com/felixYyu","followers_url":"https://api.github.com/users/felixYyu/followers","following_url":"https://api.github.com/users/felixYyu/following{/other_user}","gists_url":"https://api.github.com/users/felixYyu/gists{/gist_id}","starred_url":"https://api.github.com/users/felixYyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixYyu/subscriptions","organizations_url":"https://api.github.com/users/felixYyu/orgs","repos_url":"https://api.github.com/users/felixYyu/repos","events_url":"https://api.github.com/users/felixYyu/events{/privacy}","received_events_url":"https://api.github.com/users/felixYyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-29T11:49:44Z","updated_at":"2022-03-29T11:49:44Z","author_association":"CONTRIBUTOR","body":"cc @pvary @rajarshisarkar @jackye1995 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081773260/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081805996","html_url":"https://github.com/apache/iceberg/issues/4424#issuecomment-1081805996","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4424","id":1081805996,"node_id":"IC_kwDOCW7NX85Aewys","user":{"login":"rajarshisarkar","id":4561678,"node_id":"MDQ6VXNlcjQ1NjE2Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/4561678?v=4","gravatar_id":"","url":"https://api.github.com/users/rajarshisarkar","html_url":"https://github.com/rajarshisarkar","followers_url":"https://api.github.com/users/rajarshisarkar/followers","following_url":"https://api.github.com/users/rajarshisarkar/following{/other_user}","gists_url":"https://api.github.com/users/rajarshisarkar/gists{/gist_id}","starred_url":"https://api.github.com/users/rajarshisarkar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rajarshisarkar/subscriptions","organizations_url":"https://api.github.com/users/rajarshisarkar/orgs","repos_url":"https://api.github.com/users/rajarshisarkar/repos","events_url":"https://api.github.com/users/rajarshisarkar/events{/privacy}","received_events_url":"https://api.github.com/users/rajarshisarkar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-29T12:24:20Z","updated_at":"2022-03-29T12:24:20Z","author_association":"CONTRIBUTOR","body":"Hi @felixYyu, \r\n\r\nCan you please confirm the command you used to build [Iceberg 0.13.x](https://github.com/apache/iceberg/tree/0.13.x)? Also, could you please report your Scala version used?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081805996/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081916309","html_url":"https://github.com/apache/iceberg/issues/4424#issuecomment-1081916309","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4424","id":1081916309,"node_id":"IC_kwDOCW7NX85AfLuV","user":{"login":"felixYyu","id":3785228,"node_id":"MDQ6VXNlcjM3ODUyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3785228?v=4","gravatar_id":"","url":"https://api.github.com/users/felixYyu","html_url":"https://github.com/felixYyu","followers_url":"https://api.github.com/users/felixYyu/followers","following_url":"https://api.github.com/users/felixYyu/following{/other_user}","gists_url":"https://api.github.com/users/felixYyu/gists{/gist_id}","starred_url":"https://api.github.com/users/felixYyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixYyu/subscriptions","organizations_url":"https://api.github.com/users/felixYyu/orgs","repos_url":"https://api.github.com/users/felixYyu/repos","events_url":"https://api.github.com/users/felixYyu/events{/privacy}","received_events_url":"https://api.github.com/users/felixYyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-29T14:06:15Z","updated_at":"2022-03-29T14:06:15Z","author_association":"CONTRIBUTOR","body":"<scala.version>2.12.10</scala.version>\r\n<spark.version>3.2.1</spark.version>\r\n<iceberg.version>0.13.0</iceberg.version>","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1081916309/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1082040687","html_url":"https://github.com/apache/iceberg/issues/4426#issuecomment-1082040687","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4426","id":1082040687,"node_id":"IC_kwDOCW7NX85AfqFv","user":{"login":"rajarshisarkar","id":4561678,"node_id":"MDQ6VXNlcjQ1NjE2Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/4561678?v=4","gravatar_id":"","url":"https://api.github.com/users/rajarshisarkar","html_url":"https://github.com/rajarshisarkar","followers_url":"https://api.github.com/users/rajarshisarkar/followers","following_url":"https://api.github.com/users/rajarshisarkar/following{/other_user}","gists_url":"https://api.github.com/users/rajarshisarkar/gists{/gist_id}","starred_url":"https://api.github.com/users/rajarshisarkar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rajarshisarkar/subscriptions","organizations_url":"https://api.github.com/users/rajarshisarkar/orgs","repos_url":"https://api.github.com/users/rajarshisarkar/repos","events_url":"https://api.github.com/users/rajarshisarkar/events{/privacy}","received_events_url":"https://api.github.com/users/rajarshisarkar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-29T15:42:50Z","updated_at":"2022-03-29T15:42:50Z","author_association":"CONTRIBUTOR","body":"Thanks, for bringing this up. I'm working on this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1082040687/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1082074692","html_url":"https://github.com/apache/iceberg/issues/4426#issuecomment-1082074692","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4426","id":1082074692,"node_id":"IC_kwDOCW7NX85AfyZE","user":{"login":"anuragmantri","id":13743212,"node_id":"MDQ6VXNlcjEzNzQzMjEy","avatar_url":"https://avatars.githubusercontent.com/u/13743212?v=4","gravatar_id":"","url":"https://api.github.com/users/anuragmantri","html_url":"https://github.com/anuragmantri","followers_url":"https://api.github.com/users/anuragmantri/followers","following_url":"https://api.github.com/users/anuragmantri/following{/other_user}","gists_url":"https://api.github.com/users/anuragmantri/gists{/gist_id}","starred_url":"https://api.github.com/users/anuragmantri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/anuragmantri/subscriptions","organizations_url":"https://api.github.com/users/anuragmantri/orgs","repos_url":"https://api.github.com/users/anuragmantri/repos","events_url":"https://api.github.com/users/anuragmantri/events{/privacy}","received_events_url":"https://api.github.com/users/anuragmantri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-29T16:09:49Z","updated_at":"2022-03-29T16:09:49Z","author_association":"CONTRIBUTOR","body":"Thanks for creating this issue Russell. \r\n\r\n@rajarshisarkar - Feel free to add me to the PR. I will be happy to review.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1082074692/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1082103071","html_url":"https://github.com/apache/iceberg/pull/4342#issuecomment-1082103071","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4342","id":1082103071,"node_id":"IC_kwDOCW7NX85Af5Uf","user":{"login":"danielcweeks","id":4925077,"node_id":"MDQ6VXNlcjQ5MjUwNzc=","avatar_url":"https://avatars.githubusercontent.com/u/4925077?v=4","gravatar_id":"","url":"https://api.github.com/users/danielcweeks","html_url":"https://github.com/danielcweeks","followers_url":"https://api.github.com/users/danielcweeks/followers","following_url":"https://api.github.com/users/danielcweeks/following{/other_user}","gists_url":"https://api.github.com/users/danielcweeks/gists{/gist_id}","starred_url":"https://api.github.com/users/danielcweeks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielcweeks/subscriptions","organizations_url":"https://api.github.com/users/danielcweeks/orgs","repos_url":"https://api.github.com/users/danielcweeks/repos","events_url":"https://api.github.com/users/danielcweeks/events{/privacy}","received_events_url":"https://api.github.com/users/danielcweeks/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-29T16:33:38Z","updated_at":"2022-03-29T16:33:38Z","author_association":"CONTRIBUTOR","body":"@rajarshisarkar and @jackye1995 One small comment about proper shutdown above, but other than that I'm generally ok with this.  I think we can tackle refactoring some of this logic later (the S3FileIO is now mostly bulk/delete/tagging, so I think there's an opportunity to clean this up).\r\n\r\nIt is important to note that for the bulk use cases, tagging will be quite a bit slower since we have to tag each object individually.  That may not scale particularly well, but at least the option to tag is there.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1082103071/reactions","total_count":4,"+1":4,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1082523209","html_url":"https://github.com/apache/iceberg/issues/4265#issuecomment-1082523209","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4265","id":1082523209,"node_id":"IC_kwDOCW7NX85Ahf5J","user":{"login":"KarlManong","id":2627662,"node_id":"MDQ6VXNlcjI2Mjc2NjI=","avatar_url":"https://avatars.githubusercontent.com/u/2627662?v=4","gravatar_id":"","url":"https://api.github.com/users/KarlManong","html_url":"https://github.com/KarlManong","followers_url":"https://api.github.com/users/KarlManong/followers","following_url":"https://api.github.com/users/KarlManong/following{/other_user}","gists_url":"https://api.github.com/users/KarlManong/gists{/gist_id}","starred_url":"https://api.github.com/users/KarlManong/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/KarlManong/subscriptions","organizations_url":"https://api.github.com/users/KarlManong/orgs","repos_url":"https://api.github.com/users/KarlManong/repos","events_url":"https://api.github.com/users/KarlManong/events{/privacy}","received_events_url":"https://api.github.com/users/KarlManong/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-30T01:28:06Z","updated_at":"2022-03-30T01:28:06Z","author_association":"CONTRIBUTOR","body":"link #4346","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1082523209/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1082564173","html_url":"https://github.com/apache/iceberg/pull/4376#issuecomment-1082564173","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4376","id":1082564173,"node_id":"IC_kwDOCW7NX85Ahp5N","user":{"login":"felixYyu","id":3785228,"node_id":"MDQ6VXNlcjM3ODUyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3785228?v=4","gravatar_id":"","url":"https://api.github.com/users/felixYyu","html_url":"https://github.com/felixYyu","followers_url":"https://api.github.com/users/felixYyu/followers","following_url":"https://api.github.com/users/felixYyu/following{/other_user}","gists_url":"https://api.github.com/users/felixYyu/gists{/gist_id}","starred_url":"https://api.github.com/users/felixYyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixYyu/subscriptions","organizations_url":"https://api.github.com/users/felixYyu/orgs","repos_url":"https://api.github.com/users/felixYyu/repos","events_url":"https://api.github.com/users/felixYyu/events{/privacy}","received_events_url":"https://api.github.com/users/felixYyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-30T02:48:00Z","updated_at":"2022-03-30T02:48:00Z","author_association":"CONTRIBUTOR","body":"I will separate out the changes which make semantic changes to the code into their own PR's.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1082564173/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1082594615","html_url":"https://github.com/apache/iceberg/pull/4395#issuecomment-1082594615","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4395","id":1082594615,"node_id":"IC_kwDOCW7NX85AhxU3","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-30T03:56:31Z","updated_at":"2022-03-30T03:56:31Z","author_association":"CONTRIBUTOR","body":"@kbendick thank you for the perspective. As @RussellSpitzer has pointed out, custom task metrics do not appear to be the right mechanism for getting a correct count for number of data files read, or number of delete files applied while reading data files. I think we need to wait for Spark support for driver-side custom metrics to implement those properly. In the meantime, I was thinking of renaming the custom metric that I have here \"number of file splits read\". I'll update the PR very soon.\r\nFor other metrics that are actually computed at task time, such as the one Russell suggested, let me look into that.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1082594615/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1082613213","html_url":"https://github.com/apache/iceberg/pull/4428#issuecomment-1082613213","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4428","id":1082613213,"node_id":"IC_kwDOCW7NX85Ah13d","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-30T04:36:53Z","updated_at":"2022-03-30T04:36:53Z","author_association":"CONTRIBUTOR","body":"@rdblue @jackye1995  Let me know what you think!  ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1082613213/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1082615145","html_url":"https://github.com/apache/iceberg/pull/4428#issuecomment-1082615145","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4428","id":1082615145,"node_id":"IC_kwDOCW7NX85Ah2Vp","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-30T04:41:01Z","updated_at":"2022-03-30T04:43:55Z","author_association":"CONTRIBUTOR","body":"Investigating failing core tests","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1082615145/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1082617851","html_url":"https://github.com/apache/iceberg/pull/4318#issuecomment-1082617851","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4318","id":1082617851,"node_id":"IC_kwDOCW7NX85Ah2_7","user":{"login":"samredai","id":43911210,"node_id":"MDQ6VXNlcjQzOTExMjEw","avatar_url":"https://avatars.githubusercontent.com/u/43911210?v=4","gravatar_id":"","url":"https://api.github.com/users/samredai","html_url":"https://github.com/samredai","followers_url":"https://api.github.com/users/samredai/followers","following_url":"https://api.github.com/users/samredai/following{/other_user}","gists_url":"https://api.github.com/users/samredai/gists{/gist_id}","starred_url":"https://api.github.com/users/samredai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samredai/subscriptions","organizations_url":"https://api.github.com/users/samredai/orgs","repos_url":"https://api.github.com/users/samredai/repos","events_url":"https://api.github.com/users/samredai/events{/privacy}","received_events_url":"https://api.github.com/users/samredai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-30T04:47:30Z","updated_at":"2022-03-30T04:53:32Z","author_association":"CONTRIBUTOR","body":"Added an `IndexByName` visitor and did a comparison with the java client which produces the same result.\r\n\r\n### Java\r\n```java\r\nimport org.apache.iceberg.Schema;\r\nimport org.apache.iceberg.types.Types;\r\nimport org.apache.iceberg.types.TypeUtil;\r\n\r\nSchema schema = new Schema(\r\n      Types.NestedField.required(1, \"foo\", Types.StringType.get()),\r\n      Types.NestedField.optional(2, \"bar\", Types.IntegerType.get()),\r\n      Types.NestedField.required(3, \"baz\", Types.BooleanType.get()),\r\n      Types.NestedField.required(4, \"qux\", Types.ListType.ofOptional(5, Types.StringType.get())),\r\n      Types.NestedField.required(6, \"quux\", Types.MapType.ofOptional(7, 8, Types.StringType.get(), Types.MapType.ofOptional(9, 10, Types.StringType.get(), Types.IntegerType.get())))\r\n);\r\nMap<String, Integer> index = TypeUtil.indexByName(schema.asStruct());\r\nSystem.out.println(index);\r\n```\r\noutput:\r\n```\r\n{foo=1, bar=2, baz=3, qux=4, qux.element=5, quux=6, quux.key=7, quux.value=8, quux.value.key=9, quux.value.value=10}\r\n```\r\n### Python\r\n```py\r\nfrom iceberg.types import (\r\n    BooleanType,\r\n    IntegerType,\r\n    ListType,\r\n    MapType,\r\n    NestedField,\r\n    StringType,\r\n    StructType,\r\n)\r\nfrom iceberg.table.schema import Schema, index_by_name\r\n\r\nschema = Schema(\r\n    NestedField(field_id=1, name=\"foo\", field_type=StringType(), is_optional=False),\r\n    NestedField(field_id=2, name=\"bar\", field_type=IntegerType(), is_optional=True),\r\n    NestedField(field_id=3, name=\"baz\", field_type=BooleanType(), is_optional=False),\r\n    NestedField(field_id=4, name=\"qux\", field_type=ListType(element_id=5, element_type=StringType(), element_is_optional=True), is_optional=True),\r\n    NestedField(field_id=6, name=\"quux\", field_type=MapType(key_id=7, key_type=StringType(), value_id=8, value_type=MapType(key_id=9, key_type=StringType(), value_id=10, value_type=IntegerType(), value_is_optional=True), value_is_optional=True), is_optional=True)\r\n)\r\n    \r\nindex = index_by_name(schema)\r\nprint(index)\r\n```\r\noutput:\r\n```\r\n{'foo': 1, 'bar': 2, 'baz': 3, 'qux': 4, 'qux.element': 5, 'quux': 6, 'quux.key': 7, 'quux.value': 8, 'quux.value.key': 9, 'quux.value.value': 10}\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1082617851/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1082621634","html_url":"https://github.com/apache/iceberg/pull/4318#issuecomment-1082621634","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4318","id":1082621634,"node_id":"IC_kwDOCW7NX85Ah37C","user":{"login":"samredai","id":43911210,"node_id":"MDQ6VXNlcjQzOTExMjEw","avatar_url":"https://avatars.githubusercontent.com/u/43911210?v=4","gravatar_id":"","url":"https://api.github.com/users/samredai","html_url":"https://github.com/samredai","followers_url":"https://api.github.com/users/samredai/followers","following_url":"https://api.github.com/users/samredai/following{/other_user}","gists_url":"https://api.github.com/users/samredai/gists{/gist_id}","starred_url":"https://api.github.com/users/samredai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samredai/subscriptions","organizations_url":"https://api.github.com/users/samredai/orgs","repos_url":"https://api.github.com/users/samredai/repos","events_url":"https://api.github.com/users/samredai/events{/privacy}","received_events_url":"https://api.github.com/users/samredai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-30T04:56:58Z","updated_at":"2022-03-30T04:56:58Z","author_association":"CONTRIBUTOR","body":"Also, here's a comparison to `TypeUtil.indexById` in Java:\r\n### Java\r\n```java\r\nimport org.apache.iceberg.Schema;\r\nimport org.apache.iceberg.types.Types;\r\nimport org.apache.iceberg.types.TypeUtil;\r\n\r\nSchema schema = new Schema(\r\n      Types.NestedField.required(1, \"foo\", Types.StringType.get()),\r\n      Types.NestedField.optional(2, \"bar\", Types.IntegerType.get()),\r\n      Types.NestedField.required(3, \"baz\", Types.BooleanType.get()),\r\n      Types.NestedField.required(4, \"qux\", Types.ListType.ofOptional(5, Types.StringType.get())),\r\n      Types.NestedField.required(6, \"quux\", Types.MapType.ofOptional(7, 8, Types.StringType.get(), Types.MapType.ofOptional(9, 10, Types.StringType.get(), Types.IntegerType.get())))\r\n);\r\nMap<Integer, Types.NestedField> index = TypeUtil.indexById(schema.asStruct());\r\nSystem.out.println(index);\r\n```\r\noutput:\r\n```\r\n{1=1: foo: required string, 2=2: bar: optional int, 3=3: baz: required boolean, 4=4: qux: required list<string>, 5=5: element: optional string, 6=6: quux: required map<string, map<string, int>>, 7=7: key: required string, 8=8: value: optional map<string, int>, 9=9: key: required string, 10=10: value: optional int}\r\n```\r\n\r\n### Python\r\n```py\r\nfrom iceberg.types import (\r\n    BooleanType,\r\n    IntegerType,\r\n    ListType,\r\n    MapType,\r\n    NestedField,\r\n    StringType,\r\n    StructType,\r\n)\r\nfrom iceberg.table.schema import Schema, index_by_id\r\n\r\nschema = Schema(\r\n    NestedField(field_id=1, name=\"foo\", field_type=StringType(), is_optional=False),\r\n    NestedField(field_id=2, name=\"bar\", field_type=IntegerType(), is_optional=True),\r\n    NestedField(field_id=3, name=\"baz\", field_type=BooleanType(), is_optional=False),\r\n    NestedField(field_id=4, name=\"qux\", field_type=ListType(element_id=5, element_type=StringType(), element_is_optional=True), is_optional=True),\r\n    NestedField(field_id=6, name=\"quux\", field_type=MapType(key_id=7, key_type=StringType(), value_id=8, value_type=MapType(key_id=9, key_type=StringType(), value_id=10, value_type=IntegerType(), value_is_optional=True), value_is_optional=True), is_optional=True)\r\n)\r\n    \r\nindex = index_by_id(schema)\r\nprint(index)\r\n```\r\noutput:\r\n```\r\n{\r\n 1: NestedField(field_id=1, name='foo', field_type=StringType(), is_optional=False),\r\n 2: NestedField(field_id=2, name='bar', field_type=IntegerType(), is_optional=True),\r\n 3: NestedField(field_id=3, name='baz', field_type=BooleanType(), is_optional=False),\r\n 4: NestedField(field_id=4, name='qux', field_type=ListType(element_id=5, element_type=StringType(), element_is_optional=True), is_optional=True),\r\n 5: NestedField(field_id=5, name='element', field_type=StringType(), is_optional=True),\r\n 6: NestedField(field_id=6, name='quux', field_type=MapType(key_id=7, key_type=StringType(), value_id=8, value_type=MapType(key_id=9, key_type=StringType(), value_id=10, value_type=IntegerType(), value_is_optional=True), value_is_optional=True), is_optional=True),\r\n 7: NestedField(field_id=7, name='key', field_type=StringType(), is_optional=False),\r\n 8: NestedField(field_id=8, name='value', field_type=MapType(key_id=9, key_type=StringType(), value_id=10, value_type=IntegerType(), value_is_optional=True), is_optional=True),\r\n 9: NestedField(field_id=9, name='key', field_type=StringType(), is_optional=False),\r\n 10: NestedField(field_id=10, name='value', field_type=IntegerType(), is_optional=True),\r\n}\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1082621634/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1082635432","html_url":"https://github.com/apache/iceberg/pull/4273#issuecomment-1082635432","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4273","id":1082635432,"node_id":"IC_kwDOCW7NX85Ah7So","user":{"login":"zhongyujiang","id":42907416,"node_id":"MDQ6VXNlcjQyOTA3NDE2","avatar_url":"https://avatars.githubusercontent.com/u/42907416?v=4","gravatar_id":"","url":"https://api.github.com/users/zhongyujiang","html_url":"https://github.com/zhongyujiang","followers_url":"https://api.github.com/users/zhongyujiang/followers","following_url":"https://api.github.com/users/zhongyujiang/following{/other_user}","gists_url":"https://api.github.com/users/zhongyujiang/gists{/gist_id}","starred_url":"https://api.github.com/users/zhongyujiang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhongyujiang/subscriptions","organizations_url":"https://api.github.com/users/zhongyujiang/orgs","repos_url":"https://api.github.com/users/zhongyujiang/repos","events_url":"https://api.github.com/users/zhongyujiang/events{/privacy}","received_events_url":"https://api.github.com/users/zhongyujiang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-30T05:25:07Z","updated_at":"2022-03-30T05:25:07Z","author_association":"CONTRIBUTOR","body":"Updated based on comments.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1082635432/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1082694262","html_url":"https://github.com/apache/iceberg/issues/4190#issuecomment-1082694262","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4190","id":1082694262,"node_id":"IC_kwDOCW7NX85AiJp2","user":{"login":"naisongwen","id":2129939,"node_id":"MDQ6VXNlcjIxMjk5Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/2129939?v=4","gravatar_id":"","url":"https://api.github.com/users/naisongwen","html_url":"https://github.com/naisongwen","followers_url":"https://api.github.com/users/naisongwen/followers","following_url":"https://api.github.com/users/naisongwen/following{/other_user}","gists_url":"https://api.github.com/users/naisongwen/gists{/gist_id}","starred_url":"https://api.github.com/users/naisongwen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/naisongwen/subscriptions","organizations_url":"https://api.github.com/users/naisongwen/orgs","repos_url":"https://api.github.com/users/naisongwen/repos","events_url":"https://api.github.com/users/naisongwen/events{/privacy}","received_events_url":"https://api.github.com/users/naisongwen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-30T06:51:16Z","updated_at":"2022-03-30T06:51:16Z","author_association":"NONE","body":"> \r\n\r\nright","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1082694262/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1082794032","html_url":"https://github.com/apache/iceberg/issues/4426#issuecomment-1082794032","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4426","id":1082794032,"node_id":"IC_kwDOCW7NX85AiiAw","user":{"login":"rajarshisarkar","id":4561678,"node_id":"MDQ6VXNlcjQ1NjE2Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/4561678?v=4","gravatar_id":"","url":"https://api.github.com/users/rajarshisarkar","html_url":"https://github.com/rajarshisarkar","followers_url":"https://api.github.com/users/rajarshisarkar/followers","following_url":"https://api.github.com/users/rajarshisarkar/following{/other_user}","gists_url":"https://api.github.com/users/rajarshisarkar/gists{/gist_id}","starred_url":"https://api.github.com/users/rajarshisarkar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rajarshisarkar/subscriptions","organizations_url":"https://api.github.com/users/rajarshisarkar/orgs","repos_url":"https://api.github.com/users/rajarshisarkar/repos","events_url":"https://api.github.com/users/rajarshisarkar/events{/privacy}","received_events_url":"https://api.github.com/users/rajarshisarkar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-30T08:42:02Z","updated_at":"2022-03-30T08:42:02Z","author_association":"CONTRIBUTOR","body":"Sure, @anuragmantri.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1082794032/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1083337942","html_url":"https://github.com/apache/iceberg/pull/4223#issuecomment-1083337942","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4223","id":1083337942,"node_id":"IC_kwDOCW7NX85AkmzW","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-30T16:10:42Z","updated_at":"2022-03-30T16:10:42Z","author_association":"MEMBER","body":"@samredai , @rdblue , @szehon-ho : This is commonly asked question in the Iceberg slack workspace. Today also someone asking this.\r\nSo, I feel we should merge this and update the site docs and provide more context if required after #3432 is merged.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1083337942/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1083357207","html_url":"https://github.com/apache/iceberg/issues/4346#issuecomment-1083357207","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4346","id":1083357207,"node_id":"IC_kwDOCW7NX85AkrgX","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-30T16:25:43Z","updated_at":"2022-03-30T16:25:43Z","author_association":"CONTRIBUTOR","body":"Also adding that I have been working with @bijanhoule on a patch that will allow users to provide their own dataframe of actual files, to avoid skipping the listing entirely if all of the files are already known - for example if a cluster administrator is able to provide a list of files from HDFS or if a list of files is obtainable from the cloud provider (such as S3 inventory list).\r\n\r\nThis is similar in that it allows us to avoid the list but it does put the onus on the user to provide the correct listing. This would be _in addition_ to the work mentioned above as an alternative option.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1083357207/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1083412195","html_url":"https://github.com/apache/iceberg/issues/4346#issuecomment-1083412195","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4346","id":1083412195,"node_id":"IC_kwDOCW7NX85Ak47j","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-30T17:19:50Z","updated_at":"2022-03-30T17:21:41Z","author_association":"CONTRIBUTOR","body":"@kbendick, I think being able to customize `DeleteOrphanFiles` with a custom way of obtaining actual files is a great feature but I find it orthogonal. No matter what way we use to get actual files, we still need to normalize the locations and decide what to do if the scheme/authority don't match.\r\n\r\nI'd consider exposing some sort of a strategy in `DeleteOrphanFiles` that would allow users to customize not only how to obtain actual files but also other things (e.g. how to perform normalization). For example, I find it reasonable to use Hadoop for normalization if we use Hadoop for listing. If we rely on another way of computing actual files, maybe we should use something else for normalizing.\r\n\r\nI think once we know what to do for the current implementation we can think of a way to make it pluggable.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1083412195/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1083460470","html_url":"https://github.com/apache/iceberg/issues/4346#issuecomment-1083460470","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4346","id":1083460470,"node_id":"IC_kwDOCW7NX85AlEt2","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-30T18:15:07Z","updated_at":"2022-03-30T18:28:48Z","author_association":"CONTRIBUTOR","body":"Agreed that making the source of the \"actual files\" list pluggable is orthogonal. My apologies for bringing it up here, as it's more related to just \"making `DeleteOrpahFiles` more reliable\" by avoiding the list operation on the entire object store.\r\n\r\nI would propose, since I know that it's mostly working and that it's rather simple, that we consider the addition of a way to add in a source other than the hadoop-based list as an additional option. Right now, it's simply another table that can be referenced that contains the actual files of the file store.\r\n\r\nWhether things like prefix normalization would be applied to the listing of files in the table or to the list of actual files, that would be outside the scope of a user-provided lsit of actual files.\r\n\r\nFor example for table's entirely on s3 in one bucket, normalization of the files in the table on the scheme of `s3a` or `s3` is probably the most common concern that average users face in practice.\r\n\r\nWhether the normalization to one of `s3` or `s3a` is done one the table's file list or the list of actual files, the user could still provide a list of actual files from a more definitive source that has been properly adjusted to be `s3` or `s3a`.\r\n\r\nWe can open a PR for review to better show what is meant. But I don't think that the normalization work needs to be completed before we make it pluggable in this way. The normalization work would naturally layer on top of this as this simply skips one small part of the actions `execute` method.\r\n\r\nIt will be more clear what is meant by putting up the work, but it is a rather small change that provides a very significant benefit to a lot of users right away - avoiding the listing of the entire file store if a more definitive source of truth is available.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1083460470/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1083462118","html_url":"https://github.com/apache/iceberg/pull/4342#issuecomment-1083462118","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4342","id":1083462118,"node_id":"IC_kwDOCW7NX85AlFHm","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-30T18:16:53Z","updated_at":"2022-03-30T18:16:53Z","author_association":"CONTRIBUTOR","body":"This looks good to me, the only point with concern now is the executor service. I think we can merge this, and address the issue if there is a better way from @danielcweeks, otherwise the current implementation is consistent with what we had in `S3OutputStream`. Thanks for the work @rajarshisarkar, and thanks for the review @rdblue @danielcweeks @singhpk234 @amogh-jahagirdar !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1083462118/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1083485697","html_url":"https://github.com/apache/iceberg/pull/4434#issuecomment-1083485697","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4434","id":1083485697,"node_id":"IC_kwDOCW7NX85AlK4B","user":{"login":"bijanhoule","id":7012524,"node_id":"MDQ6VXNlcjcwMTI1MjQ=","avatar_url":"https://avatars.githubusercontent.com/u/7012524?v=4","gravatar_id":"","url":"https://api.github.com/users/bijanhoule","html_url":"https://github.com/bijanhoule","followers_url":"https://api.github.com/users/bijanhoule/followers","following_url":"https://api.github.com/users/bijanhoule/following{/other_user}","gists_url":"https://api.github.com/users/bijanhoule/gists{/gist_id}","starred_url":"https://api.github.com/users/bijanhoule/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bijanhoule/subscriptions","organizations_url":"https://api.github.com/users/bijanhoule/orgs","repos_url":"https://api.github.com/users/bijanhoule/repos","events_url":"https://api.github.com/users/bijanhoule/events{/privacy}","received_events_url":"https://api.github.com/users/bijanhoule/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-30T18:38:01Z","updated_at":"2022-03-30T18:38:01Z","author_association":"CONTRIBUTOR","body":"Closing this as I accidentally opened it against the wrong repository -- I will reopen here when it is ready for review","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1083485697/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1083549743","html_url":"https://github.com/apache/iceberg/pull/4393#issuecomment-1083549743","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4393","id":1083549743,"node_id":"IC_kwDOCW7NX85Alagv","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-30T19:38:59Z","updated_at":"2022-03-30T19:38:59Z","author_association":"CONTRIBUTOR","body":"Thanks, @rajarshisarkar!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1083549743/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1083554671","html_url":"https://github.com/apache/iceberg/pull/4342#issuecomment-1083554671","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4342","id":1083554671,"node_id":"IC_kwDOCW7NX85Albtv","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-30T19:45:19Z","updated_at":"2022-03-30T19:45:19Z","author_association":"CONTRIBUTOR","body":"Thanks for getting this in, @amogh-jahagirdar and @jackye1995!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1083554671/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1083597223","html_url":"https://github.com/apache/iceberg/pull/4262#issuecomment-1083597223","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4262","id":1083597223,"node_id":"IC_kwDOCW7NX85AlmGn","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-30T20:32:48Z","updated_at":"2022-03-30T20:32:48Z","author_association":"CONTRIBUTOR","body":"Thanks, @dramaticlly!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1083597223/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1083600231","html_url":"https://github.com/apache/iceberg/pull/4262#issuecomment-1083600231","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4262","id":1083600231,"node_id":"IC_kwDOCW7NX85Alm1n","user":{"login":"dramaticlly","id":5961173,"node_id":"MDQ6VXNlcjU5NjExNzM=","avatar_url":"https://avatars.githubusercontent.com/u/5961173?v=4","gravatar_id":"","url":"https://api.github.com/users/dramaticlly","html_url":"https://github.com/dramaticlly","followers_url":"https://api.github.com/users/dramaticlly/followers","following_url":"https://api.github.com/users/dramaticlly/following{/other_user}","gists_url":"https://api.github.com/users/dramaticlly/gists{/gist_id}","starred_url":"https://api.github.com/users/dramaticlly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dramaticlly/subscriptions","organizations_url":"https://api.github.com/users/dramaticlly/orgs","repos_url":"https://api.github.com/users/dramaticlly/repos","events_url":"https://api.github.com/users/dramaticlly/events{/privacy}","received_events_url":"https://api.github.com/users/dramaticlly/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-30T20:36:04Z","updated_at":"2022-03-30T20:57:22Z","author_association":"CONTRIBUTOR","body":"Thank you @rdblue  for merging the pull request. Let me also try to add those unresolved comments into issue and will come back with follow up PR. \r\n\r\n1. https://github.com/apache/iceberg/issues/4435","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1083600231/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1083668610","html_url":"https://github.com/apache/iceberg/pull/4262#issuecomment-1083668610","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4262","id":1083668610,"node_id":"IC_kwDOCW7NX85Al3iC","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-30T21:58:47Z","updated_at":"2022-03-30T21:58:47Z","author_association":"CONTRIBUTOR","body":"I opened a follow-up PR to fix some of the remaining issues, #4436.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1083668610/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1083686117","html_url":"https://github.com/apache/iceberg/pull/4262#issuecomment-1083686117","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4262","id":1083686117,"node_id":"IC_kwDOCW7NX85Al7zl","user":{"login":"samredai","id":43911210,"node_id":"MDQ6VXNlcjQzOTExMjEw","avatar_url":"https://avatars.githubusercontent.com/u/43911210?v=4","gravatar_id":"","url":"https://api.github.com/users/samredai","html_url":"https://github.com/samredai","followers_url":"https://api.github.com/users/samredai/followers","following_url":"https://api.github.com/users/samredai/following{/other_user}","gists_url":"https://api.github.com/users/samredai/gists{/gist_id}","starred_url":"https://api.github.com/users/samredai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samredai/subscriptions","organizations_url":"https://api.github.com/users/samredai/orgs","repos_url":"https://api.github.com/users/samredai/repos","events_url":"https://api.github.com/users/samredai/events{/privacy}","received_events_url":"https://api.github.com/users/samredai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-30T22:15:14Z","updated_at":"2022-03-30T22:15:14Z","author_association":"CONTRIBUTOR","body":"Woohoo! Big thanks @dramaticlly for tackling this. 🍻","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1083686117/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1083769270","html_url":"https://github.com/apache/iceberg/pull/3457#issuecomment-1083769270","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3457","id":1083769270,"node_id":"IC_kwDOCW7NX85AmQG2","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-30T23:32:58Z","updated_at":"2022-03-30T23:32:58Z","author_association":"MEMBER","body":"@szehon-ho sorry for not getting back to this sooner, let's finish this up when you are back online","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1083769270/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1083856002","html_url":"https://github.com/apache/iceberg/pull/4376#issuecomment-1083856002","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4376","id":1083856002,"node_id":"IC_kwDOCW7NX85AmlSC","user":{"login":"felixYyu","id":3785228,"node_id":"MDQ6VXNlcjM3ODUyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3785228?v=4","gravatar_id":"","url":"https://api.github.com/users/felixYyu","html_url":"https://github.com/felixYyu","followers_url":"https://api.github.com/users/felixYyu/followers","following_url":"https://api.github.com/users/felixYyu/following{/other_user}","gists_url":"https://api.github.com/users/felixYyu/gists{/gist_id}","starred_url":"https://api.github.com/users/felixYyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixYyu/subscriptions","organizations_url":"https://api.github.com/users/felixYyu/orgs","repos_url":"https://api.github.com/users/felixYyu/repos","events_url":"https://api.github.com/users/felixYyu/events{/privacy}","received_events_url":"https://api.github.com/users/felixYyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-31T00:31:30Z","updated_at":"2022-03-31T10:22:33Z","author_association":"CONTRIBUTOR","body":"The task was not fully completed，It will be finished today. @RussellSpitzer ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1083856002/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1083911851","html_url":"https://github.com/apache/iceberg/pull/4318#issuecomment-1083911851","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4318","id":1083911851,"node_id":"IC_kwDOCW7NX85Amy6r","user":{"login":"samredai","id":43911210,"node_id":"MDQ6VXNlcjQzOTExMjEw","avatar_url":"https://avatars.githubusercontent.com/u/43911210?v=4","gravatar_id":"","url":"https://api.github.com/users/samredai","html_url":"https://github.com/samredai","followers_url":"https://api.github.com/users/samredai/followers","following_url":"https://api.github.com/users/samredai/following{/other_user}","gists_url":"https://api.github.com/users/samredai/gists{/gist_id}","starred_url":"https://api.github.com/users/samredai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samredai/subscriptions","organizations_url":"https://api.github.com/users/samredai/orgs","repos_url":"https://api.github.com/users/samredai/repos","events_url":"https://api.github.com/users/samredai/events{/privacy}","received_events_url":"https://api.github.com/users/samredai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-31T01:08:47Z","updated_at":"2022-03-31T01:08:47Z","author_association":"CONTRIBUTOR","body":"Rebased and also updated it to call `index_by_id(...)` lazily and then cache it.\r\n\r\n`index_by_name(...)` on the other hand is called right away in the init for `Schema` and cached.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1083911851/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1083928661","html_url":"https://github.com/apache/iceberg/pull/4223#issuecomment-1083928661","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4223","id":1083928661,"node_id":"IC_kwDOCW7NX85Am3BV","user":{"login":"samredai","id":43911210,"node_id":"MDQ6VXNlcjQzOTExMjEw","avatar_url":"https://avatars.githubusercontent.com/u/43911210?v=4","gravatar_id":"","url":"https://api.github.com/users/samredai","html_url":"https://github.com/samredai","followers_url":"https://api.github.com/users/samredai/followers","following_url":"https://api.github.com/users/samredai/following{/other_user}","gists_url":"https://api.github.com/users/samredai/gists{/gist_id}","starred_url":"https://api.github.com/users/samredai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samredai/subscriptions","organizations_url":"https://api.github.com/users/samredai/orgs","repos_url":"https://api.github.com/users/samredai/repos","events_url":"https://api.github.com/users/samredai/events{/privacy}","received_events_url":"https://api.github.com/users/samredai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-31T01:20:14Z","updated_at":"2022-03-31T01:20:14Z","author_association":"CONTRIBUTOR","body":"> I feel we should merge this and update the site docs and provide more context if required after https://github.com/apache/iceberg/pull/3432 is merged\r\n\r\n+1","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1083928661/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1083982606","html_url":"https://github.com/apache/iceberg/issues/4435#issuecomment-1083982606","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4435","id":1083982606,"node_id":"IC_kwDOCW7NX85AnEMO","user":{"login":"samredai","id":43911210,"node_id":"MDQ6VXNlcjQzOTExMjEw","avatar_url":"https://avatars.githubusercontent.com/u/43911210?v=4","gravatar_id":"","url":"https://api.github.com/users/samredai","html_url":"https://github.com/samredai","followers_url":"https://api.github.com/users/samredai/followers","following_url":"https://api.github.com/users/samredai/following{/other_user}","gists_url":"https://api.github.com/users/samredai/gists{/gist_id}","starred_url":"https://api.github.com/users/samredai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samredai/subscriptions","organizations_url":"https://api.github.com/users/samredai/orgs","repos_url":"https://api.github.com/users/samredai/repos","events_url":"https://api.github.com/users/samredai/events{/privacy}","received_events_url":"https://api.github.com/users/samredai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-31T01:56:29Z","updated_at":"2022-03-31T01:56:29Z","author_association":"CONTRIBUTOR","body":"Thanks for opening this @dramaticlly, to add more, I think we should section off the ABC classes to a `base.py` file (doesn't have to be the same PR as the general restructuring). Mainly because the expressions module has a pretty gnarly sequence of class inheritance that's hard to follow when the interfaces are scattered among the concrete classes. This also keeps the files with the actual logic easy to follow since the top of those files are not full of super classes. In turn that also makes it easier to find where pdb breakpoints need to be set while debugging.\r\n\r\nHere's what I imagine the file contents would look like:\r\n- **base.py** (ABC classes that are never instantiated directly)\r\n  - Literal\r\n  - Expression\r\n  - ExpressionVisitor\r\n  - BoundExpressionVisitor\r\n  - Evaluator\r\n  - Bound\r\n  - Unbound\r\n  - Term\r\n  - Predicate\r\n- **literals.py**\r\n  - IntegerLiteral\r\n  - BooleanLiteral\r\n  - DecimalLiteral\r\n  - ...\r\n- **operation.py**\r\n  - Operation\r\n  - And\r\n  - Or\r\n  - Not\r\n  - TrueExp\r\n  - FalseExp\r\n- **predicate.py**\r\n  - BoundPredicate\r\n  - UnboundPredicate\r\n- **references.py**\r\n  - Boundreference\r\n  - UnboundReference\r\n- **visitors.py**\r\n  - EvalVisitor\r\n  - BindVisitor\r\n  - ReferenceVisitor\r\n  - ManifestEvalVisitor\r\n  - MetricsEvalVisitor\r\n- **evaluators.py**\r\n  - InclusiveManifestEvaluator\r\n  - StrictMetricsEvaluator\r\n\r\nI may have left out a couple classes/functions but I think it captures the gist. There's of course a good amount of opinion in this but personally it helps navigate a pretty hefty expressions module. I think of it as \"I need to look into an evaluator, must be in evaluator.py\" or \"I need to debug a visitor, it must be in visitors.py\". If I want to get a better understanding of the interfaces and how they all come together, I go to `base.py` and find a collection of well-documented ABC classes.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1083982606/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1083986397","html_url":"https://github.com/apache/iceberg/pull/4432#issuecomment-1083986397","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4432","id":1083986397,"node_id":"IC_kwDOCW7NX85AnFHd","user":{"login":"zhongyujiang","id":42907416,"node_id":"MDQ6VXNlcjQyOTA3NDE2","avatar_url":"https://avatars.githubusercontent.com/u/42907416?v=4","gravatar_id":"","url":"https://api.github.com/users/zhongyujiang","html_url":"https://github.com/zhongyujiang","followers_url":"https://api.github.com/users/zhongyujiang/followers","following_url":"https://api.github.com/users/zhongyujiang/following{/other_user}","gists_url":"https://api.github.com/users/zhongyujiang/gists{/gist_id}","starred_url":"https://api.github.com/users/zhongyujiang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhongyujiang/subscriptions","organizations_url":"https://api.github.com/users/zhongyujiang/orgs","repos_url":"https://api.github.com/users/zhongyujiang/repos","events_url":"https://api.github.com/users/zhongyujiang/events{/privacy}","received_events_url":"https://api.github.com/users/zhongyujiang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-31T02:01:22Z","updated_at":"2022-03-31T02:01:22Z","author_association":"CONTRIBUTOR","body":"`Map` type used to have similar issue, but got fixed in Flink, see [here](https://issues.apache.org/jira/browse/FLINK-21247). Unforunately the similar [issue](https://issues.apache.org/jira/browse/FLINK-25238?jql=project%20%3D%20FLINK%20AND%20text%20~%20%22iceberg%20array%22) for `Array` type  have been closed.\r\nI think we should continue to use custom `ReusableArrayData` for memory saving and solve the serialization problem in a similar way, instead of creating a new `GenericArrayData`.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1083986397/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1083989125","html_url":"https://github.com/apache/iceberg/pull/4263#issuecomment-1083989125","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4263","id":1083989125,"node_id":"IC_kwDOCW7NX85AnFyF","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-31T02:05:56Z","updated_at":"2022-03-31T02:05:56Z","author_association":"CONTRIBUTOR","body":"Thanks, @samredai!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1083989125/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1083990842","html_url":"https://github.com/apache/iceberg/pull/4273#issuecomment-1083990842","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4273","id":1083990842,"node_id":"IC_kwDOCW7NX85AnGM6","user":{"login":"zhongyujiang","id":42907416,"node_id":"MDQ6VXNlcjQyOTA3NDE2","avatar_url":"https://avatars.githubusercontent.com/u/42907416?v=4","gravatar_id":"","url":"https://api.github.com/users/zhongyujiang","html_url":"https://github.com/zhongyujiang","followers_url":"https://api.github.com/users/zhongyujiang/followers","following_url":"https://api.github.com/users/zhongyujiang/following{/other_user}","gists_url":"https://api.github.com/users/zhongyujiang/gists{/gist_id}","starred_url":"https://api.github.com/users/zhongyujiang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhongyujiang/subscriptions","organizations_url":"https://api.github.com/users/zhongyujiang/orgs","repos_url":"https://api.github.com/users/zhongyujiang/repos","events_url":"https://api.github.com/users/zhongyujiang/events{/privacy}","received_events_url":"https://api.github.com/users/zhongyujiang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-31T02:09:04Z","updated_at":"2022-03-31T02:09:04Z","author_association":"CONTRIBUTOR","body":"Thanks all for your review!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1083990842/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1084003848","html_url":"https://github.com/apache/iceberg/pull/4432#issuecomment-1084003848","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4432","id":1084003848,"node_id":"IC_kwDOCW7NX85AnJYI","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-31T02:25:06Z","updated_at":"2022-03-31T02:25:06Z","author_association":"MEMBER","body":"Yes, I generally agree with @zhongyujiang . The correct direction is improving the apache flink project to support customized `ArrayData` instead of adjusting the apache iceberg to support `GenericArrayData` only. \r\n\r\nBtw,  since we've got the https://issues.apache.org/jira/browse/FLINK-21247 resolved in the current flink release,   I think we'd better to add the unit tests also in the apache iceberg project to address the `ReusableMapData` issue.  The `ReusableArrayData` ditto, but can be marked as `Ignore` since we still get a correct flink release the fix this `ArrayData` issue. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1084003848/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1084008104","html_url":"https://github.com/apache/iceberg/pull/4432#issuecomment-1084008104","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4432","id":1084008104,"node_id":"IC_kwDOCW7NX85AnKao","user":{"login":"yittg","id":4429171,"node_id":"MDQ6VXNlcjQ0MjkxNzE=","avatar_url":"https://avatars.githubusercontent.com/u/4429171?v=4","gravatar_id":"","url":"https://api.github.com/users/yittg","html_url":"https://github.com/yittg","followers_url":"https://api.github.com/users/yittg/followers","following_url":"https://api.github.com/users/yittg/following{/other_user}","gists_url":"https://api.github.com/users/yittg/gists{/gist_id}","starred_url":"https://api.github.com/users/yittg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yittg/subscriptions","organizations_url":"https://api.github.com/users/yittg/orgs","repos_url":"https://api.github.com/users/yittg/repos","events_url":"https://api.github.com/users/yittg/events{/privacy}","received_events_url":"https://api.github.com/users/yittg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-31T02:31:29Z","updated_at":"2022-03-31T02:37:18Z","author_association":"CONTRIBUTOR","body":"Thanks @zhongyujiang , @openinx for your comments, totally agree with you.\r\nActually this PR is only a trivial fix, it is basically for adding a test case for the issue and starting a discussion.\r\n\r\nWe can reuse the ReusableArrayData, and maybe copy it to GenericArrayData on a higher level without fixing it in Flink.\r\nOf course, it should be better to fix it in Flink.\r\n\r\nSo, what's your opinion @zhongyujiang, @openinx ?\r\n1. fix it in iceberg;\r\n2. fix it in flink, and only and a test case;","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1084008104/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1084013385","html_url":"https://github.com/apache/iceberg/pull/4432#issuecomment-1084013385","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4432","id":1084013385,"node_id":"IC_kwDOCW7NX85AnLtJ","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-31T02:43:22Z","updated_at":"2022-03-31T02:43:22Z","author_association":"MEMBER","body":"Reconsidered about this thing again,  as we usually cannot align the iceberg release timeline with apache flink,  it's good to make this feature work fine rather than keeping this existing bug in the future iceberg release for waiting the flink bug fix release to accomplish the best performance.  I think we'd better to file an issue in apache flink firstly, and then add a TODO comment to refer it ( if we choose the option#1 temporarily).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1084013385/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1084083153","html_url":"https://github.com/apache/iceberg/pull/4395#issuecomment-1084083153","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4395","id":1084083153,"node_id":"IC_kwDOCW7NX85AncvR","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-31T05:12:21Z","updated_at":"2022-03-31T05:12:21Z","author_association":"CONTRIBUTOR","body":"I have updated the PR. I renamed the metric \"numSplits\" and its description is now \"number of file splits read\" (this is what appears in the Spark UI). I also changed \"IcebergScan\" to \"IcebergBatchScan\" in the `description` and `toString` methods of `SparkBatchQueryScan`.\r\nFor now, I am not adding any other metrics in this PR. Task metrics do not appear to be the right mechanism for computing how many delete files are applied, for example. I will look into other metrics for which task metrics are the right mechanism, but that can be a separate PR.\r\nI am open to computing min, median and max for the numSplits metric if that is desired.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1084083153/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1084168717","html_url":"https://github.com/apache/iceberg/issues/4447#issuecomment-1084168717","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4447","id":1084168717,"node_id":"IC_kwDOCW7NX85AnxoN","user":{"login":"felixYyu","id":3785228,"node_id":"MDQ6VXNlcjM3ODUyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3785228?v=4","gravatar_id":"","url":"https://api.github.com/users/felixYyu","html_url":"https://github.com/felixYyu","followers_url":"https://api.github.com/users/felixYyu/followers","following_url":"https://api.github.com/users/felixYyu/following{/other_user}","gists_url":"https://api.github.com/users/felixYyu/gists{/gist_id}","starred_url":"https://api.github.com/users/felixYyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixYyu/subscriptions","organizations_url":"https://api.github.com/users/felixYyu/orgs","repos_url":"https://api.github.com/users/felixYyu/repos","events_url":"https://api.github.com/users/felixYyu/events{/privacy}","received_events_url":"https://api.github.com/users/felixYyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-31T06:56:39Z","updated_at":"2022-03-31T07:21:40Z","author_association":"CONTRIBUTOR","body":"This branch is 54 commits ahead of apache/iceberg:master.\r\nexp：committed on 1 Dec 2021 commit 6aa419cc0ff2c4526b598418ac1f9e01c1eb3301","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1084168717/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1084214073","html_url":"https://github.com/apache/iceberg/pull/4399#issuecomment-1084214073","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4399","id":1084214073,"node_id":"IC_kwDOCW7NX85An8s5","user":{"login":"huleilei","id":9431947,"node_id":"MDQ6VXNlcjk0MzE5NDc=","avatar_url":"https://avatars.githubusercontent.com/u/9431947?v=4","gravatar_id":"","url":"https://api.github.com/users/huleilei","html_url":"https://github.com/huleilei","followers_url":"https://api.github.com/users/huleilei/followers","following_url":"https://api.github.com/users/huleilei/following{/other_user}","gists_url":"https://api.github.com/users/huleilei/gists{/gist_id}","starred_url":"https://api.github.com/users/huleilei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huleilei/subscriptions","organizations_url":"https://api.github.com/users/huleilei/orgs","repos_url":"https://api.github.com/users/huleilei/repos","events_url":"https://api.github.com/users/huleilei/events{/privacy}","received_events_url":"https://api.github.com/users/huleilei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-31T07:43:24Z","updated_at":"2022-03-31T07:43:48Z","author_association":"NONE","body":"@kbendick Is it necessary to change `MANIFEST_LIST_SCHEMA` to ensure that the length of `MANIFEST_LIST_SCHEMA` \r\n and the \"`get ()`\" method is consistent:\r\n\r\n```\r\n  static final Schema MANIFEST_LIST_SCHEMA = new Schema(\r\n      ManifestFile.PATH,\r\n      ManifestFile.LENGTH,\r\n      ManifestFile.SPEC_ID,\r\n      ManifestFile.MANIFEST_CONTENT.asRequired(),\r\n      ManifestFile.SEQUENCE_NUMBER.asRequired(),\r\n      ManifestFile.MIN_SEQUENCE_NUMBER.asRequired(),\r\n      ManifestFile.SNAPSHOT_ID.asRequired(),\r\n      ManifestFile.ADDED_FILES_COUNT.asRequired(),\r\n      ManifestFile.EXISTING_FILES_COUNT.asRequired(),\r\n      ManifestFile.DELETED_FILES_COUNT.asRequired(),\r\n      ManifestFile.ADDED_ROWS_COUNT.asRequired(),\r\n      ManifestFile.EXISTING_ROWS_COUNT.asRequired(),\r\n      ManifestFile.DELETED_ROWS_COUNT.asRequired(),\r\n      ManifestFile.PARTITION_SUMMARIES,\r\n      ManifestFile.WRITER_ID.asRequired(),\r\n      ManifestFile.KEY_METADATA\r\n  );\r\n```\r\n The length of `MANIFEST_LIST_SCHEMA` is 14. \r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1084214073/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1084223547","html_url":"https://github.com/apache/iceberg/issues/1688#issuecomment-1084223547","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1688","id":1084223547,"node_id":"IC_kwDOCW7NX85An_A7","user":{"login":"KarlManong","id":2627662,"node_id":"MDQ6VXNlcjI2Mjc2NjI=","avatar_url":"https://avatars.githubusercontent.com/u/2627662?v=4","gravatar_id":"","url":"https://api.github.com/users/KarlManong","html_url":"https://github.com/KarlManong","followers_url":"https://api.github.com/users/KarlManong/followers","following_url":"https://api.github.com/users/KarlManong/following{/other_user}","gists_url":"https://api.github.com/users/KarlManong/gists{/gist_id}","starred_url":"https://api.github.com/users/KarlManong/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/KarlManong/subscriptions","organizations_url":"https://api.github.com/users/KarlManong/orgs","repos_url":"https://api.github.com/users/KarlManong/repos","events_url":"https://api.github.com/users/KarlManong/events{/privacy}","received_events_url":"https://api.github.com/users/KarlManong/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-31T07:52:49Z","updated_at":"2022-03-31T07:52:49Z","author_association":"CONTRIBUTOR","body":"I think #3717 can fix this","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1084223547/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1084497768","html_url":"https://github.com/apache/iceberg/pull/4436#issuecomment-1084497768","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4436","id":1084497768,"node_id":"IC_kwDOCW7NX85ApB9o","user":{"login":"samredai","id":43911210,"node_id":"MDQ6VXNlcjQzOTExMjEw","avatar_url":"https://avatars.githubusercontent.com/u/43911210?v=4","gravatar_id":"","url":"https://api.github.com/users/samredai","html_url":"https://github.com/samredai","followers_url":"https://api.github.com/users/samredai/followers","following_url":"https://api.github.com/users/samredai/following{/other_user}","gists_url":"https://api.github.com/users/samredai/gists{/gist_id}","starred_url":"https://api.github.com/users/samredai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samredai/subscriptions","organizations_url":"https://api.github.com/users/samredai/orgs","repos_url":"https://api.github.com/users/samredai/repos","events_url":"https://api.github.com/users/samredai/events{/privacy}","received_events_url":"https://api.github.com/users/samredai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-31T12:10:16Z","updated_at":"2022-03-31T12:42:59Z","author_association":"CONTRIBUTOR","body":"LGTM!\r\n\r\nThe lint failure is because mypy is confused by the `isinstance(value, type)` in the constructor for `Literal`. Once it sees an isinstance check it uses that to infer the expected type and for `type` it infers a very general `object`. I think the best thing to do is to add a mypy ignore comment to the value property method for `Literal`:\r\n```py\r\n    @property\r\n    def value(self) -> T:\r\n        return self._value  # type: ignore\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1084497768/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1084639356","html_url":"https://github.com/apache/iceberg/issues/4447#issuecomment-1084639356","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4447","id":1084639356,"node_id":"IC_kwDOCW7NX85Apkh8","user":{"login":"kyle-cx91","id":10529123,"node_id":"MDQ6VXNlcjEwNTI5MTIz","avatar_url":"https://avatars.githubusercontent.com/u/10529123?v=4","gravatar_id":"","url":"https://api.github.com/users/kyle-cx91","html_url":"https://github.com/kyle-cx91","followers_url":"https://api.github.com/users/kyle-cx91/followers","following_url":"https://api.github.com/users/kyle-cx91/following{/other_user}","gists_url":"https://api.github.com/users/kyle-cx91/gists{/gist_id}","starred_url":"https://api.github.com/users/kyle-cx91/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kyle-cx91/subscriptions","organizations_url":"https://api.github.com/users/kyle-cx91/orgs","repos_url":"https://api.github.com/users/kyle-cx91/repos","events_url":"https://api.github.com/users/kyle-cx91/events{/privacy}","received_events_url":"https://api.github.com/users/kyle-cx91/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-31T14:09:37Z","updated_at":"2022-03-31T14:09:37Z","author_association":"CONTRIBUTOR","body":"@felixYyu  u can roll-back the branch u initiated the PR, and recommit the change u like to the same branch. Modifications will be automatically reflected on PR.\r\n\r\nps: remember to back up the code before the roll-back","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1084639356/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1084730748","html_url":"https://github.com/apache/iceberg/pull/4405#issuecomment-1084730748","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4405","id":1084730748,"node_id":"IC_kwDOCW7NX85Ap618","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-31T15:13:12Z","updated_at":"2022-03-31T15:13:12Z","author_association":"CONTRIBUTOR","body":"Thanks, @kbendick!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1084730748/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]