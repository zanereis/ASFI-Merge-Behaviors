[{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/794339725","html_url":"https://github.com/apache/couchdb/pull/3380#issuecomment-794339725","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3380","id":794339725,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NDMzOTcyNQ==","user":{"login":"iilyak","id":9804420,"node_id":"MDQ6VXNlcjk4MDQ0MjA=","avatar_url":"https://avatars.githubusercontent.com/u/9804420?v=4","gravatar_id":"","url":"https://api.github.com/users/iilyak","html_url":"https://github.com/iilyak","followers_url":"https://api.github.com/users/iilyak/followers","following_url":"https://api.github.com/users/iilyak/following{/other_user}","gists_url":"https://api.github.com/users/iilyak/gists{/gist_id}","starred_url":"https://api.github.com/users/iilyak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/iilyak/subscriptions","organizations_url":"https://api.github.com/users/iilyak/orgs","repos_url":"https://api.github.com/users/iilyak/repos","events_url":"https://api.github.com/users/iilyak/events{/privacy}","received_events_url":"https://api.github.com/users/iilyak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-09T19:24:18Z","updated_at":"2021-03-09T19:24:18Z","author_association":"CONTRIBUTOR","body":"I think I would need to create a new repo for the parse_transform code. Because it need to be used as dependency for other applications which are not part of the monolithic repository.\r\n\r\nI am trying to choose between\r\n1. a repository specifically for this transform\r\n2. a repository which we would use to hold all transforms we ever implement\r\n3. a repository with utility functions which would also have parse transforms in there\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/794339725/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/794430675","html_url":"https://github.com/apache/couchdb/pull/3411#issuecomment-794430675","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3411","id":794430675,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NDQzMDY3NQ==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-09T20:44:50Z","updated_at":"2021-03-09T20:44:50Z","author_association":"CONTRIBUTOR","body":"`make check` passed locally too","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/794430675/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/794586381","html_url":"https://github.com/apache/couchdb/pull/3391#issuecomment-794586381","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3391","id":794586381,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NDU4NjM4MQ==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-09T23:13:03Z","updated_at":"2021-03-09T23:13:03Z","author_association":"CONTRIBUTOR","body":"Two more fixups:\r\n     \r\n   * https://github.com/apache/couchdb/pull/3391/commits/a0cc49fc8af1c567c7362c44163827f99b7f4b13 : ensure that we don't bump the `DbReadVsn` but not the `DbViewVns` as it makes the logic of view emits a bit more complicated if we do want to emit from an un-completed view. So we ensure we persist either both `DbReadVsn` and `ViewReadVsn` together or they both stay `null`.\r\n \r\n   * https://github.com/apache/couchdb/pull/3391/commits/c0b24dacf0f26ac23bc8e874ea83573567525f3b This is a cherry pick from @kocolosk. This is needed to pass all the tests otherwise the last do_update's report_progress call will result in a data update with `ViewSeq >= UpdateSeq` which will make subscriptions fire break a bunch of unit tests.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/794586381/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/795453294","html_url":"https://github.com/apache/couchdb/pull/3380#issuecomment-795453294","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3380","id":795453294,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NTQ1MzI5NA==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-10T14:02:10Z","updated_at":"2021-03-10T14:02:10Z","author_association":"MEMBER","body":"Good cleanup @iilyak! This is a lot easer to comprehend.\r\n\r\nThe one place where this could do with a comment about what happens is https://github.com/apache/couchdb/pull/3380/files#diff-33000329e1e5eb2554d72f4675fb32c2bf3e0599c981f044683467cb25efc02aR378 which seems very meta and it is not clear to me what is happening there, or if we still need it, now that ddocs are out of scope for redacting.\r\n\r\nI agree with @rnewson on the duplication and agree with methods to mitigate. A separate repo sounds good. I would go with option 1. until we have more transforms, at which point we can move things around.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/795453294/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/795790595","html_url":"https://github.com/apache/couchdb/issues/3410#issuecomment-795790595","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3410","id":795790595,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NTc5MDU5NQ==","user":{"login":"wknd","id":328942,"node_id":"MDQ6VXNlcjMyODk0Mg==","avatar_url":"https://avatars.githubusercontent.com/u/328942?v=4","gravatar_id":"","url":"https://api.github.com/users/wknd","html_url":"https://github.com/wknd","followers_url":"https://api.github.com/users/wknd/followers","following_url":"https://api.github.com/users/wknd/following{/other_user}","gists_url":"https://api.github.com/users/wknd/gists{/gist_id}","starred_url":"https://api.github.com/users/wknd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wknd/subscriptions","organizations_url":"https://api.github.com/users/wknd/orgs","repos_url":"https://api.github.com/users/wknd/repos","events_url":"https://api.github.com/users/wknd/events{/privacy}","received_events_url":"https://api.github.com/users/wknd/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-10T17:34:20Z","updated_at":"2021-03-10T17:34:20Z","author_association":"NONE","body":"I can't seem to find the per shard info you describe or find the documentation to get the right syntax.\r\n```\r\n$ curl -s -X GET http://localhost:5984/testtest/_shards -K curl-proxyauth.conf  | jq\r\n{  \"shards\": {    \"00000000-7fffffff\": [\r\n      \"nonode@nohost\"\r\n    ],\r\n    \"80000000-ffffffff\": [\r\n      \"nonode@nohost\"\r\n    ]\r\n  }\r\n}\r\n```\r\n```\r\n$ curl -s -X GET http://localhost:5984/_node/nonode@nohost/_dbs -K curl-proxyauth.conf  | jq\r\n{\r\n  \"db_name\": \"_dbs\",\r\n  \"engine\": \"couch_bt_engine\",\r\n  \"doc_count\": 8,\r\n  \"doc_del_count\": 0,\r\n  \"update_seq\": 8,\r\n  \"purge_seq\": 0,\r\n  \"compact_running\": false,\r\n  \"sizes\": {\r\n    \"active\": 2660,\r\n    \"external\": 2584,\r\n    \"file\": 37069\r\n  },\r\n  \"instance_start_time\": \"1615397397994629\",\r\n  \"disk_format_version\": 8,\r\n  \"committed_update_seq\": 8,\r\n  \"compacted_seq\": 0,\r\n  \"props\": {},\r\n  \"uuid\": \"09db1ca01262f5ee27d72711c63f182c\"\r\n}\r\n```\r\n```\r\n$ curl -s -X GET http://localhost:5984/_node/nonode@nohost/00000000-7fffffff -K curl-proxyauth.conf  | jq\r\n{\r\n  \"error\": \"illegal_database_name\",\r\n  \"reason\": \"Name: '00000000-7fffffff'. Only lowercase characters (a-z), digits (0-9), and any of the characters _, $, (, ), +, -, and / are allowed. Must begin with a letter.\"\r\n}\r\n$ curl -s -X GET 'http://localhost:5984/_node/nonode@nohost/testtest.1615396353' -K curl-proxyauth.conf  | jq\r\n{\r\n  \"error\": \"not_found\",\r\n  \"reason\": \"no_db_file\"\r\n}\r\n$ curl -s -X GET 'http://localhost:5984/_node/nonode@nohost/testtest.1615396353.couch' -K curl-proxyauth.conf  | jq\r\n{\r\n  \"error\": \"not_found\",\r\n  \"reason\": \"no_db_file\"\r\n}\r\n```\r\nwhat file does it expect there?\r\n\r\nThe smoosh logs you're looking for only occur with testscript 1: \r\n```\r\ntouch2-couchdb | [notice] 2021-03-10T17:02:26.300395Z nonode@nohost <0.430.0> -------- ratio_dbs: adding <<\"shards/00000000-7fffffff/testtest.1615393017\">> to internal compactor queue with priority 16.02983105341381\r\ntouch2-couchdb | [notice] 2021-03-10T17:02:26.300465Z nonode@nohost <0.430.0> -------- ratio_dbs: Starting compaction for shards/00000000-7fffffff/testtest.1615393017 (priority 16.02983105341381)\r\ntouch2-couchdb | [notice] 2021-03-10T17:02:26.300706Z nonode@nohost <0.430.0> -------- ratio_dbs: Started compaction for shards/00000000-7fffffff/testtest.1615393017\r\n```\r\n(though todays test seems to reach a higher priority than yesterday even though I started over from a clean image for further testing)\r\n\r\nwith testscript 2 the smoosh log never emits, and db sizes when I gave up were:\r\n```\r\n$ curl -s -X GET http://localhost:5984/testtest -K curl-proxyauth.conf | jq\r\n{  \"db_name\": \"testtest\",  \"purge_seq\": \"0-g1AAAABPeJzLYWBgYMpgTmHgzcvPy09JdcjLz8gvLskBCeexAEmGBiD1HwiyEhlwqEtkSKqHKMgCAIT2GV4\",  \"update_seq\": \"767-g1AAAABSeJzLYWBgYMpgTmHgzcvPy09JdcjLz8gvLskBCeexAEmGBiD1HwiyEhlwqEtkSKoHKUgCsv9nAQDR3Bpg\",\r\n  \"sizes\": {\r\n    \"file\": 3277164,\r\n    \"external\": 16637,\r\n    \"active\": 40239\r\n  },\r\n  \"props\": {},\r\n  \"doc_del_count\": 0,\r\n  \"doc_count\": 1,\r\n  \"disk_format_version\": 8,\r\n  \"compact_running\": false,\r\n  \"cluster\": {\r\n    \"q\": 2,\r\n    \"n\": 1,\r\n    \"w\": 1,\r\n    \"r\": 1\r\n  },\r\n  \"instance_start_time\": \"0\"\r\n}\r\n```\r\nNote there is almost nothing on this server for testing, a few empty databases and 1 'testtest' database with just 1 document in it. I'm creating a new docker container just for these tests.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/795790595/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/795791107","html_url":"https://github.com/apache/couchdb/pull/3413#issuecomment-795791107","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3413","id":795791107,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NTc5MTEwNw==","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-10T17:34:40Z","updated_at":"2021-03-10T17:34:40Z","author_association":"MEMBER","body":"Added nick's suggestions and his max_sessions work.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/795791107/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/795951980","html_url":"https://github.com/apache/couchdb/issues/3410#issuecomment-795951980","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3410","id":795951980,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NTk1MTk4MA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-10T19:25:06Z","updated_at":"2021-03-10T19:28:16Z","author_association":"MEMBER","body":"Sorry, I rushed my advice, here's an example on a local DB:\r\n\r\n```\r\n$ curl http://admin:password@localhost:5984/_membership\r\n{\"all_nodes\":[\"couchdb@localhost\"],\"cluster_nodes\":[\"couchdb@localhost\"]}\r\n\r\n$ curl http://admin:password@localhost:5984/_node/couchdb@localhost/_dbs/test1\r\n{\"_id\":\"test1\",\"_rev\":\"1-24ad69872d6cdaa9a85708b327ba887d\",\"shard_suffix\":[46,49,54,48,50,49,55,48,50,54,48],\"changelog\":[[\"add\",\"00000000-7fffffff\",\"couchdb@localhost\"],[\"add\",\"80000000-ffffffff\",\"couchdb@localhost\"]],\"by_node\":{\"couchdb@localhost\":[\"00000000-7fffffff\",\"80000000-ffffffff\"]},\"by_range\":{\"00000000-7fffffff\":[\"couchdb@localhost\"],\"80000000-ffffffff\":[\"couchdb@localhost\"]},\"props\":{}}\r\n\r\n$ curl http://admin:password@localhost:5984/_node/couchdb@localhost/_all_dbs\r\n... cut for privacy...\r\n\"shards/00000000-7fffffff/test1.1602170260\",\r\n\"shards/80000000-ffffffff/test1.1602170260\"\r\n\r\n$ curl http://admin:password@localhost:5984/_node/couchdb@localhost/shards%2f00000000-7fffffff%2ftest1.1602170260\r\n{\"db_name\":\"shards/00000000-7fffffff/test1.1602170260\",\"engine\":\"couch_bt_engine\",\"doc_count\":0,\"doc_del_count\":0,\"update_seq\":0,\"purge_seq\":0,\"compact_running\":false,\"sizes\":{\"active\":333,\"external\":0,\"file\":16549},\"instance_start_time\":\"1615404245595000\",\"disk_format_version\":8,\"committed_update_seq\":0,\"compacted_seq\":0,\"props\":{},\"uuid\":\"eefcf4e13cf56f1f5bd063afce077672\"}\r\n```\r\n\r\nAnd repeat for `80-ff` range. So for 00-7f for this DB the info is `{\"active\":333,\"external\":0,\"file\":16549}`.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/795951980/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/796067919","html_url":"https://github.com/apache/couchdb/issues/3410#issuecomment-796067919","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3410","id":796067919,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NjA2NzkxOQ==","user":{"login":"wknd","id":328942,"node_id":"MDQ6VXNlcjMyODk0Mg==","avatar_url":"https://avatars.githubusercontent.com/u/328942?v=4","gravatar_id":"","url":"https://api.github.com/users/wknd","html_url":"https://github.com/wknd","followers_url":"https://api.github.com/users/wknd/followers","following_url":"https://api.github.com/users/wknd/following{/other_user}","gists_url":"https://api.github.com/users/wknd/gists{/gist_id}","starred_url":"https://api.github.com/users/wknd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wknd/subscriptions","organizations_url":"https://api.github.com/users/wknd/orgs","repos_url":"https://api.github.com/users/wknd/repos","events_url":"https://api.github.com/users/wknd/events{/privacy}","received_events_url":"https://api.github.com/users/wknd/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-10T20:40:47Z","updated_at":"2021-03-10T20:40:47Z","author_association":"NONE","body":"No problem, got the data for you:\r\n```\r\n$ curl -s -X GET http://localhost:5984/_node/nonode@nohost/_all_dbs -K curl-proxyauth.conf | jq\r\n[\r\n  \"_dbs\",\r\n  \"_nodes\",\r\n  \"_users\",\r\n  \"shards/00000000-7fffffff/_users.1615396319\",\r\n  \"shards/00000000-7fffffff/testtest.1615396353\",\r\n  ... snip snip...\r\n  \"shards/80000000-ffffffff/_users.1615396319\",\r\n  \"shards/80000000-ffffffff/testtest.1615396353\",\r\n  ... snip snip ...\r\n]\r\n```\r\n```\r\n\r\n$ curl -s -X GET http://localhost:5984/_node/nonode@nohost/shards%2f00000000-7fffffff%2ftesttest.1615396353 -K curl-proxyauth.conf | jq\r\n{\r\n  \"db_name\": \"shards/00000000-7fffffff/testtest.1615396353\",\r\n  \"engine\": \"couch_bt_engine\",\r\n  \"doc_count\": 1,\r\n  \"doc_del_count\": 0,\r\n  \"update_seq\": 853,\r\n  \"purge_seq\": 0,\r\n  \"compact_running\": false,\r\n  \"sizes\": {\r\n    \"active\": 34963,\r\n    \"external\": 96,\r\n    \"file\": 2887884\r\n  },\r\n  \"instance_start_time\": \"1615408498456965\",\r\n  \"disk_format_version\": 8,\r\n  \"committed_update_seq\": 853,\r\n  \"compacted_seq\": 837,\r\n  \"props\": {},\r\n  \"uuid\": \"d16cdf0c8f8c65db7902499ee4857dc9\"\r\n}\r\n$ curl -s -X GET http://localhost:5984/_node/nonode@nohost/shards%2f80000000-ffffffff%2ftesttest.1615396353 -K curl-proxyauth.conf | jq\r\n{\r\n  \"db_name\": \"shards/80000000-ffffffff/testtest.1615396353\",\r\n  \"engine\": \"couch_bt_engine\",\r\n  \"doc_count\": 0,\r\n  \"doc_del_count\": 0,\r\n  \"update_seq\": 0,\r\n  \"purge_seq\": 0,\r\n  \"compact_running\": false,\r\n  \"sizes\": {\r\n    \"active\": 0,\r\n    \"external\": 0,\r\n    \"file\": 8346\r\n  },\r\n  \"instance_start_time\": \"1615408546533771\",\r\n  \"disk_format_version\": 8,\r\n  \"committed_update_seq\": 0,\r\n  \"compacted_seq\": 0,\r\n  \"props\": {},\r\n  \"uuid\": \"b5d43e1cb89a57b4234877546b7bcd16\"\r\n}\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/796067919/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/796352519","html_url":"https://github.com/apache/couchdb/issues/3410#issuecomment-796352519","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3410","id":796352519,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NjM1MjUxOQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T01:26:40Z","updated_at":"2021-03-11T01:26:40Z","author_association":"MEMBER","body":"@wknd is this for your test scenario 1 or 2?\r\n\r\n@rnewson thoughts on the above? ratio seems to trigger but I'm not seeing the compaction.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/796352519/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/796552861","html_url":"https://github.com/apache/couchdb/issues/3410#issuecomment-796552861","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3410","id":796552861,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NjU1Mjg2MQ==","user":{"login":"wknd","id":328942,"node_id":"MDQ6VXNlcjMyODk0Mg==","avatar_url":"https://avatars.githubusercontent.com/u/328942?v=4","gravatar_id":"","url":"https://api.github.com/users/wknd","html_url":"https://github.com/wknd","followers_url":"https://api.github.com/users/wknd/followers","following_url":"https://api.github.com/users/wknd/following{/other_user}","gists_url":"https://api.github.com/users/wknd/gists{/gist_id}","starred_url":"https://api.github.com/users/wknd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wknd/subscriptions","organizations_url":"https://api.github.com/users/wknd/orgs","repos_url":"https://api.github.com/users/wknd/repos","events_url":"https://api.github.com/users/wknd/events{/privacy}","received_events_url":"https://api.github.com/users/wknd/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T08:12:15Z","updated_at":"2021-03-11T08:12:15Z","author_association":"NONE","body":"Those logs were after running scenario 2.\r\nScenario 1 it does seem to trigger it as expected.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/796552861/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/796554611","html_url":"https://github.com/apache/couchdb/pull/3404#issuecomment-796554611","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3404","id":796554611,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NjU1NDYxMQ==","user":{"login":"bessbd","id":9086834,"node_id":"MDQ6VXNlcjkwODY4MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/9086834?v=4","gravatar_id":"","url":"https://api.github.com/users/bessbd","html_url":"https://github.com/bessbd","followers_url":"https://api.github.com/users/bessbd/followers","following_url":"https://api.github.com/users/bessbd/following{/other_user}","gists_url":"https://api.github.com/users/bessbd/gists{/gist_id}","starred_url":"https://api.github.com/users/bessbd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bessbd/subscriptions","organizations_url":"https://api.github.com/users/bessbd/orgs","repos_url":"https://api.github.com/users/bessbd/repos","events_url":"https://api.github.com/users/bessbd/events{/privacy}","received_events_url":"https://api.github.com/users/bessbd/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T08:15:30Z","updated_at":"2021-03-11T08:15:30Z","author_association":"MEMBER","body":"Hi @jjrodrig ,\r\nCan you please do a second / final pass on this PR?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/796554611/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/796825381","html_url":"https://github.com/apache/couchdb/pull/3414#issuecomment-796825381","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3414","id":796825381,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NjgyNTM4MQ==","user":{"login":"bessbd","id":9086834,"node_id":"MDQ6VXNlcjkwODY4MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/9086834?v=4","gravatar_id":"","url":"https://api.github.com/users/bessbd","html_url":"https://github.com/bessbd","followers_url":"https://api.github.com/users/bessbd/followers","following_url":"https://api.github.com/users/bessbd/following{/other_user}","gists_url":"https://api.github.com/users/bessbd/gists{/gist_id}","starred_url":"https://api.github.com/users/bessbd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bessbd/subscriptions","organizations_url":"https://api.github.com/users/bessbd/orgs","repos_url":"https://api.github.com/users/bessbd/repos","events_url":"https://api.github.com/users/bessbd/events{/privacy}","received_events_url":"https://api.github.com/users/bessbd/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T15:36:51Z","updated_at":"2021-03-11T15:36:51Z","author_association":"MEMBER","body":"Thank you for this PR, @nickva !\r\nI'm getting some fails on my machine: https://gist.github.com/bessbd/906e50015a8ace1432f11538a08151e1 (I got `Failed: 8.` on a previous run.)\r\nDo you have them all passing when you run them locally?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/796825381/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/796830709","html_url":"https://github.com/apache/couchdb/pull/3414#issuecomment-796830709","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3414","id":796830709,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NjgzMDcwOQ==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T15:44:15Z","updated_at":"2021-03-11T17:32:04Z","author_association":"CONTRIBUTOR","body":"@bessbd thanks for taking a look! Good find. \r\n\r\nThey should be passing yeah. I saw they passed in Jenkins and locally for me so I submitted the PR. But there is still some flakiness in there it seems.\r\n\r\nCould you share more about your environment so I can reproduce the issue (Erlang version? Do you use docker?)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/796830709/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/796938965","html_url":"https://github.com/apache/couchdb/pull/3364#issuecomment-796938965","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3364","id":796938965,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NjkzODk2NQ==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T18:12:57Z","updated_at":"2021-03-11T18:12:57Z","author_association":"CONTRIBUTOR","body":"Will merge the PR and noting that I still owe a documentation update for it.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/796938965/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/797010959","html_url":"https://github.com/apache/couchdb/pull/3391#issuecomment-797010959","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3391","id":797010959,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NzAxMDk1OQ==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T20:01:10Z","updated_at":"2021-03-11T20:01:10Z","author_association":"CONTRIBUTOR","body":"Thanks for taking a look @kocolosk. I integrated c0b24da to make the test suite pass. Should I integrate 2e40063 as well? I'd be happy to do it","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/797010959/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/797012667","html_url":"https://github.com/apache/couchdb/pull/3391#issuecomment-797012667","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3391","id":797012667,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NzAxMjY2Nw==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T20:03:57Z","updated_at":"2021-03-11T20:03:57Z","author_association":"CONTRIBUTOR","body":"Another piece that would be related is to modify the couch_views batcher so it doesn't try to bump against the 5 second timeout limit and instead use a lower limit (you suggested 1 sec). I think it would be a separate PR though\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/797012667/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/797061637","html_url":"https://github.com/apache/couchdb/pull/3414#issuecomment-797061637","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3414","id":797061637,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NzA2MTYzNw==","user":{"login":"bessbd","id":9086834,"node_id":"MDQ6VXNlcjkwODY4MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/9086834?v=4","gravatar_id":"","url":"https://api.github.com/users/bessbd","html_url":"https://github.com/bessbd","followers_url":"https://api.github.com/users/bessbd/followers","following_url":"https://api.github.com/users/bessbd/following{/other_user}","gists_url":"https://api.github.com/users/bessbd/gists{/gist_id}","starred_url":"https://api.github.com/users/bessbd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bessbd/subscriptions","organizations_url":"https://api.github.com/users/bessbd/orgs","repos_url":"https://api.github.com/users/bessbd/repos","events_url":"https://api.github.com/users/bessbd/events{/privacy}","received_events_url":"https://api.github.com/users/bessbd/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T21:29:09Z","updated_at":"2021-03-11T21:29:09Z","author_association":"MEMBER","body":"> Could you share more about your environment so I can reproduce the issue (Erlang version? Do you use docker?)\r\n\r\n`[donat:~/couchdb] 23a2d3709* 24m44s ±  erl -eval 'erlang:display(erlang:system_info(otp_release)), halt().'  -noshell\r\n\"21\"`\r\nNo docker.\r\n\r\nPlease let me know if you need any further info.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/797061637/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/797069943","html_url":"https://github.com/apache/couchdb/pull/3414#issuecomment-797069943","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3414","id":797069943,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NzA2OTk0Mw==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T21:44:10Z","updated_at":"2021-03-11T21:44:10Z","author_association":"CONTRIBUTOR","body":"@bessbd thank you!\r\n\r\nWould you be able to fetch the logs in `src/couch_views/.eunit/couch.log` and share in gist or txt attachment. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/797069943/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/797096716","html_url":"https://github.com/apache/couchdb/pull/3404#issuecomment-797096716","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3404","id":797096716,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NzA5NjcxNg==","user":{"login":"bessbd","id":9086834,"node_id":"MDQ6VXNlcjkwODY4MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/9086834?v=4","gravatar_id":"","url":"https://api.github.com/users/bessbd","html_url":"https://github.com/bessbd","followers_url":"https://api.github.com/users/bessbd/followers","following_url":"https://api.github.com/users/bessbd/following{/other_user}","gists_url":"https://api.github.com/users/bessbd/gists{/gist_id}","starred_url":"https://api.github.com/users/bessbd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bessbd/subscriptions","organizations_url":"https://api.github.com/users/bessbd/orgs","repos_url":"https://api.github.com/users/bessbd/repos","events_url":"https://api.github.com/users/bessbd/events{/privacy}","received_events_url":"https://api.github.com/users/bessbd/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T22:37:57Z","updated_at":"2021-03-11T22:37:57Z","author_association":"MEMBER","body":"Thank you for the review, @jjrodrig ! I'm about to merge this.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/797096716/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/797105638","html_url":"https://github.com/apache/couchdb/issues/3394#issuecomment-797105638","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3394","id":797105638,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NzEwNTYzOA==","user":{"login":"bessbd","id":9086834,"node_id":"MDQ6VXNlcjkwODY4MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/9086834?v=4","gravatar_id":"","url":"https://api.github.com/users/bessbd","html_url":"https://github.com/bessbd","followers_url":"https://api.github.com/users/bessbd/followers","following_url":"https://api.github.com/users/bessbd/following{/other_user}","gists_url":"https://api.github.com/users/bessbd/gists{/gist_id}","starred_url":"https://api.github.com/users/bessbd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bessbd/subscriptions","organizations_url":"https://api.github.com/users/bessbd/orgs","repos_url":"https://api.github.com/users/bessbd/repos","events_url":"https://api.github.com/users/bessbd/events{/privacy}","received_events_url":"https://api.github.com/users/bessbd/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T22:57:57Z","updated_at":"2021-03-11T22:57:57Z","author_association":"MEMBER","body":"Update: I think the issue linked above (`uninitialized`) has been fixed by  https://github.com/apache/couchdb-erlfdb/releases/tag/v1.2.9 and https://github.com/apache/couchdb/commit/c00bdd7ba93e7cdfcf8faebc9d9306931d5ffa0b . \r\nAlso, the current issues will probably be resolved by https://github.com/apache/couchdb/pull/3414 .","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/797105638/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/797107773","html_url":"https://github.com/apache/couchdb/pull/3414#issuecomment-797107773","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3414","id":797107773,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NzEwNzc3Mw==","user":{"login":"bessbd","id":9086834,"node_id":"MDQ6VXNlcjkwODY4MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/9086834?v=4","gravatar_id":"","url":"https://api.github.com/users/bessbd","html_url":"https://github.com/bessbd","followers_url":"https://api.github.com/users/bessbd/followers","following_url":"https://api.github.com/users/bessbd/following{/other_user}","gists_url":"https://api.github.com/users/bessbd/gists{/gist_id}","starred_url":"https://api.github.com/users/bessbd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bessbd/subscriptions","organizations_url":"https://api.github.com/users/bessbd/orgs","repos_url":"https://api.github.com/users/bessbd/repos","events_url":"https://api.github.com/users/bessbd/events{/privacy}","received_events_url":"https://api.github.com/users/bessbd/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T23:02:34Z","updated_at":"2021-03-11T23:02:34Z","author_association":"MEMBER","body":"> @bessbd thank you!\r\n> \r\n> Would you be able to fetch the logs in `src/couch_views/.eunit/couch.log` and share in gist or txt attachment.\r\n\r\n```\r\n[donat:~/couchdb] 23a2d3709* 7h45m25s ± ls -la  src/couch_views/.eunit\r\nls: src/couch_views/.eunit: No such file or directory\r\n```\r\n\r\nI got a `src/couch_jobs/.eunit/couch.log` though if that's what you meant: https://gist.github.com/bessbd/d34d94f9888993d07b149ce88684428d","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/797107773/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/797120928","html_url":"https://github.com/apache/couchdb/pull/3414#issuecomment-797120928","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3414","id":797120928,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NzEyMDkyOA==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T23:33:24Z","updated_at":"2021-03-12T06:30:19Z","author_association":"CONTRIBUTOR","body":"@bessbd sorry, I meant `couch_jobs`, thanks for the logs. \r\n\r\nNo obvious errors based on the log so far.  I can probably update few places to do the `test_util:wait(...)` pattern to wait for the value to change.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/797120928/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/797164160","html_url":"https://github.com/apache/couchdb/pull/3391#issuecomment-797164160","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3391","id":797164160,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NzE2NDE2MA==","user":{"login":"kocolosk","id":16679,"node_id":"MDQ6VXNlcjE2Njc5","avatar_url":"https://avatars.githubusercontent.com/u/16679?v=4","gravatar_id":"","url":"https://api.github.com/users/kocolosk","html_url":"https://github.com/kocolosk","followers_url":"https://api.github.com/users/kocolosk/followers","following_url":"https://api.github.com/users/kocolosk/following{/other_user}","gists_url":"https://api.github.com/users/kocolosk/gists{/gist_id}","starred_url":"https://api.github.com/users/kocolosk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kocolosk/subscriptions","organizations_url":"https://api.github.com/users/kocolosk/orgs","repos_url":"https://api.github.com/users/kocolosk/repos","events_url":"https://api.github.com/users/kocolosk/events{/privacy}","received_events_url":"https://api.github.com/users/kocolosk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-12T01:14:56Z","updated_at":"2021-03-12T01:14:56Z","author_association":"MEMBER","body":"Agree that would be a separate PR. I'm fine to leave 2e40063 out as well -- it's not related to the work of getting `include_docs` to match the view output, it's on a different topic of ensuring the view actually observes a snapshot of the DB as it existed at some point in time (which is only the case today if the indexer does not need to retry, or the write pattern is insert-only).","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/797164160/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/797265211","html_url":"https://github.com/apache/couchdb/pull/3391#issuecomment-797265211","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3391","id":797265211,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NzI2NTIxMQ==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-12T06:21:32Z","updated_at":"2021-03-22T15:47:26Z","author_association":"CONTRIBUTOR","body":"Found one more test that was failing because of how it mocked the indexer and expected do_update to be called. Fixed in a separate commit ea36569\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/797265211/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/797266385","html_url":"https://github.com/apache/couchdb/pull/3414#issuecomment-797266385","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3414","id":797266385,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NzI2NjM4NQ==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-12T06:24:14Z","updated_at":"2021-03-12T06:24:14Z","author_association":"CONTRIBUTOR","body":"To see if the db_expiration circular dependency on couch_jobs is messing up the tests would you mind trying running the tests with this diff:\r\n\r\n```\r\ndiff --git a/src/fabric/src/fabric2_db_expiration.erl b/src/fabric/src/fabric2_db_expiration.erl\r\nindex 92f22e749..4a79e5474 100644\r\n--- a/src/fabric/src/fabric2_db_expiration.erl\r\n+++ b/src/fabric/src/fabric2_db_expiration.erl\r\n@@ -56,7 +56,7 @@ start_link() ->\r\n \r\n init(_) ->\r\n     process_flag(trap_exit, true),\r\n-    {ok, #st{job = undefined}, 0}.\r\n+    {ok, #st{job = undefined}, 99999999}.\r\n \r\n```\r\n\r\nWe are basically disabling db expiration from initialization and using couch_jobs, so then when it restart, it doesn't bring fabric application down. Wonder if you'd see a different set of failures with that or no difference at all.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/797266385/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/797358363","html_url":"https://github.com/apache/couchdb/pull/3414#issuecomment-797358363","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3414","id":797358363,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NzM1ODM2Mw==","user":{"login":"bessbd","id":9086834,"node_id":"MDQ6VXNlcjkwODY4MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/9086834?v=4","gravatar_id":"","url":"https://api.github.com/users/bessbd","html_url":"https://github.com/bessbd","followers_url":"https://api.github.com/users/bessbd/followers","following_url":"https://api.github.com/users/bessbd/following{/other_user}","gists_url":"https://api.github.com/users/bessbd/gists{/gist_id}","starred_url":"https://api.github.com/users/bessbd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bessbd/subscriptions","organizations_url":"https://api.github.com/users/bessbd/orgs","repos_url":"https://api.github.com/users/bessbd/repos","events_url":"https://api.github.com/users/bessbd/events{/privacy}","received_events_url":"https://api.github.com/users/bessbd/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-12T09:24:20Z","updated_at":"2021-03-12T09:25:30Z","author_association":"MEMBER","body":"[`(git diff && make eunit apps=couch_jobs 2>&1) |pbcopy`](https://gist.github.com/bessbd/02c0101db549e74dac59a157832fa1f7)\r\n\r\nDo you get 100% pass locally? Is it failing only on my machine?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/797358363/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/797359839","html_url":"https://github.com/apache/couchdb/pull/3414#issuecomment-797359839","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3414","id":797359839,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NzM1OTgzOQ==","user":{"login":"bessbd","id":9086834,"node_id":"MDQ6VXNlcjkwODY4MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/9086834?v=4","gravatar_id":"","url":"https://api.github.com/users/bessbd","html_url":"https://github.com/bessbd","followers_url":"https://api.github.com/users/bessbd/followers","following_url":"https://api.github.com/users/bessbd/following{/other_user}","gists_url":"https://api.github.com/users/bessbd/gists{/gist_id}","starred_url":"https://api.github.com/users/bessbd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bessbd/subscriptions","organizations_url":"https://api.github.com/users/bessbd/orgs","repos_url":"https://api.github.com/users/bessbd/repos","events_url":"https://api.github.com/users/bessbd/events{/privacy}","received_events_url":"https://api.github.com/users/bessbd/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-12T09:26:38Z","updated_at":"2021-03-12T09:26:38Z","author_association":"MEMBER","body":"If we get a consistent green in CI, then I think we should merge this and let's figure out what could be wrong later.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/797359839/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/797696388","html_url":"https://github.com/apache/couchdb/pull/3414#issuecomment-797696388","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3414","id":797696388,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NzY5NjM4OA==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-12T19:15:53Z","updated_at":"2021-03-12T19:15:53Z","author_association":"CONTRIBUTOR","body":"I'll merge then and make a new issue to keep track of the failure @bessbd found","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/797696388/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/797700715","html_url":"https://github.com/apache/couchdb/pull/3414#issuecomment-797700715","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3414","id":797700715,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NzcwMDcxNQ==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-12T19:22:00Z","updated_at":"2021-03-12T19:22:00Z","author_association":"CONTRIBUTOR","body":"New issue https://github.com/apache/couchdb/issues/3417","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/797700715/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/797767800","html_url":"https://github.com/apache/couchdb/pull/3419#issuecomment-797767800","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3419","id":797767800,"node_id":"MDEyOklzc3VlQ29tbWVudDc5Nzc2NzgwMA==","user":{"login":"tonysun83","id":6991573,"node_id":"MDQ6VXNlcjY5OTE1NzM=","avatar_url":"https://avatars.githubusercontent.com/u/6991573?v=4","gravatar_id":"","url":"https://api.github.com/users/tonysun83","html_url":"https://github.com/tonysun83","followers_url":"https://api.github.com/users/tonysun83/followers","following_url":"https://api.github.com/users/tonysun83/following{/other_user}","gists_url":"https://api.github.com/users/tonysun83/gists{/gist_id}","starred_url":"https://api.github.com/users/tonysun83/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tonysun83/subscriptions","organizations_url":"https://api.github.com/users/tonysun83/orgs","repos_url":"https://api.github.com/users/tonysun83/repos","events_url":"https://api.github.com/users/tonysun83/events{/privacy}","received_events_url":"https://api.github.com/users/tonysun83/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-12T21:33:01Z","updated_at":"2021-03-12T21:33:01Z","author_association":"CONTRIBUTOR","body":"tests ran successfully for me:\r\n```\r\n=======================================================\r\n  All 37 tests passed.\r\nCover analysis: /Users/tonysun/github/cloudant/couchdb/src/couch_jobs/.eunit/index.html\r\n\r\nCode Coverage:\r\ncouch_jobs                      :  77%\r\ncouch_jobs_activity_monitor     :  78%\r\ncouch_jobs_activity_monitor_sup : 100%\r\ncouch_jobs_app                  : 100%\r\ncouch_jobs_fdb                  :  94%\r\ncouch_jobs_notifier             :  85%\r\ncouch_jobs_notifier_sup         : 100%\r\ncouch_jobs_pending              :  91%\r\ncouch_jobs_server               :  82%\r\ncouch_jobs_sup                  : 100%\r\ncouch_jobs_type_monitor         :  81%\r\n\r\nTotal                           : 87%\r\n==> rel (eunit)\r\n==> couchdb (eunit)\r\n```\r\nRan 3 times and saw no errors. \r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/797767800/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/797768100","html_url":"https://github.com/apache/couchdb/pull/3419#issuecomment-797768100","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3419","id":797768100,"node_id":"MDEyOklzc3VlQ29tbWVudDc5Nzc2ODEwMA==","user":{"login":"tonysun83","id":6991573,"node_id":"MDQ6VXNlcjY5OTE1NzM=","avatar_url":"https://avatars.githubusercontent.com/u/6991573?v=4","gravatar_id":"","url":"https://api.github.com/users/tonysun83","html_url":"https://github.com/tonysun83","followers_url":"https://api.github.com/users/tonysun83/followers","following_url":"https://api.github.com/users/tonysun83/following{/other_user}","gists_url":"https://api.github.com/users/tonysun83/gists{/gist_id}","starred_url":"https://api.github.com/users/tonysun83/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tonysun83/subscriptions","organizations_url":"https://api.github.com/users/tonysun83/orgs","repos_url":"https://api.github.com/users/tonysun83/repos","events_url":"https://api.github.com/users/tonysun83/events{/privacy}","received_events_url":"https://api.github.com/users/tonysun83/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-12T21:33:39Z","updated_at":"2021-03-12T21:33:39Z","author_association":"CONTRIBUTOR","body":"+1 after Jenkins finishes","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/797768100/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/797776378","html_url":"https://github.com/apache/couchdb/pull/3419#issuecomment-797776378","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3419","id":797776378,"node_id":"MDEyOklzc3VlQ29tbWVudDc5Nzc3NjM3OA==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-12T21:51:31Z","updated_at":"2021-03-12T21:51:31Z","author_association":"CONTRIBUTOR","body":"Jenkins looks green, merging","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/797776378/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/797834093","html_url":"https://github.com/apache/couchdb/pull/3418#issuecomment-797834093","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3418","id":797834093,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NzgzNDA5Mw==","user":{"login":"tonysun83","id":6991573,"node_id":"MDQ6VXNlcjY5OTE1NzM=","avatar_url":"https://avatars.githubusercontent.com/u/6991573?v=4","gravatar_id":"","url":"https://api.github.com/users/tonysun83","html_url":"https://github.com/tonysun83","followers_url":"https://api.github.com/users/tonysun83/followers","following_url":"https://api.github.com/users/tonysun83/following{/other_user}","gists_url":"https://api.github.com/users/tonysun83/gists{/gist_id}","starred_url":"https://api.github.com/users/tonysun83/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tonysun83/subscriptions","organizations_url":"https://api.github.com/users/tonysun83/orgs","repos_url":"https://api.github.com/users/tonysun83/repos","events_url":"https://api.github.com/users/tonysun83/events{/privacy}","received_events_url":"https://api.github.com/users/tonysun83/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-13T00:45:45Z","updated_at":"2021-03-13T00:45:45Z","author_association":"CONTRIBUTOR","body":"+1","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/797834093/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/798669543","html_url":"https://github.com/apache/couchdb/issues/3115#issuecomment-798669543","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3115","id":798669543,"node_id":"MDEyOklzc3VlQ29tbWVudDc5ODY2OTU0Mw==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-13T17:30:02Z","updated_at":"2021-03-14T13:03:08Z","author_association":"MEMBER","body":"I’ve started digging through these.\r\n\r\n- [x] fixing `-Ilerl_interface` is relatively easy, we are not using it anywhere, so we can just hotwire our local rebar copy:\r\n\r\nhttps://github.com/apache/couchdb-rebar/pull/2\r\n\r\n```diff\r\ndiff --git a/src/rebar_port_compiler.erl b/src/rebar_port_compiler.erl\r\nindex 9679c80..44f7b0d 100644\r\n--- a/src/rebar_port_compiler.erl\r\n+++ b/src/rebar_port_compiler.erl\r\n@@ -673,7 +673,7 @@ default_env() ->\r\n                        \"\\\" \"\r\n                       ])},\r\n      {\"ERL_EI_LIBDIR\", lists:concat([\"\\\"\", erl_interface_dir(lib), \"\\\"\"])},\r\n-     {\"ERL_LDFLAGS\"  , \" -L$ERL_EI_LIBDIR -lerl_interface -lei\"},\r\n+     {\"ERL_LDFLAGS\"  , \" -L$ERL_EI_LIBDIR -lei\"},\r\n      {\"ERLANG_ARCH\"  , rebar_utils:wordsize()},\r\n      {\"ERLANG_TARGET\", rebar_utils:get_arch()},\r\n ```\r\n- [x] `get_stacktrace()` is not getting removed until 24, so we have one more release to go, but the diff is totally bearable IMHO: https://github.com/apache/couchdb/pull/new/feat/3.x/otp23\r\n  - [x] this needs some more work to support <23 properly, made a logic bubu that I can fix up tomorrow.\r\n\r\n- [x] snappy needs to allow 23 https://github.com/apache/couchdb-snappy/pull/12\r\n\r\n```diff\r\ndiff --git a/rebar.config b/rebar.config\r\nindex 1785295..250cd2a 100644\r\n--- a/rebar.config\r\n+++ b/rebar.config\r\n@@ -1,4 +1,4 @@\r\n-{require_otp_vsn, \"R14|R15|R16|17|18|19|20|21|22\"}.\r\n+{require_otp_vsn, \"R14|R15|R16|17|18|19|20|21|22|23\"}.\r\n \r\n {erl_opts, [debug_info, warn_unused_vars, warn_shadow_vars, warn_unused_import]}.\r\n {port_sources, [\"c_src/*.cc\", \r\n```\r\n- [x] jiffy needs… ~I don’t know ;D @davisp help:~ h/t @rnewson jiffy `main` already supports 23,\r\n\r\n—\r\n\r\nThat’s as far as I got this time around.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/798669543/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/798771152","html_url":"https://github.com/apache/couchdb/pull/3421#issuecomment-798771152","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3421","id":798771152,"node_id":"MDEyOklzc3VlQ29tbWVudDc5ODc3MTE1Mg==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-13T19:20:47Z","updated_at":"2021-03-13T19:20:47Z","author_association":"MEMBER","body":"Thank you @hotsphink and @evilpie for the extremely thorough review! 🙏🙇‍♂️💕 I appreciate you taking the time to go through all this!\r\n\r\nThe main bulk of this code is pasted from `../68.` which we have working fine in production (not saying it can’t be improved :)\r\n\r\nWe’ll need a few more eyes on this to see how we can integrate those improvements as my C++ chop pretty much end at making function calls align as in the OP diff (which are the changes I really did, aside from the build system additions).\r\n\r\nI hope @jiangphcn @davisp @wohali can have a look.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/798771152/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/798773435","html_url":"https://github.com/apache/couchdb/issues/3115#issuecomment-798773435","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3115","id":798773435,"node_id":"MDEyOklzc3VlQ29tbWVudDc5ODc3MzQzNQ==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-13T19:37:01Z","updated_at":"2021-03-13T19:37:01Z","author_association":"MEMBER","body":"I gave this a spin and with the changes outlined here on 3.x, I got `make check` to pass on Erlang 23.\r\n\r\n@iilyak Do you have more pointers on the logging behaviour. I found this reference in the Erlang 22 release notes:\r\n\r\n> gen_* behaviours: If logging of the last N messages through sys:log/2,3 is active for the server, this log is included in the terminate report.\r\n\r\n— https://www.erlang.org/news/132\r\n\r\nBut I’m not sure if that’s what you mean.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/798773435/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/798780181","html_url":"https://github.com/apache/couchdb/issues/3420#issuecomment-798780181","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3420","id":798780181,"node_id":"MDEyOklzc3VlQ29tbWVudDc5ODc4MDE4MQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-13T20:24:43Z","updated_at":"2021-03-13T20:24:43Z","author_association":"MEMBER","body":"If you repeat the action does it still occur? As you say, I can't reproduce this problem here.\r\n\r\nWe are planning to move to a new repository hosting service in the next couple of weeks, which will probably resolve this issue.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/798780181/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/798792397","html_url":"https://github.com/apache/couchdb/issues/3420#issuecomment-798792397","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3420","id":798792397,"node_id":"MDEyOklzc3VlQ29tbWVudDc5ODc5MjM5Nw==","user":{"login":"MatthijsBurgh","id":18014833,"node_id":"MDQ6VXNlcjE4MDE0ODMz","avatar_url":"https://avatars.githubusercontent.com/u/18014833?v=4","gravatar_id":"","url":"https://api.github.com/users/MatthijsBurgh","html_url":"https://github.com/MatthijsBurgh","followers_url":"https://api.github.com/users/MatthijsBurgh/followers","following_url":"https://api.github.com/users/MatthijsBurgh/following{/other_user}","gists_url":"https://api.github.com/users/MatthijsBurgh/gists{/gist_id}","starred_url":"https://api.github.com/users/MatthijsBurgh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MatthijsBurgh/subscriptions","organizations_url":"https://api.github.com/users/MatthijsBurgh/orgs","repos_url":"https://api.github.com/users/MatthijsBurgh/repos","events_url":"https://api.github.com/users/MatthijsBurgh/events{/privacy}","received_events_url":"https://api.github.com/users/MatthijsBurgh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-13T22:01:34Z","updated_at":"2021-03-13T22:01:34Z","author_association":"NONE","body":"Yes, it keeps occurring when rerunning the action.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/798792397/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/798903420","html_url":"https://github.com/apache/couchdb/issues/3115#issuecomment-798903420","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3115","id":798903420,"node_id":"MDEyOklzc3VlQ29tbWVudDc5ODkwMzQyMA==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-14T13:04:20Z","updated_at":"2021-03-14T13:04:20Z","author_association":"MEMBER","body":"Erlang 20 is now fixed: https://github.com/apache/couchdb/pull/3422/commits/70334b3f9e85dd558c2a64ca222ceebe8f33a9c3#diff-a07a3d3b357a34c4acb80b2e178e9a19e6c2ed9d91cb0aa8d53cadabb1ae8bd0R95\r\n\r\nThis is mainly a draft to show how it can be done. I’m happy to see a bike shed about making this cleaner.\r\n\r\nI’m a bit confused tho, this broke builds tagged with 21 and 22, but I didn’t dig too deep in it. Are we sure our per-version builds are actually using the versions they say they do?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/798903420/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/798932797","html_url":"https://github.com/apache/couchdb/issues/3356#issuecomment-798932797","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3356","id":798932797,"node_id":"MDEyOklzc3VlQ29tbWVudDc5ODkzMjc5Nw==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-14T16:05:33Z","updated_at":"2021-03-14T16:05:33Z","author_association":"MEMBER","body":"for a AP vs CP system, this is not a bug.\r\n\r\nYou could wait with shorter timeouts until you get a non-403 response. It’s not pretty, but the only option until 4.x comes out.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/798932797/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/798932860","html_url":"https://github.com/apache/couchdb/issues/3349#issuecomment-798932860","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3349","id":798932860,"node_id":"MDEyOklzc3VlQ29tbWVudDc5ODkzMjg2MA==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-14T16:05:54Z","updated_at":"2021-03-14T16:05:54Z","author_association":"MEMBER","body":"Haha, this is on the native Mac builds I assume, I’ll take this one.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/798932860/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/798933170","html_url":"https://github.com/apache/couchdb/issues/3348#issuecomment-798933170","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3348","id":798933170,"node_id":"MDEyOklzc3VlQ29tbWVudDc5ODkzMzE3MA==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-14T16:07:45Z","updated_at":"2021-03-14T16:07:45Z","author_association":"MEMBER","body":"This is how compaction works. It copies all index and document data into two separate files and joins them into the new database/shard file at the end. So for the time of compaction, your disk usage is increasing. CouchDB has worked this way since before 1.0. This is not a bug.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/798933170/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/798934096","html_url":"https://github.com/apache/couchdb/issues/3083#issuecomment-798934096","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3083","id":798934096,"node_id":"MDEyOklzc3VlQ29tbWVudDc5ODkzNDA5Ng==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-14T16:13:23Z","updated_at":"2021-04-13T08:56:26Z","author_association":"MEMBER","body":"please reopen if there is something CouchDB can do to run better in the docker env","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/798934096/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/798934926","html_url":"https://github.com/apache/couchdb/issues/2951#issuecomment-798934926","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2951","id":798934926,"node_id":"MDEyOklzc3VlQ29tbWVudDc5ODkzNDkyNg==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-14T16:18:26Z","updated_at":"2021-03-14T16:18:26Z","author_association":"MEMBER","body":"@Terreii sgtm, looking forward to your PR :)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/798934926/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/798941143","html_url":"https://github.com/apache/couchdb/pull/3424#issuecomment-798941143","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3424","id":798941143,"node_id":"MDEyOklzc3VlQ29tbWVudDc5ODk0MTE0Mw==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-14T16:59:06Z","updated_at":"2021-07-11T07:26:17Z","author_association":"MEMBER","body":"~Currently built on SM86 and Erlang23 fixes, but can be merged after.~\r\n\r\nrebased to only include the actual fix","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/798941143/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/798941283","html_url":"https://github.com/apache/couchdb/issues/3362#issuecomment-798941283","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3362","id":798941283,"node_id":"MDEyOklzc3VlQ29tbWVudDc5ODk0MTI4Mw==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-14T17:00:04Z","updated_at":"2021-03-14T17:00:04Z","author_association":"MEMBER","body":"@marten-de-vries thanks for this. The docs state that `latest` should return the `winning` revision despite what `rev` might be provided, so I’ve reinstated that behaviour. I do not agree you should receive two revisions, as that’s not what the documentation says.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/798941283/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/798957904","html_url":"https://github.com/apache/couchdb/issues/3115#issuecomment-798957904","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3115","id":798957904,"node_id":"MDEyOklzc3VlQ29tbWVudDc5ODk1NzkwNA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-14T18:43:45Z","updated_at":"2021-03-14T18:43:45Z","author_association":"MEMBER","body":"I don't see it, our PRs currently build against 20.3.8.11, 20.3.8.25 and 22.2.3. We don't build against any 21 in Jenkins and we don't have 23 in Jenkins yet.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/798957904/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/798959890","html_url":"https://github.com/apache/couchdb/pull/3363#issuecomment-798959890","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3363","id":798959890,"node_id":"MDEyOklzc3VlQ29tbWVudDc5ODk1OTg5MA==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-14T18:56:52Z","updated_at":"2021-03-14T18:56:52Z","author_association":"MEMBER","body":"the ci errors here were intermitted, how do we re-run the cloudbees/error check?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/798959890/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/798970517","html_url":"https://github.com/apache/couchdb/pull/3363#issuecomment-798970517","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3363","id":798970517,"node_id":"MDEyOklzc3VlQ29tbWVudDc5ODk3MDUxNw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-14T20:04:04Z","updated_at":"2021-03-14T20:04:04Z","author_association":"MEMBER","body":"@janl log into jenkins @ ci-couchdb.apache.org with your Apache creds and press the restart icon (looks like a circular arrow) for the job on the branch","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/798970517/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/798971369","html_url":"https://github.com/apache/couchdb/pull/3363#issuecomment-798971369","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3363","id":798971369,"node_id":"MDEyOklzc3VlQ29tbWVudDc5ODk3MTM2OQ==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-14T20:09:41Z","updated_at":"2021-03-14T20:09:41Z","author_association":"CONTRIBUTOR","body":"We should still address https://github.com/apache/couchdb/pull/3363#issuecomment-776124292 I think. \r\n\r\nDo we have an example of this clause triggering on `main`?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/798971369/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/799201260","html_url":"https://github.com/apache/couchdb/issues/3356#issuecomment-799201260","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3356","id":799201260,"node_id":"MDEyOklzc3VlQ29tbWVudDc5OTIwMTI2MA==","user":{"login":"adrienverge","id":5244945,"node_id":"MDQ6VXNlcjUyNDQ5NDU=","avatar_url":"https://avatars.githubusercontent.com/u/5244945?v=4","gravatar_id":"","url":"https://api.github.com/users/adrienverge","html_url":"https://github.com/adrienverge","followers_url":"https://api.github.com/users/adrienverge/followers","following_url":"https://api.github.com/users/adrienverge/following{/other_user}","gists_url":"https://api.github.com/users/adrienverge/gists{/gist_id}","starred_url":"https://api.github.com/users/adrienverge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adrienverge/subscriptions","organizations_url":"https://api.github.com/users/adrienverge/orgs","repos_url":"https://api.github.com/users/adrienverge/repos","events_url":"https://api.github.com/users/adrienverge/events{/privacy}","received_events_url":"https://api.github.com/users/adrienverge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-15T07:57:52Z","updated_at":"2021-03-15T07:57:52Z","author_association":"CONTRIBUTOR","body":"@janl this message is a bit obscure, could you please enlighten us with more details than \"this is not a bug\"?\r\n- If you're talking about consistency/availability (which I'm not sure of, given your very short message), these terms usually relate to multi-node clusters. Here we're talking about inconsistent results in a **one-node** CouchDB, is that right?\r\n- \"the only option until 4.x comes out\": what do you mean? Will this bug be solved in the 4.x release? Is there some code/pointer that relates to this?\r\n\r\nThe reason I opened this issue is because this behavior (inconsistent reads/writes on 1 node) wasn't described anywhere.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/799201260/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/799295425","html_url":"https://github.com/apache/couchdb/issues/3362#issuecomment-799295425","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3362","id":799295425,"node_id":"MDEyOklzc3VlQ29tbWVudDc5OTI5NTQyNQ==","user":{"login":"marten-de-vries","id":1750170,"node_id":"MDQ6VXNlcjE3NTAxNzA=","avatar_url":"https://avatars.githubusercontent.com/u/1750170?v=4","gravatar_id":"","url":"https://api.github.com/users/marten-de-vries","html_url":"https://github.com/marten-de-vries","followers_url":"https://api.github.com/users/marten-de-vries/followers","following_url":"https://api.github.com/users/marten-de-vries/following{/other_user}","gists_url":"https://api.github.com/users/marten-de-vries/gists{/gist_id}","starred_url":"https://api.github.com/users/marten-de-vries/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marten-de-vries/subscriptions","organizations_url":"https://api.github.com/users/marten-de-vries/orgs","repos_url":"https://api.github.com/users/marten-de-vries/repos","events_url":"https://api.github.com/users/marten-de-vries/events{/privacy}","received_events_url":"https://api.github.com/users/marten-de-vries/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-15T10:11:49Z","updated_at":"2021-03-15T10:11:49Z","author_association":"NONE","body":"@janl Good point. As long as ``open_revs`` is still respected (based on my reading of your PR it is), that works too. Thanks!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/799295425/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/799343593","html_url":"https://github.com/apache/couchdb/pull/3422#issuecomment-799343593","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3422","id":799343593,"node_id":"MDEyOklzc3VlQ29tbWVudDc5OTM0MzU5Mw==","user":{"login":"iilyak","id":9804420,"node_id":"MDQ6VXNlcjk4MDQ0MjA=","avatar_url":"https://avatars.githubusercontent.com/u/9804420?v=4","gravatar_id":"","url":"https://api.github.com/users/iilyak","html_url":"https://github.com/iilyak","followers_url":"https://api.github.com/users/iilyak/followers","following_url":"https://api.github.com/users/iilyak/following{/other_user}","gists_url":"https://api.github.com/users/iilyak/gists{/gist_id}","starred_url":"https://api.github.com/users/iilyak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/iilyak/subscriptions","organizations_url":"https://api.github.com/users/iilyak/orgs","repos_url":"https://api.github.com/users/iilyak/repos","events_url":"https://api.github.com/users/iilyak/events{/privacy}","received_events_url":"https://api.github.com/users/iilyak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-15T11:26:42Z","updated_at":"2021-03-15T11:26:42Z","author_association":"CONTRIBUTOR","body":"Please test how couch_log application work. I tried couch_log on OTP 22 and it was not working correctly for the following test. \r\n1. Define new clause in any of the named gen_server. For example `couch_server`:\r\n  ```\r\n      handle_info(die, State) ->\r\n          ok = nok,\r\n          {noreply, State};          \r\n  ```\r\n2. Start CouchDB `dev/run --admin=adm:pass`\r\n3. Start remsh session `dev/remsh`\r\n4. Send die message `couch_server ! die`\r\n5. Check logs. You should see a log message about couch_server crashing (something matching the following pattern `\"gen_server ~w terminated with reason: ~s~n\"`).\r\n\r\nThis is due to significant changes in OTP logging subsystem.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/799343593/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/799359926","html_url":"https://github.com/apache/couchdb/pull/3425#issuecomment-799359926","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3425","id":799359926,"node_id":"MDEyOklzc3VlQ29tbWVudDc5OTM1OTkyNg==","user":{"login":"iilyak","id":9804420,"node_id":"MDQ6VXNlcjk4MDQ0MjA=","avatar_url":"https://avatars.githubusercontent.com/u/9804420?v=4","gravatar_id":"","url":"https://api.github.com/users/iilyak","html_url":"https://github.com/iilyak","followers_url":"https://api.github.com/users/iilyak/followers","following_url":"https://api.github.com/users/iilyak/following{/other_user}","gists_url":"https://api.github.com/users/iilyak/gists{/gist_id}","starred_url":"https://api.github.com/users/iilyak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/iilyak/subscriptions","organizations_url":"https://api.github.com/users/iilyak/orgs","repos_url":"https://api.github.com/users/iilyak/repos","events_url":"https://api.github.com/users/iilyak/events{/privacy}","received_events_url":"https://api.github.com/users/iilyak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-15T11:55:06Z","updated_at":"2021-03-15T11:55:06Z","author_association":"CONTRIBUTOR","body":"Currently `/_node/<whatever>/_system` returns dynamic information showing current load on the system. The spidermonkey version is a statically defined during compilation (in current implementation). One option is to add this information into welcome endpoint. However in this case it would be trickier to get the version for a given node. Not sure if it is a requirement for #3298.\r\n\r\nI don't have strong opinion on this.\r\n\r\n ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/799359926/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/799366151","html_url":"https://github.com/apache/couchdb/pull/3425#issuecomment-799366151","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3425","id":799366151,"node_id":"MDEyOklzc3VlQ29tbWVudDc5OTM2NjE1MQ==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-15T12:04:51Z","updated_at":"2021-03-15T12:04:51Z","author_association":"MEMBER","body":"we could also add it to the `/` response, I don’t have a strong opinion about where we report it, as long as we can get it. I don’t mind reporting static things in _system, but I can be convinced otherwise.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/799366151/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/799375476","html_url":"https://github.com/apache/couchdb/pull/3425#issuecomment-799375476","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3425","id":799375476,"node_id":"MDEyOklzc3VlQ29tbWVudDc5OTM3NTQ3Ng==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-15T12:20:40Z","updated_at":"2021-03-15T12:20:40Z","author_association":"MEMBER","body":"come to think of it, might be worth getting the OTP version out that way as well, whichever we choose","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/799375476/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/799528861","html_url":"https://github.com/apache/couchdb/pull/3363#issuecomment-799528861","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3363","id":799528861,"node_id":"MDEyOklzc3VlQ29tbWVudDc5OTUyODg2MQ==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-15T15:50:43Z","updated_at":"2021-03-15T15:50:43Z","author_association":"MEMBER","body":"@wohali thanks, I couldn’t for the life of me find the right page where the restart button shows, but it seems to be here\r\n\r\nhttps://ci-couchdb.apache.org/job/jenkins-cm1/job/PullRequests/job/PR-3363/16/","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/799528861/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/799531491","html_url":"https://github.com/apache/couchdb/issues/3115#issuecomment-799531491","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3115","id":799531491,"node_id":"MDEyOklzc3VlQ29tbWVudDc5OTUzMTQ5MQ==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-15T15:53:59Z","updated_at":"2021-03-15T15:53:59Z","author_association":"MEMBER","body":"@wohali agreed that the logs show that now, there was just some intermittent state there when they were failing. The UI there is also not very intuitive, so I may have turned myself around.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/799531491/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/799532486","html_url":"https://github.com/apache/couchdb/pull/3363#issuecomment-799532486","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3363","id":799532486,"node_id":"MDEyOklzc3VlQ29tbWVudDc5OTUzMjQ4Ng==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-15T15:55:23Z","updated_at":"2021-03-15T15:55:23Z","author_association":"MEMBER","body":"@janl always click on the \"Open Blue Ocean\" button after clicking on \"Details\" on any PR, or bookmark this page: https://ci-couchdb.apache.org/blue/organizations/jenkins/pipelines/\r\n\r\nWay better UX.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/799532486/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/799536264","html_url":"https://github.com/apache/couchdb/pull/3363#issuecomment-799536264","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3363","id":799536264,"node_id":"MDEyOklzc3VlQ29tbWVudDc5OTUzNjI2NA==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-15T16:00:03Z","updated_at":"2021-03-15T16:00:03Z","author_association":"MEMBER","body":"@wohali yeah, tried that too and didn’t see a restart button where I would normally expect it. I don’t think blue ocean solves my UX trouble ;)\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/799536264/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/799550136","html_url":"https://github.com/apache/couchdb/pull/3363#issuecomment-799550136","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3363","id":799550136,"node_id":"MDEyOklzc3VlQ29tbWVudDc5OTU1MDEzNg==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-15T16:18:22Z","updated_at":"2021-03-15T16:18:29Z","author_association":"MEMBER","body":"edit for posterity: this is the page to bookmark: https://ci-couchdb.apache.org/blue/organizations/jenkins/jenkins-cm1%2FPullRequests/activity","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/799550136/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/799561276","html_url":"https://github.com/apache/couchdb/pull/3422#issuecomment-799561276","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3422","id":799561276,"node_id":"MDEyOklzc3VlQ29tbWVudDc5OTU2MTI3Ng==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-15T16:32:01Z","updated_at":"2021-03-15T16:32:01Z","author_association":"MEMBER","body":"@iilyak this is what I get in the log:\r\n\r\n```\r\n[error] 2021-03-15T16:30:38.242690Z node1@127.0.0.1 <0.278.0> -------- couch_server terminating with {{badmatch,nok},[{couch_server,handle_info,2,[{file,\"src/couch_server.erl\"},{line,690}]},{gen_server,try_dispatch,4,[{file,\"gen_server.erl\"},{line,689}]},{gen_server,handle_msg,6,[{file,\"gen_server.erl\"},{line,765}]},{proc_lib,init_p_do_apply,3,[{file,\"proc_lib.erl\"},{line,226}]}]}, state {server,\"/Users/jan/Work/asf/couchdb/dev/lib/node1/data\",[{\"couch\",couch_bt_engine}],62,0,\"Mon, 15 Mar 2021 16:18:04 GMT\",false,redacted,couch_dbs_1,couch_dbs_pid_to_name_1,couch_dbs_locks_1}\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/799561276/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/799745662","html_url":"https://github.com/apache/couchdb/pull/3422#issuecomment-799745662","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3422","id":799745662,"node_id":"MDEyOklzc3VlQ29tbWVudDc5OTc0NTY2Mg==","user":{"login":"iilyak","id":9804420,"node_id":"MDQ6VXNlcjk4MDQ0MjA=","avatar_url":"https://avatars.githubusercontent.com/u/9804420?v=4","gravatar_id":"","url":"https://api.github.com/users/iilyak","html_url":"https://github.com/iilyak","followers_url":"https://api.github.com/users/iilyak/followers","following_url":"https://api.github.com/users/iilyak/following{/other_user}","gists_url":"https://api.github.com/users/iilyak/gists{/gist_id}","starred_url":"https://api.github.com/users/iilyak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/iilyak/subscriptions","organizations_url":"https://api.github.com/users/iilyak/orgs","repos_url":"https://api.github.com/users/iilyak/repos","events_url":"https://api.github.com/users/iilyak/events{/privacy}","received_events_url":"https://api.github.com/users/iilyak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-15T20:55:23Z","updated_at":"2021-03-15T20:55:23Z","author_association":"CONTRIBUTOR","body":"I've got the following using 20.3.8.26\r\n\r\n```\r\n[error] 2021-03-15T20:47:39.317559Z node1@127.0.0.1 <0.250.0> -------- couch_server terminating with {{badmatch,nok},[{couch_server,handle_info,2,[{file,\"src/couch_server.erl\"},{line,719}]},{gen_server,try_dispatch,4,[{file,\"gen_server.erl\"},{line,616}]},{gen_server,handle_msg,6,[{file,\"gen_server.erl\"},{line,686}]},{proc_lib,init_p_do_apply,3,[{file,\"proc_lib.erl\"},{line,247}]}]}, state {server,\"/Users/iilyak@ca.ibm.com/dev/db.mono/src/couchdb/dev/lib/node1/data\",[{\"couch\",couch_bt_engine}],62,0,\"Mon, 15 Mar 2021 20:46:27 GMT\",false,redacted,couch_dbs_1,couch_dbs_pid_to_name_1,couch_dbs_locks_1}\r\n[error] 2021-03-15T20:47:39.318413Z node1@127.0.0.1 <0.250.0> -------- gen_server couch_server_1 terminated with reason: no match of right hand value nok at couch_server:handle_info/2(line:719) <= gen_server:try_dispatch/4(line:616) <= gen_server:handle_msg/6(line:686) <= proc_lib:init_p_do_apply/3(line:247)\r\n  last msg: die\r\n     state: {server,\"/Users/iilyak@ca.ibm.com/dev/db.mono/src/couchdb/dev/lib/node1/data\",[{\"couch\",couch_bt_engine}],62,0,\"Mon, 15 Mar 2021 20:46:27 GMT\",false,{0,#Ref<0.2205975427.3573678086.33533>,#Ref<0.2205975427.3573678086.33534>},couch_dbs_1,couch_dbs_pid_to_name_1,couch_dbs_locks_1}\r\n    extra: []\r\n[error] 2021-03-15T20:47:39.323063Z node1@127.0.0.1 <0.250.0> -------- CRASH REPORT Process couch_server_1 (<0.250.0>) with 0 neighbors crashed with reason: no match of right hand value nok at couch_server:handle_info/2(line:719) <= gen_server:try_dispatch/4(line:616) <= gen_server:handle_msg/6(line:686) <= proc_lib:init_p_do_apply/3(line:247); initial_call: {couch_server,init,['Argument__1']}, ancestors: [couch_primary_services,couch_sup,<0.244.0>], message_queue_len: 0, messages: [], links: [<0.247.0>], dictionary: [], trap_exit: true, status: running, heap_size: 4185, stack_size: 27, reductions: 6727\r\n```\r\n\r\nAs you can see some of the messages are missing in your output.\r\n\r\nAlso while trying this out I realized that my instructions are no longer correct after a merge of couch_server work. The `couch_server ! die` should be `couch_server_1 ! die` now.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/799745662/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/799748913","html_url":"https://github.com/apache/couchdb/pull/3425#issuecomment-799748913","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3425","id":799748913,"node_id":"MDEyOklzc3VlQ29tbWVudDc5OTc0ODkxMw==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-15T21:00:51Z","updated_at":"2021-03-15T21:00:51Z","author_association":"CONTRIBUTOR","body":"Good idea about reporting the JS version, it might give users an idea which JS language features they could target (if they could map the runtime to JS features).\r\n\r\nWe do already report the OTP version in the welcome point as a header:\r\n\r\n```\r\n $ http $DB\r\n                                                                                                                                                                                                  \r\nHTTP/1.1 200 OK\r\n...\r\nServer: CouchDB/3.0.0-d5fae35-dirty (Erlang OTP/20)\r\nX-Couch-Request-ID: e766be1148\r\nX-CouchDB-Body-Time: 0\r\n\r\n{\r\n    \"couchdb\": \"Welcome\",\r\n    \"features\": [\r\n        \"access-ready\",\r\n        \"fdb\"\r\n    ],\r\n    \"git_sha\": \"d5fae35\",\r\n    \"uuid\": \"fake_uuid_for_dev\",\r\n    \"vendor\": {\r\n        \"name\": \"The Apache Software Foundation\"\r\n    },\r\n    \"version\": \"3.0.0-d5fae35-dirty\"\r\n}\r\n\r\n```\r\n\r\nWould it be too obscure to append the JS version to the `Server` along with the OTP version?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/799748913/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/799758579","html_url":"https://github.com/apache/couchdb/pull/3422#issuecomment-799758579","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3422","id":799758579,"node_id":"MDEyOklzc3VlQ29tbWVudDc5OTc1ODU3OQ==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-15T21:17:42Z","updated_at":"2021-03-16T15:47:45Z","author_association":"CONTRIBUTOR","body":"The logging issue is probably there since 21 when OTP introduced a whole new logging infrastructure. I remember advising someone at Cloudant to use Erlang 20 for local development because they would not \"see\" some of the gen_server crash reports when they ran with 21.\r\n\r\nI am not sure how hard it would be to fix it, hoping it would be just a matter of configuring the additional compatibility mode:\r\n\r\n https://erlang.org/doc/man/sasl_app.html#deprecated-error-logger-event-handlers-and-configuration\r\n \r\n https://erlang.org/doc/apps/kernel/logger_chapter.html#compatibility\r\n \r\n https://erlang.org/doc/man/kernel_app.html#logger_level\r\n\r\nHowever since this issue has been there at least since 21, and we already shipped a few releases supporting that OTP version, it's probably not a hard blocker for 23?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/799758579/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/799759516","html_url":"https://github.com/apache/couchdb/pull/3422#issuecomment-799759516","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3422","id":799759516,"node_id":"MDEyOklzc3VlQ29tbWVudDc5OTc1OTUxNg==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-15T21:19:23Z","updated_at":"2021-03-15T21:19:23Z","author_association":"MEMBER","body":"Note that our binary packages still ship with 20.3.8.25.\r\n\r\nThis being broken would be a primary reason to continue to ship against that version until it's fixed (@rnewson was worried about this a while back, see dev@ for details.)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/799759516/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/799762814","html_url":"https://github.com/apache/couchdb/pull/3422#issuecomment-799762814","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3422","id":799762814,"node_id":"MDEyOklzc3VlQ29tbWVudDc5OTc2MjgxNA==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-15T21:25:18Z","updated_at":"2021-03-15T21:25:18Z","author_association":"CONTRIBUTOR","body":"@wohali good point, agree","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/799762814/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/800099229","html_url":"https://github.com/apache/couchdb/pull/3415#issuecomment-800099229","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3415","id":800099229,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMDA5OTIyOQ==","user":{"login":"bessbd","id":9086834,"node_id":"MDQ6VXNlcjkwODY4MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/9086834?v=4","gravatar_id":"","url":"https://api.github.com/users/bessbd","html_url":"https://github.com/bessbd","followers_url":"https://api.github.com/users/bessbd/followers","following_url":"https://api.github.com/users/bessbd/following{/other_user}","gists_url":"https://api.github.com/users/bessbd/gists{/gist_id}","starred_url":"https://api.github.com/users/bessbd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bessbd/subscriptions","organizations_url":"https://api.github.com/users/bessbd/orgs","repos_url":"https://api.github.com/users/bessbd/repos","events_url":"https://api.github.com/users/bessbd/events{/privacy}","received_events_url":"https://api.github.com/users/bessbd/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-16T09:28:55Z","updated_at":"2021-03-16T09:28:55Z","author_association":"MEMBER","body":"Thank you for the review and merge, @janl !","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/800099229/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/800150924","html_url":"https://github.com/apache/couchdb/pull/3425#issuecomment-800150924","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3425","id":800150924,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMDE1MDkyNA==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-16T10:43:49Z","updated_at":"2021-03-16T10:43:49Z","author_association":"MEMBER","body":"@nickva I remembered that we report that in the header but thought we might want to not add info to each request that never changes per server.\r\n\r\nThat kick-started a few more thoughts:\r\n\r\n1. some users treat build versions as security sensitive. This is of course folly, and I have to admit that it hasn’t come up in quite a while.\r\n2. What is the use of reporting these? The initial request is for diagnostic reasons, but there is another use case: client libraries adjusting behaviour based on what capabilities a server has.\r\n3. For diagnosis, one can easily argue that an admin-required endpoint is a natural choice (hence _system), but for the client-library use-case, we’d ideally want a public endpoint.\r\n4. I still think we shouldn’t add static info to each request, even if just 2-3 bytes.\r\n\r\nThen I though we should just re-use the existing capabilities mechanism in `/`, but that gets us to the problem that existing capabilities are a list of strings. But now we’d have tagged strings, something like `\"otp-20.3.8.25\"`, which folks then need to know how to parse. If we made them proper JSON, say `{\"otp\":\"20.3.8.25\"}`, then we might break capabilities parsers that expect strings.\r\n\r\nSo I think we should just add this to the server info JSON from `/`:\r\n\r\n```\r\n{\r\n  \"couchdb\": \"Welcome\",\r\n  \"version\": \"3.1.1\",\r\n  \"otp\":\"20.3.8.25\",\r\n  \"spidermonkey\": \"68\",\r\n  \"git_sha\": \"ce596c65d\",\r\n  \"uuid\": \"d077378b841f6b2c5d2f9c6ae753c769\",\r\n  \"features\": [\r\n    \"access-ready\",\r\n    \"partitioned\",\r\n    \"pluggable-storage-engines\",\r\n    \"reshard\",\r\n    \"scheduler\"\r\n  ],\r\n  \"vendor\": {\r\n    \"name\": \"The Apache Software Foundation\"\r\n  }\r\n}\r\n```\r\n\r\n(the SpiderMonkey version should be a string, so we can express `\"1.8.5\"`, and not have to switch this field between numbers and strings, and it makes us future-proof against version scheme changes)\r\n\r\nThat way:\r\n\r\n1. client libraries can get the server config once and behave accordingly, \r\n2. we don’t add any overhead to responses (we could even deprecate the existing OTP section of the `Server` header, but one thing at a time ;)\r\n3. diagnostics can get at the data easily as well","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/800150924/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/800179495","html_url":"https://github.com/apache/couchdb/pull/3422#issuecomment-800179495","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3422","id":800179495,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMDE3OTQ5NQ==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-16T11:29:00Z","updated_at":"2021-03-16T11:29:00Z","author_association":"MEMBER","body":"I tried setting `logger_sasl_compatible` to `true` in our `sys.config`, but that either doesn't work (pointers welcome), or doesn’t do what we want. The error log is the same, missing the extra output.\r\n\r\nSo we are missing last message and gen_server stat info? I agree that it is less convenient than before, but I wouldn’t call this “broken”.\r\n\r\nEspecially if we keep our binary packages on 20 for the time being.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/800179495/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/800232926","html_url":"https://github.com/apache/couchdb/pull/3428#issuecomment-800232926","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3428","id":800232926,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMDIzMjkyNg==","user":{"login":"KangTheTerrible","id":7072176,"node_id":"MDQ6VXNlcjcwNzIxNzY=","avatar_url":"https://avatars.githubusercontent.com/u/7072176?v=4","gravatar_id":"","url":"https://api.github.com/users/KangTheTerrible","html_url":"https://github.com/KangTheTerrible","followers_url":"https://api.github.com/users/KangTheTerrible/followers","following_url":"https://api.github.com/users/KangTheTerrible/following{/other_user}","gists_url":"https://api.github.com/users/KangTheTerrible/gists{/gist_id}","starred_url":"https://api.github.com/users/KangTheTerrible/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/KangTheTerrible/subscriptions","organizations_url":"https://api.github.com/users/KangTheTerrible/orgs","repos_url":"https://api.github.com/users/KangTheTerrible/repos","events_url":"https://api.github.com/users/KangTheTerrible/events{/privacy}","received_events_url":"https://api.github.com/users/KangTheTerrible/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-16T12:53:30Z","updated_at":"2021-03-16T12:53:30Z","author_association":"CONTRIBUTOR","body":"This duplicated block of code still exists in couch_sup.erl and I feel it should be removed.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/800232926/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/800255267","html_url":"https://github.com/apache/couchdb/pull/3429#issuecomment-800255267","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3429","id":800255267,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMDI1NTI2Nw==","user":{"login":"bessbd","id":9086834,"node_id":"MDQ6VXNlcjkwODY4MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/9086834?v=4","gravatar_id":"","url":"https://api.github.com/users/bessbd","html_url":"https://github.com/bessbd","followers_url":"https://api.github.com/users/bessbd/followers","following_url":"https://api.github.com/users/bessbd/following{/other_user}","gists_url":"https://api.github.com/users/bessbd/gists{/gist_id}","starred_url":"https://api.github.com/users/bessbd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bessbd/subscriptions","organizations_url":"https://api.github.com/users/bessbd/orgs","repos_url":"https://api.github.com/users/bessbd/repos","events_url":"https://api.github.com/users/bessbd/events{/privacy}","received_events_url":"https://api.github.com/users/bessbd/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-16T13:25:07Z","updated_at":"2021-03-16T13:25:07Z","author_association":"MEMBER","body":"Thank you for the review, @garrensmith ! I'm about to merge this.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/800255267/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/800255872","html_url":"https://github.com/apache/couchdb/pull/3422#issuecomment-800255872","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3422","id":800255872,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMDI1NTg3Mg==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-16T13:25:56Z","updated_at":"2021-03-16T13:25:56Z","author_association":"MEMBER","body":"same with adding this to `vm.args` h/t rnewson","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/800255872/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/800266600","html_url":"https://github.com/apache/couchdb/issues/3394#issuecomment-800266600","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3394","id":800266600,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMDI2NjYwMA==","user":{"login":"bessbd","id":9086834,"node_id":"MDQ6VXNlcjkwODY4MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/9086834?v=4","gravatar_id":"","url":"https://api.github.com/users/bessbd","html_url":"https://github.com/bessbd","followers_url":"https://api.github.com/users/bessbd/followers","following_url":"https://api.github.com/users/bessbd/following{/other_user}","gists_url":"https://api.github.com/users/bessbd/gists{/gist_id}","starred_url":"https://api.github.com/users/bessbd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bessbd/subscriptions","organizations_url":"https://api.github.com/users/bessbd/orgs","repos_url":"https://api.github.com/users/bessbd/repos","events_url":"https://api.github.com/users/bessbd/events{/privacy}","received_events_url":"https://api.github.com/users/bessbd/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-16T13:39:59Z","updated_at":"2021-03-16T13:39:59Z","author_association":"MEMBER","body":"Also related: https://github.com/apache/couchdb/pull/3429","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/800266600/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/800358123","html_url":"https://github.com/apache/couchdb/pull/3430#issuecomment-800358123","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3430","id":800358123,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMDM1ODEyMw==","user":{"login":"bessbd","id":9086834,"node_id":"MDQ6VXNlcjkwODY4MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/9086834?v=4","gravatar_id":"","url":"https://api.github.com/users/bessbd","html_url":"https://github.com/bessbd","followers_url":"https://api.github.com/users/bessbd/followers","following_url":"https://api.github.com/users/bessbd/following{/other_user}","gists_url":"https://api.github.com/users/bessbd/gists{/gist_id}","starred_url":"https://api.github.com/users/bessbd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bessbd/subscriptions","organizations_url":"https://api.github.com/users/bessbd/orgs","repos_url":"https://api.github.com/users/bessbd/repos","events_url":"https://api.github.com/users/bessbd/events{/privacy}","received_events_url":"https://api.github.com/users/bessbd/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-16T15:22:38Z","updated_at":"2021-03-16T15:22:38Z","author_association":"MEMBER","body":"Thank you for the review, @nickva ! I'm about to merge this.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/800358123/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/800426693","html_url":"https://github.com/apache/couchdb/pull/3380#issuecomment-800426693","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3380","id":800426693,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMDQyNjY5Mw==","user":{"login":"iilyak","id":9804420,"node_id":"MDQ6VXNlcjk4MDQ0MjA=","avatar_url":"https://avatars.githubusercontent.com/u/9804420?v=4","gravatar_id":"","url":"https://api.github.com/users/iilyak","html_url":"https://github.com/iilyak","followers_url":"https://api.github.com/users/iilyak/followers","following_url":"https://api.github.com/users/iilyak/following{/other_user}","gists_url":"https://api.github.com/users/iilyak/gists{/gist_id}","starred_url":"https://api.github.com/users/iilyak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/iilyak/subscriptions","organizations_url":"https://api.github.com/users/iilyak/orgs","repos_url":"https://api.github.com/users/iilyak/repos","events_url":"https://api.github.com/users/iilyak/events{/privacy}","received_events_url":"https://api.github.com/users/iilyak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-16T16:43:38Z","updated_at":"2021-03-16T16:43:38Z","author_association":"CONTRIBUTOR","body":"I rolled back the controversial changes and included only the changes needed to prevent leaking of passwords. I think we can have separate PR if we would want to prevent leaking of users' data or minimize state terms.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/800426693/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/800463944","html_url":"https://github.com/apache/couchdb/pull/3422#issuecomment-800463944","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3422","id":800463944,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMDQ2Mzk0NA==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-16T17:31:05Z","updated_at":"2021-03-16T17:31:05Z","author_association":"MEMBER","body":"So what’s the verdict here, are we going with 23-support-is-good-enough-for now, or are we looking for more changes?\r\n\r\nI’m happy to file the logging issue as a separate ticket\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/800463944/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/800482501","html_url":"https://github.com/apache/couchdb/pull/3425#issuecomment-800482501","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3425","id":800482501,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMDQ4MjUwMQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-16T17:56:29Z","updated_at":"2021-03-16T17:56:29Z","author_association":"MEMBER","body":"We added the `git_sha` without breaking anyone, so I see no reason not to also add other keys like `spidermonkey`.\r\n\r\nI might use `otp_version` or `otp_ver` but that's really bikeshedding.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/800482501/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/800483674","html_url":"https://github.com/apache/couchdb/pull/3425#issuecomment-800483674","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3425","id":800483674,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMDQ4MzY3NA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-16T17:57:46Z","updated_at":"2021-03-16T17:57:46Z","author_association":"MEMBER","body":"Also +1 to not using the capability strings, that's meant to advertise features this particular CouchDB is compatible with. I can see why that might be used for JS stuff (ECMAScript compatibility level, e.g.) but that's a translation from the JS version, not the actual SM JS version itself...and wouldn't make sense at all for the Erlang/OTP version.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/800483674/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/800563054","html_url":"https://github.com/apache/couchdb/pull/3422#issuecomment-800563054","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3422","id":800563054,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMDU2MzA1NA==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-16T20:00:15Z","updated_at":"2021-03-16T20:00:15Z","author_association":"CONTRIBUTOR","body":"@janl agree, let's have a separate issue for logging, I don't think this should be a blocker for 23 support as it wasn't a blocker for 21 and 22.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/800563054/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/800567938","html_url":"https://github.com/apache/couchdb/pull/3425#issuecomment-800567938","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3425","id":800567938,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMDU2NzkzOA==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-16T20:08:22Z","updated_at":"2021-03-16T20:08:22Z","author_association":"CONTRIBUTOR","body":"@janl good point on not adding extra static info to all the headers, I hadn't thought of that\r\n\r\nFor javascript we might want to add an info object in case we switch away from spidermonkey to say v8 or other engine.`\"javascript_engine\": {\"name\": \"spidermonkey\", \"version\": \"68\"}`, for `V8` would it be `{\"name\":\"v8\", \"version\": \"1.0.0\"}` or something. Maybe `\"javascript\": {...}` or `\"js_engine\"` I am not very good at names :-)\r\n\r\n@wohali good idea, if we know the ECMAScript version we could add it to the `{..., \"ecmascript_version\": ...}` to the info object too perahps.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/800567938/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/800594628","html_url":"https://github.com/apache/couchdb/pull/3422#issuecomment-800594628","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3422","id":800594628,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMDU5NDYyOA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-16T20:49:22Z","updated_at":"2021-03-16T20:49:22Z","author_association":"MEMBER","body":"+1, with the proviso I don't intend to move the binaries/Docker off of 20.3.8.* until logging is fixed.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/800594628/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/800850782","html_url":"https://github.com/apache/couchdb/pull/3422#issuecomment-800850782","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3422","id":800850782,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMDg1MDc4Mg==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-17T07:07:31Z","updated_at":"2021-03-17T07:07:31Z","author_association":"CONTRIBUTOR","body":"While we're talking about it, this should fix the error_logger in OTP >= 21 https://github.com/apache/couchdb/pull/3433","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/800850782/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/801044857","html_url":"https://github.com/apache/couchdb/issues/3394#issuecomment-801044857","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3394","id":801044857,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMTA0NDg1Nw==","user":{"login":"bessbd","id":9086834,"node_id":"MDQ6VXNlcjkwODY4MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/9086834?v=4","gravatar_id":"","url":"https://api.github.com/users/bessbd","html_url":"https://github.com/bessbd","followers_url":"https://api.github.com/users/bessbd/followers","following_url":"https://api.github.com/users/bessbd/following{/other_user}","gists_url":"https://api.github.com/users/bessbd/gists{/gist_id}","starred_url":"https://api.github.com/users/bessbd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bessbd/subscriptions","organizations_url":"https://api.github.com/users/bessbd/orgs","repos_url":"https://api.github.com/users/bessbd/repos","events_url":"https://api.github.com/users/bessbd/events{/privacy}","received_events_url":"https://api.github.com/users/bessbd/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-17T12:32:07Z","updated_at":"2021-03-17T12:32:07Z","author_association":"MEMBER","body":"Right now I'm working on the `17-multi-type-value-test.py` failures. They seem consistent on centos 6. I have an idea, I'll post here later.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/801044857/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/801078137","html_url":"https://github.com/apache/couchdb/pull/3428#issuecomment-801078137","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3428","id":801078137,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMTA3ODEzNw==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-17T13:26:01Z","updated_at":"2021-03-17T13:26:01Z","author_association":"MEMBER","body":"> This duplicated block of code still exists in couch_sup.erl and I feel it should be removed.\r\n\r\n+1\r\n\r\nthe rest looks good, well done :)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/801078137/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/802030788","html_url":"https://github.com/apache/couchdb/pull/3439#issuecomment-802030788","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3439","id":802030788,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMjAzMDc4OA==","user":{"login":"bessbd","id":9086834,"node_id":"MDQ6VXNlcjkwODY4MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/9086834?v=4","gravatar_id":"","url":"https://api.github.com/users/bessbd","html_url":"https://github.com/bessbd","followers_url":"https://api.github.com/users/bessbd/followers","following_url":"https://api.github.com/users/bessbd/following{/other_user}","gists_url":"https://api.github.com/users/bessbd/gists{/gist_id}","starred_url":"https://api.github.com/users/bessbd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bessbd/subscriptions","organizations_url":"https://api.github.com/users/bessbd/orgs","repos_url":"https://api.github.com/users/bessbd/repos","events_url":"https://api.github.com/users/bessbd/events{/privacy}","received_events_url":"https://api.github.com/users/bessbd/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-18T15:41:03Z","updated_at":"2021-03-18T15:41:03Z","author_association":"MEMBER","body":"> +1 from me but would like @wohali or @janl to comment also before we merge.\r\n\r\nI'll wait for @wohali or @janl 's +1 then before merging.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/802030788/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/802189764","html_url":"https://github.com/apache/couchdb/issues/3394#issuecomment-802189764","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3394","id":802189764,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMjE4OTc2NA==","user":{"login":"bessbd","id":9086834,"node_id":"MDQ6VXNlcjkwODY4MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/9086834?v=4","gravatar_id":"","url":"https://api.github.com/users/bessbd","html_url":"https://github.com/bessbd","followers_url":"https://api.github.com/users/bessbd/followers","following_url":"https://api.github.com/users/bessbd/following{/other_user}","gists_url":"https://api.github.com/users/bessbd/gists{/gist_id}","starred_url":"https://api.github.com/users/bessbd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bessbd/subscriptions","organizations_url":"https://api.github.com/users/bessbd/orgs","repos_url":"https://api.github.com/users/bessbd/repos","events_url":"https://api.github.com/users/bessbd/events{/privacy}","received_events_url":"https://api.github.com/users/bessbd/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-18T18:32:44Z","updated_at":"2021-03-18T18:32:44Z","author_association":"MEMBER","body":"Related PR: https://github.com/apache/couchdb/pull/3439","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/802189764/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/802210259","html_url":"https://github.com/apache/couchdb/pull/3439#issuecomment-802210259","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3439","id":802210259,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMjIxMDI1OQ==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-18T19:00:38Z","updated_at":"2021-03-18T19:00:38Z","author_association":"MEMBER","body":"I'm generally +1, but would also defer to @wohali for a final call :)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/802210259/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/802282757","html_url":"https://github.com/apache/couchdb/pull/3442#issuecomment-802282757","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3442","id":802282757,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMjI4Mjc1Nw==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-18T20:43:31Z","updated_at":"2021-03-18T20:43:31Z","author_association":"CONTRIBUTOR","body":"The second test can be checked if it triggers with the `multi_lookup` [bug](https://github.com/apache/couchdb/commit/ec4b2132918338d893a800a823cf5f12d5b2efd5):\r\n\r\n```\r\n $ git revert ec4b2132918338d893a800a823cf5f12d5b2efd5\r\n $ make elixir tests=test/elixir/test/concurrent_writes_test.exs\r\n\r\n  1) test Secondary data tests with deletes and queries (ConcurrentWritesTest)\r\n     test/elixir/test/concurrent_writes_test.exs:109\r\n     Assertion with == failed\r\n     code:  assert [] == Couch.get(\"/#{db_name}/#{ddoc_id}/_view/foo\").body()[\"rows\"]\r\n     left:  []\r\n     right: [%{\"key\" => :null, \"value\" => 643}]\r\n   \r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/802282757/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/802282936","html_url":"https://github.com/apache/couchdb/pull/3439#issuecomment-802282936","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3439","id":802282936,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMjI4MjkzNg==","user":{"login":"bessbd","id":9086834,"node_id":"MDQ6VXNlcjkwODY4MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/9086834?v=4","gravatar_id":"","url":"https://api.github.com/users/bessbd","html_url":"https://github.com/bessbd","followers_url":"https://api.github.com/users/bessbd/followers","following_url":"https://api.github.com/users/bessbd/following{/other_user}","gists_url":"https://api.github.com/users/bessbd/gists{/gist_id}","starred_url":"https://api.github.com/users/bessbd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bessbd/subscriptions","organizations_url":"https://api.github.com/users/bessbd/orgs","repos_url":"https://api.github.com/users/bessbd/repos","events_url":"https://api.github.com/users/bessbd/events{/privacy}","received_events_url":"https://api.github.com/users/bessbd/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-18T20:43:44Z","updated_at":"2021-03-18T20:43:44Z","author_association":"MEMBER","body":"Thank you for the review, @nickva , @rnewson , @janl and @wohali !\r\nI'll merge this tomorrow and add extra info on the motivation.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/802282936/reactions","total_count":2,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":1,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/802300378","html_url":"https://github.com/apache/couchdb/pull/3439#issuecomment-802300378","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3439","id":802300378,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMjMwMDM3OA==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-18T21:08:15Z","updated_at":"2021-03-18T21:08:15Z","author_association":"CONTRIBUTOR","body":"@bessbd nice work discovering the bug, it was a rather tricky one!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/802300378/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/802604610","html_url":"https://github.com/apache/couchdb/pull/2788#issuecomment-802604610","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2788","id":802604610,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMjYwNDYxMA==","user":{"login":"ronag","id":3065230,"node_id":"MDQ6VXNlcjMwNjUyMzA=","avatar_url":"https://avatars.githubusercontent.com/u/3065230?v=4","gravatar_id":"","url":"https://api.github.com/users/ronag","html_url":"https://github.com/ronag","followers_url":"https://api.github.com/users/ronag/followers","following_url":"https://api.github.com/users/ronag/following{/other_user}","gists_url":"https://api.github.com/users/ronag/gists{/gist_id}","starred_url":"https://api.github.com/users/ronag/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ronag/subscriptions","organizations_url":"https://api.github.com/users/ronag/orgs","repos_url":"https://api.github.com/users/ronag/repos","events_url":"https://api.github.com/users/ronag/events{/privacy}","received_events_url":"https://api.github.com/users/ronag/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-19T07:02:43Z","updated_at":"2021-03-19T07:02:43Z","author_association":"NONE","body":"Any plans to apply this to https://github.com/apache/couchdb-docker?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/802604610/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/802805857","html_url":"https://github.com/apache/couchdb/pull/3439#issuecomment-802805857","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3439","id":802805857,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMjgwNTg1Nw==","user":{"login":"bessbd","id":9086834,"node_id":"MDQ6VXNlcjkwODY4MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/9086834?v=4","gravatar_id":"","url":"https://api.github.com/users/bessbd","html_url":"https://github.com/bessbd","followers_url":"https://api.github.com/users/bessbd/followers","following_url":"https://api.github.com/users/bessbd/following{/other_user}","gists_url":"https://api.github.com/users/bessbd/gists{/gist_id}","starred_url":"https://api.github.com/users/bessbd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bessbd/subscriptions","organizations_url":"https://api.github.com/users/bessbd/orgs","repos_url":"https://api.github.com/users/bessbd/repos","events_url":"https://api.github.com/users/bessbd/events{/privacy}","received_events_url":"https://api.github.com/users/bessbd/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-19T12:40:56Z","updated_at":"2021-03-19T12:40:56Z","author_association":"MEMBER","body":"Motivation: as I was working on #3394 to get a green `main`, I was looking at the broken https://github.com/apache/couchdb/blob/main/src/mango/test/17-multi-type-value-test.py#L28 and I've noticed it's green everywhere but centos6.\r\nI fired up the centos6 image in docker and realized couchdb `main` always returns one row less there than in my native (osx) environment.\r\nAfter a long tracing and debugging session (with plenty of help from @nickva - thanks for that!), we've discovered that\r\n`couch_ejson_compare:less([{[{<<\"forename\">>,<<\"Eddie\">>}]}], [{[{<<\"ÿÿÿÿ\">>,<<>>}]}]).` always returns `1` on centos6 and `-1` elswehere.\r\nWhen I was trying to bump the libicu version, I've noticed the `yum` commands are failing so I looked up the supported centos versions and that's when I realized it's now discontinued - hence this PR.\r\n\r\n@wohali : please let me know if I missed any important details here.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/802805857/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/802984151","html_url":"https://github.com/apache/couchdb/pull/2788#issuecomment-802984151","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2788","id":802984151,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMjk4NDE1MQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-19T17:11:12Z","updated_at":"2021-03-19T17:11:12Z","author_association":"MEMBER","body":"It should be in the `3.1.1` image already. We're not backporting to 1.x/2.x.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/802984151/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/802988940","html_url":"https://github.com/apache/couchdb/pull/3416#issuecomment-802988940","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3416","id":802988940,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMjk4ODk0MA==","user":{"login":"chewbranca","id":5326,"node_id":"MDQ6VXNlcjUzMjY=","avatar_url":"https://avatars.githubusercontent.com/u/5326?v=4","gravatar_id":"","url":"https://api.github.com/users/chewbranca","html_url":"https://github.com/chewbranca","followers_url":"https://api.github.com/users/chewbranca/followers","following_url":"https://api.github.com/users/chewbranca/following{/other_user}","gists_url":"https://api.github.com/users/chewbranca/gists{/gist_id}","starred_url":"https://api.github.com/users/chewbranca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chewbranca/subscriptions","organizations_url":"https://api.github.com/users/chewbranca/orgs","repos_url":"https://api.github.com/users/chewbranca/repos","events_url":"https://api.github.com/users/chewbranca/events{/privacy}","received_events_url":"https://api.github.com/users/chewbranca/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-19T17:19:05Z","updated_at":"2021-03-19T17:19:05Z","author_association":"CONTRIBUTOR","body":"Does this need to be a stateful application? Rather than having a dedicated app hierarchy here, can we just add a `_prometheus` endpoint to https://github.com/apache/couchdb/blob/main/src/chttpd/src/chttpd_node.erl#L121-L124 \r\n\r\nthat then does the conversion over https://github.com/apache/couchdb/blob/main/src/chttpd/src/chttpd_node.erl#L206-L236\r\n\r\nWe could avoid having the server that does the caching and just do it on demand when the request comes in.\r\n\r\nI'm also not a huge fan of introducing an additional http server to the mix. Is supporting unauthenticated requests to the Prometheus endpoint a necessary feature?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/802988940/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/803536567","html_url":"https://github.com/apache/couchdb/issues/3047#issuecomment-803536567","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3047","id":803536567,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMzUzNjU2Nw==","user":{"login":"molecular","id":589745,"node_id":"MDQ6VXNlcjU4OTc0NQ==","avatar_url":"https://avatars.githubusercontent.com/u/589745?v=4","gravatar_id":"","url":"https://api.github.com/users/molecular","html_url":"https://github.com/molecular","followers_url":"https://api.github.com/users/molecular/followers","following_url":"https://api.github.com/users/molecular/following{/other_user}","gists_url":"https://api.github.com/users/molecular/gists{/gist_id}","starred_url":"https://api.github.com/users/molecular/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/molecular/subscriptions","organizations_url":"https://api.github.com/users/molecular/orgs","repos_url":"https://api.github.com/users/molecular/repos","events_url":"https://api.github.com/users/molecular/events{/privacy}","received_events_url":"https://api.github.com/users/molecular/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-21T09:01:02Z","updated_at":"2021-03-21T09:03:37Z","author_association":"NONE","body":"I ran into this (100% cpu 1-2 minutes after couchdb start, never stopped). \r\n\r\nReason was a view compaction being triggered (and repeatedly re-triggered right after it finished) on a ~5 million document db that gets new document(s) every 10 seconds.\r\n\r\nI copied the defaults from https://docs.couchdb.org/en/latest/maintenance/compaction.html#channel-configuration and that resulted is much less frequent view compaction being triggered. \r\n\r\nSo those \"defaults2 are likely not the defaults on my system (archlinux, couchdb 3.1.1-2)\r\n\r\nI also learned how to interpret db metadata to evaluate what's a good treshold priority\r\n\r\n```sh\r\n#> curl -s -u admin:<pw> -X GET http://blackbox:5984/<db> | jq '(.sizes.file - .sizes.active) / 1E6'\r\n62.852902\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/803536567/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/804134790","html_url":"https://github.com/apache/couchdb/pull/3450#issuecomment-804134790","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3450","id":804134790,"node_id":"MDEyOklzc3VlQ29tbWVudDgwNDEzNDc5MA==","user":{"login":"bessbd","id":9086834,"node_id":"MDQ6VXNlcjkwODY4MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/9086834?v=4","gravatar_id":"","url":"https://api.github.com/users/bessbd","html_url":"https://github.com/bessbd","followers_url":"https://api.github.com/users/bessbd/followers","following_url":"https://api.github.com/users/bessbd/following{/other_user}","gists_url":"https://api.github.com/users/bessbd/gists{/gist_id}","starred_url":"https://api.github.com/users/bessbd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bessbd/subscriptions","organizations_url":"https://api.github.com/users/bessbd/orgs","repos_url":"https://api.github.com/users/bessbd/repos","events_url":"https://api.github.com/users/bessbd/events{/privacy}","received_events_url":"https://api.github.com/users/bessbd/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-22T15:05:30Z","updated_at":"2021-03-22T15:05:30Z","author_association":"MEMBER","body":"Thank you for the review, @nickva ! I'm about to merge this.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/804134790/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/804242078","html_url":"https://github.com/apache/couchdb/issues/2785#issuecomment-804242078","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2785","id":804242078,"node_id":"MDEyOklzc3VlQ29tbWVudDgwNDI0MjA3OA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-22T17:14:01Z","updated_at":"2021-03-22T17:14:01Z","author_association":"MEMBER","body":"2.x is done, this isn't going to get fixed.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/804242078/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/804843277","html_url":"https://github.com/apache/couchdb/pull/3363#issuecomment-804843277","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3363","id":804843277,"node_id":"MDEyOklzc3VlQ29tbWVudDgwNDg0MzI3Nw==","user":{"login":"iilyak","id":9804420,"node_id":"MDQ6VXNlcjk4MDQ0MjA=","avatar_url":"https://avatars.githubusercontent.com/u/9804420?v=4","gravatar_id":"","url":"https://api.github.com/users/iilyak","html_url":"https://github.com/iilyak","followers_url":"https://api.github.com/users/iilyak/followers","following_url":"https://api.github.com/users/iilyak/following{/other_user}","gists_url":"https://api.github.com/users/iilyak/gists{/gist_id}","starred_url":"https://api.github.com/users/iilyak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/iilyak/subscriptions","organizations_url":"https://api.github.com/users/iilyak/orgs","repos_url":"https://api.github.com/users/iilyak/repos","events_url":"https://api.github.com/users/iilyak/events{/privacy}","received_events_url":"https://api.github.com/users/iilyak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-23T11:57:53Z","updated_at":"2021-03-23T11:57:53Z","author_association":"CONTRIBUTOR","body":"@janosgyerman I remember you had a similar PR for 3.x branch but I cannot find. If we cannot repro this on main. Let's at least fix it for 3.x.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/804843277/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/804950003","html_url":"https://github.com/apache/couchdb/issues/3381#issuecomment-804950003","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3381","id":804950003,"node_id":"MDEyOklzc3VlQ29tbWVudDgwNDk1MDAwMw==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-23T14:30:19Z","updated_at":"2021-03-23T14:30:19Z","author_association":"CONTRIBUTOR","body":"https://github.com/apache/couchdb/pull/3447 to go along with #3391 to lower the view indexer TX times","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/804950003/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]