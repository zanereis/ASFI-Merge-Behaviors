[{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2339186481","html_url":"https://github.com/apache/accumulo/pull/4867#issuecomment-2339186481","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4867","id":2339186481,"node_id":"IC_kwDOACaFSM6LbScx","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-09T21:30:40Z","updated_at":"2024-09-09T21:30:40Z","author_association":"CONTRIBUTOR","body":"> Did you see the mentioned memory issue actually happen or is this more preventative?\r\n\r\nIts a preventative change.  The number of external compactions has the potential to scale with the number of tablets.  A lot of the Accumulo code tries to avoid assuming that per tablet information fits in memory.  This code is kinda doing that and its doing it per web request.\r\n\r\n> I am also wondering it would simplify the code if we used the memoizeWithExpiration in place of the other code that checks if an interval has passed before computing again (getScans(), getScanServerScans(), getCompactions(), getCompactorsInfo()). Although this should probably not be done in this PR.\r\n\r\nThat would be good to investigate for a a follow on PR.  Looking around in the monitor there is other code that also rate limits the amount of time data is fetched and that would be nice to use memoizeWithExpiration if its workable.  Looking into this I noticed a REFRESH_TIME constant in the montior, I think I will use that for this PR. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2339186481/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2339216603","html_url":"https://github.com/apache/accumulo/pull/4867#issuecomment-2339216603","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4867","id":2339216603,"node_id":"IC_kwDOACaFSM6LbZzb","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-09T21:50:34Z","updated_at":"2024-09-09T21:50:34Z","author_association":"CONTRIBUTOR","body":"> I am also wondering it would simplify the code if we used the memoizeWithExpiration in place of the other code that checks if an interval has passed before computing again (getScans(), getScanServerScans(), getCompactions(), getCompactorsInfo()). Although this should probably not be done in this PR.\r\n\r\n\r\nI updated the code to use an existing timeout that the functions you mentioned were using in dc5f043.   Those existing functions seems to have a bug there they will never refresh if nanoTime starts off negative (which the nanoTime javadoc mentions can happen).  So using memoizeWithExpiration or Timer w/ those functions would probably fix a bug.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2339216603/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2341510363","html_url":"https://github.com/apache/accumulo/pull/4861#issuecomment-2341510363","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4861","id":2341510363,"node_id":"IC_kwDOACaFSM6LkJzb","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-10T17:08:26Z","updated_at":"2024-09-10T17:08:26Z","author_association":"CONTRIBUTOR","body":"> Will we need to open a follow on issue for updgrade? Will we need to clean up anything in ZK from the old way of doing things for tablet and scan servers?\r\n\r\nAddressed in 9f9a0af","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2341510363/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2341833683","html_url":"https://github.com/apache/accumulo/issues/4870#issuecomment-2341833683","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4870","id":2341833683,"node_id":"IC_kwDOACaFSM6LlYvT","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-10T19:17:05Z","updated_at":"2024-09-24T19:37:11Z","author_association":"MEMBER","body":"This ticket can only be completed once PR #4850 is merged.\r\n\r\nEdit: See next comment. Ticket should stay open for now.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2341833683/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2341834891","html_url":"https://github.com/apache/accumulo/pull/4850#issuecomment-2341834891","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4850","id":2341834891,"node_id":"IC_kwDOACaFSM6LlZCL","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-10T19:17:48Z","updated_at":"2024-09-10T19:17:48Z","author_association":"MEMBER","body":"@keith-turner sounds good. I created #4870 to track this.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2341834891/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2342325336","html_url":"https://github.com/apache/accumulo/pull/4872#issuecomment-2342325336","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4872","id":2342325336,"node_id":"IC_kwDOACaFSM6LnQxY","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-10T23:19:50Z","updated_at":"2024-09-10T23:19:50Z","author_association":"CONTRIBUTOR","body":"Created this while working on #4505 and decided to pull it out into its own PR.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2342325336/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2342379014","html_url":"https://github.com/apache/accumulo/pull/4873#issuecomment-2342379014","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4873","id":2342379014,"node_id":"IC_kwDOACaFSM6Lnd4G","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-11T00:18:28Z","updated_at":"2024-09-11T00:18:28Z","author_association":"CONTRIBUTOR","body":"In a test with a single tablet sever with 4,000 tablets and the following setting\r\n\r\n```\r\ntserver.assignment.concurrent.max=64\r\n```\r\n\r\nsaw the following number tablets per second loaded after an unclean shutdown using these changes.\r\n\r\n```\r\n$ grep Loaded tserver.log | grep tablet.location | cut -b 1-19 | uniq -c\r\n      1 2024-09-11T00:07:21\r\n      2 2024-09-11T00:07:25\r\n     57 2024-09-11T00:07:31\r\n     57 2024-09-11T00:07:32\r\n    124 2024-09-11T00:07:33\r\n    139 2024-09-11T00:07:34\r\n    164 2024-09-11T00:07:35\r\n    133 2024-09-11T00:07:36\r\n    195 2024-09-11T00:07:37\r\n    172 2024-09-11T00:07:38\r\n    313 2024-09-11T00:07:39\r\n    331 2024-09-11T00:07:40\r\n    400 2024-09-11T00:07:41\r\n    400 2024-09-11T00:07:42\r\n    387 2024-09-11T00:07:43\r\n    382 2024-09-11T00:07:44\r\n    448 2024-09-11T00:07:45\r\n    300 2024-09-11T00:07:46\r\n```\r\n\r\nRunning the same test against 3.1.0-SNAPSHOT, saw the following number of tablet per second loaded.\r\n\r\n```\r\n      1 2024-09-10T19:32:50\r\n      2 2024-09-10T19:32:54\r\n      2 2024-09-10T19:32:55\r\n     12 2024-09-10T19:32:56\r\n     20 2024-09-10T19:32:57\r\n     29 2024-09-10T19:32:58\r\n     34 2024-09-10T19:32:59\r\n     33 2024-09-10T19:33:00\r\n     34 2024-09-10T19:33:01\r\n     41 2024-09-10T19:33:02\r\n     41 2024-09-10T19:33:03\r\n     39 2024-09-10T19:33:04\r\n     45 2024-09-10T19:33:05\r\n     45 2024-09-10T19:33:06\r\n     49 2024-09-10T19:33:07\r\n     50 2024-09-10T19:33:08\r\n     48 2024-09-10T19:33:09\r\n     48 2024-09-10T19:33:10\r\n     48 2024-09-10T19:33:11\r\n     50 2024-09-10T19:33:12\r\n     52 2024-09-10T19:33:13\r\n     52 2024-09-10T19:33:14\r\n     51 2024-09-10T19:33:15\r\n     54 2024-09-10T19:33:16\r\n     54 2024-09-10T19:33:17\r\n     55 2024-09-10T19:33:18\r\n     57 2024-09-10T19:33:19\r\n     56 2024-09-10T19:33:20\r\n     58 2024-09-10T19:33:21\r\n     57 2024-09-10T19:33:22\r\n     56 2024-09-10T19:33:23\r\n     56 2024-09-10T19:33:24\r\n     58 2024-09-10T19:33:25\r\n     59 2024-09-10T19:33:26\r\n     57 2024-09-10T19:33:27\r\n     57 2024-09-10T19:33:28\r\n     37 2024-09-10T19:33:29\r\n     51 2024-09-10T19:33:30\r\n     49 2024-09-10T19:33:31\r\n     55 2024-09-10T19:33:32\r\n     55 2024-09-10T19:33:33\r\n     54 2024-09-10T19:33:34\r\n     58 2024-09-10T19:33:35\r\n     58 2024-09-10T19:33:36\r\n     56 2024-09-10T19:33:37\r\n     55 2024-09-10T19:33:38\r\n     58 2024-09-10T19:33:39\r\n     56 2024-09-10T19:33:40\r\n     54 2024-09-10T19:33:41\r\n     55 2024-09-10T19:33:42\r\n     57 2024-09-10T19:33:43\r\n     53 2024-09-10T19:33:44\r\n     56 2024-09-10T19:33:45\r\n     55 2024-09-10T19:33:46\r\n     56 2024-09-10T19:33:47\r\n     55 2024-09-10T19:33:48\r\n     53 2024-09-10T19:33:49\r\n     55 2024-09-10T19:33:50\r\n     57 2024-09-10T19:33:51\r\n     58 2024-09-10T19:33:52\r\n     58 2024-09-10T19:33:53\r\n     58 2024-09-10T19:33:54\r\n     58 2024-09-10T19:33:55\r\n     59 2024-09-10T19:33:56\r\n     56 2024-09-10T19:33:57\r\n      5 2024-09-10T19:33:58\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2342379014/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2342415218","html_url":"https://github.com/apache/accumulo/issues/4875#issuecomment-2342415218","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4875","id":2342415218,"node_id":"IC_kwDOACaFSM6Lnmty","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-11T01:00:54Z","updated_at":"2024-09-11T01:00:54Z","author_association":"CONTRIBUTOR","body":"The following is the link to the code that deletes the walogs\r\n\r\nhttps://github.com/apache/accumulo/blob/233baddbe89850c2d303a25386ee828c0e21b23b/server/tserver/src/main/java/org/apache/accumulo/tserver/tablet/Tablet.java#L306-L318\r\n\r\n\r\nThe following is the link to the code that sets the location\r\n\r\nhttps://github.com/apache/accumulo/blob/233baddbe89850c2d303a25386ee828c0e21b23b/server/tserver/src/main/java/org/apache/accumulo/tserver/AssignmentHandler.java#L159\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2342415218/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2343450096","html_url":"https://github.com/apache/accumulo/pull/4861#issuecomment-2343450096","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4861","id":2343450096,"node_id":"IC_kwDOACaFSM6LrjXw","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-11T11:48:34Z","updated_at":"2024-09-11T11:48:34Z","author_association":"CONTRIBUTOR","body":"Full IT build passed except for `NamespaceIdTest.testCacheIncreasesAndDecreasesAfterGC`. This seems unrelated and a similar test is failing in the `main` branch.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2343450096/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2344318091","html_url":"https://github.com/apache/accumulo/pull/4850#issuecomment-2344318091","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4850","id":2344318091,"node_id":"IC_kwDOACaFSM6Lu3SL","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-11T17:49:19Z","updated_at":"2024-09-11T17:49:19Z","author_association":"MEMBER","body":"I made a PR to the website to add the doc generated by these changes: https://github.com/apache/accumulo-website/pull/442.\r\n\r\nAlso, here is a screenshot of what things look like currently on the User manual page of the website when I run it from the linked branch:\r\n\r\n![Screenshot from 2024-09-11 13-37-28](https://github.com/user-attachments/assets/3417a811-8210-4d07-a590-fbc308c7a597)","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2344318091/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2344323417","html_url":"https://github.com/apache/accumulo/pull/4850#issuecomment-2344323417","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4850","id":2344323417,"node_id":"IC_kwDOACaFSM6Lu4lZ","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-11T17:52:08Z","updated_at":"2024-09-11T17:52:08Z","author_association":"MEMBER","body":"I think this PR is ready to be merged as far as I can tell. Once this is merged I plan to open a follow on PR in the hopes that everyone can contribute to adding/editing the descriptions for each metric.\r\n\r\nI have also verified that running `mvn package -DskipTests` correctly generates the markdown doc and puts in alongside the other generated markdown docs for client and server properties.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2344323417/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2344366086","html_url":"https://github.com/apache/accumulo/pull/4850#issuecomment-2344366086","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4850","id":2344366086,"node_id":"IC_kwDOACaFSM6LvDAG","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-11T18:15:19Z","updated_at":"2024-09-11T18:15:19Z","author_association":"CONTRIBUTOR","body":"Was there already a discussion about the table format that is used for the properties? If so, I'll go read that.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2344366086/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2344564981","html_url":"https://github.com/apache/accumulo/pull/4852#issuecomment-2344564981","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4852","id":2344564981,"node_id":"IC_kwDOACaFSM6Lvzj1","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-11T19:42:36Z","updated_at":"2024-09-11T19:42:36Z","author_association":"MEMBER","body":"Resolved conflict from https://github.com/apache/accumulo/pull/4858. PR should be ready to merge","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2344564981/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2344571828","html_url":"https://github.com/apache/accumulo/issues/4877#issuecomment-2344571828","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4877","id":2344571828,"node_id":"IC_kwDOACaFSM6Lv1O0","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-11T19:46:50Z","updated_at":"2024-09-11T19:46:50Z","author_association":"CONTRIBUTOR","body":"Did not set a milestone for this because was unsure what the changes would look like.  If the complexity of the change is low then may want to consider fixing in 2.1","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2344571828/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2344619347","html_url":"https://github.com/apache/accumulo/pull/4816#issuecomment-2344619347","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4816","id":2344619347,"node_id":"IC_kwDOACaFSM6LwA1T","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-11T20:14:33Z","updated_at":"2024-09-11T20:14:33Z","author_association":"MEMBER","body":"After a conversation with @kevinrr888, I added commit 5924b02c065297886ede479fbcf9750e699e4362 to incorporate some of the changes we discussed, that he intends to build on and polish up. The main points included were:\r\n\r\n* Push a reasonable `getConfig()` implementation up into `IteratorEnvironment`'s default method (depends on the ability to have `getTableId()` return a null value)\r\n* Include concrete implementations of `getPluginEnv()` instead of just `getServiceEnv()` to make it easier to just drop the deprecated one when merging to newer branches\r\n* Consider using a Proxy instance of TableId instead of a real instance, so it isn't possible to be confused with any similar user-constructed TableId (may not work)\r\n* Update javadocs in RFile to make it clearer how properties set on the scanner builder (such as iterators) will be available to client-side iterators from the plugin environment\r\n\r\nThe main thing left unresolved after our conversation was how to fix the mismatch between the implementations and the javadoc for all the methods that inconsistently return null or throw IllegalStateException or UnsupportedOperationException, when calling a method that doesn't apply to a given situation (like asking for a table ID or table name when operating directly on RFiles or asking if it's a user-initiated compaction when it's a scan). Nearly every caller seems to have a unique set a requirements/implementation, and it's a bit hard to home in on the best implementation, especially for the default methods, and make sure the javadoc matches the behavior.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2344619347/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2344639593","html_url":"https://github.com/apache/accumulo/issues/4877#issuecomment-2344639593","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4877","id":2344639593,"node_id":"IC_kwDOACaFSM6LwFxp","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-11T20:27:21Z","updated_at":"2024-09-11T20:29:17Z","author_association":"CONTRIBUTOR","body":"I remembered that I had made a comment somewhere about filtering in log4j. [This](https://github.com/apache/accumulo/issues/4409#issuecomment-2061147133) is the comment. I wonder if this filter could be applied with the MonitorLoggerAppender in the configuration.  If this works, then this would be a no-code solution that a user could apply on their own.\r\n\r\nUpdate: It looks like Filters are to be used with Appenders, so this should be possible. Reference: https://logging.apache.org/log4j/2.x/javadoc/log4j-core/org/apache/logging/log4j/core/filter/BurstFilter.html","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2344639593/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2344656568","html_url":"https://github.com/apache/accumulo/issues/4876#issuecomment-2344656568","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4876","id":2344656568,"node_id":"IC_kwDOACaFSM6LwJ64","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-11T20:37:16Z","updated_at":"2024-09-11T20:37:16Z","author_association":"CONTRIBUTOR","body":"Other options might include:\r\n\r\n - a ring buffer, log4j2 asynchronous logging uses the LMAX Disruptor [RingBuffer](https://github.com/LMAX-Exchange/disruptor/blob/master/src/main/java/com/lmax/disruptor/RingBuffer.java#L84) (it's already a dependency I think).\r\n \r\n - a [LinkedTransferQueue](https://docs.oracle.com/en%2Fjava%2Fjavase%2F11%2Fdocs%2Fapi%2F%2F/java.base/java/util/concurrent/LinkedTransferQueue.html), but might have to check it's size before putting the object on it as it's unbounded.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2344656568/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2346022055","html_url":"https://github.com/apache/accumulo/issues/4876#issuecomment-2346022055","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4876","id":2346022055,"node_id":"IC_kwDOACaFSM6L1XSn","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-12T11:21:34Z","updated_at":"2024-09-12T11:21:34Z","author_association":"CONTRIBUTOR","body":"> * a ring buffer, log4j2 asynchronous logging uses the LMAX Disruptor [RingBuffer](https://github.com/LMAX-Exchange/disruptor/blob/master/src/main/java/com/lmax/disruptor/RingBuffer.java#L84) (it's already a dependency I think).\r\n\r\nRingBuffer here is an interesting idea, but the main thing that I noticed looking at the code is that it uses a map specifically for deduplication. A key is generated so it avoids storing duplicates and I don't know that is possible for another data structure like RingBuffer but I haven't looked at it very closely.\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2346022055/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2346037451","html_url":"https://github.com/apache/accumulo/issues/4876#issuecomment-2346037451","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4876","id":2346037451,"node_id":"IC_kwDOACaFSM6L1bDL","user":{"login":"ben-manes","id":378614,"node_id":"MDQ6VXNlcjM3ODYxNA==","avatar_url":"https://avatars.githubusercontent.com/u/378614?v=4","gravatar_id":"","url":"https://api.github.com/users/ben-manes","html_url":"https://github.com/ben-manes","followers_url":"https://api.github.com/users/ben-manes/followers","following_url":"https://api.github.com/users/ben-manes/following{/other_user}","gists_url":"https://api.github.com/users/ben-manes/gists{/gist_id}","starred_url":"https://api.github.com/users/ben-manes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ben-manes/subscriptions","organizations_url":"https://api.github.com/users/ben-manes/orgs","repos_url":"https://api.github.com/users/ben-manes/repos","events_url":"https://api.github.com/users/ben-manes/events{/privacy}","received_events_url":"https://api.github.com/users/ben-manes/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-12T11:29:47Z","updated_at":"2024-09-12T11:36:37Z","author_association":"CONTRIBUTOR","body":"Do you want it exact or can it be lossy (sampled)?\r\n\r\nCaffeine uses ring buffers as a lightweight recording of events that are replayed under a tryLock. It’s lossy for reads (request sampling) as a skewed distribution means popular items reappear frequently enough to get deemed hot, even if some are lost. It’s a pretty common pattern, pubsub, where the ring buffer is just a fixed queue between multiple producers / single consumer so that you don’t throttle the producers.\r\n\r\nIf sampling is okay then just a tryLock to append an event is likely enough, and an exclusive lock for aggregate operations like clear() and sanitized(). And if any reads like size or sanitized are a bottleneck, then you can dual write to maintain a copy for lock-free access (ConcurrentHashMap as unordered view).","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2346037451/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2346093599","html_url":"https://github.com/apache/accumulo/issues/4876#issuecomment-2346093599","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4876","id":2346093599,"node_id":"IC_kwDOACaFSM6L1owf","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-12T11:59:29Z","updated_at":"2024-09-12T11:59:29Z","author_association":"CONTRIBUTOR","body":"> Do you want it exact or can it be lossy (sampled)?\r\n\r\nI think the Monitor tries to keep a fixed number of recent log messages from the servers to display to the user. I think the issue is that the Monitor (a single object) is being flooded with messages, and the code is in a synchronized block slowing it way down. Ideally, we wouldn't be showing log messages in the Monitor. I made a comment in the related ticket (#4877) with a possible no-code solution for throttling the senders.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2346093599/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2346402111","html_url":"https://github.com/apache/accumulo/pull/4850#issuecomment-2346402111","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4850","id":2346402111,"node_id":"IC_kwDOACaFSM6L20E_","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-12T14:06:09Z","updated_at":"2024-09-12T14:06:09Z","author_association":"MEMBER","body":"> Was there already a discussion about the table format that is used for the properties? If so, I'll go read that.\r\n\r\nHere is a link to where I proposed the current format: https://github.com/apache/accumulo/issues/4815#issuecomment-2313386004 along with the comment that follows it. That was pretty much the whole discussion on the formatting. \r\n\r\nThere is still time for more input/opinions as that is something that is pretty easy to change at this point. Do you a table better than how it is now with different sections per metric? @dlmarion ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2346402111/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2346449657","html_url":"https://github.com/apache/accumulo/pull/4866#issuecomment-2346449657","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4866","id":2346449657,"node_id":"IC_kwDOACaFSM6L2_r5","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-12T14:23:40Z","updated_at":"2024-09-12T14:23:40Z","author_association":"CONTRIBUTOR","body":"The MiniAccumulo tests were hanging on this and I took a look at logs and found the following:\r\n\r\n```\r\n2024-09-12T10:20:28,962 [threads.AccumuloUncaughtExceptionHandler] ERROR: Caught an Exception in Thread[accumulo.pool\r\n.metadata.tablet.assignment-Worker-10,5,main]. Thread is dead.\r\njava.lang.RuntimeException: java.lang.ArithmeticException: long overflow\r\n        at org.apache.accumulo.tserver.AssignmentHandler.run(AssignmentHandler.java:142) ~[accumulo-tserver-2.1.4-SNAPSHOT.jar:2.1.4-SNAPSHOT]\r\n        at org.apache.accumulo.tserver.ActiveAssignmentRunnable.run(ActiveAssignmentRunnable.java:63) ~[accumulo-tserver-2.1.4-SNAPSHOT.jar:2.1.4-SNAPSHOT]\r\n        at org.apache.accumulo.core.trace.TraceWrappedRunnable.run(TraceWrappedRunnable.java:52) ~[accumulo-core-2.1.4-SNAPSHOT.jar:2.1.4-SNAPSHOT]\r\n        at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]\r\n        at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]\r\n        at org.apache.accumulo.core.trace.TraceWrappedRunnable.run(TraceWrappedRunnable.java:52) ~[accumulo-core-2.1.4-SNAPSHOT.jar:2.1.4-SNAPSHOT]\r\n        at java.base/java.lang.Thread.run(Thread.java:840) [?:?]\r\nCaused by: java.lang.ArithmeticException: long overflow\r\n        at java.base/java.lang.Math.multiplyExact(Math.java:1004) ~[?:?]\r\n        at java.base/java.time.Duration.toNanos(Duration.java:1250) ~[?:?]\r\n        at org.apache.accumulo.core.util.Timer.hasElapsed(Timer.java:62) ~[accumulo-core-2.1.4-SNAPSHOT.jar:2.1.4-SNAPSHOT]\r\n        at org.apache.accumulo.core.clientImpl.ThriftScanner.scan(ThriftScanner.java:344) ~[accumulo-core-2.1.4-SNAPSHOT.jar:2.1.4-SNAPSHOT]\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2346449657/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2346605683","html_url":"https://github.com/apache/accumulo/pull/4850#issuecomment-2346605683","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4850","id":2346605683,"node_id":"IC_kwDOACaFSM6L3lxz","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-12T15:25:41Z","updated_at":"2024-09-12T15:25:41Z","author_association":"CONTRIBUTOR","body":"@DomGarguilo - Looking at the server configuration properties [table](https://accumulo.apache.org/docs/2.x/configuration/server-properties3), I like how the entries are more condensed and that there is a separator between each one. If we end up having a short description, and a longer explanation, then I can see how that might not work well in a table. Can the current format be adjusted to put a line separator between each metric, and to reduce the whitespace within the lines of the elements for each metric?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2346605683/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2346773604","html_url":"https://github.com/apache/accumulo/pull/4850#issuecomment-2346773604","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4850","id":2346773604,"node_id":"IC_kwDOACaFSM6L4Oxk","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-12T16:40:54Z","updated_at":"2024-09-12T16:40:54Z","author_association":"MEMBER","body":"> @DomGarguilo - Looking at the server configuration properties [table](https://accumulo.apache.org/docs/2.x/configuration/server-properties3), I like how the entries are more condensed and that there is a separator between each one. If we end up having a short description, and a longer explanation, then I can see how that might not work well in a table. Can the current format be adjusted to put a line separator between each metric, and to reduce the whitespace within the lines of the elements for each metric?\r\n\r\nYea I think those would be good improvements. I'll try to do that. \r\n\r\nI think once this is merged and the follow on PR is created to fill out or improve all the descriptions, that will also give us a better idea of whether a table or \"list\" format would be better.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2346773604/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2346796290","html_url":"https://github.com/apache/accumulo/issues/4877#issuecomment-2346796290","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4877","id":2346796290,"node_id":"IC_kwDOACaFSM6L4UUC","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-12T16:53:11Z","updated_at":"2024-09-12T16:53:11Z","author_association":"MEMBER","body":"I'm not opposed to pursing the addition of the QoS handler, if it's a small amount of code (which I suspect it would be), but I also think that if this is only an issue with the logging, then users should really implement their own filters to control that. I would like to discourage the use of the monitor appender as the primary means of collecting and viewing logs, or alerting on log events, as it's really just an item for convenience, not something that is really suitable for reliable log watching anyway, and there are much better appenders for proper log collection, monitoring, and alerting, that users should configure for their specific use cases in their specific deployed environment (although personally, I'm a big fan of just using a basic console appender, and collecting logs via journald or rsyslog, like any other Linux daemon service, rather than doing any kind of complex logging in the Java application itself).","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2346796290/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2346802257","html_url":"https://github.com/apache/accumulo/issues/4877#issuecomment-2346802257","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4877","id":2346802257,"node_id":"IC_kwDOACaFSM6L4VxR","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-12T16:56:33Z","updated_at":"2024-09-12T16:57:03Z","author_association":"MEMBER","body":"> Not really sure what happens when the previous ignored futures are still in progress because the monitor is not keeping up. Does the client just keep queuing up stuff to send and adding more http request?\r\n\r\nClient-side backpressure for logging to the monitor appender should be handled by the async logger feature (see `-Dlog4j2.contextSelector=org.apache.logging.log4j.core.async.AsyncLoggerContextSelector` in our `conf/accumulo-env.sh` script and https://logging.apache.org/log4j/2.x/manual/async.html . There are properties for setting the discard threshold.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2346802257/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2346819074","html_url":"https://github.com/apache/accumulo/issues/4828#issuecomment-2346819074","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4828","id":2346819074,"node_id":"IC_kwDOACaFSM6L4Z4C","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-12T17:05:52Z","updated_at":"2024-09-12T17:05:52Z","author_association":"MEMBER","body":"In general, I think it'd be okay to move to 17 for 3.1. The biggest holdup is that Hadoop doesn't have good support for 17 to my knowledge, although I've been running it on a single node with 17 for awhile, and it seems to be fine, with the exception of a few quirks, like start-yarn.sh fails on 17 (I haven't looked into why it doesn't work).","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2346819074/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2346905444","html_url":"https://github.com/apache/accumulo/issues/4877#issuecomment-2346905444","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4877","id":2346905444,"node_id":"IC_kwDOACaFSM6L4u9k","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-12T17:53:37Z","updated_at":"2024-09-12T17:53:37Z","author_association":"CONTRIBUTOR","body":"> Client-side backpressure for logging to the monitor appender should be handled by the async logger feature (see -Dlog4j2.contextSelector=org.apache.logging.log4j.core.async.AsyncLoggerContextSelector in our conf/accumulo-env.sh script and https://logging.apache.org/log4j/2.x/manual/async.html . There are properties for setting the discard threshold.\r\n\r\nOne thing I am uncertain about with the AsyncLoggerContextSelector is that in AccumuloMonitorAppender will [create an async http task](https://github.com/apache/accumulo/blob/233baddbe89850c2d303a25386ee828c0e21b23b/server/monitor/src/main/java/org/apache/accumulo/monitor/util/logging/AccumuloMonitorAppender.java#L124) to send the data and not wait on the future.  So maybe from log4js perspective appending is always instant and it just keeps queuing http sends on the client side.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2346905444/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2346915985","html_url":"https://github.com/apache/accumulo/issues/4877#issuecomment-2346915985","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4877","id":2346915985,"node_id":"IC_kwDOACaFSM6L4xiR","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-12T17:58:13Z","updated_at":"2024-09-12T17:58:13Z","author_association":"CONTRIBUTOR","body":">  if this filter could be applied with the MonitorLoggerAppender in the configuration. If this works, then this would be a no-code solution that a user could apply on their own.\r\n\r\nOne thing to consider about rate limiting on the client side is that it may require adjusting the log4j config based on the number of servers.  For example if I want to limit to 100K log events per second and I have 100 servers then I would need to configure log4j in each server with a max rate of 1000.  If I have 200 servers then I would need to set the max rate in log4j to 500 to get the same overall rate.  If the rate could be configure in the monitor on the server side it would make configuring this simpler.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2346915985/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2346920423","html_url":"https://github.com/apache/accumulo/issues/4823#issuecomment-2346920423","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4823","id":2346920423,"node_id":"IC_kwDOACaFSM6L4ynn","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-12T18:00:27Z","updated_at":"2024-09-12T18:00:27Z","author_association":"CONTRIBUTOR","body":"> The accumulo shell communicates with the system by connecting as a random tserver.\r\n> This can be problematic as information like property site config information is based on the specific tserver connection.\r\n\r\nI believe the random behavior that you are referring to only happens when the client is executing a method from the [ClientService](https://github.com/apache/accumulo/blob/3.1/core/src/main/thrift-gen-java/org/apache/accumulo/core/clientImpl/thrift/ClientService.java) or the [TabletServerClientService](https://github.com/apache/accumulo/blob/main/core/src/main/thrift-gen-java/org/apache/accumulo/core/tabletserver/thrift/TabletServerClientService.java).\r\n\r\nThe random connection logic is located [here](https://github.com/apache/accumulo/blob/3.1/core/src/main/java/org/apache/accumulo/core/rpc/clients/TServerClient.java#L60). Looking at the methods on the [TabletServerClientService$Iface](https://github.com/apache/accumulo/blob/main/core/src/main/thrift-gen-java/org/apache/accumulo/core/tabletserver/thrift/TabletServerClientService.java#L30), I think we should support specifying a specific server name for the ClientService only.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2346920423/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2346963497","html_url":"https://github.com/apache/accumulo/issues/4877#issuecomment-2346963497","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4877","id":2346963497,"node_id":"IC_kwDOACaFSM6L49Ip","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-12T18:23:47Z","updated_at":"2024-09-12T18:23:47Z","author_association":"MEMBER","body":"> So maybe from log4js perspective appending is always instant and it just keeps queuing http sends on the client side.\r\n\r\nI believe this is true, provided you have the appropriate lmax disruptor library on the classpath. However, the client side queue should be configurable... I thought the discardThreshold configuration property would be helpful here, but it's only when the queue is full, it drops items of a certain log level... not a blanket drop of all items, unless we set the discard threshold to the max log severity, perhaps?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2346963497/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2346989662","html_url":"https://github.com/apache/accumulo/issues/4876#issuecomment-2346989662","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4876","id":2346989662,"node_id":"IC_kwDOACaFSM6L5Dhe","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-12T18:39:18Z","updated_at":"2024-09-12T18:40:54Z","author_association":"CONTRIBUTOR","body":"The situation I was seeing that prompted me open this issue was that many  tservers were having lots of errors, those were being forwarded to the monitor.  The monitor would eventually die w/ OOME.  Some jstacks of the monitor showed close to 200 jetty threads stuck trying to get the lock for [this method](https://github.com/apache/accumulo/blob/38952c922648014e74e4e7a5704bfa256f390faa/server/monitor/src/main/java/org/apache/accumulo/monitor/util/logging/RecentLogs.java#L66) prior to OOME.   The hypothesis was that the tservers continued to send messages and those would be placed on a jetty thread pool queue until the monitor ran out of memory.  Following that hypothesis I opened this issue to improve the concurrency.  Then opened #4877 to explore rate limiting with the assumption that solving this issue would increase the upper bound on what the monitor could process a second but there would still be an upper bound, so may still be nice to gracefully handle exceeding the upper bound.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2346989662/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2347016570","html_url":"https://github.com/apache/accumulo/pull/4850#issuecomment-2347016570","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4850","id":2347016570,"node_id":"IC_kwDOACaFSM6L5KF6","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-12T18:53:25Z","updated_at":"2024-09-12T18:59:30Z","author_association":"MEMBER","body":"In e818f6d I added some more style changes so that the metrics page will render with alternating background colors per metric as well as reduced line break between fields:\r\n![image](https://github.com/user-attachments/assets/55a50a0a-18de-4032-bdad-0f94633dd479)\r\n\r\nI think this looks nice and did this as opposed to a line separator since there is one after each metrics section title (e.g. \"General Server Metrics\", \"Compactor Metrics\", etc.)","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2347016570/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2347026281","html_url":"https://github.com/apache/accumulo/pull/4850#issuecomment-2347026281","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4850","id":2347026281,"node_id":"IC_kwDOACaFSM6L5Mdp","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-12T18:59:06Z","updated_at":"2024-09-12T18:59:06Z","author_association":"CONTRIBUTOR","body":"@DomGarguilo  - this looks better, thanks for adding this change.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2347026281/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2347036382","html_url":"https://github.com/apache/accumulo/issues/4877#issuecomment-2347036382","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4877","id":2347036382,"node_id":"IC_kwDOACaFSM6L5O7e","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-12T19:04:58Z","updated_at":"2024-09-12T19:04:58Z","author_association":"CONTRIBUTOR","body":"I dug into what [this code](https://github.com/apache/accumulo/blob/233baddbe89850c2d303a25386ee828c0e21b23b/server/monitor/src/main/java/org/apache/accumulo/monitor/util/logging/AccumuloMonitorAppender.java#L124) is doing.  Looking at the javadocs they mention an executor [will be created](https://docs.oracle.com/en/java/javase/11/docs/api/java.net.http/java/net/http/HttpClient.Builder.html#executor(java.util.concurrent.Executor)) if one is not supplied.  This executor is used for the sendAsync request.  The javadocs do not mention anything about what kind of executor is created.  Looking at the impl of HttpClient in JDK17 it calls [Executors.newCachedThreadPool](https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/Executors.html#newCachedThreadPool-java.util.concurrent.ThreadFactory-).  So it seems like the current code may create an http client thread for each log4j append request. Since the future is ignored, this could be a lot of threads.  It also means that log4j will have no resistance or back pressure until something breaks from too many threads in the server process. So thinking the code should wait on  that future and that would allow the log4j async mechanism to kick in.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2347036382/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2347062846","html_url":"https://github.com/apache/accumulo/pull/4879#issuecomment-2347062846","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4879","id":2347062846,"node_id":"IC_kwDOACaFSM6L5VY-","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-12T19:18:56Z","updated_at":"2024-09-12T19:18:56Z","author_association":"CONTRIBUTOR","body":"Created this as a draft PR because I do not have a good sense of the end to end implications of this change.  So created this to discuss the change.  Its based on discussion in #4877, but is not a solution for #4877. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2347062846/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2347073100","html_url":"https://github.com/apache/accumulo/issues/4876#issuecomment-2347073100","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4876","id":2347073100,"node_id":"IC_kwDOACaFSM6L5X5M","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-12T19:24:49Z","updated_at":"2024-09-12T19:24:49Z","author_association":"MEMBER","body":"Just for context, the only reason we have concurrency on the incoming events is to handle deduplication/aggregation with count of repeated messages. We could just drop that feature. The user could then use their own deduplicating log4j filter for recently repeated messages, so the monitor doesn't have to. We could also show the last half hour of messages instead of a fixed number of unique messages. We could let the browser do the aggregation/counting from whatever messages we have.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2347073100/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2347075963","html_url":"https://github.com/apache/accumulo/issues/4877#issuecomment-2347075963","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4877","id":2347075963,"node_id":"IC_kwDOACaFSM6L5Yl7","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-12T19:26:35Z","updated_at":"2024-09-12T19:26:35Z","author_association":"MEMBER","body":"> So thinking the code should wait on that future and that would allow the log4j async mechanism to kick in.\r\n\r\nI'm having trouble understanding how waiting on the future would have anything to do with the number of threads. The future represents the executable task, not the thread, right? Since this is a best effort, we shouldn't care if the task finished or not. My expectation for the httpClient is that it will maintain threads/connections internally and that is largely abstracted from us. However, this is not the log4j async mechanism. That's just how the appender works when it has events to append to the connection. The log4j async works at a level above this, prior to entering the appender, and is handled by the lmax disruptor threads/executors for the log messages, not the http messages that they get translated into.\r\n\r\nThe log4j async mechanism is supposed to drop messages after a best effort append. We could fail more often in this http code in response to backpressure from the http connection, to let it do that, but I think that would end up resulting in a lot of retries in the log4j code, without additional config to limit them.\r\n\r\nThe other aspect I'm not sure about is whether the log4j async queues are actually filling up. If so, a user might want to more agressively drop stuff from the async queues at the max log level threshold. I think by default it only drops stuff at INFO and lower. That should be a user configuration change, though, not a code change.\r\n\r\nSo, I think there's potential optimization in the client:\r\n\r\n1. User configuration of async logging options,\r\n2. HttpClient executor threads/future handling,\r\n3. Applying backpressure from the HttpClient-based Appender by throwing exceptions back out to the log4j framework to be handled by the log4j async stuff.\r\n\r\nThe potential optimization in the server is:\r\n\r\n1. Reduce thread contention by using a better concurrency model or data structure, instead of a synchronized method that gets called by everybody and blocks even simple things like string concatenation/building, (#4876)\r\n2. Implement QoS handler to rate limit the flood of incoming events (#4877, this issue),\r\n3. Drop deduplication feature or alter it in some other way to remove the need for concurrency (also discussed on #4876)\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2347075963/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2347084411","html_url":"https://github.com/apache/accumulo/issues/4877#issuecomment-2347084411","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4877","id":2347084411,"node_id":"IC_kwDOACaFSM6L5ap7","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-12T19:31:22Z","updated_at":"2024-09-12T19:31:22Z","author_association":"CONTRIBUTOR","body":"> The log4j async mechanism is supposed to drop messages after a best effort append.\r\n\r\nThat sendAsync call is not to log4j, its to an HttpClient object.  The http client sendAsync call happens in the log4j impl of an appender.\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2347084411/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2347088800","html_url":"https://github.com/apache/accumulo/issues/4877#issuecomment-2347088800","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4877","id":2347088800,"node_id":"IC_kwDOACaFSM6L5bug","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-12T19:33:57Z","updated_at":"2024-09-12T19:33:57Z","author_association":"CONTRIBUTOR","body":"> I'm having trouble understanding how waiting on the future would have anything to do with the number of threads. The future represents the executable task, not the thread, right? \r\n\r\nAFAICT each call to sendAsync in the http client will create a task on an executor that is created using Executors.newCachedThreadPool.  So the append method always returns instantly and always creates a thread.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2347088800/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2347164444","html_url":"https://github.com/apache/accumulo/pull/4816#issuecomment-2347164444","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4816","id":2347164444,"node_id":"IC_kwDOACaFSM6L5uMc","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-12T20:19:37Z","updated_at":"2024-09-12T20:37:01Z","author_association":"MEMBER","body":"Some comments about decisions in a68ec11693a57a09c36eecea2cdb70c2c18acfc9\r\n\r\n### Comment about `IteratorEnvironment.getConfig()`:\r\n\r\n**TLDR: opted for not having a default impl for `IteratorEnvironment.getConfig()` (keep default as throwing UOE)**\r\n\r\nIt might be strange to have a default impl for this method but not others... If we do want a default impl for this that isnt just throwing a UOE, we should probably change the others too... But that should be done in a follow on if that is desired. Keeping the default as throwing a UOE keeps it consistent with the other default impls/more inline with the original approach (throw UOE by default, concrete impls should have an actual impl). The only `IteratorEnvironment` which would be using the default `getConfig()` would be `ClientSideIteratorScanner`. But we can just add the impl there (done in latest commit). It is also hard to know what would be a good default impl since its not exactly clear how `getConfig()` was originally working.\r\n\r\n### Comment about `RFileScanner.IterEnv.getTableId()`\r\n\r\n**TLDR: Opted for having `RFileScanner.IterEnv.getTableId()` return null**\r\n\r\nProxy can only be used to create proxies for interfaces, not concrete classes, so can't be used for `TableId`. Opting to just return null with added javadoc.\r\n\r\nBackground: we want to support `getConfiguration(TableId)` since this is the method defined as returning the props set on the table and `getConfiguration()` should not be returning table props, so we cant substitute that method. So, something needs to be passed, but it doesn't matter what since it wont be used. The way `getConfiguration(TableId)` will be called is `env.getPluginEnv().getConfiguration(env.getTableId())` (from javadocs for `IteratorEnvironment.getPluginEnv()`) So, we should have `env.getTableId()` returning something. \r\n\r\nNo solutions seem great, but `Proxy` is a no-go, a real dummy id may be confusing (e.g., a user may think that it is a real table id), null may lead to NPE. I figure null makes the most sense here. A NPE would only occur if the user is trying to do something with the table id which they shouldnt be doing anyways. It is also now noted in the javadocs that null will be returned so if a NPE does occur, it should be easy to see why.\r\n\r\n### Comment about UOE/ISE\r\n\r\nDid not change anything further than I had already changed in my earlier commits relating to when/how UOE or ISE are thrown, how its documented etc. Some future considerations would be\r\n- `IteratorEnvironment.getAuthorizations()` currently documented as throwing `UnsupportedOperationException` if scope != scan (should probably be ISE if anything).\r\n- `IteratorEnvironment.isFullMajorCompaction()` and `isUserCompaction()` should maybe throw ISE in the default if the scope is majc\r\n\t- Maybe these shouldn't be throwing exceptions at all and only returning false... This would probably be the cleanest if possible. Would have to look more into why these are throwing exceptions in the first place.\r\n\r\n### Comment about `RFileScanner`s `createServiceEnv()`\r\n\r\n@ctubbsii suggested having this be an inner class instead of anon class. Leaving this comment as a reminder. Will do once the other more important changes are looked at; want to avoid confusing diff between commits for now.\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2347164444/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2347336718","html_url":"https://github.com/apache/accumulo/pull/4879#issuecomment-2347336718","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4879","id":2347336718,"node_id":"IC_kwDOACaFSM6L6YQO","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-12T22:15:18Z","updated_at":"2024-09-12T22:15:18Z","author_association":"MEMBER","body":"Re #4877, but does not implement or fix #4877; also re #4876","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2347336718/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2347338670","html_url":"https://github.com/apache/accumulo/issues/4877#issuecomment-2347338670","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4877","id":2347338670,"node_id":"IC_kwDOACaFSM6L6Yuu","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-12T22:17:05Z","updated_at":"2024-09-12T22:17:05Z","author_association":"MEMBER","body":"I'll look into the QoS Handler. The issue regarding the Future and its implications on the log4j2 async stuff in the logger client code is a separate issue, largely unrelated to the QoS Handler, and requires some extra investigation I think.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2347338670/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2347338757","html_url":"https://github.com/apache/accumulo/pull/4879#issuecomment-2347338757","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4879","id":2347338757,"node_id":"IC_kwDOACaFSM6L6YwF","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-12T22:17:10Z","updated_at":"2024-09-12T22:17:10Z","author_association":"CONTRIBUTOR","body":"Something I found while poking around\r\n\r\nhttps://logging.apache.org/log4j/2.x/manual/appenders/network.html#HttpAppender","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2347338757/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2347907239","html_url":"https://github.com/apache/accumulo/pull/4881#issuecomment-2347907239","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4881","id":2347907239,"node_id":"IC_kwDOACaFSM6L8jin","user":{"login":"ben-manes","id":378614,"node_id":"MDQ6VXNlcjM3ODYxNA==","avatar_url":"https://avatars.githubusercontent.com/u/378614?v=4","gravatar_id":"","url":"https://api.github.com/users/ben-manes","html_url":"https://github.com/ben-manes","followers_url":"https://api.github.com/users/ben-manes/followers","following_url":"https://api.github.com/users/ben-manes/following{/other_user}","gists_url":"https://api.github.com/users/ben-manes/gists{/gist_id}","starred_url":"https://api.github.com/users/ben-manes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ben-manes/subscriptions","organizations_url":"https://api.github.com/users/ben-manes/orgs","repos_url":"https://api.github.com/users/ben-manes/repos","events_url":"https://api.github.com/users/ben-manes/events{/privacy}","received_events_url":"https://api.github.com/users/ben-manes/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-13T02:13:23Z","updated_at":"2024-09-13T02:13:23Z","author_association":"CONTRIBUTOR","body":"did your business logic rely on being LRU (keeping the most recently used)? Caffeine focuses on hit rates, so it mixes LRU / LFU / MRU behavior to maximize for the workload pattern. Thus, it might decide to immediately evict a recent arrival that would not be worthwhile keeping (e.g. a scan). It does not make promises about the eviction order, simply that it will optimize given the configuration constraints.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2347907239/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2347931311","html_url":"https://github.com/apache/accumulo/pull/4881#issuecomment-2347931311","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4881","id":2347931311,"node_id":"IC_kwDOACaFSM6L8pav","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-13T02:43:02Z","updated_at":"2024-09-13T02:43:02Z","author_association":"CONTRIBUTOR","body":"For this use case, the behavior of Caffeine should be fine. The deduplication of the log statements is a best effort attempt to reduce the amount of extra logging so I don't think it's a big deal not to be LRU and the performance gains are well worth the change. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2347931311/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2347934056","html_url":"https://github.com/apache/accumulo/pull/4881#issuecomment-2347934056","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4881","id":2347934056,"node_id":"IC_kwDOACaFSM6L8qFo","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-13T02:46:33Z","updated_at":"2024-09-13T02:46:33Z","author_association":"CONTRIBUTOR","body":"And as a follow up to my previous comment, now that I think about it, if anything because we are trying to dedupe lots of the same log message being spammed, the Caffeine algorithm is probably better than what we had before specifically because it is focused on hit rates.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2347934056/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2349324959","html_url":"https://github.com/apache/accumulo/pull/4879#issuecomment-2349324959","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4879","id":2349324959,"node_id":"IC_kwDOACaFSM6MB9qf","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-13T16:20:29Z","updated_at":"2024-09-13T16:20:29Z","author_association":"CONTRIBUTOR","body":"To take this out of draft need to understand the following about the log4j async logging:\r\n\r\n * What happens when the monitor is alive but not accepting data over http?  Will this ever cause logging to block on sever processes?\r\n * Can log4j be configured to drop log messages going to the monitor when there are too many async messages queued.\r\n * If log4j is dropping messages on the monitor appender, will that impact any other appenders?  Want to know if dropping messages on the monitor appender may also cause the local file appender to drop messages.  Does async log4j have a queue per appender or just a single queue for all appenders?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2349324959/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2349446204","html_url":"https://github.com/apache/accumulo/pull/4884#issuecomment-2349446204","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4884","id":2349446204,"node_id":"IC_kwDOACaFSM6MCbQ8","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-13T17:00:48Z","updated_at":"2024-09-13T17:23:46Z","author_association":"CONTRIBUTOR","body":"This code could be changed to use Timer, however I chose not do that and make the simplest fix possible for this because of #4885","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2349446204/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2349461097","html_url":"https://github.com/apache/accumulo/issues/4868#issuecomment-2349461097","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4868","id":2349461097,"node_id":"IC_kwDOACaFSM6MCe5p","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-13T17:04:32Z","updated_at":"2024-09-13T17:04:32Z","author_association":"MEMBER","body":"Completed by https://github.com/apache/accumulo/pull/4871","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2349461097/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2349700797","html_url":"https://github.com/apache/accumulo/issues/4860#issuecomment-2349700797","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4860","id":2349700797,"node_id":"IC_kwDOACaFSM6MDZa9","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-13T18:01:45Z","updated_at":"2024-09-13T18:01:45Z","author_association":"CONTRIBUTOR","body":"If this change is made, then the map added in #4855 can be removed.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2349700797/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2350001764","html_url":"https://github.com/apache/accumulo/issues/4883#issuecomment-2350001764","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4883","id":2350001764,"node_id":"IC_kwDOACaFSM6MEi5k","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-13T19:19:12Z","updated_at":"2024-09-13T19:19:12Z","author_association":"CONTRIBUTOR","body":"I pushed a branch up to my local repo that contains changes for this that use #4861 as a base. Can compare branches at https://github.com/dlmarion/accumulo/compare/group-in-zk-paths...dlmarion:accumulo:4883-group-in-zk-followon?expand=1.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2350001764/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2350189454","html_url":"https://github.com/apache/accumulo/issues/4839#issuecomment-2350189454","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4839","id":2350189454,"node_id":"IC_kwDOACaFSM6MFQuO","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-13T21:02:56Z","updated_at":"2024-09-13T21:02:56Z","author_association":"CONTRIBUTOR","body":"With the changes in #4861 maybe we could expand the scope of this issue a bit, not sure. Wonder if it would make sense to have shared code for creating and waiting on the lock for tablet sever, scan sever, and compactor.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2350189454/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2351088427","html_url":"https://github.com/apache/accumulo/pull/4889#issuecomment-2351088427","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4889","id":2351088427,"node_id":"IC_kwDOACaFSM6MIsMr","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-14T18:09:51Z","updated_at":"2024-09-14T18:09:51Z","author_association":"CONTRIBUTOR","body":"This bug was found by `VolumeIT.testDirtyReplaceVolumes()`.  This test currently passes in 4.0 because volume replacement was reworked in 4.0.\r\n\r\nIn 3.1 the following happens during tablet load.\r\n\r\n 1. Tablet server checks if recovery is needed\r\n 2. Tablet server does volume replacement if needed\r\n 3. Tablet server does recovery if it was needed.\r\n\r\nIn 4.0 the foillowing happens during tablet load.\r\n\r\n 1. Manager does volume replacement for a tablet if needed prior to load\r\n 2. Tablet server checks if recovery is needed\r\n 3. Tablet server does recovery if it was needed.\r\n\r\nSo these changes should be dropped when merging to 4.0 to avoid creating a maintenance burden.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2351088427/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2351109503","html_url":"https://github.com/apache/accumulo/pull/4886#issuecomment-2351109503","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4886","id":2351109503,"node_id":"IC_kwDOACaFSM6MIxV_","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-14T19:06:26Z","updated_at":"2024-09-14T19:06:26Z","author_association":"CONTRIBUTOR","body":"@DomGarguilo I went through looking for empty descriptions and filled some of them in in 9b0174a","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2351109503/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2353115626","html_url":"https://github.com/apache/accumulo/issues/3505#issuecomment-2353115626","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3505","id":2353115626,"node_id":"IC_kwDOACaFSM6MQbHq","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-16T14:38:36Z","updated_at":"2024-09-16T14:38:36Z","author_association":"MEMBER","body":"Closing as completed from https://github.com/apache/accumulo/pull/4852\r\n\r\n> Realized [MetadataConstraints](https://github.com/apache/accumulo/blob/main/server/base/src/main/java/org/apache/accumulo/server/constraints/MetadataConstraints.java) does no validation for non tablet updates. As part of this reorganization effort, could open up follow on issues for areas lacking validation after reorganizing the existing code.\r\n\r\n@keith-turner this may be still be something left to do, I'm not sure. I'm not sure which areas are lacking validation or just don't need it, so this may be better for someone else to open the issues if there are any more (since you have already opened a few follow ons noted in https://github.com/apache/accumulo/pull/4852).","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2353115626/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2353256847","html_url":"https://github.com/apache/accumulo/issues/4687#issuecomment-2353256847","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4687","id":2353256847,"node_id":"IC_kwDOACaFSM6MQ9mP","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-16T15:34:15Z","updated_at":"2024-09-16T15:34:15Z","author_association":"MEMBER","body":"Closing this as completed by https://github.com/apache/accumulo/pull/4807.\r\nEssentially just replacing this ticket with https://github.com/apache/accumulo/issues/4892 so we don't have two tickets tracking the same thing. That ticket has some added info and links to this ticket as well.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2353256847/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2353811652","html_url":"https://github.com/apache/accumulo/pull/4890#issuecomment-2353811652","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4890","id":2353811652,"node_id":"IC_kwDOACaFSM6MTFDE","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-16T20:05:28Z","updated_at":"2024-09-16T20:05:28Z","author_association":"MEMBER","body":"I think this might supersede #4742","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2353811652/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2353854102","html_url":"https://github.com/apache/accumulo/pull/4851#issuecomment-2353854102","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4851","id":2353854102,"node_id":"IC_kwDOACaFSM6MTPaW","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-16T20:14:07Z","updated_at":"2024-09-16T20:14:07Z","author_association":"CONTRIBUTOR","body":"Merged in `main` which contains #4861 . Setting this back to draft because I need to re-review the changes.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2353854102/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2354162804","html_url":"https://github.com/apache/accumulo/pull/4890#issuecomment-2354162804","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4890","id":2354162804,"node_id":"IC_kwDOACaFSM6MUax0","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-16T22:48:45Z","updated_at":"2024-09-16T23:01:18Z","author_association":"CONTRIBUTOR","body":"> I think this might supersede https://github.com/apache/accumulo/pull/4742\r\n\r\nYeah I think it does.  Looking at #4742 there was a comment about performance test.  Wrote up the following test and ran against this PR and 3.1.  Seeing  these changes run around 3 times faster than 3.1.  The code below will go through a Duration obj internally (in this PR, not in 3.1), but will not create a Duration for each call.  So these changes should provide duration objs and be much faster than what currently exists in 3.1\r\n\r\n```java\r\npublic class PerfTest {\r\n    public static void main(String[] args) {\r\n\r\n        ConfigurationCopy config = new ConfigurationCopy(DefaultConfiguration.getInstance());\r\n\r\n        var durationProps = Arrays.stream(Property.values())\r\n                .filter(property -> property.getType() == PropertyType.TIMEDURATION)\r\n                .collect(Collectors.toUnmodifiableList());\r\n\r\n        final int iterations = 100000;\r\n\r\n        for(int i = 0; i<100;i++) {\r\n            long sum = 0;\r\n            var timer = Timer.startNew();\r\n            for(int j = 0; j<iterations;j++) {\r\n                for (var prop : durationProps) {\r\n                    sum += config.getTimeInMillis(prop);\r\n                }\r\n            }\r\n            var time = timer.elapsed(TimeUnit.MICROSECONDS);\r\n            System.out.printf(\"%d %f\\n\", sum, (durationProps.size() * iterations)/(double)time);\r\n\r\n        }\r\n    }\r\n}\r\n```","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2354162804/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2355865584","html_url":"https://github.com/apache/accumulo/pull/4742#issuecomment-2355865584","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4742","id":2355865584,"node_id":"IC_kwDOACaFSM6Ma6fw","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-17T13:46:33Z","updated_at":"2024-09-17T13:46:33Z","author_association":"MEMBER","body":"Superseded by #4890 ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2355865584/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2355869526","html_url":"https://github.com/apache/accumulo/pull/4890#issuecomment-2355869526","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4890","id":2355869526,"node_id":"IC_kwDOACaFSM6Ma7dW","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-17T13:47:39Z","updated_at":"2024-09-17T13:47:39Z","author_association":"MEMBER","body":"> Seeing these changes run around 3 times faster than 3.1. The code below will go through a Duration obj internally (in this PR, not in 3.1), but will not create a Duration for each call. So these changes should provide duration objs and be much faster than what currently exists in 3.1\r\n\r\nNice!","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2355869526/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2355977929","html_url":"https://github.com/apache/accumulo/pull/4869#issuecomment-2355977929","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4869","id":2355977929,"node_id":"IC_kwDOACaFSM6MbV7J","user":{"login":"ArbaazKhan1","id":29344877,"node_id":"MDQ6VXNlcjI5MzQ0ODc3","avatar_url":"https://avatars.githubusercontent.com/u/29344877?v=4","gravatar_id":"","url":"https://api.github.com/users/ArbaazKhan1","html_url":"https://github.com/ArbaazKhan1","followers_url":"https://api.github.com/users/ArbaazKhan1/followers","following_url":"https://api.github.com/users/ArbaazKhan1/following{/other_user}","gists_url":"https://api.github.com/users/ArbaazKhan1/gists{/gist_id}","starred_url":"https://api.github.com/users/ArbaazKhan1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ArbaazKhan1/subscriptions","organizations_url":"https://api.github.com/users/ArbaazKhan1/orgs","repos_url":"https://api.github.com/users/ArbaazKhan1/repos","events_url":"https://api.github.com/users/ArbaazKhan1/events{/privacy}","received_events_url":"https://api.github.com/users/ArbaazKhan1/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-17T14:16:40Z","updated_at":"2024-09-17T14:16:40Z","author_association":"CONTRIBUTOR","body":"closes [issue #3993 ](https://github.com/apache/accumulo/issues/3993)","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2355977929/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2358655515","html_url":"https://github.com/apache/accumulo/issues/4843#issuecomment-2358655515","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4843","id":2358655515,"node_id":"IC_kwDOACaFSM6Mljob","user":{"login":"ArbaazKhan1","id":29344877,"node_id":"MDQ6VXNlcjI5MzQ0ODc3","avatar_url":"https://avatars.githubusercontent.com/u/29344877?v=4","gravatar_id":"","url":"https://api.github.com/users/ArbaazKhan1","html_url":"https://github.com/ArbaazKhan1","followers_url":"https://api.github.com/users/ArbaazKhan1/followers","following_url":"https://api.github.com/users/ArbaazKhan1/following{/other_user}","gists_url":"https://api.github.com/users/ArbaazKhan1/gists{/gist_id}","starred_url":"https://api.github.com/users/ArbaazKhan1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ArbaazKhan1/subscriptions","organizations_url":"https://api.github.com/users/ArbaazKhan1/orgs","repos_url":"https://api.github.com/users/ArbaazKhan1/repos","events_url":"https://api.github.com/users/ArbaazKhan1/events{/privacy}","received_events_url":"https://api.github.com/users/ArbaazKhan1/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-18T14:37:06Z","updated_at":"2024-09-18T14:37:06Z","author_association":"CONTRIBUTOR","body":"I can take a look at this","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2358655515/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2358804107","html_url":"https://github.com/apache/accumulo/issues/4877#issuecomment-2358804107","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4877","id":2358804107,"node_id":"IC_kwDOACaFSM6MmH6L","user":{"login":"ddanielr","id":12480877,"node_id":"MDQ6VXNlcjEyNDgwODc3","avatar_url":"https://avatars.githubusercontent.com/u/12480877?v=4","gravatar_id":"","url":"https://api.github.com/users/ddanielr","html_url":"https://github.com/ddanielr","followers_url":"https://api.github.com/users/ddanielr/followers","following_url":"https://api.github.com/users/ddanielr/following{/other_user}","gists_url":"https://api.github.com/users/ddanielr/gists{/gist_id}","starred_url":"https://api.github.com/users/ddanielr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ddanielr/subscriptions","organizations_url":"https://api.github.com/users/ddanielr/orgs","repos_url":"https://api.github.com/users/ddanielr/repos","events_url":"https://api.github.com/users/ddanielr/events{/privacy}","received_events_url":"https://api.github.com/users/ddanielr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-18T15:35:04Z","updated_at":"2024-09-18T15:35:04Z","author_association":"CONTRIBUTOR","body":"> The other aspect I'm not sure about is whether the log4j async queues are actually filling up. If so, a user might want to more agressively drop stuff from the async queues at the max log level threshold. I think by default it only drops stuff at INFO and lower. That should be a user configuration change, though, not a code change.\r\n\r\nI tested this by setting the `asyncQueueFullPolicy` to `Discard` and the `discardThreshold` to `ERROR`.\r\nhttps://logging.apache.org/log4j/2.x/manual/async.html#log4j2.asyncQueueFullPolicy\r\n\r\nThe monitor still fell over with OOM errors under a high level of log messages so I don't think the queue is filling up.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2358804107/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2358914756","html_url":"https://github.com/apache/accumulo/pull/4894#issuecomment-2358914756","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4894","id":2358914756,"node_id":"IC_kwDOACaFSM6Mmi7E","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-18T16:26:23Z","updated_at":"2024-09-18T16:26:23Z","author_association":"MEMBER","body":"> > Remove the age-off logic that was being done in the fetch() methods. It should be noted that the functionality has slightly changed. Since we just re-create a new map whenever the data is refreshed in the fetch() methods, there are no old values that need to be aged off.\r\n> \r\n> That is a nice simplification.\r\n\r\nYea definitely nice to be able to remove some code. Wasn't sure if this would be an issue though since before, the maps would contain values that would only be aged off after they were 15 minutes old. And now, since the data is recreated once every minute, all of the returned data will only ever be that old. Not too sure what the implications of this are or what the old values were being used for. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2358914756/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2358988601","html_url":"https://github.com/apache/accumulo/pull/4879#issuecomment-2358988601","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4879","id":2358988601,"node_id":"IC_kwDOACaFSM6Mm085","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-18T17:02:17Z","updated_at":"2024-09-18T17:02:17Z","author_association":"MEMBER","body":"> Something I found while poking around\r\n> \r\n> https://logging.apache.org/log4j/2.x/manual/appenders/network.html#HttpAppender\r\n\r\nI saw that one when I made the AccumuloMonitorAppender, but it seemed to be a pain to configure so it works out of the box, and may have relied on more log4j code on the server side to receive and deserialize the events, which I wanted to avoid. Still, it'd be useful to see how its implementation can answer questions about how to handle backpressure for the async stuff.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2358988601/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2359167601","html_url":"https://github.com/apache/accumulo/issues/3376#issuecomment-2359167601","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3376","id":2359167601,"node_id":"IC_kwDOACaFSM6Mngpx","user":{"login":"jmark99","id":31573345,"node_id":"MDQ6VXNlcjMxNTczMzQ1","avatar_url":"https://avatars.githubusercontent.com/u/31573345?v=4","gravatar_id":"","url":"https://api.github.com/users/jmark99","html_url":"https://github.com/jmark99","followers_url":"https://api.github.com/users/jmark99/followers","following_url":"https://api.github.com/users/jmark99/following{/other_user}","gists_url":"https://api.github.com/users/jmark99/gists{/gist_id}","starred_url":"https://api.github.com/users/jmark99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jmark99/subscriptions","organizations_url":"https://api.github.com/users/jmark99/orgs","repos_url":"https://api.github.com/users/jmark99/repos","events_url":"https://api.github.com/users/jmark99/events{/privacy}","received_events_url":"https://api.github.com/users/jmark99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-18T18:42:01Z","updated_at":"2024-09-18T18:42:01Z","author_association":"CONTRIBUTOR","body":"I ran across this ticket today. It looks like it has been addressed. The current main branch has a modified version of  `accumulo/test/functional/SplitRecoveryIT.java` and the the `accumulo/test/SplitRecovertyIT.java` class no longer exists.\r\n\r\nI'm going to close the ticket. It can be re-opened if someone thinks more work should be done.\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2359167601/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2359180390","html_url":"https://github.com/apache/accumulo/pull/4879#issuecomment-2359180390","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4879","id":2359180390,"node_id":"IC_kwDOACaFSM6Mnjxm","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-18T18:49:09Z","updated_at":"2024-09-18T18:49:09Z","author_association":"CONTRIBUTOR","body":"> Still, it'd be useful to see how its implementation can answer questions about how to handle backpressure for the async stuff.\r\n\r\nThat was something I was curious about also.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2359180390/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2359189212","html_url":"https://github.com/apache/accumulo/pull/4894#issuecomment-2359189212","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4894","id":2359189212,"node_id":"IC_kwDOACaFSM6Mnl7c","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-18T18:54:20Z","updated_at":"2024-09-18T18:54:20Z","author_association":"CONTRIBUTOR","body":">  Wasn't sure if this would be an issue though since before, the maps would contain values that would only be aged off after they were 15 minutes old.\r\n\r\nI misread that code when I was reviewing.  I thought they were aging off after 15 milliseconds, so did not think it was an issue. But its actually 15 minutes. It would be good to understand that change in behavior a bit better.  So it seems like some things used to hang around for 15 minutes in the monitor display even after they were gone?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2359189212/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2361698043","html_url":"https://github.com/apache/accumulo/pull/4524#issuecomment-2361698043","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4524","id":2361698043,"node_id":"IC_kwDOACaFSM6MxKb7","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-19T17:07:13Z","updated_at":"2024-09-19T17:07:13Z","author_association":"MEMBER","body":"@kevinrr888 -\r\n> This was an existing TODO that you had marked in your \"distributed FATE\" WIP PR:\r\n> // TODO 4131\r\n> // TODO make the max time a function of the number of concurrent callers, as the number of\r\n> // concurrent callers increases then increase the max wait time\r\n> // TODO could support signaling within this instance for known events\r\n> // TODO made the maxWait low so this would be responsive... that may put a lot of load in\r\n> // the case there are lots of things waiting...\r\n> I made the max wait = curr num callers in seconds. Does this address the first TODO? For the other two TODOs, I was not sure what was to be done, so I left them. Can these be safely deleted without creating follow on issue(s)? If follow on issues should be made, perhaps it would be best for you to write these or explain it here because I am not sure what should be done.\r\n\r\n@keith-turner -\r\n> Yeah you can delete those. I will look into it and open an issue if needed.\r\n\r\nThis may still need to be looked into just posting this as a reminder just in case","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2361698043/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2361917351","html_url":"https://github.com/apache/accumulo/pull/4879#issuecomment-2361917351","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4879","id":2361917351,"node_id":"IC_kwDOACaFSM6Mx_-n","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-19T18:43:06Z","updated_at":"2024-09-19T18:43:06Z","author_association":"CONTRIBUTOR","body":"I would look into [AsyncAppender](https://logging.apache.org/log4j/2.x/manual/appenders/delegating.html#AsyncAppender) instead of AsyncLogger.\r\n\r\nIt's a bit different but allows configuring per appender the behavior and max queue size. The async appenders just delegate to another sync appender.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2361917351/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2361957461","html_url":"https://github.com/apache/accumulo/pull/4909#issuecomment-2361957461","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4909","id":2361957461,"node_id":"IC_kwDOACaFSM6MyJxV","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-19T19:04:54Z","updated_at":"2024-09-19T19:04:54Z","author_association":"CONTRIBUTOR","body":"Notice this while researching the lock contention seen in #4910.  ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2361957461/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2362296324","html_url":"https://github.com/apache/accumulo/pull/4879#issuecomment-2362296324","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4879","id":2362296324,"node_id":"IC_kwDOACaFSM6MzcgE","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-19T22:16:14Z","updated_at":"2024-09-19T22:16:14Z","author_association":"CONTRIBUTOR","body":"> I would look into [AsyncAppender](https://logging.apache.org/log4j/2.x/manual/appenders/delegating.html#AsyncAppender) instead of AsyncLogger.\r\n\r\nI think that works nicely.  Updated config to use that and made the http request synchronous.  Need to create a block issue to update 2.1.4 release notes before closing this.  With the change to the appender, will have to change log4j config.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2362296324/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2363446543","html_url":"https://github.com/apache/accumulo/pull/4879#issuecomment-2363446543","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4879","id":2363446543,"node_id":"IC_kwDOACaFSM6M31UP","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-20T10:57:42Z","updated_at":"2024-09-20T10:57:42Z","author_association":"MEMBER","body":"@keith-turner I updated the PR based on our discussion, in addition to a few small things (bump log4j2 version and use the annotation processor to generate the metadata for the registering the appender as a log4j plugin on the classpath; those changes make this ready for log4j 3, whenever that comes).\r\n\r\nI did test the config options, and they work, and properly reconfigure the appender if the file changes. I left the defaults commented out in the config file, to make it easier for users to modify. The main thing I'm uncertain about is the stopping of the executor, and whether that works well through reconfiguration.... it should, but it might need another pair of eyes to test.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2363446543/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2363836288","html_url":"https://github.com/apache/accumulo/issues/4877#issuecomment-2363836288","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4877","id":2363836288,"node_id":"IC_kwDOACaFSM6M5UeA","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-20T14:11:38Z","updated_at":"2024-09-20T14:11:38Z","author_association":"CONTRIBUTOR","body":"Has anyone taken a heap dump to view what actual objects are in memory that are using up all the space? I usually use the Eclipse [MAT](https://eclipse.dev/mat/) to view heap dumps and see what's going on.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2363836288/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2363884856","html_url":"https://github.com/apache/accumulo/issues/4857#issuecomment-2363884856","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4857","id":2363884856,"node_id":"IC_kwDOACaFSM6M5gU4","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-20T14:35:54Z","updated_at":"2024-09-20T14:35:54Z","author_association":"CONTRIBUTOR","body":"I started to look at this now that the changes with #4852 were merged and it looks relatively straight forward. One thing I noticed, which might be better as a separate PR first because it also would affect 3.1, is the lack of validation for the directory column. I think it would be nice to add a check and new violation if that format is wrong. There is already a utility to do the validation: `ServerColumnFamily.validateDirCol()` I can work on a quick PR for that and test improvements, and another PR to use the opid in elasticity to detect splits.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2363884856/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2364050238","html_url":"https://github.com/apache/accumulo/pull/4894#issuecomment-2364050238","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4894","id":2364050238,"node_id":"IC_kwDOACaFSM6M6Is-","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-20T16:00:02Z","updated_at":"2024-09-20T16:00:02Z","author_association":"MEMBER","body":"> So it seems like some things used to hang around for 15 minutes in the monitor display even after they were gone?\r\n\r\nYea, so after looking at the code a bit more I think that the purpose of the age-off logic was to remove entries whose server was no longer present. The code that collects this data iterates through each server returned from `context.instanceOperations().getTabletServers()` and uses the HostAndPort of that server as the key in the map. So if there is new data for that server, the old data will just be replaced, but in the case where there is some data for a server and then that server dies, then it will not be replaced by anything. So after 15 mins, if the server did not come back up, those entries will be aged off. It seems like we want to keep this functionality so I'm going to work on adding this age-off functionality back.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2364050238/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2364058360","html_url":"https://github.com/apache/accumulo/pull/4879#issuecomment-2364058360","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4879","id":2364058360,"node_id":"IC_kwDOACaFSM6M6Kr4","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-20T16:04:51Z","updated_at":"2024-09-20T16:04:51Z","author_association":"CONTRIBUTOR","body":"@ctubbsii I added some stats.  In the failed attempt to use thread pool rejection handlers with the java http client I saw error messages from the thread pool that included some stats. Those were really useful since the error log messages in the appender itself are serverly rate limited, so the counts give a sense of what happened between the error messages.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2364058360/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2364614849","html_url":"https://github.com/apache/accumulo/pull/4912#issuecomment-2364614849","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4912","id":2364614849,"node_id":"IC_kwDOACaFSM6M8SjB","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-20T21:03:48Z","updated_at":"2024-09-20T21:03:48Z","author_association":"CONTRIBUTOR","body":"> With the increased time of the dead reservation cleanup, testDeadReservationsCleanup() now takes a lot longer (6 mins for me locally). Will this be an issue when the test runs on Jenkins?\r\n\r\nTo improve the test time could use a strategy similar to FlakyFateManager and a test like ComprehensiveFlakyFateIT.  So could create a FastFateCleanupManager that creates fate with a much lower cycle time and then have the test use that manager class.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2364614849/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2364662287","html_url":"https://github.com/apache/accumulo/pull/4894#issuecomment-2364662287","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4894","id":2364662287,"node_id":"IC_kwDOACaFSM6M8eIP","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-20T21:48:28Z","updated_at":"2024-09-20T21:48:28Z","author_association":"CONTRIBUTOR","body":"@DomGarguilo for these these dead servers that hang around in the monitor for 15mins, do you know if their last contact time continues to increase in monitor display? ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2364662287/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2364754350","html_url":"https://github.com/apache/accumulo/pull/4879#issuecomment-2364754350","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4879","id":2364754350,"node_id":"IC_kwDOACaFSM6M80mu","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-20T23:39:48Z","updated_at":"2024-09-20T23:39:48Z","author_association":"CONTRIBUTOR","body":"Ran the following code in jshell with the latest changes\r\n\r\n```java\r\n        client.tableOperations().create(\"foo\");\r\n        var executor = Executors.newFixedThreadPool(200);\r\n        var iteratorSetting=new IteratorSetting(10,\"not\",\"not\");\r\n        var scanner = client.createScanner(\"foo\");\r\n        scanner.addScanIterator(iteratorSetting);\r\n        for(int i =0;i<3000000;i++) {\r\n            executor.submit(()->scanner.stream().count());\r\n        }\r\n```\r\n\r\nand saw the following in the logs.\r\n\r\n\r\n```\r\n$ grep \"Unable to send\" tserver_localhost.err\r\n2024-09-20T22:11:42.811651738Z Log4j2-TF-1-AsyncLogger[AsyncContext@2cdf8d8a]-1 ERROR Unable to send HTTP in appender [MonitorLog]. No monitor is running. discards:1 errors:0 appends:1\r\n2024-09-20T22:16:11.994583280Z Log4j2-TF-1-AsyncLogger[AsyncContext@2cdf8d8a]-1 ERROR Unable to send HTTP in appender [MonitorLog]. Queue full. discards:2 errors:0 appends:855\r\n2024-09-20T22:16:11.995339569Z Log4j2-TF-1-AsyncLogger[AsyncContext@2cdf8d8a]-1 ERROR Unable to send HTTP in appender [MonitorLog]. Queue full. discards:3 errors:0 appends:856\r\n2024-09-20T22:16:11.997571913Z Log4j2-TF-1-AsyncLogger[AsyncContext@2cdf8d8a]-1 ERROR Unable to send HTTP in appender [MonitorLog]. Queue full. discards:4 errors:0 appends:858\r\n2024-09-20T22:24:48.316727314Z Log4j2-TF-1-AsyncLogger[AsyncContext@2cdf8d8a]-1 ERROR Unable to send HTTP in appender [MonitorLog]. Queue full. discards:3031 errors:0 appends:3002691\r\n2024-09-20T22:47:39.418922814Z Log4j2-TF-1-AsyncLogger[AsyncContext@2cdf8d8a]-1 ERROR Unable to send HTTP in appender [MonitorLog]. Queue full. discards:4104 errors:0 appends:9002670\r\n```\r\n\r\nNoticed a lot of tcp connections to the monitor while this was running, around 1200","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2364754350/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2365151923","html_url":"https://github.com/apache/accumulo/issues/4857#issuecomment-2365151923","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4857","id":2365151923,"node_id":"IC_kwDOACaFSM6M-Vqz","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-21T11:22:55Z","updated_at":"2024-09-21T11:28:12Z","author_association":"CONTRIBUTOR","body":"I'm going to open up a PR just for main for now for the extra directory column validation check for two reasons. \r\n\r\n1. The violation codes have diverged between [3.1](https://github.com/apache/accumulo/blob/2e63b7140d04fee881f429e674db0f96df4c6183/server/base/src/main/java/org/apache/accumulo/server/constraints/MetadataConstraints.java#L239) vs [main](https://github.com/apache/accumulo/blob/f47f835c0be746bc32a52516fb0e89624574497c/server/base/src/main/java/org/apache/accumulo/server/constraints/MetadataConstraints.java#L267). In 3.1 there are only 10 violation codes and we have 16 in main. If we want to add a new violation code to 3.1 for the directory check, we either have to make it number 11 and then go try and change codes 11-16 in main (which may be error prone to try and find all the spots), or we would need to just make it code 17 in 3.1 ad skip 11 through 16. I am not sure which is best because skipping the numbers is a lot easier but a bit weird to have missing codes.\r\n2. I don't think the changes in 3.1 would merge forward cleanly anyways. The metadata constraints code has diverged a bit with the changes in elasticity so it's likely there would just be merge conflicts anyways in both the metadata constraints class and the test for it so I think it would probably be simpler to anyways to just backport the change and merge forward an empty commit if we decide it is worthwhile to do that. (and figure out how to handle the error code)","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2365151923/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2365263745","html_url":"https://github.com/apache/accumulo/issues/4857#issuecomment-2365263745","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4857","id":2365263745,"node_id":"IC_kwDOACaFSM6M-w-B","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-21T17:35:31Z","updated_at":"2024-09-21T17:35:31Z","author_association":"CONTRIBUTOR","body":"For new error codes added in 3.1 we could start those at 310 or 3100 and new error codes added in 4.0 could start at 400 or 4000.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2365263745/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2365265066","html_url":"https://github.com/apache/accumulo/pull/4913#issuecomment-2365265066","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4913","id":2365265066,"node_id":"IC_kwDOACaFSM6M-xSq","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-21T17:40:55Z","updated_at":"2024-09-21T17:41:53Z","author_association":"CONTRIBUTOR","body":"I went ahead and backported to 3.1 and kept the number as 17 for the error code. I talked to @keith-turner and I'm going to open an issue to refactor the error codes for validation and have the new error codes that only apply to main (elasticity) start at a higher number such as 100 or 300, etc so we have a cap for future errors that apply to 3.1 and 4.0 and don't run into this issue again.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2365265066/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2368751945","html_url":"https://github.com/apache/accumulo/pull/4912#issuecomment-2368751945","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4912","id":2368751945,"node_id":"IC_kwDOACaFSM6NMElJ","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-23T16:12:33Z","updated_at":"2024-09-23T16:12:33Z","author_association":"MEMBER","body":"> To improve the test time could use a strategy similar to FlakyFateManager and a test like ComprehensiveFlakyFateIT. So could create a FastFateCleanupManager that creates fate with a much lower cycle time and then have the test use that manager class.\r\n\r\nYeah good idea. I created `FastFate` in 9599bd87d02a58413080cc1b241a6285857d2778","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2368751945/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2368826603","html_url":"https://github.com/apache/accumulo/pull/4920#issuecomment-2368826603","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4920","id":2368826603,"node_id":"IC_kwDOACaFSM6NMWzr","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-23T16:46:41Z","updated_at":"2024-09-23T16:46:41Z","author_association":"CONTRIBUTOR","body":"Opened this based on a conversation w/ @cshannon about 4.0 testing.  If we do all future testing with TinyLfu and it seems to work well and have no problems, then the lru cache code could eventually be dropped.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2368826603/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2368873842","html_url":"https://github.com/apache/accumulo/pull/4920#issuecomment-2368873842","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4920","id":2368873842,"node_id":"IC_kwDOACaFSM6NMiVy","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-23T17:06:13Z","updated_at":"2024-09-23T17:06:13Z","author_association":"CONTRIBUTOR","body":"Ran `mvn verify -Psunny` successfully with these changes.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2368873842/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2368906449","html_url":"https://github.com/apache/accumulo/pull/4920#issuecomment-2368906449","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4920","id":2368906449,"node_id":"IC_kwDOACaFSM6NMqTR","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-23T17:22:01Z","updated_at":"2024-09-23T17:22:01Z","author_association":"CONTRIBUTOR","body":"> Should we set the forRemoval flag to be true in the deprecated annotation? I guess if that's the case we'd be expected to remove it for sure from 4.0 so maybe we leave it as is and be more conservative.\r\n\r\nforRemoval has subtle problems and there was a PR that outlined those problems and removed its partial use in the code, but not sure what the PR number is.  For this particular code its unlikely users reference it any other way than configuring it, so that leaves the log message as the primary way of notifying the user of it deprecation.  I mainly added the deprecation annotation to avoid new direct uses in the accumulo code base.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2368906449/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2369012988","html_url":"https://github.com/apache/accumulo/pull/4894#issuecomment-2369012988","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4894","id":2369012988,"node_id":"IC_kwDOACaFSM6NNET8","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-23T18:08:44Z","updated_at":"2024-09-23T18:18:09Z","author_association":"MEMBER","body":"> @DomGarguilo for these these dead servers that hang around in the monitor for 15mins, do you know if their last contact time continues to increase in monitor display?\r\n\r\nOkay so i was a bit mistaken. The info for servers that have dies did stick around in the map and then it depends on what the calling code does with it. For example, `ScansResource` sets up the rest endpoint for scans and it filters the data to only return scans from tservers that are alive, where as for scan server scans, it will return all of the data in the map. This means that if a scan server dies, as long as the 15 min age-off window has not passed, scans that were running on that scan server will still be displayed. This is just one example of how this potentially stale data is used in the monitor. I am taking a look at the other usages of this data that is kept around. I am not sure why we want to keep this data around on the monitor for scan servers but not for tservers.\r\n\r\nEdit:\r\n\r\nI am also seeing this scenario where I start a script that scans a table on a running scan server, then once that scan appears on the active scans page in the monitor, I kill the scan server and eventually it looks like that scan from the script starts running on the tserver. At that point the active scans page shows two active scans, one on the dead scan server and that same scan on a tserver. This seems like a bug to me.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2369012988/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2369048752","html_url":"https://github.com/apache/accumulo/pull/4894#issuecomment-2369048752","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4894","id":2369048752,"node_id":"IC_kwDOACaFSM6NNNCw","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-23T18:25:23Z","updated_at":"2024-09-23T18:25:23Z","author_association":"MEMBER","body":"Regarding my previous comment:\r\n\r\nI looked into the other spots where data was being pulled from these maps in the `Monitor` code (tserverScans, sserverScans, and allCompactions). Unless I am missing something, the only one that seems to use this stale data before it is aged off is the scan servers scenario outlined above. This leads me to believe that we might not need to keep this age off functionality unless it is deemed necessary for the scan server scans info.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2369048752/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2369307209","html_url":"https://github.com/apache/accumulo/pull/4912#issuecomment-2369307209","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4912","id":2369307209,"node_id":"IC_kwDOACaFSM6NOMJJ","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-23T20:25:06Z","updated_at":"2024-09-23T20:25:24Z","author_association":"MEMBER","body":"@keith-turner just 30-40 seconds","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2369307209/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2372216252","html_url":"https://github.com/apache/accumulo/issues/4870#issuecomment-2372216252","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4870","id":2372216252,"node_id":"IC_kwDOACaFSM6NZSW8","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-24T19:36:50Z","updated_at":"2024-09-24T19:36:50Z","author_association":"MEMBER","body":"I'm working on a new PR for elasticity which will close this ticket.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2372216252/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2372329360","html_url":"https://github.com/apache/accumulo/pull/4924#issuecomment-2372329360","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4924","id":2372329360,"node_id":"IC_kwDOACaFSM6NZt-Q","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-24T20:34:29Z","updated_at":"2024-09-24T20:34:29Z","author_association":"MEMBER","body":"Something that I noticed while working on these changes was the following:\r\nhttps://github.com/apache/accumulo/blob/88bd23ea5afd424242e95ff3963f0d898368bd5e/server/manager/src/main/java/org/apache/accumulo/manager/metrics/fate/FateMetrics.java#L114-L115\r\nI haven't looked into things too much but it seems like this code would create a new micrometer Gauge each time it is called (which ends up being once every second).","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2372329360/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2374877505","html_url":"https://github.com/apache/accumulo/pull/4925#issuecomment-2374877505","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4925","id":2374877505,"node_id":"IC_kwDOACaFSM6NjcFB","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-25T18:35:00Z","updated_at":"2024-09-27T16:23:51Z","author_association":"MEMBER","body":"While working on this PR I noticed some improvements that could be made regarding FateMetrics so opened #4894 against the 3.1 branch. That PR touches some of the code that needs to be changed for the effort being made in this PR so I'll get that merged in here before we merge this one.\r\n\r\nEdit: this has been taken care of in e583a59","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2374877505/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2374940916","html_url":"https://github.com/apache/accumulo/pull/4924#issuecomment-2374940916","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4924","id":2374940916,"node_id":"IC_kwDOACaFSM6Njrj0","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-25T19:04:21Z","updated_at":"2024-09-25T19:04:21Z","author_association":"MEMBER","body":"> Something that I noticed while working on these changes was the following:\r\n> \r\n> https://github.com/apache/accumulo/blob/88bd23ea5afd424242e95ff3963f0d898368bd5e/server/manager/src/main/java/org/apache/accumulo/manager/metrics/fate/FateMetrics.java#L114-L115\r\n> \r\n> \r\n> I haven't looked into things too much but it seems like this code would create a new micrometer Gauge each time it is called (which ends up being once every second).\r\n\r\nMade a ticket to track this potential issue.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2374940916/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2380102904","html_url":"https://github.com/apache/accumulo/pull/4900#issuecomment-2380102904","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4900","id":2380102904,"node_id":"IC_kwDOACaFSM6N3Xz4","user":{"login":"ddanielr","id":12480877,"node_id":"MDQ6VXNlcjEyNDgwODc3","avatar_url":"https://avatars.githubusercontent.com/u/12480877?v=4","gravatar_id":"","url":"https://api.github.com/users/ddanielr","html_url":"https://github.com/ddanielr","followers_url":"https://api.github.com/users/ddanielr/followers","following_url":"https://api.github.com/users/ddanielr/following{/other_user}","gists_url":"https://api.github.com/users/ddanielr/gists{/gist_id}","starred_url":"https://api.github.com/users/ddanielr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ddanielr/subscriptions","organizations_url":"https://api.github.com/users/ddanielr/orgs","repos_url":"https://api.github.com/users/ddanielr/repos","events_url":"https://api.github.com/users/ddanielr/events{/privacy}","received_events_url":"https://api.github.com/users/ddanielr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-27T21:40:21Z","updated_at":"2024-09-27T21:40:21Z","author_association":"CONTRIBUTOR","body":"I was able to remove the execute permission in the jline code and have the shell function correctly. \r\n\r\nOpened a PR to get that change merged upstream https://github.com/jline/jline3/pull/1081. \r\nClosing this for now.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2380102904/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2380166203","html_url":"https://github.com/apache/accumulo/pull/4930#issuecomment-2380166203","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4930","id":2380166203,"node_id":"IC_kwDOACaFSM6N3nQ7","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-27T22:02:21Z","updated_at":"2024-09-27T22:02:21Z","author_association":"CONTRIBUTOR","body":"Looked into how thiese changes would work with the release pluging and found the following.\r\n\r\nhttps://stackoverflow.com/a/67012045\r\nhttps://medium.com/@makhaer/replace-maven-release-plugin-with-maven-ci-friendly-1496d63de9ed\r\n\r\nThose are saying the release pluging is not needed anymore.  For the accumulo release process is the release plugin still needed?  Does the release plugin upload artifacts to the apache maven repos?\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2380166203/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2380231332","html_url":"https://github.com/apache/accumulo/pull/4930#issuecomment-2380231332","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4930","id":2380231332,"node_id":"IC_kwDOACaFSM6N33Kk","user":{"login":"ddanielr","id":12480877,"node_id":"MDQ6VXNlcjEyNDgwODc3","avatar_url":"https://avatars.githubusercontent.com/u/12480877?v=4","gravatar_id":"","url":"https://api.github.com/users/ddanielr","html_url":"https://github.com/ddanielr","followers_url":"https://api.github.com/users/ddanielr/followers","following_url":"https://api.github.com/users/ddanielr/following{/other_user}","gists_url":"https://api.github.com/users/ddanielr/gists{/gist_id}","starred_url":"https://api.github.com/users/ddanielr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ddanielr/subscriptions","organizations_url":"https://api.github.com/users/ddanielr/orgs","repos_url":"https://api.github.com/users/ddanielr/repos","events_url":"https://api.github.com/users/ddanielr/events{/privacy}","received_events_url":"https://api.github.com/users/ddanielr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-27T22:28:32Z","updated_at":"2024-09-27T22:28:32Z","author_association":"CONTRIBUTOR","body":"Built these changes locally and tested various build commands.\r\n1. `mvn package -DskipTests -DskipITs`\r\n     produced `accumulo-2.1.4-SNAPSHOT` artifacts as expected\r\n     \r\n1. `mvn -Drevision=2.1.4 -Dsha1=$(git rev-parse --short HEAD) clean install -DskipTests -DskipITs` \r\n      produced artifacts with a `2.1.451b8cad81e-SNAPSHOT` version and installed all the jars correctly into my local mvn repo.\r\n\r\nFor building a release version, an empty `-Dchangelist=` build arg will need to be supplied but from a dev perspective this makes building and testing specific artifacts much easier.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2380231332/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2380313802","html_url":"https://github.com/apache/accumulo/pull/4930#issuecomment-2380313802","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4930","id":2380313802,"node_id":"IC_kwDOACaFSM6N4LTK","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-28T00:24:58Z","updated_at":"2024-09-28T00:25:21Z","author_association":"CONTRIBUTOR","body":"> or building a release version, an empty -Dchangelist=\r\n\r\nI tried running this and the artifacts are shorter.  Adding SNAPSHOT when the hash is present does not really seem useful.\r\n\r\n```\r\nmvn clean install -PskipQA -Dsha1=\"-$(git rev-parse --short HEAD)\" -Dchangelist=\"\"\r\n```","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2380313802/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]