[{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1846888565","html_url":"https://github.com/apache/brpc/issues/2448#issuecomment-1846888565","issue_url":"https://api.github.com/repos/apache/brpc/issues/2448","id":1846888565,"node_id":"IC_kwDOBhmkcs5uFUh1","user":{"login":"tmacjay2015","id":14331445,"node_id":"MDQ6VXNlcjE0MzMxNDQ1","avatar_url":"https://avatars.githubusercontent.com/u/14331445?v=4","gravatar_id":"","url":"https://api.github.com/users/tmacjay2015","html_url":"https://github.com/tmacjay2015","followers_url":"https://api.github.com/users/tmacjay2015/followers","following_url":"https://api.github.com/users/tmacjay2015/following{/other_user}","gists_url":"https://api.github.com/users/tmacjay2015/gists{/gist_id}","starred_url":"https://api.github.com/users/tmacjay2015/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tmacjay2015/subscriptions","organizations_url":"https://api.github.com/users/tmacjay2015/orgs","repos_url":"https://api.github.com/users/tmacjay2015/repos","events_url":"https://api.github.com/users/tmacjay2015/events{/privacy}","received_events_url":"https://api.github.com/users/tmacjay2015/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-08T09:59:01Z","updated_at":"2023-12-08T09:59:01Z","author_association":"NONE","body":"> 你是指异步调用么？可以描述下使用场景\r\n\r\nrpc请求发出后 客户端不需要等待回复 （服务端也不需要回复） ","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1846888565/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1846918705","html_url":"https://github.com/apache/brpc/issues/2448#issuecomment-1846918705","issue_url":"https://api.github.com/repos/apache/brpc/issues/2448","id":1846918705,"node_id":"IC_kwDOBhmkcs5uFb4x","user":{"login":"Huixxi","id":21335093,"node_id":"MDQ6VXNlcjIxMzM1MDkz","avatar_url":"https://avatars.githubusercontent.com/u/21335093?v=4","gravatar_id":"","url":"https://api.github.com/users/Huixxi","html_url":"https://github.com/Huixxi","followers_url":"https://api.github.com/users/Huixxi/followers","following_url":"https://api.github.com/users/Huixxi/following{/other_user}","gists_url":"https://api.github.com/users/Huixxi/gists{/gist_id}","starred_url":"https://api.github.com/users/Huixxi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Huixxi/subscriptions","organizations_url":"https://api.github.com/users/Huixxi/orgs","repos_url":"https://api.github.com/users/Huixxi/repos","events_url":"https://api.github.com/users/Huixxi/events{/privacy}","received_events_url":"https://api.github.com/users/Huixxi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-08T10:22:01Z","updated_at":"2023-12-08T10:22:01Z","author_association":"CONTRIBUTOR","body":"> > 你是指异步调用么？可以描述下使用场景\r\n> \r\n> rpc请求发出后 客户端不需要等待回复 （服务端也不需要回复）\r\n\r\n看下bRPC异步调用的文档，传一个回调函数 Done，我理解就可以满足你这种使用场景","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1846918705/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1848952485","html_url":"https://github.com/apache/brpc/pull/2251#issuecomment-1848952485","issue_url":"https://api.github.com/repos/apache/brpc/issues/2251","id":1848952485,"node_id":"IC_kwDOBhmkcs5uNMal","user":{"login":"Menci","id":11341955,"node_id":"MDQ6VXNlcjExMzQxOTU1","avatar_url":"https://avatars.githubusercontent.com/u/11341955?v=4","gravatar_id":"","url":"https://api.github.com/users/Menci","html_url":"https://github.com/Menci","followers_url":"https://api.github.com/users/Menci/followers","following_url":"https://api.github.com/users/Menci/following{/other_user}","gists_url":"https://api.github.com/users/Menci/gists{/gist_id}","starred_url":"https://api.github.com/users/Menci/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Menci/subscriptions","organizations_url":"https://api.github.com/users/Menci/orgs","repos_url":"https://api.github.com/users/Menci/repos","events_url":"https://api.github.com/users/Menci/events{/privacy}","received_events_url":"https://api.github.com/users/Menci/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-10T12:34:05Z","updated_at":"2023-12-10T12:34:05Z","author_association":"CONTRIBUTOR","body":"@wwbmmm resolved 了 conflict，添加了文档~\r\n\r\n看到 server side 的 ALPN 已经进了，思考了一下没有和它一样用 AdaptiveProtocolType，因为 client 端并不知道目标的服务器端是什么，所以就不做相关的检查了。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1848952485/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1849848011","html_url":"https://github.com/apache/brpc/pull/2358#issuecomment-1849848011","issue_url":"https://api.github.com/repos/apache/brpc/issues/2358","id":1849848011,"node_id":"IC_kwDOBhmkcs5uQnDL","user":{"login":"justmao945","id":619331,"node_id":"MDQ6VXNlcjYxOTMzMQ==","avatar_url":"https://avatars.githubusercontent.com/u/619331?v=4","gravatar_id":"","url":"https://api.github.com/users/justmao945","html_url":"https://github.com/justmao945","followers_url":"https://api.github.com/users/justmao945/followers","following_url":"https://api.github.com/users/justmao945/following{/other_user}","gists_url":"https://api.github.com/users/justmao945/gists{/gist_id}","starred_url":"https://api.github.com/users/justmao945/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/justmao945/subscriptions","organizations_url":"https://api.github.com/users/justmao945/orgs","repos_url":"https://api.github.com/users/justmao945/repos","events_url":"https://api.github.com/users/justmao945/events{/privacy}","received_events_url":"https://api.github.com/users/justmao945/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-11T11:06:59Z","updated_at":"2023-12-11T11:06:59Z","author_association":"NONE","body":"大佬们这个现在有啥合并 master 的计划吗？有了 tag 也好支持 NUMA 分组了，不然大机型搞起来还有点费劲","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1849848011/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1850082804","html_url":"https://github.com/apache/brpc/pull/2256#issuecomment-1850082804","issue_url":"https://api.github.com/repos/apache/brpc/issues/2256","id":1850082804,"node_id":"IC_kwDOBhmkcs5uRgX0","user":{"login":"zhoukangsheng","id":53427718,"node_id":"MDQ6VXNlcjUzNDI3NzE4","avatar_url":"https://avatars.githubusercontent.com/u/53427718?v=4","gravatar_id":"","url":"https://api.github.com/users/zhoukangsheng","html_url":"https://github.com/zhoukangsheng","followers_url":"https://api.github.com/users/zhoukangsheng/followers","following_url":"https://api.github.com/users/zhoukangsheng/following{/other_user}","gists_url":"https://api.github.com/users/zhoukangsheng/gists{/gist_id}","starred_url":"https://api.github.com/users/zhoukangsheng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhoukangsheng/subscriptions","organizations_url":"https://api.github.com/users/zhoukangsheng/orgs","repos_url":"https://api.github.com/users/zhoukangsheng/repos","events_url":"https://api.github.com/users/zhoukangsheng/events{/privacy}","received_events_url":"https://api.github.com/users/zhoukangsheng/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-11T13:29:55Z","updated_at":"2023-12-11T13:29:55Z","author_association":"NONE","body":"> @smbzhang 欢迎加入开发者群，一起探讨 brpc 相关的问题。\r\n\r\n求一个开发者群号","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1850082804/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1850986734","html_url":"https://github.com/apache/brpc/pull/2358#issuecomment-1850986734","issue_url":"https://api.github.com/repos/apache/brpc/issues/2358","id":1850986734,"node_id":"IC_kwDOBhmkcs5uU9Du","user":{"login":"yanglimingcn","id":7091130,"node_id":"MDQ6VXNlcjcwOTExMzA=","avatar_url":"https://avatars.githubusercontent.com/u/7091130?v=4","gravatar_id":"","url":"https://api.github.com/users/yanglimingcn","html_url":"https://github.com/yanglimingcn","followers_url":"https://api.github.com/users/yanglimingcn/followers","following_url":"https://api.github.com/users/yanglimingcn/following{/other_user}","gists_url":"https://api.github.com/users/yanglimingcn/gists{/gist_id}","starred_url":"https://api.github.com/users/yanglimingcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yanglimingcn/subscriptions","organizations_url":"https://api.github.com/users/yanglimingcn/orgs","repos_url":"https://api.github.com/users/yanglimingcn/repos","events_url":"https://api.github.com/users/yanglimingcn/events{/privacy}","received_events_url":"https://api.github.com/users/yanglimingcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-11T22:22:33Z","updated_at":"2023-12-11T22:23:00Z","author_association":"CONTRIBUTOR","body":"> 大佬们这个现在有啥合并 master 的计划吗？有了 tag 也好支持 NUMA 分组了，不然大机型搞起来还有点费劲\r\n\r\n@wwbmmm 再review评估一下吧，看起来有需求的用户还挺多的。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1850986734/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1851223311","html_url":"https://github.com/apache/brpc/issues/2448#issuecomment-1851223311","issue_url":"https://api.github.com/repos/apache/brpc/issues/2448","id":1851223311,"node_id":"IC_kwDOBhmkcs5uV20P","user":{"login":"jiangdongzi","id":17529657,"node_id":"MDQ6VXNlcjE3NTI5NjU3","avatar_url":"https://avatars.githubusercontent.com/u/17529657?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangdongzi","html_url":"https://github.com/jiangdongzi","followers_url":"https://api.github.com/users/jiangdongzi/followers","following_url":"https://api.github.com/users/jiangdongzi/following{/other_user}","gists_url":"https://api.github.com/users/jiangdongzi/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangdongzi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangdongzi/subscriptions","organizations_url":"https://api.github.com/users/jiangdongzi/orgs","repos_url":"https://api.github.com/users/jiangdongzi/repos","events_url":"https://api.github.com/users/jiangdongzi/events{/privacy}","received_events_url":"https://api.github.com/users/jiangdongzi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-12T02:57:24Z","updated_at":"2023-12-12T02:57:24Z","author_association":"NONE","body":"> > > 你是指异步调用么？可以描述下使用场景\r\n> > \r\n> > \r\n> > rpc请求发出后 客户端不需要等待回复 （服务端也不需要回复）\r\n> \r\n> 看下bRPC异步调用的文档，传一个回调函数 Done，我理解就可以满足你这种使用场景\r\n\r\n但是这样, 服务端还是需要回复","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1851223311/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1853376676","html_url":"https://github.com/apache/brpc/pull/1751#issuecomment-1853376676","issue_url":"https://api.github.com/repos/apache/brpc/issues/1751","id":1853376676,"node_id":"IC_kwDOBhmkcs5ueEik","user":{"login":"MrGuin","id":26199910,"node_id":"MDQ6VXNlcjI2MTk5OTEw","avatar_url":"https://avatars.githubusercontent.com/u/26199910?v=4","gravatar_id":"","url":"https://api.github.com/users/MrGuin","html_url":"https://github.com/MrGuin","followers_url":"https://api.github.com/users/MrGuin/followers","following_url":"https://api.github.com/users/MrGuin/following{/other_user}","gists_url":"https://api.github.com/users/MrGuin/gists{/gist_id}","starred_url":"https://api.github.com/users/MrGuin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MrGuin/subscriptions","organizations_url":"https://api.github.com/users/MrGuin/orgs","repos_url":"https://api.github.com/users/MrGuin/repos","events_url":"https://api.github.com/users/MrGuin/events{/privacy}","received_events_url":"https://api.github.com/users/MrGuin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-13T07:09:47Z","updated_at":"2023-12-13T07:09:47Z","author_association":"CONTRIBUTOR","body":"> nosched参数是不是可以去掉了，如果nosignal是true，就不要调用exchange，而是调用ready_to_run 另外，我觉得exchange里面的nosignal=true会有问题，因为当前协程切出去了，再次回来需要一个flush，这个flush不知道谁去执行。这和其它地方的nosignal不一样，其它地方都是本协程唤醒其它协程，最后执行一次flush\r\n\r\nno_signal 为 true，不调用 exchange，ready_to_run* 会传递 no_signal 参数，被唤醒的 bthread 不就无法被及时调度了吗？\r\n我们有同样的场景，不希望当前执行 butex_wake 的 bthread 被 exchange 转去执行被唤醒的 bthread，所以使用了这个 feature，现在观察到被唤醒的 bthread 从唤醒到被调度执行会有上百毫秒的延迟，因为现在的实现 no_signal 传递给了 ready_to_run*，导致无法被及时调度处理。\r\n","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1853376676/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1853427709","html_url":"https://github.com/apache/brpc/pull/1751#issuecomment-1853427709","issue_url":"https://api.github.com/repos/apache/brpc/issues/1751","id":1853427709,"node_id":"IC_kwDOBhmkcs5ueQ_9","user":{"login":"MrGuin","id":26199910,"node_id":"MDQ6VXNlcjI2MTk5OTEw","avatar_url":"https://avatars.githubusercontent.com/u/26199910?v=4","gravatar_id":"","url":"https://api.github.com/users/MrGuin","html_url":"https://github.com/MrGuin","followers_url":"https://api.github.com/users/MrGuin/followers","following_url":"https://api.github.com/users/MrGuin/following{/other_user}","gists_url":"https://api.github.com/users/MrGuin/gists{/gist_id}","starred_url":"https://api.github.com/users/MrGuin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MrGuin/subscriptions","organizations_url":"https://api.github.com/users/MrGuin/orgs","repos_url":"https://api.github.com/users/MrGuin/repos","events_url":"https://api.github.com/users/MrGuin/events{/privacy}","received_events_url":"https://api.github.com/users/MrGuin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-13T07:57:06Z","updated_at":"2023-12-13T07:57:06Z","author_association":"CONTRIBUTOR","body":"现在我这里每次 butex_wake 后主动调 bthread_flush 解决了不能及时调度的问题。\r\n我看了下上下文，感觉当前的 no_signal 的实现针对场景是消费者 bthread 批量 butex_wake，然后再一次 bthread_flush，no_signal 参数不希望被调度，顺带也不会把当前 bthread 给 exchange 过去。但如果消费者无法批量去 butex_wake 最后统一 flush 的话，就只能传 no_signal 参数然后手动去 bthread_flush 了。\r\n比如我们是 braft 状态机 on_apply 线程，每次修改状态机然后唤醒等待在 butex 上的 RPC线程，因为每个 raft group 的 on_apply 是严格串行的，是性能瓶颈，所以我们不希望它在唤醒别人的时候被切走，所以传了 no_signal，但被唤醒的 RPC bthread 也是要及时调度执行的，不然会影响 RPC 服务的 responsiveness。如果只是要达到不让当前调用 butex_wake 的线程被 exchange 走的效果，只能 no_signal 然后 bthread_flush，感觉不够优雅。\r\n@wwbmmm 佬怎么看呢？","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1853427709/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1853485155","html_url":"https://github.com/apache/brpc/pull/2358#issuecomment-1853485155","issue_url":"https://api.github.com/repos/apache/brpc/issues/2358","id":1853485155,"node_id":"IC_kwDOBhmkcs5uefBj","user":{"login":"vinllen","id":6987398,"node_id":"MDQ6VXNlcjY5ODczOTg=","avatar_url":"https://avatars.githubusercontent.com/u/6987398?v=4","gravatar_id":"","url":"https://api.github.com/users/vinllen","html_url":"https://github.com/vinllen","followers_url":"https://api.github.com/users/vinllen/followers","following_url":"https://api.github.com/users/vinllen/following{/other_user}","gists_url":"https://api.github.com/users/vinllen/gists{/gist_id}","starred_url":"https://api.github.com/users/vinllen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinllen/subscriptions","organizations_url":"https://api.github.com/users/vinllen/orgs","repos_url":"https://api.github.com/users/vinllen/repos","events_url":"https://api.github.com/users/vinllen/events{/privacy}","received_events_url":"https://api.github.com/users/vinllen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-13T08:40:32Z","updated_at":"2023-12-13T08:40:32Z","author_association":"NONE","body":"坐等合入","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1853485155/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1853514284","html_url":"https://github.com/apache/brpc/pull/2358#issuecomment-1853514284","issue_url":"https://api.github.com/repos/apache/brpc/issues/2358","id":1853514284,"node_id":"IC_kwDOBhmkcs5uemIs","user":{"login":"huntinux","id":6072626,"node_id":"MDQ6VXNlcjYwNzI2MjY=","avatar_url":"https://avatars.githubusercontent.com/u/6072626?v=4","gravatar_id":"","url":"https://api.github.com/users/huntinux","html_url":"https://github.com/huntinux","followers_url":"https://api.github.com/users/huntinux/followers","following_url":"https://api.github.com/users/huntinux/following{/other_user}","gists_url":"https://api.github.com/users/huntinux/gists{/gist_id}","starred_url":"https://api.github.com/users/huntinux/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huntinux/subscriptions","organizations_url":"https://api.github.com/users/huntinux/orgs","repos_url":"https://api.github.com/users/huntinux/repos","events_url":"https://api.github.com/users/huntinux/events{/privacy}","received_events_url":"https://api.github.com/users/huntinux/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-13T09:01:07Z","updated_at":"2023-12-13T09:01:07Z","author_association":"NONE","body":"> 大佬们这个现在有啥合并 master 的计划吗？有了 tag 也好支持 NUMA 分组了，不然大机型搞起来还有点费劲\r\n\r\n@justmao945 @yanglimingcn @wwbmmm 我请教个小问题，大机型下，如果划分容器时直接绑定numa，这样就没有 remote access 了。在软件层面实现 numa aware 似乎只能逼近这个状态。所以为什么不直接用容器绑定numa？是因为内存的限制吗？还是因为有些场景不能接受使用容器，必须要用物理整机？","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1853514284/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1853561314","html_url":"https://github.com/apache/brpc/issues/1241#issuecomment-1853561314","issue_url":"https://api.github.com/repos/apache/brpc/issues/1241","id":1853561314,"node_id":"IC_kwDOBhmkcs5uexni","user":{"login":"limindlmu","id":24813528,"node_id":"MDQ6VXNlcjI0ODEzNTI4","avatar_url":"https://avatars.githubusercontent.com/u/24813528?v=4","gravatar_id":"","url":"https://api.github.com/users/limindlmu","html_url":"https://github.com/limindlmu","followers_url":"https://api.github.com/users/limindlmu/followers","following_url":"https://api.github.com/users/limindlmu/following{/other_user}","gists_url":"https://api.github.com/users/limindlmu/gists{/gist_id}","starred_url":"https://api.github.com/users/limindlmu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/limindlmu/subscriptions","organizations_url":"https://api.github.com/users/limindlmu/orgs","repos_url":"https://api.github.com/users/limindlmu/repos","events_url":"https://api.github.com/users/limindlmu/events{/privacy}","received_events_url":"https://api.github.com/users/limindlmu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-13T09:31:08Z","updated_at":"2023-12-13T09:31:08Z","author_association":"NONE","body":"@gydong vx：cflimi ，求拉社区交流群","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1853561314/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1854656746","html_url":"https://github.com/apache/brpc/issues/1209#issuecomment-1854656746","issue_url":"https://api.github.com/repos/apache/brpc/issues/1209","id":1854656746,"node_id":"IC_kwDOBhmkcs5ui9Dq","user":{"login":"Divyansh200102","id":146909065,"node_id":"U_kgDOCMGniQ","avatar_url":"https://avatars.githubusercontent.com/u/146909065?v=4","gravatar_id":"","url":"https://api.github.com/users/Divyansh200102","html_url":"https://github.com/Divyansh200102","followers_url":"https://api.github.com/users/Divyansh200102/followers","following_url":"https://api.github.com/users/Divyansh200102/following{/other_user}","gists_url":"https://api.github.com/users/Divyansh200102/gists{/gist_id}","starred_url":"https://api.github.com/users/Divyansh200102/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Divyansh200102/subscriptions","organizations_url":"https://api.github.com/users/Divyansh200102/orgs","repos_url":"https://api.github.com/users/Divyansh200102/repos","events_url":"https://api.github.com/users/Divyansh200102/events{/privacy}","received_events_url":"https://api.github.com/users/Divyansh200102/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-13T20:29:15Z","updated_at":"2023-12-13T20:29:15Z","author_association":"CONTRIBUTOR","body":"Can anyone review the pr? @zyearn ","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1854656746/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1854982265","html_url":"https://github.com/apache/brpc/pull/2358#issuecomment-1854982265","issue_url":"https://api.github.com/repos/apache/brpc/issues/2358","id":1854982265,"node_id":"IC_kwDOBhmkcs5ukMh5","user":{"login":"yanglimingcn","id":7091130,"node_id":"MDQ6VXNlcjcwOTExMzA=","avatar_url":"https://avatars.githubusercontent.com/u/7091130?v=4","gravatar_id":"","url":"https://api.github.com/users/yanglimingcn","html_url":"https://github.com/yanglimingcn","followers_url":"https://api.github.com/users/yanglimingcn/followers","following_url":"https://api.github.com/users/yanglimingcn/following{/other_user}","gists_url":"https://api.github.com/users/yanglimingcn/gists{/gist_id}","starred_url":"https://api.github.com/users/yanglimingcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yanglimingcn/subscriptions","organizations_url":"https://api.github.com/users/yanglimingcn/orgs","repos_url":"https://api.github.com/users/yanglimingcn/repos","events_url":"https://api.github.com/users/yanglimingcn/events{/privacy}","received_events_url":"https://api.github.com/users/yanglimingcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-14T01:51:27Z","updated_at":"2023-12-14T01:51:27Z","author_association":"CONTRIBUTOR","body":"> > 大佬们这个现在有啥合并 master 的计划吗？有了 tag 也好支持 NUMA 分组了，不然大机型搞起来还有点费劲\r\n> \r\n> @justmao945 @yanglimingcn @wwbmmm 我请教个小问题，大机型下，如果划分容器时直接绑定numa，这样就没有 remote access 了。在软件层面实现 numa aware 似乎只能逼近这个状态。所以为什么不直接用容器绑定numa？是因为内存的限制吗？还是因为有些场景不能接受使用容器，必须要用物理整机？\r\n\r\n的确有些场景不能或者不方便使用容器，我所接触的，比如，一些使用了dpdk、spdk、rdma等等这些对性能要求比较极致的应用，都绕过了内核，相当于自己直接管理硬件了。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1854982265/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1855094311","html_url":"https://github.com/apache/brpc/issues/1894#issuecomment-1855094311","issue_url":"https://api.github.com/repos/apache/brpc/issues/1894","id":1855094311,"node_id":"IC_kwDOBhmkcs5ukn4n","user":{"login":"Divyansh200102","id":146909065,"node_id":"U_kgDOCMGniQ","avatar_url":"https://avatars.githubusercontent.com/u/146909065?v=4","gravatar_id":"","url":"https://api.github.com/users/Divyansh200102","html_url":"https://github.com/Divyansh200102","followers_url":"https://api.github.com/users/Divyansh200102/followers","following_url":"https://api.github.com/users/Divyansh200102/following{/other_user}","gists_url":"https://api.github.com/users/Divyansh200102/gists{/gist_id}","starred_url":"https://api.github.com/users/Divyansh200102/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Divyansh200102/subscriptions","organizations_url":"https://api.github.com/users/Divyansh200102/orgs","repos_url":"https://api.github.com/users/Divyansh200102/repos","events_url":"https://api.github.com/users/Divyansh200102/events{/privacy}","received_events_url":"https://api.github.com/users/Divyansh200102/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-14T04:04:57Z","updated_at":"2023-12-14T04:04:57Z","author_association":"CONTRIBUTOR","body":"Please review this pr as well @zyearn ","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1855094311/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1857199286","html_url":"https://github.com/apache/brpc/pull/2358#issuecomment-1857199286","issue_url":"https://api.github.com/repos/apache/brpc/issues/2358","id":1857199286,"node_id":"IC_kwDOBhmkcs5uspy2","user":{"login":"justmao945","id":619331,"node_id":"MDQ6VXNlcjYxOTMzMQ==","avatar_url":"https://avatars.githubusercontent.com/u/619331?v=4","gravatar_id":"","url":"https://api.github.com/users/justmao945","html_url":"https://github.com/justmao945","followers_url":"https://api.github.com/users/justmao945/followers","following_url":"https://api.github.com/users/justmao945/following{/other_user}","gists_url":"https://api.github.com/users/justmao945/gists{/gist_id}","starred_url":"https://api.github.com/users/justmao945/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/justmao945/subscriptions","organizations_url":"https://api.github.com/users/justmao945/orgs","repos_url":"https://api.github.com/users/justmao945/repos","events_url":"https://api.github.com/users/justmao945/events{/privacy}","received_events_url":"https://api.github.com/users/justmao945/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-15T03:08:42Z","updated_at":"2023-12-15T03:08:42Z","author_association":"NONE","body":"> > 大佬们这个现在有啥合并 master 的计划吗？有了 tag 也好支持 NUMA 分组了，不然大机型搞起来还有点费劲\r\n> \r\n> @justmao945 @yanglimingcn @wwbmmm 我请教个小问题，大机型下，如果划分容器时直接绑定numa，这样就没有 remote access 了。在软件层面实现 numa aware 似乎只能逼近这个状态。所以为什么不直接用容器绑定numa？是因为内存的限制吗？还是因为有些场景不能接受使用容器，必须要用物理整机？\r\n\r\n大内存应用 😢 ","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1857199286/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1857794710","html_url":"https://github.com/apache/brpc/issues/2470#issuecomment-1857794710","issue_url":"https://api.github.com/repos/apache/brpc/issues/2470","id":1857794710,"node_id":"IC_kwDOBhmkcs5uu7KW","user":{"login":"lorinlee","id":16054841,"node_id":"MDQ6VXNlcjE2MDU0ODQx","avatar_url":"https://avatars.githubusercontent.com/u/16054841?v=4","gravatar_id":"","url":"https://api.github.com/users/lorinlee","html_url":"https://github.com/lorinlee","followers_url":"https://api.github.com/users/lorinlee/followers","following_url":"https://api.github.com/users/lorinlee/following{/other_user}","gists_url":"https://api.github.com/users/lorinlee/gists{/gist_id}","starred_url":"https://api.github.com/users/lorinlee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lorinlee/subscriptions","organizations_url":"https://api.github.com/users/lorinlee/orgs","repos_url":"https://api.github.com/users/lorinlee/repos","events_url":"https://api.github.com/users/lorinlee/events{/privacy}","received_events_url":"https://api.github.com/users/lorinlee/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-15T12:17:55Z","updated_at":"2023-12-15T12:17:55Z","author_association":"CONTRIBUTOR","body":"这里的内存泄漏是符合预期的，可以参考 Server::Join的注释\r\n![image](https://github.com/apache/brpc/assets/16054841/79727fc9-c018-43f4-b82d-42f0f54da42d)\r\n","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1857794710/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1858691301","html_url":"https://github.com/apache/brpc/pull/2406#issuecomment-1858691301","issue_url":"https://api.github.com/repos/apache/brpc/issues/2406","id":1858691301,"node_id":"IC_kwDOBhmkcs5uyWDl","user":{"login":"yanglimingcn","id":7091130,"node_id":"MDQ6VXNlcjcwOTExMzA=","avatar_url":"https://avatars.githubusercontent.com/u/7091130?v=4","gravatar_id":"","url":"https://api.github.com/users/yanglimingcn","html_url":"https://github.com/yanglimingcn","followers_url":"https://api.github.com/users/yanglimingcn/followers","following_url":"https://api.github.com/users/yanglimingcn/following{/other_user}","gists_url":"https://api.github.com/users/yanglimingcn/gists{/gist_id}","starred_url":"https://api.github.com/users/yanglimingcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yanglimingcn/subscriptions","organizations_url":"https://api.github.com/users/yanglimingcn/orgs","repos_url":"https://api.github.com/users/yanglimingcn/repos","events_url":"https://api.github.com/users/yanglimingcn/events{/privacy}","received_events_url":"https://api.github.com/users/yanglimingcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-16T02:51:30Z","updated_at":"2023-12-16T02:51:30Z","author_association":"CONTRIBUTOR","body":"现在baidu_std协议如果请求处理失败了，应答包就不会pack用户的response了，这个pr是不是可以做到在请求处理失败，也可以设置应答属性字段。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1858691301/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1858706386","html_url":"https://github.com/apache/brpc/issues/1010#issuecomment-1858706386","issue_url":"https://api.github.com/repos/apache/brpc/issues/1010","id":1858706386,"node_id":"IC_kwDOBhmkcs5uyZvS","user":{"login":"yanglimingcn","id":7091130,"node_id":"MDQ6VXNlcjcwOTExMzA=","avatar_url":"https://avatars.githubusercontent.com/u/7091130?v=4","gravatar_id":"","url":"https://api.github.com/users/yanglimingcn","html_url":"https://github.com/yanglimingcn","followers_url":"https://api.github.com/users/yanglimingcn/followers","following_url":"https://api.github.com/users/yanglimingcn/following{/other_user}","gists_url":"https://api.github.com/users/yanglimingcn/gists{/gist_id}","starred_url":"https://api.github.com/users/yanglimingcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yanglimingcn/subscriptions","organizations_url":"https://api.github.com/users/yanglimingcn/orgs","repos_url":"https://api.github.com/users/yanglimingcn/repos","events_url":"https://api.github.com/users/yanglimingcn/events{/privacy}","received_events_url":"https://api.github.com/users/yanglimingcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-16T04:03:30Z","updated_at":"2023-12-16T04:03:30Z","author_association":"CONTRIBUTOR","body":"> > > 这种可以用StartCancel+Join吧\r\n> > \r\n> > \r\n> > 这种其实还是想要第三个请求的rpc应答的，只是不需要同步等待它，等这个rpc应答后可以做一些更新的动作。\r\n> \r\n> 这个场景的话，感觉第三个请求的span信息也是有用的吧？可能需要实现一个server span延迟submit的逻辑\r\n\r\n如果不关心第三个请求的应答的span信息，在同步请求得到应答之后，是否可以按照如下逻辑处理不造成core呢？\r\n具体步骤\r\n1、使用bthread_id_lock锁住controller，\r\n2、然后设置controller里面的span为空，\r\n3、释放span空间。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1858706386/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1858714464","html_url":"https://github.com/apache/brpc/issues/2471#issuecomment-1858714464","issue_url":"https://api.github.com/repos/apache/brpc/issues/2471","id":1858714464,"node_id":"IC_kwDOBhmkcs5uybtg","user":{"login":"lorinlee","id":16054841,"node_id":"MDQ6VXNlcjE2MDU0ODQx","avatar_url":"https://avatars.githubusercontent.com/u/16054841?v=4","gravatar_id":"","url":"https://api.github.com/users/lorinlee","html_url":"https://github.com/lorinlee","followers_url":"https://api.github.com/users/lorinlee/followers","following_url":"https://api.github.com/users/lorinlee/following{/other_user}","gists_url":"https://api.github.com/users/lorinlee/gists{/gist_id}","starred_url":"https://api.github.com/users/lorinlee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lorinlee/subscriptions","organizations_url":"https://api.github.com/users/lorinlee/orgs","repos_url":"https://api.github.com/users/lorinlee/repos","events_url":"https://api.github.com/users/lorinlee/events{/privacy}","received_events_url":"https://api.github.com/users/lorinlee/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-16T04:25:57Z","updated_at":"2023-12-16T04:25:57Z","author_association":"CONTRIBUTOR","body":"是在什么场景发现变更RECV_QUEUE_SIZE有收益吗？可以详细介绍一下么","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1858714464/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1859156846","html_url":"https://github.com/apache/brpc/issues/2466#issuecomment-1859156846","issue_url":"https://api.github.com/repos/apache/brpc/issues/2466","id":1859156846,"node_id":"IC_kwDOBhmkcs5u0Htu","user":{"login":"lorinlee","id":16054841,"node_id":"MDQ6VXNlcjE2MDU0ODQx","avatar_url":"https://avatars.githubusercontent.com/u/16054841?v=4","gravatar_id":"","url":"https://api.github.com/users/lorinlee","html_url":"https://github.com/lorinlee","followers_url":"https://api.github.com/users/lorinlee/followers","following_url":"https://api.github.com/users/lorinlee/following{/other_user}","gists_url":"https://api.github.com/users/lorinlee/gists{/gist_id}","starred_url":"https://api.github.com/users/lorinlee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lorinlee/subscriptions","organizations_url":"https://api.github.com/users/lorinlee/orgs","repos_url":"https://api.github.com/users/lorinlee/repos","events_url":"https://api.github.com/users/lorinlee/events{/privacy}","received_events_url":"https://api.github.com/users/lorinlee/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-17T12:23:38Z","updated_at":"2023-12-17T12:23:38Z","author_association":"CONTRIBUTOR","body":"原有的接口，先声明两个 butil::intrusive_ptr<brpc::ResponseMerger> rm_ptr(response_merger); butil::intrusive_ptr<XXXCallMapper<Request>> cm_ptr(call_mapper); 再用.get()传入指针，效果是不是一样的？ channel.AddChannel(sub_channel.get(), brpc::DOESNT_OWN_CHANNEL, cm_ptr.get(), rm_ptr.get())","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1859156846/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1859162634","html_url":"https://github.com/apache/brpc/issues/2468#issuecomment-1859162634","issue_url":"https://api.github.com/repos/apache/brpc/issues/2468","id":1859162634,"node_id":"IC_kwDOBhmkcs5u0JIK","user":{"login":"lorinlee","id":16054841,"node_id":"MDQ6VXNlcjE2MDU0ODQx","avatar_url":"https://avatars.githubusercontent.com/u/16054841?v=4","gravatar_id":"","url":"https://api.github.com/users/lorinlee","html_url":"https://github.com/lorinlee","followers_url":"https://api.github.com/users/lorinlee/followers","following_url":"https://api.github.com/users/lorinlee/following{/other_user}","gists_url":"https://api.github.com/users/lorinlee/gists{/gist_id}","starred_url":"https://api.github.com/users/lorinlee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lorinlee/subscriptions","organizations_url":"https://api.github.com/users/lorinlee/orgs","repos_url":"https://api.github.com/users/lorinlee/repos","events_url":"https://api.github.com/users/lorinlee/events{/privacy}","received_events_url":"https://api.github.com/users/lorinlee/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-17T12:48:24Z","updated_at":"2023-12-17T12:48:24Z","author_association":"CONTRIBUTOR","body":"brpc是什么版本呢？brpc的global.cpp里有注册H2协议吗\r\n![image](https://github.com/apache/brpc/assets/16054841/2f32a88b-2e7a-418c-bcb4-6f627d1fa1cb)\r\n","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1859162634/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1859170948","html_url":"https://github.com/apache/brpc/issues/2468#issuecomment-1859170948","issue_url":"https://api.github.com/repos/apache/brpc/issues/2468","id":1859170948,"node_id":"IC_kwDOBhmkcs5u0LKE","user":{"login":"tuhbo","id":75490989,"node_id":"MDQ6VXNlcjc1NDkwOTg5","avatar_url":"https://avatars.githubusercontent.com/u/75490989?v=4","gravatar_id":"","url":"https://api.github.com/users/tuhbo","html_url":"https://github.com/tuhbo","followers_url":"https://api.github.com/users/tuhbo/followers","following_url":"https://api.github.com/users/tuhbo/following{/other_user}","gists_url":"https://api.github.com/users/tuhbo/gists{/gist_id}","starred_url":"https://api.github.com/users/tuhbo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tuhbo/subscriptions","organizations_url":"https://api.github.com/users/tuhbo/orgs","repos_url":"https://api.github.com/users/tuhbo/repos","events_url":"https://api.github.com/users/tuhbo/events{/privacy}","received_events_url":"https://api.github.com/users/tuhbo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-17T13:20:04Z","updated_at":"2023-12-17T13:20:04Z","author_association":"NONE","body":"已经知道原因了，我用的brpc是0.9.0的，还不支持h2协议","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1859170948/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1859858176","html_url":"https://github.com/apache/brpc/issues/2466#issuecomment-1859858176","issue_url":"https://api.github.com/repos/apache/brpc/issues/2466","id":1859858176,"node_id":"IC_kwDOBhmkcs5u2y8A","user":{"login":"sinomiko","id":12888642,"node_id":"MDQ6VXNlcjEyODg4NjQy","avatar_url":"https://avatars.githubusercontent.com/u/12888642?v=4","gravatar_id":"","url":"https://api.github.com/users/sinomiko","html_url":"https://github.com/sinomiko","followers_url":"https://api.github.com/users/sinomiko/followers","following_url":"https://api.github.com/users/sinomiko/following{/other_user}","gists_url":"https://api.github.com/users/sinomiko/gists{/gist_id}","starred_url":"https://api.github.com/users/sinomiko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sinomiko/subscriptions","organizations_url":"https://api.github.com/users/sinomiko/orgs","repos_url":"https://api.github.com/users/sinomiko/repos","events_url":"https://api.github.com/users/sinomiko/events{/privacy}","received_events_url":"https://api.github.com/users/sinomiko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-18T09:10:46Z","updated_at":"2023-12-18T09:10:47Z","author_association":"CONTRIBUTOR","body":"> 原有的接口，先声明两个 butil::intrusive_ptrbrpc::ResponseMerger rm_ptr(response_merger); butil::intrusive_ptr<XXXCallMapper> cm_ptr(call_mapper); 再用.get()传入指针，效果是不是一样的？ channel.AddChannel(sub_channel.get(), brpc::DOESNT_OWN_CHANNEL, cm_ptr.get(), rm_ptr.get())\r\n\r\n一块资源给多个intrusive_ptr管理，会存在重复析构问题；\r\n如果使用 detach \r\n\r\nchannel.AddChannel(sub_channel.get(), brpc::DOESNT_OWN_CHANNEL, cm_ptr.detach(), rm_ptr.detach())\r\n\r\n又会存在AddChannel 失败，导致 资源泄漏问题。\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1859858176/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1859963411","html_url":"https://github.com/apache/brpc/issues/2472#issuecomment-1859963411","issue_url":"https://api.github.com/repos/apache/brpc/issues/2472","id":1859963411,"node_id":"IC_kwDOBhmkcs5u3MoT","user":{"login":"binarycopycode","id":34117975,"node_id":"MDQ6VXNlcjM0MTE3OTc1","avatar_url":"https://avatars.githubusercontent.com/u/34117975?v=4","gravatar_id":"","url":"https://api.github.com/users/binarycopycode","html_url":"https://github.com/binarycopycode","followers_url":"https://api.github.com/users/binarycopycode/followers","following_url":"https://api.github.com/users/binarycopycode/following{/other_user}","gists_url":"https://api.github.com/users/binarycopycode/gists{/gist_id}","starred_url":"https://api.github.com/users/binarycopycode/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/binarycopycode/subscriptions","organizations_url":"https://api.github.com/users/binarycopycode/orgs","repos_url":"https://api.github.com/users/binarycopycode/repos","events_url":"https://api.github.com/users/binarycopycode/events{/privacy}","received_events_url":"https://api.github.com/users/binarycopycode/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-18T09:50:53Z","updated_at":"2023-12-18T09:50:53Z","author_association":"CONTRIBUTOR","body":"解决了。需要加上`brpc::rdma::GlobalRdmaInitializeOrDie();`\r\n不然没有注册g_pd\r\n![pd=0](https://github.com/apache/brpc/assets/34117975/79e0ae14-dd2c-4634-8ca9-c135c935370a)\r\n![pd != 0](https://github.com/apache/brpc/assets/34117975/b2ffe747-b3ad-462d-ba3b-77abfe40a27e)\r\n","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1859963411/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1859967178","html_url":"https://github.com/apache/brpc/issues/2472#issuecomment-1859967178","issue_url":"https://api.github.com/repos/apache/brpc/issues/2472","id":1859967178,"node_id":"IC_kwDOBhmkcs5u3NjK","user":{"login":"binarycopycode","id":34117975,"node_id":"MDQ6VXNlcjM0MTE3OTc1","avatar_url":"https://avatars.githubusercontent.com/u/34117975?v=4","gravatar_id":"","url":"https://api.github.com/users/binarycopycode","html_url":"https://github.com/binarycopycode","followers_url":"https://api.github.com/users/binarycopycode/followers","following_url":"https://api.github.com/users/binarycopycode/following{/other_user}","gists_url":"https://api.github.com/users/binarycopycode/gists{/gist_id}","starred_url":"https://api.github.com/users/binarycopycode/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/binarycopycode/subscriptions","organizations_url":"https://api.github.com/users/binarycopycode/orgs","repos_url":"https://api.github.com/users/binarycopycode/repos","events_url":"https://api.github.com/users/binarycopycode/events{/privacy}","received_events_url":"https://api.github.com/users/binarycopycode/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-18T09:52:58Z","updated_at":"2023-12-18T09:52:58Z","author_association":"CONTRIBUTOR","body":"感觉文档里可以多补充一些细节","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1859967178/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1860337652","html_url":"https://github.com/apache/brpc/issues/2471#issuecomment-1860337652","issue_url":"https://api.github.com/repos/apache/brpc/issues/2471","id":1860337652,"node_id":"IC_kwDOBhmkcs5u4n_0","user":{"login":"limindlmu","id":24813528,"node_id":"MDQ6VXNlcjI0ODEzNTI4","avatar_url":"https://avatars.githubusercontent.com/u/24813528?v=4","gravatar_id":"","url":"https://api.github.com/users/limindlmu","html_url":"https://github.com/limindlmu","followers_url":"https://api.github.com/users/limindlmu/followers","following_url":"https://api.github.com/users/limindlmu/following{/other_user}","gists_url":"https://api.github.com/users/limindlmu/gists{/gist_id}","starred_url":"https://api.github.com/users/limindlmu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/limindlmu/subscriptions","organizations_url":"https://api.github.com/users/limindlmu/orgs","repos_url":"https://api.github.com/users/limindlmu/repos","events_url":"https://api.github.com/users/limindlmu/events{/privacy}","received_events_url":"https://api.github.com/users/limindlmu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-18T12:16:10Z","updated_at":"2023-12-18T12:16:10Z","author_association":"NONE","body":"> 是在什么场景发现变更RECV_QUEUE_SIZE有收益吗？可以详细介绍一下么\r\n\r\n在我们的业务场景中，耗时不是很平稳（因为有多个场景，每个场景耗时差异较大）。RECV_QUEUE_SIZE 调大些时，avg_latency的计算波动会更小，这样weight的波动也会更小，客户端打到服务端的流量会更平稳些，不会频繁上下波动。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1860337652/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1861998351","html_url":"https://github.com/apache/brpc/issues/2460#issuecomment-1861998351","issue_url":"https://api.github.com/repos/apache/brpc/issues/2460","id":1861998351,"node_id":"IC_kwDOBhmkcs5u-9cP","user":{"login":"wwbmmm","id":3894631,"node_id":"MDQ6VXNlcjM4OTQ2MzE=","avatar_url":"https://avatars.githubusercontent.com/u/3894631?v=4","gravatar_id":"","url":"https://api.github.com/users/wwbmmm","html_url":"https://github.com/wwbmmm","followers_url":"https://api.github.com/users/wwbmmm/followers","following_url":"https://api.github.com/users/wwbmmm/following{/other_user}","gists_url":"https://api.github.com/users/wwbmmm/gists{/gist_id}","starred_url":"https://api.github.com/users/wwbmmm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wwbmmm/subscriptions","organizations_url":"https://api.github.com/users/wwbmmm/orgs","repos_url":"https://api.github.com/users/wwbmmm/repos","events_url":"https://api.github.com/users/wwbmmm/events{/privacy}","received_events_url":"https://api.github.com/users/wwbmmm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-19T02:21:25Z","updated_at":"2023-12-19T02:21:25Z","author_association":"CONTRIBUTOR","body":"不用每个UT都启动一个server吧。可以启动一个公共的server，然后不同的UT运行不同的client就可以了","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1861998351/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1862001776","html_url":"https://github.com/apache/brpc/issues/978#issuecomment-1862001776","issue_url":"https://api.github.com/repos/apache/brpc/issues/978","id":1862001776,"node_id":"IC_kwDOBhmkcs5u--Rw","user":{"login":"wwbmmm","id":3894631,"node_id":"MDQ6VXNlcjM4OTQ2MzE=","avatar_url":"https://avatars.githubusercontent.com/u/3894631?v=4","gravatar_id":"","url":"https://api.github.com/users/wwbmmm","html_url":"https://github.com/wwbmmm","followers_url":"https://api.github.com/users/wwbmmm/followers","following_url":"https://api.github.com/users/wwbmmm/following{/other_user}","gists_url":"https://api.github.com/users/wwbmmm/gists{/gist_id}","starred_url":"https://api.github.com/users/wwbmmm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wwbmmm/subscriptions","organizations_url":"https://api.github.com/users/wwbmmm/orgs","repos_url":"https://api.github.com/users/wwbmmm/repos","events_url":"https://api.github.com/users/wwbmmm/events{/privacy}","received_events_url":"https://api.github.com/users/wwbmmm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-19T02:26:08Z","updated_at":"2023-12-19T02:26:08Z","author_association":"CONTRIBUTOR","body":"> brpc 可以通过 LD_PRELOAD 的方式使用 f-stack 吗？\r\n\r\n理论上可以吧。brpc底层也是通过libc进行网络通信的，只要能hook相关的系统调用就可以。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1862001776/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1862009947","html_url":"https://github.com/apache/brpc/pull/2467#issuecomment-1862009947","issue_url":"https://api.github.com/repos/apache/brpc/issues/2467","id":1862009947,"node_id":"IC_kwDOBhmkcs5u_ARb","user":{"login":"wwbmmm","id":3894631,"node_id":"MDQ6VXNlcjM4OTQ2MzE=","avatar_url":"https://avatars.githubusercontent.com/u/3894631?v=4","gravatar_id":"","url":"https://api.github.com/users/wwbmmm","html_url":"https://github.com/wwbmmm","followers_url":"https://api.github.com/users/wwbmmm/followers","following_url":"https://api.github.com/users/wwbmmm/following{/other_user}","gists_url":"https://api.github.com/users/wwbmmm/gists{/gist_id}","starred_url":"https://api.github.com/users/wwbmmm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wwbmmm/subscriptions","organizations_url":"https://api.github.com/users/wwbmmm/orgs","repos_url":"https://api.github.com/users/wwbmmm/repos","events_url":"https://api.github.com/users/wwbmmm/events{/privacy}","received_events_url":"https://api.github.com/users/wwbmmm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-19T02:37:17Z","updated_at":"2023-12-19T02:37:17Z","author_association":"CONTRIBUTOR","body":"LGTM","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1862009947/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1862024192","html_url":"https://github.com/apache/brpc/pull/2469#issuecomment-1862024192","issue_url":"https://api.github.com/repos/apache/brpc/issues/2469","id":1862024192,"node_id":"IC_kwDOBhmkcs5u_DwA","user":{"login":"wwbmmm","id":3894631,"node_id":"MDQ6VXNlcjM4OTQ2MzE=","avatar_url":"https://avatars.githubusercontent.com/u/3894631?v=4","gravatar_id":"","url":"https://api.github.com/users/wwbmmm","html_url":"https://github.com/wwbmmm","followers_url":"https://api.github.com/users/wwbmmm/followers","following_url":"https://api.github.com/users/wwbmmm/following{/other_user}","gists_url":"https://api.github.com/users/wwbmmm/gists{/gist_id}","starred_url":"https://api.github.com/users/wwbmmm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wwbmmm/subscriptions","organizations_url":"https://api.github.com/users/wwbmmm/orgs","repos_url":"https://api.github.com/users/wwbmmm/repos","events_url":"https://api.github.com/users/wwbmmm/events{/privacy}","received_events_url":"https://api.github.com/users/wwbmmm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-19T02:54:48Z","updated_at":"2023-12-19T02:54:48Z","author_association":"CONTRIBUTOR","body":"LGTM","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1862024192/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1862026203","html_url":"https://github.com/apache/brpc/pull/2251#issuecomment-1862026203","issue_url":"https://api.github.com/repos/apache/brpc/issues/2251","id":1862026203,"node_id":"IC_kwDOBhmkcs5u_EPb","user":{"login":"wwbmmm","id":3894631,"node_id":"MDQ6VXNlcjM4OTQ2MzE=","avatar_url":"https://avatars.githubusercontent.com/u/3894631?v=4","gravatar_id":"","url":"https://api.github.com/users/wwbmmm","html_url":"https://github.com/wwbmmm","followers_url":"https://api.github.com/users/wwbmmm/followers","following_url":"https://api.github.com/users/wwbmmm/following{/other_user}","gists_url":"https://api.github.com/users/wwbmmm/gists{/gist_id}","starred_url":"https://api.github.com/users/wwbmmm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wwbmmm/subscriptions","organizations_url":"https://api.github.com/users/wwbmmm/orgs","repos_url":"https://api.github.com/users/wwbmmm/repos","events_url":"https://api.github.com/users/wwbmmm/events{/privacy}","received_events_url":"https://api.github.com/users/wwbmmm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-19T02:57:29Z","updated_at":"2023-12-19T02:57:29Z","author_association":"CONTRIBUTOR","body":"LGTM","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1862026203/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1862026985","html_url":"https://github.com/apache/brpc/issues/2448#issuecomment-1862026985","issue_url":"https://api.github.com/repos/apache/brpc/issues/2448","id":1862026985,"node_id":"IC_kwDOBhmkcs5u_Ebp","user":{"login":"wwbmmm","id":3894631,"node_id":"MDQ6VXNlcjM4OTQ2MzE=","avatar_url":"https://avatars.githubusercontent.com/u/3894631?v=4","gravatar_id":"","url":"https://api.github.com/users/wwbmmm","html_url":"https://github.com/wwbmmm","followers_url":"https://api.github.com/users/wwbmmm/followers","following_url":"https://api.github.com/users/wwbmmm/following{/other_user}","gists_url":"https://api.github.com/users/wwbmmm/gists{/gist_id}","starred_url":"https://api.github.com/users/wwbmmm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wwbmmm/subscriptions","organizations_url":"https://api.github.com/users/wwbmmm/orgs","repos_url":"https://api.github.com/users/wwbmmm/repos","events_url":"https://api.github.com/users/wwbmmm/events{/privacy}","received_events_url":"https://api.github.com/users/wwbmmm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-19T02:58:36Z","updated_at":"2023-12-19T02:58:36Z","author_association":"CONTRIBUTOR","body":"是的，不支持oneway调用","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1862026985/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1862032909","html_url":"https://github.com/apache/brpc/pull/1751#issuecomment-1862032909","issue_url":"https://api.github.com/repos/apache/brpc/issues/1751","id":1862032909,"node_id":"IC_kwDOBhmkcs5u_F4N","user":{"login":"wwbmmm","id":3894631,"node_id":"MDQ6VXNlcjM4OTQ2MzE=","avatar_url":"https://avatars.githubusercontent.com/u/3894631?v=4","gravatar_id":"","url":"https://api.github.com/users/wwbmmm","html_url":"https://github.com/wwbmmm","followers_url":"https://api.github.com/users/wwbmmm/followers","following_url":"https://api.github.com/users/wwbmmm/following{/other_user}","gists_url":"https://api.github.com/users/wwbmmm/gists{/gist_id}","starred_url":"https://api.github.com/users/wwbmmm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wwbmmm/subscriptions","organizations_url":"https://api.github.com/users/wwbmmm/orgs","repos_url":"https://api.github.com/users/wwbmmm/repos","events_url":"https://api.github.com/users/wwbmmm/events{/privacy}","received_events_url":"https://api.github.com/users/wwbmmm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-19T03:06:29Z","updated_at":"2023-12-19T03:06:29Z","author_association":"CONTRIBUTOR","body":"> 只能 no_signal 然后 bthread_flush，感觉不够优雅\r\n\r\n虽然不够优雅，但能解决问题吧，再加参数的话感觉这个接口也太复杂了。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1862032909/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1863763484","html_url":"https://github.com/apache/brpc/issues/2473#issuecomment-1863763484","issue_url":"https://api.github.com/repos/apache/brpc/issues/2473","id":1863763484,"node_id":"IC_kwDOBhmkcs5vFsYc","user":{"login":"binarycopycode","id":34117975,"node_id":"MDQ6VXNlcjM0MTE3OTc1","avatar_url":"https://avatars.githubusercontent.com/u/34117975?v=4","gravatar_id":"","url":"https://api.github.com/users/binarycopycode","html_url":"https://github.com/binarycopycode","followers_url":"https://api.github.com/users/binarycopycode/followers","following_url":"https://api.github.com/users/binarycopycode/following{/other_user}","gists_url":"https://api.github.com/users/binarycopycode/gists{/gist_id}","starred_url":"https://api.github.com/users/binarycopycode/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/binarycopycode/subscriptions","organizations_url":"https://api.github.com/users/binarycopycode/orgs","repos_url":"https://api.github.com/users/binarycopycode/repos","events_url":"https://api.github.com/users/binarycopycode/events{/privacy}","received_events_url":"https://api.github.com/users/binarycopycode/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-20T02:40:52Z","updated_at":"2023-12-20T02:41:40Z","author_association":"CONTRIBUTOR","body":"/brpc/src/brpc/details/http_message.h 在这个头文件中加入`#include <memory>`  就可以编译了。\r\n\r\n感觉是个跟不同版本编译器有关的bug，是否需要修一下？","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1863763484/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1863805265","html_url":"https://github.com/apache/brpc/issues/1010#issuecomment-1863805265","issue_url":"https://api.github.com/repos/apache/brpc/issues/1010","id":1863805265,"node_id":"IC_kwDOBhmkcs5vF2lR","user":{"login":"wwbmmm","id":3894631,"node_id":"MDQ6VXNlcjM4OTQ2MzE=","avatar_url":"https://avatars.githubusercontent.com/u/3894631?v=4","gravatar_id":"","url":"https://api.github.com/users/wwbmmm","html_url":"https://github.com/wwbmmm","followers_url":"https://api.github.com/users/wwbmmm/followers","following_url":"https://api.github.com/users/wwbmmm/following{/other_user}","gists_url":"https://api.github.com/users/wwbmmm/gists{/gist_id}","starred_url":"https://api.github.com/users/wwbmmm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wwbmmm/subscriptions","organizations_url":"https://api.github.com/users/wwbmmm/orgs","repos_url":"https://api.github.com/users/wwbmmm/repos","events_url":"https://api.github.com/users/wwbmmm/events{/privacy}","received_events_url":"https://api.github.com/users/wwbmmm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-20T03:50:55Z","updated_at":"2023-12-20T03:50:55Z","author_association":"CONTRIBUTOR","body":"> > > > 这种可以用StartCancel+Join吧\r\n> > > \r\n> > > \r\n> > > 这种其实还是想要第三个请求的rpc应答的，只是不需要同步等待它，等这个rpc应答后可以做一些更新的动作。\r\n> > \r\n> > \r\n> > 这个场景的话，感觉第三个请求的span信息也是有用的吧？可能需要实现一个server span延迟submit的逻辑\r\n> \r\n> 如果不关心第三个请求的应答的span信息，在同步请求得到应答之后，是否可以按照如下逻辑处理不造成core呢？ 具体步骤 1、使用bthread_id_lock锁住controller， 2、然后设置controller里面的span为空， 3、释放span空间。\r\n\r\n可以是可以，但是感觉有点trick","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1863805265/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1863808017","html_url":"https://github.com/apache/brpc/issues/2473#issuecomment-1863808017","issue_url":"https://api.github.com/repos/apache/brpc/issues/2473","id":1863808017,"node_id":"IC_kwDOBhmkcs5vF3QR","user":{"login":"wwbmmm","id":3894631,"node_id":"MDQ6VXNlcjM4OTQ2MzE=","avatar_url":"https://avatars.githubusercontent.com/u/3894631?v=4","gravatar_id":"","url":"https://api.github.com/users/wwbmmm","html_url":"https://github.com/wwbmmm","followers_url":"https://api.github.com/users/wwbmmm/followers","following_url":"https://api.github.com/users/wwbmmm/following{/other_user}","gists_url":"https://api.github.com/users/wwbmmm/gists{/gist_id}","starred_url":"https://api.github.com/users/wwbmmm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wwbmmm/subscriptions","organizations_url":"https://api.github.com/users/wwbmmm/orgs","repos_url":"https://api.github.com/users/wwbmmm/repos","events_url":"https://api.github.com/users/wwbmmm/events{/privacy}","received_events_url":"https://api.github.com/users/wwbmmm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-20T03:55:48Z","updated_at":"2023-12-20T03:55:48Z","author_association":"CONTRIBUTOR","body":"欢迎提PR","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1863808017/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1864154226","html_url":"https://github.com/apache/brpc/issues/1010#issuecomment-1864154226","issue_url":"https://api.github.com/repos/apache/brpc/issues/1010","id":1864154226,"node_id":"IC_kwDOBhmkcs5vHLxy","user":{"login":"yanglimingcn","id":7091130,"node_id":"MDQ6VXNlcjcwOTExMzA=","avatar_url":"https://avatars.githubusercontent.com/u/7091130?v=4","gravatar_id":"","url":"https://api.github.com/users/yanglimingcn","html_url":"https://github.com/yanglimingcn","followers_url":"https://api.github.com/users/yanglimingcn/followers","following_url":"https://api.github.com/users/yanglimingcn/following{/other_user}","gists_url":"https://api.github.com/users/yanglimingcn/gists{/gist_id}","starred_url":"https://api.github.com/users/yanglimingcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yanglimingcn/subscriptions","organizations_url":"https://api.github.com/users/yanglimingcn/orgs","repos_url":"https://api.github.com/users/yanglimingcn/repos","events_url":"https://api.github.com/users/yanglimingcn/events{/privacy}","received_events_url":"https://api.github.com/users/yanglimingcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-20T09:40:08Z","updated_at":"2023-12-20T09:40:08Z","author_association":"CONTRIBUTOR","body":"> > > > > 这种可以用StartCancel+Join吧\r\n> > > > \r\n> > > > \r\n> > > > 这种其实还是想要第三个请求的rpc应答的，只是不需要同步等待它，等这个rpc应答后可以做一些更新的动作。\r\n> > > \r\n> > > \r\n> > > 这个场景的话，感觉第三个请求的span信息也是有用的吧？可能需要实现一个server span延迟submit的逻辑\r\n> > \r\n> > \r\n> > 如果不关心第三个请求的应答的span信息，在同步请求得到应答之后，是否可以按照如下逻辑处理不造成core呢？ 具体步骤 1、使用bthread_id_lock锁住controller， 2、然后设置controller里面的span为空， 3、释放span空间。\r\n> \r\n> 可以是可以，但是感觉有点trick\r\n\r\n因为我们有需求，所以暂时先这么搞定，然后再讨论怎么处理这样的需求更合理。😂","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1864154226/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1864160788","html_url":"https://github.com/apache/brpc/pull/2215#issuecomment-1864160788","issue_url":"https://api.github.com/repos/apache/brpc/issues/2215","id":1864160788,"node_id":"IC_kwDOBhmkcs5vHNYU","user":{"login":"yanglimingcn","id":7091130,"node_id":"MDQ6VXNlcjcwOTExMzA=","avatar_url":"https://avatars.githubusercontent.com/u/7091130?v=4","gravatar_id":"","url":"https://api.github.com/users/yanglimingcn","html_url":"https://github.com/yanglimingcn","followers_url":"https://api.github.com/users/yanglimingcn/followers","following_url":"https://api.github.com/users/yanglimingcn/following{/other_user}","gists_url":"https://api.github.com/users/yanglimingcn/gists{/gist_id}","starred_url":"https://api.github.com/users/yanglimingcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yanglimingcn/subscriptions","organizations_url":"https://api.github.com/users/yanglimingcn/orgs","repos_url":"https://api.github.com/users/yanglimingcn/repos","events_url":"https://api.github.com/users/yanglimingcn/events{/privacy}","received_events_url":"https://api.github.com/users/yanglimingcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-20T09:44:25Z","updated_at":"2023-12-20T09:44:25Z","author_association":"CONTRIBUTOR","body":"a better method see #2358 ","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1864160788/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1864644477","html_url":"https://github.com/apache/brpc/pull/2474#issuecomment-1864644477","issue_url":"https://api.github.com/repos/apache/brpc/issues/2474","id":1864644477,"node_id":"IC_kwDOBhmkcs5vJDd9","user":{"login":"chenBright","id":12249635,"node_id":"MDQ6VXNlcjEyMjQ5NjM1","avatar_url":"https://avatars.githubusercontent.com/u/12249635?v=4","gravatar_id":"","url":"https://api.github.com/users/chenBright","html_url":"https://github.com/chenBright","followers_url":"https://api.github.com/users/chenBright/followers","following_url":"https://api.github.com/users/chenBright/following{/other_user}","gists_url":"https://api.github.com/users/chenBright/gists{/gist_id}","starred_url":"https://api.github.com/users/chenBright/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenBright/subscriptions","organizations_url":"https://api.github.com/users/chenBright/orgs","repos_url":"https://api.github.com/users/chenBright/repos","events_url":"https://api.github.com/users/chenBright/events{/privacy}","received_events_url":"https://api.github.com/users/chenBright/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-20T15:13:14Z","updated_at":"2023-12-20T15:13:14Z","author_association":"CONTRIBUTOR","body":"LGTM","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1864644477/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1865241005","html_url":"https://github.com/apache/brpc/pull/2413#issuecomment-1865241005","issue_url":"https://api.github.com/repos/apache/brpc/issues/2413","id":1865241005,"node_id":"IC_kwDOBhmkcs5vLVGt","user":{"login":"yanglimingcn","id":7091130,"node_id":"MDQ6VXNlcjcwOTExMzA=","avatar_url":"https://avatars.githubusercontent.com/u/7091130?v=4","gravatar_id":"","url":"https://api.github.com/users/yanglimingcn","html_url":"https://github.com/yanglimingcn","followers_url":"https://api.github.com/users/yanglimingcn/followers","following_url":"https://api.github.com/users/yanglimingcn/following{/other_user}","gists_url":"https://api.github.com/users/yanglimingcn/gists{/gist_id}","starred_url":"https://api.github.com/users/yanglimingcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yanglimingcn/subscriptions","organizations_url":"https://api.github.com/users/yanglimingcn/orgs","repos_url":"https://api.github.com/users/yanglimingcn/repos","events_url":"https://api.github.com/users/yanglimingcn/events{/privacy}","received_events_url":"https://api.github.com/users/yanglimingcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-20T22:44:31Z","updated_at":"2023-12-20T22:44:31Z","author_association":"CONTRIBUTOR","body":"请问这个日志名字是怎么定义的，日志会根据大小切分吗","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1865241005/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1865397898","html_url":"https://github.com/apache/brpc/pull/2476#issuecomment-1865397898","issue_url":"https://api.github.com/repos/apache/brpc/issues/2476","id":1865397898,"node_id":"IC_kwDOBhmkcs5vL7aK","user":{"login":"yanglimingcn","id":7091130,"node_id":"MDQ6VXNlcjcwOTExMzA=","avatar_url":"https://avatars.githubusercontent.com/u/7091130?v=4","gravatar_id":"","url":"https://api.github.com/users/yanglimingcn","html_url":"https://github.com/yanglimingcn","followers_url":"https://api.github.com/users/yanglimingcn/followers","following_url":"https://api.github.com/users/yanglimingcn/following{/other_user}","gists_url":"https://api.github.com/users/yanglimingcn/gists{/gist_id}","starred_url":"https://api.github.com/users/yanglimingcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yanglimingcn/subscriptions","organizations_url":"https://api.github.com/users/yanglimingcn/orgs","repos_url":"https://api.github.com/users/yanglimingcn/repos","events_url":"https://api.github.com/users/yanglimingcn/events{/privacy}","received_events_url":"https://api.github.com/users/yanglimingcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-21T02:43:15Z","updated_at":"2023-12-21T02:43:15Z","author_association":"CONTRIBUTOR","body":"@wwbmmm 我觉得brpc内部启动的协程，有些地方需要把bthread_tag设置正确，否则会存在跨线程池执行的问题，特别是socket.cpp这块。\r\n其它地方我把握的不是很准确，请仔细review一下。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1865397898/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1865406094","html_url":"https://github.com/apache/brpc/issues/2475#issuecomment-1865406094","issue_url":"https://api.github.com/repos/apache/brpc/issues/2475","id":1865406094,"node_id":"IC_kwDOBhmkcs5vL9aO","user":{"login":"binarycopycode","id":34117975,"node_id":"MDQ6VXNlcjM0MTE3OTc1","avatar_url":"https://avatars.githubusercontent.com/u/34117975?v=4","gravatar_id":"","url":"https://api.github.com/users/binarycopycode","html_url":"https://github.com/binarycopycode","followers_url":"https://api.github.com/users/binarycopycode/followers","following_url":"https://api.github.com/users/binarycopycode/following{/other_user}","gists_url":"https://api.github.com/users/binarycopycode/gists{/gist_id}","starred_url":"https://api.github.com/users/binarycopycode/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/binarycopycode/subscriptions","organizations_url":"https://api.github.com/users/binarycopycode/orgs","repos_url":"https://api.github.com/users/binarycopycode/repos","events_url":"https://api.github.com/users/binarycopycode/events{/privacy}","received_events_url":"https://api.github.com/users/binarycopycode/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-21T02:57:00Z","updated_at":"2023-12-21T02:57:00Z","author_association":"CONTRIBUTOR","body":"以上为本地虚拟机测试。后来在两台有mlx的RDMA网卡的服务器上测试又不一样了。其中tcp能传1G的数据，但是到2G就出现一样的Broken pipe错误，但是RDMA可以传2G数据，但是4G数据被iobuf的限制给写死了，这个有办法解决吗？ @Tuvie  是否能去掉这个限制，还是只能自己手动分段传数据了？\r\n```\r\nint IOBuf::append_user_data_with_meta(void* data,\r\n                                      size_t size,\r\n                                      void (*deleter)(void*),\r\n                                      uint64_t meta) {\r\n    if (size > 0xFFFFFFFFULL - 100) {\r\n        LOG(FATAL) << \"data_size=\" << size << \" is too large\";\r\n        return -1;\r\n    }\r\n    ......\r\n}\r\n```","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1865406094/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1865410753","html_url":"https://github.com/apache/brpc/issues/2473#issuecomment-1865410753","issue_url":"https://api.github.com/repos/apache/brpc/issues/2473","id":1865410753,"node_id":"IC_kwDOBhmkcs5vL-jB","user":{"login":"binarycopycode","id":34117975,"node_id":"MDQ6VXNlcjM0MTE3OTc1","avatar_url":"https://avatars.githubusercontent.com/u/34117975?v=4","gravatar_id":"","url":"https://api.github.com/users/binarycopycode","html_url":"https://github.com/binarycopycode","followers_url":"https://api.github.com/users/binarycopycode/followers","following_url":"https://api.github.com/users/binarycopycode/following{/other_user}","gists_url":"https://api.github.com/users/binarycopycode/gists{/gist_id}","starred_url":"https://api.github.com/users/binarycopycode/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/binarycopycode/subscriptions","organizations_url":"https://api.github.com/users/binarycopycode/orgs","repos_url":"https://api.github.com/users/binarycopycode/repos","events_url":"https://api.github.com/users/binarycopycode/events{/privacy}","received_events_url":"https://api.github.com/users/binarycopycode/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-21T03:04:29Z","updated_at":"2023-12-21T03:04:29Z","author_association":"CONTRIBUTOR","body":"> 欢迎提PR\r\n\r\nhttps://github.com/apache/brpc/pull/2474 提好了","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1865410753/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1865434275","html_url":"https://github.com/apache/brpc/pull/2406#issuecomment-1865434275","issue_url":"https://api.github.com/repos/apache/brpc/issues/2406","id":1865434275,"node_id":"IC_kwDOBhmkcs5vMESj","user":{"login":"chenBright","id":12249635,"node_id":"MDQ6VXNlcjEyMjQ5NjM1","avatar_url":"https://avatars.githubusercontent.com/u/12249635?v=4","gravatar_id":"","url":"https://api.github.com/users/chenBright","html_url":"https://github.com/chenBright","followers_url":"https://api.github.com/users/chenBright/followers","following_url":"https://api.github.com/users/chenBright/following{/other_user}","gists_url":"https://api.github.com/users/chenBright/gists{/gist_id}","starred_url":"https://api.github.com/users/chenBright/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenBright/subscriptions","organizations_url":"https://api.github.com/users/chenBright/orgs","repos_url":"https://api.github.com/users/chenBright/repos","events_url":"https://api.github.com/users/chenBright/events{/privacy}","received_events_url":"https://api.github.com/users/chenBright/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-21T03:46:25Z","updated_at":"2023-12-21T03:46:25Z","author_association":"CONTRIBUTOR","body":"> 现在baidu_std协议如果请求处理失败了，应答包就不会pack用户的response了，这个pr是不是可以做到在请求处理失败，也可以设置应答属性字段。\r\n\r\n这应该是另一个特性吧，支持请求处理失败的回调函数。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1865434275/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1865442215","html_url":"https://github.com/apache/brpc/pull/2413#issuecomment-1865442215","issue_url":"https://api.github.com/repos/apache/brpc/issues/2413","id":1865442215,"node_id":"IC_kwDOBhmkcs5vMGOn","user":{"login":"chenBright","id":12249635,"node_id":"MDQ6VXNlcjEyMjQ5NjM1","avatar_url":"https://avatars.githubusercontent.com/u/12249635?v=4","gravatar_id":"","url":"https://api.github.com/users/chenBright","html_url":"https://github.com/chenBright","followers_url":"https://api.github.com/users/chenBright/followers","following_url":"https://api.github.com/users/chenBright/following{/other_user}","gists_url":"https://api.github.com/users/chenBright/gists{/gist_id}","starred_url":"https://api.github.com/users/chenBright/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenBright/subscriptions","organizations_url":"https://api.github.com/users/chenBright/orgs","repos_url":"https://api.github.com/users/chenBright/repos","events_url":"https://api.github.com/users/chenBright/events{/privacy}","received_events_url":"https://api.github.com/users/chenBright/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-21T04:00:51Z","updated_at":"2023-12-21T04:01:10Z","author_association":"CONTRIBUTOR","body":"日志名通过butil::InitLogging  LoggingSettings设置\r\nhttps://github.com/apache/brpc/blob/2098dd3927ac389cdf6a0973b0edf19a477ff540/src/butil/logging.h#L244-L280","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1865442215/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1865443363","html_url":"https://github.com/apache/brpc/pull/2413#issuecomment-1865443363","issue_url":"https://api.github.com/repos/apache/brpc/issues/2413","id":1865443363,"node_id":"IC_kwDOBhmkcs5vMGgj","user":{"login":"chenBright","id":12249635,"node_id":"MDQ6VXNlcjEyMjQ5NjM1","avatar_url":"https://avatars.githubusercontent.com/u/12249635?v=4","gravatar_id":"","url":"https://api.github.com/users/chenBright","html_url":"https://github.com/chenBright","followers_url":"https://api.github.com/users/chenBright/followers","following_url":"https://api.github.com/users/chenBright/following{/other_user}","gists_url":"https://api.github.com/users/chenBright/gists{/gist_id}","starred_url":"https://api.github.com/users/chenBright/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenBright/subscriptions","organizations_url":"https://api.github.com/users/chenBright/orgs","repos_url":"https://api.github.com/users/chenBright/repos","events_url":"https://api.github.com/users/chenBright/events{/privacy}","received_events_url":"https://api.github.com/users/chenBright/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-21T04:02:43Z","updated_at":"2023-12-21T04:05:09Z","author_association":"CONTRIBUTOR","body":"目前框架不支持日志滚动，需要用户自己实现日志滚动逻辑，然后在LoggingLock的保护下更换log_file。\r\n\r\n不过，很多日志库都支持日志滚动。框架支持日志滚动特性应该是个合理的需求。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1865443363/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1867930599","html_url":"https://github.com/apache/brpc/pull/2251#issuecomment-1867930599","issue_url":"https://api.github.com/repos/apache/brpc/issues/2251","id":1867930599,"node_id":"IC_kwDOBhmkcs5vVlvn","user":{"login":"Menci","id":11341955,"node_id":"MDQ6VXNlcjExMzQxOTU1","avatar_url":"https://avatars.githubusercontent.com/u/11341955?v=4","gravatar_id":"","url":"https://api.github.com/users/Menci","html_url":"https://github.com/Menci","followers_url":"https://api.github.com/users/Menci/followers","following_url":"https://api.github.com/users/Menci/following{/other_user}","gists_url":"https://api.github.com/users/Menci/gists{/gist_id}","starred_url":"https://api.github.com/users/Menci/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Menci/subscriptions","organizations_url":"https://api.github.com/users/Menci/orgs","repos_url":"https://api.github.com/users/Menci/repos","events_url":"https://api.github.com/users/Menci/events{/privacy}","received_events_url":"https://api.github.com/users/Menci/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-22T17:40:08Z","updated_at":"2023-12-22T17:40:08Z","author_association":"CONTRIBUTOR","body":"谁可以来 merge 一下呢","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1867930599/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1868667164","html_url":"https://github.com/apache/brpc/pull/2467#issuecomment-1868667164","issue_url":"https://api.github.com/repos/apache/brpc/issues/2467","id":1868667164,"node_id":"IC_kwDOBhmkcs5vYZkc","user":{"login":"serverglen","id":38067377,"node_id":"MDQ6VXNlcjM4MDY3Mzc3","avatar_url":"https://avatars.githubusercontent.com/u/38067377?v=4","gravatar_id":"","url":"https://api.github.com/users/serverglen","html_url":"https://github.com/serverglen","followers_url":"https://api.github.com/users/serverglen/followers","following_url":"https://api.github.com/users/serverglen/following{/other_user}","gists_url":"https://api.github.com/users/serverglen/gists{/gist_id}","starred_url":"https://api.github.com/users/serverglen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/serverglen/subscriptions","organizations_url":"https://api.github.com/users/serverglen/orgs","repos_url":"https://api.github.com/users/serverglen/repos","events_url":"https://api.github.com/users/serverglen/events{/privacy}","received_events_url":"https://api.github.com/users/serverglen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-25T02:12:39Z","updated_at":"2023-12-25T02:12:39Z","author_association":"CONTRIBUTOR","body":"LGTM","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1868667164/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1868707543","html_url":"https://github.com/apache/brpc/pull/2476#issuecomment-1868707543","issue_url":"https://api.github.com/repos/apache/brpc/issues/2476","id":1868707543,"node_id":"IC_kwDOBhmkcs5vYjbX","user":{"login":"wwbmmm","id":3894631,"node_id":"MDQ6VXNlcjM4OTQ2MzE=","avatar_url":"https://avatars.githubusercontent.com/u/3894631?v=4","gravatar_id":"","url":"https://api.github.com/users/wwbmmm","html_url":"https://github.com/wwbmmm","followers_url":"https://api.github.com/users/wwbmmm/followers","following_url":"https://api.github.com/users/wwbmmm/following{/other_user}","gists_url":"https://api.github.com/users/wwbmmm/gists{/gist_id}","starred_url":"https://api.github.com/users/wwbmmm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wwbmmm/subscriptions","organizations_url":"https://api.github.com/users/wwbmmm/orgs","repos_url":"https://api.github.com/users/wwbmmm/repos","events_url":"https://api.github.com/users/wwbmmm/events{/privacy}","received_events_url":"https://api.github.com/users/wwbmmm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-25T03:50:08Z","updated_at":"2023-12-25T03:50:08Z","author_association":"CONTRIBUTOR","body":"> @wwbmmm 我觉得brpc内部启动的协程，有些地方需要把bthread_tag设置正确，否则会存在跨线程池执行的问题，特别是socket.cpp这块。 其它地方我把握的不是很准确，请仔细review一下。\r\n\r\n类似BTHREAD_ATTR_NORMAL这些，能不能默认都设置成在本线程池执行？比如把tag的初始值设置成一个特殊值，表示在本线程池执行。因为BTHREAD_ATTR_NORMAL这些不只是在brpc框架会用，业务代码也会用到","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1868707543/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1868782196","html_url":"https://github.com/apache/brpc/pull/2476#issuecomment-1868782196","issue_url":"https://api.github.com/repos/apache/brpc/issues/2476","id":1868782196,"node_id":"IC_kwDOBhmkcs5vY1p0","user":{"login":"yanglimingcn","id":7091130,"node_id":"MDQ6VXNlcjcwOTExMzA=","avatar_url":"https://avatars.githubusercontent.com/u/7091130?v=4","gravatar_id":"","url":"https://api.github.com/users/yanglimingcn","html_url":"https://github.com/yanglimingcn","followers_url":"https://api.github.com/users/yanglimingcn/followers","following_url":"https://api.github.com/users/yanglimingcn/following{/other_user}","gists_url":"https://api.github.com/users/yanglimingcn/gists{/gist_id}","starred_url":"https://api.github.com/users/yanglimingcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yanglimingcn/subscriptions","organizations_url":"https://api.github.com/users/yanglimingcn/orgs","repos_url":"https://api.github.com/users/yanglimingcn/repos","events_url":"https://api.github.com/users/yanglimingcn/events{/privacy}","received_events_url":"https://api.github.com/users/yanglimingcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-25T06:33:35Z","updated_at":"2023-12-25T07:02:20Z","author_association":"CONTRIBUTOR","body":"> > @wwbmmm 我觉得brpc内部启动的协程，有些地方需要把bthread_tag设置正确，否则会存在跨线程池执行的问题，特别是socket.cpp这块。 其它地方我把握的不是很准确，请仔细review一下。\r\n> \r\n> 类似BTHREAD_ATTR_NORMAL这些，能不能默认都设置成在本线程池执行？比如把tag的初始值设置成一个特殊值，表示在本线程池执行。因为BTHREAD_ATTR_NORMAL这些不只是在brpc框架会用，业务代码也会用到\r\n\r\n我这边加了一个BTHREAD_TAG_INVALID，是BTHREAD_ATTR_NORMAL这些的默认值，如果用户启动的协程用了这些的话，会在默认的local线程池中执行。\r\n\r\n这么改之后，brpc内部的有些地方感觉也不需要改了","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1868782196/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1869247484","html_url":"https://github.com/apache/brpc/pull/2476#issuecomment-1869247484","issue_url":"https://api.github.com/repos/apache/brpc/issues/2476","id":1869247484,"node_id":"IC_kwDOBhmkcs5vanP8","user":{"login":"wwbmmm","id":3894631,"node_id":"MDQ6VXNlcjM4OTQ2MzE=","avatar_url":"https://avatars.githubusercontent.com/u/3894631?v=4","gravatar_id":"","url":"https://api.github.com/users/wwbmmm","html_url":"https://github.com/wwbmmm","followers_url":"https://api.github.com/users/wwbmmm/followers","following_url":"https://api.github.com/users/wwbmmm/following{/other_user}","gists_url":"https://api.github.com/users/wwbmmm/gists{/gist_id}","starred_url":"https://api.github.com/users/wwbmmm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wwbmmm/subscriptions","organizations_url":"https://api.github.com/users/wwbmmm/orgs","repos_url":"https://api.github.com/users/wwbmmm/repos","events_url":"https://api.github.com/users/wwbmmm/events{/privacy}","received_events_url":"https://api.github.com/users/wwbmmm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-26T04:35:43Z","updated_at":"2023-12-26T04:35:43Z","author_association":"CONTRIBUTOR","body":"LGTM","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1869247484/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1869946914","html_url":"https://github.com/apache/brpc/pull/2482#issuecomment-1869946914","issue_url":"https://api.github.com/repos/apache/brpc/issues/2482","id":1869946914,"node_id":"IC_kwDOBhmkcs5vdSAi","user":{"login":"serverglen","id":38067377,"node_id":"MDQ6VXNlcjM4MDY3Mzc3","avatar_url":"https://avatars.githubusercontent.com/u/38067377?v=4","gravatar_id":"","url":"https://api.github.com/users/serverglen","html_url":"https://github.com/serverglen","followers_url":"https://api.github.com/users/serverglen/followers","following_url":"https://api.github.com/users/serverglen/following{/other_user}","gists_url":"https://api.github.com/users/serverglen/gists{/gist_id}","starred_url":"https://api.github.com/users/serverglen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/serverglen/subscriptions","organizations_url":"https://api.github.com/users/serverglen/orgs","repos_url":"https://api.github.com/users/serverglen/repos","events_url":"https://api.github.com/users/serverglen/events{/privacy}","received_events_url":"https://api.github.com/users/serverglen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-27T04:54:42Z","updated_at":"2023-12-27T04:54:42Z","author_association":"CONTRIBUTOR","body":"LGTM","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1869946914/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1869947528","html_url":"https://github.com/apache/brpc/pull/2483#issuecomment-1869947528","issue_url":"https://api.github.com/repos/apache/brpc/issues/2483","id":1869947528,"node_id":"IC_kwDOBhmkcs5vdSKI","user":{"login":"serverglen","id":38067377,"node_id":"MDQ6VXNlcjM4MDY3Mzc3","avatar_url":"https://avatars.githubusercontent.com/u/38067377?v=4","gravatar_id":"","url":"https://api.github.com/users/serverglen","html_url":"https://github.com/serverglen","followers_url":"https://api.github.com/users/serverglen/followers","following_url":"https://api.github.com/users/serverglen/following{/other_user}","gists_url":"https://api.github.com/users/serverglen/gists{/gist_id}","starred_url":"https://api.github.com/users/serverglen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/serverglen/subscriptions","organizations_url":"https://api.github.com/users/serverglen/orgs","repos_url":"https://api.github.com/users/serverglen/repos","events_url":"https://api.github.com/users/serverglen/events{/privacy}","received_events_url":"https://api.github.com/users/serverglen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-27T04:56:12Z","updated_at":"2023-12-27T04:56:12Z","author_association":"CONTRIBUTOR","body":"LGTM","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1869947528/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1870774923","html_url":"https://github.com/apache/brpc/issues/2485#issuecomment-1870774923","issue_url":"https://api.github.com/repos/apache/brpc/issues/2485","id":1870774923,"node_id":"IC_kwDOBhmkcs5vgcKL","user":{"login":"duishuhaoqi","id":50567662,"node_id":"MDQ6VXNlcjUwNTY3NjYy","avatar_url":"https://avatars.githubusercontent.com/u/50567662?v=4","gravatar_id":"","url":"https://api.github.com/users/duishuhaoqi","html_url":"https://github.com/duishuhaoqi","followers_url":"https://api.github.com/users/duishuhaoqi/followers","following_url":"https://api.github.com/users/duishuhaoqi/following{/other_user}","gists_url":"https://api.github.com/users/duishuhaoqi/gists{/gist_id}","starred_url":"https://api.github.com/users/duishuhaoqi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/duishuhaoqi/subscriptions","organizations_url":"https://api.github.com/users/duishuhaoqi/orgs","repos_url":"https://api.github.com/users/duishuhaoqi/repos","events_url":"https://api.github.com/users/duishuhaoqi/events{/privacy}","received_events_url":"https://api.github.com/users/duishuhaoqi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-28T02:51:46Z","updated_at":"2023-12-28T02:51:46Z","author_association":"NONE","body":"![image](https://github.com/apache/brpc/assets/50567662/af653ee3-df39-411a-913b-1bfb75c561f3)\r\n","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1870774923/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1870789672","html_url":"https://github.com/apache/brpc/issues/2485#issuecomment-1870789672","issue_url":"https://api.github.com/repos/apache/brpc/issues/2485","id":1870789672,"node_id":"IC_kwDOBhmkcs5vgfwo","user":{"login":"TousakaRin","id":8801314,"node_id":"MDQ6VXNlcjg4MDEzMTQ=","avatar_url":"https://avatars.githubusercontent.com/u/8801314?v=4","gravatar_id":"","url":"https://api.github.com/users/TousakaRin","html_url":"https://github.com/TousakaRin","followers_url":"https://api.github.com/users/TousakaRin/followers","following_url":"https://api.github.com/users/TousakaRin/following{/other_user}","gists_url":"https://api.github.com/users/TousakaRin/gists{/gist_id}","starred_url":"https://api.github.com/users/TousakaRin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TousakaRin/subscriptions","organizations_url":"https://api.github.com/users/TousakaRin/orgs","repos_url":"https://api.github.com/users/TousakaRin/repos","events_url":"https://api.github.com/users/TousakaRin/events{/privacy}","received_events_url":"https://api.github.com/users/TousakaRin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-28T03:29:58Z","updated_at":"2023-12-28T03:29:58Z","author_association":"CONTRIBUTOR","body":"可以打开rpcz，然后在查询时根据lantecy进行过滤超过500ms的请求，一般来说很容易看到。另外可以检查以下代码里是否使用了brpc的timer功能并且在callback里使用了可能阻塞的代码（不管是阻塞bthread还是phtread都可能会导致这个问题）","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1870789672/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1870791629","html_url":"https://github.com/apache/brpc/issues/2460#issuecomment-1870791629","issue_url":"https://api.github.com/repos/apache/brpc/issues/2460","id":1870791629,"node_id":"IC_kwDOBhmkcs5vggPN","user":{"login":"TousakaRin","id":8801314,"node_id":"MDQ6VXNlcjg4MDEzMTQ=","avatar_url":"https://avatars.githubusercontent.com/u/8801314?v=4","gravatar_id":"","url":"https://api.github.com/users/TousakaRin","html_url":"https://github.com/TousakaRin","followers_url":"https://api.github.com/users/TousakaRin/followers","following_url":"https://api.github.com/users/TousakaRin/following{/other_user}","gists_url":"https://api.github.com/users/TousakaRin/gists{/gist_id}","starred_url":"https://api.github.com/users/TousakaRin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TousakaRin/subscriptions","organizations_url":"https://api.github.com/users/TousakaRin/orgs","repos_url":"https://api.github.com/users/TousakaRin/repos","events_url":"https://api.github.com/users/TousakaRin/events{/privacy}","received_events_url":"https://api.github.com/users/TousakaRin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-28T03:35:04Z","updated_at":"2023-12-28T03:35:04Z","author_association":"CONTRIBUTOR","body":"gmock应该是可以把 channel 的 CallMethod 直接 mock 掉，替换成你想要的逻辑。但是这样的话可能会对代码有入侵（即用于 rpc 的 channel 是从外部传递进来的）。 ","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1870791629/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1870886754","html_url":"https://github.com/apache/brpc/pull/2121#issuecomment-1870886754","issue_url":"https://api.github.com/repos/apache/brpc/issues/2121","id":1870886754,"node_id":"IC_kwDOBhmkcs5vg3di","user":{"login":"stdpain","id":34912776,"node_id":"MDQ6VXNlcjM0OTEyNzc2","avatar_url":"https://avatars.githubusercontent.com/u/34912776?v=4","gravatar_id":"","url":"https://api.github.com/users/stdpain","html_url":"https://github.com/stdpain","followers_url":"https://api.github.com/users/stdpain/followers","following_url":"https://api.github.com/users/stdpain/following{/other_user}","gists_url":"https://api.github.com/users/stdpain/gists{/gist_id}","starred_url":"https://api.github.com/users/stdpain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stdpain/subscriptions","organizations_url":"https://api.github.com/users/stdpain/orgs","repos_url":"https://api.github.com/users/stdpain/repos","events_url":"https://api.github.com/users/stdpain/events{/privacy}","received_events_url":"https://api.github.com/users/stdpain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-28T07:09:23Z","updated_at":"2023-12-28T07:09:23Z","author_association":"CONTRIBUTOR","body":"如果调整系统的mmap_max_count，可以达到coroutine一样的效果吗","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1870886754/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1872493392","html_url":"https://github.com/apache/brpc/pull/1996#issuecomment-1872493392","issue_url":"https://api.github.com/repos/apache/brpc/issues/1996","id":1872493392,"node_id":"IC_kwDOBhmkcs5vm_tQ","user":{"login":"89dexua","id":3748205,"node_id":"MDQ6VXNlcjM3NDgyMDU=","avatar_url":"https://avatars.githubusercontent.com/u/3748205?v=4","gravatar_id":"","url":"https://api.github.com/users/89dexua","html_url":"https://github.com/89dexua","followers_url":"https://api.github.com/users/89dexua/followers","following_url":"https://api.github.com/users/89dexua/following{/other_user}","gists_url":"https://api.github.com/users/89dexua/gists{/gist_id}","starred_url":"https://api.github.com/users/89dexua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/89dexua/subscriptions","organizations_url":"https://api.github.com/users/89dexua/orgs","repos_url":"https://api.github.com/users/89dexua/repos","events_url":"https://api.github.com/users/89dexua/events{/privacy}","received_events_url":"https://api.github.com/users/89dexua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-30T09:40:53Z","updated_at":"2023-12-30T09:41:32Z","author_association":"NONE","body":"Any chance to support protobuf 3.21.9\r\nTensorflow 2.15.0 not Compatible with protobuf 3.19.1\r\n\r\nSimply change the protobuf version got this error message \r\n\r\nERROR: brpc/example/BUILD.bazel:40:14: every rule of type proto_library implicitly depends upon the target '@com_google_protobuf//:protoc', but this target could not be found because of: error loading package '@com_google_protobuf//': cannot load '@com_google_protobuf//:compiler_config_setting.bzl': no such file","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1872493392/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1872626387","html_url":"https://github.com/apache/brpc/pull/2476#issuecomment-1872626387","issue_url":"https://api.github.com/repos/apache/brpc/issues/2476","id":1872626387,"node_id":"IC_kwDOBhmkcs5vngLT","user":{"login":"yanglimingcn","id":7091130,"node_id":"MDQ6VXNlcjcwOTExMzA=","avatar_url":"https://avatars.githubusercontent.com/u/7091130?v=4","gravatar_id":"","url":"https://api.github.com/users/yanglimingcn","html_url":"https://github.com/yanglimingcn","followers_url":"https://api.github.com/users/yanglimingcn/followers","following_url":"https://api.github.com/users/yanglimingcn/following{/other_user}","gists_url":"https://api.github.com/users/yanglimingcn/gists{/gist_id}","starred_url":"https://api.github.com/users/yanglimingcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yanglimingcn/subscriptions","organizations_url":"https://api.github.com/users/yanglimingcn/orgs","repos_url":"https://api.github.com/users/yanglimingcn/repos","events_url":"https://api.github.com/users/yanglimingcn/events{/privacy}","received_events_url":"https://api.github.com/users/yanglimingcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-30T23:35:19Z","updated_at":"2023-12-31T00:32:09Z","author_association":"CONTRIBUTOR","body":"> LGTM\r\n\r\n拆分线程池后，有些原来服务于一个线程池的routine现在服务于多个线程池，如果这个routine内部有bthread锁，就会发生问题，因为线程池之间不能被唤醒。另外就是跨线程池创建协程，使用了bthread锁。\r\nbrpc内部的routine有这种case吗？我看多数用的butil:Mutex，那内部routine使用锁的原则是怎么样的？\r\n目前我能搜到的使用bthread::Mutex(bthread_mutex_*)的地方有，stream.cpp，id.cpp，有没有风险。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1872626387/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1873190741","html_url":"https://github.com/apache/brpc/pull/2413#issuecomment-1873190741","issue_url":"https://api.github.com/repos/apache/brpc/issues/2413","id":1873190741,"node_id":"IC_kwDOBhmkcs5vpp9V","user":{"login":"chenBright","id":12249635,"node_id":"MDQ6VXNlcjEyMjQ5NjM1","avatar_url":"https://avatars.githubusercontent.com/u/12249635?v=4","gravatar_id":"","url":"https://api.github.com/users/chenBright","html_url":"https://github.com/chenBright","followers_url":"https://api.github.com/users/chenBright/followers","following_url":"https://api.github.com/users/chenBright/following{/other_user}","gists_url":"https://api.github.com/users/chenBright/gists{/gist_id}","starred_url":"https://api.github.com/users/chenBright/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenBright/subscriptions","organizations_url":"https://api.github.com/users/chenBright/orgs","repos_url":"https://api.github.com/users/chenBright/repos","events_url":"https://api.github.com/users/chenBright/events{/privacy}","received_events_url":"https://api.github.com/users/chenBright/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-01T06:55:26Z","updated_at":"2024-01-01T06:55:26Z","author_association":"CONTRIBUTOR","body":"1. 每次都会消费完所有日志，所以传入IsComplete的肯定是singular node，同时也不需要获取cur_tail。已删除相关逻辑。\r\n2. 进程退出时候，将异步日志队列的日志落盘，并退出异步日志线程。如果在停异步日志线程的时候，有异步日志入队，则有第一个日志所在的线程/协程负责将队列的日志落盘。停止后的异步日志回退为同步日志。为了保证最后的异步日志能全部落盘，在异步日志线程停止（Join结束）后，sleep一小段时间。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1873190741/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1873194784","html_url":"https://github.com/apache/brpc/issues/1650#issuecomment-1873194784","issue_url":"https://api.github.com/repos/apache/brpc/issues/1650","id":1873194784,"node_id":"IC_kwDOBhmkcs5vpq8g","user":{"login":"lishunan246","id":4033385,"node_id":"MDQ6VXNlcjQwMzMzODU=","avatar_url":"https://avatars.githubusercontent.com/u/4033385?v=4","gravatar_id":"","url":"https://api.github.com/users/lishunan246","html_url":"https://github.com/lishunan246","followers_url":"https://api.github.com/users/lishunan246/followers","following_url":"https://api.github.com/users/lishunan246/following{/other_user}","gists_url":"https://api.github.com/users/lishunan246/gists{/gist_id}","starred_url":"https://api.github.com/users/lishunan246/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lishunan246/subscriptions","organizations_url":"https://api.github.com/users/lishunan246/orgs","repos_url":"https://api.github.com/users/lishunan246/repos","events_url":"https://api.github.com/users/lishunan246/events{/privacy}","received_events_url":"https://api.github.com/users/lishunan246/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-01T07:08:41Z","updated_at":"2024-01-01T07:08:41Z","author_association":"NONE","body":"期望支持","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1873194784/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1873600084","html_url":"https://github.com/apache/brpc/issues/2466#issuecomment-1873600084","issue_url":"https://api.github.com/repos/apache/brpc/issues/2466","id":1873600084,"node_id":"IC_kwDOBhmkcs5vrN5U","user":{"login":"lorinlee","id":16054841,"node_id":"MDQ6VXNlcjE2MDU0ODQx","avatar_url":"https://avatars.githubusercontent.com/u/16054841?v=4","gravatar_id":"","url":"https://api.github.com/users/lorinlee","html_url":"https://github.com/lorinlee","followers_url":"https://api.github.com/users/lorinlee/followers","following_url":"https://api.github.com/users/lorinlee/following{/other_user}","gists_url":"https://api.github.com/users/lorinlee/gists{/gist_id}","starred_url":"https://api.github.com/users/lorinlee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lorinlee/subscriptions","organizations_url":"https://api.github.com/users/lorinlee/orgs","repos_url":"https://api.github.com/users/lorinlee/repos","events_url":"https://api.github.com/users/lorinlee/events{/privacy}","received_events_url":"https://api.github.com/users/lorinlee/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-02T03:52:16Z","updated_at":"2024-01-02T03:53:43Z","author_association":"CONTRIBUTOR","body":"@sinomiko intrusive_ptr的计数是在对象上的，和shared_ptr是不一样的，为什么会重复析构","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1873600084/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1873774338","html_url":"https://github.com/apache/brpc/issues/2489#issuecomment-1873774338","issue_url":"https://api.github.com/repos/apache/brpc/issues/2489","id":1873774338,"node_id":"IC_kwDOBhmkcs5vr4cC","user":{"login":"TousakaRin","id":8801314,"node_id":"MDQ6VXNlcjg4MDEzMTQ=","avatar_url":"https://avatars.githubusercontent.com/u/8801314?v=4","gravatar_id":"","url":"https://api.github.com/users/TousakaRin","html_url":"https://github.com/TousakaRin","followers_url":"https://api.github.com/users/TousakaRin/followers","following_url":"https://api.github.com/users/TousakaRin/following{/other_user}","gists_url":"https://api.github.com/users/TousakaRin/gists{/gist_id}","starred_url":"https://api.github.com/users/TousakaRin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TousakaRin/subscriptions","organizations_url":"https://api.github.com/users/TousakaRin/orgs","repos_url":"https://api.github.com/users/TousakaRin/repos","events_url":"https://api.github.com/users/TousakaRin/events{/privacy}","received_events_url":"https://api.github.com/users/TousakaRin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-02T09:18:50Z","updated_at":"2024-01-02T09:18:50Z","author_association":"CONTRIBUTOR","body":"看了看文档，我尝试翻译一下:\r\n- [lock](https://www.felixcloutier.com/x86/lock) 前缀表示后续的指令是原子操作\r\n- [xaddl src dst](https://www.felixcloutier.com/x86/xadd):  等价于: temp = src + dst; src = dst; dst = temp; 也就是 fetch_add。\r\n- `+r (temp), +m(*ptr)`， 这一句是表明这段汇编代码的输出操作数，也就是这个汇编代码会改变的变量，其中 temp 由编译器选一个寄存器保存，记为%0，*ptr 则需要直接访问内存，记为 %1\r\n- `lock xaddl %0, %1`，这里注意gcc的汇编语法第一个数是src操作数，intel语法第一个是dst操作数。所以 %0 对应xaddl 指令中的src, %1 对应 dst\r\n\r\n综上所述，这段汇编代码翻译过来就是\r\n```c++\r\nAtomic32 temp = increment;\r\n\r\n// 以下三行是原子操作\r\nAtomic32 asm_temp = temp + *ptr;\r\ntemp = *ptr;\r\n*ptr = asm_temp;\r\n\r\nreturn temp + increment\r\n```\r\n所以说，ptr 中保存的就是相加后的值。对gcc内嵌汇编也不是特别熟悉，有错误欢迎指正。\r\n","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1873774338/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1874862827","html_url":"https://github.com/apache/brpc/pull/2491#issuecomment-1874862827","issue_url":"https://api.github.com/repos/apache/brpc/issues/2491","id":1874862827,"node_id":"IC_kwDOBhmkcs5vwCLr","user":{"login":"lengmoXXL","id":19929075,"node_id":"MDQ6VXNlcjE5OTI5MDc1","avatar_url":"https://avatars.githubusercontent.com/u/19929075?v=4","gravatar_id":"","url":"https://api.github.com/users/lengmoXXL","html_url":"https://github.com/lengmoXXL","followers_url":"https://api.github.com/users/lengmoXXL/followers","following_url":"https://api.github.com/users/lengmoXXL/following{/other_user}","gists_url":"https://api.github.com/users/lengmoXXL/gists{/gist_id}","starred_url":"https://api.github.com/users/lengmoXXL/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lengmoXXL/subscriptions","organizations_url":"https://api.github.com/users/lengmoXXL/orgs","repos_url":"https://api.github.com/users/lengmoXXL/repos","events_url":"https://api.github.com/users/lengmoXXL/events{/privacy}","received_events_url":"https://api.github.com/users/lengmoXXL/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-03T05:22:29Z","updated_at":"2024-01-03T05:22:29Z","author_association":"CONTRIBUTOR","body":"该问题由 pr #2284 引入","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1874862827/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1875059108","html_url":"https://github.com/apache/brpc/issues/2466#issuecomment-1875059108","issue_url":"https://api.github.com/repos/apache/brpc/issues/2466","id":1875059108,"node_id":"IC_kwDOBhmkcs5vwyGk","user":{"login":"sinomiko","id":12888642,"node_id":"MDQ6VXNlcjEyODg4NjQy","avatar_url":"https://avatars.githubusercontent.com/u/12888642?v=4","gravatar_id":"","url":"https://api.github.com/users/sinomiko","html_url":"https://github.com/sinomiko","followers_url":"https://api.github.com/users/sinomiko/followers","following_url":"https://api.github.com/users/sinomiko/following{/other_user}","gists_url":"https://api.github.com/users/sinomiko/gists{/gist_id}","starred_url":"https://api.github.com/users/sinomiko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sinomiko/subscriptions","organizations_url":"https://api.github.com/users/sinomiko/orgs","repos_url":"https://api.github.com/users/sinomiko/repos","events_url":"https://api.github.com/users/sinomiko/events{/privacy}","received_events_url":"https://api.github.com/users/sinomiko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-03T09:21:01Z","updated_at":"2024-01-03T09:21:01Z","author_association":"CONTRIBUTOR","body":"@lorinlee 可以的。\r\n\r\n但旧接口会导致很多误解。\r\n比如ut中AddChannel用法，假设 NCHANS = 0，就会直接泄漏资源。\r\nhttps://github.com/apache/brpc/blob/dc9e786fbb5fd79f08b49fa8d55ec4e1a35f2125/test/brpc_channel_unittest.cpp#L634C18-L634C26\r\n\r\n也有很多代码写了\r\nbrpc::ResponseMerger* merger =  new XXResponseMerger(); \r\n将 merger传入AddChannel；\r\n\r\n如果AddChannel失败，就会泄漏资源；\r\n其次在很多业务会 new CallMapper，new ResponseMerger 后执行一堆操作，而AddChannel 可有可能后续不再调用，就会有潜在泄漏问题。\r\n\r\n使用新接口必须用 intrusive_ptr 管理及传递，就可以避免这种潜在问题。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1875059108/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1876959889","html_url":"https://github.com/apache/brpc/pull/2493#issuecomment-1876959889","issue_url":"https://api.github.com/repos/apache/brpc/issues/2493","id":1876959889,"node_id":"IC_kwDOBhmkcs5v4CKR","user":{"login":"chenBright","id":12249635,"node_id":"MDQ6VXNlcjEyMjQ5NjM1","avatar_url":"https://avatars.githubusercontent.com/u/12249635?v=4","gravatar_id":"","url":"https://api.github.com/users/chenBright","html_url":"https://github.com/chenBright","followers_url":"https://api.github.com/users/chenBright/followers","following_url":"https://api.github.com/users/chenBright/following{/other_user}","gists_url":"https://api.github.com/users/chenBright/gists{/gist_id}","starred_url":"https://api.github.com/users/chenBright/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenBright/subscriptions","organizations_url":"https://api.github.com/users/chenBright/orgs","repos_url":"https://api.github.com/users/chenBright/repos","events_url":"https://api.github.com/users/chenBright/events{/privacy}","received_events_url":"https://api.github.com/users/chenBright/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-04T11:42:44Z","updated_at":"2024-01-04T11:42:44Z","author_association":"CONTRIBUTOR","body":"HealthService好像已经支持了吧。\r\nhttps://github.com/apache/brpc/blob/master/src/brpc/builtin/health_service.cpp","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1876959889/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1877034356","html_url":"https://github.com/apache/brpc/pull/2493#issuecomment-1877034356","issue_url":"https://api.github.com/repos/apache/brpc/issues/2493","id":1877034356,"node_id":"IC_kwDOBhmkcs5v4UV0","user":{"login":"jiangyt-git","id":64257436,"node_id":"MDQ6VXNlcjY0MjU3NDM2","avatar_url":"https://avatars.githubusercontent.com/u/64257436?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangyt-git","html_url":"https://github.com/jiangyt-git","followers_url":"https://api.github.com/users/jiangyt-git/followers","following_url":"https://api.github.com/users/jiangyt-git/following{/other_user}","gists_url":"https://api.github.com/users/jiangyt-git/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangyt-git/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangyt-git/subscriptions","organizations_url":"https://api.github.com/users/jiangyt-git/orgs","repos_url":"https://api.github.com/users/jiangyt-git/repos","events_url":"https://api.github.com/users/jiangyt-git/events{/privacy}","received_events_url":"https://api.github.com/users/jiangyt-git/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-04T12:40:22Z","updated_at":"2024-01-04T12:40:22Z","author_association":"CONTRIBUTOR","body":"> HealthService好像已经支持了吧。 https://github.com/apache/brpc/blob/master/src/brpc/builtin/health_service.cpp\r\n\r\n支持的grpc 官方定义的健康检查协议，response是这样的：\r\nmessage HealthCheckResponse {\r\n    enum ServingStatus {\r\n        UNKNOWN = 0;\r\n        SERVING = 1;\r\n        NOT_SERVING = 2;\r\n        SERVICE_UNKNOWN = 3;  // Used only by the Watch method.\r\n    }\r\n    optional ServingStatus status = 1;\r\n}","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1877034356/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1877066322","html_url":"https://github.com/apache/brpc/pull/2493#issuecomment-1877066322","issue_url":"https://api.github.com/repos/apache/brpc/issues/2493","id":1877066322,"node_id":"IC_kwDOBhmkcs5v4cJS","user":{"login":"jiangyt-git","id":64257436,"node_id":"MDQ6VXNlcjY0MjU3NDM2","avatar_url":"https://avatars.githubusercontent.com/u/64257436?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangyt-git","html_url":"https://github.com/jiangyt-git","followers_url":"https://api.github.com/users/jiangyt-git/followers","following_url":"https://api.github.com/users/jiangyt-git/following{/other_user}","gists_url":"https://api.github.com/users/jiangyt-git/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangyt-git/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangyt-git/subscriptions","organizations_url":"https://api.github.com/users/jiangyt-git/orgs","repos_url":"https://api.github.com/users/jiangyt-git/repos","events_url":"https://api.github.com/users/jiangyt-git/events{/privacy}","received_events_url":"https://api.github.com/users/jiangyt-git/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-04T13:05:46Z","updated_at":"2024-01-04T13:05:46Z","author_association":"CONTRIBUTOR","body":"> > HealthService好像已经支持了吧。 https://github.com/apache/brpc/blob/master/src/brpc/builtin/health_service.cpp\r\n> \r\n> 支持的grpc 官方定义的健康检查协议，response是这样的： message HealthCheckResponse { enum ServingStatus { UNKNOWN = 0; SERVING = 1; NOT_SERVING = 2; SERVICE_UNKNOWN = 3; // Used only by the Watch method. } optional ServingStatus status = 1; }\r\n\r\n请求对应的path是: /grpc.health.v1.Health/Check","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1877066322/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1877434730","html_url":"https://github.com/apache/brpc/pull/2493#issuecomment-1877434730","issue_url":"https://api.github.com/repos/apache/brpc/issues/2493","id":1877434730,"node_id":"IC_kwDOBhmkcs5v52Fq","user":{"login":"chenBright","id":12249635,"node_id":"MDQ6VXNlcjEyMjQ5NjM1","avatar_url":"https://avatars.githubusercontent.com/u/12249635?v=4","gravatar_id":"","url":"https://api.github.com/users/chenBright","html_url":"https://github.com/chenBright","followers_url":"https://api.github.com/users/chenBright/followers","following_url":"https://api.github.com/users/chenBright/following{/other_user}","gists_url":"https://api.github.com/users/chenBright/gists{/gist_id}","starred_url":"https://api.github.com/users/chenBright/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenBright/subscriptions","organizations_url":"https://api.github.com/users/chenBright/orgs","repos_url":"https://api.github.com/users/chenBright/repos","events_url":"https://api.github.com/users/chenBright/events{/privacy}","received_events_url":"https://api.github.com/users/chenBright/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-04T16:49:39Z","updated_at":"2024-01-04T16:49:39Z","author_association":"CONTRIBUTOR","body":"health_reporter满足不了grpc健康检查的要求吧，获取不了HealthCheckRequest和设置不了HealthCheckResponse。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1877434730/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1878075189","html_url":"https://github.com/apache/brpc/pull/2493#issuecomment-1878075189","issue_url":"https://api.github.com/repos/apache/brpc/issues/2493","id":1878075189,"node_id":"IC_kwDOBhmkcs5v8Sc1","user":{"login":"jiangyt-git","id":64257436,"node_id":"MDQ6VXNlcjY0MjU3NDM2","avatar_url":"https://avatars.githubusercontent.com/u/64257436?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangyt-git","html_url":"https://github.com/jiangyt-git","followers_url":"https://api.github.com/users/jiangyt-git/followers","following_url":"https://api.github.com/users/jiangyt-git/following{/other_user}","gists_url":"https://api.github.com/users/jiangyt-git/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangyt-git/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangyt-git/subscriptions","organizations_url":"https://api.github.com/users/jiangyt-git/orgs","repos_url":"https://api.github.com/users/jiangyt-git/repos","events_url":"https://api.github.com/users/jiangyt-git/events{/privacy}","received_events_url":"https://api.github.com/users/jiangyt-git/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-05T03:30:37Z","updated_at":"2024-01-05T03:30:37Z","author_association":"CONTRIBUTOR","body":"> health_reporter满足不了grpc健康检查的要求吧，获取不了HealthCheckRequest和设置不了HealthCheckResponse。\r\n\r\ngrpc和http 都是写的 cntl->response_attachment()，理论上是可以定制的。\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1878075189/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1878079641","html_url":"https://github.com/apache/brpc/pull/2493#issuecomment-1878079641","issue_url":"https://api.github.com/repos/apache/brpc/issues/2493","id":1878079641,"node_id":"IC_kwDOBhmkcs5v8TiZ","user":{"login":"chenBright","id":12249635,"node_id":"MDQ6VXNlcjEyMjQ5NjM1","avatar_url":"https://avatars.githubusercontent.com/u/12249635?v=4","gravatar_id":"","url":"https://api.github.com/users/chenBright","html_url":"https://github.com/chenBright","followers_url":"https://api.github.com/users/chenBright/followers","following_url":"https://api.github.com/users/chenBright/following{/other_user}","gists_url":"https://api.github.com/users/chenBright/gists{/gist_id}","starred_url":"https://api.github.com/users/chenBright/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenBright/subscriptions","organizations_url":"https://api.github.com/users/chenBright/orgs","repos_url":"https://api.github.com/users/chenBright/repos","events_url":"https://api.github.com/users/chenBright/events{/privacy}","received_events_url":"https://api.github.com/users/chenBright/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-05T03:39:38Z","updated_at":"2024-01-05T03:39:38Z","author_association":"CONTRIBUTOR","body":"可以补充一下UT吗","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1878079641/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1878081248","html_url":"https://github.com/apache/brpc/pull/2493#issuecomment-1878081248","issue_url":"https://api.github.com/repos/apache/brpc/issues/2493","id":1878081248,"node_id":"IC_kwDOBhmkcs5v8T7g","user":{"login":"jiangyt-git","id":64257436,"node_id":"MDQ6VXNlcjY0MjU3NDM2","avatar_url":"https://avatars.githubusercontent.com/u/64257436?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangyt-git","html_url":"https://github.com/jiangyt-git","followers_url":"https://api.github.com/users/jiangyt-git/followers","following_url":"https://api.github.com/users/jiangyt-git/following{/other_user}","gists_url":"https://api.github.com/users/jiangyt-git/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangyt-git/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangyt-git/subscriptions","organizations_url":"https://api.github.com/users/jiangyt-git/orgs","repos_url":"https://api.github.com/users/jiangyt-git/repos","events_url":"https://api.github.com/users/jiangyt-git/events{/privacy}","received_events_url":"https://api.github.com/users/jiangyt-git/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-05T03:42:50Z","updated_at":"2024-01-05T03:42:50Z","author_association":"CONTRIBUTOR","body":"> 可以补充一下UT吗\r\n\r\n好的，我补一下。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1878081248/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1879503854","html_url":"https://github.com/apache/brpc/pull/2493#issuecomment-1879503854","issue_url":"https://api.github.com/repos/apache/brpc/issues/2493","id":1879503854,"node_id":"IC_kwDOBhmkcs5wBvPu","user":{"login":"jiangyt-git","id":64257436,"node_id":"MDQ6VXNlcjY0MjU3NDM2","avatar_url":"https://avatars.githubusercontent.com/u/64257436?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangyt-git","html_url":"https://github.com/jiangyt-git","followers_url":"https://api.github.com/users/jiangyt-git/followers","following_url":"https://api.github.com/users/jiangyt-git/following{/other_user}","gists_url":"https://api.github.com/users/jiangyt-git/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangyt-git/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangyt-git/subscriptions","organizations_url":"https://api.github.com/users/jiangyt-git/orgs","repos_url":"https://api.github.com/users/jiangyt-git/repos","events_url":"https://api.github.com/users/jiangyt-git/events{/privacy}","received_events_url":"https://api.github.com/users/jiangyt-git/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-06T02:29:55Z","updated_at":"2024-01-06T02:29:55Z","author_association":"CONTRIBUTOR","body":"> 可以补充一下UT吗\r\n已经加好了","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1879503854/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1879598514","html_url":"https://github.com/apache/brpc/pull/2494#issuecomment-1879598514","issue_url":"https://api.github.com/repos/apache/brpc/issues/2494","id":1879598514,"node_id":"IC_kwDOBhmkcs5wCGWy","user":{"login":"chenBright","id":12249635,"node_id":"MDQ6VXNlcjEyMjQ5NjM1","avatar_url":"https://avatars.githubusercontent.com/u/12249635?v=4","gravatar_id":"","url":"https://api.github.com/users/chenBright","html_url":"https://github.com/chenBright","followers_url":"https://api.github.com/users/chenBright/followers","following_url":"https://api.github.com/users/chenBright/following{/other_user}","gists_url":"https://api.github.com/users/chenBright/gists{/gist_id}","starred_url":"https://api.github.com/users/chenBright/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenBright/subscriptions","organizations_url":"https://api.github.com/users/chenBright/orgs","repos_url":"https://api.github.com/users/chenBright/repos","events_url":"https://api.github.com/users/chenBright/events{/privacy}","received_events_url":"https://api.github.com/users/chenBright/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-06T08:56:36Z","updated_at":"2024-01-06T08:56:36Z","author_association":"CONTRIBUTOR","body":"Thanks for the contribution.","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1879598514/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1880244787","html_url":"https://github.com/apache/brpc/issues/1724#issuecomment-1880244787","issue_url":"https://api.github.com/repos/apache/brpc/issues/1724","id":1880244787,"node_id":"IC_kwDOBhmkcs5wEkIz","user":{"login":"dxw1997","id":21140875,"node_id":"MDQ6VXNlcjIxMTQwODc1","avatar_url":"https://avatars.githubusercontent.com/u/21140875?v=4","gravatar_id":"","url":"https://api.github.com/users/dxw1997","html_url":"https://github.com/dxw1997","followers_url":"https://api.github.com/users/dxw1997/followers","following_url":"https://api.github.com/users/dxw1997/following{/other_user}","gists_url":"https://api.github.com/users/dxw1997/gists{/gist_id}","starred_url":"https://api.github.com/users/dxw1997/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dxw1997/subscriptions","organizations_url":"https://api.github.com/users/dxw1997/orgs","repos_url":"https://api.github.com/users/dxw1997/repos","events_url":"https://api.github.com/users/dxw1997/events{/privacy}","received_events_url":"https://api.github.com/users/dxw1997/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-08T00:25:45Z","updated_at":"2024-01-08T00:25:45Z","author_association":"NONE","body":"> 你比较的是bthread vs. ”pthread线程池“，还是bthread vs. “纯异步\"? pthread线程池的代价是一旦阻塞只能阻塞pthread，影响并发度（也就是pthread线程的个数），后者代码难写。bthread就是平衡一下这两者。\r\n\r\n还是有一点不懂。我现在在bthread中同步调用下游的一个服务，同步调用的时候调用端会阻塞在一个锁上，这时候在调用端bthread所跑的pthread上，会出现bthread的切换吗?","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1880244787/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1882382246","html_url":"https://github.com/apache/brpc/pull/2497#issuecomment-1882382246","issue_url":"https://api.github.com/repos/apache/brpc/issues/2497","id":1882382246,"node_id":"IC_kwDOBhmkcs5wMt-m","user":{"login":"sinomiko","id":12888642,"node_id":"MDQ6VXNlcjEyODg4NjQy","avatar_url":"https://avatars.githubusercontent.com/u/12888642?v=4","gravatar_id":"","url":"https://api.github.com/users/sinomiko","html_url":"https://github.com/sinomiko","followers_url":"https://api.github.com/users/sinomiko/followers","following_url":"https://api.github.com/users/sinomiko/following{/other_user}","gists_url":"https://api.github.com/users/sinomiko/gists{/gist_id}","starred_url":"https://api.github.com/users/sinomiko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sinomiko/subscriptions","organizations_url":"https://api.github.com/users/sinomiko/orgs","repos_url":"https://api.github.com/users/sinomiko/repos","events_url":"https://api.github.com/users/sinomiko/events{/privacy}","received_events_url":"https://api.github.com/users/sinomiko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-09T04:07:50Z","updated_at":"2024-01-09T04:07:50Z","author_association":"CONTRIBUTOR","body":"借问个问题\r\n\r\n![image](https://github.com/apache/brpc/assets/12888642/600d86bb-00e0-45d2-a2a5-fbaf31d60d53)\r\n\r\n\r\n这种被socket read创建的io block被 其他类似压缩/解压通过tls共享的io block有什么办法强制回收；\r\n\r\n如果业务中 收包很大，挂到tls共享出来了，解压/解压通过也可能用这块io buf的block。\r\n如果socket不断开，这块io buf一直在；\r\n\r\n可否主动调用这个代码，强制socket归还 block\r\nm->_read_buf.return_cached_blocks();\r\n```\r\n    m->AddInputMessages(1);\r\n        // Calculate average size of messages\r\n        const size_t cur_size = m->_read_buf.length();\r\n        if (cur_size == 0) {\r\n            // _read_buf is consumed, it's good timing to return blocks\r\n            // cached internally back to TLS, otherwise the memory is not\r\n            // reused until next message arrives which is quite uncertain\r\n            // in situations that most connections are idle.\r\n            m->_read_buf.return_cached_blocks();\r\n        }\r\n```","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1882382246/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1882471364","html_url":"https://github.com/apache/brpc/pull/2497#issuecomment-1882471364","issue_url":"https://api.github.com/repos/apache/brpc/issues/2497","id":1882471364,"node_id":"IC_kwDOBhmkcs5wNDvE","user":{"login":"chenBright","id":12249635,"node_id":"MDQ6VXNlcjEyMjQ5NjM1","avatar_url":"https://avatars.githubusercontent.com/u/12249635?v=4","gravatar_id":"","url":"https://api.github.com/users/chenBright","html_url":"https://github.com/chenBright","followers_url":"https://api.github.com/users/chenBright/followers","following_url":"https://api.github.com/users/chenBright/following{/other_user}","gists_url":"https://api.github.com/users/chenBright/gists{/gist_id}","starred_url":"https://api.github.com/users/chenBright/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenBright/subscriptions","organizations_url":"https://api.github.com/users/chenBright/orgs","repos_url":"https://api.github.com/users/chenBright/repos","events_url":"https://api.github.com/users/chenBright/events{/privacy}","received_events_url":"https://api.github.com/users/chenBright/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-09T06:15:38Z","updated_at":"2024-01-09T07:35:26Z","author_association":"CONTRIBUTOR","body":"socket 不会一直持有申请的block吧。每个请求解析的时候，从_read_buf cut出一个包长度的数据。直到socket在解析完_read_buf的数据，会调用`m->_read_buf.return_cached_blocks();`，归还_read_buf缓存的block（优先归还到tls的）。\r\n\r\n为了后续更快地分配block，每个线程的tls缓存block数软上限是8。应该不需要强制回收吧？","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1882471364/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1882494580","html_url":"https://github.com/apache/brpc/issues/982#issuecomment-1882494580","issue_url":"https://api.github.com/repos/apache/brpc/issues/982","id":1882494580,"node_id":"IC_kwDOBhmkcs5wNJZ0","user":{"login":"chenBright","id":12249635,"node_id":"MDQ6VXNlcjEyMjQ5NjM1","avatar_url":"https://avatars.githubusercontent.com/u/12249635?v=4","gravatar_id":"","url":"https://api.github.com/users/chenBright","html_url":"https://github.com/chenBright","followers_url":"https://api.github.com/users/chenBright/followers","following_url":"https://api.github.com/users/chenBright/following{/other_user}","gists_url":"https://api.github.com/users/chenBright/gists{/gist_id}","starred_url":"https://api.github.com/users/chenBright/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenBright/subscriptions","organizations_url":"https://api.github.com/users/chenBright/orgs","repos_url":"https://api.github.com/users/chenBright/repos","events_url":"https://api.github.com/users/chenBright/events{/privacy}","received_events_url":"https://api.github.com/users/chenBright/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-09T06:42:45Z","updated_at":"2024-01-09T06:42:45Z","author_association":"CONTRIBUTOR","body":"我理解，不执行过滤规则是为了避免漏删节点。考虑以下场景：NamingServiceFiler执行过滤规则增加了一个节点，但是等到该节点下线时，NamingServiceFiler过滤规则变了，导致没有没有删除该节点，这样lb里就一直存在一个“野”SocketId了。\r\n\r\nNamingServiceFiler是业务实现的，框架不能确保NamingServiceFiler规则会不会变更，所以不执行过滤规则能保证节点肯定能被删除，同时也不会有什么问题。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1882494580/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1882523124","html_url":"https://github.com/apache/brpc/issues/2484#issuecomment-1882523124","issue_url":"https://api.github.com/repos/apache/brpc/issues/2484","id":1882523124,"node_id":"IC_kwDOBhmkcs5wNQX0","user":{"login":"wwbmmm","id":3894631,"node_id":"MDQ6VXNlcjM4OTQ2MzE=","avatar_url":"https://avatars.githubusercontent.com/u/3894631?v=4","gravatar_id":"","url":"https://api.github.com/users/wwbmmm","html_url":"https://github.com/wwbmmm","followers_url":"https://api.github.com/users/wwbmmm/followers","following_url":"https://api.github.com/users/wwbmmm/following{/other_user}","gists_url":"https://api.github.com/users/wwbmmm/gists{/gist_id}","starred_url":"https://api.github.com/users/wwbmmm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wwbmmm/subscriptions","organizations_url":"https://api.github.com/users/wwbmmm/orgs","repos_url":"https://api.github.com/users/wwbmmm/repos","events_url":"https://api.github.com/users/wwbmmm/events{/privacy}","received_events_url":"https://api.github.com/users/wwbmmm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-09T07:13:35Z","updated_at":"2024-01-09T07:13:35Z","author_association":"CONTRIBUTOR","body":"把不同组的bthread放入不同的execution_queue ?","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1882523124/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1882526381","html_url":"https://github.com/apache/brpc/pull/2121#issuecomment-1882526381","issue_url":"https://api.github.com/repos/apache/brpc/issues/2121","id":1882526381,"node_id":"IC_kwDOBhmkcs5wNRKt","user":{"login":"wwbmmm","id":3894631,"node_id":"MDQ6VXNlcjM4OTQ2MzE=","avatar_url":"https://avatars.githubusercontent.com/u/3894631?v=4","gravatar_id":"","url":"https://api.github.com/users/wwbmmm","html_url":"https://github.com/wwbmmm","followers_url":"https://api.github.com/users/wwbmmm/followers","following_url":"https://api.github.com/users/wwbmmm/following{/other_user}","gists_url":"https://api.github.com/users/wwbmmm/gists{/gist_id}","starred_url":"https://api.github.com/users/wwbmmm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wwbmmm/subscriptions","organizations_url":"https://api.github.com/users/wwbmmm/orgs","repos_url":"https://api.github.com/users/wwbmmm/repos","events_url":"https://api.github.com/users/wwbmmm/events{/privacy}","received_events_url":"https://api.github.com/users/wwbmmm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-09T07:17:05Z","updated_at":"2024-01-09T07:17:05Z","author_association":"CONTRIBUTOR","body":"> 如果调整系统的mmap_max_count，可以达到coroutine一样的效果吗\r\n\r\n这样只是增加了bthread数量的上限。但是bthread的堆栈内存占用、堆栈切换开销还是会比coroutine更大。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1882526381/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1882534718","html_url":"https://github.com/apache/brpc/pull/2488#issuecomment-1882534718","issue_url":"https://api.github.com/repos/apache/brpc/issues/2488","id":1882534718,"node_id":"IC_kwDOBhmkcs5wNTM-","user":{"login":"wwbmmm","id":3894631,"node_id":"MDQ6VXNlcjM4OTQ2MzE=","avatar_url":"https://avatars.githubusercontent.com/u/3894631?v=4","gravatar_id":"","url":"https://api.github.com/users/wwbmmm","html_url":"https://github.com/wwbmmm","followers_url":"https://api.github.com/users/wwbmmm/followers","following_url":"https://api.github.com/users/wwbmmm/following{/other_user}","gists_url":"https://api.github.com/users/wwbmmm/gists{/gist_id}","starred_url":"https://api.github.com/users/wwbmmm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wwbmmm/subscriptions","organizations_url":"https://api.github.com/users/wwbmmm/orgs","repos_url":"https://api.github.com/users/wwbmmm/repos","events_url":"https://api.github.com/users/wwbmmm/events{/privacy}","received_events_url":"https://api.github.com/users/wwbmmm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-09T07:25:34Z","updated_at":"2024-01-09T07:25:34Z","author_association":"CONTRIBUTOR","body":"LGTM","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1882534718/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1882539124","html_url":"https://github.com/apache/brpc/pull/2476#issuecomment-1882539124","issue_url":"https://api.github.com/repos/apache/brpc/issues/2476","id":1882539124,"node_id":"IC_kwDOBhmkcs5wNUR0","user":{"login":"wwbmmm","id":3894631,"node_id":"MDQ6VXNlcjM4OTQ2MzE=","avatar_url":"https://avatars.githubusercontent.com/u/3894631?v=4","gravatar_id":"","url":"https://api.github.com/users/wwbmmm","html_url":"https://github.com/wwbmmm","followers_url":"https://api.github.com/users/wwbmmm/followers","following_url":"https://api.github.com/users/wwbmmm/following{/other_user}","gists_url":"https://api.github.com/users/wwbmmm/gists{/gist_id}","starred_url":"https://api.github.com/users/wwbmmm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wwbmmm/subscriptions","organizations_url":"https://api.github.com/users/wwbmmm/orgs","repos_url":"https://api.github.com/users/wwbmmm/repos","events_url":"https://api.github.com/users/wwbmmm/events{/privacy}","received_events_url":"https://api.github.com/users/wwbmmm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-09T07:29:55Z","updated_at":"2024-01-09T07:29:55Z","author_association":"CONTRIBUTOR","body":"> > LGTM\r\n> \r\n> 拆分线程池后，有些原来服务于一个线程池的routine现在服务于多个线程池，如果这个routine内部有bthread锁，就会发生问题，因为线程池之间不能被唤醒。另外就是跨线程池创建协程，使用了bthread锁。 brpc内部的routine有这种case吗？我看多数用的butil:Mutex，那内部routine使用锁的原则是怎么样的？ 目前我能搜到的使用bthread::Mutex(bthread_mutex_*)的地方有，stream.cpp，id.cpp，有没有风险。\r\n\r\n线程池之间，能否支持唤醒呢？就像之前 pthread和bthread 也可以相互唤醒，可能需要调整下butex的相关逻辑","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1882539124/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1882545463","html_url":"https://github.com/apache/brpc/pull/2413#issuecomment-1882545463","issue_url":"https://api.github.com/repos/apache/brpc/issues/2413","id":1882545463,"node_id":"IC_kwDOBhmkcs5wNV03","user":{"login":"wwbmmm","id":3894631,"node_id":"MDQ6VXNlcjM4OTQ2MzE=","avatar_url":"https://avatars.githubusercontent.com/u/3894631?v=4","gravatar_id":"","url":"https://api.github.com/users/wwbmmm","html_url":"https://github.com/wwbmmm","followers_url":"https://api.github.com/users/wwbmmm/followers","following_url":"https://api.github.com/users/wwbmmm/following{/other_user}","gists_url":"https://api.github.com/users/wwbmmm/gists{/gist_id}","starred_url":"https://api.github.com/users/wwbmmm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wwbmmm/subscriptions","organizations_url":"https://api.github.com/users/wwbmmm/orgs","repos_url":"https://api.github.com/users/wwbmmm/repos","events_url":"https://api.github.com/users/wwbmmm/events{/privacy}","received_events_url":"https://api.github.com/users/wwbmmm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-09T07:36:04Z","updated_at":"2024-01-09T07:36:04Z","author_association":"CONTRIBUTOR","body":"LGTM","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1882545463/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1882553532","html_url":"https://github.com/apache/brpc/pull/2492#issuecomment-1882553532","issue_url":"https://api.github.com/repos/apache/brpc/issues/2492","id":1882553532,"node_id":"IC_kwDOBhmkcs5wNXy8","user":{"login":"wwbmmm","id":3894631,"node_id":"MDQ6VXNlcjM4OTQ2MzE=","avatar_url":"https://avatars.githubusercontent.com/u/3894631?v=4","gravatar_id":"","url":"https://api.github.com/users/wwbmmm","html_url":"https://github.com/wwbmmm","followers_url":"https://api.github.com/users/wwbmmm/followers","following_url":"https://api.github.com/users/wwbmmm/following{/other_user}","gists_url":"https://api.github.com/users/wwbmmm/gists{/gist_id}","starred_url":"https://api.github.com/users/wwbmmm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wwbmmm/subscriptions","organizations_url":"https://api.github.com/users/wwbmmm/orgs","repos_url":"https://api.github.com/users/wwbmmm/repos","events_url":"https://api.github.com/users/wwbmmm/events{/privacy}","received_events_url":"https://api.github.com/users/wwbmmm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-09T07:43:44Z","updated_at":"2024-01-09T07:43:44Z","author_association":"CONTRIBUTOR","body":"LGTM","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1882553532/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1882558773","html_url":"https://github.com/apache/brpc/issues/2495#issuecomment-1882558773","issue_url":"https://api.github.com/repos/apache/brpc/issues/2495","id":1882558773,"node_id":"IC_kwDOBhmkcs5wNZE1","user":{"login":"wwbmmm","id":3894631,"node_id":"MDQ6VXNlcjM4OTQ2MzE=","avatar_url":"https://avatars.githubusercontent.com/u/3894631?v=4","gravatar_id":"","url":"https://api.github.com/users/wwbmmm","html_url":"https://github.com/wwbmmm","followers_url":"https://api.github.com/users/wwbmmm/followers","following_url":"https://api.github.com/users/wwbmmm/following{/other_user}","gists_url":"https://api.github.com/users/wwbmmm/gists{/gist_id}","starred_url":"https://api.github.com/users/wwbmmm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wwbmmm/subscriptions","organizations_url":"https://api.github.com/users/wwbmmm/orgs","repos_url":"https://api.github.com/users/wwbmmm/repos","events_url":"https://api.github.com/users/wwbmmm/events{/privacy}","received_events_url":"https://api.github.com/users/wwbmmm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-09T07:48:38Z","updated_at":"2024-01-09T07:48:38Z","author_association":"CONTRIBUTOR","body":"bRPC's ABI contains large amount of C++ data structures, it is too complex and frequently changed, it's hard to guarantee ABI stability.","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1882558773/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1882559578","html_url":"https://github.com/apache/brpc/issues/2498#issuecomment-1882559578","issue_url":"https://api.github.com/repos/apache/brpc/issues/2498","id":1882559578,"node_id":"IC_kwDOBhmkcs5wNZRa","user":{"login":"wwbmmm","id":3894631,"node_id":"MDQ6VXNlcjM4OTQ2MzE=","avatar_url":"https://avatars.githubusercontent.com/u/3894631?v=4","gravatar_id":"","url":"https://api.github.com/users/wwbmmm","html_url":"https://github.com/wwbmmm","followers_url":"https://api.github.com/users/wwbmmm/followers","following_url":"https://api.github.com/users/wwbmmm/following{/other_user}","gists_url":"https://api.github.com/users/wwbmmm/gists{/gist_id}","starred_url":"https://api.github.com/users/wwbmmm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wwbmmm/subscriptions","organizations_url":"https://api.github.com/users/wwbmmm/orgs","repos_url":"https://api.github.com/users/wwbmmm/repos","events_url":"https://api.github.com/users/wwbmmm/events{/privacy}","received_events_url":"https://api.github.com/users/wwbmmm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-09T07:49:23Z","updated_at":"2024-01-09T07:49:23Z","author_association":"CONTRIBUTOR","body":"目前不支持grpc流","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1882559578/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1882563286","html_url":"https://github.com/apache/brpc/pull/2499#issuecomment-1882563286","issue_url":"https://api.github.com/repos/apache/brpc/issues/2499","id":1882563286,"node_id":"IC_kwDOBhmkcs5wNaLW","user":{"login":"wwbmmm","id":3894631,"node_id":"MDQ6VXNlcjM4OTQ2MzE=","avatar_url":"https://avatars.githubusercontent.com/u/3894631?v=4","gravatar_id":"","url":"https://api.github.com/users/wwbmmm","html_url":"https://github.com/wwbmmm","followers_url":"https://api.github.com/users/wwbmmm/followers","following_url":"https://api.github.com/users/wwbmmm/following{/other_user}","gists_url":"https://api.github.com/users/wwbmmm/gists{/gist_id}","starred_url":"https://api.github.com/users/wwbmmm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wwbmmm/subscriptions","organizations_url":"https://api.github.com/users/wwbmmm/orgs","repos_url":"https://api.github.com/users/wwbmmm/repos","events_url":"https://api.github.com/users/wwbmmm/events{/privacy}","received_events_url":"https://api.github.com/users/wwbmmm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-09T07:52:42Z","updated_at":"2024-01-09T07:52:42Z","author_association":"CONTRIBUTOR","body":"LGTM","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1882563286/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1882577887","html_url":"https://github.com/apache/brpc/pull/2497#issuecomment-1882577887","issue_url":"https://api.github.com/repos/apache/brpc/issues/2497","id":1882577887,"node_id":"IC_kwDOBhmkcs5wNdvf","user":{"login":"wwbmmm","id":3894631,"node_id":"MDQ6VXNlcjM4OTQ2MzE=","avatar_url":"https://avatars.githubusercontent.com/u/3894631?v=4","gravatar_id":"","url":"https://api.github.com/users/wwbmmm","html_url":"https://github.com/wwbmmm","followers_url":"https://api.github.com/users/wwbmmm/followers","following_url":"https://api.github.com/users/wwbmmm/following{/other_user}","gists_url":"https://api.github.com/users/wwbmmm/gists{/gist_id}","starred_url":"https://api.github.com/users/wwbmmm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wwbmmm/subscriptions","organizations_url":"https://api.github.com/users/wwbmmm/orgs","repos_url":"https://api.github.com/users/wwbmmm/repos","events_url":"https://api.github.com/users/wwbmmm/events{/privacy}","received_events_url":"https://api.github.com/users/wwbmmm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-09T08:04:34Z","updated_at":"2024-01-09T08:04:34Z","author_association":"CONTRIBUTOR","body":"是否可以给IOBuf开发一个不共享模式，然后通过memory profiler来定位问题？","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1882577887/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1882604352","html_url":"https://github.com/apache/brpc/pull/2497#issuecomment-1882604352","issue_url":"https://api.github.com/repos/apache/brpc/issues/2497","id":1882604352,"node_id":"IC_kwDOBhmkcs5wNkNA","user":{"login":"chenBright","id":12249635,"node_id":"MDQ6VXNlcjEyMjQ5NjM1","avatar_url":"https://avatars.githubusercontent.com/u/12249635?v=4","gravatar_id":"","url":"https://api.github.com/users/chenBright","html_url":"https://github.com/chenBright","followers_url":"https://api.github.com/users/chenBright/followers","following_url":"https://api.github.com/users/chenBright/following{/other_user}","gists_url":"https://api.github.com/users/chenBright/gists{/gist_id}","starred_url":"https://api.github.com/users/chenBright/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenBright/subscriptions","organizations_url":"https://api.github.com/users/chenBright/orgs","repos_url":"https://api.github.com/users/chenBright/repos","events_url":"https://api.github.com/users/chenBright/events{/privacy}","received_events_url":"https://api.github.com/users/chenBright/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-09T08:25:53Z","updated_at":"2024-01-09T08:25:53Z","author_association":"CONTRIBUTOR","body":"> 是否可以给IOBuf开发一个不共享模式，然后通过memory profiler来定位问题？\r\n\r\n应该是可以的。\r\n当时的IOBuf泄漏问题在测试环境无法复现，只能在线上服务排查。因为（拷贝模式）这个方案可能需要改造BLock、IOBuf及其所有派生类等相关的功能，侵入性大、改动量大、风险大，所以最后没有采用这个方案。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1882604352/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1882742759","html_url":"https://github.com/apache/brpc/pull/2476#issuecomment-1882742759","issue_url":"https://api.github.com/repos/apache/brpc/issues/2476","id":1882742759,"node_id":"IC_kwDOBhmkcs5wOF_n","user":{"login":"yanglimingcn","id":7091130,"node_id":"MDQ6VXNlcjcwOTExMzA=","avatar_url":"https://avatars.githubusercontent.com/u/7091130?v=4","gravatar_id":"","url":"https://api.github.com/users/yanglimingcn","html_url":"https://github.com/yanglimingcn","followers_url":"https://api.github.com/users/yanglimingcn/followers","following_url":"https://api.github.com/users/yanglimingcn/following{/other_user}","gists_url":"https://api.github.com/users/yanglimingcn/gists{/gist_id}","starred_url":"https://api.github.com/users/yanglimingcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yanglimingcn/subscriptions","organizations_url":"https://api.github.com/users/yanglimingcn/orgs","repos_url":"https://api.github.com/users/yanglimingcn/repos","events_url":"https://api.github.com/users/yanglimingcn/events{/privacy}","received_events_url":"https://api.github.com/users/yanglimingcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-09T09:50:47Z","updated_at":"2024-01-09T09:54:15Z","author_association":"CONTRIBUTOR","body":"> > > LGTM\r\n> > \r\n> > \r\n> > 拆分线程池后，有些原来服务于一个线程池的routine现在服务于多个线程池，如果这个routine内部有bthread锁，就会发生问题，因为线程池之间不能被唤醒。另外就是跨线程池创建协程，使用了bthread锁。 brpc内部的routine有这种case吗？我看多数用的butil:Mutex，那内部routine使用锁的原则是怎么样的？ 目前我能搜到的使用bthread::Mutex(bthread_mutex_*)的地方有，stream.cpp，id.cpp，有没有风险。\r\n> \r\n> 线程池之间，能否支持唤醒呢？就像之前 pthread和bthread 也可以相互唤醒，可能需要调整下butex的相关逻辑\r\n\r\n我感觉线程池之间不需要这么做了，如果线程池之间有共享的内容，就退化到pthread_mutex就可以了。\r\n另外那个FLAGS_usercode_in_pthread这个感觉可以做成每个线程池可以单独配置的。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1882742759/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1884469599","html_url":"https://github.com/apache/brpc/pull/2493#issuecomment-1884469599","issue_url":"https://api.github.com/repos/apache/brpc/issues/2493","id":1884469599,"node_id":"IC_kwDOBhmkcs5wUrlf","user":{"login":"chenBright","id":12249635,"node_id":"MDQ6VXNlcjEyMjQ5NjM1","avatar_url":"https://avatars.githubusercontent.com/u/12249635?v=4","gravatar_id":"","url":"https://api.github.com/users/chenBright","html_url":"https://github.com/chenBright","followers_url":"https://api.github.com/users/chenBright/followers","following_url":"https://api.github.com/users/chenBright/following{/other_user}","gists_url":"https://api.github.com/users/chenBright/gists{/gist_id}","starred_url":"https://api.github.com/users/chenBright/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenBright/subscriptions","organizations_url":"https://api.github.com/users/chenBright/orgs","repos_url":"https://api.github.com/users/chenBright/repos","events_url":"https://api.github.com/users/chenBright/events{/privacy}","received_events_url":"https://api.github.com/users/chenBright/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-10T09:21:00Z","updated_at":"2024-01-10T09:21:00Z","author_association":"CONTRIBUTOR","body":"LGTM","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1884469599/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1884533170","html_url":"https://github.com/apache/brpc/issues/1724#issuecomment-1884533170","issue_url":"https://api.github.com/repos/apache/brpc/issues/1724","id":1884533170,"node_id":"IC_kwDOBhmkcs5wU7Gy","user":{"login":"ehds","id":17853449,"node_id":"MDQ6VXNlcjE3ODUzNDQ5","avatar_url":"https://avatars.githubusercontent.com/u/17853449?v=4","gravatar_id":"","url":"https://api.github.com/users/ehds","html_url":"https://github.com/ehds","followers_url":"https://api.github.com/users/ehds/followers","following_url":"https://api.github.com/users/ehds/following{/other_user}","gists_url":"https://api.github.com/users/ehds/gists{/gist_id}","starred_url":"https://api.github.com/users/ehds/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ehds/subscriptions","organizations_url":"https://api.github.com/users/ehds/orgs","repos_url":"https://api.github.com/users/ehds/repos","events_url":"https://api.github.com/users/ehds/events{/privacy}","received_events_url":"https://api.github.com/users/ehds/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-10T09:59:53Z","updated_at":"2024-01-10T09:59:53Z","author_association":"CONTRIBUTOR","body":"这个得看你具体使用什么类型的锁，如果是pthread的锁，会阻塞当前运行的pthread，如果使用butex，那么不会阻塞当前pthread。发自我的 iPhone在 2024年1月8日，08:25，dxw1997 ***@***.***> 写道：﻿\r\n\r\n你比较的是bthread vs. ”pthread线程池“，还是bthread vs. “纯异步\"? pthread线程池的代价是一旦阻塞只能阻塞pthread，影响并发度（也就是pthread线程的个数），后者代码难写。bthread就是平衡一下这两者。\r\n\r\n还是有一点不懂。我现在在bthread中同步调用下游的一个服务，同步调用的时候调用端会阻塞在一个锁上，这时候在调用端bthread所跑的pthread上，会出现bthread的切换吗?\r\n\r\n—Reply to this email directly, view it on GitHub, or unsubscribe.You are receiving this because you commented.Message ID: ***@***.***>","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1884533170/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1886202189","html_url":"https://github.com/apache/brpc/pull/2469#issuecomment-1886202189","issue_url":"https://api.github.com/repos/apache/brpc/issues/2469","id":1886202189,"node_id":"IC_kwDOBhmkcs5wbSlN","user":{"login":"chenBright","id":12249635,"node_id":"MDQ6VXNlcjEyMjQ5NjM1","avatar_url":"https://avatars.githubusercontent.com/u/12249635?v=4","gravatar_id":"","url":"https://api.github.com/users/chenBright","html_url":"https://github.com/chenBright","followers_url":"https://api.github.com/users/chenBright/followers","following_url":"https://api.github.com/users/chenBright/following{/other_user}","gists_url":"https://api.github.com/users/chenBright/gists{/gist_id}","starred_url":"https://api.github.com/users/chenBright/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenBright/subscriptions","organizations_url":"https://api.github.com/users/chenBright/orgs","repos_url":"https://api.github.com/users/chenBright/repos","events_url":"https://api.github.com/users/chenBright/events{/privacy}","received_events_url":"https://api.github.com/users/chenBright/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-11T04:04:31Z","updated_at":"2024-01-11T04:04:31Z","author_association":"CONTRIBUTOR","body":"@wwbmmm @serverglen 这个PR应该可以合入了","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1886202189/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1886645080","html_url":"https://github.com/apache/brpc/issues/344#issuecomment-1886645080","issue_url":"https://api.github.com/repos/apache/brpc/issues/344","id":1886645080,"node_id":"IC_kwDOBhmkcs5wc-tY","user":{"login":"ike47","id":156296108,"node_id":"U_kgDOCVDjrA","avatar_url":"https://avatars.githubusercontent.com/u/156296108?v=4","gravatar_id":"","url":"https://api.github.com/users/ike47","html_url":"https://github.com/ike47","followers_url":"https://api.github.com/users/ike47/followers","following_url":"https://api.github.com/users/ike47/following{/other_user}","gists_url":"https://api.github.com/users/ike47/gists{/gist_id}","starred_url":"https://api.github.com/users/ike47/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ike47/subscriptions","organizations_url":"https://api.github.com/users/ike47/orgs","repos_url":"https://api.github.com/users/ike47/repos","events_url":"https://api.github.com/users/ike47/events{/privacy}","received_events_url":"https://api.github.com/users/ike47/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-11T08:49:32Z","updated_at":"2024-01-11T08:49:32Z","author_association":"NONE","body":"> 使用rpc作为服务收请求，该服务同时还会作为client请求其他服务，中间的处理逻辑只有解析包和组装包，发现内存也会增长，1000qps持续压测，如下图（横轴：时间h，纵轴：内存M）：\r\n\r\n我也遇到了服务端作为client请求其他服务内存增长的问题。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1886645080/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1887062332","html_url":"https://github.com/apache/brpc/pull/2503#issuecomment-1887062332","issue_url":"https://api.github.com/repos/apache/brpc/issues/2503","id":1887062332,"node_id":"IC_kwDOBhmkcs5wekk8","user":{"login":"chenBright","id":12249635,"node_id":"MDQ6VXNlcjEyMjQ5NjM1","avatar_url":"https://avatars.githubusercontent.com/u/12249635?v=4","gravatar_id":"","url":"https://api.github.com/users/chenBright","html_url":"https://github.com/chenBright","followers_url":"https://api.github.com/users/chenBright/followers","following_url":"https://api.github.com/users/chenBright/following{/other_user}","gists_url":"https://api.github.com/users/chenBright/gists{/gist_id}","starred_url":"https://api.github.com/users/chenBright/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenBright/subscriptions","organizations_url":"https://api.github.com/users/chenBright/orgs","repos_url":"https://api.github.com/users/chenBright/repos","events_url":"https://api.github.com/users/chenBright/events{/privacy}","received_events_url":"https://api.github.com/users/chenBright/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-11T12:31:20Z","updated_at":"2024-01-11T12:31:20Z","author_association":"CONTRIBUTOR","body":"LGTM","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1887062332/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1887457096","html_url":"https://github.com/apache/brpc/pull/2488#issuecomment-1887457096","issue_url":"https://api.github.com/repos/apache/brpc/issues/2488","id":1887457096,"node_id":"IC_kwDOBhmkcs5wgE9I","user":{"login":"chenBright","id":12249635,"node_id":"MDQ6VXNlcjEyMjQ5NjM1","avatar_url":"https://avatars.githubusercontent.com/u/12249635?v=4","gravatar_id":"","url":"https://api.github.com/users/chenBright","html_url":"https://github.com/chenBright","followers_url":"https://api.github.com/users/chenBright/followers","following_url":"https://api.github.com/users/chenBright/following{/other_user}","gists_url":"https://api.github.com/users/chenBright/gists{/gist_id}","starred_url":"https://api.github.com/users/chenBright/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenBright/subscriptions","organizations_url":"https://api.github.com/users/chenBright/orgs","repos_url":"https://api.github.com/users/chenBright/repos","events_url":"https://api.github.com/users/chenBright/events{/privacy}","received_events_url":"https://api.github.com/users/chenBright/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-11T15:50:13Z","updated_at":"2024-01-11T15:50:13Z","author_association":"CONTRIBUTOR","body":"tcmalloc GetStackTrace的性能优于glibc backtrace的。当链接了tcmalloc时，优先使用tcmalloc GetStackTrace。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1887457096/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1890884707","html_url":"https://github.com/apache/brpc/pull/2413#issuecomment-1890884707","issue_url":"https://api.github.com/repos/apache/brpc/issues/2413","id":1890884707,"node_id":"IC_kwDOBhmkcs5wtJxj","user":{"login":"chenBright","id":12249635,"node_id":"MDQ6VXNlcjEyMjQ5NjM1","avatar_url":"https://avatars.githubusercontent.com/u/12249635?v=4","gravatar_id":"","url":"https://api.github.com/users/chenBright","html_url":"https://github.com/chenBright","followers_url":"https://api.github.com/users/chenBright/followers","following_url":"https://api.github.com/users/chenBright/following{/other_user}","gists_url":"https://api.github.com/users/chenBright/gists{/gist_id}","starred_url":"https://api.github.com/users/chenBright/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenBright/subscriptions","organizations_url":"https://api.github.com/users/chenBright/orgs","repos_url":"https://api.github.com/users/chenBright/repos","events_url":"https://api.github.com/users/chenBright/events{/privacy}","received_events_url":"https://api.github.com/users/chenBright/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-14T08:33:24Z","updated_at":"2024-01-23T06:35:23Z","author_association":"CONTRIBUTOR","body":"当日志打印频率比较低的时候，异步日志有可能退化为每个日志都包含两个动作：signal异步日志线程、异步日志线程落盘。\r\n针对这种场景，采用Socket::Write的策略，同步落盘队头的日志，队列的其他日志通过异步日志线程落盘，减少signal的消耗。对于日志打印频率比较高的场景，可通过开关支持异步日志线程来落盘全部日志。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1890884707/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1890906416","html_url":"https://github.com/apache/brpc/pull/2505#issuecomment-1890906416","issue_url":"https://api.github.com/repos/apache/brpc/issues/2505","id":1890906416,"node_id":"IC_kwDOBhmkcs5wtPEw","user":{"login":"chenBright","id":12249635,"node_id":"MDQ6VXNlcjEyMjQ5NjM1","avatar_url":"https://avatars.githubusercontent.com/u/12249635?v=4","gravatar_id":"","url":"https://api.github.com/users/chenBright","html_url":"https://github.com/chenBright","followers_url":"https://api.github.com/users/chenBright/followers","following_url":"https://api.github.com/users/chenBright/following{/other_user}","gists_url":"https://api.github.com/users/chenBright/gists{/gist_id}","starred_url":"https://api.github.com/users/chenBright/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenBright/subscriptions","organizations_url":"https://api.github.com/users/chenBright/orgs","repos_url":"https://api.github.com/users/chenBright/repos","events_url":"https://api.github.com/users/chenBright/events{/privacy}","received_events_url":"https://api.github.com/users/chenBright/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-14T10:07:21Z","updated_at":"2024-01-14T10:07:21Z","author_association":"CONTRIBUTOR","body":"![127 0 0 1_8000_tcmalloc](https://github.com/apache/brpc/assets/12249635/a07ea3b4-ad8f-4466-a0b1-df4d49f7492a)\r\n","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1890906416/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1891269803","html_url":"https://github.com/apache/brpc/pull/2505#issuecomment-1891269803","issue_url":"https://api.github.com/repos/apache/brpc/issues/2505","id":1891269803,"node_id":"IC_kwDOBhmkcs5wunyr","user":{"login":"jamesge","id":6566535,"node_id":"MDQ6VXNlcjY1NjY1MzU=","avatar_url":"https://avatars.githubusercontent.com/u/6566535?v=4","gravatar_id":"","url":"https://api.github.com/users/jamesge","html_url":"https://github.com/jamesge","followers_url":"https://api.github.com/users/jamesge/followers","following_url":"https://api.github.com/users/jamesge/following{/other_user}","gists_url":"https://api.github.com/users/jamesge/gists{/gist_id}","starred_url":"https://api.github.com/users/jamesge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jamesge/subscriptions","organizations_url":"https://api.github.com/users/jamesge/orgs","repos_url":"https://api.github.com/users/jamesge/repos","events_url":"https://api.github.com/users/jamesge/events{/privacy}","received_events_url":"https://api.github.com/users/jamesge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-15T04:06:34Z","updated_at":"2024-01-15T04:06:34Z","author_association":"CONTRIBUTOR","body":"这个要考虑成为memory service么？(/memory)，那样的话似乎比较适合以后适配新的allocator","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/1891269803/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]