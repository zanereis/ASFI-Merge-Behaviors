[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1074855839","html_url":"https://github.com/apache/iceberg/pull/4359#issuecomment-1074855839","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4359","id":1074855839,"node_id":"IC_kwDOCW7NX85AEP-f","user":{"login":"xloya","id":26177232,"node_id":"MDQ6VXNlcjI2MTc3MjMy","avatar_url":"https://avatars.githubusercontent.com/u/26177232?v=4","gravatar_id":"","url":"https://api.github.com/users/xloya","html_url":"https://github.com/xloya","followers_url":"https://api.github.com/users/xloya/followers","following_url":"https://api.github.com/users/xloya/following{/other_user}","gists_url":"https://api.github.com/users/xloya/gists{/gist_id}","starred_url":"https://api.github.com/users/xloya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xloya/subscriptions","organizations_url":"https://api.github.com/users/xloya/orgs","repos_url":"https://api.github.com/users/xloya/repos","events_url":"https://api.github.com/users/xloya/events{/privacy}","received_events_url":"https://api.github.com/users/xloya/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-22T08:07:43Z","updated_at":"2022-03-23T11:40:09Z","author_association":"CONTRIBUTOR","body":"> I'm not sure I see the benefit to this change? Could you elaborate?\r\n\r\nLet me explain why this change was made:  \r\nRecently, I found that the driver oom will occur when the compaction jobs rewriting the v2 table. After analyzing the memory of the driver heap, I found that the `RewriteFileGroup` will occupy a large amount of memory, so I thought maybe we could get rid of the reference to the group when the rewrite was done.  \r\nThe heap occupation like this:  \r\n![image](https://user-images.githubusercontent.com/26177232/159434220-b0d5b6c9-9ca6-4ced-b4a4-b1bf868708af.png)\r\n\r\nWe now use `Stream` to save the `RewriteFileGroup`, which will not release the memory until all threads are completed. I'm not sure if anyone has encountered it, but the compaction job with v2 tables on my side encounters a lot of groups that need to be rewritten, resulting in a lot of memory for this class. So I modified the `Stream` to a `ConcurrentLinkedQueue,` removed the reference to the `RewriteFileGroup` after rewrited, and converted it to a simple class when storing in the result set to reduce the memory occupation.  \r\n\r\n@RussellSpitzer What do you think about this? Please give any comments, thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1074855839/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1074933543","html_url":"https://github.com/apache/iceberg/pull/4374#issuecomment-1074933543","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4374","id":1074933543,"node_id":"IC_kwDOCW7NX85AEi8n","user":{"login":"felixYyu","id":3785228,"node_id":"MDQ6VXNlcjM3ODUyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3785228?v=4","gravatar_id":"","url":"https://api.github.com/users/felixYyu","html_url":"https://github.com/felixYyu","followers_url":"https://api.github.com/users/felixYyu/followers","following_url":"https://api.github.com/users/felixYyu/following{/other_user}","gists_url":"https://api.github.com/users/felixYyu/gists{/gist_id}","starred_url":"https://api.github.com/users/felixYyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixYyu/subscriptions","organizations_url":"https://api.github.com/users/felixYyu/orgs","repos_url":"https://api.github.com/users/felixYyu/repos","events_url":"https://api.github.com/users/felixYyu/events{/privacy}","received_events_url":"https://api.github.com/users/felixYyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-22T09:33:04Z","updated_at":"2022-03-22T09:33:04Z","author_association":"CONTRIBUTOR","body":"can you take a look at it, thanks.  cc @rdblue @RussellSpitzer ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1074933543/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1074969808","html_url":"https://github.com/apache/iceberg/issues/3146#issuecomment-1074969808","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3146","id":1074969808,"node_id":"IC_kwDOCW7NX85AErzQ","user":{"login":"wangmiao1002","id":38424929,"node_id":"MDQ6VXNlcjM4NDI0OTI5","avatar_url":"https://avatars.githubusercontent.com/u/38424929?v=4","gravatar_id":"","url":"https://api.github.com/users/wangmiao1002","html_url":"https://github.com/wangmiao1002","followers_url":"https://api.github.com/users/wangmiao1002/followers","following_url":"https://api.github.com/users/wangmiao1002/following{/other_user}","gists_url":"https://api.github.com/users/wangmiao1002/gists{/gist_id}","starred_url":"https://api.github.com/users/wangmiao1002/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangmiao1002/subscriptions","organizations_url":"https://api.github.com/users/wangmiao1002/orgs","repos_url":"https://api.github.com/users/wangmiao1002/repos","events_url":"https://api.github.com/users/wangmiao1002/events{/privacy}","received_events_url":"https://api.github.com/users/wangmiao1002/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-22T09:59:28Z","updated_at":"2022-03-22T09:59:28Z","author_association":"NONE","body":"I also encountered the same problem. I tried to solve it in this way. At present, the test is successful. I don't know whether it is reasonable or not. \r\n\r\nPut iceberg-hive-runtime-0.13.1 jar in hive_ AUX_ JARS_ Path configuration directory;\r\n Recompile the hive runtime module and modify the dependencies in the project to version 2.1.1","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1074969808/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1075129607","html_url":"https://github.com/apache/iceberg/pull/4375#issuecomment-1075129607","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4375","id":1075129607,"node_id":"IC_kwDOCW7NX85AFS0H","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-22T12:43:35Z","updated_at":"2022-03-22T12:43:35Z","author_association":"MEMBER","body":"Merged, thanks @wuwenchi for the contribution !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1075129607/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1075214036","html_url":"https://github.com/apache/iceberg/issues/4363#issuecomment-1075214036","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4363","id":1075214036,"node_id":"IC_kwDOCW7NX85AFnbU","user":{"login":"krisvaz","id":26745672,"node_id":"MDQ6VXNlcjI2NzQ1Njcy","avatar_url":"https://avatars.githubusercontent.com/u/26745672?v=4","gravatar_id":"","url":"https://api.github.com/users/krisvaz","html_url":"https://github.com/krisvaz","followers_url":"https://api.github.com/users/krisvaz/followers","following_url":"https://api.github.com/users/krisvaz/following{/other_user}","gists_url":"https://api.github.com/users/krisvaz/gists{/gist_id}","starred_url":"https://api.github.com/users/krisvaz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/krisvaz/subscriptions","organizations_url":"https://api.github.com/users/krisvaz/orgs","repos_url":"https://api.github.com/users/krisvaz/repos","events_url":"https://api.github.com/users/krisvaz/events{/privacy}","received_events_url":"https://api.github.com/users/krisvaz/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-22T13:57:43Z","updated_at":"2022-03-22T13:59:34Z","author_association":"NONE","body":"@hililiwei \r\n\r\nHere's an example of using the DataFrameWriterV2 to try creating the partitioned table and it's result:\r\n```\r\n>>> df = spark.createDataFrame([{'partition_a': 'A', 'partition_b': 'B', 'data': 'somestuff'}])\r\n>>> df.writeTo(\"iceberg_catalog.p2.test\").using(\"iceberg\").partitionedBy(\"partition_a\", \"partition_b\").create()\r\n>>> spark.sql(\"describe iceberg_catalog.p2.test\").show()\r\n+---------------+---------+-------+\r\n|       col_name|data_type|comment|\r\n+---------------+---------+-------+\r\n|           data|   string|       |\r\n|    partition_a|   string|       |\r\n|    partition_b|   string|       |\r\n|               |         |       |\r\n| # Partitioning|         |       |\r\n|Not partitioned|         |       |\r\n+---------------+---------+-------+\r\n```\r\n\r\nHere's an example of using spark sql to create the partitioned table and it's result:\r\n```\r\n>>> df = spark.createDataFrame([{'partition_a': 'A', 'partition_b': 'B', 'data': 'somestuff'}])\r\n>>> df.createOrReplaceTempView('test_view')\r\n>>> spark.sql(\"\"\"\r\n... create table iceberg_catalog.p2.test using iceberg partitioned by (partition_a, partition_b)\r\n... as select * from test_view\"\"\")\r\nDataFrame[]\r\n>>> spark.sql(\"describe iceberg_catalog.p2.test\").show()\r\n+--------------+-----------+-------+\r\n|      col_name|  data_type|comment|\r\n+--------------+-----------+-------+\r\n|          data|     string|       |\r\n|   partition_a|     string|       |\r\n|   partition_b|     string|       |\r\n|              |           |       |\r\n|# Partitioning|           |       |\r\n|        Part 0|partition_a|       |\r\n|        Part 1|partition_b|       |\r\n+--------------+-----------+-------+\r\n```\r\n\r\nI should note that I am running this within an AWS EMR cluster that's configured as defined [here](https://iceberg.apache.org/docs/latest/aws/#spark). \r\nInstead of starting a spark-sql shell, I'm starting a pyspark shell with those same configs.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1075214036/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1075234554","html_url":"https://github.com/apache/iceberg/pull/4376#issuecomment-1075234554","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4376","id":1075234554,"node_id":"IC_kwDOCW7NX85AFsb6","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-22T14:12:39Z","updated_at":"2022-03-22T14:12:39Z","author_association":"MEMBER","body":"Can you combine some of these style prs and perhaps label them as fixing static analysis warnings","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1075234554/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1075347792","html_url":"https://github.com/apache/iceberg/pull/4374#issuecomment-1075347792","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4374","id":1075347792,"node_id":"IC_kwDOCW7NX85AGIFQ","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-22T15:57:29Z","updated_at":"2022-03-22T15:57:29Z","author_association":"CONTRIBUTOR","body":"Thanks, @felixYyu!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1075347792/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1075425376","html_url":"https://github.com/apache/iceberg/pull/4342#issuecomment-1075425376","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4342","id":1075425376,"node_id":"IC_kwDOCW7NX85AGbBg","user":{"login":"danielcweeks","id":4925077,"node_id":"MDQ6VXNlcjQ5MjUwNzc=","avatar_url":"https://avatars.githubusercontent.com/u/4925077?v=4","gravatar_id":"","url":"https://api.github.com/users/danielcweeks","html_url":"https://github.com/danielcweeks","followers_url":"https://api.github.com/users/danielcweeks/followers","following_url":"https://api.github.com/users/danielcweeks/following{/other_user}","gists_url":"https://api.github.com/users/danielcweeks/gists{/gist_id}","starred_url":"https://api.github.com/users/danielcweeks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielcweeks/subscriptions","organizations_url":"https://api.github.com/users/danielcweeks/orgs","repos_url":"https://api.github.com/users/danielcweeks/repos","events_url":"https://api.github.com/users/danielcweeks/events{/privacy}","received_events_url":"https://api.github.com/users/danielcweeks/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-22T17:31:44Z","updated_at":"2022-03-22T17:31:44Z","author_association":"CONTRIBUTOR","body":"@jackye1995 I think we need to really clarify the use cases and make sure we're coming up with a solution that really addresses those.  This may be a good topic for the next sync as well, since it's getting a little involved in terms of object lifecycle management in S3.\r\n\r\nI would say the typical uses cases would be:\r\n\r\n*Versioned Bucket:*  Life-cycle policy for non-current versions+delete markers with direct delete as there's no requirement for tags.\r\n\r\n*Non-Versioned Bucket:* Life-cycle policy for tagged objects and no direct delete (deleting after tagging doesn't really make sense).\r\n\r\nI'm not sure if there's a use case for both versioned bucket and tagging for delete.\r\n\r\nI would also question the use of life-cycle for transitioning tagged objects since there's a cost associated with the tagging, the transition and, depending on the tier, a minimum charge.  It feels like that the use case where it becomes more cost effective gets narrow pretty quickly (as compared to just versioned bucket).\r\n\r\nGiven that there are these different strategies, we might actually want to separate this behavior into an interface for `DeletionStrategy` where we can provide implementations that are targeted to the use case.  That would also allow us to isolate some things (like the executor service which is currently created whether it's used or not).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1075425376/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1075491749","html_url":"https://github.com/apache/iceberg/pull/4372#issuecomment-1075491749","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4372","id":1075491749,"node_id":"IC_kwDOCW7NX85AGrOl","user":{"login":"liuml07","id":159186,"node_id":"MDQ6VXNlcjE1OTE4Ng==","avatar_url":"https://avatars.githubusercontent.com/u/159186?v=4","gravatar_id":"","url":"https://api.github.com/users/liuml07","html_url":"https://github.com/liuml07","followers_url":"https://api.github.com/users/liuml07/followers","following_url":"https://api.github.com/users/liuml07/following{/other_user}","gists_url":"https://api.github.com/users/liuml07/gists{/gist_id}","starred_url":"https://api.github.com/users/liuml07/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liuml07/subscriptions","organizations_url":"https://api.github.com/users/liuml07/orgs","repos_url":"https://api.github.com/users/liuml07/repos","events_url":"https://api.github.com/users/liuml07/events{/privacy}","received_events_url":"https://api.github.com/users/liuml07/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-22T18:37:15Z","updated_at":"2022-03-22T18:37:15Z","author_association":"MEMBER","body":"Thank you all for prompt reviews! I have updated the PR a bit.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1075491749/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1075556013","html_url":"https://github.com/apache/iceberg/pull/4236#issuecomment-1075556013","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4236","id":1075556013,"node_id":"IC_kwDOCW7NX85AG66t","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-22T19:36:10Z","updated_at":"2022-03-22T19:36:10Z","author_association":"CONTRIBUTOR","body":"Thanks, @kbendick!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1075556013/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1075654382","html_url":"https://github.com/apache/iceberg/pull/4336#issuecomment-1075654382","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4336","id":1075654382,"node_id":"IC_kwDOCW7NX85AHS7u","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-22T21:20:57Z","updated_at":"2022-03-22T21:20:57Z","author_association":"COLLABORATOR","body":"Merged, thanks @aokolnychyi for the review","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1075654382/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1075658611","html_url":"https://github.com/apache/iceberg/pull/4333#issuecomment-1075658611","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4333","id":1075658611,"node_id":"IC_kwDOCW7NX85AHT9z","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-22T21:23:55Z","updated_at":"2022-03-22T21:23:55Z","author_association":"CONTRIBUTOR","body":"If we add this to `core`, what are the implications for existing JUnit 4 based tests? As well as for things like overall runtime or any other concerns in operating in a mixed mode? Possibly classpath issues?\r\n\r\nTrying to better understand the implications of adding it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1075658611/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1075682671","html_url":"https://github.com/apache/iceberg/pull/4304#issuecomment-1075682671","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4304","id":1075682671,"node_id":"IC_kwDOCW7NX85AHZ1v","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-22T21:57:44Z","updated_at":"2022-03-22T21:57:44Z","author_association":"COLLABORATOR","body":"Note: this fix does not fix all the issues without #4370 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1075682671/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1075692624","html_url":"https://github.com/apache/iceberg/pull/4285#issuecomment-1075692624","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4285","id":1075692624,"node_id":"IC_kwDOCW7NX85AHcRQ","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-22T22:12:40Z","updated_at":"2022-03-22T22:12:40Z","author_association":"CONTRIBUTOR","body":"Looks great! Thank you for getting this working, @Fokko!\r\n\r\nI really like having doctests enforced. This will be useful for the transforms PR.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1075692624/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1075730115","html_url":"https://github.com/apache/iceberg/pull/4348#issuecomment-1075730115","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4348","id":1075730115,"node_id":"IC_kwDOCW7NX85AHlbD","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-22T22:55:12Z","updated_at":"2022-03-22T22:55:12Z","author_association":"CONTRIBUTOR","body":"Thanks for reviewing, @kbendick, @RussellSpitzer, @openinx, and @szehon-ho! I'm merging to unblock the next ones, which are what the remaining comments are about.\r\n\r\nI'll also fix a couple of the nits in the next PR, like the indentation in `CatalogHandlers` and the comment about the error handler.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1075730115/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1075730670","html_url":"https://github.com/apache/iceberg/pull/4348#issuecomment-1075730670","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4348","id":1075730670,"node_id":"IC_kwDOCW7NX85AHlju","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-22T22:56:20Z","updated_at":"2022-03-22T22:56:20Z","author_association":"MEMBER","body":"SGTM, There is always time for more commits :)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1075730670/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1075746153","html_url":"https://github.com/apache/iceberg/issues/4346#issuecomment-1075746153","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4346","id":1075746153,"node_id":"IC_kwDOCW7NX85AHpVp","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-22T23:24:49Z","updated_at":"2022-03-22T23:34:18Z","author_association":"COLLABORATOR","body":"> A few recent issues reported by the community: https://github.com/apache/iceberg/issues/4194, https://github.com/apache/iceberg/issues/4161. I know there were more issues and a few PRs too. Feel free to link anything that may be related.\r\n\r\nFound another PR on this:  https://github.com/apache/iceberg/pull/2890\r\n\r\nNeed to think a bit about CRC.\r\n\r\nOn first thought, seems the original ignoreScheme/ignoreAuthority proposal can solve the problem.  But if the goal is to make RemoveOrphan safe (ex, not remove all files if we change HDFS authority like today), then both need to default true, and as Ryan says we need to decide the right values for all FileSystem we support as it may not be the case for S3.  And personal thought, the flag name may cause some confusion (it could be read as remove orphans ignores prefix checking files when removing)\r\n\r\nMaybe an alternative is to do it the other way, the user has to force the delete when scheme/authority do not match to get the old behavior (which should be rare), or choose to skip them.\r\n\r\nWe could do it by distinguishing two sets from the inner Spark job, and have it return\r\n1. If FileSystem file does not match either absolute or relative path of any reachable Iceberg file\r\n2. If FileSystem file matches relative path, but not absolute path of a reachable Iceberg file (Before, will be returned as orphans as well and be silently deleted).\r\n\r\nThen a flag \"prefixMismatchMode\", \"error\", \"delete\", \"skip\" controls what to do with the second set (default=error, throws exception)\r\n\r\nThis might be an easier UX to me and no need to choose file-system specific flags.  The user in this case specifically chooses to skip if prefix no longer matches.  But it is worse performance compared to the original proposal in this case, as we would return a lot of results to driver just to throw the exception, not sure if its worth it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1075746153/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1075773308","html_url":"https://github.com/apache/iceberg/pull/4267#issuecomment-1075773308","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4267","id":1075773308,"node_id":"IC_kwDOCW7NX85AHv98","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-23T00:13:38Z","updated_at":"2022-03-23T00:13:38Z","author_association":"CONTRIBUTOR","body":"I'm going to merge this since there's still ongoing discussion about #4254. Thanks @rajarshisarkar!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1075773308/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1075774762","html_url":"https://github.com/apache/iceberg/pull/4254#issuecomment-1075774762","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4254","id":1075774762,"node_id":"IC_kwDOCW7NX85AHwUq","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-23T00:16:19Z","updated_at":"2022-03-23T00:16:19Z","author_association":"CONTRIBUTOR","body":"I think the `MetricsProducer` interface that carries `setMetricsContext` makes sense. We may not even need anything in `Catalog`. I think it is likely that the Flink implementation would create a `MetricsContext` in each task and set it on the IO when setting up execution. The dynamic Hadoop handling is a good default, but we probably only need to expose a way to set this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1075774762/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1075776203","html_url":"https://github.com/apache/iceberg/pull/4254#issuecomment-1075776203","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4254","id":1075776203,"node_id":"IC_kwDOCW7NX85AHwrL","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-23T00:18:28Z","updated_at":"2022-03-23T00:18:28Z","author_association":"CONTRIBUTOR","body":"It sounds like we agree about not setting up metrics with dynamic config, so I'm going to go ahead and close this one. Thanks for working on it, @kunal0829!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1075776203/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1075778273","html_url":"https://github.com/apache/iceberg/pull/4342#issuecomment-1075778273","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4342","id":1075778273,"node_id":"IC_kwDOCW7NX85AHxLh","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-23T00:22:13Z","updated_at":"2022-03-23T00:22:13Z","author_association":"CONTRIBUTOR","body":"I talked with Dan about this and he made me question my take on `io.deletes-enabled` vs `s3.deletes-enabled`. I'm good either way.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1075778273/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1075822276","html_url":"https://github.com/apache/iceberg/pull/4376#issuecomment-1075822276","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4376","id":1075822276,"node_id":"IC_kwDOCW7NX85AH77E","user":{"login":"felixYyu","id":3785228,"node_id":"MDQ6VXNlcjM3ODUyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3785228?v=4","gravatar_id":"","url":"https://api.github.com/users/felixYyu","html_url":"https://github.com/felixYyu","followers_url":"https://api.github.com/users/felixYyu/followers","following_url":"https://api.github.com/users/felixYyu/following{/other_user}","gists_url":"https://api.github.com/users/felixYyu/gists{/gist_id}","starred_url":"https://api.github.com/users/felixYyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixYyu/subscriptions","organizations_url":"https://api.github.com/users/felixYyu/orgs","repos_url":"https://api.github.com/users/felixYyu/repos","events_url":"https://api.github.com/users/felixYyu/events{/privacy}","received_events_url":"https://api.github.com/users/felixYyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-23T01:45:17Z","updated_at":"2022-03-23T01:45:40Z","author_association":"CONTRIBUTOR","body":"> Can you combine some of these style prs and perhaps label them as fixing static analysis warnings\r\n\r\nis a good idea, I try do it. @RussellSpitzer ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1075822276/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1075853937","html_url":"https://github.com/apache/iceberg/pull/3784#issuecomment-1075853937","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3784","id":1075853937,"node_id":"IC_kwDOCW7NX85AIDpx","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-23T02:35:21Z","updated_at":"2022-03-23T02:35:21Z","author_association":"MEMBER","body":"There are 3 failure cases from travis CI report: \r\n\r\n```\r\norg.apache.iceberg.flink.actions.TestRewriteDataFilesAction > testRewriteAvoidRepeateCompress[catalogName=testhive, baseNamespace=, format=ORC] FAILED\r\n    java.lang.AssertionError: Action should add 1 data file expected:<1> but was:<2>\r\n        at org.junit.Assert.fail(Assert.java:89)\r\n        at org.junit.Assert.failNotEquals(Assert.java:835)\r\n        at org.junit.Assert.assertEquals(Assert.java:647)\r\n        at org.apache.iceberg.flink.actions.TestRewriteDataFilesAction.testRewriteAvoidRepeateCompress(TestRewriteDataFilesAction.java:367)\r\n\r\norg.apache.iceberg.flink.actions.TestRewriteDataFilesAction > testRewriteAvoidRepeateCompress[catalogName=testhadoop, baseNamespace=, format=ORC] FAILED\r\n    java.lang.AssertionError: Action should add 1 data file expected:<1> but was:<2>\r\n        at org.junit.Assert.fail(Assert.java:89)\r\n        at org.junit.Assert.failNotEquals(Assert.java:835)\r\n        at org.junit.Assert.assertEquals(Assert.java:647)\r\n        at org.apache.iceberg.flink.actions.TestRewriteDataFilesAction.testRewriteAvoidRepeateCompress(TestRewriteDataFilesAction.java:367)\r\n\r\norg.apache.iceberg.flink.actions.TestRewriteDataFilesAction > testRewriteAvoidRepeateCompress[catalogName=testhadoop_basenamespace, baseNamespace=l0.l1, format=ORC] FAILED\r\n    java.lang.AssertionError: Action should add 1 data file expected:<1> but was:<2>\r\n        at org.junit.Assert.fail(Assert.java:89)\r\n        at org.junit.Assert.failNotEquals(Assert.java:835)\r\n        at org.junit.Assert.assertEquals(Assert.java:647)\r\n        at org.apache.iceberg.flink.actions.TestRewriteDataFilesAction.testRewriteAvoidRepeateCompress(TestRewriteDataFilesAction.java:367)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1075853937/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1075879148","html_url":"https://github.com/apache/iceberg/pull/4370#issuecomment-1075879148","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4370","id":1075879148,"node_id":"IC_kwDOCW7NX85AIJzs","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-23T03:33:31Z","updated_at":"2022-03-23T03:33:31Z","author_association":"CONTRIBUTOR","body":"Thanks, @szehon-ho!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1075879148/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1075969127","html_url":"https://github.com/apache/iceberg/pull/4342#issuecomment-1075969127","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4342","id":1075969127,"node_id":"IC_kwDOCW7NX85AIfxn","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-23T06:28:47Z","updated_at":"2022-03-23T06:28:47Z","author_association":"CONTRIBUTOR","body":"> I'm not sure if there's a use case for both versioned bucket and tagging for delete.\r\n\r\nYes, after doing some more research I think this is the right conclusion. I thought there was such a use case based on what @rdblue describe, but I've never heard of any.\r\n\r\nRegarding having a `DeleteStrategy`, I don't have a strong opinion for the interface either. The original proposal of introducing `s3.delete.tags` is a minimum integration, but if some other approaches are easier for your integration use case we can totally go with that.\r\n\r\nI don't know how this interface would look like though, do you have anything in your mind? Because unlike bulk operation, this is just conceptually a \"delete\" in the user's mind, which should ideally reuse the existing delete interface. So the strategy feels more like a config to me, where we can have `s3.delete.strategy=delete(default)|tagging` to choose from.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1075969127/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1075969650","html_url":"https://github.com/apache/iceberg/issues/2737#issuecomment-1075969650","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2737","id":1075969650,"node_id":"IC_kwDOCW7NX85AIf5y","user":{"login":"weichampion","id":38829422,"node_id":"MDQ6VXNlcjM4ODI5NDIy","avatar_url":"https://avatars.githubusercontent.com/u/38829422?v=4","gravatar_id":"","url":"https://api.github.com/users/weichampion","html_url":"https://github.com/weichampion","followers_url":"https://api.github.com/users/weichampion/followers","following_url":"https://api.github.com/users/weichampion/following{/other_user}","gists_url":"https://api.github.com/users/weichampion/gists{/gist_id}","starred_url":"https://api.github.com/users/weichampion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/weichampion/subscriptions","organizations_url":"https://api.github.com/users/weichampion/orgs","repos_url":"https://api.github.com/users/weichampion/repos","events_url":"https://api.github.com/users/weichampion/events{/privacy}","received_events_url":"https://api.github.com/users/weichampion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-23T06:29:31Z","updated_at":"2022-03-23T06:29:31Z","author_association":"NONE","body":"@jhsenjaliya hello, i'm a question :\r\nspark-sql --packages org.apache.iceberg:iceberg-spark3-runtime:0.13.1  --conf spark.sql.catalog.hadoop_prod=org.apache.iceberg.spark.SparkCatalog --conf spark.sql.catalog.hadoop_prod.type=hadoop --conf spark.sql.catalog.hadoop_prod.warehouse=hdfs://10.195.5.62:9001/_iceberg/warehouse\r\n\r\nI just run into spark-sql shell, and use merge into command : \r\nMERGE INTO hadoop_prod.default.target t USING (SELECT * FROM hadoop_prod.default.source) u ON t.id = u.id \r\nWHEN MATCHED THEN UPDATE SET t.name = u.name \r\nWHEN NOT MATCHED THEN INSERT *;\r\n\r\nthen return a message like this : \r\n\r\njava.lang.UnsupportedOperationException: MERGE INTO TABLE is not supported temporarily.\r\n\tat org.apache.spark.sql.execution.SparkStrategies$BasicOperators$.apply(SparkStrategies.scala:796)\r\n\tat org.apache.spark.sql.catalyst.planning.QueryPlanner.$anonfun$plan$1(QueryPlanner.scala:63)\r\n\r\n\r\nCan you help me ? \r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1075969650/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1076115697","html_url":"https://github.com/apache/iceberg/pull/4333#issuecomment-1076115697","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4333","id":1076115697,"node_id":"IC_kwDOCW7NX85AJDjx","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-23T09:01:24Z","updated_at":"2022-03-23T09:01:24Z","author_association":"CONTRIBUTOR","body":"> If we add this to `core`, what are the implications for existing JUnit 4 based tests? As well as for things like overall runtime or any other concerns in operating in a mixed mode? Possibly classpath issues?\r\n> \r\n> Trying to better understand the implications of adding it.\r\n\r\nExisting Junit4 tests will work as usual, so there are no implications and no classpath issues. The only implication is that subclasses of `CatalogTests` will have to be Junit5 tests (which is what's being addressed here as well)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1076115697/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1076403736","html_url":"https://github.com/apache/iceberg/issues/2737#issuecomment-1076403736","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2737","id":1076403736,"node_id":"IC_kwDOCW7NX85AKJ4Y","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-23T13:54:23Z","updated_at":"2022-03-23T13:54:23Z","author_association":"MEMBER","body":"@weichampion \r\n\r\nLooks like you are missing \r\n```\r\n--conf spark.sql.extensions=org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions   \r\n```\r\n\r\nPlease see the docs, https://iceberg.apache.org/docs/latest/getting-started/","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1076403736/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1076425001","html_url":"https://github.com/apache/iceberg/pull/4379#issuecomment-1076425001","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4379","id":1076425001,"node_id":"IC_kwDOCW7NX85AKPEp","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-23T14:13:43Z","updated_at":"2022-03-23T14:13:43Z","author_association":"MEMBER","body":"cc: @aokolnychyi , @RussellSpitzer ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1076425001/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1076456495","html_url":"https://github.com/apache/iceberg/pull/4376#issuecomment-1076456495","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4376","id":1076456495,"node_id":"IC_kwDOCW7NX85AKWwv","user":{"login":"felixYyu","id":3785228,"node_id":"MDQ6VXNlcjM3ODUyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3785228?v=4","gravatar_id":"","url":"https://api.github.com/users/felixYyu","html_url":"https://github.com/felixYyu","followers_url":"https://api.github.com/users/felixYyu/followers","following_url":"https://api.github.com/users/felixYyu/following{/other_user}","gists_url":"https://api.github.com/users/felixYyu/gists{/gist_id}","starred_url":"https://api.github.com/users/felixYyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixYyu/subscriptions","organizations_url":"https://api.github.com/users/felixYyu/orgs","repos_url":"https://api.github.com/users/felixYyu/repos","events_url":"https://api.github.com/users/felixYyu/events{/privacy}","received_events_url":"https://api.github.com/users/felixYyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-23T14:42:09Z","updated_at":"2022-03-24T03:35:57Z","author_association":"CONTRIBUTOR","body":"changelist\r\n```\r\nObject                                      Warnings\r\n------------------------------------------------------------------------------------\r\nBaseFileScanTask.java               UnnecessaryParentheses/MixedMutabilityReturnType\r\nBaseFilesTable.java                 SummaryFragment\r\nFlinkCatalog.java                   MixedMutabilityReturnType\r\nFlinkSplitPlanner.java              LambdaMethodReference\r\n--SnapshotRef.java                  ObjectEqualsForPrimitives--**revert**\r\n--CharSequenceSet.java              ObjectsHashCodeUnnecessaryVarargs--**revert**\r\nDynClasses.java                     ImplicitPublicBuilderConstructor\r\nDynFields.java                      ImplicitPublicBuilderConstructor\r\n--MappedFields.java                 ObjectsHashCodeUnnecessaryVarargs--**revert**\r\n--MetricsModes.java                 ObjectsHashCodeUnnecessaryVarargs--**revert**\r\nBuildAvroProjection.java            UnnecessarilyQualified\r\nSnapshotSummary.java                ImplicitPublicBuilderConstructor\r\n--StructLikeSet.java                ObjectsHashCodeUnnecessaryVarargs--**revert**\r\nJdbcUtil.java                       ProtectedMembersInFinalClass\r\nRemoveSnapshots.java                JavaUtilDate\r\nLoadTableResponse.java              MissingSummary\r\nScanSummary.java                    JavaUtilDate\r\n--ParquetMetricsRowGroupFilter.java UnusedMethod--**revert**\r\nIcebergSplit.java                   MutablePublicArray\r\nTestIcebergInputFormats.java        MutablePublicArray\r\n------------------------------------------------------------------------------------ \r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1076456495/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1076592026","html_url":"https://github.com/apache/iceberg/issues/644#issuecomment-1076592026","issue_url":"https://api.github.com/repos/apache/iceberg/issues/644","id":1076592026,"node_id":"IC_kwDOCW7NX85AK32a","user":{"login":"wilsonpenha","id":26729128,"node_id":"MDQ6VXNlcjI2NzI5MTI4","avatar_url":"https://avatars.githubusercontent.com/u/26729128?v=4","gravatar_id":"","url":"https://api.github.com/users/wilsonpenha","html_url":"https://github.com/wilsonpenha","followers_url":"https://api.github.com/users/wilsonpenha/followers","following_url":"https://api.github.com/users/wilsonpenha/following{/other_user}","gists_url":"https://api.github.com/users/wilsonpenha/gists{/gist_id}","starred_url":"https://api.github.com/users/wilsonpenha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wilsonpenha/subscriptions","organizations_url":"https://api.github.com/users/wilsonpenha/orgs","repos_url":"https://api.github.com/users/wilsonpenha/repos","events_url":"https://api.github.com/users/wilsonpenha/events{/privacy}","received_events_url":"https://api.github.com/users/wilsonpenha/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-23T17:13:55Z","updated_at":"2022-03-23T17:13:55Z","author_association":"NONE","body":"Hello there\r\nWhen this PR will be merged and we will be able to create and query views from iceberg tables?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1076592026/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1076605918","html_url":"https://github.com/apache/iceberg/pull/4372#issuecomment-1076605918","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4372","id":1076605918,"node_id":"IC_kwDOCW7NX85AK7Pe","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-23T17:26:16Z","updated_at":"2022-03-23T17:26:16Z","author_association":"COLLABORATOR","body":"Merged, thanks @liuml07 for change and @kbendick @nastra for additional review","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1076605918/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1076684074","html_url":"https://github.com/apache/iceberg/issues/4292#issuecomment-1076684074","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4292","id":1076684074,"node_id":"IC_kwDOCW7NX85ALOUq","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-23T18:33:20Z","updated_at":"2022-03-23T18:33:20Z","author_association":"CONTRIBUTOR","body":"I agree with your analysis, @szlta. I am surprised `PartitionsTable` does not use `Partitioning$partitionType`.\r\n\r\nI'd do the following in separate PRs:\r\n- Rename conflicting columns in old specs in `Partitioning$partitionType` as [discussed](https://github.com/apache/iceberg/pull/3411#discussion_r821845093).\r\n- Use `Partitioning$partitionType` in all metadata tables.\r\n- Consider adding `partition_spec_id` to metadata tables like `data_files` and `partitions`.\r\n- Consider reusing equivalent columns with column IDs during spec evolutions.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1076684074/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1076696591","html_url":"https://github.com/apache/iceberg/pull/4380#issuecomment-1076696591","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4380","id":1076696591,"node_id":"IC_kwDOCW7NX85ALRYP","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-23T18:45:35Z","updated_at":"2022-03-23T18:45:35Z","author_association":"COLLABORATOR","body":"@rdblue @RussellSpitzer @aokolnychyi  fyi","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1076696591/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1076756955","html_url":"https://github.com/apache/iceberg/issues/4346#issuecomment-1076756955","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4346","id":1076756955,"node_id":"IC_kwDOCW7NX85ALgHb","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-23T19:50:27Z","updated_at":"2022-03-23T19:50:27Z","author_association":"CONTRIBUTOR","body":"@anuragmantri, I am not sure relative paths will help. They will be optional and we will still need to resolve them somehow to compare with absolute paths we get from listing. I assume we will have the same issues without normalization and with different yet equivalent authorities/schemes.\r\n\r\n@flyrain, it is an interesting idea. However, is there an efficient way to compute these values for all files in a location? I assume it will require a request per every listed file, making this extremely expensive. We may find a way to persist these values for referenced files for future use cases but I am afraid we will need to send a request for every actual file that we get after listing a location and it is going to be costly (not to mention that listing itself is already extremely expensive).\r\n\r\n@szehon-ho, I can see you idea being implemented. If I understand correctly, it will behave like this:\r\n\r\n- Build a DF of reachable normalized paths with scheme/authority (if a file does not have either scheme or authority, inherit it from the location we clean).\r\n- Build a DF of reachable normalized paths without scheme/authority.\r\n- Build a DF of all actual files in the location with scheme/authority.\r\n- Find actual locations that don't match reachable normalized paths with scheme/authority. These are potentially orphan files.\r\n- Among potentially orphan files, find which of them match reachable files if we ignore their scheme and authority.\r\n- Act according to `prefix-mismatch-mode` that can be `error` (default), `delete`, `ignore`.\r\n\r\nI think it is worth exploring this option. It is also not perfect, though. Cases when the bucket name (authority) is different would result in an exception. Also, are there scenarios where we want to compare authorities but not schemes?\r\n\r\nWhat does everybody else think?\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1076756955/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1076773031","html_url":"https://github.com/apache/iceberg/pull/4378#issuecomment-1076773031","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4378","id":1076773031,"node_id":"IC_kwDOCW7NX85ALkCn","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-23T20:09:23Z","updated_at":"2022-03-23T20:09:23Z","author_association":"COLLABORATOR","body":"Merged, thanks @ajantha-bhat ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1076773031/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1076811604","html_url":"https://github.com/apache/iceberg/pull/4263#issuecomment-1076811604","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4263","id":1076811604,"node_id":"IC_kwDOCW7NX85ALtdU","user":{"login":"samredai","id":43911210,"node_id":"MDQ6VXNlcjQzOTExMjEw","avatar_url":"https://avatars.githubusercontent.com/u/43911210?v=4","gravatar_id":"","url":"https://api.github.com/users/samredai","html_url":"https://github.com/samredai","followers_url":"https://api.github.com/users/samredai/followers","following_url":"https://api.github.com/users/samredai/following{/other_user}","gists_url":"https://api.github.com/users/samredai/gists{/gist_id}","starred_url":"https://api.github.com/users/samredai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samredai/subscriptions","organizations_url":"https://api.github.com/users/samredai/orgs","repos_url":"https://api.github.com/users/samredai/repos","events_url":"https://api.github.com/users/samredai/events{/privacy}","received_events_url":"https://api.github.com/users/samredai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-23T20:55:51Z","updated_at":"2022-03-23T20:55:51Z","author_association":"CONTRIBUTOR","body":"@rdblue @emkornfield I appreciate the reviews! I think I addressed everything and I also rebased with the changes from the recently merged doctests PR.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1076811604/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1076850852","html_url":"https://github.com/apache/iceberg/issues/4346#issuecomment-1076850852","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4346","id":1076850852,"node_id":"IC_kwDOCW7NX85AL3Ck","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-23T21:45:26Z","updated_at":"2022-03-23T22:06:08Z","author_association":"COLLABORATOR","body":"Yea actually the idea is same as your original, just that:\r\n- rename the flag\r\n- add the error mode (for information to user that they were going to delete valid files)\r\n- combine the authority/scheme into 'prefix'\r\n\r\nMaybe ```delete``` => ```force-delete``` to make it clear they should not do this unless they are sure.\r\n\r\nFor the algorithm, yea that works.  If we want to further optimize we could even conditionally skip the prefix-less comparison for non-error mode, like in original algorithm.\r\n\r\nI'm open if error mode proves too cumbersome to be useful.  Initialy I was thinking its a safety, that they must turn off if trying to delete on a different absolute location than what the files were written with.  Users could go back to running RemoveOrphan with default 'error' mode once table is fixed with all locations on the new prefix.  Maybe it can be via RepairManifests with an option to rewrite the prefix, or once relative path is there we can change the root location.\r\n\r\nYea, I didn't initially think to distinguish scheme/authority, with just prefix, which is different if either are different.  When bucket is different, we should throw exception right?  (user tries to clean a different bucket than the one the table initially wrote to).  Though I can see for the other case  , if the scheme is different (s3 => s3a), it's debatable.  I was thinking to avoid too many details in the config, just have them set prefix-mismatch-mode='ignore' in this case, but we could put another flag if we really need.  Again, the user could eventually fix s3 to s3a in the paths, using some of these to-be-developed features.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1076850852/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1076855219","html_url":"https://github.com/apache/iceberg/issues/4292#issuecomment-1076855219","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4292","id":1076855219,"node_id":"IC_kwDOCW7NX85AL4Gz","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-23T21:51:25Z","updated_at":"2022-03-23T21:51:25Z","author_association":"COLLABORATOR","body":"Third point was already done in #3015 for *files_table, though I think not yet Partitions table","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1076855219/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1076925108","html_url":"https://github.com/apache/iceberg/pull/4371#issuecomment-1076925108","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4371","id":1076925108,"node_id":"IC_kwDOCW7NX85AMJK0","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-23T23:47:11Z","updated_at":"2022-03-23T23:47:11Z","author_association":"CONTRIBUTOR","body":"Thanks for adding the support!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1076925108/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1076988331","html_url":"https://github.com/apache/iceberg/issues/4317#issuecomment-1076988331","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4317","id":1076988331,"node_id":"IC_kwDOCW7NX85AMYmr","user":{"login":"yittg","id":4429171,"node_id":"MDQ6VXNlcjQ0MjkxNzE=","avatar_url":"https://avatars.githubusercontent.com/u/4429171?v=4","gravatar_id":"","url":"https://api.github.com/users/yittg","html_url":"https://github.com/yittg","followers_url":"https://api.github.com/users/yittg/followers","following_url":"https://api.github.com/users/yittg/following{/other_user}","gists_url":"https://api.github.com/users/yittg/gists{/gist_id}","starred_url":"https://api.github.com/users/yittg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yittg/subscriptions","organizations_url":"https://api.github.com/users/yittg/orgs","repos_url":"https://api.github.com/users/yittg/repos","events_url":"https://api.github.com/users/yittg/events{/privacy}","received_events_url":"https://api.github.com/users/yittg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-24T01:53:46Z","updated_at":"2022-03-24T01:53:46Z","author_association":"CONTRIBUTOR","body":"@hililiwei That would be great. For example, supporting of partition transforms.\r\n\r\nIs this migrating on the way?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1076988331/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1077010756","html_url":"https://github.com/apache/iceberg/pull/4379#issuecomment-1077010756","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4379","id":1077010756,"node_id":"IC_kwDOCW7NX85AMeFE","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-24T02:42:47Z","updated_at":"2022-03-24T02:42:47Z","author_association":"MEMBER","body":"@RussellSpitzer : can you please take another look and help merging this PR ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1077010756/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1077014733","html_url":"https://github.com/apache/iceberg/issues/2645#issuecomment-1077014733","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2645","id":1077014733,"node_id":"IC_kwDOCW7NX85AMfDN","user":{"login":"YesOrNo828","id":6017591,"node_id":"MDQ6VXNlcjYwMTc1OTE=","avatar_url":"https://avatars.githubusercontent.com/u/6017591?v=4","gravatar_id":"","url":"https://api.github.com/users/YesOrNo828","html_url":"https://github.com/YesOrNo828","followers_url":"https://api.github.com/users/YesOrNo828/followers","following_url":"https://api.github.com/users/YesOrNo828/following{/other_user}","gists_url":"https://api.github.com/users/YesOrNo828/gists{/gist_id}","starred_url":"https://api.github.com/users/YesOrNo828/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/YesOrNo828/subscriptions","organizations_url":"https://api.github.com/users/YesOrNo828/orgs","repos_url":"https://api.github.com/users/YesOrNo828/repos","events_url":"https://api.github.com/users/YesOrNo828/events{/privacy}","received_events_url":"https://api.github.com/users/YesOrNo828/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-24T02:51:59Z","updated_at":"2022-03-24T02:51:59Z","author_association":"NONE","body":"Hello @yeezychao @xinbinhuang, do you have any progress about this ticket ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1077014733/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1077018617","html_url":"https://github.com/apache/iceberg/pull/3482#issuecomment-1077018617","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3482","id":1077018617,"node_id":"IC_kwDOCW7NX85AMf_5","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-24T03:01:27Z","updated_at":"2022-03-24T03:01:27Z","author_association":"MEMBER","body":"> Hi @KnightChess , if you still have time, could you rebase and address the comments? I would like to move forward on it, I think it's a valuable change.\r\n\r\nAgree, I thought of adding this doc few months ago, but because this PR was already there, I was waiting for it to getting merged.\r\n \r\n@KnightChess : If you don't have time, you can let us know. I can add you as a coauthor and take this PR forward. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1077018617/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1077026459","html_url":"https://github.com/apache/iceberg/pull/3482#issuecomment-1077026459","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3482","id":1077026459,"node_id":"IC_kwDOCW7NX85AMh6b","user":{"login":"KnightChess","id":20125927,"node_id":"MDQ6VXNlcjIwMTI1OTI3","avatar_url":"https://avatars.githubusercontent.com/u/20125927?v=4","gravatar_id":"","url":"https://api.github.com/users/KnightChess","html_url":"https://github.com/KnightChess","followers_url":"https://api.github.com/users/KnightChess/followers","following_url":"https://api.github.com/users/KnightChess/following{/other_user}","gists_url":"https://api.github.com/users/KnightChess/gists{/gist_id}","starred_url":"https://api.github.com/users/KnightChess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/KnightChess/subscriptions","organizations_url":"https://api.github.com/users/KnightChess/orgs","repos_url":"https://api.github.com/users/KnightChess/repos","events_url":"https://api.github.com/users/KnightChess/events{/privacy}","received_events_url":"https://api.github.com/users/KnightChess/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-24T03:18:36Z","updated_at":"2022-03-24T03:18:36Z","author_association":"CONTRIBUTOR","body":"@szehon-ho @ajantha-bhat sorry for the late reply, I will take this PR forward in the next few days.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1077026459/reactions","total_count":2,"+1":0,"-1":0,"laugh":0,"hooray":2,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1077028137","html_url":"https://github.com/apache/iceberg/pull/4280#issuecomment-1077028137","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4280","id":1077028137,"node_id":"IC_kwDOCW7NX85AMiUp","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-24T03:22:17Z","updated_at":"2022-03-24T03:22:17Z","author_association":"CONTRIBUTOR","body":"@rdblue I am merging this because there is a subsequent PR for some caching improvements to the codepath. I think this has been reduced to what we have discussed. The LF integration is only a new client factory, and there is no change to the codebase outside GlueCatalog. Let us know if you have any additional concern, and we can discuss in subsequent PRs. Thanks @xiaoxuandev for bearing with all my nitpickings, this is very important contribution!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1077028137/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1077036305","html_url":"https://github.com/apache/iceberg/pull/3482#issuecomment-1077036305","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3482","id":1077036305,"node_id":"IC_kwDOCW7NX85AMkUR","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-24T03:40:56Z","updated_at":"2022-03-24T03:40:56Z","author_association":"MEMBER","body":"> @szehon-ho @ajantha-bhat sorry for the late reply, I will take this PR forward in the next few days.\r\n\r\nAwesome. Looking forward to it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1077036305/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1077037426","html_url":"https://github.com/apache/iceberg/pull/3432#issuecomment-1077037426","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3432","id":1077037426,"node_id":"IC_kwDOCW7NX85AMkly","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-24T03:43:48Z","updated_at":"2022-03-24T03:43:48Z","author_association":"MEMBER","body":"@jackye1995 : Can we take this PR forward? One of my PR (https://github.com/apache/iceberg/pull/4223) depends on it ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1077037426/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1077051555","html_url":"https://github.com/apache/iceberg/pull/4382#issuecomment-1077051555","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4382","id":1077051555,"node_id":"IC_kwDOCW7NX85AMoCj","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-24T04:17:53Z","updated_at":"2022-03-24T04:17:53Z","author_association":"COLLABORATOR","body":"The failure may not be related, filed: https://github.com/apache/iceberg/issues/4383, re-triggering to see if it goes away.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1077051555/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1077100784","html_url":"https://github.com/apache/iceberg/issues/4383#issuecomment-1077100784","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4383","id":1077100784,"node_id":"IC_kwDOCW7NX85AM0Dw","user":{"login":"rajarshisarkar","id":4561678,"node_id":"MDQ6VXNlcjQ1NjE2Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/4561678?v=4","gravatar_id":"","url":"https://api.github.com/users/rajarshisarkar","html_url":"https://github.com/rajarshisarkar","followers_url":"https://api.github.com/users/rajarshisarkar/followers","following_url":"https://api.github.com/users/rajarshisarkar/following{/other_user}","gists_url":"https://api.github.com/users/rajarshisarkar/gists{/gist_id}","starred_url":"https://api.github.com/users/rajarshisarkar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rajarshisarkar/subscriptions","organizations_url":"https://api.github.com/users/rajarshisarkar/orgs","repos_url":"https://api.github.com/users/rajarshisarkar/repos","events_url":"https://api.github.com/users/rajarshisarkar/events{/privacy}","received_events_url":"https://api.github.com/users/rajarshisarkar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-24T04:50:25Z","updated_at":"2022-03-24T04:50:25Z","author_association":"CONTRIBUTOR","body":"I am also getting this test failure in my recent PRs.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1077100784/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1077138894","html_url":"https://github.com/apache/iceberg/pull/4334#issuecomment-1077138894","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4334","id":1077138894,"node_id":"IC_kwDOCW7NX85AM9XO","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-24T05:06:37Z","updated_at":"2022-03-24T05:06:37Z","author_association":"CONTRIBUTOR","body":"This looks good to me, and I think there has been no comment for a few days, I will merge it to unblock other feature contributions, and for people to test out the access point usages. @rdblue @rajarshisarkar let us know if you have any additional concern, we can address before the upcoming release.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1077138894/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1077251204","html_url":"https://github.com/apache/iceberg/issues/4383#issuecomment-1077251204","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4383","id":1077251204,"node_id":"IC_kwDOCW7NX85ANYyE","user":{"login":"singhpk234","id":35593236,"node_id":"MDQ6VXNlcjM1NTkzMjM2","avatar_url":"https://avatars.githubusercontent.com/u/35593236?v=4","gravatar_id":"","url":"https://api.github.com/users/singhpk234","html_url":"https://github.com/singhpk234","followers_url":"https://api.github.com/users/singhpk234/followers","following_url":"https://api.github.com/users/singhpk234/following{/other_user}","gists_url":"https://api.github.com/users/singhpk234/gists{/gist_id}","starred_url":"https://api.github.com/users/singhpk234/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/singhpk234/subscriptions","organizations_url":"https://api.github.com/users/singhpk234/orgs","repos_url":"https://api.github.com/users/singhpk234/repos","events_url":"https://api.github.com/users/singhpk234/events{/privacy}","received_events_url":"https://api.github.com/users/singhpk234/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-24T05:53:00Z","updated_at":"2022-03-24T05:54:16Z","author_association":"CONTRIBUTOR","body":"Looks like below might be causing this issue **(Might be wrong here)** : \r\nwe pass the conf we have HadoopFileIO to HadoopOutputFile : \r\n\r\nhttps://github.com/apache/iceberg/blob/ea8bbe749753e3d1ddc595ce75a88a55a442a67e/core/src/main/java/org/apache/iceberg/hadoop/HadoopFileIO.java#L63-L65\r\n\r\nwhich is modified for ORC write path : \r\n\r\nhttps://github.com/apache/iceberg/blob/ea8bbe749753e3d1ddc595ce75a88a55a442a67e/orc/src/main/java/org/apache/iceberg/orc/ORC.java#L165-L174\r\n\r\n\r\nLooks like it fails for ORC only : \r\n> org.apache.iceberg.spark.extensions.TestCopyOnWriteMerge > testMergeWithSnapshotIsolation[catalogName = testhive, implementation = org.apache.iceberg.spark.SparkCatalog, config = {type=hive, default-namespace=default}, format = orc, vectorized = true, distributionMode = none] FAILED\r\n\r\nshould we create new conf always and copy the existing hadoop confs in to new conf to avoid this ? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1077251204/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1077282776","html_url":"https://github.com/apache/iceberg/issues/4383#issuecomment-1077282776","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4383","id":1077282776,"node_id":"IC_kwDOCW7NX85ANgfY","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-24T06:31:03Z","updated_at":"2022-03-24T06:34:58Z","author_association":"MEMBER","body":"Okay, this seems to be caused by this PR: \r\n\r\nhttps://github.com/apache/iceberg/pull/4291/files#diff-34d7fce4c1d9417fa9342247cf5ace0636cd86591efbed0555ae80197f79303dL91\r\n\r\nThe original design was also cloning the hadoop configuration to pass to ORC writers. \r\n\r\nhttps://github.com/apache/iceberg/pull/4291/files#diff-34d7fce4c1d9417fa9342247cf5ace0636cd86591efbed0555ae80197f79303dL90-L94 \r\n\r\nBut we've just changed the design in PR #4291","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1077282776/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1077285033","html_url":"https://github.com/apache/iceberg/pull/4376#issuecomment-1077285033","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4376","id":1077285033,"node_id":"IC_kwDOCW7NX85ANhCp","user":{"login":"felixYyu","id":3785228,"node_id":"MDQ6VXNlcjM3ODUyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3785228?v=4","gravatar_id":"","url":"https://api.github.com/users/felixYyu","html_url":"https://github.com/felixYyu","followers_url":"https://api.github.com/users/felixYyu/followers","following_url":"https://api.github.com/users/felixYyu/following{/other_user}","gists_url":"https://api.github.com/users/felixYyu/gists{/gist_id}","starred_url":"https://api.github.com/users/felixYyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixYyu/subscriptions","organizations_url":"https://api.github.com/users/felixYyu/orgs","repos_url":"https://api.github.com/users/felixYyu/repos","events_url":"https://api.github.com/users/felixYyu/events{/privacy}","received_events_url":"https://api.github.com/users/felixYyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-24T06:35:13Z","updated_at":"2022-03-30T04:08:15Z","author_association":"CONTRIBUTOR","body":"changelist-v2  cc @RussellSpitzer \r\n\r\n```\r\nObject                                                         Warnings\r\n------------------------------------------------------------------------------------\r\nTasks.java                                    StreamToIterable--**revert**/new Runnable() lambda\r\nAvro.java                                     UnnecessaryLambda\r\n--InputFilesDecryptor.java                      StreamToIterable--**revert**\r\n--ArrowReader.java                              StreamToIterable--**revert**\r\nOrcSplit.java                                 MissingSummary\r\n--IcebergTimestampObjectInspectorHive3.java     JavaLocalDateTimeGetNano--**revert**\r\nHiveTableOperations.java                      ReverseDnsLookup\r\n------------------------------------------------------------------------------------ \r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1077285033/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1077337564","html_url":"https://github.com/apache/iceberg/pull/3784#issuecomment-1077337564","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3784","id":1077337564,"node_id":"IC_kwDOCW7NX85ANt3c","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-24T07:55:59Z","updated_at":"2022-03-24T09:06:10Z","author_association":"CONTRIBUTOR","body":"> Thanks @hililiwei. Left some further comments.\r\n> \r\n> Additionally, is it possible for these changes to be backported to earlier Spark versions in subsequent PRs to make reviewing easier? It's possible I missed some discussion on this, so let me know if so.\r\n\r\nreverted old version changes for flink and spark.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1077337564/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1077566136","html_url":"https://github.com/apache/iceberg/pull/4384#issuecomment-1077566136","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4384","id":1077566136,"node_id":"IC_kwDOCW7NX85AOlq4","user":{"login":"singhpk234","id":35593236,"node_id":"MDQ6VXNlcjM1NTkzMjM2","avatar_url":"https://avatars.githubusercontent.com/u/35593236?v=4","gravatar_id":"","url":"https://api.github.com/users/singhpk234","html_url":"https://github.com/singhpk234","followers_url":"https://api.github.com/users/singhpk234/followers","following_url":"https://api.github.com/users/singhpk234/following{/other_user}","gists_url":"https://api.github.com/users/singhpk234/gists{/gist_id}","starred_url":"https://api.github.com/users/singhpk234/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/singhpk234/subscriptions","organizations_url":"https://api.github.com/users/singhpk234/orgs","repos_url":"https://api.github.com/users/singhpk234/repos","events_url":"https://api.github.com/users/singhpk234/events{/privacy}","received_events_url":"https://api.github.com/users/singhpk234/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-24T12:17:09Z","updated_at":"2022-03-24T12:17:09Z","author_association":"CONTRIBUTOR","body":"Thanks @openinx , for prompt review :) !!!!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1077566136/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1077654607","html_url":"https://github.com/apache/iceberg/pull/4381#issuecomment-1077654607","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4381","id":1077654607,"node_id":"IC_kwDOCW7NX85AO7RP","user":{"login":"alexjo2144","id":7109804,"node_id":"MDQ6VXNlcjcxMDk4MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/7109804?v=4","gravatar_id":"","url":"https://api.github.com/users/alexjo2144","html_url":"https://github.com/alexjo2144","followers_url":"https://api.github.com/users/alexjo2144/followers","following_url":"https://api.github.com/users/alexjo2144/following{/other_user}","gists_url":"https://api.github.com/users/alexjo2144/gists{/gist_id}","starred_url":"https://api.github.com/users/alexjo2144/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexjo2144/subscriptions","organizations_url":"https://api.github.com/users/alexjo2144/orgs","repos_url":"https://api.github.com/users/alexjo2144/repos","events_url":"https://api.github.com/users/alexjo2144/events{/privacy}","received_events_url":"https://api.github.com/users/alexjo2144/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-24T13:54:47Z","updated_at":"2022-03-24T13:54:47Z","author_association":"CONTRIBUTOR","body":"Mind taking a look? @rdblue @danielcweeks @findepi ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1077654607/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1078018409","html_url":"https://github.com/apache/iceberg/issues/4289#issuecomment-1078018409","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4289","id":1078018409,"node_id":"IC_kwDOCW7NX85AQUFp","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-24T19:31:37Z","updated_at":"2022-03-24T19:31:37Z","author_association":"CONTRIBUTOR","body":"Hi @cccs-jc! Thanks for reporting this.\r\n\r\nCan you please let me know which Iceberg (and Spark) version you have tried this with (just your normal one would be fine, or the latest one you've tried). Also, can you provide me an example (redacted) comment that's more representative of the kind DBT has?\r\n\r\nI see some comment handling code in our `IcebergSqlExtensions.g4` file which generates the antlr grammar, but some comments have meaning (SQL hints) and so having a closer example to what's really generated would be helpful while I take a look.\r\n\r\nThank you!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1078018409/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1078107779","html_url":"https://github.com/apache/iceberg/issues/4289#issuecomment-1078107779","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4289","id":1078107779,"node_id":"IC_kwDOCW7NX85AQp6D","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-24T20:04:17Z","updated_at":"2022-03-24T20:04:25Z","author_association":"MEMBER","body":"I think we'd have to modify our grammar, since our parser uses it's own grammar which doesn't have comments. That or finally copy the grammar from the relevant version of spark and start using that instead of our own custom extension. This may be the time now that we separated by version ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1078107779/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1078396290","html_url":"https://github.com/apache/iceberg/pull/4394#issuecomment-1078396290","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4394","id":1078396290,"node_id":"IC_kwDOCW7NX85ARwWC","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-24T21:27:54Z","updated_at":"2022-03-24T21:27:54Z","author_association":"COLLABORATOR","body":"Looks like #4381 broke the build and this fixes it?  Though, confused how the initial pr passed the build ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1078396290/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1078400558","html_url":"https://github.com/apache/iceberg/pull/4382#issuecomment-1078400558","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4382","id":1078400558,"node_id":"IC_kwDOCW7NX85ARxYu","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-24T21:29:00Z","updated_at":"2022-03-24T21:29:00Z","author_association":"COLLABORATOR","body":"Looks like build is broken in general by https://github.com/apache/iceberg/commit/0f6398f1ae6f5fbde5329858e0cd64064ceb165e, will retrigger after.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1078400558/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1078412753","html_url":"https://github.com/apache/iceberg/issues/4289#issuecomment-1078412753","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4289","id":1078412753,"node_id":"IC_kwDOCW7NX85AR0XR","user":{"login":"cccs-jc","id":56140112,"node_id":"MDQ6VXNlcjU2MTQwMTEy","avatar_url":"https://avatars.githubusercontent.com/u/56140112?v=4","gravatar_id":"","url":"https://api.github.com/users/cccs-jc","html_url":"https://github.com/cccs-jc","followers_url":"https://api.github.com/users/cccs-jc/followers","following_url":"https://api.github.com/users/cccs-jc/following{/other_user}","gists_url":"https://api.github.com/users/cccs-jc/gists{/gist_id}","starred_url":"https://api.github.com/users/cccs-jc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cccs-jc/subscriptions","organizations_url":"https://api.github.com/users/cccs-jc/orgs","repos_url":"https://api.github.com/users/cccs-jc/repos","events_url":"https://api.github.com/users/cccs-jc/events{/privacy}","received_events_url":"https://api.github.com/users/cccs-jc/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-24T21:42:37Z","updated_at":"2022-03-24T21:42:37Z","author_association":"CONTRIBUTOR","body":"dbt issues comments like this before it renders the procedure calls\r\n\r\n\r\n/* {\"app\": \"dbt\", \"dbt_version\": \"1.0.1\", \"profile_name\": \"profile1\", \"target_name\": \"dev\", \"node_id\": \"model.profile1.stg_users\"} */\r\n\r\nright now I modified my dbt-spark adapter to strip this out but I would rather keep the comments for auditing","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1078412753/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1078413384","html_url":"https://github.com/apache/iceberg/pull/4394#issuecomment-1078413384","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4394","id":1078413384,"node_id":"IC_kwDOCW7NX85AR0hI","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-24T21:43:35Z","updated_at":"2022-03-24T21:43:35Z","author_association":"COLLABORATOR","body":"Merging to try to fix the build, thanks for following up.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1078413384/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1078417572","html_url":"https://github.com/apache/iceberg/issues/4289#issuecomment-1078417572","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4289","id":1078417572,"node_id":"IC_kwDOCW7NX85AR1ik","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-24T21:50:23Z","updated_at":"2022-03-24T21:50:23Z","author_association":"CONTRIBUTOR","body":"I think I have found a solution that seems to work for `CALL` statements. The issue is similar to this one, for making the iceberg statements more recognizable: https://github.com/apache/iceberg/pull/2729/files\r\n\r\nI will open a draft PR shortly.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1078417572/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1078438167","html_url":"https://github.com/apache/iceberg/issues/4289#issuecomment-1078438167","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4289","id":1078438167,"node_id":"IC_kwDOCW7NX85AR6kX","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-24T22:23:15Z","updated_at":"2022-03-25T23:32:46Z","author_association":"CONTRIBUTOR","body":"I matched the admittedly wild regex used there against this test query statement. https://regex101.com/r/9cs1yV/1\r\n\r\nFortunately, this function doesn't modify the query at all, just how the query is determined to be an Iceberg-specifc DDL query or not.\r\n\r\nWe still delegate to the _existing_ antlr parser for processing the query, and only strip comments out when we're checking if this is Iceberg specific DDL. Hence there's no concerns about accidentally dropping SQL hints, etc.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1078438167/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1078438586","html_url":"https://github.com/apache/iceberg/pull/4396#issuecomment-1078438586","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4396","id":1078438586,"node_id":"IC_kwDOCW7NX85AR6q6","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-24T22:24:01Z","updated_at":"2022-03-24T22:24:01Z","author_association":"CONTRIBUTOR","body":"I matched the admittedly wild regex used there against this test query statement. https://regex101.com/r/9cs1yV/1\r\n\r\nFortunately, this function doesn't modify the query at all, just how the query is determined to be an Iceberg query or not.\r\n\r\nWe still delegate to the existing antlr parser for processing the query, and only strip comments out when we're checking if this is Iceberg specific DDL. Hence there's no concerns about accidentally dropping SQL hints, etc.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1078438586/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1078439995","html_url":"https://github.com/apache/iceberg/pull/4396#issuecomment-1078439995","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4396","id":1078439995,"node_id":"IC_kwDOCW7NX85AR7A7","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-24T22:26:32Z","updated_at":"2022-03-24T22:37:28Z","author_association":"CONTRIBUTOR","body":"cc @aokolnychyi @RussellSpitzer @rdblue @jackye1995 @danielcweeks @szehon-ho @flyrain  - can you please look at this? Trying to allow for comments in Iceberg DDL, so that people can use Iceberg with DBT or SQL scripts that have comments in them.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1078439995/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1078447950","html_url":"https://github.com/apache/iceberg/pull/4394#issuecomment-1078447950","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4394","id":1078447950,"node_id":"IC_kwDOCW7NX85AR89O","user":{"login":"danielcweeks","id":4925077,"node_id":"MDQ6VXNlcjQ5MjUwNzc=","avatar_url":"https://avatars.githubusercontent.com/u/4925077?v=4","gravatar_id":"","url":"https://api.github.com/users/danielcweeks","html_url":"https://github.com/danielcweeks","followers_url":"https://api.github.com/users/danielcweeks/followers","following_url":"https://api.github.com/users/danielcweeks/following{/other_user}","gists_url":"https://api.github.com/users/danielcweeks/gists{/gist_id}","starred_url":"https://api.github.com/users/danielcweeks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielcweeks/subscriptions","organizations_url":"https://api.github.com/users/danielcweeks/orgs","repos_url":"https://api.github.com/users/danielcweeks/repos","events_url":"https://api.github.com/users/danielcweeks/events{/privacy}","received_events_url":"https://api.github.com/users/danielcweeks/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-24T22:38:50Z","updated_at":"2022-03-24T22:38:50Z","author_association":"CONTRIBUTOR","body":"Thanks @szehon-ho I'm not sure what happened with CI (maybe I missed it), but I didn't see failures.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1078447950/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1078492717","html_url":"https://github.com/apache/iceberg/pull/4395#issuecomment-1078492717","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4395","id":1078492717,"node_id":"IC_kwDOCW7NX85ASH4t","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-24T23:39:59Z","updated_at":"2022-03-24T23:47:27Z","author_association":"CONTRIBUTOR","body":"Note that in order for the Spark UI to show the value of the custom metric, the custom metric class must be available in the classpath of the Spark History Server. The simplest way to do this is to put the Iceberg Spark runtime JAR in the SHS classpath. Spark's `SQLAppStatusListener` loads the custom metric class by name, instantiates it, and calls its `aggregateTaskMetrics` method to get the value of the metric. If it is not able to load the custom metric class, it shows \"N/A\".","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1078492717/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1078511905","html_url":"https://github.com/apache/iceberg/pull/4395#issuecomment-1078511905","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4395","id":1078511905,"node_id":"IC_kwDOCW7NX85ASMkh","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-24T23:52:07Z","updated_at":"2022-03-24T23:52:07Z","author_association":"MEMBER","body":"> Note that in order for the Spark UI to show the value of the custom metric, the custom metric class must be available in the classpath of the Spark History Server. The simplest way to do this is to put the Iceberg Spark runtime JAR in the SHS classpath. Spark's `SQLAppStatusListener` loads the custom metric class by name, instantiates it, and calls its `aggregateTaskMetrics` method to get the value of the metric. If it is not able to load the custom metric class, it shows \"N/A\".\r\n\r\nYeah I was very frustrated with this when i was messing with it. Makes it hard if your history server is not running the same Spark build as your apps :(","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1078511905/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1078561754","html_url":"https://github.com/apache/iceberg/pull/4395#issuecomment-1078561754","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4395","id":1078561754,"node_id":"IC_kwDOCW7NX85ASYva","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-25T01:19:58Z","updated_at":"2022-03-25T01:19:58Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer thank you for the interest. I just updated the PR to add debug logging on the `PartitionReader`s to show how many files each is reading (and the table being read). If you're playing with this, that helps you see the numbers that are being reported for each `InputPartition`, and the sum should be reported in the Spark UI.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1078561754/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1078656991","html_url":"https://github.com/apache/iceberg/issues/4389#issuecomment-1078656991","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4389","id":1078656991,"node_id":"IC_kwDOCW7NX85ASv_f","user":{"login":"molsionmo","id":52347588,"node_id":"MDQ6VXNlcjUyMzQ3NTg4","avatar_url":"https://avatars.githubusercontent.com/u/52347588?v=4","gravatar_id":"","url":"https://api.github.com/users/molsionmo","html_url":"https://github.com/molsionmo","followers_url":"https://api.github.com/users/molsionmo/followers","following_url":"https://api.github.com/users/molsionmo/following{/other_user}","gists_url":"https://api.github.com/users/molsionmo/gists{/gist_id}","starred_url":"https://api.github.com/users/molsionmo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/molsionmo/subscriptions","organizations_url":"https://api.github.com/users/molsionmo/orgs","repos_url":"https://api.github.com/users/molsionmo/repos","events_url":"https://api.github.com/users/molsionmo/events{/privacy}","received_events_url":"https://api.github.com/users/molsionmo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-25T05:01:42Z","updated_at":"2022-03-25T05:01:42Z","author_association":"NONE","body":"You may be missing package hive-metastore-2.3.8.jar(or other version), check hadoop Settings or put the package in the $flink_home/lib directory","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1078656991/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1078692250","html_url":"https://github.com/apache/iceberg/issues/3585#issuecomment-1078692250","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3585","id":1078692250,"node_id":"IC_kwDOCW7NX85AS4ma","user":{"login":"Ashish1997","id":17335120,"node_id":"MDQ6VXNlcjE3MzM1MTIw","avatar_url":"https://avatars.githubusercontent.com/u/17335120?v=4","gravatar_id":"","url":"https://api.github.com/users/Ashish1997","html_url":"https://github.com/Ashish1997","followers_url":"https://api.github.com/users/Ashish1997/followers","following_url":"https://api.github.com/users/Ashish1997/following{/other_user}","gists_url":"https://api.github.com/users/Ashish1997/gists{/gist_id}","starred_url":"https://api.github.com/users/Ashish1997/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Ashish1997/subscriptions","organizations_url":"https://api.github.com/users/Ashish1997/orgs","repos_url":"https://api.github.com/users/Ashish1997/repos","events_url":"https://api.github.com/users/Ashish1997/events{/privacy}","received_events_url":"https://api.github.com/users/Ashish1997/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-25T06:14:05Z","updated_at":"2022-03-25T06:14:05Z","author_association":"NONE","body":"> @rdblue @kbendick I had tried that jar first, actually: had the same exact result, so I looked to the docs in master for getting started and found they still referred to the old jar (I must have missed the correct location to look for the changed getting started instructions?).\r\n> \r\n> I cleared dependency caches (just in case), and ran again with:\r\n> \r\n> ```\r\n> bin/spark-sql --packages org.apache.iceberg:iceberg-spark-runtime-3.2_2.12:0.13.0 \\\r\n>     --repositories https://repository.apache.org/content/repositories/orgapacheiceberg-1079/ \\\r\n>     ...\r\n> ```\r\n> \r\n> but still got the exact same stacktrace as before. Just as a sanity check, I switched over to spark 3.1.2 and the org.apache.iceberg:iceberg-spark-runtime-3.1_2.12:0.13.0 jar and that was able to create the table successfully.\r\n\r\n\r\nThanks, Spark 3.1.3-bin-hadoop3.2 with iceberg-spark-runtime-3.1_2.12:0.13.0 jar also worked for me.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1078692250/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1078750580","html_url":"https://github.com/apache/iceberg/issues/4238#issuecomment-1078750580","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4238","id":1078750580,"node_id":"IC_kwDOCW7NX85ATG10","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-25T07:54:23Z","updated_at":"2022-03-25T07:54:23Z","author_association":"CONTRIBUTOR","body":"Is your intention to simplify this process and do it with TTL properties?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1078750580/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1078786781","html_url":"https://github.com/apache/iceberg/issues/4190#issuecomment-1078786781","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4190","id":1078786781,"node_id":"IC_kwDOCW7NX85ATPrd","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-25T08:42:53Z","updated_at":"2022-03-25T08:42:53Z","author_association":"CONTRIBUTOR","body":"To summarize, your expectation is to dynamically update Iceberg table schema based on the schema of the data flow when the schema of the data flow does not match the Iceberg table?\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1078786781/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1078968347","html_url":"https://github.com/apache/iceberg/pull/4400#issuecomment-1078968347","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4400","id":1078968347,"node_id":"IC_kwDOCW7NX85AT8Ab","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-25T12:09:51Z","updated_at":"2022-03-25T12:09:51Z","author_association":"CONTRIBUTOR","body":"Thanks for the fix @singhpk234 and @rajarshisarkar for the review!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1078968347/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1079336184","html_url":"https://github.com/apache/iceberg/issues/4190#issuecomment-1079336184","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4190","id":1079336184,"node_id":"IC_kwDOCW7NX85AVVz4","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-25T19:02:12Z","updated_at":"2022-03-25T19:02:58Z","author_association":"CONTRIBUTOR","body":"I am not sure this would the universally desired behavior. if data stream contains incompatible schema change (like removing a required field), it will break the downstream consumers.\r\n\r\nthere is a value of automatically syncing input data schema to Iceberg table schema (for compatible schema evolution). Personally, I would like to keep it at the control plane, which would be more natural if there is a schema registry for tracking input data schema change. Control plane can then update Iceberg table schema and restart the Flink job to pick up new Iceberg table schema for write path.\r\n\r\nIt is tricky to support in automatic schema sync in the data plane. There would be parallel Iceberg writers (like hundreds) for a single sink table. Coordinating metadata (like schema) change is very tricky. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1079336184/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1079480188","html_url":"https://github.com/apache/iceberg/issues/4406#issuecomment-1079480188","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4406","id":1079480188,"node_id":"IC_kwDOCW7NX85AV498","user":{"login":"singhpk234","id":35593236,"node_id":"MDQ6VXNlcjM1NTkzMjM2","avatar_url":"https://avatars.githubusercontent.com/u/35593236?v=4","gravatar_id":"","url":"https://api.github.com/users/singhpk234","html_url":"https://github.com/singhpk234","followers_url":"https://api.github.com/users/singhpk234/followers","following_url":"https://api.github.com/users/singhpk234/following{/other_user}","gists_url":"https://api.github.com/users/singhpk234/gists{/gist_id}","starred_url":"https://api.github.com/users/singhpk234/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/singhpk234/subscriptions","organizations_url":"https://api.github.com/users/singhpk234/orgs","repos_url":"https://api.github.com/users/singhpk234/repos","events_url":"https://api.github.com/users/singhpk234/events{/privacy}","received_events_url":"https://api.github.com/users/singhpk234/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-25T22:11:49Z","updated_at":"2022-03-25T22:11:49Z","author_association":"CONTRIBUTOR","body":"based on this discussion https://github.com/apache/iceberg/pull/734#issuecomment-574062407\r\nLooks like passing this env context to the alter table should be sufficient to avoid recursive listing here as well : \r\n```java\r\n          EnvironmentContext envContext = new EnvironmentContext(\r\n              ImmutableMap.of(StatsSetupConst.DO_NOT_UPDATE_STATS, StatsSetupConst.TRUE)\r\n          );\r\n```\r\n\r\ncan I pick this up ? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1079480188/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1079481623","html_url":"https://github.com/apache/iceberg/issues/4406#issuecomment-1079481623","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4406","id":1079481623,"node_id":"IC_kwDOCW7NX85AV5UX","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-25T22:14:32Z","updated_at":"2022-03-25T22:14:32Z","author_association":"MEMBER","body":"Sure I am way behind on reviews anyway :)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1079481623/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1079492230","html_url":"https://github.com/apache/iceberg/pull/4318#issuecomment-1079492230","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4318","id":1079492230,"node_id":"IC_kwDOCW7NX85AV76G","user":{"login":"samredai","id":43911210,"node_id":"MDQ6VXNlcjQzOTExMjEw","avatar_url":"https://avatars.githubusercontent.com/u/43911210?v=4","gravatar_id":"","url":"https://api.github.com/users/samredai","html_url":"https://github.com/samredai","followers_url":"https://api.github.com/users/samredai/followers","following_url":"https://api.github.com/users/samredai/following{/other_user}","gists_url":"https://api.github.com/users/samredai/gists{/gist_id}","starred_url":"https://api.github.com/users/samredai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samredai/subscriptions","organizations_url":"https://api.github.com/users/samredai/orgs","repos_url":"https://api.github.com/users/samredai/repos","events_url":"https://api.github.com/users/samredai/events{/privacy}","received_events_url":"https://api.github.com/users/samredai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-25T22:35:45Z","updated_at":"2022-03-25T22:35:45Z","author_association":"CONTRIBUTOR","body":"Rebased to add the changes from the docstest PR that was merged in.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1079492230/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1079560257","html_url":"https://github.com/apache/iceberg/pull/4399#issuecomment-1079560257","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4399","id":1079560257,"node_id":"IC_kwDOCW7NX85AWMhB","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-26T01:54:01Z","updated_at":"2022-03-26T01:54:01Z","author_association":"MEMBER","body":"key_metadata is only _currently_ unused. It will become active once encryption is implemented. Also since this is part of the spec it should definitely not be removed. \r\n\r\nSee https://iceberg.apache.org/spec/\r\n\r\n```\r\noptional | optional | 131 key_metadata | binary | Implementation-specific key metadata for encryption\r\n-- | -- | -- | -- | --\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1079560257/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1079561711","html_url":"https://github.com/apache/iceberg/pull/4397#issuecomment-1079561711","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4397","id":1079561711,"node_id":"IC_kwDOCW7NX85AWM3v","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-26T01:59:17Z","updated_at":"2022-03-26T01:59:17Z","author_association":"MEMBER","body":"I think the change here is good, but we definitely need some tests.\r\n\r\nIf you like you could put them in\r\n\r\nhttps://github.com/apache/iceberg/blob/4d7837093bd19a42237446a9b656a248e106b789/spark/v3.2/spark/src/test/java/org/apache/iceberg/spark/actions/TestCreateActions.java#L412\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1079561711/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1079565485","html_url":"https://github.com/apache/iceberg/pull/4395#issuecomment-1079565485","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4395","id":1079565485,"node_id":"IC_kwDOCW7NX85AWNyt","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-26T02:10:05Z","updated_at":"2022-03-26T02:10:05Z","author_association":"MEMBER","body":"So one big issue I have here, and why I kind of gave up on this for the moment, is that we actually know all of this information on the driver before any executors run. Not only do we have it there but we can also eliminate duplicate counts for both delete files and for data files. \r\n\r\nIn the current code we would get incorrect results for number of data files if our split size is smaller than our file size. Imagine we have a 512 mb file and 128 mb split size (and row group) this will generate 4 separate tasks for the same Data file. Counting the file 4 times.\r\n\r\nOn the driver we have already materialized every single FileScanTask and know this information and can do the dedupe, our only problem is currently spark doesn't allow us to populate custom metrics at the Source itself on the driver. I think we should push for that capability in spark rather than doing this at the executor level. (Or do it in conjunction with the executor metrics)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1079565485/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1079565947","html_url":"https://github.com/apache/iceberg/pull/4395#issuecomment-1079565947","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4395","id":1079565947,"node_id":"IC_kwDOCW7NX85AWN57","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-26T02:11:39Z","updated_at":"2022-03-26T02:11:39Z","author_association":"MEMBER","body":"Something we could do with custom metrics that we don't know at planning time would be tracking for example, how many records are eliminated via delete files. That's a good metric to know and we wouldn't know it until a task completes.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1079565947/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1079573700","html_url":"https://github.com/apache/iceberg/issues/4363#issuecomment-1079573700","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4363","id":1079573700,"node_id":"IC_kwDOCW7NX85AWPzE","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-26T02:39:39Z","updated_at":"2022-03-26T02:39:39Z","author_association":"CONTRIBUTOR","body":"@krisvaz \r\n```\r\n./pyspark --conf spark.sql.extensions=org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions \\\r\n    --conf spark.sql.catalog.spark_catalog=org.apache.iceberg.spark.SparkSessionCatalog \\\r\n    --conf spark.sql.catalog.spark_catalog.type=hive \\\r\n    --conf spark.sql.catalog.local=org.apache.iceberg.spark.SparkCatalog \\\r\n    --conf spark.sql.catalog.local.type=hadoop \\\r\n    --conf spark.sql.catalog.local.warehouse=$PWD/warehouse\r\n```\r\n```\r\n>>> spark.sql(\"create database local.p2\").show()\r\n>>> df = spark.createDataFrame([{'partition_a': 'A', 'partition_b': 'B', 'data': 'somestuff'}])\r\n>>> df.writeTo(\"local.p2.test\").using(\"iceberg\").partitionedBy(\"partition_a\", \"partition_b\").create()\r\n>>> spark.sql(\"describe local.p2.test\").show()\r\n\r\n+--------------+-----------+-------+\r\n|      col_name|  data_type|comment|\r\n+--------------+-----------+-------+\r\n|          data|     string|       |\r\n|   partition_a|     string|       |\r\n|   partition_b|     string|       |\r\n|              |           |       |\r\n|# Partitioning|           |       |\r\n|        Part 0|partition_a|       |\r\n|        Part 1|partition_b|       |\r\n+--------------+-----------+-------+\r\n\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1079573700/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1079599018","html_url":"https://github.com/apache/iceberg/pull/4399#issuecomment-1079599018","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4399","id":1079599018,"node_id":"IC_kwDOCW7NX85AWV-q","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-26T04:23:14Z","updated_at":"2022-03-26T04:23:14Z","author_association":"CONTRIBUTOR","body":"Yes I would move to close this.\r\n\r\n`key_metadata` is part of the specification, and one of the most important parts of Iceberg is that it has a strong specification. That's the reason that other engines are able to easily add support for Iceberg - and that organizations are able to fork it and add features in a way that will ideally be compatible in the future.\r\n\r\nAs this is part of the spec, there's no way to say that it's not used in some existing forks.\r\n\r\nAs another note: seeing that a function or field is not used anywhere in the Iceberg codebase isn't always an indication that it is entirely unused. While support for some engines is handled within the Iceberg repo, other engines implement support themselves or within their own code base (e.g. Trino, Apache Drill, etc). So we have to be especially cautious removing things that are \"unused\" these days.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1079599018/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1079613533","html_url":"https://github.com/apache/iceberg/pull/4395#issuecomment-1079613533","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4395","id":1079613533,"node_id":"IC_kwDOCW7NX85AWZhd","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-26T05:51:01Z","updated_at":"2022-03-26T05:51:01Z","author_association":"CONTRIBUTOR","body":"> So one big issue I have here, and why I kind of gave up on this for the moment, is that we actually know all of this information on the driver before any executors run. Not only do we have it there but we can also eliminate duplicate counts for both delete files and for data files.\r\n> \r\nYes, I realize that we know the number of files before the tasks are run. It would certainly be better if Spark had driver-side custom metrics. But this is something we can implement with what is Spark 3.2 now. It's not the best way, but I think it's still useful to provide this metric, and it can be implemented in a better way when we get driver-side custom metrics in Spark.\r\n\r\n> In the current code we would get incorrect results for number of data files if our split size is smaller than our file size. Imagine we have a 512 mb file and 128 mb split size (and row group) this will generate 4 separate tasks for the same Data file. Counting the file 4 times.\r\n> \r\nThat is a good point. Even so, such a count is still a useful metric, in that it is a measure of amount of work to do, although \"number of files\" is not the correct name for it. Of course, the actual number of files is a metric we're interested in as well.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1079613533/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1079620348","html_url":"https://github.com/apache/iceberg/issues/4313#issuecomment-1079620348","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4313","id":1079620348,"node_id":"IC_kwDOCW7NX85AWbL8","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-26T06:31:23Z","updated_at":"2022-03-26T12:22:23Z","author_association":"CONTRIBUTOR","body":"1. keep\r\n  ```\r\n  org.apache.iceberg\r\n  iceberg-spark3-runtime\r\n  0.13.1\r\n  ```\r\n  no **test**, marke it  as provided/runtime.\r\n\r\n2. remove \r\n```\r\norg.apache.iceberg\r\niceberg-spark\r\n0.9.1\r\n```\r\nWhen using Spark and Iceberg  only  `iceberg-spark3-runtime` jar is required, and it helps avoid conflict.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1079620348/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1079653757","html_url":"https://github.com/apache/iceberg/pull/3482#issuecomment-1079653757","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3482","id":1079653757,"node_id":"IC_kwDOCW7NX85AWjV9","user":{"login":"KnightChess","id":20125927,"node_id":"MDQ6VXNlcjIwMTI1OTI3","avatar_url":"https://avatars.githubusercontent.com/u/20125927?v=4","gravatar_id":"","url":"https://api.github.com/users/KnightChess","html_url":"https://github.com/KnightChess","followers_url":"https://api.github.com/users/KnightChess/followers","following_url":"https://api.github.com/users/KnightChess/following{/other_user}","gists_url":"https://api.github.com/users/KnightChess/gists{/gist_id}","starred_url":"https://api.github.com/users/KnightChess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/KnightChess/subscriptions","organizations_url":"https://api.github.com/users/KnightChess/orgs","repos_url":"https://api.github.com/users/KnightChess/repos","events_url":"https://api.github.com/users/KnightChess/events{/privacy}","received_events_url":"https://api.github.com/users/KnightChess/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-26T10:02:30Z","updated_at":"2022-03-26T10:02:30Z","author_association":"CONTRIBUTOR","body":"@szehon-ho update other except **Advanced Usage**, and adapt new doc styple for hugo","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1079653757/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1079784280","html_url":"https://github.com/apache/iceberg/issues/4410#issuecomment-1079784280","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4410","id":1079784280,"node_id":"IC_kwDOCW7NX85AXDNY","user":{"login":"samredai","id":43911210,"node_id":"MDQ6VXNlcjQzOTExMjEw","avatar_url":"https://avatars.githubusercontent.com/u/43911210?v=4","gravatar_id":"","url":"https://api.github.com/users/samredai","html_url":"https://github.com/samredai","followers_url":"https://api.github.com/users/samredai/followers","following_url":"https://api.github.com/users/samredai/following{/other_user}","gists_url":"https://api.github.com/users/samredai/gists{/gist_id}","starred_url":"https://api.github.com/users/samredai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samredai/subscriptions","organizations_url":"https://api.github.com/users/samredai/orgs","repos_url":"https://api.github.com/users/samredai/repos","events_url":"https://api.github.com/users/samredai/events{/privacy}","received_events_url":"https://api.github.com/users/samredai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-26T22:10:04Z","updated_at":"2022-03-26T22:10:04Z","author_association":"CONTRIBUTOR","body":"I believe this is caused by the HadoopFileIO [no-arg constructor](https://github.com/apache/iceberg/blob/01393a06c284175edab75de34f48b2bfbd606081/core/src/main/java/org/apache/iceberg/hadoop/HadoopFileIO.java#L42) not setting an empty conf. Using the `HadoopFileIO` directly you can use `setConf` to add an empty configuration (when reading local files) and the NPE goes away. Should the no-arg constructor do the same?\r\n\r\n```java\r\n  public HadoopFileIO() {\r\n    Configuration conf = new Configuration();\r\n    this.hadoopConf = new SerializableConfiguration(conf)::get;\r\n  }\r\n```\r\n\r\nOtherwise, is there some other way to set an empty conf before `JdbcCatalog` uses it?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1079784280/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1079787229","html_url":"https://github.com/apache/iceberg/issues/4410#issuecomment-1079787229","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4410","id":1079787229,"node_id":"IC_kwDOCW7NX85AXD7d","user":{"login":"samredai","id":43911210,"node_id":"MDQ6VXNlcjQzOTExMjEw","avatar_url":"https://avatars.githubusercontent.com/u/43911210?v=4","gravatar_id":"","url":"https://api.github.com/users/samredai","html_url":"https://github.com/samredai","followers_url":"https://api.github.com/users/samredai/followers","following_url":"https://api.github.com/users/samredai/following{/other_user}","gists_url":"https://api.github.com/users/samredai/gists{/gist_id}","starred_url":"https://api.github.com/users/samredai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samredai/subscriptions","organizations_url":"https://api.github.com/users/samredai/orgs","repos_url":"https://api.github.com/users/samredai/repos","events_url":"https://api.github.com/users/samredai/events{/privacy}","received_events_url":"https://api.github.com/users/samredai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-26T22:33:58Z","updated_at":"2022-03-26T22:34:15Z","author_association":"CONTRIBUTOR","body":"Hah, I made this issue too quickly. Using the `setConf` method on `JdbcCatalog` solves this (I was using the interface as the type which is why I missed it).\r\n```java\r\nimport org.apache.hadoop.conf.Configuration;\r\n...\r\n\r\nJdbcCatalog catalog = new JdbcCatalog();\r\nConfiguration conf = new Configuration();\r\ncatalog.setConf(conf)\r\ncatalog.initialize(\"demo\", properties);\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1079787229/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1079982601","html_url":"https://github.com/apache/iceberg/pull/4402#issuecomment-1079982601","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4402","id":1079982601,"node_id":"IC_kwDOCW7NX85AXzoJ","user":{"login":"danielcweeks","id":4925077,"node_id":"MDQ6VXNlcjQ5MjUwNzc=","avatar_url":"https://avatars.githubusercontent.com/u/4925077?v=4","gravatar_id":"","url":"https://api.github.com/users/danielcweeks","html_url":"https://github.com/danielcweeks","followers_url":"https://api.github.com/users/danielcweeks/followers","following_url":"https://api.github.com/users/danielcweeks/following{/other_user}","gists_url":"https://api.github.com/users/danielcweeks/gists{/gist_id}","starred_url":"https://api.github.com/users/danielcweeks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielcweeks/subscriptions","organizations_url":"https://api.github.com/users/danielcweeks/orgs","repos_url":"https://api.github.com/users/danielcweeks/repos","events_url":"https://api.github.com/users/danielcweeks/events{/privacy}","received_events_url":"https://api.github.com/users/danielcweeks/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-27T17:45:20Z","updated_at":"2022-03-27T17:46:06Z","author_association":"CONTRIBUTOR","body":"I think it would be good to discuss what the use case is for this. I can understand trying to annotate some additional information but I'm not sure that this tracks very well with the evolution of tables. If you rename a table now all of the objects are out of sync.  This also isn't particularly helpful for recovering table data because you actually don't know based on the file what manifests they belong to and that of course can change as well.  \r\n\r\nBecause iceberg metadata tracks from the metadata file all the way down to the physical file, I'm not sure there's any reason to do this that I can think of.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1079982601/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080018654","html_url":"https://github.com/apache/iceberg/pull/4245#issuecomment-1080018654","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4245","id":1080018654,"node_id":"IC_kwDOCW7NX85AX8be","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-27T21:03:36Z","updated_at":"2022-03-27T21:03:36Z","author_association":"CONTRIBUTOR","body":"Thanks, @kbendick! This is looking great.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080018654/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080023905","html_url":"https://github.com/apache/iceberg/pull/4367#issuecomment-1080023905","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4367","id":1080023905,"node_id":"IC_kwDOCW7NX85AX9th","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-27T21:36:19Z","updated_at":"2022-03-27T21:36:19Z","author_association":"CONTRIBUTOR","body":"Thanks for reviewing, @kbendick and @danielcweeks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080023905/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080037341","html_url":"https://github.com/apache/iceberg/pull/4262#issuecomment-1080037341","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4262","id":1080037341,"node_id":"IC_kwDOCW7NX85AYA_d","user":{"login":"dramaticlly","id":5961173,"node_id":"MDQ6VXNlcjU5NjExNzM=","avatar_url":"https://avatars.githubusercontent.com/u/5961173?v=4","gravatar_id":"","url":"https://api.github.com/users/dramaticlly","html_url":"https://github.com/dramaticlly","followers_url":"https://api.github.com/users/dramaticlly/followers","following_url":"https://api.github.com/users/dramaticlly/following{/other_user}","gists_url":"https://api.github.com/users/dramaticlly/gists{/gist_id}","starred_url":"https://api.github.com/users/dramaticlly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dramaticlly/subscriptions","organizations_url":"https://api.github.com/users/dramaticlly/orgs","repos_url":"https://api.github.com/users/dramaticlly/repos","events_url":"https://api.github.com/users/dramaticlly/events{/privacy}","received_events_url":"https://api.github.com/users/dramaticlly/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-27T22:58:49Z","updated_at":"2022-03-27T22:58:49Z","author_association":"CONTRIBUTOR","body":"Thank you @samredai  for sending me the patch for addressing most of the comments from @rdblue , I was on personal leave last week so did not have the chance to update in time. \r\n\r\nI believe Sam helped with parametrizing the Literal class with python primitive type, added type hint for both parameters and return type, introduced ABC abstract method, removed several intermediate abstraction together with better handle on float and datetime literal.\r\n\r\n`fastavro` is no longer part of the test dependency and rebased from latest upstream to resolve conflict :) \r\n\r\nCC @jun-he ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080037341/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080044930","html_url":"https://github.com/apache/iceberg/pull/4414#issuecomment-1080044930","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4414","id":1080044930,"node_id":"IC_kwDOCW7NX85AYC2C","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-27T23:36:35Z","updated_at":"2022-03-27T23:36:35Z","author_association":"CONTRIBUTOR","body":"Thanks, @kbendick!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080044930/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080045063","html_url":"https://github.com/apache/iceberg/pull/4409#issuecomment-1080045063","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4409","id":1080045063,"node_id":"IC_kwDOCW7NX85AYC4H","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-27T23:37:34Z","updated_at":"2022-03-27T23:37:34Z","author_association":"CONTRIBUTOR","body":"Thanks, @kbendick!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080045063/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080045137","html_url":"https://github.com/apache/iceberg/pull/4364#issuecomment-1080045137","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4364","id":1080045137,"node_id":"IC_kwDOCW7NX85AYC5R","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-27T23:38:05Z","updated_at":"2022-03-27T23:38:05Z","author_association":"CONTRIBUTOR","body":"Given that the new test case `testMultipleUpsertsToOneRowWithNonPKFieldChanging` can be fixed by using new values for each row as shown here, https://github.com/apache/iceberg/pull/4364#discussion_r835973502, I'm now sure that the issue is unrelated to what this patch is fixing.\r\n\r\nAnd I would suggest that we handle it in another PR. As the issue exists in master, and is not related to the changes this PR fixes.\r\n\r\nI've removed the test and will open another issue and a draft PR with the new test case in it so that anybody who wants to can look into it further.  ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080045137/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080045166","html_url":"https://github.com/apache/iceberg/pull/4408#issuecomment-1080045166","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4408","id":1080045166,"node_id":"IC_kwDOCW7NX85AYC5u","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-27T23:38:16Z","updated_at":"2022-03-27T23:38:16Z","author_association":"CONTRIBUTOR","body":"Thanks, @kbendick!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080045166/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080045731","html_url":"https://github.com/apache/iceberg/pull/4404#issuecomment-1080045731","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4404","id":1080045731,"node_id":"IC_kwDOCW7NX85AYDCj","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-27T23:42:02Z","updated_at":"2022-03-27T23:42:02Z","author_association":"CONTRIBUTOR","body":"You're correct. NaN values are not allowed in lower or upper bounds. Thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1080045731/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]