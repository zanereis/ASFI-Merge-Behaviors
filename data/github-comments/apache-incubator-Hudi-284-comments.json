[{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263026464","html_url":"https://github.com/apache/hudi/pull/6793#issuecomment-1263026464","issue_url":"https://api.github.com/repos/apache/hudi/issues/6793","id":1263026464,"node_id":"IC_kwDOBI7nWM5LSEEg","user":{"login":"boneanxs","id":10115332,"node_id":"MDQ6VXNlcjEwMTE1MzMy","avatar_url":"https://avatars.githubusercontent.com/u/10115332?v=4","gravatar_id":"","url":"https://api.github.com/users/boneanxs","html_url":"https://github.com/boneanxs","followers_url":"https://api.github.com/users/boneanxs/followers","following_url":"https://api.github.com/users/boneanxs/following{/other_user}","gists_url":"https://api.github.com/users/boneanxs/gists{/gist_id}","starred_url":"https://api.github.com/users/boneanxs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/boneanxs/subscriptions","organizations_url":"https://api.github.com/users/boneanxs/orgs","repos_url":"https://api.github.com/users/boneanxs/repos","events_url":"https://api.github.com/users/boneanxs/events{/privacy}","received_events_url":"https://api.github.com/users/boneanxs/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T02:20:11Z","updated_at":"2022-09-30T02:20:11Z","author_association":"CONTRIBUTOR","body":"@hudi-bot run azure","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263026464/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263026731","html_url":"https://github.com/apache/hudi/pull/6751#issuecomment-1263026731","issue_url":"https://api.github.com/repos/apache/hudi/issues/6751","id":1263026731,"node_id":"IC_kwDOBI7nWM5LSEIr","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T02:20:45Z","updated_at":"2022-09-30T02:20:45Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"158346cc320681c745909665038f2ecf0d22a947\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11590\",\n    \"triggerID\" : \"158346cc320681c745909665038f2ecf0d22a947\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"b4f214f1c8e5592b590af131f519af093ebdb10c\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11651\",\n    \"triggerID\" : \"b4f214f1c8e5592b590af131f519af093ebdb10c\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"1cbb28cc66b41ac261f387a94eab46dc079efd6b\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11686\",\n    \"triggerID\" : \"1cbb28cc66b41ac261f387a94eab46dc079efd6b\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"afc44f21d6e5e644a2007fb2400bdbf0f1146890\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11854\",\n    \"triggerID\" : \"afc44f21d6e5e644a2007fb2400bdbf0f1146890\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"c7a1d373796e8bfce040bd79a07f68ef6b7ffc59\",\n    \"status\" : \"UNKNOWN\",\n    \"url\" : \"TBD\",\n    \"triggerID\" : \"c7a1d373796e8bfce040bd79a07f68ef6b7ffc59\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"287c52c6da5eb75093f3c9f7bfd5bfaf0eeb9ac0\",\n    \"status\" : \"FAILURE\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11911\",\n    \"triggerID\" : \"287c52c6da5eb75093f3c9f7bfd5bfaf0eeb9ac0\",\n    \"triggerType\" : \"PUSH\"\n  } ]\n}-->\n## CI report:\n\n* c7a1d373796e8bfce040bd79a07f68ef6b7ffc59 UNKNOWN\n* 287c52c6da5eb75093f3c9f7bfd5bfaf0eeb9ac0 Azure: [FAILURE](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11911) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263026731/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263059421","html_url":"https://github.com/apache/hudi/issues/6835#issuecomment-1263059421","issue_url":"https://api.github.com/repos/apache/hudi/issues/6835","id":1263059421,"node_id":"IC_kwDOBI7nWM5LSMHd","user":{"login":"xiarixiaoyao","id":13514703,"node_id":"MDQ6VXNlcjEzNTE0NzAz","avatar_url":"https://avatars.githubusercontent.com/u/13514703?v=4","gravatar_id":"","url":"https://api.github.com/users/xiarixiaoyao","html_url":"https://github.com/xiarixiaoyao","followers_url":"https://api.github.com/users/xiarixiaoyao/followers","following_url":"https://api.github.com/users/xiarixiaoyao/following{/other_user}","gists_url":"https://api.github.com/users/xiarixiaoyao/gists{/gist_id}","starred_url":"https://api.github.com/users/xiarixiaoyao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xiarixiaoyao/subscriptions","organizations_url":"https://api.github.com/users/xiarixiaoyao/orgs","repos_url":"https://api.github.com/users/xiarixiaoyao/repos","events_url":"https://api.github.com/users/xiarixiaoyao/events{/privacy}","received_events_url":"https://api.github.com/users/xiarixiaoyao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T03:26:49Z","updated_at":"2022-09-30T03:27:09Z","author_association":"CONTRIBUTOR","body":"pls  check this pr  https://github.com/apache/hudi/pull/6741 ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263059421/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263064400","html_url":"https://github.com/apache/hudi/issues/6462#issuecomment-1263064400","issue_url":"https://api.github.com/repos/apache/hudi/issues/6462","id":1263064400,"node_id":"IC_kwDOBI7nWM5LSNVQ","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T03:37:02Z","updated_at":"2022-09-30T03:37:02Z","author_association":"CONTRIBUTOR","body":"https://github.com/apache/hudi/pull/6836\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263064400/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263068927","html_url":"https://github.com/apache/hudi/issues/6462#issuecomment-1263068927","issue_url":"https://api.github.com/repos/apache/hudi/issues/6462","id":1263068927,"node_id":"IC_kwDOBI7nWM5LSOb_","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T03:47:07Z","updated_at":"2022-09-30T03:47:07Z","author_association":"CONTRIBUTOR","body":"closing github issue as we have a fix. thanks for reporting.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263068927/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263069076","html_url":"https://github.com/apache/hudi/issues/6835#issuecomment-1263069076","issue_url":"https://api.github.com/repos/apache/hudi/issues/6835","id":1263069076,"node_id":"IC_kwDOBI7nWM5LSOeU","user":{"login":"wwli05","id":29621865,"node_id":"MDQ6VXNlcjI5NjIxODY1","avatar_url":"https://avatars.githubusercontent.com/u/29621865?v=4","gravatar_id":"","url":"https://api.github.com/users/wwli05","html_url":"https://github.com/wwli05","followers_url":"https://api.github.com/users/wwli05/followers","following_url":"https://api.github.com/users/wwli05/following{/other_user}","gists_url":"https://api.github.com/users/wwli05/gists{/gist_id}","starred_url":"https://api.github.com/users/wwli05/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wwli05/subscriptions","organizations_url":"https://api.github.com/users/wwli05/orgs","repos_url":"https://api.github.com/users/wwli05/repos","events_url":"https://api.github.com/users/wwli05/events{/privacy}","received_events_url":"https://api.github.com/users/wwli05/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T03:47:27Z","updated_at":"2022-09-30T03:47:27Z","author_association":"NONE","body":"thank you ,friends, really JI_SHI_YU","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263069076/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263069591","html_url":"https://github.com/apache/hudi/issues/6421#issuecomment-1263069591","issue_url":"https://api.github.com/repos/apache/hudi/issues/6421","id":1263069591,"node_id":"IC_kwDOBI7nWM5LSOmX","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T03:48:43Z","updated_at":"2022-09-30T03:48:43Z","author_association":"CONTRIBUTOR","body":"@sandip-yadav : gentle ping. did you get a chance to try 0.12.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263069591/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263069837","html_url":"https://github.com/apache/hudi/issues/6428#issuecomment-1263069837","issue_url":"https://api.github.com/repos/apache/hudi/issues/6428","id":1263069837,"node_id":"IC_kwDOBI7nWM5LSOqN","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T03:49:23Z","updated_at":"2022-09-30T03:49:23Z","author_association":"CONTRIBUTOR","body":"yes, you are right. you can disable via hudi-cli as well. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263069837/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263070600","html_url":"https://github.com/apache/hudi/issues/6428#issuecomment-1263070600","issue_url":"https://api.github.com/repos/apache/hudi/issues/6428","id":1263070600,"node_id":"IC_kwDOBI7nWM5LSO2I","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T03:51:15Z","updated_at":"2022-09-30T03:51:15Z","author_association":"CONTRIBUTOR","body":"Since we could not reproduce w/ OSS spark, can you reach out to aws support. \r\nCC @umehrot2 @rahil-c : Have you folks seen this issue before. seems like simple read from metadata table is failing w/ EMR spark. \r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263070600/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263070852","html_url":"https://github.com/apache/hudi/issues/6504#issuecomment-1263070852","issue_url":"https://api.github.com/repos/apache/hudi/issues/6504","id":1263070852,"node_id":"IC_kwDOBI7nWM5LSO6E","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T03:51:56Z","updated_at":"2022-09-30T03:51:56Z","author_association":"CONTRIBUTOR","body":"@santoshraj123 : gentle ping. if you got the issue resolved, feel free to close it out. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263070852/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263071072","html_url":"https://github.com/apache/hudi/issues/6101#issuecomment-1263071072","issue_url":"https://api.github.com/repos/apache/hudi/issues/6101","id":1263071072,"node_id":"IC_kwDOBI7nWM5LSO9g","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T03:52:29Z","updated_at":"2022-09-30T03:52:29Z","author_association":"CONTRIBUTOR","body":"@navbalaraman :  hey any updates for us. if you could not reproduce, feel free to close it out.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263071072/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263105718","html_url":"https://github.com/apache/hudi/pull/6793#issuecomment-1263105718","issue_url":"https://api.github.com/repos/apache/hudi/issues/6793","id":1263105718,"node_id":"IC_kwDOBI7nWM5LSXa2","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T05:02:58Z","updated_at":"2022-09-30T05:02:58Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"da04810eb0593e53bbce0e389930502cfbc217d4\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11730\",\n    \"triggerID\" : \"da04810eb0593e53bbce0e389930502cfbc217d4\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"a39a660ad1c53183d3cf6554f29bdd94b1d707ea\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11733\",\n    \"triggerID\" : \"a39a660ad1c53183d3cf6554f29bdd94b1d707ea\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"5a5beba06c61fd2233a7f6861923b86fa860213e\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11834\",\n    \"triggerID\" : \"5a5beba06c61fd2233a7f6861923b86fa860213e\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"32cc352122d276f5bb5943a0dd420920854fdb8e\",\n    \"status\" : \"CANCELED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11837\",\n    \"triggerID\" : \"32cc352122d276f5bb5943a0dd420920854fdb8e\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"32cc352122d276f5bb5943a0dd420920854fdb8e\",\n    \"status\" : \"SUCCESS\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11916\",\n    \"triggerID\" : \"1263026464\",\n    \"triggerType\" : \"MANUAL\"\n  } ]\n}-->\n## CI report:\n\n* 32cc352122d276f5bb5943a0dd420920854fdb8e Azure: [CANCELED](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11837) Azure: [SUCCESS](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11916) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263105718/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263109912","html_url":"https://github.com/apache/hudi/issues/6462#issuecomment-1263109912","issue_url":"https://api.github.com/repos/apache/hudi/issues/6462","id":1263109912,"node_id":"IC_kwDOBI7nWM5LSYcY","user":{"login":"bigdata-spec","id":23710717,"node_id":"MDQ6VXNlcjIzNzEwNzE3","avatar_url":"https://avatars.githubusercontent.com/u/23710717?v=4","gravatar_id":"","url":"https://api.github.com/users/bigdata-spec","html_url":"https://github.com/bigdata-spec","followers_url":"https://api.github.com/users/bigdata-spec/followers","following_url":"https://api.github.com/users/bigdata-spec/following{/other_user}","gists_url":"https://api.github.com/users/bigdata-spec/gists{/gist_id}","starred_url":"https://api.github.com/users/bigdata-spec/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bigdata-spec/subscriptions","organizations_url":"https://api.github.com/users/bigdata-spec/orgs","repos_url":"https://api.github.com/users/bigdata-spec/repos","events_url":"https://api.github.com/users/bigdata-spec/events{/privacy}","received_events_url":"https://api.github.com/users/bigdata-spec/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T05:11:17Z","updated_at":"2022-09-30T05:11:17Z","author_association":"NONE","body":"@nsivabalan Thank you for your reply，\r\nif I don't set hoodie.metadata.enable\"=\"false\"，throw \"java.lang.NoSuchMethodError: org.apache.hadoop.hdfs.client.HdfsDataInputStream.getReadStatistics()\" \r\nif  I set hoodie.metadata.enable\"=\"false\"， often not every time  throw “\r\nCaused by: org.apache.hudi.exception.HoodieMetadataException: Failed to retrieve list of partition from metadata”\r\nBut when I run the sql again, it work well.\r\nI think Hbase relies on Hadoop 2.10.0，But Our environment is CDH-6.3.2 and hadoop version is 3.0。\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263109912/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263111919","html_url":"https://github.com/apache/hudi/issues/5777#issuecomment-1263111919","issue_url":"https://api.github.com/repos/apache/hudi/issues/5777","id":1263111919,"node_id":"IC_kwDOBI7nWM5LSY7v","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T05:15:03Z","updated_at":"2022-09-30T05:15:03Z","author_association":"CONTRIBUTOR","body":"sorry to have dropped the ball on this. again picking it up. \r\nbtw, I see this config `hoodie.datasource.write.insert.drop.duplicates` was proposed earlier. do not set this to true. if yes, records from incoming batch if they are already in storage, it will be dropped. \r\n\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263111919/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263114477","html_url":"https://github.com/apache/hudi/issues/5777#issuecomment-1263114477","issue_url":"https://api.github.com/repos/apache/hudi/issues/5777","id":1263114477,"node_id":"IC_kwDOBI7nWM5LSZjt","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T05:20:16Z","updated_at":"2022-09-30T05:20:16Z","author_association":"CONTRIBUTOR","body":"@jiangjiguang : did not realize you had give us a reproducible code snippet. so from what you have given above, you could see duplicate data w/ MOR RT query? \r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263114477/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263114829","html_url":"https://github.com/apache/hudi/issues/5777#issuecomment-1263114829","issue_url":"https://api.github.com/repos/apache/hudi/issues/5777","id":1263114829,"node_id":"IC_kwDOBI7nWM5LSZpN","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T05:20:55Z","updated_at":"2022-09-30T05:20:55Z","author_association":"CONTRIBUTOR","body":"I see you have given test data. is everything to be ingested in 1 single commit. or using diff commits. your reproducible script is not very clear on this. \r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263114829/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263115964","html_url":"https://github.com/apache/hudi/issues/6503#issuecomment-1263115964","issue_url":"https://api.github.com/repos/apache/hudi/issues/6503","id":1263115964,"node_id":"IC_kwDOBI7nWM5LSZ68","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T05:23:00Z","updated_at":"2022-09-30T05:23:00Z","author_association":"CONTRIBUTOR","body":"my understanding is that, preCombine is a mandatory field for merge into statement. But I will let @alexeykudinkin investigate further though. \r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263115964/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263116299","html_url":"https://github.com/apache/hudi/issues/5582#issuecomment-1263116299","issue_url":"https://api.github.com/repos/apache/hudi/issues/5582","id":1263116299,"node_id":"IC_kwDOBI7nWM5LSaAL","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T05:23:39Z","updated_at":"2022-09-30T05:23:39Z","author_association":"CONTRIBUTOR","body":"@nitinkul @vicuna96 : gentle ping.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263116299/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263117459","html_url":"https://github.com/apache/hudi/issues/6835#issuecomment-1263117459","issue_url":"https://api.github.com/repos/apache/hudi/issues/6835","id":1263117459,"node_id":"IC_kwDOBI7nWM5LSaST","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T05:25:41Z","updated_at":"2022-09-30T05:25:41Z","author_association":"CONTRIBUTOR","body":"since we have a patch being actively worked on, closing the issue. thanks for reporting. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263117459/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263120280","html_url":"https://github.com/apache/hudi/issues/6825#issuecomment-1263120280","issue_url":"https://api.github.com/repos/apache/hudi/issues/6825","id":1263120280,"node_id":"IC_kwDOBI7nWM5LSa-Y","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T05:30:26Z","updated_at":"2022-09-30T05:30:26Z","author_association":"CONTRIBUTOR","body":"guess timeline server crashed for some reason. \r\nCC @yihua any thoughts. \r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263120280/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263121682","html_url":"https://github.com/apache/hudi/issues/6804#issuecomment-1263121682","issue_url":"https://api.github.com/repos/apache/hudi/issues/6804","id":1263121682,"node_id":"IC_kwDOBI7nWM5LSbUS","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T05:32:55Z","updated_at":"2022-09-30T05:32:55Z","author_association":"CONTRIBUTOR","body":"if not for metadata table, can't think of easier way to go about this. essentially cleaner has cleaned up some data file which is being required by the query. if you have very aggressive cleaner configs, you may try to relax them based on the max time any query can take for the table of interest. \r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263121682/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263122615","html_url":"https://github.com/apache/hudi/issues/6800#issuecomment-1263122615","issue_url":"https://api.github.com/repos/apache/hudi/issues/6800","id":1263122615,"node_id":"IC_kwDOBI7nWM5LSbi3","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T05:34:42Z","updated_at":"2022-09-30T05:34:42Z","author_association":"CONTRIBUTOR","body":"we rely on avro's field naming conventions. looks like starting char cannot be numbers. \r\nhttps://issues.apache.org/jira/browse/AVRO-153\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263122615/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263123231","html_url":"https://github.com/apache/hudi/issues/6800#issuecomment-1263123231","issue_url":"https://api.github.com/repos/apache/hudi/issues/6800","id":1263123231,"node_id":"IC_kwDOBI7nWM5LSbsf","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T05:35:48Z","updated_at":"2022-09-30T05:35:48Z","author_association":"CONTRIBUTOR","body":"if you are using deltastreamer, you can add a schema post processor and rename columns. if not,can't think of any easy solution apart from manually fixing it. \r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263123231/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263152153","html_url":"https://github.com/apache/hudi/pull/6665#issuecomment-1263152153","issue_url":"https://api.github.com/repos/apache/hudi/issues/6665","id":1263152153,"node_id":"IC_kwDOBI7nWM5LSiwZ","user":{"login":"codope","id":16440354,"node_id":"MDQ6VXNlcjE2NDQwMzU0","avatar_url":"https://avatars.githubusercontent.com/u/16440354?v=4","gravatar_id":"","url":"https://api.github.com/users/codope","html_url":"https://github.com/codope","followers_url":"https://api.github.com/users/codope/followers","following_url":"https://api.github.com/users/codope/following{/other_user}","gists_url":"https://api.github.com/users/codope/gists{/gist_id}","starred_url":"https://api.github.com/users/codope/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codope/subscriptions","organizations_url":"https://api.github.com/users/codope/orgs","repos_url":"https://api.github.com/users/codope/repos","events_url":"https://api.github.com/users/codope/events{/privacy}","received_events_url":"https://api.github.com/users/codope/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T06:18:42Z","updated_at":"2022-09-30T06:18:42Z","author_association":"MEMBER","body":"> \r\n\r\nI ran the tests locally. Works for me. Probably you're not building it right. Note that for Spark 3.2, you need to use the following maven command\r\n`mvn clean install -DskipTests -Dspark3.2 -Dscala-2.12`\r\nand for Spark 2.4, use `mavn clean install -DskipTests` (spark2 and scala-2.11 are defaults).","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263152153/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263158269","html_url":"https://github.com/apache/hudi/pull/5064#issuecomment-1263158269","issue_url":"https://api.github.com/repos/apache/hudi/issues/5064","id":1263158269,"node_id":"IC_kwDOBI7nWM5LSkP9","user":{"login":"Zouxxyy","id":37108074,"node_id":"MDQ6VXNlcjM3MTA4MDc0","avatar_url":"https://avatars.githubusercontent.com/u/37108074?v=4","gravatar_id":"","url":"https://api.github.com/users/Zouxxyy","html_url":"https://github.com/Zouxxyy","followers_url":"https://api.github.com/users/Zouxxyy/followers","following_url":"https://api.github.com/users/Zouxxyy/following{/other_user}","gists_url":"https://api.github.com/users/Zouxxyy/gists{/gist_id}","starred_url":"https://api.github.com/users/Zouxxyy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Zouxxyy/subscriptions","organizations_url":"https://api.github.com/users/Zouxxyy/orgs","repos_url":"https://api.github.com/users/Zouxxyy/repos","events_url":"https://api.github.com/users/Zouxxyy/events{/privacy}","received_events_url":"https://api.github.com/users/Zouxxyy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T06:25:49Z","updated_at":"2022-09-30T06:25:49Z","author_association":"CONTRIBUTOR","body":"Is there a conflict between using metaserver and hudi metadata? For example, using them at the same time\r\nHudi's metadata now supports not only FILES, but also COLUMN_ STATS and BLOOM_ FILTERS. Currently, metaserver only supports list files and list partitions. Will it complement others?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263158269/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263160137","html_url":"https://github.com/apache/hudi/issues/6829#issuecomment-1263160137","issue_url":"https://api.github.com/repos/apache/hudi/issues/6829","id":1263160137,"node_id":"IC_kwDOBI7nWM5LSktJ","user":{"login":"codope","id":16440354,"node_id":"MDQ6VXNlcjE2NDQwMzU0","avatar_url":"https://avatars.githubusercontent.com/u/16440354?v=4","gravatar_id":"","url":"https://api.github.com/users/codope","html_url":"https://github.com/codope","followers_url":"https://api.github.com/users/codope/followers","following_url":"https://api.github.com/users/codope/following{/other_user}","gists_url":"https://api.github.com/users/codope/gists{/gist_id}","starred_url":"https://api.github.com/users/codope/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codope/subscriptions","organizations_url":"https://api.github.com/users/codope/orgs","repos_url":"https://api.github.com/users/codope/repos","events_url":"https://api.github.com/users/codope/events{/privacy}","received_events_url":"https://api.github.com/users/codope/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T06:28:05Z","updated_at":"2022-09-30T06:28:05Z","author_association":"MEMBER","body":"@KnightChess Does the solution proposed in https://github.com/apache/hudi/issues/6588#issuecomment-1236580669 work for you?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263160137/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263165665","html_url":"https://github.com/apache/hudi/issues/6829#issuecomment-1263165665","issue_url":"https://api.github.com/repos/apache/hudi/issues/6829","id":1263165665,"node_id":"IC_kwDOBI7nWM5LSmDh","user":{"login":"KnightChess","id":20125927,"node_id":"MDQ6VXNlcjIwMTI1OTI3","avatar_url":"https://avatars.githubusercontent.com/u/20125927?v=4","gravatar_id":"","url":"https://api.github.com/users/KnightChess","html_url":"https://github.com/KnightChess","followers_url":"https://api.github.com/users/KnightChess/followers","following_url":"https://api.github.com/users/KnightChess/following{/other_user}","gists_url":"https://api.github.com/users/KnightChess/gists{/gist_id}","starred_url":"https://api.github.com/users/KnightChess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/KnightChess/subscriptions","organizations_url":"https://api.github.com/users/KnightChess/orgs","repos_url":"https://api.github.com/users/KnightChess/repos","events_url":"https://api.github.com/users/KnightChess/events{/privacy}","received_events_url":"https://api.github.com/users/KnightChess/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T06:34:44Z","updated_at":"2022-09-30T06:34:44Z","author_association":"CONTRIBUTOR","body":"@codope yes, it's work, but I think need fix to compatible between the multy engines","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263165665/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263177489","html_url":"https://github.com/apache/hudi/issues/6800#issuecomment-1263177489","issue_url":"https://api.github.com/repos/apache/hudi/issues/6800","id":1263177489,"node_id":"IC_kwDOBI7nWM5LSo8R","user":{"login":"gtwuser","id":6791570,"node_id":"MDQ6VXNlcjY3OTE1NzA=","avatar_url":"https://avatars.githubusercontent.com/u/6791570?v=4","gravatar_id":"","url":"https://api.github.com/users/gtwuser","html_url":"https://github.com/gtwuser","followers_url":"https://api.github.com/users/gtwuser/followers","following_url":"https://api.github.com/users/gtwuser/following{/other_user}","gists_url":"https://api.github.com/users/gtwuser/gists{/gist_id}","starred_url":"https://api.github.com/users/gtwuser/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gtwuser/subscriptions","organizations_url":"https://api.github.com/users/gtwuser/orgs","repos_url":"https://api.github.com/users/gtwuser/repos","events_url":"https://api.github.com/users/gtwuser/events{/privacy}","received_events_url":"https://api.github.com/users/gtwuser/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T06:50:45Z","updated_at":"2022-09-30T06:50:45Z","author_association":"NONE","body":"We are not using deltastreamer, but thanks for sharing this, will close this issue then and would work towards column renaming","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263177489/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263184742","html_url":"https://github.com/apache/hudi/issues/6797#issuecomment-1263184742","issue_url":"https://api.github.com/repos/apache/hudi/issues/6797","id":1263184742,"node_id":"IC_kwDOBI7nWM5LSqtm","user":{"login":"codope","id":16440354,"node_id":"MDQ6VXNlcjE2NDQwMzU0","avatar_url":"https://avatars.githubusercontent.com/u/16440354?v=4","gravatar_id":"","url":"https://api.github.com/users/codope","html_url":"https://github.com/codope","followers_url":"https://api.github.com/users/codope/followers","following_url":"https://api.github.com/users/codope/following{/other_user}","gists_url":"https://api.github.com/users/codope/gists{/gist_id}","starred_url":"https://api.github.com/users/codope/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codope/subscriptions","organizations_url":"https://api.github.com/users/codope/orgs","repos_url":"https://api.github.com/users/codope/repos","events_url":"https://api.github.com/users/codope/events{/privacy}","received_events_url":"https://api.github.com/users/codope/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T07:00:19Z","updated_at":"2022-09-30T07:00:19Z","author_association":"MEMBER","body":"@gtwuser I added a unit test where I could not reproduce this behavior with nested record key field: https://github.com/codope/hudi/commit/b018861f895218259f7b72793776068c7bb623ae\r\n\r\nAnd I also ran a very simple test with a small json file to match your schema and configs. I was able to write and read hudi table successfully. Please check this gist https://gist.github.com/codope/89fc0749c8a285a74bfb6883861ddddf\r\nNote that I am using Hudi 0.12.0.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263184742/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263187034","html_url":"https://github.com/apache/hudi/pull/6665#issuecomment-1263187034","issue_url":"https://api.github.com/repos/apache/hudi/issues/6665","id":1263187034,"node_id":"IC_kwDOBI7nWM5LSrRa","user":{"login":"pramodbiligiri","id":759691,"node_id":"MDQ6VXNlcjc1OTY5MQ==","avatar_url":"https://avatars.githubusercontent.com/u/759691?v=4","gravatar_id":"","url":"https://api.github.com/users/pramodbiligiri","html_url":"https://github.com/pramodbiligiri","followers_url":"https://api.github.com/users/pramodbiligiri/followers","following_url":"https://api.github.com/users/pramodbiligiri/following{/other_user}","gists_url":"https://api.github.com/users/pramodbiligiri/gists{/gist_id}","starred_url":"https://api.github.com/users/pramodbiligiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pramodbiligiri/subscriptions","organizations_url":"https://api.github.com/users/pramodbiligiri/orgs","repos_url":"https://api.github.com/users/pramodbiligiri/repos","events_url":"https://api.github.com/users/pramodbiligiri/events{/privacy}","received_events_url":"https://api.github.com/users/pramodbiligiri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T07:03:12Z","updated_at":"2022-09-30T07:03:12Z","author_association":"CONTRIBUTOR","body":"Ack. Did more or less the same locally, just now:\r\nI'm not able to repro the error. Could have been because I hadn't cleaned up the build and different versions were conflicting. I just ran the below two commands and it worked:\r\n$ mvn -DskipTests -Dspark2 -Dscala-2.12 -Dcheckstyle.skip -Drat.skip clean install\r\nFollowed by:\r\n$ mvn -Dspark2 -Dscala-2.12 -Dcheckstyle.skip -Drat.skip -Dtest=org.apache.hudi.utilities.sources.TestGcsEventsSource -pl hudi-utilities test\r\n[INFO] Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 41.804 s - in org.apache.hudi.utilities.sources.TestGcsEventsSource\r\n[INFO]\r\n[INFO] Results:\r\n[INFO]\r\n[INFO] Tests run: 5, Failures: 0, Errors: 0, Skipped: 0\r\n[INFO]\r\n[INFO] ------------------------------------------------------------------------\r\n[INFO] BUILD SUCCESS\r\n[INFO] ------------------------------------------------------------------------\r\n[INFO] Total time:  01:07 min","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263187034/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263196874","html_url":"https://github.com/apache/hudi/issues/6829#issuecomment-1263196874","issue_url":"https://api.github.com/repos/apache/hudi/issues/6829","id":1263196874,"node_id":"IC_kwDOBI7nWM5LStrK","user":{"login":"codope","id":16440354,"node_id":"MDQ6VXNlcjE2NDQwMzU0","avatar_url":"https://avatars.githubusercontent.com/u/16440354?v=4","gravatar_id":"","url":"https://api.github.com/users/codope","html_url":"https://github.com/codope","followers_url":"https://api.github.com/users/codope/followers","following_url":"https://api.github.com/users/codope/following{/other_user}","gists_url":"https://api.github.com/users/codope/gists{/gist_id}","starred_url":"https://api.github.com/users/codope/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codope/subscriptions","organizations_url":"https://api.github.com/users/codope/orgs","repos_url":"https://api.github.com/users/codope/repos","events_url":"https://api.github.com/users/codope/events{/privacy}","received_events_url":"https://api.github.com/users/codope/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T07:14:48Z","updated_at":"2022-09-30T07:14:48Z","author_association":"MEMBER","body":"Yes, I think we should shade/relocate avro in all bundles where it is included. The issue here is that it is shaded in one bundle but not in another. By shading in all bundles, there shouldn't be a conflict between shaded and unshaded class. Created HUDI-4954 to track it. If you would like to contribute, feel free to put up a PR.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263196874/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263213658","html_url":"https://github.com/apache/hudi/issues/6832#issuecomment-1263213658","issue_url":"https://api.github.com/repos/apache/hudi/issues/6832","id":1263213658,"node_id":"IC_kwDOBI7nWM5LSxxa","user":{"login":"codope","id":16440354,"node_id":"MDQ6VXNlcjE2NDQwMzU0","avatar_url":"https://avatars.githubusercontent.com/u/16440354?v=4","gravatar_id":"","url":"https://api.github.com/users/codope","html_url":"https://github.com/codope","followers_url":"https://api.github.com/users/codope/followers","following_url":"https://api.github.com/users/codope/following{/other_user}","gists_url":"https://api.github.com/users/codope/gists{/gist_id}","starred_url":"https://api.github.com/users/codope/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codope/subscriptions","organizations_url":"https://api.github.com/users/codope/orgs","repos_url":"https://api.github.com/users/codope/repos","events_url":"https://api.github.com/users/codope/events{/privacy}","received_events_url":"https://api.github.com/users/codope/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T07:32:26Z","updated_at":"2022-09-30T07:32:26Z","author_association":"MEMBER","body":"> sometimes it could write the dataframe successfully\r\n> sometimes it would fail (with the same dataframe but different table name)\r\n\r\nThis is strange. The hive sync configs look fine. In the stacktrace, i see partition sync errors out for the same table name as in the config i.e. `Customer_Sample_Hudi`. When you do `show tables`, do you see multiple Hudi tables?\r\n\r\ncc @xushiyan ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263213658/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263217513","html_url":"https://github.com/apache/hudi/issues/6819#issuecomment-1263217513","issue_url":"https://api.github.com/repos/apache/hudi/issues/6819","id":1263217513,"node_id":"IC_kwDOBI7nWM5LSytp","user":{"login":"codope","id":16440354,"node_id":"MDQ6VXNlcjE2NDQwMzU0","avatar_url":"https://avatars.githubusercontent.com/u/16440354?v=4","gravatar_id":"","url":"https://api.github.com/users/codope","html_url":"https://github.com/codope","followers_url":"https://api.github.com/users/codope/followers","following_url":"https://api.github.com/users/codope/following{/other_user}","gists_url":"https://api.github.com/users/codope/gists{/gist_id}","starred_url":"https://api.github.com/users/codope/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codope/subscriptions","organizations_url":"https://api.github.com/users/codope/orgs","repos_url":"https://api.github.com/users/codope/repos","events_url":"https://api.github.com/users/codope/events{/privacy}","received_events_url":"https://api.github.com/users/codope/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T07:36:27Z","updated_at":"2022-09-30T07:36:27Z","author_association":"MEMBER","body":"@mikeashley87 Path not serializable is a known issue which was fixed in https://github.com/apache/hudi/commit/7a9d48d126b1474f1bb7cfbe8b1c0b0391ef49d2\r\nThe fix was released in Hudi version 0.12.0. Can you please try with that?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263217513/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263227049","html_url":"https://github.com/apache/hudi/issues/6797#issuecomment-1263227049","issue_url":"https://api.github.com/repos/apache/hudi/issues/6797","id":1263227049,"node_id":"IC_kwDOBI7nWM5LS1Cp","user":{"login":"gtwuser","id":6791570,"node_id":"MDQ6VXNlcjY3OTE1NzA=","avatar_url":"https://avatars.githubusercontent.com/u/6791570?v=4","gravatar_id":"","url":"https://api.github.com/users/gtwuser","html_url":"https://github.com/gtwuser","followers_url":"https://api.github.com/users/gtwuser/followers","following_url":"https://api.github.com/users/gtwuser/following{/other_user}","gists_url":"https://api.github.com/users/gtwuser/gists{/gist_id}","starred_url":"https://api.github.com/users/gtwuser/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gtwuser/subscriptions","organizations_url":"https://api.github.com/users/gtwuser/orgs","repos_url":"https://api.github.com/users/gtwuser/repos","events_url":"https://api.github.com/users/gtwuser/events{/privacy}","received_events_url":"https://api.github.com/users/gtwuser/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T07:46:21Z","updated_at":"2022-09-30T07:46:21Z","author_association":"NONE","body":"Closing this issue since there were records missing `metadata` column itself. Sorry for this confusion. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263227049/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263231014","html_url":"https://github.com/apache/hudi/issues/6825#issuecomment-1263231014","issue_url":"https://api.github.com/repos/apache/hudi/issues/6825","id":1263231014,"node_id":"IC_kwDOBI7nWM5LS2Am","user":{"login":"codope","id":16440354,"node_id":"MDQ6VXNlcjE2NDQwMzU0","avatar_url":"https://avatars.githubusercontent.com/u/16440354?v=4","gravatar_id":"","url":"https://api.github.com/users/codope","html_url":"https://github.com/codope","followers_url":"https://api.github.com/users/codope/followers","following_url":"https://api.github.com/users/codope/following{/other_user}","gists_url":"https://api.github.com/users/codope/gists{/gist_id}","starred_url":"https://api.github.com/users/codope/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codope/subscriptions","organizations_url":"https://api.github.com/users/codope/orgs","repos_url":"https://api.github.com/users/codope/repos","events_url":"https://api.github.com/users/codope/events{/privacy}","received_events_url":"https://api.github.com/users/codope/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T07:50:32Z","updated_at":"2022-09-30T07:51:56Z","author_association":"MEMBER","body":"Yes from the stack trace it seems like the timeline server crashed. To root cause, we will have to look into driver resource monitors. If you hit this issue very frequently, then I would recommend to check the driver health and resources, see if it is under high usage. \r\nIn the upcoming release version, we have added a retry mechanism based on exponential backoff to avoid any throttling issues: https://github.com/apache/hudi/commit/c597eb5d206b528d201a47194e144b8aed732c0e\r\nHowever, in the meantime, perhaps you could disable timeline server and remote filesytem view using\r\n```\r\nhoodie.embed.timeline.server=false\r\nhoodie.filesystem.view.type=MEMORY\r\n```","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263231014/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263252224","html_url":"https://github.com/apache/hudi/pull/6636#issuecomment-1263252224","issue_url":"https://api.github.com/repos/apache/hudi/issues/6636","id":1263252224,"node_id":"IC_kwDOBI7nWM5LS7MA","user":{"login":"wqwl611","id":67826098,"node_id":"MDQ6VXNlcjY3ODI2MDk4","avatar_url":"https://avatars.githubusercontent.com/u/67826098?v=4","gravatar_id":"","url":"https://api.github.com/users/wqwl611","html_url":"https://github.com/wqwl611","followers_url":"https://api.github.com/users/wqwl611/followers","following_url":"https://api.github.com/users/wqwl611/following{/other_user}","gists_url":"https://api.github.com/users/wqwl611/gists{/gist_id}","starred_url":"https://api.github.com/users/wqwl611/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wqwl611/subscriptions","organizations_url":"https://api.github.com/users/wqwl611/orgs","repos_url":"https://api.github.com/users/wqwl611/repos","events_url":"https://api.github.com/users/wqwl611/events{/privacy}","received_events_url":"https://api.github.com/users/wqwl611/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T08:08:08Z","updated_at":"2022-09-30T08:12:04Z","author_association":"CONTRIBUTOR","body":"> @wqwl611 there are a bunch of flakiness fixes went in master. you might want to rebase\r\n\r\n@xushiyan I  rebase my repo wrongly，and I delete it and refork it，then apply all the changes，how can I use the old pr？","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263252224/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263257319","html_url":"https://github.com/apache/hudi/issues/6832#issuecomment-1263257319","issue_url":"https://api.github.com/repos/apache/hudi/issues/6832","id":1263257319,"node_id":"IC_kwDOBI7nWM5LS8bn","user":{"login":"dragonH","id":18332044,"node_id":"MDQ6VXNlcjE4MzMyMDQ0","avatar_url":"https://avatars.githubusercontent.com/u/18332044?v=4","gravatar_id":"","url":"https://api.github.com/users/dragonH","html_url":"https://github.com/dragonH","followers_url":"https://api.github.com/users/dragonH/followers","following_url":"https://api.github.com/users/dragonH/following{/other_user}","gists_url":"https://api.github.com/users/dragonH/gists{/gist_id}","starred_url":"https://api.github.com/users/dragonH/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dragonH/subscriptions","organizations_url":"https://api.github.com/users/dragonH/orgs","repos_url":"https://api.github.com/users/dragonH/repos","events_url":"https://api.github.com/users/dragonH/events{/privacy}","received_events_url":"https://api.github.com/users/dragonH/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T08:13:12Z","updated_at":"2022-09-30T08:13:12Z","author_association":"NONE","body":"hi @codope \r\n\r\nthanks for your kindly help\r\n\r\nhere's my another try\r\n\r\nanother hudi config (I used `Customer_Sample_Hudi_001` instead of `Customer_Sample_Hudi`)\r\n\r\nfirst, i used `show tables` to list tables\r\n\r\n<img width=\"221\" alt=\"image\" src=\"https://user-images.githubusercontent.com/18332044/193223276-cd667a96-1bab-46cb-a266-00ca31e5f937.png\">\r\n\r\nwe could see that the table `Customer_Sample_Hudi_001` was not there\r\n\r\nthen used the hudi config below\r\n\r\n```\r\nhudi_options = {\r\n    'hoodie.table.name': 'Customer_Sample_Hudi_001',\r\n    'hoodie.datasource.write.storage.type': 'COPY_ON_WRITE',\r\n    'hoodie.datasource.write.recordkey.field': 'MA001',\r\n    'hoodie.datasource.write.partitionpath.field': 'MA001',\r\n    'hoodie.datasource.write.table.name': 'Customer_Sample_Hudi_001',\r\n    'hoodie.datasource.write.operation': 'insert_overwrite',\r\n    'hoodie.datasource.write.precombine.field': 'load_timestamp',\r\n    'hoodie.datasource.write.hive_style_partitioning': 'true',\r\n    'hoodie.upsert.shuffle.parallelism': 2,\r\n    'hoodie.insert.shuffle.parallelism': 2,\r\n    'path': 's3://drwu-data-platform-staging-data/Customer_Sample_Hudi_001/',\r\n    'hoodie.datasource.hive_sync.enable': 'true',\r\n    'hoodie.datasource.hive_sync.database': 'default',\r\n    'hoodie.datasource.hive_sync.table': 'Customer_Sample_Hudi_001',\r\n    'hoodie.datasource.hive_sync.partition_fields': 'MA001',\r\n    'hoodie.datasource.hive_sync.partition_extractor_class': 'org.apache.hudi.hive.MultiPartKeysValueExtractor',\r\n    'hoodie.datasource.hive_sync.use_jdbc': 'false',\r\n    'hoodie.datasource.hive_sync.mode': 'hms',\r\n    'hoodie.datasource.hive_sync.ignore_exceptions': True\r\n}\r\n```\r\n\r\nwrite the dataframe with the same way\r\n\r\n```\r\ndf \\\r\n    .write \\\r\n    .format(\"hudi\") \\\r\n    .options(**hudi_options) \\\r\n    .mode(\"append\") \\\r\n    .save()\r\n```\r\n\r\nget the same error\r\n\r\n```\r\nPy4JJavaError: An error occurred while calling o249.save.\r\n: org.apache.hudi.exception.HoodieException: Got runtime exception when hive syncing Customer_Sample_Hudi_001\r\n\tat org.apache.hudi.hive.HiveSyncTool.syncHoodieTable(HiveSyncTool.java:118)\r\n\tat org.apache.hudi.HoodieSparkSqlWriter$.syncHive(HoodieSparkSqlWriter.scala:539)\r\n\tat org.apache.hudi.HoodieSparkSqlWriter$.$anonfun$metaSync$2(HoodieSparkSqlWriter.scala:595)\r\n\tat org.apache.hudi.HoodieSparkSqlWriter$.$anonfun$metaSync$2$adapted(HoodieSparkSqlWriter.scala:591)\r\n\tat scala.collection.mutable.HashSet.foreach(HashSet.scala:77)\r\n\tat org.apache.hudi.HoodieSparkSqlWriter$.metaSync(HoodieSparkSqlWriter.scala:591)\r\n\tat org.apache.hudi.HoodieSparkSqlWriter$.commitAndPerformPostOperations(HoodieSparkSqlWriter.scala:665)\r\n\tat org.apache.hudi.HoodieSparkSqlWriter$.write(HoodieSparkSqlWriter.scala:286)\r\n\tat org.apache.hudi.DefaultSource.createRelation(DefaultSource.scala:164)\r\n\tat org.apache.spark.sql.execution.datasources.SaveIntoDataSourceCommand.run(SaveIntoDataSourceCommand.scala:46)\r\n\tat org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult$lzycompute(commands.scala:70)\r\n\tat org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult(commands.scala:68)\r\n\tat org.apache.spark.sql.execution.command.ExecutedCommandExec.doExecute(commands.scala:90)\r\n\tat org.apache.spark.sql.execution.SparkPlan.$anonfun$execute$1(SparkPlan.scala:185)\r\n\tat org.apache.spark.sql.execution.SparkPlan.$anonfun$executeQuery$1(SparkPlan.scala:223)\r\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\r\n\tat org.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:220)\r\n\tat org.apache.spark.sql.execution.SparkPlan.execute(SparkPlan.scala:181)\r\n\tat org.apache.spark.sql.execution.QueryExecution.toRdd$lzycompute(QueryExecution.scala:134)\r\n\tat org.apache.spark.sql.execution.QueryExecution.toRdd(QueryExecution.scala:133)\r\n\tat org.apache.spark.sql.DataFrameWriter.$anonfun$runCommand$1(DataFrameWriter.scala:989)\r\n\tat org.apache.spark.sql.catalyst.QueryPlanningTracker$.withTracker(QueryPlanningTracker.scala:107)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.withTracker(SQLExecution.scala:232)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.executeQuery$1(SQLExecution.scala:110)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:135)\r\n\tat org.apache.spark.sql.catalyst.QueryPlanningTracker$.withTracker(QueryPlanningTracker.scala:107)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.withTracker(SQLExecution.scala:232)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$5(SQLExecution.scala:135)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:253)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:134)\r\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:772)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:68)\r\n\tat org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:989)\r\n\tat org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:438)\r\n\tat org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:415)\r\n\tat org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:301)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.lang.reflect.Method.invoke(Method.java:498)\r\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\r\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\r\n\tat py4j.Gateway.invoke(Gateway.java:282)\r\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\r\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\r\n\tat py4j.GatewayConnection.run(GatewayConnection.java:238)\r\n\tat java.lang.Thread.run(Thread.java:750)\r\nCaused by: org.apache.hudi.hive.HoodieHiveSyncException: Failed to sync partitions for table Customer_Sample_Hudi_001\r\n\tat org.apache.hudi.hive.HiveSyncTool.syncPartitions(HiveSyncTool.java:363)\r\n\tat org.apache.hudi.hive.HiveSyncTool.syncHoodieTable(HiveSyncTool.java:197)\r\n\tat org.apache.hudi.hive.HiveSyncTool.doSync(HiveSyncTool.java:129)\r\n\tat org.apache.hudi.hive.HiveSyncTool.syncHoodieTable(HiveSyncTool.java:115)\r\n\t... 46 more\r\nCaused by: java.lang.IllegalArgumentException: Partitions must be in the same table\r\n\tat com.google.common.base.Preconditions.checkArgument(Preconditions.java:92)\r\n\tat com.amazonaws.glue.catalog.metastore.GlueMetastoreClientDelegate.validateInputForBatchCreatePartitions(GlueMetastoreClientDelegate.java:800)\r\n\tat com.amazonaws.glue.catalog.metastore.GlueMetastoreClientDelegate.batchCreatePartitions(GlueMetastoreClientDelegate.java:736)\r\n\tat com.amazonaws.glue.catalog.metastore.GlueMetastoreClientDelegate.addPartitions(GlueMetastoreClientDelegate.java:718)\r\n\tat com.amazonaws.glue.catalog.metastore.AWSCatalogMetastoreClient.add_partitions(AWSCatalogMetastoreClient.java:339)\r\n\tat org.apache.hudi.hive.ddl.HMSDDLExecutor.addPartitionsToTable(HMSDDLExecutor.java:198)\r\n\tat org.apache.hudi.hive.HoodieHiveClient.addPartitionsToTable(HoodieHiveClient.java:115)\r\n\tat org.apache.hudi.hive.HiveSyncTool.syncPartitions(HiveSyncTool.java:346)\r\n\t... 49 more\r\n```\r\n\r\none weird thing is that the table was created as this time\r\n\r\n<img width=\"220\" alt=\"image\" src=\"https://user-images.githubusercontent.com/18332044/193223994-cc8daa21-00ce-4051-819e-18f302330475.png\">\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263257319/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263311923","html_url":"https://github.com/apache/hudi/issues/6808#issuecomment-1263311923","issue_url":"https://api.github.com/repos/apache/hudi/issues/6808","id":1263311923,"node_id":"IC_kwDOBI7nWM5LTJwz","user":{"login":"codope","id":16440354,"node_id":"MDQ6VXNlcjE2NDQwMzU0","avatar_url":"https://avatars.githubusercontent.com/u/16440354?v=4","gravatar_id":"","url":"https://api.github.com/users/codope","html_url":"https://github.com/codope","followers_url":"https://api.github.com/users/codope/followers","following_url":"https://api.github.com/users/codope/following{/other_user}","gists_url":"https://api.github.com/users/codope/gists{/gist_id}","starred_url":"https://api.github.com/users/codope/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codope/subscriptions","organizations_url":"https://api.github.com/users/codope/orgs","repos_url":"https://api.github.com/users/codope/repos","events_url":"https://api.github.com/users/codope/events{/privacy}","received_events_url":"https://api.github.com/users/codope/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T09:06:04Z","updated_at":"2022-09-30T09:06:04Z","author_association":"MEMBER","body":"Could be related to Hive itself. Can you add this to your script and see if metastore configs are passed correctly?\r\n`spark.sql(\"set\").filter(\"key rlike 'metastore|jdo'\").show(1000,False)`\r\n\r\nI see that you have already turned off the schema as well as its version verification. That should have taken effect.\r\n\r\nAlso, you need to set the derby jdbc driver.\r\n```\r\n\"spark.hadoop.javax.jdo.option.ConnectionDriverName\" = \"org.apache.derby.jdbc.EmbeddedDriver\",\r\n\"spark.hadoop.javax.jdo.option.ConnectionURL\" = \"jdbc:derby:memory:myInMemDB;create=true\"\r\n```\r\nIf it does not help, can you run sync with `jdbc` mode. Just set following configs:\r\n```\r\n\"hoodie.datasource.hive_sync.use_jdbc\": \"true\"\r\n\"hoodie.datasource.hive_sync.mode\": \"jdbc\"\r\n```","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263311923/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263316829","html_url":"https://github.com/apache/hudi/pull/6705#issuecomment-1263316829","issue_url":"https://api.github.com/repos/apache/hudi/issues/6705","id":1263316829,"node_id":"IC_kwDOBI7nWM5LTK9d","user":{"login":"watermelon12138","id":49849410,"node_id":"MDQ6VXNlcjQ5ODQ5NDEw","avatar_url":"https://avatars.githubusercontent.com/u/49849410?v=4","gravatar_id":"","url":"https://api.github.com/users/watermelon12138","html_url":"https://github.com/watermelon12138","followers_url":"https://api.github.com/users/watermelon12138/followers","following_url":"https://api.github.com/users/watermelon12138/following{/other_user}","gists_url":"https://api.github.com/users/watermelon12138/gists{/gist_id}","starred_url":"https://api.github.com/users/watermelon12138/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/watermelon12138/subscriptions","organizations_url":"https://api.github.com/users/watermelon12138/orgs","repos_url":"https://api.github.com/users/watermelon12138/repos","events_url":"https://api.github.com/users/watermelon12138/events{/privacy}","received_events_url":"https://api.github.com/users/watermelon12138/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T09:10:39Z","updated_at":"2022-09-30T09:10:39Z","author_association":"CONTRIBUTOR","body":"@nsivabalan \r\nI have modified it according to the review comments and hope you can review again, thanks","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263316829/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263328854","html_url":"https://github.com/apache/hudi/issues/6611#issuecomment-1263328854","issue_url":"https://api.github.com/repos/apache/hudi/issues/6611","id":1263328854,"node_id":"IC_kwDOBI7nWM5LTN5W","user":{"login":"codope","id":16440354,"node_id":"MDQ6VXNlcjE2NDQwMzU0","avatar_url":"https://avatars.githubusercontent.com/u/16440354?v=4","gravatar_id":"","url":"https://api.github.com/users/codope","html_url":"https://github.com/codope","followers_url":"https://api.github.com/users/codope/followers","following_url":"https://api.github.com/users/codope/following{/other_user}","gists_url":"https://api.github.com/users/codope/gists{/gist_id}","starred_url":"https://api.github.com/users/codope/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codope/subscriptions","organizations_url":"https://api.github.com/users/codope/orgs","repos_url":"https://api.github.com/users/codope/repos","events_url":"https://api.github.com/users/codope/events{/privacy}","received_events_url":"https://api.github.com/users/codope/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T09:22:27Z","updated_at":"2022-09-30T10:54:25Z","author_association":"MEMBER","body":"Looks like the user-specified schema provider is already being honored. I also added a unit test with evolving schema in #6817. In this case, schema registry is the schema provider and we see that the type of column `ten` is not a union. Ideally, it should have been \r\n```\r\n{\\\"name\\\":\\\"ten\\\",\\\"type\\\":[{\\\"type\\\":\\\"string\\\",\\\"connect.default\\\":\\\"ten_10\\\"},\\\"null\\\"],\\\"default\\\":\\\"ten_10\\\"}\r\n```\r\nBut it is\r\n```\r\n{\\\"name\\\":\\\"ten\\\",\\\"type\\\":{\\\"type\\\":\\\"string\\\",\\\"connect.default\\\":\\\"ten_10\\\"},\\\"default\\\":\\\"ten_10\\\"}\r\n```","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263328854/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263336548","html_url":"https://github.com/apache/hudi/pull/6703#issuecomment-1263336548","issue_url":"https://api.github.com/repos/apache/hudi/issues/6703","id":1263336548,"node_id":"IC_kwDOBI7nWM5LTPxk","user":{"login":"watermelon12138","id":49849410,"node_id":"MDQ6VXNlcjQ5ODQ5NDEw","avatar_url":"https://avatars.githubusercontent.com/u/49849410?v=4","gravatar_id":"","url":"https://api.github.com/users/watermelon12138","html_url":"https://github.com/watermelon12138","followers_url":"https://api.github.com/users/watermelon12138/followers","following_url":"https://api.github.com/users/watermelon12138/following{/other_user}","gists_url":"https://api.github.com/users/watermelon12138/gists{/gist_id}","starred_url":"https://api.github.com/users/watermelon12138/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/watermelon12138/subscriptions","organizations_url":"https://api.github.com/users/watermelon12138/orgs","repos_url":"https://api.github.com/users/watermelon12138/repos","events_url":"https://api.github.com/users/watermelon12138/events{/privacy}","received_events_url":"https://api.github.com/users/watermelon12138/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T09:29:41Z","updated_at":"2022-09-30T09:29:41Z","author_association":"CONTRIBUTOR","body":"@nsivabalan \r\nThank you for your reply. SP_C4 will retain the state formed from C1 to C4. Why is C1->C3 still can be archived? Archiving C1->C3 may affect clean.\r\nFor the MOR table, at hudi 0.11, I tested that it could not delete the savepoint, which would result in the mor table never being archived.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263336548/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263352404","html_url":"https://github.com/apache/hudi/issues/6332#issuecomment-1263352404","issue_url":"https://api.github.com/repos/apache/hudi/issues/6332","id":1263352404,"node_id":"IC_kwDOBI7nWM5LTTpU","user":{"login":"pratyakshsharma","id":30863489,"node_id":"MDQ6VXNlcjMwODYzNDg5","avatar_url":"https://avatars.githubusercontent.com/u/30863489?v=4","gravatar_id":"","url":"https://api.github.com/users/pratyakshsharma","html_url":"https://github.com/pratyakshsharma","followers_url":"https://api.github.com/users/pratyakshsharma/followers","following_url":"https://api.github.com/users/pratyakshsharma/following{/other_user}","gists_url":"https://api.github.com/users/pratyakshsharma/gists{/gist_id}","starred_url":"https://api.github.com/users/pratyakshsharma/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pratyakshsharma/subscriptions","organizations_url":"https://api.github.com/users/pratyakshsharma/orgs","repos_url":"https://api.github.com/users/pratyakshsharma/repos","events_url":"https://api.github.com/users/pratyakshsharma/events{/privacy}","received_events_url":"https://api.github.com/users/pratyakshsharma/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T09:46:00Z","updated_at":"2022-09-30T09:46:00Z","author_association":"CONTRIBUTOR","body":"@codope Let us connect sometime next week to discuss this. This has been pending for some time.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263352404/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263369412","html_url":"https://github.com/apache/hudi/pull/6837#issuecomment-1263369412","issue_url":"https://api.github.com/repos/apache/hudi/issues/6837","id":1263369412,"node_id":"IC_kwDOBI7nWM5LTXzE","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T10:03:08Z","updated_at":"2022-09-30T10:03:08Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"4f600909e91b537c1e34ff36d2b298b359bac68e\",\n    \"status\" : \"PENDING\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11928\",\n    \"triggerID\" : \"4f600909e91b537c1e34ff36d2b298b359bac68e\",\n    \"triggerType\" : \"PUSH\"\n  } ]\n}-->\n## CI report:\n\n* 4f600909e91b537c1e34ff36d2b298b359bac68e Azure: [PENDING](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11928) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263369412/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263378611","html_url":"https://github.com/apache/hudi/issues/5582#issuecomment-1263378611","issue_url":"https://api.github.com/repos/apache/hudi/issues/5582","id":1263378611,"node_id":"IC_kwDOBI7nWM5LTaCz","user":{"login":"codope","id":16440354,"node_id":"MDQ6VXNlcjE2NDQwMzU0","avatar_url":"https://avatars.githubusercontent.com/u/16440354?v=4","gravatar_id":"","url":"https://api.github.com/users/codope","html_url":"https://github.com/codope","followers_url":"https://api.github.com/users/codope/followers","following_url":"https://api.github.com/users/codope/following{/other_user}","gists_url":"https://api.github.com/users/codope/gists{/gist_id}","starred_url":"https://api.github.com/users/codope/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codope/subscriptions","organizations_url":"https://api.github.com/users/codope/orgs","repos_url":"https://api.github.com/users/codope/repos","events_url":"https://api.github.com/users/codope/events{/privacy}","received_events_url":"https://api.github.com/users/codope/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T10:11:14Z","updated_at":"2022-09-30T10:11:14Z","author_association":"MEMBER","body":"I could not reproduce with the latest master. Sharing the spark-sql and spark-shell scripts in this gist: https://gist.github.com/codope/f9e89093b98e58ad097820a35376caed","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263378611/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263385706","html_url":"https://github.com/apache/hudi/issues/5242#issuecomment-1263385706","issue_url":"https://api.github.com/repos/apache/hudi/issues/5242","id":1263385706,"node_id":"IC_kwDOBI7nWM5LTbxq","user":{"login":"codope","id":16440354,"node_id":"MDQ6VXNlcjE2NDQwMzU0","avatar_url":"https://avatars.githubusercontent.com/u/16440354?v=4","gravatar_id":"","url":"https://api.github.com/users/codope","html_url":"https://github.com/codope","followers_url":"https://api.github.com/users/codope/followers","following_url":"https://api.github.com/users/codope/following{/other_user}","gists_url":"https://api.github.com/users/codope/gists{/gist_id}","starred_url":"https://api.github.com/users/codope/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codope/subscriptions","organizations_url":"https://api.github.com/users/codope/orgs","repos_url":"https://api.github.com/users/codope/repos","events_url":"https://api.github.com/users/codope/events{/privacy}","received_events_url":"https://api.github.com/users/codope/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T10:17:34Z","updated_at":"2022-09-30T10:17:34Z","author_association":"MEMBER","body":"Closing as it cannot be reproduced with the latest master.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263385706/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263388078","html_url":"https://github.com/apache/hudi/issues/6503#issuecomment-1263388078","issue_url":"https://api.github.com/repos/apache/hudi/issues/6503","id":1263388078,"node_id":"IC_kwDOBI7nWM5LTcWu","user":{"login":"codope","id":16440354,"node_id":"MDQ6VXNlcjE2NDQwMzU0","avatar_url":"https://avatars.githubusercontent.com/u/16440354?v=4","gravatar_id":"","url":"https://api.github.com/users/codope","html_url":"https://github.com/codope","followers_url":"https://api.github.com/users/codope/followers","following_url":"https://api.github.com/users/codope/following{/other_user}","gists_url":"https://api.github.com/users/codope/gists{/gist_id}","starred_url":"https://api.github.com/users/codope/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codope/subscriptions","organizations_url":"https://api.github.com/users/codope/orgs","repos_url":"https://api.github.com/users/codope/repos","events_url":"https://api.github.com/users/codope/events{/privacy}","received_events_url":"https://api.github.com/users/codope/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T10:19:39Z","updated_at":"2022-09-30T10:19:39Z","author_association":"MEMBER","body":"@maduraitech gentle ping to provide sql scripts to reproduce.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263388078/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263392242","html_url":"https://github.com/apache/hudi/issues/6249#issuecomment-1263392242","issue_url":"https://api.github.com/repos/apache/hudi/issues/6249","id":1263392242,"node_id":"IC_kwDOBI7nWM5LTdXy","user":{"login":"codope","id":16440354,"node_id":"MDQ6VXNlcjE2NDQwMzU0","avatar_url":"https://avatars.githubusercontent.com/u/16440354?v=4","gravatar_id":"","url":"https://api.github.com/users/codope","html_url":"https://github.com/codope","followers_url":"https://api.github.com/users/codope/followers","following_url":"https://api.github.com/users/codope/following{/other_user}","gists_url":"https://api.github.com/users/codope/gists{/gist_id}","starred_url":"https://api.github.com/users/codope/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codope/subscriptions","organizations_url":"https://api.github.com/users/codope/orgs","repos_url":"https://api.github.com/users/codope/repos","events_url":"https://api.github.com/users/codope/events{/privacy}","received_events_url":"https://api.github.com/users/codope/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T10:23:33Z","updated_at":"2022-09-30T10:23:33Z","author_association":"MEMBER","body":"@soma1712 I have been running a deltastreamer MOR table job for over 30+ commits with sql transformer (though my setup is a bit different, I'm not using DMS). So far it's going well. No issues. We have had long-running deltastreamer tests in our test infra. Could you try with the latest Hudi?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263392242/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263393264","html_url":"https://github.com/apache/hudi/issues/6281#issuecomment-1263393264","issue_url":"https://api.github.com/repos/apache/hudi/issues/6281","id":1263393264,"node_id":"IC_kwDOBI7nWM5LTdnw","user":{"login":"codope","id":16440354,"node_id":"MDQ6VXNlcjE2NDQwMzU0","avatar_url":"https://avatars.githubusercontent.com/u/16440354?v=4","gravatar_id":"","url":"https://api.github.com/users/codope","html_url":"https://github.com/codope","followers_url":"https://api.github.com/users/codope/followers","following_url":"https://api.github.com/users/codope/following{/other_user}","gists_url":"https://api.github.com/users/codope/gists{/gist_id}","starred_url":"https://api.github.com/users/codope/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codope/subscriptions","organizations_url":"https://api.github.com/users/codope/orgs","repos_url":"https://api.github.com/users/codope/repos","events_url":"https://api.github.com/users/codope/events{/privacy}","received_events_url":"https://api.github.com/users/codope/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T10:24:29Z","updated_at":"2022-09-30T10:24:29Z","author_association":"MEMBER","body":"@crutis gentle ping to try out the master branch.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263393264/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263393615","html_url":"https://github.com/apache/hudi/issues/6504#issuecomment-1263393615","issue_url":"https://api.github.com/repos/apache/hudi/issues/6504","id":1263393615,"node_id":"IC_kwDOBI7nWM5LTdtP","user":{"login":"codope","id":16440354,"node_id":"MDQ6VXNlcjE2NDQwMzU0","avatar_url":"https://avatars.githubusercontent.com/u/16440354?v=4","gravatar_id":"","url":"https://api.github.com/users/codope","html_url":"https://github.com/codope","followers_url":"https://api.github.com/users/codope/followers","following_url":"https://api.github.com/users/codope/following{/other_user}","gists_url":"https://api.github.com/users/codope/gists{/gist_id}","starred_url":"https://api.github.com/users/codope/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codope/subscriptions","organizations_url":"https://api.github.com/users/codope/orgs","repos_url":"https://api.github.com/users/codope/repos","events_url":"https://api.github.com/users/codope/events{/privacy}","received_events_url":"https://api.github.com/users/codope/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T10:24:49Z","updated_at":"2022-09-30T10:24:49Z","author_association":"MEMBER","body":"Closing due to inactivity.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263393615/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263395871","html_url":"https://github.com/apache/hudi/issues/6798#issuecomment-1263395871","issue_url":"https://api.github.com/repos/apache/hudi/issues/6798","id":1263395871,"node_id":"IC_kwDOBI7nWM5LTeQf","user":{"login":"codope","id":16440354,"node_id":"MDQ6VXNlcjE2NDQwMzU0","avatar_url":"https://avatars.githubusercontent.com/u/16440354?v=4","gravatar_id":"","url":"https://api.github.com/users/codope","html_url":"https://github.com/codope","followers_url":"https://api.github.com/users/codope/followers","following_url":"https://api.github.com/users/codope/following{/other_user}","gists_url":"https://api.github.com/users/codope/gists{/gist_id}","starred_url":"https://api.github.com/users/codope/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codope/subscriptions","organizations_url":"https://api.github.com/users/codope/orgs","repos_url":"https://api.github.com/users/codope/repos","events_url":"https://api.github.com/users/codope/events{/privacy}","received_events_url":"https://api.github.com/users/codope/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T10:26:49Z","updated_at":"2022-09-30T10:26:49Z","author_association":"MEMBER","body":"Closing it as the issue has already been triaged and the fix is being worked upon.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263395871/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263410673","html_url":"https://github.com/apache/hudi/issues/6421#issuecomment-1263410673","issue_url":"https://api.github.com/repos/apache/hudi/issues/6421","id":1263410673,"node_id":"IC_kwDOBI7nWM5LTh3x","user":{"login":"codope","id":16440354,"node_id":"MDQ6VXNlcjE2NDQwMzU0","avatar_url":"https://avatars.githubusercontent.com/u/16440354?v=4","gravatar_id":"","url":"https://api.github.com/users/codope","html_url":"https://github.com/codope","followers_url":"https://api.github.com/users/codope/followers","following_url":"https://api.github.com/users/codope/following{/other_user}","gists_url":"https://api.github.com/users/codope/gists{/gist_id}","starred_url":"https://api.github.com/users/codope/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codope/subscriptions","organizations_url":"https://api.github.com/users/codope/orgs","repos_url":"https://api.github.com/users/codope/repos","events_url":"https://api.github.com/users/codope/events{/privacy}","received_events_url":"https://api.github.com/users/codope/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T10:40:37Z","updated_at":"2022-09-30T10:40:37Z","author_association":"MEMBER","body":"I could not repro and there is a unit test as well which covers this scenario: `TestCOWDataSource#testCopyOnWriteWithDroppedPartitionColumns`.\r\nClosing it due to inactivity and as it is not reproducible with the latest version.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263410673/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263411546","html_url":"https://github.com/apache/hudi/issues/6621#issuecomment-1263411546","issue_url":"https://api.github.com/repos/apache/hudi/issues/6621","id":1263411546,"node_id":"IC_kwDOBI7nWM5LTiFa","user":{"login":"codope","id":16440354,"node_id":"MDQ6VXNlcjE2NDQwMzU0","avatar_url":"https://avatars.githubusercontent.com/u/16440354?v=4","gravatar_id":"","url":"https://api.github.com/users/codope","html_url":"https://github.com/codope","followers_url":"https://api.github.com/users/codope/followers","following_url":"https://api.github.com/users/codope/following{/other_user}","gists_url":"https://api.github.com/users/codope/gists{/gist_id}","starred_url":"https://api.github.com/users/codope/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codope/subscriptions","organizations_url":"https://api.github.com/users/codope/orgs","repos_url":"https://api.github.com/users/codope/repos","events_url":"https://api.github.com/users/codope/events{/privacy}","received_events_url":"https://api.github.com/users/codope/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T10:41:25Z","updated_at":"2022-09-30T10:41:25Z","author_association":"MEMBER","body":"@dik111 did you get a chance to try out this suggestion https://github.com/apache/hudi/issues/6621#issuecomment-1241538207 ?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263411546/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263414847","html_url":"https://github.com/apache/hudi/pull/5958#issuecomment-1263414847","issue_url":"https://api.github.com/repos/apache/hudi/issues/5958","id":1263414847,"node_id":"IC_kwDOBI7nWM5LTi4_","user":{"login":"suryaprasanna","id":20996567,"node_id":"MDQ6VXNlcjIwOTk2NTY3","avatar_url":"https://avatars.githubusercontent.com/u/20996567?v=4","gravatar_id":"","url":"https://api.github.com/users/suryaprasanna","html_url":"https://github.com/suryaprasanna","followers_url":"https://api.github.com/users/suryaprasanna/followers","following_url":"https://api.github.com/users/suryaprasanna/following{/other_user}","gists_url":"https://api.github.com/users/suryaprasanna/gists{/gist_id}","starred_url":"https://api.github.com/users/suryaprasanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/suryaprasanna/subscriptions","organizations_url":"https://api.github.com/users/suryaprasanna/orgs","repos_url":"https://api.github.com/users/suryaprasanna/repos","events_url":"https://api.github.com/users/suryaprasanna/events{/privacy}","received_events_url":"https://api.github.com/users/suryaprasanna/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T10:44:41Z","updated_at":"2022-09-30T10:44:41Z","author_association":"CONTRIBUTOR","body":"@prasannarajaperumal and @nsivabalan thanks a lot for reviewing the diff. I have addressed all the comments.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263414847/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263423889","html_url":"https://github.com/apache/hudi/issues/6686#issuecomment-1263423889","issue_url":"https://api.github.com/repos/apache/hudi/issues/6686","id":1263423889,"node_id":"IC_kwDOBI7nWM5LTlGR","user":{"login":"codope","id":16440354,"node_id":"MDQ6VXNlcjE2NDQwMzU0","avatar_url":"https://avatars.githubusercontent.com/u/16440354?v=4","gravatar_id":"","url":"https://api.github.com/users/codope","html_url":"https://github.com/codope","followers_url":"https://api.github.com/users/codope/followers","following_url":"https://api.github.com/users/codope/following{/other_user}","gists_url":"https://api.github.com/users/codope/gists{/gist_id}","starred_url":"https://api.github.com/users/codope/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codope/subscriptions","organizations_url":"https://api.github.com/users/codope/orgs","repos_url":"https://api.github.com/users/codope/repos","events_url":"https://api.github.com/users/codope/events{/privacy}","received_events_url":"https://api.github.com/users/codope/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T10:53:37Z","updated_at":"2022-09-30T10:53:37Z","author_association":"MEMBER","body":"Disabling should resolve the issue. In later Hudi versions, this is disabled by default. See https://github.com/apache/hudi/issues/2983\r\nPlease reopen if you still face this issue after disabling consistency check.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263423889/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263425320","html_url":"https://github.com/apache/hudi/issues/6460#issuecomment-1263425320","issue_url":"https://api.github.com/repos/apache/hudi/issues/6460","id":1263425320,"node_id":"IC_kwDOBI7nWM5LTlco","user":{"login":"codope","id":16440354,"node_id":"MDQ6VXNlcjE2NDQwMzU0","avatar_url":"https://avatars.githubusercontent.com/u/16440354?v=4","gravatar_id":"","url":"https://api.github.com/users/codope","html_url":"https://github.com/codope","followers_url":"https://api.github.com/users/codope/followers","following_url":"https://api.github.com/users/codope/following{/other_user}","gists_url":"https://api.github.com/users/codope/gists{/gist_id}","starred_url":"https://api.github.com/users/codope/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codope/subscriptions","organizations_url":"https://api.github.com/users/codope/orgs","repos_url":"https://api.github.com/users/codope/repos","events_url":"https://api.github.com/users/codope/events{/privacy}","received_events_url":"https://api.github.com/users/codope/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T10:55:05Z","updated_at":"2022-09-30T10:55:05Z","author_association":"MEMBER","body":"@danny0405 @yuzhaojing Could you please help with this issue?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263425320/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263425828","html_url":"https://github.com/apache/hudi/issues/6469#issuecomment-1263425828","issue_url":"https://api.github.com/repos/apache/hudi/issues/6469","id":1263425828,"node_id":"IC_kwDOBI7nWM5LTlkk","user":{"login":"codope","id":16440354,"node_id":"MDQ6VXNlcjE2NDQwMzU0","avatar_url":"https://avatars.githubusercontent.com/u/16440354?v=4","gravatar_id":"","url":"https://api.github.com/users/codope","html_url":"https://github.com/codope","followers_url":"https://api.github.com/users/codope/followers","following_url":"https://api.github.com/users/codope/following{/other_user}","gists_url":"https://api.github.com/users/codope/gists{/gist_id}","starred_url":"https://api.github.com/users/codope/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codope/subscriptions","organizations_url":"https://api.github.com/users/codope/orgs","repos_url":"https://api.github.com/users/codope/repos","events_url":"https://api.github.com/users/codope/events{/privacy}","received_events_url":"https://api.github.com/users/codope/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T10:55:35Z","updated_at":"2022-09-30T10:55:35Z","author_association":"MEMBER","body":"@sangeethsasidharan gentle ping^","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263425828/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263428666","html_url":"https://github.com/apache/hudi/issues/6496#issuecomment-1263428666","issue_url":"https://api.github.com/repos/apache/hudi/issues/6496","id":1263428666,"node_id":"IC_kwDOBI7nWM5LTmQ6","user":{"login":"codope","id":16440354,"node_id":"MDQ6VXNlcjE2NDQwMzU0","avatar_url":"https://avatars.githubusercontent.com/u/16440354?v=4","gravatar_id":"","url":"https://api.github.com/users/codope","html_url":"https://github.com/codope","followers_url":"https://api.github.com/users/codope/followers","following_url":"https://api.github.com/users/codope/following{/other_user}","gists_url":"https://api.github.com/users/codope/gists{/gist_id}","starred_url":"https://api.github.com/users/codope/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codope/subscriptions","organizations_url":"https://api.github.com/users/codope/orgs","repos_url":"https://api.github.com/users/codope/repos","events_url":"https://api.github.com/users/codope/events{/privacy}","received_events_url":"https://api.github.com/users/codope/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T10:58:51Z","updated_at":"2022-09-30T10:58:51Z","author_association":"MEMBER","body":"Closing as the issue has been triaged and we have a patch as suggested in https://github.com/apache/hudi/issues/6496#issuecomment-1228023484","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263428666/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263429401","html_url":"https://github.com/apache/hudi/issues/6527#issuecomment-1263429401","issue_url":"https://api.github.com/repos/apache/hudi/issues/6527","id":1263429401,"node_id":"IC_kwDOBI7nWM5LTmcZ","user":{"login":"codope","id":16440354,"node_id":"MDQ6VXNlcjE2NDQwMzU0","avatar_url":"https://avatars.githubusercontent.com/u/16440354?v=4","gravatar_id":"","url":"https://api.github.com/users/codope","html_url":"https://github.com/codope","followers_url":"https://api.github.com/users/codope/followers","following_url":"https://api.github.com/users/codope/following{/other_user}","gists_url":"https://api.github.com/users/codope/gists{/gist_id}","starred_url":"https://api.github.com/users/codope/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codope/subscriptions","organizations_url":"https://api.github.com/users/codope/orgs","repos_url":"https://api.github.com/users/codope/repos","events_url":"https://api.github.com/users/codope/events{/privacy}","received_events_url":"https://api.github.com/users/codope/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T10:59:49Z","updated_at":"2022-09-30T10:59:49Z","author_association":"MEMBER","body":"Closing it as we have a fix under review.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263429401/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263429828","html_url":"https://github.com/apache/hudi/issues/6483#issuecomment-1263429828","issue_url":"https://api.github.com/repos/apache/hudi/issues/6483","id":1263429828,"node_id":"IC_kwDOBI7nWM5LTmjE","user":{"login":"codope","id":16440354,"node_id":"MDQ6VXNlcjE2NDQwMzU0","avatar_url":"https://avatars.githubusercontent.com/u/16440354?v=4","gravatar_id":"","url":"https://api.github.com/users/codope","html_url":"https://github.com/codope","followers_url":"https://api.github.com/users/codope/followers","following_url":"https://api.github.com/users/codope/following{/other_user}","gists_url":"https://api.github.com/users/codope/gists{/gist_id}","starred_url":"https://api.github.com/users/codope/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codope/subscriptions","organizations_url":"https://api.github.com/users/codope/orgs","repos_url":"https://api.github.com/users/codope/repos","events_url":"https://api.github.com/users/codope/events{/privacy}","received_events_url":"https://api.github.com/users/codope/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T11:00:21Z","updated_at":"2022-09-30T11:00:21Z","author_association":"MEMBER","body":"Issue resolved with hms mode.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263429828/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263436625","html_url":"https://github.com/apache/hudi/pull/6636#issuecomment-1263436625","issue_url":"https://api.github.com/repos/apache/hudi/issues/6636","id":1263436625,"node_id":"IC_kwDOBI7nWM5LToNR","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T11:07:57Z","updated_at":"2022-09-30T11:07:57Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"b837b813fb706508b1fccc0924f839275e9373c3\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11253\",\n    \"triggerID\" : \"b837b813fb706508b1fccc0924f839275e9373c3\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"2b7e99f0e851f61b92f027928f208180c533c653\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11273\",\n    \"triggerID\" : \"2b7e99f0e851f61b92f027928f208180c533c653\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"b999bb8532df8c5cdf236b3fc891eaf9b90a8487\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11317\",\n    \"triggerID\" : \"b999bb8532df8c5cdf236b3fc891eaf9b90a8487\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"985e9736cadeeda86a96d5641ec6fd01afdee194\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11326\",\n    \"triggerID\" : \"985e9736cadeeda86a96d5641ec6fd01afdee194\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"adfccbc445f31f6e109dfced1fb47beccc6c7dae\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11329\",\n    \"triggerID\" : \"adfccbc445f31f6e109dfced1fb47beccc6c7dae\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"47864db3234b5dd7115006db07019481c91d65f8\",\n    \"status\" : \"UNKNOWN\",\n    \"url\" : \"TBD\",\n    \"triggerID\" : \"47864db3234b5dd7115006db07019481c91d65f8\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"1ef2c6f59d7ce1616b4cf36494373007e2ad9450\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11585\",\n    \"triggerID\" : \"1ef2c6f59d7ce1616b4cf36494373007e2ad9450\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"cdbc804bd8ecd88141ec461fd16716c66397c8db\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11612\",\n    \"triggerID\" : \"cdbc804bd8ecd88141ec461fd16716c66397c8db\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"2f75d8a39026d6d2039754eccb90b7b3ed0dcfee\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11608\",\n    \"triggerID\" : \"2f75d8a39026d6d2039754eccb90b7b3ed0dcfee\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"0dd96e8c8209bf3a6f3faced96c867d888974260\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11692\",\n    \"triggerID\" : \"0dd96e8c8209bf3a6f3faced96c867d888974260\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"1f939eeefe4435a9cb009c0648bcaffcaa990a1a\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11707\",\n    \"triggerID\" : \"1f939eeefe4435a9cb009c0648bcaffcaa990a1a\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"8530a43c8839ce9ca1c6891585d141eca7641304\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11711\",\n    \"triggerID\" : \"8530a43c8839ce9ca1c6891585d141eca7641304\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"57c510b4c10006da8a8d901a1f060b12491263d5\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11893\",\n    \"triggerID\" : \"57c510b4c10006da8a8d901a1f060b12491263d5\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"84076b27bdf11455c54a0d878089724e65e9daf9\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11904\",\n    \"triggerID\" : \"84076b27bdf11455c54a0d878089724e65e9daf9\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"5bcf55eb76b9e7abf7a18ffcedfe638f4d11c643\",\n    \"status\" : \"FAILURE\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11924\",\n    \"triggerID\" : \"5bcf55eb76b9e7abf7a18ffcedfe638f4d11c643\",\n    \"triggerType\" : \"PUSH\"\n  } ]\n}-->\n## CI report:\n\n* 47864db3234b5dd7115006db07019481c91d65f8 UNKNOWN\n* 5bcf55eb76b9e7abf7a18ffcedfe638f4d11c643 Azure: [FAILURE](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11924) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263436625/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263443677","html_url":"https://github.com/apache/hudi/issues/6304#issuecomment-1263443677","issue_url":"https://api.github.com/repos/apache/hudi/issues/6304","id":1263443677,"node_id":"IC_kwDOBI7nWM5LTp7d","user":{"login":"codope","id":16440354,"node_id":"MDQ6VXNlcjE2NDQwMzU0","avatar_url":"https://avatars.githubusercontent.com/u/16440354?v=4","gravatar_id":"","url":"https://api.github.com/users/codope","html_url":"https://github.com/codope","followers_url":"https://api.github.com/users/codope/followers","following_url":"https://api.github.com/users/codope/following{/other_user}","gists_url":"https://api.github.com/users/codope/gists{/gist_id}","starred_url":"https://api.github.com/users/codope/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codope/subscriptions","organizations_url":"https://api.github.com/users/codope/orgs","repos_url":"https://api.github.com/users/codope/repos","events_url":"https://api.github.com/users/codope/events{/privacy}","received_events_url":"https://api.github.com/users/codope/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T11:15:43Z","updated_at":"2022-09-30T11:15:43Z","author_association":"MEMBER","body":"@brskiran1 @SubashRanganathan gentle ping^","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263443677/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263547740","html_url":"https://github.com/apache/hudi/issues/6832#issuecomment-1263547740","issue_url":"https://api.github.com/repos/apache/hudi/issues/6832","id":1263547740,"node_id":"IC_kwDOBI7nWM5LUDVc","user":{"login":"codope","id":16440354,"node_id":"MDQ6VXNlcjE2NDQwMzU0","avatar_url":"https://avatars.githubusercontent.com/u/16440354?v=4","gravatar_id":"","url":"https://api.github.com/users/codope","html_url":"https://github.com/codope","followers_url":"https://api.github.com/users/codope/followers","following_url":"https://api.github.com/users/codope/following{/other_user}","gists_url":"https://api.github.com/users/codope/gists{/gist_id}","starred_url":"https://api.github.com/users/codope/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codope/subscriptions","organizations_url":"https://api.github.com/users/codope/orgs","repos_url":"https://api.github.com/users/codope/repos","events_url":"https://api.github.com/users/codope/events{/privacy}","received_events_url":"https://api.github.com/users/codope/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T13:02:21Z","updated_at":"2022-09-30T13:02:21Z","author_association":"MEMBER","body":"@dragonH I ran a simple hive sync which worked. So, the issue could be with Glue sync. Can you also raise this with AWS support? If possible do try with latest EMR versions which has Hudi 0.11.1.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263547740/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263789742","html_url":"https://github.com/apache/hudi/issues/6428#issuecomment-1263789742","issue_url":"https://api.github.com/repos/apache/hudi/issues/6428","id":1263789742,"node_id":"IC_kwDOBI7nWM5LU-au","user":{"login":"dyang108","id":14955423,"node_id":"MDQ6VXNlcjE0OTU1NDIz","avatar_url":"https://avatars.githubusercontent.com/u/14955423?v=4","gravatar_id":"","url":"https://api.github.com/users/dyang108","html_url":"https://github.com/dyang108","followers_url":"https://api.github.com/users/dyang108/followers","following_url":"https://api.github.com/users/dyang108/following{/other_user}","gists_url":"https://api.github.com/users/dyang108/gists{/gist_id}","starred_url":"https://api.github.com/users/dyang108/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dyang108/subscriptions","organizations_url":"https://api.github.com/users/dyang108/orgs","repos_url":"https://api.github.com/users/dyang108/repos","events_url":"https://api.github.com/users/dyang108/events{/privacy}","received_events_url":"https://api.github.com/users/dyang108/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T16:39:19Z","updated_at":"2022-09-30T16:39:19Z","author_association":"NONE","body":"I saw this issue with Spark on mesos (on EC2), not EMR Spark","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263789742/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263899556","html_url":"https://github.com/apache/hudi/pull/6839#issuecomment-1263899556","issue_url":"https://api.github.com/repos/apache/hudi/issues/6839","id":1263899556,"node_id":"IC_kwDOBI7nWM5LVZOk","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T18:41:18Z","updated_at":"2022-09-30T18:41:18Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"3ca8dff613c07825a9d02f43911bc97fc1bcbcd8\",\n    \"status\" : \"SUCCESS\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11936\",\n    \"triggerID\" : \"3ca8dff613c07825a9d02f43911bc97fc1bcbcd8\",\n    \"triggerType\" : \"PUSH\"\n  } ]\n}-->\n## CI report:\n\n* 3ca8dff613c07825a9d02f43911bc97fc1bcbcd8 Azure: [SUCCESS](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11936) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263899556/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263992365","html_url":"https://github.com/apache/hudi/issues/6321#issuecomment-1263992365","issue_url":"https://api.github.com/repos/apache/hudi/issues/6321","id":1263992365,"node_id":"IC_kwDOBI7nWM5LVv4t","user":{"login":"gtwuser","id":6791570,"node_id":"MDQ6VXNlcjY3OTE1NzA=","avatar_url":"https://avatars.githubusercontent.com/u/6791570?v=4","gravatar_id":"","url":"https://api.github.com/users/gtwuser","html_url":"https://github.com/gtwuser","followers_url":"https://api.github.com/users/gtwuser/followers","following_url":"https://api.github.com/users/gtwuser/following{/other_user}","gists_url":"https://api.github.com/users/gtwuser/gists{/gist_id}","starred_url":"https://api.github.com/users/gtwuser/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gtwuser/subscriptions","organizations_url":"https://api.github.com/users/gtwuser/orgs","repos_url":"https://api.github.com/users/gtwuser/repos","events_url":"https://api.github.com/users/gtwuser/events{/privacy}","received_events_url":"https://api.github.com/users/gtwuser/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T20:26:52Z","updated_at":"2022-09-30T20:26:52Z","author_association":"NONE","body":"Even after adding `hoodie.datasource.write.reconcile.schema=true` we are still getting issue in different tables. This time the error is `Caused by: org.apache.avro.SchemaParseException: Can't redefine: list`\r\nStack trace:\r\n```bash\r\n2022-09-30 20:08:29,172 ERROR [main] glue.ProcessLauncher (Logging.scala:logError(73)): Error from Python:Traceback (most recent call last):\r\n  File \"/tmp/second-delete-upsert.py\", line 265, in <module>\r\n    startMerging(df_prefix_map_list)\r\n  File \"/tmp/second-delete-upsert.py\", line 260, in startMerging\r\n    .mode('append') \\\r\n  File \"/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/readwriter.py\", line 1107, in save\r\n    self._jwrite.save()\r\n  File \"/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py\", line 1305, in __call__\r\n    answer, self.gateway_client, self.target_id, self.name)\r\n  File \"/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py\", line 111, in deco\r\n    return f(*a, **kw)\r\n  File \"/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/protocol.py\", line 328, in get_return_value\r\n    format(target_id, \".\", name), value)\r\npy4j.protocol.Py4JJavaError: An error occurred while calling o514.save.\r\n: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 275.0 failed 4 times, most recent failure: Lost task 0.3 in stage 275.0 (TID 1391) (172.34.1.80 executor 1): org.apache.hudi.exception.HoodieUpsertException: Error upserting bucketType UPDATE for partition :0\r\n\tat org.apache.hudi.table.action.commit.BaseSparkCommitActionExecutor.handleUpsertPartition(BaseSparkCommitActionExecutor.java:329)\r\n\tat org.apache.hudi.table.action.commit.BaseSparkCommitActionExecutor.lambda$mapPartitionsAsRDD$a3ab3c4$1(BaseSparkCommitActionExecutor.java:244)\r\n\tat org.apache.spark.api.java.JavaRDDLike.$anonfun$mapPartitionsWithIndex$1(JavaRDDLike.scala:102)\r\n\tat org.apache.spark.api.java.JavaRDDLike.$anonfun$mapPartitionsWithIndex$1$adapted(JavaRDDLike.scala:102)\r\n\tat org.apache.spark.rdd.RDD.$anonfun$mapPartitionsWithIndex$2(RDD.scala:915)\r\n\tat org.apache.spark.rdd.RDD.$anonfun$mapPartitionsWithIndex$2$adapted(RDD.scala:915)\r\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)\r\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:373)\r\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:337)\r\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)\r\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:373)\r\n\tat org.apache.spark.rdd.RDD.$anonfun$getOrCompute$1(RDD.scala:386)\r\n\tat org.apache.spark.storage.BlockManager.$anonfun$doPutIterator$1(BlockManager.scala:1440)\r\n\tat org.apache.spark.storage.BlockManager.org$apache$spark$storage$BlockManager$$doPut(BlockManager.scala:1350)\r\n\tat org.apache.spark.storage.BlockManager.doPutIterator(BlockManager.scala:1414)\r\n\tat org.apache.spark.storage.BlockManager.getOrElseUpdate(BlockManager.scala:1237)\r\n\tat org.apache.spark.rdd.RDD.getOrCompute(RDD.scala:384)\r\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:335)\r\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)\r\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:373)\r\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:337)\r\n\tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:90)\r\n\tat org.apache.spark.scheduler.Task.run(Task.scala:131)\r\n\tat org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$3(Executor.scala:497)\r\n\tat org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1439)\r\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:500)\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n\tat java.lang.Thread.run(Thread.java:750)\r\nCaused by: org.apache.hudi.exception.HoodieException: org.apache.hudi.exception.HoodieException: java.util.concurrent.ExecutionException: org.apache.hudi.exception.HoodieException: operation has failed\r\n\tat org.apache.hudi.table.action.commit.HoodieMergeHelper.runMerge(HoodieMergeHelper.java:149)\r\n\tat org.apache.hudi.table.action.commit.BaseSparkCommitActionExecutor.handleUpdateInternal(BaseSparkCommitActionExecutor.java:358)\r\n\tat org.apache.hudi.table.action.commit.BaseSparkCommitActionExecutor.handleUpdate(BaseSparkCommitActionExecutor.java:349)\r\n\tat org.apache.hudi.table.action.commit.BaseSparkCommitActionExecutor.handleUpsertPartition(BaseSparkCommitActionExecutor.java:322)\r\n\t... 28 more\r\nCaused by: org.apache.hudi.exception.HoodieException: java.util.concurrent.ExecutionException: org.apache.hudi.exception.HoodieException: operation has failed\r\n\tat org.apache.hudi.common.util.queue.BoundedInMemoryExecutor.execute(BoundedInMemoryExecutor.java:161)\r\n\tat org.apache.hudi.table.action.commit.HoodieMergeHelper.runMerge(HoodieMergeHelper.java:147)\r\n\t... 31 more\r\nCaused by: java.util.concurrent.ExecutionException: org.apache.hudi.exception.HoodieException: operation has failed\r\n\tat java.util.concurrent.FutureTask.report(FutureTask.java:122)\r\n\tat java.util.concurrent.FutureTask.get(FutureTask.java:192)\r\n\tat org.apache.hudi.common.util.queue.BoundedInMemoryExecutor.execute(BoundedInMemoryExecutor.java:155)\r\n\t... 32 more\r\nCaused by: org.apache.hudi.exception.HoodieException: operation has failed\r\n\tat org.apache.hudi.common.util.queue.BoundedInMemoryQueue.throwExceptionIfFailed(BoundedInMemoryQueue.java:248)\r\n\tat org.apache.hudi.common.util.queue.BoundedInMemoryQueue.readNextRecord(BoundedInMemoryQueue.java:226)\r\n\tat org.apache.hudi.common.util.queue.BoundedInMemoryQueue.access$100(BoundedInMemoryQueue.java:52)\r\n\tat org.apache.hudi.common.util.queue.BoundedInMemoryQueue$QueueIterator.hasNext(BoundedInMemoryQueue.java:278)\r\n\tat org.apache.hudi.common.util.queue.BoundedInMemoryQueueConsumer.consume(BoundedInMemoryQueueConsumer.java:36)\r\n\tat org.apache.hudi.common.util.queue.BoundedInMemoryExecutor.lambda$null$2(BoundedInMemoryExecutor.java:135)\r\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:266)\r\n\t... 3 more\r\nCaused by: org.apache.hudi.exception.HoodieException: unable to read next record from parquet file \r\n\tat org.apache.hudi.common.util.ParquetReaderIterator.hasNext(ParquetReaderIterator.java:53)\r\n\tat org.apache.hudi.common.util.queue.IteratorBasedQueueProducer.produce(IteratorBasedQueueProducer.java:45)\r\n\tat org.apache.hudi.common.util.queue.BoundedInMemoryExecutor.lambda$null$0(BoundedInMemoryExecutor.java:106)\r\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:266)\r\n\tat java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)\r\n\t... 4 more\r\nCaused by: org.apache.avro.SchemaParseException: Can't redefine: list\r\n\tat org.apache.avro.Schema$Names.put(Schema.java:1128)\r\n\tat org.apache.avro.Schema$NamedSchema.writeNameRef(Schema.java:562)\r\n\tat org.apache.avro.Schema$RecordSchema.toJson(Schema.java:690)\r\n\tat org.apache.avro.Schema$ArraySchema.toJson(Schema.java:805)\r\n\tat org.apache.avro.Schema$UnionSchema.toJson(Schema.java:882)\r\n\tat org.apache.avro.Schema$RecordSchema.fieldsToJson(Schema.java:716)\r\n\tat org.apache.avro.Schema$RecordSchema.toJson(Schema.java:701)\r\n\tat org.apache.avro.Schema$UnionSchema.toJson(Schema.java:882)\r\n\tat org.apache.avro.Schema$RecordSchema.fieldsToJson(Schema.java:716)\r\n\tat org.apache.avro.Schema$RecordSchema.toJson(Schema.java:701)\r\n\tat org.apache.avro.Schema$UnionSchema.toJson(Schema.java:882)\r\n\tat org.apache.avro.Schema$RecordSchema.fieldsToJson(Schema.java:716)\r\n\tat org.apache.avro.Schema$RecordSchema.toJson(Schema.java:701)\r\n\tat org.apache.avro.Schema.toString(Schema.java:324)\r\n\tat org.apache.avro.SchemaCompatibility.checkReaderWriterCompatibility(SchemaCompatibility.java:68)\r\n\tat org.apache.parquet.avro.AvroRecordConverter.isElementType(AvroRecordConverter.java:866)\r\n\tat org.apache.parquet.avro.AvroRecordConverter$AvroCollectionConverter.<init>(AvroRecordConverter.java:475)\r\n\tat org.apache.parquet.avro.AvroRecordConverter.newConverter(AvroRecordConverter.java:289)\r\n\tat org.apache.parquet.avro.AvroRecordConverter.<init>(AvroRecordConverter.java:141)\r\n\tat org.apache.parquet.avro.AvroRecordConverter.newConverter(AvroRecordConverter.java:279)\r\n\tat org.apache.parquet.avro.AvroRecordConverter.<init>(AvroRecordConverter.java:141)\r\n\tat org.apache.parquet.avro.AvroRecordConverter.newConverter(AvroRecordConverter.java:279)\r\n\tat org.apache.parquet.avro.AvroRecordConverter.<init>(AvroRecordConverter.java:141)\r\n\tat org.apache.parquet.avro.AvroRecordConverter.<init>(AvroRecordConverter.java:95)\r\n\tat org.apache.parquet.avro.AvroRecordMaterializer.<init>(AvroRecordMaterializer.java:33)\r\n\tat org.apache.parquet.avro.AvroReadSupport.prepareForRead(AvroReadSupport.java:138)\r\n\tat org.apache.parquet.hadoop.InternalParquetRecordReader.initialize(InternalParquetRecordReader.java:183)\r\n\tat org.apache.parquet.hadoop.ParquetReader.initReader(ParquetReader.java:156)\r\n\tat org.apache.parquet.hadoop.ParquetReader.read(ParquetReader.java:135)\r\n\tat org.apache.hudi.common.util.ParquetReaderIterator.hasNext(ParquetReaderIterator.java:48)\r\n\t... 8 more\r\n\r\nDriver stacktrace:\r\n\tat org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2465)\r\n\tat org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2414)\r\n\tat org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2413)\r\n\tat scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:58)\r\n\tat scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:51)\r\n\tat scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:47)\r\n\tat org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2413)\r\n\tat org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1124)\r\n\tat org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1124)\r\n\tat scala.Option.foreach(Option.scala:257)\r\n\tat org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1124)\r\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:2679)\r\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2621)\r\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2610)\r\n\tat org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)\r\n\tat org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:914)\r\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2238)\r\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2259)\r\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2278)\r\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2303)\r\n\tat org.apache.spark.rdd.RDD.count(RDD.scala:1253)\r\n\tat org.apache.hudi.HoodieSparkSqlWriter$.commitAndPerformPostOperations(HoodieSparkSqlWriter.scala:696)\r\n\tat org.apache.hudi.HoodieSparkSqlWriter$.write(HoodieSparkSqlWriter.scala:338)\r\n\tat org.apache.hudi.DefaultSource.createRelation(DefaultSource.scala:184)\r\n\tat org.apache.spark.sql.execution.datasources.SaveIntoDataSourceCommand.run(SaveIntoDataSourceCommand.scala:46)\r\n\tat org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult$lzycompute(commands.scala:70)\r\n\tat org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult(commands.scala:68)\r\n\tat org.apache.spark.sql.execution.command.ExecutedCommandExec.doExecute(commands.scala:90)\r\n\tat org.apache.spark.sql.execution.SparkPlan.$anonfun$execute$1(SparkPlan.scala:185)\r\n\tat org.apache.spark.sql.execution.SparkPlan.$anonfun$executeQuery$1(SparkPlan.scala:223)\r\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\r\n\tat org.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:220)\r\n\tat org.apache.spark.sql.execution.SparkPlan.execute(SparkPlan.scala:181)\r\n\tat org.apache.spark.sql.execution.QueryExecution.toRdd$lzycompute(QueryExecution.scala:134)\r\n\tat org.apache.spark.sql.execution.QueryExecution.toRdd(QueryExecution.scala:133)\r\n\tat org.apache.spark.sql.DataFrameWriter.$anonfun$runCommand$1(DataFrameWriter.scala:989)\r\n\tat org.apache.spark.sql.catalyst.QueryPlanningTracker$.withTracker(QueryPlanningTracker.scala:107)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.withTracker(SQLExecution.scala:232)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.executeQuery$1(SQLExecution.scala:110)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:135)\r\n\tat org.apache.spark.sql.catalyst.QueryPlanningTracker$.withTracker(QueryPlanningTracker.scala:107)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.withTracker(SQLExecution.scala:232)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$5(SQLExecution.scala:135)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:253)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:134)\r\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:772)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:68)\r\n\tat org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:989)\r\n\tat org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:438)\r\n\tat org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:415)\r\n\tat org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:301)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.lang.reflect.Method.invoke(Method.java:498)\r\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\r\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\r\n\tat py4j.Gateway.invoke(Gateway.java:282)\r\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\r\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\r\n\tat py4j.GatewayConnection.run(GatewayConnection.java:238)\r\n\tat java.lang.Thread.run(Thread.java:750)\r\nCaused by: org.apache.hudi.exception.HoodieUpsertException: Error upserting bucketType UPDATE for partition :0\r\n\tat org.apache.hudi.table.action.commit.BaseSparkCommitActionExecutor.handleUpsertPartition(BaseSparkCommitActionExecutor.java:329)\r\n\tat org.apache.hudi.table.action.commit.BaseSparkCommitActionExecutor.lambda$mapPartitionsAsRDD$a3ab3c4$1(BaseSparkCommitActionExecutor.java:244)\r\n\tat org.apache.spark.api.java.JavaRDDLike.$anonfun$mapPartitionsWithIndex$1(JavaRDDLike.scala:102)\r\n\tat org.apache.spark.api.java.JavaRDDLike.$anonfun$mapPartitionsWithIndex$1$adapted(JavaRDDLike.scala:102)\r\n\tat org.apache.spark.rdd.RDD.$anonfun$mapPartitionsWithIndex$2(RDD.scala:915)\r\n\tat org.apache.spark.rdd.RDD.$anonfun$mapPartitionsWithIndex$2$adapted(RDD.scala:915)\r\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)\r\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:373)\r\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:337)\r\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)\r\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:373)\r\n\tat org.apache.spark.rdd.RDD.$anonfun$getOrCompute$1(RDD.scala:386)\r\n\tat org.apache.spark.storage.BlockManager.$anonfun$doPutIterator$1(BlockManager.scala:1440)\r\n\tat org.apache.spark.storage.BlockManager.org$apache$spark$storage$BlockManager$$doPut(BlockManager.scala:1350)\r\n\tat org.apache.spark.storage.BlockManager.doPutIterator(BlockManager.scala:1414)\r\n\tat org.apache.spark.storage.BlockManager.getOrElseUpdate(BlockManager.scala:1237)\r\n\tat org.apache.spark.rdd.RDD.getOrCompute(RDD.scala:384)\r\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:335)\r\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)\r\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:373)\r\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:337)\r\n\tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:90)\r\n\tat org.apache.spark.scheduler.Task.run(Task.scala:131)\r\n\tat org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$3(Executor.scala:497)\r\n\tat org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1439)\r\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:500)\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n\t... 1 more\r\nCaused by: org.apache.hudi.exception.HoodieException: org.apache.hudi.exception.HoodieException: java.util.concurrent.ExecutionException: org.apache.hudi.exception.HoodieException: operation has failed\r\n\tat org.apache.hudi.table.action.commit.HoodieMergeHelper.runMerge(HoodieMergeHelper.java:149)\r\n\tat org.apache.hudi.table.action.commit.BaseSparkCommitActionExecutor.handleUpdateInternal(BaseSparkCommitActionExecutor.java:358)\r\n\tat org.apache.hudi.table.action.commit.BaseSparkCommitActionExecutor.handleUpdate(BaseSparkCommitActionExecutor.java:349)\r\n\tat org.apache.hudi.table.action.commit.BaseSparkCommitActionExecutor.handleUpsertPartition(BaseSparkCommitActionExecutor.java:322)\r\n\t... 28 more\r\nCaused by: org.apache.hudi.exception.HoodieException: java.util.concurrent.ExecutionException: org.apache.hudi.exception.HoodieException: operation has failed\r\n\tat org.apache.hudi.common.util.queue.BoundedInMemoryExecutor.execute(BoundedInMemoryExecutor.java:161)\r\n\tat org.apache.hudi.table.action.commit.HoodieMergeHelper.runMerge(HoodieMergeHelper.java:147)\r\n\t... 31 more\r\nCaused by: java.util.concurrent.ExecutionException: org.apache.hudi.exception.HoodieException: operation has failed\r\n\tat java.util.concurrent.FutureTask.report(FutureTask.java:122)\r\n\tat java.util.concurrent.FutureTask.get(FutureTask.java:192)\r\n\tat org.apache.hudi.common.util.queue.BoundedInMemoryExecutor.execute(BoundedInMemoryExecutor.java:155)\r\n\t... 32 more\r\nCaused by: org.apache.hudi.exception.HoodieException: operation has failed\r\n\tat org.apache.hudi.common.util.queue.BoundedInMemoryQueue.throwExceptionIfFailed(BoundedInMemoryQueue.java:248)\r\n\tat org.apache.hudi.common.util.queue.BoundedInMemoryQueue.readNextRecord(BoundedInMemoryQueue.java:226)\r\n\tat org.apache.hudi.common.util.queue.BoundedInMemoryQueue.access$100(BoundedInMemoryQueue.java:52)\r\n\tat org.apache.hudi.common.util.queue.BoundedInMemoryQueue$QueueIterator.hasNext(BoundedInMemoryQueue.java:278)\r\n\tat org.apache.hudi.common.util.queue.BoundedInMemoryQueueConsumer.consume(BoundedInMemoryQueueConsumer.java:36)\r\n\tat org.apache.hudi.common.util.queue.BoundedInMemoryExecutor.lambda$null$2(BoundedInMemoryExecutor.java:135)\r\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:266)\r\n\t... 3 more\r\nCaused by: org.apache.hudi.exception.HoodieException: unable to read next record from parquet file \r\n\tat org.apache.hudi.common.util.ParquetReaderIterator.hasNext(ParquetReaderIterator.java:53)\r\n\tat org.apache.hudi.common.util.queue.IteratorBasedQueueProducer.produce(IteratorBasedQueueProducer.java:45)\r\n\tat org.apache.hudi.common.util.queue.BoundedInMemoryExecutor.lambda$null$0(BoundedInMemoryExecutor.java:106)\r\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:266)\r\n\tat java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)\r\n\t... 4 more\r\nCaused by: org.apache.avro.SchemaParseException: Can't redefine: list\r\n\tat org.apache.avro.Schema$Names.put(Schema.java:1128)\r\n\tat org.apache.avro.Schema$NamedSchema.writeNameRef(Schema.java:562)\r\n\tat org.apache.avro.Schema$RecordSchema.toJson(Schema.java:690)\r\n\tat org.apache.avro.Schema$ArraySchema.toJson(Schema.java:805)\r\n\tat org.apache.avro.Schema$UnionSchema.toJson(Schema.java:882)\r\n\tat org.apache.avro.Schema$RecordSchema.fieldsToJson(Schema.java:716)\r\n\tat org.apache.avro.Schema$RecordSchema.toJson(Schema.java:701)\r\n\tat org.apache.avro.Schema$UnionSchema.toJson(Schema.java:882)\r\n\tat org.apache.avro.Schema$RecordSchema.fieldsToJson(Schema.java:716)\r\n\tat org.apache.avro.Schema$RecordSchema.toJson(Schema.java:701)\r\n\tat org.apache.avro.Schema$UnionSchema.toJson(Schema.java:882)\r\n\tat org.apache.avro.Schema$RecordSchema.fieldsToJson(Schema.java:716)\r\n\tat org.apache.avro.Schema$RecordSchema.toJson(Schema.java:701)\r\n\tat org.apache.avro.Schema.toString(Schema.java:324)\r\n\tat org.apache.avro.SchemaCompatibility.checkReaderWriterCompatibility(SchemaCompatibility.java:68)\r\n\tat org.apache.parquet.avro.AvroRecordConverter.isElementType(AvroRecordConverter.java:866)\r\n\tat org.apache.parquet.avro.AvroRecordConverter$AvroCollectionConverter.<init>(AvroRecordConverter.java:475)\r\n\tat org.apache.parquet.avro.AvroRecordConverter.newConverter(AvroRecordConverter.java:289)\r\n\tat org.apache.parquet.avro.AvroRecordConverter.<init>(AvroRecordConverter.java:141)\r\n\tat org.apache.parquet.avro.AvroRecordConverter.newConverter(AvroRecordConverter.java:279)\r\n\tat org.apache.parquet.avro.AvroRecordConverter.<init>(AvroRecordConverter.java:141)\r\n\tat org.apache.parquet.avro.AvroRecordConverter.newConverter(AvroRecordConverter.java:279)\r\n\tat org.apache.parquet.avro.AvroRecordConverter.<init>(AvroRecordConverter.java:141)\r\n\tat org.apache.parquet.avro.AvroRecordConverter.<init>(AvroRecordConverter.java:95)\r\n\tat org.apache.parquet.avro.AvroRecordMaterializer.<init>(AvroRecordMaterializer.java:33)\r\n\tat org.apache.parquet.avro.AvroReadSupport.prepareForRead(AvroReadSupport.java:138)\r\n\tat org.apache.parquet.hadoop.InternalParquetRecordReader.initialize(InternalParquetRecordReader.java:183)\r\n\tat org.apache.parquet.hadoop.ParquetReader.initReader(ParquetReader.java:156)\r\n\tat org.apache.parquet.hadoop.ParquetReader.read(ParquetReader.java:135)\r\n\tat org.apache.hudi.common.util.ParquetReaderIterator.hasNext(ParquetReaderIterator.java:48)\r\n\t... 8 more\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263992365/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263993916","html_url":"https://github.com/apache/hudi/issues/6321#issuecomment-1263993916","issue_url":"https://api.github.com/repos/apache/hudi/issues/6321","id":1263993916,"node_id":"IC_kwDOBI7nWM5LVwQ8","user":{"login":"gtwuser","id":6791570,"node_id":"MDQ6VXNlcjY3OTE1NzA=","avatar_url":"https://avatars.githubusercontent.com/u/6791570?v=4","gravatar_id":"","url":"https://api.github.com/users/gtwuser","html_url":"https://github.com/gtwuser","followers_url":"https://api.github.com/users/gtwuser/followers","following_url":"https://api.github.com/users/gtwuser/following{/other_user}","gists_url":"https://api.github.com/users/gtwuser/gists{/gist_id}","starred_url":"https://api.github.com/users/gtwuser/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gtwuser/subscriptions","organizations_url":"https://api.github.com/users/gtwuser/orgs","repos_url":"https://api.github.com/users/gtwuser/repos","events_url":"https://api.github.com/users/gtwuser/events{/privacy}","received_events_url":"https://api.github.com/users/gtwuser/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T20:28:39Z","updated_at":"2022-09-30T20:28:39Z","author_association":"NONE","body":"Configs used:\r\n```bash\r\nincrementalConfig = {\r\n                'hoodie.upsert.shuffle.parallelism': 68, 'hoodie.datasource.write.operation': 'upsert',\r\n                'hoodie.cleaner.policy': 'KEEP_LATEST_COMMITS', 'hoodie.cleaner.commits.retained': 10\r\n            }\r\npartitionDataConfig = {\r\n                'hoodie.datasource.hive_sync.partition_extractor_class': 'org.apache.hudi.hive.MultiPartKeysValueExtractor',\r\n                'hoodie.datasource.write.keygenerator.class': 'org.apache.hudi.keygen.CustomKeyGenerator',\r\n                'hoodie.datasource.write.partitionpath.field': 'year:SIMPLE, month:SIMPLE, day:SIMPLE, hour:SIMPLE, device_id:SIMPLE',\r\n                'hoodie.datasource.hive_sync.partition_fields': 'year, month, day, hour, device_id',\r\n                'hoodie.datasource.write.hive_style_partitioning': 'true'\r\n            }\r\ncommonConfig = {\r\n                'className': 'org.apache.hudi',\r\n                'hoodie.datasource.hive_sync.use_jdbc': 'false',\r\n                'hoodie.datasource.write.precombine.field': 'payload.recordedAt',\r\n                'hoodie.datasource.write.recordkey.field': 'metadata.msgID,metadata.topic',\r\n                'hoodie.table.name': 'sse',\r\n                # 'hoodie.consistency.check.enabled': 'true',\r\n                'hoodie.datasource.hive_sync.database': args['database_name'],\r\n                'hoodie.datasource.write.reconcile.schema': 'true',\r\n                'hoodie.datasource.hive_sync.table': f'sse_{\"_\".join(prefix.split(\"/\")[-7:-5])}'.lower(),\r\n                'hoodie.datasource.hive_sync.enable': 'true',\r\n                'path': 's3://' + args['curated_bucket'] + '/merged/sse-native/' + f'{prefix.split(\"/\")[-7]}'.lower(),\r\n                # 1,024 * 1,024 * 128 = 134,217,728 (134 MB)\r\n                'hoodie.parquet.small.file.limit': '307200',\r\n                'hoodie.parquet.max.file.size': '128000000'\r\n            }","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1263993916/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1264008704","html_url":"https://github.com/apache/hudi/issues/6321#issuecomment-1264008704","issue_url":"https://api.github.com/repos/apache/hudi/issues/6321","id":1264008704,"node_id":"IC_kwDOBI7nWM5LVz4A","user":{"login":"gtwuser","id":6791570,"node_id":"MDQ6VXNlcjY3OTE1NzA=","avatar_url":"https://avatars.githubusercontent.com/u/6791570?v=4","gravatar_id":"","url":"https://api.github.com/users/gtwuser","html_url":"https://github.com/gtwuser","followers_url":"https://api.github.com/users/gtwuser/followers","following_url":"https://api.github.com/users/gtwuser/following{/other_user}","gists_url":"https://api.github.com/users/gtwuser/gists{/gist_id}","starred_url":"https://api.github.com/users/gtwuser/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gtwuser/subscriptions","organizations_url":"https://api.github.com/users/gtwuser/orgs","repos_url":"https://api.github.com/users/gtwuser/repos","events_url":"https://api.github.com/users/gtwuser/events{/privacy}","received_events_url":"https://api.github.com/users/gtwuser/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T20:45:10Z","updated_at":"2022-09-30T20:45:10Z","author_association":"NONE","body":"Now we have also update the environment \r\n**Environment Description**\r\n\r\n  Hudi version : 0.11.1\r\n\r\n  Spark version : 3.1\r\n\r\n  Storage (HDFS/S3/GCS..) : S3\r\n\r\n  Running on Docker? (yes/no) : no","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1264008704/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1264012714","html_url":"https://github.com/apache/hudi/issues/6621#issuecomment-1264012714","issue_url":"https://api.github.com/repos/apache/hudi/issues/6621","id":1264012714,"node_id":"IC_kwDOBI7nWM5LV02q","user":{"login":"alexeykudinkin","id":428277,"node_id":"MDQ6VXNlcjQyODI3Nw==","avatar_url":"https://avatars.githubusercontent.com/u/428277?v=4","gravatar_id":"","url":"https://api.github.com/users/alexeykudinkin","html_url":"https://github.com/alexeykudinkin","followers_url":"https://api.github.com/users/alexeykudinkin/followers","following_url":"https://api.github.com/users/alexeykudinkin/following{/other_user}","gists_url":"https://api.github.com/users/alexeykudinkin/gists{/gist_id}","starred_url":"https://api.github.com/users/alexeykudinkin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexeykudinkin/subscriptions","organizations_url":"https://api.github.com/users/alexeykudinkin/orgs","repos_url":"https://api.github.com/users/alexeykudinkin/repos","events_url":"https://api.github.com/users/alexeykudinkin/events{/privacy}","received_events_url":"https://api.github.com/users/alexeykudinkin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T20:50:04Z","updated_at":"2022-10-22T01:13:41Z","author_association":"CONTRIBUTOR","body":"Created HUDI-4959 to track this issue.\r\n\r\nTL;DR Problem is in the fact that we're using Kryo to ser/de HoodieKey (which fails b/c can't find class registration nor association with the encoded id)\r\n\r\n---\r\nEDIT\r\n\r\nI'm taking back my hypothesis that the issue is in the class encoding, after writing a small test to validate the issue i confirmed that Kryo actually writes out full class-name for all classes registered implicitly (as it should).\r\n\r\nIt seems that the problem is actually indeed in misalignment of the Avro versions as reported by @KnightChess: quick-checking i see that b/w Avro 1.8.2 and 1.10.2, `Utf8` actually had one more field added:\r\n\r\n```\r\n  // 1.8.2 \r\n  private byte[] bytes = EMPTY;\r\n  private int length;\r\n  private String string;\r\n\r\n  // 1.10.2\r\n  private byte[] bytes;\r\n  private int hash;\r\n  private int length;\r\n  private String string;\r\n```\r\n\r\nProvided that we're relying on Kryo to generate serializer for `orderingVal` that could be `Utf8` (based on `FieldSerializer`) it would actually explain why it couldn't deserialize it back (since they will have different serializers).","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1264012714/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1264058213","html_url":"https://github.com/apache/hudi/pull/6810#issuecomment-1264058213","issue_url":"https://api.github.com/repos/apache/hudi/issues/6810","id":1264058213,"node_id":"IC_kwDOBI7nWM5LV_9l","user":{"login":"yihua","id":2497195,"node_id":"MDQ6VXNlcjI0OTcxOTU=","avatar_url":"https://avatars.githubusercontent.com/u/2497195?v=4","gravatar_id":"","url":"https://api.github.com/users/yihua","html_url":"https://github.com/yihua","followers_url":"https://api.github.com/users/yihua/followers","following_url":"https://api.github.com/users/yihua/following{/other_user}","gists_url":"https://api.github.com/users/yihua/gists{/gist_id}","starred_url":"https://api.github.com/users/yihua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yihua/subscriptions","organizations_url":"https://api.github.com/users/yihua/orgs","repos_url":"https://api.github.com/users/yihua/repos","events_url":"https://api.github.com/users/yihua/events{/privacy}","received_events_url":"https://api.github.com/users/yihua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-30T21:53:14Z","updated_at":"2022-09-30T21:53:14Z","author_association":"CONTRIBUTOR","body":"CI is green.\r\n<img width=\"1483\" alt=\"Screen Shot 2022-09-30 at 14 51 53\" src=\"https://user-images.githubusercontent.com/2497195/193361283-133b1fb9-8b59-4997-8f24-7a6ca1484f85.png\">\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1264058213/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1264143351","html_url":"https://github.com/apache/hudi/issues/6572#issuecomment-1264143351","issue_url":"https://api.github.com/repos/apache/hudi/issues/6572","id":1264143351,"node_id":"IC_kwDOBI7nWM5LWUv3","user":{"login":"yihua","id":2497195,"node_id":"MDQ6VXNlcjI0OTcxOTU=","avatar_url":"https://avatars.githubusercontent.com/u/2497195?v=4","gravatar_id":"","url":"https://api.github.com/users/yihua","html_url":"https://github.com/yihua","followers_url":"https://api.github.com/users/yihua/followers","following_url":"https://api.github.com/users/yihua/following{/other_user}","gists_url":"https://api.github.com/users/yihua/gists{/gist_id}","starred_url":"https://api.github.com/users/yihua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yihua/subscriptions","organizations_url":"https://api.github.com/users/yihua/orgs","repos_url":"https://api.github.com/users/yihua/repos","events_url":"https://api.github.com/users/yihua/events{/privacy}","received_events_url":"https://api.github.com/users/yihua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-01T00:07:14Z","updated_at":"2022-10-01T00:07:14Z","author_association":"CONTRIBUTOR","body":"@Archie-selfless I'm unable to reproduce the NPE.  Could you share the schema of the source?  Does Spark uses the same Hive version as the Hive metastore?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1264143351/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1264163133","html_url":"https://github.com/apache/hudi/issues/6572#issuecomment-1264163133","issue_url":"https://api.github.com/repos/apache/hudi/issues/6572","id":1264163133,"node_id":"IC_kwDOBI7nWM5LWZk9","user":{"login":"yihua","id":2497195,"node_id":"MDQ6VXNlcjI0OTcxOTU=","avatar_url":"https://avatars.githubusercontent.com/u/2497195?v=4","gravatar_id":"","url":"https://api.github.com/users/yihua","html_url":"https://github.com/yihua","followers_url":"https://api.github.com/users/yihua/followers","following_url":"https://api.github.com/users/yihua/following{/other_user}","gists_url":"https://api.github.com/users/yihua/gists{/gist_id}","starred_url":"https://api.github.com/users/yihua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yihua/subscriptions","organizations_url":"https://api.github.com/users/yihua/orgs","repos_url":"https://api.github.com/users/yihua/repos","events_url":"https://api.github.com/users/yihua/events{/privacy}","received_events_url":"https://api.github.com/users/yihua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-01T00:34:49Z","updated_at":"2022-10-01T00:34:49Z","author_association":"CONTRIBUTOR","body":"This command works for me.  I can see in beeline that the table and partition paths are synced.\r\n```\r\nexport SPARK_HOME=/Users/ethan/Work/lib/spark-3.2.2-bin-hadoop3.2\r\n/Users/ethan/Work/lib/spark-3.2.2-bin-hadoop3.2/bin/spark-submit \\\r\n      --master local[4] \\\r\n      --driver-memory 4g --executor-memory 2g --num-executors 4 --executor-cores 1 \\\r\n      --conf spark.serializer=org.apache.spark.serializer.KryoSerializer \\\r\n      --conf spark.sql.catalogImplementation=hive \\\r\n      --conf spark.driver.maxResultSize=1g \\\r\n      --conf spark.speculation=true \\\r\n      --conf spark.speculation.multiplier=1.0 \\\r\n      --conf spark.speculation.quantile=0.5 \\\r\n      --conf spark.ui.port=6680 \\\r\n      --conf spark.eventLog.enabled=true \\\r\n      --conf spark.eventLog.dir=/Users/ethan/Work/data/hudi/spark-logs \\\r\n      --jars $HUDI_DIR/packaging/hudi-spark-bundle/target/hudi-spark3.2-bundle_2.12-0.12.0.jar \\\r\n      --class org.apache.hudi.utilities.deltastreamer.HoodieDeltaStreamer \\\r\n      $HUDI_DIR/packaging/hudi-utilities-bundle/target/hudi-utilities-bundle_2.12-0.12.0.jar \\\r\n      --props $TEST_BASE_DIR/ds_cow.properties \\\r\n      --schemaprovider-class org.apache.hudi.utilities.schema.FilebasedSchemaProvider \\\r\n      --source-class org.apache.hudi.utilities.sources.ParquetDFSSource \\\r\n      --source-ordering-field ts \\\r\n      --target-base-path file:$TEST_BASE_DIR/hudi_mysql_table2 \\\r\n      --target-table hudi_mysql_table2 \\\r\n      --table-type COPY_ON_WRITE \\\r\n      --op UPSERT \\\r\n      --enable-sync \\\r\n      --sync-tool-classes org.apache.hudi.hive.HiveSyncTool \\\r\n      --hoodie-conf hoodie.datasource.hive_sync.partition_extractor_class=org.apache.hudi.hive.MultiPartKeysValueExtractor \\\r\n      --hoodie-conf hoodie.datasource.write.hive_style_partitioning=true \\\r\n      --hoodie-conf hoodie.datasource.hive_sync.enable=true \\\r\n      --hoodie-conf hoodie.datasource.hive_sync.database=default \\\r\n      --hoodie-conf hoodie.datasource.hive_sync.table=hudi_mysql_table2 \\\r\n      --hoodie-conf hoodie.datasource.hive_sync.partition_fields=u_name \\\r\n      --hoodie-conf hoodie.datasource.hive_sync.use_jdbc=false \\\r\n      --hoodie-conf hoodie.datasource.hive_sync.metastore.uris=thrift://localhost:9083 \\\r\n      --hoodie-conf hoodie.datasource.hive_sync.mode=hms >> ds.log 2>&1\r\n```\r\nds_cow.properties\r\n```\r\n# Key fields, for kafka example\r\nhoodie.datasource.write.recordkey.field=key\r\nhoodie.datasource.write.partitionpath.field=u_name\r\n# Schema provider props (change to absolute path based on your installation)\r\nhoodie.deltastreamer.schemaprovider.source.schema.file=file:/TEST_BASE_DIR/schema.avsc\r\nhoodie.deltastreamer.schemaprovider.target.schema.file=file:/TEST_BASE_DIR/schema.avsc\r\n# DFS Source\r\nhoodie.deltastreamer.source.dfs.root=file:/TEST_BASE_DIR/source\r\n```\r\nschema.avsc\r\n```\r\n{\r\n  \"type\" : \"record\",\r\n  \"name\" : \"test_struct\",\r\n  \"namespace\" : \"test_namespace\",\r\n  \"fields\" : [ {\r\n    \"name\" : \"key\",\r\n    \"type\" : [ \"null\", \"string\" ],\r\n    \"default\" : null\r\n  }, {\r\n    \"name\" : \"partition\",\r\n    \"type\" : [ \"null\", \"string\" ],\r\n    \"default\" : null\r\n  }, {\r\n    \"name\" : \"ts\",\r\n    \"type\" : [ \"null\", \"long\" ],\r\n    \"default\" : null\r\n  }, {\r\n    \"name\" : \"textField\",\r\n    \"type\" : [ \"null\", \"string\" ],\r\n    \"default\" : null\r\n  }, {\r\n    \"name\" : \"decimalField\",\r\n    \"type\" : [ \"null\", \"float\" ],\r\n    \"default\" : null\r\n  }, {\r\n    \"name\" : \"longField\",\r\n    \"type\" : [ \"null\", \"long\" ],\r\n    \"default\" : null\r\n  }, {\r\n    \"name\" : \"arrayField\",\r\n    \"type\" : [ \"null\", {\r\n      \"type\" : \"array\",\r\n      \"items\" : [ \"int\", \"null\" ]\r\n    } ],\r\n    \"default\" : null\r\n  }, {\r\n    \"name\" : \"mapField\",\r\n    \"type\" : [ \"null\", {\r\n      \"type\" : \"map\",\r\n      \"values\" : [ \"int\", \"null\" ]\r\n    } ],\r\n    \"default\" : null\r\n  }, {\r\n    \"name\" : \"round\",\r\n    \"type\" : [ \"null\", \"int\" ],\r\n    \"default\" : null\r\n  }, {\r\n    \"name\" : \"u_name\",\r\n    \"type\" : [ \"null\", \"string\" ],\r\n    \"default\" : null\r\n  } ]\r\n}\r\n```","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1264163133/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1264166951","html_url":"https://github.com/apache/hudi/issues/6572#issuecomment-1264166951","issue_url":"https://api.github.com/repos/apache/hudi/issues/6572","id":1264166951,"node_id":"IC_kwDOBI7nWM5LWagn","user":{"login":"yihua","id":2497195,"node_id":"MDQ6VXNlcjI0OTcxOTU=","avatar_url":"https://avatars.githubusercontent.com/u/2497195?v=4","gravatar_id":"","url":"https://api.github.com/users/yihua","html_url":"https://github.com/yihua","followers_url":"https://api.github.com/users/yihua/followers","following_url":"https://api.github.com/users/yihua/following{/other_user}","gists_url":"https://api.github.com/users/yihua/gists{/gist_id}","starred_url":"https://api.github.com/users/yihua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yihua/subscriptions","organizations_url":"https://api.github.com/users/yihua/orgs","repos_url":"https://api.github.com/users/yihua/repos","events_url":"https://api.github.com/users/yihua/events{/privacy}","received_events_url":"https://api.github.com/users/yihua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-01T00:35:46Z","updated_at":"2022-10-01T02:02:13Z","author_association":"CONTRIBUTOR","body":"@Archie-selfless I'm not sure if this is related to the MySqlDebeziumSource and MySqlDebeziumAvroPayload.  Could you try a simple ingestion with ParquetDFSSource as above to see if the Hive sync works in your setup?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1264166951/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1264289570","html_url":"https://github.com/apache/hudi/pull/6840#issuecomment-1264289570","issue_url":"https://api.github.com/repos/apache/hudi/issues/6840","id":1264289570,"node_id":"IC_kwDOBI7nWM5LW4ci","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-01T08:20:14Z","updated_at":"2022-10-01T08:20:14Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"19269c08181415e307ad01dd8e55b5bfdb57dd21\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11937\",\n    \"triggerID\" : \"19269c08181415e307ad01dd8e55b5bfdb57dd21\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"e5aa453d856029f2534a85cb9e14c7c8dcf218d9\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11944\",\n    \"triggerID\" : \"e5aa453d856029f2534a85cb9e14c7c8dcf218d9\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"91ef1a0ff644c2a9bf855a409cb6f46fcaeb7817\",\n    \"status\" : \"SUCCESS\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11949\",\n    \"triggerID\" : \"91ef1a0ff644c2a9bf855a409cb6f46fcaeb7817\",\n    \"triggerType\" : \"PUSH\"\n  } ]\n}-->\n## CI report:\n\n* 91ef1a0ff644c2a9bf855a409cb6f46fcaeb7817 Azure: [SUCCESS](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11949) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1264289570/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1264293012","html_url":"https://github.com/apache/hudi/pull/6846#issuecomment-1264293012","issue_url":"https://api.github.com/repos/apache/hudi/issues/6846","id":1264293012,"node_id":"IC_kwDOBI7nWM5LW5SU","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-01T08:40:23Z","updated_at":"2022-10-01T08:40:23Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"41ce560cacf27b18c14672ef5650f285b271ce4a\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11947\",\n    \"triggerID\" : \"41ce560cacf27b18c14672ef5650f285b271ce4a\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"6137f878fb8c1bf572e53cc56624341a39893c31\",\n    \"status\" : \"SUCCESS\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11950\",\n    \"triggerID\" : \"6137f878fb8c1bf572e53cc56624341a39893c31\",\n    \"triggerType\" : \"PUSH\"\n  } ]\n}-->\n## CI report:\n\n* 6137f878fb8c1bf572e53cc56624341a39893c31 Azure: [SUCCESS](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11950) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1264293012/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1264301226","html_url":"https://github.com/apache/hudi/pull/6745#issuecomment-1264301226","issue_url":"https://api.github.com/repos/apache/hudi/issues/6745","id":1264301226,"node_id":"IC_kwDOBI7nWM5LW7Sq","user":{"login":"wzx140","id":25837418,"node_id":"MDQ6VXNlcjI1ODM3NDE4","avatar_url":"https://avatars.githubusercontent.com/u/25837418?v=4","gravatar_id":"","url":"https://api.github.com/users/wzx140","html_url":"https://github.com/wzx140","followers_url":"https://api.github.com/users/wzx140/followers","following_url":"https://api.github.com/users/wzx140/following{/other_user}","gists_url":"https://api.github.com/users/wzx140/gists{/gist_id}","starred_url":"https://api.github.com/users/wzx140/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wzx140/subscriptions","organizations_url":"https://api.github.com/users/wzx140/orgs","repos_url":"https://api.github.com/users/wzx140/repos","events_url":"https://api.github.com/users/wzx140/events{/privacy}","received_events_url":"https://api.github.com/users/wzx140/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-01T09:08:17Z","updated_at":"2022-10-01T09:08:17Z","author_association":"CONTRIBUTOR","body":"@hudi-bot run azure","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1264301226/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1264315897","html_url":"https://github.com/apache/hudi/issues/6832#issuecomment-1264315897","issue_url":"https://api.github.com/repos/apache/hudi/issues/6832","id":1264315897,"node_id":"IC_kwDOBI7nWM5LW-35","user":{"login":"kazdy","id":27806231,"node_id":"MDQ6VXNlcjI3ODA2MjMx","avatar_url":"https://avatars.githubusercontent.com/u/27806231?v=4","gravatar_id":"","url":"https://api.github.com/users/kazdy","html_url":"https://github.com/kazdy","followers_url":"https://api.github.com/users/kazdy/followers","following_url":"https://api.github.com/users/kazdy/following{/other_user}","gists_url":"https://api.github.com/users/kazdy/gists{/gist_id}","starred_url":"https://api.github.com/users/kazdy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kazdy/subscriptions","organizations_url":"https://api.github.com/users/kazdy/orgs","repos_url":"https://api.github.com/users/kazdy/repos","events_url":"https://api.github.com/users/kazdy/events{/privacy}","received_events_url":"https://api.github.com/users/kazdy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-01T10:09:36Z","updated_at":"2022-10-01T10:09:36Z","author_association":"CONTRIBUTOR","body":"hi @dragonH \r\n\r\nI had the same issue, basically glue data catalog converts table names and column names to lowarcase. Then in glue client for hive metastore (the aws one) it is not taken into account and because Customer_Sample_Hudi becomes customer_sample_hudi and glue client is case sensitive and throws this error:\r\n`java.lang.IllegalArgumentException: Partitions must be in the same table`\r\n\r\nHere's exactly the piece of code that causes this issue:\r\n\r\n`checkArgument(tbl.getDbName().equals(partition.getDbName()), \"Partitions must be in the same DB\");`\r\n\r\nhttps://github.com/awslabs/aws-glue-data-catalog-client-for-apache-hive-metastore/blob/ac318d42b3df00c1ada1be6a3305bcf9bd4895f0/aws-glue-datacatalog-client-common/src/main/java/com/amazonaws/glue/catalog/metastore/GlueMetastoreClientDelegate.java#L679\r\n\r\nYou can try using AWSGlueCatalogSyncClient, It might be fixed there. \r\nIf you don't want to change the sync tool, just change this:\r\n`'hoodie.datasource.hive_sync.table': 'Customer_Sample_Hudi'`\r\nto\r\n`'hoodie.datasource.hive_sync.table': 'customer_sample_hudi'`\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1264315897/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1264334459","html_url":"https://github.com/apache/hudi/issues/6849#issuecomment-1264334459","issue_url":"https://api.github.com/repos/apache/hudi/issues/6849","id":1264334459,"node_id":"IC_kwDOBI7nWM5LXDZ7","user":{"login":"gtwuser","id":6791570,"node_id":"MDQ6VXNlcjY3OTE1NzA=","avatar_url":"https://avatars.githubusercontent.com/u/6791570?v=4","gravatar_id":"","url":"https://api.github.com/users/gtwuser","html_url":"https://github.com/gtwuser","followers_url":"https://api.github.com/users/gtwuser/followers","following_url":"https://api.github.com/users/gtwuser/following{/other_user}","gists_url":"https://api.github.com/users/gtwuser/gists{/gist_id}","starred_url":"https://api.github.com/users/gtwuser/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gtwuser/subscriptions","organizations_url":"https://api.github.com/users/gtwuser/orgs","repos_url":"https://api.github.com/users/gtwuser/repos","events_url":"https://api.github.com/users/gtwuser/events{/privacy}","received_events_url":"https://api.github.com/users/gtwuser/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-01T11:22:25Z","updated_at":"2022-10-01T11:22:25Z","author_association":"NONE","body":"@nsivabalan @alexeykudinkin @yihua @xiarixiaoyao any help will be highly useful","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1264334459/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1264337473","html_url":"https://github.com/apache/hudi/issues/6849#issuecomment-1264337473","issue_url":"https://api.github.com/repos/apache/hudi/issues/6849","id":1264337473,"node_id":"IC_kwDOBI7nWM5LXEJB","user":{"login":"gtwuser","id":6791570,"node_id":"MDQ6VXNlcjY3OTE1NzA=","avatar_url":"https://avatars.githubusercontent.com/u/6791570?v=4","gravatar_id":"","url":"https://api.github.com/users/gtwuser","html_url":"https://github.com/gtwuser","followers_url":"https://api.github.com/users/gtwuser/followers","following_url":"https://api.github.com/users/gtwuser/following{/other_user}","gists_url":"https://api.github.com/users/gtwuser/gists{/gist_id}","starred_url":"https://api.github.com/users/gtwuser/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gtwuser/subscriptions","organizations_url":"https://api.github.com/users/gtwuser/orgs","repos_url":"https://api.github.com/users/gtwuser/repos","events_url":"https://api.github.com/users/gtwuser/events{/privacy}","received_events_url":"https://api.github.com/users/gtwuser/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-01T11:38:17Z","updated_at":"2022-10-01T11:38:17Z","author_association":"NONE","body":"This https://github.com/apache/hudi/issues/1326 may be similar to the above issue. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1264337473/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1264338119","html_url":"https://github.com/apache/hudi/issues/5891#issuecomment-1264338119","issue_url":"https://api.github.com/repos/apache/hudi/issues/5891","id":1264338119,"node_id":"IC_kwDOBI7nWM5LXETH","user":{"login":"gtwuser","id":6791570,"node_id":"MDQ6VXNlcjY3OTE1NzA=","avatar_url":"https://avatars.githubusercontent.com/u/6791570?v=4","gravatar_id":"","url":"https://api.github.com/users/gtwuser","html_url":"https://github.com/gtwuser","followers_url":"https://api.github.com/users/gtwuser/followers","following_url":"https://api.github.com/users/gtwuser/following{/other_user}","gists_url":"https://api.github.com/users/gtwuser/gists{/gist_id}","starred_url":"https://api.github.com/users/gtwuser/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gtwuser/subscriptions","organizations_url":"https://api.github.com/users/gtwuser/orgs","repos_url":"https://api.github.com/users/gtwuser/repos","events_url":"https://api.github.com/users/gtwuser/events{/privacy}","received_events_url":"https://api.github.com/users/gtwuser/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-01T11:41:51Z","updated_at":"2022-10-01T11:41:51Z","author_association":"NONE","body":"thanks @jharringtonCoupons closing it for now. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1264338119/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1264423605","html_url":"https://github.com/apache/hudi/pull/6805#issuecomment-1264423605","issue_url":"https://api.github.com/repos/apache/hudi/issues/6805","id":1264423605,"node_id":"IC_kwDOBI7nWM5LXZK1","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-01T17:06:14Z","updated_at":"2022-10-01T17:06:14Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"591c0d34537bba9f3d1e20dab8ba01d5be60e738\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11764\",\n    \"triggerID\" : \"591c0d34537bba9f3d1e20dab8ba01d5be60e738\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"553617898625ce54efbe0f72bdad5c44c3906743\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11779\",\n    \"triggerID\" : \"553617898625ce54efbe0f72bdad5c44c3906743\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"553617898625ce54efbe0f72bdad5c44c3906743\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11792\",\n    \"triggerID\" : \"1259565595\",\n    \"triggerType\" : \"MANUAL\"\n  }, {\n    \"hash\" : \"553617898625ce54efbe0f72bdad5c44c3906743\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11779\",\n    \"triggerID\" : \"1259565595\",\n    \"triggerType\" : \"MANUAL\"\n  }, {\n    \"hash\" : \"573c27aef34708f1b6019f0647a0ef7093c3a96a\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11822\",\n    \"triggerID\" : \"573c27aef34708f1b6019f0647a0ef7093c3a96a\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"075b993b608134f15eff7cab96b8e916369ae722\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11918\",\n    \"triggerID\" : \"075b993b608134f15eff7cab96b8e916369ae722\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"be8c12ec97231e1dd549cb3ece42a388e2976563\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11925\",\n    \"triggerID\" : \"be8c12ec97231e1dd549cb3ece42a388e2976563\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"8b5baf6007d88f619ca2838c507c93d48e3c7f45\",\n    \"status\" : \"SUCCESS\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11958\",\n    \"triggerID\" : \"8b5baf6007d88f619ca2838c507c93d48e3c7f45\",\n    \"triggerType\" : \"PUSH\"\n  } ]\n}-->\n## CI report:\n\n* 8b5baf6007d88f619ca2838c507c93d48e3c7f45 Azure: [SUCCESS](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11958) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1264423605/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1264499469","html_url":"https://github.com/apache/hudi/pull/6848#issuecomment-1264499469","issue_url":"https://api.github.com/repos/apache/hudi/issues/6848","id":1264499469,"node_id":"IC_kwDOBI7nWM5LXrsN","user":{"login":"danny0405","id":7644508,"node_id":"MDQ6VXNlcjc2NDQ1MDg=","avatar_url":"https://avatars.githubusercontent.com/u/7644508?v=4","gravatar_id":"","url":"https://api.github.com/users/danny0405","html_url":"https://github.com/danny0405","followers_url":"https://api.github.com/users/danny0405/followers","following_url":"https://api.github.com/users/danny0405/following{/other_user}","gists_url":"https://api.github.com/users/danny0405/gists{/gist_id}","starred_url":"https://api.github.com/users/danny0405/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danny0405/subscriptions","organizations_url":"https://api.github.com/users/danny0405/orgs","repos_url":"https://api.github.com/users/danny0405/repos","events_url":"https://api.github.com/users/danny0405/events{/privacy}","received_events_url":"https://api.github.com/users/danny0405/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-01T22:47:32Z","updated_at":"2022-10-01T22:47:32Z","author_association":"CONTRIBUTOR","body":"The failed test `ITTestDataStreamWrite.testWriteCopyOnWriteWithClustering` is flaky, it should not affected by this pr, would merge it soon and fire another PR to fix the tests separately.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1264499469/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1264507836","html_url":"https://github.com/apache/hudi/pull/6848#issuecomment-1264507836","issue_url":"https://api.github.com/repos/apache/hudi/issues/6848","id":1264507836,"node_id":"IC_kwDOBI7nWM5LXtu8","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-01T23:29:44Z","updated_at":"2022-10-01T23:29:44Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"6318c29ab4e0415d365db365aac92f1f562a4b68\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11954\",\n    \"triggerID\" : \"6318c29ab4e0415d365db365aac92f1f562a4b68\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"fcfc1baee8aa5394c4472135f6ceb0d280cf8c16\",\n    \"status\" : \"FAILURE\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11955\",\n    \"triggerID\" : \"fcfc1baee8aa5394c4472135f6ceb0d280cf8c16\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"856ec633afc90a499aa4de4f69ada1439a63f7a4\",\n    \"status\" : \"PENDING\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11960\",\n    \"triggerID\" : \"856ec633afc90a499aa4de4f69ada1439a63f7a4\",\n    \"triggerType\" : \"PUSH\"\n  } ]\n}-->\n## CI report:\n\n* fcfc1baee8aa5394c4472135f6ceb0d280cf8c16 Azure: [FAILURE](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11955) \n* 856ec633afc90a499aa4de4f69ada1439a63f7a4 Azure: [PENDING](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11960) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1264507836/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1264574826","html_url":"https://github.com/apache/hudi/issues/6281#issuecomment-1264574826","issue_url":"https://api.github.com/repos/apache/hudi/issues/6281","id":1264574826,"node_id":"IC_kwDOBI7nWM5LX-Fq","user":{"login":"yihua","id":2497195,"node_id":"MDQ6VXNlcjI0OTcxOTU=","avatar_url":"https://avatars.githubusercontent.com/u/2497195?v=4","gravatar_id":"","url":"https://api.github.com/users/yihua","html_url":"https://github.com/yihua","followers_url":"https://api.github.com/users/yihua/followers","following_url":"https://api.github.com/users/yihua/following{/other_user}","gists_url":"https://api.github.com/users/yihua/gists{/gist_id}","starred_url":"https://api.github.com/users/yihua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yihua/subscriptions","organizations_url":"https://api.github.com/users/yihua/orgs","repos_url":"https://api.github.com/users/yihua/repos","events_url":"https://api.github.com/users/yihua/events{/privacy}","received_events_url":"https://api.github.com/users/yihua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-02T07:35:32Z","updated_at":"2022-10-02T07:35:32Z","author_association":"CONTRIBUTOR","body":"@crutis After revisiting this issue, I found that there is a bug if `TimestampBasedKeyGenerator` is used with the output dateformat containing slashes.  I can reproduce your issue on EMR with Glue Data Catalog.  The root cause is that the partition value extraction does not fetch the right values causing the meta sync to fail.\r\n\r\nI've put up a PR to fix such issue and improve the usability: #6851.  You can check the PR description for more details.  I've tested that the exception above no longer shows up and the Glue sync is successful after the fix is applied.\r\n\r\nTo get unblocked, you may also use `hoodie.deltastreamer.keygen.timebased.output.dateformat=yyyy-MM-dd` to get around the bug.\r\n\r\n@crutis Let us know if that solves your problem.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1264574826/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1264609296","html_url":"https://github.com/apache/hudi/pull/6851#issuecomment-1264609296","issue_url":"https://api.github.com/repos/apache/hudi/issues/6851","id":1264609296,"node_id":"IC_kwDOBI7nWM5LYGgQ","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-02T10:38:43Z","updated_at":"2022-10-02T10:38:43Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"1e9d7d3b20a72047d0d5b6e385d9078ffc7fdb65\",\n    \"status\" : \"SUCCESS\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11962\",\n    \"triggerID\" : \"1e9d7d3b20a72047d0d5b6e385d9078ffc7fdb65\",\n    \"triggerType\" : \"PUSH\"\n  } ]\n}-->\n## CI report:\n\n* 1e9d7d3b20a72047d0d5b6e385d9078ffc7fdb65 Azure: [SUCCESS](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11962) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1264609296/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1264629689","html_url":"https://github.com/apache/hudi/issues/6808#issuecomment-1264629689","issue_url":"https://api.github.com/repos/apache/hudi/issues/6808","id":1264629689,"node_id":"IC_kwDOBI7nWM5LYLe5","user":{"login":"schlichtanders","id":4255480,"node_id":"MDQ6VXNlcjQyNTU0ODA=","avatar_url":"https://avatars.githubusercontent.com/u/4255480?v=4","gravatar_id":"","url":"https://api.github.com/users/schlichtanders","html_url":"https://github.com/schlichtanders","followers_url":"https://api.github.com/users/schlichtanders/followers","following_url":"https://api.github.com/users/schlichtanders/following{/other_user}","gists_url":"https://api.github.com/users/schlichtanders/gists{/gist_id}","starred_url":"https://api.github.com/users/schlichtanders/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/schlichtanders/subscriptions","organizations_url":"https://api.github.com/users/schlichtanders/orgs","repos_url":"https://api.github.com/users/schlichtanders/repos","events_url":"https://api.github.com/users/schlichtanders/events{/privacy}","received_events_url":"https://api.github.com/users/schlichtanders/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-02T12:17:44Z","updated_at":"2022-10-02T12:17:44Z","author_association":"NONE","body":"Thank you for your help,\r\nhave you tried to replicate it on your side?\r\n\r\nI added those configs so that the spark sql returns the following\r\n```\r\n+--------------------------------------------------------------+------------------------------------+\r\n|key                                                           |value                               |\r\n+--------------------------------------------------------------+------------------------------------+\r\n|spark.hadoop.hive.metastore.schema.verification               |false                               |\r\n|spark.hadoop.hive.metastore.schema.verification.record.version|false                               |\r\n|spark.hadoop.javax.jdo.option.ConnectionDriverName            |org.apache.derby.jdbc.EmbeddedDriver|\r\n|spark.hadoop.javax.jdo.option.ConnectionURL                   |*********(redacted)                 |\r\n+--------------------------------------------------------------+------------------------------------+\r\n```\r\n\r\nNow the code runs through, but no tables get registered. As a test, I am running `df.write.saveAsTable(\"saveastable_table\")` which indeed works.\r\n\r\nI won't have the resources to debug this further. I switched to delta lake which works out of the box with sparks local metastore (the one autoenabled by merely setting `spark.sql.catalogImplementation=hive`, or using `SparkSession.builder.enableHiveSupport()` respectively).\r\n\r\nHaving the possibility to test hudi locally with a local metastore is really crucial for us. It would be great if hudi can support this in the future. An example in the documentation which works would be really great. Best case would be that the default spark metastore works just out of the box (like it is the case for delta lake).\r\n\r\n\r\n--------------\r\n\r\n# Here details about my current try\r\n\r\n```python\r\nfrom pyspark.sql import SparkSession\r\nfrom pathlib import Path\r\nimport os\r\n\r\nos.environ[\"PYSPARK_SUBMIT_ARGS\"] = \" \".join([\r\n    # hudi config\r\n    \"--packages org.apache.hudi:hudi-spark3.2-bundle_2.12:0.12.0\",\r\n    \"--conf spark.serializer=org.apache.spark.serializer.KryoSerializer\",\r\n    \"--conf spark.sql.catalog.spark_catalog=org.apache.spark.sql.hudi.catalog.HoodieCatalog\",\r\n    \"--conf spark.sql.extensions=org.apache.spark.sql.hudi.HoodieSparkSessionExtension\",\r\n    # \"--conf spark.sql.hive.convertMetastoreParquet=false\", # taken from AWS example\r\n    # others\r\n    # \"--conf spark.hadoop.hive.metastore.uris=jdbc:derby:;databaseName=metastore_db;create=true\",\r\n    # \"--conf spark.hadoop.hive.metastore.uris=''\",\r\n    # f\"--conf spark.sql.warehouse.dir={Path('.').absolute() / 'metastore_warehouse'}\",\r\n    # \"--conf spark.eventLog.enabled=false\",\r\n    \"--conf spark.sql.catalogImplementation=hive\",\r\n    \"--conf spark.hadoop.hive.metastore.schema.verification=false\",\r\n    \"--conf spark.hadoop.hive.metastore.schema.verification.record.version=false\",\r\n    \"--conf spark.hadoop.javax.jdo.option.ConnectionDriverName='org.apache.derby.jdbc.EmbeddedDriver'\",\r\n    \"--conf spark.hadoop.javax.jdo.option.ConnectionURL='jdbc:derby:memory:myInMemDB;create=true'\",\r\n    \"--conf spark.hadoop.datanucleus.schema.autoCreateTables=true\",\r\n    # f\"--conf spark.sql.warehouse.dir={Path('.').absolute() / 'metastore_warehouse'}\",\r\n    # f\"--conf spark.sql.hive.metastore.warehouse.dir={Path('.').absolute() / 'metastore_warehouse'}\",\r\n    # necessary last string\r\n    \"pyspark-shell\",\r\n])\r\nos.environ[\"PYSPARK_SUBMIT_ARGS\"]\r\n\r\nspark = SparkSession.builder.getOrCreate()\r\nspark.sql(\"set\").filter(\"key rlike 'metastore|jdo'\").show(1000,False)\r\n\r\nsc = spark.sparkContext\r\n\r\nsc.setLogLevel(\"WARN\")\r\ndataGen = sc._jvm.org.apache.hudi.QuickstartUtils.DataGenerator()\r\ninserts = sc._jvm.org.apache.hudi.QuickstartUtils.convertToStringList(\r\n    dataGen.generateInserts(10)\r\n)\r\nfrom pyspark.sql.functions import expr\r\n\r\ndf = spark.read.json(spark.sparkContext.parallelize(inserts, 10)).withColumn(\r\n    \"part\", expr(\"'foo'\")\r\n)\r\ndf.toPandas()\r\n\r\ntableName = \"test_hudi_pyspark_local\"\r\nbasePath = f\"{Path('.').absolute()}/tmp/{tableName}\"\r\n\r\nhudi_options = {\r\n    \"hoodie.table.name\": tableName,\r\n    \"hoodie.datasource.write.recordkey.field\": \"uuid\",\r\n    \"hoodie.datasource.write.partitionpath.field\": \"part\",\r\n    \"hoodie.datasource.write.table.name\": tableName,\r\n    \"hoodie.datasource.write.operation\": \"upsert\",\r\n    \"hoodie.datasource.write.precombine.field\": \"ts\",\r\n    # \"hoodie.upsert.shuffle.parallelism\": 2,\r\n    # \"hoodie.insert.shuffle.parallelism\": 2,\r\n    \"hoodie.datasource.hive_sync.database\": \"default\",\r\n    \"hoodie.datasource.hive_sync.table\": tableName,\r\n    \"hoodie.datasource.hive_sync.enable\": \"true\",\r\n    # \"hoodie.datasource.meta.sync.enable\": \"true\",\r\n    # \"hoodie.datasource.hive_sync.mode\": \"hiveql\",\r\n    \"hoodie.datasource.hive_sync.mode\": \"hms\",\r\n    # \"hoodie.datasource.hive_sync.mode\": \"jdbc\",\r\n    # \"hoodie.datasource.hive_sync.username\": \"APP\",\r\n    # \"hoodie.datasource.hive_sync.use_jdbc\": \"false\",\r\n    # \"hoodie.datasource.hive_sync.jdbcurl\": f\"jdbc:derby:;databaseName={Path('.').absolute() / 'metastore_db'};create=true\",\r\n    # \"hoodie.datasource.hive_sync.jdbcurl\": \"jdbc:derby:;databaseName=metastore_db;create=true\",\r\n    \"hoodie.datasource.hive_sync.partition_fields\": \"part\",\r\n    \"hoodie.datasource.hive_sync.partition_extractor_class\": \"org.apache.hudi.hive.MultiPartKeysValueExtractor\",\r\n    \"index.global.enabled\": \"true\",\r\n    \"hoodie.index.type\": \"GLOBAL_BLOOM\",\r\n}\r\n(df.write.format(\"hudi\").options(**hudi_options).mode(\"overwrite\").save(basePath))\r\nspark.sql(\"Show tables from default\").toPandas()\r\n\r\ndf.write.saveAsTable(\"saveastable_table\")\r\nspark.sql(\"Show tables from default\").toPandas()\r\n```\r\n\r\nThe hoodie write outputs\r\n```\r\n22/10/02 14:12:44 WARN HoodieSparkSqlWriter$: hoodie table at /home/ssahm/Projects_Freelance/Fielmann/bi_kls_data_ocean_import/src/tmp/tmp/test_hudi_pyspark_local already exists. Deleting existing data & overwriting with new data.\r\n22/10/02 14:12:44 WARN HoodieBackedTableMetadata: Metadata table was not found at path /home/ssahm/Projects_Freelance/Fielmann/bi_kls_data_ocean_import/src/tmp/tmp/test_hudi_pyspark_local/.hoodie/metadata\r\n```\r\nand if I don't use `hms` but enable \r\n```\r\n\"hoodie.datasource.hive_sync.mode\": \"jdbc\",\r\n\"hoodie.datasource.hive_sync.use_jdbc\": \"true\",\r\n```\r\nI even get an error\r\n```\r\nOutput exceeds the [size limit](command:workbench.action.openSettings?%5B%22notebook.output.textLineLimit%22%5D). Open the full output data[ in a text editor](command:workbench.action.openLargeOutput?4c0adbbf-d034-45ec-b730-dcdbff52b5cd)\r\nAn error occurred while calling o217.save.\r\n: org.apache.hudi.exception.HoodieException: Could not sync using the meta sync class org.apache.hudi.hive.HiveSyncTool\r\n\tat org.apache.hudi.sync.common.util.SyncUtilHelpers.runHoodieMetaSync(SyncUtilHelpers.java:58)\r\n\tat org.apache.hudi.HoodieSparkSqlWriter$.$anonfun$metaSync$2(HoodieSparkSqlWriter.scala:648)\r\n\tat org.apache.hudi.HoodieSparkSqlWriter$.$anonfun$metaSync$2$adapted(HoodieSparkSqlWriter.scala:647)\r\n\tat scala.collection.mutable.HashSet.foreach(HashSet.scala:79)\r\n\tat org.apache.hudi.HoodieSparkSqlWriter$.metaSync(HoodieSparkSqlWriter.scala:647)\r\n\tat org.apache.hudi.HoodieSparkSqlWriter$.commitAndPerformPostOperations(HoodieSparkSqlWriter.scala:734)\r\n\tat org.apache.hudi.HoodieSparkSqlWriter$.write(HoodieSparkSqlWriter.scala:338)\r\n\tat org.apache.hudi.DefaultSource.createRelation(DefaultSource.scala:183)\r\n\tat org.apache.spark.sql.execution.datasources.SaveIntoDataSourceCommand.run(SaveIntoDataSourceCommand.scala:45)\r\n\tat org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult$lzycompute(commands.scala:75)\r\n\tat org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult(commands.scala:73)\r\n\tat org.apache.spark.sql.execution.command.ExecutedCommandExec.executeCollect(commands.scala:84)\r\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:110)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$5(SQLExecution.scala:103)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:163)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:90)\r\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:775)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:64)\r\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:110)\r\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:106)\r\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:481)\r\n\tat org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(TreeNode.scala:82)\r\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:481)\r\n...\r\n\tat java.net.Socket.connect(Socket.java:607)\r\n\tat org.apache.thrift.transport.TSocket.open(TSocket.java:221)\r\n\t... 67 more\r\n```\r\n```\r\n^[[0;31m---------------------------------------------------------------------------^[[0m\r\n^[[0;31mPy4JJavaError^[[0m                             Traceback (most recent call last)\r\nCell ^[[0;32mIn [16], line 29^[[0m\r\n^[[1;32m      2^[[0m basePath ^[[38;5;241m=^[[39m ^[[38;5;124mf^[[39m^[[38;5;124m\"^[[39m^[[38;5;132;01m{^[[39;00mPath(^[[38;5;124m'^[[39m^[[38;5;124m.^[[39m^[[38;5;124m'^[[39m)^[[38;5;241m.^[[39mabsolute()^[[38;5;132;01m}^[[39;00m^[[38;5;124m/tmp/^[[39m^[[38;5;132;01m{^[[39;00mtableName^[[38;5;132;01m}^[[39;00m^[[38;5;124m\"^[[39m\r\n^[[1;32m      4^[[0m hudi_options ^[[38;5;241m=^[[39m {\r\n^[[1;32m      5^[[0m     ^[[38;5;124m\"^[[39m^[[38;5;124mhoodie.table.name^[[39m^[[38;5;124m\"^[[39m: tableName,\r\n^[[1;32m      6^[[0m     ^[[38;5;124m\"^[[39m^[[38;5;124mhoodie.datasource.write.recordkey.field^[[39m^[[38;5;124m\"^[[39m: ^[[38;5;124m\"^[[39m^[[38;5;124muuid^[[39m^[[38;5;124m\"^[[39m,\r\n^[[0;32m   (...)^[[0m\r\n^[[1;32m     27^[[0m     ^[[38;5;124m\"^[[39m^[[38;5;124mhoodie.index.type^[[39m^[[38;5;124m\"^[[39m: ^[[38;5;124m\"^[[39m^[[38;5;124mGLOBAL_BLOOM^[[39m^[[38;5;124m\"^[[39m,\r\n^[[1;32m     28^[[0m }\r\n^[[0;32m---> 29^[[0m (^[[43mdf^[[49m^[[38;5;241;43m.^[[39;49m^[[43mwrite^[[49m^[[38;5;241;43m.^[[39;49m^[[43mformat^[[49m^[[43m(^[[49m^[[38;5;124;43m\"^[[39;49m^[[38;5;124;43mhudi^[[39;49m^[[38;5;124;43m\"^[[39;49m^[[43m)^[[49m^[[38;5;241;43m.^[[39;49m^[[43moptions^[[49m^[[43m(^[[49m^[[38;5;241;43m*^[[39;49m^[[38;5;241;43m*^[[39;49m^[[43mhudi_options^[[49m^[[43m)^[[49m^[[38;5;241;43m.^[[39;49m^[[43mmode^[[49m^[[43m(^[[49m^[[38;5;124;43m\"^[[39;49m^[[38;5;124;43moverwrite^[[39;49m^[[38;5;124;43m\"^[[39;49m^[[43m)^[[49m^[[38;5;241;43m.^[[39;49m^[[43msave^[[49m^[[43m(^[[49m^[[43mbasePath^[[49m^[[43m)^[[49m)\r\n\r\nFile ^[[0;32m~/Projects_Freelance/Fielmann/bi_kls_data_ocean_import/src/.venv/lib/python3.9/site-packages/pyspark/sql/readwriter.py:740^[[0m, in ^[[0;36mDataFrameWriter.save^[[0;34m(self, path, format, mode, partitionBy, **options)^[[0m\r\n^[[1;32m    738^[[0m     ^[[39mself^[[39m^[[39m.^[[39m_jwrite^[[39m.^[[39msave()\r\n^[[1;32m    739^[[0m ^[[39melse^[[39;00m:\r\n^[[0;32m--> 740^[[0m     ^[[39mself^[[39;49m^[[39m.^[[39;49m_jwrite^[[39m.^[[39;49msave(path)\r\n\r\nFile ^[[0;32m~/Projects_Freelance/Fielmann/bi_kls_data_ocean_import/src/.venv/lib/python3.9/site-packages/py4j/java_gateway.py:1321^[[0m, in ^[[0;36mJavaMember.__call__^[[0;34m(self, *args)^[[0m\r\n^[[1;32m   1315^[[0m command ^[[39m=^[[39m proto^[[39m.^[[39mCALL_COMMAND_NAME ^[[39m+^[[39m\\\r\n^[[1;32m   1316^[[0m     ^[[39mself^[[39m^[[39m.^[[39mcommand_header ^[[39m+^[[39m\\\r\n^[[1;32m   1317^[[0m     args_command ^[[39m+^[[39m\\\r\n^[[1;32m   1318^[[0m     proto^[[39m.^[[39mEND_COMMAND_PART\r\n^[[1;32m   1320^[[0m answer ^[[39m=^[[39m ^[[39mself^[[39m^[[39m.^[[39mgateway_client^[[39m.^[[39msend_command(command)\r\n^[[0;32m-> 1321^[[0m return_value ^[[39m=^[[39m get_return_value(\r\n^[[1;32m   1322^[[0m     answer, ^[[39mself^[[39;49m^[[39m.^[[39;49mgateway_client, ^[[39mself^[[39;49m^[[39m.^[[39;49mtarget_id, ^[[39mself^[[39;49m^[[39m.^[[39;49mname)\r\n^[[1;32m   1324^[[0m ^[[39mfor^[[39;00m temp_arg ^[[39min^[[39;00m temp_args:\r\n^[[1;32m   1325^[[0m     temp_arg^[[39m.^[[39m_detach()\r\n\r\nFile ^[[0;32m~/Projects_Freelance/Fielmann/bi_kls_data_ocean_import/src/.venv/lib/python3.9/site-packages/pyspark/sql/utils.py:111^[[0m, in ^[[0;36mcapture_sql_exception.<locals>.deco^[[0;34m(*a, **kw)^[[0m\r\n^[[1;32m    109^[[0m ^[[39mdef^[[39;00m ^[[39mdeco^[[39m(^[[39m*^[[39ma, ^[[39m*^[[39m^[[39m*^[[39mkw):\r\n^[[1;32m    110^[[0m     ^[[39mtry^[[39;00m:\r\n^[[0;32m--> 111^[[0m         ^[[39mreturn^[[39;00m f(^[[39m*^[[39;49ma, ^[[39m*^[[39;49m^[[39m*^[[39;49mkw)\r\n^[[1;32m    112^[[0m     ^[[39mexcept^[[39;00m py4j^[[39m.^[[39mprotocol^[[39m.^[[39mPy4JJavaError ^[[39mas^[[39;00m e:\r\n^[[1;32m    113^[[0m         converted ^[[39m=^[[39m convert_exception(e^[[39m.^[[39mjava_exception)\r\n\r\nFile ^[[0;32m~/Projects_Freelance/Fielmann/bi_kls_data_ocean_import/src/.venv/lib/python3.9/site-packages/py4j/protocol.py:326^[[0m, in ^[[0;36mget_return_value^[[0;34m(answer, gateway_client, target_id, name)^[[0m\r\n^[[1;32m    324^[[0m value ^[[39m=^[[39m OUTPUT_CONVERTER[^[[39mtype^[[39m](answer[^[[39m2^[[39m:], gateway_client)\r\n^[[1;32m    325^[[0m ^[[39mif^[[39;00m answer[^[[39m1^[[39m] ^[[39m==^[[39m REFERENCE_TYPE:\r\n^[[0;32m--> 326^[[0m     ^[[39mraise^[[39;00m Py4JJavaError(\r\n^[[1;32m    327^[[0m         ^[[39m\"^[[39m^[[39mAn error occurred while calling ^[[39m^[[39m{0}^[[39;00m^[[39m{1}^[[39;00m^[[39m{2}^[[39;00m^[[39m.^[[39m^[[39m\\n^[[39;00m^[[39m\"^[[39m^[[39m.^[[39m\r\n^[[1;32m    328^[[0m         ^[[39mformat^[[39m(target_id, ^[[39m\"^[[39m^[[39m.^[[39m^[[39m\"^[[39m, name), value)\r\n^[[1;32m    329^[[0m ^[[39melse^[[39;00m:\r\n^[[1;32m    330^[[0m     ^[[39mraise^[[39;00m Py4JError(\r\n^[[1;32m    331^[[0m         ^[[39m\"^[[39m^[[39mAn error occurred while calling ^[[39m^[[39m{0}^[[39;00m^[[39m{1}^[[39;00m^[[39m{2}^[[39;00m^[[39m. Trace:^[[39m^[[39m\\n^[[39;00m^[[39m{3}^[[39;00m^[[39m\\n^[[39;00m^[[39m\"^[[39m^[[39m.^[[39m\r\n^[[1;32m    332^[[0m         ^[[39mformat^[[39m(target_id, ^[[39m\"^[[39m^[[39m.^[[39m^[[39m\"^[[39m, name, value))\r\n\r\n^[[0;31mPy4JJavaError^[[0m: An error occurred while calling o217.save.\r\n: org.apache.hudi.exception.HoodieException: Could not sync using the meta sync class org.apache.hudi.hive.HiveSyncTool\r\n\tat org.apache.hudi.sync.common.util.SyncUtilHelpers.runHoodieMetaSync(SyncUtilHelpers.java:58)\r\n\tat org.apache.hudi.HoodieSparkSqlWriter$.$anonfun$metaSync$2(HoodieSparkSqlWriter.scala:648)\r\n\tat org.apache.hudi.HoodieSparkSqlWriter$.$anonfun$metaSync$2$adapted(HoodieSparkSqlWriter.scala:647)\r\n\tat scala.collection.mutable.HashSet.foreach(HashSet.scala:79)\r\n\tat org.apache.hudi.HoodieSparkSqlWriter$.metaSync(HoodieSparkSqlWriter.scala:647)\r\n\tat org.apache.hudi.HoodieSparkSqlWriter$.commitAndPerformPostOperations(HoodieSparkSqlWriter.scala:734)\r\n\tat org.apache.hudi.HoodieSparkSqlWriter$.write(HoodieSparkSqlWriter.scala:338)\r\n\tat org.apache.hudi.DefaultSource.createRelation(DefaultSource.scala:183)\r\n\tat org.apache.spark.sql.execution.datasources.SaveIntoDataSourceCommand.run(SaveIntoDataSourceCommand.scala:45)\r\n\tat org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult$lzycompute(commands.scala:75)\r\n\tat org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult(commands.scala:73)\r\n\tat org.apache.spark.sql.execution.command.ExecutedCommandExec.executeCollect(commands.scala:84)\r\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:110)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$5(SQLExecution.scala:103)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:163)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:90)\r\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:775)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:64)\r\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:110)\r\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:106)\r\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:481)\r\n\tat org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(TreeNode.scala:82)\r\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:481)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:30)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:30)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:30)\r\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:457)\r\n\tat org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:106)\r\n\tat org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:93)\r\n\tat org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:91)\r\n\tat org.apache.spark.sql.execution.QueryExecution.assertCommandExecuted(QueryExecution.scala:128)\r\n\tat org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:848)\r\n\tat org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:382)\r\n\tat org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:355)\r\n\tat org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:239)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.lang.reflect.Method.invoke(Method.java:498)\r\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\r\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\r\n\tat py4j.Gateway.invoke(Gateway.java:282)\r\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\r\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\r\n\tat py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\r\n\tat py4j.ClientServerConnection.run(ClientServerConnection.java:106)\r\n\tat java.lang.Thread.run(Thread.java:750)\r\nCaused by: org.apache.hudi.exception.HoodieException: Unable to instantiate class org.apache.hudi.hive.HiveSyncTool\r\n\tat org.apache.hudi.common.util.ReflectionUtils.loadClass(ReflectionUtils.java:91)\r\n\tat org.apache.hudi.sync.common.util.SyncUtilHelpers.instantiateMetaSyncTool(SyncUtilHelpers.java:75)\r\n\tat org.apache.hudi.sync.common.util.SyncUtilHelpers.runHoodieMetaSync(SyncUtilHelpers.java:56)\r\n\t... 48 more\r\nCaused by: java.lang.reflect.InvocationTargetException\r\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\r\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)\r\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\r\n\tat java.lang.reflect.Constructor.newInstance(Constructor.java:423)\r\n\tat org.apache.hudi.common.util.ReflectionUtils.loadClass(ReflectionUtils.java:89)\r\n\t... 50 more\r\nCaused by: org.apache.hudi.hive.HoodieHiveSyncException: Got runtime exception when hive syncing\r\n\tat org.apache.hudi.hive.HiveSyncTool.initSyncClient(HiveSyncTool.java:106)\r\n\tat org.apache.hudi.hive.HiveSyncTool.<init>(HiveSyncTool.java:95)\r\n\t... 55 more\r\nCaused by: org.apache.hudi.hive.HoodieHiveSyncException: Failed to create HiveMetaStoreClient\r\n\tat org.apache.hudi.hive.HoodieHiveSyncClient.<init>(HoodieHiveSyncClient.java:95)\r\n\tat org.apache.hudi.hive.HiveSyncTool.initSyncClient(HiveSyncTool.java:101)\r\n\t... 56 more\r\nCaused by: org.apache.hudi.hive.HoodieHiveSyncException: Cannot create hive connection jdbc:hive2://localhost:10000/\r\n\tat org.apache.hudi.hive.ddl.JDBCExecutor.createHiveConnection(JDBCExecutor.java:107)\r\n\tat org.apache.hudi.hive.ddl.JDBCExecutor.<init>(JDBCExecutor.java:59)\r\n\tat org.apache.hudi.hive.HoodieHiveSyncClient.<init>(HoodieHiveSyncClient.java:85)\r\n\t... 57 more\r\nCaused by: java.sql.SQLException: Could not open client transport with JDBC Uri: jdbc:hive2://localhost:10000: java.net.ConnectException: Connection refused (Connection refused)\r\n\tat org.apache.hive.jdbc.HiveConnection.<init>(HiveConnection.java:224)\r\n\tat org.apache.hive.jdbc.HiveDriver.connect(HiveDriver.java:107)\r\n\tat java.sql.DriverManager.getConnection(DriverManager.java:664)\r\n\tat java.sql.DriverManager.getConnection(DriverManager.java:247)\r\n\tat org.apache.hudi.hive.ddl.JDBCExecutor.createHiveConnection(JDBCExecutor.java:104)\r\n\t... 59 more\r\nCaused by: org.apache.thrift.transport.TTransportException: java.net.ConnectException: Connection refused (Connection refused)\r\n\tat org.apache.thrift.transport.TSocket.open(TSocket.java:226)\r\n\tat org.apache.thrift.transport.TSaslTransport.open(TSaslTransport.java:266)\r\n\tat org.apache.thrift.transport.TSaslClientTransport.open(TSaslClientTransport.java:38)\r\n\tat org.apache.hive.jdbc.HiveConnection.openTransport(HiveConnection.java:311)\r\n\tat org.apache.hive.jdbc.HiveConnection.<init>(HiveConnection.java:196)\r\n\t... 63 more\r\nCaused by: java.net.ConnectException: Connection refused (Connection refused)\r\n\tat java.net.PlainSocketImpl.socketConnect(Native Method)\r\n\tat java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)\r\n\tat java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)\r\n\tat java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)\r\n\tat java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)\r\n\tat java.net.Socket.connect(Socket.java:607)\r\n\tat org.apache.thrift.transport.TSocket.open(TSocket.java:221)\r\n\t... 67 more\r\n\r\n```","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1264629689/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1264701402","html_url":"https://github.com/apache/hudi/pull/6852#issuecomment-1264701402","issue_url":"https://api.github.com/repos/apache/hudi/issues/6852","id":1264701402,"node_id":"IC_kwDOBI7nWM5LYc_a","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-02T18:09:01Z","updated_at":"2022-10-02T18:09:01Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"8a6ef11a8c573fa3cd49217157a6a8bb7f112395\",\n    \"status\" : \"FAILURE\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11965\",\n    \"triggerID\" : \"8a6ef11a8c573fa3cd49217157a6a8bb7f112395\",\n    \"triggerType\" : \"PUSH\"\n  } ]\n}-->\n## CI report:\n\n* 8a6ef11a8c573fa3cd49217157a6a8bb7f112395 Azure: [FAILURE](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11965) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1264701402/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1264718033","html_url":"https://github.com/apache/hudi/pull/6851#issuecomment-1264718033","issue_url":"https://api.github.com/repos/apache/hudi/issues/6851","id":1264718033,"node_id":"IC_kwDOBI7nWM5LYhDR","user":{"login":"yihua","id":2497195,"node_id":"MDQ6VXNlcjI0OTcxOTU=","avatar_url":"https://avatars.githubusercontent.com/u/2497195?v=4","gravatar_id":"","url":"https://api.github.com/users/yihua","html_url":"https://github.com/yihua","followers_url":"https://api.github.com/users/yihua/followers","following_url":"https://api.github.com/users/yihua/following{/other_user}","gists_url":"https://api.github.com/users/yihua/gists{/gist_id}","starred_url":"https://api.github.com/users/yihua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yihua/subscriptions","organizations_url":"https://api.github.com/users/yihua/orgs","repos_url":"https://api.github.com/users/yihua/repos","events_url":"https://api.github.com/users/yihua/events{/privacy}","received_events_url":"https://api.github.com/users/yihua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-02T19:41:43Z","updated_at":"2022-10-02T19:41:43Z","author_association":"CONTRIBUTOR","body":"> @yihua thanks for looking into this. I think the user's problem can also be resolved by using `SlashEncodedDayPartitionValueExtractor` ? probably need to follow the [migration guide](https://hudi.apache.org/releases/release-0.12.0#configuration-updates)\r\n\r\nIf the date output format is “yyyy/MM/dd”, yes.  But we should also allow user to specify any format, e.g., “yyyyMM/dd/HH” or “MM/dd/yyyy”, which don’t have any corresponding partition extractor that works.  The new partition extractor addresses this problem.  Even for “yyyy/MM/dd”, there is no need to specify extractor after the fix.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1264718033/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1264882911","html_url":"https://github.com/apache/hudi/issues/6832#issuecomment-1264882911","issue_url":"https://api.github.com/repos/apache/hudi/issues/6832","id":1264882911,"node_id":"IC_kwDOBI7nWM5LZJTf","user":{"login":"dragonH","id":18332044,"node_id":"MDQ6VXNlcjE4MzMyMDQ0","avatar_url":"https://avatars.githubusercontent.com/u/18332044?v=4","gravatar_id":"","url":"https://api.github.com/users/dragonH","html_url":"https://github.com/dragonH","followers_url":"https://api.github.com/users/dragonH/followers","following_url":"https://api.github.com/users/dragonH/following{/other_user}","gists_url":"https://api.github.com/users/dragonH/gists{/gist_id}","starred_url":"https://api.github.com/users/dragonH/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dragonH/subscriptions","organizations_url":"https://api.github.com/users/dragonH/orgs","repos_url":"https://api.github.com/users/dragonH/repos","events_url":"https://api.github.com/users/dragonH/events{/privacy}","received_events_url":"https://api.github.com/users/dragonH/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-03T03:23:55Z","updated_at":"2022-10-03T03:23:55Z","author_association":"NONE","body":"hi @codope \r\n\r\nsure, wiil also do the latest hudi testing with EMR and share th result here\r\n\r\nthanks for the help\r\n\r\nhi @kazdy \r\n\r\nthanks for the help\r\n\r\ni acknowledge the behavior of aws glue that converting the table name and columns name to lowarcase\r\n\r\nbut was suprised that this casue the issue 😯\r\n\r\nafter converting the table name to lowarcase\r\n\r\nthe data was written successfully\r\n\r\n<img width=\"315\" alt=\"image\" src=\"https://user-images.githubusercontent.com/18332044/193495139-64ddc70d-1468-49c8-8772-ba7af43e80dc.png\">\r\n\r\njust curious the step of how hudi created and sync the table\r\n\r\ncause the we could see the table was created with the lowarcase name\r\n\r\nhow come it used the original name( with upper case) to find and compared the partition 🤔","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1264882911/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1264887516","html_url":"https://github.com/apache/hudi/pull/6003#issuecomment-1264887516","issue_url":"https://api.github.com/repos/apache/hudi/issues/6003","id":1264887516,"node_id":"IC_kwDOBI7nWM5LZKbc","user":{"login":"zhangyue19921010","id":69956021,"node_id":"MDQ6VXNlcjY5OTU2MDIx","avatar_url":"https://avatars.githubusercontent.com/u/69956021?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangyue19921010","html_url":"https://github.com/zhangyue19921010","followers_url":"https://api.github.com/users/zhangyue19921010/followers","following_url":"https://api.github.com/users/zhangyue19921010/following{/other_user}","gists_url":"https://api.github.com/users/zhangyue19921010/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangyue19921010/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangyue19921010/subscriptions","organizations_url":"https://api.github.com/users/zhangyue19921010/orgs","repos_url":"https://api.github.com/users/zhangyue19921010/repos","events_url":"https://api.github.com/users/zhangyue19921010/events{/privacy}","received_events_url":"https://api.github.com/users/zhangyue19921010/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-03T03:31:41Z","updated_at":"2022-10-03T03:31:41Z","author_association":"CONTRIBUTOR","body":"Hi @yihua and @pratyakshsharma . Really appreciate for your attention here! Address the comments. PTAL :)","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1264887516/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1264932668","html_url":"https://github.com/apache/hudi/pull/6732#issuecomment-1264932668","issue_url":"https://api.github.com/repos/apache/hudi/issues/6732","id":1264932668,"node_id":"IC_kwDOBI7nWM5LZVc8","user":{"login":"xushiyan","id":2701446,"node_id":"MDQ6VXNlcjI3MDE0NDY=","avatar_url":"https://avatars.githubusercontent.com/u/2701446?v=4","gravatar_id":"","url":"https://api.github.com/users/xushiyan","html_url":"https://github.com/xushiyan","followers_url":"https://api.github.com/users/xushiyan/followers","following_url":"https://api.github.com/users/xushiyan/following{/other_user}","gists_url":"https://api.github.com/users/xushiyan/gists{/gist_id}","starred_url":"https://api.github.com/users/xushiyan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xushiyan/subscriptions","organizations_url":"https://api.github.com/users/xushiyan/orgs","repos_url":"https://api.github.com/users/xushiyan/repos","events_url":"https://api.github.com/users/xushiyan/events{/privacy}","received_events_url":"https://api.github.com/users/xushiyan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-03T04:50:44Z","updated_at":"2022-10-03T04:50:44Z","author_association":"MEMBER","body":"@yuzhaojing please also fill up the PR description properly. as discussed, a class diagram to show the new hierarchy expedites the review.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1264932668/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1264943872","html_url":"https://github.com/apache/hudi/issues/6281#issuecomment-1264943872","issue_url":"https://api.github.com/repos/apache/hudi/issues/6281","id":1264943872,"node_id":"IC_kwDOBI7nWM5LZYMA","user":{"login":"xushiyan","id":2701446,"node_id":"MDQ6VXNlcjI3MDE0NDY=","avatar_url":"https://avatars.githubusercontent.com/u/2701446?v=4","gravatar_id":"","url":"https://api.github.com/users/xushiyan","html_url":"https://github.com/xushiyan","followers_url":"https://api.github.com/users/xushiyan/followers","following_url":"https://api.github.com/users/xushiyan/following{/other_user}","gists_url":"https://api.github.com/users/xushiyan/gists{/gist_id}","starred_url":"https://api.github.com/users/xushiyan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xushiyan/subscriptions","organizations_url":"https://api.github.com/users/xushiyan/orgs","repos_url":"https://api.github.com/users/xushiyan/repos","events_url":"https://api.github.com/users/xushiyan/events{/privacy}","received_events_url":"https://api.github.com/users/xushiyan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-03T05:12:02Z","updated_at":"2022-10-03T05:12:02Z","author_association":"MEMBER","body":"@crutis closing this as explained by @yihua . let us know how it works","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1264943872/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1264955767","html_url":"https://github.com/apache/hudi/pull/6852#issuecomment-1264955767","issue_url":"https://api.github.com/repos/apache/hudi/issues/6852","id":1264955767,"node_id":"IC_kwDOBI7nWM5LZbF3","user":{"login":"xushiyan","id":2701446,"node_id":"MDQ6VXNlcjI3MDE0NDY=","avatar_url":"https://avatars.githubusercontent.com/u/2701446?v=4","gravatar_id":"","url":"https://api.github.com/users/xushiyan","html_url":"https://github.com/xushiyan","followers_url":"https://api.github.com/users/xushiyan/followers","following_url":"https://api.github.com/users/xushiyan/following{/other_user}","gists_url":"https://api.github.com/users/xushiyan/gists{/gist_id}","starred_url":"https://api.github.com/users/xushiyan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xushiyan/subscriptions","organizations_url":"https://api.github.com/users/xushiyan/orgs","repos_url":"https://api.github.com/users/xushiyan/repos","events_url":"https://api.github.com/users/xushiyan/events{/privacy}","received_events_url":"https://api.github.com/users/xushiyan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-03T05:30:19Z","updated_at":"2022-10-03T05:30:19Z","author_association":"MEMBER","body":"Test fix works. CI failure is irrelevant. Landing this.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1264955767/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1265036326","html_url":"https://github.com/apache/hudi/issues/6832#issuecomment-1265036326","issue_url":"https://api.github.com/repos/apache/hudi/issues/6832","id":1265036326,"node_id":"IC_kwDOBI7nWM5LZuwm","user":{"login":"kazdy","id":27806231,"node_id":"MDQ6VXNlcjI3ODA2MjMx","avatar_url":"https://avatars.githubusercontent.com/u/27806231?v=4","gravatar_id":"","url":"https://api.github.com/users/kazdy","html_url":"https://github.com/kazdy","followers_url":"https://api.github.com/users/kazdy/followers","following_url":"https://api.github.com/users/kazdy/following{/other_user}","gists_url":"https://api.github.com/users/kazdy/gists{/gist_id}","starred_url":"https://api.github.com/users/kazdy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kazdy/subscriptions","organizations_url":"https://api.github.com/users/kazdy/orgs","repos_url":"https://api.github.com/users/kazdy/repos","events_url":"https://api.github.com/users/kazdy/events{/privacy}","received_events_url":"https://api.github.com/users/kazdy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-03T07:20:57Z","updated_at":"2022-10-03T08:11:29Z","author_association":"CONTRIBUTOR","body":"Btw on emr you'll get the same error because the glue client is the same. I got this error when running hudi on emr.\r\n\r\n> just curious the step of how hudi created and sync the table\r\n> cause the we could see the table was created with the lowarcase name\r\n\r\nhudi created table using original name, glue data catalog converted it to lowercase, hudi is not aware that table name was converted, first sync should succeed.\r\n\r\n> how come it used the original name( with upper case) to find and compared the partition 🤔\r\n\r\n`checkArgument(tbl.getDbName().equals(partition.getDbName())`\r\n\r\nhere one comes from hudi options with upper case, another is pulled from glue data catalog lowercase, that's why it doesn't work, you can read that code and  it'll become clear how this works\r\n\r\n\r\n\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1265036326/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1265049923","html_url":"https://github.com/apache/hudi/issues/6718#issuecomment-1265049923","issue_url":"https://api.github.com/repos/apache/hudi/issues/6718","id":1265049923,"node_id":"IC_kwDOBI7nWM5LZyFD","user":{"login":"hkszn","id":113899902,"node_id":"U_kgDOBsn5fg","avatar_url":"https://avatars.githubusercontent.com/u/113899902?v=4","gravatar_id":"","url":"https://api.github.com/users/hkszn","html_url":"https://github.com/hkszn","followers_url":"https://api.github.com/users/hkszn/followers","following_url":"https://api.github.com/users/hkszn/following{/other_user}","gists_url":"https://api.github.com/users/hkszn/gists{/gist_id}","starred_url":"https://api.github.com/users/hkszn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hkszn/subscriptions","organizations_url":"https://api.github.com/users/hkszn/orgs","repos_url":"https://api.github.com/users/hkszn/repos","events_url":"https://api.github.com/users/hkszn/events{/privacy}","received_events_url":"https://api.github.com/users/hkszn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-03T07:35:40Z","updated_at":"2022-10-03T07:35:40Z","author_association":"NONE","body":"Thank you for your reply.\r\n\r\n> If you are interested, I can guide you on how to achieve this.\r\n\r\nYes, I would like to try it.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1265049923/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1265226296","html_url":"https://github.com/apache/hudi/issues/6832#issuecomment-1265226296","issue_url":"https://api.github.com/repos/apache/hudi/issues/6832","id":1265226296,"node_id":"IC_kwDOBI7nWM5LadI4","user":{"login":"dragonH","id":18332044,"node_id":"MDQ6VXNlcjE4MzMyMDQ0","avatar_url":"https://avatars.githubusercontent.com/u/18332044?v=4","gravatar_id":"","url":"https://api.github.com/users/dragonH","html_url":"https://github.com/dragonH","followers_url":"https://api.github.com/users/dragonH/followers","following_url":"https://api.github.com/users/dragonH/following{/other_user}","gists_url":"https://api.github.com/users/dragonH/gists{/gist_id}","starred_url":"https://api.github.com/users/dragonH/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dragonH/subscriptions","organizations_url":"https://api.github.com/users/dragonH/orgs","repos_url":"https://api.github.com/users/dragonH/repos","events_url":"https://api.github.com/users/dragonH/events{/privacy}","received_events_url":"https://api.github.com/users/dragonH/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-03T10:12:59Z","updated_at":"2022-10-03T10:12:59Z","author_association":"NONE","body":"@kazdy thanks for the information!\r\n\r\nwonder if there's better way to avoid this kind of issue\r\n\r\ne.g.\r\n\r\n- add a new config property `AWSGlueDataCataglogEnabled` and if it set as `True`, convert the table name to lowercase at the begin and at the rest\r\n\r\n- or edit the `table-name-related` config property hint to highlight this (if using aws glue data catalog, table name sould be lowercase)\r\n\r\ncause the original one and the exception raised could not really tell about this\r\n\r\nthanks for your help !","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1265226296/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1265279684","html_url":"https://github.com/apache/hudi/pull/6846#issuecomment-1265279684","issue_url":"https://api.github.com/repos/apache/hudi/issues/6846","id":1265279684,"node_id":"IC_kwDOBI7nWM5LaqLE","user":{"login":"pramodbiligiri","id":759691,"node_id":"MDQ6VXNlcjc1OTY5MQ==","avatar_url":"https://avatars.githubusercontent.com/u/759691?v=4","gravatar_id":"","url":"https://api.github.com/users/pramodbiligiri","html_url":"https://github.com/pramodbiligiri","followers_url":"https://api.github.com/users/pramodbiligiri/followers","following_url":"https://api.github.com/users/pramodbiligiri/following{/other_user}","gists_url":"https://api.github.com/users/pramodbiligiri/gists{/gist_id}","starred_url":"https://api.github.com/users/pramodbiligiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pramodbiligiri/subscriptions","organizations_url":"https://api.github.com/users/pramodbiligiri/orgs","repos_url":"https://api.github.com/users/pramodbiligiri/repos","events_url":"https://api.github.com/users/pramodbiligiri/events{/privacy}","received_events_url":"https://api.github.com/users/pramodbiligiri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-03T11:06:02Z","updated_at":"2022-10-03T11:06:02Z","author_association":"CONTRIBUTOR","body":"Tested that this build worked locally. Built this branch as follows and ran the sync. Results after sync pasted down below.\r\nBuild:\r\n$ mvn -DskipTests -Dspark3.2 -Dscala-2.12 -Dcheckstyle.skip -Drat.skip clean install\r\n\r\nTesting the sync (each file has 10 records):\r\n```\r\nBefore Sync:\r\nselect max(id) from gcs_data;\r\n\r\n+--------+\r\n|  _c0   |\r\n+--------+\r\n| 20370  |\r\n+--------+\r\n\r\nselect max(name) from gcs_meta_hive;\r\n+----------------------------------+\r\n|               _c0                |\r\n+----------------------------------+\r\n| country=IN/data-file-2040.jsonl  |\r\n+----------------------------------+\r\n\r\n\r\nAfter Sync:\r\nselect max(id) from gcs_data;\r\n+--------+\r\n|  _c0   |\r\n+--------+\r\n| 20450  |\r\n+--------+\r\n\r\nselect max(name) from gcs_meta_hive;\r\n+----------------------------------+\r\n|               _c0                |\r\n+----------------------------------+\r\n| country=IN/data-file-2045.jsonl  |\r\n+----------------------------------+\r\n```","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1265279684/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1265613884","html_url":"https://github.com/apache/hudi/issues/6332#issuecomment-1265613884","issue_url":"https://api.github.com/repos/apache/hudi/issues/6332","id":1265613884,"node_id":"IC_kwDOBI7nWM5Lb7w8","user":{"login":"codope","id":16440354,"node_id":"MDQ6VXNlcjE2NDQwMzU0","avatar_url":"https://avatars.githubusercontent.com/u/16440354?v=4","gravatar_id":"","url":"https://api.github.com/users/codope","html_url":"https://github.com/codope","followers_url":"https://api.github.com/users/codope/followers","following_url":"https://api.github.com/users/codope/following{/other_user}","gists_url":"https://api.github.com/users/codope/gists{/gist_id}","starred_url":"https://api.github.com/users/codope/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codope/subscriptions","organizations_url":"https://api.github.com/users/codope/orgs","repos_url":"https://api.github.com/users/codope/repos","events_url":"https://api.github.com/users/codope/events{/privacy}","received_events_url":"https://api.github.com/users/codope/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-03T15:10:17Z","updated_at":"2022-10-03T15:10:17Z","author_association":"MEMBER","body":"Synced up with @pratyakshsharma regarding this issue. First of all, the issue affects hudi tables queries via presto-hive connector. We need to see if we can use the config provided by the engine itself while instantiating the meta client. Created HUDI-4974 to track that issue. For now, we have a mitigation. We will unwrap the wrapper config object and pass that. \r\n\r\nClosing the issue as it has been triaged and we have an interim solution.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1265613884/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1265637355","html_url":"https://github.com/apache/hudi/pull/6857#issuecomment-1265637355","issue_url":"https://api.github.com/repos/apache/hudi/issues/6857","id":1265637355,"node_id":"IC_kwDOBI7nWM5LcBfr","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-03T15:24:30Z","updated_at":"2022-10-03T15:24:30Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"d4f9276e7a3802fb2df5c3b7e28c224e4a1e7f15\",\n    \"status\" : \"SUCCESS\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11974\",\n    \"triggerID\" : \"d4f9276e7a3802fb2df5c3b7e28c224e4a1e7f15\",\n    \"triggerType\" : \"PUSH\"\n  } ]\n}-->\n## CI report:\n\n* d4f9276e7a3802fb2df5c3b7e28c224e4a1e7f15 Azure: [SUCCESS](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=11974) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1265637355/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1265709727","html_url":"https://github.com/apache/hudi/pull/6858#issuecomment-1265709727","issue_url":"https://api.github.com/repos/apache/hudi/issues/6858","id":1265709727,"node_id":"IC_kwDOBI7nWM5LcTKf","user":{"login":"wqwl611","id":67826098,"node_id":"MDQ6VXNlcjY3ODI2MDk4","avatar_url":"https://avatars.githubusercontent.com/u/67826098?v=4","gravatar_id":"","url":"https://api.github.com/users/wqwl611","html_url":"https://github.com/wqwl611","followers_url":"https://api.github.com/users/wqwl611/followers","following_url":"https://api.github.com/users/wqwl611/following{/other_user}","gists_url":"https://api.github.com/users/wqwl611/gists{/gist_id}","starred_url":"https://api.github.com/users/wqwl611/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wqwl611/subscriptions","organizations_url":"https://api.github.com/users/wqwl611/orgs","repos_url":"https://api.github.com/users/wqwl611/repos","events_url":"https://api.github.com/users/wqwl611/events{/privacy}","received_events_url":"https://api.github.com/users/wqwl611/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-03T16:21:14Z","updated_at":"2022-10-03T16:21:14Z","author_association":"CONTRIBUTOR","body":"I accidentally deleted my previous fork, so I opened a new PR, and modified the code according to the previous review requirements, please help me review it，thanks.\r\n@danny0405 @YuweiXiao @xushiyan @alexeykudinkin ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1265709727/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1265711269","html_url":"https://github.com/apache/hudi/pull/6636#issuecomment-1265711269","issue_url":"https://api.github.com/repos/apache/hudi/issues/6636","id":1265711269,"node_id":"IC_kwDOBI7nWM5LcTil","user":{"login":"wqwl611","id":67826098,"node_id":"MDQ6VXNlcjY3ODI2MDk4","avatar_url":"https://avatars.githubusercontent.com/u/67826098?v=4","gravatar_id":"","url":"https://api.github.com/users/wqwl611","html_url":"https://github.com/wqwl611","followers_url":"https://api.github.com/users/wqwl611/followers","following_url":"https://api.github.com/users/wqwl611/following{/other_user}","gists_url":"https://api.github.com/users/wqwl611/gists{/gist_id}","starred_url":"https://api.github.com/users/wqwl611/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wqwl611/subscriptions","organizations_url":"https://api.github.com/users/wqwl611/orgs","repos_url":"https://api.github.com/users/wqwl611/repos","events_url":"https://api.github.com/users/wqwl611/events{/privacy}","received_events_url":"https://api.github.com/users/wqwl611/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-03T16:22:31Z","updated_at":"2022-10-03T16:22:52Z","author_association":"CONTRIBUTOR","body":"I accidentally deleted my previous fork, so I opened a new PR, and modified the code according to the previous review requirements, please help me review it，thanks.\r\n@danny0405 @YuweiXiao @xushiyan @alexeykudinkin \r\nnew PR: https://github.com/apache/hudi/pull/6858","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1265711269/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]