[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/937964572","html_url":"https://github.com/apache/iceberg/issues/3243#issuecomment-937964572","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3243","id":937964572,"node_id":"IC_kwDOCW7NX8436DQc","user":{"login":"snazy","id":957468,"node_id":"MDQ6VXNlcjk1NzQ2OA==","avatar_url":"https://avatars.githubusercontent.com/u/957468?v=4","gravatar_id":"","url":"https://api.github.com/users/snazy","html_url":"https://github.com/snazy","followers_url":"https://api.github.com/users/snazy/followers","following_url":"https://api.github.com/users/snazy/following{/other_user}","gists_url":"https://api.github.com/users/snazy/gists{/gist_id}","starred_url":"https://api.github.com/users/snazy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/snazy/subscriptions","organizations_url":"https://api.github.com/users/snazy/orgs","repos_url":"https://api.github.com/users/snazy/repos","events_url":"https://api.github.com/users/snazy/events{/privacy}","received_events_url":"https://api.github.com/users/snazy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-07T16:35:01Z","updated_at":"2021-10-07T16:35:01Z","author_association":"MEMBER","body":"Yup, Have a working branch in my Iceberg fork for Nessie 1.0.0","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/937964572/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/937992068","html_url":"https://github.com/apache/iceberg/pull/3239#issuecomment-937992068","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3239","id":937992068,"node_id":"IC_kwDOCW7NX8436J-E","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-07T17:12:13Z","updated_at":"2021-10-07T17:12:13Z","author_association":"CONTRIBUTOR","body":"My current understanding is that we will no longer add new features to the legacy python package, any thoughts about this support? @jun-he","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/937992068/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/937992096","html_url":"https://github.com/apache/iceberg/pull/2935#issuecomment-937992096","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2935","id":937992096,"node_id":"IC_kwDOCW7NX8436J-g","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-07T17:12:15Z","updated_at":"2021-10-07T17:12:15Z","author_association":"CONTRIBUTOR","body":"> btw, I also feel we don't need to move those GenericOrcReader(s) and GenericOrcWriter(s) in this adding delete writer PR in case of making more conflicts when cherry-pick in into people's own repo.\r\n\r\nORC java needs to access GenericOrcReader, and `iceberg-data` already depends on `iceberg-orc`, `iceberg-parquet`. To solve this problem I have to move the classes. The added benefit is that the layout is the same as for the Parquet.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/937992096/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/938043394","html_url":"https://github.com/apache/iceberg/pull/3188#issuecomment-938043394","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3188","id":938043394,"node_id":"IC_kwDOCW7NX8436WgC","user":{"login":"anjalinorwood","id":52180099,"node_id":"MDQ6VXNlcjUyMTgwMDk5","avatar_url":"https://avatars.githubusercontent.com/u/52180099?v=4","gravatar_id":"","url":"https://api.github.com/users/anjalinorwood","html_url":"https://github.com/anjalinorwood","followers_url":"https://api.github.com/users/anjalinorwood/followers","following_url":"https://api.github.com/users/anjalinorwood/following{/other_user}","gists_url":"https://api.github.com/users/anjalinorwood/gists{/gist_id}","starred_url":"https://api.github.com/users/anjalinorwood/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/anjalinorwood/subscriptions","organizations_url":"https://api.github.com/users/anjalinorwood/orgs","repos_url":"https://api.github.com/users/anjalinorwood/repos","events_url":"https://api.github.com/users/anjalinorwood/events{/privacy}","received_events_url":"https://api.github.com/users/anjalinorwood/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-07T18:21:20Z","updated_at":"2021-10-07T18:21:20Z","author_association":"CONTRIBUTOR","body":"I take it that we are driving towards consensus. @jzhuge will take this forward with the PR for implementation (as well address any outstanding comments).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/938043394/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/938177902","html_url":"https://github.com/apache/iceberg/pull/3239#issuecomment-938177902","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3239","id":938177902,"node_id":"IC_kwDOCW7NX84363Vu","user":{"login":"jun-he","id":12246263,"node_id":"MDQ6VXNlcjEyMjQ2MjYz","avatar_url":"https://avatars.githubusercontent.com/u/12246263?v=4","gravatar_id":"","url":"https://api.github.com/users/jun-he","html_url":"https://github.com/jun-he","followers_url":"https://api.github.com/users/jun-he/followers","following_url":"https://api.github.com/users/jun-he/following{/other_user}","gists_url":"https://api.github.com/users/jun-he/gists{/gist_id}","starred_url":"https://api.github.com/users/jun-he/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jun-he/subscriptions","organizations_url":"https://api.github.com/users/jun-he/orgs","repos_url":"https://api.github.com/users/jun-he/repos","events_url":"https://api.github.com/users/jun-he/events{/privacy}","received_events_url":"https://api.github.com/users/jun-he/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-07T21:44:36Z","updated_at":"2021-10-07T21:44:36Z","author_association":"COLLABORATOR","body":"Agree with @jackye1995\r\n@joshuarobinson is it OK to directly add this support to the current python library instead of legacy one?\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/938177902/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/938223622","html_url":"https://github.com/apache/iceberg/pull/3188#issuecomment-938223622","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3188","id":938223622,"node_id":"IC_kwDOCW7NX8437CgG","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-07T23:24:34Z","updated_at":"2021-10-07T23:24:34Z","author_association":"CONTRIBUTOR","body":"@jacques-n, thanks for the example. I was going to ask for one to clarify about SQL resolution but you added one first!\r\n\r\n> What is expected behavior in the case of a Iceberg view?\r\n\r\nThis is a case I hadn't considered much because I thought that table resolution would not change based on the existence of tables.\r\n\r\nThe resolution in Trino never has this case because it always needs 3 parts:\r\n* If there are 3 parts, they are (catalog, schema, table)\r\n* If there are 2 parts, they are (schema, table) and the current catalog is used\r\n* If there is 1 part, it is the table and the current catalog and schema are used\r\n\r\nWe also specifically avoided this ambiguity in Spark when building the multi-part identifier support. We created rules so that there is only ever one way to resolve a table reference:\r\n1. If the name is a single identifier, use it as the table name, use the current catalog, and current namespace from the session.\r\n    (Otherwise, the name is multiple parts)\r\n2. If the first part is a catalog, use that catalog. Use the last identifier part as the table name and any remaining parts as the namespace.\r\n3. If the first part is not a catalog, use the current catalog from the session. Use the last identifier part as the table name and the remaining parts (including the first that was not a catalog) as the namespace.\r\n\r\nFor a fixed set of catalogs, these rules provide an unambiguous table reference. There is some ambiguity if the set of catalogs changes, but that's a rare event because it is something done primarily by admins rather than individual users (like creating tables). We decided against the idea of falling back to trying the other branch if using rule 2 or rule 3 failed to load a table.\r\n\r\nFor the view spec, we have tried to keep enough information that resolution is always done the same way. That's why the current catalog and namespace are stored as part of the view definition. We could also store the set of catalogs defined, but if there are some SQL systems that don't have an unambiguous resolution (meaning not based on the existence of _tables_) then it might not matter and we should decide how to handle it.\r\n\r\nThe argument against requiring a resolved plan is that it may not be possible to produce one. I think Spark in particular used to store resolved plans but gave up on being able to produce them at all. They're also much longer and tended to cause views to break by being truncated in a database column even faster. And if we have a substrait plan, we probably don't need the resolved SQL.\r\n\r\nI think my preference is to allow storing multiple optional representations. We know that we will need the original SQL for SQL-configured views. And we know that storing a standard query plan (like Substrait) is preferred in the long term over even a resolved SQL string because of dialect problems. Since even the SQL may be optional for views created directly as portable plans, I think it makes sense to make all of these representations possible and optional.\r\n\r\nThis is looking more like @jackye1995's original suggestion to be able to store different SQL for a given dialect. Maybe we should reconsider that.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/938223622/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/938280504","html_url":"https://github.com/apache/iceberg/issues/3115#issuecomment-938280504","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3115","id":938280504,"node_id":"IC_kwDOCW7NX8437QY4","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-08T02:06:37Z","updated_at":"2021-10-08T02:06:37Z","author_association":"MEMBER","body":"Linked to the [mail list discussion](https://lists.apache.org/x/thread.html/r6adba306a593c6c036ed8cce9af9fb4cde831e2b11e744375ca341ea@%3Cdev.iceberg.apache.org%3E): \r\n\r\n> Thanks for the context on the Flink side! I think it sounds reasonable to\r\nkeep up to date with the latest supported Flink version. If we want, we\r\ncould later go with something similar to what we do for Spark but we’ll see\r\nhow it goes and what the Flink community needs. We should probably add a\r\nsection to our Flink docs that explains and links to Flink’s support policy\r\nand has a table of Iceberg versions that work with Flink versions. (We\r\nshould probably have the same table for Spark, too!)\r\n>\r\n> For Spark, I’m also leaning toward the modified option 3 where we keep all\r\nof the code in the main repository but only build with one module at a time\r\nby default. It makes sense to switch based on modules — rather than\r\nselecting src paths within a module — so that it is easy to run a build\r\nwith all modules if you choose to — for example, when building release\r\nbinaries.\r\n>\r\n> The reason I think we should go with option 3 is for testing. If we have a\r\nsingle repo with api, core, etc. and spark then changes to the common\r\nmodules can be tested by CI actions. Updates to individual Spark modules\r\nwould be completely independent. There is a slight inconvenience that when\r\nan API used by Spark changes, the author would still need to fix multiple\r\nSpark versions. But the trade-off is that with a separate repository like\r\noption 2, changes that break Spark versions are not caught and then the\r\nSpark repository’s CI ends up failing on completely unrelated changes. That\r\nwould be a major pain, felt by everyone contributing to the Spark\r\nintegration, so I think option 3 is the best path forward.\r\n>\r\n> It sounds like we probably have some agreement now, but please speak up if\r\nyou think another option would be better.\r\n>\r\n> The next step is to prototype the build changes to test out option 3. Or if\r\nyou prefer option 2, then prototype those changes as well. I think that\r\nAnton is planning to do this, but if you have time and the desire to do it\r\nplease reach out and coordinate with us!\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/938280504/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/938351489","html_url":"https://github.com/apache/iceberg/pull/3242#issuecomment-938351489","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3242","id":938351489,"node_id":"IC_kwDOCW7NX8437huB","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-08T05:17:46Z","updated_at":"2021-10-08T05:17:46Z","author_association":"CONTRIBUTOR","body":"Thanks for the patch @tprelle! \r\nCould you please add a unit test to the PR, which is failing before the change, and fixed by the changes? This could prevent later regressions.\r\n\r\nThanks, Peter \r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/938351489/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/938378645","html_url":"https://github.com/apache/iceberg/pull/2935#issuecomment-938378645","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2935","id":938378645,"node_id":"IC_kwDOCW7NX8437oWV","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-08T06:24:05Z","updated_at":"2021-10-08T06:24:05Z","author_association":"MEMBER","body":"@pvary Thanks for the work, I think I will take another round for this tomorrow !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/938378645/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/938388781","html_url":"https://github.com/apache/iceberg/pull/3239#issuecomment-938388781","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3239","id":938388781,"node_id":"IC_kwDOCW7NX8437q0t","user":{"login":"joshuarobinson","id":3334099,"node_id":"MDQ6VXNlcjMzMzQwOTk=","avatar_url":"https://avatars.githubusercontent.com/u/3334099?v=4","gravatar_id":"","url":"https://api.github.com/users/joshuarobinson","html_url":"https://github.com/joshuarobinson","followers_url":"https://api.github.com/users/joshuarobinson/followers","following_url":"https://api.github.com/users/joshuarobinson/following{/other_user}","gists_url":"https://api.github.com/users/joshuarobinson/gists{/gist_id}","starred_url":"https://api.github.com/users/joshuarobinson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/joshuarobinson/subscriptions","organizations_url":"https://api.github.com/users/joshuarobinson/orgs","repos_url":"https://api.github.com/users/joshuarobinson/repos","events_url":"https://api.github.com/users/joshuarobinson/events{/privacy}","received_events_url":"https://api.github.com/users/joshuarobinson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-08T06:46:54Z","updated_at":"2021-10-08T06:46:54Z","author_association":"CONTRIBUTOR","body":"Yes, I'm totally fine with adding to the new library instead of the legacy one.\r\n\r\nIn the meantime, I can just keep this patch locally and unblock myself.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/938388781/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/938415167","html_url":"https://github.com/apache/iceberg/pull/3213#issuecomment-938415167","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3213","id":938415167,"node_id":"IC_kwDOCW7NX8437xQ_","user":{"login":"myandpr","id":20159351,"node_id":"MDQ6VXNlcjIwMTU5MzUx","avatar_url":"https://avatars.githubusercontent.com/u/20159351?v=4","gravatar_id":"","url":"https://api.github.com/users/myandpr","html_url":"https://github.com/myandpr","followers_url":"https://api.github.com/users/myandpr/followers","following_url":"https://api.github.com/users/myandpr/following{/other_user}","gists_url":"https://api.github.com/users/myandpr/gists{/gist_id}","starred_url":"https://api.github.com/users/myandpr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/myandpr/subscriptions","organizations_url":"https://api.github.com/users/myandpr/orgs","repos_url":"https://api.github.com/users/myandpr/repos","events_url":"https://api.github.com/users/myandpr/events{/privacy}","received_events_url":"https://api.github.com/users/myandpr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-08T07:35:31Z","updated_at":"2021-10-08T07:35:31Z","author_association":"CONTRIBUTOR","body":"> I'll take a look. The first thing is separating the features into different PRs. Can you open a PR for auto-compaction and one for automatic expiration?\r\n\r\n@rdblue I’m on vacation and can’t connect to github, so the reply is a bit slow. I think you are right, and  I have separated this PR into auto compaction PR and expire snapshot PR. This PR is for  'suto compact small files', and I will commit a new PR 'expire snapshot' later.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/938415167/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/938539818","html_url":"https://github.com/apache/iceberg/issues/3247#issuecomment-938539818","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3247","id":938539818,"node_id":"IC_kwDOCW7NX8438Psq","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-08T10:42:43Z","updated_at":"2021-10-08T10:42:43Z","author_association":"CONTRIBUTOR","body":"There are some missing feature in the Hive API. Especially in 2.x, but even in 3.x which prevented us to provide alter table support for Hive tables in Iceberg code.\r\n\r\nThat said there is an implementation in the Hive master which allows some of the `ALTER` functionality.\r\nhttps://github.com/apache/hive/blob/master/iceberg/iceberg-handler/src/main/java/org/apache/iceberg/mr/hive/HiveIcebergMetaHook.java#L96-L99\r\n```\r\n  static final EnumSet<AlterTableType> SUPPORTED_ALTER_OPS = EnumSet.of(\r\n      AlterTableType.ADDCOLS, AlterTableType.REPLACE_COLUMNS, AlterTableType.RENAME_COLUMN,\r\n      AlterTableType.ADDPROPS, AlterTableType.DROPPROPS, AlterTableType.SETPARTITIONSPEC,\r\n      AlterTableType.UPDATE_COLUMNS);\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/938539818/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/938563848","html_url":"https://github.com/apache/iceberg/pull/2680#issuecomment-938563848","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2680","id":938563848,"node_id":"IC_kwDOCW7NX8438VkI","user":{"login":"coolderli","id":38486782,"node_id":"MDQ6VXNlcjM4NDg2Nzgy","avatar_url":"https://avatars.githubusercontent.com/u/38486782?v=4","gravatar_id":"","url":"https://api.github.com/users/coolderli","html_url":"https://github.com/coolderli","followers_url":"https://api.github.com/users/coolderli/followers","following_url":"https://api.github.com/users/coolderli/following{/other_user}","gists_url":"https://api.github.com/users/coolderli/gists{/gist_id}","starred_url":"https://api.github.com/users/coolderli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coolderli/subscriptions","organizations_url":"https://api.github.com/users/coolderli/orgs","repos_url":"https://api.github.com/users/coolderli/repos","events_url":"https://api.github.com/users/coolderli/events{/privacy}","received_events_url":"https://api.github.com/users/coolderli/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-08T11:24:02Z","updated_at":"2021-10-08T11:24:02Z","author_association":"CONTRIBUTOR","body":"@openinx Using RocksDB can really solve the oom problem. But will it make things more complicated？Do users need to participate in the tuning of RocksDB?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/938563848/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/938580907","html_url":"https://github.com/apache/iceberg/pull/3249#issuecomment-938580907","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3249","id":938580907,"node_id":"IC_kwDOCW7NX8438Zur","user":{"login":"ConeyLiu","id":12733256,"node_id":"MDQ6VXNlcjEyNzMzMjU2","avatar_url":"https://avatars.githubusercontent.com/u/12733256?v=4","gravatar_id":"","url":"https://api.github.com/users/ConeyLiu","html_url":"https://github.com/ConeyLiu","followers_url":"https://api.github.com/users/ConeyLiu/followers","following_url":"https://api.github.com/users/ConeyLiu/following{/other_user}","gists_url":"https://api.github.com/users/ConeyLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/ConeyLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ConeyLiu/subscriptions","organizations_url":"https://api.github.com/users/ConeyLiu/orgs","repos_url":"https://api.github.com/users/ConeyLiu/repos","events_url":"https://api.github.com/users/ConeyLiu/events{/privacy}","received_events_url":"https://api.github.com/users/ConeyLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-08T11:53:00Z","updated_at":"2021-10-08T11:53:00Z","author_association":"CONTRIBUTOR","body":"Hi @rdblue @jackye1995 @nastra, could you help to review this? thanks a lot.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/938580907/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/938588591","html_url":"https://github.com/apache/iceberg/pull/3249#issuecomment-938588591","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3249","id":938588591,"node_id":"IC_kwDOCW7NX8438bmv","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-08T12:05:30Z","updated_at":"2021-10-08T12:05:30Z","author_association":"CONTRIBUTOR","body":"@ConeyLiu I'll try to review this next week. In the meantime could you please run some [benchmarks](https://iceberg.apache.org/benchmarks/) for this PR and attach the results here?\r\n\r\nSo in your case it would be: `./gradlew :iceberg-spark3:jmh -PjmhIncludeRegex=VectorizedReadFlatParquetDataBenchmark -PjmhOutputPath=benchmark/vectorized-read-flat-parquet-data-result.txt`","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/938588591/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/938625017","html_url":"https://github.com/apache/iceberg/pull/2935#issuecomment-938625017","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2935","id":938625017,"node_id":"IC_kwDOCW7NX8438kf5","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-08T13:02:14Z","updated_at":"2021-10-08T13:02:14Z","author_association":"CONTRIBUTOR","body":"@openinx: You might want to take a look at #3250. With the help of #3248 I was able to run all of the tests for ORC as well. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/938625017/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/938725807","html_url":"https://github.com/apache/iceberg/pull/3232#issuecomment-938725807","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3232","id":938725807,"node_id":"IC_kwDOCW7NX84389Gv","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-08T15:20:01Z","updated_at":"2021-10-08T15:20:01Z","author_association":"MEMBER","body":"Merged! Thanks @nastra and all reviewers :)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/938725807/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/938726617","html_url":"https://github.com/apache/iceberg/issues/3245#issuecomment-938726617","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3245","id":938726617,"node_id":"IC_kwDOCW7NX84389TZ","user":{"login":"nssalian","id":8526007,"node_id":"MDQ6VXNlcjg1MjYwMDc=","avatar_url":"https://avatars.githubusercontent.com/u/8526007?v=4","gravatar_id":"","url":"https://api.github.com/users/nssalian","html_url":"https://github.com/nssalian","followers_url":"https://api.github.com/users/nssalian/followers","following_url":"https://api.github.com/users/nssalian/following{/other_user}","gists_url":"https://api.github.com/users/nssalian/gists{/gist_id}","starred_url":"https://api.github.com/users/nssalian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nssalian/subscriptions","organizations_url":"https://api.github.com/users/nssalian/orgs","repos_url":"https://api.github.com/users/nssalian/repos","events_url":"https://api.github.com/users/nssalian/events{/privacy}","received_events_url":"https://api.github.com/users/nssalian/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-08T15:21:07Z","updated_at":"2021-10-11T21:24:38Z","author_association":"CONTRIBUTOR","body":"Happy to work on this to help start off the other catalogs derived from it.\r\n@jun-he , let me know if I can take this on. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/938726617/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/938933135","html_url":"https://github.com/apache/iceberg/pull/3213#issuecomment-938933135","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3213","id":938933135,"node_id":"IC_kwDOCW7NX8439vuP","user":{"login":"myandpr","id":20159351,"node_id":"MDQ6VXNlcjIwMTU5MzUx","avatar_url":"https://avatars.githubusercontent.com/u/20159351?v=4","gravatar_id":"","url":"https://api.github.com/users/myandpr","html_url":"https://github.com/myandpr","followers_url":"https://api.github.com/users/myandpr/followers","following_url":"https://api.github.com/users/myandpr/following{/other_user}","gists_url":"https://api.github.com/users/myandpr/gists{/gist_id}","starred_url":"https://api.github.com/users/myandpr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/myandpr/subscriptions","organizations_url":"https://api.github.com/users/myandpr/orgs","repos_url":"https://api.github.com/users/myandpr/repos","events_url":"https://api.github.com/users/myandpr/events{/privacy}","received_events_url":"https://api.github.com/users/myandpr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-08T17:32:57Z","updated_at":"2021-10-08T17:32:57Z","author_association":"CONTRIBUTOR","body":"> > I'll take a look. The first thing is separating the features into different PRs. Can you open a PR for auto-compaction and one for automatic expiration?\r\n> \r\n> I also agree that this seems like a good candidate for multiple PRs. If it helps you, you can keep things together for shared functionality and then branch off of that for the two PRs (or some other approach to help consume in smaller parts overall).\r\n\r\nHi @kbendick , sorry for the late reply, because I am on vacation and cannot connect to GitHub these days. \r\n\r\nI have separated this PR into `Flink: auto compact small files\r\n` PR https://github.com/apache/iceberg/pull/3213 and `[Iceberg] Flink:auto delete expired snapshots` PR https://github.com/apache/iceberg/pull/3255\r\n\r\nYou can continue to review the two PRs in https://github.com/apache/iceberg/pull/3255 and https://github.com/apache/iceberg/pull/3213","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/938933135/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/938956754","html_url":"https://github.com/apache/iceberg/pull/3237#issuecomment-938956754","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3237","id":938956754,"node_id":"IC_kwDOCW7NX84391fS","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-08T17:44:02Z","updated_at":"2021-10-08T17:44:02Z","author_association":"CONTRIBUTOR","body":"Thanks for getting this started, @jackye1995! I think this is a good first step, but there are a few things we should consider.\r\n\r\nFirst, I agree that we probably want to parameterize the Scala version while we're doing this work. We are going to need to address it sooner or later and now seems like a good time to at least put in a parameter that is always 2.12 so that we can get a 2.13 build working later.\r\n\r\nNext, I think we need to think about package naming. Right now, we produce `iceberg-spark-runtime`, `iceberg-spark3-runtime`, etc. I think that this produces just the `iceberg-spark-runtime` and not the `spark3` Jars, which would possibly break scripts because people depend on certain module names. We will also need to publish multiple Spark Jars so I think we need to give them unique names. Scala has the convention of adding the Scala version into the module name like `_2.12`. I think we should probably do the same and start publishing `iceberg-spark-runtime_3.2_2.12` and `iceberg-spark_3.2_2.12`. We can continue to publish Spark 2.4 as `iceberg-spark-runtime` and Spark 3.0 as `iceberg-spark3-runtime` for consistency. Both of those have fixed Scala versions anyway so that's good.\r\n\r\nSince we probably want to be able to publish Jars for all Spark versions, I think it makes sense to be able to build the whole project with every Spark version. And since we will probably be embedding version strings in module names, I'm wondering if the conditional project logic in the main `build.gradle` is a good idea anymore. Gradle now recommends a separate `build.gradle` for each subproject, which would work well. We could have a `build.gradle` specific to each `spark/v$major.$minor` build directory and select whole projects using `settings.gradle`. That avoids big changes to `build.gradle` and makes it easy to evolve each Spark build independently.\r\n\r\nI went ahead and tried out updating this build like this and the result is #3256.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/938956754/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/938975578","html_url":"https://github.com/apache/iceberg/pull/3213#issuecomment-938975578","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3213","id":938975578,"node_id":"IC_kwDOCW7NX84396Fa","user":{"login":"myandpr","id":20159351,"node_id":"MDQ6VXNlcjIwMTU5MzUx","avatar_url":"https://avatars.githubusercontent.com/u/20159351?v=4","gravatar_id":"","url":"https://api.github.com/users/myandpr","html_url":"https://github.com/myandpr","followers_url":"https://api.github.com/users/myandpr/followers","following_url":"https://api.github.com/users/myandpr/following{/other_user}","gists_url":"https://api.github.com/users/myandpr/gists{/gist_id}","starred_url":"https://api.github.com/users/myandpr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/myandpr/subscriptions","organizations_url":"https://api.github.com/users/myandpr/orgs","repos_url":"https://api.github.com/users/myandpr/repos","events_url":"https://api.github.com/users/myandpr/events{/privacy}","received_events_url":"https://api.github.com/users/myandpr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-08T17:52:51Z","updated_at":"2021-10-08T17:52:51Z","author_association":"CONTRIBUTOR","body":"> > @rdblue @kbendick @stevenzwu , could you help to review this PR? :)\r\n> \r\n> Thanks for working on this @myandpr. I am off this week but am interested in this so will review but might be a bit slow to respond. 🙂\r\n> \r\n> I agree with @rdblue's that it makes sense to avoid trying to compact the whole table (or scan the whole table) in an online streaming context, but rather pass around the file names that need to be compacted and committed.\r\n\r\nHi @kbendick , I'd like to hear your opinion on my doubts https://github.com/apache/iceberg/pull/3213#discussion_r724905119🙂","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/938975578/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/938985844","html_url":"https://github.com/apache/iceberg/pull/3242#issuecomment-938985844","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3242","id":938985844,"node_id":"IC_kwDOCW7NX84398l0","user":{"login":"tprelle","id":59021490,"node_id":"MDQ6VXNlcjU5MDIxNDkw","avatar_url":"https://avatars.githubusercontent.com/u/59021490?v=4","gravatar_id":"","url":"https://api.github.com/users/tprelle","html_url":"https://github.com/tprelle","followers_url":"https://api.github.com/users/tprelle/followers","following_url":"https://api.github.com/users/tprelle/following{/other_user}","gists_url":"https://api.github.com/users/tprelle/gists{/gist_id}","starred_url":"https://api.github.com/users/tprelle/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tprelle/subscriptions","organizations_url":"https://api.github.com/users/tprelle/orgs","repos_url":"https://api.github.com/users/tprelle/repos","events_url":"https://api.github.com/users/tprelle/events{/privacy}","received_events_url":"https://api.github.com/users/tprelle/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-08T17:57:37Z","updated_at":"2021-10-08T17:57:37Z","author_association":"CONTRIBUTOR","body":"Hi  @pvary,\r\nI add some unit test using Mockito it's hard.\r\nI also deployement it locally for test\r\nRegards\r\nThomas","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/938985844/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939049135","html_url":"https://github.com/apache/iceberg/issues/2482#issuecomment-939049135","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2482","id":939049135,"node_id":"IC_kwDOCW7NX843-MCv","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-08T18:51:44Z","updated_at":"2021-10-08T18:51:44Z","author_association":"CONTRIBUTOR","body":"There seems to be a lot of confusion around this issue. It was just referenced again in [this comment](https://github.com/apache/iceberg/pull/3213#discussion_r724779586).\r\n\r\nThe problem is not the behavior of the validation. That's doing the right thing for how it is configured. I think that the problem is that the validation is configured to look over the entire table history, which is clearly not correct.\r\n\r\nThe problematic validation is `validateDataFilesExist`. That only needs to be used when adding position deletes because equality deletes do not reference specific data files. Since position deletes for a CDC stream are only added against data files that are being added, I don't think that validation even needs to be configured. We can simply remove these two lines: https://github.com/apache/iceberg/blob/1cb04128661ea147c2eec4dd1d025698f9604993/flink/src/main/java/org/apache/iceberg/flink/sink/IcebergFilesCommitter.java#L286-L287\r\n\r\n@openinx and @stevenzwu, what do you think?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939049135/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939050446","html_url":"https://github.com/apache/iceberg/issues/2371#issuecomment-939050446","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2371","id":939050446,"node_id":"IC_kwDOCW7NX843-MXO","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-08T18:54:16Z","updated_at":"2021-10-08T18:54:16Z","author_association":"CONTRIBUTOR","body":"I don't think that this is a problem. `validateDataFilesExist` is written correctly, I think it is just used incorrectly in the CDC use case (see https://github.com/apache/iceberg/issues/2482#issuecomment-939049135). In that case, you don't even need to run the validation. And when a validation _is_ used, it needs to be configured by calling `validateFromSnapshot` with the snapshot used for all reads.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939050446/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939084353","html_url":"https://github.com/apache/iceberg/issues/3115#issuecomment-939084353","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3115","id":939084353,"node_id":"IC_kwDOCW7NX843-UpB","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-08T20:00:01Z","updated_at":"2021-10-08T20:00:01Z","author_association":"CONTRIBUTOR","body":"FYI @samredai","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939084353/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939130329","html_url":"https://github.com/apache/iceberg/pull/3244#issuecomment-939130329","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3244","id":939130329,"node_id":"IC_kwDOCW7NX843-f3Z","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-08T21:39:07Z","updated_at":"2021-10-08T21:39:07Z","author_association":"CONTRIBUTOR","body":"Thanks for the reviews, @nastra and @yyanyy!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939130329/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939144452","html_url":"https://github.com/apache/iceberg/pull/3258#issuecomment-939144452","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3258","id":939144452,"node_id":"IC_kwDOCW7NX843-jUE","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-08T22:15:11Z","updated_at":"2021-10-08T23:14:22Z","author_association":"CONTRIBUTOR","body":"@openinx, it looks like there is a test for a case that I don't think can happen. Should we fix the test or should we look into calling `validateFromSnapshot` with the last committed snapshot ID?\r\n\r\nHere's the alternative that uses the last committed snapshot:\r\n```java\r\n        Long lastCommittedSnapshotId = null;\r\n        for (Snapshot snap : SnapshotUtil.currentAncestors(table)) {\r\n          String snapshotCheckpointId = snap.summary().get(MAX_COMMITTED_CHECKPOINT_ID);\r\n          if (snapshotCheckpointId != null && Long.parseLong(snapshotCheckpointId) == maxCommittedCheckpointId) {\r\n            lastCommittedSnapshotId = snap.snapshotId();\r\n          }\r\n        }\r\n\r\n        RowDelta rowDelta = table.newRowDelta()\r\n            .validateDataFilesExist(ImmutableList.copyOf(result.referencedDataFiles()))\r\n            .validateDeletedFiles();\r\n\r\n        if (lastCommittedSnapshotId != null) {\r\n          rowDelta.validateFromSnapshot(lastCommittedSnapshotId);\r\n        }\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939144452/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939201068","html_url":"https://github.com/apache/iceberg/issues/3263#issuecomment-939201068","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3263","id":939201068,"node_id":"IC_kwDOCW7NX843-xIs","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-09T01:36:56Z","updated_at":"2021-10-09T01:40:19Z","author_association":"COLLABORATOR","body":"I was thinking to explicitly set it to -1 when constructing the DataFile in listAvroPartitions, but I am worried its setting wrong metadata (though it is explicitly set to -1 for Metrics.)\r\n\r\nRef: TableMigrationUtil::listAvroPartitions\r\n\r\n```\r\n Metrics metrics = new Metrics(-1L, null, null, null);\r\n            String partitionKey = spec.fields().stream()\r\n                .map(PartitionField::name)\r\n                .map(name -> String.format(\"%s=%s\", name, partitionPath.get(name)))\r\n                .collect(Collectors.joining(\"/\"));\r\n\r\n            return DataFiles.builder(spec)\r\n                .withPath(stat.getPath().toString())\r\n                .withFormat(\"avro\")\r\n                .withFileSizeInBytes(stat.getLen())\r\n                .withMetrics(metrics)\r\n                .withPartitionPath(partitionKey)\r\n                .build();\r\n```\r\n\r\nDoesn't seem like Avro file has any metadata to quickly get recordCount, I wonder if making a Spark job to read the number of rows is overkill?  Any thoughts @RussellSpitzer and @aokolnychyi ?  Or is the add_file for Avro case designed to be ok to not set the record count?\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939201068/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939207737","html_url":"https://github.com/apache/iceberg/issues/2934#issuecomment-939207737","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2934","id":939207737,"node_id":"IC_kwDOCW7NX843-yw5","user":{"login":"manishmalhotrawork","id":22434010,"node_id":"MDQ6VXNlcjIyNDM0MDEw","avatar_url":"https://avatars.githubusercontent.com/u/22434010?v=4","gravatar_id":"","url":"https://api.github.com/users/manishmalhotrawork","html_url":"https://github.com/manishmalhotrawork","followers_url":"https://api.github.com/users/manishmalhotrawork/followers","following_url":"https://api.github.com/users/manishmalhotrawork/following{/other_user}","gists_url":"https://api.github.com/users/manishmalhotrawork/gists{/gist_id}","starred_url":"https://api.github.com/users/manishmalhotrawork/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/manishmalhotrawork/subscriptions","organizations_url":"https://api.github.com/users/manishmalhotrawork/orgs","repos_url":"https://api.github.com/users/manishmalhotrawork/repos","events_url":"https://api.github.com/users/manishmalhotrawork/events{/privacy}","received_events_url":"https://api.github.com/users/manishmalhotrawork/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-09T02:24:30Z","updated_at":"2021-10-09T02:42:01Z","author_association":"CONTRIBUTOR","body":"hi @cccs-br \r\nVery sorry for the delay!\r\nGot sidelined with other stuff.\r\n\r\nI was thinking to take this up, also spend some time initially, and reach to a place where found that:\r\n\r\nlooks like `org.apache.iceberg.expressions.Literals.from` is the place where `byte[]` or `ByteBuffer` converted to the corresponding literals\r\n\r\n```\r\nstatic <T> Literal<T> from(T value) {\r\n    Preconditions.checkNotNull(value, \"Cannot create expression literal from null\");\r\n    Preconditions.checkArgument(!NaNUtil.isNaN(value), \"Cannot create expression literal from NaN\");\r\n\r\n    if (value instanceof Boolean) {\r\n      return (Literal<T>) new Literals.BooleanLiteral((Boolean) value);\r\n    } else if (value instanceof Integer) {\r\n      return (Literal<T>) new Literals.IntegerLiteral((Integer) value);\r\n    } else if (value instanceof Long) {\r\n      return (Literal<T>) new Literals.LongLiteral((Long) value);\r\n    } else if (value instanceof Float) {\r\n      return (Literal<T>) new Literals.FloatLiteral((Float) value);\r\n    } else if (value instanceof Double) {\r\n      return (Literal<T>) new Literals.DoubleLiteral((Double) value);\r\n    } else if (value instanceof CharSequence) {\r\n      return (Literal<T>) new Literals.StringLiteral((CharSequence) value);\r\n    } else if (value instanceof UUID) {\r\n      return (Literal<T>) new Literals.UUIDLiteral((UUID) value);\r\n    } else if (value instanceof byte[]) {\r\n      return (Literal<T>) new Literals.FixedLiteral(ByteBuffer.wrap((byte[]) value));\r\n    } else if (value instanceof ByteBuffer) {\r\n      return (Literal<T>) new Literals.BinaryLiteral((ByteBuffer) value);\r\n    } else if (value instanceof BigDecimal) {\r\n      return (Literal<T>) new Literals.DecimalLiteral((BigDecimal) value);\r\n    }\r\n\r\n```\r\n\r\nAlso discussed with @RussellSpitzer and next step was to check the query plan in spark sql case. That can give more insight as how it's being handled in case of spark sql.\r\n\r\nthanks @RussellSpitzer for the help!\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939207737/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939258436","html_url":"https://github.com/apache/iceberg/pull/3249#issuecomment-939258436","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3249","id":939258436,"node_id":"IC_kwDOCW7NX843-_JE","user":{"login":"ConeyLiu","id":12733256,"node_id":"MDQ6VXNlcjEyNzMzMjU2","avatar_url":"https://avatars.githubusercontent.com/u/12733256?v=4","gravatar_id":"","url":"https://api.github.com/users/ConeyLiu","html_url":"https://github.com/ConeyLiu","followers_url":"https://api.github.com/users/ConeyLiu/followers","following_url":"https://api.github.com/users/ConeyLiu/following{/other_user}","gists_url":"https://api.github.com/users/ConeyLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/ConeyLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ConeyLiu/subscriptions","organizations_url":"https://api.github.com/users/ConeyLiu/orgs","repos_url":"https://api.github.com/users/ConeyLiu/repos","events_url":"https://api.github.com/users/ConeyLiu/events{/privacy}","received_events_url":"https://api.github.com/users/ConeyLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-09T08:46:18Z","updated_at":"2021-10-09T08:46:18Z","author_association":"CONTRIBUTOR","body":"before\r\n```\r\nBenchmark                                                                 Mode  Cnt   Score   Error  Units\r\nVectorizedReadFlatParquetDataBenchmark.readDatesIcebergVectorized5k         ss    5   1.362 ± 0.092   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readDatesSparkVectorized5k           ss    5   1.451 ± 0.222   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readDecimalsIcebergVectorized5k      ss    5  10.508 ± 0.893   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readDecimalsSparkVectorized5k        ss    5   8.165 ± 1.205   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readDoublesIcebergVectorized5k       ss    5   2.880 ± 0.241   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readDoublesSparkVectorized5k         ss    5   2.610 ± 0.152   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readFloatsIcebergVectorized5k        ss    5   2.801 ± 0.376   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readFloatsSparkVectorized5k          ss    5   2.469 ± 0.155   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readIntegersIcebergVectorized5k      ss    5   2.286 ± 0.136   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readIntegersSparkVectorized5k        ss    5   2.580 ± 0.229   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readLongsIcebergVectorized5k         ss    5   2.684 ± 0.186   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readLongsSparkVectorized5k           ss    5   2.526 ± 0.767   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readStringsIcebergVectorized5k       ss    5   4.367 ± 0.207   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readStringsSparkVectorized5k         ss    5   3.964 ± 0.334   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readTimestampsIcebergVectorized5k    ss    5   1.434 ± 0.120   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readTimestampsSparkVectorized5k      ss    5   2.015 ± 0.351   s/op\r\n\r\n```\r\n\r\nafter\r\n```\r\nBenchmark                                                                 Mode  Cnt   Score   Error  Units\r\nVectorizedReadFlatParquetDataBenchmark.readDatesIcebergVectorized5k         ss    5   1.578 ± 0.045   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readDatesSparkVectorized5k           ss    5   1.757 ± 0.338   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readDecimalsIcebergVectorized5k      ss    5  10.965 ± 1.610   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readDecimalsSparkVectorized5k        ss    5   8.143 ± 0.300   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readDoublesIcebergVectorized5k       ss    5   2.791 ± 0.078   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readDoublesSparkVectorized5k         ss    5   2.623 ± 0.171   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readFloatsIcebergVectorized5k        ss    5   2.570 ± 0.065   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readFloatsSparkVectorized5k          ss    5   2.657 ± 0.692   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readIntegersIcebergVectorized5k      ss    5   2.651 ± 0.115   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readIntegersSparkVectorized5k        ss    5   2.547 ± 0.290   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readLongsIcebergVectorized5k         ss    5   2.305 ± 0.124   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readLongsSparkVectorized5k           ss    5   2.540 ± 0.076   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readStringsIcebergVectorized5k       ss    5   4.176 ± 0.222   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readStringsSparkVectorized5k         ss    5   4.231 ± 1.574   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readTimestampsIcebergVectorized5k    ss    5   1.597 ± 0.415   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readTimestampsSparkVectorized5k      ss    5   1.720 ± 0.052   s/op\r\n```\r\n\r\nI added decimal benchmark:\r\nbefore:\r\n```\r\nBenchmark                                                                        Mode  Cnt   Score   Error  Units\r\nVectorizedReadParquetDecimalBenchmark.readDecimalsIcebergVectorized5k              ss    5  10.623 ± 1.204   s/op\r\nVectorizedReadParquetDecimalBenchmark.readDecimalsSparkVectorized5k                ss    5   8.322 ± 1.146   s/op\r\nVectorizedReadParquetDecimalBenchmark.readIntBackedDecimalsIcebergVectorized5k     ss    5   1.593 ± 0.199   s/op\r\nVectorizedReadParquetDecimalBenchmark.readIntBackedDecimalsSparkVectorized5k       ss    5   1.597 ± 0.064   s/op\r\nVectorizedReadParquetDecimalBenchmark.readLongBackedDecimalsIcebergVectorized5k    ss    5   5.836 ± 0.406   s/op\r\nVectorizedReadParquetDecimalBenchmark.readLongBackedDecimalsSparkVectorized5k      ss    5   3.285 ± 0.230   s/op\r\n```\r\n\r\nafter\r\n```\r\nBenchmark                                                                        Mode  Cnt   Score   Error  Units\r\nVectorizedReadParquetDecimalBenchmark.readDecimalsIcebergVectorized5k              ss    5  10.988 ± 2.355   s/op\r\nVectorizedReadParquetDecimalBenchmark.readDecimalsSparkVectorized5k                ss    5   7.511 ± 0.484   s/op\r\nVectorizedReadParquetDecimalBenchmark.readIntBackedDecimalsIcebergVectorized5k     ss    5   1.748 ± 0.174   s/op\r\nVectorizedReadParquetDecimalBenchmark.readIntBackedDecimalsSparkVectorized5k       ss    5   1.631 ± 0.325   s/op\r\nVectorizedReadParquetDecimalBenchmark.readLongBackedDecimalsIcebergVectorized5k    ss    5   3.623 ± 0.557   s/op\r\nVectorizedReadParquetDecimalBenchmark.readLongBackedDecimalsSparkVectorized5k      ss    5   3.203 ± 0.209   s/op\r\n\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939258436/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939258835","html_url":"https://github.com/apache/iceberg/issues/2301#issuecomment-939258835","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2301","id":939258835,"node_id":"IC_kwDOCW7NX843-_PT","user":{"login":"lirui-apache","id":5210788,"node_id":"MDQ6VXNlcjUyMTA3ODg=","avatar_url":"https://avatars.githubusercontent.com/u/5210788?v=4","gravatar_id":"","url":"https://api.github.com/users/lirui-apache","html_url":"https://github.com/lirui-apache","followers_url":"https://api.github.com/users/lirui-apache/followers","following_url":"https://api.github.com/users/lirui-apache/following{/other_user}","gists_url":"https://api.github.com/users/lirui-apache/gists{/gist_id}","starred_url":"https://api.github.com/users/lirui-apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lirui-apache/subscriptions","organizations_url":"https://api.github.com/users/lirui-apache/orgs","repos_url":"https://api.github.com/users/lirui-apache/repos","events_url":"https://api.github.com/users/lirui-apache/events{/privacy}","received_events_url":"https://api.github.com/users/lirui-apache/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-09T08:48:46Z","updated_at":"2021-10-09T08:48:46Z","author_association":"CONTRIBUTOR","body":"We also encountered this issue with iceberg 0.11.1. Intuitively I wanted to enable the house keeper service in HMS. But then I noted iceberg doesn't send heartbeat for acquired locks, which seems to imply it relies on HMS not running the house keeper services. Wondering whether that's by design.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939258835/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939261058","html_url":"https://github.com/apache/iceberg/issues/2301#issuecomment-939261058","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2301","id":939261058,"node_id":"IC_kwDOCW7NX843-_yC","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-09T09:03:28Z","updated_at":"2021-10-09T09:03:28Z","author_association":"CONTRIBUTOR","body":"Heartbeat is usually not needed for Iceberg table locks. The lock is only kept for the atomicity of the snapshot swap. This should be almost immediate. Heathbeat interval is 5 min, which means no heartbeat is sent with the default conf anyway. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939261058/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939267787","html_url":"https://github.com/apache/iceberg/issues/2301#issuecomment-939267787","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2301","id":939267787,"node_id":"IC_kwDOCW7NX843_BbL","user":{"login":"lirui-apache","id":5210788,"node_id":"MDQ6VXNlcjUyMTA3ODg=","avatar_url":"https://avatars.githubusercontent.com/u/5210788?v=4","gravatar_id":"","url":"https://api.github.com/users/lirui-apache","html_url":"https://github.com/lirui-apache","followers_url":"https://api.github.com/users/lirui-apache/followers","following_url":"https://api.github.com/users/lirui-apache/following{/other_user}","gists_url":"https://api.github.com/users/lirui-apache/gists{/gist_id}","starred_url":"https://api.github.com/users/lirui-apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lirui-apache/subscriptions","organizations_url":"https://api.github.com/users/lirui-apache/orgs","repos_url":"https://api.github.com/users/lirui-apache/repos","events_url":"https://api.github.com/users/lirui-apache/events{/privacy}","received_events_url":"https://api.github.com/users/lirui-apache/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-09T09:49:33Z","updated_at":"2021-10-09T09:49:33Z","author_association":"CONTRIBUTOR","body":"Thanks @pvary for the clarifications. Then I'll go with the house keeper service.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939267787/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939268606","html_url":"https://github.com/apache/iceberg/issues/2301#issuecomment-939268606","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2301","id":939268606,"node_id":"IC_kwDOCW7NX843_Bn-","user":{"login":"rice668","id":6520673,"node_id":"MDQ6VXNlcjY1MjA2NzM=","avatar_url":"https://avatars.githubusercontent.com/u/6520673?v=4","gravatar_id":"","url":"https://api.github.com/users/rice668","html_url":"https://github.com/rice668","followers_url":"https://api.github.com/users/rice668/followers","following_url":"https://api.github.com/users/rice668/following{/other_user}","gists_url":"https://api.github.com/users/rice668/gists{/gist_id}","starred_url":"https://api.github.com/users/rice668/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rice668/subscriptions","organizations_url":"https://api.github.com/users/rice668/orgs","repos_url":"https://api.github.com/users/rice668/repos","events_url":"https://api.github.com/users/rice668/events{/privacy}","received_events_url":"https://api.github.com/users/rice668/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-09T09:54:57Z","updated_at":"2021-10-09T09:54:57Z","author_association":"CONTRIBUTOR","body":"@pvary @lirui-apache In extreme scenarios, Assuming that where the commit execution takes 2 minutes to complete and the house keeper service releases the lock at a default time of 1 minute and 50 seconds (assuming), the heartbeat may be necessary.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939268606/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939270495","html_url":"https://github.com/apache/iceberg/issues/2788#issuecomment-939270495","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2788","id":939270495,"node_id":"IC_kwDOCW7NX843_CFf","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-09T10:07:59Z","updated_at":"2021-10-09T10:07:59Z","author_association":"CONTRIBUTOR","body":"Hi @SreeramGarlapati,\r\n\r\nI was looking into this recently as I was doing some investigation into existing CDC systems. Particularly as Spark has no built in concept of this.\r\n\r\nYour proposal seems pretty good. My one concern would be streaming all data from V1 format tables in `OVERWRITE` snapshots by default. If that's a flag people can opt into, I could get behind that. But that's potentially quite a lot of duplicated data, and I think we could in theory do some sort of anti-join on files from past snapshots if they haven't been physically deleted yet (expensive, but could get much more correct results for V1 tables).\r\n\r\nI don't have a very strong opinion on much related to V1 tables, other than restreaming potential duplicates should definitely be opt-in imo. 🙂 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939270495/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939340325","html_url":"https://github.com/apache/iceberg/pull/2891#issuecomment-939340325","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2891","id":939340325,"node_id":"IC_kwDOCW7NX843_TIl","user":{"login":"findepi","id":144328,"node_id":"MDQ6VXNlcjE0NDMyOA==","avatar_url":"https://avatars.githubusercontent.com/u/144328?v=4","gravatar_id":"","url":"https://api.github.com/users/findepi","html_url":"https://github.com/findepi","followers_url":"https://api.github.com/users/findepi/followers","following_url":"https://api.github.com/users/findepi/following{/other_user}","gists_url":"https://api.github.com/users/findepi/gists{/gist_id}","starred_url":"https://api.github.com/users/findepi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/findepi/subscriptions","organizations_url":"https://api.github.com/users/findepi/orgs","repos_url":"https://api.github.com/users/findepi/repos","events_url":"https://api.github.com/users/findepi/events{/privacy}","received_events_url":"https://api.github.com/users/findepi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-09T18:20:11Z","updated_at":"2021-10-09T18:20:11Z","author_association":"MEMBER","body":"@rdblue i am not sure what the conclusion here is. Please help me understand.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939340325/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939352969","html_url":"https://github.com/apache/iceberg/pull/3268#issuecomment-939352969","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3268","id":939352969,"node_id":"IC_kwDOCW7NX843_WOJ","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-09T19:49:24Z","updated_at":"2021-10-09T19:49:24Z","author_association":"CONTRIBUTOR","body":"There are a few corner cases that don't appear to be handled. For example if somebody runs a `CreateOrReplaceTable` operation on an existing table and somebody streams from the beginning it will either NPE or likely return to the beginning of the table entirely.\r\n\r\nBut given that the Spark streaming source is presently only able to handle a limited set of use cases, I don't think convoluting it for edge cases is the best idea. If anybody would like to discuss my findings, I'd be happy to do so as I spent some time looking into CDC in other systems and how it can be efficiently applied for the Spark stream (which doesn't have an in-built notion of CDC or deletes in general). There's a bit more of a break down on the other PR mentioned above.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939352969/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939353699","html_url":"https://github.com/apache/iceberg/pull/3267#issuecomment-939353699","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3267","id":939353699,"node_id":"IC_kwDOCW7NX843_WZj","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-09T19:55:06Z","updated_at":"2021-10-09T19:55:06Z","author_association":"CONTRIBUTOR","body":"I see now that there are several open issues and a few open PRs related to this. So I'm probably going to close this PR in favor of only [simplifying the shouldProcess preconditions check](https://github.com/apache/iceberg/pull/3268).\r\n\r\nI did some research into CDC recently in other systems but I'm starting a new position soon so I'm not sure what the priority will be yet for where I spend my time. I will know more next week, but am happy to discuss with others if I don't have cycles to work on the Spark streaming source.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939353699/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939357755","html_url":"https://github.com/apache/iceberg/issues/3265#issuecomment-939357755","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3265","id":939357755,"node_id":"IC_kwDOCW7NX843_XY7","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-09T20:32:04Z","updated_at":"2021-10-09T20:32:04Z","author_association":"CONTRIBUTOR","body":"Closing this as there are already open issues (and even PRs) surrounding this subject.\r\n\r\nMy vote would be to allow for an additional flag to ignore OVERWRITE type snapshots. There are cases I can see where users might want to do that, such as bulk changing the file format or the compression type of existing files (but without changing any of the existing row level data, but it would be on the user to ensure that their OVERWRITE met their own criteria).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939357755/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939364521","html_url":"https://github.com/apache/iceberg/issues/2934#issuecomment-939364521","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2934","id":939364521,"node_id":"IC_kwDOCW7NX843_ZCp","user":{"login":"cccs-br","id":56260250,"node_id":"MDQ6VXNlcjU2MjYwMjUw","avatar_url":"https://avatars.githubusercontent.com/u/56260250?v=4","gravatar_id":"","url":"https://api.github.com/users/cccs-br","html_url":"https://github.com/cccs-br","followers_url":"https://api.github.com/users/cccs-br/followers","following_url":"https://api.github.com/users/cccs-br/following{/other_user}","gists_url":"https://api.github.com/users/cccs-br/gists{/gist_id}","starred_url":"https://api.github.com/users/cccs-br/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cccs-br/subscriptions","organizations_url":"https://api.github.com/users/cccs-br/orgs","repos_url":"https://api.github.com/users/cccs-br/repos","events_url":"https://api.github.com/users/cccs-br/events{/privacy}","received_events_url":"https://api.github.com/users/cccs-br/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-09T21:31:44Z","updated_at":"2021-10-09T21:34:35Z","author_association":"NONE","body":"That is awesome @manishmalhotrawork .  Thanks again for looking into this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939364521/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939364970","html_url":"https://github.com/apache/iceberg/issues/2934#issuecomment-939364970","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2934","id":939364970,"node_id":"IC_kwDOCW7NX843_ZJq","user":{"login":"cccs-br","id":56260250,"node_id":"MDQ6VXNlcjU2MjYwMjUw","avatar_url":"https://avatars.githubusercontent.com/u/56260250?v=4","gravatar_id":"","url":"https://api.github.com/users/cccs-br","html_url":"https://github.com/cccs-br","followers_url":"https://api.github.com/users/cccs-br/followers","following_url":"https://api.github.com/users/cccs-br/following{/other_user}","gists_url":"https://api.github.com/users/cccs-br/gists{/gist_id}","starred_url":"https://api.github.com/users/cccs-br/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cccs-br/subscriptions","organizations_url":"https://api.github.com/users/cccs-br/orgs","repos_url":"https://api.github.com/users/cccs-br/repos","events_url":"https://api.github.com/users/cccs-br/events{/privacy}","received_events_url":"https://api.github.com/users/cccs-br/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-09T21:35:53Z","updated_at":"2021-10-09T21:36:01Z","author_association":"NONE","body":"Closed by accident.  Reopening.  Sry about that.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939364970/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939448241","html_url":"https://github.com/apache/iceberg/pull/3257#issuecomment-939448241","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3257","id":939448241,"node_id":"IC_kwDOCW7NX843_tex","user":{"login":"snazy","id":957468,"node_id":"MDQ6VXNlcjk1NzQ2OA==","avatar_url":"https://avatars.githubusercontent.com/u/957468?v=4","gravatar_id":"","url":"https://api.github.com/users/snazy","html_url":"https://github.com/snazy","followers_url":"https://api.github.com/users/snazy/followers","following_url":"https://api.github.com/users/snazy/following{/other_user}","gists_url":"https://api.github.com/users/snazy/gists{/gist_id}","starred_url":"https://api.github.com/users/snazy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/snazy/subscriptions","organizations_url":"https://api.github.com/users/snazy/orgs","repos_url":"https://api.github.com/users/snazy/repos","events_url":"https://api.github.com/users/snazy/events{/privacy}","received_events_url":"https://api.github.com/users/snazy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-10T10:10:39Z","updated_at":"2021-10-10T10:10:39Z","author_association":"MEMBER","body":"Moved to draft status due to https://github.com/projectnessie/nessie/issues/2312","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939448241/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939523136","html_url":"https://github.com/apache/iceberg/pull/3262#issuecomment-939523136","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3262","id":939523136,"node_id":"IC_kwDOCW7NX843__xA","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-10T17:45:29Z","updated_at":"2021-10-10T17:45:29Z","author_association":"CONTRIBUTOR","body":"Thanks, @kbendick! Looks great.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939523136/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939523995","html_url":"https://github.com/apache/iceberg/pull/3261#issuecomment-939523995","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3261","id":939523995,"node_id":"IC_kwDOCW7NX843__-b","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-10T17:51:22Z","updated_at":"2021-10-10T17:51:22Z","author_association":"CONTRIBUTOR","body":"Thanks, @kbendick!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939523995/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939524305","html_url":"https://github.com/apache/iceberg/pull/3260#issuecomment-939524305","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3260","id":939524305,"node_id":"IC_kwDOCW7NX844AADR","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-10T17:53:30Z","updated_at":"2021-10-10T17:53:30Z","author_association":"CONTRIBUTOR","body":"Thanks, @kbendick!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939524305/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939524395","html_url":"https://github.com/apache/iceberg/pull/3257#issuecomment-939524395","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3257","id":939524395,"node_id":"IC_kwDOCW7NX844AAEr","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-10T17:54:09Z","updated_at":"2021-10-10T17:54:09Z","author_association":"CONTRIBUTOR","body":"@nastra, can you take a look?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939524395/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939525336","html_url":"https://github.com/apache/iceberg/pull/3257#issuecomment-939525336","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3257","id":939525336,"node_id":"IC_kwDOCW7NX844AATY","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-10T17:59:52Z","updated_at":"2021-10-10T17:59:52Z","author_association":"CONTRIBUTOR","body":"This appears to change the relationship between Nessie and Iceberg metadata. Can you please explain what you're doing here and why it is needed? What is the model for Nessie and Iceberg tracking now? I thought it was that Nessie tracked different Iceberg metadata files. Is that no longer the case and Nessie is tracking structures within Iceberg?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939525336/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939527365","html_url":"https://github.com/apache/iceberg/pull/3255#issuecomment-939527365","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3255","id":939527365,"node_id":"IC_kwDOCW7NX844AAzF","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-10T18:10:21Z","updated_at":"2021-10-10T18:10:21Z","author_association":"CONTRIBUTOR","body":"@myandpr, I have a few questions about the approach of this PR. First, what is the use case that motivates having separate configuration for this rather than using the existing config for snapshot expiration? I think that snapshot expiration policy and processes that actually perform the expiration are two orthogonal things. If you want to run expiration from Flink, that makes sense. But expiring snapshots differently when running in Flink vs some other method seems incorrect to me.\r\n\r\nSecond, how are you identifying the files to delete? There are two methods, incremental and reachability based. Incremental is no longer our recommended way of cleaning up files because it is really hard to reason about certain cases when snapshots are cherry-picked across branches. It isn't necessarily bad to continue using it here, but we should consider whether we can improve it. For example, I think this only cares about expiring snapshots in the current table state, which is an easier problem. Maybe we can extend the operation to support that more directly and avoid some of the hard cases.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939527365/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939532601","html_url":"https://github.com/apache/iceberg/pull/3249#issuecomment-939532601","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3249","id":939532601,"node_id":"IC_kwDOCW7NX844ACE5","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-10T18:45:24Z","updated_at":"2021-10-10T18:45:24Z","author_association":"CONTRIBUTOR","body":"Running CI","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939532601/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939534012","html_url":"https://github.com/apache/iceberg/pull/3249#issuecomment-939534012","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3249","id":939534012,"node_id":"IC_kwDOCW7NX844ACa8","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-10T18:55:28Z","updated_at":"2021-10-10T18:55:28Z","author_association":"CONTRIBUTOR","body":"@ConeyLiu, this looks like an improvement, but I think that it relies too heavily on config properties that must be set the same way everywhere rather than detecting what should be done from inputs.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939534012/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939534238","html_url":"https://github.com/apache/iceberg/pull/3186#issuecomment-939534238","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3186","id":939534238,"node_id":"IC_kwDOCW7NX844ACee","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-10T18:56:59Z","updated_at":"2021-10-10T18:56:59Z","author_association":"CONTRIBUTOR","body":"Running CI. Can you update the summary/description to note that this fixes a bug with ORC?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939534238/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939561484","html_url":"https://github.com/apache/iceberg/pull/2305#issuecomment-939561484","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2305","id":939561484,"node_id":"IC_kwDOCW7NX844AJIM","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-10T22:13:33Z","updated_at":"2021-10-10T22:13:33Z","author_association":"CONTRIBUTOR","body":"@stevenzwu, I'll try to review this in the next week. Thank you!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939561484/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939561960","html_url":"https://github.com/apache/iceberg/pull/3269#issuecomment-939561960","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3269","id":939561960,"node_id":"IC_kwDOCW7NX844AJPo","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-10T22:16:44Z","updated_at":"2021-10-10T22:16:44Z","author_association":"CONTRIBUTOR","body":"@wypoon, this is a prototype of how we can cleanly pass snapshot and timestamp selectors through identifiers. Could you take a look?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939561960/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939563308","html_url":"https://github.com/apache/iceberg/pull/3252#issuecomment-939563308","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3252","id":939563308,"node_id":"IC_kwDOCW7NX844AJks","user":{"login":"samredai","id":43911210,"node_id":"MDQ6VXNlcjQzOTExMjEw","avatar_url":"https://avatars.githubusercontent.com/u/43911210?v=4","gravatar_id":"","url":"https://api.github.com/users/samredai","html_url":"https://github.com/samredai","followers_url":"https://api.github.com/users/samredai/followers","following_url":"https://api.github.com/users/samredai/following{/other_user}","gists_url":"https://api.github.com/users/samredai/gists{/gist_id}","starred_url":"https://api.github.com/users/samredai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samredai/subscriptions","organizations_url":"https://api.github.com/users/samredai/orgs","repos_url":"https://api.github.com/users/samredai/repos","events_url":"https://api.github.com/users/samredai/events{/privacy}","received_events_url":"https://api.github.com/users/samredai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-10T22:27:26Z","updated_at":"2021-10-10T22:27:26Z","author_association":"CONTRIBUTOR","body":"Ok updated the PR with one more go at it. I cleaned it up to just `warn` when initializing without a config and then using a `new Configuration()` to initialize with. Then there's just 3 tests that check that:\r\n\r\n1. Initializing without a config does not raise\r\n2. `toString` does not raise if ran before `setConf`\r\n3. Properties passed to `initialize` are properly set even if the user did not `setConf()` explicitly\r\n\r\nFor `1.` and `2.` I used `assertDoesNotThrow` so the intention is clear (thanks @kbendick )","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939563308/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939582731","html_url":"https://github.com/apache/iceberg/issues/3246#issuecomment-939582731","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3246","id":939582731,"node_id":"IC_kwDOCW7NX844AOUL","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-11T00:22:39Z","updated_at":"2021-10-11T00:22:39Z","author_association":"CONTRIBUTOR","body":"why not just set `history.expire.max-snapshot-age-ms` to `Long.MAX_VALUE`?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939582731/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939596631","html_url":"https://github.com/apache/iceberg/issues/3246#issuecomment-939596631","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3246","id":939596631,"node_id":"IC_kwDOCW7NX844ARtX","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-11T01:12:30Z","updated_at":"2021-10-18T16:21:14Z","author_association":"MEMBER","body":"Don't we also have a GC_ENABLED flag to prevent expire snapshots? I remember this was added so that a table which was created from a snapshot cannot be expired from.\r\n\r\nhttps://github.com/apache/iceberg/blob/90225d6c9413016d611e2ce5eff37db1bc1b4fc5/core/src/main/java/org/apache/iceberg/RemoveSnapshots.java#L100-L102","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939596631/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939651147","html_url":"https://github.com/apache/iceberg/pull/3258#issuecomment-939651147","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3258","id":939651147,"node_id":"IC_kwDOCW7NX844AfBL","user":{"login":"Reo-LEI","id":17312872,"node_id":"MDQ6VXNlcjE3MzEyODcy","avatar_url":"https://avatars.githubusercontent.com/u/17312872?v=4","gravatar_id":"","url":"https://api.github.com/users/Reo-LEI","html_url":"https://github.com/Reo-LEI","followers_url":"https://api.github.com/users/Reo-LEI/followers","following_url":"https://api.github.com/users/Reo-LEI/following{/other_user}","gists_url":"https://api.github.com/users/Reo-LEI/gists{/gist_id}","starred_url":"https://api.github.com/users/Reo-LEI/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Reo-LEI/subscriptions","organizations_url":"https://api.github.com/users/Reo-LEI/orgs","repos_url":"https://api.github.com/users/Reo-LEI/repos","events_url":"https://api.github.com/users/Reo-LEI/events{/privacy}","received_events_url":"https://api.github.com/users/Reo-LEI/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-11T03:33:18Z","updated_at":"2021-10-11T04:17:49Z","author_association":"CONTRIBUTOR","body":"> Because position deletes will only reference data files being added to the table, there is no possibility that those files are concurrently deleted.\r\n\r\nIf user run `deleteOrphanFiles` action or delete referenced data file by manually/automatically program which is implement by user before flink commit, I think this validation can prevent to commit this not exists files.\r\n\r\n> should we look into calling validateFromSnapshot with the last committed snapshot ID?\r\n\r\nI have another PR(#3103) to check snapshot history from last committed snapshot id, but this PR is trying to speed up the `IcebergFilesCommitter`, but not to resolve #2482. Becasue as I mentioned on https://github.com/apache/iceberg/pull/3103/files#r718347222, we could not guarantee the `lastCommittedSnapshot` what we stored in snapshot summary or somewhere else will alway exists when we restore the flink job.\r\n\r\n@rdblue I think the proper way to resolve #2482 is `MergingSnapshotProducer.validationHistory` shop to travel the not exists snapshots which are delete by `expireSnapshots` action, or your comment on https://github.com/apache/iceberg/pull/2603/files#r652149167\r\n\r\nhttps://github.com/apache/iceberg/blob/6ca31fc2933e7533cc0f9bad9fcbc81c16c13a57/core/src/main/java/org/apache/iceberg/MergingSnapshotProducer.java#L432","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939651147/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939686414","html_url":"https://github.com/apache/iceberg/pull/3186#issuecomment-939686414","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3186","id":939686414,"node_id":"IC_kwDOCW7NX844AnoO","user":{"login":"rice668","id":6520673,"node_id":"MDQ6VXNlcjY1MjA2NzM=","avatar_url":"https://avatars.githubusercontent.com/u/6520673?v=4","gravatar_id":"","url":"https://api.github.com/users/rice668","html_url":"https://github.com/rice668","followers_url":"https://api.github.com/users/rice668/followers","following_url":"https://api.github.com/users/rice668/following{/other_user}","gists_url":"https://api.github.com/users/rice668/gists{/gist_id}","starred_url":"https://api.github.com/users/rice668/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rice668/subscriptions","organizations_url":"https://api.github.com/users/rice668/orgs","repos_url":"https://api.github.com/users/rice668/repos","events_url":"https://api.github.com/users/rice668/events{/privacy}","received_events_url":"https://api.github.com/users/rice668/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-11T05:09:38Z","updated_at":"2021-10-11T05:09:38Z","author_association":"CONTRIBUTOR","body":"@rdblue Thanks, I've done it and fix the check style as well.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939686414/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939736573","html_url":"https://github.com/apache/iceberg/pull/3204#issuecomment-939736573","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3204","id":939736573,"node_id":"IC_kwDOCW7NX844Az39","user":{"login":"hameizi","id":18445460,"node_id":"MDQ6VXNlcjE4NDQ1NDYw","avatar_url":"https://avatars.githubusercontent.com/u/18445460?v=4","gravatar_id":"","url":"https://api.github.com/users/hameizi","html_url":"https://github.com/hameizi","followers_url":"https://api.github.com/users/hameizi/followers","following_url":"https://api.github.com/users/hameizi/following{/other_user}","gists_url":"https://api.github.com/users/hameizi/gists{/gist_id}","starred_url":"https://api.github.com/users/hameizi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hameizi/subscriptions","organizations_url":"https://api.github.com/users/hameizi/orgs","repos_url":"https://api.github.com/users/hameizi/repos","events_url":"https://api.github.com/users/hameizi/events{/privacy}","received_events_url":"https://api.github.com/users/hameizi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-11T06:53:48Z","updated_at":"2021-10-11T06:53:48Z","author_association":"CONTRIBUTOR","body":"@rdblue I commit one new commit for your suggestion, can you help review one more time? The fix detail as follows:\r\n1.add one configuration to config whether vaildate there is new delete files be added when compacting files.\r\n2.change name sequenceNumber to sequenceNumberOverride\r\n3.update documentation  for method setSequenceNumber\r\n\r\n> With this approach, I think we need a validation that none of the data or delete files that are being replaced have sequence numbers newer than the override sequence number.\r\n\r\nThe override sequence number is init when compact action generate fileScanTasks in https://github.com/apache/iceberg/pull/3204/files#:~:text=long%20sequenceNumber%20%3D%20table.currentSnapshot().sequenceNumber()%3B, so it can guarantee that none of the data or delete files that are being replaced have sequence numbers newer than the override sequence number.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939736573/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939898876","html_url":"https://github.com/apache/iceberg/pull/3264#issuecomment-939898876","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3264","id":939898876,"node_id":"IC_kwDOCW7NX844Bbf8","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-11T10:28:16Z","updated_at":"2021-10-11T10:28:16Z","author_association":"CONTRIBUTOR","body":"Thanks for the catch and fix @jshmchenxi!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939898876/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939903825","html_url":"https://github.com/apache/iceberg/issues/2301#issuecomment-939903825","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2301","id":939903825,"node_id":"IC_kwDOCW7NX844BctR","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-11T10:35:37Z","updated_at":"2021-10-11T10:35:37Z","author_association":"CONTRIBUTOR","body":"@zhangminglei:\r\nThe code path protected by the lock does this:\r\n```\r\nacquireLock()\r\n  loadHmsTable()\r\n  setHmsTableParameters(newMetadataLocation, tbl, metadata.properties(), removedProps, hiveEngineEnabled, summary);\r\n  persistTable(tbl, updateHiveTable)\r\nunlock(lockId)\r\n```\r\n\r\nThis is 2 HMS calls and some object data update. So this should not take very long. Also the TXN_TIMEOUT is configured to 300s by default.\r\n\r\nAll that said, you are right, that in extreme scenarios this could be a problem.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939903825/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939941286","html_url":"https://github.com/apache/iceberg/pull/3269#issuecomment-939941286","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3269","id":939941286,"node_id":"IC_kwDOCW7NX844Bl2m","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-11T11:27:32Z","updated_at":"2021-10-11T11:27:32Z","author_association":"CONTRIBUTOR","body":"In Hive we enabled  this in [HIVE-25344](https://issues.apache.org/jira/browse/HIVE-25344):\r\n```\r\nSELECT * FROM t FOR SYSTEM_TIME AS OF <timestamp>;\r\nSELECT * FROM t FOR SYSTEM_VERSION AS OF <version>;\r\n```\r\n\r\nHaving different ways to do time travel with different engines will cause confusion for the users. Would it be good to keep the standard SQL syntax as we did in Hive?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/939941286/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940005545","html_url":"https://github.com/apache/iceberg/pull/3264#issuecomment-940005545","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3264","id":940005545,"node_id":"IC_kwDOCW7NX844B1ip","user":{"login":"jshmchenxi","id":11854435,"node_id":"MDQ6VXNlcjExODU0NDM1","avatar_url":"https://avatars.githubusercontent.com/u/11854435?v=4","gravatar_id":"","url":"https://api.github.com/users/jshmchenxi","html_url":"https://github.com/jshmchenxi","followers_url":"https://api.github.com/users/jshmchenxi/followers","following_url":"https://api.github.com/users/jshmchenxi/following{/other_user}","gists_url":"https://api.github.com/users/jshmchenxi/gists{/gist_id}","starred_url":"https://api.github.com/users/jshmchenxi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jshmchenxi/subscriptions","organizations_url":"https://api.github.com/users/jshmchenxi/orgs","repos_url":"https://api.github.com/users/jshmchenxi/repos","events_url":"https://api.github.com/users/jshmchenxi/events{/privacy}","received_events_url":"https://api.github.com/users/jshmchenxi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-11T12:58:00Z","updated_at":"2021-10-11T12:58:00Z","author_association":"CONTRIBUTOR","body":"@pvary Thanks for merging this!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940005545/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940048252","html_url":"https://github.com/apache/iceberg/pull/2935#issuecomment-940048252","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2935","id":940048252,"node_id":"IC_kwDOCW7NX844B_98","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-11T13:47:33Z","updated_at":"2021-10-11T13:47:33Z","author_association":"CONTRIBUTOR","body":"The solution in #3250 seems better, so closing this PR.\r\nWill ping everybody who participated in the review there.\r\n\r\nThanks,\r\nPeter","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940048252/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940051016","html_url":"https://github.com/apache/iceberg/pull/3250#issuecomment-940051016","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3250","id":940051016,"node_id":"IC_kwDOCW7NX844CApI","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-11T13:51:00Z","updated_at":"2021-10-11T13:51:00Z","author_association":"CONTRIBUTOR","body":"This seems like a better solution for #2935.\r\nThis PR is build on #3248.\r\n\r\nThe first commit in this PR is the squashed commits of #3248, the next 3 changes are unique for this.\r\n\r\nIf you have time, could you please review: @kbendick, @aokolnychyi, @rdblue?\r\n\r\n@openinx: Answered your comments, and did the appropriate changes. Thanks for your time!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940051016/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940090754","html_url":"https://github.com/apache/iceberg/pull/3155#issuecomment-940090754","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3155","id":940090754,"node_id":"IC_kwDOCW7NX844CKWC","user":{"login":"szlta","id":40628386,"node_id":"MDQ6VXNlcjQwNjI4Mzg2","avatar_url":"https://avatars.githubusercontent.com/u/40628386?v=4","gravatar_id":"","url":"https://api.github.com/users/szlta","html_url":"https://github.com/szlta","followers_url":"https://api.github.com/users/szlta/followers","following_url":"https://api.github.com/users/szlta/following{/other_user}","gists_url":"https://api.github.com/users/szlta/gists{/gist_id}","starred_url":"https://api.github.com/users/szlta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szlta/subscriptions","organizations_url":"https://api.github.com/users/szlta/orgs","repos_url":"https://api.github.com/users/szlta/repos","events_url":"https://api.github.com/users/szlta/events{/privacy}","received_events_url":"https://api.github.com/users/szlta/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-11T14:38:11Z","updated_at":"2021-10-11T14:38:11Z","author_association":"CONTRIBUTOR","body":"Can you retrigger the tests? I still see some failures :( ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940090754/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940126141","html_url":"https://github.com/apache/iceberg/pull/3162#issuecomment-940126141","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3162","id":940126141,"node_id":"IC_kwDOCW7NX844CS-9","user":{"login":"omarsmak","id":1190920,"node_id":"MDQ6VXNlcjExOTA5MjA=","avatar_url":"https://avatars.githubusercontent.com/u/1190920?v=4","gravatar_id":"","url":"https://api.github.com/users/omarsmak","html_url":"https://github.com/omarsmak","followers_url":"https://api.github.com/users/omarsmak/followers","following_url":"https://api.github.com/users/omarsmak/following{/other_user}","gists_url":"https://api.github.com/users/omarsmak/gists{/gist_id}","starred_url":"https://api.github.com/users/omarsmak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/omarsmak/subscriptions","organizations_url":"https://api.github.com/users/omarsmak/orgs","repos_url":"https://api.github.com/users/omarsmak/repos","events_url":"https://api.github.com/users/omarsmak/events{/privacy}","received_events_url":"https://api.github.com/users/omarsmak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-11T15:20:47Z","updated_at":"2021-10-11T15:20:47Z","author_association":"MEMBER","body":"@rdblue I have moved the logic to `CatalogUtil` instead of `Catalog`. This will work for both `Spark` and `Hive`. For Flink logic will be very similar to `CatalogUtil` but in `FlinkCatalogFactory`. If you think what I did here it makes sense for Hive and Spark, I will add Flink as well with the same logic .","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940126141/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940139665","html_url":"https://github.com/apache/iceberg/pull/3253#issuecomment-940139665","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3253","id":940139665,"node_id":"IC_kwDOCW7NX844CWSR","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-11T15:38:47Z","updated_at":"2021-10-11T15:38:47Z","author_association":"CONTRIBUTOR","body":"Thanks, @samredai!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940139665/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940142106","html_url":"https://github.com/apache/iceberg/pull/3270#issuecomment-940142106","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3270","id":940142106,"node_id":"IC_kwDOCW7NX844CW4a","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-11T15:42:09Z","updated_at":"2021-10-11T15:42:09Z","author_association":"CONTRIBUTOR","body":"@xingbowu, This doesn't add a shaded Jar, it just updates the dependencies. Did you intend to add a shadow Jar configuration?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940142106/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940144060","html_url":"https://github.com/apache/iceberg/pull/3269#issuecomment-940144060","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3269","id":940144060,"node_id":"IC_kwDOCW7NX844CXW8","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-11T15:44:36Z","updated_at":"2021-10-11T15:44:36Z","author_association":"CONTRIBUTOR","body":"@pvary, that would be great. But Spark is unlikely to add that syntax any time soon. I proposed it years ago and had people push back against it. I think it is more important to support time travel in SQL soon than to keep SQL syntax uniform. I know that would be ideal, though.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940144060/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940151632","html_url":"https://github.com/apache/iceberg/pull/3268#issuecomment-940151632","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3268","id":940151632,"node_id":"IC_kwDOCW7NX844CZNQ","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-11T15:55:18Z","updated_at":"2021-10-11T15:55:18Z","author_association":"CONTRIBUTOR","body":"Merged. Thanks, @kbendick!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940151632/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940160199","html_url":"https://github.com/apache/iceberg/pull/3258#issuecomment-940160199","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3258","id":940160199,"node_id":"IC_kwDOCW7NX844CbTH","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-11T16:05:39Z","updated_at":"2021-10-11T16:05:39Z","author_association":"CONTRIBUTOR","body":"@Reo-LEI I didn't completely get your point. The reasoning/logic that Ryan described in the comment seems correct to me. Hence, I'd like to double check with you in case that we missed sth here.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940160199/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940170086","html_url":"https://github.com/apache/iceberg/pull/3258#issuecomment-940170086","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3258","id":940170086,"node_id":"IC_kwDOCW7NX844Cdtm","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-11T16:17:32Z","updated_at":"2021-10-11T16:17:32Z","author_association":"CONTRIBUTOR","body":"@Reo-LEI, the approach in #3103 is similar to what I suggested in this comment: https://github.com/apache/iceberg/pull/3258#issuecomment-939144452. That approach works and is safe, but it still runs checks that I think are unnecessary for the CDC use case. I think it would be better not to run the validation at all if I'm right that it is unnecessary.\r\n\r\n> If user run deleteOrphanFiles action or delete referenced data file by manually/automatically program which is implement by user before flink commit, I think this validation can prevent to commit this not exists files.\r\n\r\nDeleting orphan files does not affect correctness because the files are not referenced.\r\n\r\nRemoving referenced data files (physically or logically) through any process other than `expireSnapshots` is not supported. If you make changes to files underneath a table, Iceberg makes no correctness guarantees.\r\n\r\nBoth of those cases aren't relevant to the problem here. The problem in #2482 is that the validation is incorrectly configured and very likely not required at all.\r\n\r\n> I think the proper way to resolve #2482 is MergingSnapshotProducer.validationHistory shop to travel the not exists snapshots which are delete by expireSnapshots action\r\n\r\nThis is partially correct. The validation should stop trying to use snapshots that have been expired. But doing that by ignoring expired snapshots is not correct. Instead, the validation should be configured to not require the old snapshots.\r\n\r\nAnother way of thinking about this is that the validation is _requesting_ all version of the table back to the beginning of table history. You're right that it doesn't _need_ all of those versions. But the right way to fix this is to stop _requesting_ them rather than breaking the check by ignoring when requested versions aren't available. Does that make sense?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940170086/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940172236","html_url":"https://github.com/apache/iceberg/pull/3258#issuecomment-940172236","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3258","id":940172236,"node_id":"IC_kwDOCW7NX844CePM","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-11T16:20:33Z","updated_at":"2021-10-11T16:20:33Z","author_association":"CONTRIBUTOR","body":"@stevenzwu, can you confirm that we can remove the tests that are failing? I don't think that there is a case where Flink CDC will produce a positional delete file that references files other that those that are being added.\r\n\r\nWe could also add a check to ensure that there are no such files by validating that the set of referenced data files from the positional deletes is a subset of the data files to add.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940172236/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940198703","html_url":"https://github.com/apache/iceberg/pull/3162#issuecomment-940198703","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3162","id":940198703,"node_id":"IC_kwDOCW7NX844Cksv","user":{"login":"omarsmak","id":1190920,"node_id":"MDQ6VXNlcjExOTA5MjA=","avatar_url":"https://avatars.githubusercontent.com/u/1190920?v=4","gravatar_id":"","url":"https://api.github.com/users/omarsmak","html_url":"https://github.com/omarsmak","followers_url":"https://api.github.com/users/omarsmak/followers","following_url":"https://api.github.com/users/omarsmak/following{/other_user}","gists_url":"https://api.github.com/users/omarsmak/gists{/gist_id}","starred_url":"https://api.github.com/users/omarsmak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/omarsmak/subscriptions","organizations_url":"https://api.github.com/users/omarsmak/orgs","repos_url":"https://api.github.com/users/omarsmak/repos","events_url":"https://api.github.com/users/omarsmak/events{/privacy}","received_events_url":"https://api.github.com/users/omarsmak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-11T17:01:10Z","updated_at":"2021-10-11T17:01:10Z","author_association":"MEMBER","body":"@rdblue please take a look at it once again, I hope things now are in place :) ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940198703/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940219333","html_url":"https://github.com/apache/iceberg/pull/3162#issuecomment-940219333","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3162","id":940219333,"node_id":"IC_kwDOCW7NX844CpvF","user":{"login":"omarsmak","id":1190920,"node_id":"MDQ6VXNlcjExOTA5MjA=","avatar_url":"https://avatars.githubusercontent.com/u/1190920?v=4","gravatar_id":"","url":"https://api.github.com/users/omarsmak","html_url":"https://github.com/omarsmak","followers_url":"https://api.github.com/users/omarsmak/followers","following_url":"https://api.github.com/users/omarsmak/following{/other_user}","gists_url":"https://api.github.com/users/omarsmak/gists{/gist_id}","starred_url":"https://api.github.com/users/omarsmak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/omarsmak/subscriptions","organizations_url":"https://api.github.com/users/omarsmak/orgs","repos_url":"https://api.github.com/users/omarsmak/repos","events_url":"https://api.github.com/users/omarsmak/events{/privacy}","received_events_url":"https://api.github.com/users/omarsmak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-11T17:32:45Z","updated_at":"2021-10-11T17:32:45Z","author_association":"MEMBER","body":"Some tests are failing, I will need to check tomorrow why they are failing","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940219333/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940223234","html_url":"https://github.com/apache/iceberg/pull/3273#issuecomment-940223234","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3273","id":940223234,"node_id":"IC_kwDOCW7NX844CqsC","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-11T17:39:57Z","updated_at":"2021-10-11T17:39:57Z","author_association":"COLLABORATOR","body":"@RussellSpitzer @aokolnychyi  fyi","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940223234/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940229399","html_url":"https://github.com/apache/iceberg/pull/3155#issuecomment-940229399","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3155","id":940229399,"node_id":"IC_kwDOCW7NX844CsMX","user":{"login":"omarsmak","id":1190920,"node_id":"MDQ6VXNlcjExOTA5MjA=","avatar_url":"https://avatars.githubusercontent.com/u/1190920?v=4","gravatar_id":"","url":"https://api.github.com/users/omarsmak","html_url":"https://github.com/omarsmak","followers_url":"https://api.github.com/users/omarsmak/followers","following_url":"https://api.github.com/users/omarsmak/following{/other_user}","gists_url":"https://api.github.com/users/omarsmak/gists{/gist_id}","starred_url":"https://api.github.com/users/omarsmak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/omarsmak/subscriptions","organizations_url":"https://api.github.com/users/omarsmak/orgs","repos_url":"https://api.github.com/users/omarsmak/repos","events_url":"https://api.github.com/users/omarsmak/events{/privacy}","received_events_url":"https://api.github.com/users/omarsmak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-11T17:50:02Z","updated_at":"2021-10-11T17:50:02Z","author_association":"MEMBER","body":"@szlta things look good now in the CI :) ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940229399/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940264386","html_url":"https://github.com/apache/iceberg/pull/3256#issuecomment-940264386","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3256","id":940264386,"node_id":"IC_kwDOCW7NX844C0vC","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-11T18:05:19Z","updated_at":"2021-10-11T18:05:19Z","author_association":"CONTRIBUTOR","body":"Thanks for the PR! There are a few aspects I'd like to discuss:\r\n\r\n> 1. should we continue to keep the existing iceberg-spark module as a common module across all versions\r\n\r\nMy original thought in #3237 was that we can define the rule that the shared code can continue to live, and any code that cannot build againt all versions should then be refactored to different version modules. The intention is to minimize duplicated code across version modules, but I don't have enough context yet if this is worth the effort, maybe after refactoring the current code to build across Spark 2 and 3, we don't have much shared code anyway.\r\n\r\n> 2. should we have v3.1 if v3.0 and v3.1 can all be built against v3.0\r\n\r\nIn #3237 I have the concept of a build version and source version. \r\n\r\nThe definition is that build version is the actual version we build Spark, and source version is the smallest version that would be forward compatible until we create the next source version. \r\n\r\nSo in this case, we will have source version v2.4 that can build Spark 2.4.x, source version v3.0 that can build Spark 3.0.x and 3.1.x. And we will have a v3.2 for build versions v3.2.x and forward until we cannot build against v3.2 source. \r\n\r\nThe intention is again to minimize duplicated code by minimizing the number of version folders.\r\n\r\n> 3. How would we handle Scala version in this architecture? \r\n\r\nIn #3237 I had another `scalaVersion` system property to allow setting a flexible Scala version. Do you think that is something worth adding? It doesn't need to be refactored in this PR, just want to know what you think about Scala versioning.\r\n\r\n> 4. What would be the naming scheme for modules after v3.0?\r\n\r\nThis is just something not yet shown in this PR, for example for v3.2, would the package names be something like `:iceberg-spark:spark32-runtime`, or `:iceberg-spark:spark3-2-runtime`, or something else? \r\n\r\nAlso combining with Scala version consideration, if we support that, should we also publish artifacts for all Scala versions we support like what Spark does?\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940264386/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940300490","html_url":"https://github.com/apache/iceberg/pull/3258#issuecomment-940300490","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3258","id":940300490,"node_id":"IC_kwDOCW7NX844C9jK","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-11T18:21:13Z","updated_at":"2021-10-11T18:21:13Z","author_association":"CONTRIBUTOR","body":"@rdblue with the new logic of removing validation in the PR, I agree that we don't need the failed unit test of `testValidateDataFileExist`\r\n\r\n> We could also add a check to ensure that there are no such files by validating that the set of referenced data files from the positional deletes is a subset of the data files to add.\r\n\r\nThat sounds like a good idea.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940300490/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940305888","html_url":"https://github.com/apache/iceberg/pull/3269#issuecomment-940305888","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3269","id":940305888,"node_id":"IC_kwDOCW7NX844C-3g","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-11T18:23:13Z","updated_at":"2021-10-11T18:23:13Z","author_association":"CONTRIBUTOR","body":"I agree with @rdblue that we should allow time travel query using table name. It's not likely for `AS OF` to be supported by all query engines and platforms in the near future. We can only add that when the engine supports it. But there is always a use case for using table name to perform time travel, because there are applications that user only have control of some parts of the SQL such as table name but do not have control over the entire SQL. For those applications, there is no way to add `AS OF` clause even if we support that, and user has to embed the information in the table name. This is also one of the reasons why there is not much motivation in different communities to support `AS OF`.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940305888/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940349557","html_url":"https://github.com/apache/iceberg/issues/3263#issuecomment-940349557","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3263","id":940349557,"node_id":"IC_kwDOCW7NX844DJh1","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-11T18:38:05Z","updated_at":"2021-10-11T18:38:05Z","author_association":"MEMBER","body":"https://github.com/apache/iceberg/issues/2161 -- Another Report of this issue\r\nhttps://github.com/apache/iceberg/issues/2360 -- Our initial problem with running tests for AVRO and ORC\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940349557/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940353933","html_url":"https://github.com/apache/iceberg/issues/3263#issuecomment-940353933","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3263","id":940353933,"node_id":"IC_kwDOCW7NX844DKmN","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-11T18:39:40Z","updated_at":"2021-10-11T19:18:18Z","author_association":"COLLABORATOR","body":"Yea I added a test in my commit, using native Avro file writer (as our use case is trying add_files with avro file, and not an avro table).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940353933/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940376420","html_url":"https://github.com/apache/iceberg/pull/3273#issuecomment-940376420","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3273","id":940376420,"node_id":"IC_kwDOCW7NX844DQFk","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-11T19:17:21Z","updated_at":"2021-10-11T19:20:37Z","author_association":"MEMBER","body":"Checking the evaluators it looks like we really do need a negative 1 here see\r\n\r\nhttps://github.com/apache/iceberg/blob/7aef02b9a192f62740f16a883a6ec955cdcd7aff/api/src/main/java/org/apache/iceberg/expressions/InclusiveMetricsEvaluator.java#L90-L99\r\n\r\nIf we set it to 0 then files will always be ignored, if we set it to -1 then that is currently used as a signal that the file has no metric information and must be scanned.\r\n\r\nThis has been broken ever since we switched from using a direct DataFile constructor \r\n\r\nSo I think we only have a few options\r\n\r\n1. Change the builder so that it allows -1\r\n2. Go back to using the raw datafile constructor\r\n\r\nI think approach 1. is the safest thing to do here for future proofing behavior. Specifically I think we should allow for explicitly setting the rowCount to -1 if and only if the rest of the metrics are empty. This should preserve the behavior of allowing a file without metrics but also insure that we don't have rowcount as -1 when the metrics are set.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940376420/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940383743","html_url":"https://github.com/apache/iceberg/pull/3273#issuecomment-940383743","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3273","id":940383743,"node_id":"IC_kwDOCW7NX844DR3_","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-11T19:27:20Z","updated_at":"2021-10-11T19:27:20Z","author_association":"COLLABORATOR","body":"Thanks for catching that.  Done with approach 1, and also fixed checkstyle.  Watching the tests","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940383743/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940395263","html_url":"https://github.com/apache/iceberg/pull/3177#issuecomment-940395263","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3177","id":940395263,"node_id":"IC_kwDOCW7NX844DUr_","user":{"login":"miR172","id":5323771,"node_id":"MDQ6VXNlcjUzMjM3NzE=","avatar_url":"https://avatars.githubusercontent.com/u/5323771?v=4","gravatar_id":"","url":"https://api.github.com/users/miR172","html_url":"https://github.com/miR172","followers_url":"https://api.github.com/users/miR172/followers","following_url":"https://api.github.com/users/miR172/following{/other_user}","gists_url":"https://api.github.com/users/miR172/gists{/gist_id}","starred_url":"https://api.github.com/users/miR172/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/miR172/subscriptions","organizations_url":"https://api.github.com/users/miR172/orgs","repos_url":"https://api.github.com/users/miR172/repos","events_url":"https://api.github.com/users/miR172/events{/privacy}","received_events_url":"https://api.github.com/users/miR172/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-11T19:48:53Z","updated_at":"2021-10-11T19:48:53Z","author_association":"NONE","body":"Agree that S3 should not be known by Catalog. I'll move it out in our code.\r\nI have some change locally to the existing Catalog, which make it compatible with both plain-JDBC and Jooq impl. \r\nWe can keep Jooq in our own code and contribute the common interfaces.\r\n@nssalian  let's chat on slack and coordinate the work. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940395263/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940399466","html_url":"https://github.com/apache/iceberg/pull/3237#issuecomment-940399466","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3237","id":940399466,"node_id":"IC_kwDOCW7NX844DVtq","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-11T19:56:49Z","updated_at":"2021-10-11T19:56:49Z","author_association":"CONTRIBUTOR","body":"Let me take a look at both PRs.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940399466/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940429387","html_url":"https://github.com/apache/iceberg/pull/3274#issuecomment-940429387","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3274","id":940429387,"node_id":"IC_kwDOCW7NX844DdBL","user":{"login":"nssalian","id":8526007,"node_id":"MDQ6VXNlcjg1MjYwMDc=","avatar_url":"https://avatars.githubusercontent.com/u/8526007?v=4","gravatar_id":"","url":"https://api.github.com/users/nssalian","html_url":"https://github.com/nssalian","followers_url":"https://api.github.com/users/nssalian/followers","following_url":"https://api.github.com/users/nssalian/following{/other_user}","gists_url":"https://api.github.com/users/nssalian/gists{/gist_id}","starred_url":"https://api.github.com/users/nssalian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nssalian/subscriptions","organizations_url":"https://api.github.com/users/nssalian/orgs","repos_url":"https://api.github.com/users/nssalian/repos","events_url":"https://api.github.com/users/nssalian/events{/privacy}","received_events_url":"https://api.github.com/users/nssalian/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-11T20:46:55Z","updated_at":"2021-10-11T20:46:55Z","author_association":"CONTRIBUTOR","body":"CC: @jackye1995 @rdblue ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940429387/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940441345","html_url":"https://github.com/apache/iceberg/pull/3099#issuecomment-940441345","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3099","id":940441345,"node_id":"IC_kwDOCW7NX844Df8B","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-11T21:08:37Z","updated_at":"2021-10-11T21:08:37Z","author_association":"COLLABORATOR","body":"@pvary thanks for review, addressed comments, sorry for delay","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940441345/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940455683","html_url":"https://github.com/apache/iceberg/pull/3256#issuecomment-940455683","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3256","id":940455683,"node_id":"IC_kwDOCW7NX844DjcD","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-11T21:28:07Z","updated_at":"2021-10-11T21:32:00Z","author_association":"CONTRIBUTOR","body":"> 1. should we continue to keep the existing iceberg-spark module as a common module across all versions\r\n\r\nWhile I am generally against sharing code between any versions of Spark, I am 50/50 here. We could probably have a common module for very basic things but then we won't compile that code against the exact Spark version we will be running with. Since the main development will be done against the most recent version, I'd slightly prefer duplicating the classes as then we won't have to reason how public and stable Spark API, which are used in that common module, are.\r\n\r\n> The definition is that build version is the actual version we build Spark, and source version is the smallest version that would be forward compatible until we create the next source version.\r\n\r\nI'd vote for no compatibility between minor versions, only patch releases. We tried that in the past with 3.0 and 3.1 and it slows down the development and makes the life much harder. We are using Spark APIs that change frequently. I'd say having a module for each minor Spark version would be better. I think there will be major features in each upcoming minor Spark version that we will want to consume ASAP.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940455683/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940464300","html_url":"https://github.com/apache/iceberg/pull/3256#issuecomment-940464300","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3256","id":940464300,"node_id":"IC_kwDOCW7NX844Dlis","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-11T21:44:40Z","updated_at":"2021-10-11T21:44:40Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer @szehon-ho @flyrain, any thoughts?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940464300/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940472757","html_url":"https://github.com/apache/iceberg/pull/3274#issuecomment-940472757","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3274","id":940472757,"node_id":"IC_kwDOCW7NX844Dnm1","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-11T22:00:25Z","updated_at":"2021-10-11T22:00:25Z","author_association":"CONTRIBUTOR","body":"@nssalian, we usually try to have PRs focused on just one change. Is it possible to do one for just the namespace table addition?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940472757/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940480177","html_url":"https://github.com/apache/iceberg/pull/3274#issuecomment-940480177","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3274","id":940480177,"node_id":"IC_kwDOCW7NX844Dpax","user":{"login":"nssalian","id":8526007,"node_id":"MDQ6VXNlcjg1MjYwMDc=","avatar_url":"https://avatars.githubusercontent.com/u/8526007?v=4","gravatar_id":"","url":"https://api.github.com/users/nssalian","html_url":"https://github.com/nssalian","followers_url":"https://api.github.com/users/nssalian/followers","following_url":"https://api.github.com/users/nssalian/following{/other_user}","gists_url":"https://api.github.com/users/nssalian/gists{/gist_id}","starred_url":"https://api.github.com/users/nssalian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nssalian/subscriptions","organizations_url":"https://api.github.com/users/nssalian/orgs","repos_url":"https://api.github.com/users/nssalian/repos","events_url":"https://api.github.com/users/nssalian/events{/privacy}","received_events_url":"https://api.github.com/users/nssalian/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-11T22:07:53Z","updated_at":"2021-10-11T22:07:53Z","author_association":"CONTRIBUTOR","body":"> @nssalian, we usually try to have PRs focused on just one change. Is it possible to do one for just the namespace table addition?\r\n\r\nSounds good. I can add that. I'll follow up the other changes in subsequent PRs.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940480177/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940490464","html_url":"https://github.com/apache/iceberg/pull/3275#issuecomment-940490464","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3275","id":940490464,"node_id":"IC_kwDOCW7NX844Dr7g","user":{"login":"nssalian","id":8526007,"node_id":"MDQ6VXNlcjg1MjYwMDc=","avatar_url":"https://avatars.githubusercontent.com/u/8526007?v=4","gravatar_id":"","url":"https://api.github.com/users/nssalian","html_url":"https://github.com/nssalian","followers_url":"https://api.github.com/users/nssalian/followers","following_url":"https://api.github.com/users/nssalian/following{/other_user}","gists_url":"https://api.github.com/users/nssalian/gists{/gist_id}","starred_url":"https://api.github.com/users/nssalian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nssalian/subscriptions","organizations_url":"https://api.github.com/users/nssalian/orgs","repos_url":"https://api.github.com/users/nssalian/repos","events_url":"https://api.github.com/users/nssalian/events{/privacy}","received_events_url":"https://api.github.com/users/nssalian/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-11T22:27:50Z","updated_at":"2021-10-11T22:27:50Z","author_association":"CONTRIBUTOR","body":"CC: @rdblue  @jackye1995 \r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940490464/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940497491","html_url":"https://github.com/apache/iceberg/pull/3274#issuecomment-940497491","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3274","id":940497491,"node_id":"IC_kwDOCW7NX844DtpT","user":{"login":"nssalian","id":8526007,"node_id":"MDQ6VXNlcjg1MjYwMDc=","avatar_url":"https://avatars.githubusercontent.com/u/8526007?v=4","gravatar_id":"","url":"https://api.github.com/users/nssalian","html_url":"https://github.com/nssalian","followers_url":"https://api.github.com/users/nssalian/followers","following_url":"https://api.github.com/users/nssalian/following{/other_user}","gists_url":"https://api.github.com/users/nssalian/gists{/gist_id}","starred_url":"https://api.github.com/users/nssalian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nssalian/subscriptions","organizations_url":"https://api.github.com/users/nssalian/orgs","repos_url":"https://api.github.com/users/nssalian/repos","events_url":"https://api.github.com/users/nssalian/events{/privacy}","received_events_url":"https://api.github.com/users/nssalian/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-11T22:43:49Z","updated_at":"2021-10-11T22:44:04Z","author_association":"CONTRIBUTOR","body":"PRs to follow:\r\n- [ ] Namespace table  - https://github.com/apache/iceberg/pull/3275\r\n- [ ] Support Namespace properties (set and remove)\r\n- [ ] Table to Namespace relation ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940497491/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940505714","html_url":"https://github.com/apache/iceberg/pull/3273#issuecomment-940505714","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3273","id":940505714,"node_id":"IC_kwDOCW7NX844Dvpy","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-11T23:04:51Z","updated_at":"2021-10-11T23:04:51Z","author_association":"COLLABORATOR","body":"Added the check mentioned in the last comment:\r\n\r\n> Specifically I think we should allow for explicitly setting the rowCount to -1 if and only if the rest of the metrics are empty.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940505714/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940601867","html_url":"https://github.com/apache/iceberg/pull/3249#issuecomment-940601867","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3249","id":940601867,"node_id":"IC_kwDOCW7NX844EHIL","user":{"login":"ConeyLiu","id":12733256,"node_id":"MDQ6VXNlcjEyNzMzMjU2","avatar_url":"https://avatars.githubusercontent.com/u/12733256?v=4","gravatar_id":"","url":"https://api.github.com/users/ConeyLiu","html_url":"https://github.com/ConeyLiu","followers_url":"https://api.github.com/users/ConeyLiu/followers","following_url":"https://api.github.com/users/ConeyLiu/following{/other_user}","gists_url":"https://api.github.com/users/ConeyLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/ConeyLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ConeyLiu/subscriptions","organizations_url":"https://api.github.com/users/ConeyLiu/orgs","repos_url":"https://api.github.com/users/ConeyLiu/repos","events_url":"https://api.github.com/users/ConeyLiu/events{/privacy}","received_events_url":"https://api.github.com/users/ConeyLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-12T02:31:39Z","updated_at":"2021-10-12T02:31:39Z","author_association":"CONTRIBUTOR","body":"thanks @rdblue  for the review. I will do some refactoring.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940601867/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940660196","html_url":"https://github.com/apache/iceberg/issues/3278#issuecomment-940660196","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3278","id":940660196,"node_id":"IC_kwDOCW7NX844EVXk","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-12T04:56:33Z","updated_at":"2021-10-12T04:56:33Z","author_association":"MEMBER","body":"@openinx @jackye1995 : please assign this issue to me. I want to work on it. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940660196/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940682984","html_url":"https://github.com/apache/iceberg/pull/3269#issuecomment-940682984","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3269","id":940682984,"node_id":"IC_kwDOCW7NX844Ea7o","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-12T05:44:01Z","updated_at":"2021-10-12T05:44:01Z","author_association":"CONTRIBUTOR","body":"> I agree with @rdblue that we should allow time travel query using table name. It's not likely for `AS OF` to be supported by all query engines and platforms in the near future.\r\n\r\nFWIW, Hive and Impala added this feature for Iceberg table using the standard format. I understand the spacial way Spark handles features. What other engines do have problems with implementing the standard and need to use the dot based naming format? \r\n\r\n> But there is always a use case for using table name to perform time travel, because there are applications that user only have control of some parts of the SQL such as table name but do not #have control over the entire SQL.\r\n\r\nFor Hive it was much harder to add the metadata table support, where the metadata table name is delimited by a dot after the real table name.  \r\n\r\nI was always envious of the Spark SQL extension feature. Could we add our own extension to implement time travel with format defined by the standard?\r\n\r\nI fear that if we start using `.` to separate the metadata table name, the snapshot, the branch, the tags, it will be hard to follow which one the user wants to refer to. We have to limit the usable branch and tag names, and also this limits the user to always use the full path to the tables and limits the naming hierarchy to the same depth. \r\n\r\nIf we must use identifier names to express these features I would prefer to use something specific for the feature. Like `@` for tme travel, and `#` for the tags, so it is easier to dechiper the meaning for the user and for the parser as well. \r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940682984/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940704414","html_url":"https://github.com/apache/iceberg/issues/3278#issuecomment-940704414","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3278","id":940704414,"node_id":"IC_kwDOCW7NX844EgKe","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-12T06:27:40Z","updated_at":"2021-10-12T06:29:24Z","author_association":"MEMBER","body":"I saw that already test cases are present [here](https://github.com/apache/iceberg/blob/master/spark3-extensions/src/test/java/org/apache/iceberg/spark/extensions/TestDelete.java). Hence it will be just a document update. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940704414/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]