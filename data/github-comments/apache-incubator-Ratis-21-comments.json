[{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1423801640","html_url":"https://github.com/apache/ratis/pull/819#issuecomment-1423801640","issue_url":"https://api.github.com/repos/apache/ratis/issues/819","id":1423801640,"node_id":"IC_kwDOBMxbGc5U3X0o","user":{"login":"codings-dan","id":26144703,"node_id":"MDQ6VXNlcjI2MTQ0NzAz","avatar_url":"https://avatars.githubusercontent.com/u/26144703?v=4","gravatar_id":"","url":"https://api.github.com/users/codings-dan","html_url":"https://github.com/codings-dan","followers_url":"https://api.github.com/users/codings-dan/followers","following_url":"https://api.github.com/users/codings-dan/following{/other_user}","gists_url":"https://api.github.com/users/codings-dan/gists{/gist_id}","starred_url":"https://api.github.com/users/codings-dan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codings-dan/subscriptions","organizations_url":"https://api.github.com/users/codings-dan/orgs","repos_url":"https://api.github.com/users/codings-dan/repos","events_url":"https://api.github.com/users/codings-dan/events{/privacy}","received_events_url":"https://api.github.com/users/codings-dan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-09T08:20:34Z","updated_at":"2023-02-09T08:20:34Z","author_association":"CONTRIBUTOR","body":"@kaijchen @SzyWilliam Thanks for helping review the pull request!","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1423801640/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1423852018","html_url":"https://github.com/apache/ratis/pull/808#issuecomment-1423852018","issue_url":"https://api.github.com/repos/apache/ratis/issues/808","id":1423852018,"node_id":"IC_kwDOBMxbGc5U3kHy","user":{"login":"kaijchen","id":5821159,"node_id":"MDQ6VXNlcjU4MjExNTk=","avatar_url":"https://avatars.githubusercontent.com/u/5821159?v=4","gravatar_id":"","url":"https://api.github.com/users/kaijchen","html_url":"https://github.com/kaijchen","followers_url":"https://api.github.com/users/kaijchen/followers","following_url":"https://api.github.com/users/kaijchen/following{/other_user}","gists_url":"https://api.github.com/users/kaijchen/gists{/gist_id}","starred_url":"https://api.github.com/users/kaijchen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaijchen/subscriptions","organizations_url":"https://api.github.com/users/kaijchen/orgs","repos_url":"https://api.github.com/users/kaijchen/repos","events_url":"https://api.github.com/users/kaijchen/events{/privacy}","received_events_url":"https://api.github.com/users/kaijchen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-09T09:04:52Z","updated_at":"2023-02-09T09:04:52Z","author_association":"CONTRIBUTOR","body":"> could you add a unit test for the new command? see `ElectionCommandIntegrationTest#testElectionTransferCommand`\r\n\r\nThanks @codings-dan, I have added `ElectionCommandIntegrationTest#testElectionTransferLeaderCommand`.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1423852018/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1424611609","html_url":"https://github.com/apache/ratis/pull/819#issuecomment-1424611609","issue_url":"https://api.github.com/repos/apache/ratis/issues/819","id":1424611609,"node_id":"IC_kwDOBMxbGc5U6dkZ","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-09T18:07:31Z","updated_at":"2023-02-09T18:07:31Z","author_association":"CONTRIBUTOR","body":"+1 the change looks good.\r\n\r\nSorry that I missed this earlier.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1424611609/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1425286145","html_url":"https://github.com/apache/ratis/pull/808#issuecomment-1425286145","issue_url":"https://api.github.com/repos/apache/ratis/issues/808","id":1425286145,"node_id":"IC_kwDOBMxbGc5U9CQB","user":{"login":"kaijchen","id":5821159,"node_id":"MDQ6VXNlcjU4MjExNTk=","avatar_url":"https://avatars.githubusercontent.com/u/5821159?v=4","gravatar_id":"","url":"https://api.github.com/users/kaijchen","html_url":"https://github.com/kaijchen","followers_url":"https://api.github.com/users/kaijchen/followers","following_url":"https://api.github.com/users/kaijchen/following{/other_user}","gists_url":"https://api.github.com/users/kaijchen/gists{/gist_id}","starred_url":"https://api.github.com/users/kaijchen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaijchen/subscriptions","organizations_url":"https://api.github.com/users/kaijchen/orgs","repos_url":"https://api.github.com/users/kaijchen/repos","events_url":"https://api.github.com/users/kaijchen/events{/privacy}","received_events_url":"https://api.github.com/users/kaijchen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-10T07:07:13Z","updated_at":"2023-02-10T07:07:13Z","author_association":"CONTRIBUTOR","body":"> We should have test to transfer a leader who does not have the highest priority. Then, it should get some exception.\r\n\r\nThanks @szetszwo for reviewing. Good idea.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1425286145/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1425911116","html_url":"https://github.com/apache/ratis/pull/820#issuecomment-1425911116","issue_url":"https://api.github.com/repos/apache/ratis/issues/820","id":1425911116,"node_id":"IC_kwDOBMxbGc5U_a1M","user":{"login":"kaijchen","id":5821159,"node_id":"MDQ6VXNlcjU4MjExNTk=","avatar_url":"https://avatars.githubusercontent.com/u/5821159?v=4","gravatar_id":"","url":"https://api.github.com/users/kaijchen","html_url":"https://github.com/kaijchen","followers_url":"https://api.github.com/users/kaijchen/followers","following_url":"https://api.github.com/users/kaijchen/following{/other_user}","gists_url":"https://api.github.com/users/kaijchen/gists{/gist_id}","starred_url":"https://api.github.com/users/kaijchen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaijchen/subscriptions","organizations_url":"https://api.github.com/users/kaijchen/orgs","repos_url":"https://api.github.com/users/kaijchen/repos","events_url":"https://api.github.com/users/kaijchen/events{/privacy}","received_events_url":"https://api.github.com/users/kaijchen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-10T14:48:43Z","updated_at":"2023-02-10T14:48:43Z","author_association":"CONTRIBUTOR","body":"Cc @szetszwo @codings-dan, PTAL.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1425911116/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1427224222","html_url":"https://github.com/apache/ratis/pull/820#issuecomment-1427224222","issue_url":"https://api.github.com/repos/apache/ratis/issues/820","id":1427224222,"node_id":"IC_kwDOBMxbGc5VEbae","user":{"login":"kaijchen","id":5821159,"node_id":"MDQ6VXNlcjU4MjExNTk=","avatar_url":"https://avatars.githubusercontent.com/u/5821159?v=4","gravatar_id":"","url":"https://api.github.com/users/kaijchen","html_url":"https://github.com/kaijchen","followers_url":"https://api.github.com/users/kaijchen/followers","following_url":"https://api.github.com/users/kaijchen/following{/other_user}","gists_url":"https://api.github.com/users/kaijchen/gists{/gist_id}","starred_url":"https://api.github.com/users/kaijchen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaijchen/subscriptions","organizations_url":"https://api.github.com/users/kaijchen/orgs","repos_url":"https://api.github.com/users/kaijchen/repos","events_url":"https://api.github.com/users/kaijchen/events{/privacy}","received_events_url":"https://api.github.com/users/kaijchen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-13T02:07:18Z","updated_at":"2023-02-13T02:07:18Z","author_association":"CONTRIBUTOR","body":"Thanks @szetszwo for the review.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1427224222/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1429110804","html_url":"https://github.com/apache/ratis/pull/808#issuecomment-1429110804","issue_url":"https://api.github.com/repos/apache/ratis/issues/808","id":1429110804,"node_id":"IC_kwDOBMxbGc5VLoAU","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-14T04:49:35Z","updated_at":"2023-02-14T04:49:35Z","author_association":"CONTRIBUTOR","body":"@kaijchen , I am thinking how to deal with the existing and the new commands.\r\n\r\n- The new `election transferLeader` command, since it won't change priorities, actually is yielding the leadership.  How about we call it `election yield`?\r\n\r\n- The existing `election transfer` command is still useful since it can transfer the leader to a lower priority peer.  How about we don't deprecate it?","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1429110804/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1429844030","html_url":"https://github.com/apache/ratis/pull/808#issuecomment-1429844030","issue_url":"https://api.github.com/repos/apache/ratis/issues/808","id":1429844030,"node_id":"IC_kwDOBMxbGc5VObA-","user":{"login":"kaijchen","id":5821159,"node_id":"MDQ6VXNlcjU4MjExNTk=","avatar_url":"https://avatars.githubusercontent.com/u/5821159?v=4","gravatar_id":"","url":"https://api.github.com/users/kaijchen","html_url":"https://github.com/kaijchen","followers_url":"https://api.github.com/users/kaijchen/followers","following_url":"https://api.github.com/users/kaijchen/following{/other_user}","gists_url":"https://api.github.com/users/kaijchen/gists{/gist_id}","starred_url":"https://api.github.com/users/kaijchen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaijchen/subscriptions","organizations_url":"https://api.github.com/users/kaijchen/orgs","repos_url":"https://api.github.com/users/kaijchen/repos","events_url":"https://api.github.com/users/kaijchen/events{/privacy}","received_events_url":"https://api.github.com/users/kaijchen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-14T14:34:25Z","updated_at":"2023-02-14T14:35:16Z","author_association":"CONTRIBUTOR","body":"> * The new `election transferLeader` command, since it won't change priorities, actually is yielding the leadership.  How about we call it `election yield`?\r\n\r\nI'm OK to call it `election yield`, but since raft paper call it transfer leadership, users may get confused.\r\n\r\n> * The existing `election transfer` command is still useful since it can transfer the leader to a lower priority peer.  How about we don't deprecate it?\r\n\r\nThe existing `election transfer` is equal to `peer setPriority` plus `election transferLeader`. User can still achieve the same functionality, and the priority will be set by user explicitly (so the user knows exactly what is going on).\r\n\r\nBased on these reasons, I chose to deprecate the old command. @szetszwo What do you think?","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1429844030/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1430294500","html_url":"https://github.com/apache/ratis/pull/808#issuecomment-1430294500","issue_url":"https://api.github.com/repos/apache/ratis/issues/808","id":1430294500,"node_id":"IC_kwDOBMxbGc5VQI_k","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-14T19:52:40Z","updated_at":"2023-02-14T19:52:40Z","author_association":"CONTRIBUTOR","body":"@kaijchen , I got a new idea -- we may update the `election transfer` as following:\r\n- Since we already have the `getRaftGroup()` returned from the server, we can check priorities to decide whether to call `setConfiguration`.  It will call `setConfiguration` only if the transferee has smaller priority.\r\n- Then, we don't need a new command.\r\n\r\nWe do you think?","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1430294500/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1430674627","html_url":"https://github.com/apache/ratis/pull/808#issuecomment-1430674627","issue_url":"https://api.github.com/repos/apache/ratis/issues/808","id":1430674627,"node_id":"IC_kwDOBMxbGc5VRlzD","user":{"login":"kaijchen","id":5821159,"node_id":"MDQ6VXNlcjU4MjExNTk=","avatar_url":"https://avatars.githubusercontent.com/u/5821159?v=4","gravatar_id":"","url":"https://api.github.com/users/kaijchen","html_url":"https://github.com/kaijchen","followers_url":"https://api.github.com/users/kaijchen/followers","following_url":"https://api.github.com/users/kaijchen/following{/other_user}","gists_url":"https://api.github.com/users/kaijchen/gists{/gist_id}","starred_url":"https://api.github.com/users/kaijchen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaijchen/subscriptions","organizations_url":"https://api.github.com/users/kaijchen/orgs","repos_url":"https://api.github.com/users/kaijchen/repos","events_url":"https://api.github.com/users/kaijchen/events{/privacy}","received_events_url":"https://api.github.com/users/kaijchen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-15T02:46:50Z","updated_at":"2023-02-15T02:46:50Z","author_association":"CONTRIBUTOR","body":"> * Then, we don't need a new command.\r\n\r\nThe old server (prior to 2.4.1) always requires the transferee to have the highest priority for transfer leadership.\r\nWe are keeping the old `transfer` command for backward compatibility. Is there a way to get the server version?\r\n\r\n> * Since we already have the `getRaftGroup()` returned from the server, we can check priorities to decide whether to call `setConfiguration`.  It will call `setConfiguration` only if the transferee has smaller priority.\r\n\r\nPersonally I prefer to print a message like \"transferee does not have highest priority, please call `setPriority` first\".\r\nOr add a `-force` option, to set the transferee to highest priority.\r\n\r\n## Example\r\n\r\nlet's say we have a cluster like this,\r\n\r\n| Peer | A | B | C | D | E |\r\n| --- | --- | --- | --- | --- | --- |\r\n| Priority | 3 | 2 | 2 | 1 | 1 |\r\n\r\n### New server\r\n\r\nIf we want to transfer leader from A to E, we should only raise E's priority to highest.\r\nSo if peer E is down afterwards, the old priority remains.\r\n\r\n| Peer | A | B | C | D | E |\r\n| --- | --- | --- | --- | --- | --- |\r\n| Priority | 3 | 2 | 2 | 1 | 3 |\r\n\r\n### Old server\r\n\r\nSince the old server requires transferee to be the **only** peer with highest priority.\r\nThe best we can do is:\r\n\r\n| Peer | A | B | C | D | E |\r\n| --- | --- | --- | --- | --- | --- |\r\n| Priority | 3 | 2 | 2 | 1 | 4 |\r\n\r\nHowever, the old command will reset every node's priority, and the old priority is erased.\r\n\r\n| Peer | A | B | C | D | E |\r\n| --- | --- | --- | --- | --- | --- |\r\n| Priority | 1 | 1 | 1 | 1 | 2 |\r\n ","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1430674627/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1431016422","html_url":"https://github.com/apache/ratis/pull/808#issuecomment-1431016422","issue_url":"https://api.github.com/repos/apache/ratis/issues/808","id":1431016422,"node_id":"IC_kwDOBMxbGc5VS5Pm","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-15T09:34:24Z","updated_at":"2023-02-15T09:34:24Z","author_association":"CONTRIBUTOR","body":"@kaijchen , that's a good point.  We may change the existing `election transfer` command as you described:\r\n- If the target peer already has the highest priority, do not call `setConfiguration`.\r\n- If not, call `setConfiguration` to change only the target peer to the highest priority.\r\n\r\nDoes it sound good?","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1431016422/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1431023761","html_url":"https://github.com/apache/ratis/pull/808#issuecomment-1431023761","issue_url":"https://api.github.com/repos/apache/ratis/issues/808","id":1431023761,"node_id":"IC_kwDOBMxbGc5VS7CR","user":{"login":"kaijchen","id":5821159,"node_id":"MDQ6VXNlcjU4MjExNTk=","avatar_url":"https://avatars.githubusercontent.com/u/5821159?v=4","gravatar_id":"","url":"https://api.github.com/users/kaijchen","html_url":"https://github.com/kaijchen","followers_url":"https://api.github.com/users/kaijchen/followers","following_url":"https://api.github.com/users/kaijchen/following{/other_user}","gists_url":"https://api.github.com/users/kaijchen/gists{/gist_id}","starred_url":"https://api.github.com/users/kaijchen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaijchen/subscriptions","organizations_url":"https://api.github.com/users/kaijchen/orgs","repos_url":"https://api.github.com/users/kaijchen/repos","events_url":"https://api.github.com/users/kaijchen/events{/privacy}","received_events_url":"https://api.github.com/users/kaijchen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-15T09:40:26Z","updated_at":"2023-02-15T09:45:15Z","author_association":"CONTRIBUTOR","body":"> * If the target peer already has the highest priority, do not call `setConfiguration`.\r\n> * If not, call `setConfiguration` to change only the target peer to the highest priority.\r\n> \r\n> Does it sound good?\r\n\r\nYes. But how do we deal with old server (backward compatibility)?\r\nFor example, for new servers (with RATIS-1762), we don't need to change priority in the following situation.\r\nBut for old servers (without RATIS-1762), we have to increase target peer's priority to 2.\r\n\r\n| Peer | A | B | C | D | E |\r\n| --- | --- | --- | --- | --- | --- |\r\n| Priority | 1 | 1 | 1 | 1 | 1 |\r\n\r\nCan we just drop backward compatibility?\r\ni.e. The transfer command of Ratis shell 3.0.0 won't work with Ratis 2.4.1 servers.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1431023761/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1431890415","html_url":"https://github.com/apache/ratis/pull/808#issuecomment-1431890415","issue_url":"https://api.github.com/repos/apache/ratis/issues/808","id":1431890415,"node_id":"IC_kwDOBMxbGc5VWOnv","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-15T19:19:18Z","updated_at":"2023-02-15T19:19:18Z","author_association":"CONTRIBUTOR","body":"> ... how do we deal with old server (backward compatibility)?\r\n\r\n@kaijchen , When a new client talking to an old server, the client in that case should get a `TransferLeadershipException` saying that the target server does not have the highest priority.  Then, we can send the `setConfiguration` in that case.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1431890415/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1432372112","html_url":"https://github.com/apache/ratis/pull/808#issuecomment-1432372112","issue_url":"https://api.github.com/repos/apache/ratis/issues/808","id":1432372112,"node_id":"IC_kwDOBMxbGc5VYEOQ","user":{"login":"kaijchen","id":5821159,"node_id":"MDQ6VXNlcjU4MjExNTk=","avatar_url":"https://avatars.githubusercontent.com/u/5821159?v=4","gravatar_id":"","url":"https://api.github.com/users/kaijchen","html_url":"https://github.com/kaijchen","followers_url":"https://api.github.com/users/kaijchen/followers","following_url":"https://api.github.com/users/kaijchen/following{/other_user}","gists_url":"https://api.github.com/users/kaijchen/gists{/gist_id}","starred_url":"https://api.github.com/users/kaijchen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaijchen/subscriptions","organizations_url":"https://api.github.com/users/kaijchen/orgs","repos_url":"https://api.github.com/users/kaijchen/repos","events_url":"https://api.github.com/users/kaijchen/events{/privacy}","received_events_url":"https://api.github.com/users/kaijchen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-16T02:10:33Z","updated_at":"2023-02-16T02:10:33Z","author_association":"CONTRIBUTOR","body":"> @kaijchen , When a new client talking to an old server, the client in that case should get a `TransferLeadershipException` saying that the target server does not have the highest priority. Then, we can send the `setConfiguration` in that case.\r\n\r\nOK, sounds good.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1432372112/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1432720999","html_url":"https://github.com/apache/ratis/pull/808#issuecomment-1432720999","issue_url":"https://api.github.com/repos/apache/ratis/issues/808","id":1432720999,"node_id":"IC_kwDOBMxbGc5VZZZn","user":{"login":"kaijchen","id":5821159,"node_id":"MDQ6VXNlcjU4MjExNTk=","avatar_url":"https://avatars.githubusercontent.com/u/5821159?v=4","gravatar_id":"","url":"https://api.github.com/users/kaijchen","html_url":"https://github.com/kaijchen","followers_url":"https://api.github.com/users/kaijchen/followers","following_url":"https://api.github.com/users/kaijchen/following{/other_user}","gists_url":"https://api.github.com/users/kaijchen/gists{/gist_id}","starred_url":"https://api.github.com/users/kaijchen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaijchen/subscriptions","organizations_url":"https://api.github.com/users/kaijchen/orgs","repos_url":"https://api.github.com/users/kaijchen/repos","events_url":"https://api.github.com/users/kaijchen/events{/privacy}","received_events_url":"https://api.github.com/users/kaijchen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-16T08:47:13Z","updated_at":"2023-02-16T08:47:13Z","author_association":"CONTRIBUTOR","body":"Manually test backward compatibility, Ratis shell version `3.0.0-SNAPSHOT`, Ratis server version `2.4.1`:\r\n```console\r\n$ bin/ratis sh election transfer -peers 127.0.0.1:10024,127.0.0.1:10124,127.0.0.1:11124 -address 127.0.0.1:11124\r\n[main] INFO org.reflections.Reflections - Reflections took 164 ms to scan 1 urls, producing 5 keys and 18 values\r\n[main] WARN org.apache.ratis.metrics.MetricRegistries - Found multiple MetricRegistries implementations: class org.apache.ratis.metrics.impl.MetricRegistriesImpl, class org.apache.ratis.metrics.dropwizard3.Dm3MetricRegistriesImpl. Using first found implementation: org.apache.ratis.metrics.impl.MetricRegistriesImpl@1e67a849\r\nTransferring leadership to server with address <127.0.0.1:11124> \r\nChanging priority of <127.0.0.1:11124> to 1\r\n: caught an error when executing transfer: n0@group-ABB3109A44C1 refused to transfer leadership to peer n2 as it does not has highest priority 9: peers:[n0|rpc:127.0.0.1:10024|admin:|client:|dataStream:|priority:1|startupRole:FOLLOWER, n1|rpc:127.0.0.1:10124|admin:|client:|dataStream:|priority:0|startupRole:FOLLOWER, n2|rpc:127.0.0.1:11124|admin:|client:|dataStream:|priority:1|startupRole:FOLLOWER]|listeners:[], old=null\r\nTransferring leadership to server with address <127.0.0.1:11124> \r\nChanging priority of <127.0.0.1:11124> to 2\r\n: Transferring leadership initiated\r\n```","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1432720999/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1432998040","html_url":"https://github.com/apache/ratis/pull/808#issuecomment-1432998040","issue_url":"https://api.github.com/repos/apache/ratis/issues/808","id":1432998040,"node_id":"IC_kwDOBMxbGc5VadCY","user":{"login":"kaijchen","id":5821159,"node_id":"MDQ6VXNlcjU4MjExNTk=","avatar_url":"https://avatars.githubusercontent.com/u/5821159?v=4","gravatar_id":"","url":"https://api.github.com/users/kaijchen","html_url":"https://github.com/kaijchen","followers_url":"https://api.github.com/users/kaijchen/followers","following_url":"https://api.github.com/users/kaijchen/following{/other_user}","gists_url":"https://api.github.com/users/kaijchen/gists{/gist_id}","starred_url":"https://api.github.com/users/kaijchen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaijchen/subscriptions","organizations_url":"https://api.github.com/users/kaijchen/orgs","repos_url":"https://api.github.com/users/kaijchen/repos","events_url":"https://api.github.com/users/kaijchen/events{/privacy}","received_events_url":"https://api.github.com/users/kaijchen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-16T12:14:44Z","updated_at":"2023-02-16T12:14:44Z","author_association":"CONTRIBUTOR","body":"Note: sometimes transfer leadership succeeds, but the request timed out.\r\nThis is due to the old leader hasn't received any messages from the new leader yet.\r\nEspecially in default timeout, i.e. `TransferLeadershipRequest.timeout = 0`,\r\nthe timeout will default to `server.randomElectionTimeout()`.\r\n\r\nThis will lead to `TransferCommand` to return -1, and cause flaky test.\r\nSo is it better to set a larger default timeout?\r\n\r\nTo fix this problem, we should wait for the new leader to be elected in the shell.\r\nBut `AbstractRatisCommand` seems didn't expect the leader to change.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1432998040/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1436456680","html_url":"https://github.com/apache/ratis/pull/808#issuecomment-1436456680","issue_url":"https://api.github.com/repos/apache/ratis/issues/808","id":1436456680,"node_id":"IC_kwDOBMxbGc5Vnpbo","user":{"login":"kaijchen","id":5821159,"node_id":"MDQ6VXNlcjU4MjExNTk=","avatar_url":"https://avatars.githubusercontent.com/u/5821159?v=4","gravatar_id":"","url":"https://api.github.com/users/kaijchen","html_url":"https://github.com/kaijchen","followers_url":"https://api.github.com/users/kaijchen/followers","following_url":"https://api.github.com/users/kaijchen/following{/other_user}","gists_url":"https://api.github.com/users/kaijchen/gists{/gist_id}","starred_url":"https://api.github.com/users/kaijchen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaijchen/subscriptions","organizations_url":"https://api.github.com/users/kaijchen/orgs","repos_url":"https://api.github.com/users/kaijchen/repos","events_url":"https://api.github.com/users/kaijchen/events{/privacy}","received_events_url":"https://api.github.com/users/kaijchen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-20T07:08:41Z","updated_at":"2023-02-20T07:08:41Z","author_association":"CONTRIBUTOR","body":"> Note: sometimes transfer leadership succeeds, but the request timed out. This is due to the old leader hasn't received any messages from the new leader yet. Especially in default timeout, i.e. `TransferLeadershipRequest.timeout = 0`, the timeout will default to `server.randomElectionTimeout()`.\r\n> \r\n> This will lead to `TransferCommand` to return -1, and cause flaky test. So is it better to set a larger default timeout?\r\n\r\nSet default timeout to `3s` in the new mode. The default timeout in legacy mode (fallback) is kept as `60s`.\r\n\r\n> To fix this problem, we should wait for the new leader to be elected in the shell. But `AbstractRatisCommand` seems didn't expect the leader to change.\r\n\r\nAdded TODO in comments. It's better to keep changes small in this PR.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1436456680/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1436458778","html_url":"https://github.com/apache/ratis/pull/808#issuecomment-1436458778","issue_url":"https://api.github.com/repos/apache/ratis/issues/808","id":1436458778,"node_id":"IC_kwDOBMxbGc5Vnp8a","user":{"login":"kaijchen","id":5821159,"node_id":"MDQ6VXNlcjU4MjExNTk=","avatar_url":"https://avatars.githubusercontent.com/u/5821159?v=4","gravatar_id":"","url":"https://api.github.com/users/kaijchen","html_url":"https://github.com/kaijchen","followers_url":"https://api.github.com/users/kaijchen/followers","following_url":"https://api.github.com/users/kaijchen/following{/other_user}","gists_url":"https://api.github.com/users/kaijchen/gists{/gist_id}","starred_url":"https://api.github.com/users/kaijchen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaijchen/subscriptions","organizations_url":"https://api.github.com/users/kaijchen/orgs","repos_url":"https://api.github.com/users/kaijchen/repos","events_url":"https://api.github.com/users/kaijchen/events{/privacy}","received_events_url":"https://api.github.com/users/kaijchen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-20T07:10:27Z","updated_at":"2023-02-20T07:10:27Z","author_association":"CONTRIBUTOR","body":"@szetszwo please take another look, thanks.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1436458778/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1437781663","html_url":"https://github.com/apache/ratis/pull/808#issuecomment-1437781663","issue_url":"https://api.github.com/repos/apache/ratis/issues/808","id":1437781663,"node_id":"IC_kwDOBMxbGc5Vss6f","user":{"login":"kaijchen","id":5821159,"node_id":"MDQ6VXNlcjU4MjExNTk=","avatar_url":"https://avatars.githubusercontent.com/u/5821159?v=4","gravatar_id":"","url":"https://api.github.com/users/kaijchen","html_url":"https://github.com/kaijchen","followers_url":"https://api.github.com/users/kaijchen/followers","following_url":"https://api.github.com/users/kaijchen/following{/other_user}","gists_url":"https://api.github.com/users/kaijchen/gists{/gist_id}","starred_url":"https://api.github.com/users/kaijchen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaijchen/subscriptions","organizations_url":"https://api.github.com/users/kaijchen/orgs","repos_url":"https://api.github.com/users/kaijchen/repos","events_url":"https://api.github.com/users/kaijchen/events{/privacy}","received_events_url":"https://api.github.com/users/kaijchen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-21T02:41:29Z","updated_at":"2023-02-21T02:41:29Z","author_association":"CONTRIBUTOR","body":"Thanks @szetszwo for the review, updated.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1437781663/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1438621202","html_url":"https://github.com/apache/ratis/pull/824#issuecomment-1438621202","issue_url":"https://api.github.com/repos/apache/ratis/issues/824","id":1438621202,"node_id":"IC_kwDOBMxbGc5Vv54S","user":{"login":"OneSizeFitsQuorum","id":32640567,"node_id":"MDQ6VXNlcjMyNjQwNTY3","avatar_url":"https://avatars.githubusercontent.com/u/32640567?v=4","gravatar_id":"","url":"https://api.github.com/users/OneSizeFitsQuorum","html_url":"https://github.com/OneSizeFitsQuorum","followers_url":"https://api.github.com/users/OneSizeFitsQuorum/followers","following_url":"https://api.github.com/users/OneSizeFitsQuorum/following{/other_user}","gists_url":"https://api.github.com/users/OneSizeFitsQuorum/gists{/gist_id}","starred_url":"https://api.github.com/users/OneSizeFitsQuorum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/OneSizeFitsQuorum/subscriptions","organizations_url":"https://api.github.com/users/OneSizeFitsQuorum/orgs","repos_url":"https://api.github.com/users/OneSizeFitsQuorum/repos","events_url":"https://api.github.com/users/OneSizeFitsQuorum/events{/privacy}","received_events_url":"https://api.github.com/users/OneSizeFitsQuorum/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-21T14:53:01Z","updated_at":"2023-02-21T14:53:01Z","author_association":"CONTRIBUTOR","body":"@szetszwo PTAL","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1438621202/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1438658616","html_url":"https://github.com/apache/ratis/pull/825#issuecomment-1438658616","issue_url":"https://api.github.com/repos/apache/ratis/issues/825","id":1438658616,"node_id":"IC_kwDOBMxbGc5VwDA4","user":{"login":"OneSizeFitsQuorum","id":32640567,"node_id":"MDQ6VXNlcjMyNjQwNTY3","avatar_url":"https://avatars.githubusercontent.com/u/32640567?v=4","gravatar_id":"","url":"https://api.github.com/users/OneSizeFitsQuorum","html_url":"https://github.com/OneSizeFitsQuorum","followers_url":"https://api.github.com/users/OneSizeFitsQuorum/followers","following_url":"https://api.github.com/users/OneSizeFitsQuorum/following{/other_user}","gists_url":"https://api.github.com/users/OneSizeFitsQuorum/gists{/gist_id}","starred_url":"https://api.github.com/users/OneSizeFitsQuorum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/OneSizeFitsQuorum/subscriptions","organizations_url":"https://api.github.com/users/OneSizeFitsQuorum/orgs","repos_url":"https://api.github.com/users/OneSizeFitsQuorum/repos","events_url":"https://api.github.com/users/OneSizeFitsQuorum/events{/privacy}","received_events_url":"https://api.github.com/users/OneSizeFitsQuorum/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-21T15:16:31Z","updated_at":"2023-02-21T15:16:31Z","author_association":"CONTRIBUTOR","body":"@szetszwo PTAL","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1438658616/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1439026937","html_url":"https://github.com/apache/ratis/pull/825#issuecomment-1439026937","issue_url":"https://api.github.com/repos/apache/ratis/issues/825","id":1439026937,"node_id":"IC_kwDOBMxbGc5Vxc75","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-21T20:04:38Z","updated_at":"2023-02-21T20:04:38Z","author_association":"CONTRIBUTOR","body":"@OneSizeFitsQuorum , welcome to Apache Ratis!\r\n","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1439026937/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1442777490","html_url":"https://github.com/apache/ratis/pull/827#issuecomment-1442777490","issue_url":"https://api.github.com/repos/apache/ratis/issues/827","id":1442777490,"node_id":"IC_kwDOBMxbGc5V_wmS","user":{"login":"kaijchen","id":5821159,"node_id":"MDQ6VXNlcjU4MjExNTk=","avatar_url":"https://avatars.githubusercontent.com/u/5821159?v=4","gravatar_id":"","url":"https://api.github.com/users/kaijchen","html_url":"https://github.com/kaijchen","followers_url":"https://api.github.com/users/kaijchen/followers","following_url":"https://api.github.com/users/kaijchen/following{/other_user}","gists_url":"https://api.github.com/users/kaijchen/gists{/gist_id}","starred_url":"https://api.github.com/users/kaijchen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaijchen/subscriptions","organizations_url":"https://api.github.com/users/kaijchen/orgs","repos_url":"https://api.github.com/users/kaijchen/repos","events_url":"https://api.github.com/users/kaijchen/events{/privacy}","received_events_url":"https://api.github.com/users/kaijchen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-24T04:01:39Z","updated_at":"2023-02-24T04:01:39Z","author_association":"CONTRIBUTOR","body":"Cc @szetszwo ","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1442777490/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1442845195","html_url":"https://github.com/apache/ratis/pull/827#issuecomment-1442845195","issue_url":"https://api.github.com/repos/apache/ratis/issues/827","id":1442845195,"node_id":"IC_kwDOBMxbGc5WABIL","user":{"login":"kaijchen","id":5821159,"node_id":"MDQ6VXNlcjU4MjExNTk=","avatar_url":"https://avatars.githubusercontent.com/u/5821159?v=4","gravatar_id":"","url":"https://api.github.com/users/kaijchen","html_url":"https://github.com/kaijchen","followers_url":"https://api.github.com/users/kaijchen/followers","following_url":"https://api.github.com/users/kaijchen/following{/other_user}","gists_url":"https://api.github.com/users/kaijchen/gists{/gist_id}","starred_url":"https://api.github.com/users/kaijchen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaijchen/subscriptions","organizations_url":"https://api.github.com/users/kaijchen/orgs","repos_url":"https://api.github.com/users/kaijchen/repos","events_url":"https://api.github.com/users/kaijchen/events{/privacy}","received_events_url":"https://api.github.com/users/kaijchen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-24T05:52:05Z","updated_at":"2023-02-24T05:52:05Z","author_association":"CONTRIBUTOR","body":"> repeat 100x: https://github.com/kaijchen/ratis/actions/runs/4259195995\r\n\r\nSorry, no test was executed in this workflow. Probably due to it's a abstract test.\r\nI will edit the link after retry.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1442845195/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1442850668","html_url":"https://github.com/apache/ratis/pull/827#issuecomment-1442850668","issue_url":"https://api.github.com/repos/apache/ratis/issues/827","id":1442850668,"node_id":"IC_kwDOBMxbGc5WACds","user":{"login":"kaijchen","id":5821159,"node_id":"MDQ6VXNlcjU4MjExNTk=","avatar_url":"https://avatars.githubusercontent.com/u/5821159?v=4","gravatar_id":"","url":"https://api.github.com/users/kaijchen","html_url":"https://github.com/kaijchen","followers_url":"https://api.github.com/users/kaijchen/followers","following_url":"https://api.github.com/users/kaijchen/following{/other_user}","gists_url":"https://api.github.com/users/kaijchen/gists{/gist_id}","starred_url":"https://api.github.com/users/kaijchen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaijchen/subscriptions","organizations_url":"https://api.github.com/users/kaijchen/orgs","repos_url":"https://api.github.com/users/kaijchen/repos","events_url":"https://api.github.com/users/kaijchen/events{/privacy}","received_events_url":"https://api.github.com/users/kaijchen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-24T06:01:34Z","updated_at":"2023-02-24T06:01:34Z","author_association":"CONTRIBUTOR","body":"Repeated 100x, found 2 failures (caused by a different reason):\r\nhttps://github.com/kaijchen/ratis/actions/runs/4259760865\r\n\r\n```\r\nError:  Tests run: 1, Failures: 1, Errors: 0, Skipped: 0, Time elapsed: 9.972 s <<< FAILURE! - in org.apache.ratis.server.simulation.TestServerRestartWithSimulatedRpc\r\nError:  testRestartFollower(org.apache.ratis.server.simulation.TestServerRestartWithSimulatedRpc)  Time elapsed: 9.878 s  <<< FAILURE!\r\njava.lang.AssertionError: expected:<38> but was:<39>\r\n\tat org.junit.Assert.fail(Assert.java:89)\r\n\tat org.junit.Assert.failNotEquals(Assert.java:835)\r\n\tat org.junit.Assert.assertEquals(Assert.java:647)\r\n\tat org.junit.Assert.assertEquals(Assert.java:633)\r\n\tat org.apache.ratis.server.ServerRestartTests.assertTruncatedLog(ServerRestartTests.java:171)\r\n\tat org.apache.ratis.server.ServerRestartTests.runTestRestartFollower(ServerRestartTests.java:135)\r\n\tat org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:141)\r\n\tat org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:121)\r\n\tat org.apache.ratis.server.ServerRestartTests.testRestartFollower(ServerRestartTests.java:88)\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1442850668/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1442861020","html_url":"https://github.com/apache/ratis/pull/827#issuecomment-1442861020","issue_url":"https://api.github.com/repos/apache/ratis/issues/827","id":1442861020,"node_id":"IC_kwDOBMxbGc5WAE_c","user":{"login":"kaijchen","id":5821159,"node_id":"MDQ6VXNlcjU4MjExNTk=","avatar_url":"https://avatars.githubusercontent.com/u/5821159?v=4","gravatar_id":"","url":"https://api.github.com/users/kaijchen","html_url":"https://github.com/kaijchen","followers_url":"https://api.github.com/users/kaijchen/followers","following_url":"https://api.github.com/users/kaijchen/following{/other_user}","gists_url":"https://api.github.com/users/kaijchen/gists{/gist_id}","starred_url":"https://api.github.com/users/kaijchen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaijchen/subscriptions","organizations_url":"https://api.github.com/users/kaijchen/orgs","repos_url":"https://api.github.com/users/kaijchen/repos","events_url":"https://api.github.com/users/kaijchen/events{/privacy}","received_events_url":"https://api.github.com/users/kaijchen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-24T06:19:14Z","updated_at":"2023-02-24T06:19:14Z","author_association":"CONTRIBUTOR","body":"> Repeated 100x, found 2 failures (caused by a different reason):\r\n> https://github.com/kaijchen/ratis/actions/runs/4259760865\r\n\r\nHowever, if we revert ea73079ea24a39c7dc848152fc5dee8416744bcc, very few runs could pass:\r\nhttps://github.com/kaijchen/ratis/actions/runs/4259839079\r\n\r\nI will look into the 2nd issue later, and try to fix it at my best (maybe in another PR).","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1442861020/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1443357386","html_url":"https://github.com/apache/ratis/pull/827#issuecomment-1443357386","issue_url":"https://api.github.com/repos/apache/ratis/issues/827","id":1443357386,"node_id":"IC_kwDOBMxbGc5WB-LK","user":{"login":"kaijchen","id":5821159,"node_id":"MDQ6VXNlcjU4MjExNTk=","avatar_url":"https://avatars.githubusercontent.com/u/5821159?v=4","gravatar_id":"","url":"https://api.github.com/users/kaijchen","html_url":"https://github.com/kaijchen","followers_url":"https://api.github.com/users/kaijchen/followers","following_url":"https://api.github.com/users/kaijchen/following{/other_user}","gists_url":"https://api.github.com/users/kaijchen/gists{/gist_id}","starred_url":"https://api.github.com/users/kaijchen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaijchen/subscriptions","organizations_url":"https://api.github.com/users/kaijchen/orgs","repos_url":"https://api.github.com/users/kaijchen/repos","events_url":"https://api.github.com/users/kaijchen/events{/privacy}","received_events_url":"https://api.github.com/users/kaijchen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-24T09:40:13Z","updated_at":"2023-02-24T09:40:13Z","author_association":"CONTRIBUTOR","body":"Got a clean run after applied the 2nd fix:\r\nhttps://github.com/kaijchen/ratis/actions/runs/4261057419","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1443357386/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1444139347","html_url":"https://github.com/apache/ratis/pull/830#issuecomment-1444139347","issue_url":"https://api.github.com/repos/apache/ratis/issues/830","id":1444139347,"node_id":"IC_kwDOBMxbGc5WE9FT","user":{"login":"adoroszlai","id":6454655,"node_id":"MDQ6VXNlcjY0NTQ2NTU=","avatar_url":"https://avatars.githubusercontent.com/u/6454655?v=4","gravatar_id":"","url":"https://api.github.com/users/adoroszlai","html_url":"https://github.com/adoroszlai","followers_url":"https://api.github.com/users/adoroszlai/followers","following_url":"https://api.github.com/users/adoroszlai/following{/other_user}","gists_url":"https://api.github.com/users/adoroszlai/gists{/gist_id}","starred_url":"https://api.github.com/users/adoroszlai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adoroszlai/subscriptions","organizations_url":"https://api.github.com/users/adoroszlai/orgs","repos_url":"https://api.github.com/users/adoroszlai/repos","events_url":"https://api.github.com/users/adoroszlai/events{/privacy}","received_events_url":"https://api.github.com/users/adoroszlai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-24T17:54:57Z","updated_at":"2023-02-24T17:54:57Z","author_association":"CONTRIBUTOR","body":"@szetszwo Turns out it was originally committed to `branch-2` as 2226c5eb, but reverted (probably unintentionally) by RATIS-1675 in 7d3716db.  If you agree, I'll close this PR and cherry-pick the original commit directly to `branch-2`.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1444139347/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1444373210","html_url":"https://github.com/apache/ratis/pull/830#issuecomment-1444373210","issue_url":"https://api.github.com/repos/apache/ratis/issues/830","id":1444373210,"node_id":"IC_kwDOBMxbGc5WF2La","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-24T20:00:12Z","updated_at":"2023-02-24T20:00:12Z","author_association":"CONTRIBUTOR","body":"@adoroszlai , sure, let's cherry-pick it.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1444373210/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1444572206","html_url":"https://github.com/apache/ratis/pull/829#issuecomment-1444572206","issue_url":"https://api.github.com/repos/apache/ratis/issues/829","id":1444572206,"node_id":"IC_kwDOBMxbGc5WGmwu","user":{"login":"adoroszlai","id":6454655,"node_id":"MDQ6VXNlcjY0NTQ2NTU=","avatar_url":"https://avatars.githubusercontent.com/u/6454655?v=4","gravatar_id":"","url":"https://api.github.com/users/adoroszlai","html_url":"https://github.com/adoroszlai","followers_url":"https://api.github.com/users/adoroszlai/followers","following_url":"https://api.github.com/users/adoroszlai/following{/other_user}","gists_url":"https://api.github.com/users/adoroszlai/gists{/gist_id}","starred_url":"https://api.github.com/users/adoroszlai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adoroszlai/subscriptions","organizations_url":"https://api.github.com/users/adoroszlai/orgs","repos_url":"https://api.github.com/users/adoroszlai/repos","events_url":"https://api.github.com/users/adoroszlai/events{/privacy}","received_events_url":"https://api.github.com/users/adoroszlai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-24T21:53:47Z","updated_at":"2023-02-24T21:53:47Z","author_association":"CONTRIBUTOR","body":"Thanks a lot @szetszwo for the review.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1444572206/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1445929649","html_url":"https://github.com/apache/ratis/pull/831#issuecomment-1445929649","issue_url":"https://api.github.com/repos/apache/ratis/issues/831","id":1445929649,"node_id":"IC_kwDOBMxbGc5WLyKx","user":{"login":"adoroszlai","id":6454655,"node_id":"MDQ6VXNlcjY0NTQ2NTU=","avatar_url":"https://avatars.githubusercontent.com/u/6454655?v=4","gravatar_id":"","url":"https://api.github.com/users/adoroszlai","html_url":"https://github.com/adoroszlai","followers_url":"https://api.github.com/users/adoroszlai/followers","following_url":"https://api.github.com/users/adoroszlai/following{/other_user}","gists_url":"https://api.github.com/users/adoroszlai/gists{/gist_id}","starred_url":"https://api.github.com/users/adoroszlai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adoroszlai/subscriptions","organizations_url":"https://api.github.com/users/adoroszlai/orgs","repos_url":"https://api.github.com/users/adoroszlai/repos","events_url":"https://api.github.com/users/adoroszlai/events{/privacy}","received_events_url":"https://api.github.com/users/adoroszlai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-27T08:51:04Z","updated_at":"2023-02-27T08:51:04Z","author_association":"CONTRIBUTOR","body":"Thanks @szetszwo for the review.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1445929649/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1448546500","html_url":"https://github.com/apache/ratis/pull/832#issuecomment-1448546500","issue_url":"https://api.github.com/repos/apache/ratis/issues/832","id":1448546500,"node_id":"IC_kwDOBMxbGc5WVxDE","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-28T17:09:19Z","updated_at":"2023-02-28T17:09:19Z","author_association":"CONTRIBUTOR","body":"@SzyWilliam , thanks a lot for reviewing and merging this!\r\n\r\nBTW, I should have mentioned that we did see very frequent appendEntries calls happening in some error conditions.  The follower replied very fast without changing the nextIndex (Not sure why).  So the leader kept sending appendEntries very frequently.  The wait-time.min here is to prevent it.\r\n\r\nIt also had memory spike at the same time but we did not know whether the appendEntries causing the memory spike or the other way around.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1448546500/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1449482131","html_url":"https://github.com/apache/ratis/pull/834#issuecomment-1449482131","issue_url":"https://api.github.com/repos/apache/ratis/issues/834","id":1449482131,"node_id":"IC_kwDOBMxbGc5WZVeT","user":{"login":"AngersZhuuuu","id":46485123,"node_id":"MDQ6VXNlcjQ2NDg1MTIz","avatar_url":"https://avatars.githubusercontent.com/u/46485123?v=4","gravatar_id":"","url":"https://api.github.com/users/AngersZhuuuu","html_url":"https://github.com/AngersZhuuuu","followers_url":"https://api.github.com/users/AngersZhuuuu/followers","following_url":"https://api.github.com/users/AngersZhuuuu/following{/other_user}","gists_url":"https://api.github.com/users/AngersZhuuuu/gists{/gist_id}","starred_url":"https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AngersZhuuuu/subscriptions","organizations_url":"https://api.github.com/users/AngersZhuuuu/orgs","repos_url":"https://api.github.com/users/AngersZhuuuu/repos","events_url":"https://api.github.com/users/AngersZhuuuu/events{/privacy}","received_events_url":"https://api.github.com/users/AngersZhuuuu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-01T07:29:33Z","updated_at":"2023-03-01T07:29:33Z","author_association":"CONTRIBUTOR","body":"ping @SzyWilliam @kaijchen @tisonkun @codings-dan ","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1449482131/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1449546591","html_url":"https://github.com/apache/ratis/pull/835#issuecomment-1449546591","issue_url":"https://api.github.com/repos/apache/ratis/issues/835","id":1449546591,"node_id":"IC_kwDOBMxbGc5WZlNf","user":{"login":"kaijchen","id":5821159,"node_id":"MDQ6VXNlcjU4MjExNTk=","avatar_url":"https://avatars.githubusercontent.com/u/5821159?v=4","gravatar_id":"","url":"https://api.github.com/users/kaijchen","html_url":"https://github.com/kaijchen","followers_url":"https://api.github.com/users/kaijchen/followers","following_url":"https://api.github.com/users/kaijchen/following{/other_user}","gists_url":"https://api.github.com/users/kaijchen/gists{/gist_id}","starred_url":"https://api.github.com/users/kaijchen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaijchen/subscriptions","organizations_url":"https://api.github.com/users/kaijchen/orgs","repos_url":"https://api.github.com/users/kaijchen/repos","events_url":"https://api.github.com/users/kaijchen/events{/privacy}","received_events_url":"https://api.github.com/users/kaijchen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-01T08:25:20Z","updated_at":"2023-03-01T08:25:20Z","author_association":"CONTRIBUTOR","body":"Cc @szetszwo @codings-dan PTAL.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1449546591/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1449624912","html_url":"https://github.com/apache/ratis/pull/835#issuecomment-1449624912","issue_url":"https://api.github.com/repos/apache/ratis/issues/835","id":1449624912,"node_id":"IC_kwDOBMxbGc5WZ4VQ","user":{"login":"kaijchen","id":5821159,"node_id":"MDQ6VXNlcjU4MjExNTk=","avatar_url":"https://avatars.githubusercontent.com/u/5821159?v=4","gravatar_id":"","url":"https://api.github.com/users/kaijchen","html_url":"https://github.com/kaijchen","followers_url":"https://api.github.com/users/kaijchen/followers","following_url":"https://api.github.com/users/kaijchen/following{/other_user}","gists_url":"https://api.github.com/users/kaijchen/gists{/gist_id}","starred_url":"https://api.github.com/users/kaijchen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaijchen/subscriptions","organizations_url":"https://api.github.com/users/kaijchen/orgs","repos_url":"https://api.github.com/users/kaijchen/repos","events_url":"https://api.github.com/users/kaijchen/events{/privacy}","received_events_url":"https://api.github.com/users/kaijchen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-01T09:03:02Z","updated_at":"2023-03-01T09:03:02Z","author_association":"CONTRIBUTOR","body":"Hi @adoroszlai, I think it's nice to have this PR included in the next release (2.4.2 or 2.5.0).","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1449624912/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1449888934","html_url":"https://github.com/apache/ratis/pull/836#issuecomment-1449888934","issue_url":"https://api.github.com/repos/apache/ratis/issues/836","id":1449888934,"node_id":"IC_kwDOBMxbGc5Wa4ym","user":{"login":"AngersZhuuuu","id":46485123,"node_id":"MDQ6VXNlcjQ2NDg1MTIz","avatar_url":"https://avatars.githubusercontent.com/u/46485123?v=4","gravatar_id":"","url":"https://api.github.com/users/AngersZhuuuu","html_url":"https://github.com/AngersZhuuuu","followers_url":"https://api.github.com/users/AngersZhuuuu/followers","following_url":"https://api.github.com/users/AngersZhuuuu/following{/other_user}","gists_url":"https://api.github.com/users/AngersZhuuuu/gists{/gist_id}","starred_url":"https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AngersZhuuuu/subscriptions","organizations_url":"https://api.github.com/users/AngersZhuuuu/orgs","repos_url":"https://api.github.com/users/AngersZhuuuu/repos","events_url":"https://api.github.com/users/AngersZhuuuu/events{/privacy}","received_events_url":"https://api.github.com/users/AngersZhuuuu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-01T11:02:20Z","updated_at":"2023-03-01T11:02:20Z","author_association":"CONTRIBUTOR","body":"ping @codings-dan ","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1449888934/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1450219201","html_url":"https://github.com/apache/ratis/pull/836#issuecomment-1450219201","issue_url":"https://api.github.com/repos/apache/ratis/issues/836","id":1450219201,"node_id":"IC_kwDOBMxbGc5WcJbB","user":{"login":"AngersZhuuuu","id":46485123,"node_id":"MDQ6VXNlcjQ2NDg1MTIz","avatar_url":"https://avatars.githubusercontent.com/u/46485123?v=4","gravatar_id":"","url":"https://api.github.com/users/AngersZhuuuu","html_url":"https://github.com/AngersZhuuuu","followers_url":"https://api.github.com/users/AngersZhuuuu/followers","following_url":"https://api.github.com/users/AngersZhuuuu/following{/other_user}","gists_url":"https://api.github.com/users/AngersZhuuuu/gists{/gist_id}","starred_url":"https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AngersZhuuuu/subscriptions","organizations_url":"https://api.github.com/users/AngersZhuuuu/orgs","repos_url":"https://api.github.com/users/AngersZhuuuu/repos","events_url":"https://api.github.com/users/AngersZhuuuu/events{/privacy}","received_events_url":"https://api.github.com/users/AngersZhuuuu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-01T14:12:48Z","updated_at":"2023-03-01T14:12:48Z","author_association":"CONTRIBUTOR","body":"@codings-dan Seems the failed GA is not related?\r\n","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1450219201/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1450221462","html_url":"https://github.com/apache/ratis/pull/834#issuecomment-1450221462","issue_url":"https://api.github.com/repos/apache/ratis/issues/834","id":1450221462,"node_id":"IC_kwDOBMxbGc5WcJ-W","user":{"login":"AngersZhuuuu","id":46485123,"node_id":"MDQ6VXNlcjQ2NDg1MTIz","avatar_url":"https://avatars.githubusercontent.com/u/46485123?v=4","gravatar_id":"","url":"https://api.github.com/users/AngersZhuuuu","html_url":"https://github.com/AngersZhuuuu","followers_url":"https://api.github.com/users/AngersZhuuuu/followers","following_url":"https://api.github.com/users/AngersZhuuuu/following{/other_user}","gists_url":"https://api.github.com/users/AngersZhuuuu/gists{/gist_id}","starred_url":"https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AngersZhuuuu/subscriptions","organizations_url":"https://api.github.com/users/AngersZhuuuu/orgs","repos_url":"https://api.github.com/users/AngersZhuuuu/repos","events_url":"https://api.github.com/users/AngersZhuuuu/events{/privacy}","received_events_url":"https://api.github.com/users/AngersZhuuuu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-01T14:14:19Z","updated_at":"2023-03-01T14:14:19Z","author_association":"CONTRIBUTOR","body":"The failed test seems not related","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1450221462/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1450716794","html_url":"https://github.com/apache/ratis/pull/835#issuecomment-1450716794","issue_url":"https://api.github.com/repos/apache/ratis/issues/835","id":1450716794,"node_id":"IC_kwDOBMxbGc5WeC56","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-01T19:13:28Z","updated_at":"2023-03-01T19:13:28Z","author_association":"CONTRIBUTOR","body":"@adoroszlai , thanks a lot for reviewing and testing this!","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1450716794/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1451186915","html_url":"https://github.com/apache/ratis/pull/832#issuecomment-1451186915","issue_url":"https://api.github.com/repos/apache/ratis/issues/832","id":1451186915,"node_id":"IC_kwDOBMxbGc5Wf1rj","user":{"login":"SzyWilliam","id":48054931,"node_id":"MDQ6VXNlcjQ4MDU0OTMx","avatar_url":"https://avatars.githubusercontent.com/u/48054931?v=4","gravatar_id":"","url":"https://api.github.com/users/SzyWilliam","html_url":"https://github.com/SzyWilliam","followers_url":"https://api.github.com/users/SzyWilliam/followers","following_url":"https://api.github.com/users/SzyWilliam/following{/other_user}","gists_url":"https://api.github.com/users/SzyWilliam/gists{/gist_id}","starred_url":"https://api.github.com/users/SzyWilliam/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SzyWilliam/subscriptions","organizations_url":"https://api.github.com/users/SzyWilliam/orgs","repos_url":"https://api.github.com/users/SzyWilliam/repos","events_url":"https://api.github.com/users/SzyWilliam/events{/privacy}","received_events_url":"https://api.github.com/users/SzyWilliam/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T02:39:37Z","updated_at":"2023-03-02T02:39:37Z","author_association":"MEMBER","body":"@szetszwo Bravo! frequent appendEntries calls without changing nextIndex is bothering me for a while. Enforcing minimal wait time may help with this problem.\r\n> BTW, I should have mentioned that we did see very frequent appendEntries calls happening in some error conditions. The follower replied very fast without changing the nextIndex (Not sure why)\r\n\r\nIn some of our scenarios, this problem happens when a new leader is elected and start sending AppendEntries to a slow follower. Unfortunately, this slow follower is going through a GC pause, so these AppendEntries just accumulates at gRPC buffer. When the slow follower comes around and starts dealing with these piled RPCs, it immediately finds the first AppendEntries nextIndex is inconsistent. So it replies INCONSISTENT to all of these accumulated AE RPCs, all with the same nextIndex.\r\n\r\nI was thinking before to add some initial states to prevent this issue, e.g., the new leader will only sends 1 AppendEntries to a follower until it receives a positive reply.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1451186915/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1451261430","html_url":"https://github.com/apache/ratis/pull/832#issuecomment-1451261430","issue_url":"https://api.github.com/repos/apache/ratis/issues/832","id":1451261430,"node_id":"IC_kwDOBMxbGc5WgH32","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T03:57:26Z","updated_at":"2023-03-02T03:57:26Z","author_association":"CONTRIBUTOR","body":"@SzyWilliam , good observations!  We should limit the number of outstanding append entires.  Filed https://issues.apache.org/jira/browse/RATIS-1804","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1451261430/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1451292718","html_url":"https://github.com/apache/ratis/pull/838#issuecomment-1451292718","issue_url":"https://api.github.com/repos/apache/ratis/issues/838","id":1451292718,"node_id":"IC_kwDOBMxbGc5WgPgu","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T04:45:51Z","updated_at":"2023-03-02T04:45:51Z","author_association":"CONTRIBUTOR","body":"Also fix `STATISTICS_EXPIRY_TIME_DEFAULT`: MICROSECONDS should be MILLISECONDS.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1451292718/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1451454649","html_url":"https://github.com/apache/ratis/pull/832#issuecomment-1451454649","issue_url":"https://api.github.com/repos/apache/ratis/issues/832","id":1451454649,"node_id":"IC_kwDOBMxbGc5Wg3C5","user":{"login":"kaijchen","id":5821159,"node_id":"MDQ6VXNlcjU4MjExNTk=","avatar_url":"https://avatars.githubusercontent.com/u/5821159?v=4","gravatar_id":"","url":"https://api.github.com/users/kaijchen","html_url":"https://github.com/kaijchen","followers_url":"https://api.github.com/users/kaijchen/followers","following_url":"https://api.github.com/users/kaijchen/following{/other_user}","gists_url":"https://api.github.com/users/kaijchen/gists{/gist_id}","starred_url":"https://api.github.com/users/kaijchen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaijchen/subscriptions","organizations_url":"https://api.github.com/users/kaijchen/orgs","repos_url":"https://api.github.com/users/kaijchen/repos","events_url":"https://api.github.com/users/kaijchen/events{/privacy}","received_events_url":"https://api.github.com/users/kaijchen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T08:06:23Z","updated_at":"2023-03-02T08:06:23Z","author_association":"CONTRIBUTOR","body":"> I was thinking before to add some initial states to prevent this issue, e.g., the new leader will only sends 1 AppendEntries to a follower until it receives a positive reply.\r\n\r\nMaybe we can mimic the `progress` design in etcd/raft\r\nhttps://github.com/etcd-io/raft/blob/main/design.md","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1451454649/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1451488577","html_url":"https://github.com/apache/ratis/pull/834#issuecomment-1451488577","issue_url":"https://api.github.com/repos/apache/ratis/issues/834","id":1451488577,"node_id":"IC_kwDOBMxbGc5Wg_VB","user":{"login":"pan3793","id":26535726,"node_id":"MDQ6VXNlcjI2NTM1NzI2","avatar_url":"https://avatars.githubusercontent.com/u/26535726?v=4","gravatar_id":"","url":"https://api.github.com/users/pan3793","html_url":"https://github.com/pan3793","followers_url":"https://api.github.com/users/pan3793/followers","following_url":"https://api.github.com/users/pan3793/following{/other_user}","gists_url":"https://api.github.com/users/pan3793/gists{/gist_id}","starred_url":"https://api.github.com/users/pan3793/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pan3793/subscriptions","organizations_url":"https://api.github.com/users/pan3793/orgs","repos_url":"https://api.github.com/users/pan3793/repos","events_url":"https://api.github.com/users/pan3793/events{/privacy}","received_events_url":"https://api.github.com/users/pan3793/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T08:35:10Z","updated_at":"2023-03-02T08:35:10Z","author_association":"MEMBER","body":"May I ask which RPC implementation is favored in the downstream projects or production cases? Are there general pros and cons of each one?","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1451488577/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1451491138","html_url":"https://github.com/apache/ratis/pull/834#issuecomment-1451491138","issue_url":"https://api.github.com/repos/apache/ratis/issues/834","id":1451491138,"node_id":"IC_kwDOBMxbGc5Wg_9C","user":{"login":"tisonkun","id":18818196,"node_id":"MDQ6VXNlcjE4ODE4MTk2","avatar_url":"https://avatars.githubusercontent.com/u/18818196?v=4","gravatar_id":"","url":"https://api.github.com/users/tisonkun","html_url":"https://github.com/tisonkun","followers_url":"https://api.github.com/users/tisonkun/followers","following_url":"https://api.github.com/users/tisonkun/following{/other_user}","gists_url":"https://api.github.com/users/tisonkun/gists{/gist_id}","starred_url":"https://api.github.com/users/tisonkun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tisonkun/subscriptions","organizations_url":"https://api.github.com/users/tisonkun/orgs","repos_url":"https://api.github.com/users/tisonkun/repos","events_url":"https://api.github.com/users/tisonkun/events{/privacy}","received_events_url":"https://api.github.com/users/tisonkun/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T08:37:20Z","updated_at":"2023-03-02T08:37:20Z","author_association":"MEMBER","body":"@pan3793 This question is unrelated to this patch. I suggest you email to [user@ratis.apache.org](mailto:user@ratis.apache.org) for discussion. See [this page](https://ratis.apache.org/#community) about how to subscribe the list.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1451491138/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1451499170","html_url":"https://github.com/apache/ratis/pull/834#issuecomment-1451499170","issue_url":"https://api.github.com/repos/apache/ratis/issues/834","id":1451499170,"node_id":"IC_kwDOBMxbGc5WhB6i","user":{"login":"pan3793","id":26535726,"node_id":"MDQ6VXNlcjI2NTM1NzI2","avatar_url":"https://avatars.githubusercontent.com/u/26535726?v=4","gravatar_id":"","url":"https://api.github.com/users/pan3793","html_url":"https://github.com/pan3793","followers_url":"https://api.github.com/users/pan3793/followers","following_url":"https://api.github.com/users/pan3793/following{/other_user}","gists_url":"https://api.github.com/users/pan3793/gists{/gist_id}","starred_url":"https://api.github.com/users/pan3793/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pan3793/subscriptions","organizations_url":"https://api.github.com/users/pan3793/orgs","repos_url":"https://api.github.com/users/pan3793/repos","events_url":"https://api.github.com/users/pan3793/events{/privacy}","received_events_url":"https://api.github.com/users/pan3793/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T08:44:06Z","updated_at":"2023-03-02T08:44:31Z","author_association":"MEMBER","body":"> This question is unrelated to this patch.\r\n\r\nActually, this issue is found in the Celeborn project when we want to include `ratis-shell` in. A direct manifestation of this issue is Celeborn uses the Netty RPC implementation but ratis-shell does not support that.\r\n\r\n@tisonkun Based on this fact, I think they are kind of \"related\".","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1451499170/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1451557584","html_url":"https://github.com/apache/ratis/pull/834#issuecomment-1451557584","issue_url":"https://api.github.com/repos/apache/ratis/issues/834","id":1451557584,"node_id":"IC_kwDOBMxbGc5WhQLQ","user":{"login":"kaijchen","id":5821159,"node_id":"MDQ6VXNlcjU4MjExNTk=","avatar_url":"https://avatars.githubusercontent.com/u/5821159?v=4","gravatar_id":"","url":"https://api.github.com/users/kaijchen","html_url":"https://github.com/kaijchen","followers_url":"https://api.github.com/users/kaijchen/followers","following_url":"https://api.github.com/users/kaijchen/following{/other_user}","gists_url":"https://api.github.com/users/kaijchen/gists{/gist_id}","starred_url":"https://api.github.com/users/kaijchen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaijchen/subscriptions","organizations_url":"https://api.github.com/users/kaijchen/orgs","repos_url":"https://api.github.com/users/kaijchen/repos","events_url":"https://api.github.com/users/kaijchen/events{/privacy}","received_events_url":"https://api.github.com/users/kaijchen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T09:26:25Z","updated_at":"2023-03-02T09:26:25Z","author_association":"CONTRIBUTOR","body":"> Actually, this issue is found in the Celeborn project when we want to include `ratis-shell` in. A direct manifestation of this issue is Celeborn uses the Netty RPC implementation but ratis-shell does not support that.\r\n\r\n`ratis-shell` is originally contributed by Ozone and Alluxio community, these two projects use gRPC by default.\r\n\r\nhttps://issues.apache.org/jira/browse/RATIS-1412\r\n\r\nBut Netty should be supported as well. Glad to see we have Netty use cases in Celeborn.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1451557584/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1451569371","html_url":"https://github.com/apache/ratis/pull/834#issuecomment-1451569371","issue_url":"https://api.github.com/repos/apache/ratis/issues/834","id":1451569371,"node_id":"IC_kwDOBMxbGc5WhTDb","user":{"login":"pan3793","id":26535726,"node_id":"MDQ6VXNlcjI2NTM1NzI2","avatar_url":"https://avatars.githubusercontent.com/u/26535726?v=4","gravatar_id":"","url":"https://api.github.com/users/pan3793","html_url":"https://github.com/pan3793","followers_url":"https://api.github.com/users/pan3793/followers","following_url":"https://api.github.com/users/pan3793/following{/other_user}","gists_url":"https://api.github.com/users/pan3793/gists{/gist_id}","starred_url":"https://api.github.com/users/pan3793/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pan3793/subscriptions","organizations_url":"https://api.github.com/users/pan3793/orgs","repos_url":"https://api.github.com/users/pan3793/repos","events_url":"https://api.github.com/users/pan3793/events{/privacy}","received_events_url":"https://api.github.com/users/pan3793/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T09:35:02Z","updated_at":"2023-03-02T09:35:02Z","author_association":"MEMBER","body":"Thank @kaijchen for the information, yes, it works after this minor fix, I know you are active in the Ozone community, would you like to share more about why Ozone uses gRPC by default?","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1451569371/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1451594356","html_url":"https://github.com/apache/ratis/pull/834#issuecomment-1451594356","issue_url":"https://api.github.com/repos/apache/ratis/issues/834","id":1451594356,"node_id":"IC_kwDOBMxbGc5WhZJ0","user":{"login":"kaijchen","id":5821159,"node_id":"MDQ6VXNlcjU4MjExNTk=","avatar_url":"https://avatars.githubusercontent.com/u/5821159?v=4","gravatar_id":"","url":"https://api.github.com/users/kaijchen","html_url":"https://github.com/kaijchen","followers_url":"https://api.github.com/users/kaijchen/followers","following_url":"https://api.github.com/users/kaijchen/following{/other_user}","gists_url":"https://api.github.com/users/kaijchen/gists{/gist_id}","starred_url":"https://api.github.com/users/kaijchen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaijchen/subscriptions","organizations_url":"https://api.github.com/users/kaijchen/orgs","repos_url":"https://api.github.com/users/kaijchen/repos","events_url":"https://api.github.com/users/kaijchen/events{/privacy}","received_events_url":"https://api.github.com/users/kaijchen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T09:54:28Z","updated_at":"2023-03-02T09:54:28Z","author_association":"CONTRIBUTOR","body":"> Thank @kaijchen for the information, yes, it works after this minor fix, I know you are active in the Ozone community, would you like to share more about why Ozone uses gRPC by default?\r\n\r\nBasically gRPC is higher level and provides more features, while Netty is lower level and has less overhead.\r\n\r\nThere is a blog post about why Alluxio switch from Thrift + Netty to gRPC:\r\nhttps://www.alluxio.io/blog/moving-from-apache-thrift-to-grpc-a-perspective-from-alluxio/","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1451594356/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1451597524","html_url":"https://github.com/apache/ratis/pull/834#issuecomment-1451597524","issue_url":"https://api.github.com/repos/apache/ratis/issues/834","id":1451597524,"node_id":"IC_kwDOBMxbGc5WhZ7U","user":{"login":"pan3793","id":26535726,"node_id":"MDQ6VXNlcjI2NTM1NzI2","avatar_url":"https://avatars.githubusercontent.com/u/26535726?v=4","gravatar_id":"","url":"https://api.github.com/users/pan3793","html_url":"https://github.com/pan3793","followers_url":"https://api.github.com/users/pan3793/followers","following_url":"https://api.github.com/users/pan3793/following{/other_user}","gists_url":"https://api.github.com/users/pan3793/gists{/gist_id}","starred_url":"https://api.github.com/users/pan3793/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pan3793/subscriptions","organizations_url":"https://api.github.com/users/pan3793/orgs","repos_url":"https://api.github.com/users/pan3793/repos","events_url":"https://api.github.com/users/pan3793/events{/privacy}","received_events_url":"https://api.github.com/users/pan3793/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T09:56:53Z","updated_at":"2023-03-02T09:56:53Z","author_association":"MEMBER","body":"Many thanks, @kaijchen ","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1451597524/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1451728227","html_url":"https://github.com/apache/ratis/pull/834#issuecomment-1451728227","issue_url":"https://api.github.com/repos/apache/ratis/issues/834","id":1451728227,"node_id":"IC_kwDOBMxbGc5Wh51j","user":{"login":"SzyWilliam","id":48054931,"node_id":"MDQ6VXNlcjQ4MDU0OTMx","avatar_url":"https://avatars.githubusercontent.com/u/48054931?v=4","gravatar_id":"","url":"https://api.github.com/users/SzyWilliam","html_url":"https://github.com/SzyWilliam","followers_url":"https://api.github.com/users/SzyWilliam/followers","following_url":"https://api.github.com/users/SzyWilliam/following{/other_user}","gists_url":"https://api.github.com/users/SzyWilliam/gists{/gist_id}","starred_url":"https://api.github.com/users/SzyWilliam/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SzyWilliam/subscriptions","organizations_url":"https://api.github.com/users/SzyWilliam/orgs","repos_url":"https://api.github.com/users/SzyWilliam/repos","events_url":"https://api.github.com/users/SzyWilliam/events{/privacy}","received_events_url":"https://api.github.com/users/SzyWilliam/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T11:37:32Z","updated_at":"2023-03-02T11:37:32Z","author_association":"MEMBER","body":"> https://www.alluxio.io/blog/moving-from-apache-thrift-to-grpc-a-perspective-from-alluxio/\r\n\r\n@kaijchen The link seems broken. IoTDB community also had a discussion about Thrift v.s gRPC recently. It would be great to learn lessons from other projects.\r\n\r\n@pan3793 IoTDB also uses gRPC by default. It was originally a \"captain's call\" ;). gRPC mostly meets our needs. However, we are experiencing [issues](https://issues.apache.org/jira/browse/RATIS-1790) related to gRPC's installSnapshot process recently. ","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1451728227/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1451733627","html_url":"https://github.com/apache/ratis/pull/834#issuecomment-1451733627","issue_url":"https://api.github.com/repos/apache/ratis/issues/834","id":1451733627,"node_id":"IC_kwDOBMxbGc5Wh7J7","user":{"login":"pan3793","id":26535726,"node_id":"MDQ6VXNlcjI2NTM1NzI2","avatar_url":"https://avatars.githubusercontent.com/u/26535726?v=4","gravatar_id":"","url":"https://api.github.com/users/pan3793","html_url":"https://github.com/pan3793","followers_url":"https://api.github.com/users/pan3793/followers","following_url":"https://api.github.com/users/pan3793/following{/other_user}","gists_url":"https://api.github.com/users/pan3793/gists{/gist_id}","starred_url":"https://api.github.com/users/pan3793/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pan3793/subscriptions","organizations_url":"https://api.github.com/users/pan3793/orgs","repos_url":"https://api.github.com/users/pan3793/repos","events_url":"https://api.github.com/users/pan3793/events{/privacy}","received_events_url":"https://api.github.com/users/pan3793/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T11:42:26Z","updated_at":"2023-03-02T11:44:33Z","author_association":"MEMBER","body":"@SzyWilliam thanks for the information, looks like the gRPC protocol has more practices.\r\n\r\nBTW, I can open the link\r\n\r\n> https://www.alluxio.io/blog/moving-from-apache-thrift-to-grpc-a-perspective-from-alluxio/","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1451733627/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1451739450","html_url":"https://github.com/apache/ratis/pull/828#issuecomment-1451739450","issue_url":"https://api.github.com/repos/apache/ratis/issues/828","id":1451739450,"node_id":"IC_kwDOBMxbGc5Wh8k6","user":{"login":"SzyWilliam","id":48054931,"node_id":"MDQ6VXNlcjQ4MDU0OTMx","avatar_url":"https://avatars.githubusercontent.com/u/48054931?v=4","gravatar_id":"","url":"https://api.github.com/users/SzyWilliam","html_url":"https://github.com/SzyWilliam","followers_url":"https://api.github.com/users/SzyWilliam/followers","following_url":"https://api.github.com/users/SzyWilliam/following{/other_user}","gists_url":"https://api.github.com/users/SzyWilliam/gists{/gist_id}","starred_url":"https://api.github.com/users/SzyWilliam/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SzyWilliam/subscriptions","organizations_url":"https://api.github.com/users/SzyWilliam/orgs","repos_url":"https://api.github.com/users/SzyWilliam/repos","events_url":"https://api.github.com/users/SzyWilliam/events{/privacy}","received_events_url":"https://api.github.com/users/SzyWilliam/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T11:47:01Z","updated_at":"2023-03-02T11:47:01Z","author_association":"MEMBER","body":"@szetszwo It is working now. It is surprising that gRPC don't provide a per-call deadline that we have to hack inside gRPC internals.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1451739450/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1451743645","html_url":"https://github.com/apache/ratis/pull/832#issuecomment-1451743645","issue_url":"https://api.github.com/repos/apache/ratis/issues/832","id":1451743645,"node_id":"IC_kwDOBMxbGc5Wh9md","user":{"login":"SzyWilliam","id":48054931,"node_id":"MDQ6VXNlcjQ4MDU0OTMx","avatar_url":"https://avatars.githubusercontent.com/u/48054931?v=4","gravatar_id":"","url":"https://api.github.com/users/SzyWilliam","html_url":"https://github.com/SzyWilliam","followers_url":"https://api.github.com/users/SzyWilliam/followers","following_url":"https://api.github.com/users/SzyWilliam/following{/other_user}","gists_url":"https://api.github.com/users/SzyWilliam/gists{/gist_id}","starred_url":"https://api.github.com/users/SzyWilliam/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SzyWilliam/subscriptions","organizations_url":"https://api.github.com/users/SzyWilliam/orgs","repos_url":"https://api.github.com/users/SzyWilliam/repos","events_url":"https://api.github.com/users/SzyWilliam/events{/privacy}","received_events_url":"https://api.github.com/users/SzyWilliam/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T11:50:44Z","updated_at":"2023-03-02T11:51:01Z","author_association":"MEMBER","body":"> https://github.com/etcd-io/raft/blob/main/design.md\r\n\r\nThanks @kaijchen ! It looks exactly what I thought before. @szetszwo Maybe we can initialize gRPC appender with a similar 'probe' state that allows only, say, 8 out going RPCs. After it gets in touch with the follower, it is then allowed to have more pending requests.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1451743645/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1451792893","html_url":"https://github.com/apache/ratis/pull/834#issuecomment-1451792893","issue_url":"https://api.github.com/repos/apache/ratis/issues/834","id":1451792893,"node_id":"IC_kwDOBMxbGc5WiJn9","user":{"login":"kaijchen","id":5821159,"node_id":"MDQ6VXNlcjU4MjExNTk=","avatar_url":"https://avatars.githubusercontent.com/u/5821159?v=4","gravatar_id":"","url":"https://api.github.com/users/kaijchen","html_url":"https://github.com/kaijchen","followers_url":"https://api.github.com/users/kaijchen/followers","following_url":"https://api.github.com/users/kaijchen/following{/other_user}","gists_url":"https://api.github.com/users/kaijchen/gists{/gist_id}","starred_url":"https://api.github.com/users/kaijchen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaijchen/subscriptions","organizations_url":"https://api.github.com/users/kaijchen/orgs","repos_url":"https://api.github.com/users/kaijchen/repos","events_url":"https://api.github.com/users/kaijchen/events{/privacy}","received_events_url":"https://api.github.com/users/kaijchen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T12:30:52Z","updated_at":"2023-03-02T12:30:52Z","author_association":"CONTRIBUTOR","body":"> The link seems broken. IoTDB community also had a discussion about Thrift v.s gRPC recently. It would be great to learn lessons from other projects.\r\n\r\nYou need to set language to EN first: https://www.alluxio.io/?lang=en","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1451792893/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1452337900","html_url":"https://github.com/apache/ratis/pull/834#issuecomment-1452337900","issue_url":"https://api.github.com/repos/apache/ratis/issues/834","id":1452337900,"node_id":"IC_kwDOBMxbGc5WkOrs","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T18:24:00Z","updated_at":"2023-03-02T18:24:00Z","author_association":"CONTRIBUTOR","body":"> May I ask which RPC implementation is favored in the downstream projects or production cases? Are there general pros and cons of each one?\r\n\r\n@pan3793 , thanks for being interested in Apache Ratis!  I agree with @tisonkun that this kind of questions is better to discuss it on the mailing list.  Let me give you some short answer.  \r\n\r\nCurrently, grpc is the default rpc type in Ratis.  It supports all the functionalities -- blocking io, ordered async and unordered async.  Netty RPC in Ratis only supports blocking io.\r\n\r\nFrom our experience, grpc is good when the message sizes are small.  For large messages, grpc does not perform well since we cannot control the buffer allocation and copying.  Netty is better in that case.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1452337900/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1452365539","html_url":"https://github.com/apache/ratis/pull/834#issuecomment-1452365539","issue_url":"https://api.github.com/repos/apache/ratis/issues/834","id":1452365539,"node_id":"IC_kwDOBMxbGc5WkVbj","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T18:40:58Z","updated_at":"2023-03-02T18:40:58Z","author_association":"CONTRIBUTOR","body":"> https://www.alluxio.io/blog/moving-from-apache-thrift-to-grpc-a-perspective-from-alluxio/\r\n\r\n@kaijchen , thanks for sharing the blog!\r\n\r\n> **Implement zero-copy**: Another overhead we observed switching to gRPC is excessive buffer copying. This is because gRPC, by default, uses protobuf for message serialization, which introduces extra copy operations. There is currently no official API for getting raw buffers in and out of gRPC without having to go through protobuf serialization or throw away the nice generated RPC bindings. We end up using some ideas from the gRPC user group and implemented a workaround to achieve zero-copy.\r\n\r\nDo you have more details on zero-copy?  I wonder if we could do the same in Ratis.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1452365539/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1452704379","html_url":"https://github.com/apache/ratis/pull/828#issuecomment-1452704379","issue_url":"https://api.github.com/repos/apache/ratis/issues/828","id":1452704379,"node_id":"IC_kwDOBMxbGc5WloJ7","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T23:12:21Z","updated_at":"2023-03-03T02:36:54Z","author_association":"CONTRIBUTOR","body":"@SzyWilliam , tried to test it but it failed.  Not sure if my test is correct; please take a look \r\n~~https://issues.apache.org/jira/secure/attachment/13055979/828_test.patch~~  (updated to 828_test2.patch)","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1452704379/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1452829079","html_url":"https://github.com/apache/ratis/pull/834#issuecomment-1452829079","issue_url":"https://api.github.com/repos/apache/ratis/issues/834","id":1452829079,"node_id":"IC_kwDOBMxbGc5WmGmX","user":{"login":"pan3793","id":26535726,"node_id":"MDQ6VXNlcjI2NTM1NzI2","avatar_url":"https://avatars.githubusercontent.com/u/26535726?v=4","gravatar_id":"","url":"https://api.github.com/users/pan3793","html_url":"https://github.com/pan3793","followers_url":"https://api.github.com/users/pan3793/followers","following_url":"https://api.github.com/users/pan3793/following{/other_user}","gists_url":"https://api.github.com/users/pan3793/gists{/gist_id}","starred_url":"https://api.github.com/users/pan3793/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pan3793/subscriptions","organizations_url":"https://api.github.com/users/pan3793/orgs","repos_url":"https://api.github.com/users/pan3793/repos","events_url":"https://api.github.com/users/pan3793/events{/privacy}","received_events_url":"https://api.github.com/users/pan3793/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-03T02:01:23Z","updated_at":"2023-03-03T02:01:23Z","author_association":"MEMBER","body":"@szetszwo, thank you for sharing the detail, based on your description, the gRPC should be the best choice for Apache Celeborn(Incubating).","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1452829079/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1452849886","html_url":"https://github.com/apache/ratis/pull/834#issuecomment-1452849886","issue_url":"https://api.github.com/repos/apache/ratis/issues/834","id":1452849886,"node_id":"IC_kwDOBMxbGc5WmLre","user":{"login":"kaijchen","id":5821159,"node_id":"MDQ6VXNlcjU4MjExNTk=","avatar_url":"https://avatars.githubusercontent.com/u/5821159?v=4","gravatar_id":"","url":"https://api.github.com/users/kaijchen","html_url":"https://github.com/kaijchen","followers_url":"https://api.github.com/users/kaijchen/followers","following_url":"https://api.github.com/users/kaijchen/following{/other_user}","gists_url":"https://api.github.com/users/kaijchen/gists{/gist_id}","starred_url":"https://api.github.com/users/kaijchen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaijchen/subscriptions","organizations_url":"https://api.github.com/users/kaijchen/orgs","repos_url":"https://api.github.com/users/kaijchen/repos","events_url":"https://api.github.com/users/kaijchen/events{/privacy}","received_events_url":"https://api.github.com/users/kaijchen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-03T02:15:25Z","updated_at":"2023-03-03T02:15:25Z","author_association":"CONTRIBUTOR","body":"> Do you have more details on zero-copy? I wonder if we could do the same in Ratis.\r\n\r\nhttps://github.com/Alluxio/alluxio/pull/8353\r\nhttps://github.com/Alluxio/alluxio/pull/8526\r\n\r\nYou may also check:\r\n\r\nhttps://github.com/GoogleCloudPlatform/grpc-gcp-java/pull/77\r\nhttps://github.com/grpc/grpc-java/pull/8102\r\n\r\nAFAIK, it is still not as good as Netty though.\r\n","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1452849886/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1452874000","html_url":"https://github.com/apache/ratis/pull/828#issuecomment-1452874000","issue_url":"https://api.github.com/repos/apache/ratis/issues/828","id":1452874000,"node_id":"IC_kwDOBMxbGc5WmRkQ","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-03T02:42:26Z","updated_at":"2023-03-03T02:42:26Z","author_association":"CONTRIBUTOR","body":"Updated the test and added more log messages: https://issues.apache.org/jira/secure/attachment/13055984/828_test2.patch\r\n\r\nThe output looks like below.\r\n- Note that `interceptCall`, `start` and `onHeaders` are only invoked once (not per `onNext`).\r\n- The timeout mechanism does not work even the total sleep time for all `onNext` is much longer the timeout.\r\n```\r\n2023-03-02 18:33:11,572 [main] INFO  util.LogUtils (Slf4jUtils.java:setLogLevel(38)) - Successfully set org.apache.ratis.conf.ConfUtils log level to WARN\r\n2023-03-02 18:33:11,575 [main] INFO  util.LogUtils (Slf4jUtils.java:setLogLevel(38)) - Successfully set org.apache.ratis.util.FileUtils log level to TRACE\r\n2023-03-02 18:33:11,594 [Time-limited test] INFO  tests.TestDeadlineClientInterceptor (TestDeadlineClientInterceptor.java:runTestTimeout(77)) - slow = 5, WithInterceptors\r\n2023-03-02 18:33:12,059 [Time-limited test] INFO  server.DeadlineClientInterceptor (DeadlineClientInterceptor.java:interceptCall(54)) - callOptions CallOptions{deadline=null, authority=null, callCredentials=null, executor=null, compressorName=null, customOptions=[[internal-stub-type, ASYNC]], waitForReady=false, maxInboundMessageSize=null, maxOutboundMessageSize=null, streamTracerFactories=[]}\r\n2023-03-02 18:33:12,075 [Time-limited test] INFO  server.DeadlineClientInterceptor (DeadlineClientInterceptor.java:start(73)) - start Metadata()\r\n2023-03-02 18:33:12,076 [Time-limited test] INFO  tests.GrpcTestClient (GrpcTestClient.java:send(107)) - send m0\r\n2023-03-02 18:33:12,085 [Time-limited test] INFO  tests.GrpcTestClient (GrpcTestClient.java:send(107)) - send m1\r\n2023-03-02 18:33:12,085 [Time-limited test] INFO  tests.GrpcTestClient (GrpcTestClient.java:send(107)) - send m2\r\n2023-03-02 18:33:12,085 [Time-limited test] INFO  tests.GrpcTestClient (GrpcTestClient.java:send(107)) - send m3\r\n2023-03-02 18:33:12,085 [Time-limited test] INFO  tests.GrpcTestClient (GrpcTestClient.java:send(107)) - send m4\r\n2023-03-02 18:33:12,085 [Time-limited test] INFO  tests.GrpcTestClient (GrpcTestClient.java:send(107)) - send m5\r\n2023-03-02 18:33:12,086 [Time-limited test] INFO  tests.GrpcTestClient (GrpcTestClient.java:send(107)) - send m6\r\n2023-03-02 18:33:12,086 [Time-limited test] INFO  tests.GrpcTestClient (GrpcTestClient.java:send(107)) - send m7\r\n2023-03-02 18:33:12,086 [Time-limited test] INFO  tests.GrpcTestClient (GrpcTestClient.java:send(107)) - send m8\r\n2023-03-02 18:33:12,086 [Time-limited test] INFO  tests.GrpcTestClient (GrpcTestClient.java:send(107)) - send m9\r\n2023-03-02 18:33:12,315 [grpc-default-executor-1] INFO  tests.GreeterImpl (GreeterImpl.java:onNext(53)) - count = 0) Hello m0, slow = 5, sleep 250ms\r\n2023-03-02 18:33:12,578 [grpc-default-executor-1] INFO  tests.GreeterImpl (GreeterImpl.java:onNext(53)) - count = 1) Hello m1, slow = 5, sleep 250ms\r\n2023-03-02 18:33:12,580 [grpc-default-executor-0] INFO  server.DeadlineClientInterceptor (DeadlineClientInterceptor.java:onHeaders(77)) - onHeaders Metadata(content-type=application/grpc,grpc-encoding=identity,grpc-accept-encoding=gzip)\r\n2023-03-02 18:33:12,581 [Time-limited test] INFO  tests.TestDeadlineClientInterceptor (TestDeadlineClientInterceptor.java:runTestTimeout(100)) - 0) passed\r\n2023-03-02 18:33:12,832 [grpc-default-executor-1] INFO  tests.GreeterImpl (GreeterImpl.java:onNext(53)) - count = 2) Hello m2, slow = 5, sleep 250ms\r\n2023-03-02 18:33:12,833 [Time-limited test] INFO  tests.TestDeadlineClientInterceptor (TestDeadlineClientInterceptor.java:runTestTimeout(100)) - 1) passed\r\n2023-03-02 18:33:13,086 [grpc-default-executor-1] INFO  tests.GreeterImpl (GreeterImpl.java:onNext(53)) - count = 3) Hello m3, slow = 5, sleep 250ms\r\n2023-03-02 18:33:13,086 [Time-limited test] INFO  tests.TestDeadlineClientInterceptor (TestDeadlineClientInterceptor.java:runTestTimeout(100)) - 2) passed\r\n2023-03-02 18:33:13,341 [grpc-default-executor-1] INFO  tests.GreeterImpl (GreeterImpl.java:onNext(53)) - count = 4) Hello m4, slow = 5, sleep 250ms\r\n2023-03-02 18:33:13,341 [Time-limited test] INFO  tests.TestDeadlineClientInterceptor (TestDeadlineClientInterceptor.java:runTestTimeout(100)) - 3) passed\r\n2023-03-02 18:33:13,592 [grpc-default-executor-1] INFO  tests.GreeterImpl (GreeterImpl.java:onNext(53)) - count = 5) Hello m5, slow = 5, sleep 2s\r\n2023-03-02 18:33:13,592 [Time-limited test] INFO  tests.TestDeadlineClientInterceptor (TestDeadlineClientInterceptor.java:runTestTimeout(100)) - 4) passed\r\n2023-03-02 18:33:15,596 [grpc-default-executor-1] INFO  tests.GreeterImpl (GreeterImpl.java:onNext(53)) - count = 6) Hello m6, slow = 5, sleep 2s\r\n2023-03-02 18:33:17,602 [grpc-default-executor-1] INFO  tests.GreeterImpl (GreeterImpl.java:onNext(53)) - count = 7) Hello m7, slow = 5, sleep 2s\r\n2023-03-02 18:33:19,608 [grpc-default-executor-1] INFO  tests.GreeterImpl (GreeterImpl.java:onNext(53)) - count = 8) Hello m8, slow = 5, sleep 2s\r\n2023-03-02 18:33:21,613 [grpc-default-executor-1] INFO  tests.GreeterImpl (GreeterImpl.java:onNext(53)) - count = 9) Hello m9, slow = 5, sleep 2s\r\n2023-03-02 18:33:23,624 [grpc-default-executor-1] INFO  tests.GrpcTestClient (GrpcTestClient.java:onCompleted(83)) - onCompleted\r\n\r\njava.lang.AssertionError: 5) reply = 5) Hello m5, COMPLETED\r\n\r\n\tat org.junit.Assert.fail(Assert.java:89)\r\n\tat org.apache.ratis.grpc.tests.TestDeadlineClientInterceptor.runTestTimeout(TestDeadlineClientInterceptor.java:107)\r\n\tat org.apache.ratis.grpc.tests.TestDeadlineClientInterceptor.testWithInterceptors(TestDeadlineClientInterceptor.java:57)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.lang.reflect.Method.invoke(Method.java:498)\r\n\tat org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)\r\n\tat org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)\r\n\tat org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)\r\n\tat org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)\r\n\tat org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)\r\n\tat org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)\r\n\tat org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)\r\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:266)\r\n\tat java.lang.Thread.run(Thread.java:748)\r\n\r\n\r\nProcess finished with exit code 255\r\n```","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1452874000/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1452877824","html_url":"https://github.com/apache/ratis/pull/839#issuecomment-1452877824","issue_url":"https://api.github.com/repos/apache/ratis/issues/839","id":1452877824,"node_id":"IC_kwDOBMxbGc5WmSgA","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-03T02:47:03Z","updated_at":"2023-03-03T02:47:03Z","author_association":"CONTRIBUTOR","body":"- Check close before `onError`.\r\n- Also remove a unnecessary `stream` in `readIndex` proto definition.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1452877824/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1452879718","html_url":"https://github.com/apache/ratis/pull/834#issuecomment-1452879718","issue_url":"https://api.github.com/repos/apache/ratis/issues/834","id":1452879718,"node_id":"IC_kwDOBMxbGc5WmS9m","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-03T02:50:10Z","updated_at":"2023-03-03T02:50:10Z","author_association":"CONTRIBUTOR","body":"@kaijchen , thanks for the info.  Will check them.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1452879718/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1453041686","html_url":"https://github.com/apache/ratis/pull/840#issuecomment-1453041686","issue_url":"https://api.github.com/repos/apache/ratis/issues/840","id":1453041686,"node_id":"IC_kwDOBMxbGc5Wm6gW","user":{"login":"AngersZhuuuu","id":46485123,"node_id":"MDQ6VXNlcjQ2NDg1MTIz","avatar_url":"https://avatars.githubusercontent.com/u/46485123?v=4","gravatar_id":"","url":"https://api.github.com/users/AngersZhuuuu","html_url":"https://github.com/AngersZhuuuu","followers_url":"https://api.github.com/users/AngersZhuuuu/followers","following_url":"https://api.github.com/users/AngersZhuuuu/following{/other_user}","gists_url":"https://api.github.com/users/AngersZhuuuu/gists{/gist_id}","starred_url":"https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AngersZhuuuu/subscriptions","organizations_url":"https://api.github.com/users/AngersZhuuuu/orgs","repos_url":"https://api.github.com/users/AngersZhuuuu/repos","events_url":"https://api.github.com/users/AngersZhuuuu/events{/privacy}","received_events_url":"https://api.github.com/users/AngersZhuuuu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-03T06:24:56Z","updated_at":"2023-03-03T06:24:56Z","author_association":"CONTRIBUTOR","body":"ping @szetszwo ","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1453041686/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1453475650","html_url":"https://github.com/apache/ratis/pull/841#issuecomment-1453475650","issue_url":"https://api.github.com/repos/apache/ratis/issues/841","id":1453475650,"node_id":"IC_kwDOBMxbGc5WokdC","user":{"login":"kaijchen","id":5821159,"node_id":"MDQ6VXNlcjU4MjExNTk=","avatar_url":"https://avatars.githubusercontent.com/u/5821159?v=4","gravatar_id":"","url":"https://api.github.com/users/kaijchen","html_url":"https://github.com/kaijchen","followers_url":"https://api.github.com/users/kaijchen/followers","following_url":"https://api.github.com/users/kaijchen/following{/other_user}","gists_url":"https://api.github.com/users/kaijchen/gists{/gist_id}","starred_url":"https://api.github.com/users/kaijchen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaijchen/subscriptions","organizations_url":"https://api.github.com/users/kaijchen/orgs","repos_url":"https://api.github.com/users/kaijchen/repos","events_url":"https://api.github.com/users/kaijchen/events{/privacy}","received_events_url":"https://api.github.com/users/kaijchen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-03T12:40:45Z","updated_at":"2023-03-03T12:40:45Z","author_association":"CONTRIBUTOR","body":"@szetszwo @AngersZhuuuu PTAL, thanks.\r\n\r\nHowever, it still fails occasionally (3/100):\r\nhttps://github.com/kaijchen/ratis/actions/runs/4323262932\r\n\r\nI'll try my best to fix it.\r\n","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1453475650/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1453487847","html_url":"https://github.com/apache/ratis/pull/828#issuecomment-1453487847","issue_url":"https://api.github.com/repos/apache/ratis/issues/828","id":1453487847,"node_id":"IC_kwDOBMxbGc5Wonbn","user":{"login":"SzyWilliam","id":48054931,"node_id":"MDQ6VXNlcjQ4MDU0OTMx","avatar_url":"https://avatars.githubusercontent.com/u/48054931?v=4","gravatar_id":"","url":"https://api.github.com/users/SzyWilliam","html_url":"https://github.com/SzyWilliam","followers_url":"https://api.github.com/users/SzyWilliam/followers","following_url":"https://api.github.com/users/SzyWilliam/following{/other_user}","gists_url":"https://api.github.com/users/SzyWilliam/gists{/gist_id}","starred_url":"https://api.github.com/users/SzyWilliam/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SzyWilliam/subscriptions","organizations_url":"https://api.github.com/users/SzyWilliam/orgs","repos_url":"https://api.github.com/users/SzyWilliam/repos","events_url":"https://api.github.com/users/SzyWilliam/events{/privacy}","received_events_url":"https://api.github.com/users/SzyWilliam/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-03T12:51:51Z","updated_at":"2023-03-03T12:51:51Z","author_association":"MEMBER","body":"@szetszwo Thanks a lot for providing the test patch!❤️ I'll take a look at the test to see what's going on here.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1453487847/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1453827536","html_url":"https://github.com/apache/ratis/pull/841#issuecomment-1453827536","issue_url":"https://api.github.com/repos/apache/ratis/issues/841","id":1453827536,"node_id":"IC_kwDOBMxbGc5Wp6XQ","user":{"login":"kaijchen","id":5821159,"node_id":"MDQ6VXNlcjU4MjExNTk=","avatar_url":"https://avatars.githubusercontent.com/u/5821159?v=4","gravatar_id":"","url":"https://api.github.com/users/kaijchen","html_url":"https://github.com/kaijchen","followers_url":"https://api.github.com/users/kaijchen/followers","following_url":"https://api.github.com/users/kaijchen/following{/other_user}","gists_url":"https://api.github.com/users/kaijchen/gists{/gist_id}","starred_url":"https://api.github.com/users/kaijchen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaijchen/subscriptions","organizations_url":"https://api.github.com/users/kaijchen/orgs","repos_url":"https://api.github.com/users/kaijchen/repos","events_url":"https://api.github.com/users/kaijchen/events{/privacy}","received_events_url":"https://api.github.com/users/kaijchen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-03T17:01:50Z","updated_at":"2023-03-03T17:44:49Z","author_association":"CONTRIBUTOR","body":"> However, it still fails occasionally (3/100): https://github.com/kaijchen/ratis/actions/runs/4323262932\r\n> \r\n> I'll try my best to fix it.\r\n\r\nI believe I have found the cause.\r\n\r\nA follower's `nextIndex` (from leader's view) matches with `initialNextIndex` doesn't mean the follower has ~~applied~~ (edit: written) these logs to state machine. If we block state machine write here, sometimes we may get unexpected result.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1453827536/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1453878785","html_url":"https://github.com/apache/ratis/pull/841#issuecomment-1453878785","issue_url":"https://api.github.com/repos/apache/ratis/issues/841","id":1453878785,"node_id":"IC_kwDOBMxbGc5WqG4B","user":{"login":"kaijchen","id":5821159,"node_id":"MDQ6VXNlcjU4MjExNTk=","avatar_url":"https://avatars.githubusercontent.com/u/5821159?v=4","gravatar_id":"","url":"https://api.github.com/users/kaijchen","html_url":"https://github.com/kaijchen","followers_url":"https://api.github.com/users/kaijchen/followers","following_url":"https://api.github.com/users/kaijchen/following{/other_user}","gists_url":"https://api.github.com/users/kaijchen/gists{/gist_id}","starred_url":"https://api.github.com/users/kaijchen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaijchen/subscriptions","organizations_url":"https://api.github.com/users/kaijchen/orgs","repos_url":"https://api.github.com/users/kaijchen/repos","events_url":"https://api.github.com/users/kaijchen/events{/privacy}","received_events_url":"https://api.github.com/users/kaijchen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-03T17:43:19Z","updated_at":"2023-03-03T17:43:19Z","author_association":"CONTRIBUTOR","body":"Repeating 1000x after applied 7b21c1f2c05d7e8624299c393c03bb40c5b8bfd8:\r\nhttps://github.com/kaijchen/ratis/actions/runs/4325910230","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1453878785/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1454305422","html_url":"https://github.com/apache/ratis/pull/841#issuecomment-1454305422","issue_url":"https://api.github.com/repos/apache/ratis/issues/841","id":1454305422,"node_id":"IC_kwDOBMxbGc5WrvCO","user":{"login":"kaijchen","id":5821159,"node_id":"MDQ6VXNlcjU4MjExNTk=","avatar_url":"https://avatars.githubusercontent.com/u/5821159?v=4","gravatar_id":"","url":"https://api.github.com/users/kaijchen","html_url":"https://github.com/kaijchen","followers_url":"https://api.github.com/users/kaijchen/followers","following_url":"https://api.github.com/users/kaijchen/following{/other_user}","gists_url":"https://api.github.com/users/kaijchen/gists{/gist_id}","starred_url":"https://api.github.com/users/kaijchen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaijchen/subscriptions","organizations_url":"https://api.github.com/users/kaijchen/orgs","repos_url":"https://api.github.com/users/kaijchen/repos","events_url":"https://api.github.com/users/kaijchen/events{/privacy}","received_events_url":"https://api.github.com/users/kaijchen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-04T00:46:51Z","updated_at":"2023-03-04T00:46:51Z","author_association":"CONTRIBUTOR","body":"> Repeating 1000x after applied [7b21c1f](https://github.com/apache/ratis/commit/7b21c1f2c05d7e8624299c393c03bb40c5b8bfd8):\r\n> https://github.com/kaijchen/ratis/actions/runs/4325910230\r\n\r\n1/1000 failure, but it no longer fails at `expected:<13> but was:<11>`.\r\n\r\n```\r\nError:  Tests run: 10, Failures: 1, Errors: 0, Skipped: 0, Time elapsed: 41.578 s <<< FAILURE! - in org.apache.ratis.grpc.TestLogAppenderWithGrpc\r\nError:  testPendingLimits[0](org.apache.ratis.grpc.TestLogAppenderWithGrpc)  Time elapsed: 4.661 s  <<< FAILURE!\r\njava.lang.AssertionError: expected:<2> but was:<3>\r\n\tat org.junit.Assert.fail(Assert.java:89)\r\n\tat org.junit.Assert.failNotEquals(Assert.java:835)\r\n\tat org.junit.Assert.assertEquals(Assert.java:647)\r\n\tat org.junit.Assert.assertEquals(Assert.java:633)\r\n\tat org.apache.ratis.grpc.TestLogAppenderWithGrpc.lambda$testPendingLimits$0(TestLogAppenderWithGrpc.java:86)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1454305422/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1454324411","html_url":"https://github.com/apache/ratis/pull/841#issuecomment-1454324411","issue_url":"https://api.github.com/repos/apache/ratis/issues/841","id":1454324411,"node_id":"IC_kwDOBMxbGc5Wrzq7","user":{"login":"kaijchen","id":5821159,"node_id":"MDQ6VXNlcjU4MjExNTk=","avatar_url":"https://avatars.githubusercontent.com/u/5821159?v=4","gravatar_id":"","url":"https://api.github.com/users/kaijchen","html_url":"https://github.com/kaijchen","followers_url":"https://api.github.com/users/kaijchen/followers","following_url":"https://api.github.com/users/kaijchen/following{/other_user}","gists_url":"https://api.github.com/users/kaijchen/gists{/gist_id}","starred_url":"https://api.github.com/users/kaijchen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaijchen/subscriptions","organizations_url":"https://api.github.com/users/kaijchen/orgs","repos_url":"https://api.github.com/users/kaijchen/repos","events_url":"https://api.github.com/users/kaijchen/events{/privacy}","received_events_url":"https://api.github.com/users/kaijchen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-04T01:28:50Z","updated_at":"2023-03-04T01:28:50Z","author_association":"CONTRIBUTOR","body":"1000x testPendingLimits running:\r\nhttps://github.com/kaijchen/ratis/actions/runs/4328615615/jobs/7558484422","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1454324411/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1454786117","html_url":"https://github.com/apache/ratis/pull/828#issuecomment-1454786117","issue_url":"https://api.github.com/repos/apache/ratis/issues/828","id":1454786117,"node_id":"IC_kwDOBMxbGc5WtkZF","user":{"login":"SzyWilliam","id":48054931,"node_id":"MDQ6VXNlcjQ4MDU0OTMx","avatar_url":"https://avatars.githubusercontent.com/u/48054931?v=4","gravatar_id":"","url":"https://api.github.com/users/SzyWilliam","html_url":"https://github.com/SzyWilliam","followers_url":"https://api.github.com/users/SzyWilliam/followers","following_url":"https://api.github.com/users/SzyWilliam/following{/other_user}","gists_url":"https://api.github.com/users/SzyWilliam/gists{/gist_id}","starred_url":"https://api.github.com/users/SzyWilliam/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SzyWilliam/subscriptions","organizations_url":"https://api.github.com/users/SzyWilliam/orgs","repos_url":"https://api.github.com/users/SzyWilliam/repos","events_url":"https://api.github.com/users/SzyWilliam/events{/privacy}","received_events_url":"https://api.github.com/users/SzyWilliam/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-04T15:59:27Z","updated_at":"2023-03-04T15:59:27Z","author_association":"MEMBER","body":"@szetszwo Indeed the solution mentioned in https://github.com/carl-mastrangelo/grpc-java/commit/4a31a589c98f5f9c6f87206a6cb3c8d43b136924 is a 'ConnectionTimeoutInterceptor', and the deadline ticker will only be started once. \r\nI use a scheduleWithFixedDelay to create a deadline checker routine, refreshed every time a new response message  is received. This patch passes the tests, see https://issues.apache.org/jira/secure/attachment/13056034/828_test_passed.patch.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1454786117/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1454920640","html_url":"https://github.com/apache/ratis/pull/832#issuecomment-1454920640","issue_url":"https://api.github.com/repos/apache/ratis/issues/832","id":1454920640,"node_id":"IC_kwDOBMxbGc5WuFPA","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-04T23:26:24Z","updated_at":"2023-03-04T23:26:24Z","author_association":"CONTRIBUTOR","body":"@SzyWilliam , Yes, we should implement a probe state.  In https://github.com/etcd-io/raft/blob/main/design.md , it will return the probe state whenever the appendEntries is rejected.  It should be able to solve the frequent appendEntries problem.\r\n\r\n@kaijchen , thanks for pointing out the etcd-io design!","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1454920640/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1454927882","html_url":"https://github.com/apache/ratis/pull/828#issuecomment-1454927882","issue_url":"https://api.github.com/repos/apache/ratis/issues/828","id":1454927882,"node_id":"IC_kwDOBMxbGc5WuHAK","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-04T23:58:36Z","updated_at":"2023-03-04T23:58:36Z","author_association":"CONTRIBUTOR","body":"```java\r\n      this.timeoutFuture = TIMER.scheduleWithFixedDelay(() -> {\r\n```\r\n\r\n@SzyWilliam , it should schedule a timeout whenever calling onNext.   A fix rate does not work.  The test will fail if we change the short sleep multiplier to 0.8.\r\n```java\r\n+++ b/ratis-test/src/test/java/org/apache/ratis/grpc/tests/GreeterImpl.java\r\n@@ -39,7 +39,7 @@ class GreeterImpl extends GreeterGrpc.GreeterImplBase {\r\n \r\n   GreeterImpl(int slow, TimeDuration timeout) {\r\n     this.slow = slow;\r\n-    this.shortSleepTime = timeout.multiply(0.25);\r\n+    this.shortSleepTime = timeout.multiply(0.8);\r\n     this.longSleepTime = timeout.multiply(2);\r\n   }\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1454927882/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1454963001","html_url":"https://github.com/apache/ratis/pull/828#issuecomment-1454963001","issue_url":"https://api.github.com/repos/apache/ratis/issues/828","id":1454963001,"node_id":"IC_kwDOBMxbGc5WuPk5","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-05T02:20:44Z","updated_at":"2023-03-05T02:20:44Z","author_association":"CONTRIBUTOR","body":"Actually, my test may be wrong since all requests are sent about the same time.\r\n```\r\n2023-03-02 18:33:12,076 [Time-limited test] INFO  tests.GrpcTestClient (GrpcTestClient.java:send(107)) - send m0\r\n2023-03-02 18:33:12,085 [Time-limited test] INFO  tests.GrpcTestClient (GrpcTestClient.java:send(107)) - send m1\r\n2023-03-02 18:33:12,085 [Time-limited test] INFO  tests.GrpcTestClient (GrpcTestClient.java:send(107)) - send m2\r\n2023-03-02 18:33:12,085 [Time-limited test] INFO  tests.GrpcTestClient (GrpcTestClient.java:send(107)) - send m3\r\n2023-03-02 18:33:12,085 [Time-limited test] INFO  tests.GrpcTestClient (GrpcTestClient.java:send(107)) - send m4\r\n2023-03-02 18:33:12,085 [Time-limited test] INFO  tests.GrpcTestClient (GrpcTestClient.java:send(107)) - send m5\r\n2023-03-02 18:33:12,086 [Time-limited test] INFO  tests.GrpcTestClient (GrpcTestClient.java:send(107)) - send m6\r\n2023-03-02 18:33:12,086 [Time-limited test] INFO  tests.GrpcTestClient (GrpcTestClient.java:send(107)) - send m7\r\n2023-03-02 18:33:12,086 [Time-limited test] INFO  tests.GrpcTestClient (GrpcTestClient.java:send(107)) - send m8\r\n2023-03-02 18:33:12,086 [Time-limited test] INFO  tests.GrpcTestClient (GrpcTestClient.java:send(107)) - send m9\r\n```","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1454963001/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1454965455","html_url":"https://github.com/apache/ratis/pull/828#issuecomment-1454965455","issue_url":"https://api.github.com/repos/apache/ratis/issues/828","id":1454965455,"node_id":"IC_kwDOBMxbGc5WuQLP","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-05T02:31:59Z","updated_at":"2023-03-05T02:31:59Z","author_association":"CONTRIBUTOR","body":"`testWithInterceptors` will fail if adding a sleep between sending the requests.\r\n```java\r\n+++ b/ratis-test/src/test/java/org/apache/ratis/grpc/tests/TestDeadlineClientInterceptor.java\r\n@@ -89,6 +89,7 @@ public class TestDeadlineClientInterceptor extends BaseTest {\r\n \r\n         final List<CompletableFuture<String>> futures = new ArrayList<>();\r\n         for (String m : messages) {\r\n+          timeout.sleep();\r\n           futures.add(client.send(m));\r\n         }\r\n```","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1454965455/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1454982799","html_url":"https://github.com/apache/ratis/pull/828#issuecomment-1454982799","issue_url":"https://api.github.com/repos/apache/ratis/issues/828","id":1454982799,"node_id":"IC_kwDOBMxbGc5WuUaP","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-05T03:58:45Z","updated_at":"2023-03-05T03:58:45Z","author_association":"CONTRIBUTOR","body":"@SzyWilliam , spent some time to make it work; see #842","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1454982799/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1455563204","html_url":"https://github.com/apache/ratis/pull/828#issuecomment-1455563204","issue_url":"https://api.github.com/repos/apache/ratis/issues/828","id":1455563204,"node_id":"IC_kwDOBMxbGc5WwiHE","user":{"login":"SzyWilliam","id":48054931,"node_id":"MDQ6VXNlcjQ4MDU0OTMx","avatar_url":"https://avatars.githubusercontent.com/u/48054931?v=4","gravatar_id":"","url":"https://api.github.com/users/SzyWilliam","html_url":"https://github.com/SzyWilliam","followers_url":"https://api.github.com/users/SzyWilliam/followers","following_url":"https://api.github.com/users/SzyWilliam/following{/other_user}","gists_url":"https://api.github.com/users/SzyWilliam/gists{/gist_id}","starred_url":"https://api.github.com/users/SzyWilliam/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SzyWilliam/subscriptions","organizations_url":"https://api.github.com/users/SzyWilliam/orgs","repos_url":"https://api.github.com/users/SzyWilliam/repos","events_url":"https://api.github.com/users/SzyWilliam/events{/privacy}","received_events_url":"https://api.github.com/users/SzyWilliam/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-06T07:07:22Z","updated_at":"2023-03-06T07:07:22Z","author_association":"MEMBER","body":"@szetszwo Thanks very much for testing and pointing out the issues! Will take a look at https://github.com/apache/ratis/pull/842!","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1455563204/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1456208016","html_url":"https://github.com/apache/ratis/pull/843#issuecomment-1456208016","issue_url":"https://api.github.com/repos/apache/ratis/issues/843","id":1456208016,"node_id":"IC_kwDOBMxbGc5Wy_iQ","user":{"login":"kaijchen","id":5821159,"node_id":"MDQ6VXNlcjU4MjExNTk=","avatar_url":"https://avatars.githubusercontent.com/u/5821159?v=4","gravatar_id":"","url":"https://api.github.com/users/kaijchen","html_url":"https://github.com/kaijchen","followers_url":"https://api.github.com/users/kaijchen/followers","following_url":"https://api.github.com/users/kaijchen/following{/other_user}","gists_url":"https://api.github.com/users/kaijchen/gists{/gist_id}","starred_url":"https://api.github.com/users/kaijchen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaijchen/subscriptions","organizations_url":"https://api.github.com/users/kaijchen/orgs","repos_url":"https://api.github.com/users/kaijchen/repos","events_url":"https://api.github.com/users/kaijchen/events{/privacy}","received_events_url":"https://api.github.com/users/kaijchen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-06T14:11:20Z","updated_at":"2023-03-06T14:11:20Z","author_association":"CONTRIBUTOR","body":"After a second thought, let's focus on addressing the problem in this Jira, and leave PreCandidate state as TODO for now.\r\nClosed in favor of #844.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1456208016/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1456394425","html_url":"https://github.com/apache/ratis/pull/844#issuecomment-1456394425","issue_url":"https://api.github.com/repos/apache/ratis/issues/844","id":1456394425,"node_id":"IC_kwDOBMxbGc5WztC5","user":{"login":"kaijchen","id":5821159,"node_id":"MDQ6VXNlcjU4MjExNTk=","avatar_url":"https://avatars.githubusercontent.com/u/5821159?v=4","gravatar_id":"","url":"https://api.github.com/users/kaijchen","html_url":"https://github.com/kaijchen","followers_url":"https://api.github.com/users/kaijchen/followers","following_url":"https://api.github.com/users/kaijchen/following{/other_user}","gists_url":"https://api.github.com/users/kaijchen/gists{/gist_id}","starred_url":"https://api.github.com/users/kaijchen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaijchen/subscriptions","organizations_url":"https://api.github.com/users/kaijchen/orgs","repos_url":"https://api.github.com/users/kaijchen/repos","events_url":"https://api.github.com/users/kaijchen/events{/privacy}","received_events_url":"https://api.github.com/users/kaijchen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-06T15:54:28Z","updated_at":"2023-03-06T15:54:28Z","author_association":"CONTRIBUTOR","body":"The failed test is not related,\r\nWithout this patch: https://github.com/kaijchen/ratis/actions/runs/4345085390\r\nWith this patch: https://github.com/kaijchen/ratis/actions/runs/4345237123","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1456394425/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1456695361","html_url":"https://github.com/apache/ratis/pull/842#issuecomment-1456695361","issue_url":"https://api.github.com/repos/apache/ratis/issues/842","id":1456695361,"node_id":"IC_kwDOBMxbGc5W02hB","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-06T18:15:16Z","updated_at":"2023-03-06T18:15:16Z","author_association":"CONTRIBUTOR","body":"@SzyWilliam , I think you are looking at a timeout + limiting pending request mechanism.\r\n- Support the pending request limit is L.\r\n- The timeout T should be long enough for processing L requests.\r\n- If the number of pending request < L,  a request is sent out with the timeout T.\r\n- If the number of pending request == L, a request enters a wait queue before sending it out.\r\n","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1456695361/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":1,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1457315179","html_url":"https://github.com/apache/ratis/pull/842#issuecomment-1457315179","issue_url":"https://api.github.com/repos/apache/ratis/issues/842","id":1457315179,"node_id":"IC_kwDOBMxbGc5W3N1r","user":{"login":"SzyWilliam","id":48054931,"node_id":"MDQ6VXNlcjQ4MDU0OTMx","avatar_url":"https://avatars.githubusercontent.com/u/48054931?v=4","gravatar_id":"","url":"https://api.github.com/users/SzyWilliam","html_url":"https://github.com/SzyWilliam","followers_url":"https://api.github.com/users/SzyWilliam/followers","following_url":"https://api.github.com/users/SzyWilliam/following{/other_user}","gists_url":"https://api.github.com/users/SzyWilliam/gists{/gist_id}","starred_url":"https://api.github.com/users/SzyWilliam/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SzyWilliam/subscriptions","organizations_url":"https://api.github.com/users/SzyWilliam/orgs","repos_url":"https://api.github.com/users/SzyWilliam/repos","events_url":"https://api.github.com/users/SzyWilliam/events{/privacy}","received_events_url":"https://api.github.com/users/SzyWilliam/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-07T01:12:41Z","updated_at":"2023-03-07T01:12:41Z","author_association":"MEMBER","body":"@szetszwo You are right! Timeout and pending limit together can help avoid the original deadline issue. The timeout upper bound is L * (time required to process each RPC). Shall we use a separate timeout config for installSnapshot?","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1457315179/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1457445334","html_url":"https://github.com/apache/ratis/pull/809#issuecomment-1457445334","issue_url":"https://api.github.com/repos/apache/ratis/issues/809","id":1457445334,"node_id":"IC_kwDOBMxbGc5W3tnW","user":{"login":"kaijchen","id":5821159,"node_id":"MDQ6VXNlcjU4MjExNTk=","avatar_url":"https://avatars.githubusercontent.com/u/5821159?v=4","gravatar_id":"","url":"https://api.github.com/users/kaijchen","html_url":"https://github.com/kaijchen","followers_url":"https://api.github.com/users/kaijchen/followers","following_url":"https://api.github.com/users/kaijchen/following{/other_user}","gists_url":"https://api.github.com/users/kaijchen/gists{/gist_id}","starred_url":"https://api.github.com/users/kaijchen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaijchen/subscriptions","organizations_url":"https://api.github.com/users/kaijchen/orgs","repos_url":"https://api.github.com/users/kaijchen/repos","events_url":"https://api.github.com/users/kaijchen/events{/privacy}","received_events_url":"https://api.github.com/users/kaijchen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-07T03:12:36Z","updated_at":"2023-03-07T03:12:36Z","author_association":"CONTRIBUTOR","body":"New PR opened in #845.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1457445334/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1457508771","html_url":"https://github.com/apache/ratis/pull/842#issuecomment-1457508771","issue_url":"https://api.github.com/repos/apache/ratis/issues/842","id":1457508771,"node_id":"IC_kwDOBMxbGc5W39Gj","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-07T04:26:41Z","updated_at":"2023-03-07T04:26:41Z","author_association":"CONTRIBUTOR","body":"@SzyWilliam , thanks for reviewing this!  Let's merge this and continue working on\r\n- separate timeout config for installSnapshot;\r\n- enforce a pending request limit.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1457508771/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1458076329","html_url":"https://github.com/apache/ratis/pull/847#issuecomment-1458076329","issue_url":"https://api.github.com/repos/apache/ratis/issues/847","id":1458076329,"node_id":"IC_kwDOBMxbGc5W6Hqp","user":{"login":"kaijchen","id":5821159,"node_id":"MDQ6VXNlcjU4MjExNTk=","avatar_url":"https://avatars.githubusercontent.com/u/5821159?v=4","gravatar_id":"","url":"https://api.github.com/users/kaijchen","html_url":"https://github.com/kaijchen","followers_url":"https://api.github.com/users/kaijchen/followers","following_url":"https://api.github.com/users/kaijchen/following{/other_user}","gists_url":"https://api.github.com/users/kaijchen/gists{/gist_id}","starred_url":"https://api.github.com/users/kaijchen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaijchen/subscriptions","organizations_url":"https://api.github.com/users/kaijchen/orgs","repos_url":"https://api.github.com/users/kaijchen/repos","events_url":"https://api.github.com/users/kaijchen/events{/privacy}","received_events_url":"https://api.github.com/users/kaijchen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-07T12:20:18Z","updated_at":"2023-03-08T11:39:59Z","author_association":"CONTRIBUTOR","body":"Personally I prefer the changes in this PR, but it may hurt performance slightly.\r\n\r\nAn alternative solution: https://github.com/kaijchen/ratis/commit/bca67669e1aa41d85126c4ce497872c91656c8c9\r\nCI: https://github.com/kaijchen/ratis/actions/runs/4354104994\r\n\r\n@szetszwo, what do you think?","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1458076329/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1461190276","html_url":"https://github.com/apache/ratis/pull/849#issuecomment-1461190276","issue_url":"https://api.github.com/repos/apache/ratis/issues/849","id":1461190276,"node_id":"IC_kwDOBMxbGc5XF_6E","user":{"login":"SzyWilliam","id":48054931,"node_id":"MDQ6VXNlcjQ4MDU0OTMx","avatar_url":"https://avatars.githubusercontent.com/u/48054931?v=4","gravatar_id":"","url":"https://api.github.com/users/SzyWilliam","html_url":"https://github.com/SzyWilliam","followers_url":"https://api.github.com/users/SzyWilliam/followers","following_url":"https://api.github.com/users/SzyWilliam/following{/other_user}","gists_url":"https://api.github.com/users/SzyWilliam/gists{/gist_id}","starred_url":"https://api.github.com/users/SzyWilliam/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SzyWilliam/subscriptions","organizations_url":"https://api.github.com/users/SzyWilliam/orgs","repos_url":"https://api.github.com/users/SzyWilliam/repos","events_url":"https://api.github.com/users/SzyWilliam/events{/privacy}","received_events_url":"https://api.github.com/users/SzyWilliam/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-09T02:52:40Z","updated_at":"2023-03-09T02:52:40Z","author_association":"MEMBER","body":"@szetszwo Thanks for the review! Changed to the simple version.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1461190276/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1461208606","html_url":"https://github.com/apache/ratis/pull/842#issuecomment-1461208606","issue_url":"https://api.github.com/repos/apache/ratis/issues/842","id":1461208606,"node_id":"IC_kwDOBMxbGc5XGEYe","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-09T03:19:43Z","updated_at":"2023-03-09T03:19:43Z","author_association":"CONTRIBUTOR","body":"> If the number of pending request == L, a request enters a wait queue before sending it out.\r\n\r\n@SzyWilliam , we indeed should simply block the onNext call.  It will slow down the caller.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1461208606/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1464057234","html_url":"https://github.com/apache/ratis/pull/845#issuecomment-1464057234","issue_url":"https://api.github.com/repos/apache/ratis/issues/845","id":1464057234,"node_id":"IC_kwDOBMxbGc5XQ72S","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-10T16:27:57Z","updated_at":"2023-03-10T16:27:57Z","author_association":"CONTRIBUTOR","body":"@kaijchen , I reviewed this and the TransferLeadership code earlier and found some suggestions.  Will post some comments soon.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1464057234/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1465643259","html_url":"https://github.com/apache/ratis/pull/853#issuecomment-1465643259","issue_url":"https://api.github.com/repos/apache/ratis/issues/853","id":1465643259,"node_id":"IC_kwDOBMxbGc5XW_D7","user":{"login":"adoroszlai","id":6454655,"node_id":"MDQ6VXNlcjY0NTQ2NTU=","avatar_url":"https://avatars.githubusercontent.com/u/6454655?v=4","gravatar_id":"","url":"https://api.github.com/users/adoroszlai","html_url":"https://github.com/adoroszlai","followers_url":"https://api.github.com/users/adoroszlai/followers","following_url":"https://api.github.com/users/adoroszlai/following{/other_user}","gists_url":"https://api.github.com/users/adoroszlai/gists{/gist_id}","starred_url":"https://api.github.com/users/adoroszlai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adoroszlai/subscriptions","organizations_url":"https://api.github.com/users/adoroszlai/orgs","repos_url":"https://api.github.com/users/adoroszlai/repos","events_url":"https://api.github.com/users/adoroszlai/events{/privacy}","received_events_url":"https://api.github.com/users/adoroszlai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-13T07:33:48Z","updated_at":"2023-03-13T07:33:48Z","author_association":"CONTRIBUTOR","body":"Thanks @kaijchen for the patch, @codings-dan for the review.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1465643259/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1467261660","html_url":"https://github.com/apache/ratis/pull/844#issuecomment-1467261660","issue_url":"https://api.github.com/repos/apache/ratis/issues/844","id":1467261660,"node_id":"IC_kwDOBMxbGc5XdKLc","user":{"login":"kaijchen","id":5821159,"node_id":"MDQ6VXNlcjU4MjExNTk=","avatar_url":"https://avatars.githubusercontent.com/u/5821159?v=4","gravatar_id":"","url":"https://api.github.com/users/kaijchen","html_url":"https://github.com/kaijchen","followers_url":"https://api.github.com/users/kaijchen/followers","following_url":"https://api.github.com/users/kaijchen/following{/other_user}","gists_url":"https://api.github.com/users/kaijchen/gists{/gist_id}","starred_url":"https://api.github.com/users/kaijchen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaijchen/subscriptions","organizations_url":"https://api.github.com/users/kaijchen/orgs","repos_url":"https://api.github.com/users/kaijchen/repos","events_url":"https://api.github.com/users/kaijchen/events{/privacy}","received_events_url":"https://api.github.com/users/kaijchen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-14T02:37:27Z","updated_at":"2023-03-14T02:37:27Z","author_association":"CONTRIBUTOR","body":"Thanks @szetszwo for the review.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1467261660/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1467276782","html_url":"https://github.com/apache/ratis/pull/852#issuecomment-1467276782","issue_url":"https://api.github.com/repos/apache/ratis/issues/852","id":1467276782,"node_id":"IC_kwDOBMxbGc5XdN3u","user":{"login":"qian0817","id":45898769,"node_id":"MDQ6VXNlcjQ1ODk4NzY5","avatar_url":"https://avatars.githubusercontent.com/u/45898769?v=4","gravatar_id":"","url":"https://api.github.com/users/qian0817","html_url":"https://github.com/qian0817","followers_url":"https://api.github.com/users/qian0817/followers","following_url":"https://api.github.com/users/qian0817/following{/other_user}","gists_url":"https://api.github.com/users/qian0817/gists{/gist_id}","starred_url":"https://api.github.com/users/qian0817/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/qian0817/subscriptions","organizations_url":"https://api.github.com/users/qian0817/orgs","repos_url":"https://api.github.com/users/qian0817/repos","events_url":"https://api.github.com/users/qian0817/events{/privacy}","received_events_url":"https://api.github.com/users/qian0817/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-14T02:58:56Z","updated_at":"2023-03-14T02:58:56Z","author_association":"CONTRIBUTOR","body":"I have another question, how can I know if a node is a listener on the client side? Currently it seems impossible to achieve this. @szetszwo ","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1467276782/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1467291833","html_url":"https://github.com/apache/ratis/pull/852#issuecomment-1467291833","issue_url":"https://api.github.com/repos/apache/ratis/issues/852","id":1467291833,"node_id":"IC_kwDOBMxbGc5XdRi5","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-14T03:20:25Z","updated_at":"2023-03-14T03:20:25Z","author_association":"CONTRIBUTOR","body":"@qian0817 , use `group info` api/cli.  It should return all information of the group.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1467291833/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1467293903","html_url":"https://github.com/apache/ratis/pull/852#issuecomment-1467293903","issue_url":"https://api.github.com/repos/apache/ratis/issues/852","id":1467293903,"node_id":"IC_kwDOBMxbGc5XdSDP","user":{"login":"qian0817","id":45898769,"node_id":"MDQ6VXNlcjQ1ODk4NzY5","avatar_url":"https://avatars.githubusercontent.com/u/45898769?v=4","gravatar_id":"","url":"https://api.github.com/users/qian0817","html_url":"https://github.com/qian0817","followers_url":"https://api.github.com/users/qian0817/followers","following_url":"https://api.github.com/users/qian0817/following{/other_user}","gists_url":"https://api.github.com/users/qian0817/gists{/gist_id}","starred_url":"https://api.github.com/users/qian0817/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/qian0817/subscriptions","organizations_url":"https://api.github.com/users/qian0817/orgs","repos_url":"https://api.github.com/users/qian0817/repos","events_url":"https://api.github.com/users/qian0817/events{/privacy}","received_events_url":"https://api.github.com/users/qian0817/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-14T03:24:06Z","updated_at":"2023-03-14T03:24:06Z","author_association":"CONTRIBUTOR","body":"I think that in the `group info` API, only the 'startup role' value is returned, but this value does not seem to represent the actual role of the node at that time.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1467293903/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1467316873","html_url":"https://github.com/apache/ratis/pull/852#issuecomment-1467316873","issue_url":"https://api.github.com/repos/apache/ratis/issues/852","id":1467316873,"node_id":"IC_kwDOBMxbGc5XdXqJ","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-14T03:58:05Z","updated_at":"2023-03-14T03:58:05Z","author_association":"CONTRIBUTOR","body":"There is also a `role` in the returned `RoleInfoProto`.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1467316873/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1467410299","html_url":"https://github.com/apache/ratis/pull/852#issuecomment-1467410299","issue_url":"https://api.github.com/repos/apache/ratis/issues/852","id":1467410299,"node_id":"IC_kwDOBMxbGc5Xdud7","user":{"login":"qian0817","id":45898769,"node_id":"MDQ6VXNlcjQ1ODk4NzY5","avatar_url":"https://avatars.githubusercontent.com/u/45898769?v=4","gravatar_id":"","url":"https://api.github.com/users/qian0817","html_url":"https://github.com/qian0817","followers_url":"https://api.github.com/users/qian0817/followers","following_url":"https://api.github.com/users/qian0817/following{/other_user}","gists_url":"https://api.github.com/users/qian0817/gists{/gist_id}","starred_url":"https://api.github.com/users/qian0817/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/qian0817/subscriptions","organizations_url":"https://api.github.com/users/qian0817/orgs","repos_url":"https://api.github.com/users/qian0817/repos","events_url":"https://api.github.com/users/qian0817/events{/privacy}","received_events_url":"https://api.github.com/users/qian0817/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-14T05:55:59Z","updated_at":"2023-03-14T07:23:59Z","author_association":"CONTRIBUTOR","body":"Thanks for your answer. I tried and was able to obtain information about the roles of all current nodes through the following code.\r\n\r\n```java\r\nGroupInfoReply groupInfoReply = client.getGroupManagementApi(client.getLeaderId())\r\n        .info(Constants.RAFT_GROUP.getGroupId());\r\nfor (RaftPeer peer : groupInfoReply.getGroup().getPeers()) {\r\n  GroupInfoReply reply = client.getGroupManagementApi(peer.getId())\r\n      .info(Constants.RAFT_GROUP.getGroupId());\r\n  System.out.println(peer.getId() + \": \" + reply.getRoleInfoProto().getRole());\r\n}\r\n\r\n```","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1467410299/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1467497622","html_url":"https://github.com/apache/ratis/pull/852#issuecomment-1467497622","issue_url":"https://api.github.com/repos/apache/ratis/issues/852","id":1467497622,"node_id":"IC_kwDOBMxbGc5XeDyW","user":{"login":"qian0817","id":45898769,"node_id":"MDQ6VXNlcjQ1ODk4NzY5","avatar_url":"https://avatars.githubusercontent.com/u/45898769?v=4","gravatar_id":"","url":"https://api.github.com/users/qian0817","html_url":"https://github.com/qian0817","followers_url":"https://api.github.com/users/qian0817/followers","following_url":"https://api.github.com/users/qian0817/following{/other_user}","gists_url":"https://api.github.com/users/qian0817/gists{/gist_id}","starred_url":"https://api.github.com/users/qian0817/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/qian0817/subscriptions","organizations_url":"https://api.github.com/users/qian0817/orgs","repos_url":"https://api.github.com/users/qian0817/repos","events_url":"https://api.github.com/users/qian0817/events{/privacy}","received_events_url":"https://api.github.com/users/qian0817/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-14T07:10:06Z","updated_at":"2023-03-14T07:10:06Z","author_association":"CONTRIBUTOR","body":"I tried the above method, which requests all nodes and obtains corresponding role information. Therefore, if any node goes down, it cannot work properly. Is there a way to request only one node and obtain information about all listeners in the cluster?","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1467497622/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1467632698","html_url":"https://github.com/apache/ratis/pull/852#issuecomment-1467632698","issue_url":"https://api.github.com/repos/apache/ratis/issues/852","id":1467632698,"node_id":"IC_kwDOBMxbGc5Xekw6","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-14T08:30:55Z","updated_at":"2023-03-14T08:30:55Z","author_association":"CONTRIBUTOR","body":"> ...  Therefore, if any node goes down, it cannot work properly ...\r\n\r\n@qian0817 , the information returned is the view of the peer specified in `getGroupManagementApi(peer.getId())`.  It does not require other peers to be running.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1467632698/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1467863652","html_url":"https://github.com/apache/ratis/pull/850#issuecomment-1467863652","issue_url":"https://api.github.com/repos/apache/ratis/issues/850","id":1467863652,"node_id":"IC_kwDOBMxbGc5XfdJk","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-14T10:52:39Z","updated_at":"2023-03-14T10:52:39Z","author_association":"CONTRIBUTOR","body":"@SzyWilliam , thanks a lot for reviewing this!","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1467863652/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1469457787","html_url":"https://github.com/apache/ratis/pull/855#issuecomment-1469457787","issue_url":"https://api.github.com/repos/apache/ratis/issues/855","id":1469457787,"node_id":"IC_kwDOBMxbGc5XliV7","user":{"login":"HxpSerein","id":65238551,"node_id":"MDQ6VXNlcjY1MjM4NTUx","avatar_url":"https://avatars.githubusercontent.com/u/65238551?v=4","gravatar_id":"","url":"https://api.github.com/users/HxpSerein","html_url":"https://github.com/HxpSerein","followers_url":"https://api.github.com/users/HxpSerein/followers","following_url":"https://api.github.com/users/HxpSerein/following{/other_user}","gists_url":"https://api.github.com/users/HxpSerein/gists{/gist_id}","starred_url":"https://api.github.com/users/HxpSerein/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HxpSerein/subscriptions","organizations_url":"https://api.github.com/users/HxpSerein/orgs","repos_url":"https://api.github.com/users/HxpSerein/repos","events_url":"https://api.github.com/users/HxpSerein/events{/privacy}","received_events_url":"https://api.github.com/users/HxpSerein/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-15T07:06:16Z","updated_at":"2023-03-15T07:06:16Z","author_association":"CONTRIBUTOR","body":"@szetszwo  Please help review it, thanks!","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1469457787/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1469793583","html_url":"https://github.com/apache/ratis/pull/854#issuecomment-1469793583","issue_url":"https://api.github.com/repos/apache/ratis/issues/854","id":1469793583,"node_id":"IC_kwDOBMxbGc5Xm0Uv","user":{"login":"kaijchen","id":5821159,"node_id":"MDQ6VXNlcjU4MjExNTk=","avatar_url":"https://avatars.githubusercontent.com/u/5821159?v=4","gravatar_id":"","url":"https://api.github.com/users/kaijchen","html_url":"https://github.com/kaijchen","followers_url":"https://api.github.com/users/kaijchen/followers","following_url":"https://api.github.com/users/kaijchen/following{/other_user}","gists_url":"https://api.github.com/users/kaijchen/gists{/gist_id}","starred_url":"https://api.github.com/users/kaijchen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaijchen/subscriptions","organizations_url":"https://api.github.com/users/kaijchen/orgs","repos_url":"https://api.github.com/users/kaijchen/repos","events_url":"https://api.github.com/users/kaijchen/events{/privacy}","received_events_url":"https://api.github.com/users/kaijchen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-15T11:00:11Z","updated_at":"2023-03-15T11:00:11Z","author_association":"CONTRIBUTOR","body":"Please add `.mvn/wrapper/maven-wrapper.jar` to `.gitignore`.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1469793583/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1469863987","html_url":"https://github.com/apache/ratis/pull/854#issuecomment-1469863987","issue_url":"https://api.github.com/repos/apache/ratis/issues/854","id":1469863987,"node_id":"IC_kwDOBMxbGc5XnFgz","user":{"login":"tisonkun","id":18818196,"node_id":"MDQ6VXNlcjE4ODE4MTk2","avatar_url":"https://avatars.githubusercontent.com/u/18818196?v=4","gravatar_id":"","url":"https://api.github.com/users/tisonkun","html_url":"https://github.com/tisonkun","followers_url":"https://api.github.com/users/tisonkun/followers","following_url":"https://api.github.com/users/tisonkun/following{/other_user}","gists_url":"https://api.github.com/users/tisonkun/gists{/gist_id}","starred_url":"https://api.github.com/users/tisonkun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tisonkun/subscriptions","organizations_url":"https://api.github.com/users/tisonkun/orgs","repos_url":"https://api.github.com/users/tisonkun/repos","events_url":"https://api.github.com/users/tisonkun/events{/privacy}","received_events_url":"https://api.github.com/users/tisonkun/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-15T11:51:08Z","updated_at":"2023-03-15T11:51:08Z","author_association":"MEMBER","body":"@kaijchen Done. I have a local global ignore pattern to ignore it :)","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/1469863987/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]