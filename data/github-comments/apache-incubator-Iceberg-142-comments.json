[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1016651149","html_url":"https://github.com/apache/iceberg/issues/3905#issuecomment-1016651149","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3905","id":1016651149,"node_id":"IC_kwDOCW7NX848mN2N","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-19T16:38:41Z","updated_at":"2022-01-19T16:38:41Z","author_association":"CONTRIBUTOR","body":"@hililiwei this can be achieved by setting the filters in `ScanContext` when constructing the `FlinkSource`","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1016651149/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1016706748","html_url":"https://github.com/apache/iceberg/issues/3903#issuecomment-1016706748","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3903","id":1016706748,"node_id":"IC_kwDOCW7NX848mba8","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-19T17:39:10Z","updated_at":"2022-01-19T17:39:10Z","author_association":"COLLABORATOR","body":"Yea i think in current versions there is no good way I could find, unfortunately.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1016706748/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1016719135","html_url":"https://github.com/apache/iceberg/pull/3926#issuecomment-1016719135","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3926","id":1016719135,"node_id":"IC_kwDOCW7NX848mecf","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-19T17:54:22Z","updated_at":"2022-01-19T18:46:26Z","author_association":"CONTRIBUTOR","body":"I updated the test that is failing. It's a rather simple fix, but I'm surprised we haven't hit them before.\r\n\r\nhttps://github.com/apache/iceberg/pull/3931","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1016719135/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1016778288","html_url":"https://github.com/apache/iceberg/pull/3931#issuecomment-1016778288","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3931","id":1016778288,"node_id":"IC_kwDOCW7NX848ms4w","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-19T19:05:26Z","updated_at":"2022-01-19T19:05:26Z","author_association":"CONTRIBUTOR","body":"Thanks, @kbendick!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1016778288/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1016900822","html_url":"https://github.com/apache/iceberg/pull/3925#issuecomment-1016900822","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3925","id":1016900822,"node_id":"IC_kwDOCW7NX848nKzW","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-19T21:53:22Z","updated_at":"2022-01-19T21:53:22Z","author_association":"CONTRIBUTOR","body":"Thanks, @openinx!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1016900822/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1016961486","html_url":"https://github.com/apache/iceberg/pull/3875#issuecomment-1016961486","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3875","id":1016961486,"node_id":"IC_kwDOCW7NX848nZnO","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-19T23:21:51Z","updated_at":"2022-01-19T23:21:51Z","author_association":"CONTRIBUTOR","body":"Nice work. Thanks, @puchengy!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1016961486/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1016962188","html_url":"https://github.com/apache/iceberg/pull/3927#issuecomment-1016962188","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3927","id":1016962188,"node_id":"IC_kwDOCW7NX848nZyM","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-19T23:22:56Z","updated_at":"2022-01-19T23:22:56Z","author_association":"CONTRIBUTOR","body":"Thanks, @cccs-eric! And thanks to @samredai for pinging me.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1016962188/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1016962847","html_url":"https://github.com/apache/iceberg/pull/3892#issuecomment-1016962847","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3892","id":1016962847,"node_id":"IC_kwDOCW7NX848nZ8f","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-19T23:24:09Z","updated_at":"2022-01-19T23:24:09Z","author_association":"CONTRIBUTOR","body":"Thanks, @hililiwei! Good to have those listed.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1016962847/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1016973828","html_url":"https://github.com/apache/iceberg/issues/3932#issuecomment-1016973828","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3932","id":1016973828,"node_id":"IC_kwDOCW7NX848ncoE","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-19T23:46:25Z","updated_at":"2022-01-19T23:46:25Z","author_association":"CONTRIBUTOR","body":"Here is the [PR](https://github.com/apache/iceberg/pull/3933)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1016973828/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1016973987","html_url":"https://github.com/apache/iceberg/issues/3932#issuecomment-1016973987","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3932","id":1016973987,"node_id":"IC_kwDOCW7NX848ncqj","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-19T23:46:48Z","updated_at":"2022-01-19T23:46:48Z","author_association":"CONTRIBUTOR","body":"cc @RussellSpitzer ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1016973987/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1016989625","html_url":"https://github.com/apache/iceberg/pull/3691#issuecomment-1016989625","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3691","id":1016989625,"node_id":"IC_kwDOCW7NX848nge5","user":{"login":"emkornfield","id":17869838,"node_id":"MDQ6VXNlcjE3ODY5ODM4","avatar_url":"https://avatars.githubusercontent.com/u/17869838?v=4","gravatar_id":"","url":"https://api.github.com/users/emkornfield","html_url":"https://github.com/emkornfield","followers_url":"https://api.github.com/users/emkornfield/followers","following_url":"https://api.github.com/users/emkornfield/following{/other_user}","gists_url":"https://api.github.com/users/emkornfield/gists{/gist_id}","starred_url":"https://api.github.com/users/emkornfield/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/emkornfield/subscriptions","organizations_url":"https://api.github.com/users/emkornfield/orgs","repos_url":"https://api.github.com/users/emkornfield/repos","events_url":"https://api.github.com/users/emkornfield/events{/privacy}","received_events_url":"https://api.github.com/users/emkornfield/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-20T00:17:20Z","updated_at":"2022-01-20T00:17:20Z","author_association":"CONTRIBUTOR","body":"Sorry, trying to ramp up on some of these changes, so if this is answered elsewhere (maybe design doc) I'd be happy to read it.  Was creating a new abstraction weighed against using something already in the python ecosystem (e.g. [fsspec](https://filesystem-spec.readthedocs.io/en/latest/))","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1016989625/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1016999181","html_url":"https://github.com/apache/iceberg/pull/3691#issuecomment-1016999181","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3691","id":1016999181,"node_id":"IC_kwDOCW7NX848ni0N","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-20T00:37:12Z","updated_at":"2022-01-20T00:37:48Z","author_association":"CONTRIBUTOR","body":"@emkornfield, yes.\r\n\r\nThe FileIO abstraction is a weaker abstraction. Iceberg doesn't require file listing, directories, or many of the features of a file system. It only cares that it can read a file as a stream with seek, or write a file and get the byte position from time to time. That's why we maintain a light-weight way to plug in. Having a fsspec FileIO makes a lot of sense for generic use cases, but we don't want to make strict requirements about large dependencies.\r\n\r\nThis has really helped on the Java side, where we are using this to lower dependence on Hadoop's FileSystem API. And it also allows us to do some custom operations, like hook into S3 setup for non-standard credentials chains.\r\n\r\nfsspec is definitely one of the base implementations that we're talking about. But if you want to avoid that dependency and use boto3 directly, you should be able to.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1016999181/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017001858","html_url":"https://github.com/apache/iceberg/pull/3708#issuecomment-1017001858","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3708","id":1017001858,"node_id":"IC_kwDOCW7NX848njeC","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-20T00:42:32Z","updated_at":"2022-01-20T00:42:32Z","author_association":"CONTRIBUTOR","body":"Thanks, @xiaotianzhang01!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017001858/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017014923","html_url":"https://github.com/apache/iceberg/pull/3760#issuecomment-1017014923","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3760","id":1017014923,"node_id":"IC_kwDOCW7NX848nmqL","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-20T01:03:36Z","updated_at":"2022-01-20T01:03:36Z","author_association":"COLLABORATOR","body":"@RussellSpitzer  thanks a lot for review, done.  The upper bound check in the test was already there (i clarified a bit the assert message to try to make it more clear).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017014923/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017022508","html_url":"https://github.com/apache/iceberg/pull/3691#issuecomment-1017022508","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3691","id":1017022508,"node_id":"IC_kwDOCW7NX848nogs","user":{"login":"emkornfield","id":17869838,"node_id":"MDQ6VXNlcjE3ODY5ODM4","avatar_url":"https://avatars.githubusercontent.com/u/17869838?v=4","gravatar_id":"","url":"https://api.github.com/users/emkornfield","html_url":"https://github.com/emkornfield","followers_url":"https://api.github.com/users/emkornfield/followers","following_url":"https://api.github.com/users/emkornfield/following{/other_user}","gists_url":"https://api.github.com/users/emkornfield/gists{/gist_id}","starred_url":"https://api.github.com/users/emkornfield/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/emkornfield/subscriptions","organizations_url":"https://api.github.com/users/emkornfield/orgs","repos_url":"https://api.github.com/users/emkornfield/repos","events_url":"https://api.github.com/users/emkornfield/events{/privacy}","received_events_url":"https://api.github.com/users/emkornfield/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-20T01:18:04Z","updated_at":"2022-01-20T01:18:04Z","author_association":"CONTRIBUTOR","body":"> This still leaves an open question on how we manage dependencies for all of the implementations. For example, if a user does not plan on using S3FileIO or has their own s3 file io implementation that does not depend on boto3, it should not be forced as a hard dependency.\r\n\r\nI think as a generic answer looking at what [fsspec](https://filesystem-spec.readthedocs.io/en/latest/developer.html#implementing-a-backend) has done (and having these as separate packages) that the use can install in there environment probably makes sense.  \r\n\r\nSpecifically for S3, if pyarrow is a hard dependency for parquet reading providing reference implementations based off of its file systems (it comes prepackaged with S3) could make sense.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017022508/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017027427","html_url":"https://github.com/apache/iceberg/issues/3934#issuecomment-1017027427","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3934","id":1017027427,"node_id":"IC_kwDOCW7NX848nptj","user":{"login":"emkornfield","id":17869838,"node_id":"MDQ6VXNlcjE3ODY5ODM4","avatar_url":"https://avatars.githubusercontent.com/u/17869838?v=4","gravatar_id":"","url":"https://api.github.com/users/emkornfield","html_url":"https://github.com/emkornfield","followers_url":"https://api.github.com/users/emkornfield/followers","following_url":"https://api.github.com/users/emkornfield/following{/other_user}","gists_url":"https://api.github.com/users/emkornfield/gists{/gist_id}","starred_url":"https://api.github.com/users/emkornfield/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/emkornfield/subscriptions","organizations_url":"https://api.github.com/users/emkornfield/orgs","repos_url":"https://api.github.com/users/emkornfield/repos","events_url":"https://api.github.com/users/emkornfield/events{/privacy}","received_events_url":"https://api.github.com/users/emkornfield/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-20T01:28:31Z","updated_at":"2022-01-20T01:28:31Z","author_association":"CONTRIBUTOR","body":"I assume if it was present it would be in tox.ini (perhaps I missed it)?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017027427/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017028099","html_url":"https://github.com/apache/iceberg/issues/3934#issuecomment-1017028099","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3934","id":1017028099,"node_id":"IC_kwDOCW7NX848np4D","user":{"login":"emkornfield","id":17869838,"node_id":"MDQ6VXNlcjE3ODY5ODM4","avatar_url":"https://avatars.githubusercontent.com/u/17869838?v=4","gravatar_id":"","url":"https://api.github.com/users/emkornfield","html_url":"https://github.com/emkornfield","followers_url":"https://api.github.com/users/emkornfield/followers","following_url":"https://api.github.com/users/emkornfield/following{/other_user}","gists_url":"https://api.github.com/users/emkornfield/gists{/gist_id}","starred_url":"https://api.github.com/users/emkornfield/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/emkornfield/subscriptions","organizations_url":"https://api.github.com/users/emkornfield/orgs","repos_url":"https://api.github.com/users/emkornfield/repos","events_url":"https://api.github.com/users/emkornfield/events{/privacy}","received_events_url":"https://api.github.com/users/emkornfield/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-20T01:30:05Z","updated_at":"2022-01-20T01:30:05Z","author_association":"CONTRIBUTOR","body":"Actually it looks like flake8 should probably be run so maybe this isn't an issue","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017028099/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017028938","html_url":"https://github.com/apache/iceberg/issues/3934#issuecomment-1017028938","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3934","id":1017028938,"node_id":"IC_kwDOCW7NX848nqFK","user":{"login":"emkornfield","id":17869838,"node_id":"MDQ6VXNlcjE3ODY5ODM4","avatar_url":"https://avatars.githubusercontent.com/u/17869838?v=4","gravatar_id":"","url":"https://api.github.com/users/emkornfield","html_url":"https://github.com/emkornfield","followers_url":"https://api.github.com/users/emkornfield/followers","following_url":"https://api.github.com/users/emkornfield/following{/other_user}","gists_url":"https://api.github.com/users/emkornfield/gists{/gist_id}","starred_url":"https://api.github.com/users/emkornfield/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/emkornfield/subscriptions","organizations_url":"https://api.github.com/users/emkornfield/orgs","repos_url":"https://api.github.com/users/emkornfield/repos","events_url":"https://api.github.com/users/emkornfield/events{/privacy}","received_events_url":"https://api.github.com/users/emkornfield/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-20T01:32:01Z","updated_at":"2022-01-20T01:34:25Z","author_association":"CONTRIBUTOR","body":"I think the question around [black](https://github.com/psf/black) still might be worth considering to avoid nit-picking on formatting.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017028938/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017030808","html_url":"https://github.com/apache/iceberg/issues/3934#issuecomment-1017030808","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3934","id":1017030808,"node_id":"IC_kwDOCW7NX848nqiY","user":{"login":"emkornfield","id":17869838,"node_id":"MDQ6VXNlcjE3ODY5ODM4","avatar_url":"https://avatars.githubusercontent.com/u/17869838?v=4","gravatar_id":"","url":"https://api.github.com/users/emkornfield","html_url":"https://github.com/emkornfield","followers_url":"https://api.github.com/users/emkornfield/followers","following_url":"https://api.github.com/users/emkornfield/following{/other_user}","gists_url":"https://api.github.com/users/emkornfield/gists{/gist_id}","starred_url":"https://api.github.com/users/emkornfield/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/emkornfield/subscriptions","organizations_url":"https://api.github.com/users/emkornfield/orgs","repos_url":"https://api.github.com/users/emkornfield/repos","events_url":"https://api.github.com/users/emkornfield/events{/privacy}","received_events_url":"https://api.github.com/users/emkornfield/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-20T01:36:14Z","updated_at":"2022-01-20T01:36:14Z","author_association":"CONTRIBUTOR","body":"Found black also after looking further.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017030808/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017031981","html_url":"https://github.com/apache/iceberg/pull/3926#issuecomment-1017031981","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3926","id":1017031981,"node_id":"IC_kwDOCW7NX848nq0t","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-20T01:38:57Z","updated_at":"2022-01-20T01:38:57Z","author_association":"MEMBER","body":"Thanks @kbendick for addressing the failure tests,    Let's re-run the unit tests.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017031981/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017032910","html_url":"https://github.com/apache/iceberg/issues/3921#issuecomment-1017032910","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3921","id":1017032910,"node_id":"IC_kwDOCW7NX848nrDO","user":{"login":"wangxujin1221","id":38022823,"node_id":"MDQ6VXNlcjM4MDIyODIz","avatar_url":"https://avatars.githubusercontent.com/u/38022823?v=4","gravatar_id":"","url":"https://api.github.com/users/wangxujin1221","html_url":"https://github.com/wangxujin1221","followers_url":"https://api.github.com/users/wangxujin1221/followers","following_url":"https://api.github.com/users/wangxujin1221/following{/other_user}","gists_url":"https://api.github.com/users/wangxujin1221/gists{/gist_id}","starred_url":"https://api.github.com/users/wangxujin1221/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangxujin1221/subscriptions","organizations_url":"https://api.github.com/users/wangxujin1221/orgs","repos_url":"https://api.github.com/users/wangxujin1221/repos","events_url":"https://api.github.com/users/wangxujin1221/events{/privacy}","received_events_url":"https://api.github.com/users/wangxujin1221/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-20T01:41:07Z","updated_at":"2022-01-20T01:52:43Z","author_association":"NONE","body":"> \r\n\r\nHi @RussellSpitzer ， thanks for your reply. The purpose of herre is  accumulating all the records into a LinkedBlockQueue. Actually when i use year or month as the partion rules, it worked and without error above. And i also tried with code like:\r\n```\r\ndataset.foreachPartition(par ->{\r\n                    par.forEachRemaining(row ->{\r\n                        try{\r\n                            OUTPUT_LIST.put(row);\r\n                        }catch(InterruptedException e){\r\n                            logger.error(\"iceberg records caching failed in LinkedBlockingQueue.\",e);\r\n                        }\r\n                    });\r\n                });\r\n```            \r\nBut i still got this error. I don't know whether this error relatted to the total number of files of the hive table. Tables partioned by year or bucket only have 0.5k where table partioned by day has 73k.  Or do you think is it possible that the  error  is relatted to the configurantion of my server, e.g. ulimit things or something like that.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017032910/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017036519","html_url":"https://github.com/apache/iceberg/pull/3908#issuecomment-1017036519","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3908","id":1017036519,"node_id":"IC_kwDOCW7NX848nr7n","user":{"login":"vanliu-tx","id":64360028,"node_id":"MDQ6VXNlcjY0MzYwMDI4","avatar_url":"https://avatars.githubusercontent.com/u/64360028?v=4","gravatar_id":"","url":"https://api.github.com/users/vanliu-tx","html_url":"https://github.com/vanliu-tx","followers_url":"https://api.github.com/users/vanliu-tx/followers","following_url":"https://api.github.com/users/vanliu-tx/following{/other_user}","gists_url":"https://api.github.com/users/vanliu-tx/gists{/gist_id}","starred_url":"https://api.github.com/users/vanliu-tx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vanliu-tx/subscriptions","organizations_url":"https://api.github.com/users/vanliu-tx/orgs","repos_url":"https://api.github.com/users/vanliu-tx/repos","events_url":"https://api.github.com/users/vanliu-tx/events{/privacy}","received_events_url":"https://api.github.com/users/vanliu-tx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-20T01:48:42Z","updated_at":"2022-01-20T01:48:42Z","author_association":"CONTRIBUTOR","body":"> Thanks, @vanliu-tx. Looking close to ready. I think you just need to rename the property.\r\n\r\nI was on vacation yesterday, sorry for the delay.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017036519/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017038993","html_url":"https://github.com/apache/iceberg/pull/3926#issuecomment-1017038993","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3926","id":1017038993,"node_id":"IC_kwDOCW7NX848nsiR","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-20T01:51:57Z","updated_at":"2022-01-20T01:51:57Z","author_association":"MEMBER","body":"All checks looks good now,  Let me get this merged !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017038993/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017049903","html_url":"https://github.com/apache/iceberg/pull/3724#issuecomment-1017049903","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3724","id":1017049903,"node_id":"IC_kwDOCW7NX848nvMv","user":{"login":"xloya","id":26177232,"node_id":"MDQ6VXNlcjI2MTc3MjMy","avatar_url":"https://avatars.githubusercontent.com/u/26177232?v=4","gravatar_id":"","url":"https://api.github.com/users/xloya","html_url":"https://github.com/xloya","followers_url":"https://api.github.com/users/xloya/followers","following_url":"https://api.github.com/users/xloya/following{/other_user}","gists_url":"https://api.github.com/users/xloya/gists{/gist_id}","starred_url":"https://api.github.com/users/xloya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xloya/subscriptions","organizations_url":"https://api.github.com/users/xloya/orgs","repos_url":"https://api.github.com/users/xloya/repos","events_url":"https://api.github.com/users/xloya/events{/privacy}","received_events_url":"https://api.github.com/users/xloya/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-20T02:11:26Z","updated_at":"2022-01-20T02:15:34Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer Sure! I will do it later today","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017049903/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017059294","html_url":"https://github.com/apache/iceberg/pull/3893#issuecomment-1017059294","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3893","id":1017059294,"node_id":"IC_kwDOCW7NX848nxfe","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-20T02:30:41Z","updated_at":"2022-01-20T02:30:41Z","author_association":"MEMBER","body":"Thanks @hililiwei for the port,  looks good to me.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017059294/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017062338","html_url":"https://github.com/apache/iceberg/pull/3893#issuecomment-1017062338","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3893","id":1017062338,"node_id":"IC_kwDOCW7NX848nyPC","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-20T02:37:39Z","updated_at":"2022-01-20T02:37:39Z","author_association":"MEMBER","body":"One minor thing,  when we port the patch,  we usually log the message as: \r\n\r\n```\r\n<Engine> <Version>: <Message>\r\n```\r\n\r\nSo in theory, in this PR. we recommend to title it as : \r\n\r\n```\r\nFlink 1.14: Add tests to check whether should remove meta columns in source reader\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017062338/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017062429","html_url":"https://github.com/apache/iceberg/issues/3909#issuecomment-1017062429","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3909","id":1017062429,"node_id":"IC_kwDOCW7NX848nyQd","user":{"login":"moon-fall","id":7753372,"node_id":"MDQ6VXNlcjc3NTMzNzI=","avatar_url":"https://avatars.githubusercontent.com/u/7753372?v=4","gravatar_id":"","url":"https://api.github.com/users/moon-fall","html_url":"https://github.com/moon-fall","followers_url":"https://api.github.com/users/moon-fall/followers","following_url":"https://api.github.com/users/moon-fall/following{/other_user}","gists_url":"https://api.github.com/users/moon-fall/gists{/gist_id}","starred_url":"https://api.github.com/users/moon-fall/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/moon-fall/subscriptions","organizations_url":"https://api.github.com/users/moon-fall/orgs","repos_url":"https://api.github.com/users/moon-fall/repos","events_url":"https://api.github.com/users/moon-fall/events{/privacy}","received_events_url":"https://api.github.com/users/moon-fall/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-20T02:37:51Z","updated_at":"2022-01-20T02:52:25Z","author_association":"CONTRIBUTOR","body":"A large amount of memory is used because each datafile will read all the data of the deletefile which seqNum is bigger than datafile in a hashSet for filtering, But only those keys that are also in the datafile are necessary to read , In the optimized version of my company , I use a bloom filter of datafile's keys  to filter out unnecessary eq-deletefile keys (hashset  of datafile's keys also works, but using hashset usually consumes more memory) , if the datafile support storage Bloom filter Such as  using parquet format based on #2642 ，It's easier to read bloom filters directly from a datafile.\r\n maybe I can pull a request if need.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017062429/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017063411","html_url":"https://github.com/apache/iceberg/pull/3893#issuecomment-1017063411","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3893","id":1017063411,"node_id":"IC_kwDOCW7NX848nyfz","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-20T02:40:03Z","updated_at":"2022-01-20T02:40:03Z","author_association":"CONTRIBUTOR","body":"> One minor thing, when we port the patch, we usually log the message as:\r\n> \r\n> ```\r\n> <Engine> <Version>: <Message>\r\n> ```\r\n> \r\n> So in theory, in this PR. we recommend to title it as :\r\n> \r\n> ```\r\n> Flink 1.14: Add tests to check whether should remove meta columns in source reader\r\n> ```\r\nGot it. Thank you.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017063411/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017141063","html_url":"https://github.com/apache/iceberg/pull/3935#issuecomment-1017141063","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3935","id":1017141063,"node_id":"IC_kwDOCW7NX848oFdH","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-20T05:47:36Z","updated_at":"2022-01-20T05:47:36Z","author_association":"MEMBER","body":"Thanks @xloya!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017141063/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017167331","html_url":"https://github.com/apache/iceberg/issues/3900#issuecomment-1017167331","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3900","id":1017167331,"node_id":"IC_kwDOCW7NX848oL3j","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-20T06:44:49Z","updated_at":"2022-01-20T06:51:21Z","author_association":"CONTRIBUTOR","body":"After https://github.com/apache/iceberg/pull/3883 gets closed, I'll raise a PR for this that I have ready. I am planning on deprecating the existing TableMetadata#removeSnapshotsIf and adding the a new removeSnapshots method which simply accepts a set of snapshot ids to remove. It will do validation that the set of snapshot ids passed in does not contain the latest snapshot id. Something like the following.\r\n\r\n```\r\npublic TableMetadata removeSnapshots(Set<Long> snapshotIdsToRemove) {\r\n    Preconditions.checkArgument(snapshotIdsToRemove != null,\r\n        \"Snapshot ids to remove cannot be null\");\r\n    ValidationException.check(!snapshotIdsToRemove.contains(currentSnapshotId),\r\n        String.format(\"Cannot remove the latest snapshot id: %d\", currentSnapshotId));\r\n    return new Builder(this)\r\n        .removeSnapshots(snapshotIdsToRemove)\r\n        .build();\r\n  }\r\n\r\n```\r\n\r\nThen in a later PR to address updating the expiration logic to account for references, we would start calling removeSnapshots along with replaceRefs. @jackye1995 thoughts on this? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017167331/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017177997","html_url":"https://github.com/apache/iceberg/pull/3935#issuecomment-1017177997","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3935","id":1017177997,"node_id":"IC_kwDOCW7NX848oOeN","user":{"login":"xloya","id":26177232,"node_id":"MDQ6VXNlcjI2MTc3MjMy","avatar_url":"https://avatars.githubusercontent.com/u/26177232?v=4","gravatar_id":"","url":"https://api.github.com/users/xloya","html_url":"https://github.com/xloya","followers_url":"https://api.github.com/users/xloya/followers","following_url":"https://api.github.com/users/xloya/following{/other_user}","gists_url":"https://api.github.com/users/xloya/gists{/gist_id}","starred_url":"https://api.github.com/users/xloya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xloya/subscriptions","organizations_url":"https://api.github.com/users/xloya/orgs","repos_url":"https://api.github.com/users/xloya/repos","events_url":"https://api.github.com/users/xloya/events{/privacy}","received_events_url":"https://api.github.com/users/xloya/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-20T07:06:19Z","updated_at":"2022-01-20T07:06:19Z","author_association":"CONTRIBUTOR","body":"> Thanks @xloya!\r\n\r\nHave a nice bed time!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017177997/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017216735","html_url":"https://github.com/apache/iceberg/pull/3095#issuecomment-1017216735","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3095","id":1017216735,"node_id":"IC_kwDOCW7NX848oX7f","user":{"login":"hameizi","id":18445460,"node_id":"MDQ6VXNlcjE4NDQ1NDYw","avatar_url":"https://avatars.githubusercontent.com/u/18445460?v=4","gravatar_id":"","url":"https://api.github.com/users/hameizi","html_url":"https://github.com/hameizi","followers_url":"https://api.github.com/users/hameizi/followers","following_url":"https://api.github.com/users/hameizi/following{/other_user}","gists_url":"https://api.github.com/users/hameizi/gists{/gist_id}","starred_url":"https://api.github.com/users/hameizi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hameizi/subscriptions","organizations_url":"https://api.github.com/users/hameizi/orgs","repos_url":"https://api.github.com/users/hameizi/repos","events_url":"https://api.github.com/users/hameizi/events{/privacy}","received_events_url":"https://api.github.com/users/hameizi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-20T08:11:25Z","updated_at":"2022-01-20T08:11:25Z","author_association":"CONTRIBUTOR","body":"> 1. flink writing cdc data to iceberg will ignore UPDATE_BEFORE and treat UPDATE_AFTER as retract message,  it's completely not correct. The relevant codes are as follows:\r\n\r\nFor this issue, config `write.upsert.enabled` is not suitable for CDC. So if your scene is CDC you can config it false that result `upsert` false.\r\n\r\n\r\n> 2\\. when there is only delete operation during the period of one snapshot，the snapshot of iceberg will contains only equality delete files  and no data file(data file is deleted),  flink will ignore equality delete files and miss all  -D .   function org.apache.iceberg.ManifestGroup.planStreamingFiles()   create FileScanTask  only when data file exists, so flink can not process equality delete files.\r\n\r\nI will do more test for this issue.\r\nThanks for your feedback.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017216735/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017325484","html_url":"https://github.com/apache/iceberg/pull/3911#issuecomment-1017325484","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3911","id":1017325484,"node_id":"IC_kwDOCW7NX848oyes","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-20T10:23:02Z","updated_at":"2022-01-20T10:23:02Z","author_association":"CONTRIBUTOR","body":"Thanks @marton-bod for the PR!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017325484/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017482383","html_url":"https://github.com/apache/iceberg/pull/3938#issuecomment-1017482383","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3938","id":1017482383,"node_id":"IC_kwDOCW7NX848pYyP","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-20T12:59:38Z","updated_at":"2022-01-20T13:00:15Z","author_association":"CONTRIBUTOR","body":"cc @rdblue re checking for null bytes when instantiating `Namespace`s.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017482383/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017684205","html_url":"https://github.com/apache/iceberg/pull/3940#issuecomment-1017684205","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3940","id":1017684205,"node_id":"IC_kwDOCW7NX848qKDt","user":{"login":"cccs-eric","id":56447460,"node_id":"MDQ6VXNlcjU2NDQ3NDYw","avatar_url":"https://avatars.githubusercontent.com/u/56447460?v=4","gravatar_id":"","url":"https://api.github.com/users/cccs-eric","html_url":"https://github.com/cccs-eric","followers_url":"https://api.github.com/users/cccs-eric/followers","following_url":"https://api.github.com/users/cccs-eric/following{/other_user}","gists_url":"https://api.github.com/users/cccs-eric/gists{/gist_id}","starred_url":"https://api.github.com/users/cccs-eric/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cccs-eric/subscriptions","organizations_url":"https://api.github.com/users/cccs-eric/orgs","repos_url":"https://api.github.com/users/cccs-eric/repos","events_url":"https://api.github.com/users/cccs-eric/events{/privacy}","received_events_url":"https://api.github.com/users/cccs-eric/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-20T16:26:50Z","updated_at":"2022-01-20T16:26:50Z","author_association":"CONTRIBUTOR","body":"@samredai Do you mind taking a look at this?  Details are in the associated issue.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017684205/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017733969","html_url":"https://github.com/apache/iceberg/pull/2115#issuecomment-1017733969","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2115","id":1017733969,"node_id":"IC_kwDOCW7NX848qWNR","user":{"login":"emkornfield","id":17869838,"node_id":"MDQ6VXNlcjE3ODY5ODM4","avatar_url":"https://avatars.githubusercontent.com/u/17869838?v=4","gravatar_id":"","url":"https://api.github.com/users/emkornfield","html_url":"https://github.com/emkornfield","followers_url":"https://api.github.com/users/emkornfield/followers","following_url":"https://api.github.com/users/emkornfield/following{/other_user}","gists_url":"https://api.github.com/users/emkornfield/gists{/gist_id}","starred_url":"https://api.github.com/users/emkornfield/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/emkornfield/subscriptions","organizations_url":"https://api.github.com/users/emkornfield/orgs","repos_url":"https://api.github.com/users/emkornfield/repos","events_url":"https://api.github.com/users/emkornfield/events{/privacy}","received_events_url":"https://api.github.com/users/emkornfield/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-20T17:16:42Z","updated_at":"2022-01-20T17:16:42Z","author_association":"CONTRIBUTOR","body":"Thanks @TGooch44 does this apply to any of the other open PRs?  Or is there an easy way for me to distinguish myself (this PR appeared on the surface to be being made again python and not python legacy.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017733969/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017746859","html_url":"https://github.com/apache/iceberg/issues/3900#issuecomment-1017746859","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3900","id":1017746859,"node_id":"IC_kwDOCW7NX848qZWr","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-20T17:29:27Z","updated_at":"2022-01-20T17:29:27Z","author_association":"CONTRIBUTOR","body":"As a follow up, I think in the scope of the API we should also make sure we are cleaning up any references as well, as to prevent a \"corrupt\" state of TableMetadata. So if snapshot 2 is to be removed and there are references to snapshot 2, within this API we should also remove those references. This way we don't have any dangling references. We could also filter and not remove any snapshots which have references in this method, and then force callers to remove references first and then the snapshot ids. This seems like too much work for callers, and to me is not as intuitive. Let me know your thoughts.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017746859/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017922194","html_url":"https://github.com/apache/iceberg/pull/2115#issuecomment-1017922194","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2115","id":1017922194,"node_id":"IC_kwDOCW7NX848rEKS","user":{"login":"TGooch44","id":1591711,"node_id":"MDQ6VXNlcjE1OTE3MTE=","avatar_url":"https://avatars.githubusercontent.com/u/1591711?v=4","gravatar_id":"","url":"https://api.github.com/users/TGooch44","html_url":"https://github.com/TGooch44","followers_url":"https://api.github.com/users/TGooch44/followers","following_url":"https://api.github.com/users/TGooch44/following{/other_user}","gists_url":"https://api.github.com/users/TGooch44/gists{/gist_id}","starred_url":"https://api.github.com/users/TGooch44/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TGooch44/subscriptions","organizations_url":"https://api.github.com/users/TGooch44/orgs","repos_url":"https://api.github.com/users/TGooch44/repos","events_url":"https://api.github.com/users/TGooch44/events{/privacy}","received_events_url":"https://api.github.com/users/TGooch44/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-20T20:59:10Z","updated_at":"2022-01-20T20:59:10Z","author_association":"CONTRIBUTOR","body":"Let me go through and clear out any that are for the legacy code-base\n\nOn Thu, Jan 20, 2022 at 9:16 AM emkornfield ***@***.***>\nwrote:\n\n> Thanks @TGooch44 <https://github.com/TGooch44> does this apply to any of\n> the other open PRs? Or is there an easy way for me to distinguish myself\n> (this PR appeared on the surface to be being made again python and not\n> python legacy.\n>\n> —\n> Reply to this email directly, view it on GitHub\n> <https://github.com/apache/iceberg/pull/2115#issuecomment-1017733969>, or\n> unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/AAMETH3EHD6ISNFANTK6KK3UXA7QJANCNFSM4WJGQAIQ>\n> .\n> You are receiving this because you were mentioned.Message ID:\n> ***@***.***>\n>\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017922194/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017927265","html_url":"https://github.com/apache/iceberg/pull/3691#issuecomment-1017927265","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3691","id":1017927265,"node_id":"IC_kwDOCW7NX848rFZh","user":{"login":"samredai","id":43911210,"node_id":"MDQ6VXNlcjQzOTExMjEw","avatar_url":"https://avatars.githubusercontent.com/u/43911210?v=4","gravatar_id":"","url":"https://api.github.com/users/samredai","html_url":"https://github.com/samredai","followers_url":"https://api.github.com/users/samredai/followers","following_url":"https://api.github.com/users/samredai/following{/other_user}","gists_url":"https://api.github.com/users/samredai/gists{/gist_id}","starred_url":"https://api.github.com/users/samredai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samredai/subscriptions","organizations_url":"https://api.github.com/users/samredai/orgs","repos_url":"https://api.github.com/users/samredai/repos","events_url":"https://api.github.com/users/samredai/events{/privacy}","received_events_url":"https://api.github.com/users/samredai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-20T21:05:43Z","updated_at":"2022-01-20T21:05:43Z","author_association":"CONTRIBUTOR","body":"> I think as a generic answer looking at what [fsspec](https://filesystem-spec.readthedocs.io/en/latest/developer.html#implementing-a-backend) has done (and having these as separate packages) that the use can install in there environment probably makes sense.\r\n\r\nThanks for pointing out the entry_point mechanism that fsspec uses. I have to take a closer look at it but I really like the idea of the user simply plugging in a custom implementation while we maintain \"known implementations\" in the main library.\r\n\r\n> Specifically for S3, if pyarrow is a hard dependency for parquet reading providing reference implementations based off of its file systems (it comes prepackaged with S3) could make sense.\r\n\r\nI'm wondering if the FileIO implementations need to be storage-specific. For example, pyarrow, boto, and smartopen all could be used as an implementation for various cloud storage solutions. Instead of having something like `PyarrowS3FileIO` to differentiate between maybe like a `BotoS3FileIO`, we could instead do a `PyarrowFileIO` which can be an entry point to any of the storage io options provided by pyarrow. I don't think this has any implications for this PR in particular so I'll work on updating this asap with the suggestions and we can tackle these other questions in follow-up discussions.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017927265/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017928254","html_url":"https://github.com/apache/iceberg/pull/2115#issuecomment-1017928254","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2115","id":1017928254,"node_id":"IC_kwDOCW7NX848rFo-","user":{"login":"TGooch44","id":1591711,"node_id":"MDQ6VXNlcjE1OTE3MTE=","avatar_url":"https://avatars.githubusercontent.com/u/1591711?v=4","gravatar_id":"","url":"https://api.github.com/users/TGooch44","html_url":"https://github.com/TGooch44","followers_url":"https://api.github.com/users/TGooch44/followers","following_url":"https://api.github.com/users/TGooch44/following{/other_user}","gists_url":"https://api.github.com/users/TGooch44/gists{/gist_id}","starred_url":"https://api.github.com/users/TGooch44/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TGooch44/subscriptions","organizations_url":"https://api.github.com/users/TGooch44/orgs","repos_url":"https://api.github.com/users/TGooch44/repos","events_url":"https://api.github.com/users/TGooch44/events{/privacy}","received_events_url":"https://api.github.com/users/TGooch44/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-20T21:07:06Z","updated_at":"2022-01-20T21:07:06Z","author_association":"CONTRIBUTOR","body":"@emkornfield I closed out mine as I think they are likely not relevant in the new design.  I labeled the other few that I'm sure are not bug fixes and are for python legacy implementation.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017928254/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017936053","html_url":"https://github.com/apache/iceberg/pull/3691#issuecomment-1017936053","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3691","id":1017936053,"node_id":"IC_kwDOCW7NX848rHi1","user":{"login":"emkornfield","id":17869838,"node_id":"MDQ6VXNlcjE3ODY5ODM4","avatar_url":"https://avatars.githubusercontent.com/u/17869838?v=4","gravatar_id":"","url":"https://api.github.com/users/emkornfield","html_url":"https://github.com/emkornfield","followers_url":"https://api.github.com/users/emkornfield/followers","following_url":"https://api.github.com/users/emkornfield/following{/other_user}","gists_url":"https://api.github.com/users/emkornfield/gists{/gist_id}","starred_url":"https://api.github.com/users/emkornfield/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/emkornfield/subscriptions","organizations_url":"https://api.github.com/users/emkornfield/orgs","repos_url":"https://api.github.com/users/emkornfield/repos","events_url":"https://api.github.com/users/emkornfield/events{/privacy}","received_events_url":"https://api.github.com/users/emkornfield/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-20T21:18:03Z","updated_at":"2022-01-20T21:18:03Z","author_association":"CONTRIBUTOR","body":"> I'm wondering if the FileIO implementations need to be storage-specific. For example, pyarrow, boto, and smartopen all could be used as an implementation for various cloud storage solutions. Instead of having something like PyarrowS3FileIO to differentiate between maybe like a BotoS3FileIO, we could instead do a PyarrowFileIO which can be an entry point to any of the storage io options provided by pyarrow. I don't think this has any implications for this PR in particular so I'll work on updating this asap with the suggestions and we can tackle these other questions in follow-up discussions.\r\n\r\nAgreed,  I was pointing out that for common connection types additonal dependencies can be avoided for a large number of systems if pyarrow is assumed as dependency.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017936053/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017943855","html_url":"https://github.com/apache/iceberg/pull/3691#issuecomment-1017943855","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3691","id":1017943855,"node_id":"IC_kwDOCW7NX848rJcv","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-20T21:28:56Z","updated_at":"2022-01-20T21:28:56Z","author_association":"CONTRIBUTOR","body":"I think we will definitely have a mode where pyarrow is used. Certainly if you're reading or writing data, you'd probably want pyarrow. But it isn't unreasonable to have a service that only does metadata interaction and that doesn't need all of pyarrow. It could be done entirely with Python libraries like fastavro, smartopen, and the Iceberg core library.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017943855/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017950666","html_url":"https://github.com/apache/iceberg/pull/3933#issuecomment-1017950666","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3933","id":1017950666,"node_id":"IC_kwDOCW7NX848rLHK","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-20T21:38:35Z","updated_at":"2022-01-20T23:48:05Z","author_association":"CONTRIBUTOR","body":"+1 for the solution. It should be pretty useful in the following scenario. The table only have a timestamp column, but want to partitioned by year/date.\r\n```\r\nCREATE TABLE %s (id Integer, name String, dept String, ts Timestamp) USING iceberg PARTITIONED BY (years(ts))\r\nCREATE TABLE %s (id Integer, name String, dept String, ts Timestamp) USING iceberg PARTITIONED BY (date(ts))\r\n```\r\n\r\nThe Iceberg doc gives an example about it, https://iceberg.apache.org/#spark-ddl/#partitioned-by.\r\n```\r\nCREATE TABLE prod.db.sample (\r\n    id bigint,\r\n    data string,\r\n    category string,\r\n    ts timestamp)\r\nUSING iceberg\r\nPARTITIONED BY (bucket(16, id), days(ts), category)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017950666/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017955390","html_url":"https://github.com/apache/iceberg/pull/3691#issuecomment-1017955390","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3691","id":1017955390,"node_id":"IC_kwDOCW7NX848rMQ-","user":{"login":"emkornfield","id":17869838,"node_id":"MDQ6VXNlcjE3ODY5ODM4","avatar_url":"https://avatars.githubusercontent.com/u/17869838?v=4","gravatar_id":"","url":"https://api.github.com/users/emkornfield","html_url":"https://github.com/emkornfield","followers_url":"https://api.github.com/users/emkornfield/followers","following_url":"https://api.github.com/users/emkornfield/following{/other_user}","gists_url":"https://api.github.com/users/emkornfield/gists{/gist_id}","starred_url":"https://api.github.com/users/emkornfield/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/emkornfield/subscriptions","organizations_url":"https://api.github.com/users/emkornfield/orgs","repos_url":"https://api.github.com/users/emkornfield/repos","events_url":"https://api.github.com/users/emkornfield/events{/privacy}","received_events_url":"https://api.github.com/users/emkornfield/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-20T21:46:06Z","updated_at":"2022-01-20T21:46:06Z","author_association":"CONTRIBUTOR","body":"> I think we will definitely have a mode where pyarrow is used. Certainly if you're reading or writing data, you'd probably want pyarrow.\r\n\r\nYeah, wasn't sure if pyarrow was going to be considered optional or not.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1017955390/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1018122554","html_url":"https://github.com/apache/iceberg/pull/3942#issuecomment-1018122554","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3942","id":1018122554,"node_id":"IC_kwDOCW7NX848r1E6","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-21T03:02:03Z","updated_at":"2022-01-21T03:02:03Z","author_association":"CONTRIBUTOR","body":"FYI @bijanhoule","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1018122554/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1018192717","html_url":"https://github.com/apache/iceberg/pull/3933#issuecomment-1018192717","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3933","id":1018192717,"node_id":"IC_kwDOCW7NX848sGNN","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-21T05:24:57Z","updated_at":"2022-01-21T05:24:57Z","author_association":"MEMBER","body":"@huaxingao to be clear here, this is a fix mostly for MigrationTableUtils right? I was looking for any other consumers of the function but I only found that and test code.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1018192717/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1018232270","html_url":"https://github.com/apache/iceberg/issues/3909#issuecomment-1018232270","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3909","id":1018232270,"node_id":"IC_kwDOCW7NX848sP3O","user":{"login":"fengsen-neu","id":58256617,"node_id":"MDQ6VXNlcjU4MjU2NjE3","avatar_url":"https://avatars.githubusercontent.com/u/58256617?v=4","gravatar_id":"","url":"https://api.github.com/users/fengsen-neu","html_url":"https://github.com/fengsen-neu","followers_url":"https://api.github.com/users/fengsen-neu/followers","following_url":"https://api.github.com/users/fengsen-neu/following{/other_user}","gists_url":"https://api.github.com/users/fengsen-neu/gists{/gist_id}","starred_url":"https://api.github.com/users/fengsen-neu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fengsen-neu/subscriptions","organizations_url":"https://api.github.com/users/fengsen-neu/orgs","repos_url":"https://api.github.com/users/fengsen-neu/repos","events_url":"https://api.github.com/users/fengsen-neu/events{/privacy}","received_events_url":"https://api.github.com/users/fengsen-neu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-21T06:55:57Z","updated_at":"2022-01-21T06:55:57Z","author_association":"NONE","body":"> A large amount of memory is used because each datafile will read all the data of the deletefile which seqNum is bigger than datafile in a hashSet for filtering, But only those keys that are also in the datafile are necessary to read , In the optimized version of my company , I use a bloom filter of datafile's keys to filter out unnecessary eq-deletefile keys (hashset of datafile's keys also works, but using hashset usually consumes more memory) , if the datafile support storage Bloom filter Such as using parquet format based on #2642 ，It's easier to read bloom filters directly from a datafile. maybe I can pull a request if need.\r\n\r\n![image](https://user-images.githubusercontent.com/58256617/150480410-dffc1c5f-66db-41ab-ac7f-199e8f65542b.png)\r\n![image](https://user-images.githubusercontent.com/58256617/150480438-bb672d08-94de-4f1e-86f0-1ee203dc9306.png)\r\nThe DeleteFilter object that include deletefile is using much more memory when compaction. As you said 'each datafile will read all the data of the deletefile which seqNum is bigger than datafile in a hashSet for filtering', so I think we should control the DeleteFilter size to limit memory use. \r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1018232270/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1018248216","html_url":"https://github.com/apache/iceberg/issues/3900#issuecomment-1018248216","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3900","id":1018248216,"node_id":"IC_kwDOCW7NX848sTwY","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-21T07:22:42Z","updated_at":"2022-01-21T07:22:42Z","author_association":"CONTRIBUTOR","body":"Overall there are 3 use cases:\r\n1. filter snapshots with ref and skip removal of those\r\n2. throw exception if a snapshot to remove has ref\r\n3. directly remove snapshot and its associated refs\r\n\r\nConsider the use case if this method, it is basically used for snapshot expiration and nothing else. The logic is:\r\n\r\n```java\r\n    TableMetadata updateMeta = base.removeSnapshotsIf(snapshot ->\r\n        idsToRemove.contains(snapshot.snapshotId()) ||\r\n        (snapshot.timestampMillis() < expireOlderThan && !idsToRetain.contains(snapshot.snapshotId())));\r\n```\r\n\r\nWhen we add branching and tagging, we will have a much more complex if statement to filter out snapshots, and we should be sure that the snapshots passed into the method are the ones we truly want to remove. The snapshot might have associated refs, but removing the refs along the way seems like the correct choice, so that we don't need to have another operation like `RemoveSnapshotRef` to clean those things up.\r\n\r\nBased on this, I think option 3 makes sense to me at this point of time based on the use case.\r\n\r\nThis is also not a one way door, we can always add a flag to achieve 1 or 2 in the future if that is absolutely needed, but it should be simpler to enforce that requirement before the information is passed into the method.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1018248216/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1018282278","html_url":"https://github.com/apache/iceberg/pull/3912#issuecomment-1018282278","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3912","id":1018282278,"node_id":"IC_kwDOCW7NX848scEm","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-21T08:20:43Z","updated_at":"2022-01-21T08:20:43Z","author_association":"CONTRIBUTOR","body":"@humengyu2012: Why did you closed the PR, and created a new one?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1018282278/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1018309730","html_url":"https://github.com/apache/iceberg/issues/3913#issuecomment-1018309730","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3913","id":1018309730,"node_id":"IC_kwDOCW7NX848sixi","user":{"login":"jqysn","id":87296427,"node_id":"MDQ6VXNlcjg3Mjk2NDI3","avatar_url":"https://avatars.githubusercontent.com/u/87296427?v=4","gravatar_id":"","url":"https://api.github.com/users/jqysn","html_url":"https://github.com/jqysn","followers_url":"https://api.github.com/users/jqysn/followers","following_url":"https://api.github.com/users/jqysn/following{/other_user}","gists_url":"https://api.github.com/users/jqysn/gists{/gist_id}","starred_url":"https://api.github.com/users/jqysn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jqysn/subscriptions","organizations_url":"https://api.github.com/users/jqysn/orgs","repos_url":"https://api.github.com/users/jqysn/repos","events_url":"https://api.github.com/users/jqysn/events{/privacy}","received_events_url":"https://api.github.com/users/jqysn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-21T09:00:53Z","updated_at":"2022-01-21T09:00:53Z","author_association":"NONE","body":"Yes. That's correct. I have created a PR for the doc.\r\nhttps://github.com/apache/iceberg/pull/3944","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1018309730/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1018332459","html_url":"https://github.com/apache/iceberg/pull/3943#issuecomment-1018332459","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3943","id":1018332459,"node_id":"IC_kwDOCW7NX848soUr","user":{"login":"coolderli","id":38486782,"node_id":"MDQ6VXNlcjM4NDg2Nzgy","avatar_url":"https://avatars.githubusercontent.com/u/38486782?v=4","gravatar_id":"","url":"https://api.github.com/users/coolderli","html_url":"https://github.com/coolderli","followers_url":"https://api.github.com/users/coolderli/followers","following_url":"https://api.github.com/users/coolderli/following{/other_user}","gists_url":"https://api.github.com/users/coolderli/gists{/gist_id}","starred_url":"https://api.github.com/users/coolderli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coolderli/subscriptions","organizations_url":"https://api.github.com/users/coolderli/orgs","repos_url":"https://api.github.com/users/coolderli/repos","events_url":"https://api.github.com/users/coolderli/events{/privacy}","received_events_url":"https://api.github.com/users/coolderli/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-21T09:28:28Z","updated_at":"2022-01-21T09:28:28Z","author_association":"CONTRIBUTOR","body":"@rdblue Could you please take a look?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1018332459/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1018386887","html_url":"https://github.com/apache/iceberg/pull/3944#issuecomment-1018386887","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3944","id":1018386887,"node_id":"IC_kwDOCW7NX848s1nH","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-21T10:38:22Z","updated_at":"2022-01-21T10:38:22Z","author_association":"CONTRIBUTOR","body":"Since I am not a native English speaker, I would like @rdblue or @massdosage or someone to review the change.\r\nThe technical details are correct.\r\nThanks,\r\nPeter","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1018386887/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1018404424","html_url":"https://github.com/apache/iceberg/pull/3876#issuecomment-1018404424","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3876","id":1018404424,"node_id":"IC_kwDOCW7NX848s55I","user":{"login":"kingeasternsun","id":5291739,"node_id":"MDQ6VXNlcjUyOTE3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/5291739?v=4","gravatar_id":"","url":"https://api.github.com/users/kingeasternsun","html_url":"https://github.com/kingeasternsun","followers_url":"https://api.github.com/users/kingeasternsun/followers","following_url":"https://api.github.com/users/kingeasternsun/following{/other_user}","gists_url":"https://api.github.com/users/kingeasternsun/gists{/gist_id}","starred_url":"https://api.github.com/users/kingeasternsun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kingeasternsun/subscriptions","organizations_url":"https://api.github.com/users/kingeasternsun/orgs","repos_url":"https://api.github.com/users/kingeasternsun/repos","events_url":"https://api.github.com/users/kingeasternsun/events{/privacy}","received_events_url":"https://api.github.com/users/kingeasternsun/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-21T11:03:11Z","updated_at":"2022-01-21T11:52:28Z","author_association":"CONTRIBUTOR","body":"> Left some thoughts on a refactor we could do here, let me know what you think.\r\n\r\n\r\n  - extract common `task.run` portion of listAvroPartition, listParquetPartition and  listOrcPartition to  listPartition\r\n  - left different portion of listAvroPartition, listParquetPartition and  listOrcPartition  to be new function that getDataFile\r\n  - build an exiting executor service like `expireService`\r\n  - use `datafiles[index]` to receive result , so we could avoid collisions among the different thread\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1018404424/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1018577609","html_url":"https://github.com/apache/iceberg/pull/3912#issuecomment-1018577609","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3912","id":1018577609,"node_id":"IC_kwDOCW7NX848tkLJ","user":{"login":"humengyu2012","id":45056332,"node_id":"MDQ6VXNlcjQ1MDU2MzMy","avatar_url":"https://avatars.githubusercontent.com/u/45056332?v=4","gravatar_id":"","url":"https://api.github.com/users/humengyu2012","html_url":"https://github.com/humengyu2012","followers_url":"https://api.github.com/users/humengyu2012/followers","following_url":"https://api.github.com/users/humengyu2012/following{/other_user}","gists_url":"https://api.github.com/users/humengyu2012/gists{/gist_id}","starred_url":"https://api.github.com/users/humengyu2012/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/humengyu2012/subscriptions","organizations_url":"https://api.github.com/users/humengyu2012/orgs","repos_url":"https://api.github.com/users/humengyu2012/repos","events_url":"https://api.github.com/users/humengyu2012/events{/privacy}","received_events_url":"https://api.github.com/users/humengyu2012/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-21T14:50:05Z","updated_at":"2022-01-21T14:50:05Z","author_association":"NONE","body":"1. I think my previous implementation was so bad and had too many useless commits, so I made some big changes;\r\n2. The hive table property 'iceberg.identifier-fields' is not good, I rename it to 'iceberg.identifier-field-names' and change my description in new PR. \r\nToo many things I changed , so I checkout a new branch. I'm sorry to confuse you, maybe I should continue here.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1018577609/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1018609222","html_url":"https://github.com/apache/iceberg/pull/3912#issuecomment-1018609222","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3912","id":1018609222,"node_id":"IC_kwDOCW7NX848tr5G","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-21T15:25:53Z","updated_at":"2022-01-21T15:25:53Z","author_association":"CONTRIBUTOR","body":"@humengyu2012: Usually we stick to the PR, so the reviewers have easier time to follow what happens.\r\nYou can have multiple changes (reverts etc) in a PR, so feel free to do as many as need.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1018609222/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1018614580","html_url":"https://github.com/apache/iceberg/pull/3910#issuecomment-1018614580","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3910","id":1018614580,"node_id":"IC_kwDOCW7NX848ttM0","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-21T15:31:37Z","updated_at":"2022-01-21T15:31:37Z","author_association":"CONTRIBUTOR","body":"@zhongyujiang can you please run https://github.com/zhongyujiang/iceberg/actions/workflows/jmh-bechmarks.yml in your fork and give it `\"SparkParquetWritersFlatDataBenchmark\",\"SparkParquetWritersNestedDataBenchmark\"` as parameters to make sure the Benchmarks are working?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1018614580/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1018628020","html_url":"https://github.com/apache/iceberg/pull/3910#issuecomment-1018628020","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3910","id":1018628020,"node_id":"IC_kwDOCW7NX848twe0","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-21T15:47:10Z","updated_at":"2022-01-21T15:47:10Z","author_association":"CONTRIBUTOR","body":"I noticed that running benchmarks is currently broken and will be fixed by https://github.com/apache/iceberg/pull/3946","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1018628020/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1018677873","html_url":"https://github.com/apache/iceberg/pull/3912#issuecomment-1018677873","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3912","id":1018677873,"node_id":"IC_kwDOCW7NX848t8px","user":{"login":"humengyu2012","id":45056332,"node_id":"MDQ6VXNlcjQ1MDU2MzMy","avatar_url":"https://avatars.githubusercontent.com/u/45056332?v=4","gravatar_id":"","url":"https://api.github.com/users/humengyu2012","html_url":"https://github.com/humengyu2012","followers_url":"https://api.github.com/users/humengyu2012/followers","following_url":"https://api.github.com/users/humengyu2012/following{/other_user}","gists_url":"https://api.github.com/users/humengyu2012/gists{/gist_id}","starred_url":"https://api.github.com/users/humengyu2012/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/humengyu2012/subscriptions","organizations_url":"https://api.github.com/users/humengyu2012/orgs","repos_url":"https://api.github.com/users/humengyu2012/repos","events_url":"https://api.github.com/users/humengyu2012/events{/privacy}","received_events_url":"https://api.github.com/users/humengyu2012/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-21T16:44:39Z","updated_at":"2022-01-21T16:44:39Z","author_association":"NONE","body":"Thanks, I will reopen this PR and close another one.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1018677873/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1018687595","html_url":"https://github.com/apache/iceberg/pull/3912#issuecomment-1018687595","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3912","id":1018687595,"node_id":"IC_kwDOCW7NX848t_Br","user":{"login":"humengyu2012","id":45056332,"node_id":"MDQ6VXNlcjQ1MDU2MzMy","avatar_url":"https://avatars.githubusercontent.com/u/45056332?v=4","gravatar_id":"","url":"https://api.github.com/users/humengyu2012","html_url":"https://github.com/humengyu2012","followers_url":"https://api.github.com/users/humengyu2012/followers","following_url":"https://api.github.com/users/humengyu2012/following{/other_user}","gists_url":"https://api.github.com/users/humengyu2012/gists{/gist_id}","starred_url":"https://api.github.com/users/humengyu2012/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/humengyu2012/subscriptions","organizations_url":"https://api.github.com/users/humengyu2012/orgs","repos_url":"https://api.github.com/users/humengyu2012/repos","events_url":"https://api.github.com/users/humengyu2012/events{/privacy}","received_events_url":"https://api.github.com/users/humengyu2012/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-21T16:56:58Z","updated_at":"2022-01-21T16:56:58Z","author_association":"NONE","body":"@pvary I revert all of my previous commits, submit some new code. Thanks for your guidance.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1018687595/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1018780873","html_url":"https://github.com/apache/iceberg/pull/3948#issuecomment-1018780873","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3948","id":1018780873,"node_id":"IC_kwDOCW7NX848uVzJ","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-21T19:03:22Z","updated_at":"2022-01-21T19:03:22Z","author_association":"MEMBER","body":"@rdblue Quick backport of the streaming test refactors we did when we worked on the \"As Of Time\" Streaming bugfix patch","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1018780873/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1018818511","html_url":"https://github.com/apache/iceberg/pull/3948#issuecomment-1018818511","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3948","id":1018818511,"node_id":"IC_kwDOCW7NX848ue_P","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-21T20:00:31Z","updated_at":"2022-01-21T20:00:31Z","author_association":"MEMBER","body":"Thanks @rdblue !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1018818511/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1018867083","html_url":"https://github.com/apache/iceberg/issues/3951#issuecomment-1018867083","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3951","id":1018867083,"node_id":"IC_kwDOCW7NX848uq2L","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-21T21:18:15Z","updated_at":"2022-01-21T21:18:15Z","author_association":"MEMBER","body":"We actually have a helper for getting the underlying table see\r\nhttps://github.com/apache/iceberg/blob/master/spark/v3.2/spark/src/main/java/org/apache/iceberg/spark/Spark3Util.java#L644\r\n\r\nBut I believe we would probably recommend using the procedure api\r\nhttps://iceberg.apache.org/spark-procedures/#_top\r\n\r\nFrom spark. \r\n\r\nThat said it would be great if we could have some better samples and such and a more complete docker image\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1018867083/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1018885168","html_url":"https://github.com/apache/iceberg/issues/3951#issuecomment-1018885168","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3951","id":1018885168,"node_id":"IC_kwDOCW7NX848uvQw","user":{"login":"findinpath","id":57260417,"node_id":"MDQ6VXNlcjU3MjYwNDE3","avatar_url":"https://avatars.githubusercontent.com/u/57260417?v=4","gravatar_id":"","url":"https://api.github.com/users/findinpath","html_url":"https://github.com/findinpath","followers_url":"https://api.github.com/users/findinpath/followers","following_url":"https://api.github.com/users/findinpath/following{/other_user}","gists_url":"https://api.github.com/users/findinpath/gists{/gist_id}","starred_url":"https://api.github.com/users/findinpath/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/findinpath/subscriptions","organizations_url":"https://api.github.com/users/findinpath/orgs","repos_url":"https://api.github.com/users/findinpath/repos","events_url":"https://api.github.com/users/findinpath/events{/privacy}","received_events_url":"https://api.github.com/users/findinpath/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-21T21:41:38Z","updated_at":"2022-01-21T21:41:38Z","author_association":"NONE","body":"@RussellSpitzer indeed. I came across by `loadTable` method of `Spark3Util`, but being at the moment of trying stuff out on spark 3.1.2 (AFAIK iceberg 0.12.1 doesn't work fully atm with spark 3.2) I didn't have this method available in the `spark-shell`.\r\n\r\nIn any case, simple examples that just work (this comes obviously with a maintenance cost) would be a definite win to grow the community around Iceberg.\r\n\r\nThank you for the feedback.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1018885168/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1018927205","html_url":"https://github.com/apache/iceberg/pull/3952#issuecomment-1018927205","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3952","id":1018927205,"node_id":"IC_kwDOCW7NX848u5hl","user":{"login":"CircArgs","id":35903677,"node_id":"MDQ6VXNlcjM1OTAzNjc3","avatar_url":"https://avatars.githubusercontent.com/u/35903677?v=4","gravatar_id":"","url":"https://api.github.com/users/CircArgs","html_url":"https://github.com/CircArgs","followers_url":"https://api.github.com/users/CircArgs/followers","following_url":"https://api.github.com/users/CircArgs/following{/other_user}","gists_url":"https://api.github.com/users/CircArgs/gists{/gist_id}","starred_url":"https://api.github.com/users/CircArgs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CircArgs/subscriptions","organizations_url":"https://api.github.com/users/CircArgs/orgs","repos_url":"https://api.github.com/users/CircArgs/repos","events_url":"https://api.github.com/users/CircArgs/events{/privacy}","received_events_url":"https://api.github.com/users/CircArgs/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-21T23:03:37Z","updated_at":"2022-01-21T23:03:37Z","author_association":"CONTRIBUTOR","body":"tagging @rdblue @samredai ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1018927205/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019000279","html_url":"https://github.com/apache/iceberg/pull/3952#issuecomment-1019000279","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3952","id":1019000279,"node_id":"IC_kwDOCW7NX848vLXX","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-22T01:04:37Z","updated_at":"2022-01-22T01:04:37Z","author_association":"CONTRIBUTOR","body":"@CircArgs, I'm trying to understand the goal here. It looks like this makes the type classes both types and literals at the same time. I can now have both `Integer()` and `Integer(5)`. The first is a type. But the second is also a type, but one that is used as a literal? What is the value of mixing the two classes together?\r\n\r\nI probably don't understand the benefit, but I do see some drawbacks. First, I think that currently `Integer() == Integer()` will be `False`. That's confusing to me because I think those should be equivalent. Second, `isinstance(Integer(5), PrimitiveType)` is `True`, so the literal is reporting that it can be used as a type.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019000279/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019000727","html_url":"https://github.com/apache/iceberg/pull/3953#issuecomment-1019000727","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3953","id":1019000727,"node_id":"IC_kwDOCW7NX848vLeX","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-22T01:06:09Z","updated_at":"2022-01-22T01:06:09Z","author_association":"CONTRIBUTOR","body":"Thanks, @aokolnychyi!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019000727/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019001036","html_url":"https://github.com/apache/iceberg/pull/3947#issuecomment-1019001036","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3947","id":1019001036,"node_id":"IC_kwDOCW7NX848vLjM","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-22T01:07:21Z","updated_at":"2022-01-22T01:07:21Z","author_association":"CONTRIBUTOR","body":"I think that this change is fine, but you should be able to use any IDs that you choose so it isn't really a functional change. IDs are reassigned when we create an Iceberg table anyway, so they're for internal consistency. The IDs produced here shouldn't really matter.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019001036/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019041517","html_url":"https://github.com/apache/iceberg/pull/3933#issuecomment-1019041517","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3933","id":1019041517,"node_id":"IC_kwDOCW7NX848vVbt","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-22T04:11:32Z","updated_at":"2022-01-22T04:11:32Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer \r\nSorry for the late reply. Yes, the fix is mostly for MigrationTableUtils. It is for this path `DataFiles.withPartitionPath` -> `DataFiles.fillFromPath` -> `Conversions.fromPartitionString`. \r\n\r\nAfter I took a look at `PartitionSpec`, I feel that timestamp is intentionally blocked in  `Conversions.fromPartitionString`, because in `PartitionSpec Builder`, it has year, month, day, time, but no timestamp. I guess timestamp as a partition column is not supported because it doesn't have any real usages. However, creating table using timestamp as a partition column \r\n`CREATE TABLE test (id Integer, name String, dept String, ts Timestamp) USING iceberg PARTITIONED BY (ts)` \r\ncan create the table successfully, but users don't know that the partition column `ts` is not working, so I feel that we probably should support partitioned by timestamp. If not, we probably should block creating table partitioned by timestamp.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019041517/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019071181","html_url":"https://github.com/apache/iceberg/pull/3947#issuecomment-1019071181","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3947","id":1019071181,"node_id":"IC_kwDOCW7NX848vcrN","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-22T06:04:08Z","updated_at":"2022-01-22T06:04:08Z","author_association":"CONTRIBUTOR","body":"@rdblue: We have a corresponding change in the Hive code where during the migration of an external Hive table to Iceberg table we would like to set the \"schema.name-mapping.default\", so Impala could read the migrated table.\r\n\r\nWe can do in a different way:\r\n- When Iceberg rewrites the schema, it should rewrite the `schema.name-mapping.default` value too - This might be a more general solution than depending on the Hive schema generation creating the same ids as the Iceberg schema generation. On the other hand I am not sure this worth the added complexity.\r\n\r\nWhat are your thoughts Ryan?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019071181/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019073859","html_url":"https://github.com/apache/iceberg/pull/3954#issuecomment-1019073859","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3954","id":1019073859,"node_id":"IC_kwDOCW7NX848vdVD","user":{"login":"CodingCat","id":678008,"node_id":"MDQ6VXNlcjY3ODAwOA==","avatar_url":"https://avatars.githubusercontent.com/u/678008?v=4","gravatar_id":"","url":"https://api.github.com/users/CodingCat","html_url":"https://github.com/CodingCat","followers_url":"https://api.github.com/users/CodingCat/followers","following_url":"https://api.github.com/users/CodingCat/following{/other_user}","gists_url":"https://api.github.com/users/CodingCat/gists{/gist_id}","starred_url":"https://api.github.com/users/CodingCat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CodingCat/subscriptions","organizations_url":"https://api.github.com/users/CodingCat/orgs","repos_url":"https://api.github.com/users/CodingCat/repos","events_url":"https://api.github.com/users/CodingCat/events{/privacy}","received_events_url":"https://api.github.com/users/CodingCat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-22T06:21:59Z","updated_at":"2022-01-22T06:21:59Z","author_association":"CONTRIBUTOR","body":"Hi, @rdblue would you mind taking a look? thank you!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019073859/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019331217","html_url":"https://github.com/apache/iceberg/pull/3952#issuecomment-1019331217","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3952","id":1019331217,"node_id":"IC_kwDOCW7NX848wcKR","user":{"login":"samredai","id":43911210,"node_id":"MDQ6VXNlcjQzOTExMjEw","avatar_url":"https://avatars.githubusercontent.com/u/43911210?v=4","gravatar_id":"","url":"https://api.github.com/users/samredai","html_url":"https://github.com/samredai","followers_url":"https://api.github.com/users/samredai/followers","following_url":"https://api.github.com/users/samredai/following{/other_user}","gists_url":"https://api.github.com/users/samredai/gists{/gist_id}","starred_url":"https://api.github.com/users/samredai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samredai/subscriptions","organizations_url":"https://api.github.com/users/samredai/orgs","repos_url":"https://api.github.com/users/samredai/repos","events_url":"https://api.github.com/users/samredai/events{/privacy}","received_events_url":"https://api.github.com/users/samredai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-22T18:39:17Z","updated_at":"2022-01-22T18:39:17Z","author_association":"CONTRIBUTOR","body":"There was some discussion in previous python syncs about decreasing the size of this part of the codebase by not having a literal class defined separately for each type. I don't think we reached a consensus so maybe we can do that here.\r\n\r\nI believe the only place literals are used is in the expressions logic which handles filtering of the metadata (partitions, manifest files, etc). Types are used in a lot of places since `StructType` is used to define schema in many places (table schema as well as the schema of metadata files).\r\n\r\nI like the intuitiveness of only having to look in one place to understand how a type is defined as well as how an instance of that type (a literal) behaves and usage feels very close to how the python standard library works. If the types and literals actually aren't as tightly coupled as the class names in the legacy and java implementation might indicate, then I can see how keeping them as separate classes could be better and they can be tied together by just an attribute on the literal classes. Curious to hear everyone else's thoughts.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019331217/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019376285","html_url":"https://github.com/apache/iceberg/pull/3875#issuecomment-1019376285","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3875","id":1019376285,"node_id":"IC_kwDOCW7NX848wnKd","user":{"login":"jun-he","id":12246263,"node_id":"MDQ6VXNlcjEyMjQ2MjYz","avatar_url":"https://avatars.githubusercontent.com/u/12246263?v=4","gravatar_id":"","url":"https://api.github.com/users/jun-he","html_url":"https://github.com/jun-he","followers_url":"https://api.github.com/users/jun-he/followers","following_url":"https://api.github.com/users/jun-he/following{/other_user}","gists_url":"https://api.github.com/users/jun-he/gists{/gist_id}","starred_url":"https://api.github.com/users/jun-he/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jun-he/subscriptions","organizations_url":"https://api.github.com/users/jun-he/orgs","repos_url":"https://api.github.com/users/jun-he/repos","events_url":"https://api.github.com/users/jun-he/events{/privacy}","received_events_url":"https://api.github.com/users/jun-he/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-22T23:27:14Z","updated_at":"2022-01-22T23:27:14Z","author_association":"COLLABORATOR","body":"Thanks @puchengy !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019376285/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019385569","html_url":"https://github.com/apache/iceberg/pull/3914#issuecomment-1019385569","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3914","id":1019385569,"node_id":"IC_kwDOCW7NX848wpbh","user":{"login":"anuragmantri","id":13743212,"node_id":"MDQ6VXNlcjEzNzQzMjEy","avatar_url":"https://avatars.githubusercontent.com/u/13743212?v=4","gravatar_id":"","url":"https://api.github.com/users/anuragmantri","html_url":"https://github.com/anuragmantri","followers_url":"https://api.github.com/users/anuragmantri/followers","following_url":"https://api.github.com/users/anuragmantri/following{/other_user}","gists_url":"https://api.github.com/users/anuragmantri/gists{/gist_id}","starred_url":"https://api.github.com/users/anuragmantri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/anuragmantri/subscriptions","organizations_url":"https://api.github.com/users/anuragmantri/orgs","repos_url":"https://api.github.com/users/anuragmantri/repos","events_url":"https://api.github.com/users/anuragmantri/events{/privacy}","received_events_url":"https://api.github.com/users/anuragmantri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-23T00:44:48Z","updated_at":"2022-01-23T00:49:04Z","author_association":"CONTRIBUTOR","body":"I'm not aware of a way to mark a table property as immutable in HMS. This is not a blocking comment. Just curious. Could you elaborate more on how we would use this UUID from HMS directly? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019385569/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019395604","html_url":"https://github.com/apache/iceberg/pull/3908#issuecomment-1019395604","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3908","id":1019395604,"node_id":"IC_kwDOCW7NX848wr4U","user":{"login":"vanliu-tx","id":64360028,"node_id":"MDQ6VXNlcjY0MzYwMDI4","avatar_url":"https://avatars.githubusercontent.com/u/64360028?v=4","gravatar_id":"","url":"https://api.github.com/users/vanliu-tx","html_url":"https://github.com/vanliu-tx","followers_url":"https://api.github.com/users/vanliu-tx/followers","following_url":"https://api.github.com/users/vanliu-tx/following{/other_user}","gists_url":"https://api.github.com/users/vanliu-tx/gists{/gist_id}","starred_url":"https://api.github.com/users/vanliu-tx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vanliu-tx/subscriptions","organizations_url":"https://api.github.com/users/vanliu-tx/orgs","repos_url":"https://api.github.com/users/vanliu-tx/repos","events_url":"https://api.github.com/users/vanliu-tx/events{/privacy}","received_events_url":"https://api.github.com/users/vanliu-tx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-23T02:03:25Z","updated_at":"2022-01-23T02:03:25Z","author_association":"CONTRIBUTOR","body":"@rdblue could you help to merge this PR?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019395604/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019411109","html_url":"https://github.com/apache/iceberg/pull/3914#issuecomment-1019411109","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3914","id":1019411109,"node_id":"IC_kwDOCW7NX848wvql","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-23T04:19:01Z","updated_at":"2022-01-23T04:19:01Z","author_association":"CONTRIBUTOR","body":"> I'm not aware of a way to mark a table property as immutable in HMS. This is not a blocking comment. Just curious. Could you elaborate more on how we would use this UUID from HMS directly? \n\nAn application can identify an Iceberg table by just checking the properties in HMS without reading the metadata.json. It is pretty useful in case that the application doesn't have the permission to access the file system.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019411109/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019417391","html_url":"https://github.com/apache/iceberg/pull/3943#issuecomment-1019417391","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3943","id":1019417391,"node_id":"IC_kwDOCW7NX848wxMv","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-23T05:33:57Z","updated_at":"2022-01-23T05:33:57Z","author_association":"CONTRIBUTOR","body":"Thanks for looking into this @coolderli \r\n\r\nmy opinion would be that if we know something doesn’t currently happen, we should update it when it does become an issue\r\n\r\n It’s easier to track that way as the changes are around the same time (and can more easily reference each other). Also, it’s always possible that changes we make defensively for future possible changes might never pan out and then we wouldn’t need this change.\r\n\r\nso it’s typically best to wait until it’s an actual issue. that said, there are always exceptions I suppose.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019417391/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019535657","html_url":"https://github.com/apache/iceberg/pull/3947#issuecomment-1019535657","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3947","id":1019535657,"node_id":"IC_kwDOCW7NX848xOEp","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-23T17:59:25Z","updated_at":"2022-01-23T17:59:25Z","author_association":"CONTRIBUTOR","body":"@pvary, it sounds like what you're saying is that you're generating a schema, then a name mapping, and then creating a table and want the table schema to match the name mapping. I think it makes the most sense to create the table, then base the name mapping on the schema, and then add it to the table. That way you don't rely on the IDs that you pass into create table -- the IDs passed in are reassigned and we make no guarantees about them.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019535657/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019540788","html_url":"https://github.com/apache/iceberg/pull/3952#issuecomment-1019540788","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3952","id":1019540788,"node_id":"IC_kwDOCW7NX848xPU0","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-23T18:27:28Z","updated_at":"2022-01-23T18:27:28Z","author_association":"CONTRIBUTOR","body":"> usage feels very close to how the python standard library works\r\n\r\nCan you give examples? The only thing I can think of is that `str` can be used as a type or can be used to cast a value. We could do the same by implementing `__call__` on type objects to produce literals. But there is no need to make the type and the literal share a class.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019540788/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019541514","html_url":"https://github.com/apache/iceberg/pull/3954#issuecomment-1019541514","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3954","id":1019541514,"node_id":"IC_kwDOCW7NX848xPgK","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-23T18:32:21Z","updated_at":"2022-01-23T18:32:21Z","author_association":"CONTRIBUTOR","body":"Thanks, @CodingCat! Looks close to being ready to commit.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019541514/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019545305","html_url":"https://github.com/apache/iceberg/pull/3945#issuecomment-1019545305","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3945","id":1019545305,"node_id":"IC_kwDOCW7NX848xQbZ","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-23T18:56:16Z","updated_at":"2022-01-23T18:56:16Z","author_association":"CONTRIBUTOR","body":"Thanks, @coolderli! This looks like a promising idea.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019545305/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019545412","html_url":"https://github.com/apache/iceberg/pull/3919#issuecomment-1019545412","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3919","id":1019545412,"node_id":"IC_kwDOCW7NX848xQdE","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-23T18:56:59Z","updated_at":"2022-01-23T18:56:59Z","author_association":"CONTRIBUTOR","body":"Thanks, @Zhangg7723! Looks good. I'll merge when tests are passing.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019545412/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019549170","html_url":"https://github.com/apache/iceberg/pull/3952#issuecomment-1019549170","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3952","id":1019549170,"node_id":"IC_kwDOCW7NX848xRXy","user":{"login":"samredai","id":43911210,"node_id":"MDQ6VXNlcjQzOTExMjEw","avatar_url":"https://avatars.githubusercontent.com/u/43911210?v=4","gravatar_id":"","url":"https://api.github.com/users/samredai","html_url":"https://github.com/samredai","followers_url":"https://api.github.com/users/samredai/followers","following_url":"https://api.github.com/users/samredai/following{/other_user}","gists_url":"https://api.github.com/users/samredai/gists{/gist_id}","starred_url":"https://api.github.com/users/samredai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samredai/subscriptions","organizations_url":"https://api.github.com/users/samredai/orgs","repos_url":"https://api.github.com/users/samredai/repos","events_url":"https://api.github.com/users/samredai/events{/privacy}","received_events_url":"https://api.github.com/users/samredai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-23T19:15:20Z","updated_at":"2022-01-23T19:15:20Z","author_association":"CONTRIBUTOR","body":"@rdblue I meant that both the following are true in built-in types:\r\n- calling `type` on a literal value returns the class used to instantiate the literal\r\n- checking the type of a literal value is done using `isinstance`, the literal, and that same class returned by `type`\r\n\r\n```py\r\ndef type_and_literal(literal):\r\n    python_type = type(literal)  # calling type(5) returns int\r\n    new_instance = python_type(literal)  # int(5) returns another literal instance\r\n    \r\n    # int is used in both isinstance and == so all of the below is True for all built-ins\r\n    assert isinstance(new_instance, python_type)\r\n    assert type(new_instance) == python_type\r\n    assert isinstance(literal, python_type)\r\n    assert type(literal) == python_type\r\n\r\n# Confirm the assertions for all built-in types\r\nfor literal in \"foo\", 1, 1.1, True, {\"foo\": \"bar\"}, (\"foo\", \"bar\", 0, 1), b'foo':\r\n    type_and_literal(literal)\r\n```\r\n\r\nSo there's no differentiation between a type object and a literal object or at least that's how the api makes it seem.\r\n\r\n> But there is no need to make the type and the literal share a class.\r\n\r\nI see, so there could be an `IntegerType` class that can create an `IntegerLiteral` and `IntegerLiteral` would return it's type as `IntegerType`. Would it be useful to wrap them both in a top-level `Integer` class to match the api in the snippet above? Or is that just getting us back to having the logic mixed?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019549170/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019594662","html_url":"https://github.com/apache/iceberg/issues/3951#issuecomment-1019594662","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3951","id":1019594662,"node_id":"IC_kwDOCW7NX848xcem","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-23T23:48:42Z","updated_at":"2022-01-23T23:48:42Z","author_association":"CONTRIBUTOR","body":"> In any case, simple examples that just work (this comes obviously with a maintenance cost) would be a definite win to grow the community around Iceberg.\n\nCannot agree more. The community is working on the docker image. It will be released pretty soon. Cc @samredai and @kbendick for more details.\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019594662/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019609414","html_url":"https://github.com/apache/iceberg/pull/3691#issuecomment-1019609414","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3691","id":1019609414,"node_id":"IC_kwDOCW7NX848xgFG","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T00:37:22Z","updated_at":"2022-01-24T00:37:22Z","author_association":"CONTRIBUTOR","body":"Looks great. Thanks for updating this, @samredai!\r\n\r\nI'm going to go ahead and merge this. I think there's still an open question about what type to return from the `open` and `create` methods (and how to support `with`) but the overall structure looks great and we can solve that problem later.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019609414/reactions","total_count":2,"+1":1,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019610280","html_url":"https://github.com/apache/iceberg/pull/3923#issuecomment-1019610280","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3923","id":1019610280,"node_id":"IC_kwDOCW7NX848xgSo","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T00:39:48Z","updated_at":"2022-01-24T00:39:48Z","author_association":"CONTRIBUTOR","body":"While I don't think that this is necessary, it does improve the codebase slightly because we won't have to remember to create a no-arg constructor if we ever create a second constructor for this class. I'll merge this. Thanks, @rajarshisarkar!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019610280/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019610699","html_url":"https://github.com/apache/iceberg/pull/3910#issuecomment-1019610699","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3910","id":1019610699,"node_id":"IC_kwDOCW7NX848xgZL","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T00:41:02Z","updated_at":"2022-01-24T00:41:02Z","author_association":"CONTRIBUTOR","body":"Running CI. @nastra, do you think this is ready to commit?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019610699/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019611062","html_url":"https://github.com/apache/iceberg/pull/3884#issuecomment-1019611062","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3884","id":1019611062,"node_id":"IC_kwDOCW7NX848xge2","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T00:41:58Z","updated_at":"2022-01-24T00:41:58Z","author_association":"CONTRIBUTOR","body":"@felixYyu, I'm going to close this since I don't quite understand the purpose. Feel free to reopen it when you have a chance to answer my question about it. Thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019611062/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019611410","html_url":"https://github.com/apache/iceberg/pull/3876#issuecomment-1019611410","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3876","id":1019611410,"node_id":"IC_kwDOCW7NX848xgkS","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T00:42:59Z","updated_at":"2022-01-24T00:42:59Z","author_association":"CONTRIBUTOR","body":"Running CI for when @RussellSpitzer comes back to this review.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019611410/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019614710","html_url":"https://github.com/apache/iceberg/pull/3784#issuecomment-1019614710","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3784","id":1019614710,"node_id":"IC_kwDOCW7NX848xhX2","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T00:50:53Z","updated_at":"2022-01-24T00:50:53Z","author_association":"CONTRIBUTOR","body":"@hililiwei, can you describe how you're estimating the size of data that is buffered in memory for ORC? I think a description to explain to reviewers would help.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019614710/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019646429","html_url":"https://github.com/apache/iceberg/pull/3876#issuecomment-1019646429","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3876","id":1019646429,"node_id":"IC_kwDOCW7NX848xpHd","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T02:09:01Z","updated_at":"2022-01-24T02:09:01Z","author_association":"MEMBER","body":"Looks like some tests are failing, \n\n```\norg.apache.iceberg.spark.extensions.TestAddFilesProcedure > addOrcFileWithDoubleAndFloatColumns[catalogName = testhadoop, implementation = org.apache.iceberg.spark.SparkCatalog, config = {type=hadoop}] FAILED\n426\n    org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 513.0 failed 1 times, most recent failure: Lost task 0.0 in stage 513.0 (TID 931) (localhost executor driver): org.apache.iceberg.exceptions.RuntimeIOException: Failed to open file: file:/tmp/junit5159181195255838438/test.orc\n427\n    \tat org.apache.iceberg.avro.AvroIterable.newFileReader(AvroIterable.java:103)\n428\n    \tat org.apache.iceberg.avro.AvroIterable.iterator(AvroIterable.java:77)\n429\n    \tat org.apache.iceberg.avro.AvroIterable.iterator(AvroIterable.java:37)\n430\n    \tat org.apache.iceberg.util.Filter.lambda$filter$0(Filter.java:35)\n431\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019646429/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019648023","html_url":"https://github.com/apache/iceberg/pull/3876#issuecomment-1019648023","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3876","id":1019648023,"node_id":"IC_kwDOCW7NX848xpgX","user":{"login":"kingeasternsun","id":5291739,"node_id":"MDQ6VXNlcjUyOTE3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/5291739?v=4","gravatar_id":"","url":"https://api.github.com/users/kingeasternsun","html_url":"https://github.com/kingeasternsun","followers_url":"https://api.github.com/users/kingeasternsun/followers","following_url":"https://api.github.com/users/kingeasternsun/following{/other_user}","gists_url":"https://api.github.com/users/kingeasternsun/gists{/gist_id}","starred_url":"https://api.github.com/users/kingeasternsun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kingeasternsun/subscriptions","organizations_url":"https://api.github.com/users/kingeasternsun/orgs","repos_url":"https://api.github.com/users/kingeasternsun/repos","events_url":"https://api.github.com/users/kingeasternsun/events{/privacy}","received_events_url":"https://api.github.com/users/kingeasternsun/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T02:11:40Z","updated_at":"2022-01-24T02:11:40Z","author_association":"CONTRIBUTOR","body":"> Looks like some tests are failing,\r\n> \r\n> ```\r\n> org.apache.iceberg.spark.extensions.TestAddFilesProcedure > addOrcFileWithDoubleAndFloatColumns[catalogName = testhadoop, implementation = org.apache.iceberg.spark.SparkCatalog, config = {type=hadoop}] FAILED\r\n> 426\r\n>     org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 513.0 failed 1 times, most recent failure: Lost task 0.0 in stage 513.0 (TID 931) (localhost executor driver): org.apache.iceberg.exceptions.RuntimeIOException: Failed to open file: file:/tmp/junit5159181195255838438/test.orc\r\n> 427\r\n>     \tat org.apache.iceberg.avro.AvroIterable.newFileReader(AvroIterable.java:103)\r\n> 428\r\n>     \tat org.apache.iceberg.avro.AvroIterable.iterator(AvroIterable.java:77)\r\n> 429\r\n>     \tat org.apache.iceberg.avro.AvroIterable.iterator(AvroIterable.java:37)\r\n> 430\r\n>     \tat org.apache.iceberg.util.Filter.lambda$filter$0(Filter.java:35)\r\n> 431\r\n> ```\r\n\r\nOk, I will check it out ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019648023/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019657682","html_url":"https://github.com/apache/iceberg/pull/3876#issuecomment-1019657682","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3876","id":1019657682,"node_id":"IC_kwDOCW7NX848xr3S","user":{"login":"kingeasternsun","id":5291739,"node_id":"MDQ6VXNlcjUyOTE3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/5291739?v=4","gravatar_id":"","url":"https://api.github.com/users/kingeasternsun","html_url":"https://github.com/kingeasternsun","followers_url":"https://api.github.com/users/kingeasternsun/followers","following_url":"https://api.github.com/users/kingeasternsun/following{/other_user}","gists_url":"https://api.github.com/users/kingeasternsun/gists{/gist_id}","starred_url":"https://api.github.com/users/kingeasternsun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kingeasternsun/subscriptions","organizations_url":"https://api.github.com/users/kingeasternsun/orgs","repos_url":"https://api.github.com/users/kingeasternsun/repos","events_url":"https://api.github.com/users/kingeasternsun/events{/privacy}","received_events_url":"https://api.github.com/users/kingeasternsun/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T02:30:44Z","updated_at":"2022-01-24T02:30:44Z","author_association":"CONTRIBUTOR","body":"Looks weird,  All these failed cases  \r\n```shell\r\n    Caused by: org.apache.avro.InvalidAvroMagicException: Not an Avro data file\r\n    \tat org.apache.avro.file.DataFileReader.openReader(DataFileReader.java:70)\r\n    \tat org.apache.iceberg.avro.AvroIterable.newFileReader(AvroIterable.java:100)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019657682/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019663113","html_url":"https://github.com/apache/iceberg/pull/3834#issuecomment-1019663113","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3834","id":1019663113,"node_id":"IC_kwDOCW7NX848xtMJ","user":{"login":"hameizi","id":18445460,"node_id":"MDQ6VXNlcjE4NDQ1NDYw","avatar_url":"https://avatars.githubusercontent.com/u/18445460?v=4","gravatar_id":"","url":"https://api.github.com/users/hameizi","html_url":"https://github.com/hameizi","followers_url":"https://api.github.com/users/hameizi/followers","following_url":"https://api.github.com/users/hameizi/following{/other_user}","gists_url":"https://api.github.com/users/hameizi/gists{/gist_id}","starred_url":"https://api.github.com/users/hameizi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hameizi/subscriptions","organizations_url":"https://api.github.com/users/hameizi/orgs","repos_url":"https://api.github.com/users/hameizi/repos","events_url":"https://api.github.com/users/hameizi/events{/privacy}","received_events_url":"https://api.github.com/users/hameizi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T02:47:11Z","updated_at":"2022-01-24T02:47:11Z","author_association":"CONTRIBUTOR","body":"@rdblue code style fix in new commit.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019663113/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019675344","html_url":"https://github.com/apache/iceberg/pull/3876#issuecomment-1019675344","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3876","id":1019675344,"node_id":"IC_kwDOCW7NX848xwLQ","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T03:16:27Z","updated_at":"2022-01-24T03:16:27Z","author_association":"MEMBER","body":"> Looks weird, All these failed cases\r\n> \r\n> ```shell\r\n>     Caused by: org.apache.avro.InvalidAvroMagicException: Not an Avro data file\r\n>     \tat org.apache.avro.file.DataFileReader.openReader(DataFileReader.java:70)\r\n>     \tat org.apache.iceberg.avro.AvroIterable.newFileReader(AvroIterable.java:100)\r\n> ```\r\n\r\nYeah something wrong with the format matching? Odd, for example the one I looked at is failing because an ORC file is being read as an AVRO one.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019675344/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019676189","html_url":"https://github.com/apache/iceberg/issues/3941#issuecomment-1019676189","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3941","id":1019676189,"node_id":"IC_kwDOCW7NX848xwYd","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T03:17:57Z","updated_at":"2022-01-24T03:17:57Z","author_association":"CONTRIBUTOR","body":"I'm working on a Iceberg CDC design doc. It will be like the CDF(change data feed) in the proprietary Delta. Will keep you posted. It'd be helpful if you can share your CDC use case.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019676189/reactions","total_count":5,"+1":5,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019680961","html_url":"https://github.com/apache/iceberg/pull/3876#issuecomment-1019680961","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3876","id":1019680961,"node_id":"IC_kwDOCW7NX848xxjB","user":{"login":"kingeasternsun","id":5291739,"node_id":"MDQ6VXNlcjUyOTE3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/5291739?v=4","gravatar_id":"","url":"https://api.github.com/users/kingeasternsun","html_url":"https://github.com/kingeasternsun","followers_url":"https://api.github.com/users/kingeasternsun/followers","following_url":"https://api.github.com/users/kingeasternsun/following{/other_user}","gists_url":"https://api.github.com/users/kingeasternsun/gists{/gist_id}","starred_url":"https://api.github.com/users/kingeasternsun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kingeasternsun/subscriptions","organizations_url":"https://api.github.com/users/kingeasternsun/orgs","repos_url":"https://api.github.com/users/kingeasternsun/repos","events_url":"https://api.github.com/users/kingeasternsun/events{/privacy}","received_events_url":"https://api.github.com/users/kingeasternsun/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T03:25:38Z","updated_at":"2022-01-24T03:25:38Z","author_association":"CONTRIBUTOR","body":"> > Looks weird, All these failed cases\r\n> > ```shell\r\n> >     Caused by: org.apache.avro.InvalidAvroMagicException: Not an Avro data file\r\n> >     \tat org.apache.avro.file.DataFileReader.openReader(DataFileReader.java:70)\r\n> >     \tat org.apache.iceberg.avro.AvroIterable.newFileReader(AvroIterable.java:100)\r\n> > ```\r\n> \r\n> Yeah something wrong with the format matching? Odd, for example the one I looked at is failing because an ORC file is being read as an AVRO one.\r\n\r\n```shell\r\nError: eckstyle] [ERROR] /home/runner/work/iceberg/iceberg/data/src/main/java/org/apache/iceberg/data/TableMigrationUtil.java:91: Trailing whitespace is not allowed. [RegexpSinglelineJava]\r\nError: eckstyle] [ERROR] /home/runner/work/iceberg/iceberg/data/src/main/java/org/apache/iceberg/data/TableMigrationUtil.java:91: Whitespace at end-of-line [RegexpSingleline]\r\nError: eckstyle] [ERROR] /home/runner/work/iceberg/iceberg/data/src/main/java/org/apache/iceberg/data/TableMigrationUtil.java:105: Trailing whitespace is not allowed. [RegexpSinglelineJava]\r\n> Task :iceberg-data:checkstyleMain FAILED\r\nError: eckstyle] [ERROR] /home/runner/work/iceberg/iceberg/data/src/main/java/org/apache/iceberg/data/TableMigrationUtil.java:105: Whitespace at end-of-line [RegexpSingleline]\r\n```\r\n\r\ncan i just remove these two empty line?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019680961/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019681791","html_url":"https://github.com/apache/iceberg/pull/3876#issuecomment-1019681791","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3876","id":1019681791,"node_id":"IC_kwDOCW7NX848xxv_","user":{"login":"kingeasternsun","id":5291739,"node_id":"MDQ6VXNlcjUyOTE3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/5291739?v=4","gravatar_id":"","url":"https://api.github.com/users/kingeasternsun","html_url":"https://github.com/kingeasternsun","followers_url":"https://api.github.com/users/kingeasternsun/followers","following_url":"https://api.github.com/users/kingeasternsun/following{/other_user}","gists_url":"https://api.github.com/users/kingeasternsun/gists{/gist_id}","starred_url":"https://api.github.com/users/kingeasternsun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kingeasternsun/subscriptions","organizations_url":"https://api.github.com/users/kingeasternsun/orgs","repos_url":"https://api.github.com/users/kingeasternsun/repos","events_url":"https://api.github.com/users/kingeasternsun/events{/privacy}","received_events_url":"https://api.github.com/users/kingeasternsun/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T03:27:14Z","updated_at":"2022-01-24T03:29:38Z","author_association":"CONTRIBUTOR","body":"> > Looks weird, All these failed cases\r\n> > ```shell\r\n> >     Caused by: org.apache.avro.InvalidAvroMagicException: Not an Avro data file\r\n> >     \tat org.apache.avro.file.DataFileReader.openReader(DataFileReader.java:70)\r\n> >     \tat org.apache.iceberg.avro.AvroIterable.newFileReader(AvroIterable.java:100)\r\n> > ```\r\n> \r\n> Yeah something wrong with the format matching? Odd, for example the one I looked at is failing because an ORC file is being read as an AVRO one.\r\n\r\nSorry , My mistake.  I passed the wrong paramter.  when match `orc`, I should pass `orc` to `buildDataFile`,  But I passed `avro`.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019681791/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019686425","html_url":"https://github.com/apache/iceberg/pull/3944#issuecomment-1019686425","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3944","id":1019686425,"node_id":"IC_kwDOCW7NX848xy4Z","user":{"login":"0xffmeta","id":98149057,"node_id":"U_kgDOBdmiwQ","avatar_url":"https://avatars.githubusercontent.com/u/98149057?v=4","gravatar_id":"","url":"https://api.github.com/users/0xffmeta","html_url":"https://github.com/0xffmeta","followers_url":"https://api.github.com/users/0xffmeta/followers","following_url":"https://api.github.com/users/0xffmeta/following{/other_user}","gists_url":"https://api.github.com/users/0xffmeta/gists{/gist_id}","starred_url":"https://api.github.com/users/0xffmeta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/0xffmeta/subscriptions","organizations_url":"https://api.github.com/users/0xffmeta/orgs","repos_url":"https://api.github.com/users/0xffmeta/repos","events_url":"https://api.github.com/users/0xffmeta/events{/privacy}","received_events_url":"https://api.github.com/users/0xffmeta/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T03:40:30Z","updated_at":"2022-01-24T03:40:30Z","author_association":"CONTRIBUTOR","body":"Hello @massdosage, thanks for the suggestion, I have changed the wording as suggested. Please take a look.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019686425/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019691039","html_url":"https://github.com/apache/iceberg/pull/3095#issuecomment-1019691039","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3095","id":1019691039,"node_id":"IC_kwDOCW7NX848x0Af","user":{"login":"xianyouQ","id":4082998,"node_id":"MDQ6VXNlcjQwODI5OTg=","avatar_url":"https://avatars.githubusercontent.com/u/4082998?v=4","gravatar_id":"","url":"https://api.github.com/users/xianyouQ","html_url":"https://github.com/xianyouQ","followers_url":"https://api.github.com/users/xianyouQ/followers","following_url":"https://api.github.com/users/xianyouQ/following{/other_user}","gists_url":"https://api.github.com/users/xianyouQ/gists{/gist_id}","starred_url":"https://api.github.com/users/xianyouQ/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xianyouQ/subscriptions","organizations_url":"https://api.github.com/users/xianyouQ/orgs","repos_url":"https://api.github.com/users/xianyouQ/repos","events_url":"https://api.github.com/users/xianyouQ/events{/privacy}","received_events_url":"https://api.github.com/users/xianyouQ/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T03:56:16Z","updated_at":"2022-01-24T03:56:16Z","author_association":"NONE","body":"> For this issue, config `write.upsert.enabled` is not suitable for CDC. So if your scene is CDC you can config it false that result `upsert` false.\r\nThanks , I also merged [change-delete-logic](https://github.com/hameizi/iceberg/tree/change-delete-logic)  , I think it's a better way to write delete rows.  I am confused why delete row writing to postition delete file also write to equality delete file. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019691039/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019692312","html_url":"https://github.com/apache/iceberg/pull/3876#issuecomment-1019692312","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3876","id":1019692312,"node_id":"IC_kwDOCW7NX848x0UY","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T04:00:54Z","updated_at":"2022-01-24T04:00:54Z","author_association":"MEMBER","body":"> > > Looks weird, All these failed cases\n> \n> > > ```shell\n> \n> > >     Caused by: org.apache.avro.InvalidAvroMagicException: Not an Avro data file\n> \n> > >     \tat org.apache.avro.file.DataFileReader.openReader(DataFileReader.java:70)\n> \n> > >     \tat org.apache.iceberg.avro.AvroIterable.newFileReader(AvroIterable.java:100)\n> \n> > > ```\n> \n> > \n> \n> > Yeah something wrong with the format matching? Odd, for example the one I looked at is failing because an ORC file is being read as an AVRO one.\n> \n> \n> \n> ```shell\n> \n> Error: eckstyle] [ERROR] /home/runner/work/iceberg/iceberg/data/src/main/java/org/apache/iceberg/data/TableMigrationUtil.java:91: Trailing whitespace is not allowed. [RegexpSinglelineJava]\n> \n> Error: eckstyle] [ERROR] /home/runner/work/iceberg/iceberg/data/src/main/java/org/apache/iceberg/data/TableMigrationUtil.java:91: Whitespace at end-of-line [RegexpSingleline]\n> \n> Error: eckstyle] [ERROR] /home/runner/work/iceberg/iceberg/data/src/main/java/org/apache/iceberg/data/TableMigrationUtil.java:105: Trailing whitespace is not allowed. [RegexpSinglelineJava]\n> \n> > Task :iceberg-data:checkstyleMain FAILED\n> \n> Error: eckstyle] [ERROR] /home/runner/work/iceberg/iceberg/data/src/main/java/org/apache/iceberg/data/TableMigrationUtil.java:105: Whitespace at end-of-line [RegexpSingleline]\n> \n> ```\n> \n> \n> \n> can i just remove these two empty line?\n\nThe empty line isn't the issue, the error would be white space before an end of line character","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019692312/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]