[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/969558110","html_url":"https://github.com/apache/iceberg/issues/3475#issuecomment-969558110","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3475","id":969558110,"node_id":"IC_kwDOCW7NX845ykhe","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-16T00:57:05Z","updated_at":"2021-11-16T00:57:05Z","author_association":"CONTRIBUTOR","body":"It would be nice to have a ToC similar to the old one, with different section levels shown.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/969558110/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/969680258","html_url":"https://github.com/apache/iceberg/issues/3507#issuecomment-969680258","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3507","id":969680258,"node_id":"IC_kwDOCW7NX845zCWC","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-16T02:08:57Z","updated_at":"2021-11-16T02:08:57Z","author_association":"MEMBER","body":"@ayush-san , I think you use the 0.11.x iceberg release to upgrade the iceberg table from v1 to v2.  The correct way to upgrade the v1 to v2 is using 0.12.x because 0.12.0 is the correct release that we've voted to stablize the v2 format. You can see the mail list: https://lists.apache.org/thread/ws2gg52d124p7bx9jgrn3kctrtfgtltp\r\n\r\nIn fact,  during the 0.11.x to 0.12.x we've introduced another iceberg spec changes such as https://github.com/apache/iceberg/pull/2096/files.  So 0.11.x is not the correct release to upgrade the v1 for v2. \r\n\r\nIf you want to experience the iceberg table to maintain the flink cdc events, you may want to take a look at this post: https://ververica.github.io/flink-cdc-connectors/master/content/quickstart/build-real-time-data-lake-tutorial.html","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/969680258/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/969699867","html_url":"https://github.com/apache/iceberg/pull/3501#issuecomment-969699867","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3501","id":969699867,"node_id":"IC_kwDOCW7NX845zHIb","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-16T02:26:35Z","updated_at":"2021-11-16T02:26:48Z","author_association":"MEMBER","body":"Since we've enabled all the engine version's checkstyle check, let's rerun this travis CI again ! https://github.com/apache/iceberg/pull/3550","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/969699867/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/969754438","html_url":"https://github.com/apache/iceberg/issues/3554#issuecomment-969754438","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3554","id":969754438,"node_id":"IC_kwDOCW7NX845zUdG","user":{"login":"felixYyu","id":3785228,"node_id":"MDQ6VXNlcjM3ODUyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3785228?v=4","gravatar_id":"","url":"https://api.github.com/users/felixYyu","html_url":"https://github.com/felixYyu","followers_url":"https://api.github.com/users/felixYyu/followers","following_url":"https://api.github.com/users/felixYyu/following{/other_user}","gists_url":"https://api.github.com/users/felixYyu/gists{/gist_id}","starred_url":"https://api.github.com/users/felixYyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixYyu/subscriptions","organizations_url":"https://api.github.com/users/felixYyu/orgs","repos_url":"https://api.github.com/users/felixYyu/repos","events_url":"https://api.github.com/users/felixYyu/events{/privacy}","received_events_url":"https://api.github.com/users/felixYyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-16T03:04:00Z","updated_at":"2021-11-16T03:04:00Z","author_association":"CONTRIBUTOR","body":"Will the spark SQL extension be supported in the future？","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/969754438/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/969755616","html_url":"https://github.com/apache/iceberg/issues/3554#issuecomment-969755616","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3554","id":969755616,"node_id":"IC_kwDOCW7NX845zUvg","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-16T03:05:00Z","updated_at":"2021-11-16T03:05:00Z","author_association":"MEMBER","body":"Pull requests are welcome :) I think I actually saw someone working on this with \"Show Partitions\" support which uses the same extension point","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/969755616/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/969766716","html_url":"https://github.com/apache/iceberg/issues/3554#issuecomment-969766716","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3554","id":969766716,"node_id":"IC_kwDOCW7NX845zXc8","user":{"login":"felixYyu","id":3785228,"node_id":"MDQ6VXNlcjM3ODUyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3785228?v=4","gravatar_id":"","url":"https://api.github.com/users/felixYyu","html_url":"https://github.com/felixYyu","followers_url":"https://api.github.com/users/felixYyu/followers","following_url":"https://api.github.com/users/felixYyu/following{/other_user}","gists_url":"https://api.github.com/users/felixYyu/gists{/gist_id}","starred_url":"https://api.github.com/users/felixYyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixYyu/subscriptions","organizations_url":"https://api.github.com/users/felixYyu/orgs","repos_url":"https://api.github.com/users/felixYyu/repos","events_url":"https://api.github.com/users/felixYyu/events{/privacy}","received_events_url":"https://api.github.com/users/felixYyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-16T03:12:21Z","updated_at":"2021-11-16T03:12:21Z","author_association":"CONTRIBUTOR","body":"I'm well, this PR assigne to me please. thanks Russell.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/969766716/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/969769950","html_url":"https://github.com/apache/iceberg/issues/3554#issuecomment-969769950","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3554","id":969769950,"node_id":"IC_kwDOCW7NX845zYPe","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-16T03:14:14Z","updated_at":"2021-11-16T03:14:14Z","author_association":"MEMBER","body":"Sounds good, let's close out this issue and i'll make a new one for the support drop partition.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/969769950/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/969775439","html_url":"https://github.com/apache/iceberg/issues/3558#issuecomment-969775439","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3558","id":969775439,"node_id":"IC_kwDOCW7NX845zZlP","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-16T03:17:10Z","updated_at":"2021-11-16T03:17:10Z","author_association":"MEMBER","body":"@felixYyu You wanted to take a crack at this?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/969775439/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/969782710","html_url":"https://github.com/apache/iceberg/issues/3558#issuecomment-969782710","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3558","id":969782710,"node_id":"IC_kwDOCW7NX845zbW2","user":{"login":"felixYyu","id":3785228,"node_id":"MDQ6VXNlcjM3ODUyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3785228?v=4","gravatar_id":"","url":"https://api.github.com/users/felixYyu","html_url":"https://github.com/felixYyu","followers_url":"https://api.github.com/users/felixYyu/followers","following_url":"https://api.github.com/users/felixYyu/following{/other_user}","gists_url":"https://api.github.com/users/felixYyu/gists{/gist_id}","starred_url":"https://api.github.com/users/felixYyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixYyu/subscriptions","organizations_url":"https://api.github.com/users/felixYyu/orgs","repos_url":"https://api.github.com/users/felixYyu/repos","events_url":"https://api.github.com/users/felixYyu/events{/privacy}","received_events_url":"https://api.github.com/users/felixYyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-16T03:21:25Z","updated_at":"2021-11-16T03:21:25Z","author_association":"CONTRIBUTOR","body":"I want","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/969782710/reactions","total_count":2,"+1":1,"-1":0,"laugh":1,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/969834256","html_url":"https://github.com/apache/iceberg/pull/3556#issuecomment-969834256","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3556","id":969834256,"node_id":"IC_kwDOCW7NX845zn8Q","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-16T03:55:38Z","updated_at":"2021-11-16T03:55:38Z","author_association":"MEMBER","body":"Updated again","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/969834256/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/969879040","html_url":"https://github.com/apache/iceberg/pull/3469#issuecomment-969879040","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3469","id":969879040,"node_id":"IC_kwDOCW7NX845zy4A","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-16T05:36:43Z","updated_at":"2021-11-16T05:36:43Z","author_association":"MEMBER","body":"> This looks fine to me, my only question would be should we be removing all the tests for the deprecated pathway before we remove that code from the codebase. Since the deprecated functions call the new ones it seems like we would be ok keeping them that way? I don't have a strong opinion here though. @aokolnychyi what do you think?\r\n\r\ncode is anyways deprecated. So, I felt it is ok to remove testcase. Also spark actions don't have testcase. I wanted to run some testcase and I found testcase doesn't exist. So, I added this PR. I am even ok to keep deprecated test class and add new test class. But that shows lot of code in diff. Hence I went with this method.\r\n\r\nwaiting for @aokolnychyi 's comments on this. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/969879040/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/970056747","html_url":"https://github.com/apache/iceberg/issues/3559#issuecomment-970056747","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3559","id":970056747,"node_id":"IC_kwDOCW7NX8450eQr","user":{"login":"SaurabhChawla100","id":34540906,"node_id":"MDQ6VXNlcjM0NTQwOTA2","avatar_url":"https://avatars.githubusercontent.com/u/34540906?v=4","gravatar_id":"","url":"https://api.github.com/users/SaurabhChawla100","html_url":"https://github.com/SaurabhChawla100","followers_url":"https://api.github.com/users/SaurabhChawla100/followers","following_url":"https://api.github.com/users/SaurabhChawla100/following{/other_user}","gists_url":"https://api.github.com/users/SaurabhChawla100/gists{/gist_id}","starred_url":"https://api.github.com/users/SaurabhChawla100/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SaurabhChawla100/subscriptions","organizations_url":"https://api.github.com/users/SaurabhChawla100/orgs","repos_url":"https://api.github.com/users/SaurabhChawla100/repos","events_url":"https://api.github.com/users/SaurabhChawla100/events{/privacy}","received_events_url":"https://api.github.com/users/SaurabhChawla100/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-16T08:56:23Z","updated_at":"2021-11-16T08:56:23Z","author_association":"NONE","body":"In Case we are opting for the  table.refresh in the SparkMergeScan  . I have created the Pr for the same https://github.com/apache/iceberg/pull/3560","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/970056747/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/970057467","html_url":"https://github.com/apache/iceberg/issues/3559#issuecomment-970057467","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3559","id":970057467,"node_id":"IC_kwDOCW7NX8450eb7","user":{"login":"SaurabhChawla100","id":34540906,"node_id":"MDQ6VXNlcjM0NTQwOTA2","avatar_url":"https://avatars.githubusercontent.com/u/34540906?v=4","gravatar_id":"","url":"https://api.github.com/users/SaurabhChawla100","html_url":"https://github.com/SaurabhChawla100","followers_url":"https://api.github.com/users/SaurabhChawla100/followers","following_url":"https://api.github.com/users/SaurabhChawla100/following{/other_user}","gists_url":"https://api.github.com/users/SaurabhChawla100/gists{/gist_id}","starred_url":"https://api.github.com/users/SaurabhChawla100/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SaurabhChawla100/subscriptions","organizations_url":"https://api.github.com/users/SaurabhChawla100/orgs","repos_url":"https://api.github.com/users/SaurabhChawla100/repos","events_url":"https://api.github.com/users/SaurabhChawla100/events{/privacy}","received_events_url":"https://api.github.com/users/SaurabhChawla100/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-16T08:57:17Z","updated_at":"2021-11-16T08:57:17Z","author_association":"NONE","body":"cc @RussellSpitzer @aokolnychyi ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/970057467/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/970131841","html_url":"https://github.com/apache/iceberg/pull/3562#issuecomment-970131841","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3562","id":970131841,"node_id":"IC_kwDOCW7NX8450wmB","user":{"login":"xloya","id":26177232,"node_id":"MDQ6VXNlcjI2MTc3MjMy","avatar_url":"https://avatars.githubusercontent.com/u/26177232?v=4","gravatar_id":"","url":"https://api.github.com/users/xloya","html_url":"https://github.com/xloya","followers_url":"https://api.github.com/users/xloya/followers","following_url":"https://api.github.com/users/xloya/following{/other_user}","gists_url":"https://api.github.com/users/xloya/gists{/gist_id}","starred_url":"https://api.github.com/users/xloya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xloya/subscriptions","organizations_url":"https://api.github.com/users/xloya/orgs","repos_url":"https://api.github.com/users/xloya/repos","events_url":"https://api.github.com/users/xloya/events{/privacy}","received_events_url":"https://api.github.com/users/xloya/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-16T10:27:38Z","updated_at":"2021-11-16T10:27:38Z","author_association":"CONTRIBUTOR","body":"If no exception is thrown, the Spark program will consider the entire compaction process to be successful and return the final state of success.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/970131841/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/970292486","html_url":"https://github.com/apache/iceberg/issues/3559#issuecomment-970292486","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3559","id":970292486,"node_id":"IC_kwDOCW7NX8451X0G","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-16T13:49:36Z","updated_at":"2021-11-16T13:49:36Z","author_association":"MEMBER","body":"Sounds like you just want to disable the Spark Catalog Cache, there are ongoing efforts to change the behavior  #3543 \r\n\r\nYou can disable the cache as well which would be my recommendation here.\r\n\r\n```\r\nspark.sql.catalog.catalog-name.cache-enabled | true or false | Whether to enable catalog cache, default value is true\r\n-- | -- | --\r\n```\r\n\r\nNote that this refresh will not avoid all \"found conflicting files\" errors, only those caused by a certain timing issues. If two merges happen truly simultaneously and attempt to modified the same files only 1 can succeed.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/970292486/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/970312711","html_url":"https://github.com/apache/iceberg/pull/3556#issuecomment-970312711","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3556","id":970312711,"node_id":"IC_kwDOCW7NX8451cwH","user":{"login":"rymurr","id":2022305,"node_id":"MDQ6VXNlcjIwMjIzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/2022305?v=4","gravatar_id":"","url":"https://api.github.com/users/rymurr","html_url":"https://github.com/rymurr","followers_url":"https://api.github.com/users/rymurr/followers","following_url":"https://api.github.com/users/rymurr/following{/other_user}","gists_url":"https://api.github.com/users/rymurr/gists{/gist_id}","starred_url":"https://api.github.com/users/rymurr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rymurr/subscriptions","organizations_url":"https://api.github.com/users/rymurr/orgs","repos_url":"https://api.github.com/users/rymurr/repos","events_url":"https://api.github.com/users/rymurr/events{/privacy}","received_events_url":"https://api.github.com/users/rymurr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-16T14:11:58Z","updated_at":"2021-11-16T14:11:58Z","author_association":"CONTRIBUTOR","body":"LGTM w/ the addition that a full example would really help the reader","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/970312711/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/970341489","html_url":"https://github.com/apache/iceberg/issues/3559#issuecomment-970341489","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3559","id":970341489,"node_id":"IC_kwDOCW7NX8451jxx","user":{"login":"SaurabhChawla100","id":34540906,"node_id":"MDQ6VXNlcjM0NTQwOTA2","avatar_url":"https://avatars.githubusercontent.com/u/34540906?v=4","gravatar_id":"","url":"https://api.github.com/users/SaurabhChawla100","html_url":"https://github.com/SaurabhChawla100","followers_url":"https://api.github.com/users/SaurabhChawla100/followers","following_url":"https://api.github.com/users/SaurabhChawla100/following{/other_user}","gists_url":"https://api.github.com/users/SaurabhChawla100/gists{/gist_id}","starred_url":"https://api.github.com/users/SaurabhChawla100/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SaurabhChawla100/subscriptions","organizations_url":"https://api.github.com/users/SaurabhChawla100/orgs","repos_url":"https://api.github.com/users/SaurabhChawla100/repos","events_url":"https://api.github.com/users/SaurabhChawla100/events{/privacy}","received_events_url":"https://api.github.com/users/SaurabhChawla100/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-16T14:43:09Z","updated_at":"2021-11-16T14:43:09Z","author_association":"NONE","body":"@RussellSpitzer - Thanks for sharing this conf (spark.sql.catalog.catalog-name.cache-enabled) for refreshing the cache eagerly. For the above use case where merge/update is running  at different time the conf is working fine.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/970341489/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/970426229","html_url":"https://github.com/apache/iceberg/pull/3459#issuecomment-970426229","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3459","id":970426229,"node_id":"IC_kwDOCW7NX84514d1","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-16T16:10:06Z","updated_at":"2021-11-16T16:10:06Z","author_association":"MEMBER","body":"@knightchess here is an example of what happens with the partitions metadata table\r\n\r\n```\r\nscala> spark.sql(\"CREATE TABLE example (a int, b int, c int, d int) using Iceberg location 'file:///Users/russellspitzer/Temp/example'\")\r\nscala> spark.sql(\"ALTER TABLE example ADD PARTITION FIELD identity(a)\")\r\nscala> spark.sql(\"INSERT INTO example VALUES (1,1,1,1)\")\r\n// Partition (a = 1)\r\nscala> spark.sql(\"ALTER TABLE example ADD PARTITION FIELD identity(b)\")\r\nscala> spark.sql(\"INSERT INTO example VALUES (2,2,2,2)\")\r\n// Partition (a = 2, b =2)\r\nscala> spark.sql(\"ALTER TABLE example ADD PARTITION FIELD identity(c)\")\r\nscala> spark.sql(\"INSERT INTO example VALUES (3,3,3,3)\")\r\n// Partition (a = 3, b = 3, c = 3)\r\nscala> spark.sql(\"ALTER TABLE example DROP PARTITION FIELD identity(c)\")\r\nscala> spark.sql(\"INSERT INTO example VALUES (4,4,4,4)\")\r\n// Partition (a = 4, b = 4, null(c) = null)\r\nscala> spark.sql(\"ALTER TABLE example DROP PARTITION FIELD identity(b)\")\r\nscala> spark.sql(\"INSERT INTO example VALUES (5,5,5,5)\")\r\n// Partition (a= 5, null(b) = null, null(c) = null)\r\nscala> spark.sql(\"ALTER TABLE example DROP PARTITION FIELD identity(a)\")\r\nscala> spark.sql(\"INSERT INTO example VALUES (6,6,6,6)\")\r\n// Partition (null(a) = null, null(b) = null, null(c) = null\r\n```\r\n\r\nThis creates a metadata table\r\n```\r\nscala> spark.sql(\"SELECT * from default.example.partitions SORT BY partition\").show\r\n+------------------+------------+----------+\r\n|         partition|record_count|file_count|\r\n+------------------+------------+----------+\r\n|{null, null, null}|           1|         1|\r\n|   {1, null, null}|           1|         1|\r\n|      {2, 2, null}|           1|         1|\r\n|         {3, 3, 3}|           1|         1|\r\n|      {4, 4, null}|           1|         1|\r\n|   {5, null, null}|           1|         1|\r\n+------------------+------------+----------+\r\n```\r\n\r\nThis metadata table has a partition spec which covers the entire range of possible specs the table has had even though the underlying table is currently unpartitioned. Now even though some partitions where written in a different spec (in this case every partition was written with a different spec) you see them all in the context of the \"maximal\" spec which covers all fields.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/970426229/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/970474454","html_url":"https://github.com/apache/iceberg/pull/3556#issuecomment-970474454","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3556","id":970474454,"node_id":"IC_kwDOCW7NX8452EPW","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-16T17:02:00Z","updated_at":"2021-11-16T17:02:00Z","author_association":"MEMBER","body":"@rymurr example added!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/970474454/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/970521918","html_url":"https://github.com/apache/iceberg/pull/3556#issuecomment-970521918","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3556","id":970521918,"node_id":"IC_kwDOCW7NX8452P0-","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-16T17:56:21Z","updated_at":"2021-11-16T17:56:21Z","author_association":"CONTRIBUTOR","body":"Looking great! Just a couple things I'd change.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/970521918/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/970559886","html_url":"https://github.com/apache/iceberg/pull/3293#issuecomment-970559886","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3293","id":970559886,"node_id":"IC_kwDOCW7NX8452ZGO","user":{"login":"NeQuissimus","id":628342,"node_id":"MDQ6VXNlcjYyODM0Mg==","avatar_url":"https://avatars.githubusercontent.com/u/628342?v=4","gravatar_id":"","url":"https://api.github.com/users/NeQuissimus","html_url":"https://github.com/NeQuissimus","followers_url":"https://api.github.com/users/NeQuissimus/followers","following_url":"https://api.github.com/users/NeQuissimus/following{/other_user}","gists_url":"https://api.github.com/users/NeQuissimus/gists{/gist_id}","starred_url":"https://api.github.com/users/NeQuissimus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/NeQuissimus/subscriptions","organizations_url":"https://api.github.com/users/NeQuissimus/orgs","repos_url":"https://api.github.com/users/NeQuissimus/repos","events_url":"https://api.github.com/users/NeQuissimus/events{/privacy}","received_events_url":"https://api.github.com/users/NeQuissimus/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-16T18:39:10Z","updated_at":"2021-11-16T18:39:10Z","author_association":"CONTRIBUTOR","body":"FWIW, we have been running this change and seen significant resource reduction.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/970559886/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/970610762","html_url":"https://github.com/apache/iceberg/pull/3565#issuecomment-970610762","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3565","id":970610762,"node_id":"IC_kwDOCW7NX8452lhK","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-16T19:32:13Z","updated_at":"2021-11-16T19:32:13Z","author_association":"CONTRIBUTOR","body":"cc @flyrain @rdblue @RussellSpitzer @karuppayya @szehon-ho @kbendick","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/970610762/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/970628383","html_url":"https://github.com/apache/iceberg/pull/3460#issuecomment-970628383","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3460","id":970628383,"node_id":"IC_kwDOCW7NX8452p0f","user":{"login":"izchen","id":67534059,"node_id":"MDQ6VXNlcjY3NTM0MDU5","avatar_url":"https://avatars.githubusercontent.com/u/67534059?v=4","gravatar_id":"","url":"https://api.github.com/users/izchen","html_url":"https://github.com/izchen","followers_url":"https://api.github.com/users/izchen/followers","following_url":"https://api.github.com/users/izchen/following{/other_user}","gists_url":"https://api.github.com/users/izchen/gists{/gist_id}","starred_url":"https://api.github.com/users/izchen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/izchen/subscriptions","organizations_url":"https://api.github.com/users/izchen/orgs","repos_url":"https://api.github.com/users/izchen/repos","events_url":"https://api.github.com/users/izchen/events{/privacy}","received_events_url":"https://api.github.com/users/izchen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-16T19:55:09Z","updated_at":"2021-11-16T19:55:09Z","author_association":"CONTRIBUTOR","body":"> Eventually, we'll need to update more than just Spark v3.2. Additionally, it would be nice if Flink and even MR could be handled in this PR. \r\n\r\n### Flink\r\n\r\nExecuting this SQL test case in flink will report an error: \r\n\r\n```\r\n[ERROR] Could not execute SQL statement. Reason:\r\norg.apache.flink.table.api.ValidationException: Data type 'BINARY(2) NOT NULL' with conversion class '[B' does not support a value literal of class 'org.apache.calcite.avatica.util.ByteString'.\r\n```\r\n\r\nIt seems that this is an internal error of flink, which has nothing to do with iceberg. I can add the following code to the flink code to solve this problem (I will try to submit a PR to the flink community in the future):\r\n\r\n```scala\r\ncase BINARY =>\r\n\t// convert to byte[]\r\n\tliteral.getValueAs(classOf[Array[Byte]])\r\n```\r\n\r\nhttps://github.com/apache/flink/blob/44378fa5fde6c17e1712a62b834cb6251605f416/flink-table/flink-table-planner/src/main/scala/org/apache/flink/table/planner/plan/utils/RexNodeExtractor.scala#L400-L466\r\n\r\nAfter using this code to fix flink, the SQL test case runs normally, returns the correct result, and the SQL description string in the flink UI is the correct X'110F'. I think this problem does not exist in Flink-runtime.\r\n\r\n### Hive\r\n\r\nAccording to the hive documentation, there is no binary type literal in hive. I think this problem does not exist in Hive-runtime.\r\n\r\n### Trino\r\n\r\nFor Trino, I have not actually used Trino. Judging from the Trino code, Trino may not have this MR problem, but I do not have a Trino test environment. And we cannot modify the Trino-runtime code in this MR.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/970628383/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/970629936","html_url":"https://github.com/apache/iceberg/pull/3460#issuecomment-970629936","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3460","id":970629936,"node_id":"IC_kwDOCW7NX8452qMw","user":{"login":"izchen","id":67534059,"node_id":"MDQ6VXNlcjY3NTM0MDU5","avatar_url":"https://avatars.githubusercontent.com/u/67534059?v=4","gravatar_id":"","url":"https://api.github.com/users/izchen","html_url":"https://github.com/izchen","followers_url":"https://api.github.com/users/izchen/followers","following_url":"https://api.github.com/users/izchen/following{/other_user}","gists_url":"https://api.github.com/users/izchen/gists{/gist_id}","starred_url":"https://api.github.com/users/izchen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/izchen/subscriptions","organizations_url":"https://api.github.com/users/izchen/orgs","repos_url":"https://api.github.com/users/izchen/repos","events_url":"https://api.github.com/users/izchen/events{/privacy}","received_events_url":"https://api.github.com/users/izchen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-16T19:57:16Z","updated_at":"2021-11-16T19:57:16Z","author_association":"CONTRIBUTOR","body":"Sorry for the late reply. I left some feedback. Thank you for your review @kbendick @rdblue ！","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/970629936/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/970632899","html_url":"https://github.com/apache/iceberg/pull/3530#issuecomment-970632899","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3530","id":970632899,"node_id":"IC_kwDOCW7NX8452q7D","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-16T20:01:33Z","updated_at":"2021-11-16T20:01:33Z","author_association":"CONTRIBUTOR","body":"Thanks for making this better, @flyrain!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/970632899/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/970638155","html_url":"https://github.com/apache/iceberg/pull/3530#issuecomment-970638155","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3530","id":970638155,"node_id":"IC_kwDOCW7NX8452sNL","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-16T20:08:26Z","updated_at":"2021-11-16T20:08:26Z","author_association":"CONTRIBUTOR","body":"Thanks for the review @RussellSpitzer @szehon-ho @kbendick @rdblue!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/970638155/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/970683192","html_url":"https://github.com/apache/iceberg/pull/3565#issuecomment-970683192","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3565","id":970683192,"node_id":"IC_kwDOCW7NX84523M4","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-16T21:12:48Z","updated_at":"2021-11-16T21:15:07Z","author_association":"MEMBER","body":"I'm not sure the added complexity here is worth the savings. It just feels like even with thousands of columns this should be on the order of milliseconds?\r\n\r\nIf we are worried about it though I have no problem with merging this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/970683192/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/970708453","html_url":"https://github.com/apache/iceberg/pull/3565#issuecomment-970708453","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3565","id":970708453,"node_id":"IC_kwDOCW7NX84529Xl","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-16T21:48:22Z","updated_at":"2021-11-16T21:48:22Z","author_association":"CONTRIBUTOR","body":"Yeah, I am not convinced either. I did not have it in the first place but I thought I would trigger this discussion. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/970708453/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/970719344","html_url":"https://github.com/apache/iceberg/issues/3559#issuecomment-970719344","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3559","id":970719344,"node_id":"IC_kwDOCW7NX8453ABw","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-16T22:03:57Z","updated_at":"2021-11-16T22:03:57Z","author_association":"MEMBER","body":"Alright, should we close this issue one out?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/970719344/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/970720179","html_url":"https://github.com/apache/iceberg/issues/3564#issuecomment-970720179","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3564","id":970720179,"node_id":"IC_kwDOCW7NX8453AOz","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-16T22:05:08Z","updated_at":"2021-11-16T22:05:08Z","author_association":"MEMBER","body":"I think this basically becomes a moot point in the new Spark 3 code where we can have the data source request the correct distribution. Manual sorting of the input data won't be required and Iceberg will be able to request to correct sorting automatically.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/970720179/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/970721428","html_url":"https://github.com/apache/iceberg/pull/3548#issuecomment-970721428","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3548","id":970721428,"node_id":"IC_kwDOCW7NX8453AiU","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-16T22:07:04Z","updated_at":"2021-11-16T22:07:04Z","author_association":"MEMBER","body":"Looks like we have some checkstyle errors\r\n```\r\nError: eckstyle] [ERROR] /home/runner/work/iceberg/iceberg/spark/v3.2/spark/src/test/java/org/apache/iceberg/spark/TestSparkCatalogOperations.java:75: Two consecutive blank lines are not permitted. [RegexpMultiline]\r\n```\r\n\r\nI generally use \r\n```\r\ng build -x test  -x integrationTest\r\n```\r\n\r\nto check all of the style/static analysis checks.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/970721428/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/970746207","html_url":"https://github.com/apache/iceberg/pull/3557#issuecomment-970746207","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3557","id":970746207,"node_id":"IC_kwDOCW7NX8453Glf","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-16T22:39:55Z","updated_at":"2021-11-16T22:39:55Z","author_association":"MEMBER","body":"Should we have added tests her for mixed equality and positional deletes?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/970746207/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/970783558","html_url":"https://github.com/apache/iceberg/pull/3545#issuecomment-970783558","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3545","id":970783558,"node_id":"IC_kwDOCW7NX8453PtG","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-16T23:03:43Z","updated_at":"2021-11-16T23:03:43Z","author_association":"MEMBER","body":"I'm a little worried about adding this to the core api, should this be something that we figure out at the Spark side and pass in the correct identifiers from there? Like it seems like the SortOrderBuilder should be like the PartitionSpecBuilder and require exact matches. Then if we want to support case insensitivity we rely on the engine (or convert at the engine level) to get the correct identifiers.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/970783558/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/970870654","html_url":"https://github.com/apache/iceberg/pull/3561#issuecomment-970870654","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3561","id":970870654,"node_id":"IC_kwDOCW7NX8453k9-","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-16T23:52:06Z","updated_at":"2021-11-16T23:54:16Z","author_association":"CONTRIBUTOR","body":"Example of the Swagger editor view of the proposed API specification when copied into `editor.swagger.io`.\r\n\r\n![image](https://user-images.githubusercontent.com/9833362/142084426-10585753-419b-436d-94c1-b6da27684d1c.png)\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/970870654/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/971084426","html_url":"https://github.com/apache/iceberg/pull/3459#issuecomment-971084426","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3459","id":971084426,"node_id":"IC_kwDOCW7NX8454ZKK","user":{"login":"KnightChess","id":20125927,"node_id":"MDQ6VXNlcjIwMTI1OTI3","avatar_url":"https://avatars.githubusercontent.com/u/20125927?v=4","gravatar_id":"","url":"https://api.github.com/users/KnightChess","html_url":"https://github.com/KnightChess","followers_url":"https://api.github.com/users/KnightChess/followers","following_url":"https://api.github.com/users/KnightChess/following{/other_user}","gists_url":"https://api.github.com/users/KnightChess/gists{/gist_id}","starred_url":"https://api.github.com/users/KnightChess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/KnightChess/subscriptions","organizations_url":"https://api.github.com/users/KnightChess/orgs","repos_url":"https://api.github.com/users/KnightChess/repos","events_url":"https://api.github.com/users/KnightChess/events{/privacy}","received_events_url":"https://api.github.com/users/KnightChess/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-17T01:59:03Z","updated_at":"2021-11-17T01:59:03Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer yes, I konw, `listPartitionIdentifiers` can return all partitions of the \"maximal\" spec.\r\n\r\n1. But in `ShowPartitionsExe`, spark use `partitionSchema` method to get dataType in following code. \r\n\r\n    So that's mean I need return \"maximal\" spec when use `partitionSchema` although the table was partitioned before but unpartitioned now.\r\n```scala\r\nval partitionIdentifiers = table.listPartitionIdentifiers(names.toArray, ident)\r\n// Converting partition identifiers as `InternalRow` of partition values,\r\n// for instance InternalRow(value0, value1, ..., valueN), to `InternalRow`s\r\n// with a string in the format: \"col0=value0/col1=value1/.../colN=valueN\".\r\nval schema = table.partitionSchema()\r\nval len = schema.length\r\nval partitions = new Array[String](len)\r\nval timeZoneId = conf.sessionLocalTimeZone\r\nval output = partitionIdentifiers.map { row =>\r\n  var i = 0\r\n  while (i < len) {\r\n    val dataType = schema(i).dataType\r\n    val partValueUTF8String =\r\n      Cast(Literal(row.get(i, dataType), dataType), StringType, Some(timeZoneId)).eval()\r\n    val partValueStr = if (partValueUTF8String == null) \"null\" else partValueUTF8String.toString\r\n    partitions(i) = escapePathName(schema(i).name) + \"=\" + escapePathName(partValueStr)\r\n    i += 1\r\n  }\r\n  partitions.mkString(\"/\")\r\n}\r\noutput.sorted.map(p => InternalRow(UTF8String.fromString(p)))\r\n```\r\n\r\n2. But if `partitionSchema` method return \"maximal\" spec. Some scenes may lead to errors. like: `CheckAnalysis.checkAnalysis` in following code, although the table is unpartitioned, but will pass the check if the table was partitioned before.\r\n\r\n```scala\r\ncase command: V2PartitionCommand =>\r\ncommand.table match {\r\n  case r @ ResolvedTable(_, _, table, _) => table match {\r\n    case t: SupportsPartitionManagement =>\r\n      if (t.partitionSchema.isEmpty) {\r\n        failAnalysis(s\"Table ${r.name} is not partitioned.\")\r\n      }\r\n    case _ =>\r\n      failAnalysis(s\"Table ${r.name} does not support partition management.\")\r\n  }\r\n  case _ =>\r\n}\r\n```\r\n\r\n3. And My fault,  I didn't notice the following description before. \r\n> `partitionSchema` must be consistent with `Table.partitioning`\r\n\r\nThe `Table.partitioning` will only return the physical partitioning of the table (voiedTransform will be remove).\r\n```scala\r\n/**\r\n* Get the partition schema of table,\r\n* this must be consistent with ${@link Table#partitioning()}.\r\n* @return the partition schema of table\r\n*/\r\nStructType partitionSchema();\r\n```\r\n\r\nI have a little confusion. So that's mean it can't achieve the same effect by use `show partitions` and `select * form xxxx.partitions` when follow the rules in points 2 and 3?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/971084426/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/971120089","html_url":"https://github.com/apache/iceberg/pull/3487#issuecomment-971120089","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3487","id":971120089,"node_id":"IC_kwDOCW7NX8454h3Z","user":{"login":"KnightChess","id":20125927,"node_id":"MDQ6VXNlcjIwMTI1OTI3","avatar_url":"https://avatars.githubusercontent.com/u/20125927?v=4","gravatar_id":"","url":"https://api.github.com/users/KnightChess","html_url":"https://github.com/KnightChess","followers_url":"https://api.github.com/users/KnightChess/followers","following_url":"https://api.github.com/users/KnightChess/following{/other_user}","gists_url":"https://api.github.com/users/KnightChess/gists{/gist_id}","starred_url":"https://api.github.com/users/KnightChess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/KnightChess/subscriptions","organizations_url":"https://api.github.com/users/KnightChess/orgs","repos_url":"https://api.github.com/users/KnightChess/repos","events_url":"https://api.github.com/users/KnightChess/events{/privacy}","received_events_url":"https://api.github.com/users/KnightChess/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-17T02:37:07Z","updated_at":"2021-11-17T02:37:24Z","author_association":"CONTRIBUTOR","body":"So it's better support doc for developer to decide personal development environment.\r\n\r\nthis pr will close next day, let's discuss in #3485 \r\nthanks for @rdblue @jackye1995 @pan3793 advice","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/971120089/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/971149890","html_url":"https://github.com/apache/iceberg/pull/3434#issuecomment-971149890","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3434","id":971149890,"node_id":"IC_kwDOCW7NX8454pJC","user":{"login":"SteNicholas","id":10048174,"node_id":"MDQ6VXNlcjEwMDQ4MTc0","avatar_url":"https://avatars.githubusercontent.com/u/10048174?v=4","gravatar_id":"","url":"https://api.github.com/users/SteNicholas","html_url":"https://github.com/SteNicholas","followers_url":"https://api.github.com/users/SteNicholas/followers","following_url":"https://api.github.com/users/SteNicholas/following{/other_user}","gists_url":"https://api.github.com/users/SteNicholas/gists{/gist_id}","starred_url":"https://api.github.com/users/SteNicholas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SteNicholas/subscriptions","organizations_url":"https://api.github.com/users/SteNicholas/orgs","repos_url":"https://api.github.com/users/SteNicholas/repos","events_url":"https://api.github.com/users/SteNicholas/events{/privacy}","received_events_url":"https://api.github.com/users/SteNicholas/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-17T03:52:06Z","updated_at":"2021-11-17T03:52:06Z","author_association":"MEMBER","body":"@openinx , what about the integration with the new `Sink` interface? The FLIP-27 is implemented by @stevenzwu , and the corresponding FLIP-143 support is necessary.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/971149890/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/971167494","html_url":"https://github.com/apache/iceberg/issues/3559#issuecomment-971167494","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3559","id":971167494,"node_id":"IC_kwDOCW7NX8454tcG","user":{"login":"SaurabhChawla100","id":34540906,"node_id":"MDQ6VXNlcjM0NTQwOTA2","avatar_url":"https://avatars.githubusercontent.com/u/34540906?v=4","gravatar_id":"","url":"https://api.github.com/users/SaurabhChawla100","html_url":"https://github.com/SaurabhChawla100","followers_url":"https://api.github.com/users/SaurabhChawla100/followers","following_url":"https://api.github.com/users/SaurabhChawla100/following{/other_user}","gists_url":"https://api.github.com/users/SaurabhChawla100/gists{/gist_id}","starred_url":"https://api.github.com/users/SaurabhChawla100/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SaurabhChawla100/subscriptions","organizations_url":"https://api.github.com/users/SaurabhChawla100/orgs","repos_url":"https://api.github.com/users/SaurabhChawla100/repos","events_url":"https://api.github.com/users/SaurabhChawla100/events{/privacy}","received_events_url":"https://api.github.com/users/SaurabhChawla100/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-17T04:18:16Z","updated_at":"2021-11-17T04:18:16Z","author_association":"NONE","body":"Sure will close this issue. Thank you","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/971167494/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/971168029","html_url":"https://github.com/apache/iceberg/pull/3560#issuecomment-971168029","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3560","id":971168029,"node_id":"IC_kwDOCW7NX8454tkd","user":{"login":"SaurabhChawla100","id":34540906,"node_id":"MDQ6VXNlcjM0NTQwOTA2","avatar_url":"https://avatars.githubusercontent.com/u/34540906?v=4","gravatar_id":"","url":"https://api.github.com/users/SaurabhChawla100","html_url":"https://github.com/SaurabhChawla100","followers_url":"https://api.github.com/users/SaurabhChawla100/followers","following_url":"https://api.github.com/users/SaurabhChawla100/following{/other_user}","gists_url":"https://api.github.com/users/SaurabhChawla100/gists{/gist_id}","starred_url":"https://api.github.com/users/SaurabhChawla100/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SaurabhChawla100/subscriptions","organizations_url":"https://api.github.com/users/SaurabhChawla100/orgs","repos_url":"https://api.github.com/users/SaurabhChawla100/repos","events_url":"https://api.github.com/users/SaurabhChawla100/events{/privacy}","received_events_url":"https://api.github.com/users/SaurabhChawla100/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-17T04:19:32Z","updated_at":"2021-11-17T04:19:32Z","author_association":"NONE","body":"Closing this PR since on disabling the `spark.sql.catalog.catalog-name.cache-enabled` . we can run the SparkMergeScan on latest snapshotId","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/971168029/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/971308599","html_url":"https://github.com/apache/iceberg/pull/3563#issuecomment-971308599","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3563","id":971308599,"node_id":"IC_kwDOCW7NX8455P43","user":{"login":"xloya","id":26177232,"node_id":"MDQ6VXNlcjI2MTc3MjMy","avatar_url":"https://avatars.githubusercontent.com/u/26177232?v=4","gravatar_id":"","url":"https://api.github.com/users/xloya","html_url":"https://github.com/xloya","followers_url":"https://api.github.com/users/xloya/followers","following_url":"https://api.github.com/users/xloya/following{/other_user}","gists_url":"https://api.github.com/users/xloya/gists{/gist_id}","starred_url":"https://api.github.com/users/xloya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xloya/subscriptions","organizations_url":"https://api.github.com/users/xloya/orgs","repos_url":"https://api.github.com/users/xloya/repos","events_url":"https://api.github.com/users/xloya/events{/privacy}","received_events_url":"https://api.github.com/users/xloya/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-17T07:27:07Z","updated_at":"2021-11-17T07:41:03Z","author_association":"CONTRIBUTOR","body":"Hi @kbendick , firstly thanks for your review!  \r\n\r\nYou did mention another usage scenario that I didn't think about. We generally do use an isolated spark job for compaction. So we need a spark job tells us no commit succeeded by an exception to allows us to process in time without affecting query efficiency. It is also very normal to execute compaction after writing in the same one spark job.  \r\n\r\nCan we use a compromise method, such as adding an `allow-no-commit-succeed` configuration that defaults to `true`, and then customize it in a spark job to choose whether to throw an exception?  ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/971308599/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/971374709","html_url":"https://github.com/apache/iceberg/pull/3434#issuecomment-971374709","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3434","id":971374709,"node_id":"IC_kwDOCW7NX8455gB1","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-17T09:03:58Z","updated_at":"2021-11-17T09:03:58Z","author_association":"MEMBER","body":"> @openinx , what about the integration with the new `Sink` interface? The FLIP-27 is implemented by @stevenzwu , and the corresponding FLIP-143 support is necessary.\r\n\r\nI think the flip-27 sink integration work will be merged in flink 1.13 module firstly, and then port other related flink versions. That is a bigger feature and we need to make sure it works stable for a specific flink version.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/971374709/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/971396171","html_url":"https://github.com/apache/iceberg/pull/3276#issuecomment-971396171","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3276","id":971396171,"node_id":"IC_kwDOCW7NX8455lRL","user":{"login":"velctor","id":39006258,"node_id":"MDQ6VXNlcjM5MDA2MjU4","avatar_url":"https://avatars.githubusercontent.com/u/39006258?v=4","gravatar_id":"","url":"https://api.github.com/users/velctor","html_url":"https://github.com/velctor","followers_url":"https://api.github.com/users/velctor/followers","following_url":"https://api.github.com/users/velctor/following{/other_user}","gists_url":"https://api.github.com/users/velctor/gists{/gist_id}","starred_url":"https://api.github.com/users/velctor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/velctor/subscriptions","organizations_url":"https://api.github.com/users/velctor/orgs","repos_url":"https://api.github.com/users/velctor/repos","events_url":"https://api.github.com/users/velctor/events{/privacy}","received_events_url":"https://api.github.com/users/velctor/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-17T09:29:53Z","updated_at":"2021-11-17T09:48:58Z","author_association":"NONE","body":"> @velctor, it looks like that is a different finalizer. If you were seeing something that was closed by the Iceberg finalizer, you'd get a stack trace for where the stream was created and it would be no longer referenced. I think in this case, your `FileSystem` is getting closed by the finalizer, which closes all streams associated with it. That's why you get the DFS classes in those logs (I think). Are you not caching the FS instance in Hadoop's FileSystem class?\r\n\r\nOh, the stack information is too long, So I didn't add it before. The relevant complete information is as follows：\r\n```\r\n2021-11-17T16:50:01.177+0800\tDEBUG\t20211117_084955_00003_gwkuf.1.2-11-160\torg.apache.hadoop.fs.FileSystem\tBypassing cache to create filesystem hdfs://***:9000/user/hive/warehouse/SingleTable2/data/00000-1-b5ccab76-0db2-4f2e-887f-f70b9833cb91-00533.parquet\r\n2021-11-17T16:50:01.304+0800    WARN    Finalizer       org.apache.iceberg.hadoop.HadoopStreams call finalize by:\r\n        org.apache.iceberg.hadoop.HadoopStreams$HadoopSeekableInputStream.finalize(HadoopStreams.java:125)\r\n        java.base/java.lang.System$2.invokeFinalize(System.java:2125)\r\n        java.base/java.lang.ref.Finalizer.runFinalizer(Finalizer.java:87)\r\n        java.base/java.lang.ref.Finalizer$FinalizerThread.run(Finalizer.java:171)\r\n2021-11-17T16:50:01.304+0800    DEBUG   Finalizer       org.apache.hadoop.hdfs.DFSClient        close DFSInputStream /user/hive/warehouse/SingleTable2/data/00000-1-b5ccab76-0db2-4f2e-887f-f70b9833cb91-00533.parquet  thread name:Finalizer  client:DFSClient_NONMAPREDUCE_1873007395_160\r\n2021-11-17T16:50:01.304+0800    DEBUG   Finalizer       org.apache.hadoop.hdfs.DFSClient        call DFSInputStream close by:\r\n        org.apache.hadoop.hdfs.DFSInputStream.close(DFSInputStream.java:660)\r\n        java.base/java.io.FilterInputStream.close(FilterInputStream.java:180)\r\n        org.apache.iceberg.hadoop.HadoopStreams$HadoopSeekableInputStream.close(HadoopStreams.java:92)\r\n        org.apache.iceberg.hadoop.HadoopStreams$HadoopSeekableInputStream.finalize(HadoopStreams.java:129)\r\n        java.base/java.lang.System$2.invokeFinalize(System.java:2125)\r\n        java.base/java.lang.ref.Finalizer.runFinalizer(Finalizer.java:87)\r\n        java.base/java.lang.ref.Finalizer$FinalizerThread.run(Finalizer.java:171)\r\n2021-11-17T16:50:01.304+0800    WARN    Finalizer       org.apache.iceberg.hadoop.HadoopStreams Unclosed input stream created by:\r\n        org.apache.iceberg.hadoop.HadoopStreams$HadoopSeekableInputStream.<init>(HadoopStreams.java:81)\r\n        org.apache.iceberg.hadoop.HadoopStreams.wrap(HadoopStreams.java:56)\r\n        org.apache.iceberg.hadoop.HadoopInputFile.newStream(HadoopInputFile.java:175)\r\n        io.trino.plugin.hive.authentication.NoHdfsAuthentication.doAs(NoHdfsAuthentication.java:23)\r\n        io.trino.plugin.hive.HdfsEnvironment.doAs(HdfsEnvironment.java:98)\r\n        io.trino.plugin.iceberg.HdfsInputFile.newStream(HdfsInputFile.java:60)\r\n        org.apache.iceberg.parquet.ParquetIO$ParquetInputFile.newStream(ParquetIO.java:181)\r\n        org.apache.parquet.hadoop.ParquetFileReader.<init>(ParquetFileReader.java:773)\r\n        org.apache.parquet.hadoop.ParquetFileReader.open(ParquetFileReader.java:657)\r\n        org.apache.iceberg.parquet.ReadConf.newReader(ReadConf.java:218)\r\n        org.apache.iceberg.parquet.ReadConf.<init>(ReadConf.java:74)\r\n        org.apache.iceberg.parquet.ParquetReader.init(ParquetReader.java:66)\r\n        org.apache.iceberg.parquet.ParquetReader.iterator(ParquetReader.java:77)\r\n        org.apache.iceberg.io.CloseableIterable$ConcatCloseableIterable$ConcatCloseableIterator.hasNext(CloseableIterable.java:173)\r\n        org.apache.iceberg.io.FilterIterator.advance(FilterIterator.java:65)\r\n        org.apache.iceberg.io.FilterIterator.hasNext(FilterIterator.java:50)\r\n        org.apache.iceberg.io.CloseableIterable$4$1.hasNext(CloseableIterable.java:108)\r\n        org.apache.iceberg.io.CloseableIterable$ConcatCloseableIterable$ConcatCloseableIterator.hasNext(CloseableIterable.java:161)\r\n        org.apache.iceberg.relocated.com.google.common.collect.Iterators.addAll(Iterators.java:355)\r\n        org.apache.iceberg.relocated.com.google.common.collect.Sets.newHashSet(Sets.java:275)\r\n        org.apache.iceberg.relocated.com.google.common.collect.Sets.newHashSet(Sets.java:258)\r\n        org.apache.iceberg.deletes.Deletes.toPositionSet(Deletes.java:101)\r\n        org.apache.iceberg.deletes.Deletes.toPositionSet(Deletes.java:96)\r\n        org.apache.iceberg.deletes.Deletes.toPositionSet(Deletes.java:88)\r\n        io.trino.plugin.iceberg.TrinoDeleteFilter.getPositionSet(TrinoDeleteFilter.java:146)\r\n        io.trino.plugin.iceberg.IcebergDeleteFilter.<init>(IcebergDeleteFilter.java:44)\r\n        io.trino.plugin.iceberg.IcebergPageSource.<init>(IcebergPageSource.java:62)\r\n        io.trino.plugin.iceberg.IcebergPageSourceProvider.createPageSource(IcebergPageSourceProvider.java:215)   \r\n    io.trino.plugin.base.classloader.ClassLoaderSafeConnectorPageSourceProvider.createPageSource(ClassLoaderSafeConnectorPageSourceProvider.java:49)\r\n        io.trino.split.PageSourceManager.createPageSource(PageSourceManager.java:64)\r\n        io.trino.operator.TableScanOperator.getOutput(TableScanOperator.java:306)\r\n        io.trino.operator.Driver.processInternal(Driver.java:387)\r\n        io.trino.operator.Driver.lambda$processFor$9(Driver.java:291)\r\n        io.trino.operator.Driver.tryWithLock(Driver.java:683)\r\n        io.trino.operator.Driver.processFor(Driver.java:284)\r\n        io.trino.execution.SqlTaskExecution$DriverSplitRunner.processFor(SqlTaskExecution.java:1076)\r\n        io.trino.execution.executor.PrioritizedSplitRunner.process(PrioritizedSplitRunner.java:163)\r\n        io.trino.execution.executor.TaskExecutor$TaskRunner.run(TaskExecutor.java:484)\r\n        io.trino.$gen.Trino_359____20211117_084839_2.run(Unknown Source)\r\n        java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)\r\n        java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)\r\n        java.base/java.lang.Thread.run(Thread.java:829)\r\n2021-11-17T16:50:01.318+0800\tDEBUG\t20211117_084955_00003_gwkuf.1.2-11-160\torg.apache.hadoop.hdfs.DFSClient\tDFSInputStream has been closed already /user/hive/warehouse/SingleTable2/data/00000-1-b5ccab76-0db2-4f2e-887f-f70b9833cb91-00533.parquet  thread name:20211117_084955_00003_gwkuf.1.2-11-160  client:DFSClient_NONMAPREDUCE_1873007395_160\r\norg.apache.iceberg.exceptions.RuntimeIOException: Failed to open Parquet file: hdfs://***:9000/user/hive/warehouse/SingleTable2/data/00000-1-b5ccab76-0db2-4f2e-887f-f70b9833cb91-00533.parquet, thread name: 20211117_084955_00003_gwkuf.1.2-11-160\r\n\r\n2021-11-17T16:50:01.318+0800    DEBUG   20211117_084955_00003_gwkuf.1.2-11-160  org.apache.hadoop.hdfs.DFSClient        DFSInputStream has been closed already /user/hive/warehouse/SingleTable2/data/00000-1-b5ccab76-0db2-4f2e-887f-f70b9833cb91-00533.parquet  thread name:20211117_084955_00003_gwkuf.1.2-11-160  client:DFSClient_NONMAPREDUCE_1873007395_16\r\n```\r\n\r\nI have added the call stack log of the `finalize `and `close `functions. Together with the stack trace for where the stream was created, we can see that the stream is closed by the Finalizer.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/971396171/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/971517807","html_url":"https://github.com/apache/iceberg/pull/3375#issuecomment-971517807","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3375","id":971517807,"node_id":"IC_kwDOCW7NX8456C9v","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-17T12:07:22Z","updated_at":"2021-11-17T12:07:22Z","author_association":"MEMBER","body":"@rymurr , @RussellSpitzer :\r\na) I added few test cases to sparkExpression converter and then saw Russell's comment about converting sparkExpression to sparkFilter and then to IcebergExpression. I couldn't find a way to do that.  So, I should go back to testing sparkExpression or do we have a way to achieve it ?\r\nb) About avoiding manual parser for sort order, I tried `SqlBaseParser::orderedIdentifierList`, it gave empty results. Didn't work. I will explore more on this.\r\n\r\nOther than these two, everything else is handled. Please take a look.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/971517807/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/971544477","html_url":"https://github.com/apache/iceberg/pull/3104#issuecomment-971544477","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3104","id":971544477,"node_id":"IC_kwDOCW7NX8456Jed","user":{"login":"rymurr","id":2022305,"node_id":"MDQ6VXNlcjIwMjIzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/2022305?v=4","gravatar_id":"","url":"https://api.github.com/users/rymurr","html_url":"https://github.com/rymurr","followers_url":"https://api.github.com/users/rymurr/followers","following_url":"https://api.github.com/users/rymurr/following{/other_user}","gists_url":"https://api.github.com/users/rymurr/gists{/gist_id}","starred_url":"https://api.github.com/users/rymurr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rymurr/subscriptions","organizations_url":"https://api.github.com/users/rymurr/orgs","repos_url":"https://api.github.com/users/rymurr/repos","events_url":"https://api.github.com/users/rymurr/events{/privacy}","received_events_url":"https://api.github.com/users/rymurr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-17T12:44:04Z","updated_at":"2021-11-17T12:44:04Z","author_association":"CONTRIBUTOR","body":"Hey @jackye1995 I added a bunch of comments to the design doc. Do you consider this more up to date now? Should I commnet/review here instead?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/971544477/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/971550216","html_url":"https://github.com/apache/iceberg/pull/3425#issuecomment-971550216","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3425","id":971550216,"node_id":"IC_kwDOCW7NX8456K4I","user":{"login":"rymurr","id":2022305,"node_id":"MDQ6VXNlcjIwMjIzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/2022305?v=4","gravatar_id":"","url":"https://api.github.com/users/rymurr","html_url":"https://github.com/rymurr","followers_url":"https://api.github.com/users/rymurr/followers","following_url":"https://api.github.com/users/rymurr/following{/other_user}","gists_url":"https://api.github.com/users/rymurr/gists{/gist_id}","starred_url":"https://api.github.com/users/rymurr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rymurr/subscriptions","organizations_url":"https://api.github.com/users/rymurr/orgs","repos_url":"https://api.github.com/users/rymurr/repos","events_url":"https://api.github.com/users/rymurr/events{/privacy}","received_events_url":"https://api.github.com/users/rymurr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-17T12:52:16Z","updated_at":"2021-11-17T12:52:16Z","author_association":"CONTRIBUTOR","body":"Hey @jackye1995 I left a lot of comments on the google doc. is that still the referecne or should I copy the comments here?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/971550216/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/971652737","html_url":"https://github.com/apache/iceberg/pull/3545#issuecomment-971652737","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3545","id":971652737,"node_id":"IC_kwDOCW7NX8456j6B","user":{"login":"xiaotianzhang01","id":17720945,"node_id":"MDQ6VXNlcjE3NzIwOTQ1","avatar_url":"https://avatars.githubusercontent.com/u/17720945?v=4","gravatar_id":"","url":"https://api.github.com/users/xiaotianzhang01","html_url":"https://github.com/xiaotianzhang01","followers_url":"https://api.github.com/users/xiaotianzhang01/followers","following_url":"https://api.github.com/users/xiaotianzhang01/following{/other_user}","gists_url":"https://api.github.com/users/xiaotianzhang01/gists{/gist_id}","starred_url":"https://api.github.com/users/xiaotianzhang01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xiaotianzhang01/subscriptions","organizations_url":"https://api.github.com/users/xiaotianzhang01/orgs","repos_url":"https://api.github.com/users/xiaotianzhang01/repos","events_url":"https://api.github.com/users/xiaotianzhang01/events{/privacy}","received_events_url":"https://api.github.com/users/xiaotianzhang01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-17T14:48:05Z","updated_at":"2021-11-18T04:17:12Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer You're right, we should have a common util at the spark engine level for this, i updated the pr to put the function in `Spark3Util`","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/971652737/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/971689868","html_url":"https://github.com/apache/iceberg/pull/3508#issuecomment-971689868","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3508","id":971689868,"node_id":"IC_kwDOCW7NX8456s-M","user":{"login":"samredai","id":43911210,"node_id":"MDQ6VXNlcjQzOTExMjEw","avatar_url":"https://avatars.githubusercontent.com/u/43911210?v=4","gravatar_id":"","url":"https://api.github.com/users/samredai","html_url":"https://github.com/samredai","followers_url":"https://api.github.com/users/samredai/followers","following_url":"https://api.github.com/users/samredai/following{/other_user}","gists_url":"https://api.github.com/users/samredai/gists{/gist_id}","starred_url":"https://api.github.com/users/samredai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samredai/subscriptions","organizations_url":"https://api.github.com/users/samredai/orgs","repos_url":"https://api.github.com/users/samredai/repos","events_url":"https://api.github.com/users/samredai/events{/privacy}","received_events_url":"https://api.github.com/users/samredai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-17T15:27:44Z","updated_at":"2021-11-17T15:27:44Z","author_association":"CONTRIBUTOR","body":"Thanks for this @xinbinhuang! A few other commands that would be nice to document here is running just a single test. For example, running just `test_map_types` can be done like this.\r\n```\r\ntox -- -k test_map_types\r\n```\r\nAlso reformatting the code:\r\n```\r\ntox -e format\r\n```\r\nAlso _just_ running the format checkers and not the pytests:\r\n```\r\ntox -e linters\r\n```\r\nOne other thing is I think it would be better if we split out the commands into their own code blocks so that users can use the code block copy button. If two or three variations of a command are in a single code block, the user has to highlight which one they want with the mouse.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/971689868/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/971752494","html_url":"https://github.com/apache/iceberg/issues/3483#issuecomment-971752494","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3483","id":971752494,"node_id":"IC_kwDOCW7NX84568Qu","user":{"login":"singhpk234","id":35593236,"node_id":"MDQ6VXNlcjM1NTkzMjM2","avatar_url":"https://avatars.githubusercontent.com/u/35593236?v=4","gravatar_id":"","url":"https://api.github.com/users/singhpk234","html_url":"https://github.com/singhpk234","followers_url":"https://api.github.com/users/singhpk234/followers","following_url":"https://api.github.com/users/singhpk234/following{/other_user}","gists_url":"https://api.github.com/users/singhpk234/gists{/gist_id}","starred_url":"https://api.github.com/users/singhpk234/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/singhpk234/subscriptions","organizations_url":"https://api.github.com/users/singhpk234/orgs","repos_url":"https://api.github.com/users/singhpk234/repos","events_url":"https://api.github.com/users/singhpk234/events{/privacy}","received_events_url":"https://api.github.com/users/singhpk234/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-17T16:35:45Z","updated_at":"2021-11-17T16:35:45Z","author_association":"CONTRIBUTOR","body":"May I have a try ? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/971752494/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/971768810","html_url":"https://github.com/apache/iceberg/pull/3293#issuecomment-971768810","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3293","id":971768810,"node_id":"IC_kwDOCW7NX8457APq","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-17T16:54:18Z","updated_at":"2021-11-17T16:54:18Z","author_association":"CONTRIBUTOR","body":"@NeQuissimus, I think we'd love to get this in. The blocker is that test. We need to understand what's going on and fix it. I can't say when I'll have time to investigate myself, so if you want to find out more about it that would be really helpful!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/971768810/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/971807958","html_url":"https://github.com/apache/iceberg/issues/3212#issuecomment-971807958","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3212","id":971807958,"node_id":"IC_kwDOCW7NX8457JzW","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-17T17:40:14Z","updated_at":"2021-11-17T17:40:14Z","author_association":"CONTRIBUTOR","body":"For clarification, in (2), by `object storage mode`, do you mean the [`ObjectStorageLocationProvider`](https://github.com/apache/iceberg/blob/12e30ebaeb6dc0ff7e6bb01c0d9f8ae8a5f06ddf/core/src/main/java/org/apache/iceberg/LocationProviders.java#L98)?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/971807958/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/971815162","html_url":"https://github.com/apache/iceberg/issues/3212#issuecomment-971815162","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3212","id":971815162,"node_id":"IC_kwDOCW7NX8457Lj6","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-17T17:49:35Z","updated_at":"2021-11-17T17:49:35Z","author_association":"CONTRIBUTOR","body":"> For clarification, in (2), by object storage mode, do you mean the ObjectStorageLocationProvider?\r\n\r\nYes","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/971815162/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/971834899","html_url":"https://github.com/apache/iceberg/pull/3565#issuecomment-971834899","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3565","id":971834899,"node_id":"IC_kwDOCW7NX8457QYT","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-17T18:14:37Z","updated_at":"2021-11-17T18:14:37Z","author_association":"CONTRIBUTOR","body":"I agree that string manipulation is probably more expensive than the select, but I'm not too concerned about this.\r\n\r\nThat said, the complexity here looks reasonable since it is just passing a set of IDs to `select`. I could go either way. +1 if you want to merge it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/971834899/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/971838964","html_url":"https://github.com/apache/iceberg/pull/3556#issuecomment-971838964","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3556","id":971838964,"node_id":"IC_kwDOCW7NX8457RX0","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-17T18:19:41Z","updated_at":"2021-11-17T18:19:41Z","author_association":"CONTRIBUTOR","body":"+1 once the fixed-width font for name mapping and field mapping are fixed. Thanks @RussellSpitzer!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/971838964/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/971882674","html_url":"https://github.com/apache/iceberg/pull/3434#issuecomment-971882674","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3434","id":971882674,"node_id":"IC_kwDOCW7NX8457cCy","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-17T19:01:28Z","updated_at":"2021-11-17T19:01:28Z","author_association":"CONTRIBUTOR","body":"@openinx I think you meant flip-17 source integration will be merged to flink 1.13 module first.\r\n\r\n@SteNicholas was asking about the new flip-143 unified sink interface, which I don't think anyone has picked that one up yet. We probably should create a separate github issue to track that work and discussions","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/971882674/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/971908479","html_url":"https://github.com/apache/iceberg/pull/3556#issuecomment-971908479","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3556","id":971908479,"node_id":"IC_kwDOCW7NX8457iV_","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-17T19:35:05Z","updated_at":"2021-11-17T19:35:05Z","author_association":"MEMBER","body":"@electrum Are you +1? Let me know if you have any other mods","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/971908479/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/971927072","html_url":"https://github.com/apache/iceberg/issues/3566#issuecomment-971927072","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3566","id":971927072,"node_id":"IC_kwDOCW7NX8457m4g","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-17T20:01:35Z","updated_at":"2021-11-17T20:01:35Z","author_association":"MEMBER","body":"In Iceberg this is done by just issuing a delete command. Under the hood this becomes a metadata only operation.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/971927072/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/971932370","html_url":"https://github.com/apache/iceberg/issues/3483#issuecomment-971932370","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3483","id":971932370,"node_id":"IC_kwDOCW7NX8457oLS","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-17T20:06:52Z","updated_at":"2021-11-17T20:06:52Z","author_association":"MEMBER","body":"Task assigned @singhpk234 !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/971932370/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/971950077","html_url":"https://github.com/apache/iceberg/pull/3563#issuecomment-971950077","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3563","id":971950077,"node_id":"IC_kwDOCW7NX8457sf9","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-17T20:18:23Z","updated_at":"2021-11-17T20:18:23Z","author_association":"CONTRIBUTOR","body":"> Hi @kbendick , firstly thanks for your review!\r\n> \r\n> You did mention another usage scenario that I didn't think about. We generally do use an isolated spark job for compaction. So we need a spark job tells us no commit succeeded by an exception to allows us to process in time without affecting query efficiency. It is also very normal to execute compaction after writing in the same one spark job.\r\n> \r\n> Can we use a compromise method, such as adding an `allow-no-commit-succeed` configuration that defaults to `true`, and then customize it in a spark job to choose whether to throw an exception?\r\n\r\nYeah I think adding a flag to the action would be a decent compromise.  cc @RussellSpitzer on his thoughts as he's done the most work around compactions and the API for it.\r\n\r\nMy biggest concern for not just blindly throwing would be streaming ingestion, as mentioned, then followed by batch jobs that optimize as a final step.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/971950077/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/971953821","html_url":"https://github.com/apache/iceberg/pull/3556#issuecomment-971953821","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3556","id":971953821,"node_id":"IC_kwDOCW7NX8457tad","user":{"login":"electrum","id":9230,"node_id":"MDQ6VXNlcjkyMzA=","avatar_url":"https://avatars.githubusercontent.com/u/9230?v=4","gravatar_id":"","url":"https://api.github.com/users/electrum","html_url":"https://github.com/electrum","followers_url":"https://api.github.com/users/electrum/followers","following_url":"https://api.github.com/users/electrum/following{/other_user}","gists_url":"https://api.github.com/users/electrum/gists{/gist_id}","starred_url":"https://api.github.com/users/electrum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/electrum/subscriptions","organizations_url":"https://api.github.com/users/electrum/orgs","repos_url":"https://api.github.com/users/electrum/repos","events_url":"https://api.github.com/users/electrum/events{/privacy}","received_events_url":"https://api.github.com/users/electrum/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-17T20:20:48Z","updated_at":"2021-11-17T20:20:48Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer Looks good to me.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/971953821/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/971955928","html_url":"https://github.com/apache/iceberg/pull/3556#issuecomment-971955928","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3556","id":971955928,"node_id":"IC_kwDOCW7NX8457t7Y","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-17T20:22:13Z","updated_at":"2021-11-17T20:22:13Z","author_association":"MEMBER","body":"Ok thanks for review everyone! I'll merge this now","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/971955928/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/971958522","html_url":"https://github.com/apache/iceberg/pull/3556#issuecomment-971958522","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3556","id":971958522,"node_id":"IC_kwDOCW7NX8457uj6","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-17T20:23:58Z","updated_at":"2021-11-17T20:23:58Z","author_association":"MEMBER","body":"Closes #3542 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/971958522/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972006981","html_url":"https://github.com/apache/iceberg/issues/3541#issuecomment-972006981","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3541","id":972006981,"node_id":"IC_kwDOCW7NX84576ZF","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-17T20:55:25Z","updated_at":"2021-11-17T20:55:25Z","author_association":"CONTRIBUTOR","body":"From the code, it looks like returning false is allowed and will result in an error that the namespace can't be dropped because it is not empty.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972006981/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972115074","html_url":"https://github.com/apache/iceberg/pull/3375#issuecomment-972115074","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3375","id":972115074,"node_id":"IC_kwDOCW7NX8458UyC","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-17T21:59:16Z","updated_at":"2021-11-17T22:00:24Z","author_association":"MEMBER","body":"In the Datasource code in Spark3 it uses this little bit\r\n```          val filters = DataSourceStrategy.normalizeExprs(condition.toSeq, output)\r\n              .flatMap(splitConjunctivePredicates(_).map {\r\n                f => DataSourceStrategy.translateFilter(f, true).getOrElse(\r\n                  throw QueryCompilationErrors.cannotTranslateExpressionToSourceFilterError(f))\r\n              }).toArray\r\n```\r\nTo convert to Source Filters, I think this is a little simpler than reimplementing the Spark Expressions -> Iceberg Expressions directly. I just figure this way, we will have less direct dependencies on Spark code.\r\n\r\nThis is protected but it may make sense for us to expose it in our extensions for this purpose.\r\n\r\nThe relevant sections are here\r\nhttps://github.com/apache/spark/blob/master/sql/core/src/main/scala/org/apache/spark/sql/execution/datasources/DataSourceStrategy.scala#L567-L570","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972115074/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972121512","html_url":"https://github.com/apache/iceberg/pull/3487#issuecomment-972121512","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3487","id":972121512,"node_id":"IC_kwDOCW7NX8458WWo","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-17T22:03:36Z","updated_at":"2021-11-17T22:03:36Z","author_association":"MEMBER","body":"I like the icon, but I don't want to get into an Apache fight for including binary files in the release. I know sometimes this tends to rub certain folks the wrong way.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972121512/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972125255","html_url":"https://github.com/apache/iceberg/pull/3459#issuecomment-972125255","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3459","id":972125255,"node_id":"IC_kwDOCW7NX8458XRH","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-17T22:06:03Z","updated_at":"2021-11-17T22:06:03Z","author_association":"MEMBER","body":"Since you are using \r\n```          (PartitionsTable) MetadataTableUtils.createMetadataTableInstance(table, MetadataTableType.PARTITIONS);\r\n```\r\nRight now for determining the partition spec I believe you are already using the maximal spec.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972125255/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972145308","html_url":"https://github.com/apache/iceberg/pull/2932#issuecomment-972145308","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2932","id":972145308,"node_id":"IC_kwDOCW7NX8458cKc","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-17T22:19:09Z","updated_at":"2021-11-17T22:19:09Z","author_association":"MEMBER","body":"Sorry for taking so long to get to this, I think this would be worth keeping just because of how difficult it is to deal with this situation. Please update the PR and I will merge it in.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972145308/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972185905","html_url":"https://github.com/apache/iceberg/pull/3178#issuecomment-972185905","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3178","id":972185905,"node_id":"IC_kwDOCW7NX8458mEx","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-17T22:43:34Z","updated_at":"2021-11-17T22:43:34Z","author_association":"MEMBER","body":"Merging! Sorry it took me so long to get to this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972185905/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972206845","html_url":"https://github.com/apache/iceberg/pull/3557#issuecomment-972206845","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3557","id":972206845,"node_id":"IC_kwDOCW7NX8458rL9","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-17T22:53:16Z","updated_at":"2021-11-17T22:54:45Z","author_association":"CONTRIBUTOR","body":"> Should we have added tests her for mixed equality and positional deletes?\r\n\r\nIt is there. Check test `testMixedPositionAndEqualityDeletes`.\r\n\r\nThanks for the review, @RussellSpitzer. Still working on the benchmark. Will post the new commit along with the fixes for your comments. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972206845/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972252469","html_url":"https://github.com/apache/iceberg/pull/3414#issuecomment-972252469","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3414","id":972252469,"node_id":"IC_kwDOCW7NX84582U1","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-17T23:15:34Z","updated_at":"2021-11-17T23:15:34Z","author_association":"CONTRIBUTOR","body":"As Russell suggests, I'm going to merge this to get it out there. We can fine-tune it later.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972252469/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972261114","html_url":"https://github.com/apache/iceberg/pull/3376#issuecomment-972261114","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3376","id":972261114,"node_id":"IC_kwDOCW7NX84584b6","user":{"login":"mechgouki","id":8364215,"node_id":"MDQ6VXNlcjgzNjQyMTU=","avatar_url":"https://avatars.githubusercontent.com/u/8364215?v=4","gravatar_id":"","url":"https://api.github.com/users/mechgouki","html_url":"https://github.com/mechgouki","followers_url":"https://api.github.com/users/mechgouki/followers","following_url":"https://api.github.com/users/mechgouki/following{/other_user}","gists_url":"https://api.github.com/users/mechgouki/gists{/gist_id}","starred_url":"https://api.github.com/users/mechgouki/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mechgouki/subscriptions","organizations_url":"https://api.github.com/users/mechgouki/orgs","repos_url":"https://api.github.com/users/mechgouki/repos","events_url":"https://api.github.com/users/mechgouki/events{/privacy}","received_events_url":"https://api.github.com/users/mechgouki/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-17T23:21:04Z","updated_at":"2021-11-17T23:21:04Z","author_association":"NONE","body":"@rdblue Ryan, after several rounds's review with @jackye1995 , I think we are good to merge this PR. However this is a new feature for iceberg to support on-perm product, would you please help to take a look and give the green light ? I think the 0.13 window still open and we would like to get ready soon for our customers. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972261114/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972269565","html_url":"https://github.com/apache/iceberg/pull/3480#issuecomment-972269565","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3480","id":972269565,"node_id":"IC_kwDOCW7NX84586f9","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-17T23:26:46Z","updated_at":"2021-11-17T23:26:46Z","author_association":"CONTRIBUTOR","body":"Thanks, @jackye1995! Great to have this work done!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972269565/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972279217","html_url":"https://github.com/apache/iceberg/issues/3541#issuecomment-972279217","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3541","id":972279217,"node_id":"IC_kwDOCW7NX845882x","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-17T23:33:16Z","updated_at":"2021-11-17T23:33:16Z","author_association":"CONTRIBUTOR","body":"Hi @pan3793 - Thanks for reporting this!\r\n\r\nI spent some time looking into this, and it doesn't seem as though Spark exposes `CASCADE` to the interfaces that external catalogs are supposed to implement.\r\n\r\nIn fact, their javadocs _do_ say that the default behavior is to `CASCADE`, but `SupportsNamespace` doesn't capture any of the information related to cascading from `DropNamespaceExec`.\r\n\r\nEven in their tests for external catalogs, they only have a test that throws if the namespace isn't empty: https://github.com/apache/spark/blob/5c0762b5d2004464c36df353a4d483f8f57eebeb/sql/[…]/spark/sql/execution/datasources/v2/V2SessionCatalogSuite.scala\r\n\r\nThat's sort of what they're implying in the comment:\r\n\r\n```\r\n// The default behavior of `SupportsNamespace.dropNamespace()` is cascading,\r\n// so make sure the namespace to drop is empty.\r\n```\r\n\r\nEven their implementation `DropNamespaceExec` (which you posted here) doesn't seem to handle `CASCADE` behavior at all which is why they actually check and throw vs list and drop.\r\n\r\nAnd poking around the query planner, it doesn't seem to be the case that any instantiated `DropNamespace` node actually causes cascading either, at least for V2Catalog interfaces.\r\n\r\nI'm going to poke around a bit more to see if there is an easy way to get at the `CASCADE` information - but I think that their documentation is a little off, specifically for external catalogs.\r\n\r\nI will get back and confirm that. Since it's not exposed in Spark's `SupportsNamespace` interface presently, it will probably a little more difficult to get this behavior until it can be fixed upstream.\r\n\r\nBut hopefully I'm wrong and it's a simple change!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972279217/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972301903","html_url":"https://github.com/apache/iceberg/issues/3541#issuecomment-972301903","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3541","id":972301903,"node_id":"IC_kwDOCW7NX8459CZP","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-17T23:44:49Z","updated_at":"2021-11-17T23:44:49Z","author_association":"CONTRIBUTOR","body":"Ok. On further inspection, it seems that the V2SessionCatalog falls back to the V1 definition `DropDatabaseExec`:\r\n\r\nhttps://github.com/apache/spark/blob/8ab9d6327d7db20a4257f9fe6d0b17919576be5e/sql/core/src/main/scala/org/apache/spark/sql/catalyst/analysis/ResolveSessionCatalog.scala#L254-L255\r\n\r\nSo we'd likely have to inject our own analyzer rule, or get that information exposed upstream in Spark (having Spark expose it being the better choice but longer task): https://github.com/apache/spark/blob/4df40ead99f07b87e3207c9d18c1b4f1f92a3b86/sql/core/src/main/scala/org/apache/spark/sql/internal/BaseSessionStateBuilder.scala#L182-L190","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972301903/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972337885","html_url":"https://github.com/apache/iceberg/pull/3549#issuecomment-972337885","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3549","id":972337885,"node_id":"IC_kwDOCW7NX8459LLd","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-17T23:58:29Z","updated_at":"2021-11-17T23:58:29Z","author_association":"CONTRIBUTOR","body":"@hililiwei, I opened a PR against your branch to make this a bit more generic and implement my suggestions.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972337885/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972429759","html_url":"https://github.com/apache/iceberg/pull/3549#issuecomment-972429759","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3549","id":972429759,"node_id":"IC_kwDOCW7NX8459hm_","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-18T01:56:22Z","updated_at":"2021-11-18T01:56:22Z","author_association":"CONTRIBUTOR","body":"> @hililiwei, I opened a PR against your branch to make this a bit more generic and implement my suggestions.\r\n\r\nThanks for your guidance. merged.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972429759/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972439824","html_url":"https://github.com/apache/iceberg/issues/3541#issuecomment-972439824","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3541","id":972439824,"node_id":"IC_kwDOCW7NX8459kEQ","user":{"login":"pan3793","id":26535726,"node_id":"MDQ6VXNlcjI2NTM1NzI2","avatar_url":"https://avatars.githubusercontent.com/u/26535726?v=4","gravatar_id":"","url":"https://api.github.com/users/pan3793","html_url":"https://github.com/pan3793","followers_url":"https://api.github.com/users/pan3793/followers","following_url":"https://api.github.com/users/pan3793/following{/other_user}","gists_url":"https://api.github.com/users/pan3793/gists{/gist_id}","starred_url":"https://api.github.com/users/pan3793/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pan3793/subscriptions","organizations_url":"https://api.github.com/users/pan3793/orgs","repos_url":"https://api.github.com/users/pan3793/repos","events_url":"https://api.github.com/users/pan3793/events{/privacy}","received_events_url":"https://api.github.com/users/pan3793/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-18T02:17:32Z","updated_at":"2021-11-18T02:17:32Z","author_association":"MEMBER","body":"Thanks for your reply, the cascade logic is handled by `DropNamespaceExec`, I updated issue description.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972439824/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972441018","html_url":"https://github.com/apache/iceberg/pull/3186#issuecomment-972441018","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3186","id":972441018,"node_id":"IC_kwDOCW7NX8459kW6","user":{"login":"rice668","id":6520673,"node_id":"MDQ6VXNlcjY1MjA2NzM=","avatar_url":"https://avatars.githubusercontent.com/u/6520673?v=4","gravatar_id":"","url":"https://api.github.com/users/rice668","html_url":"https://github.com/rice668","followers_url":"https://api.github.com/users/rice668/followers","following_url":"https://api.github.com/users/rice668/following{/other_user}","gists_url":"https://api.github.com/users/rice668/gists{/gist_id}","starred_url":"https://api.github.com/users/rice668/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rice668/subscriptions","organizations_url":"https://api.github.com/users/rice668/orgs","repos_url":"https://api.github.com/users/rice668/repos","events_url":"https://api.github.com/users/rice668/events{/privacy}","received_events_url":"https://api.github.com/users/rice668/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-18T02:18:35Z","updated_at":"2021-11-18T02:18:35Z","author_association":"CONTRIBUTOR","body":"@rdblue Could you take a look again when you have a chance ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972441018/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972457529","html_url":"https://github.com/apache/iceberg/issues/3541#issuecomment-972457529","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3541","id":972457529,"node_id":"IC_kwDOCW7NX8459oY5","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-18T02:26:53Z","updated_at":"2021-11-18T02:26:53Z","author_association":"CONTRIBUTOR","body":"> Thanks for your reply, the cascade logic is handled by `DropNamespaceExec`, I updated issue description.\r\n\r\nAppreciate the update.\r\n\r\nUnfortunately, there's not really presently a way to access whether or not the user has set CASCADE in the query based on the interfaces that Spark provides.\r\n\r\nSpark gives us essentially the same `SupportsNamespaces` interfaces, and `dropNamespace` only provides access to the `Namespace` that the user passed.\r\n\r\nOur code (at least in the HiveCatalog) simply implements the interface Spark provides, which doesn't provide access to whether or not the `CASCADE` flag is set.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972457529/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972460374","html_url":"https://github.com/apache/iceberg/issues/3541#issuecomment-972460374","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3541","id":972460374,"node_id":"IC_kwDOCW7NX8459pFW","user":{"login":"pan3793","id":26535726,"node_id":"MDQ6VXNlcjI2NTM1NzI2","avatar_url":"https://avatars.githubusercontent.com/u/26535726?v=4","gravatar_id":"","url":"https://api.github.com/users/pan3793","html_url":"https://github.com/pan3793","followers_url":"https://api.github.com/users/pan3793/followers","following_url":"https://api.github.com/users/pan3793/following{/other_user}","gists_url":"https://api.github.com/users/pan3793/gists{/gist_id}","starred_url":"https://api.github.com/users/pan3793/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pan3793/subscriptions","organizations_url":"https://api.github.com/users/pan3793/orgs","repos_url":"https://api.github.com/users/pan3793/repos","events_url":"https://api.github.com/users/pan3793/events{/privacy}","received_events_url":"https://api.github.com/users/pan3793/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-18T02:31:45Z","updated_at":"2021-11-18T02:31:45Z","author_association":"MEMBER","body":"Spark already told us the dropNamespace should be act as `CASCADE`\r\n\r\nSpark `interface SupportsNamespaces extends CatalogPlugin`\r\n```\r\n  /**\r\n   * Drop a namespace from the catalog, **recursively dropping all objects within the namespace.**\r\n   * .....\r\n   */\r\n  boolean dropNamespace(String[] namespace) throws NoSuchNamespaceException;\r\n```\r\n\r\nAnd in `DropNamespaceExec`, Spark know the `CASCADE` flag, and handled by \r\n\r\n```\r\n      if (!cascade) {\r\n        if (catalog.asTableCatalog.listTables(ns).nonEmpty\r\n          || nsCatalog.listNamespaces(ns).nonEmpty) {\r\n          throw QueryExecutionErrors.cannotDropNonemptyNamespaceError(namespace)\r\n        }\r\n      }\r\n\r\n      if (!nsCatalog.dropNamespace(ns)) {\r\n        throw QueryExecutionErrors.cannotDropNonemptyNamespaceError(namespace)\r\n      }\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972460374/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972461318","html_url":"https://github.com/apache/iceberg/issues/3541#issuecomment-972461318","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3541","id":972461318,"node_id":"IC_kwDOCW7NX8459pUG","user":{"login":"pan3793","id":26535726,"node_id":"MDQ6VXNlcjI2NTM1NzI2","avatar_url":"https://avatars.githubusercontent.com/u/26535726?v=4","gravatar_id":"","url":"https://api.github.com/users/pan3793","html_url":"https://github.com/pan3793","followers_url":"https://api.github.com/users/pan3793/followers","following_url":"https://api.github.com/users/pan3793/following{/other_user}","gists_url":"https://api.github.com/users/pan3793/gists{/gist_id}","starred_url":"https://api.github.com/users/pan3793/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pan3793/subscriptions","organizations_url":"https://api.github.com/users/pan3793/orgs","repos_url":"https://api.github.com/users/pan3793/repos","events_url":"https://api.github.com/users/pan3793/events{/privacy}","received_events_url":"https://api.github.com/users/pan3793/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-18T02:34:17Z","updated_at":"2021-11-18T02:35:45Z","author_association":"MEMBER","body":"Seems the second `throw QueryExecutionErrors.cannotDropNonemptyNamespaceError(namespace)` is misleading","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972461318/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972463677","html_url":"https://github.com/apache/iceberg/issues/3541#issuecomment-972463677","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3541","id":972463677,"node_id":"IC_kwDOCW7NX8459p49","user":{"login":"pan3793","id":26535726,"node_id":"MDQ6VXNlcjI2NTM1NzI2","avatar_url":"https://avatars.githubusercontent.com/u/26535726?v=4","gravatar_id":"","url":"https://api.github.com/users/pan3793","html_url":"https://github.com/pan3793","followers_url":"https://api.github.com/users/pan3793/followers","following_url":"https://api.github.com/users/pan3793/following{/other_user}","gists_url":"https://api.github.com/users/pan3793/gists{/gist_id}","starred_url":"https://api.github.com/users/pan3793/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pan3793/subscriptions","organizations_url":"https://api.github.com/users/pan3793/orgs","repos_url":"https://api.github.com/users/pan3793/repos","events_url":"https://api.github.com/users/pan3793/events{/privacy}","received_events_url":"https://api.github.com/users/pan3793/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-18T02:40:45Z","updated_at":"2021-11-18T02:44:48Z","author_association":"MEMBER","body":"How about the following change in Iceberg `interface SupportsNamespaces`\r\n\r\n```\r\ndefault boolean dropNamespace(Namespace namespace) throws NamespaceNotEmptyException {\r\n    dropNamespace(namespace, false);\r\n}\r\n\r\nboolean dropNamespace(Namespace namespace, boolean cascade) throws NamespaceNotEmptyException;\r\n```\r\n\r\nAnd expose `dropNamespace(namespace, cascade=true)` to SparkCatalog","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972463677/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972466345","html_url":"https://github.com/apache/iceberg/issues/3541#issuecomment-972466345","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3541","id":972466345,"node_id":"IC_kwDOCW7NX8459qip","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-18T02:47:58Z","updated_at":"2021-11-18T02:49:17Z","author_association":"CONTRIBUTOR","body":"Yeah. That's what I mean.\r\n\r\nI know the Spark docs mention it, but they're actually the ones that even throw the exception. I did a pretty deep dive and I can see how Hive tables are able to handle it. They follow an older pathway `DropDatabaseCommand`, which relies on HMS to handle the Cascade.\r\n\r\nThe problem with the approach that you mentioned is that we still wouldn't have the ability to get the `CASCADE` information from the query. Just setting it to `true` by default is most likely not going to work for most cases. It's just not exposed in the interface that Spark provides to external catalog developers.\r\n\r\nWe'd have to implement our own antlr grammar to catch `drop table ... cascade`. That's something that could be done, but it's not a trivial amount of work necessarily.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972466345/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972467295","html_url":"https://github.com/apache/iceberg/issues/3541#issuecomment-972467295","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3541","id":972467295,"node_id":"IC_kwDOCW7NX8459qxf","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-18T02:50:20Z","updated_at":"2021-11-18T02:51:28Z","author_association":"CONTRIBUTOR","body":"I can sync up with some people in the Spark community that I know and see if there is a way to get access to whether or not that flag is set. I somewhat doubt it, but I'll do my best to find out.\r\n\r\nIf I don't get back to you in a few days, feel free to message me on the Iceberg slack 🙂","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972467295/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972468615","html_url":"https://github.com/apache/iceberg/issues/3541#issuecomment-972468615","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3541","id":972468615,"node_id":"IC_kwDOCW7NX8459rGH","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-18T02:53:48Z","updated_at":"2021-11-18T02:53:48Z","author_association":"CONTRIBUTOR","body":"May I ask too, how big of an issue is this for you in practice? What's the workflow that you use that requires Cascade support?\r\n\r\nI 100% agree it would be great to support, but it would be helpful to know your specific pain point and how you're using CASCADE in your workflows if you don't mind sharing. Is it in Dev environments to easily stand up and tear things down? Or do you use a namespace perhaps as a staging environment during your jobs?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972468615/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972473901","html_url":"https://github.com/apache/iceberg/pull/3568#issuecomment-972473901","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3568","id":972473901,"node_id":"IC_kwDOCW7NX8459sYt","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-18T03:06:24Z","updated_at":"2021-11-18T03:06:24Z","author_association":"CONTRIBUTOR","body":"#3368 was merged 3 weeks ago. @izchen I took the liberty to port it to v3.1, v3.0 and v2.4; I hope you don't mind, since you haven't done it.\r\n@kbendick @jackye1995 @rdblue this is my main concern, the follow-through.\r\nPlease see #3569 and #3570 as well.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972473901/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972477426","html_url":"https://github.com/apache/iceberg/issues/3541#issuecomment-972477426","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3541","id":972477426,"node_id":"IC_kwDOCW7NX8459tPy","user":{"login":"pan3793","id":26535726,"node_id":"MDQ6VXNlcjI2NTM1NzI2","avatar_url":"https://avatars.githubusercontent.com/u/26535726?v=4","gravatar_id":"","url":"https://api.github.com/users/pan3793","html_url":"https://github.com/pan3793","followers_url":"https://api.github.com/users/pan3793/followers","following_url":"https://api.github.com/users/pan3793/following{/other_user}","gists_url":"https://api.github.com/users/pan3793/gists{/gist_id}","starred_url":"https://api.github.com/users/pan3793/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pan3793/subscriptions","organizations_url":"https://api.github.com/users/pan3793/orgs","repos_url":"https://api.github.com/users/pan3793/repos","events_url":"https://api.github.com/users/pan3793/events{/privacy}","received_events_url":"https://api.github.com/users/pan3793/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-18T03:13:44Z","updated_at":"2021-11-18T03:13:44Z","author_association":"MEMBER","body":"> The problem with the approach that you mentioned is that we still wouldn't have the ability to get the CASCADE information from the query.\r\n\r\nI can't agree. Spark already handled the nonempty detection, an exception will throw if drop a nonempty database without CASCADE. Why Iceberg need to know the CASCADE flag?\r\n```\r\n      if (!cascade) {\r\n        if (catalog.asTableCatalog.listTables(ns).nonEmpty\r\n          || nsCatalog.listNamespaces(ns).nonEmpty) {\r\n          throw QueryExecutionErrors.cannotDropNonemptyNamespaceError(namespace)\r\n        }\r\n      }\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972477426/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972479067","html_url":"https://github.com/apache/iceberg/issues/3541#issuecomment-972479067","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3541","id":972479067,"node_id":"IC_kwDOCW7NX8459tpb","user":{"login":"pan3793","id":26535726,"node_id":"MDQ6VXNlcjI2NTM1NzI2","avatar_url":"https://avatars.githubusercontent.com/u/26535726?v=4","gravatar_id":"","url":"https://api.github.com/users/pan3793","html_url":"https://github.com/pan3793","followers_url":"https://api.github.com/users/pan3793/followers","following_url":"https://api.github.com/users/pan3793/following{/other_user}","gists_url":"https://api.github.com/users/pan3793/gists{/gist_id}","starred_url":"https://api.github.com/users/pan3793/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pan3793/subscriptions","organizations_url":"https://api.github.com/users/pan3793/orgs","repos_url":"https://api.github.com/users/pan3793/repos","events_url":"https://api.github.com/users/pan3793/events{/privacy}","received_events_url":"https://api.github.com/users/pan3793/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-18T03:16:37Z","updated_at":"2021-11-18T03:16:59Z","author_association":"MEMBER","body":"> May I ask too, how big of an issue is this for you in practice? What's the workflow that you use that requires Cascade support?\r\n\r\nI encounter this issue when change the TPCDS test suite from Delta table format to Iceberg. The drop database cascade sql works with delta but failed in iceberg.\r\n\r\nhttps://github.com/apache/incubator-kyuubi/blob/2baabf46cacf745e5ceaf78192f9f2359dc9e477/kyuubi-server/src/test/scala/org/apache/kyuubi/operation/tpcds/OutputSchemaTPCDSSuite.scala#L70","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972479067/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972480717","html_url":"https://github.com/apache/iceberg/issues/3541#issuecomment-972480717","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3541","id":972480717,"node_id":"IC_kwDOCW7NX8459uDN","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-18T03:18:05Z","updated_at":"2021-11-18T03:18:05Z","author_association":"CONTRIBUTOR","body":"Spark has access to that information, but presently it just throws an exception after doing the lists.\r\n\r\nSo if it was changed on the spark side to list the tables and drop them if `cascade` is used, Iceberg wouldn't need to know at all.\r\n\r\nBut unfortunately that's not what Spark does. I'll try syncing up with some folks that are more deeply integrated with the core Spark community to see if something can be done, but I'm not super confident much will come from it. At least not very quickly.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972480717/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972483927","html_url":"https://github.com/apache/iceberg/issues/3541#issuecomment-972483927","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3541","id":972483927,"node_id":"IC_kwDOCW7NX8459u1X","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-18T03:22:27Z","updated_at":"2021-11-18T03:23:16Z","author_association":"CONTRIBUTOR","body":"If you have further ideas (or even better, a PR), I'm definitely open to hearing them as I'd love to get this fixed. As I said, I'll try to reach out to some contacts who might be able to shed more insight.\r\n\r\nIf Spark even threw a different exception based on Cascade, we could catch it and then delete everything and retry. But the exception is the same whether cascade flag is used or not.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972483927/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972486537","html_url":"https://github.com/apache/iceberg/pull/3568#issuecomment-972486537","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3568","id":972486537,"node_id":"IC_kwDOCW7NX8459veJ","user":{"login":"izchen","id":67534059,"node_id":"MDQ6VXNlcjY3NTM0MDU5","avatar_url":"https://avatars.githubusercontent.com/u/67534059?v=4","gravatar_id":"","url":"https://api.github.com/users/izchen","html_url":"https://github.com/izchen","followers_url":"https://api.github.com/users/izchen/followers","following_url":"https://api.github.com/users/izchen/following{/other_user}","gists_url":"https://api.github.com/users/izchen/gists{/gist_id}","starred_url":"https://api.github.com/users/izchen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/izchen/subscriptions","organizations_url":"https://api.github.com/users/izchen/orgs","repos_url":"https://api.github.com/users/izchen/repos","events_url":"https://api.github.com/users/izchen/events{/privacy}","received_events_url":"https://api.github.com/users/izchen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-18T03:29:41Z","updated_at":"2021-11-18T03:29:41Z","author_association":"CONTRIBUTOR","body":"Thanks for your contribution @wypoon!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972486537/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972488054","html_url":"https://github.com/apache/iceberg/issues/3541#issuecomment-972488054","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3541","id":972488054,"node_id":"IC_kwDOCW7NX8459v12","user":{"login":"pan3793","id":26535726,"node_id":"MDQ6VXNlcjI2NTM1NzI2","avatar_url":"https://avatars.githubusercontent.com/u/26535726?v=4","gravatar_id":"","url":"https://api.github.com/users/pan3793","html_url":"https://github.com/pan3793","followers_url":"https://api.github.com/users/pan3793/followers","following_url":"https://api.github.com/users/pan3793/following{/other_user}","gists_url":"https://api.github.com/users/pan3793/gists{/gist_id}","starred_url":"https://api.github.com/users/pan3793/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pan3793/subscriptions","organizations_url":"https://api.github.com/users/pan3793/orgs","repos_url":"https://api.github.com/users/pan3793/repos","events_url":"https://api.github.com/users/pan3793/events{/privacy}","received_events_url":"https://api.github.com/users/pan3793/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-18T03:33:55Z","updated_at":"2021-11-18T03:33:55Z","author_association":"MEMBER","body":"The original PR https://github.com/apache/spark/pull/26476 description shows the design is for performance purpose.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972488054/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972491425","html_url":"https://github.com/apache/iceberg/issues/3541#issuecomment-972491425","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3541","id":972491425,"node_id":"IC_kwDOCW7NX8459wqh","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-18T03:42:27Z","updated_at":"2021-11-18T03:42:27Z","author_association":"CONTRIBUTOR","body":"Oh cool. This is a bit more promising. I'll try to take a look and see how these tests are working.\r\n\r\nI didn't come across these tests surprisingly, even when I opened it up in intellij and did code search etc.\r\n\r\nI'd also gladly review a PR if you happen to have time. I'll try to sort through how their `foo` data source is using Cascade, but I won't necessarily have time to implement it if it's complicated.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972491425/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972507377","html_url":"https://github.com/apache/iceberg/pull/3565#issuecomment-972507377","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3565","id":972507377,"node_id":"IC_kwDOCW7NX84590jx","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-18T04:03:38Z","updated_at":"2021-11-18T04:03:38Z","author_association":"CONTRIBUTOR","body":"Okay, I did a quick benchmark and the new approach does give us a 8x improvement but the current call even on a schema with 1k columns completes in a millisecond. Taking this into account, I don't think it is reasonable to complicate things. I am closing this PR.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972507377/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972527012","html_url":"https://github.com/apache/iceberg/pull/3572#issuecomment-972527012","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3572","id":972527012,"node_id":"IC_kwDOCW7NX84595Wk","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-18T04:25:34Z","updated_at":"2021-11-18T04:25:46Z","author_association":"CONTRIBUTOR","body":"cc @samarthjain @flyrain @RussellSpitzer @rdblue @nastra @rymurr ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972527012/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972545821","html_url":"https://github.com/apache/iceberg/issues/3541#issuecomment-972545821","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3541","id":972545821,"node_id":"IC_kwDOCW7NX845998d","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-18T05:13:46Z","updated_at":"2021-11-18T05:13:46Z","author_association":"CONTRIBUTOR","body":"One last question @pan3793.\r\n\r\nWhich catalog are you using? It might eventually make a difference so if I can be testing it from that point of view that would be preferable.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972545821/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972553046","html_url":"https://github.com/apache/iceberg/pull/3375#issuecomment-972553046","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3375","id":972553046,"node_id":"IC_kwDOCW7NX8459_tW","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-18T05:32:03Z","updated_at":"2021-11-18T05:32:03Z","author_association":"MEMBER","body":"@RussellSpitzer \r\n\r\n>The relevant sections are here\r\nhttps://github.com/apache/spark/blob/master/sql/core/src/main/scala/org/apache/spark/sql/execution/datasources/DataSourceStrategy.scala#L567-L570\r\n\r\nThis worked. Thank you so much. I have pushed this change. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972553046/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972560879","html_url":"https://github.com/apache/iceberg/pull/3572#issuecomment-972560879","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3572","id":972560879,"node_id":"IC_kwDOCW7NX845-Bnv","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-18T05:54:03Z","updated_at":"2021-11-18T05:56:34Z","author_association":"CONTRIBUTOR","body":"I think it makes sense to close `vec` in class `VectorizedArrowReader`. `vec` is a private filed and initialized inside the class, for example, here, https://github.com/apache/iceberg/blob/d6cbca0c2fb3d10083b304bcbdf16bf51e3b586b/arrow/src/main/java/org/apache/iceberg/arrow/vectorized/VectorizedArrowReader.java#L304\r\n\r\nWe should close it inside the class as well.\r\nInstead of removing the close logic in class `VectorizedArrowReader`, I'd recommend to use `reader::close` instead of `vectorHolders::close` in the method `BaseBatchReader::closeVectors`\r\nhttps://github.com/apache/iceberg/blob/d6cbca0c2fb3d10083b304bcbdf16bf51e3b586b/arrow/src/main/java/org/apache/iceberg/arrow/vectorized/BaseBatchReader.java#L55","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972560879/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972563540","html_url":"https://github.com/apache/iceberg/issues/3541#issuecomment-972563540","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3541","id":972563540,"node_id":"IC_kwDOCW7NX845-CRU","user":{"login":"pan3793","id":26535726,"node_id":"MDQ6VXNlcjI2NTM1NzI2","avatar_url":"https://avatars.githubusercontent.com/u/26535726?v=4","gravatar_id":"","url":"https://api.github.com/users/pan3793","html_url":"https://github.com/pan3793","followers_url":"https://api.github.com/users/pan3793/followers","following_url":"https://api.github.com/users/pan3793/following{/other_user}","gists_url":"https://api.github.com/users/pan3793/gists{/gist_id}","starred_url":"https://api.github.com/users/pan3793/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pan3793/subscriptions","organizations_url":"https://api.github.com/users/pan3793/orgs","repos_url":"https://api.github.com/users/pan3793/repos","events_url":"https://api.github.com/users/pan3793/events{/privacy}","received_events_url":"https://api.github.com/users/pan3793/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-18T06:00:51Z","updated_at":"2021-11-18T06:00:51Z","author_association":"MEMBER","body":"`HadoopCatalog`","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972563540/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972575604","html_url":"https://github.com/apache/iceberg/issues/3541#issuecomment-972575604","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3541","id":972575604,"node_id":"IC_kwDOCW7NX845-FN0","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-18T06:26:21Z","updated_at":"2021-11-18T06:26:21Z","author_association":"CONTRIBUTOR","body":"Ok. Well, I think I've mostly figured it out.\r\n\r\nSo the contract says that things should `CASCADE` by default. Which is why it's not exposed to Iceberg or other connectors.\r\n\r\nAll of the tests that I've found which use `CASCADE` use the `InMemoryTableCatalog`. The `InMemoryTableCatalog` does in fact list all namespaces and things and drops them by default.\r\nhttps://github.com/apache/spark/blob/e99fdf9654481dd9b691a3c10e52f3f3db6ed2ba/sql/catalyst/src/test/scala/org/apache/spark/sql/connector/catalog/InMemoryTableCatalog.scala#L216-L224\r\n\r\nIt seems to be that the contract is supposed to be that people who implement `dropNamespace` are supposed to eagerly cascade. I will look into this more (as its getting late for me and its been a long day), but if there is danger of corrupting people's data or accidentally allowing people to drop large things they didn't intend to, then that's probably something that's going to need to be discussed.\r\n\r\nI've talked to a decent number of people at several different large organizations that use Spark, and it's pretty rare for very large organizations to even let their users actually purge data. As often times, users want that data back within a few days or so or they didn't intend to delete it at all.\r\n\r\nSo that at least accounts for how the existing tests which have `cascade` in them work. Because of that `InMemoryTableCatalog`, which does list and drop everything. It seems that for performance reasons, they've offloaded the work of listing and dropping from spark to the individual catalog implementations.\r\n\r\nSo we'll see. If it's possible to have `cascade` and still be safe for the underlying data - meaning that the `RESTRICT` keyword isn't required, then I'm definitely very much in favor of it.\r\n\r\nIt's too bad they don't allow for seeing if the flag is set or not, as listing is also expensive for us if each individual call is going to wind up getting ultimately rejected.\r\n\r\nBut that `InMemoryTableCatalog` should provide some hints on how they have cascade working.\r\n\r\nThe reason that I worry it might not be safe for us, is that for our implementation of `HiveCatalog`, we have to pass `cascade` directly to the Hive Metastore Client: https://github.com/apache/iceberg/blob/f68d8d426661efc0d7e5686fe833b573b74eadab/hive-metastore/src/main/java/org/apache/iceberg/hive/HiveCatalog.java#L271-L284\r\n\r\nSo I don't think that would go through Spark, which assumes it has control over it.\r\n\r\nAgain, I'd love to be wrong. So if you can come up with a PR that works and doesn't require people to use `RESTRICT` and doesn't simply always cascade, regardless of what the user puts, I'd 100% sign off on that.\r\n\r\nI'll also try to find time to play around and see if I can get it to work that way. Hopefully it's something that we can make work, but Spark does seem to assume that all of the interactions with Hive go through it and that's not necessarily true for us as far as I can tell because of our implementation of `HiveCatalog` (as we interact with a large number of systems, not just Spark).\r\n\r\nThis would all be a lot easier if Spark exposed whether or not the user had entered `cascade` into the query for us. But if we can make this work, then I'd love to get this fixed. 🙂 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972575604/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972580106","html_url":"https://github.com/apache/iceberg/issues/3541#issuecomment-972580106","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3541","id":972580106,"node_id":"IC_kwDOCW7NX845-GUK","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-18T06:37:15Z","updated_at":"2021-11-18T06:37:15Z","author_association":"CONTRIBUTOR","body":"Actually, I started playing around with it and we might get lucky and it might not be as bad as I thought.\r\n\r\nIf you don't hear from me in the next few days, feel free to reach out on the Iceberg Slack. 🙂 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/972580106/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]