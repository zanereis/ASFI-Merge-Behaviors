[{"url":"https://api.github.com/repos/apache/solr/issues/comments/1349417190","html_url":"https://github.com/apache/solr/pull/1237#issuecomment-1349417190","issue_url":"https://api.github.com/repos/apache/solr/issues/1237","id":1349417190,"node_id":"IC_kwDOFFj3yM5Qbnjm","user":{"login":"magibney","id":6225104,"node_id":"MDQ6VXNlcjYyMjUxMDQ=","avatar_url":"https://avatars.githubusercontent.com/u/6225104?v=4","gravatar_id":"","url":"https://api.github.com/users/magibney","html_url":"https://github.com/magibney","followers_url":"https://api.github.com/users/magibney/followers","following_url":"https://api.github.com/users/magibney/following{/other_user}","gists_url":"https://api.github.com/users/magibney/gists{/gist_id}","starred_url":"https://api.github.com/users/magibney/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/magibney/subscriptions","organizations_url":"https://api.github.com/users/magibney/orgs","repos_url":"https://api.github.com/users/magibney/repos","events_url":"https://api.github.com/users/magibney/events{/privacy}","received_events_url":"https://api.github.com/users/magibney/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-13T18:18:45Z","updated_at":"2022-12-13T18:18:45Z","author_association":"CONTRIBUTOR","body":"Doesn't [this](https://github.com/apache/solr/blob/6869ec97c7a59cc6acd001eb592b98ea90679fb8/solr/core/src/java/org/apache/solr/core/SolrCore.java#L2861-L2864) allow to achieve essentially the same thing (pre-logging requests), by configuring logging to:\r\n\r\n```\r\norg.apache.solr.core.SolrCore.Request=DEBUG\r\n```","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1349417190/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1349463963","html_url":"https://github.com/apache/solr/pull/1223#issuecomment-1349463963","issue_url":"https://api.github.com/repos/apache/solr/issues/1223","id":1349463963,"node_id":"IC_kwDOFFj3yM5Qby-b","user":{"login":"risdenk","id":3384157,"node_id":"MDQ6VXNlcjMzODQxNTc=","avatar_url":"https://avatars.githubusercontent.com/u/3384157?v=4","gravatar_id":"","url":"https://api.github.com/users/risdenk","html_url":"https://github.com/risdenk","followers_url":"https://api.github.com/users/risdenk/followers","following_url":"https://api.github.com/users/risdenk/following{/other_user}","gists_url":"https://api.github.com/users/risdenk/gists{/gist_id}","starred_url":"https://api.github.com/users/risdenk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/risdenk/subscriptions","organizations_url":"https://api.github.com/users/risdenk/orgs","repos_url":"https://api.github.com/users/risdenk/repos","events_url":"https://api.github.com/users/risdenk/events{/privacy}","received_events_url":"https://api.github.com/users/risdenk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-13T18:23:14Z","updated_at":"2022-12-13T18:26:27Z","author_association":"CONTRIBUTOR","body":"Well since `solr/bin/*` are the only files involved. That helps narrow it down considerably. I would guess its one of these changes...\r\n\r\n```\r\n# git log branch_9_1..branch_9x -- solr/bin/solr\r\ncommit 586c80a3b876b338ae71599737da27b6ad3fed57\r\nAuthor: Kevin Risden <risdenk@users.noreply.github.com>\r\nDate:   Fri Oct 28 12:21:50 2022 -0400\r\n\r\n    SOLR-16500: Added --enable-preview for JDK 19 to enable MemorySegment support in MMapDirectory (#1142)\r\n\r\ncommit 6ddfcc841b2f78fc481547b618c277eeafbfad1c\r\nAuthor: Houston Putman <houston@apache.org>\r\nDate:   Thu Oct 20 11:58:47 2022 -0400\r\n\r\n    SOLR-16482: Add internal envVar for passing opts to solr/bin (#1096)\r\n    \r\n    The name of the envVar is SOLR_OPTS_INTERNAL\r\n    \r\n    (cherry picked from commit fabdc8e836264f309c0224ef190abe13bb749641)\r\n\r\ncommit a4307dabde6f776bf4657d73ea8a52ca1e7b51a4\r\nAuthor: Jan HÃ¸ydahl <janhoy@users.noreply.github.com>\r\nDate:   Thu Oct 20 09:54:32 2022 +0200\r\n\r\n    SOLR-16463: Workaround for serious crash on JDK17+ (#1090)\r\n\r\ncommit 0a334bda7ea40d5c11195fa5ce33d16c21d0504e\r\nAuthor: Shawn Heisey <elyograg@apache.org>\r\nDate:   Sun Oct 16 13:40:49 2022 -0600\r\n\r\n    SOLR-8803 Solr now crashes on OOME for all supported platforms.\r\n\r\ncommit f9a8b1997fcf78ac44c0b5e64307ff23b54dcd99\r\nAuthor: Kevin Risden <risdenk@users.noreply.github.com>\r\nDate:   Wed Oct 12 12:11:26 2022 -0400\r\n\r\n    SOLR-16457: solr.data.home should not be set to empty string in bin/solr (#1066)\r\n```\r\n\r\nwhich is really just a few lines different:\r\n\r\n```\r\n# git diff branch_9_1..branch_9x -- solr/bin/solr\r\ndiff --git a/solr/bin/solr b/solr/bin/solr\r\nindex eed0272eb32..704efcb724f 100755\r\n--- a/solr/bin/solr\r\n+++ b/solr/bin/solr\r\n@@ -2230,6 +2230,7 @@ function start_solr() {\r\n     fi\r\n \r\n     if [ -n \"${SOLR_DATA_HOME:-}\" ]; then\r\n+      SOLR_OPTS+=(\"-Dsolr.data.home=$SOLR_DATA_HOME\")\r\n       echo -e \"    SOLR_DATA_HOME  = $SOLR_DATA_HOME\"\r\n     fi\r\n     echo\r\n@@ -2249,14 +2250,22 @@ function start_solr() {\r\n     echo \"Java $JAVA_VER_NUM detected. Enabled workaround for SOLR-16463\"\r\n   fi\r\n \r\n+  # Added --enable-preview for JDK 19 to enable MemorySegment support in MMapDirectory, see https://issues.apache.org/jira/browse/SOLR-16500\r\n+  if [[ \"$JAVA_VER_NUM\" -eq \"19\" ]] ; then\r\n+    SOLR_OPTS+=(\"--enable-preview\")\r\n+    echo \"Java $JAVA_VER_NUM detected. Added --enable-preview to enable MemorySegment support in MMapDirectory. See SOLR-16500\"\r\n+  fi\r\n+\r\n   SOLR_START_OPTS=('-server' \"${JAVA_MEM_OPTS[@]}\" \"${GC_TUNE[@]}\" \"${GC_LOG_OPTS[@]}\" \"${IP_ACL_OPTS[@]}\" \\\r\n     \"${REMOTE_JMX_OPTS[@]}\" \"${CLOUD_MODE_OPTS[@]}\" ${SOLR_LOG_LEVEL_OPT:-} -Dsolr.log.dir=\"$SOLR_LOGS_DIR\" \\\r\n     \"-Djetty.port=$SOLR_PORT\" \"-DSTOP.PORT=$stop_port\" \"-DSTOP.KEY=$STOP_KEY\" \\\r\n     # '-OmitStackTraceInFastThrow' ensures stack traces in errors,\r\n     # users who don't care about useful error msgs can override in SOLR_OPTS with +OmitStackTraceInFastThrow\r\n     \"${SOLR_HOST_ARG[@]}\" \"-Duser.timezone=$SOLR_TIMEZONE\" \"-XX:-OmitStackTraceInFastThrow\" \\\r\n-    \"-XX:OnOutOfMemoryError=$SOLR_TIP/bin/oom_solr.sh $SOLR_PORT $SOLR_LOGS_DIR\" \\\r\n-    \"-Djetty.home=$SOLR_SERVER_DIR\" \"-Dsolr.solr.home=$SOLR_HOME\" \"-Dsolr.data.home=${SOLR_DATA_HOME:-}\" \"-Dsolr.install.dir=$SOLR_TIP\" \\\r\n+    # '+CrashOnOutOfMemoryError' ensures that Solr crashes whenever\r\n+    # OOME is thrown. Program operation after OOME is unpredictable.\r\n+    \"-XX:+CrashOnOutOfMemoryError\" \"-XX:ErrorFile=${SOLR_LOGS_DIR}/jvm_crash_%p.log\" \\\r\n+    \"-Djetty.home=$SOLR_SERVER_DIR\" \"-Dsolr.solr.home=$SOLR_HOME\" \"-Dsolr.install.dir=$SOLR_TIP\" \\\r\n     \"-Dsolr.default.confdir=$DEFAULT_CONFDIR\" \"${LOG4J_CONFIG[@]}\" \"${SOLR_OPTS[@]}\" \"${SECURITY_MANAGER_OPTS[@]}\" \"${SOLR_ADMIN_UI}\")\r\n \r\n   mk_writable_dir \"$SOLR_LOGS_DIR\" \"Logs\"\r\n```","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1349463963/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1349496980","html_url":"https://github.com/apache/solr/pull/1223#issuecomment-1349496980","issue_url":"https://api.github.com/repos/apache/solr/issues/1223","id":1349496980,"node_id":"IC_kwDOFFj3yM5Qb7CU","user":{"login":"risdenk","id":3384157,"node_id":"MDQ6VXNlcjMzODQxNTc=","avatar_url":"https://avatars.githubusercontent.com/u/3384157?v=4","gravatar_id":"","url":"https://api.github.com/users/risdenk","html_url":"https://github.com/risdenk","followers_url":"https://api.github.com/users/risdenk/followers","following_url":"https://api.github.com/users/risdenk/following{/other_user}","gists_url":"https://api.github.com/users/risdenk/gists{/gist_id}","starred_url":"https://api.github.com/users/risdenk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/risdenk/subscriptions","organizations_url":"https://api.github.com/users/risdenk/orgs","repos_url":"https://api.github.com/users/risdenk/repos","events_url":"https://api.github.com/users/risdenk/events{/privacy}","received_events_url":"https://api.github.com/users/risdenk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-13T18:34:27Z","updated_at":"2022-12-13T18:34:27Z","author_association":"CONTRIBUTOR","body":"So @janhoy can you sanity check me - at the bottom of https://github.com/apache/solr/actions/runs/3658565463 are the logs from the integration test run. \r\n\r\nI don't see in `solr.log` or `solr-7574-console.log` anything about Solr shutting down or even attempting to. \r\n\r\nThe last log line is:\r\n\r\n```\r\n2022-12-09 15:21:31.061 INFO  (main) [] o.e.j.s.Server Started Server@3ef41c66{STARTING}[10.0.12,sto=0] @5791ms\r\n```\r\n\r\nwhich is a full 3 minutes (180s as expected) before its killed based on https://github.com/apache/solr/actions/runs/3658565463/jobs/6183511889 \r\n\r\n```\r\n#   Sending stop command to Solr running on port 7574 ... waiting up to 180 seconds to allow Jetty process 2392 to stop gracefully.\r\n#    [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b [|]  \b\b\b\b\b\b [/]  \b\b\b\b\b\b [-]  \b\b\b\b\b\b [\\]  \b\b\b\b\b\b    \b\b\b\bSolr process 2392 is still running; jstacking it now.\r\n#   2022-12-09 15:24:33\r\n```\r\n\r\nI would have expected solr log to have SOMETHING about shutting down.","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1349496980/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1349536907","html_url":"https://github.com/apache/solr/pull/1237#issuecomment-1349536907","issue_url":"https://api.github.com/repos/apache/solr/issues/1237","id":1349536907,"node_id":"IC_kwDOFFj3yM5QcEyL","user":{"login":"patsonluk","id":2895902,"node_id":"MDQ6VXNlcjI4OTU5MDI=","avatar_url":"https://avatars.githubusercontent.com/u/2895902?v=4","gravatar_id":"","url":"https://api.github.com/users/patsonluk","html_url":"https://github.com/patsonluk","followers_url":"https://api.github.com/users/patsonluk/followers","following_url":"https://api.github.com/users/patsonluk/following{/other_user}","gists_url":"https://api.github.com/users/patsonluk/gists{/gist_id}","starred_url":"https://api.github.com/users/patsonluk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/patsonluk/subscriptions","organizations_url":"https://api.github.com/users/patsonluk/orgs","repos_url":"https://api.github.com/users/patsonluk/repos","events_url":"https://api.github.com/users/patsonluk/events{/privacy}","received_events_url":"https://api.github.com/users/patsonluk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-13T19:07:08Z","updated_at":"2022-12-13T19:36:08Z","author_association":"CONTRIBUTOR","body":"> Doesn't [this](https://github.com/apache/solr/blob/6869ec97c7a59cc6acd001eb592b98ea90679fb8/solr/core/src/java/org/apache/solr/core/SolrCore.java#L2861-L2864) allow to achieve essentially the same thing (pre-logging requests), by configuring logging to:\r\n> \r\n> ```\r\n> org.apache.solr.core.SolrCore.Request=DEBUG\r\n> ```\r\n\r\nThat's a good point @magibney ! I guess for our own usage, we were having issues with Search queries in particular and didn't want to enable debug for SolrCore for that, which could create quite a bit of noise. \r\n\r\nHowever, from general Solr perspective, it does not bring much values to have 2 different debug pieces with very similar info. The scope difference - `SolrCore.Request` vs `SearchHandler` probably does not warrant the extra change. I will keep the change to our own local version, and retract this PR for now.\r\n\r\nThank you for all the comments and help!","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1349536907/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1349607818","html_url":"https://github.com/apache/solr/pull/1223#issuecomment-1349607818","issue_url":"https://api.github.com/repos/apache/solr/issues/1223","id":1349607818,"node_id":"IC_kwDOFFj3yM5QcWGK","user":{"login":"risdenk","id":3384157,"node_id":"MDQ6VXNlcjMzODQxNTc=","avatar_url":"https://avatars.githubusercontent.com/u/3384157?v=4","gravatar_id":"","url":"https://api.github.com/users/risdenk","html_url":"https://github.com/risdenk","followers_url":"https://api.github.com/users/risdenk/followers","following_url":"https://api.github.com/users/risdenk/following{/other_user}","gists_url":"https://api.github.com/users/risdenk/gists{/gist_id}","starred_url":"https://api.github.com/users/risdenk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/risdenk/subscriptions","organizations_url":"https://api.github.com/users/risdenk/orgs","repos_url":"https://api.github.com/users/risdenk/repos","events_url":"https://api.github.com/users/risdenk/events{/privacy}","received_events_url":"https://api.github.com/users/risdenk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-13T19:55:43Z","updated_at":"2022-12-13T19:55:43Z","author_association":"CONTRIBUTOR","body":"added some debug to see what https://github.com/apache/solr/pull/1223/commits/94d229c2e0ca3698590c9be51acfa143a190f362 is running.\r\n\r\nI would guess the failure is line 850 though since it does `|| true`\r\n\r\nthere must be some failure in Java stop script that doesn't log","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1349607818/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1349677713","html_url":"https://github.com/apache/solr/pull/1223#issuecomment-1349677713","issue_url":"https://api.github.com/repos/apache/solr/issues/1223","id":1349677713,"node_id":"IC_kwDOFFj3yM5QcnKR","user":{"login":"risdenk","id":3384157,"node_id":"MDQ6VXNlcjMzODQxNTc=","avatar_url":"https://avatars.githubusercontent.com/u/3384157?v=4","gravatar_id":"","url":"https://api.github.com/users/risdenk","html_url":"https://github.com/risdenk","followers_url":"https://api.github.com/users/risdenk/followers","following_url":"https://api.github.com/users/risdenk/following{/other_user}","gists_url":"https://api.github.com/users/risdenk/gists{/gist_id}","starred_url":"https://api.github.com/users/risdenk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/risdenk/subscriptions","organizations_url":"https://api.github.com/users/risdenk/orgs","repos_url":"https://api.github.com/users/risdenk/repos","events_url":"https://api.github.com/users/risdenk/events{/privacy}","received_events_url":"https://api.github.com/users/risdenk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-13T20:55:56Z","updated_at":"2022-12-13T20:55:56Z","author_association":"CONTRIBUTOR","body":"@janhoy https://github.com/apache/solr/pull/1223/commits/b6d814aace03837fcc61e2aa2f4315b93610487b may have fixed it! I wonder if its a Jetty 10.x change...\r\n\r\nI'm looking into https://github.com/apache/solr/pull/1223/commits/6b9e7ecd7c27d2eab491674023f8be2a84374eff as well.","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1349677713/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1349683700","html_url":"https://github.com/apache/solr/pull/1223#issuecomment-1349683700","issue_url":"https://api.github.com/repos/apache/solr/issues/1223","id":1349683700,"node_id":"IC_kwDOFFj3yM5Qcon0","user":{"login":"janhoy","id":409128,"node_id":"MDQ6VXNlcjQwOTEyOA==","avatar_url":"https://avatars.githubusercontent.com/u/409128?v=4","gravatar_id":"","url":"https://api.github.com/users/janhoy","html_url":"https://github.com/janhoy","followers_url":"https://api.github.com/users/janhoy/followers","following_url":"https://api.github.com/users/janhoy/following{/other_user}","gists_url":"https://api.github.com/users/janhoy/gists{/gist_id}","starred_url":"https://api.github.com/users/janhoy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janhoy/subscriptions","organizations_url":"https://api.github.com/users/janhoy/orgs","repos_url":"https://api.github.com/users/janhoy/repos","events_url":"https://api.github.com/users/janhoy/events{/privacy}","received_events_url":"https://api.github.com/users/janhoy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-13T21:01:59Z","updated_at":"2022-12-13T21:01:59Z","author_association":"CONTRIBUTOR","body":"Yes, I was just looking into the same...","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1349683700/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1349704824","html_url":"https://github.com/apache/solr/pull/1223#issuecomment-1349704824","issue_url":"https://api.github.com/repos/apache/solr/issues/1223","id":1349704824,"node_id":"IC_kwDOFFj3yM5Qctx4","user":{"login":"janhoy","id":409128,"node_id":"MDQ6VXNlcjQwOTEyOA==","avatar_url":"https://avatars.githubusercontent.com/u/409128?v=4","gravatar_id":"","url":"https://api.github.com/users/janhoy","html_url":"https://github.com/janhoy","followers_url":"https://api.github.com/users/janhoy/followers","following_url":"https://api.github.com/users/janhoy/following{/other_user}","gists_url":"https://api.github.com/users/janhoy/gists{/gist_id}","starred_url":"https://api.github.com/users/janhoy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janhoy/subscriptions","organizations_url":"https://api.github.com/users/janhoy/orgs","repos_url":"https://api.github.com/users/janhoy/repos","events_url":"https://api.github.com/users/janhoy/events{/privacy}","received_events_url":"https://api.github.com/users/janhoy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-13T21:15:54Z","updated_at":"2022-12-13T21:15:54Z","author_association":"CONTRIBUTOR","body":"I reproduced this locally in Docker:\r\n\r\n```bash\r\ndocker run --rm -ti apache/solr-nightly:10.0.0-SNAPSHOT bash\r\nUnable to find image 'apache/solr-nightly:10.0.0-SNAPSHOT' locally\r\n10.0.0-SNAPSHOT: Pulling from apache/solr-nightly\r\nDigest: sha256:df810e8fc7b81238f1339a9267ab3e0689a9295cb031776e8a8c9c5ba68dbdd3\r\nStatus: Downloaded newer image for apache/solr-nightly:10.0.0-SNAPSHOT\r\nWARNING: The requested image's platform (linux/amd64) does not match the detected host platform (linux/arm64/v8) and no specific platform was requested\r\nsolr@00c425e5b1ca:/opt/solr-10.0.0-SNAPSHOT$ solr start -p 7000\r\nJava 17 detected. Enabled workaround for SOLR-16463\r\nWaiting up to 180 seconds to see Solr running on port 7000 [-]  \r\nStarted Solr server on port 7000 (pid=127). Happy searching!\r\n\r\nsolr@00c425e5b1ca:/opt/solr-10.0.0-SNAPSHOT$ solr stop -V -p 7000\r\nUsing Solr root directory: /opt/solr\r\nUsing Java: /opt/java/openjdk/bin/java\r\nopenjdk version \"17.0.5\" 2022-10-18\r\nOpenJDK Runtime Environment Temurin-17.0.5+8 (build 17.0.5+8)\r\nOpenJDK 64-Bit Server VM Temurin-17.0.5+8 (build 17.0.5+8, mixed mode, sharing)\r\nSending stop command to Solr running on port 7000 ... waiting up to 180 seconds to allow Jetty process 127 to stop gracefully.\r\nSolr process 127 is still running; jattach threaddumping it now.\r\nCould not start attach mechanism: No such file or directory\r\nSolr process 127 is still running; forcefully killing it now.\r\nKilled process 127\r\nsolr@00c425e5b1ca:/opt/solr-10.0.0-SNAPSHOT$ \r\n```","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1349704824/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1349704893","html_url":"https://github.com/apache/solr/pull/1223#issuecomment-1349704893","issue_url":"https://api.github.com/repos/apache/solr/issues/1223","id":1349704893,"node_id":"IC_kwDOFFj3yM5Qcty9","user":{"login":"risdenk","id":3384157,"node_id":"MDQ6VXNlcjMzODQxNTc=","avatar_url":"https://avatars.githubusercontent.com/u/3384157?v=4","gravatar_id":"","url":"https://api.github.com/users/risdenk","html_url":"https://github.com/risdenk","followers_url":"https://api.github.com/users/risdenk/followers","following_url":"https://api.github.com/users/risdenk/following{/other_user}","gists_url":"https://api.github.com/users/risdenk/gists{/gist_id}","starred_url":"https://api.github.com/users/risdenk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/risdenk/subscriptions","organizations_url":"https://api.github.com/users/risdenk/orgs","repos_url":"https://api.github.com/users/risdenk/repos","events_url":"https://api.github.com/users/risdenk/events{/privacy}","received_events_url":"https://api.github.com/users/risdenk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-13T21:15:56Z","updated_at":"2022-12-13T21:15:56Z","author_association":"CONTRIBUTOR","body":"So I undid all my changes for debugging and so what is left is just the `stop.port` and `stop.key` parts. In theory this will just work.\r\n\r\nI have NO idea why this passes locally before this change...","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1349704893/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1349707444","html_url":"https://github.com/apache/solr/pull/1223#issuecomment-1349707444","issue_url":"https://api.github.com/repos/apache/solr/issues/1223","id":1349707444,"node_id":"IC_kwDOFFj3yM5Qcua0","user":{"login":"janhoy","id":409128,"node_id":"MDQ6VXNlcjQwOTEyOA==","avatar_url":"https://avatars.githubusercontent.com/u/409128?v=4","gravatar_id":"","url":"https://api.github.com/users/janhoy","html_url":"https://github.com/janhoy","followers_url":"https://api.github.com/users/janhoy/followers","following_url":"https://api.github.com/users/janhoy/following{/other_user}","gists_url":"https://api.github.com/users/janhoy/gists{/gist_id}","starred_url":"https://api.github.com/users/janhoy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janhoy/subscriptions","organizations_url":"https://api.github.com/users/janhoy/orgs","repos_url":"https://api.github.com/users/janhoy/repos","events_url":"https://api.github.com/users/janhoy/events{/privacy}","received_events_url":"https://api.github.com/users/janhoy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-13T21:16:56Z","updated_at":"2022-12-13T21:16:56Z","author_association":"CONTRIBUTOR","body":"> I have NO idea why this passes locally before this change...\r\n\r\nIt all works on my Macbook. But in Docker under Ubuntu it is definitely not happy","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1349707444/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":1},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1349710085","html_url":"https://github.com/apache/solr/pull/1223#issuecomment-1349710085","issue_url":"https://api.github.com/repos/apache/solr/issues/1223","id":1349710085,"node_id":"IC_kwDOFFj3yM5QcvEF","user":{"login":"janhoy","id":409128,"node_id":"MDQ6VXNlcjQwOTEyOA==","avatar_url":"https://avatars.githubusercontent.com/u/409128?v=4","gravatar_id":"","url":"https://api.github.com/users/janhoy","html_url":"https://github.com/janhoy","followers_url":"https://api.github.com/users/janhoy/followers","following_url":"https://api.github.com/users/janhoy/following{/other_user}","gists_url":"https://api.github.com/users/janhoy/gists{/gist_id}","starred_url":"https://api.github.com/users/janhoy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janhoy/subscriptions","organizations_url":"https://api.github.com/users/janhoy/orgs","repos_url":"https://api.github.com/users/janhoy/repos","events_url":"https://api.github.com/users/janhoy/events{/privacy}","received_events_url":"https://api.github.com/users/janhoy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-13T21:17:59Z","updated_at":"2022-12-13T21:17:59Z","author_association":"CONTRIBUTOR","body":"I exec'ed into the container during the 180 seconds it tried to stop and found this\r\n```\r\ndocker exec -ti 00c425e5b1ca bash                                                                                                              î² â î² 10016 î² 22:13:04\r\nsolr@00c425e5b1ca:/opt/solr-10.0.0-SNAPSHOT$ ps -efwww\r\nUID        PID  PPID  C STIME TTY          TIME CMD\r\nsolr         1     0  0 21:08 pts/0    00:00:00 /usr/bin/qemu-x86_64 /usr/bin/bash bash\r\nsolr       127     1 99 21:10 pts/0    00:03:07 /usr/bin/qemu-x86_64 /opt/java/openjdk/bin/java /opt/java/openjdk/bin/java -server -Xms512m -Xmx512m -XX:+UseG1GC -XX:+PerfDisableSharedMem -XX:+ParallelRefProcEnabled -XX:MaxGCPauseMillis=250 -XX:+UseLargePages -XX:+AlwaysPreTouch -XX:+ExplicitGCInvokesConcurrent -Xlog:gc*:file=/var/solr/logs/solr_gc.log:time,uptime:filecount=9,filesize=20M -Dsolr.jetty.inetaccess.includes= -Dsolr.jetty.inetaccess.excludes= -Dsolr.log.dir=/var/solr/logs -Djetty.port=7000 -DSTOP.PORT=6000 -DSTOP.KEY=solrrocks -Duser.timezone=UTC -XX:-OmitStackTraceInFastThrow -XX:+CrashOnOutOfMemoryError -XX:ErrorFile=/var/solr/logs/jvm_crash_%p.log -Djetty.home=/opt/solr-10.0.0-SNAPSHOT/server -Dsolr.solr.home=/var/solr/data -Dsolr.install.dir=/opt/solr -Dsolr.default.confdir=/opt/solr-10.0.0-SNAPSHOT/server/solr/configsets/_default/conf -Dlog4j.configurationFile=/var/solr/log4j2.xml -Dsolr.jetty.host=0.0.0.0 -Xss256k -XX:CompileCommand=exclude,com.github.benmanes.caffeine.cache.BoundedLocalCache::put -Djava.security.manager -Djava.security.policy=/opt/solr-10.0.0-SNAPSHOT/server/etc/security.policy -Djava.security.properties=/opt/solr-10.0.0-SNAPSHOT/server/etc/security.properties -Dsolr.internal.network.permission=* -DdisableAdminUI=false -Dsolr.log.muteconsole -jar start.jar --module=http --module=requestlog --module=gzip\r\nsolr       470     1  0 21:11 pts/0    00:00:00 /usr/bin/qemu-x86_64 /usr/bin/bash bash /opt/solr/bin/solr stop -V -p 7000\r\nsolr       594   470  0 21:11 pts/0    00:00:00 /usr/bin/qemu-x86_64 /usr/bin/bash bash /opt/solr/bin/solr stop -V -p 7000\r\nsolr      2819     0  2 21:13 pts/1    00:00:00 /usr/bin/qemu-x86_64 /usr/bin/bash bash\r\nsolr      2857   594  0 21:13 pts/0    00:00:00 /usr/bin/qemu-x86_64 /usr/bin/sleep sleep 2\r\nsolr      2875   470  0 21:13 pts/0    00:00:00 /usr/bin/qemu-x86_64 /usr/bin/sleep sleep 0.5\r\nsolr      2878  2819  0 05:27 ?        00:00:00 ps -efwww\r\nsolr@00c425e5b1ca:/opt/solr-10.0.0-SNAPSHOT$ ps -efwww\r\nUID        PID  PPID  C STIME TTY          TIME CMD\r\nsolr         1     0  0 21:08 pts/0    00:00:00 /usr/bin/qemu-x86_64 /usr/bin/bash bash\r\nsolr       127     1 99 21:10 pts/0    00:03:19 /usr/bin/qemu-x86_64 /opt/java/openjdk/bin/java /opt/java/openjdk/bin/java -server -Xms512m -Xmx512m -XX:+UseG1GC -XX:+PerfDisableSharedMem -XX:+ParallelRefProcEnabled -XX:MaxGCPauseMillis=250 -XX:+UseLargePages -XX:+AlwaysPreTouch -XX:+ExplicitGCInvokesConcurrent -Xlog:gc*:file=/var/solr/logs/solr_gc.log:time,uptime:filecount=9,filesize=20M -Dsolr.jetty.inetaccess.includes= -Dsolr.jetty.inetaccess.excludes= -Dsolr.log.dir=/var/solr/logs -Djetty.port=7000 -DSTOP.PORT=6000 -DSTOP.KEY=solrrocks -Duser.timezone=UTC -XX:-OmitStackTraceInFastThrow -XX:+CrashOnOutOfMemoryError -XX:ErrorFile=/var/solr/logs/jvm_crash_%p.log -Djetty.home=/opt/solr-10.0.0-SNAPSHOT/server -Dsolr.solr.home=/var/solr/data -Dsolr.install.dir=/opt/solr -Dsolr.default.confdir=/opt/solr-10.0.0-SNAPSHOT/server/solr/configsets/_default/conf -Dlog4j.configurationFile=/var/solr/log4j2.xml -Dsolr.jetty.host=0.0.0.0 -Xss256k -XX:CompileCommand=exclude,com.github.benmanes.caffeine.cache.BoundedLocalCache::put -Djava.security.manager -Djava.security.policy=/opt/solr-10.0.0-SNAPSHOT/server/etc/security.policy -Djava.security.properties=/opt/solr-10.0.0-SNAPSHOT/server/etc/security.properties -Dsolr.internal.network.permission=* -DdisableAdminUI=false -Dsolr.log.muteconsole -jar start.jar --module=http --module=requestlog --module=gzip\r\nsolr       470     1  0 21:11 pts/0    00:00:00 /usr/bin/qemu-x86_64 /usr/bin/bash bash /opt/solr/bin/solr stop -V -p 7000\r\nsolr       594   470  0 21:11 pts/0    00:00:00 /usr/bin/qemu-x86_64 /usr/bin/bash bash /opt/solr/bin/solr stop -V -p 7000\r\nsolr      2819     0  0 21:13 pts/1    00:00:00 /usr/bin/qemu-x86_64 /usr/bin/bash bash\r\nsolr      3070   594  1 21:13 pts/0    00:00:00 /usr/bin/qemu-x86_64 /usr/bin/sleep sleep 2\r\nsolr      3079  2819  0 05:27 ?        00:00:00 ps -efwww\r\nsolr      3082   470  0 21:13 pts/0    00:00:00 /usr/bin/qemu-x86_64 /usr/bin/ps ps -o pid= -p 594\r\n```","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1349710085/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1349728776","html_url":"https://github.com/apache/solr/pull/1223#issuecomment-1349728776","issue_url":"https://api.github.com/repos/apache/solr/issues/1223","id":1349728776,"node_id":"IC_kwDOFFj3yM5QczoI","user":{"login":"janhoy","id":409128,"node_id":"MDQ6VXNlcjQwOTEyOA==","avatar_url":"https://avatars.githubusercontent.com/u/409128?v=4","gravatar_id":"","url":"https://api.github.com/users/janhoy","html_url":"https://github.com/janhoy","followers_url":"https://api.github.com/users/janhoy/followers","following_url":"https://api.github.com/users/janhoy/following{/other_user}","gists_url":"https://api.github.com/users/janhoy/gists{/gist_id}","starred_url":"https://api.github.com/users/janhoy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janhoy/subscriptions","organizations_url":"https://api.github.com/users/janhoy/orgs","repos_url":"https://api.github.com/users/janhoy/repos","events_url":"https://api.github.com/users/janhoy/events{/privacy}","received_events_url":"https://api.github.com/users/janhoy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-13T21:22:47Z","updated_at":"2022-12-13T21:22:47Z","author_association":"CONTRIBUTOR","body":"You see Solr itself running in PID 127. But the `ps` command targets PID 594, which is the PID of the stop script, which sleeps in a loop of 2 seconds.\r\n\r\nI think now that we have a super fast way of reproducing, it should be easier to debug","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1349728776/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1349767958","html_url":"https://github.com/apache/solr/pull/1223#issuecomment-1349767958","issue_url":"https://api.github.com/repos/apache/solr/issues/1223","id":1349767958,"node_id":"IC_kwDOFFj3yM5Qc9MW","user":{"login":"risdenk","id":3384157,"node_id":"MDQ6VXNlcjMzODQxNTc=","avatar_url":"https://avatars.githubusercontent.com/u/3384157?v=4","gravatar_id":"","url":"https://api.github.com/users/risdenk","html_url":"https://github.com/risdenk","followers_url":"https://api.github.com/users/risdenk/followers","following_url":"https://api.github.com/users/risdenk/following{/other_user}","gists_url":"https://api.github.com/users/risdenk/gists{/gist_id}","starred_url":"https://api.github.com/users/risdenk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/risdenk/subscriptions","organizations_url":"https://api.github.com/users/risdenk/orgs","repos_url":"https://api.github.com/users/risdenk/repos","events_url":"https://api.github.com/users/risdenk/events{/privacy}","received_events_url":"https://api.github.com/users/risdenk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-13T21:35:57Z","updated_at":"2022-12-13T21:35:57Z","author_association":"CONTRIBUTOR","body":"> You see Solr itself running in PID 127. But the ps command targets PID 594, which is the PID of the stop script, which sleeps in a loop of 2 seconds.\r\n\r\nok cool thanks @janhoy most likely SOLR_PID is getting set wrong somehow. \r\n\r\nOne of these invocations:\r\n\r\n```\r\n# git grep -nF stop_solr\r\nsolr/bin/solr:840:function stop_solr() {\r\nsolr/bin/solr:905:} # end stop_solr\r\nsolr/bin/solr:1858:          stop_solr \"$SOLR_SERVER_DIR\" \"$port\" \"$STOP_KEY\" \"$NEXT_PID\"\r\nsolr/bin/solr:1879:          stop_solr \"$SOLR_SERVER_DIR\" \"$port\" \"$STOP_KEY\" \"$CHECK_PID\"\r\nsolr/bin/solr:1939:    stop_solr \"$SOLR_SERVER_DIR\" \"$SOLR_PORT\" \"$STOP_KEY\" \"$SOLR_PID\"\r\n```","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1349767958/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1349784517","html_url":"https://github.com/apache/solr/pull/1223#issuecomment-1349784517","issue_url":"https://api.github.com/repos/apache/solr/issues/1223","id":1349784517,"node_id":"IC_kwDOFFj3yM5QdBPF","user":{"login":"janhoy","id":409128,"node_id":"MDQ6VXNlcjQwOTEyOA==","avatar_url":"https://avatars.githubusercontent.com/u/409128?v=4","gravatar_id":"","url":"https://api.github.com/users/janhoy","html_url":"https://github.com/janhoy","followers_url":"https://api.github.com/users/janhoy/followers","following_url":"https://api.github.com/users/janhoy/following{/other_user}","gists_url":"https://api.github.com/users/janhoy/gists{/gist_id}","starred_url":"https://api.github.com/users/janhoy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janhoy/subscriptions","organizations_url":"https://api.github.com/users/janhoy/orgs","repos_url":"https://api.github.com/users/janhoy/repos","events_url":"https://api.github.com/users/janhoy/events{/privacy}","received_events_url":"https://api.github.com/users/janhoy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-13T21:43:09Z","updated_at":"2022-12-13T21:44:00Z","author_association":"CONTRIBUTOR","body":"I think it is SOLR-16191\r\n\r\nIt changed how the PS command looking for PID gets executed.\r\nIf I debug even on my laptop, the command `ps -o stat='' -p $SOLR_PID` returns just a single `S`, not a PID","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1349784517/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1349793006","html_url":"https://github.com/apache/solr/pull/1223#issuecomment-1349793006","issue_url":"https://api.github.com/repos/apache/solr/issues/1223","id":1349793006,"node_id":"IC_kwDOFFj3yM5QdDTu","user":{"login":"risdenk","id":3384157,"node_id":"MDQ6VXNlcjMzODQxNTc=","avatar_url":"https://avatars.githubusercontent.com/u/3384157?v=4","gravatar_id":"","url":"https://api.github.com/users/risdenk","html_url":"https://github.com/risdenk","followers_url":"https://api.github.com/users/risdenk/followers","following_url":"https://api.github.com/users/risdenk/following{/other_user}","gists_url":"https://api.github.com/users/risdenk/gists{/gist_id}","starred_url":"https://api.github.com/users/risdenk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/risdenk/subscriptions","organizations_url":"https://api.github.com/users/risdenk/orgs","repos_url":"https://api.github.com/users/risdenk/repos","events_url":"https://api.github.com/users/risdenk/events{/privacy}","received_events_url":"https://api.github.com/users/risdenk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-13T21:46:30Z","updated_at":"2022-12-13T21:46:30Z","author_association":"CONTRIBUTOR","body":"> If I debug even on my laptop, the command ps -o stat='' -p $SOLR_PID returns just a single S, not a PID\r\n\r\nI think thats correct - as long as it isn't a `Z` or empty - it finds the stat column without the header - so it returned a result.","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1349793006/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1349796157","html_url":"https://github.com/apache/solr/pull/1223#issuecomment-1349796157","issue_url":"https://api.github.com/repos/apache/solr/issues/1223","id":1349796157,"node_id":"IC_kwDOFFj3yM5QdEE9","user":{"login":"janhoy","id":409128,"node_id":"MDQ6VXNlcjQwOTEyOA==","avatar_url":"https://avatars.githubusercontent.com/u/409128?v=4","gravatar_id":"","url":"https://api.github.com/users/janhoy","html_url":"https://github.com/janhoy","followers_url":"https://api.github.com/users/janhoy/followers","following_url":"https://api.github.com/users/janhoy/following{/other_user}","gists_url":"https://api.github.com/users/janhoy/gists{/gist_id}","starred_url":"https://api.github.com/users/janhoy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janhoy/subscriptions","organizations_url":"https://api.github.com/users/janhoy/orgs","repos_url":"https://api.github.com/users/janhoy/repos","events_url":"https://api.github.com/users/janhoy/events{/privacy}","received_events_url":"https://api.github.com/users/janhoy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-13T21:47:48Z","updated_at":"2022-12-13T21:47:48Z","author_association":"CONTRIBUTOR","body":"> I think thats correct - as long as it isn't a `Z` or empty - it finds the stat column without the header - so it returned a result.\r\n\r\nOk, might have been too quick to conclude there. And SOLR-16191 is in Solr 9.1 as well...","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1349796157/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1349806254","html_url":"https://github.com/apache/solr/pull/1223#issuecomment-1349806254","issue_url":"https://api.github.com/repos/apache/solr/issues/1223","id":1349806254,"node_id":"IC_kwDOFFj3yM5QdGiu","user":{"login":"risdenk","id":3384157,"node_id":"MDQ6VXNlcjMzODQxNTc=","avatar_url":"https://avatars.githubusercontent.com/u/3384157?v=4","gravatar_id":"","url":"https://api.github.com/users/risdenk","html_url":"https://github.com/risdenk","followers_url":"https://api.github.com/users/risdenk/followers","following_url":"https://api.github.com/users/risdenk/following{/other_user}","gists_url":"https://api.github.com/users/risdenk/gists{/gist_id}","starred_url":"https://api.github.com/users/risdenk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/risdenk/subscriptions","organizations_url":"https://api.github.com/users/risdenk/orgs","repos_url":"https://api.github.com/users/risdenk/repos","events_url":"https://api.github.com/users/risdenk/events{/privacy}","received_events_url":"https://api.github.com/users/risdenk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-13T21:52:12Z","updated_at":"2022-12-13T21:52:12Z","author_association":"CONTRIBUTOR","body":"@janhoy at least from github actions the pid looks correct...:\r\n\r\nhttps://github.com/apache/solr/actions/runs/3689576579/jobs/6245669505\r\n\r\n```\r\n#   line 1858\r\n...\r\n#   runner      2651  107  9.2 3098124 661288 ?      Sl   21:42   0:05 /opt/hostedtoolcache/Java_Temurin-Hotspot_jdk/11.0.17-8/x64/bin/java -server -Xms512m -Xmx512m -XX:+UseG1GC -XX:+PerfDisableSharedMem -XX:+ParallelRefProcEnabled -XX:MaxGCPauseMillis=250 -XX:+UseLargePages -XX:+AlwaysPreTouch -XX:+ExplicitGCInvokesConcurrent -Xlog:gc*:file=/home/runner/work/solr/solr/solr/packaging/build/test-output/solr-home/logs/solr_gc.log:time,uptime:filecount=9,filesize=20M -Dsolr.jetty.inetaccess.includes= -Dsolr.jetty.inetaccess.excludes= -Dsolr.log.dir=/home/runner/work/solr/solr/solr/packaging/build/test-output/solr-home/logs -Djetty.port=7574 -DSTOP.PORT=6574 -DSTOP.KEY=solrrocks -Dhost=localhost -Duser.timezone=UTC -XX:-OmitStackTraceInFastThrow -XX:+CrashOnOutOfMemoryError -XX:ErrorFile=/home/runner/work/solr/solr/solr/packaging/build/test-output/solr-home/logs/jvm_crash_%p.log -Djetty.home=/home/runner/work/solr/solr/solr/packaging/build/solr-10.0.0-SNAPSHOT/server -Dsolr.solr.home=/home/runner/work/solr/solr/solr/packaging/build/test-output/solr-home -Dsolr.install.dir=/home/runner/work/solr/solr/solr/packaging/build/solr-10.0.0-SNAPSHOT -Dsolr.default.confdir=/home/runner/work/solr/solr/solr/packaging/build/solr-10.0.0-SNAPSHOT/server/solr/configsets/_default/conf -Xss256k -Djava.security.manager -Djava.security.policy=/home/runner/work/solr/solr/solr/packaging/build/solr-10.0.0-SNAPSHOT/server/etc/security.policy -Djava.security.properties=/home/runner/work/solr/solr/solr/packaging/build/solr-10.0.0-SNAPSHOT/server/etc/security.properties -Dsolr.internal.network.permission=* -DdisableAdminUI=false -Dsolr.log.muteconsole -jar start.jar --module=http --module=requestlog --module=gzip\r\n...\r\n#   stop_solr /home/runner/work/solr/solr/solr/packaging/build/solr-10.0.0-SNAPSHOT/server 7574 solrrocks 2651\r\n```\r\n\r\nand from the jstack - Solr is 100% still running. \r\n\r\nSo I'm back to `\"$JAVA\" $SOLR_SSL_OPTS $AUTHC_OPTS -jar \"$DIR/start.jar\" \"STOP.PORT=$THIS_STOP_PORT\" \"STOP.KEY=$STOP_KEY\" --stop || true` not working correctly somehow.","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1349806254/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1349872685","html_url":"https://github.com/apache/solr/pull/1223#issuecomment-1349872685","issue_url":"https://api.github.com/repos/apache/solr/issues/1223","id":1349872685,"node_id":"IC_kwDOFFj3yM5QdWwt","user":{"login":"janhoy","id":409128,"node_id":"MDQ6VXNlcjQwOTEyOA==","avatar_url":"https://avatars.githubusercontent.com/u/409128?v=4","gravatar_id":"","url":"https://api.github.com/users/janhoy","html_url":"https://github.com/janhoy","followers_url":"https://api.github.com/users/janhoy/followers","following_url":"https://api.github.com/users/janhoy/following{/other_user}","gists_url":"https://api.github.com/users/janhoy/gists{/gist_id}","starred_url":"https://api.github.com/users/janhoy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janhoy/subscriptions","organizations_url":"https://api.github.com/users/janhoy/orgs","repos_url":"https://api.github.com/users/janhoy/repos","events_url":"https://api.github.com/users/janhoy/events{/privacy}","received_events_url":"https://api.github.com/users/janhoy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-13T22:13:58Z","updated_at":"2022-12-13T22:13:58Z","author_association":"CONTRIBUTOR","body":"Yea, I tried `java -jar server/start.jar --help` and get\r\n\r\n```\r\n  --stop\r\n                   Sends a stop signal to the running Jetty instance.\r\n                   The running Jetty instance must have been started with a\r\n                   stop.port=<port> property and the --stop command must\r\n                   be executed with the same property.\r\n\r\n  stop.port=<number>\r\n                   Used with the --stop command.\r\n                   Specifies the port to use to contact the Jetty server\r\n                   to stop.\r\n\r\n  stop.key=<alphanumeric>\r\n                   Used with the --stop command.\r\n                   The passphrase required to stop the Jetty server.\r\n\r\n  stop.wait=<number>\r\n                   Used with the --stop command.\r\n                   The time, in seconds, to wait for confirmation that the\r\n                   running Jetty server has stopped.\r\n                   If not specified, the stopper will not wait.\r\n```\r\n\r\nSo I think we must also START solr with lowercase stop.port","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1349872685/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1349922398","html_url":"https://github.com/apache/solr/pull/1223#issuecomment-1349922398","issue_url":"https://api.github.com/repos/apache/solr/issues/1223","id":1349922398,"node_id":"IC_kwDOFFj3yM5Qdi5e","user":{"login":"risdenk","id":3384157,"node_id":"MDQ6VXNlcjMzODQxNTc=","avatar_url":"https://avatars.githubusercontent.com/u/3384157?v=4","gravatar_id":"","url":"https://api.github.com/users/risdenk","html_url":"https://github.com/risdenk","followers_url":"https://api.github.com/users/risdenk/followers","following_url":"https://api.github.com/users/risdenk/following{/other_user}","gists_url":"https://api.github.com/users/risdenk/gists{/gist_id}","starred_url":"https://api.github.com/users/risdenk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/risdenk/subscriptions","organizations_url":"https://api.github.com/users/risdenk/orgs","repos_url":"https://api.github.com/users/risdenk/repos","events_url":"https://api.github.com/users/risdenk/events{/privacy}","received_events_url":"https://api.github.com/users/risdenk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-13T22:36:00Z","updated_at":"2022-12-13T22:36:00Z","author_association":"CONTRIBUTOR","body":"Well after 6ba8d29 the logs are reporting something interesting... https://github.com/apache/solr/actions/runs/3689870566/jobs/6246292033#step:7:545\r\n\r\nJetty thinks it stopped....\r\n\r\nSo need to figure out what is going on...","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1349922398/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1349954252","html_url":"https://github.com/apache/solr/pull/1223#issuecomment-1349954252","issue_url":"https://api.github.com/repos/apache/solr/issues/1223","id":1349954252,"node_id":"IC_kwDOFFj3yM5QdqrM","user":{"login":"janhoy","id":409128,"node_id":"MDQ6VXNlcjQwOTEyOA==","avatar_url":"https://avatars.githubusercontent.com/u/409128?v=4","gravatar_id":"","url":"https://api.github.com/users/janhoy","html_url":"https://github.com/janhoy","followers_url":"https://api.github.com/users/janhoy/followers","following_url":"https://api.github.com/users/janhoy/following{/other_user}","gists_url":"https://api.github.com/users/janhoy/gists{/gist_id}","starred_url":"https://api.github.com/users/janhoy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janhoy/subscriptions","organizations_url":"https://api.github.com/users/janhoy/orgs","repos_url":"https://api.github.com/users/janhoy/repos","events_url":"https://api.github.com/users/janhoy/events{/privacy}","received_events_url":"https://api.github.com/users/janhoy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-13T22:50:20Z","updated_at":"2022-12-13T22:50:20Z","author_association":"CONTRIBUTOR","body":"It is logical to think that it is related to Jetty 10.\r\nHowever, it it was pure Java change, we should see same behavior on local mac. That's why I felt the need to try from Docker to simulate a Linux environment.\r\n\r\nHave to call it a day...","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1349954252/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1350065980","html_url":"https://github.com/apache/solr/pull/1223#issuecomment-1350065980","issue_url":"https://api.github.com/repos/apache/solr/issues/1223","id":1350065980,"node_id":"IC_kwDOFFj3yM5QeF88","user":{"login":"janhoy","id":409128,"node_id":"MDQ6VXNlcjQwOTEyOA==","avatar_url":"https://avatars.githubusercontent.com/u/409128?v=4","gravatar_id":"","url":"https://api.github.com/users/janhoy","html_url":"https://github.com/janhoy","followers_url":"https://api.github.com/users/janhoy/followers","following_url":"https://api.github.com/users/janhoy/following{/other_user}","gists_url":"https://api.github.com/users/janhoy/gists{/gist_id}","starred_url":"https://api.github.com/users/janhoy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janhoy/subscriptions","organizations_url":"https://api.github.com/users/janhoy/orgs","repos_url":"https://api.github.com/users/janhoy/repos","events_url":"https://api.github.com/users/janhoy/events{/privacy}","received_events_url":"https://api.github.com/users/janhoy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-13T23:40:17Z","updated_at":"2022-12-13T23:40:17Z","author_association":"CONTRIBUTOR","body":"> I think now that we have a super fast way of reproducing, it should be easier to debug\r\n\r\nUnfortunately, this may be a dead end. What I thought was a reproduction may have been the effect of running an and64 docker image on an M1 Mac, which is a bit buggy and slow due to rosetta, so sometimes a process in the container may hang. I think that was the reason for the timeout and killing. Cause when I build a docker image locally and try to reproduce, all works fine.\r\n\r\nI thought for a moment that the `-all` flag was broken on linux, but since the official Docker image sets the ENV `SOLR_PORT` in Dockerfile, this leaks into bash and into the script, so that due to an unfortunate if-test it fails to enter the `-all` logic since `SOLR_PORT` is given. I.e. it believes that `SOLR_PORT` comes from the `-p` argument. :-)","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1350065980/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1350071535","html_url":"https://github.com/apache/solr/pull/1223#issuecomment-1350071535","issue_url":"https://api.github.com/repos/apache/solr/issues/1223","id":1350071535,"node_id":"IC_kwDOFFj3yM5QeHTv","user":{"login":"janhoy","id":409128,"node_id":"MDQ6VXNlcjQwOTEyOA==","avatar_url":"https://avatars.githubusercontent.com/u/409128?v=4","gravatar_id":"","url":"https://api.github.com/users/janhoy","html_url":"https://github.com/janhoy","followers_url":"https://api.github.com/users/janhoy/followers","following_url":"https://api.github.com/users/janhoy/following{/other_user}","gists_url":"https://api.github.com/users/janhoy/gists{/gist_id}","starred_url":"https://api.github.com/users/janhoy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janhoy/subscriptions","organizations_url":"https://api.github.com/users/janhoy/orgs","repos_url":"https://api.github.com/users/janhoy/repos","events_url":"https://api.github.com/users/janhoy/events{/privacy}","received_events_url":"https://api.github.com/users/janhoy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-13T23:42:55Z","updated_at":"2022-12-13T23:42:55Z","author_association":"CONTRIBUTOR","body":"> Jetty thinks it stopped....\r\n\r\nAre you sure that is not the new \"start.jar\" jetty that executes the STOP command? Cause we kind of fire up the jetty start jar to take jetty down...","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1350071535/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1350668244","html_url":"https://github.com/apache/solr/pull/1168#issuecomment-1350668244","issue_url":"https://api.github.com/repos/apache/solr/issues/1168","id":1350668244,"node_id":"IC_kwDOFFj3yM5QgY_U","user":{"login":"janhoy","id":409128,"node_id":"MDQ6VXNlcjQwOTEyOA==","avatar_url":"https://avatars.githubusercontent.com/u/409128?v=4","gravatar_id":"","url":"https://api.github.com/users/janhoy","html_url":"https://github.com/janhoy","followers_url":"https://api.github.com/users/janhoy/followers","following_url":"https://api.github.com/users/janhoy/following{/other_user}","gists_url":"https://api.github.com/users/janhoy/gists{/gist_id}","starred_url":"https://api.github.com/users/janhoy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janhoy/subscriptions","organizations_url":"https://api.github.com/users/janhoy/orgs","repos_url":"https://api.github.com/users/janhoy/repos","events_url":"https://api.github.com/users/janhoy/events{/privacy}","received_events_url":"https://api.github.com/users/janhoy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-14T08:59:03Z","updated_at":"2022-12-14T08:59:03Z","author_association":"CONTRIBUTOR","body":"Any idea for how to or whether to build an integration test for this? Perpaps a BATS test verifying some log lines is sufficient. I'm not keen on trying to mock an OTEL collector.\r\n\r\nI have not tested as much manually as I wanted either, I'll probably do that next and I can publish a recipe here with a docker-compose.yml that stands up a collector and a jaeger UI on localhost that \"just works\" with the default config.\r\n\r\nWrt bootstrapping without adding a tag to solr.xml, I'm thinking SPI could be a solution, but that's for another JIRA.","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1350668244/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1351590063","html_url":"https://github.com/apache/solr/pull/1223#issuecomment-1351590063","issue_url":"https://api.github.com/repos/apache/solr/issues/1223","id":1351590063,"node_id":"IC_kwDOFFj3yM5Qj6Cv","user":{"login":"risdenk","id":3384157,"node_id":"MDQ6VXNlcjMzODQxNTc=","avatar_url":"https://avatars.githubusercontent.com/u/3384157?v=4","gravatar_id":"","url":"https://api.github.com/users/risdenk","html_url":"https://github.com/risdenk","followers_url":"https://api.github.com/users/risdenk/followers","following_url":"https://api.github.com/users/risdenk/following{/other_user}","gists_url":"https://api.github.com/users/risdenk/gists{/gist_id}","starred_url":"https://api.github.com/users/risdenk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/risdenk/subscriptions","organizations_url":"https://api.github.com/users/risdenk/orgs","repos_url":"https://api.github.com/users/risdenk/repos","events_url":"https://api.github.com/users/risdenk/events{/privacy}","received_events_url":"https://api.github.com/users/risdenk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-14T15:09:14Z","updated_at":"2022-12-14T15:09:14Z","author_association":"CONTRIBUTOR","body":"Well at this point @janhoy I'm not sure what to do. I have debug logging on for bin/solr and I see no indications that Solr or Jetty decided to stop. I see in the output that the start.jar stop command happened and reported it successfully stopped. I tried with upper and lower case stop parameters (ie: stop.port). \r\n\r\nI would expect to see SOMETHING in the Solr logs about stopping.\r\n\r\nI would also expect to see SOMETHING about port 6574 being listened to. I'm going to experiment more locally, but right now at a dead end.","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1351590063/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1351628578","html_url":"https://github.com/apache/solr/pull/1223#issuecomment-1351628578","issue_url":"https://api.github.com/repos/apache/solr/issues/1223","id":1351628578,"node_id":"IC_kwDOFFj3yM5QkDci","user":{"login":"risdenk","id":3384157,"node_id":"MDQ6VXNlcjMzODQxNTc=","avatar_url":"https://avatars.githubusercontent.com/u/3384157?v=4","gravatar_id":"","url":"https://api.github.com/users/risdenk","html_url":"https://github.com/risdenk","followers_url":"https://api.github.com/users/risdenk/followers","following_url":"https://api.github.com/users/risdenk/following{/other_user}","gists_url":"https://api.github.com/users/risdenk/gists{/gist_id}","starred_url":"https://api.github.com/users/risdenk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/risdenk/subscriptions","organizations_url":"https://api.github.com/users/risdenk/orgs","repos_url":"https://api.github.com/users/risdenk/repos","events_url":"https://api.github.com/users/risdenk/events{/privacy}","received_events_url":"https://api.github.com/users/risdenk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-14T15:25:23Z","updated_at":"2022-12-14T15:25:23Z","author_association":"CONTRIBUTOR","body":"Well I dug through the Jetty code and found ShutdownMonitor - which has a separate DEBUG property to actually do logging - 7aa80ee\r\n\r\nLocally testing in `./solr/packaging/build/solr-10.0.0-SNAPSHOT/server/logs/solr-7574-console.log` I found the following:\r\n\r\n```\r\n[ShutdownMonitor] command=stop\r\n[ShutdownMonitor] Performing stop command\r\njava.security.AccessControlException: access denied (\"java.io.FilePermission\" \"/private/var/folders/_9/1c1gx5717xqc4vpbtkx2k12h0000gn/T/jetty-127_0_0_1-7574-webapp-_solr-any-10834318635653572205\" \"read\")\r\n\tat java.base/java.security.AccessControlContext.checkPermission(AccessControlContext.java:485)\r\n\tat java.base/java.security.AccessController.checkPermission(AccessController.java:1068)\r\n\tat java.base/java.lang.SecurityManager.checkPermission(SecurityManager.java:416)\r\n\tat java.base/java.lang.SecurityManager.checkRead(SecurityManager.java:756)\r\n\tat java.base/java.io.File.exists(File.java:829)\r\n\tat org.eclipse.jetty.util.IO.delete(IO.java:363)\r\n\tat org.eclipse.jetty.webapp.WebInfConfiguration.deconfigure(WebInfConfiguration.java:87)\r\n\tat org.eclipse.jetty.webapp.WebAppContext.stopContext(WebAppContext.java:1316)\r\n\tat org.eclipse.jetty.server.handler.ContextHandler.doStop(ContextHandler.java:1086)\r\n\tat org.eclipse.jetty.servlet.ServletContextHandler.doStop(ServletContextHandler.java:312)\r\n\tat org.eclipse.jetty.util.component.AbstractLifeCycle.stop(AbstractLifeCycle.java:132)\r\n\tat org.eclipse.jetty.util.component.ContainerLifeCycle.stop(ContainerLifeCycle.java:182)\r\n\tat org.eclipse.jetty.util.component.ContainerLifeCycle.doStop(ContainerLifeCycle.java:205)\r\n\tat org.eclipse.jetty.server.handler.AbstractHandler.doStop(AbstractHandler.java:97)\r\n\tat org.eclipse.jetty.util.component.AbstractLifeCycle.stop(AbstractLifeCycle.java:132)\r\n\tat org.eclipse.jetty.util.component.ContainerLifeCycle.stop(ContainerLifeCycle.java:182)\r\n\tat org.eclipse.jetty.util.component.ContainerLifeCycle.doStop(ContainerLifeCycle.java:205)\r\n\tat org.eclipse.jetty.server.handler.AbstractHandler.doStop(AbstractHandler.java:97)\r\n\tat org.eclipse.jetty.util.component.AbstractLifeCycle.stop(AbstractLifeCycle.java:132)\r\n\tat org.eclipse.jetty.util.component.ContainerLifeCycle.stop(ContainerLifeCycle.java:182)\r\n\tat org.eclipse.jetty.util.component.ContainerLifeCycle.doStop(ContainerLifeCycle.java:205)\r\n\tat org.eclipse.jetty.server.handler.AbstractHandler.doStop(AbstractHandler.java:97)\r\n\tat org.eclipse.jetty.util.component.AbstractLifeCycle.stop(AbstractLifeCycle.java:132)\r\n\tat org.eclipse.jetty.util.component.ContainerLifeCycle.stop(ContainerLifeCycle.java:182)\r\n\tat org.eclipse.jetty.util.component.ContainerLifeCycle.doStop(ContainerLifeCycle.java:205)\r\n\tat org.eclipse.jetty.server.handler.AbstractHandler.doStop(AbstractHandler.java:97)\r\n\tat org.eclipse.jetty.util.component.AbstractLifeCycle.stop(AbstractLifeCycle.java:132)\r\n\tat org.eclipse.jetty.util.component.ContainerLifeCycle.stop(ContainerLifeCycle.java:182)\r\n\tat org.eclipse.jetty.util.component.ContainerLifeCycle.doStop(ContainerLifeCycle.java:205)\r\n\tat org.eclipse.jetty.server.handler.AbstractHandler.doStop(AbstractHandler.java:97)\r\n\tat org.eclipse.jetty.server.handler.gzip.GzipHandler.doStop(GzipHandler.java:227)\r\n\tat org.eclipse.jetty.util.component.AbstractLifeCycle.stop(AbstractLifeCycle.java:132)\r\n\tat org.eclipse.jetty.util.component.ContainerLifeCycle.stop(ContainerLifeCycle.java:182)\r\n\tat org.eclipse.jetty.util.component.ContainerLifeCycle.doStop(ContainerLifeCycle.java:205)\r\n\tat org.eclipse.jetty.server.handler.AbstractHandler.doStop(AbstractHandler.java:97)\r\n\tat org.eclipse.jetty.server.Server.doStop(Server.java:517)\r\n\tat org.eclipse.jetty.util.component.AbstractLifeCycle.stop(AbstractLifeCycle.java:132)\r\n\tat org.eclipse.jetty.server.ShutdownMonitor$ShutdownMonitorRunnable.stopLifeCycles(ShutdownMonitor.java:456)\r\n\tat org.eclipse.jetty.server.ShutdownMonitor$ShutdownMonitorRunnable.run(ShutdownMonitor.java:363)\r\n\tat java.base/java.lang.Thread.run(Thread.java:833)\r\n[ShutdownMonitor] Informing client that we are stopped\r\n[ShutdownMonitor] Killing JVM\r\njava.security.AccessControlException: access denied (\"java.lang.RuntimePermission\" \"exitVM.0\")\r\n\tat java.base/java.security.AccessControlContext.checkPermission(AccessControlContext.java:485)\r\n\tat java.base/java.security.AccessController.checkPermission(AccessController.java:1068)\r\n\tat java.base/java.lang.SecurityManager.checkPermission(SecurityManager.java:416)\r\n\tat java.base/java.lang.SecurityManager.checkExit(SecurityManager.java:629)\r\n\tat java.base/java.lang.Runtime.exit(Runtime.java:113)\r\n\tat java.base/java.lang.System.exit(System.java:1860)\r\n\tat org.eclipse.jetty.server.ShutdownMonitor$ShutdownMonitorRunnable.run(ShutdownMonitor.java:374)\r\n\tat java.base/java.lang.Thread.run(Thread.java:833)\r\n```\r\n\r\nwhich is the missing logs I was looking for. I'm not surprised that the JVM can't be killed. The security manager seems to be taking care of that... I just don't know how this ever worked...","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1351628578/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1351639955","html_url":"https://github.com/apache/solr/pull/1223#issuecomment-1351639955","issue_url":"https://api.github.com/repos/apache/solr/issues/1223","id":1351639955,"node_id":"IC_kwDOFFj3yM5QkGOT","user":{"login":"risdenk","id":3384157,"node_id":"MDQ6VXNlcjMzODQxNTc=","avatar_url":"https://avatars.githubusercontent.com/u/3384157?v=4","gravatar_id":"","url":"https://api.github.com/users/risdenk","html_url":"https://github.com/risdenk","followers_url":"https://api.github.com/users/risdenk/followers","following_url":"https://api.github.com/users/risdenk/following{/other_user}","gists_url":"https://api.github.com/users/risdenk/gists{/gist_id}","starred_url":"https://api.github.com/users/risdenk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/risdenk/subscriptions","organizations_url":"https://api.github.com/users/risdenk/orgs","repos_url":"https://api.github.com/users/risdenk/repos","events_url":"https://api.github.com/users/risdenk/events{/privacy}","received_events_url":"https://api.github.com/users/risdenk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-14T15:32:00Z","updated_at":"2022-12-14T15:32:00Z","author_association":"CONTRIBUTOR","body":"So my only guess so far as to why this is broken is related to:\r\n\r\nhttps://github.com/eclipse/jetty.project/blob/jetty-10.0.x/jetty-server/src/main/java/org/eclipse/jetty/server/ShutdownMonitor.java#L359\r\n\r\nand \r\n\r\nSOLR-16457 where https://github.com/apache/solr/commit/f4cca0d0a51d49266baac422cb07a100aa6e2172 changed some of the security policy about what files were readable/writable. It might be that with read everywhere - the JVM just says ok I stopped and never gets to the kill JVM part.","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1351639955/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1351642945","html_url":"https://github.com/apache/solr/pull/1223#issuecomment-1351642945","issue_url":"https://api.github.com/repos/apache/solr/issues/1223","id":1351642945,"node_id":"IC_kwDOFFj3yM5QkG9B","user":{"login":"risdenk","id":3384157,"node_id":"MDQ6VXNlcjMzODQxNTc=","avatar_url":"https://avatars.githubusercontent.com/u/3384157?v=4","gravatar_id":"","url":"https://api.github.com/users/risdenk","html_url":"https://github.com/risdenk","followers_url":"https://api.github.com/users/risdenk/followers","following_url":"https://api.github.com/users/risdenk/following{/other_user}","gists_url":"https://api.github.com/users/risdenk/gists{/gist_id}","starred_url":"https://api.github.com/users/risdenk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/risdenk/subscriptions","organizations_url":"https://api.github.com/users/risdenk/orgs","repos_url":"https://api.github.com/users/risdenk/repos","events_url":"https://api.github.com/users/risdenk/events{/privacy}","received_events_url":"https://api.github.com/users/risdenk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-14T15:34:07Z","updated_at":"2022-12-14T15:34:07Z","author_association":"CONTRIBUTOR","body":"Well the even more interesting part is the logs from github actions:\r\n\r\n```\r\n[ShutdownMonitor] command=stop\r\n[ShutdownMonitor] Performing stop command\r\njava.lang.IllegalStateException: !STOPPED\r\n\tat org.eclipse.jetty.server.handler.HandlerWrapper.destroy(HandlerWrapper.java:135)\r\n\tat org.eclipse.jetty.server.ShutdownMonitor$ShutdownMonitorRunnable.stopLifeCycles(ShutdownMonitor.java:459)\r\n\tat org.eclipse.jetty.server.ShutdownMonitor$ShutdownMonitorRunnable.run(ShutdownMonitor.java:363)\r\n\tat java.base/java.lang.Thread.run(Thread.java:829)\r\n[ShutdownMonitor] Informing client that we are stopped\r\n[ShutdownMonitor] Killing JVM\r\njava.security.AccessControlException: access denied (\"java.lang.RuntimePermission\" \"exitVM.0\")\r\n\tat java.base/java.security.AccessControlContext.checkPermission(AccessControlContext.java:472)\r\n\tat java.base/java.security.AccessController.checkPermission(AccessController.java:897)\r\n\tat java.base/java.lang.SecurityManager.checkPermission(SecurityManager.java:322)\r\n\tat java.base/java.lang.SecurityManager.checkExit(SecurityManager.java:534)\r\n\tat java.base/java.lang.Runtime.exit(Runtime.java:114)\r\n\tat java.base/java.lang.System.exit(System.java:1752)\r\n\tat org.eclipse.jetty.server.ShutdownMonitor$ShutdownMonitorRunnable.run(ShutdownMonitor.java:374)\r\n\tat java.base/java.lang.Thread.run(Thread.java:829)\r\nDec 14, 2022 3:27:41 PM org.glassfish.jersey.server.wadl.WadlFeature configure\r\nWARNING: JAXBContext implementation could not be found. WADL feature is disabled.\r\n```\r\n\r\nso something is definitely broken :D","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1351642945/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1351843865","html_url":"https://github.com/apache/solr/pull/1223#issuecomment-1351843865","issue_url":"https://api.github.com/repos/apache/solr/issues/1223","id":1351843865,"node_id":"IC_kwDOFFj3yM5Qk4AZ","user":{"login":"risdenk","id":3384157,"node_id":"MDQ6VXNlcjMzODQxNTc=","avatar_url":"https://avatars.githubusercontent.com/u/3384157?v=4","gravatar_id":"","url":"https://api.github.com/users/risdenk","html_url":"https://github.com/risdenk","followers_url":"https://api.github.com/users/risdenk/followers","following_url":"https://api.github.com/users/risdenk/following{/other_user}","gists_url":"https://api.github.com/users/risdenk/gists{/gist_id}","starred_url":"https://api.github.com/users/risdenk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/risdenk/subscriptions","organizations_url":"https://api.github.com/users/risdenk/orgs","repos_url":"https://api.github.com/users/risdenk/repos","events_url":"https://api.github.com/users/risdenk/events{/privacy}","received_events_url":"https://api.github.com/users/risdenk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-14T17:46:34Z","updated_at":"2022-12-14T17:46:34Z","author_association":"CONTRIBUTOR","body":"I'm no closer to figuring out:\r\n\r\n```\r\njava.lang.IllegalStateException: !STOPPED\r\n\tat org.eclipse.jetty.server.handler.HandlerWrapper.destroy(HandlerWrapper.java:135)\r\n\tat org.eclipse.jetty.server.ShutdownMonitor$ShutdownMonitorRunnable.stopLifeCycles(ShutdownMonitor.java:459)\r\n\tat org.eclipse.jetty.server.ShutdownMonitor$ShutdownMonitorRunnable.run(ShutdownMonitor.java:363)\r\n\tat java.base/java.lang.Thread.run(Thread.java:829)\r\n```\r\n\r\nI added a Jetty work dir to avoid the tmp dir stuff in security manager - 779df94 - this fixes some of the errors locally. I am avoiding adding `exitVM.0` until can figure out the above.","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1351843865/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1351857780","html_url":"https://github.com/apache/solr/pull/1223#issuecomment-1351857780","issue_url":"https://api.github.com/repos/apache/solr/issues/1223","id":1351857780,"node_id":"IC_kwDOFFj3yM5Qk7Z0","user":{"login":"janhoy","id":409128,"node_id":"MDQ6VXNlcjQwOTEyOA==","avatar_url":"https://avatars.githubusercontent.com/u/409128?v=4","gravatar_id":"","url":"https://api.github.com/users/janhoy","html_url":"https://github.com/janhoy","followers_url":"https://api.github.com/users/janhoy/followers","following_url":"https://api.github.com/users/janhoy/following{/other_user}","gists_url":"https://api.github.com/users/janhoy/gists{/gist_id}","starred_url":"https://api.github.com/users/janhoy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janhoy/subscriptions","organizations_url":"https://api.github.com/users/janhoy/orgs","repos_url":"https://api.github.com/users/janhoy/repos","events_url":"https://api.github.com/users/janhoy/events{/privacy}","received_events_url":"https://api.github.com/users/janhoy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-14T17:54:15Z","updated_at":"2022-12-14T17:54:15Z","author_association":"CONTRIBUTOR","body":"Ah, there I think we have it - security policy. I can understand how running locally on laptop perhaps has all files within already allowed folders, but how come System.exit() works locally, should be disabled by security manager too?\r\n\r\nAside: I keep seeing `STOP.KEY=solrrocks`. While you can add a custom `-k <key>` on the solr stop command, there is no such option on solr start. It would be a best practice to add your own stop key, else someone may scan a network for IP addresses and fire stop commands on port 7983 :) I do think you can set `STOP_KEY=foo` in `solr.in.xx` and it will be inherited by `bin/solr` though, but could be good to document.","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1351857780/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1351863879","html_url":"https://github.com/apache/solr/pull/1223#issuecomment-1351863879","issue_url":"https://api.github.com/repos/apache/solr/issues/1223","id":1351863879,"node_id":"IC_kwDOFFj3yM5Qk85H","user":{"login":"risdenk","id":3384157,"node_id":"MDQ6VXNlcjMzODQxNTc=","avatar_url":"https://avatars.githubusercontent.com/u/3384157?v=4","gravatar_id":"","url":"https://api.github.com/users/risdenk","html_url":"https://github.com/risdenk","followers_url":"https://api.github.com/users/risdenk/followers","following_url":"https://api.github.com/users/risdenk/following{/other_user}","gists_url":"https://api.github.com/users/risdenk/gists{/gist_id}","starred_url":"https://api.github.com/users/risdenk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/risdenk/subscriptions","organizations_url":"https://api.github.com/users/risdenk/orgs","repos_url":"https://api.github.com/users/risdenk/repos","events_url":"https://api.github.com/users/risdenk/events{/privacy}","received_events_url":"https://api.github.com/users/risdenk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-14T17:57:53Z","updated_at":"2022-12-14T17:57:53Z","author_association":"CONTRIBUTOR","body":"> Ah, there I think we have it - security policy. I can understand how running locally on laptop perhaps has all files within already allowed folders, but how come System.exit() works locally, should be disabled by security manager too?\r\n\r\nNot 100% sure its security manager in github actions yet. It looks like the shutdown works WITHOUT the forced vm exit. Its like the vm exit is the fallback - but once shutdown is triggered Jetty will stop.\r\n\r\nI'm still trying to figure out the following\r\n\r\n```\r\njava.lang.IllegalStateException: !STOPPED\r\n\tat org.eclipse.jetty.server.handler.HandlerWrapper.destroy(HandlerWrapper.java:135)\r\n\tat org.eclipse.jetty.server.ShutdownMonitor$ShutdownMonitorRunnable.stopLifeCycles(ShutdownMonitor.java:459)\r\n\tat org.eclipse.jetty.server.ShutdownMonitor$ShutdownMonitorRunnable.run(ShutdownMonitor.java:363)\r\n\tat java.base/java.lang.Thread.run(Thread.java:829)\r\n```\r\n\r\nwhich I haven't seen locally yet. Adding more debugging to dig further.\r\n\r\n> Aside: I keep seeing STOP.KEY=solrrocks.\r\n\r\nyea something good to do separately.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1351863879/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1351947771","html_url":"https://github.com/apache/solr/pull/1223#issuecomment-1351947771","issue_url":"https://api.github.com/repos/apache/solr/issues/1223","id":1351947771,"node_id":"IC_kwDOFFj3yM5QlRX7","user":{"login":"risdenk","id":3384157,"node_id":"MDQ6VXNlcjMzODQxNTc=","avatar_url":"https://avatars.githubusercontent.com/u/3384157?v=4","gravatar_id":"","url":"https://api.github.com/users/risdenk","html_url":"https://github.com/risdenk","followers_url":"https://api.github.com/users/risdenk/followers","following_url":"https://api.github.com/users/risdenk/following{/other_user}","gists_url":"https://api.github.com/users/risdenk/gists{/gist_id}","starred_url":"https://api.github.com/users/risdenk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/risdenk/subscriptions","organizations_url":"https://api.github.com/users/risdenk/orgs","repos_url":"https://api.github.com/users/risdenk/repos","events_url":"https://api.github.com/users/risdenk/events{/privacy}","received_events_url":"https://api.github.com/users/risdenk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-14T18:40:13Z","updated_at":"2022-12-14T18:40:13Z","author_association":"CONTRIBUTOR","body":"After implementing 93c8523, I don't see any access denied from the security manager prior to this message in the console:\r\n\r\n```\r\njava.lang.IllegalStateException: !STOPPED\r\n\tat org.eclipse.jetty.server.handler.HandlerWrapper.destroy(HandlerWrapper.java:135)\r\n\tat org.eclipse.jetty.server.ShutdownMonitor$ShutdownMonitorRunnable.stopLifeCycles(ShutdownMonitor.java:459)\r\n\tat org.eclipse.jetty.server.ShutdownMonitor$ShutdownMonitorRunnable.run(ShutdownMonitor.java:363)\r\n\tat java.base/java.lang.Thread.run(Thread.java:829)\r\n```\r\n\r\nI also don't see any exceptions in the Solr log either. \r\n\r\nIt would be awesome if HandlerWrapper shared what the state was and what it was actually wrapping...\r\n\r\nhttps://github.com/eclipse/jetty.project/blob/jetty-11.0.x/jetty-server/src/main/java/org/eclipse/jetty/server/handler/HandlerWrapper.java#L132\r\n\r\nI am not sure how to enable more logging right this second. I think I can put this in a debugger and see - but not in github actions. Overwriting this class isn't easy since only Jetty jars are in lib/ext and so not easy to add a custom jar there.","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1351947771/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1352219478","html_url":"https://github.com/apache/solr/pull/1223#issuecomment-1352219478","issue_url":"https://api.github.com/repos/apache/solr/issues/1223","id":1352219478,"node_id":"IC_kwDOFFj3yM5QmTtW","user":{"login":"risdenk","id":3384157,"node_id":"MDQ6VXNlcjMzODQxNTc=","avatar_url":"https://avatars.githubusercontent.com/u/3384157?v=4","gravatar_id":"","url":"https://api.github.com/users/risdenk","html_url":"https://github.com/risdenk","followers_url":"https://api.github.com/users/risdenk/followers","following_url":"https://api.github.com/users/risdenk/following{/other_user}","gists_url":"https://api.github.com/users/risdenk/gists{/gist_id}","starred_url":"https://api.github.com/users/risdenk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/risdenk/subscriptions","organizations_url":"https://api.github.com/users/risdenk/orgs","repos_url":"https://api.github.com/users/risdenk/repos","events_url":"https://api.github.com/users/risdenk/events{/privacy}","received_events_url":"https://api.github.com/users/risdenk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-14T21:20:06Z","updated_at":"2022-12-14T21:20:06Z","author_association":"CONTRIBUTOR","body":"Ok so with 4304fb5 I was able to test this on my fork and get the debugger hooked up to github actions. The state is `starting` for gzip handler - so its like we are shutting stuff down too quickly...\r\n\r\nI'm going to look at putting in a temp sleep to see how that works.","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1352219478/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1352232245","html_url":"https://github.com/apache/solr/pull/1223#issuecomment-1352232245","issue_url":"https://api.github.com/repos/apache/solr/issues/1223","id":1352232245,"node_id":"IC_kwDOFFj3yM5QmW01","user":{"login":"risdenk","id":3384157,"node_id":"MDQ6VXNlcjMzODQxNTc=","avatar_url":"https://avatars.githubusercontent.com/u/3384157?v=4","gravatar_id":"","url":"https://api.github.com/users/risdenk","html_url":"https://github.com/risdenk","followers_url":"https://api.github.com/users/risdenk/followers","following_url":"https://api.github.com/users/risdenk/following{/other_user}","gists_url":"https://api.github.com/users/risdenk/gists{/gist_id}","starred_url":"https://api.github.com/users/risdenk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/risdenk/subscriptions","organizations_url":"https://api.github.com/users/risdenk/orgs","repos_url":"https://api.github.com/users/risdenk/repos","events_url":"https://api.github.com/users/risdenk/events{/privacy}","received_events_url":"https://api.github.com/users/risdenk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-14T21:30:36Z","updated_at":"2022-12-14T21:30:36Z","author_association":"CONTRIBUTOR","body":"So I put in a temp sleep and that made the gzip handler go to \"stopped\" and then destroy works - trying that here: https://github.com/apache/solr/pull/1240","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1352232245/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1352234692","html_url":"https://github.com/apache/solr/pull/1223#issuecomment-1352234692","issue_url":"https://api.github.com/repos/apache/solr/issues/1223","id":1352234692,"node_id":"IC_kwDOFFj3yM5QmXbE","user":{"login":"risdenk","id":3384157,"node_id":"MDQ6VXNlcjMzODQxNTc=","avatar_url":"https://avatars.githubusercontent.com/u/3384157?v=4","gravatar_id":"","url":"https://api.github.com/users/risdenk","html_url":"https://github.com/risdenk","followers_url":"https://api.github.com/users/risdenk/followers","following_url":"https://api.github.com/users/risdenk/following{/other_user}","gists_url":"https://api.github.com/users/risdenk/gists{/gist_id}","starred_url":"https://api.github.com/users/risdenk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/risdenk/subscriptions","organizations_url":"https://api.github.com/users/risdenk/orgs","repos_url":"https://api.github.com/users/risdenk/repos","events_url":"https://api.github.com/users/risdenk/events{/privacy}","received_events_url":"https://api.github.com/users/risdenk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-14T21:32:37Z","updated_at":"2022-12-14T21:32:37Z","author_association":"CONTRIBUTOR","body":"My theory at this point is the security manager stuff is nice to fix but doesn't block shutdown (both the work dir and the vm exit). If jetty is up and ready to shutdown - it works. However on github actions and jenkins - its slower. This at least makes it so the handler is not ready to get shutdown.\r\n\r\nAt least the above is my working theory getting tested by itself here: https://github.com/apache/solr/pull/1240\r\n\r\nIt could be the security manager stuff is also playing a part but still try to narrow it down further.","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1352234692/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1352252295","html_url":"https://github.com/apache/solr/pull/1223#issuecomment-1352252295","issue_url":"https://api.github.com/repos/apache/solr/issues/1223","id":1352252295,"node_id":"IC_kwDOFFj3yM5QmbuH","user":{"login":"risdenk","id":3384157,"node_id":"MDQ6VXNlcjMzODQxNTc=","avatar_url":"https://avatars.githubusercontent.com/u/3384157?v=4","gravatar_id":"","url":"https://api.github.com/users/risdenk","html_url":"https://github.com/risdenk","followers_url":"https://api.github.com/users/risdenk/followers","following_url":"https://api.github.com/users/risdenk/following{/other_user}","gists_url":"https://api.github.com/users/risdenk/gists{/gist_id}","starred_url":"https://api.github.com/users/risdenk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/risdenk/subscriptions","organizations_url":"https://api.github.com/users/risdenk/orgs","repos_url":"https://api.github.com/users/risdenk/repos","events_url":"https://api.github.com/users/risdenk/events{/privacy}","received_events_url":"https://api.github.com/users/risdenk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-14T21:47:43Z","updated_at":"2022-12-14T21:47:43Z","author_association":"CONTRIBUTOR","body":"woot https://github.com/apache/solr/pull/1240 passed - now why does this work on branch_9_0 and not on main. idk....","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1352252295/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1352464498","html_url":"https://github.com/apache/solr/pull/1155#issuecomment-1352464498","issue_url":"https://api.github.com/repos/apache/solr/issues/1155","id":1352464498,"node_id":"IC_kwDOFFj3yM5QnPhy","user":{"login":"dsmiley","id":377295,"node_id":"MDQ6VXNlcjM3NzI5NQ==","avatar_url":"https://avatars.githubusercontent.com/u/377295?v=4","gravatar_id":"","url":"https://api.github.com/users/dsmiley","html_url":"https://github.com/dsmiley","followers_url":"https://api.github.com/users/dsmiley/followers","following_url":"https://api.github.com/users/dsmiley/following{/other_user}","gists_url":"https://api.github.com/users/dsmiley/gists{/gist_id}","starred_url":"https://api.github.com/users/dsmiley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dsmiley/subscriptions","organizations_url":"https://api.github.com/users/dsmiley/orgs","repos_url":"https://api.github.com/users/dsmiley/repos","events_url":"https://api.github.com/users/dsmiley/events{/privacy}","received_events_url":"https://api.github.com/users/dsmiley/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-15T02:08:11Z","updated_at":"2022-12-15T02:08:11Z","author_association":"CONTRIBUTOR","body":"I wish transient cores was better isolated to users that opt-in to use it.  I'm thinking, \"SolrCores\" could be pluggable with a subclass that supports TransientCores; the default (SolrCores itself) would not.  Then we could do something simple for the default implementation and delay how to handle transient cores.  For example this read/write lock stuff could be in the default/base impl but we leave the transient cache implementing one alone (wouldn't have this optimization, at least for now).  This doesn't seem hard and lets us punt on transient core complexity ramifications.  It makes the default case easier to understand (no transient core code interaction) and with the PR here, removes a bottleneck you saw.","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1352464498/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1352467817","html_url":"https://github.com/apache/solr/pull/1155#issuecomment-1352467817","issue_url":"https://api.github.com/repos/apache/solr/issues/1155","id":1352467817,"node_id":"IC_kwDOFFj3yM5QnQVp","user":{"login":"dsmiley","id":377295,"node_id":"MDQ6VXNlcjM3NzI5NQ==","avatar_url":"https://avatars.githubusercontent.com/u/377295?v=4","gravatar_id":"","url":"https://api.github.com/users/dsmiley","html_url":"https://github.com/dsmiley","followers_url":"https://api.github.com/users/dsmiley/followers","following_url":"https://api.github.com/users/dsmiley/following{/other_user}","gists_url":"https://api.github.com/users/dsmiley/gists{/gist_id}","starred_url":"https://api.github.com/users/dsmiley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dsmiley/subscriptions","organizations_url":"https://api.github.com/users/dsmiley/orgs","repos_url":"https://api.github.com/users/dsmiley/repos","events_url":"https://api.github.com/users/dsmiley/events{/privacy}","received_events_url":"https://api.github.com/users/dsmiley/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-15T02:13:13Z","updated_at":"2022-12-15T02:13:13Z","author_association":"CONTRIBUTOR","body":"If this sounds good, I volunteer to do the refactoring and then you could re-do your PR on the result of that.  The impact of the refactoring on transient cores might be back-compat as well, but I think it's too little used to worry much.","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1352467817/reactions","total_count":3,"+1":3,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1352478724","html_url":"https://github.com/apache/solr/pull/1168#issuecomment-1352478724","issue_url":"https://api.github.com/repos/apache/solr/issues/1168","id":1352478724,"node_id":"IC_kwDOFFj3yM5QnTAE","user":{"login":"dsmiley","id":377295,"node_id":"MDQ6VXNlcjM3NzI5NQ==","avatar_url":"https://avatars.githubusercontent.com/u/377295?v=4","gravatar_id":"","url":"https://api.github.com/users/dsmiley","html_url":"https://github.com/dsmiley","followers_url":"https://api.github.com/users/dsmiley/followers","following_url":"https://api.github.com/users/dsmiley/following{/other_user}","gists_url":"https://api.github.com/users/dsmiley/gists{/gist_id}","starred_url":"https://api.github.com/users/dsmiley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dsmiley/subscriptions","organizations_url":"https://api.github.com/users/dsmiley/orgs","repos_url":"https://api.github.com/users/dsmiley/repos","events_url":"https://api.github.com/users/dsmiley/events{/privacy}","received_events_url":"https://api.github.com/users/dsmiley/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-15T02:33:55Z","updated_at":"2022-12-15T02:33:55Z","author_association":"CONTRIBUTOR","body":"I love the docker-compose idea!  We'd ideally have one docker-compose sample for Solr with this in and and users could take it and comment out whatever they don't want.\r\n\r\nIntegration tests:  BATS -- yeah I guess; I can sympathize a test isn't easy.  Maybe this could test your proposed docker-compose so we test that *that* is configured properly as well.","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1352478724/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1352812182","html_url":"https://github.com/apache/solr/pull/1155#issuecomment-1352812182","issue_url":"https://api.github.com/repos/apache/solr/issues/1155","id":1352812182,"node_id":"IC_kwDOFFj3yM5QokaW","user":{"login":"bruno-roustant","id":33934988,"node_id":"MDQ6VXNlcjMzOTM0OTg4","avatar_url":"https://avatars.githubusercontent.com/u/33934988?v=4","gravatar_id":"","url":"https://api.github.com/users/bruno-roustant","html_url":"https://github.com/bruno-roustant","followers_url":"https://api.github.com/users/bruno-roustant/followers","following_url":"https://api.github.com/users/bruno-roustant/following{/other_user}","gists_url":"https://api.github.com/users/bruno-roustant/gists{/gist_id}","starred_url":"https://api.github.com/users/bruno-roustant/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bruno-roustant/subscriptions","organizations_url":"https://api.github.com/users/bruno-roustant/orgs","repos_url":"https://api.github.com/users/bruno-roustant/repos","events_url":"https://api.github.com/users/bruno-roustant/events{/privacy}","received_events_url":"https://api.github.com/users/bruno-roustant/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-15T09:54:13Z","updated_at":"2022-12-15T09:54:13Z","author_association":"CONTRIBUTOR","body":"+1 to extract the support of transient cores as a subclass of SolrCores.","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1352812182/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1352824165","html_url":"https://github.com/apache/solr/pull/1155#issuecomment-1352824165","issue_url":"https://api.github.com/repos/apache/solr/issues/1155","id":1352824165,"node_id":"IC_kwDOFFj3yM5QonVl","user":{"login":"mpetris","id":1111999,"node_id":"MDQ6VXNlcjExMTE5OTk=","avatar_url":"https://avatars.githubusercontent.com/u/1111999?v=4","gravatar_id":"","url":"https://api.github.com/users/mpetris","html_url":"https://github.com/mpetris","followers_url":"https://api.github.com/users/mpetris/followers","following_url":"https://api.github.com/users/mpetris/following{/other_user}","gists_url":"https://api.github.com/users/mpetris/gists{/gist_id}","starred_url":"https://api.github.com/users/mpetris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mpetris/subscriptions","organizations_url":"https://api.github.com/users/mpetris/orgs","repos_url":"https://api.github.com/users/mpetris/repos","events_url":"https://api.github.com/users/mpetris/events{/privacy}","received_events_url":"https://api.github.com/users/mpetris/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-15T10:03:45Z","updated_at":"2022-12-15T10:03:45Z","author_association":"CONTRIBUTOR","body":"Refactoring SolrCores with TransientCores support and SolrCores without TransientCores support into separate implementations is really a good idea. +1\r\nWe would re-do our PR on the result of that. Would be great if we could still make it in time for 9.2","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1352824165/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1352876178","html_url":"https://github.com/apache/solr/pull/1155#issuecomment-1352876178","issue_url":"https://api.github.com/repos/apache/solr/issues/1155","id":1352876178,"node_id":"IC_kwDOFFj3yM5Qo0CS","user":{"login":"debe","id":222052,"node_id":"MDQ6VXNlcjIyMjA1Mg==","avatar_url":"https://avatars.githubusercontent.com/u/222052?v=4","gravatar_id":"","url":"https://api.github.com/users/debe","html_url":"https://github.com/debe","followers_url":"https://api.github.com/users/debe/followers","following_url":"https://api.github.com/users/debe/following{/other_user}","gists_url":"https://api.github.com/users/debe/gists{/gist_id}","starred_url":"https://api.github.com/users/debe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/debe/subscriptions","organizations_url":"https://api.github.com/users/debe/orgs","repos_url":"https://api.github.com/users/debe/repos","events_url":"https://api.github.com/users/debe/events{/privacy}","received_events_url":"https://api.github.com/users/debe/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-15T10:44:11Z","updated_at":"2022-12-15T10:44:11Z","author_association":"CONTRIBUTOR","body":"Should we change the overflow cache to a Map in the mean time, to get this PR going? what do you think?\r\n\r\nchers, -dennis","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1352876178/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1353225663","html_url":"https://github.com/apache/solr/pull/1213#issuecomment-1353225663","issue_url":"https://api.github.com/repos/apache/solr/issues/1213","id":1353225663,"node_id":"IC_kwDOFFj3yM5QqJW_","user":{"login":"epugh","id":22395,"node_id":"MDQ6VXNlcjIyMzk1","avatar_url":"https://avatars.githubusercontent.com/u/22395?v=4","gravatar_id":"","url":"https://api.github.com/users/epugh","html_url":"https://github.com/epugh","followers_url":"https://api.github.com/users/epugh/followers","following_url":"https://api.github.com/users/epugh/following{/other_user}","gists_url":"https://api.github.com/users/epugh/gists{/gist_id}","starred_url":"https://api.github.com/users/epugh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/epugh/subscriptions","organizations_url":"https://api.github.com/users/epugh/orgs","repos_url":"https://api.github.com/users/epugh/repos","events_url":"https://api.github.com/users/epugh/events{/privacy}","received_events_url":"https://api.github.com/users/epugh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-15T14:59:18Z","updated_at":"2022-12-15T14:59:18Z","author_association":"CONTRIBUTOR","body":"@gabrielmagno  are you ready for me to review this PR?  I was sort of waiting till you gave me the all clear!","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1353225663/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1353235629","html_url":"https://github.com/apache/solr/pull/1213#issuecomment-1353235629","issue_url":"https://api.github.com/repos/apache/solr/issues/1213","id":1353235629,"node_id":"IC_kwDOFFj3yM5QqLyt","user":{"login":"gabrielmagno","id":244890,"node_id":"MDQ6VXNlcjI0NDg5MA==","avatar_url":"https://avatars.githubusercontent.com/u/244890?v=4","gravatar_id":"","url":"https://api.github.com/users/gabrielmagno","html_url":"https://github.com/gabrielmagno","followers_url":"https://api.github.com/users/gabrielmagno/followers","following_url":"https://api.github.com/users/gabrielmagno/following{/other_user}","gists_url":"https://api.github.com/users/gabrielmagno/gists{/gist_id}","starred_url":"https://api.github.com/users/gabrielmagno/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gabrielmagno/subscriptions","organizations_url":"https://api.github.com/users/gabrielmagno/orgs","repos_url":"https://api.github.com/users/gabrielmagno/repos","events_url":"https://api.github.com/users/gabrielmagno/events{/privacy}","received_events_url":"https://api.github.com/users/gabrielmagno/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-15T15:06:22Z","updated_at":"2022-12-15T15:06:22Z","author_association":"CONTRIBUTOR","body":"Hey @epugh!\r\n\r\nYeah, at least from my side I think I have finished it.\r\nSorry for not making that more clear ð\r\n\r\nBy the way, sonatype complained about using lxml, but since we are creating the XML and not really parsing a XML, I think we could ignore it.\r\n\r\nYou can go ahead and review it.\r\nThank you very much!","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1353235629/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1353250823","html_url":"https://github.com/apache/solr/pull/1240#issuecomment-1353250823","issue_url":"https://api.github.com/repos/apache/solr/issues/1240","id":1353250823,"node_id":"IC_kwDOFFj3yM5QqPgH","user":{"login":"risdenk","id":3384157,"node_id":"MDQ6VXNlcjMzODQxNTc=","avatar_url":"https://avatars.githubusercontent.com/u/3384157?v=4","gravatar_id":"","url":"https://api.github.com/users/risdenk","html_url":"https://github.com/risdenk","followers_url":"https://api.github.com/users/risdenk/followers","following_url":"https://api.github.com/users/risdenk/following{/other_user}","gists_url":"https://api.github.com/users/risdenk/gists{/gist_id}","starred_url":"https://api.github.com/users/risdenk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/risdenk/subscriptions","organizations_url":"https://api.github.com/users/risdenk/orgs","repos_url":"https://api.github.com/users/risdenk/repos","events_url":"https://api.github.com/users/risdenk/events{/privacy}","received_events_url":"https://api.github.com/users/risdenk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-15T15:16:06Z","updated_at":"2022-12-15T15:16:06Z","author_association":"CONTRIBUTOR","body":"@janhoy are you happy with this? I think its an improvement. I'm thinking get it merged and then see how things look.","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1353250823/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1353303993","html_url":"https://github.com/apache/solr/pull/1220#issuecomment-1353303993","issue_url":"https://api.github.com/repos/apache/solr/issues/1220","id":1353303993,"node_id":"IC_kwDOFFj3yM5Qqce5","user":{"login":"epugh","id":22395,"node_id":"MDQ6VXNlcjIyMzk1","avatar_url":"https://avatars.githubusercontent.com/u/22395?v=4","gravatar_id":"","url":"https://api.github.com/users/epugh","html_url":"https://github.com/epugh","followers_url":"https://api.github.com/users/epugh/followers","following_url":"https://api.github.com/users/epugh/following{/other_user}","gists_url":"https://api.github.com/users/epugh/gists{/gist_id}","starred_url":"https://api.github.com/users/epugh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/epugh/subscriptions","organizations_url":"https://api.github.com/users/epugh/orgs","repos_url":"https://api.github.com/users/epugh/repos","events_url":"https://api.github.com/users/epugh/events{/privacy}","received_events_url":"https://api.github.com/users/epugh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-15T15:51:31Z","updated_at":"2022-12-15T15:51:31Z","author_association":"CONTRIBUTOR","body":"@dsmiley  @risdenk I think I am ready for another review after addressing feedback.  Can I get a LGTM?","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1353303993/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1353491762","html_url":"https://github.com/apache/solr/pull/1242#issuecomment-1353491762","issue_url":"https://api.github.com/repos/apache/solr/issues/1242","id":1353491762,"node_id":"IC_kwDOFFj3yM5QrKUy","user":{"login":"noblepaul","id":54862,"node_id":"MDQ6VXNlcjU0ODYy","avatar_url":"https://avatars.githubusercontent.com/u/54862?v=4","gravatar_id":"","url":"https://api.github.com/users/noblepaul","html_url":"https://github.com/noblepaul","followers_url":"https://api.github.com/users/noblepaul/followers","following_url":"https://api.github.com/users/noblepaul/following{/other_user}","gists_url":"https://api.github.com/users/noblepaul/gists{/gist_id}","starred_url":"https://api.github.com/users/noblepaul/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/noblepaul/subscriptions","organizations_url":"https://api.github.com/users/noblepaul/orgs","repos_url":"https://api.github.com/users/noblepaul/repos","events_url":"https://api.github.com/users/noblepaul/events{/privacy}","received_events_url":"https://api.github.com/users/noblepaul/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-15T17:56:28Z","updated_at":"2022-12-15T17:56:28Z","author_association":"CONTRIBUTOR","body":"@justinrsweeney @patsonluk this is still WIP , reviews are welcome","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1353491762/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1353655272","html_url":"https://github.com/apache/solr/pull/1217#issuecomment-1353655272","issue_url":"https://api.github.com/repos/apache/solr/issues/1217","id":1353655272,"node_id":"IC_kwDOFFj3yM5QryPo","user":{"login":"epugh","id":22395,"node_id":"MDQ6VXNlcjIyMzk1","avatar_url":"https://avatars.githubusercontent.com/u/22395?v=4","gravatar_id":"","url":"https://api.github.com/users/epugh","html_url":"https://github.com/epugh","followers_url":"https://api.github.com/users/epugh/followers","following_url":"https://api.github.com/users/epugh/following{/other_user}","gists_url":"https://api.github.com/users/epugh/gists{/gist_id}","starred_url":"https://api.github.com/users/epugh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/epugh/subscriptions","organizations_url":"https://api.github.com/users/epugh/orgs","repos_url":"https://api.github.com/users/epugh/repos","events_url":"https://api.github.com/users/epugh/events{/privacy}","received_events_url":"https://api.github.com/users/epugh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-15T20:15:14Z","updated_at":"2022-12-15T20:15:14Z","author_association":"CONTRIBUTOR","body":"> needs CHANGES.txt too\r\n\r\nI will add this at the end, I find I always get merge conflicts when I add this early...","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1353655272/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1353674604","html_url":"https://github.com/apache/solr/pull/1217#issuecomment-1353674604","issue_url":"https://api.github.com/repos/apache/solr/issues/1217","id":1353674604,"node_id":"IC_kwDOFFj3yM5Qr29s","user":{"login":"epugh","id":22395,"node_id":"MDQ6VXNlcjIyMzk1","avatar_url":"https://avatars.githubusercontent.com/u/22395?v=4","gravatar_id":"","url":"https://api.github.com/users/epugh","html_url":"https://github.com/epugh","followers_url":"https://api.github.com/users/epugh/followers","following_url":"https://api.github.com/users/epugh/following{/other_user}","gists_url":"https://api.github.com/users/epugh/gists{/gist_id}","starred_url":"https://api.github.com/users/epugh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/epugh/subscriptions","organizations_url":"https://api.github.com/users/epugh/orgs","repos_url":"https://api.github.com/users/epugh/repos","events_url":"https://api.github.com/users/epugh/events{/privacy}","received_events_url":"https://api.github.com/users/epugh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-15T20:33:12Z","updated_at":"2022-12-15T20:33:12Z","author_association":"CONTRIBUTOR","body":"> needs CHANGES.txt too\r\n\r\nWent ahad and added it.  Ugh, got conflicts.","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1353674604/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1353701952","html_url":"https://github.com/apache/solr/pull/1241#issuecomment-1353701952","issue_url":"https://api.github.com/repos/apache/solr/issues/1241","id":1353701952,"node_id":"IC_kwDOFFj3yM5Qr9pA","user":{"login":"magibney","id":6225104,"node_id":"MDQ6VXNlcjYyMjUxMDQ=","avatar_url":"https://avatars.githubusercontent.com/u/6225104?v=4","gravatar_id":"","url":"https://api.github.com/users/magibney","html_url":"https://github.com/magibney","followers_url":"https://api.github.com/users/magibney/followers","following_url":"https://api.github.com/users/magibney/following{/other_user}","gists_url":"https://api.github.com/users/magibney/gists{/gist_id}","starred_url":"https://api.github.com/users/magibney/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/magibney/subscriptions","organizations_url":"https://api.github.com/users/magibney/orgs","repos_url":"https://api.github.com/users/magibney/repos","events_url":"https://api.github.com/users/magibney/events{/privacy}","received_events_url":"https://api.github.com/users/magibney/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-15T21:01:08Z","updated_at":"2022-12-15T21:01:08Z","author_association":"CONTRIBUTOR","body":"Esp. given that a 9.1.1 release looks [inevitable](https://github.com/apache/solr/pull/1236), would you consider backporting this to `branch_9_1`?","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1353701952/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1353833905","html_url":"https://github.com/apache/solr/pull/1241#issuecomment-1353833905","issue_url":"https://api.github.com/repos/apache/solr/issues/1241","id":1353833905,"node_id":"IC_kwDOFFj3yM5Qsd2x","user":{"login":"risdenk","id":3384157,"node_id":"MDQ6VXNlcjMzODQxNTc=","avatar_url":"https://avatars.githubusercontent.com/u/3384157?v=4","gravatar_id":"","url":"https://api.github.com/users/risdenk","html_url":"https://github.com/risdenk","followers_url":"https://api.github.com/users/risdenk/followers","following_url":"https://api.github.com/users/risdenk/following{/other_user}","gists_url":"https://api.github.com/users/risdenk/gists{/gist_id}","starred_url":"https://api.github.com/users/risdenk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/risdenk/subscriptions","organizations_url":"https://api.github.com/users/risdenk/orgs","repos_url":"https://api.github.com/users/risdenk/repos","events_url":"https://api.github.com/users/risdenk/events{/privacy}","received_events_url":"https://api.github.com/users/risdenk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-15T23:14:47Z","updated_at":"2022-12-15T23:14:47Z","author_association":"CONTRIBUTOR","body":"> Esp. given that a 9.1.1 release looks https://github.com/apache/solr/pull/1236, would you consider backporting this to branch_9_1?\r\n\r\nyup done and done :)","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1353833905/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1353837501","html_url":"https://github.com/apache/solr/pull/1223#issuecomment-1353837501","issue_url":"https://api.github.com/repos/apache/solr/issues/1223","id":1353837501,"node_id":"IC_kwDOFFj3yM5Qseu9","user":{"login":"risdenk","id":3384157,"node_id":"MDQ6VXNlcjMzODQxNTc=","avatar_url":"https://avatars.githubusercontent.com/u/3384157?v=4","gravatar_id":"","url":"https://api.github.com/users/risdenk","html_url":"https://github.com/risdenk","followers_url":"https://api.github.com/users/risdenk/followers","following_url":"https://api.github.com/users/risdenk/following{/other_user}","gists_url":"https://api.github.com/users/risdenk/gists{/gist_id}","starred_url":"https://api.github.com/users/risdenk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/risdenk/subscriptions","organizations_url":"https://api.github.com/users/risdenk/orgs","repos_url":"https://api.github.com/users/risdenk/repos","events_url":"https://api.github.com/users/risdenk/events{/privacy}","received_events_url":"https://api.github.com/users/risdenk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-15T23:18:42Z","updated_at":"2022-12-15T23:18:42Z","author_association":"CONTRIBUTOR","body":"Closed since not debugging here anymore for now.","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1353837501/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1354539553","html_url":"https://github.com/apache/solr/pull/1048#issuecomment-1354539553","issue_url":"https://api.github.com/repos/apache/solr/issues/1048","id":1354539553,"node_id":"IC_kwDOFFj3yM5QvKIh","user":{"login":"bruno-roustant","id":33934988,"node_id":"MDQ6VXNlcjMzOTM0OTg4","avatar_url":"https://avatars.githubusercontent.com/u/33934988?v=4","gravatar_id":"","url":"https://api.github.com/users/bruno-roustant","html_url":"https://github.com/bruno-roustant","followers_url":"https://api.github.com/users/bruno-roustant/followers","following_url":"https://api.github.com/users/bruno-roustant/following{/other_user}","gists_url":"https://api.github.com/users/bruno-roustant/gists{/gist_id}","starred_url":"https://api.github.com/users/bruno-roustant/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bruno-roustant/subscriptions","organizations_url":"https://api.github.com/users/bruno-roustant/orgs","repos_url":"https://api.github.com/users/bruno-roustant/repos","events_url":"https://api.github.com/users/bruno-roustant/events{/privacy}","received_events_url":"https://api.github.com/users/bruno-roustant/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-16T10:43:18Z","updated_at":"2022-12-16T10:43:18Z","author_association":"CONTRIBUTOR","body":"Thanks for the review!\r\nMerged","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1354539553/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1354572598","html_url":"https://github.com/apache/solr/pull/1182#issuecomment-1354572598","issue_url":"https://api.github.com/repos/apache/solr/issues/1182","id":1354572598,"node_id":"IC_kwDOFFj3yM5QvSM2","user":{"login":"bszabo97","id":79325622,"node_id":"MDQ6VXNlcjc5MzI1NjIy","avatar_url":"https://avatars.githubusercontent.com/u/79325622?v=4","gravatar_id":"","url":"https://api.github.com/users/bszabo97","html_url":"https://github.com/bszabo97","followers_url":"https://api.github.com/users/bszabo97/followers","following_url":"https://api.github.com/users/bszabo97/following{/other_user}","gists_url":"https://api.github.com/users/bszabo97/gists{/gist_id}","starred_url":"https://api.github.com/users/bszabo97/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bszabo97/subscriptions","organizations_url":"https://api.github.com/users/bszabo97/orgs","repos_url":"https://api.github.com/users/bszabo97/repos","events_url":"https://api.github.com/users/bszabo97/events{/privacy}","received_events_url":"https://api.github.com/users/bszabo97/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-16T11:11:10Z","updated_at":"2022-12-16T11:12:09Z","author_association":"CONTRIBUTOR","body":"I have added some more commits where I was trying to migrate from apache client to the jetty client in the PackageTool class, but right now I am a bit stuck and I would need a little guidance.\r\n\r\nWith the current version (at least) one test is failing, which can be reproduced with\r\n```\r\n./gradlew :solr:core:test --tests \"org.apache.solr.cloud.PackageManagerCLITest.testPackageManager\" -Ptests.jvms=6 \"-Ptests.jvmargs=-XX:TieredStopAtLevel=1 -XX:ReservedCodeCacheSize=120m\" -Ptests.seed=6DCD7855C98F8100 -Ptests.file.encoding=UTF-8\r\n```\r\nI get the following error in this test:\r\n```\r\norg.apache.solr.common.SolrException: org.apache.solr.client.solrj.impl.BaseHttpSolrClient$RemoteSolrException: Error from server at https://127.0.0.1:60536: Invalid version (expected 2, but 123) or the data in not in\r\n 'javabin' format\r\n  2>    at org.apache.solr.packagemanager.PackageManager.fetchInstalledPackageInstances(PackageManager.java:223)\r\n  2>    at org.apache.solr.util.PackageTool.runImpl(PackageTool.java:108)\r\n  2>    at org.apache.solr.util.SolrCLI$ToolBase.runTool(SolrCLI.java:174)\r\n  2>    at org.apache.solr.cloud.PackageManagerCLITest.run(PackageManagerCLITest.java:219)\r\n  2>    at org.apache.solr.cloud.PackageManagerCLITest.testPackageManager(PackageManagerCLITest.java:103)\r\n...\r\n```\r\n\r\nLooking at the logs of this test on the main branch I can see that the request with which we get the manifest file differs in the parameters. On the main branch it looks like this:\r\n```\r\n5384 INFO  (qtp747046555-89) [n:127.0.0.1:61067_solr] o.a.s.s.HttpSolrCall [admin] webapp=null path=/node/files/package/question-answer/1.0.0/manifest.json params={} status=0 QTime=1\r\n```\r\nOn my branch it is like this:\r\n```\r\n5209 INFO  (qtp1404573452-50) [n:127.0.0.1:60536_solr] o.a.s.s.HttpSolrCall [admin] webapp=null path=/node/files/package/question-answer/1.0.0/manifest.json params={wt=javabin&version=2} status=0 QTime=0\r\n```\r\nI was not able to get rid of these parameters since I think they are there by default in every solr request(?)\r\n\r\nI also tried implementing this with the V2Request but that way I get a different error which is:\r\n```\r\n2> org.apache.solr.client.solrj.impl.BaseHttpSolrClient$RemoteSolrException: Error from server at https://127.0.0.1:65494: Expected mime type in [application/octet-stream, application/vnd.apache.solr.javabin] but got text/html. <html>\r\n  2> <head>\r\n  2> <meta http-equiv=\"Content-Type\" content=\"text/html;charset=ISO-8859-1\"/>\r\n  2> <title>Error 404 Not Found</title>\r\n  2> </head>\r\n  2> <body><h2>HTTP ERROR 404 Not Found</h2>\r\n  2> <table>\r\n  2> <tr><th>URI:</th><td>/____v2/api/cluster/package</td></tr>\r\n  2> <tr><th>STATUS:</th><td>404</td></tr>\r\n  2> <tr><th>MESSAGE:</th><td>Not Found</td></tr>\r\n  2> <tr><th>SERVLET:</th><td>-</td></tr>\r\n  2> </table>\r\n  2> <hr/><a href=\"https://eclipse.org/jetty\">Powered by Jetty:// 9.4.48.v20220622</a><hr/>\r\n  2> \r\n  2> </body>\r\n  2> </html>\r\n  2> \r\n  2>    at org.apache.solr.client.solrj.impl.Http2SolrClient.processErrorsAndResponse(Http2SolrClient.java:796)\r\n  2>    at org.apache.solr.client.solrj.impl.Http2SolrClient.processErrorsAndResponse(Http2SolrClient.java:509)\r\n  2>    at org.apache.solr.client.solrj.impl.Http2SolrClient.request(Http2SolrClient.java:468)\r\n  2>    at org.apache.solr.client.solrj.SolrRequest.process(SolrRequest.java:234)\r\n  2>    at org.apache.solr.client.solrj.SolrRequest.process(SolrRequest.java:249)\r\n```\r\n(Actually I get a similar message with every V2Request in this class so I had to change quite a lot of them to be GenericSolrRequests)\r\n\r\nCan somebody take a look at this problem and provide some guidance for me? Thank you in advance and sorry for the long comment.","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1354572598/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1355201400","html_url":"https://github.com/apache/solr/pull/1213#issuecomment-1355201400","issue_url":"https://api.github.com/repos/apache/solr/issues/1213","id":1355201400,"node_id":"IC_kwDOFFj3yM5Qxrt4","user":{"login":"epugh","id":22395,"node_id":"MDQ6VXNlcjIyMzk1","avatar_url":"https://avatars.githubusercontent.com/u/22395?v=4","gravatar_id":"","url":"https://api.github.com/users/epugh","html_url":"https://github.com/epugh","followers_url":"https://api.github.com/users/epugh/followers","following_url":"https://api.github.com/users/epugh/following{/other_user}","gists_url":"https://api.github.com/users/epugh/gists{/gist_id}","starred_url":"https://api.github.com/users/epugh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/epugh/subscriptions","organizations_url":"https://api.github.com/users/epugh/orgs","repos_url":"https://api.github.com/users/epugh/repos","events_url":"https://api.github.com/users/epugh/events{/privacy}","received_events_url":"https://api.github.com/users/epugh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-16T16:45:49Z","updated_at":"2022-12-16T16:45:49Z","author_association":"CONTRIBUTOR","body":"@gabrielmagno how do you want to be credited in `CHANGES.txt`?","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1355201400/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1355341463","html_url":"https://github.com/apache/solr/pull/1213#issuecomment-1355341463","issue_url":"https://api.github.com/repos/apache/solr/issues/1213","id":1355341463,"node_id":"IC_kwDOFFj3yM5QyN6X","user":{"login":"epugh","id":22395,"node_id":"MDQ6VXNlcjIyMzk1","avatar_url":"https://avatars.githubusercontent.com/u/22395?v=4","gravatar_id":"","url":"https://api.github.com/users/epugh","html_url":"https://github.com/epugh","followers_url":"https://api.github.com/users/epugh/followers","following_url":"https://api.github.com/users/epugh/following{/other_user}","gists_url":"https://api.github.com/users/epugh/gists{/gist_id}","starred_url":"https://api.github.com/users/epugh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/epugh/subscriptions","organizations_url":"https://api.github.com/users/epugh/orgs","repos_url":"https://api.github.com/users/epugh/repos","events_url":"https://api.github.com/users/epugh/events{/privacy}","received_events_url":"https://api.github.com/users/epugh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-16T18:08:45Z","updated_at":"2022-12-16T18:08:45Z","author_association":"CONTRIBUTOR","body":"`bin/solr start -example films` no longer creates all the fields.... ","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1355341463/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1355601919","html_url":"https://github.com/apache/solr/pull/1213#issuecomment-1355601919","issue_url":"https://api.github.com/repos/apache/solr/issues/1213","id":1355601919,"node_id":"IC_kwDOFFj3yM5QzNf_","user":{"login":"epugh","id":22395,"node_id":"MDQ6VXNlcjIyMzk1","avatar_url":"https://avatars.githubusercontent.com/u/22395?v=4","gravatar_id":"","url":"https://api.github.com/users/epugh","html_url":"https://github.com/epugh","followers_url":"https://api.github.com/users/epugh/followers","following_url":"https://api.github.com/users/epugh/following{/other_user}","gists_url":"https://api.github.com/users/epugh/gists{/gist_id}","starred_url":"https://api.github.com/users/epugh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/epugh/subscriptions","organizations_url":"https://api.github.com/users/epugh/orgs","repos_url":"https://api.github.com/users/epugh/repos","events_url":"https://api.github.com/users/epugh/events{/privacy}","received_events_url":"https://api.github.com/users/epugh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-16T21:01:32Z","updated_at":"2022-12-16T21:01:32Z","author_association":"CONTRIBUTOR","body":"This is looking really cool...    I wonder, is it worth docuemnting running the python scripts?","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1355601919/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1355742412","html_url":"https://github.com/apache/solr/pull/1155#issuecomment-1355742412","issue_url":"https://api.github.com/repos/apache/solr/issues/1155","id":1355742412,"node_id":"IC_kwDOFFj3yM5QzvzM","user":{"login":"stillalex","id":61026,"node_id":"MDQ6VXNlcjYxMDI2","avatar_url":"https://avatars.githubusercontent.com/u/61026?v=4","gravatar_id":"","url":"https://api.github.com/users/stillalex","html_url":"https://github.com/stillalex","followers_url":"https://api.github.com/users/stillalex/followers","following_url":"https://api.github.com/users/stillalex/following{/other_user}","gists_url":"https://api.github.com/users/stillalex/gists{/gist_id}","starred_url":"https://api.github.com/users/stillalex/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stillalex/subscriptions","organizations_url":"https://api.github.com/users/stillalex/orgs","repos_url":"https://api.github.com/users/stillalex/repos","events_url":"https://api.github.com/users/stillalex/events{/privacy}","received_events_url":"https://api.github.com/users/stillalex/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-16T22:42:20Z","updated_at":"2022-12-16T22:42:20Z","author_association":"MEMBER","body":"@debe I have finally had some time to update the benchmark to remove mockito and only use pure SolrCore code for verification. I think I have taken all the noise out of it, but unfortunately this is back to my initial results, showing a slowdown in the PR, could you take another look?\r\n\r\n[main branch](https://github.com/apache/solr/compare/main...stillalex:SOLR-16497-locks-bench?expand=1):\r\n\r\n```Result \"org.apache.solr.core.SolrCoresBenchTest.getCoreFromAnyList\":\r\n  7013249.176 Â±(99.9%) 420959.068 ops/s [Average]\r\n  (min, avg, max) = (6986952.973, 7013249.176, 7030112.165), stdev = 23074.187\r\n  CI (99.9%): [6592290.109, 7434208.244] (assumes normal distribution)\r\n```\r\n\r\nPR ([main branch + pr patch](https://github.com/apache/solr/compare/main...stillalex:SOLR-16497-locks-bench-and-patch?expand=1)):\r\n\r\n```Result \"org.apache.solr.core.SolrCoresBenchTest.getCoreFromAnyList\":\r\n  1492787.497 Â±(99.9%) 567915.344 ops/s [Average]\r\n  (min, avg, max) = (1468715.133, 1492787.497, 1527941.373), stdev = 31129.356\r\n  CI (99.9%): [924872.153, 2060702.841] (assumes normal distribution)\r\n```\r\n\r\n@dsmiley is the benchmark useful in its current form? I would like to contribute it along with the PR (seeing the results it probably still needs a few tweaks). let me know if this is something you are interested in, otherwise I can leave it out this conversation.","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1355742412/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1355867779","html_url":"https://github.com/apache/solr/pull/1232#issuecomment-1355867779","issue_url":"https://api.github.com/repos/apache/solr/issues/1232","id":1355867779,"node_id":"IC_kwDOFFj3yM5Q0OaD","user":{"login":"stillalex","id":61026,"node_id":"MDQ6VXNlcjYxMDI2","avatar_url":"https://avatars.githubusercontent.com/u/61026?v=4","gravatar_id":"","url":"https://api.github.com/users/stillalex","html_url":"https://github.com/stillalex","followers_url":"https://api.github.com/users/stillalex/followers","following_url":"https://api.github.com/users/stillalex/following{/other_user}","gists_url":"https://api.github.com/users/stillalex/gists{/gist_id}","starred_url":"https://api.github.com/users/stillalex/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stillalex/subscriptions","organizations_url":"https://api.github.com/users/stillalex/orgs","repos_url":"https://api.github.com/users/stillalex/repos","events_url":"https://api.github.com/users/stillalex/events{/privacy}","received_events_url":"https://api.github.com/users/stillalex/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-17T00:23:48Z","updated_at":"2022-12-17T00:23:48Z","author_association":"MEMBER","body":"I think @madrob's proposal fits better, a List.of() looks cleaner to me too.","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1355867779/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1356277738","html_url":"https://github.com/apache/solr/pull/1213#issuecomment-1356277738","issue_url":"https://api.github.com/repos/apache/solr/issues/1213","id":1356277738,"node_id":"IC_kwDOFFj3yM5Q1yfq","user":{"login":"gabrielmagno","id":244890,"node_id":"MDQ6VXNlcjI0NDg5MA==","avatar_url":"https://avatars.githubusercontent.com/u/244890?v=4","gravatar_id":"","url":"https://api.github.com/users/gabrielmagno","html_url":"https://github.com/gabrielmagno","followers_url":"https://api.github.com/users/gabrielmagno/followers","following_url":"https://api.github.com/users/gabrielmagno/following{/other_user}","gists_url":"https://api.github.com/users/gabrielmagno/gists{/gist_id}","starred_url":"https://api.github.com/users/gabrielmagno/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gabrielmagno/subscriptions","organizations_url":"https://api.github.com/users/gabrielmagno/orgs","repos_url":"https://api.github.com/users/gabrielmagno/repos","events_url":"https://api.github.com/users/gabrielmagno/events{/privacy}","received_events_url":"https://api.github.com/users/gabrielmagno/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-17T14:18:14Z","updated_at":"2022-12-17T14:18:14Z","author_association":"CONTRIBUTOR","body":"Hey @epugh !\r\n\r\nYou can credit me as \"Gabriel Magno\".\r\n\r\nWhat about I create a readme file inside the \"vectors\" folder, explaining the utilization of the scripts?","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1356277738/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1358261864","html_url":"https://github.com/apache/solr/pull/1213#issuecomment-1358261864","issue_url":"https://api.github.com/repos/apache/solr/issues/1213","id":1358261864,"node_id":"IC_kwDOFFj3yM5Q9W5o","user":{"login":"krickert","id":313612,"node_id":"MDQ6VXNlcjMxMzYxMg==","avatar_url":"https://avatars.githubusercontent.com/u/313612?v=4","gravatar_id":"","url":"https://api.github.com/users/krickert","html_url":"https://github.com/krickert","followers_url":"https://api.github.com/users/krickert/followers","following_url":"https://api.github.com/users/krickert/following{/other_user}","gists_url":"https://api.github.com/users/krickert/gists{/gist_id}","starred_url":"https://api.github.com/users/krickert/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/krickert/subscriptions","organizations_url":"https://api.github.com/users/krickert/orgs","repos_url":"https://api.github.com/users/krickert/repos","events_url":"https://api.github.com/users/krickert/events{/privacy}","received_events_url":"https://api.github.com/users/krickert/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-19T20:28:13Z","updated_at":"2022-12-19T20:28:13Z","author_association":"NONE","body":"Hello - I just saw these requests and I'd like to (eventually) have a full blog post as to how to create the vector for input with the example being a full wikipedia dump using java, a pretrained model, and deeplearning4j.  I suspect once I have this completed, this can help create an example that can lead to this being a feature in solr.\r\n\r\nWould anyone be up for a discussion on this?  I suppose this point might not be the best place to ask - but this thread is the closest to finding someone who is trying to accomplish the same thing as I'm doing.","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1358261864/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1358960228","html_url":"https://github.com/apache/solr/pull/1208#issuecomment-1358960228","issue_url":"https://api.github.com/repos/apache/solr/issues/1208","id":1358960228,"node_id":"IC_kwDOFFj3yM5RABZk","user":{"login":"noblepaul","id":54862,"node_id":"MDQ6VXNlcjU0ODYy","avatar_url":"https://avatars.githubusercontent.com/u/54862?v=4","gravatar_id":"","url":"https://api.github.com/users/noblepaul","html_url":"https://github.com/noblepaul","followers_url":"https://api.github.com/users/noblepaul/followers","following_url":"https://api.github.com/users/noblepaul/following{/other_user}","gists_url":"https://api.github.com/users/noblepaul/gists{/gist_id}","starred_url":"https://api.github.com/users/noblepaul/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/noblepaul/subscriptions","organizations_url":"https://api.github.com/users/noblepaul/orgs","repos_url":"https://api.github.com/users/noblepaul/repos","events_url":"https://api.github.com/users/noblepaul/events{/privacy}","received_events_url":"https://api.github.com/users/noblepaul/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-20T07:49:46Z","updated_at":"2022-12-20T07:49:46Z","author_association":"CONTRIBUTOR","body":"`If you want to increase the scope to mark these things deprecated, that's be nice!`\r\n\r\nI'll do that .\r\n\r\n`so just move the test to the existing TestConfigReload `\r\n\r\nYes, please","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1358960228/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1360080469","html_url":"https://github.com/apache/solr/pull/1221#issuecomment-1360080469","issue_url":"https://api.github.com/repos/apache/solr/issues/1221","id":1360080469,"node_id":"IC_kwDOFFj3yM5RES5V","user":{"login":"dsmiley","id":377295,"node_id":"MDQ6VXNlcjM3NzI5NQ==","avatar_url":"https://avatars.githubusercontent.com/u/377295?v=4","gravatar_id":"","url":"https://api.github.com/users/dsmiley","html_url":"https://github.com/dsmiley","followers_url":"https://api.github.com/users/dsmiley/followers","following_url":"https://api.github.com/users/dsmiley/following{/other_user}","gists_url":"https://api.github.com/users/dsmiley/gists{/gist_id}","starred_url":"https://api.github.com/users/dsmiley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dsmiley/subscriptions","organizations_url":"https://api.github.com/users/dsmiley/orgs","repos_url":"https://api.github.com/users/dsmiley/repos","events_url":"https://api.github.com/users/dsmiley/events{/privacy}","received_events_url":"https://api.github.com/users/dsmiley/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-20T19:57:11Z","updated_at":"2022-12-20T19:57:11Z","author_association":"CONTRIBUTOR","body":"We should also probably set & clear the MDC so that if we log an issue, we have more context (e.g. *which* core).","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1360080469/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1360406066","html_url":"https://github.com/apache/solr/pull/1215#issuecomment-1360406066","issue_url":"https://api.github.com/repos/apache/solr/issues/1215","id":1360406066,"node_id":"IC_kwDOFFj3yM5RFiYy","user":{"login":"noblepaul","id":54862,"node_id":"MDQ6VXNlcjU0ODYy","avatar_url":"https://avatars.githubusercontent.com/u/54862?v=4","gravatar_id":"","url":"https://api.github.com/users/noblepaul","html_url":"https://github.com/noblepaul","followers_url":"https://api.github.com/users/noblepaul/followers","following_url":"https://api.github.com/users/noblepaul/following{/other_user}","gists_url":"https://api.github.com/users/noblepaul/gists{/gist_id}","starred_url":"https://api.github.com/users/noblepaul/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/noblepaul/subscriptions","organizations_url":"https://api.github.com/users/noblepaul/orgs","repos_url":"https://api.github.com/users/noblepaul/repos","events_url":"https://api.github.com/users/noblepaul/events{/privacy}","received_events_url":"https://api.github.com/users/noblepaul/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-20T22:39:13Z","updated_at":"2022-12-20T22:39:13Z","author_association":"CONTRIBUTOR","body":"why can't we make it properly pluggable?\r\n\r\n```\r\n\"router\" : {\"class\": \"fully.qualified.clasName\"}\r\n```","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1360406066/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1360449384","html_url":"https://github.com/apache/solr/pull/1215#issuecomment-1360449384","issue_url":"https://api.github.com/repos/apache/solr/issues/1215","id":1360449384,"node_id":"IC_kwDOFFj3yM5RFs9o","user":{"login":"dsmiley","id":377295,"node_id":"MDQ6VXNlcjM3NzI5NQ==","avatar_url":"https://avatars.githubusercontent.com/u/377295?v=4","gravatar_id":"","url":"https://api.github.com/users/dsmiley","html_url":"https://github.com/dsmiley","followers_url":"https://api.github.com/users/dsmiley/followers","following_url":"https://api.github.com/users/dsmiley/following{/other_user}","gists_url":"https://api.github.com/users/dsmiley/gists{/gist_id}","starred_url":"https://api.github.com/users/dsmiley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dsmiley/subscriptions","organizations_url":"https://api.github.com/users/dsmiley/orgs","repos_url":"https://api.github.com/users/dsmiley/repos","events_url":"https://api.github.com/users/dsmiley/events{/privacy}","received_events_url":"https://api.github.com/users/dsmiley/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-20T23:21:05Z","updated_at":"2022-12-20T23:21:05Z","author_association":"CONTRIBUTOR","body":"We could; I just chose not to go that far in this PR.  If I did something trivial, I'd be inclined to then document it, test it.  If you think I could skip some of that (rationale: this is \"expert\" option only) then I'd be willing to do that in this PR.","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1360449384/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1360554944","html_url":"https://github.com/apache/solr/pull/1215#issuecomment-1360554944","issue_url":"https://api.github.com/repos/apache/solr/issues/1215","id":1360554944,"node_id":"IC_kwDOFFj3yM5RGGvA","user":{"login":"noblepaul","id":54862,"node_id":"MDQ6VXNlcjU0ODYy","avatar_url":"https://avatars.githubusercontent.com/u/54862?v=4","gravatar_id":"","url":"https://api.github.com/users/noblepaul","html_url":"https://github.com/noblepaul","followers_url":"https://api.github.com/users/noblepaul/followers","following_url":"https://api.github.com/users/noblepaul/following{/other_user}","gists_url":"https://api.github.com/users/noblepaul/gists{/gist_id}","starred_url":"https://api.github.com/users/noblepaul/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/noblepaul/subscriptions","organizations_url":"https://api.github.com/users/noblepaul/orgs","repos_url":"https://api.github.com/users/noblepaul/repos","events_url":"https://api.github.com/users/noblepaul/events{/privacy}","received_events_url":"https://api.github.com/users/noblepaul/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-21T00:25:26Z","updated_at":"2022-12-21T00:29:12Z","author_association":"CONTRIBUTOR","body":"IMHO  this PR is mixing both the new capability and impl. If we could just have a pluggable option, then only experts would use it and that should be fine\r\n\r\nIntroducing a new type of Router needs more reviews","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1360554944/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1360572392","html_url":"https://github.com/apache/solr/pull/1215#issuecomment-1360572392","issue_url":"https://api.github.com/repos/apache/solr/issues/1215","id":1360572392,"node_id":"IC_kwDOFFj3yM5RGK_o","user":{"login":"dsmiley","id":377295,"node_id":"MDQ6VXNlcjM3NzI5NQ==","avatar_url":"https://avatars.githubusercontent.com/u/377295?v=4","gravatar_id":"","url":"https://api.github.com/users/dsmiley","html_url":"https://github.com/dsmiley","followers_url":"https://api.github.com/users/dsmiley/followers","following_url":"https://api.github.com/users/dsmiley/following{/other_user}","gists_url":"https://api.github.com/users/dsmiley/gists{/gist_id}","starred_url":"https://api.github.com/users/dsmiley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dsmiley/subscriptions","organizations_url":"https://api.github.com/users/dsmiley/orgs","repos_url":"https://api.github.com/users/dsmiley/repos","events_url":"https://api.github.com/users/dsmiley/events{/privacy}","received_events_url":"https://api.github.com/users/dsmiley/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-21T00:35:57Z","updated_at":"2022-12-21T00:35:57Z","author_association":"CONTRIBUTOR","body":"I can sympathize somewhat but the change/PR as it is strengthens a weak abstraction, even if it's not pluggable.  _Not all abstractions need to be pluggable_.  I could remove some comments added in the PR that may be suggestive of the possibility of a subclass that actually isn't present.","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1360572392/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1361092894","html_url":"https://github.com/apache/solr/pull/1196#issuecomment-1361092894","issue_url":"https://api.github.com/repos/apache/solr/issues/1196","id":1361092894,"node_id":"IC_kwDOFFj3yM5RIKEe","user":{"login":"bszabo97","id":79325622,"node_id":"MDQ6VXNlcjc5MzI1NjIy","avatar_url":"https://avatars.githubusercontent.com/u/79325622?v=4","gravatar_id":"","url":"https://api.github.com/users/bszabo97","html_url":"https://github.com/bszabo97","followers_url":"https://api.github.com/users/bszabo97/followers","following_url":"https://api.github.com/users/bszabo97/following{/other_user}","gists_url":"https://api.github.com/users/bszabo97/gists{/gist_id}","starred_url":"https://api.github.com/users/bszabo97/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bszabo97/subscriptions","organizations_url":"https://api.github.com/users/bszabo97/orgs","repos_url":"https://api.github.com/users/bszabo97/repos","events_url":"https://api.github.com/users/bszabo97/events{/privacy}","received_events_url":"https://api.github.com/users/bszabo97/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-21T09:51:10Z","updated_at":"2022-12-21T09:51:10Z","author_association":"CONTRIBUTOR","body":"Hello @gerlowskija \r\n\r\nThanks for the heads up and for the great description of what should be changed in the tests. I have added a commit which changes the test and implementation according to your suggestions.\r\nIf you think there is anything around the performance blocker in which I can help with I am more than happy to do so! ","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1361092894/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1361107904","html_url":"https://github.com/apache/solr/pull/1245#issuecomment-1361107904","issue_url":"https://api.github.com/repos/apache/solr/issues/1245","id":1361107904,"node_id":"IC_kwDOFFj3yM5RINvA","user":{"login":"alessandrobenedetti","id":513195,"node_id":"MDQ6VXNlcjUxMzE5NQ==","avatar_url":"https://avatars.githubusercontent.com/u/513195?v=4","gravatar_id":"","url":"https://api.github.com/users/alessandrobenedetti","html_url":"https://github.com/alessandrobenedetti","followers_url":"https://api.github.com/users/alessandrobenedetti/followers","following_url":"https://api.github.com/users/alessandrobenedetti/following{/other_user}","gists_url":"https://api.github.com/users/alessandrobenedetti/gists{/gist_id}","starred_url":"https://api.github.com/users/alessandrobenedetti/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alessandrobenedetti/subscriptions","organizations_url":"https://api.github.com/users/alessandrobenedetti/orgs","repos_url":"https://api.github.com/users/alessandrobenedetti/repos","events_url":"https://api.github.com/users/alessandrobenedetti/events{/privacy}","received_events_url":"https://api.github.com/users/alessandrobenedetti/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-21T10:04:07Z","updated_at":"2022-12-21T10:06:57Z","author_association":"CONTRIBUTOR","body":"> I'm looking closer at KnnQParser; ...\r\n\r\nDavid, your help has been invaluable!\r\nYou are absolutely right and this is an oversight of mine when I did the original review of the pre-filtering work(this naming is quite common in the neural search community).\r\n\r\nI think that I have found the perfect place for this fix and it literally would require few lines of code, rather than the complicate methods that are in place now:\r\n\r\norg.apache.solr.search.QueryUtils#combineQueryAndFilter\r\n`\r\n...\r\n} else if(scoreQuery instanceof KnnVectorQuery){\r\n        (KnnVectorQuery)scoreQuery.setFilter(filterQuery);\r\n      }\r\n      else {\r\n        return new BooleanQuery.Builder()\r\n            .add(scoreQuery, Occur.MUST)\r\n            .add(filterQuery, Occur.FILTER)\r\n            .build();\r\n      }\r\n`\r\nBasically when we combine the query with the filter, we manage the thing differently for KNN queries, and the filter(excluding post filters) is set in the Lucene KnnVectorQuery.\r\nThis happens after the org.apache.solr.search.SolrIndexSearcher#getProcessedFilter in the Searcher, so filters are already cached and separated from post-filters\r\nSo far so good, elegant and minimal code change, filters are processed, everyone is happy...\r\nBUT\r\ncurrently KnnVectorQuery in Lucene has no getters and setters and has all variable as final!!\r\nSo, we are where we are (to be honest, for a library class I would have gone with private variables with getters/setters since the beginning).\r\n\r\nAlso, now Lucene is a separate project, so I basically should do the change in Lucene, then wait for a Lucene release, include it in Solr ect ect \r\n\r\nSo, long story short, my suggestion:\r\n1) we proceed with the current hack, renaming where necessary to make it nicer, but no massive change\r\n2) contribute the change Lucene side, probably removing final, and adding getters/setters or if the community disagree, just adding getters so that It's possible to create a new class from the input one\r\n3) once Lucene releases and we have the code in Solr, do the nice and clean implementation\r\n\r\nlet me know what do you think!","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1361107904/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1361142463","html_url":"https://github.com/apache/solr/pull/1215#issuecomment-1361142463","issue_url":"https://api.github.com/repos/apache/solr/issues/1215","id":1361142463,"node_id":"IC_kwDOFFj3yM5RIWK_","user":{"login":"bruno-roustant","id":33934988,"node_id":"MDQ6VXNlcjMzOTM0OTg4","avatar_url":"https://avatars.githubusercontent.com/u/33934988?v=4","gravatar_id":"","url":"https://api.github.com/users/bruno-roustant","html_url":"https://github.com/bruno-roustant","followers_url":"https://api.github.com/users/bruno-roustant/followers","following_url":"https://api.github.com/users/bruno-roustant/following{/other_user}","gists_url":"https://api.github.com/users/bruno-roustant/gists{/gist_id}","starred_url":"https://api.github.com/users/bruno-roustant/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bruno-roustant/subscriptions","organizations_url":"https://api.github.com/users/bruno-roustant/orgs","repos_url":"https://api.github.com/users/bruno-roustant/repos","events_url":"https://api.github.com/users/bruno-roustant/events{/privacy}","received_events_url":"https://api.github.com/users/bruno-roustant/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-21T10:35:48Z","updated_at":"2022-12-21T10:35:48Z","author_association":"CONTRIBUTOR","body":"@noblepaul I don't fully understand your point RE _\"Introducing a new type of Router needs more reviews\"_.\r\nTo me this PR does not add a new type of DocRouter, as it is centered around CompositeIdRouter. It makes it clearer that only CompositeIdRouter is supported for split operations in SplitOp, SolrIndexSplitter, MigrateCmd. I see no new code, only some refactoring to move key parsing logic inside CompositeIdRouter. Do I miss something?","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1361142463/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1361455049","html_url":"https://github.com/apache/solr/pull/1236#issuecomment-1361455049","issue_url":"https://api.github.com/repos/apache/solr/issues/1236","id":1361455049,"node_id":"IC_kwDOFFj3yM5RJifJ","user":{"login":"magibney","id":6225104,"node_id":"MDQ6VXNlcjYyMjUxMDQ=","avatar_url":"https://avatars.githubusercontent.com/u/6225104?v=4","gravatar_id":"","url":"https://api.github.com/users/magibney","html_url":"https://github.com/magibney","followers_url":"https://api.github.com/users/magibney/followers","following_url":"https://api.github.com/users/magibney/following{/other_user}","gists_url":"https://api.github.com/users/magibney/gists{/gist_id}","starred_url":"https://api.github.com/users/magibney/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/magibney/subscriptions","organizations_url":"https://api.github.com/users/magibney/orgs","repos_url":"https://api.github.com/users/magibney/repos","events_url":"https://api.github.com/users/magibney/events{/privacy}","received_events_url":"https://api.github.com/users/magibney/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-21T15:07:54Z","updated_at":"2022-12-21T15:07:54Z","author_association":"CONTRIBUTOR","body":"Thanks everyone; committed and backported to `branch_9x` and `branch_9_1`.","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1361455049/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1361661204","html_url":"https://github.com/apache/solr/pull/1245#issuecomment-1361661204","issue_url":"https://api.github.com/repos/apache/solr/issues/1245","id":1361661204,"node_id":"IC_kwDOFFj3yM5RKU0U","user":{"login":"alessandrobenedetti","id":513195,"node_id":"MDQ6VXNlcjUxMzE5NQ==","avatar_url":"https://avatars.githubusercontent.com/u/513195?v=4","gravatar_id":"","url":"https://api.github.com/users/alessandrobenedetti","html_url":"https://github.com/alessandrobenedetti","followers_url":"https://api.github.com/users/alessandrobenedetti/followers","following_url":"https://api.github.com/users/alessandrobenedetti/following{/other_user}","gists_url":"https://api.github.com/users/alessandrobenedetti/gists{/gist_id}","starred_url":"https://api.github.com/users/alessandrobenedetti/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alessandrobenedetti/subscriptions","organizations_url":"https://api.github.com/users/alessandrobenedetti/orgs","repos_url":"https://api.github.com/users/alessandrobenedetti/repos","events_url":"https://api.github.com/users/alessandrobenedetti/events{/privacy}","received_events_url":"https://api.github.com/users/alessandrobenedetti/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-21T16:49:28Z","updated_at":"2022-12-21T16:49:28Z","author_association":"CONTRIBUTOR","body":"Ok, I updated the PR, this is what I have done:\r\n1) workaround to fix the bug and renames suggested by @dsmiley \r\n2) opened a pull request in Lucene to implement getters in the KnnVectorQuery:  https://github.com/apache/lucene/pull/12029/files\r\n\r\nUnless any additional good ideas, I would go with this now.\r\nThen as soon as the Lucene side is sorted out and in Solr, I would implement the optimal approach, removing all the redundant code and just managing the filters in the org.apache.solr.search.QueryUtils#combineQueryAndFilter ( it will be so easy and clean, it's a shame I can't do it immediately)","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1361661204/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1361754709","html_url":"https://github.com/apache/solr/pull/1242#issuecomment-1361754709","issue_url":"https://api.github.com/repos/apache/solr/issues/1242","id":1361754709,"node_id":"IC_kwDOFFj3yM5RKrpV","user":{"login":"patsonluk","id":2895902,"node_id":"MDQ6VXNlcjI4OTU5MDI=","avatar_url":"https://avatars.githubusercontent.com/u/2895902?v=4","gravatar_id":"","url":"https://api.github.com/users/patsonluk","html_url":"https://github.com/patsonluk","followers_url":"https://api.github.com/users/patsonluk/followers","following_url":"https://api.github.com/users/patsonluk/following{/other_user}","gists_url":"https://api.github.com/users/patsonluk/gists{/gist_id}","starred_url":"https://api.github.com/users/patsonluk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/patsonluk/subscriptions","organizations_url":"https://api.github.com/users/patsonluk/orgs","repos_url":"https://api.github.com/users/patsonluk/repos","events_url":"https://api.github.com/users/patsonluk/events{/privacy}","received_events_url":"https://api.github.com/users/patsonluk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-21T17:51:58Z","updated_at":"2022-12-21T17:51:58Z","author_association":"CONTRIBUTOR","body":"> @justinrsweeney @patsonluk this is still WIP , reviews are welcome\r\n\r\nThanks for the work @noblepaul ! Just want to confirm that there are mainly 2 goals here:\r\n1. Avoid making copies of DocCollections when `copyWith` is called (related to PRS updates)\r\n2. Avoid fetching PRS states until the state is actually queried (the Lazy PRS provider part)\r\n\r\nDo we know the general overhead of the current designs and whether they are causing issues? I agree that both changes will for sure reduce resource usage!","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1361754709/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1361766495","html_url":"https://github.com/apache/solr/pull/1245#issuecomment-1361766495","issue_url":"https://api.github.com/repos/apache/solr/issues/1245","id":1361766495,"node_id":"IC_kwDOFFj3yM5RKuhf","user":{"login":"dsmiley","id":377295,"node_id":"MDQ6VXNlcjM3NzI5NQ==","avatar_url":"https://avatars.githubusercontent.com/u/377295?v=4","gravatar_id":"","url":"https://api.github.com/users/dsmiley","html_url":"https://github.com/dsmiley","followers_url":"https://api.github.com/users/dsmiley/followers","following_url":"https://api.github.com/users/dsmiley/following{/other_user}","gists_url":"https://api.github.com/users/dsmiley/gists{/gist_id}","starred_url":"https://api.github.com/users/dsmiley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dsmiley/subscriptions","organizations_url":"https://api.github.com/users/dsmiley/orgs","repos_url":"https://api.github.com/users/dsmiley/repos","events_url":"https://api.github.com/users/dsmiley/events{/privacy}","received_events_url":"https://api.github.com/users/dsmiley/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-21T17:58:54Z","updated_at":"2022-12-21T17:58:54Z","author_association":"CONTRIBUTOR","body":"Thanks for your complements.\r\n\r\nCan't you simply use SolrIndexSearcher#getProcessedFilter now?\r\n\r\nAs to your proposal, I am confused as to exactly where you propose inserting the logic you provided a snippet of.  If you propose SolrIndexSearcher somewhere then I don't like it because it's clearly special casing a specific query which is a design problem.  Are you trying to basically *move* certain FQs out of their top level position and into/embedded in a particular parsed query?","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1361766495/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1361847032","html_url":"https://github.com/apache/solr/pull/1245#issuecomment-1361847032","issue_url":"https://api.github.com/repos/apache/solr/issues/1245","id":1361847032,"node_id":"IC_kwDOFFj3yM5RLCL4","user":{"login":"alessandrobenedetti","id":513195,"node_id":"MDQ6VXNlcjUxMzE5NQ==","avatar_url":"https://avatars.githubusercontent.com/u/513195?v=4","gravatar_id":"","url":"https://api.github.com/users/alessandrobenedetti","html_url":"https://github.com/alessandrobenedetti","followers_url":"https://api.github.com/users/alessandrobenedetti/followers","following_url":"https://api.github.com/users/alessandrobenedetti/following{/other_user}","gists_url":"https://api.github.com/users/alessandrobenedetti/gists{/gist_id}","starred_url":"https://api.github.com/users/alessandrobenedetti/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alessandrobenedetti/subscriptions","organizations_url":"https://api.github.com/users/alessandrobenedetti/orgs","repos_url":"https://api.github.com/users/alessandrobenedetti/repos","events_url":"https://api.github.com/users/alessandrobenedetti/events{/privacy}","received_events_url":"https://api.github.com/users/alessandrobenedetti/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-21T18:33:28Z","updated_at":"2022-12-21T18:33:28Z","author_association":"CONTRIBUTOR","body":"Hi @dsmiley ,\r\nonce we have the Lucene changes, the idea is to change this method:\r\norg.apache.solr.search.QueryUtils#combineQueryAndFilter\r\nwith an additional if clause:\r\n`else {\r\n        return new BooleanQuery.Builder()\r\n            .add(scoreQuery, Occur.MUST)\r\n            .add(filterQuery, Occur.FILTER)\r\n            .build();\r\n      }`\r\n      \r\n      will become:\r\n      `else if{scoreQuery instanceof KnnVectorQuery}{\r\n      return new KnnVectorQuery(scoreQuery,filterQuery);} \r\n      else{\r\n        return new BooleanQuery.Builder()\r\n            .add(scoreQuery, Occur.MUST)\r\n            .add(filterQuery, Occur.FILTER)\r\n            .build();\r\n      }`\r\n\r\nJust to give an idea, the final code will look different as we will have to create a new instance of KnnVectorQuery using the getters of the old one.\r\nWith this change, we will be able to simplify the KnnQueryParser removing all the stuff for pre-filters and post-filters.\r\nGetProcessedFilters will be called just once as usual and we'll get the benefit of caching and post-0filter separation automatically.\r\nSolrIndexSearcher won't be touched at all.\r\n","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1361847032/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1361848344","html_url":"https://github.com/apache/solr/pull/1245#issuecomment-1361848344","issue_url":"https://api.github.com/repos/apache/solr/issues/1245","id":1361848344,"node_id":"IC_kwDOFFj3yM5RLCgY","user":{"login":"alessandrobenedetti","id":513195,"node_id":"MDQ6VXNlcjUxMzE5NQ==","avatar_url":"https://avatars.githubusercontent.com/u/513195?v=4","gravatar_id":"","url":"https://api.github.com/users/alessandrobenedetti","html_url":"https://github.com/alessandrobenedetti","followers_url":"https://api.github.com/users/alessandrobenedetti/followers","following_url":"https://api.github.com/users/alessandrobenedetti/following{/other_user}","gists_url":"https://api.github.com/users/alessandrobenedetti/gists{/gist_id}","starred_url":"https://api.github.com/users/alessandrobenedetti/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alessandrobenedetti/subscriptions","organizations_url":"https://api.github.com/users/alessandrobenedetti/orgs","repos_url":"https://api.github.com/users/alessandrobenedetti/repos","events_url":"https://api.github.com/users/alessandrobenedetti/events{/privacy}","received_events_url":"https://api.github.com/users/alessandrobenedetti/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-21T18:34:05Z","updated_at":"2022-12-21T18:34:05Z","author_association":"CONTRIBUTOR","body":"And yes, in the workaround I can use the getProcessedFilters and I will, but once we have the Lucene side it will go away.","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1361848344/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1361863063","html_url":"https://github.com/apache/solr/pull/1245#issuecomment-1361863063","issue_url":"https://api.github.com/repos/apache/solr/issues/1245","id":1361863063,"node_id":"IC_kwDOFFj3yM5RLGGX","user":{"login":"dsmiley","id":377295,"node_id":"MDQ6VXNlcjM3NzI5NQ==","avatar_url":"https://avatars.githubusercontent.com/u/377295?v=4","gravatar_id":"","url":"https://api.github.com/users/dsmiley","html_url":"https://github.com/dsmiley","followers_url":"https://api.github.com/users/dsmiley/followers","following_url":"https://api.github.com/users/dsmiley/following{/other_user}","gists_url":"https://api.github.com/users/dsmiley/gists{/gist_id}","starred_url":"https://api.github.com/users/dsmiley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dsmiley/subscriptions","organizations_url":"https://api.github.com/users/dsmiley/orgs","repos_url":"https://api.github.com/users/dsmiley/repos","events_url":"https://api.github.com/users/dsmiley/events{/privacy}","received_events_url":"https://api.github.com/users/dsmiley/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-21T18:40:43Z","updated_at":"2022-12-21T18:40:43Z","author_association":"CONTRIBUTOR","body":"A special case nearly anywhere (except directly in KNN oriented code of course) is a design/maintenance issue.  Some special cases like MatchAllDocs are understandable but a check for KNN in QueryUtils... eh... :-/    Maybe you could show in a new PR what this would look like so I could see.  Perhaps when I understand better what you are trying to accomplish, I'll see a better solution.\r\n\r\n> (me:) Are you trying to basically move certain FQs out of their top level position and into/embedded in a particular parsed query?\r\n\r\nCould you respond to that please?\r\n","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1361863063/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1361889301","html_url":"https://github.com/apache/solr/pull/1245#issuecomment-1361889301","issue_url":"https://api.github.com/repos/apache/solr/issues/1245","id":1361889301,"node_id":"IC_kwDOFFj3yM5RLMgV","user":{"login":"alessandrobenedetti","id":513195,"node_id":"MDQ6VXNlcjUxMzE5NQ==","avatar_url":"https://avatars.githubusercontent.com/u/513195?v=4","gravatar_id":"","url":"https://api.github.com/users/alessandrobenedetti","html_url":"https://github.com/alessandrobenedetti","followers_url":"https://api.github.com/users/alessandrobenedetti/followers","following_url":"https://api.github.com/users/alessandrobenedetti/following{/other_user}","gists_url":"https://api.github.com/users/alessandrobenedetti/gists{/gist_id}","starred_url":"https://api.github.com/users/alessandrobenedetti/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alessandrobenedetti/subscriptions","organizations_url":"https://api.github.com/users/alessandrobenedetti/orgs","repos_url":"https://api.github.com/users/alessandrobenedetti/repos","events_url":"https://api.github.com/users/alessandrobenedetti/events{/privacy}","received_events_url":"https://api.github.com/users/alessandrobenedetti/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-21T18:51:49Z","updated_at":"2022-12-21T18:51:49Z","author_association":"CONTRIBUTOR","body":"Ok, I'll produce another branch with the example code assuming Lucene changes are there.\r\n\r\nSo what I am trying to accomplish:\r\n1) Knn Query has a Query filter as a constructor parameter (and instance variable). This filter is meant to be a pre-filter(in Approximate Nearest Neighbour search means a filter that is executed before the Top K nearest neighbors are returned).\r\nIt is used internally in the approximate nearest neighbor search Lucene code to only accept certain neighbors from the graph(along with the alive bitSet)\r\n2) In Apache Solr we need to make sure that all filter queries except explicit post-filters are processed and set in the Knn Query.\r\n3) But parsing happens before the Searcher will process the filters. So if are able to modify the Lucene KnnQuery in org.apache.solr.search.QueryUtils#combineQueryAndFilter (or create a new one), we are done.\r\n\r\nRight now we process the filters at parsing time (ad do it again in the Searcher).\r\nPotentially we could process and remove the filters from the request in the query parser, but it seems nasty to me, hence my idea of modifying the combineQueryAndFilter.\r\nBecause that method has the responsibility of building a new Query, combining the main Query and all filters(except post-filters).\r\nSo it seems the perfect place for implementing the custom logic for the KnnQuery, that behaves differently when you combine it with filters.\r\n\r\nHope this helps with context @dsmiley !\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1361889301/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1362008815","html_url":"https://github.com/apache/solr/pull/1245#issuecomment-1362008815","issue_url":"https://api.github.com/repos/apache/solr/issues/1245","id":1362008815,"node_id":"IC_kwDOFFj3yM5RLprv","user":{"login":"alessandrobenedetti","id":513195,"node_id":"MDQ6VXNlcjUxMzE5NQ==","avatar_url":"https://avatars.githubusercontent.com/u/513195?v=4","gravatar_id":"","url":"https://api.github.com/users/alessandrobenedetti","html_url":"https://github.com/alessandrobenedetti","followers_url":"https://api.github.com/users/alessandrobenedetti/followers","following_url":"https://api.github.com/users/alessandrobenedetti/following{/other_user}","gists_url":"https://api.github.com/users/alessandrobenedetti/gists{/gist_id}","starred_url":"https://api.github.com/users/alessandrobenedetti/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alessandrobenedetti/subscriptions","organizations_url":"https://api.github.com/users/alessandrobenedetti/orgs","repos_url":"https://api.github.com/users/alessandrobenedetti/repos","events_url":"https://api.github.com/users/alessandrobenedetti/events{/privacy}","received_events_url":"https://api.github.com/users/alessandrobenedetti/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-21T19:39:30Z","updated_at":"2022-12-21T19:39:30Z","author_association":"CONTRIBUTOR","body":"here a rough pull request just to give you the idea @dsmiley :\r\nhttps://github.com/apache/solr/pull/1246/files","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1362008815/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1362270740","html_url":"https://github.com/apache/solr/pull/1215#issuecomment-1362270740","issue_url":"https://api.github.com/repos/apache/solr/issues/1215","id":1362270740,"node_id":"IC_kwDOFFj3yM5RMpoU","user":{"login":"noblepaul","id":54862,"node_id":"MDQ6VXNlcjU0ODYy","avatar_url":"https://avatars.githubusercontent.com/u/54862?v=4","gravatar_id":"","url":"https://api.github.com/users/noblepaul","html_url":"https://github.com/noblepaul","followers_url":"https://api.github.com/users/noblepaul/followers","following_url":"https://api.github.com/users/noblepaul/following{/other_user}","gists_url":"https://api.github.com/users/noblepaul/gists{/gist_id}","starred_url":"https://api.github.com/users/noblepaul/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/noblepaul/subscriptions","organizations_url":"https://api.github.com/users/noblepaul/orgs","repos_url":"https://api.github.com/users/noblepaul/repos","events_url":"https://api.github.com/users/noblepaul/events{/privacy}","received_events_url":"https://api.github.com/users/noblepaul/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-22T01:03:50Z","updated_at":"2022-12-22T01:03:50Z","author_association":"CONTRIBUTOR","body":"```To me this PR does not add a new type of DocRouter, as it is centered around CompositeIdRouter```\r\n\r\nI was confused by the original description.  thought this was trying to introduce a new `DocRouter` by enhancing `CompositeIdRouter`\r\n\r\nThis PR is about  moving all the logic of routing /splitting into  `CompositeIdRouter`","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1362270740/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1362371622","html_url":"https://github.com/apache/solr/pull/1242#issuecomment-1362371622","issue_url":"https://api.github.com/repos/apache/solr/issues/1242","id":1362371622,"node_id":"IC_kwDOFFj3yM5RNCQm","user":{"login":"noblepaul","id":54862,"node_id":"MDQ6VXNlcjU0ODYy","avatar_url":"https://avatars.githubusercontent.com/u/54862?v=4","gravatar_id":"","url":"https://api.github.com/users/noblepaul","html_url":"https://github.com/noblepaul","followers_url":"https://api.github.com/users/noblepaul/followers","following_url":"https://api.github.com/users/noblepaul/following{/other_user}","gists_url":"https://api.github.com/users/noblepaul/gists{/gist_id}","starred_url":"https://api.github.com/users/noblepaul/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/noblepaul/subscriptions","organizations_url":"https://api.github.com/users/noblepaul/orgs","repos_url":"https://api.github.com/users/noblepaul/repos","events_url":"https://api.github.com/users/noblepaul/events{/privacy}","received_events_url":"https://api.github.com/users/noblepaul/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-22T03:41:21Z","updated_at":"2022-12-22T03:41:21Z","author_association":"CONTRIBUTOR","body":">Avoid making copies of DocCollections when copyWith is called (related to PRS updates)\r\n\r\nYes\r\n\r\n> Avoid fetching PRS states until the state is actually queried (the Lazy PRS provider part)\r\n\r\nThis behavior is not changed. But what is changed is all states are **always** queried just in time. Prior to this , the states were copied into the object when it was constructed\r\n","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1362371622/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1362615619","html_url":"https://github.com/apache/solr/pull/1245#issuecomment-1362615619","issue_url":"https://api.github.com/repos/apache/solr/issues/1245","id":1362615619,"node_id":"IC_kwDOFFj3yM5RN91D","user":{"login":"alessandrobenedetti","id":513195,"node_id":"MDQ6VXNlcjUxMzE5NQ==","avatar_url":"https://avatars.githubusercontent.com/u/513195?v=4","gravatar_id":"","url":"https://api.github.com/users/alessandrobenedetti","html_url":"https://github.com/alessandrobenedetti","followers_url":"https://api.github.com/users/alessandrobenedetti/followers","following_url":"https://api.github.com/users/alessandrobenedetti/following{/other_user}","gists_url":"https://api.github.com/users/alessandrobenedetti/gists{/gist_id}","starred_url":"https://api.github.com/users/alessandrobenedetti/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alessandrobenedetti/subscriptions","organizations_url":"https://api.github.com/users/alessandrobenedetti/orgs","repos_url":"https://api.github.com/users/alessandrobenedetti/repos","events_url":"https://api.github.com/users/alessandrobenedetti/events{/privacy}","received_events_url":"https://api.github.com/users/alessandrobenedetti/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-22T09:35:20Z","updated_at":"2022-12-22T09:35:20Z","author_association":"CONTRIBUTOR","body":"Refactored a bit, removed custom code and used getProcessedFilter.\r\nIt looks much better now, but still, the getProcessedFilter is done twice.\r\nIt's probably an acceptable workaround at the moment?\r\nI created the tentative branch to show what it would be like when we have access to the internal of the KNN Query (which I still believe to be ideal).\r\nOpen to better ideas and thanks again for the review @dsmiley !","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1362615619/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1362788990","html_url":"https://github.com/apache/solr/pull/1245#issuecomment-1362788990","issue_url":"https://api.github.com/repos/apache/solr/issues/1245","id":1362788990,"node_id":"IC_kwDOFFj3yM5ROoJ-","user":{"login":"epugh","id":22395,"node_id":"MDQ6VXNlcjIyMzk1","avatar_url":"https://avatars.githubusercontent.com/u/22395?v=4","gravatar_id":"","url":"https://api.github.com/users/epugh","html_url":"https://github.com/epugh","followers_url":"https://api.github.com/users/epugh/followers","following_url":"https://api.github.com/users/epugh/following{/other_user}","gists_url":"https://api.github.com/users/epugh/gists{/gist_id}","starred_url":"https://api.github.com/users/epugh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/epugh/subscriptions","organizations_url":"https://api.github.com/users/epugh/orgs","repos_url":"https://api.github.com/users/epugh/repos","events_url":"https://api.github.com/users/epugh/events{/privacy}","received_events_url":"https://api.github.com/users/epugh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-22T12:37:23Z","updated_at":"2022-12-22T12:37:23Z","author_association":"CONTRIBUTOR","body":"Just wanted to comment what a great discussion this has been...  I learned some new stuff...","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1362788990/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1362841293","html_url":"https://github.com/apache/solr/pull/1213#issuecomment-1362841293","issue_url":"https://api.github.com/repos/apache/solr/issues/1213","id":1362841293,"node_id":"IC_kwDOFFj3yM5RO07N","user":{"login":"epugh","id":22395,"node_id":"MDQ6VXNlcjIyMzk1","avatar_url":"https://avatars.githubusercontent.com/u/22395?v=4","gravatar_id":"","url":"https://api.github.com/users/epugh","html_url":"https://github.com/epugh","followers_url":"https://api.github.com/users/epugh/followers","following_url":"https://api.github.com/users/epugh/following{/other_user}","gists_url":"https://api.github.com/users/epugh/gists{/gist_id}","starred_url":"https://api.github.com/users/epugh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/epugh/subscriptions","organizations_url":"https://api.github.com/users/epugh/orgs","repos_url":"https://api.github.com/users/epugh/repos","events_url":"https://api.github.com/users/epugh/events{/privacy}","received_events_url":"https://api.github.com/users/epugh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-22T13:28:32Z","updated_at":"2022-12-22T13:28:32Z","author_association":"CONTRIBUTOR","body":"@krickert one thought that I have is that having this sequence of events would be useful in benchmarking Solr's performance in this evolving space of dense vectors ;-).    I think it would be a fantastic tutorial as well...    I suggest you join the dev@solr.apache.org mailing list and ask there! ","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1362841293/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1362848270","html_url":"https://github.com/apache/solr/pull/1213#issuecomment-1362848270","issue_url":"https://api.github.com/repos/apache/solr/issues/1213","id":1362848270,"node_id":"IC_kwDOFFj3yM5RO2oO","user":{"login":"krickert","id":313612,"node_id":"MDQ6VXNlcjMxMzYxMg==","avatar_url":"https://avatars.githubusercontent.com/u/313612?v=4","gravatar_id":"","url":"https://api.github.com/users/krickert","html_url":"https://github.com/krickert","followers_url":"https://api.github.com/users/krickert/followers","following_url":"https://api.github.com/users/krickert/following{/other_user}","gists_url":"https://api.github.com/users/krickert/gists{/gist_id}","starred_url":"https://api.github.com/users/krickert/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/krickert/subscriptions","organizations_url":"https://api.github.com/users/krickert/orgs","repos_url":"https://api.github.com/users/krickert/repos","events_url":"https://api.github.com/users/krickert/events{/privacy}","received_events_url":"https://api.github.com/users/krickert/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-22T13:35:53Z","updated_at":"2022-12-22T13:35:53Z","author_association":"NONE","body":"Thanks!\n\nI have to get it to the point where I get the dents vectors and the vector\nsearch working first :) after that I would be glad to write a tutorial.\n\nI'll open up a discussion. I'd like someone to ensure that I'm calculating\nthe debate vectors right.  Thanks. I'll ask there!\n\nOn Thu, Dec 22, 2022, 08:28 Eric Pugh ***@***.***> wrote:\n\n> @krickert <https://github.com/krickert> one thought that I have is that\n> having this sequence of events would be useful in benchmarking Solr's\n> performance in this evolving space of dense vectors ;-). I think it would\n> be a fantastic tutorial as well... I suggest you join the\n> ***@***.*** mailing list and ask there!\n>\n> â\n> Reply to this email directly, view it on GitHub\n> <https://github.com/apache/solr/pull/1213#issuecomment-1362841293>, or\n> unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/AACMSDFYSLVPUID6MNAICSDWORJQZANCNFSM6AAAAAASUIVWLU>\n> .\n> You are receiving this because you were mentioned.Message ID:\n> ***@***.***>\n>\n","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1362848270/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1363701253","html_url":"https://github.com/apache/solr/pull/1155#issuecomment-1363701253","issue_url":"https://api.github.com/repos/apache/solr/issues/1155","id":1363701253,"node_id":"IC_kwDOFFj3yM5RSG4F","user":{"login":"DennisBerger1984","id":69144692,"node_id":"MDQ6VXNlcjY5MTQ0Njky","avatar_url":"https://avatars.githubusercontent.com/u/69144692?v=4","gravatar_id":"","url":"https://api.github.com/users/DennisBerger1984","html_url":"https://github.com/DennisBerger1984","followers_url":"https://api.github.com/users/DennisBerger1984/followers","following_url":"https://api.github.com/users/DennisBerger1984/following{/other_user}","gists_url":"https://api.github.com/users/DennisBerger1984/gists{/gist_id}","starred_url":"https://api.github.com/users/DennisBerger1984/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DennisBerger1984/subscriptions","organizations_url":"https://api.github.com/users/DennisBerger1984/orgs","repos_url":"https://api.github.com/users/DennisBerger1984/repos","events_url":"https://api.github.com/users/DennisBerger1984/events{/privacy}","received_events_url":"https://api.github.com/users/DennisBerger1984/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-23T07:44:26Z","updated_at":"2022-12-23T08:48:04Z","author_association":"NONE","body":"@stillalex Hi Alex, before I'll go into christmas holidays, we're back in january, we'd like to comment on your recent results.\r\nWe think synchronized is currently faster because there is some substantial work inside the synchronized block missing, compared to a real world scenario. The reason for this is that the cloudDescriptor is null and therefore 3 `MDC.put()` calls in `MDCLoggingContext.setCoreDescriptor()` are not getting executed and we've noticed that the core doesn't get closed anymore, but it should probably be closed inside the benchmark.\r\n\r\nFirst we'd like to thank you again for bringing up the discussion about how to prove that certain code paths are perfoming better or worse and to increase the understanding about locking in the solr community. We think this was a great idea and basically the question behind it is \"does this PR help at all to make things better\". Nevertheless we've difficulties to take conclusions from the outcome of this benchmark. What it basically does is it answers the question whether a function call to `getCoreFromAnyList()` without thread congestion and side effects performs better or worse when using sychronized vs. ReentrantReadWriteLock. The answer is that synchronized will perform similar or better depending on the number of CPU cores and that it uses far less resources. We suspect that the adaptive spinning of the lightweight locks used in synchronized in the JVM learns pretty quickly, that the benchmark consists mostly of a synchronized block and that there is not much that can run in parallel anyway and how to align the calls to `getCoreFromAnyList()` to get away with no heavy weight locking at all.\r\n\r\nSo the problem is the synchronized behaviour of an entire solr when thread congestion, sideeffects like a big ThreadContext, other method calls grabbing the lock and possibly IO are happening. Then you can't guarantee that fast behaviour any more and it is very difficult to construct a micro benchmark that covers such cases. What ReentrantReadWriteLock can guarantee you is that it will never block read access even when you have congestion and lots of side effects, like slow MDC.put() calls, a big ThreadContext and so on. That's the most valuable advantage. In the new year we can do a macro (e.g. http) benchmark on our side again to verify a benefit and extract flight recorder dumps plus we plan to measure timings in each synchronized entrance and exit. Maybe we can find the root cause of long waits for the lock. But then again it's not about that our use case will be much faster then, it's about that you can construct a solr usage pattern which will severely suffer from synchronized blocks but which will never suffer using a ReentrantReadWriteLock.\r\n\r\nSincerely, \r\n@mpetris(Marco) and @debe (Dennis)\r\n","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1363701253/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1363888032","html_url":"https://github.com/apache/solr/pull/1248#issuecomment-1363888032","issue_url":"https://api.github.com/repos/apache/solr/issues/1248","id":1363888032,"node_id":"IC_kwDOFFj3yM5RS0eg","user":{"login":"epugh","id":22395,"node_id":"MDQ6VXNlcjIyMzk1","avatar_url":"https://avatars.githubusercontent.com/u/22395?v=4","gravatar_id":"","url":"https://api.github.com/users/epugh","html_url":"https://github.com/epugh","followers_url":"https://api.github.com/users/epugh/followers","following_url":"https://api.github.com/users/epugh/following{/other_user}","gists_url":"https://api.github.com/users/epugh/gists{/gist_id}","starred_url":"https://api.github.com/users/epugh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/epugh/subscriptions","organizations_url":"https://api.github.com/users/epugh/orgs","repos_url":"https://api.github.com/users/epugh/repos","events_url":"https://api.github.com/users/epugh/events{/privacy}","received_events_url":"https://api.github.com/users/epugh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-23T11:51:02Z","updated_at":"2022-12-23T11:51:02Z","author_association":"CONTRIBUTOR","body":"So, with these changes, a lot of tests fail... For example \"DistributedExpandComponentTest\"","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1363888032/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1364109540","html_url":"https://github.com/apache/solr/pull/1248#issuecomment-1364109540","issue_url":"https://api.github.com/repos/apache/solr/issues/1248","id":1364109540,"node_id":"IC_kwDOFFj3yM5RTqjk","user":{"login":"epugh","id":22395,"node_id":"MDQ6VXNlcjIyMzk1","avatar_url":"https://avatars.githubusercontent.com/u/22395?v=4","gravatar_id":"","url":"https://api.github.com/users/epugh","html_url":"https://github.com/epugh","followers_url":"https://api.github.com/users/epugh/followers","following_url":"https://api.github.com/users/epugh/following{/other_user}","gists_url":"https://api.github.com/users/epugh/gists{/gist_id}","starred_url":"https://api.github.com/users/epugh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/epugh/subscriptions","organizations_url":"https://api.github.com/users/epugh/orgs","repos_url":"https://api.github.com/users/epugh/repos","events_url":"https://api.github.com/users/epugh/events{/privacy}","received_events_url":"https://api.github.com/users/epugh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-23T16:47:30Z","updated_at":"2022-12-23T16:47:30Z","author_association":"CONTRIBUTOR","body":"So...    I can't get a clean run of tests on any branch of solr on my laptop....    ","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1364109540/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1364110212","html_url":"https://github.com/apache/solr/pull/1248#issuecomment-1364110212","issue_url":"https://api.github.com/repos/apache/solr/issues/1248","id":1364110212,"node_id":"IC_kwDOFFj3yM5RTquE","user":{"login":"epugh","id":22395,"node_id":"MDQ6VXNlcjIyMzk1","avatar_url":"https://avatars.githubusercontent.com/u/22395?v=4","gravatar_id":"","url":"https://api.github.com/users/epugh","html_url":"https://github.com/epugh","followers_url":"https://api.github.com/users/epugh/followers","following_url":"https://api.github.com/users/epugh/following{/other_user}","gists_url":"https://api.github.com/users/epugh/gists{/gist_id}","starred_url":"https://api.github.com/users/epugh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/epugh/subscriptions","organizations_url":"https://api.github.com/users/epugh/orgs","repos_url":"https://api.github.com/users/epugh/repos","events_url":"https://api.github.com/users/epugh/events{/privacy}","received_events_url":"https://api.github.com/users/epugh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-23T16:48:42Z","updated_at":"2022-12-23T16:48:42Z","author_association":"CONTRIBUTOR","body":"So, `setParallelCacheRefreshes` appears to be a odd setting....   Does anyone actually change it/use it?  Or do we all just use the default of 3?    There don't appear to be any tests for it....   Thoughts on eliminating it?","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1364110212/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1364564267","html_url":"https://github.com/apache/solr/pull/1250#issuecomment-1364564267","issue_url":"https://api.github.com/repos/apache/solr/issues/1250","id":1364564267,"node_id":"IC_kwDOFFj3yM5RVZkr","user":{"login":"epugh","id":22395,"node_id":"MDQ6VXNlcjIyMzk1","avatar_url":"https://avatars.githubusercontent.com/u/22395?v=4","gravatar_id":"","url":"https://api.github.com/users/epugh","html_url":"https://github.com/epugh","followers_url":"https://api.github.com/users/epugh/followers","following_url":"https://api.github.com/users/epugh/following{/other_user}","gists_url":"https://api.github.com/users/epugh/gists{/gist_id}","starred_url":"https://api.github.com/users/epugh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/epugh/subscriptions","organizations_url":"https://api.github.com/users/epugh/orgs","repos_url":"https://api.github.com/users/epugh/repos","events_url":"https://api.github.com/users/epugh/events{/privacy}","received_events_url":"https://api.github.com/users/epugh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-24T17:56:17Z","updated_at":"2022-12-24T17:56:17Z","author_association":"CONTRIBUTOR","body":"This worked great!  How would you like to be credited in the `solr/CHANGES.txt` file???","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1364564267/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1364566486","html_url":"https://github.com/apache/solr/pull/1250#issuecomment-1364566486","issue_url":"https://api.github.com/repos/apache/solr/issues/1250","id":1364566486,"node_id":"IC_kwDOFFj3yM5RVaHW","user":{"login":"stillalex","id":61026,"node_id":"MDQ6VXNlcjYxMDI2","avatar_url":"https://avatars.githubusercontent.com/u/61026?v=4","gravatar_id":"","url":"https://api.github.com/users/stillalex","html_url":"https://github.com/stillalex","followers_url":"https://api.github.com/users/stillalex/followers","following_url":"https://api.github.com/users/stillalex/following{/other_user}","gists_url":"https://api.github.com/users/stillalex/gists{/gist_id}","starred_url":"https://api.github.com/users/stillalex/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stillalex/subscriptions","organizations_url":"https://api.github.com/users/stillalex/orgs","repos_url":"https://api.github.com/users/stillalex/repos","events_url":"https://api.github.com/users/stillalex/events{/privacy}","received_events_url":"https://api.github.com/users/stillalex/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-24T18:11:48Z","updated_at":"2022-12-24T18:11:48Z","author_association":"MEMBER","body":"sure @epugh I added my name to this ticket, hope that works for you","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1364566486/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1364712912","html_url":"https://github.com/apache/solr/pull/1248#issuecomment-1364712912","issue_url":"https://api.github.com/repos/apache/solr/issues/1248","id":1364712912,"node_id":"IC_kwDOFFj3yM5RV93Q","user":{"login":"stillalex","id":61026,"node_id":"MDQ6VXNlcjYxMDI2","avatar_url":"https://avatars.githubusercontent.com/u/61026?v=4","gravatar_id":"","url":"https://api.github.com/users/stillalex","html_url":"https://github.com/stillalex","followers_url":"https://api.github.com/users/stillalex/followers","following_url":"https://api.github.com/users/stillalex/following{/other_user}","gists_url":"https://api.github.com/users/stillalex/gists{/gist_id}","starred_url":"https://api.github.com/users/stillalex/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stillalex/subscriptions","organizations_url":"https://api.github.com/users/stillalex/orgs","repos_url":"https://api.github.com/users/stillalex/repos","events_url":"https://api.github.com/users/stillalex/events{/privacy}","received_events_url":"https://api.github.com/users/stillalex/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-25T17:23:21Z","updated_at":"2022-12-25T17:23:21Z","author_association":"MEMBER","body":"left a few minor comments, overall this looks good.\r\n\r\nis updating the `objectList` method on the table? I find this code a bit ugly (bigger change would be to use an array everywhere, list is not doing any favors. smaller change would be to at least return List instead of ArrayList)\r\n","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1364712912/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1365517458","html_url":"https://github.com/apache/solr/pull/1213#issuecomment-1365517458","issue_url":"https://api.github.com/repos/apache/solr/issues/1213","id":1365517458,"node_id":"IC_kwDOFFj3yM5RZCSS","user":{"login":"dsmiley","id":377295,"node_id":"MDQ6VXNlcjM3NzI5NQ==","avatar_url":"https://avatars.githubusercontent.com/u/377295?v=4","gravatar_id":"","url":"https://api.github.com/users/dsmiley","html_url":"https://github.com/dsmiley","followers_url":"https://api.github.com/users/dsmiley/followers","following_url":"https://api.github.com/users/dsmiley/following{/other_user}","gists_url":"https://api.github.com/users/dsmiley/gists{/gist_id}","starred_url":"https://api.github.com/users/dsmiley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dsmiley/subscriptions","organizations_url":"https://api.github.com/users/dsmiley/orgs","repos_url":"https://api.github.com/users/dsmiley/repos","events_url":"https://api.github.com/users/dsmiley/events{/privacy}","received_events_url":"https://api.github.com/users/dsmiley/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-27T00:17:48Z","updated_at":"2022-12-27T00:17:48Z","author_association":"CONTRIBUTOR","body":"Next time, please put newlines at the end of each sentence in our asciidoc, as is consistent with most of our asciidoc.  It's much easier to consume in diffs.","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1365517458/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1366042104","html_url":"https://github.com/apache/solr/pull/1213#issuecomment-1366042104","issue_url":"https://api.github.com/repos/apache/solr/issues/1213","id":1366042104,"node_id":"IC_kwDOFFj3yM5RbCX4","user":{"login":"epugh","id":22395,"node_id":"MDQ6VXNlcjIyMzk1","avatar_url":"https://avatars.githubusercontent.com/u/22395?v=4","gravatar_id":"","url":"https://api.github.com/users/epugh","html_url":"https://github.com/epugh","followers_url":"https://api.github.com/users/epugh/followers","following_url":"https://api.github.com/users/epugh/following{/other_user}","gists_url":"https://api.github.com/users/epugh/gists{/gist_id}","starred_url":"https://api.github.com/users/epugh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/epugh/subscriptions","organizations_url":"https://api.github.com/users/epugh/orgs","repos_url":"https://api.github.com/users/epugh/repos","events_url":"https://api.github.com/users/epugh/events{/privacy}","received_events_url":"https://api.github.com/users/epugh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-27T16:54:26Z","updated_at":"2022-12-27T16:54:26Z","author_association":"CONTRIBUTOR","body":"I wish we had a lint checker for this kind of thing.   We have a lot of \"best practices\" in writing code, but they are all enforced manually ;-(.    I did google briefly for \"ventilated prose lint checker\" with no luck.   https://asciidoctor.org/docs/asciidoc-recommended-practices/#one-sentence-per-line","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1366042104/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1366263569","html_url":"https://github.com/apache/solr/pull/1248#issuecomment-1366263569","issue_url":"https://api.github.com/repos/apache/solr/issues/1248","id":1366263569,"node_id":"IC_kwDOFFj3yM5Rb4cR","user":{"login":"epugh","id":22395,"node_id":"MDQ6VXNlcjIyMzk1","avatar_url":"https://avatars.githubusercontent.com/u/22395?v=4","gravatar_id":"","url":"https://api.github.com/users/epugh","html_url":"https://github.com/epugh","followers_url":"https://api.github.com/users/epugh/followers","following_url":"https://api.github.com/users/epugh/following{/other_user}","gists_url":"https://api.github.com/users/epugh/gists{/gist_id}","starred_url":"https://api.github.com/users/epugh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/epugh/subscriptions","organizations_url":"https://api.github.com/users/epugh/orgs","repos_url":"https://api.github.com/users/epugh/repos","events_url":"https://api.github.com/users/epugh/events{/privacy}","received_events_url":"https://api.github.com/users/epugh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-27T23:45:29Z","updated_at":"2022-12-27T23:45:29Z","author_association":"CONTRIBUTOR","body":"> left a few minor comments, overall this looks good.\r\n> \r\n> is updating the `objectList` method on the table? I find this code a bit ugly (bigger change would be to use an array everywhere, list is not doing any favors. smaller change would be to at least return List instead of ArrayList)\r\n\r\nThere are a lot of places where some clean up would be nice.   I think we should add a new JIRA for these clean ups.   I think it's an opportunity to see if there are any otehr java cleanups that could be done.","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1366263569/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1366267147","html_url":"https://github.com/apache/solr/pull/1248#issuecomment-1366267147","issue_url":"https://api.github.com/repos/apache/solr/issues/1248","id":1366267147,"node_id":"IC_kwDOFFj3yM5Rb5UL","user":{"login":"epugh","id":22395,"node_id":"MDQ6VXNlcjIyMzk1","avatar_url":"https://avatars.githubusercontent.com/u/22395?v=4","gravatar_id":"","url":"https://api.github.com/users/epugh","html_url":"https://github.com/epugh","followers_url":"https://api.github.com/users/epugh/followers","following_url":"https://api.github.com/users/epugh/following{/other_user}","gists_url":"https://api.github.com/users/epugh/gists{/gist_id}","starred_url":"https://api.github.com/users/epugh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/epugh/subscriptions","organizations_url":"https://api.github.com/users/epugh/orgs","repos_url":"https://api.github.com/users/epugh/repos","events_url":"https://api.github.com/users/epugh/events{/privacy}","received_events_url":"https://api.github.com/users/epugh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-27T23:58:17Z","updated_at":"2022-12-27T23:58:17Z","author_association":"CONTRIBUTOR","body":"I think I've responded to everythign from @dsmiley and @stillalex..   Only change I haven't made is to eliminate this property and replace it with a system variable...   That feels like a bit more work, cause then I have to add more docs to ref guide etc...  I can live iwth just moving it....   Thoughts?  Should we not move forward with this PR and just add the system propertly?","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1366267147/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1366607559","html_url":"https://github.com/apache/solr/pull/1177#issuecomment-1366607559","issue_url":"https://api.github.com/repos/apache/solr/issues/1177","id":1366607559,"node_id":"IC_kwDOFFj3yM5RdMbH","user":{"login":"epugh","id":22395,"node_id":"MDQ6VXNlcjIyMzk1","avatar_url":"https://avatars.githubusercontent.com/u/22395?v=4","gravatar_id":"","url":"https://api.github.com/users/epugh","html_url":"https://github.com/epugh","followers_url":"https://api.github.com/users/epugh/followers","following_url":"https://api.github.com/users/epugh/following{/other_user}","gists_url":"https://api.github.com/users/epugh/gists{/gist_id}","starred_url":"https://api.github.com/users/epugh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/epugh/subscriptions","organizations_url":"https://api.github.com/users/epugh/orgs","repos_url":"https://api.github.com/users/epugh/repos","events_url":"https://api.github.com/users/epugh/events{/privacy}","received_events_url":"https://api.github.com/users/epugh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-28T12:13:18Z","updated_at":"2022-12-28T12:13:18Z","author_association":"CONTRIBUTOR","body":"Some great fixes @justinrsweeney here..   Feel free to ping me and @janhoy when you are ready for more review!","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1366607559/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1366649214","html_url":"https://github.com/apache/solr/pull/1253#issuecomment-1366649214","issue_url":"https://api.github.com/repos/apache/solr/issues/1253","id":1366649214,"node_id":"IC_kwDOFFj3yM5RdWl-","user":{"login":"epugh","id":22395,"node_id":"MDQ6VXNlcjIyMzk1","avatar_url":"https://avatars.githubusercontent.com/u/22395?v=4","gravatar_id":"","url":"https://api.github.com/users/epugh","html_url":"https://github.com/epugh","followers_url":"https://api.github.com/users/epugh/followers","following_url":"https://api.github.com/users/epugh/following{/other_user}","gists_url":"https://api.github.com/users/epugh/gists{/gist_id}","starred_url":"https://api.github.com/users/epugh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/epugh/subscriptions","organizations_url":"https://api.github.com/users/epugh/orgs","repos_url":"https://api.github.com/users/epugh/repos","events_url":"https://api.github.com/users/epugh/events{/privacy}","received_events_url":"https://api.github.com/users/epugh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-28T13:21:31Z","updated_at":"2022-12-28T13:21:31Z","author_association":"CONTRIBUTOR","body":"Hey @stillalex would love a review.","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1366649214/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1366682617","html_url":"https://github.com/apache/solr/pull/1254#issuecomment-1366682617","issue_url":"https://api.github.com/repos/apache/solr/issues/1254","id":1366682617,"node_id":"IC_kwDOFFj3yM5Rdev5","user":{"login":"epugh","id":22395,"node_id":"MDQ6VXNlcjIyMzk1","avatar_url":"https://avatars.githubusercontent.com/u/22395?v=4","gravatar_id":"","url":"https://api.github.com/users/epugh","html_url":"https://github.com/epugh","followers_url":"https://api.github.com/users/epugh/followers","following_url":"https://api.github.com/users/epugh/following{/other_user}","gists_url":"https://api.github.com/users/epugh/gists{/gist_id}","starred_url":"https://api.github.com/users/epugh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/epugh/subscriptions","organizations_url":"https://api.github.com/users/epugh/orgs","repos_url":"https://api.github.com/users/epugh/repos","events_url":"https://api.github.com/users/epugh/events{/privacy}","received_events_url":"https://api.github.com/users/epugh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-28T14:12:19Z","updated_at":"2022-12-28T14:12:19Z","author_association":"CONTRIBUTOR","body":"I'm trying to get a good pattern for using __ventilated prose__ i.e one sentence per line.  Right now my regex is failing.  I'm finding violations in `zookeeper-utilities.adoc`, but visual inspection says that we are using one sentence per line...\r\n\r\n```\r\n  We use ventilated prose, i.e one sentence per line in ascii docs. File: zookeeper-utilities.adoc, position: 125...128\r\n  We use ventilated prose, i.e one sentence per line in ascii docs. File: zookeeper-utilities.adoc, position: 1353...1356\r\n  We use ventilated prose, i.e one sentence per line in ascii docs. File: zookeeper-utilities.adoc, position: 2171...2174\r\n  We use ventilated prose, i.e one sentence per line in ascii docs. File: zookeeper-utilities.adoc, position: 2320...2323\r\n  We use ventilated prose, i.e one sentence per line in ascii docs. File: zookeeper-utilities.adoc, position: 237...240\r\n  We use ventilated prose, i.e one sentence per line in ascii docs. File: zookeeper-utilities.adoc, position: 2669...2672\r\n  We use ventilated prose, i.e one sentence per line in ascii docs. File: zookeeper-utilities.adoc, position: 2700...2703\r\n  We use ventilated prose, i.e one sentence per line in ascii docs. File: zookeeper-utilities.adoc, position: 2952...2955\r\n  We use ventilated prose, i.e one sentence per line in ascii docs. File: zookeeper-utilities.adoc, position: 3159...3162\r\n  We use ventilated prose, i.e one sentence per line in ascii docs. File: zookeeper-utilities.adoc, position: 3726...3729\r\n  We use ventilated prose, i.e one sentence per line in ascii docs. File: zookeeper-utilities.adoc, position: 401...404\r\n  We use ventilated prose, i.e one sentence per line in ascii docs. File: zookeeper-utilities.adoc, position: 4932...4935\r\n  We use ventilated prose, i.e one sentence per line in ascii docs. File: zookeeper-utilities.adoc, position: 5830...5833\r\n  We use ventilated prose, i.e one sentence per line in ascii docs. File: zookeeper-utilities.adoc, position: 715...718\r\n```","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1366682617/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1366752459","html_url":"https://github.com/apache/solr/pull/1254#issuecomment-1366752459","issue_url":"https://api.github.com/repos/apache/solr/issues/1254","id":1366752459,"node_id":"IC_kwDOFFj3yM5RdvzL","user":{"login":"epugh","id":22395,"node_id":"MDQ6VXNlcjIyMzk1","avatar_url":"https://avatars.githubusercontent.com/u/22395?v=4","gravatar_id":"","url":"https://api.github.com/users/epugh","html_url":"https://github.com/epugh","followers_url":"https://api.github.com/users/epugh/followers","following_url":"https://api.github.com/users/epugh/following{/other_user}","gists_url":"https://api.github.com/users/epugh/gists{/gist_id}","starred_url":"https://api.github.com/users/epugh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/epugh/subscriptions","organizations_url":"https://api.github.com/users/epugh/orgs","repos_url":"https://api.github.com/users/epugh/repos","events_url":"https://api.github.com/users/epugh/events{/privacy}","received_events_url":"https://api.github.com/users/epugh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-28T15:55:57Z","updated_at":"2022-12-28T15:55:57Z","author_association":"CONTRIBUTOR","body":"okay, hacked something together.  This is very much a heuristic of \"what is not a complete sentence on a line\".  It has flagged **287** places where we have NOT followed the best practice of ventilated prose:\r\n\r\n```\r\ncluster-plugins.adoc\r\nIn practice this means that cluster-level plugins managed by this API can be\r\ncluster-plugins.adoc\r\nThis component is also a `ClusterSingleton`, which means that only one active instance is present in the\r\nindex-location-format.adoc\r\nNOTE: If the environment variable `SOLR_DATA_HOME` is defined, or if `solr.data.home` is configured for your DirectoryFactory, or if `solr.xml` contains an\r\nscript-update-processor.adoc\r\nAll JARs from Groovy's distro probably aren't required, but more than just the main `groovy.jar` file is needed (at least when this was tested using Groovy 2.0.6)\r\nconfiguring-solr-xml.adoc\r\nThis section is ignored unless theSolr instance is started with either `-DzkRun` or `-DzkHost`\r\ncoreadmin-api.adoc\r\nIf you have already existing core files deployed on disk, and need to just create the Solr core from them then the url will look something like\r\nrequesthandlers-searchcomponents.adoc\r\nThis assumes you are using the request handler classes included with Solr; if you create your own request handler,\r\nrequesthandlers-searchcomponents.adoc\r\nFaceting is not turned on by default - but if the client does specify `facet=true` in the request,\r\nrequesthandlers-searchcomponents.adoc\r\nIf you are expecting to change the parameters often, or if you want define sets of parameters that you can apply on the fly,\r\nrequesthandlers-searchcomponents.adoc\r\n\r\n```","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1366752459/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/solr/issues/comments/1366757868","html_url":"https://github.com/apache/solr/pull/1248#issuecomment-1366757868","issue_url":"https://api.github.com/repos/apache/solr/issues/1248","id":1366757868,"node_id":"IC_kwDOFFj3yM5RdxHs","user":{"login":"stillalex","id":61026,"node_id":"MDQ6VXNlcjYxMDI2","avatar_url":"https://avatars.githubusercontent.com/u/61026?v=4","gravatar_id":"","url":"https://api.github.com/users/stillalex","html_url":"https://github.com/stillalex","followers_url":"https://api.github.com/users/stillalex/followers","following_url":"https://api.github.com/users/stillalex/following{/other_user}","gists_url":"https://api.github.com/users/stillalex/gists{/gist_id}","starred_url":"https://api.github.com/users/stillalex/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stillalex/subscriptions","organizations_url":"https://api.github.com/users/stillalex/orgs","repos_url":"https://api.github.com/users/stillalex/repos","events_url":"https://api.github.com/users/stillalex/events{/privacy}","received_events_url":"https://api.github.com/users/stillalex/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-28T16:03:39Z","updated_at":"2022-12-28T16:03:39Z","author_association":"MEMBER","body":"I agree eliminating the property is more work. I don't have a preference here. I would add the system property support (left a comment at the relevant line) and not remove builder support yet. basically allow both options, just my 2 cents.\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/solr/issues/comments/1366757868/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]