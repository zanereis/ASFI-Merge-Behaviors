[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1505114762","html_url":"https://github.com/apache/iceberg/issues/5122#issuecomment-1505114762","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5122","id":1505114762,"node_id":"IC_kwDOCW7NX85ZtjqK","user":{"login":"JanKaul","id":19823005,"node_id":"MDQ6VXNlcjE5ODIzMDA1","avatar_url":"https://avatars.githubusercontent.com/u/19823005?v=4","gravatar_id":"","url":"https://api.github.com/users/JanKaul","html_url":"https://github.com/JanKaul","followers_url":"https://api.github.com/users/JanKaul/followers","following_url":"https://api.github.com/users/JanKaul/following{/other_user}","gists_url":"https://api.github.com/users/JanKaul/gists{/gist_id}","starred_url":"https://api.github.com/users/JanKaul/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JanKaul/subscriptions","organizations_url":"https://api.github.com/users/JanKaul/orgs","repos_url":"https://api.github.com/users/JanKaul/repos","events_url":"https://api.github.com/users/JanKaul/events{/privacy}","received_events_url":"https://api.github.com/users/JanKaul/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-12T11:33:40Z","updated_at":"2023-04-12T11:33:40Z","author_association":"NONE","body":"The iceberg community is having a meeting to discuss the strategy for a C++/Rust SDK on **April 19th 2023 at 16:00 UTC**. You can join the meeting with the following link: https://meet.google.com/ueb-vmvx-hdw","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1505114762/reactions","total_count":4,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":4,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1505171655","html_url":"https://github.com/apache/iceberg/pull/7179#issuecomment-1505171655","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7179","id":1505171655,"node_id":"IC_kwDOCW7NX85ZtxjH","user":{"login":"lurnagao-dahua","id":91278331,"node_id":"MDQ6VXNlcjkxMjc4MzMx","avatar_url":"https://avatars.githubusercontent.com/u/91278331?v=4","gravatar_id":"","url":"https://api.github.com/users/lurnagao-dahua","html_url":"https://github.com/lurnagao-dahua","followers_url":"https://api.github.com/users/lurnagao-dahua/followers","following_url":"https://api.github.com/users/lurnagao-dahua/following{/other_user}","gists_url":"https://api.github.com/users/lurnagao-dahua/gists{/gist_id}","starred_url":"https://api.github.com/users/lurnagao-dahua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lurnagao-dahua/subscriptions","organizations_url":"https://api.github.com/users/lurnagao-dahua/orgs","repos_url":"https://api.github.com/users/lurnagao-dahua/repos","events_url":"https://api.github.com/users/lurnagao-dahua/events{/privacy}","received_events_url":"https://api.github.com/users/lurnagao-dahua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-12T12:14:45Z","updated_at":"2023-04-12T12:14:45Z","author_association":"CONTRIBUTOR","body":"> @lurnagao thanks for raising this PR ðŸ‘ðŸ» Would it be possible to add a unit test? To ensure we don't break this in the future.\r\n\r\nHi, I have now added a unit test.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1505171655/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1505229911","html_url":"https://github.com/apache/iceberg/issues/7238#issuecomment-1505229911","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7238","id":1505229911,"node_id":"IC_kwDOCW7NX85Zt_xX","user":{"login":"vamen","id":12099000,"node_id":"MDQ6VXNlcjEyMDk5MDAw","avatar_url":"https://avatars.githubusercontent.com/u/12099000?v=4","gravatar_id":"","url":"https://api.github.com/users/vamen","html_url":"https://github.com/vamen","followers_url":"https://api.github.com/users/vamen/followers","following_url":"https://api.github.com/users/vamen/following{/other_user}","gists_url":"https://api.github.com/users/vamen/gists{/gist_id}","starred_url":"https://api.github.com/users/vamen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vamen/subscriptions","organizations_url":"https://api.github.com/users/vamen/orgs","repos_url":"https://api.github.com/users/vamen/repos","events_url":"https://api.github.com/users/vamen/events{/privacy}","received_events_url":"https://api.github.com/users/vamen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-12T12:56:59Z","updated_at":"2023-04-12T12:56:59Z","author_association":"NONE","body":"@karuppayya, have a similar issue. let me know if you have not started. will pick it up","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1505229911/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1505284184","html_url":"https://github.com/apache/iceberg/pull/7109#issuecomment-1505284184","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7109","id":1505284184,"node_id":"IC_kwDOCW7NX85ZuNBY","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-12T13:31:19Z","updated_at":"2023-04-12T13:31:19Z","author_association":"CONTRIBUTOR","body":"@stevenzwu thanks again for the review, could you do another pass?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1505284184/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1505335988","html_url":"https://github.com/apache/iceberg/pull/7295#issuecomment-1505335988","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7295","id":1505335988,"node_id":"IC_kwDOCW7NX85ZuZq0","user":{"login":"tmnd1991","id":7031242,"node_id":"MDQ6VXNlcjcwMzEyNDI=","avatar_url":"https://avatars.githubusercontent.com/u/7031242?v=4","gravatar_id":"","url":"https://api.github.com/users/tmnd1991","html_url":"https://github.com/tmnd1991","followers_url":"https://api.github.com/users/tmnd1991/followers","following_url":"https://api.github.com/users/tmnd1991/following{/other_user}","gists_url":"https://api.github.com/users/tmnd1991/gists{/gist_id}","starred_url":"https://api.github.com/users/tmnd1991/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tmnd1991/subscriptions","organizations_url":"https://api.github.com/users/tmnd1991/orgs","repos_url":"https://api.github.com/users/tmnd1991/repos","events_url":"https://api.github.com/users/tmnd1991/events{/privacy}","received_events_url":"https://api.github.com/users/tmnd1991/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-12T14:03:20Z","updated_at":"2023-04-12T14:03:20Z","author_association":"NONE","body":"@SreeramGarlapati @rdblue @davseitsev can anyone have a look at this? Or point to some one that will? Thank you very much","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1505335988/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1505367273","html_url":"https://github.com/apache/iceberg/pull/7179#issuecomment-1505367273","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7179","id":1505367273,"node_id":"IC_kwDOCW7NX85ZuhTp","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-12T14:21:12Z","updated_at":"2023-04-12T14:21:12Z","author_association":"CONTRIBUTOR","body":"@lurnagao I'm seeing some odd test failures, could you pull in latest master?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1505367273/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1505436757","html_url":"https://github.com/apache/iceberg/pull/7323#issuecomment-1505436757","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7323","id":1505436757,"node_id":"IC_kwDOCW7NX85ZuyRV","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-12T15:03:52Z","updated_at":"2023-04-12T15:03:52Z","author_association":"CONTRIBUTOR","body":"Thanks all!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1505436757/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1505539351","html_url":"https://github.com/apache/iceberg/pull/7327#issuecomment-1505539351","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7327","id":1505539351,"node_id":"IC_kwDOCW7NX85ZvLUX","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-12T16:01:08Z","updated_at":"2023-04-12T16:01:08Z","author_association":"CONTRIBUTOR","body":"@hililiwei thx for the backport","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1505539351/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1505669489","html_url":"https://github.com/apache/iceberg/pull/7120#issuecomment-1505669489","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7120","id":1505669489,"node_id":"IC_kwDOCW7NX85ZvrFx","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-12T17:34:38Z","updated_at":"2023-04-12T17:34:38Z","author_association":"COLLABORATOR","body":"Thanks @gustavoatt for all the changes, let me wait a little bit to see if any other concerns, will merge if not","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1505669489/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1505677580","html_url":"https://github.com/apache/iceberg/issues/7329#issuecomment-1505677580","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7329","id":1505677580,"node_id":"IC_kwDOCW7NX85ZvtEM","user":{"login":"singhpk234","id":35593236,"node_id":"MDQ6VXNlcjM1NTkzMjM2","avatar_url":"https://avatars.githubusercontent.com/u/35593236?v=4","gravatar_id":"","url":"https://api.github.com/users/singhpk234","html_url":"https://github.com/singhpk234","followers_url":"https://api.github.com/users/singhpk234/followers","following_url":"https://api.github.com/users/singhpk234/following{/other_user}","gists_url":"https://api.github.com/users/singhpk234/gists{/gist_id}","starred_url":"https://api.github.com/users/singhpk234/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/singhpk234/subscriptions","organizations_url":"https://api.github.com/users/singhpk234/orgs","repos_url":"https://api.github.com/users/singhpk234/repos","events_url":"https://api.github.com/users/singhpk234/events{/privacy}","received_events_url":"https://api.github.com/users/singhpk234/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-12T17:39:34Z","updated_at":"2023-04-12T17:39:34Z","author_association":"CONTRIBUTOR","body":"If you are giving a path in the load command, it assumes it's an HadoopTable and hence tries to find the version-hint.text in the metadata path what you can do instead is, directly give the fully qualified table name in the `load()`.\r\n\r\nplease ref the doc below : \r\n- https://iceberg.apache.org/docs/latest/spark-queries/#catalogs-with-dataframereader","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1505677580/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1505687072","html_url":"https://github.com/apache/iceberg/issues/7317#issuecomment-1505687072","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7317","id":1505687072,"node_id":"IC_kwDOCW7NX85ZvvYg","user":{"login":"singhpk234","id":35593236,"node_id":"MDQ6VXNlcjM1NTkzMjM2","avatar_url":"https://avatars.githubusercontent.com/u/35593236?v=4","gravatar_id":"","url":"https://api.github.com/users/singhpk234","html_url":"https://github.com/singhpk234","followers_url":"https://api.github.com/users/singhpk234/followers","following_url":"https://api.github.com/users/singhpk234/following{/other_user}","gists_url":"https://api.github.com/users/singhpk234/gists{/gist_id}","starred_url":"https://api.github.com/users/singhpk234/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/singhpk234/subscriptions","organizations_url":"https://api.github.com/users/singhpk234/orgs","repos_url":"https://api.github.com/users/singhpk234/repos","events_url":"https://api.github.com/users/singhpk234/events{/privacy}","received_events_url":"https://api.github.com/users/singhpk234/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-12T17:45:13Z","updated_at":"2023-04-12T17:45:13Z","author_association":"CONTRIBUTOR","body":"I think you might wanna configure the spark catalog to SparkSessionCatalog as well, considering we require it to load an non-iceberg table.\r\n\r\ncan you please try `migrate` with the configuration below : \r\n\r\n```\r\nspark.sql.catalog.spark_catalog=org.apache.iceberg.spark.SparkSessionCatalog\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1505687072/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1505786302","html_url":"https://github.com/apache/iceberg/pull/7229#issuecomment-1505786302","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7229","id":1505786302,"node_id":"IC_kwDOCW7NX85ZwHm-","user":{"login":"haizhou-zhao","id":6187287,"node_id":"MDQ6VXNlcjYxODcyODc=","avatar_url":"https://avatars.githubusercontent.com/u/6187287?v=4","gravatar_id":"","url":"https://api.github.com/users/haizhou-zhao","html_url":"https://github.com/haizhou-zhao","followers_url":"https://api.github.com/users/haizhou-zhao/followers","following_url":"https://api.github.com/users/haizhou-zhao/following{/other_user}","gists_url":"https://api.github.com/users/haizhou-zhao/gists{/gist_id}","starred_url":"https://api.github.com/users/haizhou-zhao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/haizhou-zhao/subscriptions","organizations_url":"https://api.github.com/users/haizhou-zhao/orgs","repos_url":"https://api.github.com/users/haizhou-zhao/repos","events_url":"https://api.github.com/users/haizhou-zhao/events{/privacy}","received_events_url":"https://api.github.com/users/haizhou-zhao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-12T19:06:43Z","updated_at":"2023-04-12T19:06:43Z","author_association":"CONTRIBUTOR","body":"Thanks both @dramaticlly @Fokko for your review!\r\n\r\n@Fokko Updated description based on your suggestions. Feel free to check again.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1505786302/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1505932124","html_url":"https://github.com/apache/iceberg/pull/7175#issuecomment-1505932124","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7175","id":1505932124,"node_id":"IC_kwDOCW7NX85ZwrNc","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-12T20:58:45Z","updated_at":"2023-04-12T20:58:45Z","author_association":"CONTRIBUTOR","body":"I added tests and addressed some comments, I'll address the rest by the end of today.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1505932124/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1506002433","html_url":"https://github.com/apache/iceberg/pull/7246#issuecomment-1506002433","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7246","id":1506002433,"node_id":"IC_kwDOCW7NX85Zw8YB","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-12T21:49:45Z","updated_at":"2023-04-12T21:49:45Z","author_association":"CONTRIBUTOR","body":"@911432 this PR affects `docs/flink-connector.md` and I don't see the use of a connector described in the other files you mentioned.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1506002433/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1506016911","html_url":"https://github.com/apache/iceberg/pull/7315#issuecomment-1506016911","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7315","id":1506016911,"node_id":"IC_kwDOCW7NX85Zw_6P","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-12T22:01:25Z","updated_at":"2023-04-12T22:01:25Z","author_association":"COLLABORATOR","body":"Merged, thanks @zhongyujiang , and @amogh-jahagirdar , @nastra for reviews","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1506016911/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1506125646","html_url":"https://github.com/apache/iceberg/issues/5986#issuecomment-1506125646","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5986","id":1506125646,"node_id":"IC_kwDOCW7NX85ZxadO","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-04-13T00:10:26Z","updated_at":"2023-04-13T00:10:26Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1506125646/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1506125712","html_url":"https://github.com/apache/iceberg/issues/5871#issuecomment-1506125712","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5871","id":1506125712,"node_id":"IC_kwDOCW7NX85ZxaeQ","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-04-13T00:10:33Z","updated_at":"2023-04-13T00:10:33Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1506125712/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1506169227","html_url":"https://github.com/apache/iceberg/issues/7098#issuecomment-1506169227","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7098","id":1506169227,"node_id":"IC_kwDOCW7NX85ZxlGL","user":{"login":"lurnagao-dahua","id":91278331,"node_id":"MDQ6VXNlcjkxMjc4MzMx","avatar_url":"https://avatars.githubusercontent.com/u/91278331?v=4","gravatar_id":"","url":"https://api.github.com/users/lurnagao-dahua","html_url":"https://github.com/lurnagao-dahua","followers_url":"https://api.github.com/users/lurnagao-dahua/followers","following_url":"https://api.github.com/users/lurnagao-dahua/following{/other_user}","gists_url":"https://api.github.com/users/lurnagao-dahua/gists{/gist_id}","starred_url":"https://api.github.com/users/lurnagao-dahua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lurnagao-dahua/subscriptions","organizations_url":"https://api.github.com/users/lurnagao-dahua/orgs","repos_url":"https://api.github.com/users/lurnagao-dahua/repos","events_url":"https://api.github.com/users/lurnagao-dahua/events{/privacy}","received_events_url":"https://api.github.com/users/lurnagao-dahua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-13T01:07:04Z","updated_at":"2023-04-13T01:07:04Z","author_association":"CONTRIBUTOR","body":"closed by [https://github.com/apache/iceberg/pull/7179](url)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1506169227/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1506183829","html_url":"https://github.com/apache/iceberg/pull/7246#issuecomment-1506183829","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7246","id":1506183829,"node_id":"IC_kwDOCW7NX85ZxoqV","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-13T01:27:23Z","updated_at":"2023-04-13T01:28:16Z","author_association":"CONTRIBUTOR","body":"> @911432 this PR affects `docs/flink-connector.md` and I don't see the use of a connector described in the other files you mentioned.\r\n\r\n+1.\r\nWe should not delete this doc. It describes the Connector. It has a different emphasis from DDL.md.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1506183829/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1506197288","html_url":"https://github.com/apache/iceberg/pull/7175#issuecomment-1506197288","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7175","id":1506197288,"node_id":"IC_kwDOCW7NX85Zxr8o","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-13T01:42:01Z","updated_at":"2023-04-13T01:42:01Z","author_association":"CONTRIBUTOR","body":"@szehon-ho, this one is ready for another round.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1506197288/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1506221636","html_url":"https://github.com/apache/iceberg/pull/7120#issuecomment-1506221636","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7120","id":1506221636,"node_id":"IC_kwDOCW7NX85Zxx5E","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-13T02:06:55Z","updated_at":"2023-04-13T02:06:55Z","author_association":"CONTRIBUTOR","body":"The change looks good to me, I had a few minor comments.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1506221636/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1506286837","html_url":"https://github.com/apache/iceberg/pull/7327#issuecomment-1506286837","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7327","id":1506286837,"node_id":"IC_kwDOCW7NX85ZyBz1","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-13T03:36:46Z","updated_at":"2023-04-13T03:36:46Z","author_association":"CONTRIBUTOR","body":"thanks @stevenzwu ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1506286837/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1506476128","html_url":"https://github.com/apache/iceberg/pull/7310#issuecomment-1506476128","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7310","id":1506476128,"node_id":"IC_kwDOCW7NX85ZywBg","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-13T07:21:42Z","updated_at":"2023-04-13T07:24:20Z","author_association":"CONTRIBUTOR","body":"> Caffeine cache will not always call removelistener by default, so an extra scheduler is required to invoke removelistener.\r\n\r\nFrom how I understand how Caffeine does this is that it performs the cleanup whenever the cache is being accessed or modified. Below is an excerpt from the Javadoc:\r\n\r\n> If expireAfter, expireAfterWrite, or expireAfterAccess is requested then entries may be evicted on each cache modification, on occasional cache accesses, or on calls to Cache.cleanUp. A scheduler(Scheduler) may be specified to provide prompt removal of expired entries rather than waiting until activity triggers the periodic maintenance. Expired entries may be counted by Cache.estimatedSize(), but will never be visible to read or write operations.\r\n\r\nThat means the removal listener will be called. And this can be seen by modifying the test to \r\n```\r\n    Awaitility.await()\r\n        .atMost(10, TimeUnit.SECONDS)\r\n        .untilAsserted(\r\n            () -> {\r\n              Assert.assertTrue(clientPool1.isClosed());\r\n              Assert.assertTrue(clientPool2.isClosed());\r\n            });\r\n```\r\n\r\n\r\nThe question for this PR should rather be how **critical** it is that the removal is performed immediately vs waiting until activity triggers the periodic maintenance.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1506476128/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1506596634","html_url":"https://github.com/apache/iceberg/issues/7158#issuecomment-1506596634","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7158","id":1506596634,"node_id":"IC_kwDOCW7NX85ZzNca","user":{"login":"jkl0898","id":14175165,"node_id":"MDQ6VXNlcjE0MTc1MTY1","avatar_url":"https://avatars.githubusercontent.com/u/14175165?v=4","gravatar_id":"","url":"https://api.github.com/users/jkl0898","html_url":"https://github.com/jkl0898","followers_url":"https://api.github.com/users/jkl0898/followers","following_url":"https://api.github.com/users/jkl0898/following{/other_user}","gists_url":"https://api.github.com/users/jkl0898/gists{/gist_id}","starred_url":"https://api.github.com/users/jkl0898/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jkl0898/subscriptions","organizations_url":"https://api.github.com/users/jkl0898/orgs","repos_url":"https://api.github.com/users/jkl0898/repos","events_url":"https://api.github.com/users/jkl0898/events{/privacy}","received_events_url":"https://api.github.com/users/jkl0898/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-13T08:55:02Z","updated_at":"2023-04-13T08:55:02Z","author_association":"NONE","body":"> My understanding is Ceph Object storage is S3 compatible, so one should be able to leverage `S3FileIO` to use Ceph https://iceberg.apache.org/docs/latest/aws/#s3-fileio. Have you looked in to these docs? You can provide the io implementation `S3FileIO` for the catalog you are using. Then, I think you should be able to configure the S3 endpoint to be the Ceph object gateway endpoint but I'm admittedly less familiar with Ceph's architecture, maybe it's a different endpoint. someone else more familiar with Ceph can correct me if I'm wrong there.\r\n\r\nThanks for your advice. we had made verified by your suggesttion and it works. Hope it useful to others too!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1506596634/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1506648653","html_url":"https://github.com/apache/iceberg/pull/5437#issuecomment-1506648653","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5437","id":1506648653,"node_id":"IC_kwDOCW7NX85ZzaJN","user":{"login":"akshay-kokate-06","id":101562443,"node_id":"U_kgDOBg24Sw","avatar_url":"https://avatars.githubusercontent.com/u/101562443?v=4","gravatar_id":"","url":"https://api.github.com/users/akshay-kokate-06","html_url":"https://github.com/akshay-kokate-06","followers_url":"https://api.github.com/users/akshay-kokate-06/followers","following_url":"https://api.github.com/users/akshay-kokate-06/following{/other_user}","gists_url":"https://api.github.com/users/akshay-kokate-06/gists{/gist_id}","starred_url":"https://api.github.com/users/akshay-kokate-06/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/akshay-kokate-06/subscriptions","organizations_url":"https://api.github.com/users/akshay-kokate-06/orgs","repos_url":"https://api.github.com/users/akshay-kokate-06/repos","events_url":"https://api.github.com/users/akshay-kokate-06/events{/privacy}","received_events_url":"https://api.github.com/users/akshay-kokate-06/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-13T09:30:44Z","updated_at":"2023-04-13T09:30:44Z","author_association":"NONE","body":"@singhpk234 I am still facing this issue using `iceberg-spark-runtime-3.3_2.12:1.2.0` and `software.amazon.awssdk:bundle:2.20.18`","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1506648653/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1506827984","html_url":"https://github.com/apache/iceberg/pull/7144#issuecomment-1506827984","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7144","id":1506827984,"node_id":"IC_kwDOCW7NX85Z0F7Q","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-13T11:48:15Z","updated_at":"2023-04-13T11:48:15Z","author_association":"CONTRIBUTOR","body":"@wangyinsheng I talked to @rdblue yesterday and we concluded that we don't want to carry over the catalog properties just for the metrics reporter. The better approach would be to make `MetricsReporter` extend `Serializable`. I opened https://github.com/wangyinsheng/iceberg/pull/1 against your branch to do that. Feel free to squash it into your changes","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1506827984/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1506854606","html_url":"https://github.com/apache/iceberg/issues/6066#issuecomment-1506854606","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6066","id":1506854606,"node_id":"IC_kwDOCW7NX85Z0MbO","user":{"login":"congd123","id":2930813,"node_id":"MDQ6VXNlcjI5MzA4MTM=","avatar_url":"https://avatars.githubusercontent.com/u/2930813?v=4","gravatar_id":"","url":"https://api.github.com/users/congd123","html_url":"https://github.com/congd123","followers_url":"https://api.github.com/users/congd123/followers","following_url":"https://api.github.com/users/congd123/following{/other_user}","gists_url":"https://api.github.com/users/congd123/gists{/gist_id}","starred_url":"https://api.github.com/users/congd123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/congd123/subscriptions","organizations_url":"https://api.github.com/users/congd123/orgs","repos_url":"https://api.github.com/users/congd123/repos","events_url":"https://api.github.com/users/congd123/events{/privacy}","received_events_url":"https://api.github.com/users/congd123/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-13T12:08:37Z","updated_at":"2023-04-13T12:08:37Z","author_association":"NONE","body":"@stevenzwu if this scenario happens\r\n\r\n> if checkpoint N didn't complete successfully, the written manifest file for the incomplete checkpoint won't be used because last completed checkpoint is N-1.\r\n\r\nWhat is the best approach to recover the job?\r\n\r\nI have a similar behavior using Flink 1.14.1 and Iceberg 1.0.0 (V2)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1506854606/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1506863502","html_url":"https://github.com/apache/iceberg/pull/7310#issuecomment-1506863502","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7310","id":1506863502,"node_id":"IC_kwDOCW7NX85Z0OmO","user":{"login":"frankliee","id":10219731,"node_id":"MDQ6VXNlcjEwMjE5NzMx","avatar_url":"https://avatars.githubusercontent.com/u/10219731?v=4","gravatar_id":"","url":"https://api.github.com/users/frankliee","html_url":"https://github.com/frankliee","followers_url":"https://api.github.com/users/frankliee/followers","following_url":"https://api.github.com/users/frankliee/following{/other_user}","gists_url":"https://api.github.com/users/frankliee/gists{/gist_id}","starred_url":"https://api.github.com/users/frankliee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/frankliee/subscriptions","organizations_url":"https://api.github.com/users/frankliee/orgs","repos_url":"https://api.github.com/users/frankliee/repos","events_url":"https://api.github.com/users/frankliee/events{/privacy}","received_events_url":"https://api.github.com/users/frankliee/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-13T12:15:58Z","updated_at":"2023-04-13T12:15:58Z","author_association":"CONTRIBUTOR","body":"> > Caffeine cache will not always call removelistener by default, so an extra scheduler is required to invoke removelistener.\r\n> \r\n> From how I understand how Caffeine does this is that it performs the cleanup whenever the cache is being accessed or modified. Below is an excerpt from the Javadoc:\r\n> \r\n> > If expireAfter, expireAfterWrite, or expireAfterAccess is requested then entries may be evicted on each cache modification, on occasional cache accesses, or on calls to Cache.cleanUp. A scheduler(Scheduler) may be specified to provide prompt removal of expired entries rather than waiting until activity triggers the periodic maintenance. Expired entries may be counted by Cache.estimatedSize(), but will never be visible to read or write operations.\r\n> \r\n> That means the removal listener will be called. And this can be seen by modifying the test to\r\n> \r\n> ```\r\n>     Awaitility.await()\r\n>         .atMost(10, TimeUnit.SECONDS)\r\n>         .untilAsserted(\r\n>             () -> {\r\n>               Assert.assertTrue(clientPool1.isClosed());\r\n>               Assert.assertTrue(clientPool2.isClosed());\r\n>             });\r\n> ```\r\n> \r\n> The question for this PR should rather be how **critical** it is that the removal is performed immediately vs waiting until activity triggers the periodic maintenance.\r\n\r\n\r\n\r\nI understand your concerns, and this PR chooses to call removal immediately for the following two reasons.\r\n\r\n1) Caffeine's default stratey will postpone removal as much as possible to reduce overhead.  In this Iceberg, removal will be call for each 5 min by default, so the overhead is acceptable. \r\n\r\n2) Iceberg has a conf called \"client.pool.cache.eviction-interval-ms\" to ensure the time of eviction, but the uncertainty of Caffeine default stratey will make it strange to predict. This PR makes it meaningful.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1506863502/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1506916799","html_url":"https://github.com/apache/iceberg/pull/6699#issuecomment-1506916799","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6699","id":1506916799,"node_id":"IC_kwDOCW7NX85Z0bm_","user":{"login":"snazy","id":957468,"node_id":"MDQ6VXNlcjk1NzQ2OA==","avatar_url":"https://avatars.githubusercontent.com/u/957468?v=4","gravatar_id":"","url":"https://api.github.com/users/snazy","html_url":"https://github.com/snazy","followers_url":"https://api.github.com/users/snazy/followers","following_url":"https://api.github.com/users/snazy/following{/other_user}","gists_url":"https://api.github.com/users/snazy/gists{/gist_id}","starred_url":"https://api.github.com/users/snazy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/snazy/subscriptions","organizations_url":"https://api.github.com/users/snazy/orgs","repos_url":"https://api.github.com/users/snazy/repos","events_url":"https://api.github.com/users/snazy/events{/privacy}","received_events_url":"https://api.github.com/users/snazy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-13T12:54:33Z","updated_at":"2023-04-13T12:54:33Z","author_association":"MEMBER","body":"> this is just moving the types around and doesn't introduce any other changes, right?\r\n\r\ncorrect","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1506916799/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1506944288","html_url":"https://github.com/apache/iceberg/issues/7340#issuecomment-1506944288","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7340","id":1506944288,"node_id":"IC_kwDOCW7NX85Z0iUg","user":{"login":"cccs-jc","id":56140112,"node_id":"MDQ6VXNlcjU2MTQwMTEy","avatar_url":"https://avatars.githubusercontent.com/u/56140112?v=4","gravatar_id":"","url":"https://api.github.com/users/cccs-jc","html_url":"https://github.com/cccs-jc","followers_url":"https://api.github.com/users/cccs-jc/followers","following_url":"https://api.github.com/users/cccs-jc/following{/other_user}","gists_url":"https://api.github.com/users/cccs-jc/gists{/gist_id}","starred_url":"https://api.github.com/users/cccs-jc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cccs-jc/subscriptions","organizations_url":"https://api.github.com/users/cccs-jc/orgs","repos_url":"https://api.github.com/users/cccs-jc/repos","events_url":"https://api.github.com/users/cccs-jc/events{/privacy}","received_events_url":"https://api.github.com/users/cccs-jc/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-13T13:13:14Z","updated_at":"2023-04-13T13:13:14Z","author_association":"CONTRIBUTOR","body":"@singhpk234 does this seem like a good idea?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1506944288/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1507037365","html_url":"https://github.com/apache/iceberg/issues/5140#issuecomment-1507037365","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5140","id":1507037365,"node_id":"IC_kwDOCW7NX85Z05C1","user":{"login":"ricardopereira33","id":16037370,"node_id":"MDQ6VXNlcjE2MDM3Mzcw","avatar_url":"https://avatars.githubusercontent.com/u/16037370?v=4","gravatar_id":"","url":"https://api.github.com/users/ricardopereira33","html_url":"https://github.com/ricardopereira33","followers_url":"https://api.github.com/users/ricardopereira33/followers","following_url":"https://api.github.com/users/ricardopereira33/following{/other_user}","gists_url":"https://api.github.com/users/ricardopereira33/gists{/gist_id}","starred_url":"https://api.github.com/users/ricardopereira33/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ricardopereira33/subscriptions","organizations_url":"https://api.github.com/users/ricardopereira33/orgs","repos_url":"https://api.github.com/users/ricardopereira33/repos","events_url":"https://api.github.com/users/ricardopereira33/events{/privacy}","received_events_url":"https://api.github.com/users/ricardopereira33/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-13T14:08:16Z","updated_at":"2023-04-13T14:08:16Z","author_association":"NONE","body":"Hi @Zhangg7723!\r\n\r\nDo you have any updates on this issue?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1507037365/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1507125149","html_url":"https://github.com/apache/iceberg/issues/7340#issuecomment-1507125149","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7340","id":1507125149,"node_id":"IC_kwDOCW7NX85Z1Oed","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-13T14:58:53Z","updated_at":"2023-04-13T14:58:53Z","author_association":"CONTRIBUTOR","body":"I actually raised a [PR](https://github.com/apache/iceberg/pull/6480/files) for this a while back, I can follow up on this","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1507125149/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1507222190","html_url":"https://github.com/apache/iceberg/pull/7310#issuecomment-1507222190","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7310","id":1507222190,"node_id":"IC_kwDOCW7NX85Z1mKu","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-13T16:02:55Z","updated_at":"2023-04-13T16:02:55Z","author_association":"CONTRIBUTOR","body":"I think it would be good here to get @pvary's opinion as I'm not very familiar with Hive and how critical it is in this particular case that we perform removal immediately","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1507222190/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1507252375","html_url":"https://github.com/apache/iceberg/pull/7120#issuecomment-1507252375","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7120","id":1507252375,"node_id":"IC_kwDOCW7NX85Z1tiX","user":{"login":"gustavoatt","id":1475634,"node_id":"MDQ6VXNlcjE0NzU2MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/1475634?v=4","gravatar_id":"","url":"https://api.github.com/users/gustavoatt","html_url":"https://github.com/gustavoatt","followers_url":"https://api.github.com/users/gustavoatt/followers","following_url":"https://api.github.com/users/gustavoatt/following{/other_user}","gists_url":"https://api.github.com/users/gustavoatt/gists{/gist_id}","starred_url":"https://api.github.com/users/gustavoatt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gustavoatt/subscriptions","organizations_url":"https://api.github.com/users/gustavoatt/orgs","repos_url":"https://api.github.com/users/gustavoatt/repos","events_url":"https://api.github.com/users/gustavoatt/events{/privacy}","received_events_url":"https://api.github.com/users/gustavoatt/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-13T16:25:25Z","updated_at":"2023-04-13T16:25:25Z","author_association":"CONTRIBUTOR","body":"Thanks for the review @aokolnychyi and @szehon-ho.\r\n\r\nThere is a check failure on this PR but looks unrelated to my changes:\r\n\r\n```\r\nDeprecated Gradle features were used in this build, making it incompatible with Gradle 9.0.\r\n* What went wrong:\r\n\r\nExecution failed for task ':iceberg-spark:iceberg-spark-3.2_2.12:checkstyleMain'.\r\nYou can use '--warning-mode all' to show the individual deprecation warnings and determine if they come from your own scripts or plugins.\r\n> A failure occurred while executing org.gradle.api.plugins.quality.internal.CheckstyleAction\r\n\r\n   > An unexpected error occurred configuring and executing Checkstyle.\r\nSee https://docs.gradle.org/8.0.2/userguide/command_line_interface.html#sec:command_line_warnings\r\n      > java.lang.Error: Error was thrown while processing /home/runner/work/iceberg/iceberg/spark/v3.2/spark/src/main/java/org/apache/iceberg/spark/procedures/AddFilesProcedure.java\r\n499 actionable tasks: 499 executed\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1507252375/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1507258452","html_url":"https://github.com/apache/iceberg/pull/7120#issuecomment-1507258452","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7120","id":1507258452,"node_id":"IC_kwDOCW7NX85Z1vBU","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-13T16:30:16Z","updated_at":"2023-04-13T16:30:16Z","author_association":"COLLABORATOR","body":"Yea I think its appeared a few times, tracked by https://github.com/apache/iceberg/pull/7321, let's just retrigger (close and re-open for example)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1507258452/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1507264618","html_url":"https://github.com/apache/iceberg/pull/7321#issuecomment-1507264618","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7321","id":1507264618,"node_id":"IC_kwDOCW7NX85Z1whq","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-13T16:35:07Z","updated_at":"2023-04-13T16:35:07Z","author_association":"COLLABORATOR","body":"Merged, let's see if this fixes it, thanks @ajantha-bhat for investigation, and @nastra for review","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1507264618/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1507265220","html_url":"https://github.com/apache/iceberg/pull/7202#issuecomment-1507265220","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7202","id":1507265220,"node_id":"IC_kwDOCW7NX85Z1wrE","user":{"login":"dependabot[bot]","id":49699333,"node_id":"MDM6Qm90NDk2OTkzMzM=","avatar_url":"https://avatars.githubusercontent.com/in/29110?v=4","gravatar_id":"","url":"https://api.github.com/users/dependabot%5Bbot%5D","html_url":"https://github.com/apps/dependabot","followers_url":"https://api.github.com/users/dependabot%5Bbot%5D/followers","following_url":"https://api.github.com/users/dependabot%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/dependabot%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/dependabot%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dependabot%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/dependabot%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/dependabot%5Bbot%5D/repos","events_url":"https://api.github.com/users/dependabot%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/dependabot%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-04-13T16:35:35Z","updated_at":"2023-04-13T16:35:35Z","author_association":"CONTRIBUTOR","body":"Looks like com.puppycrawl.tools:checkstyle is no longer a dependency, so this is no longer needed.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1507265220/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1507265852","html_url":"https://github.com/apache/iceberg/pull/7305#issuecomment-1507265852","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7305","id":1507265852,"node_id":"IC_kwDOCW7NX85Z1w08","user":{"login":"dependabot[bot]","id":49699333,"node_id":"MDM6Qm90NDk2OTkzMzM=","avatar_url":"https://avatars.githubusercontent.com/in/29110?v=4","gravatar_id":"","url":"https://api.github.com/users/dependabot%5Bbot%5D","html_url":"https://github.com/apps/dependabot","followers_url":"https://api.github.com/users/dependabot%5Bbot%5D/followers","following_url":"https://api.github.com/users/dependabot%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/dependabot%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/dependabot%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dependabot%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/dependabot%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/dependabot%5Bbot%5D/repos","events_url":"https://api.github.com/users/dependabot%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/dependabot%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-04-13T16:36:05Z","updated_at":"2023-04-13T16:36:05Z","author_association":"CONTRIBUTOR","body":"Superseded by #7342.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1507265852/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1507322338","html_url":"https://github.com/apache/iceberg/pull/7279#issuecomment-1507322338","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7279","id":1507322338,"node_id":"IC_kwDOCW7NX85Z1-ni","user":{"login":"singhpk234","id":35593236,"node_id":"MDQ6VXNlcjM1NTkzMjM2","avatar_url":"https://avatars.githubusercontent.com/u/35593236?v=4","gravatar_id":"","url":"https://api.github.com/users/singhpk234","html_url":"https://github.com/singhpk234","followers_url":"https://api.github.com/users/singhpk234/followers","following_url":"https://api.github.com/users/singhpk234/following{/other_user}","gists_url":"https://api.github.com/users/singhpk234/gists{/gist_id}","starred_url":"https://api.github.com/users/singhpk234/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/singhpk234/subscriptions","organizations_url":"https://api.github.com/users/singhpk234/orgs","repos_url":"https://api.github.com/users/singhpk234/repos","events_url":"https://api.github.com/users/singhpk234/events{/privacy}","received_events_url":"https://api.github.com/users/singhpk234/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-13T17:13:25Z","updated_at":"2023-04-13T17:13:25Z","author_association":"CONTRIBUTOR","body":"> @singhpk234 is there any benchmark result to show?\r\n\r\n@ConeyLiu working on the benchmarks ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1507322338/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1507348739","html_url":"https://github.com/apache/iceberg/issues/7160#issuecomment-1507348739","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7160","id":1507348739,"node_id":"IC_kwDOCW7NX85Z2FED","user":{"login":"reswqa","id":19502505,"node_id":"MDQ6VXNlcjE5NTAyNTA1","avatar_url":"https://avatars.githubusercontent.com/u/19502505?v=4","gravatar_id":"","url":"https://api.github.com/users/reswqa","html_url":"https://github.com/reswqa","followers_url":"https://api.github.com/users/reswqa/followers","following_url":"https://api.github.com/users/reswqa/following{/other_user}","gists_url":"https://api.github.com/users/reswqa/gists{/gist_id}","starred_url":"https://api.github.com/users/reswqa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/reswqa/subscriptions","organizations_url":"https://api.github.com/users/reswqa/orgs","repos_url":"https://api.github.com/users/reswqa/repos","events_url":"https://api.github.com/users/reswqa/events{/privacy}","received_events_url":"https://api.github.com/users/reswqa/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-13T17:27:44Z","updated_at":"2023-04-13T17:33:10Z","author_association":"MEMBER","body":"Hi guys,\r\n\r\nI am very happy to see this discussion on migrating test framework to `Junit5`, which will bring great benefits to the testing part of the project. For example, stronger support for parameterized test and better support for lambda expressions.\r\n\r\nSince the `Apache Flink` community has already started migrating tests to `Junit5` and `Assertj` a long time ago, maybe we can learn something from it. In short, It adopted a `module-by-module` migration solution, and you can refer to this umbrella [ticket](https://issues.apache.org/jira/browse/FLINK-25325). \r\n\r\n\r\n> It's worth looking at https://junit.org/junit5/docs/current/user-guide/#migrating-from-junit4.\r\n\r\nIt is really a good reference to start. At the same time, I would like to share the [migration guidance]([JUnit5 migration guide](https://docs.google.com/document/d/1514Wa_aNB9bJUen4xm5uiuXOooOJTtXqS_Jqk9KJitU/edit)) of the flink community for your reference.\r\n\r\n\r\n> It's also worth mentioning that there are scripts available to convert assertions: https://assertj.github.io/doc/#assertj-migration\r\n\r\nThis script does most of the boring migration stuff. However, according to my experience, there are still some special cases that it cannot handle, such as converting `try{} catch(expected exception)` to `Assertions.assertThatThrowBy`. However, there are not many such exceptions. We can run this script first and spend a little more time to manually handle some special cases.\r\n\r\n> Things like @Rule public TemporaryFolder temp = new TemporaryFolder(); don't work in JUni5 and would have to be converted to @TempDir Path temp;.\r\n\r\nYes, something like this does the more tedious part of the migration process.\r\n\r\n I also want to share another similar case:\r\n\r\n`Juint5` has much better support for parameterized tests to avoid separating parameterized and non-parameterized parts into different test classes. But this also brings some troubles to our migration, because many of our previous tests were parameterized for the whole class, but now we have to inject parameters for each method.\r\nIn order to avoid the inconvenience caused by the above problems as much as possible, we have done some work in flink:\r\n- Introduce `ParameterizedTestExtension` and some annotations to make it easier to migrate test class that require parameterization for all methods.\r\n- Introduce `TempDirUtils` to provide some common methods in `org.junit.rules.TemporaryFolder` but for `Junit5`.\r\n\r\nFor more details, please refer to this [ticket](https://issues.apache.org/jira/browse/FLINK-25315).\r\n\r\nOf course, I am also very willing to participate in the migration of iceberg's test framework, and I look forward to taking this opportunity to integrate into this great community.\r\n\r\n\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1507348739/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1507354068","html_url":"https://github.com/apache/iceberg/pull/7330#issuecomment-1507354068","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7330","id":1507354068,"node_id":"IC_kwDOCW7NX85Z2GXU","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-13T17:31:10Z","updated_at":"2023-04-13T17:31:10Z","author_association":"CONTRIBUTOR","body":"Thanks for the update!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1507354068/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1507362978","html_url":"https://github.com/apache/iceberg/issues/6739#issuecomment-1507362978","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6739","id":1507362978,"node_id":"IC_kwDOCW7NX85Z2Iii","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-13T17:37:11Z","updated_at":"2023-04-13T17:37:11Z","author_association":"CONTRIBUTOR","body":"Assigning to me for now, working with Atreya for the async client integration, and then enable CRT from that.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1507362978/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1507418960","html_url":"https://github.com/apache/iceberg/pull/7175#issuecomment-1507418960","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7175","id":1507418960,"node_id":"IC_kwDOCW7NX85Z2WNQ","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-13T18:16:37Z","updated_at":"2023-04-13T18:16:37Z","author_association":"CONTRIBUTOR","body":"Thanks a lot for reviewing, @szehon-ho!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1507418960/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1507422241","html_url":"https://github.com/apache/iceberg/pull/7299#issuecomment-1507422241","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7299","id":1507422241,"node_id":"IC_kwDOCW7NX85Z2XAh","user":{"login":"puchengy","id":8072956,"node_id":"MDQ6VXNlcjgwNzI5NTY=","avatar_url":"https://avatars.githubusercontent.com/u/8072956?v=4","gravatar_id":"","url":"https://api.github.com/users/puchengy","html_url":"https://github.com/puchengy","followers_url":"https://api.github.com/users/puchengy/followers","following_url":"https://api.github.com/users/puchengy/following{/other_user}","gists_url":"https://api.github.com/users/puchengy/gists{/gist_id}","starred_url":"https://api.github.com/users/puchengy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/puchengy/subscriptions","organizations_url":"https://api.github.com/users/puchengy/orgs","repos_url":"https://api.github.com/users/puchengy/repos","events_url":"https://api.github.com/users/puchengy/events{/privacy}","received_events_url":"https://api.github.com/users/puchengy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-13T18:17:43Z","updated_at":"2023-04-13T18:17:43Z","author_association":"CONTRIBUTOR","body":"> Thank you for your contributions!\r\n> \r\n> I have a question regarding the overall solution for the issue addressed in this PR. Please forgive me if this is a silly one. I recall that the namemapping JSON object allows for specifying multiple names for a field. Would it be possible to solve the case sensitivity issue by specifying alternate field names in the namemapping? Are there any real-world scenarios that would prevent us from modifying the namemapping and necessitate the solution presented in this PR? I look forward to hearing your insights on this matter.\r\n\r\nThe issue we encountered happens when building iceberg table from hive table where hive table already has schema name case mismatch between its parquet file and table schema. While your solution should work, but overall I feel it adds more complexity given that case insensitivity support is already there for other places in iceberg. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1507422241/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1507473736","html_url":"https://github.com/apache/iceberg/pull/7120#issuecomment-1507473736","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7120","id":1507473736,"node_id":"IC_kwDOCW7NX85Z2jlI","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-13T19:01:16Z","updated_at":"2023-04-13T19:01:43Z","author_association":"COLLABORATOR","body":"Merged, thanks @gustavoatt , and also @aokolnychyi, @edgarRd  for additional review","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1507473736/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1507484483","html_url":"https://github.com/apache/iceberg/pull/7120#issuecomment-1507484483","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7120","id":1507484483,"node_id":"IC_kwDOCW7NX85Z2mND","user":{"login":"gustavoatt","id":1475634,"node_id":"MDQ6VXNlcjE0NzU2MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/1475634?v=4","gravatar_id":"","url":"https://api.github.com/users/gustavoatt","html_url":"https://github.com/gustavoatt","followers_url":"https://api.github.com/users/gustavoatt/followers","following_url":"https://api.github.com/users/gustavoatt/following{/other_user}","gists_url":"https://api.github.com/users/gustavoatt/gists{/gist_id}","starred_url":"https://api.github.com/users/gustavoatt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gustavoatt/subscriptions","organizations_url":"https://api.github.com/users/gustavoatt/orgs","repos_url":"https://api.github.com/users/gustavoatt/repos","events_url":"https://api.github.com/users/gustavoatt/events{/privacy}","received_events_url":"https://api.github.com/users/gustavoatt/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-13T19:11:38Z","updated_at":"2023-04-13T19:11:38Z","author_association":"CONTRIBUTOR","body":"Thanks for the review and merging @szehon-ho @aokolnychyi!\n\nAppreciate the effort spent reviewing!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1507484483/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1507532845","html_url":"https://github.com/apache/iceberg/pull/7324#issuecomment-1507532845","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7324","id":1507532845,"node_id":"IC_kwDOCW7NX85Z2yAt","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-13T19:55:43Z","updated_at":"2023-04-13T19:55:43Z","author_association":"CONTRIBUTOR","body":"Overall, it looks good to me. I had just two comments.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1507532845/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1507534391","html_url":"https://github.com/apache/iceberg/issues/7160#issuecomment-1507534391","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7160","id":1507534391,"node_id":"IC_kwDOCW7NX85Z2yY3","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-13T19:56:29Z","updated_at":"2023-04-13T19:56:29Z","author_association":"CONTRIBUTOR","body":"Thank you Weijie for the detailed explanation, this is super helpful! Regarding Junit5 vs AssertJ `Assertions`, what did Flink community do? Do you think using AssertJ `Assertions` (which seems to be the consensus above) is preferred over Junit5?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1507534391/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1507537445","html_url":"https://github.com/apache/iceberg/pull/7326#issuecomment-1507537445","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7326","id":1507537445,"node_id":"IC_kwDOCW7NX85Z2zIl","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-13T19:59:07Z","updated_at":"2023-04-13T19:59:07Z","author_association":"CONTRIBUTOR","body":"Let me take a look today.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1507537445/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1507699227","html_url":"https://github.com/apache/iceberg/issues/6647#issuecomment-1507699227","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6647","id":1507699227,"node_id":"IC_kwDOCW7NX85Z3aob","user":{"login":"sheinbergon","id":4031179,"node_id":"MDQ6VXNlcjQwMzExNzk=","avatar_url":"https://avatars.githubusercontent.com/u/4031179?v=4","gravatar_id":"","url":"https://api.github.com/users/sheinbergon","html_url":"https://github.com/sheinbergon","followers_url":"https://api.github.com/users/sheinbergon/followers","following_url":"https://api.github.com/users/sheinbergon/following{/other_user}","gists_url":"https://api.github.com/users/sheinbergon/gists{/gist_id}","starred_url":"https://api.github.com/users/sheinbergon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sheinbergon/subscriptions","organizations_url":"https://api.github.com/users/sheinbergon/orgs","repos_url":"https://api.github.com/users/sheinbergon/repos","events_url":"https://api.github.com/users/sheinbergon/events{/privacy}","received_events_url":"https://api.github.com/users/sheinbergon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-13T22:49:16Z","updated_at":"2023-04-13T23:03:41Z","author_association":"NONE","body":"@rdblue @Fokko  just wondering - when is this feature/fix due? I see work in #6505 had already taken place, but not sure where things stand. I care greatly about the ability to read externally generated iceberg tables natively via Python. Is there anyway I can contribute or help with making 0.4.0 happen and have the fix for this issue included?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1507699227/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1507754900","html_url":"https://github.com/apache/iceberg/issues/5892#issuecomment-1507754900","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5892","id":1507754900,"node_id":"IC_kwDOCW7NX85Z3oOU","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-04-14T00:10:48Z","updated_at":"2023-04-14T00:10:48Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1507754900/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1507754925","html_url":"https://github.com/apache/iceberg/issues/5728#issuecomment-1507754925","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5728","id":1507754925,"node_id":"IC_kwDOCW7NX85Z3oOt","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-04-14T00:10:49Z","updated_at":"2023-04-14T00:10:49Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1507754925/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1507798782","html_url":"https://github.com/apache/iceberg/pull/7144#issuecomment-1507798782","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7144","id":1507798782,"node_id":"IC_kwDOCW7NX85Z3y7-","user":{"login":"wangyinsheng","id":13392313,"node_id":"MDQ6VXNlcjEzMzkyMzEz","avatar_url":"https://avatars.githubusercontent.com/u/13392313?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyinsheng","html_url":"https://github.com/wangyinsheng","followers_url":"https://api.github.com/users/wangyinsheng/followers","following_url":"https://api.github.com/users/wangyinsheng/following{/other_user}","gists_url":"https://api.github.com/users/wangyinsheng/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyinsheng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyinsheng/subscriptions","organizations_url":"https://api.github.com/users/wangyinsheng/orgs","repos_url":"https://api.github.com/users/wangyinsheng/repos","events_url":"https://api.github.com/users/wangyinsheng/events{/privacy}","received_events_url":"https://api.github.com/users/wangyinsheng/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-14T01:20:16Z","updated_at":"2023-04-14T01:20:16Z","author_association":"CONTRIBUTOR","body":"@nastra I am confused why should't carry over the catalog properties for metrics reporter? We already support to config metrics report through catalog properites.  And metrics reporter may contains non-serializable object, `KafakProducer` for example. We need properties to recreate non-serializable object after table been deserialized","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1507798782/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1507848954","html_url":"https://github.com/apache/iceberg/issues/5652#issuecomment-1507848954","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5652","id":1507848954,"node_id":"IC_kwDOCW7NX85Z3_L6","user":{"login":"takeono","id":1907793,"node_id":"MDQ6VXNlcjE5MDc3OTM=","avatar_url":"https://avatars.githubusercontent.com/u/1907793?v=4","gravatar_id":"","url":"https://api.github.com/users/takeono","html_url":"https://github.com/takeono","followers_url":"https://api.github.com/users/takeono/followers","following_url":"https://api.github.com/users/takeono/following{/other_user}","gists_url":"https://api.github.com/users/takeono/gists{/gist_id}","starred_url":"https://api.github.com/users/takeono/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/takeono/subscriptions","organizations_url":"https://api.github.com/users/takeono/orgs","repos_url":"https://api.github.com/users/takeono/repos","events_url":"https://api.github.com/users/takeono/events{/privacy}","received_events_url":"https://api.github.com/users/takeono/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-14T02:39:48Z","updated_at":"2023-04-16T23:59:58Z","author_association":"NONE","body":"Our flink app that commits every minute had caused OOM after a month. This may be because each commit generates a avro reader/writer to read/write the manifest.\r\n\r\nWith the current implementation, when readSchema and fileSchema are the same reference (this can happen), the weak map entry is not released even if the reference holder disappears. This is because the reference continues to exist as a key for the inner map.\r\n\r\nSo the fileSchema used as the key needs to be a cloned one.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1507848954/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1507850136","html_url":"https://github.com/apache/iceberg/issues/7160#issuecomment-1507850136","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7160","id":1507850136,"node_id":"IC_kwDOCW7NX85Z3_eY","user":{"login":"reswqa","id":19502505,"node_id":"MDQ6VXNlcjE5NTAyNTA1","avatar_url":"https://avatars.githubusercontent.com/u/19502505?v=4","gravatar_id":"","url":"https://api.github.com/users/reswqa","html_url":"https://github.com/reswqa","followers_url":"https://api.github.com/users/reswqa/followers","following_url":"https://api.github.com/users/reswqa/following{/other_user}","gists_url":"https://api.github.com/users/reswqa/gists{/gist_id}","starred_url":"https://api.github.com/users/reswqa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/reswqa/subscriptions","organizations_url":"https://api.github.com/users/reswqa/orgs","repos_url":"https://api.github.com/users/reswqa/repos","events_url":"https://api.github.com/users/reswqa/events{/privacy}","received_events_url":"https://api.github.com/users/reswqa/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-14T02:40:54Z","updated_at":"2023-04-14T02:41:10Z","author_association":"MEMBER","body":"Thanks @jackye1995 for the quick reply!\r\n\r\n> Regarding Junit5 vs AssertJ Assertions, what did Flink community do?\r\n\r\nEarlier, many different types of assertions were mixed in Flink's codebase, such as `Junit4` assertion, `Hamcrest`,`some custom assertion`, etc. \r\n\r\nWhile migrating to `Junit5`, Flink community decided that use `AssertJ` as the only assertion framework.\r\n\r\n> Do you think using AssertJ Assertions (which seems to be the consensus above) is preferred over Junit5?\r\n\r\nIn my personal experience, `AssertJ` is really powerful and the benefit speaks for itself.\r\n\r\n- Thanks to its chained assertion style, we can avoid writing a lot of redundant code.\r\n- It has truly helpful error messages.\r\n- It provides a dedicated assertion API for many types, which will greatly reduce the burden of writing tests and increase the readability of the code.\r\n- Provides assertions for Guava types like Multimap, Table, Optional or ByteSource.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1507850136/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1508024678","html_url":"https://github.com/apache/iceberg/pull/7330#issuecomment-1508024678","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7330","id":1508024678,"node_id":"IC_kwDOCW7NX85Z4qFm","user":{"login":"gaborkaszab","id":29145491,"node_id":"MDQ6VXNlcjI5MTQ1NDkx","avatar_url":"https://avatars.githubusercontent.com/u/29145491?v=4","gravatar_id":"","url":"https://api.github.com/users/gaborkaszab","html_url":"https://github.com/gaborkaszab","followers_url":"https://api.github.com/users/gaborkaszab/followers","following_url":"https://api.github.com/users/gaborkaszab/following{/other_user}","gists_url":"https://api.github.com/users/gaborkaszab/gists{/gist_id}","starred_url":"https://api.github.com/users/gaborkaszab/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gaborkaszab/subscriptions","organizations_url":"https://api.github.com/users/gaborkaszab/orgs","repos_url":"https://api.github.com/users/gaborkaszab/repos","events_url":"https://api.github.com/users/gaborkaszab/events{/privacy}","received_events_url":"https://api.github.com/users/gaborkaszab/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-14T07:02:56Z","updated_at":"2023-04-14T07:02:56Z","author_association":"COLLABORATOR","body":"Thanks for the quick review, @nastra and @jackye1995 !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1508024678/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1508131953","html_url":"https://github.com/apache/iceberg/pull/6499#issuecomment-1508131953","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6499","id":1508131953,"node_id":"IC_kwDOCW7NX85Z5ERx","user":{"login":"krvikash","id":11939923,"node_id":"MDQ6VXNlcjExOTM5OTIz","avatar_url":"https://avatars.githubusercontent.com/u/11939923?v=4","gravatar_id":"","url":"https://api.github.com/users/krvikash","html_url":"https://github.com/krvikash","followers_url":"https://api.github.com/users/krvikash/followers","following_url":"https://api.github.com/users/krvikash/following{/other_user}","gists_url":"https://api.github.com/users/krvikash/gists{/gist_id}","starred_url":"https://api.github.com/users/krvikash/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/krvikash/subscriptions","organizations_url":"https://api.github.com/users/krvikash/orgs","repos_url":"https://api.github.com/users/krvikash/repos","events_url":"https://api.github.com/users/krvikash/events{/privacy}","received_events_url":"https://api.github.com/users/krvikash/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-14T08:27:58Z","updated_at":"2023-04-14T08:27:58Z","author_association":"CONTRIBUTOR","body":"Hi @pvary | @nastra, When you get time, could you please review this?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1508131953/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1508132536","html_url":"https://github.com/apache/iceberg/pull/6512#issuecomment-1508132536","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6512","id":1508132536,"node_id":"IC_kwDOCW7NX85Z5Ea4","user":{"login":"krvikash","id":11939923,"node_id":"MDQ6VXNlcjExOTM5OTIz","avatar_url":"https://avatars.githubusercontent.com/u/11939923?v=4","gravatar_id":"","url":"https://api.github.com/users/krvikash","html_url":"https://github.com/krvikash","followers_url":"https://api.github.com/users/krvikash/followers","following_url":"https://api.github.com/users/krvikash/following{/other_user}","gists_url":"https://api.github.com/users/krvikash/gists{/gist_id}","starred_url":"https://api.github.com/users/krvikash/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/krvikash/subscriptions","organizations_url":"https://api.github.com/users/krvikash/orgs","repos_url":"https://api.github.com/users/krvikash/repos","events_url":"https://api.github.com/users/krvikash/events{/privacy}","received_events_url":"https://api.github.com/users/krvikash/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-14T08:28:25Z","updated_at":"2023-04-14T08:28:25Z","author_association":"CONTRIBUTOR","body":"Hi @rdblue | @nastra | @ajantha-bhat , When you get time, could you please review this?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1508132536/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1508162049","html_url":"https://github.com/apache/iceberg/pull/5437#issuecomment-1508162049","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5437","id":1508162049,"node_id":"IC_kwDOCW7NX85Z5LoB","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-14T08:48:55Z","updated_at":"2023-04-14T08:48:55Z","author_association":"CONTRIBUTOR","body":"@akshay-kokate-06 what issue are you seeing exactly? Could you provide the stack trace please?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1508162049/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1508328430","html_url":"https://github.com/apache/iceberg/pull/7114#issuecomment-1508328430","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7114","id":1508328430,"node_id":"IC_kwDOCW7NX85Z50Pu","user":{"login":"steveloughran","id":162090,"node_id":"MDQ6VXNlcjE2MjA5MA==","avatar_url":"https://avatars.githubusercontent.com/u/162090?v=4","gravatar_id":"","url":"https://api.github.com/users/steveloughran","html_url":"https://github.com/steveloughran","followers_url":"https://api.github.com/users/steveloughran/followers","following_url":"https://api.github.com/users/steveloughran/following{/other_user}","gists_url":"https://api.github.com/users/steveloughran/gists{/gist_id}","starred_url":"https://api.github.com/users/steveloughran/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/steveloughran/subscriptions","organizations_url":"https://api.github.com/users/steveloughran/orgs","repos_url":"https://api.github.com/users/steveloughran/repos","events_url":"https://api.github.com/users/steveloughran/events{/privacy}","received_events_url":"https://api.github.com/users/steveloughran/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-14T10:57:37Z","updated_at":"2023-04-14T10:57:37Z","author_association":"CONTRIBUTOR","body":"so this sets the minimum version iceberg builds against to being 3.3.4? nice. \r\n\r\nwith that you can use openFile(path) and declare the read options you want (sequential vs random), any split start/end and, if you know the length, pass that down to save on any HEAD request. s3a and gcs connectors like this\r\n\r\nThe other bit of fun 3.3.4 has is the whole IOStatistics API to get stats collected on filesystem input and output streams, filesystem instances and others, with\r\nthe ability to take a snapshot (IOStatisticsSnapshot) which can be serialized as java or json. \r\n\r\nYou can just call .toString() of streams to see what is collected, and/or set this to be logged in filesystem close, which is an easy way to see what is happening in existing code\r\n\r\n```xml\r\n  <property>\r\n    <name>fs.iostatistics.logging.level</name>\r\n    <value>info</value>\r\n  </property>\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1508328430/reactions","total_count":3,"+1":3,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1508766210","html_url":"https://github.com/apache/iceberg/pull/7123#issuecomment-1508766210","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7123","id":1508766210,"node_id":"IC_kwDOCW7NX85Z7fIC","user":{"login":"edgarRd","id":266670,"node_id":"MDQ6VXNlcjI2NjY3MA==","avatar_url":"https://avatars.githubusercontent.com/u/266670?v=4","gravatar_id":"","url":"https://api.github.com/users/edgarRd","html_url":"https://github.com/edgarRd","followers_url":"https://api.github.com/users/edgarRd/followers","following_url":"https://api.github.com/users/edgarRd/following{/other_user}","gists_url":"https://api.github.com/users/edgarRd/gists{/gist_id}","starred_url":"https://api.github.com/users/edgarRd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/edgarRd/subscriptions","organizations_url":"https://api.github.com/users/edgarRd/orgs","repos_url":"https://api.github.com/users/edgarRd/repos","events_url":"https://api.github.com/users/edgarRd/events{/privacy}","received_events_url":"https://api.github.com/users/edgarRd/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-14T15:14:17Z","updated_at":"2023-04-14T15:14:17Z","author_association":"CONTRIBUTOR","body":"PTAL @danielcweeks - Thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1508766210/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1508888117","html_url":"https://github.com/apache/iceberg/issues/7344#issuecomment-1508888117","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7344","id":1508888117,"node_id":"IC_kwDOCW7NX85Z7841","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-14T16:02:56Z","updated_at":"2023-04-14T16:02:56Z","author_association":"CONTRIBUTOR","body":"@raviranak can you check if it is the same issue as https://github.com/apache/iceberg/issues/6715. Latest 1.2.0 Iceberg release should have included the fix.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1508888117/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1508933691","html_url":"https://github.com/apache/iceberg/pull/7348#issuecomment-1508933691","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7348","id":1508933691,"node_id":"IC_kwDOCW7NX85Z8IA7","user":{"login":"gustavoatt","id":1475634,"node_id":"MDQ6VXNlcjE0NzU2MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/1475634?v=4","gravatar_id":"","url":"https://api.github.com/users/gustavoatt","html_url":"https://github.com/gustavoatt","followers_url":"https://api.github.com/users/gustavoatt/followers","following_url":"https://api.github.com/users/gustavoatt/following{/other_user}","gists_url":"https://api.github.com/users/gustavoatt/gists{/gist_id}","starred_url":"https://api.github.com/users/gustavoatt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gustavoatt/subscriptions","organizations_url":"https://api.github.com/users/gustavoatt/orgs","repos_url":"https://api.github.com/users/gustavoatt/repos","events_url":"https://api.github.com/users/gustavoatt/events{/privacy}","received_events_url":"https://api.github.com/users/gustavoatt/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-14T16:37:18Z","updated_at":"2023-04-14T16:37:18Z","author_association":"CONTRIBUTOR","body":"@aokolnychyi @szehon-ho this is a follow up PR to the output spec ID PR","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1508933691/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1508976204","html_url":"https://github.com/apache/iceberg/pull/7337#issuecomment-1508976204","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7337","id":1508976204,"node_id":"IC_kwDOCW7NX85Z8SZM","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-14T17:09:56Z","updated_at":"2023-04-14T17:09:56Z","author_association":"CONTRIBUTOR","body":"Why do we need to support multiple reporters? I don't think we need to change the behavior.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1508976204/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1509412287","html_url":"https://github.com/apache/iceberg/issues/5881#issuecomment-1509412287","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5881","id":1509412287,"node_id":"IC_kwDOCW7NX85Z982_","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-04-15T00:11:46Z","updated_at":"2023-04-15T00:11:46Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1509412287/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1509444906","html_url":"https://github.com/apache/iceberg/pull/7197#issuecomment-1509444906","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7197","id":1509444906,"node_id":"IC_kwDOCW7NX85Z-E0q","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-15T01:16:51Z","updated_at":"2023-04-15T01:16:51Z","author_association":"CONTRIBUTOR","body":"Thanks, @pavibhai!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1509444906/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1509611647","html_url":"https://github.com/apache/iceberg/issues/7027#issuecomment-1509611647","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7027","id":1509611647,"node_id":"IC_kwDOCW7NX85Z-th_","user":{"login":"abmo-x","id":69539469,"node_id":"MDQ6VXNlcjY5NTM5NDY5","avatar_url":"https://avatars.githubusercontent.com/u/69539469?v=4","gravatar_id":"","url":"https://api.github.com/users/abmo-x","html_url":"https://github.com/abmo-x","followers_url":"https://api.github.com/users/abmo-x/followers","following_url":"https://api.github.com/users/abmo-x/following{/other_user}","gists_url":"https://api.github.com/users/abmo-x/gists{/gist_id}","starred_url":"https://api.github.com/users/abmo-x/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/abmo-x/subscriptions","organizations_url":"https://api.github.com/users/abmo-x/orgs","repos_url":"https://api.github.com/users/abmo-x/repos","events_url":"https://api.github.com/users/abmo-x/events{/privacy}","received_events_url":"https://api.github.com/users/abmo-x/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-15T07:33:41Z","updated_at":"2023-04-17T17:07:16Z","author_association":"CONTRIBUTOR","body":"@sweetpythoncode\r\nPR is now available, can you test and help review. https://github.com/apache/iceberg/pull/7363","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1509611647/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1509826248","html_url":"https://github.com/apache/iceberg/issues/7345#issuecomment-1509826248","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7345","id":1509826248,"node_id":"IC_kwDOCW7NX85Z_h7I","user":{"login":"singhpk234","id":35593236,"node_id":"MDQ6VXNlcjM1NTkzMjM2","avatar_url":"https://avatars.githubusercontent.com/u/35593236?v=4","gravatar_id":"","url":"https://api.github.com/users/singhpk234","html_url":"https://github.com/singhpk234","followers_url":"https://api.github.com/users/singhpk234/followers","following_url":"https://api.github.com/users/singhpk234/following{/other_user}","gists_url":"https://api.github.com/users/singhpk234/gists{/gist_id}","starred_url":"https://api.github.com/users/singhpk234/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/singhpk234/subscriptions","organizations_url":"https://api.github.com/users/singhpk234/orgs","repos_url":"https://api.github.com/users/singhpk234/repos","events_url":"https://api.github.com/users/singhpk234/events{/privacy}","received_events_url":"https://api.github.com/users/singhpk234/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-15T13:30:06Z","updated_at":"2023-04-15T13:30:06Z","author_association":"CONTRIBUTOR","body":"Thanks @nastra for reporting this, apologies couldn't catch this earlier. Have added a fix for it as well test's which could catch this going forward, as by default ObjectStoreLocationProvider is not used by iceberg. Please take a pass when you have some cycles :) !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1509826248/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1510005776","html_url":"https://github.com/apache/iceberg/issues/4889#issuecomment-1510005776","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4889","id":1510005776,"node_id":"IC_kwDOCW7NX85aANwQ","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-04-16T00:12:03Z","updated_at":"2023-04-16T00:12:03Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1510005776/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1510038817","html_url":"https://github.com/apache/iceberg/pull/7338#issuecomment-1510038817","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7338","id":1510038817,"node_id":"IC_kwDOCW7NX85aAV0h","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-16T03:58:54Z","updated_at":"2023-04-16T03:58:54Z","author_association":"CONTRIBUTOR","body":"@chenjunjiedada thx for finding and fixing this bug","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1510038817/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1510494342","html_url":"https://github.com/apache/iceberg/issues/7317#issuecomment-1510494342","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7317","id":1510494342,"node_id":"IC_kwDOCW7NX85aCFCG","user":{"login":"dthauvin","id":8190978,"node_id":"MDQ6VXNlcjgxOTA5Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/8190978?v=4","gravatar_id":"","url":"https://api.github.com/users/dthauvin","html_url":"https://github.com/dthauvin","followers_url":"https://api.github.com/users/dthauvin/followers","following_url":"https://api.github.com/users/dthauvin/following{/other_user}","gists_url":"https://api.github.com/users/dthauvin/gists{/gist_id}","starred_url":"https://api.github.com/users/dthauvin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dthauvin/subscriptions","organizations_url":"https://api.github.com/users/dthauvin/orgs","repos_url":"https://api.github.com/users/dthauvin/repos","events_url":"https://api.github.com/users/dthauvin/events{/privacy}","received_events_url":"https://api.github.com/users/dthauvin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-16T21:33:19Z","updated_at":"2023-04-16T21:33:19Z","author_association":"NONE","body":"Hello after configuring \r\n\r\n```\r\nspark.sql.catalog.spark_catalog=org.apache.iceberg.spark.SparkSessionCatalog\r\n```\r\n\r\ni get the following error : \r\n\r\n```log\r\nAn error was encountered:\r\nAn error occurred while calling o119.sql.\r\n: org.apache.iceberg.hive.RuntimeMetaException: Failed to connect to Hive Metastore\r\n\tat org.apache.iceberg.hive.HiveClientPool.newClient(HiveClientPool.java:84)\r\n\tat org.apache.iceberg.hive.HiveClientPool.newClient(HiveClientPool.java:34)\r\n\tat org.apache.iceberg.ClientPoolImpl.get(ClientPoolImpl.java:125)\r\n\tat org.apache.iceberg.ClientPoolImpl.run(ClientPoolImpl.java:56)\r\n\tat org.apache.iceberg.ClientPoolImpl.run(ClientPoolImpl.java:51)\r\n\tat org.apache.iceberg.hive.CachedClientPool.run(CachedClientPool.java:82)\r\n\tat org.apache.iceberg.hive.HiveTableOperations.doRefresh(HiveTableOperations.java:223)\r\n\tat org.apache.iceberg.BaseMetastoreTableOperations.refresh(BaseMetastoreTableOperations.java:97)\r\n\tat org.apache.iceberg.BaseMetastoreTableOperations.current(BaseMetastoreTableOperations.java:80)\r\n\tat org.apache.iceberg.BaseMetastoreCatalog.loadTable(BaseMetastoreCatalog.java:44)\r\n\tat org.apache.iceberg.shaded.com.github.benmanes.caffeine.cache.BoundedLocalCache.lambda$doComputeIfAbsent$14(BoundedLocalCache.java:2406)\r\n\tat java.util.concurrent.ConcurrentHashMap.compute(ConcurrentHashMap.java:1853)\r\n\tat org.apache.iceberg.shaded.com.github.benmanes.caffeine.cache.BoundedLocalCache.doComputeIfAbsent(BoundedLocalCache.java:2404)\r\n\tat org.apache.iceberg.shaded.com.github.benmanes.caffeine.cache.BoundedLocalCache.computeIfAbsent(BoundedLocalCache.java:2387)\r\n\tat org.apache.iceberg.shaded.com.github.benmanes.caffeine.cache.LocalCache.computeIfAbsent(LocalCache.java:108)\r\n\tat org.apache.iceberg.shaded.com.github.benmanes.caffeine.cache.LocalManualCache.get(LocalManualCache.java:62)\r\n\tat org.apache.iceberg.CachingCatalog.loadTable(CachingCatalog.java:166)\r\n\tat org.apache.iceberg.spark.SparkCatalog.load(SparkCatalog.java:608)\r\n\tat org.apache.iceberg.spark.SparkCatalog.loadTable(SparkCatalog.java:145)\r\n\tat org.apache.spark.sql.connector.catalog.CatalogV2Util$.loadTable(CatalogV2Util.scala:311)\r\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$.$anonfun$lookupRelation$3(Analyzer.scala:1198)\r\n\tat scala.Option.orElse(Option.scala:447)\r\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$.$anonfun$lookupRelation$1(Analyzer.scala:1197)\r\n\tat scala.Option.orElse(Option.scala:447)\r\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$.org$apache$spark$sql$catalyst$analysis$Analyzer$ResolveRelations$$lookupRelation(Analyzer.scala:1189)\r\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$$anonfun$apply$13.applyOrElse(Analyzer.scala:1060)\r\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$$anonfun$apply$13.applyOrElse(Analyzer.scala:1024)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.$anonfun$resolveOperatorsUpWithPruning$3(AnalysisHelper.scala:138)\r\n\tat org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(TreeNode.scala:179)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.$anonfun$resolveOperatorsUpWithPruning$1(AnalysisHelper.scala:138)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$.allowInvokingTransformsInAnalyzer(AnalysisHelper.scala:323)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.resolveOperatorsUpWithPruning(AnalysisHelper.scala:134)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.resolveOperatorsUpWithPruning$(AnalysisHelper.scala:130)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.resolveOperatorsUpWithPruning(LogicalPlan.scala:31)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.$anonfun$resolveOperatorsUpWithPruning$2(AnalysisHelper.scala:135)\r\n\tat org.apache.spark.sql.catalyst.trees.UnaryLike.mapChildren(TreeNode.scala:1282)\r\n\tat org.apache.spark.sql.catalyst.trees.UnaryLike.mapChildren$(TreeNode.scala:1281)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.OrderPreservingUnaryNode.mapChildren(LogicalPlan.scala:227)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.$anonfun$resolveOperatorsUpWithPruning$1(AnalysisHelper.scala:135)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$.allowInvokingTransformsInAnalyzer(AnalysisHelper.scala:323)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.resolveOperatorsUpWithPruning(AnalysisHelper.scala:134)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.resolveOperatorsUpWithPruning$(AnalysisHelper.scala:130)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.resolveOperatorsUpWithPruning(LogicalPlan.scala:31)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.$anonfun$resolveOperatorsUpWithPruning$2(AnalysisHelper.scala:135)\r\n\tat org.apache.spark.sql.catalyst.trees.UnaryLike.mapChildren(TreeNode.scala:1282)\r\n\tat org.apache.spark.sql.catalyst.trees.UnaryLike.mapChildren$(TreeNode.scala:1281)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.OrderPreservingUnaryNode.mapChildren(LogicalPlan.scala:227)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.$anonfun$resolveOperatorsUpWithPruning$1(AnalysisHelper.scala:135)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$.allowInvokingTransformsInAnalyzer(AnalysisHelper.scala:323)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.resolveOperatorsUpWithPruning(AnalysisHelper.scala:134)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.resolveOperatorsUpWithPruning$(AnalysisHelper.scala:130)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.resolveOperatorsUpWithPruning(LogicalPlan.scala:31)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.$anonfun$resolveOperatorsUpWithPruning$2(AnalysisHelper.scala:135)\r\n\tat org.apache.spark.sql.catalyst.trees.UnaryLike.mapChildren(TreeNode.scala:1282)\r\n\tat org.apache.spark.sql.catalyst.trees.UnaryLike.mapChildren$(TreeNode.scala:1281)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.GlobalLimit.mapChildren(basicLogicalOperators.scala:1625)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.$anonfun$resolveOperatorsUpWithPruning$1(AnalysisHelper.scala:135)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$.allowInvokingTransformsInAnalyzer(AnalysisHelper.scala:323)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.resolveOperatorsUpWithPruning(AnalysisHelper.scala:134)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.resolveOperatorsUpWithPruning$(AnalysisHelper.scala:130)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.resolveOperatorsUpWithPruning(LogicalPlan.scala:31)\r\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$.apply(Analyzer.scala:1024)\r\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$.apply(Analyzer.scala:983)\r\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor.$anonfun$execute$1(RuleExecutor.scala:215)\r\n\tat scala.collection.LinearSeqOptimized.foldLeft(LinearSeqOptimized.scala:126)\r\n\tat scala.collection.LinearSeqOptimized.foldLeft$(LinearSeqOptimized.scala:122)\r\n\tat scala.collection.immutable.List.foldLeft(List.scala:91)\r\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor.executeBatch$1(RuleExecutor.scala:212)\r\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor.$anonfun$execute$6(RuleExecutor.scala:284)\r\n\tat scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)\r\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor$RuleExecutionContext$.withContext(RuleExecutor.scala:327)\r\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor.$anonfun$execute$5(RuleExecutor.scala:284)\r\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor.$anonfun$execute$5$adapted(RuleExecutor.scala:274)\r\n\tat scala.collection.immutable.List.foreach(List.scala:431)\r\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor.execute(RuleExecutor.scala:274)\r\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor.execute(RuleExecutor.scala:188)\r\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.org$apache$spark$sql$catalyst$analysis$Analyzer$$executeSameContext(Analyzer.scala:227)\r\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.$anonfun$execute$1(Analyzer.scala:223)\r\n\tat org.apache.spark.sql.catalyst.analysis.AnalysisContext$.withNewAnalysisContext(Analyzer.scala:172)\r\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.execute(Analyzer.scala:223)\r\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.execute(Analyzer.scala:187)\r\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor.$anonfun$executeAndTrack$1(RuleExecutor.scala:179)\r\n\tat org.apache.spark.sql.catalyst.QueryPlanningTracker$.withTracker(QueryPlanningTracker.scala:107)\r\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor.executeAndTrack(RuleExecutor.scala:179)\r\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.$anonfun$executeAndCheck$1(Analyzer.scala:208)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$.markInAnalyzer(AnalysisHelper.scala:330)\r\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.executeAndCheck(Analyzer.scala:207)\r\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$analyzed$1(QueryExecution.scala:79)\r\n\tat org.apache.spark.sql.catalyst.QueryPlanningTracker.measurePhase(QueryPlanningTracker.scala:192)\r\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$2(QueryExecution.scala:214)\r\n\tat org.apache.spark.sql.execution.QueryExecution$.withInternalError(QueryExecution.scala:554)\r\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$1(QueryExecution.scala:214)\r\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:779)\r\n\tat org.apache.spark.sql.execution.QueryExecution.executePhase(QueryExecution.scala:213)\r\n\tat org.apache.spark.sql.execution.QueryExecution.analyzed$lzycompute(QueryExecution.scala:79)\r\n\tat org.apache.spark.sql.execution.QueryExecution.analyzed(QueryExecution.scala:77)\r\n\tat org.apache.spark.sql.execution.QueryExecution.assertAnalyzed(QueryExecution.scala:69)\r\n\tat org.apache.spark.sql.Dataset$.$anonfun$ofRows$2(Dataset.scala:101)\r\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:779)\r\n\tat org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:99)\r\n\tat org.apache.spark.sql.SparkSession.$anonfun$sql$1(SparkSession.scala:622)\r\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:779)\r\n\tat org.apache.spark.sql.SparkSession.sql(SparkSession.scala:617)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.lang.reflect.Method.invoke(Method.java:498)\r\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\r\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\r\n\tat py4j.Gateway.invoke(Gateway.java:282)\r\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\r\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\r\n\tat py4j.GatewayConnection.run(GatewayConnection.java:238)\r\n\tat java.lang.Thread.run(Thread.java:750)\r\nCaused by: java.lang.RuntimeException: Unable to instantiate org.apache.hadoop.hive.metastore.HiveMetaStoreClient\r\n\tat org.apache.hadoop.hive.metastore.MetaStoreUtils.newInstance(MetaStoreUtils.java:1742)\r\n\tat org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.<init>(RetryingMetaStoreClient.java:87)\r\n\tat org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:137)\r\n\tat org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:108)\r\n\tat org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:101)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.lang.reflect.Method.invoke(Method.java:498)\r\n\tat org.apache.iceberg.common.DynMethods$UnboundMethod.invokeChecked(DynMethods.java:60)\r\n\tat org.apache.iceberg.common.DynMethods$UnboundMethod.invoke(DynMethods.java:72)\r\n\tat org.apache.iceberg.common.DynMethods$StaticMethod.invoke(DynMethods.java:185)\r\n\tat org.apache.iceberg.hive.HiveClientPool.newClient(HiveClientPool.java:63)\r\n\t... 113 more\r\nCaused by: java.lang.reflect.InvocationTargetException\r\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\r\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)\r\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\r\n\tat java.lang.reflect.Constructor.newInstance(Constructor.java:423)\r\n\tat org.apache.hadoop.hive.metastore.MetaStoreUtils.newInstance(MetaStoreUtils.java:1740)\r\n\t... 125 more\r\nCaused by: MetaException(message:Unable to open a test connection to the given database. JDBC url = jdbc:derby:;databaseName=/var/lib/hadoop/metastore/metastore_db;create=true, username = APP. Terminating connection pool (set lazyInit to true if you expect to start your database after your app). Original Exception: ------\r\njava.sql.SQLException: Failed to create database '/var/lib/hadoop/metastore/metastore_db', see the next exception for details.\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.Util.seeNextException(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.createDatabase(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.<init>(Unknown Source)\r\n\tat org.apache.derby.jdbc.InternalDriver$1.run(Unknown Source)\r\n\tat org.apache.derby.jdbc.InternalDriver$1.run(Unknown Source)\r\n\tat java.security.AccessController.doPrivileged(Native Method)\r\n\tat org.apache.derby.jdbc.InternalDriver.getNewEmbedConnection(Unknown Source)\r\n\tat org.apache.derby.jdbc.InternalDriver.connect(Unknown Source)\r\n\tat org.apache.derby.jdbc.InternalDriver.connect(Unknown Source)\r\n\tat org.apache.derby.jdbc.AutoloadedDriver.connect(Unknown Source)\r\n\tat java.sql.DriverManager.getConnection(DriverManager.java:664)\r\n\tat java.sql.DriverManager.getConnection(DriverManager.java:208)\r\n\tat com.jolbox.bonecp.BoneCP.obtainRawInternalConnection(BoneCP.java:361)\r\n\tat com.jolbox.bonecp.BoneCP.<init>(BoneCP.java:416)\r\n\tat com.jolbox.bonecp.BoneCPDataSource.getConnection(BoneCPDataSource.java:120)\r\n\tat org.datanucleus.store.rdbms.ConnectionFactoryImpl$ManagedConnectionImpl.getConnection(ConnectionFactoryImpl.java:483)\r\n\tat org.datanucleus.store.rdbms.RDBMSStoreManager.<init>(RDBMSStoreManager.java:297)\r\n\tat sun.reflect.GeneratedConstructorAccessor88.newInstance(Unknown Source)\r\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\r\n\tat java.lang.reflect.Constructor.newInstance(Constructor.java:423)\r\n\tat org.datanucleus.plugin.NonManagedPluginRegistry.createExecutableExtension(NonManagedPluginRegistry.java:606)\r\n\tat org.datanucleus.plugin.PluginManager.createExecutableExtension(PluginManager.java:301)\r\n\tat org.datanucleus.NucleusContextHelper.createStoreManagerForProperties(NucleusContextHelper.java:133)\r\n\tat org.datanucleus.PersistenceNucleusContextImpl.initialise(PersistenceNucleusContextImpl.java:422)\r\n\tat org.datanucleus.api.jdo.JDOPersistenceManagerFactory.freezeConfiguration(JDOPersistenceManagerFactory.java:817)\r\n\tat org.datanucleus.api.jdo.JDOPersistenceManagerFactory.createPersistenceManagerFactory(JDOPersistenceManagerFactory.java:334)\r\n\tat org.datanucleus.api.jdo.JDOPersistenceManagerFactory.getPersistenceManagerFactory(JDOPersistenceManagerFactory.java:213)\r\n\tat sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)\r\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.lang.reflect.Method.invoke(Method.java:498)\r\n\tat javax.jdo.JDOHelper$16.run(JDOHelper.java:1975)\r\n\tat java.security.AccessController.doPrivileged(Native Method)\r\n\tat javax.jdo.JDOHelper.invoke(JDOHelper.java:1970)\r\n\tat javax.jdo.JDOHelper.invokeGetPersistenceManagerFactoryOnImplementation(JDOHelper.java:1177)\r\n\tat javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:814)\r\n\tat javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:702)\r\n\tat org.apache.hadoop.hive.metastore.ObjectStore.getPMF(ObjectStore.java:526)\r\n\tat org.apache.hadoop.hive.metastore.ObjectStore.getPersistenceManager(ObjectStore.java:555)\r\n\tat org.apache.hadoop.hive.metastore.ObjectStore.initializeHelper(ObjectStore.java:410)\r\n\tat org.apache.hadoop.hive.metastore.ObjectStore.initialize(ObjectStore.java:347)\r\n\tat org.apache.hadoop.hive.metastore.ObjectStore.setConf(ObjectStore.java:308)\r\n\tat org.apache.hadoop.util.ReflectionUtils.setConf(ReflectionUtils.java:79)\r\n\tat org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:139)\r\n\tat org.apache.hadoop.hive.metastore.RawStoreProxy.<init>(RawStoreProxy.java:58)\r\n\tat org.apache.hadoop.hive.metastore.RawStoreProxy.getProxy(RawStoreProxy.java:67)\r\n\tat org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.newRawStoreForConf(HiveMetaStore.java:627)\r\n\tat org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.getMSForConf(HiveMetaStore.java:593)\r\n\tat org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.getMS(HiveMetaStore.java:587)\r\n\tat org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.createDefaultDB(HiveMetaStore.java:658)\r\n\tat org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.init(HiveMetaStore.java:430)\r\n\tat sun.reflect.GeneratedMethodAccessor89.invoke(Unknown Source)\r\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.lang.reflect.Method.invoke(Method.java:498)\r\n\tat org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:148)\r\n\tat org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:107)\r\n\tat org.apache.hadoop.hive.metastore.RetryingHMSHandler.<init>(RetryingHMSHandler.java:79)\r\n\tat org.apache.hadoop.hive.metastore.RetryingHMSHandler.getProxy(RetryingHMSHandler.java:92)\r\n\tat org.apache.hadoop.hive.metastore.HiveMetaStore.newRetryingHMSHandler(HiveMetaStore.java:6950)\r\n\tat org.apache.hadoop.hive.metastore.HiveMetaStoreClient.<init>(HiveMetaStoreClient.java:162)\r\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\r\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)\r\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\r\n\tat java.lang.reflect.Constructor.newInstance(Constructor.java:423)\r\n\tat org.apache.hadoop.hive.metastore.MetaStoreUtils.newInstance(MetaStoreUtils.java:1740)\r\n\tat org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.<init>(RetryingMetaStoreClient.java:87)\r\n\tat org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:137)\r\n\tat org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:108)\r\n\tat org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:101)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.lang.reflect.Method.invoke(Method.java:498)\r\n\tat org.apache.iceberg.common.DynMethods$UnboundMethod.invokeChecked(DynMethods.java:60)\r\n\tat org.apache.iceberg.common.DynMethods$UnboundMethod.invoke(DynMethods.java:72)\r\n\tat org.apache.iceberg.common.DynMethods$StaticMethod.invoke(DynMethods.java:185)\r\n\tat org.apache.iceberg.hive.HiveClientPool.newClient(HiveClientPool.java:63)\r\n\tat org.apache.iceberg.hive.HiveClientPool.newClient(HiveClientPool.java:34)\r\n\tat org.apache.iceberg.ClientPoolImpl.get(ClientPoolImpl.java:125)\r\n\tat org.apache.iceberg.ClientPoolImpl.run(ClientPoolImpl.java:56)\r\n\tat org.apache.iceberg.ClientPoolImpl.run(ClientPoolImpl.java:51)\r\n\tat org.apache.iceberg.hive.CachedClientPool.run(CachedClientPool.java:82)\r\n\tat org.apache.iceberg.hive.HiveTableOperations.doRefresh(HiveTableOperations.java:223)\r\n\tat org.apache.iceberg.BaseMetastoreTableOperations.refresh(BaseMetastoreTableOperations.java:97)\r\n\tat org.apache.iceberg.BaseMetastoreTableOperations.current(BaseMetastoreTableOperations.java:80)\r\n\tat org.apache.iceberg.BaseMetastoreCatalog.loadTable(BaseMetastoreCatalog.java:44)\r\n\tat org.apache.iceberg.shaded.com.github.benmanes.caffeine.cache.BoundedLocalCache.lambda$doComputeIfAbsent$14(BoundedLocalCache.java:2406)\r\n\tat java.util.concurrent.ConcurrentHashMap.compute(ConcurrentHashMap.java:1853)\r\n\tat org.apache.iceberg.shaded.com.github.benmanes.caffeine.cache.BoundedLocalCache.doComputeIfAbsent(BoundedLocalCache.java:2404)\r\n\tat org.apache.iceberg.shaded.com.github.benmanes.caffeine.cache.BoundedLocalCache.computeIfAbsent(BoundedLocalCache.java:2387)\r\n\tat org.apache.iceberg.shaded.com.github.benmanes.caffeine.cache.LocalCache.computeIfAbsent(LocalCache.java:108)\r\n\tat org.apache.iceberg.shaded.com.github.benmanes.caffeine.cache.LocalManualCache.get(LocalManualCache.java:62)\r\n\tat org.apache.iceberg.CachingCatalog.loadTable(CachingCatalog.java:166)\r\n\tat org.apache.iceberg.spark.SparkCatalog.load(SparkCatalog.java:608)\r\n\tat org.apache.iceberg.spark.SparkCatalog.loadTable(SparkCatalog.java:145)\r\n\tat org.apache.spark.sql.connector.catalog.CatalogV2Util$.loadTable(CatalogV2Util.scala:311)\r\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$.$anonfun$lookupRelation$3(Analyzer.scala:1198)\r\n\tat scala.Option.orElse(Option.scala:447)\r\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$.$anonfun$lookupRelation$1(Analyzer.scala:1197)\r\n\tat scala.Option.orElse(Option.scala:447)\r\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$.org$apache$spark$sql$catalyst$analysis$Analyzer$ResolveRelations$$lookupRelation(Analyzer.scala:1189)\r\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$$anonfun$apply$13.applyOrElse(Analyzer.scala:1060)\r\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$$anonfun$apply$13.applyOrElse(Analyzer.scala:1024)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.$anonfun$resolveOperatorsUpWithPruning$3(AnalysisHelper.scala:138)\r\n\tat org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(TreeNode.scala:179)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.$anonfun$resolveOperatorsUpWithPruning$1(AnalysisHelper.scala:138)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$.allowInvokingTransformsInAnalyzer(AnalysisHelper.scala:323)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.resolveOperatorsUpWithPruning(AnalysisHelper.scala:134)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.resolveOperatorsUpWithPruning$(AnalysisHelper.scala:130)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.resolveOperatorsUpWithPruning(LogicalPlan.scala:31)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.$anonfun$resolveOperatorsUpWithPruning$2(AnalysisHelper.scala:135)\r\n\tat org.apache.spark.sql.catalyst.trees.UnaryLike.mapChildren(TreeNode.scala:1282)\r\n\tat org.apache.spark.sql.catalyst.trees.UnaryLike.mapChildren$(TreeNode.scala:1281)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.OrderPreservingUnaryNode.mapChildren(LogicalPlan.scala:227)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.$anonfun$resolveOperatorsUpWithPruning$1(AnalysisHelper.scala:135)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$.allowInvokingTransformsInAnalyzer(AnalysisHelper.scala:323)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.resolveOperatorsUpWithPruning(AnalysisHelper.scala:134)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.resolveOperatorsUpWithPruning$(AnalysisHelper.scala:130)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.resolveOperatorsUpWithPruning(LogicalPlan.scala:31)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.$anonfun$resolveOperatorsUpWithPruning$2(AnalysisHelper.scala:135)\r\n\tat org.apache.spark.sql.catalyst.trees.UnaryLike.mapChildren(TreeNode.scala:1282)\r\n\tat org.apache.spark.sql.catalyst.trees.UnaryLike.mapChildren$(TreeNode.scala:1281)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.OrderPreservingUnaryNode.mapChildren(LogicalPlan.scala:227)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.$anonfun$resolveOperatorsUpWithPruning$1(AnalysisHelper.scala:135)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$.allowInvokingTransformsInAnalyzer(AnalysisHelper.scala:323)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.resolveOperatorsUpWithPruning(AnalysisHelper.scala:134)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.resolveOperatorsUpWithPruning$(AnalysisHelper.scala:130)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.resolveOperatorsUpWithPruning(LogicalPlan.scala:31)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.$anonfun$resolveOperatorsUpWithPruning$2(AnalysisHelper.scala:135)\r\n\tat org.apache.spark.sql.catalyst.trees.UnaryLike.mapChildren(TreeNode.scala:1282)\r\n\tat org.apache.spark.sql.catalyst.trees.UnaryLike.mapChildren$(TreeNode.scala:1281)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.GlobalLimit.mapChildren(basicLogicalOperators.scala:1625)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.$anonfun$resolveOperatorsUpWithPruning$1(AnalysisHelper.scala:135)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$.allowInvokingTransformsInAnalyzer(AnalysisHelper.scala:323)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.resolveOperatorsUpWithPruning(AnalysisHelper.scala:134)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.resolveOperatorsUpWithPruning$(AnalysisHelper.scala:130)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.resolveOperatorsUpWithPruning(LogicalPlan.scala:31)\r\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$.apply(Analyzer.scala:1024)\r\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$.apply(Analyzer.scala:983)\r\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor.$anonfun$execute$1(RuleExecutor.scala:215)\r\n\tat scala.collection.LinearSeqOptimized.foldLeft(LinearSeqOptimized.scala:126)\r\n\tat scala.collection.LinearSeqOptimized.foldLeft$(LinearSeqOptimized.scala:122)\r\n\tat scala.collection.immutable.List.foldLeft(List.scala:91)\r\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor.executeBatch$1(RuleExecutor.scala:212)\r\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor.$anonfun$execute$6(RuleExecutor.scala:284)\r\n\tat scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)\r\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor$RuleExecutionContext$.withContext(RuleExecutor.scala:327)\r\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor.$anonfun$execute$5(RuleExecutor.scala:284)\r\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor.$anonfun$execute$5$adapted(RuleExecutor.scala:274)\r\n\tat scala.collection.immutable.List.foreach(List.scala:431)\r\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor.execute(RuleExecutor.scala:274)\r\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor.execute(RuleExecutor.scala:188)\r\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.org$apache$spark$sql$catalyst$analysis$Analyzer$$executeSameContext(Analyzer.scala:227)\r\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.$anonfun$execute$1(Analyzer.scala:223)\r\n\tat org.apache.spark.sql.catalyst.analysis.AnalysisContext$.withNewAnalysisContext(Analyzer.scala:172)\r\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.execute(Analyzer.scala:223)\r\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.execute(Analyzer.scala:187)\r\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor.$anonfun$executeAndTrack$1(RuleExecutor.scala:179)\r\n\tat org.apache.spark.sql.catalyst.QueryPlanningTracker$.withTracker(QueryPlanningTracker.scala:107)\r\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor.executeAndTrack(RuleExecutor.scala:179)\r\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.$anonfun$executeAndCheck$1(Analyzer.scala:208)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$.markInAnalyzer(AnalysisHelper.scala:330)\r\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.executeAndCheck(Analyzer.scala:207)\r\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$analyzed$1(QueryExecution.scala:79)\r\n\tat org.apache.spark.sql.catalyst.QueryPlanningTracker.measurePhase(QueryPlanningTracker.scala:192)\r\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$2(QueryExecution.scala:214)\r\n\tat org.apache.spark.sql.execution.QueryExecution$.withInternalError(QueryExecution.scala:554)\r\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$1(QueryExecution.scala:214)\r\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:779)\r\n\tat org.apache.spark.sql.execution.QueryExecution.executePhase(QueryExecution.scala:213)\r\n\tat org.apache.spark.sql.execution.QueryExecution.analyzed$lzycompute(QueryExecution.scala:79)\r\n\tat org.apache.spark.sql.execution.QueryExecution.analyzed(QueryExecution.scala:77)\r\n\tat org.apache.spark.sql.execution.QueryExecution.assertAnalyzed(QueryExecution.scala:69)\r\n\tat org.apache.spark.sql.Dataset$.$anonfun$ofRows$2(Dataset.scala:101)\r\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:779)\r\n\tat org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:99)\r\n\tat org.apache.spark.sql.SparkSession.$anonfun$sql$1(SparkSession.scala:622)\r\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:779)\r\n\tat org.apache.spark.sql.SparkSession.sql(SparkSession.scala:617)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.lang.reflect.Method.invoke(Method.java:498)\r\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\r\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\r\n\tat py4j.Gateway.invoke(Gateway.java:282)\r\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\r\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\r\n\tat py4j.GatewayConnection.run(GatewayConnection.java:238)\r\n\tat java.lang.Thread.run(Thread.java:750)\r\nCaused by: ERROR XJ041: Failed to create database '/var/lib/hadoop/metastore/metastore_db', see the next exception for details.\r\n\tat org.apache.derby.iapi.error.StandardException.newException(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory.wrapArgsForTransportAcrossDRDA(Unknown Source)\r\n\t... 191 more\r\nCaused by: ERROR XBM0H: Directory /mnt/var/lib/hadoop/metastore/metastore_db cannot be created.\r\n\tat org.apache.derby.iapi.error.StandardException.newException(Unknown Source)\r\n\tat org.apache.derby.iapi.error.StandardException.newException(Unknown Source)\r\n\tat org.apache.derby.impl.services.monitor.StorageFactoryService$10.run(Unknown Source)\r\n\tat java.security.AccessController.doPrivileged(Native Method)\r\n\tat org.apache.derby.impl.services.monitor.StorageFactoryService.createServiceRoot(Unknown Source)\r\n\tat org.apache.derby.impl.services.monitor.BaseMonitor.bootService(Unknown Source)\r\n\tat org.apache.derby.impl.services.monitor.BaseMonitor.createPersistentService(Unknown Source)\r\n\tat org.apache.derby.impl.services.monitor.FileMonitor.createPersistentService(Unknown Source)\r\n\tat org.apache.derby.iapi.services.monitor.Monitor.createPersistentService(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection$5.run(Unknown Source)\r\n\tat java.security.AccessController.doPrivileged(Native Method)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.createPersistentService(Unknown Source)\r\n\t... 188 more\r\n------ ```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1510494342/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1510531828","html_url":"https://github.com/apache/iceberg/issues/5996#issuecomment-1510531828","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5996","id":1510531828,"node_id":"IC_kwDOCW7NX85aCOL0","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-04-17T00:10:59Z","updated_at":"2023-04-17T00:10:59Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1510531828/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1510639279","html_url":"https://github.com/apache/iceberg/pull/7179#issuecomment-1510639279","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7179","id":1510639279,"node_id":"IC_kwDOCW7NX85aCoav","user":{"login":"lurnagao-dahua","id":91278331,"node_id":"MDQ6VXNlcjkxMjc4MzMx","avatar_url":"https://avatars.githubusercontent.com/u/91278331?v=4","gravatar_id":"","url":"https://api.github.com/users/lurnagao-dahua","html_url":"https://github.com/lurnagao-dahua","followers_url":"https://api.github.com/users/lurnagao-dahua/followers","following_url":"https://api.github.com/users/lurnagao-dahua/following{/other_user}","gists_url":"https://api.github.com/users/lurnagao-dahua/gists{/gist_id}","starred_url":"https://api.github.com/users/lurnagao-dahua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lurnagao-dahua/subscriptions","organizations_url":"https://api.github.com/users/lurnagao-dahua/orgs","repos_url":"https://api.github.com/users/lurnagao-dahua/repos","events_url":"https://api.github.com/users/lurnagao-dahua/events{/privacy}","received_events_url":"https://api.github.com/users/lurnagao-dahua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-17T03:25:01Z","updated_at":"2023-04-17T07:57:15Z","author_association":"CONTRIBUTOR","body":"> @lurnagao I'm seeing some odd test failures, could you pull in latest master?\r\n\r\nHi, I'm sorry for making a very foolish mistake in this pull requestï¼Œso I resubmitted a request in [https://github.com/apache/iceberg/pull/7359](https://github.com/apache/iceberg/pull/7359)\r\n\r\nMay I trouble you to take a look at this new pull requestï¼Ÿ\r\n\r\nThank you very much","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1510639279/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1510761237","html_url":"https://github.com/apache/iceberg/pull/6480#issuecomment-1510761237","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6480","id":1510761237,"node_id":"IC_kwDOCW7NX85aDGMV","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-17T06:09:15Z","updated_at":"2023-04-17T20:06:16Z","author_association":"CONTRIBUTOR","body":"Seems like surfacing a better error message is indeed the right fix for this situation based on a new issue which came up: https://github.com/apache/iceberg/issues/7340\r\n\r\nI've updated with a test cc @aokolnychyi @RussellSpitzer @szehon-ho @singhpk234 @jackye1995","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1510761237/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1511005468","html_url":"https://github.com/apache/iceberg/issues/5122#issuecomment-1511005468","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5122","id":1511005468,"node_id":"IC_kwDOCW7NX85aEB0c","user":{"login":"denniean","id":1141643,"node_id":"MDQ6VXNlcjExNDE2NDM=","avatar_url":"https://avatars.githubusercontent.com/u/1141643?v=4","gravatar_id":"","url":"https://api.github.com/users/denniean","html_url":"https://github.com/denniean","followers_url":"https://api.github.com/users/denniean/followers","following_url":"https://api.github.com/users/denniean/following{/other_user}","gists_url":"https://api.github.com/users/denniean/gists{/gist_id}","starred_url":"https://api.github.com/users/denniean/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/denniean/subscriptions","organizations_url":"https://api.github.com/users/denniean/orgs","repos_url":"https://api.github.com/users/denniean/repos","events_url":"https://api.github.com/users/denniean/events{/privacy}","received_events_url":"https://api.github.com/users/denniean/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-17T09:27:09Z","updated_at":"2023-04-17T09:27:09Z","author_association":"NONE","body":"@JanKaul thank you for the initiative. Unfortunately, I could not join the last community sync, but I will participate in the discussion this Wednesday.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1511005468/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1511261114","html_url":"https://github.com/apache/iceberg/issues/7344#issuecomment-1511261114","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7344","id":1511261114,"node_id":"IC_kwDOCW7NX85aFAO6","user":{"login":"raviranak","id":126759945,"node_id":"U_kgDOB440CQ","avatar_url":"https://avatars.githubusercontent.com/u/126759945?v=4","gravatar_id":"","url":"https://api.github.com/users/raviranak","html_url":"https://github.com/raviranak","followers_url":"https://api.github.com/users/raviranak/followers","following_url":"https://api.github.com/users/raviranak/following{/other_user}","gists_url":"https://api.github.com/users/raviranak/gists{/gist_id}","starred_url":"https://api.github.com/users/raviranak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/raviranak/subscriptions","organizations_url":"https://api.github.com/users/raviranak/orgs","repos_url":"https://api.github.com/users/raviranak/repos","events_url":"https://api.github.com/users/raviranak/events{/privacy}","received_events_url":"https://api.github.com/users/raviranak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-17T12:38:28Z","updated_at":"2023-04-17T12:38:28Z","author_association":"NONE","body":"Hi @stevenzwu \r\n\r\nHere is my spark-context used \r\nfrom pyspark.sql import SparkSession \r\n\r\n`\r\n\r\nspark = SparkSession.builder \\\r\n    .appName(\"MyApp\") \\\r\n    .config(\"spark.sql.hive.metastore.glueCatalog.enabled\", \"true\") \\\r\n    .config(\"spark.sql.catalog.iceberg_catalog.catalog-impl\", \"org.apache.iceberg.aws.glue.GlueCatalog\") \\\r\n    .config(\"spark.sql.catalog.iceberg_catalog.warehouse\", \"s3://internal/iceberg/warehouse/\") \\\r\n    .config(\"spark.sql.catalog.iceberg_catalog.io-impl\", \"org.apache.iceberg.aws.s3.S3FileIO\") \\\r\n    .config(\"spark.sql.catalog.iceberg_catalog\", \"org.apache.iceberg.spark.SparkCatalog\") \\\r\n    .config(\"spark.sql.catalogImplementation\", \"hive\") \\\r\n    .config(\"spark.hadoop.fs.s3a.aws.credentials.provider\", \"com.amazonaws.auth.WebIdentityTokenCredentialsProvider\") \\\r\n    .config(\"spark.sql.extensions\", \"org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions\") \\\r\n    .config(\"spark.jars.packages\", \"org.apache.hadoop:hadoop-aws:3.3.1,org.apache.spark:spark-avro_2.12:3.2.0,\"\r\n                                    \"org.apache.hadoop:hadoop-aws:3.3.1,\"\r\n                                    \"org.apache.iceberg:iceberg-spark-runtime-3.2_2.12:1.2.0\") \\\r\n    .config(\"spark.jars\", \"/home/ray/.ivy2/jars/org.apache.spark_spark-avro_2.12-3.2.0.jar,\"\r\n                          \"/home/ray/.ivy2/jars/com.amazonaws_aws-java-sdk-bundle-1.11.901.jar,\"\r\n                          \"/home/ray/.ivy2/jars/org.apache.hadoop_hadoop-aws-3.3.1.jar,\"\r\n                          \"/home/ray/.ivy2/jars/org.apache.iceberg_iceberg-spark-runtime-3.2_2.12-1.2.0.jar,\"\r\n                          \"https://internal.s3.amazonaws.com/iceberg/bundle-2.17.131.jar,\"\r\n                          \"https://internal.s3.amazonaws.com/iceberg/url-connection-client-2.17.131.jar\") \\\r\n    .config(\"spark.hadoop.fs.s3a.canned.acl\", \"BucketOwnerFullControl\") \\\r\n    .config(\"spark.hadoop.hive.metastore.glue.catalogid\", \"123456789\") \\\r\n    .getOrCreate()\r\n`\r\n\r\nstill facing this issue \r\n`\r\nsoftware.amazon.awssdk.services.glue.model.AccessDeniedException: User: arn:aws:sts:::assumed-role/clusteri-07d3180159a814e31 is not authorized to perform: glue:GetTable on resource: \r\n`\r\n\r\nCan you please here as it seems role doesn't resolve to service role  ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1511261114/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1511264185","html_url":"https://github.com/apache/iceberg/issues/7344#issuecomment-1511264185","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7344","id":1511264185,"node_id":"IC_kwDOCW7NX85aFA-5","user":{"login":"raviranak","id":126759945,"node_id":"U_kgDOB440CQ","avatar_url":"https://avatars.githubusercontent.com/u/126759945?v=4","gravatar_id":"","url":"https://api.github.com/users/raviranak","html_url":"https://github.com/raviranak","followers_url":"https://api.github.com/users/raviranak/followers","following_url":"https://api.github.com/users/raviranak/following{/other_user}","gists_url":"https://api.github.com/users/raviranak/gists{/gist_id}","starred_url":"https://api.github.com/users/raviranak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/raviranak/subscriptions","organizations_url":"https://api.github.com/users/raviranak/orgs","repos_url":"https://api.github.com/users/raviranak/repos","events_url":"https://api.github.com/users/raviranak/events{/privacy}","received_events_url":"https://api.github.com/users/raviranak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-17T12:40:37Z","updated_at":"2023-04-17T12:40:37Z","author_association":"NONE","body":"Using Spark 3.3.0 and .iceberg_iceberg-spark-runtime-3.2_2.12-1.2.0 [iceberg 1.2.0]","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1511264185/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1511535844","html_url":"https://github.com/apache/iceberg/pull/7295#issuecomment-1511535844","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7295","id":1511535844,"node_id":"IC_kwDOCW7NX85aGDTk","user":{"login":"karim-ramadan","id":62559630,"node_id":"MDQ6VXNlcjYyNTU5NjMw","avatar_url":"https://avatars.githubusercontent.com/u/62559630?v=4","gravatar_id":"","url":"https://api.github.com/users/karim-ramadan","html_url":"https://github.com/karim-ramadan","followers_url":"https://api.github.com/users/karim-ramadan/followers","following_url":"https://api.github.com/users/karim-ramadan/following{/other_user}","gists_url":"https://api.github.com/users/karim-ramadan/gists{/gist_id}","starred_url":"https://api.github.com/users/karim-ramadan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/karim-ramadan/subscriptions","organizations_url":"https://api.github.com/users/karim-ramadan/orgs","repos_url":"https://api.github.com/users/karim-ramadan/repos","events_url":"https://api.github.com/users/karim-ramadan/events{/privacy}","received_events_url":"https://api.github.com/users/karim-ramadan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-17T15:00:27Z","updated_at":"2023-04-17T15:00:27Z","author_association":"NONE","body":"HI @SreeramGarlapati,\r\nthis PR addresses your issue https://github.com/apache/iceberg/issues/2788,\r\ncould you or @cwsteinbach @RussellSpitzer @kbendick @rdblue have a look at it ? \r\nThank you very much ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1511535844/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1511538613","html_url":"https://github.com/apache/iceberg/issues/7287#issuecomment-1511538613","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7287","id":1511538613,"node_id":"IC_kwDOCW7NX85aGD-1","user":{"login":"karim-ramadan","id":62559630,"node_id":"MDQ6VXNlcjYyNTU5NjMw","avatar_url":"https://avatars.githubusercontent.com/u/62559630?v=4","gravatar_id":"","url":"https://api.github.com/users/karim-ramadan","html_url":"https://github.com/karim-ramadan","followers_url":"https://api.github.com/users/karim-ramadan/followers","following_url":"https://api.github.com/users/karim-ramadan/following{/other_user}","gists_url":"https://api.github.com/users/karim-ramadan/gists{/gist_id}","starred_url":"https://api.github.com/users/karim-ramadan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/karim-ramadan/subscriptions","organizations_url":"https://api.github.com/users/karim-ramadan/orgs","repos_url":"https://api.github.com/users/karim-ramadan/repos","events_url":"https://api.github.com/users/karim-ramadan/events{/privacy}","received_events_url":"https://api.github.com/users/karim-ramadan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-17T15:01:52Z","updated_at":"2023-04-17T15:01:52Z","author_association":"NONE","body":"Hi, @jackye1995 could you give me feedback on this? would you value a contribution like this? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1511538613/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1511560759","html_url":"https://github.com/apache/iceberg/pull/7310#issuecomment-1511560759","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7310","id":1511560759,"node_id":"IC_kwDOCW7NX85aGJY3","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-17T15:11:39Z","updated_at":"2023-04-17T15:11:39Z","author_association":"CONTRIBUTOR","body":"> I think it would be good here to get @pvary's opinion as I'm not very familiar with Hive and how critical it is in this particular case that we perform removal immediately\r\n\r\nI have seen cases with Flink when the open HMS client numbers are kept increasing. I was suspicious about the Caffeine cleanup, but was not able to pin down the the issue. That said, I am not sure the issue was the same.\r\n\r\n@frankliee: did you have a concrete issue which needs fixing? What was it?\r\n\r\nThanks, Peter ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1511560759/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1511612397","html_url":"https://github.com/apache/iceberg/pull/7360#issuecomment-1511612397","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7360","id":1511612397,"node_id":"IC_kwDOCW7NX85aGV_t","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-17T15:36:18Z","updated_at":"2023-04-17T15:36:18Z","author_association":"CONTRIBUTOR","body":"@hililiwei can you also help review?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1511612397/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1511783525","html_url":"https://github.com/apache/iceberg/issues/4038#issuecomment-1511783525","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4038","id":1511783525,"node_id":"IC_kwDOCW7NX85aG_xl","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-17T17:26:44Z","updated_at":"2023-04-17T17:26:44Z","author_association":"CONTRIBUTOR","body":"I think we just need to add a couple classes to convert string/bytes for UUIDs and update the builders to use them. @nastra is looking into this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1511783525/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1511927727","html_url":"https://github.com/apache/iceberg/pull/7277#issuecomment-1511927727","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7277","id":1511927727,"node_id":"IC_kwDOCW7NX85aHi-v","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-17T19:01:04Z","updated_at":"2023-04-17T19:01:04Z","author_association":"CONTRIBUTOR","body":"Thanks for the fix, merging!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1511927727/reactions","total_count":1,"+1":0,"-1":0,"laugh":1,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1512263458","html_url":"https://github.com/apache/iceberg/issues/5920#issuecomment-1512263458","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5920","id":1512263458,"node_id":"IC_kwDOCW7NX85aI08i","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-04-18T00:10:58Z","updated_at":"2023-04-18T00:10:58Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1512263458/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1512299648","html_url":"https://github.com/apache/iceberg/issues/5945#issuecomment-1512299648","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5945","id":1512299648,"node_id":"IC_kwDOCW7NX85aI9yA","user":{"login":"piyushpatel2005","id":16064603,"node_id":"MDQ6VXNlcjE2MDY0NjAz","avatar_url":"https://avatars.githubusercontent.com/u/16064603?v=4","gravatar_id":"","url":"https://api.github.com/users/piyushpatel2005","html_url":"https://github.com/piyushpatel2005","followers_url":"https://api.github.com/users/piyushpatel2005/followers","following_url":"https://api.github.com/users/piyushpatel2005/following{/other_user}","gists_url":"https://api.github.com/users/piyushpatel2005/gists{/gist_id}","starred_url":"https://api.github.com/users/piyushpatel2005/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/piyushpatel2005/subscriptions","organizations_url":"https://api.github.com/users/piyushpatel2005/orgs","repos_url":"https://api.github.com/users/piyushpatel2005/repos","events_url":"https://api.github.com/users/piyushpatel2005/events{/privacy}","received_events_url":"https://api.github.com/users/piyushpatel2005/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-18T01:11:54Z","updated_at":"2023-04-18T01:11:54Z","author_association":"NONE","body":"I am having exact same issue. For my case, I am on Dataproc cluster with Hive version 3.1.2, Iceberg 0.13.0\r\nThis started surfacing after a column was removed. We have a view on top of five identical tables, one of the tables had one column `col1` removed so I marked that column as NULL for that single table. However, now querying with Hive throws this error. Querying with spark works perfectly.\r\n\r\n```\r\n2023-04-18 01:00:29,353 INFO [AsyncDispatcher event handler] org.apache.hadoop.mapreduce.v2.app.job.impl.TaskAttemptImpl: Diagnostics report from attempt_1663280342573_42161_m_000025_0: Error: java.lang.RuntimeException: Error in configuring object\r\n\tat org.apache.hadoop.util.ReflectionUtils.setJobConf(ReflectionUtils.java:113)\r\n\tat org.apache.hadoop.util.ReflectionUtils.setConf(ReflectionUtils.java:79)\r\n\tat org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:157)\r\n\tat org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:125)\r\n\tat org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:462)\r\n\tat org.apache.hadoop.mapred.MapTask.run(MapTask.java:349)\r\n\tat org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:174)\r\n\tat java.security.AccessController.doPrivileged(Native Method)\r\n\tat javax.security.auth.Subject.doAs(Subject.java:422)\r\n\tat org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1762)\r\n\tat org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:168)\r\nCaused by: java.lang.reflect.InvocationTargetException\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.lang.reflect.Method.invoke(Method.java:498)\r\n\tat org.apache.hadoop.util.ReflectionUtils.setJobConf(ReflectionUtils.java:110)\r\n\t... 10 more\r\nCaused by: java.lang.RuntimeException: Error in configuring object\r\n\tat org.apache.hadoop.util.ReflectionUtils.setJobConf(ReflectionUtils.java:113)\r\n\tat org.apache.hadoop.util.ReflectionUtils.setConf(ReflectionUtils.java:79)\r\n\tat org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:157)\r\n\tat org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:125)\r\n\tat org.apache.hadoop.mapred.MapRunner.configure(MapRunner.java:38)\r\n\t... 15 more\r\nCaused by: java.lang.reflect.InvocationTargetException\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.lang.reflect.Method.invoke(Method.java:498)\r\n\tat org.apache.hadoop.util.ReflectionUtils.setJobConf(ReflectionUtils.java:110)\r\n\t... 19 more\r\nCaused by: java.lang.RuntimeException: Map operator initialization failed\r\n\tat org.apache.hadoop.hive.ql.exec.mr.ExecMapper.configure(ExecMapper.java:143)\r\n\t... 24 more\r\nCaused by: java.lang.RuntimeException: cannot find field col1 from [org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@7ff29d2, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@c0646466, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@5b1e98eb, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@10dc267a, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@f9a464ba, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@dd0eb9ee, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@ebc54f96, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@6a8686d, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@50345c40, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@49cc613, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@222b68b0, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@28dea907, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@bbef2675, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@4246f021, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@7ce5f757, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@5ec1f3e7, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@f31d4410, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@d1a3bff7, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@4ad530b1, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@7676a247, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@4c40e049, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@1bd60b5, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@e514fd3a, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@e2065bcc, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@454a2ac7, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@ba0fc196, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@b3772fab, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@1c58bbd6, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@5a4645b9, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@46041e45, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@46e3f5a0, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@9d9b4f70, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@eb9cc84a, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@d63089ca, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@2bc07dfe, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@7768761d, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@c9045388, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@de91b404, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@4e187447, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@643f1ca5, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@d2691de, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@62b39d37, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@efbe4493, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@e05d411c, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@b428cd02, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@df0f7caa, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@97cfc0ae, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@6a22d1d4, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@ad7cec63, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@671fd3e8, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@a3c1d437, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@a5275d28, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@37ec2ec3, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@ef36b137, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@3b565462, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@f2a0d6d6, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@8f60792, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@1a8ca90a, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@fb52658e, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@9ce94da1, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@24c624bd, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@8f4269a9, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@3ab0ceb2, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@bb7b2dd3, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@750ff469, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@34c22a6b, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@22b9b9d, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@eabab5f, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@13ba0a2, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@d09510c3, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@b5f11c29, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@34aae649, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@7cc1e4c5, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@162067dc, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@37ae4ab2, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@5439c1cb, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@68d8bb, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@450b1f46, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@39da10e9, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@e6b9cc15, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@4e558aff, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@5b9017d6, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@1b591b77, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@9ba8ecad, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@17b5056, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@19cc383d, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@71146be9, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@c90928eb, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@7f94e357, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@ad24d360, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@b9de8f2, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@8779126d, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@6c45f9bc, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@76cba551, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@4bc273fc, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@d153928, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@2dc3a6eb, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@afbe11f6, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@e52056b0, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@d3597cf6, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@ea8f57dd, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@265c4139, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@deda5651, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@df6e41f9, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@40233fd, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@73d99223, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@fdd31d32, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@e25a0a37, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@ce8b260e, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@93da96f2, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@345e7a9d, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@ff257511, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@9fa958bc, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@a04a2827, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@becb6143, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@fed9c5d8, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@fe84e611, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@d561530c, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@8ebd8028, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@430d47c9, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@a69c7001, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@f03fa88f, org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector$IcebergRecordStructField@a9aa92e9]\r\n\tat org.apache.hadoop.hive.serde2.objectinspector.ObjectInspectorUtils.getStandardStructFieldRef(ObjectInspectorUtils.java:538)\r\n\tat org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector.getStructFieldRef(IcebergRecordObjectInspector.java:70)\r\n\tat org.apache.hadoop.hive.ql.exec.ExprNodeColumnEvaluator.initialize(ExprNodeColumnEvaluator.java:56)\r\n\tat org.apache.hadoop.hive.ql.exec.Operator.initEvaluators(Operator.java:1130)\r\n\tat org.apache.hadoop.hive.ql.exec.Operator.initEvaluatorsAndReturnStruct(Operator.java:1156)\r\n\tat org.apache.hadoop.hive.ql.exec.SelectOperator.initializeOp(SelectOperator.java:75)\r\n\tat org.apache.hadoop.hive.ql.exec.Operator.initialize(Operator.java:376)\r\n\tat org.apache.hadoop.hive.ql.exec.Operator.initialize(Operator.java:573)\r\n\tat org.apache.hadoop.hive.ql.exec.Operator.initializeChildren(Operator.java:525)\r\n\tat org.apache.hadoop.hive.ql.exec.Operator.initialize(Operator.java:386)\r\n\tat org.apache.hadoop.hive.ql.exec.Operator.initialize(Operator.java:573)\r\n\tat org.apache.hadoop.hive.ql.exec.Operator.initializeChildren(Operator.java:525)\r\n\tat org.apache.hadoop.hive.ql.exec.Operator.initialize(Operator.java:386)\r\n\tat org.apache.hadoop.hive.ql.exec.MapOperator.initializeMapOperator(MapOperator.java:509)\r\n\tat org.apache.hadoop.hive.ql.exec.mr.ExecMapper.configure(ExecMapper.java:122)\r\n\t... 24 more\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1512299648/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1512351204","html_url":"https://github.com/apache/iceberg/pull/7310#issuecomment-1512351204","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7310","id":1512351204,"node_id":"IC_kwDOCW7NX85aJKXk","user":{"login":"frankliee","id":10219731,"node_id":"MDQ6VXNlcjEwMjE5NzMx","avatar_url":"https://avatars.githubusercontent.com/u/10219731?v=4","gravatar_id":"","url":"https://api.github.com/users/frankliee","html_url":"https://github.com/frankliee","followers_url":"https://api.github.com/users/frankliee/followers","following_url":"https://api.github.com/users/frankliee/following{/other_user}","gists_url":"https://api.github.com/users/frankliee/gists{/gist_id}","starred_url":"https://api.github.com/users/frankliee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/frankliee/subscriptions","organizations_url":"https://api.github.com/users/frankliee/orgs","repos_url":"https://api.github.com/users/frankliee/repos","events_url":"https://api.github.com/users/frankliee/events{/privacy}","received_events_url":"https://api.github.com/users/frankliee/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-18T02:36:24Z","updated_at":"2023-04-18T02:36:24Z","author_association":"CONTRIBUTOR","body":"> > I think it would be good here to get @pvary's opinion as I'm not very familiar with Hive and how critical it is in this particular case that we perform removal immediately\r\n> \r\n> I have seen cases with Flink when the open HMS client numbers are kept increasing. I was suspicious about the Caffeine cleanup, but was not able to pin down the the issue. That said, I am not sure the issue was the same.\r\n> \r\n> @frankliee: did you have a concrete issue which needs fixing? What was it?\r\n> \r\n> Thanks, Peter\r\n\r\n\r\nIn another project, I found guava cache can leak connections, when the cache will not be \"set\" for a long time.\r\nSo Iceberg has the similar risk.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1512351204/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1512387056","html_url":"https://github.com/apache/iceberg/pull/5100#issuecomment-1512387056","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5100","id":1512387056,"node_id":"IC_kwDOCW7NX85aJTHw","user":{"login":"jiamin13579","id":39509320,"node_id":"MDQ6VXNlcjM5NTA5MzIw","avatar_url":"https://avatars.githubusercontent.com/u/39509320?v=4","gravatar_id":"","url":"https://api.github.com/users/jiamin13579","html_url":"https://github.com/jiamin13579","followers_url":"https://api.github.com/users/jiamin13579/followers","following_url":"https://api.github.com/users/jiamin13579/following{/other_user}","gists_url":"https://api.github.com/users/jiamin13579/gists{/gist_id}","starred_url":"https://api.github.com/users/jiamin13579/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiamin13579/subscriptions","organizations_url":"https://api.github.com/users/jiamin13579/orgs","repos_url":"https://api.github.com/users/jiamin13579/repos","events_url":"https://api.github.com/users/jiamin13579/events{/privacy}","received_events_url":"https://api.github.com/users/jiamin13579/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-18T03:35:00Z","updated_at":"2023-04-18T03:35:00Z","author_association":"CONTRIBUTOR","body":"We also encountered the same problem\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1512387056/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1512392013","html_url":"https://github.com/apache/iceberg/issues/7344#issuecomment-1512392013","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7344","id":1512392013,"node_id":"IC_kwDOCW7NX85aJUVN","user":{"login":"raviranak","id":126759945,"node_id":"U_kgDOB440CQ","avatar_url":"https://avatars.githubusercontent.com/u/126759945?v=4","gravatar_id":"","url":"https://api.github.com/users/raviranak","html_url":"https://github.com/raviranak","followers_url":"https://api.github.com/users/raviranak/followers","following_url":"https://api.github.com/users/raviranak/following{/other_user}","gists_url":"https://api.github.com/users/raviranak/gists{/gist_id}","starred_url":"https://api.github.com/users/raviranak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/raviranak/subscriptions","organizations_url":"https://api.github.com/users/raviranak/orgs","repos_url":"https://api.github.com/users/raviranak/repos","events_url":"https://api.github.com/users/raviranak/events{/privacy}","received_events_url":"https://api.github.com/users/raviranak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-18T03:45:31Z","updated_at":"2023-04-18T03:45:31Z","author_association":"NONE","body":"can you help here how to change the provider to use WebIdentityTokenFileCredentialsProvider for iceberg client ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1512392013/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1512427785","html_url":"https://github.com/apache/iceberg/issues/7034#issuecomment-1512427785","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7034","id":1512427785,"node_id":"IC_kwDOCW7NX85aJdEJ","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-18T04:47:32Z","updated_at":"2023-04-18T04:47:32Z","author_association":"CONTRIBUTOR","body":"> This might be fixed with : #6648 by @pvary . I see in [newest code](https://github.com/apache/iceberg/blob/master/hive-metastore/src/main/java/org/apache/iceberg/hive/MetastoreLock.java#L174) the code calls shutdown on exitingScheduledExecutorService. But in [earlier code](https://github.com/apache/iceberg/blob/apache-iceberg-1.1.0/hive-metastore/src/main/java/org/apache/iceberg/hive/HiveTableOperations.java#L383), it does not. Although I havent walked through it to be 100% sure.\r\n\r\nThis was the exact issue with the Spark test which prompted me to add the `cancel` call to the release of the locks. Otherwise the Spark tests were failing with resource problems.\r\n\r\nThe issue was highlighted by my change since the Locking change created threads on every commit instead on every TableOperation creation.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1512427785/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1512432038","html_url":"https://github.com/apache/iceberg/issues/7034#issuecomment-1512432038","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7034","id":1512432038,"node_id":"IC_kwDOCW7NX85aJeGm","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-18T04:55:15Z","updated_at":"2023-04-18T04:55:15Z","author_association":"CONTRIBUTOR","body":"> It sounds like this should be a threadpool that is owned by the catalog, not a thread per table.\r\n> \r\n> @pvary, can you confirm whether this is working in 1.2 and what we can do to avoid needing to manage resources per table?\r\n\r\nWe need different threads for heartbeating different Hive locks. It was technically OK when we bound it to the HiveTableOperation, as there were no concurrent commits for a single operation, but putting it on the Catalog level could cause noisy neighbors problem when multiple tables are using the same thread pool.\r\n\r\nThe issue should not be present after #6648, as it binds the heartbeat thread to the Lock itself, which is the correct place for it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1512432038/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1512437603","html_url":"https://github.com/apache/iceberg/pull/7348#issuecomment-1512437603","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7348","id":1512437603,"node_id":"IC_kwDOCW7NX85aJfdj","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-18T05:02:57Z","updated_at":"2023-04-18T05:02:57Z","author_association":"CONTRIBUTOR","body":"Thanks, @gustavoatt! Thanks for reviewing, @szehon-ho @singhpk234!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1512437603/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1512441436","html_url":"https://github.com/apache/iceberg/pull/5146#issuecomment-1512441436","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5146","id":1512441436,"node_id":"IC_kwDOCW7NX85aJgZc","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-18T05:07:30Z","updated_at":"2023-04-18T05:07:30Z","author_association":"CONTRIBUTOR","body":"@Alibaba-HZY: If we are talking about how Hive implemented INSERT OVERWRITE queries above Iceberg tables, then you should take a look at the Hive code. IIRC we have a specific PR for adding this feature for non partitioned tables and another one for partitioned tables. So you should look for multiple PRs if you want to see the full picture. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1512441436/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1512445120","html_url":"https://github.com/apache/iceberg/pull/7123#issuecomment-1512445120","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7123","id":1512445120,"node_id":"IC_kwDOCW7NX85aJhTA","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-18T05:12:42Z","updated_at":"2023-04-18T05:13:20Z","author_association":"CONTRIBUTOR","body":"I am not working on MR side lately, so I do not have a current knowledge of the code here\r\nMaybe @deniskuzZ would be interested in reviewing this PR.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1512445120/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1512454864","html_url":"https://github.com/apache/iceberg/pull/7361#issuecomment-1512454864","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7361","id":1512454864,"node_id":"IC_kwDOCW7NX85aJjrQ","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-18T05:28:00Z","updated_at":"2023-04-18T05:28:00Z","author_association":"CONTRIBUTOR","body":"@szehon-ho and I should be able to review this at some point","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1512454864/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1512462437","html_url":"https://github.com/apache/iceberg/pull/5146#issuecomment-1512462437","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5146","id":1512462437,"node_id":"IC_kwDOCW7NX85aJlhl","user":{"login":"Alibaba-HZY","id":48040205,"node_id":"MDQ6VXNlcjQ4MDQwMjA1","avatar_url":"https://avatars.githubusercontent.com/u/48040205?v=4","gravatar_id":"","url":"https://api.github.com/users/Alibaba-HZY","html_url":"https://github.com/Alibaba-HZY","followers_url":"https://api.github.com/users/Alibaba-HZY/followers","following_url":"https://api.github.com/users/Alibaba-HZY/following{/other_user}","gists_url":"https://api.github.com/users/Alibaba-HZY/gists{/gist_id}","starred_url":"https://api.github.com/users/Alibaba-HZY/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Alibaba-HZY/subscriptions","organizations_url":"https://api.github.com/users/Alibaba-HZY/orgs","repos_url":"https://api.github.com/users/Alibaba-HZY/repos","events_url":"https://api.github.com/users/Alibaba-HZY/events{/privacy}","received_events_url":"https://api.github.com/users/Alibaba-HZY/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-18T05:38:19Z","updated_at":"2023-04-18T05:38:19Z","author_association":"NONE","body":"> @Alibaba-HZY: If we are talking about how Hive implemented INSERT OVERWRITE queries above Iceberg tables, then you should take a look at the Hive code. IIRC we have a specific PR for adding this feature for non partitioned tables and another one for partitioned tables. So you should look for multiple PRs if you want to see the full picture.\r\n\r\nThank you for your answer. I thought this implementation is in the iceberg code before, so I couldn't find it. Now I have found these pr in the hive code\r\n ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1512462437/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1512478527","html_url":"https://github.com/apache/iceberg/pull/6786#issuecomment-1512478527","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6786","id":1512478527,"node_id":"IC_kwDOCW7NX85aJpc_","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-18T05:56:55Z","updated_at":"2023-04-18T05:56:55Z","author_association":"CONTRIBUTOR","body":"@ajantha-bhat @jackye1995 @RussellSpitzer, what are your thoughts regarding my proposal above?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1512478527/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1512485517","html_url":"https://github.com/apache/iceberg/pull/6786#issuecomment-1512485517","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6786","id":1512485517,"node_id":"IC_kwDOCW7NX85aJrKN","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-18T06:02:48Z","updated_at":"2023-04-18T06:02:48Z","author_association":"MEMBER","body":"I agree that it should just be the drop table behavior ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1512485517/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1512507108","html_url":"https://github.com/apache/iceberg/pull/7346#issuecomment-1512507108","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7346","id":1512507108,"node_id":"IC_kwDOCW7NX85aJwbk","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-18T06:25:01Z","updated_at":"2023-04-18T06:25:01Z","author_association":"CONTRIBUTOR","body":"Seems like a good catch. I'll try to review the actual fix later this week unless someone gets there earlier.\r\n\r\ncc @nastra @rdblue @szehon-ho @flyrain @amogh-jahagirdar @jackye1995 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1512507108/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1512524885","html_url":"https://github.com/apache/iceberg/pull/7353#issuecomment-1512524885","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7353","id":1512524885,"node_id":"IC_kwDOCW7NX85aJ0xV","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-18T06:42:20Z","updated_at":"2023-04-18T06:42:20Z","author_association":"CONTRIBUTOR","body":"test failure seems unrelated. I've opened https://github.com/apache/iceberg/issues/7367 to investigate it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1512524885/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1512740996","html_url":"https://github.com/apache/iceberg/issues/5099#issuecomment-1512740996","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5099","id":1512740996,"node_id":"IC_kwDOCW7NX85aKpiE","user":{"login":"Anjaney1999","id":26672998,"node_id":"MDQ6VXNlcjI2NjcyOTk4","avatar_url":"https://avatars.githubusercontent.com/u/26672998?v=4","gravatar_id":"","url":"https://api.github.com/users/Anjaney1999","html_url":"https://github.com/Anjaney1999","followers_url":"https://api.github.com/users/Anjaney1999/followers","following_url":"https://api.github.com/users/Anjaney1999/following{/other_user}","gists_url":"https://api.github.com/users/Anjaney1999/gists{/gist_id}","starred_url":"https://api.github.com/users/Anjaney1999/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Anjaney1999/subscriptions","organizations_url":"https://api.github.com/users/Anjaney1999/orgs","repos_url":"https://api.github.com/users/Anjaney1999/repos","events_url":"https://api.github.com/users/Anjaney1999/events{/privacy}","received_events_url":"https://api.github.com/users/Anjaney1999/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-18T09:14:15Z","updated_at":"2023-04-18T09:14:15Z","author_association":"NONE","body":"@SusurHe did you find a solution to this?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1512740996/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]