[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704410239","html_url":"https://github.com/apache/iceberg/pull/1525#issuecomment-704410239","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1525","id":704410239,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNDQxMDIzOQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-06T16:51:05Z","updated_at":"2020-10-06T16:51:05Z","author_association":"CONTRIBUTOR","body":"I did one pass through the code and have a few questions/notes:\r\n\r\n**Iceberg vs Spark catalogs**\r\n\r\nI think it is reasonable to use the Spark catalog API instead of the Iceberg catalog API for the actual migration. I also like the idea of using staged tables. At the same time, I am not sure `stageCreateOrReplace` is the right semantics. I believe `replace` in case of Iceberg means replacing an Iceberg table with another Iceberg table.  To me, `stageCreate` sounds more appropriate in this case.\r\n\r\n**CreateActions vs Actions**\r\n\r\nI understand that this API targets Spark 3 while the Actions API is in the common module. Would it make sense to keep `BaseActions` in the shared module and have separate `Actions` in spark2 and spark3 modules? That way, we may add static methods like `snapshot` and `migrate` to the `Actions` in spark3. In spark2, there will no extra methods.\r\n\r\n**Session Catalog**\r\n\r\nLooks like this logic works only with the session catalog. It may be a reasonable limitation but I want to think through the use cases we want to support, especially around path-based tables (#1306).\r\n\r\nI consider this set of use cases as a minimum of what we should support for `SNAPSHOT` and `MIGRATE` commands:\r\n\r\n```\r\n// Case 1.1: snapshot a location using HadoopTables (or a path-based catalog) for target\r\n\r\nSNAPSHOT TABLE parquet.`path/to/table`\r\nUSING iceberg\r\nLOCATION `path/to/another/location`\r\nTBLPROPERTIES (\r\n  'key' 'value'\r\n)\r\n\r\n// Case 1.2: snapshot a table in HMS using HiveCatalog for target\r\n\r\nSNAPSHOT TABLE hive_table AS iceberg_hive.table_name\r\nUSING iceberg\r\nLOCATION `path/to/another/location`\r\nTBLPROPERTIES (\r\n  'key' 'value'\r\n)\r\n\r\n// Case 2.1: migrate a location using HadoopTables (or path-based catalog) for target\r\n\r\nMIGRATE TABLE parquet.`path/to/table`\r\nUSING iceberg\r\nTBLPROPERTIES (\r\n  'key' 'value'\r\n)\r\n\r\n// Case 2.2: migrate a table in HMS and replacing the pointer in HMS\r\n\r\nMIGRATE TABLE hive_table\r\nUSING iceberg\r\nTBLPROPERTIES (\r\n  'key' 'value'\r\n)\r\n```\r\n\r\nWe need to clarify how our path-based integration will look like. @rdblue @RussellSpitzer, will our existing Spark catalogs have references to `HiveCatalog` as well as to `HadoopTables` or will there be a new Iceberg catalog for path-based tables? If we go with the second option (separate catalog), then we will not be able to use the same session catalog to migrate both HMS-based and path-based tables. That seems like a substantial limitation. I can see people using both in some cases. Maybe not too common?\r\n\r\nI think we should clarify whether `MIGRATE` should be limited to the session catalog only. If so, will we be able to migrate both path-based and metastore tables using the same session catalog? If we want to support not only the session catalog, we may reconsider `MIGRATE t1 AS t2` syntax that we discarded in the first place.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704410239/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704412750","html_url":"https://github.com/apache/iceberg/pull/1487#issuecomment-704412750","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1487","id":704412750,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNDQxMjc1MA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-06T16:55:27Z","updated_at":"2020-10-06T16:55:27Z","author_association":"CONTRIBUTOR","body":"Thanks for the explanation. My general preference is for tests with a smaller scope to help identify the part that is going wrong, rather than larger end-to-end tests that could fail in lots of places. But `TestFilteredScan` is already exercising more than just the filter pushdown during planning, so both are similar in scope.\r\n\r\nI'll merge this and defer to you about how we should maintain these two. Thanks for taking the time to write these.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704412750/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704415526","html_url":"https://github.com/apache/iceberg/issues/1555#issuecomment-704415526","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1555","id":704415526,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNDQxNTUyNg==","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-06T17:00:38Z","updated_at":"2020-10-06T17:00:38Z","author_association":"CONTRIBUTOR","body":"@openinx @JingsongLi @rdblue I am thinking about pushing our Avro writer upstream. this is the tracking issue.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704415526/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704417913","html_url":"https://github.com/apache/iceberg/issues/1555#issuecomment-704417913","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1555","id":704417913,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNDQxNzkxMw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-06T17:04:38Z","updated_at":"2020-10-06T17:04:38Z","author_association":"CONTRIBUTOR","body":"I would rather not use the Avro object model upstream, since it has some serious problems:\r\n* No support for date/time types\r\n* No support for decimal\r\n* No support for non-string map keys\r\n\r\nAnd, accepting Avro records introduces issues when users have records with unsupported union types.\r\n\r\nHow about using the Iceberg generic records upstream instead?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704417913/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704435045","html_url":"https://github.com/apache/iceberg/issues/1555#issuecomment-704435045","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1555","id":704435045,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNDQzNTA0NQ==","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-06T17:35:03Z","updated_at":"2020-10-06T17:35:44Z","author_association":"CONTRIBUTOR","body":"@rdblue that is fair. we will keep the Avro writer locally then. We can revisit the decision if there are more askings.\r\n\r\nI definitely see a need for Iceberg GenericRecord upstream. E.g. we have a user asking for non-string Map key for Flink writer.\r\n\r\nBut since we are using Avro for Kafka data, I would rather avoid the type conversion btw Avro GenericRecord and Iceberg GenericRecord. In a nutshell, internally we probably would need both Avro and Iceberg Record support.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704435045/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704460069","html_url":"https://github.com/apache/iceberg/issues/1555#issuecomment-704460069","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1555","id":704460069,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNDQ2MDA2OQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-06T18:18:40Z","updated_at":"2020-10-06T18:18:40Z","author_association":"CONTRIBUTOR","body":"I agree, we probably need both. We should be able to use Iceberg generics directly for most internal uses. It is easier the more we move toward Iceberg schemas for streams, too.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704460069/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704509028","html_url":"https://github.com/apache/iceberg/pull/1553#issuecomment-704509028","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1553","id":704509028,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNDUwOTAyOA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-06T19:37:30Z","updated_at":"2020-10-06T19:37:30Z","author_association":"CONTRIBUTOR","body":"Thanks, @stevenzwu! I merged the fix.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704509028/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704562595","html_url":"https://github.com/apache/iceberg/pull/1495#issuecomment-704562595","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1495","id":704562595,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNDU2MjU5NQ==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-06T21:27:44Z","updated_at":"2020-10-06T21:27:44Z","author_association":"CONTRIBUTOR","body":"> > I reran to see if the tests were flaky and it failed.\r\n> \r\n> Yeah, seen those before too - some flaky stuff I have to investigate. 😢\r\n> This is the one on my list 😄\r\n\r\nI was able to repro one failure on my machine. Here is what I have found:\r\n```\r\n    2020-10-06 20:59:58,935 WARN  [Thread-1171] mapred.LocalJobRunner (LocalJobRunner.java:run(560)) - job_local1088664218_0010\r\n    java.lang.Exception: java.lang.OutOfMemoryError: Java heap space\r\n        at org.apache.hadoop.mapred.LocalJobRunner$Job.runTasks(LocalJobRunner.java:462)\r\n        at org.apache.hadoop.mapred.LocalJobRunner$Job.run(LocalJobRunner.java:522)\r\n    Caused by: java.lang.OutOfMemoryError: Java heap space\r\n        at org.apache.hadoop.mapred.MapTask$MapOutputBuffer.init(MapTask.java:986)\r\n        at org.apache.hadoop.mapred.MapTask.createSortingCollector(MapTask.java:402)\r\n        at org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:442)\r\n        at org.apache.hadoop.mapred.MapTask.run(MapTask.java:343)\r\n        at org.apache.hadoop.mapred.LocalJobRunner$Job$MapTaskRunnable.run(LocalJobRunner.java:243)\r\n        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)\r\n        at java.util.concurrent.FutureTask.run(FutureTask.java:266)\r\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n        at java.lang.Thread.run(Thread.java:748)\r\n```\r\n\r\nHope that this fix helps, since it is clear that on my machine the tests are rarely failing, but the failure happens more often on travis. @rdblue: Is there a way to rerun flaky tests to see if they are fixed or not?\r\n\r\nThanks,\r\nPeter\r\n\r\nPS: Also added `iceberg.engine.hive.enabled` to the `TestHiveIcebergStorageHandlerWithHiveCatalog` tests since that seems like a more often used scenario.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704562595/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704563212","html_url":"https://github.com/apache/iceberg/pull/1545#issuecomment-704563212","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1545","id":704563212,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNDU2MzIxMg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-06T21:29:06Z","updated_at":"2020-10-06T21:29:06Z","author_association":"CONTRIBUTOR","body":"+1\r\n\r\nI think this is a reasonable fix that is more in line with user expectations than independent and never-changing data frames.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704563212/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704568524","html_url":"https://github.com/apache/iceberg/pull/1517#issuecomment-704568524","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1517","id":704568524,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNDU2ODUyNA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-06T21:41:37Z","updated_at":"2020-10-06T21:41:37Z","author_association":"CONTRIBUTOR","body":"@chenjunjiedada, now that #1497 is merged, can you rebase this one on top of that? That should remove most of the test changes.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704568524/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704600505","html_url":"https://github.com/apache/iceberg/pull/1487#issuecomment-704600505","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1487","id":704600505,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNDYwMDUwNQ==","user":{"login":"HeartSaVioR","id":1317309,"node_id":"MDQ6VXNlcjEzMTczMDk=","avatar_url":"https://avatars.githubusercontent.com/u/1317309?v=4","gravatar_id":"","url":"https://api.github.com/users/HeartSaVioR","html_url":"https://github.com/HeartSaVioR","followers_url":"https://api.github.com/users/HeartSaVioR/followers","following_url":"https://api.github.com/users/HeartSaVioR/following{/other_user}","gists_url":"https://api.github.com/users/HeartSaVioR/gists{/gist_id}","starred_url":"https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HeartSaVioR/subscriptions","organizations_url":"https://api.github.com/users/HeartSaVioR/orgs","repos_url":"https://api.github.com/users/HeartSaVioR/repos","events_url":"https://api.github.com/users/HeartSaVioR/events{/privacy}","received_events_url":"https://api.github.com/users/HeartSaVioR/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-06T23:11:05Z","updated_at":"2020-10-06T23:11:05Z","author_association":"CONTRIBUTOR","body":"Thanks for reviewing and merging! I'll think about the approach of maintaining these tests.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704600505/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704602415","html_url":"https://github.com/apache/iceberg/pull/1440#issuecomment-704602415","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1440","id":704602415,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNDYwMjQxNQ==","user":{"login":"danielcweeks","id":4925077,"node_id":"MDQ6VXNlcjQ5MjUwNzc=","avatar_url":"https://avatars.githubusercontent.com/u/4925077?v=4","gravatar_id":"","url":"https://api.github.com/users/danielcweeks","html_url":"https://github.com/danielcweeks","followers_url":"https://api.github.com/users/danielcweeks/followers","following_url":"https://api.github.com/users/danielcweeks/following{/other_user}","gists_url":"https://api.github.com/users/danielcweeks/gists{/gist_id}","starred_url":"https://api.github.com/users/danielcweeks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielcweeks/subscriptions","organizations_url":"https://api.github.com/users/danielcweeks/orgs","repos_url":"https://api.github.com/users/danielcweeks/repos","events_url":"https://api.github.com/users/danielcweeks/events{/privacy}","received_events_url":"https://api.github.com/users/danielcweeks/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-06T23:17:12Z","updated_at":"2020-10-06T23:17:12Z","author_association":"CONTRIBUTOR","body":"+1 LGTM","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704602415/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704613714","html_url":"https://github.com/apache/iceberg/pull/1551#issuecomment-704613714","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1551","id":704613714,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNDYxMzcxNA==","user":{"login":"danielcweeks","id":4925077,"node_id":"MDQ6VXNlcjQ5MjUwNzc=","avatar_url":"https://avatars.githubusercontent.com/u/4925077?v=4","gravatar_id":"","url":"https://api.github.com/users/danielcweeks","html_url":"https://github.com/danielcweeks","followers_url":"https://api.github.com/users/danielcweeks/followers","following_url":"https://api.github.com/users/danielcweeks/following{/other_user}","gists_url":"https://api.github.com/users/danielcweeks/gists{/gist_id}","starred_url":"https://api.github.com/users/danielcweeks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielcweeks/subscriptions","organizations_url":"https://api.github.com/users/danielcweeks/orgs","repos_url":"https://api.github.com/users/danielcweeks/repos","events_url":"https://api.github.com/users/danielcweeks/events{/privacy}","received_events_url":"https://api.github.com/users/danielcweeks/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-06T23:57:25Z","updated_at":"2020-10-06T23:57:25Z","author_association":"CONTRIBUTOR","body":"+1","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704613714/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704619830","html_url":"https://github.com/apache/iceberg/pull/1525#issuecomment-704619830","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1525","id":704619830,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNDYxOTgzMA==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-07T00:18:55Z","updated_at":"2020-10-07T00:18:55Z","author_association":"MEMBER","body":"I was thinking the SparkSessionCatalog(Iceberg) would just be able to load paths as temporary tables. It would do this in the \"loadTable\" method since we can just hijack incoming identifiers there and as long as we return a table Spark is happy.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704619830/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704707218","html_url":"https://github.com/apache/iceberg/pull/1557#issuecomment-704707218","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1557","id":704707218,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNDcwNzIxOA==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-07T05:45:03Z","updated_at":"2020-10-07T05:45:03Z","author_association":"CONTRIBUTOR","body":"> This error occurs on the mappers and the reason for this failure is that the job configurations such as `TABLE_SCHEMA`, `TABLE_LOCATION`, `TABLE_IDENTIFIER` are not set correctly.\r\n\r\nWhich version of Hive you are using? Or this is query dependent?\r\n\r\nThanks for spotting the issue! \r\nPeter","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704707218/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704792040","html_url":"https://github.com/apache/iceberg/pull/1559#issuecomment-704792040","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1559","id":704792040,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNDc5MjA0MA==","user":{"login":"HeartSaVioR","id":1317309,"node_id":"MDQ6VXNlcjEzMTczMDk=","avatar_url":"https://avatars.githubusercontent.com/u/1317309?v=4","gravatar_id":"","url":"https://api.github.com/users/HeartSaVioR","html_url":"https://github.com/HeartSaVioR","followers_url":"https://api.github.com/users/HeartSaVioR/followers","following_url":"https://api.github.com/users/HeartSaVioR/following{/other_user}","gists_url":"https://api.github.com/users/HeartSaVioR/gists{/gist_id}","starred_url":"https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HeartSaVioR/subscriptions","organizations_url":"https://api.github.com/users/HeartSaVioR/orgs","repos_url":"https://api.github.com/users/HeartSaVioR/repos","events_url":"https://api.github.com/users/HeartSaVioR/events{/privacy}","received_events_url":"https://api.github.com/users/HeartSaVioR/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-07T08:51:21Z","updated_at":"2020-10-07T09:02:21Z","author_association":"CONTRIBUTOR","body":"If I understand correctly, these operations should be applied regardless of existing version file - consider the case when two concurrent writers both see there's no existing version file and try to write to the path directly.\r\n\r\nThat said, delete -> rename can be (should be?) replaced with rename with overwrite = true. If I'm not missing anything, this ensures last one wins (there's no way to ensure atomicity via atomic rename when the file may exist, so that's a best effort) and partial file is not exposed.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704792040/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704798105","html_url":"https://github.com/apache/iceberg/pull/1559#issuecomment-704798105","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1559","id":704798105,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNDc5ODEwNQ==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-07T09:02:21Z","updated_at":"2020-10-07T09:02:21Z","author_association":"CONTRIBUTOR","body":"> That said, delete -> rename can be (should be?) replaced with rename with overwrite = true. If I'm not missing anything, this ensures last one wins and partial file is not exposed.\r\n\r\nI think we could not use rename with overwrite since it behaves differently on different [FileSystems](https://hadoop.apache.org/docs/current/hadoop-project-dist/hadoop-common/filesystem/filesystem.html#boolean_rename.28Path_src.2C_Path_d.29):\r\n```\r\nDestination exists and is a file\r\n\r\nRenaming a file atop an existing file is specified as failing, raising an exception.\r\n- Local FileSystem : the rename succeeds; the destination file is replaced by the source file.\r\n- HDFS : The rename fails, no exception is raised. Instead the method call simply returns false.\r\n```\r\n\r\nThat is why we decided to use delete + rename which works consistently for every FS","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704798105/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704806462","html_url":"https://github.com/apache/iceberg/pull/1559#issuecomment-704806462","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1559","id":704806462,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNDgwNjQ2Mg==","user":{"login":"lcspinter","id":47777102,"node_id":"MDQ6VXNlcjQ3Nzc3MTAy","avatar_url":"https://avatars.githubusercontent.com/u/47777102?v=4","gravatar_id":"","url":"https://api.github.com/users/lcspinter","html_url":"https://github.com/lcspinter","followers_url":"https://api.github.com/users/lcspinter/followers","following_url":"https://api.github.com/users/lcspinter/following{/other_user}","gists_url":"https://api.github.com/users/lcspinter/gists{/gist_id}","starred_url":"https://api.github.com/users/lcspinter/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lcspinter/subscriptions","organizations_url":"https://api.github.com/users/lcspinter/orgs","repos_url":"https://api.github.com/users/lcspinter/repos","events_url":"https://api.github.com/users/lcspinter/events{/privacy}","received_events_url":"https://api.github.com/users/lcspinter/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-07T09:17:19Z","updated_at":"2020-10-07T09:17:19Z","author_association":"CONTRIBUTOR","body":"@pvary Thanks for the review. I've committed an improved version of the fix. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704806462/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704808370","html_url":"https://github.com/apache/iceberg/pull/1559#issuecomment-704808370","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1559","id":704808370,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNDgwODM3MA==","user":{"login":"HeartSaVioR","id":1317309,"node_id":"MDQ6VXNlcjEzMTczMDk=","avatar_url":"https://avatars.githubusercontent.com/u/1317309?v=4","gravatar_id":"","url":"https://api.github.com/users/HeartSaVioR","html_url":"https://github.com/HeartSaVioR","followers_url":"https://api.github.com/users/HeartSaVioR/followers","following_url":"https://api.github.com/users/HeartSaVioR/following{/other_user}","gists_url":"https://api.github.com/users/HeartSaVioR/gists{/gist_id}","starred_url":"https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HeartSaVioR/subscriptions","organizations_url":"https://api.github.com/users/HeartSaVioR/orgs","repos_url":"https://api.github.com/users/HeartSaVioR/repos","events_url":"https://api.github.com/users/HeartSaVioR/events{/privacy}","received_events_url":"https://api.github.com/users/HeartSaVioR/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-07T09:20:38Z","updated_at":"2020-10-07T09:27:05Z","author_association":"CONTRIBUTOR","body":"> - HDFS : The rename fails, no exception is raised. Instead the method call simply returns false.\r\n\r\nI guess it's not explaining the case when overwrite = true. (If then HDFS is breaking contract. I agree local filesystem is breaking contract without the option so can't simply rely on contract.)\r\n\r\ndelete -> rename would work if we simply do delete regardless of when the file exists or not, so not a big deal though. Just wanted to try to ensure the last one wins, but on concurrent writers it wouldn't be weird anyone wins.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704808370/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704810941","html_url":"https://github.com/apache/iceberg/pull/1495#issuecomment-704810941","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1495","id":704810941,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNDgxMDk0MQ==","user":{"login":"massdosage","id":29457,"node_id":"MDQ6VXNlcjI5NDU3","avatar_url":"https://avatars.githubusercontent.com/u/29457?v=4","gravatar_id":"","url":"https://api.github.com/users/massdosage","html_url":"https://github.com/massdosage","followers_url":"https://api.github.com/users/massdosage/followers","following_url":"https://api.github.com/users/massdosage/following{/other_user}","gists_url":"https://api.github.com/users/massdosage/gists{/gist_id}","starred_url":"https://api.github.com/users/massdosage/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/massdosage/subscriptions","organizations_url":"https://api.github.com/users/massdosage/orgs","repos_url":"https://api.github.com/users/massdosage/repos","events_url":"https://api.github.com/users/massdosage/events{/privacy}","received_events_url":"https://api.github.com/users/massdosage/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-07T09:25:07Z","updated_at":"2020-10-07T09:25:07Z","author_association":"CONTRIBUTOR","body":"Hey, I'm afraid I haven't had time to look at this but I did just try check out the `pvary:hivemetahook` branch and ran `./gradlew build' (using OpenJDK 11 on Linux) and I get different test failures as mentioned above. Apache/master builds with no errors. FWIW here's a summary of the test failures from different runs - they all seem to be related to the row group filter:\r\n\r\n**org.apache.iceberg.data.TestMetricsRowGroupFilter:**\r\n```\r\norg.apache.iceberg.exceptions.AlreadyExistsException: File already exists: /tmp/stats-row-group-filter-test.parquet\r\n\tat org.apache.iceberg.Files$LocalOutputFile.create(Files.java:58)\r\n\tat org.apache.iceberg.parquet.ParquetIO$ParquetOutputFile.create(ParquetIO.java:148)\r\n\tat org.apache.parquet.hadoop.ParquetFileWriter.<init>(ParquetFileWriter.java:295)\r\n\tat org.apache.parquet.hadoop.ParquetWriter.<init>(ParquetWriter.java:283)\r\n\tat org.apache.parquet.hadoop.ParquetWriter$Builder.build(ParquetWriter.java:564)\r\n\tat org.apache.iceberg.parquet.Parquet$WriteBuilder.build(Parquet.java:265)\r\n\tat org.apache.iceberg.data.TestMetricsRowGroupFilter.createParquetInputFile(TestMetricsRowGroupFilter.java:214)\r\n```\r\n**org.apache.iceberg.parquet.TestDictionaryRowGroupFilter:**\r\n```\r\njava.lang.RuntimeException: org.apache.iceberg.parquet.ParquetIO$ParquetInputFile@5b91de24 is not a Parquet file. expected magic number at tail [80, 65, 82, 49] but found [22, 0, 0, 0]\r\n\tat org.apache.parquet.hadoop.ParquetFileReader.readFooter(ParquetFileReader.java:531)\r\n\tat org.apache.parquet.hadoop.ParquetFileReader.<init>(ParquetFileReader.java:712)\r\n\tat org.apache.parquet.hadoop.ParquetFileReader.open(ParquetFileReader.java:597)\r\n\tat org.apache.iceberg.parquet.TestDictionaryRowGroupFilter.createInputFile(TestDictionaryRowGroupFilter.java:155)\r\n```\r\n**TestDictionaryRowGroupFilter:** 15 failures, here are 3 of them:\r\n```\r\njava.lang.AssertionError: Should skip: and(false, true)\r\n\tat org.junit.Assert.fail(Assert.java:88)\r\n\tat org.junit.Assert.assertTrue(Assert.java:41)\r\n\tat org.junit.Assert.assertFalse(Assert.java:64)\r\n\tat org.apache.iceberg.parquet.TestDictionaryRowGroupFilter.testAnd(TestDictionaryRowGroupFilter.java:346)\r\n```\r\n```\r\njava.lang.AssertionError: Should not read: id below lower bound\r\n\tat org.junit.Assert.fail(Assert.java:88)\r\n\tat org.junit.Assert.assertTrue(Assert.java:41)\r\n\tat org.junit.Assert.assertFalse(Assert.java:64)\r\n\tat org.apache.iceberg.parquet.TestDictionaryRowGroupFilter.testIntegerEq(TestDictionaryRowGroupFilter.java:453)\r\n```\r\n```\r\njava.lang.AssertionError: Should not read: id range above upper bound (85 < 79)\r\n\tat org.junit.Assert.fail(Assert.java:88)\r\n\tat org.junit.Assert.assertTrue(Assert.java:41)\r\n\tat org.junit.Assert.assertFalse(Assert.java:64)\r\n\tat org.apache.iceberg.parquet.TestDictionaryRowGroupFilter.testIntegerGt(TestDictionaryRowGroupFilter.java:415)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704810941/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704864268","html_url":"https://github.com/apache/iceberg/pull/1495#issuecomment-704864268","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1495","id":704864268,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNDg2NDI2OA==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-07T11:10:40Z","updated_at":"2020-10-07T11:10:40Z","author_association":"CONTRIBUTOR","body":"@massdosage: Could you please double check the tests?\r\nI have tried to repro without luck. Here is what I have done:\r\n- I have fetched the latest code, rebased my changes.\r\n- I have downloaded OpenJDK 11 (openjdk 11.0.8 2020-07-14) and run the following tests:\r\n```\r\n./gradlew cleanTest :iceberg-data:test --tests TestMetricsRowGroupFilter\r\n./gradlew cleanTest :iceberg-parquet:test --tests TestDictionaryRowGroupFilter\r\n```\r\n\r\nSadly I was not able to repro the case. 😞 \r\n\r\nMy only solace (is this word appropriate here?) is that the travis tests are also green.\r\nAlso both `data` and `parquet` packages are only dependent on `iceberg-api`/`iceberg-core`/`iceberg-parquet`/`iceberg-orc` which I did not change in this patch","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704864268/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704887643","html_url":"https://github.com/apache/iceberg/pull/1559#issuecomment-704887643","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1559","id":704887643,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNDg4NzY0Mw==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-07T12:01:28Z","updated_at":"2020-10-07T12:01:28Z","author_association":"CONTRIBUTOR","body":"+1","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704887643/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704961465","html_url":"https://github.com/apache/iceberg/pull/1478#issuecomment-704961465","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1478","id":704961465,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNDk2MTQ2NQ==","user":{"login":"marton-bod","id":19599214,"node_id":"MDQ6VXNlcjE5NTk5MjE0","avatar_url":"https://avatars.githubusercontent.com/u/19599214?v=4","gravatar_id":"","url":"https://api.github.com/users/marton-bod","html_url":"https://github.com/marton-bod","followers_url":"https://api.github.com/users/marton-bod/followers","following_url":"https://api.github.com/users/marton-bod/following{/other_user}","gists_url":"https://api.github.com/users/marton-bod/gists{/gist_id}","starred_url":"https://api.github.com/users/marton-bod/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marton-bod/subscriptions","organizations_url":"https://api.github.com/users/marton-bod/orgs","repos_url":"https://api.github.com/users/marton-bod/repos","events_url":"https://api.github.com/users/marton-bod/events{/privacy}","received_events_url":"https://api.github.com/users/marton-bod/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-07T14:08:08Z","updated_at":"2020-10-07T14:08:08Z","author_association":"COLLABORATOR","body":"@rdblue Thanks for the suggestion! As per that, I've changed the code to create a metastore instance only once per test class to make things faster.\r\n\r\nThe intermittent test failure was due to the fact that, in Hive3, the hive conf properties you set on the HiveRunner shell were not passed down from HiveRunner to all the threads spawned inside it (e.g. `HiveMaterializedViewsRegistry`) during HS2 initialization. This meant that these threads were calling`ObjectStore#setConf` with a different set of jdo properties than the rest, leading to the closure and replacement of the global `ObjectStore#PersistenceManagerFactory` instance whenever a config change was detected (-- resulting in intermittent \"Persistence Manager has been closed\" errors for those threads that would still be using their cached, but now closed PMs). Fortunately, during `HiveConf` construction, all the system properties are surveyed and included so we can ensure that the `metastore_uris` property is properly propagated and get the desired behaviour.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704961465/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705055362","html_url":"https://github.com/apache/iceberg/pull/1469#issuecomment-705055362","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1469","id":705055362,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNTA1NTM2Mg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-07T16:35:55Z","updated_at":"2020-10-07T16:35:55Z","author_association":"CONTRIBUTOR","body":"Thanks for reviewing, @aokolnychyi! I'm merging this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705055362/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705056231","html_url":"https://github.com/apache/iceberg/pull/1495#issuecomment-705056231","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1495","id":705056231,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNTA1NjIzMQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-07T16:37:35Z","updated_at":"2020-10-07T16:38:57Z","author_association":"CONTRIBUTOR","body":"> org.apache.iceberg.data.TestMetricsRowGroupFilter\r\n\r\nThis is a flaky test that I just had to fix. I'll get the PR up for it soon. The problem is that it uses a static path instead of a unique temp file each run.\r\n\r\n**Update**: After looking at the others, I think they are all caused by this. You should be able to fix it by removing `/tmp/stats-row-group-filter-test.parquet`.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705056231/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705058235","html_url":"https://github.com/apache/iceberg/pull/1495#issuecomment-705058235","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1495","id":705058235,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNTA1ODIzNQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-07T16:41:18Z","updated_at":"2020-10-07T16:41:18Z","author_association":"CONTRIBUTOR","body":"@pvary, committers can restart the tests in Travis, but I usually create a new test case that runs another one in a loop, like this:\r\n\r\n```java\r\n@Test\r\npublic void testInALoop() {\r\n  for (int i = 0; i < 1_000; i += 1) {\r\n    testAnotherCase();\r\n  }\r\n}\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705058235/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705065368","html_url":"https://github.com/apache/iceberg/pull/1478#issuecomment-705065368","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1478","id":705065368,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNTA2NTM2OA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-07T16:54:11Z","updated_at":"2020-10-07T16:54:11Z","author_association":"CONTRIBUTOR","body":"Thanks for all your hard work on this, @marton-bod! Great to have support for Hive 3 now.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705065368/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705123960","html_url":"https://github.com/apache/iceberg/pull/1557#issuecomment-705123960","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1557","id":705123960,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNTEyMzk2MA==","user":{"login":"HotSushi","id":6441597,"node_id":"MDQ6VXNlcjY0NDE1OTc=","avatar_url":"https://avatars.githubusercontent.com/u/6441597?v=4","gravatar_id":"","url":"https://api.github.com/users/HotSushi","html_url":"https://github.com/HotSushi","followers_url":"https://api.github.com/users/HotSushi/followers","following_url":"https://api.github.com/users/HotSushi/following{/other_user}","gists_url":"https://api.github.com/users/HotSushi/gists{/gist_id}","starred_url":"https://api.github.com/users/HotSushi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HotSushi/subscriptions","organizations_url":"https://api.github.com/users/HotSushi/orgs","repos_url":"https://api.github.com/users/HotSushi/repos","events_url":"https://api.github.com/users/HotSushi/events{/privacy}","received_events_url":"https://api.github.com/users/HotSushi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-07T18:43:17Z","updated_at":"2020-10-07T18:43:17Z","author_association":"CONTRIBUTOR","body":"@pvary we're using hive 1.1. But I was not able to find any difference in the relevant code in Hive 2, which calls `configureJobConf` or `configureInputJobProperties`.\r\n\r\nQueries which can run on the driver and doesn't spawn mr jobs succeed, the problem is only faced by queries such as DESC which needs mr jobs.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705123960/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705131982","html_url":"https://github.com/apache/iceberg/pull/1557#issuecomment-705131982","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1557","id":705131982,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNTEzMTk4Mg==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-07T18:59:07Z","updated_at":"2020-10-07T18:59:07Z","author_association":"CONTRIBUTOR","body":"> Queries which can run on the driver and doesn't spawn mr jobs succeed, the problem is only faced by queries such as DESC which needs mr jobs.\r\n\r\nMakes sense.\r\nIt would be good to have a test case to prevent regression.\r\nAre we able to provide a test case which fails before the fix and works after?\r\nHiveIcebergStorageHandlerBaseTest.testJoinTables might be a good candidate for start.\r\n\r\nThanks, Peter \r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705131982/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705134896","html_url":"https://github.com/apache/iceberg/pull/1562#issuecomment-705134896","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1562","id":705134896,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNTEzNDg5Ng==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-07T19:04:43Z","updated_at":"2020-10-07T19:05:31Z","author_association":"CONTRIBUTOR","body":"@massdosage, this should fix the issues you hit when testing #1495.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705134896/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705137126","html_url":"https://github.com/apache/iceberg/pull/1407#issuecomment-705137126","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1407","id":705137126,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNTEzNzEyNg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-07T19:09:10Z","updated_at":"2020-10-07T19:09:10Z","author_association":"CONTRIBUTOR","body":"@pvary, after #1495, are we ready to start getting this write support in? I can start reviewing it next.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705137126/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705138872","html_url":"https://github.com/apache/iceberg/pull/1559#issuecomment-705138872","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1559","id":705138872,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNTEzODg3Mg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-07T19:12:44Z","updated_at":"2020-10-07T19:12:44Z","author_association":"CONTRIBUTOR","body":"If there is a rename with overwrite option, then I would prefer to use that for the cases where it _is_ atomic. That would be safer. (Side note: local FS doesn't provide atomic rename, even without overwrite, so you shouldn't be using Hadoop tables with it except for tests.)\r\n\r\nAlso, we don't care whether the version hint is completely up to date. We just want to be close to the real version. Being a version or two behind is okay.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705138872/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705148896","html_url":"https://github.com/apache/iceberg/pull/1561#issuecomment-705148896","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1561","id":705148896,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNTE0ODg5Ng==","user":{"login":"shardulm94","id":6961317,"node_id":"MDQ6VXNlcjY5NjEzMTc=","avatar_url":"https://avatars.githubusercontent.com/u/6961317?v=4","gravatar_id":"","url":"https://api.github.com/users/shardulm94","html_url":"https://github.com/shardulm94","followers_url":"https://api.github.com/users/shardulm94/followers","following_url":"https://api.github.com/users/shardulm94/following{/other_user}","gists_url":"https://api.github.com/users/shardulm94/gists{/gist_id}","starred_url":"https://api.github.com/users/shardulm94/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shardulm94/subscriptions","organizations_url":"https://api.github.com/users/shardulm94/orgs","repos_url":"https://api.github.com/users/shardulm94/repos","events_url":"https://api.github.com/users/shardulm94/events{/privacy}","received_events_url":"https://api.github.com/users/shardulm94/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-07T19:32:42Z","updated_at":"2020-10-07T19:36:19Z","author_association":"CONTRIBUTOR","body":"@rdblue Let me retest this\r\nThe failed test seems unrelated and may be a flaky test\r\n```\r\norg.apache.iceberg.actions.TestExpireSnapshotsAction24 > dataFilesCleanupWithParallelTasks FAILED\r\n    java.lang.AssertionError: FILE_B should be deleted\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705148896/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705150115","html_url":"https://github.com/apache/iceberg/pull/1561#issuecomment-705150115","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1561","id":705150115,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNTE1MDExNQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-07T19:35:19Z","updated_at":"2020-10-07T19:35:19Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer, have you seen any failures in `TestExpireSnapshotsAction` before?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705150115/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705152103","html_url":"https://github.com/apache/iceberg/pull/1557#issuecomment-705152103","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1557","id":705152103,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNTE1MjEwMw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-07T19:39:38Z","updated_at":"2020-10-07T19:39:38Z","author_association":"CONTRIBUTOR","body":"Looks reasonable to me, but will this affect jobs that run multiple scans in a single MR stage?\r\n\r\n@massdosage, do we have HiveRunner tests for joins that run a two table scans in a stage?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705152103/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705152487","html_url":"https://github.com/apache/iceberg/pull/1561#issuecomment-705152487","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1561","id":705152487,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNTE1MjQ4Nw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-07T19:40:21Z","updated_at":"2020-10-07T19:40:21Z","author_association":"CONTRIBUTOR","body":"I restarted the JDK 8 test.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705152487/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705275597","html_url":"https://github.com/apache/iceberg/issues/1560#issuecomment-705275597","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1560","id":705275597,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNTI3NTU5Nw==","user":{"login":"HeartSaVioR","id":1317309,"node_id":"MDQ6VXNlcjEzMTczMDk=","avatar_url":"https://avatars.githubusercontent.com/u/1317309?v=4","gravatar_id":"","url":"https://api.github.com/users/HeartSaVioR","html_url":"https://github.com/HeartSaVioR","followers_url":"https://api.github.com/users/HeartSaVioR/followers","following_url":"https://api.github.com/users/HeartSaVioR/following{/other_user}","gists_url":"https://api.github.com/users/HeartSaVioR/gists{/gist_id}","starred_url":"https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HeartSaVioR/subscriptions","organizations_url":"https://api.github.com/users/HeartSaVioR/orgs","repos_url":"https://api.github.com/users/HeartSaVioR/repos","events_url":"https://api.github.com/users/HeartSaVioR/events{/privacy}","received_events_url":"https://api.github.com/users/HeartSaVioR/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-08T01:19:55Z","updated_at":"2020-10-08T01:19:55Z","author_association":"CONTRIBUTOR","body":"Spark version and Iceberg version, and the table schema, please?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705275597/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705338838","html_url":"https://github.com/apache/iceberg/pull/1508#issuecomment-705338838","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1508","id":705338838,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNTMzODgzOA==","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-08T05:29:07Z","updated_at":"2020-10-08T05:29:07Z","author_association":"CONTRIBUTOR","body":"> I think you need to check `.snapshots()` not `.snapshotLog()`. The latter seems to only retain the history of changes since the table was created/replaced. You can see in `TableMetadata.buildReplacement` that the prior history entries are not retained in the replacement.\r\n> \r\n> Also, from what I can tell, the metadata is always refreshed after the snapshot has been created (e.g., `SnapshotProducer.commit()`, `BaseTransaction.commitTransaction()`, etc... each refresh the metadata as part of the commit protocol). If that is always the case, then the loop should match the `Snapshot` with the first `MetadataLogEntry` where `MetadataLogEntry.timestampMillis() >= Snapshot.timestampMillis()`, and not the last `MetadataLogEntry.timestampMillis() <= Snapshot.timestampMillis()`.\r\n> \r\n> As a sanity check, the code could check the expected snapshot-id against the `TableMetadata` that is read.\r\n\r\nMy understanding from @rdblue's replies is that one should use the snapshot log, so I have stuck with that. Also, from what I see, the metadata timestamp is always the same as the snapshot timestamp when the metadata is written for a new snapshot. I changed the loop to look for the metadata log entry whose timestamp == the snapshot timestamp (and break out of the loop). (I could also use >= as you suggest, but it should make no difference.)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705338838/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705369551","html_url":"https://github.com/apache/iceberg/issues/1485#issuecomment-705369551","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1485","id":705369551,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNTM2OTU1MQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-08T06:50:18Z","updated_at":"2020-10-08T06:50:18Z","author_association":"CONTRIBUTOR","body":"I think we've done all we could on Iceberg side. Now we need to fix Spark and @sunchao will try to look into that.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705369551/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705373460","html_url":"https://github.com/apache/iceberg/issues/417#issuecomment-705373460","issue_url":"https://api.github.com/repos/apache/iceberg/issues/417","id":705373460,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNTM3MzQ2MA==","user":{"login":"ericsun2","id":8866410,"node_id":"MDQ6VXNlcjg4NjY0MTA=","avatar_url":"https://avatars.githubusercontent.com/u/8866410?v=4","gravatar_id":"","url":"https://api.github.com/users/ericsun2","html_url":"https://github.com/ericsun2","followers_url":"https://api.github.com/users/ericsun2/followers","following_url":"https://api.github.com/users/ericsun2/following{/other_user}","gists_url":"https://api.github.com/users/ericsun2/gists{/gist_id}","starred_url":"https://api.github.com/users/ericsun2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ericsun2/subscriptions","organizations_url":"https://api.github.com/users/ericsun2/orgs","repos_url":"https://api.github.com/users/ericsun2/repos","events_url":"https://api.github.com/users/ericsun2/events{/privacy}","received_events_url":"https://api.github.com/users/ericsun2/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-08T06:59:40Z","updated_at":"2020-10-08T06:59:40Z","author_association":"NONE","body":"IMHO, there are always 1.5 solutions:\r\n* 1.0 rich built-in Transform(s) which are hardened and provide great out-of-box logic + efficient pruning.\r\n* 0.5 custom Transform(s) which address niche patterns.\r\n\r\nSome of the popular custom Transform(s) can graduate into built-in category, and even reshape the built-in API over time.\r\n\r\nIf the long term vision of Iceberg also includes query optimization and file layout (sorting and partitioning) recommendation, then having more built-in Transform(s) can help accelerate that goal, because we can have proper parser to decode the true intention of the predicates and the corresponding granularity. Custom Transformation will probably make more predicates like blackboxes.\r\n\r\nCustom Transform is definitely needed (e.g. geo-region rollup hierarchy is a very useful UDT for partitioning structure), but I don't feel that should be the go-to solution. Using time zone as the example, those Chinese internet giants can really be the flagship users and contributors of Iceberg, and all of them need the time zone Transform. I don't really want to see 3 different custom Transform(s) from Alibaba, Tencent, and Bytedance with different names but very similar logic. Yet if the built-in Transform stays over-simplified or timezone-insensitive, then they don't have a choice.\r\n\r\nAlso custom Transform is more like a flattened approach:\r\n* day()  `-- timestamp | this is the only built-in one, all the others are custom ones`\r\n* dayWithTimezone()  `-- timestamp + time_zone` \r\n* dayFromEpochMillis()\r\n* dayFromEpoch()\r\n* dayFromYYYYMMDD()   `-- such as 20201001, this is a popular and efficient Date ID`\r\n\r\nIf Iceberg provides all the 4 other Transform(s) as well, then at least we have a better built-in base. These 4 may not be used as frequently as the 1st one, but it offers a better foundation to grow the community (and better template to write more custom Transform if necessary).\r\n\r\nThe optional argument is more like a nested approach:\r\n* day(timestamp)\r\n* day(timestamp_with_timezone)\r\n* day(timetamp, time_zone)\r\n* day(long, precision_enum)    `-- EPOCH_MILLIS, EPOCH, EPOCH_MINUTE, YYYYMMDD`\r\n\r\nWe can continue discussing/evaluating the complexity of partition pruning implementation for the flattened approach and the nested approach.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705373460/reactions","total_count":4,"+1":4,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705514115","html_url":"https://github.com/apache/iceberg/pull/1559#issuecomment-705514115","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1559","id":705514115,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNTUxNDExNQ==","user":{"login":"lcspinter","id":47777102,"node_id":"MDQ6VXNlcjQ3Nzc3MTAy","avatar_url":"https://avatars.githubusercontent.com/u/47777102?v=4","gravatar_id":"","url":"https://api.github.com/users/lcspinter","html_url":"https://github.com/lcspinter","followers_url":"https://api.github.com/users/lcspinter/followers","following_url":"https://api.github.com/users/lcspinter/following{/other_user}","gists_url":"https://api.github.com/users/lcspinter/gists{/gist_id}","starred_url":"https://api.github.com/users/lcspinter/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lcspinter/subscriptions","organizations_url":"https://api.github.com/users/lcspinter/orgs","repos_url":"https://api.github.com/users/lcspinter/repos","events_url":"https://api.github.com/users/lcspinter/events{/privacy}","received_events_url":"https://api.github.com/users/lcspinter/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-08T11:43:46Z","updated_at":"2020-10-08T11:43:46Z","author_association":"CONTRIBUTOR","body":"Since the FileSystem API doesn't provide atomic renames, that's why we choose to create new file + delete old file + rename new file path. \r\n@rdblue If you don't have any more remarks, could you please push this change to master? Thanks","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705514115/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705584192","html_url":"https://github.com/apache/iceberg/pull/1557#issuecomment-705584192","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1557","id":705584192,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNTU4NDE5Mg==","user":{"login":"massdosage","id":29457,"node_id":"MDQ6VXNlcjI5NDU3","avatar_url":"https://avatars.githubusercontent.com/u/29457?v=4","gravatar_id":"","url":"https://api.github.com/users/massdosage","html_url":"https://github.com/massdosage","followers_url":"https://api.github.com/users/massdosage/followers","following_url":"https://api.github.com/users/massdosage/following{/other_user}","gists_url":"https://api.github.com/users/massdosage/gists{/gist_id}","starred_url":"https://api.github.com/users/massdosage/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/massdosage/subscriptions","organizations_url":"https://api.github.com/users/massdosage/orgs","repos_url":"https://api.github.com/users/massdosage/repos","events_url":"https://api.github.com/users/massdosage/events{/privacy}","received_events_url":"https://api.github.com/users/massdosage/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-08T13:52:34Z","updated_at":"2020-10-08T13:56:00Z","author_association":"CONTRIBUTOR","body":"> Looks reasonable to me, but will this affect jobs that run multiple scans in a single MR stage?\r\n> \r\n> @massdosage, do we have HiveRunner tests for joins that run a two table scans in a stage?\r\n\r\nI think this does it: https://github.com/ExpediaGroup/iceberg/blob/master/mr/src/test/java/org/apache/iceberg/mr/hive/HiveIcebergStorageHandlerBaseTest.java#L145 as @pvary mentioned above. I know this caught an issue with multiple tables not being configured for the scan properly in the past but it's possible it doesn't capture all the cases that can occur.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705584192/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705661740","html_url":"https://github.com/apache/iceberg/issues/1560#issuecomment-705661740","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1560","id":705661740,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNTY2MTc0MA==","user":{"login":"cccs-dm","id":62555897,"node_id":"MDQ6VXNlcjYyNTU1ODk3","avatar_url":"https://avatars.githubusercontent.com/u/62555897?v=4","gravatar_id":"","url":"https://api.github.com/users/cccs-dm","html_url":"https://github.com/cccs-dm","followers_url":"https://api.github.com/users/cccs-dm/followers","following_url":"https://api.github.com/users/cccs-dm/following{/other_user}","gists_url":"https://api.github.com/users/cccs-dm/gists{/gist_id}","starred_url":"https://api.github.com/users/cccs-dm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cccs-dm/subscriptions","organizations_url":"https://api.github.com/users/cccs-dm/orgs","repos_url":"https://api.github.com/users/cccs-dm/repos","events_url":"https://api.github.com/users/cccs-dm/events{/privacy}","received_events_url":"https://api.github.com/users/cccs-dm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-08T15:52:11Z","updated_at":"2020-10-08T15:52:11Z","author_association":"NONE","body":"I am using Spark 3.0.0 and Iceberg 0.9.0.\r\n\r\nHere's the table schema:\r\n```\r\n            \"schema\": {\r\n                \"fields\": [\r\n                    {\r\n                        \"metadata\": {},\r\n                        \"name\": \"id\",\r\n                        \"nullable\": false,\r\n                        \"type\": \"long\"\r\n                    },\r\n                    {\r\n                        \"metadata\": {},\r\n                        \"name\": \"MARK\",\r\n                        \"nullable\": false,\r\n                        \"type\": {\r\n                            \"fields\": [\r\n                                {\r\n                                    \"metadata\": {},\r\n                                    \"name\": \"col1\",\r\n                                    \"nullable\": false,\r\n                                    \"type\": \"integer\"\r\n                                }\r\n                            ],\r\n                            \"type\": \"struct\"\r\n                        }\r\n                    }\r\n                ],\r\n                \"type\": \"struct\"\r\n            }\r\n```\r\n\r\nThanks.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705661740/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705707342","html_url":"https://github.com/apache/iceberg/pull/1558#issuecomment-705707342","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1558","id":705707342,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNTcwNzM0Mg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-08T17:11:56Z","updated_at":"2020-10-08T17:11:56Z","author_association":"CONTRIBUTOR","body":"@zhangjun0x01, @JingsongLi, how does Flink normally handle hive-site.xml files? This seems strange to me, so I'd like to understand if this is something that Flink would normally do.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705707342/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705708847","html_url":"https://github.com/apache/iceberg/pull/1557#issuecomment-705708847","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1557","id":705708847,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNTcwODg0Nw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-08T17:14:46Z","updated_at":"2020-10-08T17:14:46Z","author_association":"CONTRIBUTOR","body":"Okay, if we do have a test case that does a simple join, then I think this should be okay. It doesn't sound like we can reproduce the issue with the newer Hive versions, though. So I'll merge this without adding a test for it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705708847/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705839640","html_url":"https://github.com/apache/iceberg/issues/1383#issuecomment-705839640","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1383","id":705839640,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNTgzOTY0MA==","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-08T21:43:24Z","updated_at":"2020-10-08T21:43:24Z","author_association":"CONTRIBUTOR","body":"@JingsongLi we should use the new FLIP-27 source interface, right?  \r\n* enumerator/monitor runs in jobmanager\r\n* enumerator tracks discovered splits\r\n* enumerator assigns a split when a readers requests for one\r\n\r\nWe probably don't want enumerator statically assign all discovered splits up front. Dynamic assignment is better for load balancing with straggler/outlier reader nodes.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705839640/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705916509","html_url":"https://github.com/apache/iceberg/pull/1558#issuecomment-705916509","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1558","id":705916509,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNTkxNjUwOQ==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-09T01:36:43Z","updated_at":"2020-10-09T01:36:43Z","author_association":"CONTRIBUTOR","body":"> @zhangjun0x01, @JingsongLi, how does Flink normally handle hive-site.xml files? This seems strange to me, so I'd like to understand if this is something that Flink would normally do.\r\n\r\nhi,@rdblue:\r\n   As far as I know, flink provides a hiveConfDir to get hive-site.xml, it is indeed no problem before flink 1.11, but flink 1.11 provides an application mode to submit flink  job, in this case, the user jar is parsed  in the jobmanager node of flink, but this jobmanager node is very likely to have no hive-site.xml file. If we provide a local path to get hive-site.xml, the program will not find it in application mode , so I thought of a way to be compatible with flink's various submission modes . We provide a local or hdfs path to get hive-site.xml.I described possible problems in the https://github.com/apache/iceberg/issues/1437\r\n\r\n I think this should also be a issue with flink. What do you think?@JingsongLi","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705916509/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705918399","html_url":"https://github.com/apache/iceberg/issues/1383#issuecomment-705918399","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1383","id":705918399,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNTkxODM5OQ==","user":{"login":"JingsongLi","id":9601882,"node_id":"MDQ6VXNlcjk2MDE4ODI=","avatar_url":"https://avatars.githubusercontent.com/u/9601882?v=4","gravatar_id":"","url":"https://api.github.com/users/JingsongLi","html_url":"https://github.com/JingsongLi","followers_url":"https://api.github.com/users/JingsongLi/followers","following_url":"https://api.github.com/users/JingsongLi/following{/other_user}","gists_url":"https://api.github.com/users/JingsongLi/gists{/gist_id}","starred_url":"https://api.github.com/users/JingsongLi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JingsongLi/subscriptions","organizations_url":"https://api.github.com/users/JingsongLi/orgs","repos_url":"https://api.github.com/users/JingsongLi/repos","events_url":"https://api.github.com/users/JingsongLi/events{/privacy}","received_events_url":"https://api.github.com/users/JingsongLi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-09T01:44:28Z","updated_at":"2020-10-09T01:44:38Z","author_association":"CONTRIBUTOR","body":"Hi @stevenzwu , yes, The advantage is that the assignment will be more dynamic balanced.\r\n\r\nIt depends on the progress of FLIP-27.\r\nWe are trying to implement Filesystem/Hive source on FLIP-27 in FLINK 1.12. And in order to achieve this goal, we are modifying the interfaces of FLIP-27 too. (FLIP-27 in Flink 1.11 is not ready)\r\n\r\nIf the time is not urgent, we can wait for FLINK 1.12.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705918399/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705929459","html_url":"https://github.com/apache/iceberg/issues/1383#issuecomment-705929459","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1383","id":705929459,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNTkyOTQ1OQ==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-09T02:26:23Z","updated_at":"2020-10-09T02:26:23Z","author_association":"MEMBER","body":"@stevenzwu ,  we have implemented an internal version for flink streaming reader, which is not built on top of FLIP-27 now. Here is the pull request https://github.com/generic-datalake/iceberg-poc/pull/3/files for our own branch.  As  Jingsong described, once FLIP-27 is ready, we'd happy to switch the current implementation to FLIP-27. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705929459/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705938309","html_url":"https://github.com/apache/iceberg/pull/1558#issuecomment-705938309","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1558","id":705938309,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNTkzODMwOQ==","user":{"login":"JingsongLi","id":9601882,"node_id":"MDQ6VXNlcjk2MDE4ODI=","avatar_url":"https://avatars.githubusercontent.com/u/9601882?v=4","gravatar_id":"","url":"https://api.github.com/users/JingsongLi","html_url":"https://github.com/JingsongLi","followers_url":"https://api.github.com/users/JingsongLi/followers","following_url":"https://api.github.com/users/JingsongLi/following{/other_user}","gists_url":"https://api.github.com/users/JingsongLi/gists{/gist_id}","starred_url":"https://api.github.com/users/JingsongLi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JingsongLi/subscriptions","organizations_url":"https://api.github.com/users/JingsongLi/orgs","repos_url":"https://api.github.com/users/JingsongLi/repos","events_url":"https://api.github.com/users/JingsongLi/events{/privacy}","received_events_url":"https://api.github.com/users/JingsongLi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-09T02:55:09Z","updated_at":"2020-10-09T03:02:24Z","author_association":"CONTRIBUTOR","body":"Hi @rdblue @zhangjun0x01 \r\n- Spark has a built-in hive integration. So its hadoop conf contains `hive-site.xml`. (As @rdblue said, in `SharedState.loadHiveConfFile`)\r\n- But in Flink, Hive integration is optional. So the `HadoopUtils.getHadoopConfiguration(..)` not contains `hive-site.xml`. So just like @zhangjun0x01 said, `flink-connector-hive` provides a simple way, users need to pass a `hiveConfDir` to Flink `HiveCatalog`. (Now the `hiveConfDir` must be a local path)\r\n\r\nI created https://issues.apache.org/jira/browse/FLINK-19541 for track it.\r\n\r\nPersonally, I think we can provide two way in Flink:\r\n- From `hiveConfDir`, it should be URI which contains scheme and full path. This means it can be loaded by Hadoop Filesystem.\r\n- From the classpath, just like Spark do.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705938309/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705945755","html_url":"https://github.com/apache/iceberg/pull/1293#issuecomment-705945755","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1293","id":705945755,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNTk0NTc1NQ==","user":{"login":"JingsongLi","id":9601882,"node_id":"MDQ6VXNlcjk2MDE4ODI=","avatar_url":"https://avatars.githubusercontent.com/u/9601882?v=4","gravatar_id":"","url":"https://api.github.com/users/JingsongLi","html_url":"https://github.com/JingsongLi","followers_url":"https://api.github.com/users/JingsongLi/followers","following_url":"https://api.github.com/users/JingsongLi/following{/other_user}","gists_url":"https://api.github.com/users/JingsongLi/gists{/gist_id}","starred_url":"https://api.github.com/users/JingsongLi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JingsongLi/subscriptions","organizations_url":"https://api.github.com/users/JingsongLi/orgs","repos_url":"https://api.github.com/users/JingsongLi/repos","events_url":"https://api.github.com/users/JingsongLi/events{/privacy}","received_events_url":"https://api.github.com/users/JingsongLi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-09T03:25:30Z","updated_at":"2020-10-09T03:25:30Z","author_association":"CONTRIBUTOR","body":"Thanks all for your help, all sub-PRs have been completed. I'll close this PR.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705945755/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705952388","html_url":"https://github.com/apache/iceberg/pull/1565#issuecomment-705952388","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1565","id":705952388,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNTk1MjM4OA==","user":{"login":"JingsongLi","id":9601882,"node_id":"MDQ6VXNlcjk2MDE4ODI=","avatar_url":"https://avatars.githubusercontent.com/u/9601882?v=4","gravatar_id":"","url":"https://api.github.com/users/JingsongLi","html_url":"https://github.com/JingsongLi","followers_url":"https://api.github.com/users/JingsongLi/followers","following_url":"https://api.github.com/users/JingsongLi/following{/other_user}","gists_url":"https://api.github.com/users/JingsongLi/gists{/gist_id}","starred_url":"https://api.github.com/users/JingsongLi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JingsongLi/subscriptions","organizations_url":"https://api.github.com/users/JingsongLi/orgs","repos_url":"https://api.github.com/users/JingsongLi/repos","events_url":"https://api.github.com/users/JingsongLi/events{/privacy}","received_events_url":"https://api.github.com/users/JingsongLi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-09T03:55:30Z","updated_at":"2020-10-09T03:55:30Z","author_association":"CONTRIBUTOR","body":"CC: @rdblue @openinx ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705952388/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705989368","html_url":"https://github.com/apache/iceberg/pull/1329#issuecomment-705989368","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1329","id":705989368,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNTk4OTM2OA==","user":{"login":"duanmeng","id":5107360,"node_id":"MDQ6VXNlcjUxMDczNjA=","avatar_url":"https://avatars.githubusercontent.com/u/5107360?v=4","gravatar_id":"","url":"https://api.github.com/users/duanmeng","html_url":"https://github.com/duanmeng","followers_url":"https://api.github.com/users/duanmeng/followers","following_url":"https://api.github.com/users/duanmeng/following{/other_user}","gists_url":"https://api.github.com/users/duanmeng/gists{/gist_id}","starred_url":"https://api.github.com/users/duanmeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/duanmeng/subscriptions","organizations_url":"https://api.github.com/users/duanmeng/orgs","repos_url":"https://api.github.com/users/duanmeng/repos","events_url":"https://api.github.com/users/duanmeng/events{/privacy}","received_events_url":"https://api.github.com/users/duanmeng/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-09T06:10:41Z","updated_at":"2020-10-09T06:10:41Z","author_association":"NONE","body":"@rdblue  Got it thanks, these two PRs are exactly what I intend to do in this pr.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705989368/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705993764","html_url":"https://github.com/apache/iceberg/issues/1543#issuecomment-705993764","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1543","id":705993764,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNTk5Mzc2NA==","user":{"login":"zhangdove","id":25578853,"node_id":"MDQ6VXNlcjI1NTc4ODUz","avatar_url":"https://avatars.githubusercontent.com/u/25578853?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangdove","html_url":"https://github.com/zhangdove","followers_url":"https://api.github.com/users/zhangdove/followers","following_url":"https://api.github.com/users/zhangdove/following{/other_user}","gists_url":"https://api.github.com/users/zhangdove/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangdove/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangdove/subscriptions","organizations_url":"https://api.github.com/users/zhangdove/orgs","repos_url":"https://api.github.com/users/zhangdove/repos","events_url":"https://api.github.com/users/zhangdove/events{/privacy}","received_events_url":"https://api.github.com/users/zhangdove/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-09T06:22:29Z","updated_at":"2020-10-09T06:22:29Z","author_association":"CONTRIBUTOR","body":"We can do some validation on the input parameters when creating the bucket partition.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705993764/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705997827","html_url":"https://github.com/apache/iceberg/issues/1543#issuecomment-705997827","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1543","id":705997827,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNTk5NzgyNw==","user":{"login":"zhangdove","id":25578853,"node_id":"MDQ6VXNlcjI1NTc4ODUz","avatar_url":"https://avatars.githubusercontent.com/u/25578853?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangdove","html_url":"https://github.com/zhangdove","followers_url":"https://api.github.com/users/zhangdove/followers","following_url":"https://api.github.com/users/zhangdove/following{/other_user}","gists_url":"https://api.github.com/users/zhangdove/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangdove/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangdove/subscriptions","organizations_url":"https://api.github.com/users/zhangdove/orgs","repos_url":"https://api.github.com/users/zhangdove/repos","events_url":"https://api.github.com/users/zhangdove/events{/privacy}","received_events_url":"https://api.github.com/users/zhangdove/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-09T06:32:23Z","updated_at":"2020-10-09T06:32:23Z","author_association":"CONTRIBUTOR","body":"It seems that some time has passed and there is no reply. I would provide a relevant PR to fix this small problem.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/705997827/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706006668","html_url":"https://github.com/apache/iceberg/pull/1515#issuecomment-706006668","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1515","id":706006668,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjAwNjY2OA==","user":{"login":"simonsssu","id":12323514,"node_id":"MDQ6VXNlcjEyMzIzNTE0","avatar_url":"https://avatars.githubusercontent.com/u/12323514?v=4","gravatar_id":"","url":"https://api.github.com/users/simonsssu","html_url":"https://github.com/simonsssu","followers_url":"https://api.github.com/users/simonsssu/followers","following_url":"https://api.github.com/users/simonsssu/following{/other_user}","gists_url":"https://api.github.com/users/simonsssu/gists{/gist_id}","starred_url":"https://api.github.com/users/simonsssu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/simonsssu/subscriptions","organizations_url":"https://api.github.com/users/simonsssu/orgs","repos_url":"https://api.github.com/users/simonsssu/repos","events_url":"https://api.github.com/users/simonsssu/events{/privacy}","received_events_url":"https://api.github.com/users/simonsssu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-09T06:54:37Z","updated_at":"2020-10-09T06:54:37Z","author_association":"CONTRIBUTOR","body":"CC: @openinx ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706006668/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706048644","html_url":"https://github.com/apache/iceberg/pull/1515#issuecomment-706048644","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1515","id":706048644,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjA0ODY0NA==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-09T08:32:42Z","updated_at":"2020-10-09T08:32:42Z","author_association":"MEMBER","body":"Sorry for the delay,  Let me take a look today. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706048644/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706097789","html_url":"https://github.com/apache/iceberg/issues/1555#issuecomment-706097789","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1555","id":706097789,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjA5Nzc4OQ==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-09T10:17:27Z","updated_at":"2020-10-09T10:17:27Z","author_association":"MEMBER","body":"If we write records by using avro writer directly and there are data types that we iceberg don't support, then other compute engine readers could not read the avro record correctly, that sounds a big risk ?   Did your internal users write any iceberg unsupported avro types ? \r\n\r\nAccepting the GenericRecords  sounds good to me.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706097789/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706098984","html_url":"https://github.com/apache/iceberg/pull/1477#issuecomment-706098984","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1477","id":706098984,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjA5ODk4NA==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-09T10:20:00Z","updated_at":"2020-10-09T10:20:00Z","author_association":"MEMBER","body":"Sorry for the delay,  I was on vocation for National Day during the last past days. I will update this PR according above comments today , Thanks.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706098984/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706208403","html_url":"https://github.com/apache/iceberg/pull/1517#issuecomment-706208403","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1517","id":706208403,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjIwODQwMw==","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-09T14:16:46Z","updated_at":"2020-10-09T14:16:46Z","author_association":"COLLABORATOR","body":"Just back from holiday, I will update this tomorrow.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706208403/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706236505","html_url":"https://github.com/apache/iceberg/issues/1567#issuecomment-706236505","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1567","id":706236505,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjIzNjUwNQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-09T15:07:20Z","updated_at":"2020-10-09T15:07:20Z","author_association":"MEMBER","body":"I'm confused why we want to do this? Isn't the point that an end user should include their own un-shaded version of guava if they want to access other classes?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706236505/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706294121","html_url":"https://github.com/apache/iceberg/pull/1477#issuecomment-706294121","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1477","id":706294121,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjI5NDEyMQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-09T16:59:18Z","updated_at":"2020-10-09T16:59:18Z","author_association":"CONTRIBUTOR","body":"@openinx, no problem. I didn't realize you were on vacation. Thanks for the update today!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706294121/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706341597","html_url":"https://github.com/apache/iceberg/pull/1421#issuecomment-706341597","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1421","id":706341597,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjM0MTU5Nw==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-09T18:37:34Z","updated_at":"2020-10-09T18:37:34Z","author_association":"MEMBER","body":"@rdblue Redid a bunch of refactors as we talked about, I also switched the testing to use parameterized versions of a bunch of already existing tests. I believe this does pretty good test coverage of the feature. I'll try to run some benchmarks in the near future.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706341597/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706386331","html_url":"https://github.com/apache/iceberg/pull/1517#issuecomment-706386331","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1517","id":706386331,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjM4NjMzMQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-09T20:24:11Z","updated_at":"2020-10-09T20:24:11Z","author_association":"CONTRIBUTOR","body":"Thanks, and welcome back.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706386331/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706387312","html_url":"https://github.com/apache/iceberg/issues/1555#issuecomment-706387312","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1555","id":706387312,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjM4NzMxMg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-09T20:26:45Z","updated_at":"2020-10-09T20:26:45Z","author_association":"CONTRIBUTOR","body":"We would just have to fail if an Avro record used a union schema. I don't think we've hit this case internally. We did hit the case where users wanted to write maps with numeric keys, though.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706387312/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706397167","html_url":"https://github.com/apache/iceberg/issues/1555#issuecomment-706397167","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1555","id":706397167,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjM5NzE2Nw==","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-09T20:51:48Z","updated_at":"2020-10-09T20:52:06Z","author_association":"CONTRIBUTOR","body":"@openinx I don't think there is risk. if Avro schema is incompatible (like non-optional union usage) with Iceberg schema, I would think write will fail like Ryan said. On the other hand, for the streaming path we do internally limit the Avro schema features that are compatible with Iceberg schema.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706397167/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706406044","html_url":"https://github.com/apache/iceberg/issues/1383#issuecomment-706406044","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1383","id":706406044,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjQwNjA0NA==","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-09T21:16:39Z","updated_at":"2020-10-09T21:16:39Z","author_association":"CONTRIBUTOR","body":"@JingsongLi  @openinx thx. We are currently implementing an Iceberg source based on FLIP-27 interface. Our initial goal is for backfill purpose. it is bounded but with streaming behavior. Meaning app code stayed with DataStream API, just switching source from Kafka to Iceberg. We are also very interested in streaming/continuous read pattern. It is not urgent. we can probably collaborate. Would love to see building blocks being pushed upstream slowly.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706406044/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706463677","html_url":"https://github.com/apache/iceberg/pull/1569#issuecomment-706463677","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1569","id":706463677,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjQ2MzY3Nw==","user":{"login":"zhangdove","id":25578853,"node_id":"MDQ6VXNlcjI1NTc4ODUz","avatar_url":"https://avatars.githubusercontent.com/u/25578853?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangdove","html_url":"https://github.com/zhangdove","followers_url":"https://api.github.com/users/zhangdove/followers","following_url":"https://api.github.com/users/zhangdove/following{/other_user}","gists_url":"https://api.github.com/users/zhangdove/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangdove/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangdove/subscriptions","organizations_url":"https://api.github.com/users/zhangdove/orgs","repos_url":"https://api.github.com/users/zhangdove/repos","events_url":"https://api.github.com/users/zhangdove/events{/privacy}","received_events_url":"https://api.github.com/users/zhangdove/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-10T01:30:51Z","updated_at":"2020-10-10T01:30:51Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer @shardulm94 Thanks for your review!  It's been fixed.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706463677/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706468337","html_url":"https://github.com/apache/iceberg/pull/1568#issuecomment-706468337","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1568","id":706468337,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjQ2ODMzNw==","user":{"login":"simonsssu","id":12323514,"node_id":"MDQ6VXNlcjEyMzIzNTE0","avatar_url":"https://avatars.githubusercontent.com/u/12323514?v=4","gravatar_id":"","url":"https://api.github.com/users/simonsssu","html_url":"https://github.com/simonsssu","followers_url":"https://api.github.com/users/simonsssu/followers","following_url":"https://api.github.com/users/simonsssu/following{/other_user}","gists_url":"https://api.github.com/users/simonsssu/gists{/gist_id}","starred_url":"https://api.github.com/users/simonsssu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/simonsssu/subscriptions","organizations_url":"https://api.github.com/users/simonsssu/orgs","repos_url":"https://api.github.com/users/simonsssu/repos","events_url":"https://api.github.com/users/simonsssu/events{/privacy}","received_events_url":"https://api.github.com/users/simonsssu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-10T02:04:55Z","updated_at":"2020-10-10T02:04:55Z","author_association":"CONTRIBUTOR","body":"CC: @rdblue ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706468337/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706492294","html_url":"https://github.com/apache/iceberg/pull/1577#issuecomment-706492294","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1577","id":706492294,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjQ5MjI5NA==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-10T05:40:47Z","updated_at":"2020-10-10T05:40:47Z","author_association":"CONTRIBUTOR","body":"Now that I think about it, whether or not we introduce an additional label for `METASTORE`, this project is of importance to those amongst us who are take special interest in hive related code changes. I'm going to add `hive-metastore` to the `HIVE` tag and possibly also leave up the open PR for adding it to a new label `METASTORE` as well.\r\n\r\nWhat I'd really like is to be able to add a label such as `CATALOG`, which would capture all of the catalog and metastore related changes. Additionally, I'd love to see a label for `InputFomat` related changes. But for now, as I don't have the time at the moment to take on a major change of the labeling system as I've got a few other open issues, I'll add these to keep things up to date.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706492294/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706492965","html_url":"https://github.com/apache/iceberg/pull/1576#issuecomment-706492965","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1576","id":706492965,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjQ5Mjk2NQ==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-10T05:48:12Z","updated_at":"2020-10-10T05:48:12Z","author_association":"CONTRIBUTOR","body":"I've somewhat changed my mind and am also tagging this one underneath `hive`. The labels need to indicate changes to code that are important to the different stakeholders. It would likely be a mistake to not still tag this as `HIVE`. https://github.com/apache/iceberg/pull/1577\r\n\r\nIt can still be tagged as `METASTORE` as well. After these are merged in, I'd like to consider some syntax cleanup over the whole file and then possibly add in tags for `CATALOG` and possibly `INPUTFORMAT`, which I also think are relevant.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706492965/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706493287","html_url":"https://github.com/apache/iceberg/pull/1573#issuecomment-706493287","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1573","id":706493287,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjQ5MzI4Nw==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-10T05:51:29Z","updated_at":"2020-10-10T05:51:29Z","author_association":"CONTRIBUTOR","body":"> This is a basic initial implementation of an S3 based FileIO implementation that includes the reading and writing objects using `putObject` and `getObject`.\r\n\r\nWill this not use MultiPartUploads? And what about the relatively new TransferManager, which will upload multipart uploads at specific byte lengths and then manage their commit altogether (and also ensure that readers can pull from S3 at the proper byte lengths for things like footers etc).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706493287/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706497388","html_url":"https://github.com/apache/iceberg/pull/1573#issuecomment-706497388","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1573","id":706497388,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjQ5NzM4OA==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-10T06:30:25Z","updated_at":"2020-10-10T06:30:25Z","author_association":"CONTRIBUTOR","body":"Has there been any consideration to using the AWS Java SDK v2? I know that @jacques-n mentioned they found the java v2 Async s3 SDK buggy, but the linked code from their project is using the AWS Java SDK v2 (all of the imports start with `software.amazon`).\r\n\r\nTo me it seems like it would be smarter to start on the newer client version than have to do an upgrade later.  My understanding is that the Java SDK V2 is much more performant for most things as its the one seeing most of the work. And though I don't doubt @jacques-n's performance / bug issues with the java sdk v2 async s3 client, but I would ask when that was? I've personally noticed that when new clients and new services are brought out by amazon, they're not always production ready from the start. But many times I've found that things we performance tested 6 months prior were much more performant / resilient later on.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706497388/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706518437","html_url":"https://github.com/apache/iceberg/pull/1558#issuecomment-706518437","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1558","id":706518437,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjUxODQzNw==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-10T09:21:42Z","updated_at":"2020-10-10T09:21:42Z","author_association":"CONTRIBUTOR","body":"hi:\r\n@rdblue ,@JingsongLi , I update the PR to load hive-site.xml from path first. If the user does not provide the path, then load it from the classpath. Do you think any problems?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706518437/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706520646","html_url":"https://github.com/apache/iceberg/pull/1477#issuecomment-706520646","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1477","id":706520646,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjUyMDY0Ng==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-10T09:38:49Z","updated_at":"2020-10-10T09:38:49Z","author_association":"MEMBER","body":"Passed all the flink unit tests under my host, let us see the travis testing results,  I will provide unit tests for this change at the same time.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706520646/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706521332","html_url":"https://github.com/apache/iceberg/pull/1558#issuecomment-706521332","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1558","id":706521332,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjUyMTMzMg==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-10T09:43:54Z","updated_at":"2020-10-10T09:43:54Z","author_association":"MEMBER","body":"I think this patch should be included in the next release 0.10.0, so I marked it in the milestone. I will take a look .","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706521332/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706550851","html_url":"https://github.com/apache/iceberg/issues/1578#issuecomment-706550851","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1578","id":706550851,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjU1MDg1MQ==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-10T13:39:27Z","updated_at":"2020-10-11T02:12:04Z","author_association":"MEMBER","body":"Let's take an example to show why would this break the encode/decode unit tests.  For example, we have the schema: \r\n```java\r\n  Schema schema = new Schema(\r\n        required(0, \"id\", Types.LongType.get()),\r\n        optional(1, \"data\", Types.MapType.ofOptional(2, 3,\r\n            Types.LongType.get(),\r\n            Types.StringType.get())));\r\n```\r\n\r\nAnd we have an original record :\r\n\r\n```\r\nrecord0 =  { id=1,  data = {Map{a=b, c=d, e=f}} }\r\n```\r\n\r\nFirstly we encode the record0 by using the converted avro schema , then decode the record0 (using avro schema), we will get the unexpected record: \r\n\r\n```\r\nrecord1 = { id=1, data = {List{Record{a=b},  Record{c=d}, Record{e=f}}}}\r\n```\r\n\r\nThe assertion fail because `record0 != record1` . \r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706550851/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706584864","html_url":"https://github.com/apache/iceberg/pull/1573#issuecomment-706584864","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1573","id":706584864,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjU4NDg2NA==","user":{"login":"danielcweeks","id":4925077,"node_id":"MDQ6VXNlcjQ5MjUwNzc=","avatar_url":"https://avatars.githubusercontent.com/u/4925077?v=4","gravatar_id":"","url":"https://api.github.com/users/danielcweeks","html_url":"https://github.com/danielcweeks","followers_url":"https://api.github.com/users/danielcweeks/followers","following_url":"https://api.github.com/users/danielcweeks/following{/other_user}","gists_url":"https://api.github.com/users/danielcweeks/gists{/gist_id}","starred_url":"https://api.github.com/users/danielcweeks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielcweeks/subscriptions","organizations_url":"https://api.github.com/users/danielcweeks/orgs","repos_url":"https://api.github.com/users/danielcweeks/repos","events_url":"https://api.github.com/users/danielcweeks/events{/privacy}","received_events_url":"https://api.github.com/users/danielcweeks/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-10T17:33:24Z","updated_at":"2020-10-10T17:33:24Z","author_association":"CONTRIBUTOR","body":"@kbendick For the multipart upload/transfer manager, I do think we should toward something like that, but I'm trying to keep this initial implementation somewhat simple so it doesn't become a huge commit.\r\n\r\nWe actually used to use the transfer manager, but the last time I looked, it required writing out the full file and then initiate the upload.  What we ended up doing was building a progressive upload so that it would split up the stream and upload in parts as the stream was being written to.  \r\n\r\nI think some of these optimization should be done as follow up.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706584864/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706608984","html_url":"https://github.com/apache/iceberg/issues/1567#issuecomment-706608984","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1567","id":706608984,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjYwODk4NA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-10T20:44:22Z","updated_at":"2020-10-10T20:44:22Z","author_association":"CONTRIBUTOR","body":"@simonsssu, if we want additional Guava classes, then we add them to [`GuavaClasses`](https://github.com/apache/iceberg/blob/425b10cea34eef11cca9cf0d237e02274f6dc958/bundled-guava/src/main/java/org/apache/iceberg/GuavaClasses.java) so that they aren't removed when the Jar is minimized.\r\n\r\nAlso, we are trying to avoid depending more on Guava because it causes so many runtime issues.\r\n\r\nI think that the current build is a reasonable way to go, but maybe I've misunderstood your concern?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706608984/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706609990","html_url":"https://github.com/apache/iceberg/pull/1571#issuecomment-706609990","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1571","id":706609990,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjYwOTk5MA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-10T20:52:16Z","updated_at":"2020-10-10T20:52:16Z","author_association":"CONTRIBUTOR","body":"Thanks for contributing the fix, @jbirtman!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706609990/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706611443","html_url":"https://github.com/apache/iceberg/pull/1565#issuecomment-706611443","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1565","id":706611443,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjYxMTQ0Mw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-10T21:05:43Z","updated_at":"2020-10-10T21:05:43Z","author_association":"CONTRIBUTOR","body":"@JingsongLi, thanks for working on this! The implementation looks great, but I think it would be good to have a bit more thorough  validation in the tests.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706611443/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706611790","html_url":"https://github.com/apache/iceberg/pull/1564#issuecomment-706611790","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1564","id":706611790,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjYxMTc5MA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-10T21:08:58Z","updated_at":"2020-10-10T21:08:58Z","author_association":"CONTRIBUTOR","body":"I think existing tests should be sufficient to cover this case, since they will definitely load the serde on mappers. Thanks for fixing this, @HotSushi, good catch!\r\n\r\nFYI @massdosage, @pvary, and @guilload.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706611790/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706612264","html_url":"https://github.com/apache/iceberg/pull/1563#issuecomment-706612264","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1563","id":706612264,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjYxMjI2NA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-10T21:13:39Z","updated_at":"2020-10-10T21:13:39Z","author_association":"CONTRIBUTOR","body":"Thanks @mickjermsurawong-stripe! I've merged this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706612264/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706613051","html_url":"https://github.com/apache/iceberg/pull/1558#issuecomment-706613051","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1558","id":706613051,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjYxMzA1MQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-10T21:19:49Z","updated_at":"2020-10-10T21:19:49Z","author_association":"CONTRIBUTOR","body":"> From hiveConfDir, it should be URI which contains scheme and full path. This means it can be loaded by Hadoop Filesystem.\r\n\r\nCan you help me understand Flink's behavior a bit more?\r\n\r\n* If `hiveConfDir` is a Flink option, then why doesn't Flink automatically load the `hive-site.xml` file when it creates a `Configuration`? It doesn't seem like this should be delegated to libraries that run inside Flink. I would expect Flink to create the `Configuration` based on application options and pass that to libraries.\r\n* If Flink allows the user to set a separate `hiveConfDir`, why is that not just add that directory to the classpath so that `hive-site.xml` can be loaded like normal? That's what happens in most Hadoop setup scripts: extra config folders are added to the classpath so that the regular method of loading config files works.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706613051/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706619327","html_url":"https://github.com/apache/iceberg/pull/1570#issuecomment-706619327","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1570","id":706619327,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjYxOTMyNw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-10T22:20:55Z","updated_at":"2020-10-10T22:20:55Z","author_association":"CONTRIBUTOR","body":"@marton-bod, is there a reason not to add similar test cases for Avro?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706619327/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706620197","html_url":"https://github.com/apache/iceberg/issues/1578#issuecomment-706620197","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1578","id":706620197,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjYyMDE5Nw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-10T22:30:18Z","updated_at":"2020-10-10T22:30:18Z","author_association":"CONTRIBUTOR","body":"Maps with non-string keys are not allowed in Avro, but they are valid in Iceberg. That means we need to serialize `m: map<long, string>` differently. The approach we take is to store a map as a list of key/value pairs, just like you would get by calling `entrySet`. The list is needed because the map can have any number of key/value pairs. Omitting it would be equivalent to `m: struct<key: long, value: string>`.\r\n\r\nThe Iceberg readers are built to handle this and reconstruct the map correctly on read. And we use a logical type annotation, `\"logicalType\": \"map\"`, to indicate to regular Avro readers that the `list<struct<long, string>>` that is decoded should be converted to `map<long, string>`.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706620197/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706620901","html_url":"https://github.com/apache/iceberg/pull/1573#issuecomment-706620901","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1573","id":706620901,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjYyMDkwMQ==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-10T22:37:49Z","updated_at":"2020-10-11T06:14:58Z","author_association":"CONTRIBUTOR","body":"> @kbendick For the multipart upload/transfer manager, I do think we should toward something like that, but I'm trying to keep this initial implementation somewhat simple so it doesn't become a huge commit.\r\n> \r\n> We actually used to use the transfer manager, but the last time I looked, it required writing out the full file and then initiate the upload. What we ended up doing was building a progressive upload so that it would split up the stream and upload in parts as the stream was being written to.\r\n> \r\n> I think some of these optimization should be done as follow up.\r\n\r\nI'm on board with doing these optimizations as follow ups 👍 .\r\n\r\nAnd admittedly I've only used the transfer manager for downloads. You're right, it appears it still requires you to write the full file out. My experience in the realm of having a transfer manager like resource for concurrent multipart uploads from streams is limited to python.\r\n\r\nI'm definitely good with keeping things simple to start.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706620901/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706621293","html_url":"https://github.com/apache/iceberg/pull/1577#issuecomment-706621293","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1577","id":706621293,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjYyMTI5Mw==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-10T22:42:17Z","updated_at":"2020-10-10T22:42:17Z","author_association":"CONTRIBUTOR","body":"cc @rdblue for this simple change to the autolabeler and also your thoughts on this change as well https://github.com/apache/iceberg/pull/1576","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706621293/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706627297","html_url":"https://github.com/apache/iceberg/pull/1577#issuecomment-706627297","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1577","id":706627297,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjYyNzI5Nw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-10T23:54:20Z","updated_at":"2020-10-10T23:54:20Z","author_association":"CONTRIBUTOR","body":"Thanks, @kbendick!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706627297/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706637944","html_url":"https://github.com/apache/iceberg/issues/1544#issuecomment-706637944","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1544","id":706637944,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjYzNzk0NA==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-11T02:02:00Z","updated_at":"2020-10-11T02:02:00Z","author_association":"CONTRIBUTOR","body":"I am opening a PR for a few of these that I found. Most likely there are more of these, but figured I'd grab some where possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706637944/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706638771","html_url":"https://github.com/apache/iceberg/issues/1578#issuecomment-706638771","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1578","id":706638771,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjYzODc3MQ==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-11T02:14:51Z","updated_at":"2020-10-11T03:56:14Z","author_association":"MEMBER","body":"OK, got it, thanks for the explanation.  Let me think how to make this unit test work.\r\n\r\n== Update ==\r\n\r\nOK, I found that root cause that why the decoder read the record1 as `{ id=1, data = {List{Record{a=b},  Record{c=d}, Record{e=f}}}}`,  because I missed to register the `map` to `LogicalTypes`,  adding the following sentence works for me now.\r\n\r\n```java\r\n  static {\r\n    LogicalTypes.register(LogicalMap.NAME, schema -> LogicalMap.get());\r\n  }\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706638771/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706639028","html_url":"https://github.com/apache/iceberg/issues/1556#issuecomment-706639028","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1556","id":706639028,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjYzOTAyOA==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-11T02:18:26Z","updated_at":"2020-10-11T02:18:26Z","author_association":"CONTRIBUTOR","body":"Thanks for bringing up this issue @elkhand! When you were running the Flink pipeline that was writing to these tables, was it the only writer? Additionally, were there any restarts of the job (due to task manager fail over, etc)?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706639028/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706640723","html_url":"https://github.com/apache/iceberg/issues/1488#issuecomment-706640723","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1488","id":706640723,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjY0MDcyMw==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-11T02:40:06Z","updated_at":"2020-10-11T02:40:06Z","author_association":"CONTRIBUTOR","body":"I have found some flakey tests under some of the hive tests. I opened a PR for one that fails on my local (but doesn't fail on CI).\r\n\r\nI also have this one that fails occasionally on my local\r\n\r\n```\r\norg.apache.iceberg.mr.hive.TestHiveIcebergStorageHandlerWithHiveCatalog > testScanTableORC FAILED\r\n    java.lang.IllegalArgumentException: Failed to executeQuery Hive query SHOW TABLES: Error while compiling statement: FAILED: SemanticException org.apache.thrift.transport.TTransportException: java.net.SocketException: Broken pipe (Write failed)\r\n\r\n        Caused by:\r\n        org.apache.hive.service.cli.HiveSQLException: Error while compiling statement: FAILED: SemanticException org.apache.thrift.transport.TTransportException: java.net.SocketException: Broken pipe (Write failed)\r\n\r\n            Caused by:\r\n            org.apache.hadoop.hive.ql.parse.SemanticException: org.apache.thrift.transport.TTransportException: java.net.SocketException: Broken pipe (Write failed)\r\n\r\n                Caused by:\r\n                org.apache.hadoop.hive.ql.metadata.HiveException: org.apache.thrift.transport.TTransportException: java.net.SocketException: Broken pipe (Write failed)\r\n\r\n                    Caused by:\r\n                    org.apache.thrift.transport.TTransportException: java.net.SocketException: Broken pipe (Write failed)\r\n\r\n                        Caused by:\r\n                        java.net.SocketException: Broken pipe (Write failed)\r\n\r\n    org.apache.hadoop.hive.ql.metadata.HiveException: org.apache.thrift.transport.TTransportException: java.net.SocketException: Broken pipe (Write failed)\r\n\r\n        Caused by:\r\n        org.apache.thrift.transport.TTransportException: java.net.SocketException: Broken pipe (Write failed)\r\n\r\n            Caused by:\r\n            java.net.SocketException: Broken pipe (Write failed)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706640723/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706640762","html_url":"https://github.com/apache/iceberg/issues/1488#issuecomment-706640762","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1488","id":706640762,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjY0MDc2Mg==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-11T02:40:33Z","updated_at":"2020-10-11T02:40:33Z","author_association":"CONTRIBUTOR","body":"Here's the PR for the flakey test that fails on my local: https://github.com/apache/iceberg/pull/1579","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706640762/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706640907","html_url":"https://github.com/apache/iceberg/issues/1544#issuecomment-706640907","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1544","id":706640907,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjY0MDkwNw==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-11T02:42:59Z","updated_at":"2020-10-11T02:42:59Z","author_association":"CONTRIBUTOR","body":"Ok. I grepped through the code base for `table.toString`, `Table.toString`, `table().to`, `Table().toString`, etc. and replaced the ones that I could find in the above PR. Not sure if it's exhaustive by any means but it's a start.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706640907/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706640948","html_url":"https://github.com/apache/iceberg/pull/1580#issuecomment-706640948","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1580","id":706640948,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjY0MDk0OA==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-11T02:43:21Z","updated_at":"2020-10-11T02:43:21Z","author_association":"CONTRIBUTOR","body":"cc @aokolnychyi, who opened the issue for this originally.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706640948/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706642076","html_url":"https://github.com/apache/iceberg/issues/1451#issuecomment-706642076","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1451","id":706642076,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjY0MjA3Ng==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-11T02:59:41Z","updated_at":"2020-10-11T02:59:41Z","author_association":"CONTRIBUTOR","body":"Closing this issue as this has been fixed.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706642076/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706645811","html_url":"https://github.com/apache/iceberg/issues/1578#issuecomment-706645811","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1578","id":706645811,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjY0NTgxMQ==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-11T03:53:42Z","updated_at":"2020-10-11T03:53:42Z","author_association":"MEMBER","body":"Storing a map as a list of key/value pairs will introduce another problem:  its avro schema type is `array` while its real data type in `GenericData.Record` is `Map`, so we could not compare those records by using the default `GenericData.Record` comparator because it will use the `array` type from avro schema to parse the Map object. \r\n\r\nThat seems to be OK, we can fallback to compare the `toString`. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706645811/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706647804","html_url":"https://github.com/apache/iceberg/pull/1572#issuecomment-706647804","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1572","id":706647804,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjY0NzgwNA==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-11T04:22:24Z","updated_at":"2020-10-11T04:22:24Z","author_association":"CONTRIBUTOR","body":"This is an important task so thank you for taking it on @holdenk ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706647804/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706654114","html_url":"https://github.com/apache/iceberg/pull/1581#issuecomment-706654114","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1581","id":706654114,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjY1NDExNA==","user":{"login":"shardulm94","id":6961317,"node_id":"MDQ6VXNlcjY5NjEzMTc=","avatar_url":"https://avatars.githubusercontent.com/u/6961317?v=4","gravatar_id":"","url":"https://api.github.com/users/shardulm94","html_url":"https://github.com/shardulm94","followers_url":"https://api.github.com/users/shardulm94/followers","following_url":"https://api.github.com/users/shardulm94/following{/other_user}","gists_url":"https://api.github.com/users/shardulm94/gists{/gist_id}","starred_url":"https://api.github.com/users/shardulm94/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shardulm94/subscriptions","organizations_url":"https://api.github.com/users/shardulm94/orgs","repos_url":"https://api.github.com/users/shardulm94/repos","events_url":"https://api.github.com/users/shardulm94/events{/privacy}","received_events_url":"https://api.github.com/users/shardulm94/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-11T05:46:56Z","updated_at":"2020-10-11T05:46:56Z","author_association":"CONTRIBUTOR","body":"Thanks @kbendick!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706654114/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]