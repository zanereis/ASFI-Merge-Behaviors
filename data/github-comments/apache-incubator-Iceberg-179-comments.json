[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1156821835","html_url":"https://github.com/apache/iceberg/pull/5041#issuecomment-1156821835","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5041","id":1156821835,"node_id":"IC_kwDOCW7NX85E87NL","user":{"login":"xingfanx","id":105892373,"node_id":"U_kgDOBk_KFQ","avatar_url":"https://avatars.githubusercontent.com/u/105892373?v=4","gravatar_id":"","url":"https://api.github.com/users/xingfanx","html_url":"https://github.com/xingfanx","followers_url":"https://api.github.com/users/xingfanx/followers","following_url":"https://api.github.com/users/xingfanx/following{/other_user}","gists_url":"https://api.github.com/users/xingfanx/gists{/gist_id}","starred_url":"https://api.github.com/users/xingfanx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xingfanx/subscriptions","organizations_url":"https://api.github.com/users/xingfanx/orgs","repos_url":"https://api.github.com/users/xingfanx/repos","events_url":"https://api.github.com/users/xingfanx/events{/privacy}","received_events_url":"https://api.github.com/users/xingfanx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-15T19:01:22Z","updated_at":"2022-06-15T19:01:22Z","author_association":"CONTRIBUTOR","body":"@amogh-jahagirdar updated","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1156821835/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1156945817","html_url":"https://github.com/apache/iceberg/pull/5049#issuecomment-1156945817","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5049","id":1156945817,"node_id":"IC_kwDOCW7NX85E9ZeZ","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-15T21:09:09Z","updated_at":"2022-06-15T21:09:09Z","author_association":"CONTRIBUTOR","body":"I recall now when working on the `NOT_STARTS_WITH` that we wanted to leave it up to the engine to handle 3 value boolean logic.\r\n\r\nThe example query, `DELETE FROM table WHERE id NOT IN (1, null)`, should probably be written as `DELETE FROM table WHERE id is not null and id != 1`. Spark will add the not null-check itself often times.\r\n\r\nWith 3-valued boolean logic, for comparison purposes every null is a different null and nothing equals null. For those who might want a refresher (like I often need), I like this website's explanation of 3-valued boolean logic involving nulls: https://modern-sql.com/concept/three-valued-logic\r\n\r\nTo avoid the headache that can incur, we explicitly avoid 3-valued boolean logic. There would be better filter pushdown and more advantage taken of Iceberg's statistics by writing the query with explicit `AND is [not] null` checking too.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1156945817/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1157002214","html_url":"https://github.com/apache/iceberg/issues/4618#issuecomment-1157002214","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4618","id":1157002214,"node_id":"IC_kwDOCW7NX85E9nPm","user":{"login":"xrl1","id":5931042,"node_id":"MDQ6VXNlcjU5MzEwNDI=","avatar_url":"https://avatars.githubusercontent.com/u/5931042?v=4","gravatar_id":"","url":"https://api.github.com/users/xrl1","html_url":"https://github.com/xrl1","followers_url":"https://api.github.com/users/xrl1/followers","following_url":"https://api.github.com/users/xrl1/following{/other_user}","gists_url":"https://api.github.com/users/xrl1/gists{/gist_id}","starred_url":"https://api.github.com/users/xrl1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xrl1/subscriptions","organizations_url":"https://api.github.com/users/xrl1/orgs","repos_url":"https://api.github.com/users/xrl1/repos","events_url":"https://api.github.com/users/xrl1/events{/privacy}","received_events_url":"https://api.github.com/users/xrl1/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-15T22:10:33Z","updated_at":"2022-06-15T22:11:35Z","author_association":"CONTRIBUTOR","body":"Hey, I saw that @selectbook was unassigned, and there was no other activity\r\nI wanted to contribute a first, so I tried to fix it: #5057 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1157002214/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1157009183","html_url":"https://github.com/apache/iceberg/pull/4920#issuecomment-1157009183","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4920","id":1157009183,"node_id":"IC_kwDOCW7NX85E9o8f","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-15T22:22:01Z","updated_at":"2022-06-15T22:22:01Z","author_association":"CONTRIBUTOR","body":"@rdblue I've fixed the linting violation introduced by https://github.com/apache/iceberg/pull/5055","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1157009183/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1157076124","html_url":"https://github.com/apache/iceberg/pull/5050#issuecomment-1157076124","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5050","id":1157076124,"node_id":"IC_kwDOCW7NX85E95Sc","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-15T23:37:53Z","updated_at":"2022-06-15T23:37:53Z","author_association":"COLLABORATOR","body":"+1 to honor job level option. Shall we use the table property or Flink-specific option definition as in #4670? cc @stevenzwu  as well. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1157076124/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1157187178","html_url":"https://github.com/apache/iceberg/issues/5054#issuecomment-1157187178","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5054","id":1157187178,"node_id":"IC_kwDOCW7NX85E-UZq","user":{"login":"wuwenchi","id":19755729,"node_id":"MDQ6VXNlcjE5NzU1NzI5","avatar_url":"https://avatars.githubusercontent.com/u/19755729?v=4","gravatar_id":"","url":"https://api.github.com/users/wuwenchi","html_url":"https://github.com/wuwenchi","followers_url":"https://api.github.com/users/wuwenchi/followers","following_url":"https://api.github.com/users/wuwenchi/following{/other_user}","gists_url":"https://api.github.com/users/wuwenchi/gists{/gist_id}","starred_url":"https://api.github.com/users/wuwenchi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wuwenchi/subscriptions","organizations_url":"https://api.github.com/users/wuwenchi/orgs","repos_url":"https://api.github.com/users/wuwenchi/repos","events_url":"https://api.github.com/users/wuwenchi/events{/privacy}","received_events_url":"https://api.github.com/users/wuwenchi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-16T03:20:51Z","updated_at":"2022-06-16T03:20:51Z","author_association":"CONTRIBUTOR","body":"1.  `bigint` in flink will be converted to `long` in iceberg. For other flink type conversions, you can look #4865.\r\n2. `bigint` in spark is same as `long` in spark, `long` in spark will be converted to `long` in iceberg. For other spark type conversions, you can look https://iceberg.apache.org/docs/latest/spark-writes/#spark-type-to-iceberg-type.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1157187178/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1157208136","html_url":"https://github.com/apache/iceberg/pull/5052#issuecomment-1157208136","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5052","id":1157208136,"node_id":"IC_kwDOCW7NX85E-ZhI","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-16T04:06:29Z","updated_at":"2022-06-16T04:06:29Z","author_association":"CONTRIBUTOR","body":"cc @danielcweeks @rdblue @Fokko @nastra and @singhpk234 who has helped contribute to some areas of the REST spec.\r\n\r\nKept this one relatively simple given that most of the heavy lifting is done by existing Parsers.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1157208136/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1157254573","html_url":"https://github.com/apache/iceberg/pull/5053#issuecomment-1157254573","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5053","id":1157254573,"node_id":"IC_kwDOCW7NX85E-k2t","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-16T05:40:05Z","updated_at":"2022-06-16T05:40:05Z","author_association":"CONTRIBUTOR","body":"cc @rdblue @danielcweeks ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1157254573/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1157256538","html_url":"https://github.com/apache/iceberg/pull/4993#issuecomment-1157256538","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4993","id":1157256538,"node_id":"IC_kwDOCW7NX85E-lVa","user":{"login":"wang-x-xia","id":83057695,"node_id":"MDQ6VXNlcjgzMDU3Njk1","avatar_url":"https://avatars.githubusercontent.com/u/83057695?v=4","gravatar_id":"","url":"https://api.github.com/users/wang-x-xia","html_url":"https://github.com/wang-x-xia","followers_url":"https://api.github.com/users/wang-x-xia/followers","following_url":"https://api.github.com/users/wang-x-xia/following{/other_user}","gists_url":"https://api.github.com/users/wang-x-xia/gists{/gist_id}","starred_url":"https://api.github.com/users/wang-x-xia/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wang-x-xia/subscriptions","organizations_url":"https://api.github.com/users/wang-x-xia/orgs","repos_url":"https://api.github.com/users/wang-x-xia/repos","events_url":"https://api.github.com/users/wang-x-xia/events{/privacy}","received_events_url":"https://api.github.com/users/wang-x-xia/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-16T05:43:50Z","updated_at":"2022-06-16T05:43:50Z","author_association":"CONTRIBUTOR","body":"@rdblue\r\nThe changes are reverted,\r\nI've created a new PR for bugfix:\r\nhttps://github.com/apache/iceberg/pull/5059\r\nAnd a new PR for runtime JAR:\r\nhttps://github.com/apache/iceberg/pull/5060","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1157256538/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1157298271","html_url":"https://github.com/apache/iceberg/pull/5035#issuecomment-1157298271","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5035","id":1157298271,"node_id":"IC_kwDOCW7NX85E-vhf","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-16T06:49:42Z","updated_at":"2022-06-16T06:49:42Z","author_association":"CONTRIBUTOR","body":"Great work. 👍 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1157298271/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1157357624","html_url":"https://github.com/apache/iceberg/issues/4977#issuecomment-1157357624","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4977","id":1157357624,"node_id":"IC_kwDOCW7NX85E--A4","user":{"login":"felixYyu","id":3785228,"node_id":"MDQ6VXNlcjM3ODUyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3785228?v=4","gravatar_id":"","url":"https://api.github.com/users/felixYyu","html_url":"https://github.com/felixYyu","followers_url":"https://api.github.com/users/felixYyu/followers","following_url":"https://api.github.com/users/felixYyu/following{/other_user}","gists_url":"https://api.github.com/users/felixYyu/gists{/gist_id}","starred_url":"https://api.github.com/users/felixYyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixYyu/subscriptions","organizations_url":"https://api.github.com/users/felixYyu/orgs","repos_url":"https://api.github.com/users/felixYyu/repos","events_url":"https://api.github.com/users/felixYyu/events{/privacy}","received_events_url":"https://api.github.com/users/felixYyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-16T08:02:07Z","updated_at":"2022-06-16T08:02:07Z","author_association":"CONTRIBUTOR","body":"If `read.streaming.enabled` config via TimeTravel in real-time pipeline, I think more demand for real-time analysis scenarios.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1157357624/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1157390783","html_url":"https://github.com/apache/iceberg/issues/5054#issuecomment-1157390783","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5054","id":1157390783,"node_id":"IC_kwDOCW7NX85E_GG_","user":{"login":"romibuzi","id":2420675,"node_id":"MDQ6VXNlcjI0MjA2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/2420675?v=4","gravatar_id":"","url":"https://api.github.com/users/romibuzi","html_url":"https://github.com/romibuzi","followers_url":"https://api.github.com/users/romibuzi/followers","following_url":"https://api.github.com/users/romibuzi/following{/other_user}","gists_url":"https://api.github.com/users/romibuzi/gists{/gist_id}","starred_url":"https://api.github.com/users/romibuzi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/romibuzi/subscriptions","organizations_url":"https://api.github.com/users/romibuzi/orgs","repos_url":"https://api.github.com/users/romibuzi/repos","events_url":"https://api.github.com/users/romibuzi/events{/privacy}","received_events_url":"https://api.github.com/users/romibuzi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-16T08:37:40Z","updated_at":"2022-06-16T08:37:40Z","author_association":"NONE","body":"Thank you @wuwenchi ! does that means that technically there is no `bigint` type in Iceberg ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1157390783/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1157393827","html_url":"https://github.com/apache/iceberg/pull/5036#issuecomment-1157393827","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5036","id":1157393827,"node_id":"IC_kwDOCW7NX85E_G2j","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-16T08:40:49Z","updated_at":"2022-06-16T08:40:49Z","author_association":"CONTRIBUTOR","body":"> > After fixing this issue, you still see long alter table HMS calls? I am trying to understand the situation better, and possible other places where we have to fix too\r\n> \r\n> Yea, though likely it won't be as frequent anymore. I think the point I am trying to make is that we can not guarantee that Iceberg commit would be able finish within hive.txn.timeout. You and I both listed a few reasons on why that can happen. I think heartbeats on locks is a must have, or we should fail the commit/ rollback the commit if unlock fails with lock not found. I prefer the former as it would really be a waste of compute to simply fail or rollback.\r\n\r\nYou have convinced me here, I just trying to collect the things that we have to fix in Hive to make this work as fast as possible 😄 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1157393827/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1157401841","html_url":"https://github.com/apache/iceberg/issues/4883#issuecomment-1157401841","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4883","id":1157401841,"node_id":"IC_kwDOCW7NX85E_Izx","user":{"login":"user-GitHub-user","id":18843801,"node_id":"MDQ6VXNlcjE4ODQzODAx","avatar_url":"https://avatars.githubusercontent.com/u/18843801?v=4","gravatar_id":"","url":"https://api.github.com/users/user-GitHub-user","html_url":"https://github.com/user-GitHub-user","followers_url":"https://api.github.com/users/user-GitHub-user/followers","following_url":"https://api.github.com/users/user-GitHub-user/following{/other_user}","gists_url":"https://api.github.com/users/user-GitHub-user/gists{/gist_id}","starred_url":"https://api.github.com/users/user-GitHub-user/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/user-GitHub-user/subscriptions","organizations_url":"https://api.github.com/users/user-GitHub-user/orgs","repos_url":"https://api.github.com/users/user-GitHub-user/repos","events_url":"https://api.github.com/users/user-GitHub-user/events{/privacy}","received_events_url":"https://api.github.com/users/user-GitHub-user/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-16T08:48:48Z","updated_at":"2022-06-16T08:48:48Z","author_association":"NONE","body":"> You should set the `iceberg.engine.hive.enabled` to `true` in Hive too\r\n\r\nthanks","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1157401841/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1157454433","html_url":"https://github.com/apache/iceberg/issues/5054#issuecomment-1157454433","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5054","id":1157454433,"node_id":"IC_kwDOCW7NX85E_Vph","user":{"login":"wuwenchi","id":19755729,"node_id":"MDQ6VXNlcjE5NzU1NzI5","avatar_url":"https://avatars.githubusercontent.com/u/19755729?v=4","gravatar_id":"","url":"https://api.github.com/users/wuwenchi","html_url":"https://github.com/wuwenchi","followers_url":"https://api.github.com/users/wuwenchi/followers","following_url":"https://api.github.com/users/wuwenchi/following{/other_user}","gists_url":"https://api.github.com/users/wuwenchi/gists{/gist_id}","starred_url":"https://api.github.com/users/wuwenchi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wuwenchi/subscriptions","organizations_url":"https://api.github.com/users/wuwenchi/orgs","repos_url":"https://api.github.com/users/wuwenchi/repos","events_url":"https://api.github.com/users/wuwenchi/events{/privacy}","received_events_url":"https://api.github.com/users/wuwenchi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-16T09:43:12Z","updated_at":"2022-06-16T09:43:12Z","author_association":"CONTRIBUTOR","body":"Yes, I personally think so.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1157454433/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1157515292","html_url":"https://github.com/apache/iceberg/pull/5056#issuecomment-1157515292","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5056","id":1157515292,"node_id":"IC_kwDOCW7NX85E_kgc","user":{"login":"pan3793","id":26535726,"node_id":"MDQ6VXNlcjI2NTM1NzI2","avatar_url":"https://avatars.githubusercontent.com/u/26535726?v=4","gravatar_id":"","url":"https://api.github.com/users/pan3793","html_url":"https://github.com/pan3793","followers_url":"https://api.github.com/users/pan3793/followers","following_url":"https://api.github.com/users/pan3793/following{/other_user}","gists_url":"https://api.github.com/users/pan3793/gists{/gist_id}","starred_url":"https://api.github.com/users/pan3793/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pan3793/subscriptions","organizations_url":"https://api.github.com/users/pan3793/orgs","repos_url":"https://api.github.com/users/pan3793/repos","events_url":"https://api.github.com/users/pan3793/events{/privacy}","received_events_url":"https://api.github.com/users/pan3793/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-16T10:46:34Z","updated_at":"2022-06-16T10:46:34Z","author_association":"MEMBER","body":"\"copy 3.2 files from 3.3\" should be in another PR, otherwise after squash, the git will not keep commit history.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1157515292/reactions","total_count":3,"+1":3,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1157526614","html_url":"https://github.com/apache/iceberg/pull/5061#issuecomment-1157526614","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5061","id":1157526614,"node_id":"IC_kwDOCW7NX85E_nRW","user":{"login":"wuwenchi","id":19755729,"node_id":"MDQ6VXNlcjE5NzU1NzI5","avatar_url":"https://avatars.githubusercontent.com/u/19755729?v=4","gravatar_id":"","url":"https://api.github.com/users/wuwenchi","html_url":"https://github.com/wuwenchi","followers_url":"https://api.github.com/users/wuwenchi/followers","following_url":"https://api.github.com/users/wuwenchi/following{/other_user}","gists_url":"https://api.github.com/users/wuwenchi/gists{/gist_id}","starred_url":"https://api.github.com/users/wuwenchi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wuwenchi/subscriptions","organizations_url":"https://api.github.com/users/wuwenchi/orgs","repos_url":"https://api.github.com/users/wuwenchi/repos","events_url":"https://api.github.com/users/wuwenchi/events{/privacy}","received_events_url":"https://api.github.com/users/wuwenchi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-16T10:59:54Z","updated_at":"2022-06-16T10:59:54Z","author_association":"CONTRIBUTOR","body":"\r\nin your Expected Results:\r\n```\r\nid                      data\r\n 1                  20220607\r\n 3                  20220505\r\n 6                  20220505\r\n 2                  20220504    -------> should 20220503 ?\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1157526614/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1157551908","html_url":"https://github.com/apache/iceberg/pull/5049#issuecomment-1157551908","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5049","id":1157551908,"node_id":"IC_kwDOCW7NX85E_tck","user":{"login":"ConeyLiu","id":12733256,"node_id":"MDQ6VXNlcjEyNzMzMjU2","avatar_url":"https://avatars.githubusercontent.com/u/12733256?v=4","gravatar_id":"","url":"https://api.github.com/users/ConeyLiu","html_url":"https://github.com/ConeyLiu","followers_url":"https://api.github.com/users/ConeyLiu/followers","following_url":"https://api.github.com/users/ConeyLiu/following{/other_user}","gists_url":"https://api.github.com/users/ConeyLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/ConeyLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ConeyLiu/subscriptions","organizations_url":"https://api.github.com/users/ConeyLiu/orgs","repos_url":"https://api.github.com/users/ConeyLiu/repos","events_url":"https://api.github.com/users/ConeyLiu/events{/privacy}","received_events_url":"https://api.github.com/users/ConeyLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-16T11:29:42Z","updated_at":"2022-06-16T11:31:02Z","author_association":"CONTRIBUTOR","body":"Thanks, @rdblue @kbendick for the detailed explanation. And this doc: https://modern-sql.com/concept/three-valued-logic is really helpful. I submit this PR because the user could do this with Spark 3.1 while failing in Spark 3.2. The current logic should be good enough. Thanks again.\r\n\r\nAnother question. Should we port the https://github.com/apache/iceberg/pull/3613 to other spark versions? Currently, the other Spark versions have different behavior compared with Spark 3.2.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1157551908/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1157572984","html_url":"https://github.com/apache/iceberg/issues/5054#issuecomment-1157572984","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5054","id":1157572984,"node_id":"IC_kwDOCW7NX85E_yl4","user":{"login":"romibuzi","id":2420675,"node_id":"MDQ6VXNlcjI0MjA2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/2420675?v=4","gravatar_id":"","url":"https://api.github.com/users/romibuzi","html_url":"https://github.com/romibuzi","followers_url":"https://api.github.com/users/romibuzi/followers","following_url":"https://api.github.com/users/romibuzi/following{/other_user}","gists_url":"https://api.github.com/users/romibuzi/gists{/gist_id}","starred_url":"https://api.github.com/users/romibuzi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/romibuzi/subscriptions","organizations_url":"https://api.github.com/users/romibuzi/orgs","repos_url":"https://api.github.com/users/romibuzi/repos","events_url":"https://api.github.com/users/romibuzi/events{/privacy}","received_events_url":"https://api.github.com/users/romibuzi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-16T11:54:37Z","updated_at":"2022-06-16T11:54:37Z","author_association":"NONE","body":"Indeed in the end there is just long type in Iceberg: https://github.com/apache/iceberg/blob/44c1d00b37f0d7fc2e978baad4f7a861a8335cf0/api/src/main/java/org/apache/iceberg/types/Types.java#L46. Thanks @wuwenchi i am closing this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1157572984/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1157591503","html_url":"https://github.com/apache/iceberg/pull/5062#issuecomment-1157591503","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5062","id":1157591503,"node_id":"IC_kwDOCW7NX85E_3HP","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-16T12:14:33Z","updated_at":"2022-06-16T12:14:33Z","author_association":"CONTRIBUTOR","body":"Thanks @chakradhar2 for the fix and @ajantha-bhat for the review!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1157591503/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1157600488","html_url":"https://github.com/apache/iceberg/pull/5056#issuecomment-1157600488","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5056","id":1157600488,"node_id":"IC_kwDOCW7NX85E_5To","user":{"login":"singhpk234","id":35593236,"node_id":"MDQ6VXNlcjM1NTkzMjM2","avatar_url":"https://avatars.githubusercontent.com/u/35593236?v=4","gravatar_id":"","url":"https://api.github.com/users/singhpk234","html_url":"https://github.com/singhpk234","followers_url":"https://api.github.com/users/singhpk234/followers","following_url":"https://api.github.com/users/singhpk234/following{/other_user}","gists_url":"https://api.github.com/users/singhpk234/gists{/gist_id}","starred_url":"https://api.github.com/users/singhpk234/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/singhpk234/subscriptions","organizations_url":"https://api.github.com/users/singhpk234/orgs","repos_url":"https://api.github.com/users/singhpk234/repos","events_url":"https://api.github.com/users/singhpk234/events{/privacy}","received_events_url":"https://api.github.com/users/singhpk234/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-16T12:24:45Z","updated_at":"2022-06-16T12:24:45Z","author_association":"CONTRIBUTOR","body":"makes sense, thanks @pan3793, will do it in a separate PR.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1157600488/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1157664787","html_url":"https://github.com/apache/iceberg/pull/5061#issuecomment-1157664787","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5061","id":1157664787,"node_id":"IC_kwDOCW7NX85FAJAT","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-16T13:30:29Z","updated_at":"2022-06-16T13:30:29Z","author_association":"CONTRIBUTOR","body":"> in your Expected Results:\r\n> \r\n> ```\r\n> id                      data\r\n>  1                  20220607\r\n>  3                  20220505\r\n>  6                  20220505\r\n>  2                  20220504    -------> should 20220503 ?\r\n> ```\r\n\r\n ```sql\r\n…………\r\n where t1.data > t2.data or t2.data is null;\r\n ```\r\nt1:\r\n('2','20220503')\r\nt2:\r\n('2','20220504')\r\n20220503  should not be inserted\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1157664787/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1157725451","html_url":"https://github.com/apache/iceberg/pull/5050#issuecomment-1157725451","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5050","id":1157725451,"node_id":"IC_kwDOCW7NX85FAX0L","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-16T14:27:50Z","updated_at":"2022-06-16T14:27:50Z","author_association":"CONTRIBUTOR","body":"I rewrote the PR based on #3998, which can make this clearer. Thanks for @kbendick 's advice.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1157725451/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1157809116","html_url":"https://github.com/apache/iceberg/pull/4707#issuecomment-1157809116","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4707","id":1157809116,"node_id":"IC_kwDOCW7NX85FAsPc","user":{"login":"puchengy","id":8072956,"node_id":"MDQ6VXNlcjgwNzI5NTY=","avatar_url":"https://avatars.githubusercontent.com/u/8072956?v=4","gravatar_id":"","url":"https://api.github.com/users/puchengy","html_url":"https://github.com/puchengy","followers_url":"https://api.github.com/users/puchengy/followers","following_url":"https://api.github.com/users/puchengy/following{/other_user}","gists_url":"https://api.github.com/users/puchengy/gists{/gist_id}","starred_url":"https://api.github.com/users/puchengy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/puchengy/subscriptions","organizations_url":"https://api.github.com/users/puchengy/orgs","repos_url":"https://api.github.com/users/puchengy/repos","events_url":"https://api.github.com/users/puchengy/events{/privacy}","received_events_url":"https://api.github.com/users/puchengy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-16T15:38:23Z","updated_at":"2022-06-16T15:39:31Z","author_association":"CONTRIBUTOR","body":"@singhpk234 Hi I found this issue helpful as I want to use time travel in SQL as well.\r\n\r\nCan you explain this a little bit?\r\n\r\n> Looks like this was intended for internal use and we don't want the users to actually use it. refering : https://github.com/apache/iceberg/pull/3269#issuecomment-961520437\r\n\r\nas I don't see the connection between your comment (\"don't want user to actually use it\") and the referred comments you use.\r\n\r\nDo you mean this workaround is not guaranteed to be supported and might be dropped in the future?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1157809116/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1157841341","html_url":"https://github.com/apache/iceberg/pull/4707#issuecomment-1157841341","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4707","id":1157841341,"node_id":"IC_kwDOCW7NX85FA0G9","user":{"login":"singhpk234","id":35593236,"node_id":"MDQ6VXNlcjM1NTkzMjM2","avatar_url":"https://avatars.githubusercontent.com/u/35593236?v=4","gravatar_id":"","url":"https://api.github.com/users/singhpk234","html_url":"https://github.com/singhpk234","followers_url":"https://api.github.com/users/singhpk234/followers","following_url":"https://api.github.com/users/singhpk234/following{/other_user}","gists_url":"https://api.github.com/users/singhpk234/gists{/gist_id}","starred_url":"https://api.github.com/users/singhpk234/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/singhpk234/subscriptions","organizations_url":"https://api.github.com/users/singhpk234/orgs","repos_url":"https://api.github.com/users/singhpk234/repos","events_url":"https://api.github.com/users/singhpk234/events{/privacy}","received_events_url":"https://api.github.com/users/singhpk234/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-16T15:59:41Z","updated_at":"2022-06-16T16:01:55Z","author_association":"CONTRIBUTOR","body":"@puchengy, Hello, I was referring to this subpart of https://github.com/apache/iceberg/pull/3269#issuecomment-961520437 where @rdblue suggested :\r\n> We don't have to document that we support time travel through table identifiers so that we can remove it later and replace it with the AS OF syntax\r\n\r\nHence I closed this PR considering it not being documented is intentional. \r\n\r\n> Do you mean this workaround is not guaranteed to be supported and might be dropped in the future?\r\n\r\nAs per my understanding of the comment yes, hence not documenting this could avoid users to make dependency on it.\r\n\r\nNow `AS OF` Syntax is present since [3.3](https://issues.apache.org/jira/browse/SPARK-37219), Though I am not sure of the plans of spark community to backport it back to lower spark versions like 3.0, 3.1, 3.2. Also not sure if it will be dropped from iceberg once they are supported in lower version or in 3.3. Maybe the  authors / reviewers of the pr's have deeper insights on this.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1157841341/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1157866674","html_url":"https://github.com/apache/iceberg/issues/4689#issuecomment-1157866674","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4689","id":1157866674,"node_id":"IC_kwDOCW7NX85FA6Sy","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-16T16:18:31Z","updated_at":"2022-06-16T16:18:31Z","author_association":"CONTRIBUTOR","body":"Following up on this\r\n> Also of note is that if a table was previously partitioned, and then the partition field is dropped, and data is then inserted afterwards, the partition summary can have a reference to the partition field for the value null.\r\n\r\nThis is an artifact of the V1 table's using the void transform, which uses `alwaysNull` for its transform, so this one is a little harder to deal with (and I'm not 100% sure it matters too much as it's for V1 tables and anybody using the partition summaries is likely somewhat of a power user). This is at least well defined behavior.\r\n\r\nOtherwise, I have a PR which removes these summaries https://github.com/apache/iceberg/pull/5009.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1157866674/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1157946325","html_url":"https://github.com/apache/iceberg/pull/4707#issuecomment-1157946325","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4707","id":1157946325,"node_id":"IC_kwDOCW7NX85FBNvV","user":{"login":"puchengy","id":8072956,"node_id":"MDQ6VXNlcjgwNzI5NTY=","avatar_url":"https://avatars.githubusercontent.com/u/8072956?v=4","gravatar_id":"","url":"https://api.github.com/users/puchengy","html_url":"https://github.com/puchengy","followers_url":"https://api.github.com/users/puchengy/followers","following_url":"https://api.github.com/users/puchengy/following{/other_user}","gists_url":"https://api.github.com/users/puchengy/gists{/gist_id}","starred_url":"https://api.github.com/users/puchengy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/puchengy/subscriptions","organizations_url":"https://api.github.com/users/puchengy/orgs","repos_url":"https://api.github.com/users/puchengy/repos","events_url":"https://api.github.com/users/puchengy/events{/privacy}","received_events_url":"https://api.github.com/users/puchengy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-16T17:29:41Z","updated_at":"2022-06-16T17:29:49Z","author_association":"CONTRIBUTOR","body":"@singhpk234 got it, thanks for your response.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1157946325/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1158095923","html_url":"https://github.com/apache/iceberg/pull/4942#issuecomment-1158095923","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4942","id":1158095923,"node_id":"IC_kwDOCW7NX85FByQz","user":{"login":"sumeetgajjar","id":7351922,"node_id":"MDQ6VXNlcjczNTE5MjI=","avatar_url":"https://avatars.githubusercontent.com/u/7351922?v=4","gravatar_id":"","url":"https://api.github.com/users/sumeetgajjar","html_url":"https://github.com/sumeetgajjar","followers_url":"https://api.github.com/users/sumeetgajjar/followers","following_url":"https://api.github.com/users/sumeetgajjar/following{/other_user}","gists_url":"https://api.github.com/users/sumeetgajjar/gists{/gist_id}","starred_url":"https://api.github.com/users/sumeetgajjar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sumeetgajjar/subscriptions","organizations_url":"https://api.github.com/users/sumeetgajjar/orgs","repos_url":"https://api.github.com/users/sumeetgajjar/repos","events_url":"https://api.github.com/users/sumeetgajjar/events{/privacy}","received_events_url":"https://api.github.com/users/sumeetgajjar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-16T20:22:46Z","updated_at":"2022-06-16T20:22:46Z","author_association":"CONTRIBUTOR","body":"Hi @pvary @kbendick @rdblue,\r\nGentle ping to review the new changes.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1158095923/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1158237020","html_url":"https://github.com/apache/iceberg/pull/5068#issuecomment-1158237020","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5068","id":1158237020,"node_id":"IC_kwDOCW7NX85FCUtc","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-16T22:49:13Z","updated_at":"2022-06-16T22:49:13Z","author_association":"CONTRIBUTOR","body":"@samredai would you have time to look at this? Since you're the original author 👍🏻 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1158237020/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1158271195","html_url":"https://github.com/apache/iceberg/issues/5038#issuecomment-1158271195","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5038","id":1158271195,"node_id":"IC_kwDOCW7NX85FCdDb","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-16T23:37:09Z","updated_at":"2022-06-16T23:37:09Z","author_association":"CONTRIBUTOR","body":"We should consider what we want to do here. Technically, you could have lower precision if you wanted to store really really small values. For example, a `duration_seconds` column with nanosecond precision and is never greater than 1 millisecond could be stored as `decimal(6, 9)`. This is allowed by the spec currently. We don't state that P >= S.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1158271195/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1158273044","html_url":"https://github.com/apache/iceberg/pull/4982#issuecomment-1158273044","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4982","id":1158273044,"node_id":"IC_kwDOCW7NX85FCdgU","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-16T23:39:04Z","updated_at":"2022-06-16T23:39:04Z","author_association":"CONTRIBUTOR","body":"@Fokko, is this no longer needed? Looks like I was probably just waiting for tests to pass and never made it back to merge it. Just let me know what you'd like to do here.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1158273044/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1158274877","html_url":"https://github.com/apache/iceberg/pull/4871#issuecomment-1158274877","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4871","id":1158274877,"node_id":"IC_kwDOCW7NX85FCd89","user":{"login":"rzhang10","id":75445426,"node_id":"MDQ6VXNlcjc1NDQ1NDI2","avatar_url":"https://avatars.githubusercontent.com/u/75445426?v=4","gravatar_id":"","url":"https://api.github.com/users/rzhang10","html_url":"https://github.com/rzhang10","followers_url":"https://api.github.com/users/rzhang10/followers","following_url":"https://api.github.com/users/rzhang10/following{/other_user}","gists_url":"https://api.github.com/users/rzhang10/gists{/gist_id}","starred_url":"https://api.github.com/users/rzhang10/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rzhang10/subscriptions","organizations_url":"https://api.github.com/users/rzhang10/orgs","repos_url":"https://api.github.com/users/rzhang10/repos","events_url":"https://api.github.com/users/rzhang10/events{/privacy}","received_events_url":"https://api.github.com/users/rzhang10/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-16T23:40:53Z","updated_at":"2022-06-16T23:40:53Z","author_association":"CONTRIBUTOR","body":"Hi Ryan, I've refactored the code according to the comments, can you please take a look again?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1158274877/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1158382103","html_url":"https://github.com/apache/iceberg/pull/3998#issuecomment-1158382103","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3998","id":1158382103,"node_id":"IC_kwDOCW7NX85FC4IX","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-17T01:40:55Z","updated_at":"2022-06-17T01:40:55Z","author_association":"CONTRIBUTOR","body":"cc @rdblue @kbendick, PTAL, thx","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1158382103/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1158460447","html_url":"https://github.com/apache/iceberg/pull/5029#issuecomment-1158460447","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5029","id":1158460447,"node_id":"IC_kwDOCW7NX85FDLQf","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-17T03:46:40Z","updated_at":"2022-06-17T03:46:40Z","author_association":"CONTRIBUTOR","body":"This has a dependency on https://github.com/apache/iceberg/pull/4428/files, I will follow up on that PR. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1158460447/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1158480346","html_url":"https://github.com/apache/iceberg/issues/5064#issuecomment-1158480346","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5064","id":1158480346,"node_id":"IC_kwDOCW7NX85FDQHa","user":{"login":"findinpath","id":57260417,"node_id":"MDQ6VXNlcjU3MjYwNDE3","avatar_url":"https://avatars.githubusercontent.com/u/57260417?v=4","gravatar_id":"","url":"https://api.github.com/users/findinpath","html_url":"https://github.com/findinpath","followers_url":"https://api.github.com/users/findinpath/followers","following_url":"https://api.github.com/users/findinpath/following{/other_user}","gists_url":"https://api.github.com/users/findinpath/gists{/gist_id}","starred_url":"https://api.github.com/users/findinpath/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/findinpath/subscriptions","organizations_url":"https://api.github.com/users/findinpath/orgs","repos_url":"https://api.github.com/users/findinpath/repos","events_url":"https://api.github.com/users/findinpath/events{/privacy}","received_events_url":"https://api.github.com/users/findinpath/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-17T04:32:29Z","updated_at":"2022-06-17T04:32:29Z","author_association":"NONE","body":"Note that the operation is `compare` (returning `-1` /  `0` / `1` and not `equals`). If the provided arguments are not comparable, I think throwing IAE is correct. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1158480346/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1158586854","html_url":"https://github.com/apache/iceberg/issues/5064#issuecomment-1158586854","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5064","id":1158586854,"node_id":"IC_kwDOCW7NX85FDqHm","user":{"login":"homar","id":49628,"node_id":"MDQ6VXNlcjQ5NjI4","avatar_url":"https://avatars.githubusercontent.com/u/49628?v=4","gravatar_id":"","url":"https://api.github.com/users/homar","html_url":"https://github.com/homar","followers_url":"https://api.github.com/users/homar/followers","following_url":"https://api.github.com/users/homar/following{/other_user}","gists_url":"https://api.github.com/users/homar/gists{/gist_id}","starred_url":"https://api.github.com/users/homar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/homar/subscriptions","organizations_url":"https://api.github.com/users/homar/orgs","repos_url":"https://api.github.com/users/homar/repos","events_url":"https://api.github.com/users/homar/events{/privacy}","received_events_url":"https://api.github.com/users/homar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-17T07:38:24Z","updated_at":"2022-06-17T07:38:24Z","author_association":"NONE","body":"> Note that the operation is `compare` (returning `-1` / `0` / `1` and not `equals`). If the provided arguments are not comparable, I think throwing IAE is correct.\r\n\r\nSo maybe it should not be used as a part of equals method or maybe the exception should be caught? The ticket is about equals being broken.  ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1158586854/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1158641432","html_url":"https://github.com/apache/iceberg/pull/5056#issuecomment-1158641432","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5056","id":1158641432,"node_id":"IC_kwDOCW7NX85FD3cY","user":{"login":"singhpk234","id":35593236,"node_id":"MDQ6VXNlcjM1NTkzMjM2","avatar_url":"https://avatars.githubusercontent.com/u/35593236?v=4","gravatar_id":"","url":"https://api.github.com/users/singhpk234","html_url":"https://github.com/singhpk234","followers_url":"https://api.github.com/users/singhpk234/followers","following_url":"https://api.github.com/users/singhpk234/following{/other_user}","gists_url":"https://api.github.com/users/singhpk234/gists{/gist_id}","starred_url":"https://api.github.com/users/singhpk234/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/singhpk234/subscriptions","organizations_url":"https://api.github.com/users/singhpk234/orgs","repos_url":"https://api.github.com/users/singhpk234/repos","events_url":"https://api.github.com/users/singhpk234/events{/privacy}","received_events_url":"https://api.github.com/users/singhpk234/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-17T08:40:43Z","updated_at":"2022-06-17T12:42:17Z","author_association":"CONTRIBUTOR","body":"UPDATE : \r\nspark 3.3 got published on maven repo : https://mvnrepository.com/artifact/org.apache.spark/spark-core\r\nhave removed the pr dependency on snapshot's repo\r\n[1] Have reverted the ignored AddFilesProcedure UT's as well, since the upstream now having fix is published.\r\n[2] Have reverted the Test#Merge ut failure as well, found spark hid the behaviour we were relying on behind a conf, have enabled in our session.\r\n\r\n\r\nI am investigating the RC for the two remaining UT's failure in `TestDeleteFrom`, will update the fixes the shortly.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1158641432/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1158702003","html_url":"https://github.com/apache/iceberg/pull/5066#issuecomment-1158702003","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5066","id":1158702003,"node_id":"IC_kwDOCW7NX85FEGOz","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-17T09:46:22Z","updated_at":"2022-06-17T09:46:22Z","author_association":"CONTRIBUTOR","body":"I've removed the spellcheck because it relies on a C lib enchant that doesn't play very well with virtual-env. It can't find the binding anymore. I spend quite some time to get it to work, but no luck. Also looking at https://github.com/apache/iceberg/pull/4818 I've removed it for now since it is also not very friendly for new people to ask them to install system packages.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1158702003/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1158865578","html_url":"https://github.com/apache/iceberg/pull/1839#issuecomment-1158865578","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1839","id":1158865578,"node_id":"IC_kwDOCW7NX85FEuKq","user":{"login":"gaborkaszab","id":29145491,"node_id":"MDQ6VXNlcjI5MTQ1NDkx","avatar_url":"https://avatars.githubusercontent.com/u/29145491?v=4","gravatar_id":"","url":"https://api.github.com/users/gaborkaszab","html_url":"https://github.com/gaborkaszab","followers_url":"https://api.github.com/users/gaborkaszab/followers","following_url":"https://api.github.com/users/gaborkaszab/following{/other_user}","gists_url":"https://api.github.com/users/gaborkaszab/gists{/gist_id}","starred_url":"https://api.github.com/users/gaborkaszab/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gaborkaszab/subscriptions","organizations_url":"https://api.github.com/users/gaborkaszab/orgs","repos_url":"https://api.github.com/users/gaborkaszab/repos","events_url":"https://api.github.com/users/gaborkaszab/events{/privacy}","received_events_url":"https://api.github.com/users/gaborkaszab/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-17T13:21:00Z","updated_at":"2022-06-17T13:21:00Z","author_association":"COLLABORATOR","body":"Hey @rdblue ,\r\nI came into this topic recently as well where I expected Iceberg's dropTable() to also drop the whole directory structure for a table but apparently it doesn't. I checked a number of related issue tickets and unfinished PRs, also I checked the Iceberg sync doc. As I see the community came to a conclusion that both ways are valid (owning and not owning the whole directory structure) and there should be a flag either on table or catalog level to indicate which approach to use.\r\n\r\nHowever, I haven't seen any code changes after this conclusion was made. Is there a specific reason (e.g. the community still not sure about this functionality) or is it just no one took the effort to actually implement it? I wonder if I could revive the conversation about this topic.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1158865578/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1158948360","html_url":"https://github.com/apache/iceberg/issues/5064#issuecomment-1158948360","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5064","id":1158948360,"node_id":"IC_kwDOCW7NX85FFCYI","user":{"login":"alexjo2144","id":7109804,"node_id":"MDQ6VXNlcjcxMDk4MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/7109804?v=4","gravatar_id":"","url":"https://api.github.com/users/alexjo2144","html_url":"https://github.com/alexjo2144","followers_url":"https://api.github.com/users/alexjo2144/followers","following_url":"https://api.github.com/users/alexjo2144/following{/other_user}","gists_url":"https://api.github.com/users/alexjo2144/gists{/gist_id}","starred_url":"https://api.github.com/users/alexjo2144/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexjo2144/subscriptions","organizations_url":"https://api.github.com/users/alexjo2144/orgs","repos_url":"https://api.github.com/users/alexjo2144/repos","events_url":"https://api.github.com/users/alexjo2144/events{/privacy}","received_events_url":"https://api.github.com/users/alexjo2144/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-17T14:50:15Z","updated_at":"2022-06-17T14:50:15Z","author_association":"CONTRIBUTOR","body":"Maybe `StructLikeWrapper` should keep track of the `type` that's passed in to the constructor and should check the types are equal before calling `compare` in equals","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1158948360/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1158949356","html_url":"https://github.com/apache/iceberg/issues/5064#issuecomment-1158949356","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5064","id":1158949356,"node_id":"IC_kwDOCW7NX85FFCns","user":{"login":"homar","id":49628,"node_id":"MDQ6VXNlcjQ5NjI4","avatar_url":"https://avatars.githubusercontent.com/u/49628?v=4","gravatar_id":"","url":"https://api.github.com/users/homar","html_url":"https://github.com/homar","followers_url":"https://api.github.com/users/homar/followers","following_url":"https://api.github.com/users/homar/following{/other_user}","gists_url":"https://api.github.com/users/homar/gists{/gist_id}","starred_url":"https://api.github.com/users/homar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/homar/subscriptions","organizations_url":"https://api.github.com/users/homar/orgs","repos_url":"https://api.github.com/users/homar/repos","events_url":"https://api.github.com/users/homar/events{/privacy}","received_events_url":"https://api.github.com/users/homar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-17T14:51:17Z","updated_at":"2022-06-17T14:52:42Z","author_association":"NONE","body":"> Maybe `StructLikeWrapper` should keep track of the `type` that's passed in to the constructor and should check the types are equal before calling `compare` in equals\r\n\r\nThat may work. I didn't think about solution yet. I just reported a problem ;) \r\nIn the simplest way it may even catch potential exception from that compare method. This doesn't really matter as long as it doesn't throw anything (NPE would be acceptable but that is not the case here) ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1158949356/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1159030885","html_url":"https://github.com/apache/iceberg/pull/4792#issuecomment-1159030885","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4792","id":1159030885,"node_id":"IC_kwDOCW7NX85FFWhl","user":{"login":"emkornfield","id":17869838,"node_id":"MDQ6VXNlcjE3ODY5ODM4","avatar_url":"https://avatars.githubusercontent.com/u/17869838?v=4","gravatar_id":"","url":"https://api.github.com/users/emkornfield","html_url":"https://github.com/emkornfield","followers_url":"https://api.github.com/users/emkornfield/followers","following_url":"https://api.github.com/users/emkornfield/following{/other_user}","gists_url":"https://api.github.com/users/emkornfield/gists{/gist_id}","starred_url":"https://api.github.com/users/emkornfield/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/emkornfield/subscriptions","organizations_url":"https://api.github.com/users/emkornfield/orgs","repos_url":"https://api.github.com/users/emkornfield/repos","events_url":"https://api.github.com/users/emkornfield/events{/privacy}","received_events_url":"https://api.github.com/users/emkornfield/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-17T16:14:46Z","updated_at":"2022-06-17T16:14:46Z","author_association":"CONTRIBUTOR","body":"> The main reason why I'm hoping to add this BotoFileIO is to enable using a custom AWS signer. I couldn't find a way to do this with PyArrow's s3 filesystem (cc: @emkornfield to confirm).\r\n\r\nSorry for the late reply, this is beyond my area of expertise, so I'm not really sure but looking at the [C++ implementation](https://github.com/apache/arrow/blob/c72f84a48b4952796ab78a0c33b84a9fc8f893db/cpp/src/arrow/filesystem/s3fs.cc#L560) it seems that all references to signer are hard-coded.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1159030885/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1159047045","html_url":"https://github.com/apache/iceberg/pull/4986#issuecomment-1159047045","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4986","id":1159047045,"node_id":"IC_kwDOCW7NX85FFaeF","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-17T16:34:51Z","updated_at":"2022-06-17T16:34:51Z","author_association":"CONTRIBUTOR","body":"Thanks, @stevenzwu!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1159047045/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1159091010","html_url":"https://github.com/apache/iceberg/issues/4618#issuecomment-1159091010","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4618","id":1159091010,"node_id":"IC_kwDOCW7NX85FFlNC","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-17T17:24:00Z","updated_at":"2022-06-17T17:24:00Z","author_association":"COLLABORATOR","body":"Thanks! will review this","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1159091010/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1159115451","html_url":"https://github.com/apache/iceberg/pull/4870#issuecomment-1159115451","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4870","id":1159115451,"node_id":"IC_kwDOCW7NX85FFrK7","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-17T18:02:01Z","updated_at":"2022-06-17T18:02:01Z","author_association":"CONTRIBUTOR","body":"We discussed refactoring `FileScanTask` using a parent interface during the sync. I gave it a try in #5077.\r\nI will need a little bit more time to iterate on it but it is open for early feedback.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1159115451/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1159194551","html_url":"https://github.com/apache/iceberg/pull/5078#issuecomment-1159194551","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5078","id":1159194551,"node_id":"IC_kwDOCW7NX85FF-e3","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-17T20:07:09Z","updated_at":"2022-06-17T20:07:09Z","author_association":"CONTRIBUTOR","body":"confirmed with `git diff` that the enumerator dirs (main and test) are identical btw 1.14 and 1.15.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1159194551/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1159208496","html_url":"https://github.com/apache/iceberg/issues/4217#issuecomment-1159208496","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4217","id":1159208496,"node_id":"IC_kwDOCW7NX85FGB4w","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-17T20:31:33Z","updated_at":"2022-06-17T20:31:33Z","author_association":"CONTRIBUTOR","body":"Also make sure that vectorization is enabled for tables. This is the default in master and the upcoming release, but older versions need to enable vectorization by setting `read.parquet.vectorization.enabled=true` in table properties.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1159208496/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1159209016","html_url":"https://github.com/apache/iceberg/issues/4217#issuecomment-1159209016","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4217","id":1159209016,"node_id":"IC_kwDOCW7NX85FGCA4","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-17T20:32:28Z","updated_at":"2022-06-17T20:38:38Z","author_association":"CONTRIBUTOR","body":"Along with data vectorizations, I would encourage people to use the following system properties which affect Arrow's performance that are used within our tests - particularly if benchmarking as Arrow does duplicate some checks that we already do, which can have a big impact on hot code paths and the eventually compiled code:\r\n\r\nhttps://github.com/apache/iceberg/blob/c9442f1c0f0524b7ca5ac3ccbb927cc80b764239/spark/v3.2/build.gradle#L104-L110","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1159209016/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1159209476","html_url":"https://github.com/apache/iceberg/pull/4816#issuecomment-1159209476","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4816","id":1159209476,"node_id":"IC_kwDOCW7NX85FGCIE","user":{"login":"CircArgs","id":35903677,"node_id":"MDQ6VXNlcjM1OTAzNjc3","avatar_url":"https://avatars.githubusercontent.com/u/35903677?v=4","gravatar_id":"","url":"https://api.github.com/users/CircArgs","html_url":"https://github.com/CircArgs","followers_url":"https://api.github.com/users/CircArgs/followers","following_url":"https://api.github.com/users/CircArgs/following{/other_user}","gists_url":"https://api.github.com/users/CircArgs/gists{/gist_id}","starred_url":"https://api.github.com/users/CircArgs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CircArgs/subscriptions","organizations_url":"https://api.github.com/users/CircArgs/orgs","repos_url":"https://api.github.com/users/CircArgs/repos","events_url":"https://api.github.com/users/CircArgs/events{/privacy}","received_events_url":"https://api.github.com/users/CircArgs/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-17T20:33:16Z","updated_at":"2022-06-17T20:33:16Z","author_association":"CONTRIBUTOR","body":"Hey @rdblue sorry for the delay I was on vacation. I see I didn't change the abstract definition attribute names so I've changed that now. Do you also mean the `And` and `Or` as well? I've left those two alone for now because it's not clear to me why they would have the names `term` and `literal`","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1159209476/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1159242374","html_url":"https://github.com/apache/iceberg/pull/4708#issuecomment-1159242374","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4708","id":1159242374,"node_id":"IC_kwDOCW7NX85FGKKG","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-17T21:35:16Z","updated_at":"2022-06-17T21:35:16Z","author_association":"CONTRIBUTOR","body":"Close this. PR #4870 is the way to go.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1159242374/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1159288566","html_url":"https://github.com/apache/iceberg/pull/5079#issuecomment-1159288566","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5079","id":1159288566,"node_id":"IC_kwDOCW7NX85FGVb2","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-17T22:50:00Z","updated_at":"2022-06-17T22:50:00Z","author_association":"CONTRIBUTOR","body":"ping @samarthjain could you please take a look when you have a moment? Thanks a lot!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1159288566/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1159292770","html_url":"https://github.com/apache/iceberg/pull/5077#issuecomment-1159292770","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5077","id":1159292770,"node_id":"IC_kwDOCW7NX85FGWdi","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-17T23:01:07Z","updated_at":"2022-06-17T23:01:07Z","author_association":"CONTRIBUTOR","body":"Overall I think this looks good. Are you happy with the direction this is going, @aokolnychyi?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1159292770/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1159296987","html_url":"https://github.com/apache/iceberg/pull/5077#issuecomment-1159296987","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5077","id":1159296987,"node_id":"IC_kwDOCW7NX85FGXfb","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-17T23:14:47Z","updated_at":"2022-06-17T23:17:10Z","author_association":"CONTRIBUTOR","body":"@rdblue, I spent quite some time looking at it so I am no longer sure :) We need to sort out some details but it does unlock having tasks that are not `FileScanTask` and also parametrizes our scans. It is _probably_ worth it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1159296987/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1159301418","html_url":"https://github.com/apache/iceberg/pull/4888#issuecomment-1159301418","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4888","id":1159301418,"node_id":"IC_kwDOCW7NX85FGYkq","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-17T23:28:05Z","updated_at":"2022-06-21T17:01:30Z","author_association":"CONTRIBUTOR","body":"Thanks @RussellSpitzer for the review. Refactor class `ColumnBatchReader` a bit to remove two loops on isDeleted array. My benchmark shows a bit perf gain.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1159301418/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1159306985","html_url":"https://github.com/apache/iceberg/pull/2105#issuecomment-1159306985","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2105","id":1159306985,"node_id":"IC_kwDOCW7NX85FGZ7p","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-17T23:47:34Z","updated_at":"2022-06-17T23:47:34Z","author_association":"CONTRIBUTOR","body":"Close this draft PR, as we are moving close to merge the MVP version of FLIP-27 source","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1159306985/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1159626661","html_url":"https://github.com/apache/iceberg/issues/4471#issuecomment-1159626661","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4471","id":1159626661,"node_id":"IC_kwDOCW7NX85FHn-l","user":{"login":"peterxiong13","id":40230517,"node_id":"MDQ6VXNlcjQwMjMwNTE3","avatar_url":"https://avatars.githubusercontent.com/u/40230517?v=4","gravatar_id":"","url":"https://api.github.com/users/peterxiong13","html_url":"https://github.com/peterxiong13","followers_url":"https://api.github.com/users/peterxiong13/followers","following_url":"https://api.github.com/users/peterxiong13/following{/other_user}","gists_url":"https://api.github.com/users/peterxiong13/gists{/gist_id}","starred_url":"https://api.github.com/users/peterxiong13/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/peterxiong13/subscriptions","organizations_url":"https://api.github.com/users/peterxiong13/orgs","repos_url":"https://api.github.com/users/peterxiong13/repos","events_url":"https://api.github.com/users/peterxiong13/events{/privacy}","received_events_url":"https://api.github.com/users/peterxiong13/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-19T06:23:21Z","updated_at":"2022-06-19T06:23:21Z","author_association":"NONE","body":"@eric666666\r\n改了下确实可以，local模式不会阻塞了。另外有个问题请教下，我在合并小文件时，对于分区表老是有些等值删除文件没有清理掉，导致小文件很多。如果对表做一次比较重的数据文件重写（比如设定的条件能覆盖到所有分区的所有数据文件）有可能就清理掉了，但这么做代价太高了。难道也是local模式下才会这样？on yarn或on k8s能正常清理掉？","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1159626661/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1159803676","html_url":"https://github.com/apache/iceberg/pull/5081#issuecomment-1159803676","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5081","id":1159803676,"node_id":"IC_kwDOCW7NX85FITMc","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-19T20:13:25Z","updated_at":"2022-06-19T20:13:25Z","author_association":"CONTRIBUTOR","body":"Overall looks good! Just to avoid we miss any additional edge case, can you add an integration test just to test end to end?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1159803676/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1159840313","html_url":"https://github.com/apache/iceberg/pull/5083#issuecomment-1159840313","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5083","id":1159840313,"node_id":"IC_kwDOCW7NX85FIcI5","user":{"login":"CodingCat","id":678008,"node_id":"MDQ6VXNlcjY3ODAwOA==","avatar_url":"https://avatars.githubusercontent.com/u/678008?v=4","gravatar_id":"","url":"https://api.github.com/users/CodingCat","html_url":"https://github.com/CodingCat","followers_url":"https://api.github.com/users/CodingCat/followers","following_url":"https://api.github.com/users/CodingCat/following{/other_user}","gists_url":"https://api.github.com/users/CodingCat/gists{/gist_id}","starred_url":"https://api.github.com/users/CodingCat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CodingCat/subscriptions","organizations_url":"https://api.github.com/users/CodingCat/orgs","repos_url":"https://api.github.com/users/CodingCat/repos","events_url":"https://api.github.com/users/CodingCat/events{/privacy}","received_events_url":"https://api.github.com/users/CodingCat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-20T00:14:43Z","updated_at":"2022-06-20T00:14:43Z","author_association":"CONTRIBUTOR","body":"@kbendick, @rdblue would you mind giving a review? thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1159840313/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1159885446","html_url":"https://github.com/apache/iceberg/issues/1894#issuecomment-1159885446","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1894","id":1159885446,"node_id":"IC_kwDOCW7NX85FInKG","user":{"login":"idealspark","id":13582038,"node_id":"MDQ6VXNlcjEzNTgyMDM4","avatar_url":"https://avatars.githubusercontent.com/u/13582038?v=4","gravatar_id":"","url":"https://api.github.com/users/idealspark","html_url":"https://github.com/idealspark","followers_url":"https://api.github.com/users/idealspark/followers","following_url":"https://api.github.com/users/idealspark/following{/other_user}","gists_url":"https://api.github.com/users/idealspark/gists{/gist_id}","starred_url":"https://api.github.com/users/idealspark/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/idealspark/subscriptions","organizations_url":"https://api.github.com/users/idealspark/orgs","repos_url":"https://api.github.com/users/idealspark/repos","events_url":"https://api.github.com/users/idealspark/events{/privacy}","received_events_url":"https://api.github.com/users/idealspark/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-20T02:00:53Z","updated_at":"2022-06-20T02:00:53Z","author_association":"NONE","body":"when i execute sql use spark like this, encountered the same error\r\n`create table local.iceberg_partition.web_returns PARTITIONED by (wr_returned_date_sk) as select * from local.iceberg_db.web_returns`\r\n\r\ni add order by statement ,it works\r\n`create table local.iceberg_partition.web_returns PARTITIONED by (wr_returned_date_sk) as select * from local.iceberg_db.web_returns order by wr_returned_date_sk`","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1159885446/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160010168","html_url":"https://github.com/apache/iceberg/pull/4925#issuecomment-1160010168","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4925","id":1160010168,"node_id":"IC_kwDOCW7NX85FJFm4","user":{"login":"jzhuge","id":1883812,"node_id":"MDQ6VXNlcjE4ODM4MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1883812?v=4","gravatar_id":"","url":"https://api.github.com/users/jzhuge","html_url":"https://github.com/jzhuge","followers_url":"https://api.github.com/users/jzhuge/followers","following_url":"https://api.github.com/users/jzhuge/following{/other_user}","gists_url":"https://api.github.com/users/jzhuge/gists{/gist_id}","starred_url":"https://api.github.com/users/jzhuge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jzhuge/subscriptions","organizations_url":"https://api.github.com/users/jzhuge/orgs","repos_url":"https://api.github.com/users/jzhuge/repos","events_url":"https://api.github.com/users/jzhuge/events{/privacy}","received_events_url":"https://api.github.com/users/jzhuge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-20T06:04:59Z","updated_at":"2022-06-20T06:04:59Z","author_association":"MEMBER","body":"Thanks @amogh-jahagirdar.\r\n\r\nBTW, I am also ok if we decide to remove `UpdateViewProperties` and just use the existing `UpdateProperties`.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160010168/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160017948","html_url":"https://github.com/apache/iceberg/issues/5086#issuecomment-1160017948","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5086","id":1160017948,"node_id":"IC_kwDOCW7NX85FJHgc","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-20T06:15:21Z","updated_at":"2022-06-20T06:15:21Z","author_association":"CONTRIBUTOR","body":"Hey @deadwind4 Thanks for opening the issue. Could you elaborate a bit more on how you would see this?\r\n\r\nI'm new to the Flink connectors, and I see it being used with Elastic as you mention in the linked issue above. And in the examples of Flink itself with Kafka: https://nightlies.apache.org/flink/flink-docs-master/docs/dev/python/table/python_table_api_connectors/\r\n\r\nFor the tables that we create, we recommend setting the type of the catalog to Iceberg, and that way you'll create iceberg tables inside of that catalog. Examples are given in our docs: https://iceberg.apache.org/docs/latest/flink/#create-table\r\n\r\nLet me know what you think!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160017948/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160021495","html_url":"https://github.com/apache/iceberg/issues/4971#issuecomment-1160021495","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4971","id":1160021495,"node_id":"IC_kwDOCW7NX85FJIX3","user":{"login":"JunjianS","id":7474234,"node_id":"MDQ6VXNlcjc0NzQyMzQ=","avatar_url":"https://avatars.githubusercontent.com/u/7474234?v=4","gravatar_id":"","url":"https://api.github.com/users/JunjianS","html_url":"https://github.com/JunjianS","followers_url":"https://api.github.com/users/JunjianS/followers","following_url":"https://api.github.com/users/JunjianS/following{/other_user}","gists_url":"https://api.github.com/users/JunjianS/gists{/gist_id}","starred_url":"https://api.github.com/users/JunjianS/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JunjianS/subscriptions","organizations_url":"https://api.github.com/users/JunjianS/orgs","repos_url":"https://api.github.com/users/JunjianS/repos","events_url":"https://api.github.com/users/JunjianS/events{/privacy}","received_events_url":"https://api.github.com/users/JunjianS/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-20T06:20:02Z","updated_at":"2022-06-20T06:20:02Z","author_association":"NONE","body":"@kbendick Thank you for your advice.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160021495/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160029643","html_url":"https://github.com/apache/iceberg/issues/4618#issuecomment-1160029643","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4618","id":1160029643,"node_id":"IC_kwDOCW7NX85FJKXL","user":{"login":"XN137","id":1204398,"node_id":"MDQ6VXNlcjEyMDQzOTg=","avatar_url":"https://avatars.githubusercontent.com/u/1204398?v=4","gravatar_id":"","url":"https://api.github.com/users/XN137","html_url":"https://github.com/XN137","followers_url":"https://api.github.com/users/XN137/followers","following_url":"https://api.github.com/users/XN137/following{/other_user}","gists_url":"https://api.github.com/users/XN137/gists{/gist_id}","starred_url":"https://api.github.com/users/XN137/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/XN137/subscriptions","organizations_url":"https://api.github.com/users/XN137/orgs","repos_url":"https://api.github.com/users/XN137/repos","events_url":"https://api.github.com/users/XN137/events{/privacy}","received_events_url":"https://api.github.com/users/XN137/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-20T06:30:52Z","updated_at":"2022-06-20T06:30:52Z","author_association":"CONTRIBUTOR","body":"i am wondering why isnt https://errorprone.info/bugpattern/PreconditionsInvalidPlaceholder catching those violations already? :thinking: \r\nit should be part of the build already through `com.palantir.baseline-error-prone`\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160029643/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160079795","html_url":"https://github.com/apache/iceberg/pull/4954#issuecomment-1160079795","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4954","id":1160079795,"node_id":"IC_kwDOCW7NX85FJWmz","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-20T07:32:20Z","updated_at":"2022-06-20T07:32:20Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer could you merge this one please?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160079795/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160096399","html_url":"https://github.com/apache/iceberg/pull/4978#issuecomment-1160096399","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4978","id":1160096399,"node_id":"IC_kwDOCW7NX85FJaqP","user":{"login":"findepi","id":144328,"node_id":"MDQ6VXNlcjE0NDMyOA==","avatar_url":"https://avatars.githubusercontent.com/u/144328?v=4","gravatar_id":"","url":"https://api.github.com/users/findepi","html_url":"https://github.com/findepi","followers_url":"https://api.github.com/users/findepi/followers","following_url":"https://api.github.com/users/findepi/following{/other_user}","gists_url":"https://api.github.com/users/findepi/gists{/gist_id}","starred_url":"https://api.github.com/users/findepi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/findepi/subscriptions","organizations_url":"https://api.github.com/users/findepi/orgs","repos_url":"https://api.github.com/users/findepi/repos","events_url":"https://api.github.com/users/findepi/events{/privacy}","received_events_url":"https://api.github.com/users/findepi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-20T07:50:11Z","updated_at":"2022-06-20T07:50:11Z","author_association":"MEMBER","body":"Failure https://github.com/apache/iceberg/runs/6858297773?check_suite_focus=true doesn't look related, or more precisely, i don't see how it relates to my change.\r\n\r\n```\r\n> Task :iceberg-spark:iceberg-spark-3.2_2.13:test\r\norg.apache.iceberg.spark.actions.TestRemoveOrphanFilesAction3 > orphanedFileRemovedWithParallelTasks FAILED\r\n    java.lang.AssertionError: Should delete 4 files expected:<4> but was:<3>\r\n        at org.junit.Assert.fail(Assert.java:89)\r\n        at org.junit.Assert.failNotEquals(Assert.java:835)\r\n        at org.junit.Assert.assertEquals(Assert.java:647)\r\n        at org.apache.iceberg.spark.actions.TestRemoveOrphanFilesAction.orphanedFileRemovedWithParallelTasks(TestRemoveOrphanFilesAction.java:317)\r\n        at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.base/java.lang.reflect.Method.invoke(Method.java:566)\r\n        at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)\r\n        at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)\r\n        at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)\r\n        at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)\r\n        at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)\r\n        at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)\r\n        at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)\r\n        at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)\r\n        at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)\r\n        at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)\r\n        at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)\r\n        at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)\r\n        at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)\r\n        at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)\r\n        at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.ParentRunner.run(ParentRunner.java:413)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.runTestClass(JUnitTestClassExecutor.java:110)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:58)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:38)\r\n        at org.gradle.api.internal.tasks.testing.junit.AbstractJUnitTestClassProcessor.processTestClass(AbstractJUnitTestClassProcessor.java:62)\r\n        at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:51)\r\n        at jdk.internal.reflect.GeneratedMethodAccessor212.invoke(Unknown Source)\r\n        at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.base/java.lang.reflect.Method.invoke(Method.java:566)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:36)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)\r\n        at org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:33)\r\n        at org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:94)\r\n        at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker$2.run(TestWorker.java:176)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.executeAndMaintainThreadName(TestWorker.java:129)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:100)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:60)\r\n        at org.gradle.process.internal.worker.child.ActionExecutionWorker.execute(ActionExecutionWorker.java:56)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:133)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:71)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.run(GradleWorkerMain.java:69)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.main(GradleWorkerMain.java:74)\r\n[Thread-5] INFO org.apache.spark.util.ShutdownHookManager - Shutdown hook called\r\n```\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160096399/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160102351","html_url":"https://github.com/apache/iceberg/pull/5021#issuecomment-1160102351","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5021","id":1160102351,"node_id":"IC_kwDOCW7NX85FJcHP","user":{"login":"findepi","id":144328,"node_id":"MDQ6VXNlcjE0NDMyOA==","avatar_url":"https://avatars.githubusercontent.com/u/144328?v=4","gravatar_id":"","url":"https://api.github.com/users/findepi","html_url":"https://github.com/findepi","followers_url":"https://api.github.com/users/findepi/followers","following_url":"https://api.github.com/users/findepi/following{/other_user}","gists_url":"https://api.github.com/users/findepi/gists{/gist_id}","starred_url":"https://api.github.com/users/findepi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/findepi/subscriptions","organizations_url":"https://api.github.com/users/findepi/orgs","repos_url":"https://api.github.com/users/findepi/repos","events_url":"https://api.github.com/users/findepi/events{/privacy}","received_events_url":"https://api.github.com/users/findepi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-20T07:56:49Z","updated_at":"2022-06-20T07:56:49Z","author_association":"MEMBER","body":"Currently, based on https://github.com/apache/iceberg/pull/4978","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160102351/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160159684","html_url":"https://github.com/apache/iceberg/issues/5058#issuecomment-1160159684","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5058","id":1160159684,"node_id":"IC_kwDOCW7NX85FJqHE","user":{"login":"Initial-neko","id":40999666,"node_id":"MDQ6VXNlcjQwOTk5NjY2","avatar_url":"https://avatars.githubusercontent.com/u/40999666?v=4","gravatar_id":"","url":"https://api.github.com/users/Initial-neko","html_url":"https://github.com/Initial-neko","followers_url":"https://api.github.com/users/Initial-neko/followers","following_url":"https://api.github.com/users/Initial-neko/following{/other_user}","gists_url":"https://api.github.com/users/Initial-neko/gists{/gist_id}","starred_url":"https://api.github.com/users/Initial-neko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Initial-neko/subscriptions","organizations_url":"https://api.github.com/users/Initial-neko/orgs","repos_url":"https://api.github.com/users/Initial-neko/repos","events_url":"https://api.github.com/users/Initial-neko/events{/privacy}","received_events_url":"https://api.github.com/users/Initial-neko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-20T08:49:37Z","updated_at":"2022-06-20T08:49:37Z","author_association":"NONE","body":"The deletefile without datafile Association will be cleaned up; Maybe your datafile is the best size. You can try to increase the size of the rewritten file so that all files can be rewritten. This will clean up all old deletefiles","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160159684/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160401349","html_url":"https://github.com/apache/iceberg/pull/5061#issuecomment-1160401349","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5061","id":1160401349,"node_id":"IC_kwDOCW7NX85FKlHF","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-20T12:42:09Z","updated_at":"2022-06-20T12:44:00Z","author_association":"CONTRIBUTOR","body":"**In our latest tests, we found this problem not only with upsert table. Tables with no-upsert have similar problems.**\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160401349/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160402803","html_url":"https://github.com/apache/iceberg/pull/5061#issuecomment-1160402803","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5061","id":1160402803,"node_id":"IC_kwDOCW7NX85FKldz","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-20T12:43:36Z","updated_at":"2022-06-20T12:43:36Z","author_association":"CONTRIBUTOR","body":"cc @rdblue @wuwenchi @openinx @chenjunjiedada @kbendick , PTAL, thx.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160402803/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160446745","html_url":"https://github.com/apache/iceberg/pull/5056#issuecomment-1160446745","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5056","id":1160446745,"node_id":"IC_kwDOCW7NX85FKwMZ","user":{"login":"singhpk234","id":35593236,"node_id":"MDQ6VXNlcjM1NTkzMjM2","avatar_url":"https://avatars.githubusercontent.com/u/35593236?v=4","gravatar_id":"","url":"https://api.github.com/users/singhpk234","html_url":"https://github.com/singhpk234","followers_url":"https://api.github.com/users/singhpk234/followers","following_url":"https://api.github.com/users/singhpk234/following{/other_user}","gists_url":"https://api.github.com/users/singhpk234/gists{/gist_id}","starred_url":"https://api.github.com/users/singhpk234/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/singhpk234/subscriptions","organizations_url":"https://api.github.com/users/singhpk234/orgs","repos_url":"https://api.github.com/users/singhpk234/repos","events_url":"https://api.github.com/users/singhpk234/events{/privacy}","received_events_url":"https://api.github.com/users/singhpk234/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-20T13:24:57Z","updated_at":"2022-06-20T13:25:10Z","author_association":"CONTRIBUTOR","body":"> \"copy 3.2 files from 3.3\" should be in another PR, otherwise after squash, the git will not keep commit history.\r\n\r\nACK, opened a new [PR](https://github.com/apache/iceberg/pull/5094) for \"copy 3.2 files from 3.3\" ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160446745/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160585124","html_url":"https://github.com/apache/iceberg/pull/5061#issuecomment-1160585124","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5061","id":1160585124,"node_id":"IC_kwDOCW7NX85FLR-k","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-20T15:26:55Z","updated_at":"2022-06-20T15:26:55Z","author_association":"CONTRIBUTOR","body":"To me, it looks like the problem is that the join is producing CDC records. A join would normally not produce output records that don't match the filter, so it is strange to have `+I[2, ...]` and `-D[2, ...]` in the join output.\r\n\r\nI'm not sure how to solve this, but it looks like a problem with Flink. Flink shouldn't produce CDC rows for a straightforward join. It should just produce the regular SQL output set, which is:\r\n\r\n```\r\nid | data\r\n---+---------\r\n 1 | 20220607\r\n 3 | 20220505\r\n```\r\n\r\n> We are currently using the new Sink API to fix it temporarily, FYI #4904 (add a configuration that specifies whether to enable the new version sink), that use sink instead of transform, but in this way, we can't get the CDC data.\r\n\r\nDo you mean that the new sink doesn't pass the `RowKind` and you only get in inserted rows?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160585124/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160591787","html_url":"https://github.com/apache/iceberg/pull/5093#issuecomment-1160591787","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5093","id":1160591787,"node_id":"IC_kwDOCW7NX85FLTmr","user":{"login":"danielcweeks","id":4925077,"node_id":"MDQ6VXNlcjQ5MjUwNzc=","avatar_url":"https://avatars.githubusercontent.com/u/4925077?v=4","gravatar_id":"","url":"https://api.github.com/users/danielcweeks","html_url":"https://github.com/danielcweeks","followers_url":"https://api.github.com/users/danielcweeks/followers","following_url":"https://api.github.com/users/danielcweeks/following{/other_user}","gists_url":"https://api.github.com/users/danielcweeks/gists{/gist_id}","starred_url":"https://api.github.com/users/danielcweeks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielcweeks/subscriptions","organizations_url":"https://api.github.com/users/danielcweeks/orgs","repos_url":"https://api.github.com/users/danielcweeks/repos","events_url":"https://api.github.com/users/danielcweeks/events{/privacy}","received_events_url":"https://api.github.com/users/danielcweeks/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-20T15:33:00Z","updated_at":"2022-06-20T15:33:00Z","author_association":"CONTRIBUTOR","body":"Good catch.  Thanks @Fokko ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160591787/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160606146","html_url":"https://github.com/apache/iceberg/pull/4920#issuecomment-1160606146","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4920","id":1160606146,"node_id":"IC_kwDOCW7NX85FLXHC","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-20T15:48:08Z","updated_at":"2022-06-20T15:48:08Z","author_association":"CONTRIBUTOR","body":"Thanks, @Fokko! Everything looks great in here. Thanks for updating the tests. Looking forward to the next steps!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160606146/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160611225","html_url":"https://github.com/apache/iceberg/pull/4925#issuecomment-1160611225","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4925","id":1160611225,"node_id":"IC_kwDOCW7NX85FLYWZ","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-20T15:53:48Z","updated_at":"2022-06-20T15:53:48Z","author_association":"CONTRIBUTOR","body":"@rdblue do you have any additional comment for adding these view APIs?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160611225/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160613098","html_url":"https://github.com/apache/iceberg/pull/5078#issuecomment-1160613098","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5078","id":1160613098,"node_id":"IC_kwDOCW7NX85FLYzq","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-20T15:55:55Z","updated_at":"2022-06-20T15:55:55Z","author_association":"CONTRIBUTOR","body":"Thanks, @stevenzwu!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160613098/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160636601","html_url":"https://github.com/apache/iceberg/issues/5064#issuecomment-1160636601","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5064","id":1160636601,"node_id":"IC_kwDOCW7NX85FLei5","user":{"login":"findinpath","id":57260417,"node_id":"MDQ6VXNlcjU3MjYwNDE3","avatar_url":"https://avatars.githubusercontent.com/u/57260417?v=4","gravatar_id":"","url":"https://api.github.com/users/findinpath","html_url":"https://github.com/findinpath","followers_url":"https://api.github.com/users/findinpath/followers","following_url":"https://api.github.com/users/findinpath/following{/other_user}","gists_url":"https://api.github.com/users/findinpath/gists{/gist_id}","starred_url":"https://api.github.com/users/findinpath/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/findinpath/subscriptions","organizations_url":"https://api.github.com/users/findinpath/orgs","repos_url":"https://api.github.com/users/findinpath/repos","events_url":"https://api.github.com/users/findinpath/events{/privacy}","received_events_url":"https://api.github.com/users/findinpath/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-20T16:18:44Z","updated_at":"2022-06-20T16:18:44Z","author_association":"NONE","body":"This problem seems to be affecting Iceberg Spark implementation as well:\r\n\r\n```\r\nspark-sql> create table logs (level string, event_time timestamp , message string) partitioned by (date(event_time), level);\r\nResponse code\r\nTime taken: 2.377 seconds\r\nspark-sql> drop table logs;\r\nResponse code\r\nTime taken: 0.132 seconds\r\nspark-sql> create table logs (level string, event_time timestamp , message string) using iceberg partitioned by (date(event_time), level);\r\nResponse code\r\nTime taken: 0.043 seconds\r\nspark-sql> insert into logs values ('ERROR', timestamp '2021-04-01 12:23:53.383345', '1 message');\r\nResponse code\r\nTime taken: 2.677 seconds\r\nspark-sql> select * from logs.partitions;\r\n22/06/20 18:14:13 WARN ObjectStore: Failed to get database global_temp, returning NoSuchObjectException\r\npartition\trecord_count\tfile_count\r\n{\"event_time_day\":2021-04-01,\"level\":\"ERROR\"}\t1\t1\r\nTime taken: 0.413 seconds, Fetched 1 row(s)\r\nspark-sql> alter table logs drop partition field event_time_day;\r\nANTLR Runtime version 4.8 used for parser compilation does not match the current runtime version 4.7.1ANTLR Runtime version 4.8 used for parser compilation does not match the current runtime version 4.7.1Response code\r\nTime taken: 0.109 seconds\r\nspark-sql> alter table logs add partition field hours(event_time);\r\nResponse code\r\nTime taken: 0.044 seconds\r\nspark-sql> insert into logs values ('ERROR', timestamp '2021-04-01 15:55:23', '2 message');\r\nResponse code\r\nTime taken: 0.225 seconds\r\nspark-sql> insert into logs values ('WARN', timestamp '2021-04-01 16:55:23', '3 message');\r\nResponse code\r\nTime taken: 0.209 seconds\r\nspark-sql> select * from logs.partitions;\r\n```\r\n\r\n```\r\n22/06/20 18:17:09 ERROR Executor: Exception in task 0.0 in stage 4.0 (TID 4)\r\njava.lang.IllegalStateException: Unknown type for long field. Type name: java.lang.Integer\r\n\tat org.apache.iceberg.spark.source.StructInternalRow.getLong(StructInternalRow.java:146)\r\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)\r\n\tat org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)\r\n\tat org.apache.spark.sql.execution.WholeStageCodegenExec$$anon$1.hasNext(WholeStageCodegenExec.scala:759)\r\n\tat org.apache.spark.sql.execution.SparkPlan.$anonfun$getByteArrayRdd$1(SparkPlan.scala:349)\r\n\tat org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:898)\r\n\tat org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:898)\r\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)\r\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:373)\r\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:337)\r\n\tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:90)\r\n\tat org.apache.spark.scheduler.Task.run(Task.scala:131)\r\n\tat org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$3(Executor.scala:506)\r\n\tat org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1462)\r\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:509)\r\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)\r\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)\r\n\tat java.base/java.lang.Thread.run(Thread.java:829)\r\n22/06/20 18:17:09 WARN TaskSetManager: Lost task 0.0 in stage 4.0 (TID 4) (10.0.0.1 executor driver): java.lang.IllegalStateException: Unknown type for long field. Type name: java.lang.Integer\r\n\tat org.apache.iceberg.spark.source.StructInternalRow.getLong(StructInternalRow.java:146)\r\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)\r\n\tat org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)\r\n\tat org.apache.spark.sql.execution.WholeStageCodegenExec$$anon$1.hasNext(WholeStageCodegenExec.scala:759)\r\n\tat org.apache.spark.sql.execution.SparkPlan.$anonfun$getByteArrayRdd$1(SparkPlan.scala:349)\r\n\tat org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:898)\r\n\tat org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:898)\r\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)\r\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:373)\r\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:337)\r\n\tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:90)\r\n\tat org.apache.spark.scheduler.Task.run(Task.scala:131)\r\n\tat org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$3(Executor.scala:506)\r\n\tat org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1462)\r\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:509)\r\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)\r\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)\r\n\tat java.base/java.lang.Thread.run(Thread.java:829)\r\n\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160636601/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160676800","html_url":"https://github.com/apache/iceberg/issues/3896#issuecomment-1160676800","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3896","id":1160676800,"node_id":"IC_kwDOCW7NX85FLoXA","user":{"login":"namrathamyske","id":17932873,"node_id":"MDQ6VXNlcjE3OTMyODcz","avatar_url":"https://avatars.githubusercontent.com/u/17932873?v=4","gravatar_id":"","url":"https://api.github.com/users/namrathamyske","html_url":"https://github.com/namrathamyske","followers_url":"https://api.github.com/users/namrathamyske/followers","following_url":"https://api.github.com/users/namrathamyske/following{/other_user}","gists_url":"https://api.github.com/users/namrathamyske/gists{/gist_id}","starred_url":"https://api.github.com/users/namrathamyske/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/namrathamyske/subscriptions","organizations_url":"https://api.github.com/users/namrathamyske/orgs","repos_url":"https://api.github.com/users/namrathamyske/repos","events_url":"https://api.github.com/users/namrathamyske/events{/privacy}","received_events_url":"https://api.github.com/users/namrathamyske/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-20T17:09:21Z","updated_at":"2022-06-20T17:09:21Z","author_association":"CONTRIBUTOR","body":"@jackye1995 I have started PR : https://github.com/apache/iceberg/pull/4926, https://github.com/apache/iceberg/pull/5010 wrt to this issue. Would like to take this forward.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160676800/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160687177","html_url":"https://github.com/apache/iceberg/pull/5010#issuecomment-1160687177","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5010","id":1160687177,"node_id":"IC_kwDOCW7NX85FLq5J","user":{"login":"namrathamyske","id":17932873,"node_id":"MDQ6VXNlcjE3OTMyODcz","avatar_url":"https://avatars.githubusercontent.com/u/17932873?v=4","gravatar_id":"","url":"https://api.github.com/users/namrathamyske","html_url":"https://github.com/namrathamyske","followers_url":"https://api.github.com/users/namrathamyske/followers","following_url":"https://api.github.com/users/namrathamyske/following{/other_user}","gists_url":"https://api.github.com/users/namrathamyske/gists{/gist_id}","starred_url":"https://api.github.com/users/namrathamyske/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/namrathamyske/subscriptions","organizations_url":"https://api.github.com/users/namrathamyske/orgs","repos_url":"https://api.github.com/users/namrathamyske/repos","events_url":"https://api.github.com/users/namrathamyske/events{/privacy}","received_events_url":"https://api.github.com/users/namrathamyske/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-20T17:21:38Z","updated_at":"2022-06-20T17:21:38Z","author_association":"CONTRIBUTOR","body":"@rdblue Can you review this ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160687177/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160752668","html_url":"https://github.com/apache/iceberg/pull/5060#issuecomment-1160752668","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5060","id":1160752668,"node_id":"IC_kwDOCW7NX85FL64c","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-20T18:53:31Z","updated_at":"2022-06-20T18:53:31Z","author_association":"CONTRIBUTOR","body":"@wang-x-xia, we will need to update the LICENSE and NOTICE file for all of the additional files that are brought in by this change. Can you paste a copy of the module's dependency tree and all of the new files that this adds to the Iceberg Spark 3.2 runtime Jar?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160752668/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160753463","html_url":"https://github.com/apache/iceberg/pull/5053#issuecomment-1160753463","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5053","id":1160753463,"node_id":"IC_kwDOCW7NX85FL7E3","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-20T18:54:51Z","updated_at":"2022-06-20T18:54:51Z","author_association":"CONTRIBUTOR","body":"Thanks, @kbendick!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160753463/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160754188","html_url":"https://github.com/apache/iceberg/pull/5049#issuecomment-1160754188","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5049","id":1160754188,"node_id":"IC_kwDOCW7NX85FL7QM","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-20T18:56:06Z","updated_at":"2022-06-20T18:56:06Z","author_association":"CONTRIBUTOR","body":"@ConeyLiu, sure. If you want to backport that, I think it would be useful.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160754188/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160762931","html_url":"https://github.com/apache/iceberg/pull/5094#issuecomment-1160762931","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5094","id":1160762931,"node_id":"IC_kwDOCW7NX85FL9Yz","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-20T19:08:51Z","updated_at":"2022-06-20T19:08:51Z","author_association":"CONTRIBUTOR","body":"@singhpk234, can you post a gist of the diff between 3.2 and 3.3? I see there's an addition for metadata columns.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160762931/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160773692","html_url":"https://github.com/apache/iceberg/pull/5052#issuecomment-1160773692","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5052","id":1160773692,"node_id":"IC_kwDOCW7NX85FMAA8","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-20T19:23:01Z","updated_at":"2022-06-20T19:23:01Z","author_association":"CONTRIBUTOR","body":"Thanks, @kbendick!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160773692/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160774550","html_url":"https://github.com/apache/iceberg/pull/5083#issuecomment-1160774550","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5083","id":1160774550,"node_id":"IC_kwDOCW7NX85FMAOW","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-20T19:24:08Z","updated_at":"2022-06-20T19:24:08Z","author_association":"CONTRIBUTOR","body":"@aokolnychyi, can you take a look? You're most familiar with this part of the code.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160774550/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160796773","html_url":"https://github.com/apache/iceberg/pull/5089#issuecomment-1160796773","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5089","id":1160796773,"node_id":"IC_kwDOCW7NX85FMFpl","user":{"login":"findepi","id":144328,"node_id":"MDQ6VXNlcjE0NDMyOA==","avatar_url":"https://avatars.githubusercontent.com/u/144328?v=4","gravatar_id":"","url":"https://api.github.com/users/findepi","html_url":"https://github.com/findepi","followers_url":"https://api.github.com/users/findepi/followers","following_url":"https://api.github.com/users/findepi/following{/other_user}","gists_url":"https://api.github.com/users/findepi/gists{/gist_id}","starred_url":"https://api.github.com/users/findepi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/findepi/subscriptions","organizations_url":"https://api.github.com/users/findepi/orgs","repos_url":"https://api.github.com/users/findepi/repos","events_url":"https://api.github.com/users/findepi/events{/privacy}","received_events_url":"https://api.github.com/users/findepi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-20T19:52:41Z","updated_at":"2022-06-20T19:52:41Z","author_association":"MEMBER","body":"Thanks @danielcweeks ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160796773/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160848956","html_url":"https://github.com/apache/iceberg/pull/5094#issuecomment-1160848956","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5094","id":1160848956,"node_id":"IC_kwDOCW7NX85FMSY8","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-20T21:09:13Z","updated_at":"2022-06-20T21:09:13Z","author_association":"CONTRIBUTOR","body":"Here's a gist with the diff: https://gist.github.com/rdblue/73c575f7ada567c3fb3b997918f3bf9d","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160848956/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160866480","html_url":"https://github.com/apache/iceberg/issues/5028#issuecomment-1160866480","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5028","id":1160866480,"node_id":"IC_kwDOCW7NX85FMWqw","user":{"login":"romibuzi","id":2420675,"node_id":"MDQ6VXNlcjI0MjA2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/2420675?v=4","gravatar_id":"","url":"https://api.github.com/users/romibuzi","html_url":"https://github.com/romibuzi","followers_url":"https://api.github.com/users/romibuzi/followers","following_url":"https://api.github.com/users/romibuzi/following{/other_user}","gists_url":"https://api.github.com/users/romibuzi/gists{/gist_id}","starred_url":"https://api.github.com/users/romibuzi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/romibuzi/subscriptions","organizations_url":"https://api.github.com/users/romibuzi/orgs","repos_url":"https://api.github.com/users/romibuzi/repos","events_url":"https://api.github.com/users/romibuzi/events{/privacy}","received_events_url":"https://api.github.com/users/romibuzi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-20T21:38:21Z","updated_at":"2022-06-20T21:38:21Z","author_association":"NONE","body":"Hi @shiyuhang0, yes you can name your catalog as you want. \r\nThen you will reference it in you spark sql queries: \r\n```sql\r\n\"CREATE TABLE ${your_catalog_name}.db.table (id long, data string) USING iceberg\"\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160866480/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160873780","html_url":"https://github.com/apache/iceberg/pull/5094#issuecomment-1160873780","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5094","id":1160873780,"node_id":"IC_kwDOCW7NX85FMYc0","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-20T21:50:21Z","updated_at":"2022-06-20T21:50:21Z","author_association":"CONTRIBUTOR","body":"@singhpk234, thanks for putting this together! I did a round of review. Hopefully we can get this in soon!\r\n\r\nIt would be great if @aokolnychyi could take a look as well.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160873780/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160911106","html_url":"https://github.com/apache/iceberg/pull/5079#issuecomment-1160911106","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5079","id":1160911106,"node_id":"IC_kwDOCW7NX85FMhkC","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-20T22:40:03Z","updated_at":"2022-06-20T22:40:03Z","author_association":"CONTRIBUTOR","body":"@huaxingao, looks like `FixedWidthBinaryReader` needs to be updated as well.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160911106/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160917682","html_url":"https://github.com/apache/iceberg/pull/5084#issuecomment-1160917682","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5084","id":1160917682,"node_id":"IC_kwDOCW7NX85FMjKy","user":{"login":"bryanck","id":5475421,"node_id":"MDQ6VXNlcjU0NzU0MjE=","avatar_url":"https://avatars.githubusercontent.com/u/5475421?v=4","gravatar_id":"","url":"https://api.github.com/users/bryanck","html_url":"https://github.com/bryanck","followers_url":"https://api.github.com/users/bryanck/followers","following_url":"https://api.github.com/users/bryanck/following{/other_user}","gists_url":"https://api.github.com/users/bryanck/gists{/gist_id}","starred_url":"https://api.github.com/users/bryanck/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bryanck/subscriptions","organizations_url":"https://api.github.com/users/bryanck/orgs","repos_url":"https://api.github.com/users/bryanck/repos","events_url":"https://api.github.com/users/bryanck/events{/privacy}","received_events_url":"https://api.github.com/users/bryanck/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-20T22:48:12Z","updated_at":"2022-06-20T22:48:12Z","author_association":"CONTRIBUTOR","body":"I added a test for creating a V2 table via a create transaction, which fails without the change.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1160917682/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1161178972","html_url":"https://github.com/apache/iceberg/issues/4190#issuecomment-1161178972","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4190","id":1161178972,"node_id":"IC_kwDOCW7NX85FNi9c","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-21T03:10:25Z","updated_at":"2022-06-21T03:10:34Z","author_association":"CONTRIBUTOR","body":"I think we should take this feature seriously. In fact, in the Flink CDC, HUDI already supports dynamic table schema changes without restarting tasks. It captures schema changes to the table and updates it in real time.\r\n\r\nWhen synchronizing data using flink CDC, it is unacceptable to restart a task if the table schema changes.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1161178972/reactions","total_count":11,"+1":11,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1161197507","html_url":"https://github.com/apache/iceberg/issues/5069#issuecomment-1161197507","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5069","id":1161197507,"node_id":"IC_kwDOCW7NX85FNnfD","user":{"login":"felixYyu","id":3785228,"node_id":"MDQ6VXNlcjM3ODUyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3785228?v=4","gravatar_id":"","url":"https://api.github.com/users/felixYyu","html_url":"https://github.com/felixYyu","followers_url":"https://api.github.com/users/felixYyu/followers","following_url":"https://api.github.com/users/felixYyu/following{/other_user}","gists_url":"https://api.github.com/users/felixYyu/gists{/gist_id}","starred_url":"https://api.github.com/users/felixYyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixYyu/subscriptions","organizations_url":"https://api.github.com/users/felixYyu/orgs","repos_url":"https://api.github.com/users/felixYyu/repos","events_url":"https://api.github.com/users/felixYyu/events{/privacy}","received_events_url":"https://api.github.com/users/felixYyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-21T03:27:06Z","updated_at":"2022-06-21T05:13:52Z","author_association":"CONTRIBUTOR","body":"cc: @rdblue @RussellSpitzer @kbendick I think should be added `PRIMARY KEY(col) NOT ENFORCED` to column via Spark sql?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1161197507/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1161214941","html_url":"https://github.com/apache/iceberg/pull/5061#issuecomment-1161214941","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5061","id":1161214941,"node_id":"IC_kwDOCW7NX85FNrvd","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-21T03:43:19Z","updated_at":"2022-06-21T03:43:19Z","author_association":"CONTRIBUTOR","body":"![image.png](https://user-images.githubusercontent.com/59213263/174711554-93aa9d4b-e4ae-4b8a-b88c-1a07315ef3f4.png)\n\nIn Flink SQL, data is transferred from one operator to another as a Chanlog Stream. Changelog Stream can be translated as either a table or a Stream.\n\nIceberg should be more like a Dynamic Table. In our case above, I think it should materialize changes rather than store changes in the table as they were.\n\n> Do you mean that the new sink doesn't pass the RowKind and you only get in inserted rows?\n\nSink will not just receive Inserted Rows. With Flink CDC, it can receive change log normally.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1161214941/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1161321533","html_url":"https://github.com/apache/iceberg/issues/4510#issuecomment-1161321533","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4510","id":1161321533,"node_id":"IC_kwDOCW7NX85FOFw9","user":{"login":"romibuzi","id":2420675,"node_id":"MDQ6VXNlcjI0MjA2NzU=","avatar_url":"https://avatars.githubusercontent.com/u/2420675?v=4","gravatar_id":"","url":"https://api.github.com/users/romibuzi","html_url":"https://github.com/romibuzi","followers_url":"https://api.github.com/users/romibuzi/followers","following_url":"https://api.github.com/users/romibuzi/following{/other_user}","gists_url":"https://api.github.com/users/romibuzi/gists{/gist_id}","starred_url":"https://api.github.com/users/romibuzi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/romibuzi/subscriptions","organizations_url":"https://api.github.com/users/romibuzi/orgs","repos_url":"https://api.github.com/users/romibuzi/repos","events_url":"https://api.github.com/users/romibuzi/events{/privacy}","received_events_url":"https://api.github.com/users/romibuzi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-21T06:33:34Z","updated_at":"2022-06-21T06:33:51Z","author_association":"NONE","body":"Hi @itaise, \r\nyou need to change the partition specs of your table before writing the data with the new partition:\r\n\r\n```\r\nspark.sql(\"ALTER TABLE iprod.test_schema.example DROP PARTITION FIELD some_date\")\r\nspark.sql(\"ALTER TABLE iprod.test_schema.example ADD PARTITION FIELD some_date_2\")\r\n```\r\n\r\nThis will not drop `some_date` from your data but only metadata","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1161321533/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1161387770","html_url":"https://github.com/apache/iceberg/pull/5033#issuecomment-1161387770","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5033","id":1161387770,"node_id":"IC_kwDOCW7NX85FOV76","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-21T07:51:13Z","updated_at":"2022-06-21T07:51:13Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer could you merge this one please?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1161387770/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1161395051","html_url":"https://github.com/apache/iceberg/pull/3231#issuecomment-1161395051","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3231","id":1161395051,"node_id":"IC_kwDOCW7NX85FOXtr","user":{"login":"ggershinsky","id":12033212,"node_id":"MDQ6VXNlcjEyMDMzMjEy","avatar_url":"https://avatars.githubusercontent.com/u/12033212?v=4","gravatar_id":"","url":"https://api.github.com/users/ggershinsky","html_url":"https://github.com/ggershinsky","followers_url":"https://api.github.com/users/ggershinsky/followers","following_url":"https://api.github.com/users/ggershinsky/following{/other_user}","gists_url":"https://api.github.com/users/ggershinsky/gists{/gist_id}","starred_url":"https://api.github.com/users/ggershinsky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ggershinsky/subscriptions","organizations_url":"https://api.github.com/users/ggershinsky/orgs","repos_url":"https://api.github.com/users/ggershinsky/repos","events_url":"https://api.github.com/users/ggershinsky/events{/privacy}","received_events_url":"https://api.github.com/users/ggershinsky/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-21T07:57:42Z","updated_at":"2022-06-21T07:57:42Z","author_association":"CONTRIBUTOR","body":"> Thanks @ggershinsky for the patch. Can we add a unit test for these two classes?\r\n\r\ndone","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1161395051/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1161416399","html_url":"https://github.com/apache/iceberg/issues/5058#issuecomment-1161416399","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5058","id":1161416399,"node_id":"IC_kwDOCW7NX85FOc7P","user":{"login":"eric666666","id":51162281,"node_id":"MDQ6VXNlcjUxMTYyMjgx","avatar_url":"https://avatars.githubusercontent.com/u/51162281?v=4","gravatar_id":"","url":"https://api.github.com/users/eric666666","html_url":"https://github.com/eric666666","followers_url":"https://api.github.com/users/eric666666/followers","following_url":"https://api.github.com/users/eric666666/following{/other_user}","gists_url":"https://api.github.com/users/eric666666/gists{/gist_id}","starred_url":"https://api.github.com/users/eric666666/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eric666666/subscriptions","organizations_url":"https://api.github.com/users/eric666666/orgs","repos_url":"https://api.github.com/users/eric666666/repos","events_url":"https://api.github.com/users/eric666666/events{/privacy}","received_events_url":"https://api.github.com/users/eric666666/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-21T08:16:25Z","updated_at":"2022-06-21T08:16:25Z","author_association":"NONE","body":"> The deletefile without datafile Association will be cleaned up; Maybe your datafile is the best size. You can try to increase the size of the rewritten file so that all files can be rewritten. This will clean up all old deletefiles\r\n\r\nThanks for your reply! I‘m already set 'min-input-files'='1' , so it will rewrite all datafiles. But the equality delete file and pos-delete file  can not remove from expire snapshot action.\r\nI test it seems like occour on partition table which added where cause in rewrite_data_files action.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1161416399/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1161433895","html_url":"https://github.com/apache/iceberg/pull/5061#issuecomment-1161433895","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5061","id":1161433895,"node_id":"IC_kwDOCW7NX85FOhMn","user":{"login":"wuwenchi","id":19755729,"node_id":"MDQ6VXNlcjE5NzU1NzI5","avatar_url":"https://avatars.githubusercontent.com/u/19755729?v=4","gravatar_id":"","url":"https://api.github.com/users/wuwenchi","html_url":"https://github.com/wuwenchi","followers_url":"https://api.github.com/users/wuwenchi/followers","following_url":"https://api.github.com/users/wuwenchi/following{/other_user}","gists_url":"https://api.github.com/users/wuwenchi/gists{/gist_id}","starred_url":"https://api.github.com/users/wuwenchi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wuwenchi/subscriptions","organizations_url":"https://api.github.com/users/wuwenchi/orgs","repos_url":"https://api.github.com/users/wuwenchi/repos","events_url":"https://api.github.com/users/wuwenchi/events{/privacy}","received_events_url":"https://api.github.com/users/wuwenchi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-21T08:32:10Z","updated_at":"2022-06-21T08:32:10Z","author_association":"CONTRIBUTOR","body":"For the data with id=2\r\n1. Originally there is a piece of data, the operation is insert, which is `+I`,\r\n2. The two data in the CDC data are `+I` and `-D`\r\n\r\nIf the cdc data is regarded as a whole, and the cdc is inserted first and then deleted, the original piece of data should be left in the end.  But in fact, on the whole, all operations on the data are `+I, +I, -D`, and the second `+I` was wrongly processed as an update to the original data, which eventually led to the disappearance of this data. (In fact, the second `+I` is an insert into the intermediate result set)\r\n\r\nSo, in this case, should batch mode be used? Generate the final result directly for `select` in batch mode:\r\n```\r\nselect  t1.id as id ,t1.data as data from upsert_sample t1 left join upsert_test t2 on t1.id = t2.id  where t1.data > t2.data or t2.data is null  :\r\n+----+--------------------------------+--------------------------------+\r\n| op |                             id |                           data |\r\n+----+--------------------------------+--------------------------------+\r\n| +I |                              1 |                       20220607 |\r\n| +I |                              3 |                       20220505 |\r\n+----+--------------------------------+--------------------------------+\r\n```\r\n\r\nThis is just a temporary solution that I can think of. But in stream mode, there is indeed a problem with the result processed by iceberg now.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1161433895/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1161499158","html_url":"https://github.com/apache/iceberg/pull/4926#issuecomment-1161499158","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4926","id":1161499158,"node_id":"IC_kwDOCW7NX85FOxIW","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-21T09:30:43Z","updated_at":"2022-06-21T09:30:43Z","author_association":"CONTRIBUTOR","body":"Replied here https://github.com/apache/iceberg/pull/4926#discussion_r902380766 , but yes as @rdblue pointed out I think we'll need to think of defining conflict detection validation behavior in the presence of branching and tagging (such as the case where validation starts at a snapshot which is not an ancestor of the branch). I'll need to think more on this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1161499158/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1161522749","html_url":"https://github.com/apache/iceberg/pull/5037#issuecomment-1161522749","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5037","id":1161522749,"node_id":"IC_kwDOCW7NX85FO249","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-21T09:51:50Z","updated_at":"2022-06-21T09:51:50Z","author_association":"MEMBER","body":"@pvary , @openinx, @szehon-ho, @RussellSpitzer , @rdblue : Can one of the maintainers please approve the first-time contributor flow for this PR?   ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1161522749/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]