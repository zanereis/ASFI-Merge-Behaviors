[{"url":"https://api.github.com/repos/apache/druid/issues/comments/384349017","html_url":"https://github.com/apache/druid/issues/5205#issuecomment-384349017","issue_url":"https://api.github.com/repos/apache/druid/issues/5205","id":384349017,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDM0OTAxNw==","user":{"login":"Himadri1800","id":3540291,"node_id":"MDQ6VXNlcjM1NDAyOTE=","avatar_url":"https://avatars.githubusercontent.com/u/3540291?v=4","gravatar_id":"","url":"https://api.github.com/users/Himadri1800","html_url":"https://github.com/Himadri1800","followers_url":"https://api.github.com/users/Himadri1800/followers","following_url":"https://api.github.com/users/Himadri1800/following{/other_user}","gists_url":"https://api.github.com/users/Himadri1800/gists{/gist_id}","starred_url":"https://api.github.com/users/Himadri1800/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Himadri1800/subscriptions","organizations_url":"https://api.github.com/users/Himadri1800/orgs","repos_url":"https://api.github.com/users/Himadri1800/repos","events_url":"https://api.github.com/users/Himadri1800/events{/privacy}","received_events_url":"https://api.github.com/users/Himadri1800/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-25T16:27:44Z","updated_at":"2018-04-25T16:27:44Z","author_association":"NONE","body":"Use `-XX:OnOutOfMemoryError=\"/bin/kill -9 %p\"` instead","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/384349017/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/384352053","html_url":"https://github.com/apache/druid/issues/5641#issuecomment-384352053","issue_url":"https://api.github.com/repos/apache/druid/issues/5641","id":384352053,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDM1MjA1Mw==","user":{"login":"varaga","id":31006611,"node_id":"MDQ6VXNlcjMxMDA2NjEx","avatar_url":"https://avatars.githubusercontent.com/u/31006611?v=4","gravatar_id":"","url":"https://api.github.com/users/varaga","html_url":"https://github.com/varaga","followers_url":"https://api.github.com/users/varaga/followers","following_url":"https://api.github.com/users/varaga/following{/other_user}","gists_url":"https://api.github.com/users/varaga/gists{/gist_id}","starred_url":"https://api.github.com/users/varaga/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/varaga/subscriptions","organizations_url":"https://api.github.com/users/varaga/orgs","repos_url":"https://api.github.com/users/varaga/repos","events_url":"https://api.github.com/users/varaga/events{/privacy}","received_events_url":"https://api.github.com/users/varaga/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-25T16:37:08Z","updated_at":"2018-04-25T16:37:08Z","author_association":"CONTRIBUTOR","body":"@gianm  & @jihoonson  - PR Submitted here: https://github.com/druid-io/druid/pull/5701","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/384352053/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/384434163","html_url":"https://github.com/apache/druid/pull/5322#issuecomment-384434163","issue_url":"https://api.github.com/repos/apache/druid/issues/5322","id":384434163,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDQzNDE2Mw==","user":{"login":"b-slim","id":7376396,"node_id":"MDQ6VXNlcjczNzYzOTY=","avatar_url":"https://avatars.githubusercontent.com/u/7376396?v=4","gravatar_id":"","url":"https://api.github.com/users/b-slim","html_url":"https://github.com/b-slim","followers_url":"https://api.github.com/users/b-slim/followers","following_url":"https://api.github.com/users/b-slim/following{/other_user}","gists_url":"https://api.github.com/users/b-slim/gists{/gist_id}","starred_url":"https://api.github.com/users/b-slim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/b-slim/subscriptions","organizations_url":"https://api.github.com/users/b-slim/orgs","repos_url":"https://api.github.com/users/b-slim/repos","events_url":"https://api.github.com/users/b-slim/events{/privacy}","received_events_url":"https://api.github.com/users/b-slim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-25T21:06:34Z","updated_at":"2018-04-25T21:08:24Z","author_association":"CONTRIBUTOR","body":"@jon-wei this is where the magic is happening ```io.druid.security.kerberos.DruidKerberosUtil#kerberosChallenge```\r\nas you can see the challenge is tight to the serverName hence can not be read by broker if it was originally generated to Router. I am not sure how you can get around this?\r\n\r\n```java\r\n      // GSS name for server\r\n      GSSName serverName = manager.createName(\"HTTP@\" + server, GSSName.NT_HOSTBASED_SERVICE);\r\n      // Create a GSSContext for authentication with the service.\r\n```","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/384434163/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/384441481","html_url":"https://github.com/apache/druid/pull/5322#issuecomment-384441481","issue_url":"https://api.github.com/repos/apache/druid/issues/5322","id":384441481,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDQ0MTQ4MQ==","user":{"login":"jon-wei","id":8729063,"node_id":"MDQ6VXNlcjg3MjkwNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8729063?v=4","gravatar_id":"","url":"https://api.github.com/users/jon-wei","html_url":"https://github.com/jon-wei","followers_url":"https://api.github.com/users/jon-wei/followers","following_url":"https://api.github.com/users/jon-wei/following{/other_user}","gists_url":"https://api.github.com/users/jon-wei/gists{/gist_id}","starred_url":"https://api.github.com/users/jon-wei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jon-wei/subscriptions","organizations_url":"https://api.github.com/users/jon-wei/orgs","repos_url":"https://api.github.com/users/jon-wei/repos","events_url":"https://api.github.com/users/jon-wei/events{/privacy}","received_events_url":"https://api.github.com/users/jon-wei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-25T21:33:41Z","updated_at":"2018-04-25T21:33:41Z","author_association":"CONTRIBUTOR","body":"@b-slim Can you try a test build where you put that escalated router -> broker path back in, and see if that fixes the issue? We can see where to go from there. I don't have a setup where I can reproduce the issue yet.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/384441481/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/384446155","html_url":"https://github.com/apache/druid/pull/5322#issuecomment-384446155","issue_url":"https://api.github.com/repos/apache/druid/issues/5322","id":384446155,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDQ0NjE1NQ==","user":{"login":"b-slim","id":7376396,"node_id":"MDQ6VXNlcjczNzYzOTY=","avatar_url":"https://avatars.githubusercontent.com/u/7376396?v=4","gravatar_id":"","url":"https://api.github.com/users/b-slim","html_url":"https://github.com/b-slim","followers_url":"https://api.github.com/users/b-slim/followers","following_url":"https://api.github.com/users/b-slim/following{/other_user}","gists_url":"https://api.github.com/users/b-slim/gists{/gist_id}","starred_url":"https://api.github.com/users/b-slim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/b-slim/subscriptions","organizations_url":"https://api.github.com/users/b-slim/orgs","repos_url":"https://api.github.com/users/b-slim/repos","events_url":"https://api.github.com/users/b-slim/events{/privacy}","received_events_url":"https://api.github.com/users/b-slim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-25T21:52:45Z","updated_at":"2018-04-25T21:52:45Z","author_association":"CONTRIBUTOR","body":"@jon-wei i did that and it is not working, in fact that client does't try to authenticate at all. am still looking what is the best way to fix this currently am thinking about attaching the authToken since it is tight to the user id and every node can decrypt it if they share the same secret ... will keep you posted am still hacking around. ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/384446155/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/384484977","html_url":"https://github.com/apache/druid/pull/5706#issuecomment-384484977","issue_url":"https://api.github.com/repos/apache/druid/issues/5706","id":384484977,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDQ4NDk3Nw==","user":{"login":"b-slim","id":7376396,"node_id":"MDQ6VXNlcjczNzYzOTY=","avatar_url":"https://avatars.githubusercontent.com/u/7376396?v=4","gravatar_id":"","url":"https://api.github.com/users/b-slim","html_url":"https://github.com/b-slim","followers_url":"https://api.github.com/users/b-slim/followers","following_url":"https://api.github.com/users/b-slim/following{/other_user}","gists_url":"https://api.github.com/users/b-slim/gists{/gist_id}","starred_url":"https://api.github.com/users/b-slim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/b-slim/subscriptions","organizations_url":"https://api.github.com/users/b-slim/orgs","repos_url":"https://api.github.com/users/b-slim/repos","events_url":"https://api.github.com/users/b-slim/events{/privacy}","received_events_url":"https://api.github.com/users/b-slim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-26T01:36:21Z","updated_at":"2018-04-26T01:36:21Z","author_association":"CONTRIBUTOR","body":"related to https://github.com/druid-io/druid/pull/5322","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/384484977/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/384485053","html_url":"https://github.com/apache/druid/pull/5322#issuecomment-384485053","issue_url":"https://api.github.com/repos/apache/druid/issues/5322","id":384485053,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDQ4NTA1Mw==","user":{"login":"b-slim","id":7376396,"node_id":"MDQ6VXNlcjczNzYzOTY=","avatar_url":"https://avatars.githubusercontent.com/u/7376396?v=4","gravatar_id":"","url":"https://api.github.com/users/b-slim","html_url":"https://github.com/b-slim","followers_url":"https://api.github.com/users/b-slim/followers","following_url":"https://api.github.com/users/b-slim/following{/other_user}","gists_url":"https://api.github.com/users/b-slim/gists{/gist_id}","starred_url":"https://api.github.com/users/b-slim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/b-slim/subscriptions","organizations_url":"https://api.github.com/users/b-slim/orgs","repos_url":"https://api.github.com/users/b-slim/repos","events_url":"https://api.github.com/users/b-slim/events{/privacy}","received_events_url":"https://api.github.com/users/b-slim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-26T01:36:57Z","updated_at":"2018-04-26T01:36:57Z","author_association":"CONTRIBUTOR","body":"@jon-wei and @gianm thanks for feedback sent PR","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/384485053/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/384547715","html_url":"https://github.com/apache/druid/issues/5687#issuecomment-384547715","issue_url":"https://api.github.com/repos/apache/druid/issues/5687","id":384547715,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDU0NzcxNQ==","user":{"login":"davidkeeper","id":38687149,"node_id":"MDQ6VXNlcjM4Njg3MTQ5","avatar_url":"https://avatars.githubusercontent.com/u/38687149?v=4","gravatar_id":"","url":"https://api.github.com/users/davidkeeper","html_url":"https://github.com/davidkeeper","followers_url":"https://api.github.com/users/davidkeeper/followers","following_url":"https://api.github.com/users/davidkeeper/following{/other_user}","gists_url":"https://api.github.com/users/davidkeeper/gists{/gist_id}","starred_url":"https://api.github.com/users/davidkeeper/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davidkeeper/subscriptions","organizations_url":"https://api.github.com/users/davidkeeper/orgs","repos_url":"https://api.github.com/users/davidkeeper/repos","events_url":"https://api.github.com/users/davidkeeper/events{/privacy}","received_events_url":"https://api.github.com/users/davidkeeper/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-26T07:53:00Z","updated_at":"2018-04-26T07:53:00Z","author_association":"NONE","body":"@gianm Thanks for your reply, but still some confuse about noop mode. Here I post the detail question:\r\nhttps://groups.google.com/forum/#!topic/druid-user/CzNNRK74y2k","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/384547715/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/384719673","html_url":"https://github.com/apache/druid/issues/5707#issuecomment-384719673","issue_url":"https://api.github.com/repos/apache/druid/issues/5707","id":384719673,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDcxOTY3Mw==","user":{"login":"leventov","id":609240,"node_id":"MDQ6VXNlcjYwOTI0MA==","avatar_url":"https://avatars.githubusercontent.com/u/609240?v=4","gravatar_id":"","url":"https://api.github.com/users/leventov","html_url":"https://github.com/leventov","followers_url":"https://api.github.com/users/leventov/followers","following_url":"https://api.github.com/users/leventov/following{/other_user}","gists_url":"https://api.github.com/users/leventov/gists{/gist_id}","starred_url":"https://api.github.com/users/leventov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leventov/subscriptions","organizations_url":"https://api.github.com/users/leventov/orgs","repos_url":"https://api.github.com/users/leventov/repos","events_url":"https://api.github.com/users/leventov/events{/privacy}","received_events_url":"https://api.github.com/users/leventov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-26T17:16:02Z","updated_at":"2018-04-26T17:16:02Z","author_association":"MEMBER","body":"This might be essentially the same problem as fixed in https://github.com/druid-io/druid/pull/4758, just on lookup update rather than initial loading.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/384719673/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/384777914","html_url":"https://github.com/apache/druid/pull/5692#issuecomment-384777914","issue_url":"https://api.github.com/repos/apache/druid/issues/5692","id":384777914,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDc3NzkxNA==","user":{"login":"b-slim","id":7376396,"node_id":"MDQ6VXNlcjczNzYzOTY=","avatar_url":"https://avatars.githubusercontent.com/u/7376396?v=4","gravatar_id":"","url":"https://api.github.com/users/b-slim","html_url":"https://github.com/b-slim","followers_url":"https://api.github.com/users/b-slim/followers","following_url":"https://api.github.com/users/b-slim/following{/other_user}","gists_url":"https://api.github.com/users/b-slim/gists{/gist_id}","starred_url":"https://api.github.com/users/b-slim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/b-slim/subscriptions","organizations_url":"https://api.github.com/users/b-slim/orgs","repos_url":"https://api.github.com/users/b-slim/repos","events_url":"https://api.github.com/users/b-slim/events{/privacy}","received_events_url":"https://api.github.com/users/b-slim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-26T20:26:22Z","updated_at":"2018-04-26T20:26:22Z","author_association":"CONTRIBUTOR","body":"@dclim not sure how someone would read this\r\n\r\n>  the segments may remain in deep storage and may need to be cleaned up manually.\r\n\r\nCan you please provide some guidance on how to find out those leaked segments and delete it manually? ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/384777914/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/384788314","html_url":"https://github.com/apache/druid/issues/5628#issuecomment-384788314","issue_url":"https://api.github.com/repos/apache/druid/issues/5628","id":384788314,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDc4ODMxNA==","user":{"login":"jon-wei","id":8729063,"node_id":"MDQ6VXNlcjg3MjkwNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8729063?v=4","gravatar_id":"","url":"https://api.github.com/users/jon-wei","html_url":"https://github.com/jon-wei","followers_url":"https://api.github.com/users/jon-wei/followers","following_url":"https://api.github.com/users/jon-wei/following{/other_user}","gists_url":"https://api.github.com/users/jon-wei/gists{/gist_id}","starred_url":"https://api.github.com/users/jon-wei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jon-wei/subscriptions","organizations_url":"https://api.github.com/users/jon-wei/orgs","repos_url":"https://api.github.com/users/jon-wei/repos","events_url":"https://api.github.com/users/jon-wei/events{/privacy}","received_events_url":"https://api.github.com/users/jon-wei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-26T21:03:44Z","updated_at":"2018-04-26T21:03:44Z","author_association":"CONTRIBUTOR","body":"@erikdubbelboer has added a patch for GCS support, currently Azure/Cassandra/Cloudfiles do not have implementations","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/384788314/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/384803038","html_url":"https://github.com/apache/druid/pull/5692#issuecomment-384803038","issue_url":"https://api.github.com/repos/apache/druid/issues/5692","id":384803038,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDgwMzAzOA==","user":{"login":"dclim","id":11050882,"node_id":"MDQ6VXNlcjExMDUwODgy","avatar_url":"https://avatars.githubusercontent.com/u/11050882?v=4","gravatar_id":"","url":"https://api.github.com/users/dclim","html_url":"https://github.com/dclim","followers_url":"https://api.github.com/users/dclim/followers","following_url":"https://api.github.com/users/dclim/following{/other_user}","gists_url":"https://api.github.com/users/dclim/gists{/gist_id}","starred_url":"https://api.github.com/users/dclim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dclim/subscriptions","organizations_url":"https://api.github.com/users/dclim/orgs","repos_url":"https://api.github.com/users/dclim/repos","events_url":"https://api.github.com/users/dclim/events{/privacy}","received_events_url":"https://api.github.com/users/dclim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-26T22:03:29Z","updated_at":"2018-04-26T22:03:29Z","author_association":"CONTRIBUTOR","body":"@b-slim right now, it would involve some scripting, something like: list out the segment directory and find any partition directories that have more than one child directory, and then compare these directory names to the druid_segments table and delete any directory that isn't referenced in the loadSpec of an entry in that table. You'd probably also want to check timestamps and only process dangling segments from sometime in the past so you don't inadvertently wipe segments that are pushed but not published.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/384803038/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/384822872","html_url":"https://github.com/apache/druid/pull/5692#issuecomment-384822872","issue_url":"https://api.github.com/repos/apache/druid/issues/5692","id":384822872,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDgyMjg3Mg==","user":{"login":"b-slim","id":7376396,"node_id":"MDQ6VXNlcjczNzYzOTY=","avatar_url":"https://avatars.githubusercontent.com/u/7376396?v=4","gravatar_id":"","url":"https://api.github.com/users/b-slim","html_url":"https://github.com/b-slim","followers_url":"https://api.github.com/users/b-slim/followers","following_url":"https://api.github.com/users/b-slim/following{/other_user}","gists_url":"https://api.github.com/users/b-slim/gists{/gist_id}","starred_url":"https://api.github.com/users/b-slim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/b-slim/subscriptions","organizations_url":"https://api.github.com/users/b-slim/orgs","repos_url":"https://api.github.com/users/b-slim/repos","events_url":"https://api.github.com/users/b-slim/events{/privacy}","received_events_url":"https://api.github.com/users/b-slim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-26T23:55:10Z","updated_at":"2018-04-26T23:55:10Z","author_association":"CONTRIBUTOR","body":"@dclim this seems pretty complicated to me, so imagine user whom just adopted Druid.\r\nIMO we need to fix this by doing this work you have described as a cron task running at supervisor to cleanup stuff after aborted transaction. I don't have to much knowledge about the design/fix here but i think this should be something like task runner that get a transaction ID that we can use to track aborted transactions and clean the leaked segments. I don't think putting the burden on the user is fair.    ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/384822872/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/384832142","html_url":"https://github.com/apache/druid/pull/5692#issuecomment-384832142","issue_url":"https://api.github.com/repos/apache/druid/issues/5692","id":384832142,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDgzMjE0Mg==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-27T00:58:59Z","updated_at":"2018-04-27T00:58:59Z","author_association":"CONTRIBUTOR","body":"@b-slim @dclim how about making one change in this patch: kill segments in the \"Our segments really do exist, awaiting handoff\" path. Then, tasks will clean up after themselves, and the only way 'loose' segments would be lying around is if tasks die before they can clean up. And this can already lead to loose segments even today (if a segment is pushed but not published, it stays in deep storage forever). So it'd be just as good as what we have today. ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/384832142/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/384835363","html_url":"https://github.com/apache/druid/pull/5692#issuecomment-384835363","issue_url":"https://api.github.com/repos/apache/druid/issues/5692","id":384835363,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDgzNTM2Mw==","user":{"login":"b-slim","id":7376396,"node_id":"MDQ6VXNlcjczNzYzOTY=","avatar_url":"https://avatars.githubusercontent.com/u/7376396?v=4","gravatar_id":"","url":"https://api.github.com/users/b-slim","html_url":"https://github.com/b-slim","followers_url":"https://api.github.com/users/b-slim/followers","following_url":"https://api.github.com/users/b-slim/following{/other_user}","gists_url":"https://api.github.com/users/b-slim/gists{/gist_id}","starred_url":"https://api.github.com/users/b-slim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/b-slim/subscriptions","organizations_url":"https://api.github.com/users/b-slim/orgs","repos_url":"https://api.github.com/users/b-slim/repos","events_url":"https://api.github.com/users/b-slim/events{/privacy}","received_events_url":"https://api.github.com/users/b-slim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-27T01:22:19Z","updated_at":"2018-04-27T01:22:19Z","author_association":"CONTRIBUTOR","body":"@dclim and @gianm am not asking this as part of this patch, but is it possible to have a persisted  pointer (maybe as part of segments allocations table) this pointer can be path to a directory  based on transaction id that can be used to track the committed/aborted handoffs and clean any aborted segments afterward even if the task dies before cleaning after it self?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/384835363/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/384844462","html_url":"https://github.com/apache/druid/pull/5706#issuecomment-384844462","issue_url":"https://api.github.com/repos/apache/druid/issues/5706","id":384844462,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDg0NDQ2Mg==","user":{"login":"b-slim","id":7376396,"node_id":"MDQ6VXNlcjczNzYzOTY=","avatar_url":"https://avatars.githubusercontent.com/u/7376396?v=4","gravatar_id":"","url":"https://api.github.com/users/b-slim","html_url":"https://github.com/b-slim","followers_url":"https://api.github.com/users/b-slim/followers","following_url":"https://api.github.com/users/b-slim/following{/other_user}","gists_url":"https://api.github.com/users/b-slim/gists{/gist_id}","starred_url":"https://api.github.com/users/b-slim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/b-slim/subscriptions","organizations_url":"https://api.github.com/users/b-slim/orgs","repos_url":"https://api.github.com/users/b-slim/repos","events_url":"https://api.github.com/users/b-slim/events{/privacy}","received_events_url":"https://api.github.com/users/b-slim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-27T02:23:46Z","updated_at":"2018-04-27T02:23:46Z","author_association":"CONTRIBUTOR","body":"@jon-wei thanks please checkout this new version.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/384844462/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/384859977","html_url":"https://github.com/apache/druid/issues/5709#issuecomment-384859977","issue_url":"https://api.github.com/repos/apache/druid/issues/5709","id":384859977,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDg1OTk3Nw==","user":{"login":"b-slim","id":7376396,"node_id":"MDQ6VXNlcjczNzYzOTY=","avatar_url":"https://avatars.githubusercontent.com/u/7376396?v=4","gravatar_id":"","url":"https://api.github.com/users/b-slim","html_url":"https://github.com/b-slim","followers_url":"https://api.github.com/users/b-slim/followers","following_url":"https://api.github.com/users/b-slim/following{/other_user}","gists_url":"https://api.github.com/users/b-slim/gists{/gist_id}","starred_url":"https://api.github.com/users/b-slim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/b-slim/subscriptions","organizations_url":"https://api.github.com/users/b-slim/orgs","repos_url":"https://api.github.com/users/b-slim/repos","events_url":"https://api.github.com/users/b-slim/events{/privacy}","received_events_url":"https://api.github.com/users/b-slim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-27T04:23:05Z","updated_at":"2018-04-27T04:23:05Z","author_association":"CONTRIBUTOR","body":"I think with 2 we can add a Health check procedures let say a simple periodic/on-demand  dry run query that does simple scans on the data and that can detects if there is a flaky node and either alert/blacklist/alltheabove...","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/384859977/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/384874233","html_url":"https://github.com/apache/druid/pull/5692#issuecomment-384874233","issue_url":"https://api.github.com/repos/apache/druid/issues/5692","id":384874233,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDg3NDIzMw==","user":{"login":"dclim","id":11050882,"node_id":"MDQ6VXNlcjExMDUwODgy","avatar_url":"https://avatars.githubusercontent.com/u/11050882?v=4","gravatar_id":"","url":"https://api.github.com/users/dclim","html_url":"https://github.com/dclim","followers_url":"https://api.github.com/users/dclim/followers","following_url":"https://api.github.com/users/dclim/following{/other_user}","gists_url":"https://api.github.com/users/dclim/gists{/gist_id}","starred_url":"https://api.github.com/users/dclim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dclim/subscriptions","organizations_url":"https://api.github.com/users/dclim/orgs","repos_url":"https://api.github.com/users/dclim/repos","events_url":"https://api.github.com/users/dclim/events{/privacy}","received_events_url":"https://api.github.com/users/dclim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-27T06:10:40Z","updated_at":"2018-04-27T06:10:40Z","author_association":"CONTRIBUTOR","body":"@gianm changes made, thanks for the review guys. Good catch on killing segments at \"Our segments really do exist, awaiting handoff\", I meant to do that but missed it and only caught the exception case.\r\n\r\n@b-slim that seems reasonable to me; I think it makes sense though to wait and see if anyone complains about this; I think the cases that it will leave garbage are actually quite small, and not much higher than the current implementation where tasks overwrite each other's segments.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/384874233/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/384982174","html_url":"https://github.com/apache/druid/pull/5597#issuecomment-384982174","issue_url":"https://api.github.com/repos/apache/druid/issues/5597","id":384982174,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDk4MjE3NA==","user":{"login":"scrawfor","id":7061689,"node_id":"MDQ6VXNlcjcwNjE2ODk=","avatar_url":"https://avatars.githubusercontent.com/u/7061689?v=4","gravatar_id":"","url":"https://api.github.com/users/scrawfor","html_url":"https://github.com/scrawfor","followers_url":"https://api.github.com/users/scrawfor/followers","following_url":"https://api.github.com/users/scrawfor/following{/other_user}","gists_url":"https://api.github.com/users/scrawfor/gists{/gist_id}","starred_url":"https://api.github.com/users/scrawfor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/scrawfor/subscriptions","organizations_url":"https://api.github.com/users/scrawfor/orgs","repos_url":"https://api.github.com/users/scrawfor/repos","events_url":"https://api.github.com/users/scrawfor/events{/privacy}","received_events_url":"https://api.github.com/users/scrawfor/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-27T14:12:06Z","updated_at":"2018-04-27T14:12:06Z","author_association":"CONTRIBUTOR","body":"I've been running this in my cluster for a week or so, and just found a bug.  If you change the type of a filter  to `noop` inside of an `and` filter a NPE is thrown.\r\n\r\n`\"filter\": {\r\n    \"type\": \"and\",\r\n    \"fields\": [{\r\n      \"type\": \"selector\",\r\n      \"dimension\": \"my_dimension\",\r\n      \"value\": \"some_value\"\r\n    }, \r\n   {\"type\": \"noop\"}]\r\n  },`\r\n\r\nthrows \r\n\r\n`java.lang.NullPointerException\r\n        at com.google.common.base.Preconditions.checkNotNull(Preconditions.java:213) ~[guava-16.0.1.jar:?]\r\n        at com.google.common.collect.ImmutableCollection$ArrayBasedBuilder.add(ImmutableCollection.java:339) ~[guava-16.0.1.jar:?]\r\n        at com.google.common.collect.ImmutableList$Builder.add(ImmutableList.java:652) ~[guava-16.0.1.jar:?]\r\n        at com.google.common.collect.ImmutableList$Builder.add(ImmutableList.java:630) ~[guava-16.0.1.jar:?]\r\n        at com.google.common.collect.ImmutableCollection$Builder.addAll(ImmutableCollection.java:301) ~[guava-16.0.1.jar:?]\r\n        at com.google.common.collect.ImmutableList$Builder.addAll(ImmutableList.java:691) ~[guava-16.0.1.jar:?]\r\n        at com.google.common.collect.ImmutableList.copyOf(ImmutableList.java:275) ~[guava-16.0.1.jar:?]\r\n        at com.google.common.collect.ImmutableList.copyOf(ImmutableList.java:226) ~[guava-16.0.1.jar:?]\r\n        at io.druid.segment.filter.Filters.toFilters(Filters.java:84) ~[druid-processing-0.11.0.jar:0.11.0]\r\n        at io.druid.query.filter.AndDimFilter.toFilter(AndDimFilter.java:75) ~[druid-processing-0.11.0.jar:0.11.0]\r\n        at io.druid.segment.filter.Filters.toFilter(Filters.java:109) ~[druid-processing-0.11.0.jar:0.11.0]\r\n`\r\n\r\nVery unfamiliar with the project still, but to me the appropriate solution would be to remove any noop filters instead of trying to actually convert it to a filter.  But I wanted to open it up and see if you guys had any input.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/384982174/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/384996232","html_url":"https://github.com/apache/druid/pull/5597#issuecomment-384996232","issue_url":"https://api.github.com/repos/apache/druid/issues/5597","id":384996232,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDk5NjIzMg==","user":{"login":"b-slim","id":7376396,"node_id":"MDQ6VXNlcjczNzYzOTY=","avatar_url":"https://avatars.githubusercontent.com/u/7376396?v=4","gravatar_id":"","url":"https://api.github.com/users/b-slim","html_url":"https://github.com/b-slim","followers_url":"https://api.github.com/users/b-slim/followers","following_url":"https://api.github.com/users/b-slim/following{/other_user}","gists_url":"https://api.github.com/users/b-slim/gists{/gist_id}","starred_url":"https://api.github.com/users/b-slim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/b-slim/subscriptions","organizations_url":"https://api.github.com/users/b-slim/orgs","repos_url":"https://api.github.com/users/b-slim/repos","events_url":"https://api.github.com/users/b-slim/events{/privacy}","received_events_url":"https://api.github.com/users/b-slim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-27T14:58:37Z","updated_at":"2018-04-27T14:58:37Z","author_association":"CONTRIBUTOR","body":"@scrawfor IMO this noop filter is no sense i think what you are asking for is `true` filter that matchs everything and maybe `false` opposite of true.  How about adding a filter of type `true` instead of exposing noop ?\r\n","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/384996232/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385051392","html_url":"https://github.com/apache/druid/pull/5597#issuecomment-385051392","issue_url":"https://api.github.com/repos/apache/druid/issues/5597","id":385051392,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTA1MTM5Mg==","user":{"login":"scrawfor","id":7061689,"node_id":"MDQ6VXNlcjcwNjE2ODk=","avatar_url":"https://avatars.githubusercontent.com/u/7061689?v=4","gravatar_id":"","url":"https://api.github.com/users/scrawfor","html_url":"https://github.com/scrawfor","followers_url":"https://api.github.com/users/scrawfor/followers","following_url":"https://api.github.com/users/scrawfor/following{/other_user}","gists_url":"https://api.github.com/users/scrawfor/gists{/gist_id}","starred_url":"https://api.github.com/users/scrawfor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/scrawfor/subscriptions","organizations_url":"https://api.github.com/users/scrawfor/orgs","repos_url":"https://api.github.com/users/scrawfor/repos","events_url":"https://api.github.com/users/scrawfor/events{/privacy}","received_events_url":"https://api.github.com/users/scrawfor/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-27T18:13:04Z","updated_at":"2018-04-27T18:13:04Z","author_association":"CONTRIBUTOR","body":"I'm fine with that.  It does better represent what we are actually doing. I only went with the noop because it already existed\r\n\r\nTake a look and let me know if this is more like what you're thinking.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385051392/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385056020","html_url":"https://github.com/apache/druid/pull/5597#issuecomment-385056020","issue_url":"https://api.github.com/repos/apache/druid/issues/5597","id":385056020,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTA1NjAyMA==","user":{"login":"b-slim","id":7376396,"node_id":"MDQ6VXNlcjczNzYzOTY=","avatar_url":"https://avatars.githubusercontent.com/u/7376396?v=4","gravatar_id":"","url":"https://api.github.com/users/b-slim","html_url":"https://github.com/b-slim","followers_url":"https://api.github.com/users/b-slim/followers","following_url":"https://api.github.com/users/b-slim/following{/other_user}","gists_url":"https://api.github.com/users/b-slim/gists{/gist_id}","starred_url":"https://api.github.com/users/b-slim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/b-slim/subscriptions","organizations_url":"https://api.github.com/users/b-slim/orgs","repos_url":"https://api.github.com/users/b-slim/repos","events_url":"https://api.github.com/users/b-slim/events{/privacy}","received_events_url":"https://api.github.com/users/b-slim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-27T18:30:08Z","updated_at":"2018-04-27T18:30:08Z","author_association":"CONTRIBUTOR","body":"> Take a look and let me know if this is more like what you're thinking.\r\n\r\n@scrawfor where ?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385056020/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385060953","html_url":"https://github.com/apache/druid/pull/5597#issuecomment-385060953","issue_url":"https://api.github.com/repos/apache/druid/issues/5597","id":385060953,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTA2MDk1Mw==","user":{"login":"scrawfor","id":7061689,"node_id":"MDQ6VXNlcjcwNjE2ODk=","avatar_url":"https://avatars.githubusercontent.com/u/7061689?v=4","gravatar_id":"","url":"https://api.github.com/users/scrawfor","html_url":"https://github.com/scrawfor","followers_url":"https://api.github.com/users/scrawfor/followers","following_url":"https://api.github.com/users/scrawfor/following{/other_user}","gists_url":"https://api.github.com/users/scrawfor/gists{/gist_id}","starred_url":"https://api.github.com/users/scrawfor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/scrawfor/subscriptions","organizations_url":"https://api.github.com/users/scrawfor/orgs","repos_url":"https://api.github.com/users/scrawfor/repos","events_url":"https://api.github.com/users/scrawfor/events{/privacy}","received_events_url":"https://api.github.com/users/scrawfor/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-27T18:48:53Z","updated_at":"2018-04-27T18:48:53Z","author_association":"CONTRIBUTOR","body":"My bad. Wan't thinking that this wouldn't be updated.  I created a new PR #5711","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385060953/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385065929","html_url":"https://github.com/apache/druid/pull/5701#issuecomment-385065929","issue_url":"https://api.github.com/repos/apache/druid/issues/5701","id":385065929,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTA2NTkyOQ==","user":{"login":"b-slim","id":7376396,"node_id":"MDQ6VXNlcjczNzYzOTY=","avatar_url":"https://avatars.githubusercontent.com/u/7376396?v=4","gravatar_id":"","url":"https://api.github.com/users/b-slim","html_url":"https://github.com/b-slim","followers_url":"https://api.github.com/users/b-slim/followers","following_url":"https://api.github.com/users/b-slim/following{/other_user}","gists_url":"https://api.github.com/users/b-slim/gists{/gist_id}","starred_url":"https://api.github.com/users/b-slim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/b-slim/subscriptions","organizations_url":"https://api.github.com/users/b-slim/orgs","repos_url":"https://api.github.com/users/b-slim/repos","events_url":"https://api.github.com/users/b-slim/events{/privacy}","received_events_url":"https://api.github.com/users/b-slim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-27T19:07:15Z","updated_at":"2018-04-27T19:07:15Z","author_association":"CONTRIBUTOR","body":"@varaga is it possible to unit test this with good/bad passwords ?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385065929/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385066509","html_url":"https://github.com/apache/druid/pull/5695#issuecomment-385066509","issue_url":"https://api.github.com/repos/apache/druid/issues/5695","id":385066509,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTA2NjUwOQ==","user":{"login":"b-slim","id":7376396,"node_id":"MDQ6VXNlcjczNzYzOTY=","avatar_url":"https://avatars.githubusercontent.com/u/7376396?v=4","gravatar_id":"","url":"https://api.github.com/users/b-slim","html_url":"https://github.com/b-slim","followers_url":"https://api.github.com/users/b-slim/followers","following_url":"https://api.github.com/users/b-slim/following{/other_user}","gists_url":"https://api.github.com/users/b-slim/gists{/gist_id}","starred_url":"https://api.github.com/users/b-slim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/b-slim/subscriptions","organizations_url":"https://api.github.com/users/b-slim/orgs","repos_url":"https://api.github.com/users/b-slim/repos","events_url":"https://api.github.com/users/b-slim/events{/privacy}","received_events_url":"https://api.github.com/users/b-slim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-27T19:09:49Z","updated_at":"2018-04-27T19:09:49Z","author_association":"CONTRIBUTOR","body":"@Caroline1000 can you please fill up CLA http://druid.io/community/cla.html","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385066509/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385104121","html_url":"https://github.com/apache/druid/pull/5674#issuecomment-385104121","issue_url":"https://api.github.com/repos/apache/druid/issues/5674","id":385104121,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTEwNDEyMQ==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-27T21:55:51Z","updated_at":"2018-04-27T21:55:51Z","author_association":"CONTRIBUTOR","body":"> Also stumbled over this issue. The problem is that KafkaIndexTaskTest uses offsets which are not yet available, not yet sent to broker. And it seems that new version of kafka client can't handle this situation. It throws OffsetOutOfRangeException but doesn't remove last fetche response. So next time it reuse last response and throws the same exception. Here is kafka client code responsible.\r\n\r\nHmm, this is a bummer. Do we ever do this in production (seek to offsets that are after the latest offsets available at the broker)? If not, then I think we should just adjust the tests to stop doing that. But if we do, we need to think harder about what the most appropriate fix is.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385104121/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385124030","html_url":"https://github.com/apache/druid/pull/5692#issuecomment-385124030","issue_url":"https://api.github.com/repos/apache/druid/issues/5692","id":385124030,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTEyNDAzMA==","user":{"login":"dclim","id":11050882,"node_id":"MDQ6VXNlcjExMDUwODgy","avatar_url":"https://avatars.githubusercontent.com/u/11050882?v=4","gravatar_id":"","url":"https://api.github.com/users/dclim","html_url":"https://github.com/dclim","followers_url":"https://api.github.com/users/dclim/followers","following_url":"https://api.github.com/users/dclim/following{/other_user}","gists_url":"https://api.github.com/users/dclim/gists{/gist_id}","starred_url":"https://api.github.com/users/dclim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dclim/subscriptions","organizations_url":"https://api.github.com/users/dclim/orgs","repos_url":"https://api.github.com/users/dclim/repos","events_url":"https://api.github.com/users/dclim/events{/privacy}","received_events_url":"https://api.github.com/users/dclim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-28T00:18:48Z","updated_at":"2018-04-28T00:18:48Z","author_association":"CONTRIBUTOR","body":"@gianm added docs; also refactored common Finder code into a `BaseDataSegmentFinder`","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385124030/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385124829","html_url":"https://github.com/apache/druid/pull/5692#issuecomment-385124829","issue_url":"https://api.github.com/repos/apache/druid/issues/5692","id":385124829,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTEyNDgyOQ==","user":{"login":"b-slim","id":7376396,"node_id":"MDQ6VXNlcjczNzYzOTY=","avatar_url":"https://avatars.githubusercontent.com/u/7376396?v=4","gravatar_id":"","url":"https://api.github.com/users/b-slim","html_url":"https://github.com/b-slim","followers_url":"https://api.github.com/users/b-slim/followers","following_url":"https://api.github.com/users/b-slim/following{/other_user}","gists_url":"https://api.github.com/users/b-slim/gists{/gist_id}","starred_url":"https://api.github.com/users/b-slim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/b-slim/subscriptions","organizations_url":"https://api.github.com/users/b-slim/orgs","repos_url":"https://api.github.com/users/b-slim/repos","events_url":"https://api.github.com/users/b-slim/events{/privacy}","received_events_url":"https://api.github.com/users/b-slim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-28T00:27:37Z","updated_at":"2018-04-28T00:27:37Z","author_association":"CONTRIBUTOR","body":"@dclim can you please add a short section about when the leak can occur and how to find leaked segments? Thanks","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385124829/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385125127","html_url":"https://github.com/apache/druid/pull/5335#issuecomment-385125127","issue_url":"https://api.github.com/repos/apache/druid/issues/5335","id":385125127,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTEyNTEyNw==","user":{"login":"fjy","id":428325,"node_id":"MDQ6VXNlcjQyODMyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/428325?v=4","gravatar_id":"","url":"https://api.github.com/users/fjy","html_url":"https://github.com/fjy","followers_url":"https://api.github.com/users/fjy/followers","following_url":"https://api.github.com/users/fjy/following{/other_user}","gists_url":"https://api.github.com/users/fjy/gists{/gist_id}","starred_url":"https://api.github.com/users/fjy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fjy/subscriptions","organizations_url":"https://api.github.com/users/fjy/orgs","repos_url":"https://api.github.com/users/fjy/repos","events_url":"https://api.github.com/users/fjy/events{/privacy}","received_events_url":"https://api.github.com/users/fjy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-28T00:30:45Z","updated_at":"2018-04-28T00:30:45Z","author_association":"CONTRIBUTOR","body":" ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385125127/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385127583","html_url":"https://github.com/apache/druid/pull/5692#issuecomment-385127583","issue_url":"https://api.github.com/repos/apache/druid/issues/5692","id":385127583,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTEyNzU4Mw==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-28T01:00:13Z","updated_at":"2018-04-28T01:00:13Z","author_association":"CONTRIBUTOR","body":"@b-slim,\r\n\r\n> @dclim can you please add a short section about when the leak can occur and how to find leaked segments? Thanks\r\n\r\nWhere were you thinking about adding that? In the kafka indexing service docs?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385127583/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385128305","html_url":"https://github.com/apache/druid/pull/5692#issuecomment-385128305","issue_url":"https://api.github.com/repos/apache/druid/issues/5692","id":385128305,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTEyODMwNQ==","user":{"login":"b-slim","id":7376396,"node_id":"MDQ6VXNlcjczNzYzOTY=","avatar_url":"https://avatars.githubusercontent.com/u/7376396?v=4","gravatar_id":"","url":"https://api.github.com/users/b-slim","html_url":"https://github.com/b-slim","followers_url":"https://api.github.com/users/b-slim/followers","following_url":"https://api.github.com/users/b-slim/following{/other_user}","gists_url":"https://api.github.com/users/b-slim/gists{/gist_id}","starred_url":"https://api.github.com/users/b-slim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/b-slim/subscriptions","organizations_url":"https://api.github.com/users/b-slim/orgs","repos_url":"https://api.github.com/users/b-slim/repos","events_url":"https://api.github.com/users/b-slim/events{/privacy}","received_events_url":"https://api.github.com/users/b-slim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-28T01:10:19Z","updated_at":"2018-04-28T01:10:19Z","author_association":"CONTRIBUTOR","body":"@gianm since it is a Kafka indexing issue i think we can added to the new Kafka ingestion page maybe as `Misc section` or `Operation section` for me the goal is more to document this i guess even a github issue can be enough if you don't like the idea of section within documentation.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385128305/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385129168","html_url":"https://github.com/apache/druid/pull/5692#issuecomment-385129168","issue_url":"https://api.github.com/repos/apache/druid/issues/5692","id":385129168,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTEyOTE2OA==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-28T01:22:31Z","updated_at":"2018-04-28T01:22:31Z","author_association":"CONTRIBUTOR","body":"I'm ok with a section in the docs, just wondering what you were thinking. If we add one I don't think it needs to be too alarmist, because with the cleanup-after-nonpublishing feature in this patch, there shouldn't be too many unused segment files lying around. Probably not more than already existed with Kafka indexing.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385129168/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385134967","html_url":"https://github.com/apache/druid/pull/5692#issuecomment-385134967","issue_url":"https://api.github.com/repos/apache/druid/issues/5692","id":385134967,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTEzNDk2Nw==","user":{"login":"b-slim","id":7376396,"node_id":"MDQ6VXNlcjczNzYzOTY=","avatar_url":"https://avatars.githubusercontent.com/u/7376396?v=4","gravatar_id":"","url":"https://api.github.com/users/b-slim","html_url":"https://github.com/b-slim","followers_url":"https://api.github.com/users/b-slim/followers","following_url":"https://api.github.com/users/b-slim/following{/other_user}","gists_url":"https://api.github.com/users/b-slim/gists{/gist_id}","starred_url":"https://api.github.com/users/b-slim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/b-slim/subscriptions","organizations_url":"https://api.github.com/users/b-slim/orgs","repos_url":"https://api.github.com/users/b-slim/repos","events_url":"https://api.github.com/users/b-slim/events{/privacy}","received_events_url":"https://api.github.com/users/b-slim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-28T02:58:45Z","updated_at":"2018-04-28T02:58:45Z","author_association":"CONTRIBUTOR","body":"@gianm yeah, as i said it is to help ppls operating the cluster/help me to know where to dig without reading the code base and maybe good to have it as issue that someone can tack if they want to.\r\nThanks","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385134967/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385136384","html_url":"https://github.com/apache/druid/issues/5666#issuecomment-385136384","issue_url":"https://api.github.com/repos/apache/druid/issues/5666","id":385136384,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTEzNjM4NA==","user":{"login":"jon-wei","id":8729063,"node_id":"MDQ6VXNlcjg3MjkwNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8729063?v=4","gravatar_id":"","url":"https://api.github.com/users/jon-wei","html_url":"https://github.com/jon-wei","followers_url":"https://api.github.com/users/jon-wei/followers","following_url":"https://api.github.com/users/jon-wei/following{/other_user}","gists_url":"https://api.github.com/users/jon-wei/gists{/gist_id}","starred_url":"https://api.github.com/users/jon-wei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jon-wei/subscriptions","organizations_url":"https://api.github.com/users/jon-wei/orgs","repos_url":"https://api.github.com/users/jon-wei/repos","events_url":"https://api.github.com/users/jon-wei/events{/privacy}","received_events_url":"https://api.github.com/users/jon-wei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-28T03:26:46Z","updated_at":"2018-04-28T03:26:46Z","author_association":"CONTRIBUTOR","body":"Going to merge this with issue #5656, I think these are the same issue","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385136384/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385136549","html_url":"https://github.com/apache/druid/issues/5656#issuecomment-385136549","issue_url":"https://api.github.com/repos/apache/druid/issues/5656","id":385136549,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTEzNjU0OQ==","user":{"login":"jon-wei","id":8729063,"node_id":"MDQ6VXNlcjg3MjkwNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8729063?v=4","gravatar_id":"","url":"https://api.github.com/users/jon-wei","html_url":"https://github.com/jon-wei","followers_url":"https://api.github.com/users/jon-wei/followers","following_url":"https://api.github.com/users/jon-wei/following{/other_user}","gists_url":"https://api.github.com/users/jon-wei/gists{/gist_id}","starred_url":"https://api.github.com/users/jon-wei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jon-wei/subscriptions","organizations_url":"https://api.github.com/users/jon-wei/orgs","repos_url":"https://api.github.com/users/jon-wei/repos","events_url":"https://api.github.com/users/jon-wei/events{/privacy}","received_events_url":"https://api.github.com/users/jon-wei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-28T03:30:05Z","updated_at":"2018-04-28T03:30:05Z","author_association":"CONTRIBUTOR","body":"This issue was also reported here: https://github.com/druid-io/druid/issues/5666\r\n\r\nThis thread on the druid-user mailing list also seems to describe the same or a similar issue:\r\n- https://groups.google.com/forum/?utm_medium=email&utm_source=footer#!msg/druid-user/3v38kko5bss/x4vze-RlBwAJ (In the attached log, the KafkaIndexTask also ends with the line `2018-04-13T17:58:17,790 INFO [task-runner-0-priority-0] io.druid.indexing.kafka.KafkaIndexTask - Pausing ingestion until resumed`, but this task seems to have ingested some data)","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385136549/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385141610","html_url":"https://github.com/apache/druid/pull/5692#issuecomment-385141610","issue_url":"https://api.github.com/repos/apache/druid/issues/5692","id":385141610,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTE0MTYxMA==","user":{"login":"dclim","id":11050882,"node_id":"MDQ6VXNlcjExMDUwODgy","avatar_url":"https://avatars.githubusercontent.com/u/11050882?v=4","gravatar_id":"","url":"https://api.github.com/users/dclim","html_url":"https://github.com/dclim","followers_url":"https://api.github.com/users/dclim/followers","following_url":"https://api.github.com/users/dclim/following{/other_user}","gists_url":"https://api.github.com/users/dclim/gists{/gist_id}","starred_url":"https://api.github.com/users/dclim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dclim/subscriptions","organizations_url":"https://api.github.com/users/dclim/orgs","repos_url":"https://api.github.com/users/dclim/repos","events_url":"https://api.github.com/users/dclim/events{/privacy}","received_events_url":"https://api.github.com/users/dclim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-28T05:20:25Z","updated_at":"2018-04-28T05:20:25Z","author_association":"CONTRIBUTOR","body":"@gianm I agree with the base class making things more convoluted and refactored it; please check the last commit again when you get a chance","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385141610/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385142828","html_url":"https://github.com/apache/druid/pull/5692#issuecomment-385142828","issue_url":"https://api.github.com/repos/apache/druid/issues/5692","id":385142828,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTE0MjgyOA==","user":{"login":"dclim","id":11050882,"node_id":"MDQ6VXNlcjExMDUwODgy","avatar_url":"https://avatars.githubusercontent.com/u/11050882?v=4","gravatar_id":"","url":"https://api.github.com/users/dclim","html_url":"https://github.com/dclim","followers_url":"https://api.github.com/users/dclim/followers","following_url":"https://api.github.com/users/dclim/following{/other_user}","gists_url":"https://api.github.com/users/dclim/gists{/gist_id}","starred_url":"https://api.github.com/users/dclim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dclim/subscriptions","organizations_url":"https://api.github.com/users/dclim/orgs","repos_url":"https://api.github.com/users/dclim/repos","events_url":"https://api.github.com/users/dclim/events{/privacy}","received_events_url":"https://api.github.com/users/dclim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-28T05:43:46Z","updated_at":"2018-04-28T05:43:46Z","author_association":"CONTRIBUTOR","body":"@gianm @b-slim I took another look through the code, and with the change Gian suggested to remove segments if we discover someone already published it before us, I can't find any real scenario in which garbage would be left behind, other than if there are bugs in Druid's code, such as these sanity checks tripping in `AppenderatorImpl.mergeAndPush()`:\r\n```\r\n    // Sanity checks\r\n    for (FireHydrant hydrant : sink) {\r\n      if (sink.isWritable()) {\r\n        throw new ISE(\"WTF?! Expected sink to be no longer writable before mergeAndPush. Segment[%s].\", identifier);\r\n      }\r\n\r\n      synchronized (hydrant) {\r\n        if (!hydrant.hasSwapped()) {\r\n          throw new ISE(\"WTF?! Expected sink to be fully persisted before mergeAndPush. Segment[%s].\", identifier);\r\n        }\r\n      }\r\n    }\r\n```\r\n\r\nIn these cases, if an exception was thrown after some segments had already been pushed, those segments would be orphaned. \r\n\r\nBut - my point here is that this is not something related at all to the `useUniquePath` functionality, nor is it something related to Kafka indexing exclusively. This is something that was always in Druid indexing and happens with every type of ingestion, where a sanity check failure due to broken Druid logic that causes the task to end prematurely does not clean up already pushed segments.\r\n\r\nAfter looking at it more closely, I'm leaning towards the opinion that it would actually cause more harm than good to explicitly call it out in documentation since it would scare people unnecessarily. Folks who view this as a major issue should already have been running periodic consistency checks comparing deep storage to the metadata storage.\r\n\r\nI think it might be interesting to write a tool, sorta like a 'druid-fsck', that can validate the consistency of the deep storage and clean up orphans, but that would be for another time.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385142828/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385151256","html_url":"https://github.com/apache/druid/pull/5556#issuecomment-385151256","issue_url":"https://api.github.com/repos/apache/druid/issues/5556","id":385151256,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTE1MTI1Ng==","user":{"login":"zhangxinyu1","id":12528894,"node_id":"MDQ6VXNlcjEyNTI4ODk0","avatar_url":"https://avatars.githubusercontent.com/u/12528894?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangxinyu1","html_url":"https://github.com/zhangxinyu1","followers_url":"https://api.github.com/users/zhangxinyu1/followers","following_url":"https://api.github.com/users/zhangxinyu1/following{/other_user}","gists_url":"https://api.github.com/users/zhangxinyu1/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangxinyu1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangxinyu1/subscriptions","organizations_url":"https://api.github.com/users/zhangxinyu1/orgs","repos_url":"https://api.github.com/users/zhangxinyu1/repos","events_url":"https://api.github.com/users/zhangxinyu1/events{/privacy}","received_events_url":"https://api.github.com/users/zhangxinyu1/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-28T08:06:29Z","updated_at":"2018-04-28T08:11:15Z","author_association":"CONTRIBUTOR","body":"@jihoonson \r\n>>Also please add some documentation. I would love to test this in my cluster!\r\n\r\nThe rough documentation about how to use this feature is at the front of this pr. Should I add some documentation to `docs`?\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385151256/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385187413","html_url":"https://github.com/apache/druid/pull/5694#issuecomment-385187413","issue_url":"https://api.github.com/repos/apache/druid/issues/5694","id":385187413,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTE4NzQxMw==","user":{"login":"kaijianding","id":8663725,"node_id":"MDQ6VXNlcjg2NjM3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/8663725?v=4","gravatar_id":"","url":"https://api.github.com/users/kaijianding","html_url":"https://github.com/kaijianding","followers_url":"https://api.github.com/users/kaijianding/followers","following_url":"https://api.github.com/users/kaijianding/following{/other_user}","gists_url":"https://api.github.com/users/kaijianding/gists{/gist_id}","starred_url":"https://api.github.com/users/kaijianding/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaijianding/subscriptions","organizations_url":"https://api.github.com/users/kaijianding/orgs","repos_url":"https://api.github.com/users/kaijianding/repos","events_url":"https://api.github.com/users/kaijianding/events{/privacy}","received_events_url":"https://api.github.com/users/kaijianding/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-28T16:15:32Z","updated_at":"2018-04-28T16:15:32Z","author_association":"CONTRIBUTOR","body":"my mis-understanding. it is different with what happens in #3943 now, close this PR.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385187413/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385193039","html_url":"https://github.com/apache/druid/issues/5713#issuecomment-385193039","issue_url":"https://api.github.com/repos/apache/druid/issues/5713","id":385193039,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTE5MzAzOQ==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-28T17:36:35Z","updated_at":"2018-04-28T17:36:35Z","author_association":"CONTRIBUTOR","body":"I didn't think there was any grace period beyond the one implied by `replicationThrottleLimit`.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385193039/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385226810","html_url":"https://github.com/apache/druid/pull/5714#issuecomment-385226810","issue_url":"https://api.github.com/repos/apache/druid/issues/5714","id":385226810,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTIyNjgxMA==","user":{"login":"dclim","id":11050882,"node_id":"MDQ6VXNlcjExMDUwODgy","avatar_url":"https://avatars.githubusercontent.com/u/11050882?v=4","gravatar_id":"","url":"https://api.github.com/users/dclim","html_url":"https://github.com/dclim","followers_url":"https://api.github.com/users/dclim/followers","following_url":"https://api.github.com/users/dclim/following{/other_user}","gists_url":"https://api.github.com/users/dclim/gists{/gist_id}","starred_url":"https://api.github.com/users/dclim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dclim/subscriptions","organizations_url":"https://api.github.com/users/dclim/orgs","repos_url":"https://api.github.com/users/dclim/repos","events_url":"https://api.github.com/users/dclim/events{/privacy}","received_events_url":"https://api.github.com/users/dclim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-29T05:17:54Z","updated_at":"2018-04-29T05:17:54Z","author_association":"CONTRIBUTOR","body":" after travis and minor doc typo","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385226810/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385247949","html_url":"https://github.com/apache/druid/issues/5669#issuecomment-385247949","issue_url":"https://api.github.com/repos/apache/druid/issues/5669","id":385247949,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTI0Nzk0OQ==","user":{"login":"leventov","id":609240,"node_id":"MDQ6VXNlcjYwOTI0MA==","avatar_url":"https://avatars.githubusercontent.com/u/609240?v=4","gravatar_id":"","url":"https://api.github.com/users/leventov","html_url":"https://github.com/leventov","followers_url":"https://api.github.com/users/leventov/followers","following_url":"https://api.github.com/users/leventov/following{/other_user}","gists_url":"https://api.github.com/users/leventov/gists{/gist_id}","starred_url":"https://api.github.com/users/leventov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leventov/subscriptions","organizations_url":"https://api.github.com/users/leventov/orgs","repos_url":"https://api.github.com/users/leventov/repos","events_url":"https://api.github.com/users/leventov/events{/privacy}","received_events_url":"https://api.github.com/users/leventov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-29T12:27:40Z","updated_at":"2018-04-29T12:27:40Z","author_association":"MEMBER","body":"Looks like Aggregator and BufferAggregator impls never actually override equals() and hashCode(), so they are ok.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385247949/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385251865","html_url":"https://github.com/apache/druid/pull/5335#issuecomment-385251865","issue_url":"https://api.github.com/repos/apache/druid/issues/5335","id":385251865,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTI1MTg2NQ==","user":{"login":"leventov","id":609240,"node_id":"MDQ6VXNlcjYwOTI0MA==","avatar_url":"https://avatars.githubusercontent.com/u/609240?v=4","gravatar_id":"","url":"https://api.github.com/users/leventov","html_url":"https://github.com/leventov","followers_url":"https://api.github.com/users/leventov/followers","following_url":"https://api.github.com/users/leventov/following{/other_user}","gists_url":"https://api.github.com/users/leventov/gists{/gist_id}","starred_url":"https://api.github.com/users/leventov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leventov/subscriptions","organizations_url":"https://api.github.com/users/leventov/orgs","repos_url":"https://api.github.com/users/leventov/repos","events_url":"https://api.github.com/users/leventov/events{/privacy}","received_events_url":"https://api.github.com/users/leventov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-29T13:34:08Z","updated_at":"2018-04-29T13:34:08Z","author_association":"MEMBER","body":"Thanks for reviews.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385251865/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385251983","html_url":"https://github.com/apache/druid/issues/5670#issuecomment-385251983","issue_url":"https://api.github.com/repos/apache/druid/issues/5670","id":385251983,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTI1MTk4Mw==","user":{"login":"leventov","id":609240,"node_id":"MDQ6VXNlcjYwOTI0MA==","avatar_url":"https://avatars.githubusercontent.com/u/609240?v=4","gravatar_id":"","url":"https://api.github.com/users/leventov","html_url":"https://github.com/leventov","followers_url":"https://api.github.com/users/leventov/followers","following_url":"https://api.github.com/users/leventov/following{/other_user}","gists_url":"https://api.github.com/users/leventov/gists{/gist_id}","starred_url":"https://api.github.com/users/leventov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leventov/subscriptions","organizations_url":"https://api.github.com/users/leventov/orgs","repos_url":"https://api.github.com/users/leventov/repos","events_url":"https://api.github.com/users/leventov/events{/privacy}","received_events_url":"https://api.github.com/users/leventov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-29T13:35:41Z","updated_at":"2018-04-29T13:35:41Z","author_association":"MEMBER","body":"Thanks.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385251983/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385261065","html_url":"https://github.com/apache/druid/issues/5698#issuecomment-385261065","issue_url":"https://api.github.com/repos/apache/druid/issues/5698","id":385261065,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTI2MTA2NQ==","user":{"login":"leventov","id":609240,"node_id":"MDQ6VXNlcjYwOTI0MA==","avatar_url":"https://avatars.githubusercontent.com/u/609240?v=4","gravatar_id":"","url":"https://api.github.com/users/leventov","html_url":"https://github.com/leventov","followers_url":"https://api.github.com/users/leventov/followers","following_url":"https://api.github.com/users/leventov/following{/other_user}","gists_url":"https://api.github.com/users/leventov/gists{/gist_id}","starred_url":"https://api.github.com/users/leventov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leventov/subscriptions","organizations_url":"https://api.github.com/users/leventov/orgs","repos_url":"https://api.github.com/users/leventov/repos","events_url":"https://api.github.com/users/leventov/events{/privacy}","received_events_url":"https://api.github.com/users/leventov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-29T15:54:12Z","updated_at":"2018-04-29T15:54:12Z","author_association":"MEMBER","body":"@sanastas interesting proposal, thanks. Notes:\r\n\r\n - There is a plan to globally departure from using ByteBuffer in Druid, we are going to use https://github.com/DataSketches/memory. In order not to do some work twice and conversions between `ByteBuffer` and `Memory` APIs back and forth, maybe you could already base your Oak code on the Memory library. You might want to talk with with @leerho about that.\r\n - Instead of adding more incremental index variants (your refactoring plan suggests existence of four), it would be better if everything have converged on the minimum number implementations, that work in all use cases reasonably well. E. g. I plan to make a change that will leave just one IncrementalIndex implementation (on-heap, but \"serialized\" in `Memory` objects), instead of current two: OnHeap and OffHeap. This is mentioned in the last paragraph of this message: https://github.com/druid-io/druid/pull/5335#issue-166870792. However, my idea doesn't touch present `ConcurrentSkipListMap`-based machinery. It would be nice to combine that ideas with concurrency and key handling from Oak, and thus have just one IncrementalIndex. In the materials that you provided I see mentions of tests with 1K-sized values. For Druid, very small values (8 bytes) are important, so they might need to be tested too.\r\n - Another thing that might be important - Druid needs variable-sized values, see the second half of this message: https://github.com/druid-io/druid/pull/5335#issuecomment-365274611\r\n - I don't think there is a big issue with GC in our incremental index structures, because those heaps are quite small, < 10 GB. The bigger issue is the overhead of traditional Java object structures. That is why in the improvement that I planned (see above), I don't intend to move data off-heap, just reduce the overhead and flatten memory, storing data in `Memory` objects (read: `byte[]` buffers). On the other hand, it allows to simplify the concurrency model and take advantage of Java's GC. Buffers are shared among a small number of key-value pairs (e. g. 64) in order to reduce the overhead from `byte[]` and `Memory` headers themselves.\r\n - Currently concurrency of incremental indexes is inherently broken, because it doesn't synchronize between updates and reads: see #3956. Would Oak allow to solve this problem? Also see https://github.com/druid-io/druid/pull/5148#discussion_r171968971","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385261065/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385264282","html_url":"https://github.com/apache/druid/issues/5698#issuecomment-385264282","issue_url":"https://api.github.com/repos/apache/druid/issues/5698","id":385264282,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTI2NDI4Mg==","user":{"login":"b-slim","id":7376396,"node_id":"MDQ6VXNlcjczNzYzOTY=","avatar_url":"https://avatars.githubusercontent.com/u/7376396?v=4","gravatar_id":"","url":"https://api.github.com/users/b-slim","html_url":"https://github.com/b-slim","followers_url":"https://api.github.com/users/b-slim/followers","following_url":"https://api.github.com/users/b-slim/following{/other_user}","gists_url":"https://api.github.com/users/b-slim/gists{/gist_id}","starred_url":"https://api.github.com/users/b-slim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/b-slim/subscriptions","organizations_url":"https://api.github.com/users/b-slim/orgs","repos_url":"https://api.github.com/users/b-slim/repos","events_url":"https://api.github.com/users/b-slim/events{/privacy}","received_events_url":"https://api.github.com/users/b-slim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-29T16:42:36Z","updated_at":"2018-04-29T16:42:36Z","author_association":"CONTRIBUTOR","body":"@leventov the first thing i see when i read memory docs is \r\n```\r\n* <p>This may work with jdk9 but might require the JVM arg <i>-permit-illegal-access</i>,\r\n * <i>illegal-access=permit</i> or equivalent. Proper operation with jdk9 or above is not\r\n * guaranteed and has not been tested.\r\n```\r\nthat is scary! is there any plans to support JDK 9 and higher? i propose to make sure that is the case before we move out of `ByteBuffer`  to `Memory`","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385264282/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385264604","html_url":"https://github.com/apache/druid/issues/5698#issuecomment-385264604","issue_url":"https://api.github.com/repos/apache/druid/issues/5698","id":385264604,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTI2NDYwNA==","user":{"login":"leventov","id":609240,"node_id":"MDQ6VXNlcjYwOTI0MA==","avatar_url":"https://avatars.githubusercontent.com/u/609240?v=4","gravatar_id":"","url":"https://api.github.com/users/leventov","html_url":"https://github.com/leventov","followers_url":"https://api.github.com/users/leventov/followers","following_url":"https://api.github.com/users/leventov/following{/other_user}","gists_url":"https://api.github.com/users/leventov/gists{/gist_id}","starred_url":"https://api.github.com/users/leventov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leventov/subscriptions","organizations_url":"https://api.github.com/users/leventov/orgs","repos_url":"https://api.github.com/users/leventov/repos","events_url":"https://api.github.com/users/leventov/events{/privacy}","received_events_url":"https://api.github.com/users/leventov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-29T16:47:29Z","updated_at":"2018-04-29T16:47:29Z","author_association":"MEMBER","body":"@b-slim please raise the same question here: #3892, rather than this thread, it has a different topic.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385264604/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385266026","html_url":"https://github.com/apache/druid/issues/3892#issuecomment-385266026","issue_url":"https://api.github.com/repos/apache/druid/issues/3892","id":385266026,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTI2NjAyNg==","user":{"login":"b-slim","id":7376396,"node_id":"MDQ6VXNlcjczNzYzOTY=","avatar_url":"https://avatars.githubusercontent.com/u/7376396?v=4","gravatar_id":"","url":"https://api.github.com/users/b-slim","html_url":"https://github.com/b-slim","followers_url":"https://api.github.com/users/b-slim/followers","following_url":"https://api.github.com/users/b-slim/following{/other_user}","gists_url":"https://api.github.com/users/b-slim/gists{/gist_id}","starred_url":"https://api.github.com/users/b-slim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/b-slim/subscriptions","organizations_url":"https://api.github.com/users/b-slim/orgs","repos_url":"https://api.github.com/users/b-slim/repos","events_url":"https://api.github.com/users/b-slim/events{/privacy}","received_events_url":"https://api.github.com/users/b-slim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-29T17:09:45Z","updated_at":"2018-04-29T17:09:45Z","author_association":"CONTRIBUTOR","body":"My 2cents [concerns](https://github.com/druid-io/druid/issues/5698#issuecomment-385264282)","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385266026/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385276069","html_url":"https://github.com/apache/druid/issues/5698#issuecomment-385276069","issue_url":"https://api.github.com/repos/apache/druid/issues/5698","id":385276069,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTI3NjA2OQ==","user":{"login":"sanastas","id":12136181,"node_id":"MDQ6VXNlcjEyMTM2MTgx","avatar_url":"https://avatars.githubusercontent.com/u/12136181?v=4","gravatar_id":"","url":"https://api.github.com/users/sanastas","html_url":"https://github.com/sanastas","followers_url":"https://api.github.com/users/sanastas/followers","following_url":"https://api.github.com/users/sanastas/following{/other_user}","gists_url":"https://api.github.com/users/sanastas/gists{/gist_id}","starred_url":"https://api.github.com/users/sanastas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sanastas/subscriptions","organizations_url":"https://api.github.com/users/sanastas/orgs","repos_url":"https://api.github.com/users/sanastas/repos","events_url":"https://api.github.com/users/sanastas/events{/privacy}","received_events_url":"https://api.github.com/users/sanastas/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-29T19:42:22Z","updated_at":"2018-04-29T19:42:22Z","author_association":"NONE","body":"@leventov , thanks for taking a look! You have great comments!\r\n\r\n- Generally speaking Oak was written quite a while ago using ByteBuffers. The integration of the Oak to Druid is also almost done and we want to publish it soon for your review. We are good friends with Lee Rhodes and we know about his Memory library. We do not see any special advantage to use Memory over ByteBuffer internally at Oak, but definitely it can be an advantage in Druid. In order not to slow the progress I would suggest we publish the code as we have it just to get your impression. If required we can move it to Memory.\r\n\r\n- As we didn't yet feel comfortable to delete existing implementation, we just added our on top of what we saw as existing. It could be good for testing and benchmarking against the current implementation. In the future of course we can remain with one implementation. Regarding your plan about \"just one IncrementalIndex implementation (on-heap, but \"serialized\" in Memory objects)\", you can get it from Oak as Oak works off-heap and on heap and we can allocate ByteBuffer/Memory off-heap or on-heap. Clearly the objects on the ByteBuffer/Memory are serialized. Please note that with Oak you are getting much more than memory layout: the better concurrency, reacher and more efficient API, fast backward scans, etc. \r\n\r\n- Regarding your concern about small values. We work with them better than the ConcurrentSkipListMap as well. The off-heaping is less important with small values, but as mentioned Oak has more to suggest than just off-heaping. Of course all the benchmarks need to be repeated inside Druid. Here are the results \r\n[OakMap OnHeap with Integer Values.pdf](https://github.com/druid-io/druid/files/1959106/OakMap.OnHeap.with.Integer.Values.pdf)\r\n\r\n- \"Druid needs variable-sized values\": Oak definitely supports variable-sized values and keys! This was one of the initial design points.\r\n\r\n- Regarding your comment about GC and flattening. With 10GB heap, the GC efficiency depends on the number of objects. The smaller they are and more of them - worse. When working with ConcurrentSkipListMap and small key-value pairs, hundred of millions key-value pairs still make young generation garbage-collection stop time long. There are 2 problems of ConcurrentSkipListMap: (1) it needs 2 objects to store one key-value on expectation. One Index (skiplist's average node height is 1), one Node itself. (2) Recent inserted KeyValue and its map structure (Index, Node) are assigned on young generation. The card table (for CMS gc algorithm) or RSet (for G1 gc algorithm) will change frequently on high writing throughput, which makes YGC slow. However, I share your concern that we also spend too much memory on objects overheads as well. Oak flattens it all! Keys and values saved in buffers (or you name any other container) and also index itself uses arrays as much as possible.\r\n\r\n- Finally, clearly Oak cares for all the concurrency issues. It is design for concurrent updates/reads of the data it stores.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385276069/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385282988","html_url":"https://github.com/apache/druid/issues/5698#issuecomment-385282988","issue_url":"https://api.github.com/repos/apache/druid/issues/5698","id":385282988,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTI4Mjk4OA==","user":{"login":"leventov","id":609240,"node_id":"MDQ6VXNlcjYwOTI0MA==","avatar_url":"https://avatars.githubusercontent.com/u/609240?v=4","gravatar_id":"","url":"https://api.github.com/users/leventov","html_url":"https://github.com/leventov","followers_url":"https://api.github.com/users/leventov/followers","following_url":"https://api.github.com/users/leventov/following{/other_user}","gists_url":"https://api.github.com/users/leventov/gists{/gist_id}","starred_url":"https://api.github.com/users/leventov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leventov/subscriptions","organizations_url":"https://api.github.com/users/leventov/orgs","repos_url":"https://api.github.com/users/leventov/repos","events_url":"https://api.github.com/users/leventov/events{/privacy}","received_events_url":"https://api.github.com/users/leventov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-29T21:24:30Z","updated_at":"2018-04-29T21:25:43Z","author_association":"MEMBER","body":"> We do not see any special advantage to use Memory over ByteBuffer internally at Oak, but definitely it can be an advantage in Druid. In order not to slow the progress I would suggest we publish the code as we have it just to get your impression. If required we can move it to Memory.\r\n\r\nThe problem is that if the Druid API is going to depend on Memory, then if Oak is used, conversion from ByteBuffer to Memory is required on every read and write access to the NavigableMap. The allocated Memory objects are garbage. I don't think the overhead of those conversions is going to be prohibitive, but it could be considerable, so better avoided.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385282988/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385288512","html_url":"https://github.com/apache/druid/pull/5681#issuecomment-385288512","issue_url":"https://api.github.com/repos/apache/druid/issues/5681","id":385288512,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTI4ODUxMg==","user":{"login":"dylwylie","id":3107079,"node_id":"MDQ6VXNlcjMxMDcwNzk=","avatar_url":"https://avatars.githubusercontent.com/u/3107079?v=4","gravatar_id":"","url":"https://api.github.com/users/dylwylie","html_url":"https://github.com/dylwylie","followers_url":"https://api.github.com/users/dylwylie/followers","following_url":"https://api.github.com/users/dylwylie/following{/other_user}","gists_url":"https://api.github.com/users/dylwylie/gists{/gist_id}","starred_url":"https://api.github.com/users/dylwylie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dylwylie/subscriptions","organizations_url":"https://api.github.com/users/dylwylie/orgs","repos_url":"https://api.github.com/users/dylwylie/repos","events_url":"https://api.github.com/users/dylwylie/events{/privacy}","received_events_url":"https://api.github.com/users/dylwylie/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-29T22:57:22Z","updated_at":"2018-04-29T22:57:22Z","author_association":"CONTRIBUTOR","body":"Hmm realise this might be naive, if we get passed in something like a MapDB offheap htreemap we'd be defeating the point of the off-heap collection by copying everything into the inverse offheap.\r\n\r\nWondering about letting the caller pass in the reverse map.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385288512/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385291052","html_url":"https://github.com/apache/druid/pull/5660#issuecomment-385291052","issue_url":"https://api.github.com/repos/apache/druid/issues/5660","id":385291052,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTI5MTA1Mg==","user":{"login":"josephglanville","id":605591,"node_id":"MDQ6VXNlcjYwNTU5MQ==","avatar_url":"https://avatars.githubusercontent.com/u/605591?v=4","gravatar_id":"","url":"https://api.github.com/users/josephglanville","html_url":"https://github.com/josephglanville","followers_url":"https://api.github.com/users/josephglanville/followers","following_url":"https://api.github.com/users/josephglanville/following{/other_user}","gists_url":"https://api.github.com/users/josephglanville/gists{/gist_id}","starred_url":"https://api.github.com/users/josephglanville/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/josephglanville/subscriptions","organizations_url":"https://api.github.com/users/josephglanville/orgs","repos_url":"https://api.github.com/users/josephglanville/repos","events_url":"https://api.github.com/users/josephglanville/events{/privacy}","received_events_url":"https://api.github.com/users/josephglanville/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-29T23:45:04Z","updated_at":"2018-04-29T23:45:04Z","author_association":"CONTRIBUTOR","body":"@b-slim would you be able to review this again, formatting has been addressed.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385291052/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385293658","html_url":"https://github.com/apache/druid/issues/3892#issuecomment-385293658","issue_url":"https://api.github.com/repos/apache/druid/issues/3892","id":385293658,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTI5MzY1OA==","user":{"login":"leerho","id":12941506,"node_id":"MDQ6VXNlcjEyOTQxNTA2","avatar_url":"https://avatars.githubusercontent.com/u/12941506?v=4","gravatar_id":"","url":"https://api.github.com/users/leerho","html_url":"https://github.com/leerho","followers_url":"https://api.github.com/users/leerho/followers","following_url":"https://api.github.com/users/leerho/following{/other_user}","gists_url":"https://api.github.com/users/leerho/gists{/gist_id}","starred_url":"https://api.github.com/users/leerho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leerho/subscriptions","organizations_url":"https://api.github.com/users/leerho/orgs","repos_url":"https://api.github.com/users/leerho/repos","events_url":"https://api.github.com/users/leerho/events{/privacy}","received_events_url":"https://api.github.com/users/leerho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-30T00:20:38Z","updated_at":"2018-04-30T00:20:38Z","author_association":"CONTRIBUTOR","body":"@b-slim \r\n\r\nThe facts are as follows:\r\n\r\nThe current internal implementation of Memory is heavily dependent on the `Unsafe` class, as many high-performance libraries do. However, the architecture of Memory has been designed so that a non-Unsafe implementation could be created without impacting the API. \r\n\r\nDruid has not moved to JDK 9 yet, nor have many of the other systems that currently use the library.  So there hasn't been a great deal of pressure to move to JDK 9, yet.  Nonetheless, when the time comes we will move to 9, 10, 11 or whatever.\r\n\r\nMy comment in the memory docs that you highlighted is simply the truth.  We have not had the time, resources or the requirement to move to JDK 9 or 10.  So it obviously hasn't been tested to work against JDK 9 or 10 either.   I'm clearly not going to guarantee code that hasn't been tested.  And I don't plan to start extensive testing until it becomes a requirement.  \r\n\r\nThere have been only 2 people heavily involved in the design and implementation of the Memory repository in DataSketches, @leventov and myself.  And both of us are very busy people.  \r\n\r\nIf you understand the value in the Memory API as @leventov and I do, then how about contributing a helping hand?  \r\n\r\n\r\n\r\n ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385293658/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385304957","html_url":"https://github.com/apache/druid/pull/5692#issuecomment-385304957","issue_url":"https://api.github.com/repos/apache/druid/issues/5692","id":385304957,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTMwNDk1Nw==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-30T02:57:25Z","updated_at":"2018-04-30T02:57:25Z","author_association":"CONTRIBUTOR","body":"@dclim that makes sense to me, so I'll merge this.\r\n\r\n@b-slim I raised https://github.com/druid-io/druid/issues/5716 about a potential loose segment cleanup tool.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385304957/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385305037","html_url":"https://github.com/apache/druid/pull/5692#issuecomment-385305037","issue_url":"https://api.github.com/repos/apache/druid/issues/5692","id":385305037,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTMwNTAzNw==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-30T02:58:16Z","updated_at":"2018-04-30T02:58:16Z","author_association":"CONTRIBUTOR","body":"Wait, I won't merge this, since there's a checkstyle error showing up in travis. @dclim could you please take a look?\r\n\r\n```\r\n[ERROR] /home/travis/build/druid-io/druid/extensions-core/hdfs-storage/src/main/java/io/druid/storage/hdfs/HdfsDataSegmentPusher.java:54: 'HdfsDataSegmentPusher' has incorrect indentation level 0, expected level should be 4. [Indentation]\r\n```","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385305037/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385310939","html_url":"https://github.com/apache/druid/pull/5583#issuecomment-385310939","issue_url":"https://api.github.com/repos/apache/druid/issues/5583","id":385310939,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTMxMDkzOQ==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-30T04:23:51Z","updated_at":"2018-04-30T04:23:51Z","author_association":"CONTRIBUTOR","body":"@surekhasaharan Could you please resolve the conflicts, and we can do another round of review? thanks!","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385310939/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385313557","html_url":"https://github.com/apache/druid/pull/5692#issuecomment-385313557","issue_url":"https://api.github.com/repos/apache/druid/issues/5692","id":385313557,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTMxMzU1Nw==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-30T04:59:44Z","updated_at":"2018-04-30T04:59:44Z","author_association":"CONTRIBUTOR","body":"Travis is looking good; merging.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385313557/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385313706","html_url":"https://github.com/apache/druid/pull/5692#issuecomment-385313706","issue_url":"https://api.github.com/repos/apache/druid/issues/5692","id":385313706,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTMxMzcwNg==","user":{"login":"dclim","id":11050882,"node_id":"MDQ6VXNlcjExMDUwODgy","avatar_url":"https://avatars.githubusercontent.com/u/11050882?v=4","gravatar_id":"","url":"https://api.github.com/users/dclim","html_url":"https://github.com/dclim","followers_url":"https://api.github.com/users/dclim/followers","following_url":"https://api.github.com/users/dclim/following{/other_user}","gists_url":"https://api.github.com/users/dclim/gists{/gist_id}","starred_url":"https://api.github.com/users/dclim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dclim/subscriptions","organizations_url":"https://api.github.com/users/dclim/orgs","repos_url":"https://api.github.com/users/dclim/repos","events_url":"https://api.github.com/users/dclim/events{/privacy}","received_events_url":"https://api.github.com/users/dclim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-30T05:01:48Z","updated_at":"2018-04-30T05:01:48Z","author_association":"CONTRIBUTOR","body":"thanks @gianm ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385313706/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385314007","html_url":"https://github.com/apache/druid/pull/5692#issuecomment-385314007","issue_url":"https://api.github.com/repos/apache/druid/issues/5692","id":385314007,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTMxNDAwNw==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-30T05:05:26Z","updated_at":"2018-04-30T05:05:26Z","author_association":"CONTRIBUTOR","body":"@dclim I tagged this 0.12.1 since I brought up on the dev list the prospect of including this there, and nobody argued. Does that sound reasonable to you & are you able to do a backport?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385314007/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385314834","html_url":"https://github.com/apache/druid/pull/5692#issuecomment-385314834","issue_url":"https://api.github.com/repos/apache/druid/issues/5692","id":385314834,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTMxNDgzNA==","user":{"login":"dclim","id":11050882,"node_id":"MDQ6VXNlcjExMDUwODgy","avatar_url":"https://avatars.githubusercontent.com/u/11050882?v=4","gravatar_id":"","url":"https://api.github.com/users/dclim","html_url":"https://github.com/dclim","followers_url":"https://api.github.com/users/dclim/followers","following_url":"https://api.github.com/users/dclim/following{/other_user}","gists_url":"https://api.github.com/users/dclim/gists{/gist_id}","starred_url":"https://api.github.com/users/dclim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dclim/subscriptions","organizations_url":"https://api.github.com/users/dclim/orgs","repos_url":"https://api.github.com/users/dclim/repos","events_url":"https://api.github.com/users/dclim/events{/privacy}","received_events_url":"https://api.github.com/users/dclim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-30T05:15:07Z","updated_at":"2018-04-30T05:15:07Z","author_association":"CONTRIBUTOR","body":"@gianm yes that sounds good, will backport","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385314834/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385326304","html_url":"https://github.com/apache/druid/issues/5698#issuecomment-385326304","issue_url":"https://api.github.com/repos/apache/druid/issues/5698","id":385326304,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTMyNjMwNA==","user":{"login":"sanastas","id":12136181,"node_id":"MDQ6VXNlcjEyMTM2MTgx","avatar_url":"https://avatars.githubusercontent.com/u/12136181?v=4","gravatar_id":"","url":"https://api.github.com/users/sanastas","html_url":"https://github.com/sanastas","followers_url":"https://api.github.com/users/sanastas/followers","following_url":"https://api.github.com/users/sanastas/following{/other_user}","gists_url":"https://api.github.com/users/sanastas/gists{/gist_id}","starred_url":"https://api.github.com/users/sanastas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sanastas/subscriptions","organizations_url":"https://api.github.com/users/sanastas/orgs","repos_url":"https://api.github.com/users/sanastas/repos","events_url":"https://api.github.com/users/sanastas/events{/privacy}","received_events_url":"https://api.github.com/users/sanastas/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-30T07:12:17Z","updated_at":"2018-04-30T07:12:17Z","author_association":"NONE","body":"To be based on ByteBuffer of Memory is equivalent for Oak. We care about performance a lot and conversion from ByteBuffer to Memory is not an option. When aggregators will transform from ByteBuffer to Memory, we will switch Oak to use Memory. For now we just want to get your review feedback and to get some benchmark performance comparisons.\r\n\r\nBy the way do you have any ready performance benchmarks we can use? Do you use any performance evaluation platform like YCSB or similar?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385326304/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385375092","html_url":"https://github.com/apache/druid/pull/5701#issuecomment-385375092","issue_url":"https://api.github.com/repos/apache/druid/issues/5701","id":385375092,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTM3NTA5Mg==","user":{"login":"varaga","id":31006611,"node_id":"MDQ6VXNlcjMxMDA2NjEx","avatar_url":"https://avatars.githubusercontent.com/u/31006611?v=4","gravatar_id":"","url":"https://api.github.com/users/varaga","html_url":"https://github.com/varaga","followers_url":"https://api.github.com/users/varaga/followers","following_url":"https://api.github.com/users/varaga/following{/other_user}","gists_url":"https://api.github.com/users/varaga/gists{/gist_id}","starred_url":"https://api.github.com/users/varaga/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/varaga/subscriptions","organizations_url":"https://api.github.com/users/varaga/orgs","repos_url":"https://api.github.com/users/varaga/repos","events_url":"https://api.github.com/users/varaga/events{/privacy}","received_events_url":"https://api.github.com/users/varaga/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-30T11:44:01Z","updated_at":"2018-04-30T11:44:01Z","author_association":"CONTRIBUTOR","body":"@b-slim - The expected validation exception is buried deep in the stack and is returned from ZK server. I don't see value in mocking the stack up to verify the semantics of a wrong password. Secondly, I don't see ZK integration tests in druid that verifies ZK config, likes of acl, paths etc., against the ZK server. What do you reckon?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385375092/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385424845","html_url":"https://github.com/apache/druid/issues/5719#issuecomment-385424845","issue_url":"https://api.github.com/repos/apache/druid/issues/5719","id":385424845,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTQyNDg0NQ==","user":{"login":"dylwylie","id":3107079,"node_id":"MDQ6VXNlcjMxMDcwNzk=","avatar_url":"https://avatars.githubusercontent.com/u/3107079?v=4","gravatar_id":"","url":"https://api.github.com/users/dylwylie","html_url":"https://github.com/dylwylie","followers_url":"https://api.github.com/users/dylwylie/followers","following_url":"https://api.github.com/users/dylwylie/following{/other_user}","gists_url":"https://api.github.com/users/dylwylie/gists{/gist_id}","starred_url":"https://api.github.com/users/dylwylie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dylwylie/subscriptions","organizations_url":"https://api.github.com/users/dylwylie/orgs","repos_url":"https://api.github.com/users/dylwylie/repos","events_url":"https://api.github.com/users/dylwylie/events{/privacy}","received_events_url":"https://api.github.com/users/dylwylie/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-30T14:58:55Z","updated_at":"2018-04-30T14:58:55Z","author_association":"CONTRIBUTOR","body":"Hey @HenryMiller \r\n\r\nDruid currently requires Java8, there's an open Issue to support Java11 -> https://github.com/druid-io/druid/issues/5589","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385424845/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385440047","html_url":"https://github.com/apache/druid/issues/5719#issuecomment-385440047","issue_url":"https://api.github.com/repos/apache/druid/issues/5719","id":385440047,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTQ0MDA0Nw==","user":{"login":"HenryMiller","id":1829995,"node_id":"MDQ6VXNlcjE4Mjk5OTU=","avatar_url":"https://avatars.githubusercontent.com/u/1829995?v=4","gravatar_id":"","url":"https://api.github.com/users/HenryMiller","html_url":"https://github.com/HenryMiller","followers_url":"https://api.github.com/users/HenryMiller/followers","following_url":"https://api.github.com/users/HenryMiller/following{/other_user}","gists_url":"https://api.github.com/users/HenryMiller/gists{/gist_id}","starred_url":"https://api.github.com/users/HenryMiller/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HenryMiller/subscriptions","organizations_url":"https://api.github.com/users/HenryMiller/orgs","repos_url":"https://api.github.com/users/HenryMiller/repos","events_url":"https://api.github.com/users/HenryMiller/events{/privacy}","received_events_url":"https://api.github.com/users/HenryMiller/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-30T15:47:11Z","updated_at":"2018-04-30T15:47:11Z","author_association":"NONE","body":"Thank you Dylan!\r\nI will try on a virtual Ubuntu machine then.\r\nThanks \r\nGiovanni\r\n","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385440047/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385442187","html_url":"https://github.com/apache/druid/issues/5582#issuecomment-385442187","issue_url":"https://api.github.com/repos/apache/druid/issues/5582","id":385442187,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTQ0MjE4Nw==","user":{"login":"drcrallen","id":8213081,"node_id":"MDQ6VXNlcjgyMTMwODE=","avatar_url":"https://avatars.githubusercontent.com/u/8213081?v=4","gravatar_id":"","url":"https://api.github.com/users/drcrallen","html_url":"https://github.com/drcrallen","followers_url":"https://api.github.com/users/drcrallen/followers","following_url":"https://api.github.com/users/drcrallen/following{/other_user}","gists_url":"https://api.github.com/users/drcrallen/gists{/gist_id}","starred_url":"https://api.github.com/users/drcrallen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/drcrallen/subscriptions","organizations_url":"https://api.github.com/users/drcrallen/orgs","repos_url":"https://api.github.com/users/drcrallen/repos","events_url":"https://api.github.com/users/drcrallen/events{/privacy}","received_events_url":"https://api.github.com/users/drcrallen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-30T15:54:02Z","updated_at":"2018-04-30T15:54:02Z","author_association":"CONTRIBUTOR","body":"@josephglanville the problem with 2 stateful sets is that one doesn't know what the other is doing. So I'm not sure there's a way to say \"don't do any operations on this set while the other doesn't meet stateful requirements\". Its kind of a... stateful set of stateful sets","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385442187/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385442790","html_url":"https://github.com/apache/druid/issues/5368#issuecomment-385442790","issue_url":"https://api.github.com/repos/apache/druid/issues/5368","id":385442790,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTQ0Mjc5MA==","user":{"login":"drcrallen","id":8213081,"node_id":"MDQ6VXNlcjgyMTMwODE=","avatar_url":"https://avatars.githubusercontent.com/u/8213081?v=4","gravatar_id":"","url":"https://api.github.com/users/drcrallen","html_url":"https://github.com/drcrallen","followers_url":"https://api.github.com/users/drcrallen/followers","following_url":"https://api.github.com/users/drcrallen/following{/other_user}","gists_url":"https://api.github.com/users/drcrallen/gists{/gist_id}","starred_url":"https://api.github.com/users/drcrallen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/drcrallen/subscriptions","organizations_url":"https://api.github.com/users/drcrallen/orgs","repos_url":"https://api.github.com/users/drcrallen/repos","events_url":"https://api.github.com/users/drcrallen/events{/privacy}","received_events_url":"https://api.github.com/users/drcrallen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-30T15:55:55Z","updated_at":"2018-04-30T15:55:55Z","author_association":"CONTRIBUTOR","body":"dang, its too bad it is not reproducible. I'd like to leave this open a bit if that's ok, just in case others encounter the problem as well.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385442790/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385442975","html_url":"https://github.com/apache/druid/issues/5320#issuecomment-385442975","issue_url":"https://api.github.com/repos/apache/druid/issues/5320","id":385442975,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTQ0Mjk3NQ==","user":{"login":"drcrallen","id":8213081,"node_id":"MDQ6VXNlcjgyMTMwODE=","avatar_url":"https://avatars.githubusercontent.com/u/8213081?v=4","gravatar_id":"","url":"https://api.github.com/users/drcrallen","html_url":"https://github.com/drcrallen","followers_url":"https://api.github.com/users/drcrallen/followers","following_url":"https://api.github.com/users/drcrallen/following{/other_user}","gists_url":"https://api.github.com/users/drcrallen/gists{/gist_id}","starred_url":"https://api.github.com/users/drcrallen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/drcrallen/subscriptions","organizations_url":"https://api.github.com/users/drcrallen/orgs","repos_url":"https://api.github.com/users/drcrallen/repos","events_url":"https://api.github.com/users/drcrallen/events{/privacy}","received_events_url":"https://api.github.com/users/drcrallen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-30T15:56:32Z","updated_at":"2018-04-30T15:56:32Z","author_association":"CONTRIBUTOR","body":"Request logs :)","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385442975/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385445760","html_url":"https://github.com/apache/druid/pull/5514#issuecomment-385445760","issue_url":"https://api.github.com/repos/apache/druid/issues/5514","id":385445760,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTQ0NTc2MA==","user":{"login":"drcrallen","id":8213081,"node_id":"MDQ6VXNlcjgyMTMwODE=","avatar_url":"https://avatars.githubusercontent.com/u/8213081?v=4","gravatar_id":"","url":"https://api.github.com/users/drcrallen","html_url":"https://github.com/drcrallen","followers_url":"https://api.github.com/users/drcrallen/followers","following_url":"https://api.github.com/users/drcrallen/following{/other_user}","gists_url":"https://api.github.com/users/drcrallen/gists{/gist_id}","starred_url":"https://api.github.com/users/drcrallen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/drcrallen/subscriptions","organizations_url":"https://api.github.com/users/drcrallen/orgs","repos_url":"https://api.github.com/users/drcrallen/repos","events_url":"https://api.github.com/users/drcrallen/events{/privacy}","received_events_url":"https://api.github.com/users/drcrallen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-30T16:06:11Z","updated_at":"2018-04-30T16:06:11Z","author_association":"CONTRIBUTOR","body":"We can leave it open for now to see if there's other desires to have some sort of native-logging solution. There is already one for the middle managers, so it is not totally unprecedented. But it is not clear what others would also want from such a solution. for example: Is a \"file reader\" like the peon one sufficient? Does the request logger need expanded to have more builtin export types?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385445760/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385478956","html_url":"https://github.com/apache/druid/issues/5685#issuecomment-385478956","issue_url":"https://api.github.com/repos/apache/druid/issues/5685","id":385478956,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTQ3ODk1Ng==","user":{"login":"jihoonson","id":2322288,"node_id":"MDQ6VXNlcjIzMjIyODg=","avatar_url":"https://avatars.githubusercontent.com/u/2322288?v=4","gravatar_id":"","url":"https://api.github.com/users/jihoonson","html_url":"https://github.com/jihoonson","followers_url":"https://api.github.com/users/jihoonson/followers","following_url":"https://api.github.com/users/jihoonson/following{/other_user}","gists_url":"https://api.github.com/users/jihoonson/gists{/gist_id}","starred_url":"https://api.github.com/users/jihoonson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jihoonson/subscriptions","organizations_url":"https://api.github.com/users/jihoonson/orgs","repos_url":"https://api.github.com/users/jihoonson/repos","events_url":"https://api.github.com/users/jihoonson/events{/privacy}","received_events_url":"https://api.github.com/users/jihoonson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-30T18:00:05Z","updated_at":"2018-04-30T18:00:05Z","author_association":"CONTRIBUTOR","body":"Hi, Druid supports [SQL](http://druid.io/docs/latest/querying/sql.html). You can try it.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385478956/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385482382","html_url":"https://github.com/apache/druid/pull/5471#issuecomment-385482382","issue_url":"https://api.github.com/repos/apache/druid/issues/5471","id":385482382,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTQ4MjM4Mg==","user":{"login":"jihoonson","id":2322288,"node_id":"MDQ6VXNlcjIzMjIyODg=","avatar_url":"https://avatars.githubusercontent.com/u/2322288?v=4","gravatar_id":"","url":"https://api.github.com/users/jihoonson","html_url":"https://github.com/jihoonson","followers_url":"https://api.github.com/users/jihoonson/followers","following_url":"https://api.github.com/users/jihoonson/following{/other_user}","gists_url":"https://api.github.com/users/jihoonson/gists{/gist_id}","starred_url":"https://api.github.com/users/jihoonson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jihoonson/subscriptions","organizations_url":"https://api.github.com/users/jihoonson/orgs","repos_url":"https://api.github.com/users/jihoonson/repos","events_url":"https://api.github.com/users/jihoonson/events{/privacy}","received_events_url":"https://api.github.com/users/jihoonson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-30T18:11:40Z","updated_at":"2018-04-30T18:11:40Z","author_association":"CONTRIBUTOR","body":"@samarthjain ah, you're correct. Unfortunately, I also have no idea where the data is. @nishantmonu51 would you explain these things like where the data is and how to see/modify the input data?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385482382/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385483604","html_url":"https://github.com/apache/druid/issues/5697#issuecomment-385483604","issue_url":"https://api.github.com/repos/apache/druid/issues/5697","id":385483604,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTQ4MzYwNA==","user":{"login":"jihoonson","id":2322288,"node_id":"MDQ6VXNlcjIzMjIyODg=","avatar_url":"https://avatars.githubusercontent.com/u/2322288?v=4","gravatar_id":"","url":"https://api.github.com/users/jihoonson","html_url":"https://github.com/jihoonson","followers_url":"https://api.github.com/users/jihoonson/followers","following_url":"https://api.github.com/users/jihoonson/following{/other_user}","gists_url":"https://api.github.com/users/jihoonson/gists{/gist_id}","starred_url":"https://api.github.com/users/jihoonson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jihoonson/subscriptions","organizations_url":"https://api.github.com/users/jihoonson/orgs","repos_url":"https://api.github.com/users/jihoonson/repos","events_url":"https://api.github.com/users/jihoonson/events{/privacy}","received_events_url":"https://api.github.com/users/jihoonson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-30T18:16:08Z","updated_at":"2018-04-30T18:16:08Z","author_association":"CONTRIBUTOR","body":"Hmm, would you elaborate more on what you think the bug is? Looks like the middleManager of different port should be regarded as a different one.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385483604/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385485418","html_url":"https://github.com/apache/druid/pull/5699#issuecomment-385485418","issue_url":"https://api.github.com/repos/apache/druid/issues/5699","id":385485418,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTQ4NTQxOA==","user":{"login":"jihoonson","id":2322288,"node_id":"MDQ6VXNlcjIzMjIyODg=","avatar_url":"https://avatars.githubusercontent.com/u/2322288?v=4","gravatar_id":"","url":"https://api.github.com/users/jihoonson","html_url":"https://github.com/jihoonson","followers_url":"https://api.github.com/users/jihoonson/followers","following_url":"https://api.github.com/users/jihoonson/following{/other_user}","gists_url":"https://api.github.com/users/jihoonson/gists{/gist_id}","starred_url":"https://api.github.com/users/jihoonson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jihoonson/subscriptions","organizations_url":"https://api.github.com/users/jihoonson/orgs","repos_url":"https://api.github.com/users/jihoonson/repos","events_url":"https://api.github.com/users/jihoonson/events{/privacy}","received_events_url":"https://api.github.com/users/jihoonson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-30T18:22:41Z","updated_at":"2018-04-30T18:23:08Z","author_association":"CONTRIBUTOR","body":"@kskalski, thank you for the contribution!\r\n\r\nI believe this PR would be useful for some use cases, but existing implementation is also useful as well. So, I think it would be better to add an option to First/LastAggregatorFactory to get only time/value or both. The default should be both as it does.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385485418/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385485879","html_url":"https://github.com/apache/druid/issues/5700#issuecomment-385485879","issue_url":"https://api.github.com/repos/apache/druid/issues/5700","id":385485879,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTQ4NTg3OQ==","user":{"login":"jihoonson","id":2322288,"node_id":"MDQ6VXNlcjIzMjIyODg=","avatar_url":"https://avatars.githubusercontent.com/u/2322288?v=4","gravatar_id":"","url":"https://api.github.com/users/jihoonson","html_url":"https://github.com/jihoonson","followers_url":"https://api.github.com/users/jihoonson/followers","following_url":"https://api.github.com/users/jihoonson/following{/other_user}","gists_url":"https://api.github.com/users/jihoonson/gists{/gist_id}","starred_url":"https://api.github.com/users/jihoonson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jihoonson/subscriptions","organizations_url":"https://api.github.com/users/jihoonson/orgs","repos_url":"https://api.github.com/users/jihoonson/repos","events_url":"https://api.github.com/users/jihoonson/events{/privacy}","received_events_url":"https://api.github.com/users/jihoonson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-30T18:24:26Z","updated_at":"2018-04-30T18:24:26Z","author_association":"CONTRIBUTOR","body":"@dkhwangbo any thoughts?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385485879/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385490192","html_url":"https://github.com/apache/druid/pull/5556#issuecomment-385490192","issue_url":"https://api.github.com/repos/apache/druid/issues/5556","id":385490192,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTQ5MDE5Mg==","user":{"login":"jihoonson","id":2322288,"node_id":"MDQ6VXNlcjIzMjIyODg=","avatar_url":"https://avatars.githubusercontent.com/u/2322288?v=4","gravatar_id":"","url":"https://api.github.com/users/jihoonson","html_url":"https://github.com/jihoonson","followers_url":"https://api.github.com/users/jihoonson/followers","following_url":"https://api.github.com/users/jihoonson/following{/other_user}","gists_url":"https://api.github.com/users/jihoonson/gists{/gist_id}","starred_url":"https://api.github.com/users/jihoonson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jihoonson/subscriptions","organizations_url":"https://api.github.com/users/jihoonson/orgs","repos_url":"https://api.github.com/users/jihoonson/repos","events_url":"https://api.github.com/users/jihoonson/events{/privacy}","received_events_url":"https://api.github.com/users/jihoonson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-30T18:39:51Z","updated_at":"2018-04-30T18:39:51Z","author_association":"CONTRIBUTOR","body":"@zhangxinyu1 yes, you can add docs to the directory under $DRUID/docs/content/development/extensions-contrib like other extensions.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385490192/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385498294","html_url":"https://github.com/apache/druid/pull/5699#issuecomment-385498294","issue_url":"https://api.github.com/repos/apache/druid/issues/5699","id":385498294,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTQ5ODI5NA==","user":{"login":"kskalski","id":775012,"node_id":"MDQ6VXNlcjc3NTAxMg==","avatar_url":"https://avatars.githubusercontent.com/u/775012?v=4","gravatar_id":"","url":"https://api.github.com/users/kskalski","html_url":"https://github.com/kskalski","followers_url":"https://api.github.com/users/kskalski/followers","following_url":"https://api.github.com/users/kskalski/following{/other_user}","gists_url":"https://api.github.com/users/kskalski/gists{/gist_id}","starred_url":"https://api.github.com/users/kskalski/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kskalski/subscriptions","organizations_url":"https://api.github.com/users/kskalski/orgs","repos_url":"https://api.github.com/users/kskalski/repos","events_url":"https://api.github.com/users/kskalski/events{/privacy}","received_events_url":"https://api.github.com/users/kskalski/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-30T19:08:51Z","updated_at":"2018-04-30T19:08:51Z","author_association":"NONE","body":"Yes, I guess it would be a better fix to get the right value when processing is done. Actually First/LastAggregator already have methods for fetching just the value or timestamp, however I don't know the code-base enough to find out when/where they should be called.\r\nI'm not sure where the values surfaced in the exception are actually produced, both *AggregatorFactory and Aggregator have methods, which return SerializablePair. My guess is that somewhere the code calls Aggregator::get instead of Aggregator::getDouble, which for First/Last Aggregator returns a pair. Unfortunately the exception I get is already past that phase, values are already produced and there is only symptomatic way to deal with it.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385498294/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385560159","html_url":"https://github.com/apache/druid/pull/5706#issuecomment-385560159","issue_url":"https://api.github.com/repos/apache/druid/issues/5706","id":385560159,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTU2MDE1OQ==","user":{"login":"b-slim","id":7376396,"node_id":"MDQ6VXNlcjczNzYzOTY=","avatar_url":"https://avatars.githubusercontent.com/u/7376396?v=4","gravatar_id":"","url":"https://api.github.com/users/b-slim","html_url":"https://github.com/b-slim","followers_url":"https://api.github.com/users/b-slim/followers","following_url":"https://api.github.com/users/b-slim/following{/other_user}","gists_url":"https://api.github.com/users/b-slim/gists{/gist_id}","starred_url":"https://api.github.com/users/b-slim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/b-slim/subscriptions","organizations_url":"https://api.github.com/users/b-slim/orgs","repos_url":"https://api.github.com/users/b-slim/repos","events_url":"https://api.github.com/users/b-slim/events{/privacy}","received_events_url":"https://api.github.com/users/b-slim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-30T23:39:04Z","updated_at":"2018-04-30T23:39:04Z","author_association":"CONTRIBUTOR","body":"@jon-wei thanks for all the feedback please check this out. ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385560159/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385562605","html_url":"https://github.com/apache/druid/issues/5582#issuecomment-385562605","issue_url":"https://api.github.com/repos/apache/druid/issues/5582","id":385562605,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTU2MjYwNQ==","user":{"login":"josephglanville","id":605591,"node_id":"MDQ6VXNlcjYwNTU5MQ==","avatar_url":"https://avatars.githubusercontent.com/u/605591?v=4","gravatar_id":"","url":"https://api.github.com/users/josephglanville","html_url":"https://github.com/josephglanville","followers_url":"https://api.github.com/users/josephglanville/followers","following_url":"https://api.github.com/users/josephglanville/following{/other_user}","gists_url":"https://api.github.com/users/josephglanville/gists{/gist_id}","starred_url":"https://api.github.com/users/josephglanville/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/josephglanville/subscriptions","organizations_url":"https://api.github.com/users/josephglanville/orgs","repos_url":"https://api.github.com/users/josephglanville/repos","events_url":"https://api.github.com/users/josephglanville/events{/privacy}","received_events_url":"https://api.github.com/users/josephglanville/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-30T23:54:51Z","updated_at":"2018-04-30T23:54:51Z","author_association":"CONTRIBUTOR","body":"Yeah such a feature would need to be in Helm/Tiller most likely. There is also the problem that `PodDisruptionBudget` can't respect cross statefulset constrains which means that automated cluster operations could prove problematic.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385562605/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385569245","html_url":"https://github.com/apache/druid/pull/5701#issuecomment-385569245","issue_url":"https://api.github.com/repos/apache/druid/issues/5701","id":385569245,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTU2OTI0NQ==","user":{"login":"b-slim","id":7376396,"node_id":"MDQ6VXNlcjczNzYzOTY=","avatar_url":"https://avatars.githubusercontent.com/u/7376396?v=4","gravatar_id":"","url":"https://api.github.com/users/b-slim","html_url":"https://github.com/b-slim","followers_url":"https://api.github.com/users/b-slim/followers","following_url":"https://api.github.com/users/b-slim/following{/other_user}","gists_url":"https://api.github.com/users/b-slim/gists{/gist_id}","starred_url":"https://api.github.com/users/b-slim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/b-slim/subscriptions","organizations_url":"https://api.github.com/users/b-slim/orgs","repos_url":"https://api.github.com/users/b-slim/repos","events_url":"https://api.github.com/users/b-slim/events{/privacy}","received_events_url":"https://api.github.com/users/b-slim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-01T00:33:49Z","updated_at":"2018-05-01T00:33:49Z","author_association":"CONTRIBUTOR","body":">  I don't see value in mocking the stack up to verify the semantics of a wrong password. \r\n\r\nWell there is multiple values one of them is to catch bugs if someone would break something via other changes but anyway am not get into that debate of what is the value of testing... \r\n\r\n> I don't see ZK integration tests in druid that verifies ZK config, likes of acl, paths etc., against the ZK server.\r\n\r\nMaybe it is true for ACLs but there is a good amount of testing for zookeeper stuff... \r\n\r\nAnyway, Overall looks pretty simple change so LGTM.\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385569245/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385572352","html_url":"https://github.com/apache/druid/pull/5712#issuecomment-385572352","issue_url":"https://api.github.com/repos/apache/druid/issues/5712","id":385572352,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTU3MjM1Mg==","user":{"login":"fjy","id":428325,"node_id":"MDQ6VXNlcjQyODMyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/428325?v=4","gravatar_id":"","url":"https://api.github.com/users/fjy","html_url":"https://github.com/fjy","followers_url":"https://api.github.com/users/fjy/followers","following_url":"https://api.github.com/users/fjy/following{/other_user}","gists_url":"https://api.github.com/users/fjy/gists{/gist_id}","starred_url":"https://api.github.com/users/fjy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fjy/subscriptions","organizations_url":"https://api.github.com/users/fjy/orgs","repos_url":"https://api.github.com/users/fjy/repos","events_url":"https://api.github.com/users/fjy/events{/privacy}","received_events_url":"https://api.github.com/users/fjy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-01T00:55:24Z","updated_at":"2018-05-01T00:55:24Z","author_association":"CONTRIBUTOR","body":"@AlexanderSaydakov any benchmarks around how this compares to the original HLL sketch? Does this sketch enable us to fine tune performance/accuracy?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385572352/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385578563","html_url":"https://github.com/apache/druid/pull/5712#issuecomment-385578563","issue_url":"https://api.github.com/repos/apache/druid/issues/5712","id":385578563,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTU3ODU2Mw==","user":{"login":"AlexanderSaydakov","id":13126686,"node_id":"MDQ6VXNlcjEzMTI2Njg2","avatar_url":"https://avatars.githubusercontent.com/u/13126686?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexanderSaydakov","html_url":"https://github.com/AlexanderSaydakov","followers_url":"https://api.github.com/users/AlexanderSaydakov/followers","following_url":"https://api.github.com/users/AlexanderSaydakov/following{/other_user}","gists_url":"https://api.github.com/users/AlexanderSaydakov/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexanderSaydakov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexanderSaydakov/subscriptions","organizations_url":"https://api.github.com/users/AlexanderSaydakov/orgs","repos_url":"https://api.github.com/users/AlexanderSaydakov/repos","events_url":"https://api.github.com/users/AlexanderSaydakov/events{/privacy}","received_events_url":"https://api.github.com/users/AlexanderSaydakov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-01T01:42:04Z","updated_at":"2018-05-01T01:42:04Z","author_association":"CONTRIBUTOR","body":"Could you point me to the original one?\r\nOur HllSketch has a parameter K that controls the size-accuracy trade-off.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385578563/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385587309","html_url":"https://github.com/apache/druid/issues/3892#issuecomment-385587309","issue_url":"https://api.github.com/repos/apache/druid/issues/3892","id":385587309,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTU4NzMwOQ==","user":{"login":"b-slim","id":7376396,"node_id":"MDQ6VXNlcjczNzYzOTY=","avatar_url":"https://avatars.githubusercontent.com/u/7376396?v=4","gravatar_id":"","url":"https://api.github.com/users/b-slim","html_url":"https://github.com/b-slim","followers_url":"https://api.github.com/users/b-slim/followers","following_url":"https://api.github.com/users/b-slim/following{/other_user}","gists_url":"https://api.github.com/users/b-slim/gists{/gist_id}","starred_url":"https://api.github.com/users/b-slim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/b-slim/subscriptions","organizations_url":"https://api.github.com/users/b-slim/orgs","repos_url":"https://api.github.com/users/b-slim/repos","events_url":"https://api.github.com/users/b-slim/events{/privacy}","received_events_url":"https://api.github.com/users/b-slim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-01T02:53:05Z","updated_at":"2018-05-01T02:53:05Z","author_association":"CONTRIBUTOR","body":">  how about contributing a helping hand?\r\n\r\n@leerho it will be a great honor and learning experience to help. Am wondering by help you are  referring to  move Memory to be jdk9 compatible or refactor Druid code base to start using The Memory  lib? ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385587309/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385593794","html_url":"https://github.com/apache/druid/pull/5583#issuecomment-385593794","issue_url":"https://api.github.com/repos/apache/druid/issues/5583","id":385593794,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTU5Mzc5NA==","user":{"login":"jihoonson","id":2322288,"node_id":"MDQ6VXNlcjIzMjIyODg=","avatar_url":"https://avatars.githubusercontent.com/u/2322288?v=4","gravatar_id":"","url":"https://api.github.com/users/jihoonson","html_url":"https://github.com/jihoonson","followers_url":"https://api.github.com/users/jihoonson/followers","following_url":"https://api.github.com/users/jihoonson/following{/other_user}","gists_url":"https://api.github.com/users/jihoonson/gists{/gist_id}","starred_url":"https://api.github.com/users/jihoonson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jihoonson/subscriptions","organizations_url":"https://api.github.com/users/jihoonson/orgs","repos_url":"https://api.github.com/users/jihoonson/repos","events_url":"https://api.github.com/users/jihoonson/events{/privacy}","received_events_url":"https://api.github.com/users/jihoonson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-01T03:58:55Z","updated_at":"2018-05-01T03:58:55Z","author_association":"CONTRIBUTOR","body":"I'll finish my review tomorrow.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385593794/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385597747","html_url":"https://github.com/apache/druid/issues/3892#issuecomment-385597747","issue_url":"https://api.github.com/repos/apache/druid/issues/3892","id":385597747,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTU5Nzc0Nw==","user":{"login":"leerho","id":12941506,"node_id":"MDQ6VXNlcjEyOTQxNTA2","avatar_url":"https://avatars.githubusercontent.com/u/12941506?v=4","gravatar_id":"","url":"https://api.github.com/users/leerho","html_url":"https://github.com/leerho","followers_url":"https://api.github.com/users/leerho/followers","following_url":"https://api.github.com/users/leerho/following{/other_user}","gists_url":"https://api.github.com/users/leerho/gists{/gist_id}","starred_url":"https://api.github.com/users/leerho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leerho/subscriptions","organizations_url":"https://api.github.com/users/leerho/orgs","repos_url":"https://api.github.com/users/leerho/repos","events_url":"https://api.github.com/users/leerho/events{/privacy}","received_events_url":"https://api.github.com/users/leerho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-01T04:40:06Z","updated_at":"2018-05-01T04:40:06Z","author_association":"CONTRIBUTOR","body":"You could help by start doing some testing w/ Memory:\r\n\r\n1) Do some testing w/ JDK9.  What are the blockers?  My understanding is that JDK9 allows access to Unsafe, but we have to add some code to access it. How and where do changes need to be made? My concern is that we will have to have a special code base for JDK9 that cannot be used with JDK8.  Please investigate.  You will need to create your own jars from master as the latest code has not been released to Maven Central yet.  Although I hope it will be soon.\r\n2) What about JDK10? Same questions. \r\n3) Once you have some answers as to where it breaks and what we need to do, we can strategize on the best way to go forward.  Don't submit any PR's, it is too early.  If you want to show us code we can look at code on your own repo. \r\n\r\nAs a longer range contribution, you could investigate VarHandles and MethodHandles.  Will they help at all?  I'm not convinced from what I have read, but I have not played with them yet.  If they look promising, you could do some detailed timing characterization and find out how they perform.\r\n\r\nThen there is the OpenJDK Panama Project and JEP 191.  These have been on the sideline for years, but if it they were ever adopted it would make life so much simpler for us.  Do some digging and find out where they are headed and when! Contact John Rose and Charles Nutter... ask them!\r\n\r\nYou could become our migration expert !! :)\r\n \r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385597747/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385731035","html_url":"https://github.com/apache/druid/issues/5725#issuecomment-385731035","issue_url":"https://api.github.com/repos/apache/druid/issues/5725","id":385731035,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTczMTAzNQ==","user":{"login":"dylwylie","id":3107079,"node_id":"MDQ6VXNlcjMxMDcwNzk=","avatar_url":"https://avatars.githubusercontent.com/u/3107079?v=4","gravatar_id":"","url":"https://api.github.com/users/dylwylie","html_url":"https://github.com/dylwylie","followers_url":"https://api.github.com/users/dylwylie/followers","following_url":"https://api.github.com/users/dylwylie/following{/other_user}","gists_url":"https://api.github.com/users/dylwylie/gists{/gist_id}","starred_url":"https://api.github.com/users/dylwylie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dylwylie/subscriptions","organizations_url":"https://api.github.com/users/dylwylie/orgs","repos_url":"https://api.github.com/users/dylwylie/repos","events_url":"https://api.github.com/users/dylwylie/events{/privacy}","received_events_url":"https://api.github.com/users/dylwylie/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-01T17:24:38Z","updated_at":"2018-05-01T17:24:38Z","author_association":"CONTRIBUTOR","body":"Looks to be fixed in 0.12.1 \r\n\r\nhttps://github.com/druid-io/druid/issues/5661","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385731035/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385743545","html_url":"https://github.com/apache/druid/issues/5673#issuecomment-385743545","issue_url":"https://api.github.com/repos/apache/druid/issues/5673","id":385743545,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTc0MzU0NQ==","user":{"login":"jihoonson","id":2322288,"node_id":"MDQ6VXNlcjIzMjIyODg=","avatar_url":"https://avatars.githubusercontent.com/u/2322288?v=4","gravatar_id":"","url":"https://api.github.com/users/jihoonson","html_url":"https://github.com/jihoonson","followers_url":"https://api.github.com/users/jihoonson/followers","following_url":"https://api.github.com/users/jihoonson/following{/other_user}","gists_url":"https://api.github.com/users/jihoonson/gists{/gist_id}","starred_url":"https://api.github.com/users/jihoonson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jihoonson/subscriptions","organizations_url":"https://api.github.com/users/jihoonson/orgs","repos_url":"https://api.github.com/users/jihoonson/repos","events_url":"https://api.github.com/users/jihoonson/events{/privacy}","received_events_url":"https://api.github.com/users/jihoonson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-01T18:07:49Z","updated_at":"2018-05-01T18:07:49Z","author_association":"CONTRIBUTOR","body":"@yorkart can you let us know which unused segments exist for the interval `\"2018-01-02T00:00:00.000+08:00/2018-01-03T00:00:00.000+08:00\"`? You might need to run the below SQL against metastore.\r\n\r\n```\r\nSELECT payload FROM druid_segments WHERE dataSource = 'my-ds' AND start >= '2018-01-02T00:00:00.000+08:00' AND \"end\" <= '2018-01-03T00:00:00.000+08:00 ' AND used = false\r\n```","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385743545/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385764429","html_url":"https://github.com/apache/druid/pull/5148#issuecomment-385764429","issue_url":"https://api.github.com/repos/apache/druid/issues/5148","id":385764429,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTc2NDQyOQ==","user":{"login":"AlexanderSaydakov","id":13126686,"node_id":"MDQ6VXNlcjEzMTI2Njg2","avatar_url":"https://avatars.githubusercontent.com/u/13126686?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexanderSaydakov","html_url":"https://github.com/AlexanderSaydakov","followers_url":"https://api.github.com/users/AlexanderSaydakov/followers","following_url":"https://api.github.com/users/AlexanderSaydakov/following{/other_user}","gists_url":"https://api.github.com/users/AlexanderSaydakov/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexanderSaydakov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexanderSaydakov/subscriptions","organizations_url":"https://api.github.com/users/AlexanderSaydakov/orgs","repos_url":"https://api.github.com/users/AlexanderSaydakov/repos","events_url":"https://api.github.com/users/AlexanderSaydakov/events{/privacy}","received_events_url":"https://api.github.com/users/AlexanderSaydakov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-01T19:25:58Z","updated_at":"2018-05-01T19:25:58Z","author_association":"CONTRIBUTOR","body":"I think I have addressed the review points. The build failure seems to be unrelated to the datasketches extension.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385764429/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385787171","html_url":"https://github.com/apache/druid/pull/5701#issuecomment-385787171","issue_url":"https://api.github.com/repos/apache/druid/issues/5701","id":385787171,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTc4NzE3MQ==","user":{"login":"varaga","id":31006611,"node_id":"MDQ6VXNlcjMxMDA2NjEx","avatar_url":"https://avatars.githubusercontent.com/u/31006611?v=4","gravatar_id":"","url":"https://api.github.com/users/varaga","html_url":"https://github.com/varaga","followers_url":"https://api.github.com/users/varaga/followers","following_url":"https://api.github.com/users/varaga/following{/other_user}","gists_url":"https://api.github.com/users/varaga/gists{/gist_id}","starred_url":"https://api.github.com/users/varaga/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/varaga/subscriptions","organizations_url":"https://api.github.com/users/varaga/orgs","repos_url":"https://api.github.com/users/varaga/repos","events_url":"https://api.github.com/users/varaga/events{/privacy}","received_events_url":"https://api.github.com/users/varaga/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-01T20:54:55Z","updated_at":"2018-05-01T20:54:55Z","author_association":"CONTRIBUTOR","body":"@jihoonson - I'm using eclipse code formatting file as listed in the contributing page. Has that been outdated by any chance?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385787171/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385792480","html_url":"https://github.com/apache/druid/pull/5701#issuecomment-385792480","issue_url":"https://api.github.com/repos/apache/druid/issues/5701","id":385792480,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTc5MjQ4MA==","user":{"login":"jihoonson","id":2322288,"node_id":"MDQ6VXNlcjIzMjIyODg=","avatar_url":"https://avatars.githubusercontent.com/u/2322288?v=4","gravatar_id":"","url":"https://api.github.com/users/jihoonson","html_url":"https://github.com/jihoonson","followers_url":"https://api.github.com/users/jihoonson/followers","following_url":"https://api.github.com/users/jihoonson/following{/other_user}","gists_url":"https://api.github.com/users/jihoonson/gists{/gist_id}","starred_url":"https://api.github.com/users/jihoonson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jihoonson/subscriptions","organizations_url":"https://api.github.com/users/jihoonson/orgs","repos_url":"https://api.github.com/users/jihoonson/repos","events_url":"https://api.github.com/users/jihoonson/events{/privacy}","received_events_url":"https://api.github.com/users/jihoonson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-01T21:14:29Z","updated_at":"2018-05-01T21:14:29Z","author_association":"CONTRIBUTOR","body":"@varaga I don't think so, but it doesn't check everything unfortunately. You should additionally check the code style by comparing with existing codes.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385792480/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385801586","html_url":"https://github.com/apache/druid/pull/5471#issuecomment-385801586","issue_url":"https://api.github.com/repos/apache/druid/issues/5471","id":385801586,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTgwMTU4Ng==","user":{"login":"jihoonson","id":2322288,"node_id":"MDQ6VXNlcjIzMjIyODg=","avatar_url":"https://avatars.githubusercontent.com/u/2322288?v=4","gravatar_id":"","url":"https://api.github.com/users/jihoonson","html_url":"https://github.com/jihoonson","followers_url":"https://api.github.com/users/jihoonson/followers","following_url":"https://api.github.com/users/jihoonson/following{/other_user}","gists_url":"https://api.github.com/users/jihoonson/gists{/gist_id}","starred_url":"https://api.github.com/users/jihoonson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jihoonson/subscriptions","organizations_url":"https://api.github.com/users/jihoonson/orgs","repos_url":"https://api.github.com/users/jihoonson/repos","events_url":"https://api.github.com/users/jihoonson/events{/privacy}","received_events_url":"https://api.github.com/users/jihoonson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-01T21:50:35Z","updated_at":"2018-05-01T21:50:35Z","author_association":"CONTRIBUTOR","body":"@samarthjain I found the location of test data is in the sql file. You can find it by searching bucket and key. Since the bucket is public, you should be able to download them. Once you download them, you can check data by using [DumpSegment tool](http://druid.io/docs/latest/operations/dump-segment.html).","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385801586/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385821549","html_url":"https://github.com/apache/druid/issues/5729#issuecomment-385821549","issue_url":"https://api.github.com/repos/apache/druid/issues/5729","id":385821549,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTgyMTU0OQ==","user":{"login":"jihoonson","id":2322288,"node_id":"MDQ6VXNlcjIzMjIyODg=","avatar_url":"https://avatars.githubusercontent.com/u/2322288?v=4","gravatar_id":"","url":"https://api.github.com/users/jihoonson","html_url":"https://github.com/jihoonson","followers_url":"https://api.github.com/users/jihoonson/followers","following_url":"https://api.github.com/users/jihoonson/following{/other_user}","gists_url":"https://api.github.com/users/jihoonson/gists{/gist_id}","starred_url":"https://api.github.com/users/jihoonson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jihoonson/subscriptions","organizations_url":"https://api.github.com/users/jihoonson/orgs","repos_url":"https://api.github.com/users/jihoonson/repos","events_url":"https://api.github.com/users/jihoonson/events{/privacy}","received_events_url":"https://api.github.com/users/jihoonson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-01T23:37:36Z","updated_at":"2018-05-01T23:37:36Z","author_association":"CONTRIBUTOR","body":"@pjain1 any thoughts?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385821549/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385833585","html_url":"https://github.com/apache/druid/pull/5730#issuecomment-385833585","issue_url":"https://api.github.com/repos/apache/druid/issues/5730","id":385833585,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTgzMzU4NQ==","user":{"login":"b-slim","id":7376396,"node_id":"MDQ6VXNlcjczNzYzOTY=","avatar_url":"https://avatars.githubusercontent.com/u/7376396?v=4","gravatar_id":"","url":"https://api.github.com/users/b-slim","html_url":"https://github.com/b-slim","followers_url":"https://api.github.com/users/b-slim/followers","following_url":"https://api.github.com/users/b-slim/following{/other_user}","gists_url":"https://api.github.com/users/b-slim/gists{/gist_id}","starred_url":"https://api.github.com/users/b-slim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/b-slim/subscriptions","organizations_url":"https://api.github.com/users/b-slim/orgs","repos_url":"https://api.github.com/users/b-slim/repos","events_url":"https://api.github.com/users/b-slim/events{/privacy}","received_events_url":"https://api.github.com/users/b-slim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-02T00:55:29Z","updated_at":"2018-05-02T00:55:29Z","author_association":"CONTRIBUTOR","body":"@jihoonson i think it is still useful to keep that method public maybe in some other cases you want to persist one by one, i think we should keep that method public and fix whatever need to be fixed.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385833585/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385834272","html_url":"https://github.com/apache/druid/pull/5730#issuecomment-385834272","issue_url":"https://api.github.com/repos/apache/druid/issues/5730","id":385834272,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTgzNDI3Mg==","user":{"login":"jihoonson","id":2322288,"node_id":"MDQ6VXNlcjIzMjIyODg=","avatar_url":"https://avatars.githubusercontent.com/u/2322288?v=4","gravatar_id":"","url":"https://api.github.com/users/jihoonson","html_url":"https://github.com/jihoonson","followers_url":"https://api.github.com/users/jihoonson/followers","following_url":"https://api.github.com/users/jihoonson/following{/other_user}","gists_url":"https://api.github.com/users/jihoonson/gists{/gist_id}","starred_url":"https://api.github.com/users/jihoonson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jihoonson/subscriptions","organizations_url":"https://api.github.com/users/jihoonson/orgs","repos_url":"https://api.github.com/users/jihoonson/repos","events_url":"https://api.github.com/users/jihoonson/events{/privacy}","received_events_url":"https://api.github.com/users/jihoonson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-02T00:59:46Z","updated_at":"2018-05-02T00:59:46Z","author_association":"CONTRIBUTOR","body":"@b-slim I can't imagine any case. Do you have anything in your mind? \r\n\r\nIf we don't know exactly when it can be used, I think it would be better to remove to avoid mistakenly using a wrong method.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385834272/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385834395","html_url":"https://github.com/apache/druid/pull/5730#issuecomment-385834395","issue_url":"https://api.github.com/repos/apache/druid/issues/5730","id":385834395,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTgzNDM5NQ==","user":{"login":"jihoonson","id":2322288,"node_id":"MDQ6VXNlcjIzMjIyODg=","avatar_url":"https://avatars.githubusercontent.com/u/2322288?v=4","gravatar_id":"","url":"https://api.github.com/users/jihoonson","html_url":"https://github.com/jihoonson","followers_url":"https://api.github.com/users/jihoonson/followers","following_url":"https://api.github.com/users/jihoonson/following{/other_user}","gists_url":"https://api.github.com/users/jihoonson/gists{/gist_id}","starred_url":"https://api.github.com/users/jihoonson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jihoonson/subscriptions","organizations_url":"https://api.github.com/users/jihoonson/orgs","repos_url":"https://api.github.com/users/jihoonson/repos","events_url":"https://api.github.com/users/jihoonson/events{/privacy}","received_events_url":"https://api.github.com/users/jihoonson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-02T01:00:37Z","updated_at":"2018-05-02T01:00:37Z","author_association":"CONTRIBUTOR","body":"BTW, the unit test failure might be related even though it passed when I ran it locally. I'll check it.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385834395/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385834636","html_url":"https://github.com/apache/druid/pull/5730#issuecomment-385834636","issue_url":"https://api.github.com/repos/apache/druid/issues/5730","id":385834636,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTgzNDYzNg==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-02T01:02:28Z","updated_at":"2018-05-02T01:02:28Z","author_association":"CONTRIBUTOR","body":"IMO, the method is broken by design and it makes sense to get rid of it (at least if you are using commit metadata). If you are using commit metadata, you need to persist all segments at once, since the commit metadata is not related to any particular segment.\r\n\r\nIt could make sense to call `persist` for one segment at a time if you don't care about tracking metadata, but I don't see a reason to keep it around just for this. We don't have a use case for this behavior so it's all basically dead code.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385834636/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385838996","html_url":"https://github.com/apache/druid/pull/5706#issuecomment-385838996","issue_url":"https://api.github.com/repos/apache/druid/issues/5706","id":385838996,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTgzODk5Ng==","user":{"login":"b-slim","id":7376396,"node_id":"MDQ6VXNlcjczNzYzOTY=","avatar_url":"https://avatars.githubusercontent.com/u/7376396?v=4","gravatar_id":"","url":"https://api.github.com/users/b-slim","html_url":"https://github.com/b-slim","followers_url":"https://api.github.com/users/b-slim/followers","following_url":"https://api.github.com/users/b-slim/following{/other_user}","gists_url":"https://api.github.com/users/b-slim/gists{/gist_id}","starred_url":"https://api.github.com/users/b-slim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/b-slim/subscriptions","organizations_url":"https://api.github.com/users/b-slim/orgs","repos_url":"https://api.github.com/users/b-slim/repos","events_url":"https://api.github.com/users/b-slim/events{/privacy}","received_events_url":"https://api.github.com/users/b-slim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-02T01:32:58Z","updated_at":"2018-05-02T01:32:58Z","author_association":"CONTRIBUTOR","body":"done","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385838996/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385844576","html_url":"https://github.com/apache/druid/pull/5706#issuecomment-385844576","issue_url":"https://api.github.com/repos/apache/druid/issues/5706","id":385844576,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTg0NDU3Ng==","user":{"login":"jon-wei","id":8729063,"node_id":"MDQ6VXNlcjg3MjkwNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8729063?v=4","gravatar_id":"","url":"https://api.github.com/users/jon-wei","html_url":"https://github.com/jon-wei","followers_url":"https://api.github.com/users/jon-wei/followers","following_url":"https://api.github.com/users/jon-wei/following{/other_user}","gists_url":"https://api.github.com/users/jon-wei/gists{/gist_id}","starred_url":"https://api.github.com/users/jon-wei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jon-wei/subscriptions","organizations_url":"https://api.github.com/users/jon-wei/orgs","repos_url":"https://api.github.com/users/jon-wei/repos","events_url":"https://api.github.com/users/jon-wei/events{/privacy}","received_events_url":"https://api.github.com/users/jon-wei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-02T02:12:26Z","updated_at":"2018-05-02T02:12:26Z","author_association":"CONTRIBUTOR","body":"Great, LGTM after CI","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385844576/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385852830","html_url":"https://github.com/apache/druid/issues/5709#issuecomment-385852830","issue_url":"https://api.github.com/repos/apache/druid/issues/5709","id":385852830,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTg1MjgzMA==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-02T03:12:00Z","updated_at":"2018-05-02T03:12:00Z","author_association":"CONTRIBUTOR","body":"Hmm, I was imagining the blacklisting piggybacking off of normal queries. So if normal queries fail more than typical on some node (compared to other nodes) then put it on a blacklist and only query it if we have to. (Prefer replicas on other nodes.) I guess what I had in mind is more of a graylist, since we should probably still query the node if it's the _only_ source for a given segment (since maybe it'll work?).","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385852830/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385884283","html_url":"https://github.com/apache/druid/pull/5730#issuecomment-385884283","issue_url":"https://api.github.com/repos/apache/druid/issues/5730","id":385884283,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTg4NDI4Mw==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-02T07:08:17Z","updated_at":"2018-05-02T07:08:17Z","author_association":"CONTRIBUTOR","body":"LGTM other than the adjustment to the javadocs.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385884283/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/385884813","html_url":"https://github.com/apache/druid/issues/1209#issuecomment-385884813","issue_url":"https://api.github.com/repos/apache/druid/issues/1209","id":385884813,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTg4NDgxMw==","user":{"login":"mentholi","id":1844254,"node_id":"MDQ6VXNlcjE4NDQyNTQ=","avatar_url":"https://avatars.githubusercontent.com/u/1844254?v=4","gravatar_id":"","url":"https://api.github.com/users/mentholi","html_url":"https://github.com/mentholi","followers_url":"https://api.github.com/users/mentholi/followers","following_url":"https://api.github.com/users/mentholi/following{/other_user}","gists_url":"https://api.github.com/users/mentholi/gists{/gist_id}","starred_url":"https://api.github.com/users/mentholi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mentholi/subscriptions","organizations_url":"https://api.github.com/users/mentholi/orgs","repos_url":"https://api.github.com/users/mentholi/repos","events_url":"https://api.github.com/users/mentholi/events{/privacy}","received_events_url":"https://api.github.com/users/mentholi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-02T07:10:48Z","updated_at":"2018-05-02T07:10:48Z","author_association":"NONE","body":"@pdeva Do you still remember what was your issue with this? I have exactly same problem and cannot figure it out.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/385884813/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/386011312","html_url":"https://github.com/apache/druid/pull/5730#issuecomment-386011312","issue_url":"https://api.github.com/repos/apache/druid/issues/5730","id":386011312,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NjAxMTMxMg==","user":{"login":"b-slim","id":7376396,"node_id":"MDQ6VXNlcjczNzYzOTY=","avatar_url":"https://avatars.githubusercontent.com/u/7376396?v=4","gravatar_id":"","url":"https://api.github.com/users/b-slim","html_url":"https://github.com/b-slim","followers_url":"https://api.github.com/users/b-slim/followers","following_url":"https://api.github.com/users/b-slim/following{/other_user}","gists_url":"https://api.github.com/users/b-slim/gists{/gist_id}","starred_url":"https://api.github.com/users/b-slim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/b-slim/subscriptions","organizations_url":"https://api.github.com/users/b-slim/orgs","repos_url":"https://api.github.com/users/b-slim/repos","events_url":"https://api.github.com/users/b-slim/events{/privacy}","received_events_url":"https://api.github.com/users/b-slim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-02T15:08:20Z","updated_at":"2018-05-02T15:08:20Z","author_association":"CONTRIBUTOR","body":">  If you are using commit metadata, you need to persist all segments at once, since the commit metadata is not related to any particular segment.\r\n\r\n@gianm please help me to understand this, if we can not do a persist of some segments (in-memory) how we can do a push of subset of segments via ``` ListenableFuture<SegmentsAndMetadata> push(Collection<SegmentIdentifier> identifiers, @Nullable Committer committer);``` ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/386011312/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]