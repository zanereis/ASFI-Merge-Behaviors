[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/976096428","html_url":"https://github.com/apache/iceberg/pull/3477#issuecomment-976096428","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3477","id":976096428,"node_id":"IC_kwDOCW7NX846Lgys","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-23T01:50:19Z","updated_at":"2021-11-23T01:50:19Z","author_association":"MEMBER","body":"@rdblue , I think this conversation is a good material to read for this PR's background: https://github.com/apache/iceberg/pull/3240/files#r736304982","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/976096428/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/976098897","html_url":"https://github.com/apache/iceberg/pull/3548#issuecomment-976098897","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3548","id":976098897,"node_id":"IC_kwDOCW7NX846LhZR","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-23T01:59:13Z","updated_at":"2021-11-23T01:59:13Z","author_association":"MEMBER","body":"OK! Time to merge, thanks for the contribution @xinbinhuang !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/976098897/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/976107298","html_url":"https://github.com/apache/iceberg/pull/3589#issuecomment-976107298","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3589","id":976107298,"node_id":"IC_kwDOCW7NX846Ljci","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-23T02:25:14Z","updated_at":"2021-11-23T02:25:14Z","author_association":"MEMBER","body":"@rdblue : I have pushed the changes by pointing `remove_orphan_files` and `delete_orphan_files` to use DeleteOrphanFilesProcedure to avoid breaking change.\r\nAlso added the note in `spark-Procedures.md`","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/976107298/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/976176296","html_url":"https://github.com/apache/iceberg/pull/3548#issuecomment-976176296","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3548","id":976176296,"node_id":"IC_kwDOCW7NX846L0So","user":{"login":"xinbinhuang","id":27927454,"node_id":"MDQ6VXNlcjI3OTI3NDU0","avatar_url":"https://avatars.githubusercontent.com/u/27927454?v=4","gravatar_id":"","url":"https://api.github.com/users/xinbinhuang","html_url":"https://github.com/xinbinhuang","followers_url":"https://api.github.com/users/xinbinhuang/followers","following_url":"https://api.github.com/users/xinbinhuang/following{/other_user}","gists_url":"https://api.github.com/users/xinbinhuang/gists{/gist_id}","starred_url":"https://api.github.com/users/xinbinhuang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xinbinhuang/subscriptions","organizations_url":"https://api.github.com/users/xinbinhuang/orgs","repos_url":"https://api.github.com/users/xinbinhuang/repos","events_url":"https://api.github.com/users/xinbinhuang/events{/privacy}","received_events_url":"https://api.github.com/users/xinbinhuang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-23T05:20:42Z","updated_at":"2021-11-23T05:20:42Z","author_association":"CONTRIBUTOR","body":"Thank you all for reviewing and giving feedback!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/976176296/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/976178715","html_url":"https://github.com/apache/iceberg/issues/3586#issuecomment-976178715","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3586","id":976178715,"node_id":"IC_kwDOCW7NX846L04b","user":{"login":"dubeme","id":1667350,"node_id":"MDQ6VXNlcjE2NjczNTA=","avatar_url":"https://avatars.githubusercontent.com/u/1667350?v=4","gravatar_id":"","url":"https://api.github.com/users/dubeme","html_url":"https://github.com/dubeme","followers_url":"https://api.github.com/users/dubeme/followers","following_url":"https://api.github.com/users/dubeme/following{/other_user}","gists_url":"https://api.github.com/users/dubeme/gists{/gist_id}","starred_url":"https://api.github.com/users/dubeme/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dubeme/subscriptions","organizations_url":"https://api.github.com/users/dubeme/orgs","repos_url":"https://api.github.com/users/dubeme/repos","events_url":"https://api.github.com/users/dubeme/events{/privacy}","received_events_url":"https://api.github.com/users/dubeme/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-23T05:28:12Z","updated_at":"2021-11-23T05:28:12Z","author_association":"CONTRIBUTOR","body":"Cool... I just created this small PR #3597","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/976178715/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/976203057","html_url":"https://github.com/apache/iceberg/pull/2210#issuecomment-976203057","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2210","id":976203057,"node_id":"IC_kwDOCW7NX846L60x","user":{"login":"talgos1","id":54764035,"node_id":"MDQ6VXNlcjU0NzY0MDM1","avatar_url":"https://avatars.githubusercontent.com/u/54764035?v=4","gravatar_id":"","url":"https://api.github.com/users/talgos1","html_url":"https://github.com/talgos1","followers_url":"https://api.github.com/users/talgos1/followers","following_url":"https://api.github.com/users/talgos1/following{/other_user}","gists_url":"https://api.github.com/users/talgos1/gists{/gist_id}","starred_url":"https://api.github.com/users/talgos1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/talgos1/subscriptions","organizations_url":"https://api.github.com/users/talgos1/orgs","repos_url":"https://api.github.com/users/talgos1/repos","events_url":"https://api.github.com/users/talgos1/events{/privacy}","received_events_url":"https://api.github.com/users/talgos1/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-23T06:42:54Z","updated_at":"2021-11-23T06:43:05Z","author_association":"NONE","body":"> @talgos1, have you tried using a full file path as the source table?\r\n\r\n@rdblue \r\nUsing the `CALL` command, it expects the source to have same partition spec as destination (got an error the source has no partitions)\r\n\r\nSince my last comment, I succeeded doing that using the spark and java APIs and explicitly defining a synthetic SparkPartition for the file/path\r\n```scala\r\n// Define the source file\r\nval uri = \"/some/path/to/orc/file.orc\"\r\nval format = \"orc\"\r\nval partitionSpec: util.Map[String, String] = Map(\"some_partition_key\" -> \"some_partition_value\").asJava\r\n// Define a synthetic spark partition\r\nval sparkPartition = new SparkPartition(partitionSpec, uri,  format)\r\n\r\n// Do the add call for importing partitioned source table\r\nSparkTableUtil.importSparkPartitions(spark, Seq(sparkPartition).asJava, table, spec, stagingDir)\r\n```\r\n\r\nWDYT?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/976203057/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/976231559","html_url":"https://github.com/apache/iceberg/pull/3561#issuecomment-976231559","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3561","id":976231559,"node_id":"IC_kwDOCW7NX846MByH","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-23T07:50:28Z","updated_at":"2021-11-23T07:50:28Z","author_association":"CONTRIBUTOR","body":"> > Have you thought about/considered something like https://github.com/eclipse/microprofile-open-api (just an example, but there are other libs available as well), which allows you to add OpenAPI annotations directly to your Java code, so that the OpenAPI spec+docs and the code are all at one place?\r\n> \r\n> Right now, the main thing is to have something to discuss, and being able to paste this file into the swagger UI makes it really easy to discuss the API.\r\n\r\nAgreed that having the pure Swagger API definition for discussion is probably the best. I was rather thinking long term and how we want to approach that.\r\n\r\n> \r\n> Longer term, I'm not sure what the best path will be to maintain the API definition, but I'm really reluctant to publish whatever happens to be in the Java implementation through annotations. While that's an easy way to keep the code and the definition in sync, it is probably not a great way to manage a specification that is portable. It's too easy to refactor Java and make unintended changes to the OpenAPI spec, right? Maybe I'm wrong here, but it seems easy to mess up the API that way.\r\n\r\nIt can be indeed easy to change the OpenAPI spec by changing/refactoring Java stuff. An approach to mitigating this would be to generate the Swagger API definition to a folder that is version-controlled and always commit that API definition as well. That way we could spot those changes.\r\nAlternatively, we could have the REST API code be generated from the Swagger definition. \r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/976231559/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/976924211","html_url":"https://github.com/apache/iceberg/pull/3561#issuecomment-976924211","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3561","id":976924211,"node_id":"IC_kwDOCW7NX846Oq4z","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-23T17:44:49Z","updated_at":"2021-11-23T17:44:49Z","author_association":"CONTRIBUTOR","body":"We were thinking more along the lines of the second option, having the REST API code generated from the Swagger definition. But I'm flexible as long as we have an OpenAPI source of truth and make sure we don't make accidental changes to it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/976924211/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/976952062","html_url":"https://github.com/apache/iceberg/pull/3600#issuecomment-976952062","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3600","id":976952062,"node_id":"IC_kwDOCW7NX846Oxr-","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-23T18:05:25Z","updated_at":"2021-11-23T18:05:25Z","author_association":"CONTRIBUTOR","body":"cc @rdblue @jackye1995 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/976952062/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/976957380","html_url":"https://github.com/apache/iceberg/pull/3584#issuecomment-976957380","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3584","id":976957380,"node_id":"IC_kwDOCW7NX846Oy_E","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-23T18:09:11Z","updated_at":"2021-11-23T18:09:11Z","author_association":"CONTRIBUTOR","body":"I've submitted an alternative solution in #3600 as this one did not cover all use cases. Let me know if I am overthinking it too. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/976957380/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/976978804","html_url":"https://github.com/apache/iceberg/pull/3600#issuecomment-976978804","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3600","id":976978804,"node_id":"IC_kwDOCW7NX846O4N0","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-23T18:27:06Z","updated_at":"2021-11-23T18:27:31Z","author_association":"CONTRIBUTOR","body":"I'll adapt Spark 3.0 code as needed later. Please ignore the test failures for 3.0.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/976978804/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/977288400","html_url":"https://github.com/apache/iceberg/pull/2210#issuecomment-977288400","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2210","id":977288400,"node_id":"IC_kwDOCW7NX846QDzQ","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-23T23:44:28Z","updated_at":"2021-11-23T23:44:28Z","author_association":"CONTRIBUTOR","body":"I'm glad you were able to find a way to get it working! We may want to update this so that we can detect when there's only a single file and handle that case. But in the meantime, it looks like this is a good way to get it working using the API directly.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/977288400/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":1,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/977326148","html_url":"https://github.com/apache/iceberg/pull/3597#issuecomment-977326148","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3597","id":977326148,"node_id":"IC_kwDOCW7NX846QNBE","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-24T00:51:02Z","updated_at":"2021-11-24T00:51:02Z","author_association":"CONTRIBUTOR","body":"Thanks for working on this, @dubeme!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/977326148/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/977396506","html_url":"https://github.com/apache/iceberg/pull/3450#issuecomment-977396506","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3450","id":977396506,"node_id":"IC_kwDOCW7NX846QeMa","user":{"login":"jun-he","id":12246263,"node_id":"MDQ6VXNlcjEyMjQ2MjYz","avatar_url":"https://avatars.githubusercontent.com/u/12246263?v=4","gravatar_id":"","url":"https://api.github.com/users/jun-he","html_url":"https://github.com/jun-he","followers_url":"https://api.github.com/users/jun-he/followers","following_url":"https://api.github.com/users/jun-he/following{/other_user}","gists_url":"https://api.github.com/users/jun-he/gists{/gist_id}","starred_url":"https://api.github.com/users/jun-he/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jun-he/subscriptions","organizations_url":"https://api.github.com/users/jun-he/orgs","repos_url":"https://api.github.com/users/jun-he/repos","events_url":"https://api.github.com/users/jun-he/events{/privacy}","received_events_url":"https://api.github.com/users/jun-he/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-24T02:04:36Z","updated_at":"2021-11-24T02:04:36Z","author_association":"COLLABORATOR","body":"@rdblue Thanks for the review. I updated the code based on the comments. Can you take another look?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/977396506/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/977397856","html_url":"https://github.com/apache/iceberg/pull/3432#issuecomment-977397856","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3432","id":977397856,"node_id":"IC_kwDOCW7NX846Qehg","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-24T02:07:50Z","updated_at":"2021-11-24T02:07:50Z","author_association":"CONTRIBUTOR","body":"For anyone interested, I have updated the doc based on all the work we have done in this area, please let me know if there is any new comments","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/977397856/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/977427488","html_url":"https://github.com/apache/iceberg/issues/3599#issuecomment-977427488","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3599","id":977427488,"node_id":"IC_kwDOCW7NX846Qlwg","user":{"login":"Reo-LEI","id":17312872,"node_id":"MDQ6VXNlcjE3MzEyODcy","avatar_url":"https://avatars.githubusercontent.com/u/17312872?v=4","gravatar_id":"","url":"https://api.github.com/users/Reo-LEI","html_url":"https://github.com/Reo-LEI","followers_url":"https://api.github.com/users/Reo-LEI/followers","following_url":"https://api.github.com/users/Reo-LEI/following{/other_user}","gists_url":"https://api.github.com/users/Reo-LEI/gists{/gist_id}","starred_url":"https://api.github.com/users/Reo-LEI/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Reo-LEI/subscriptions","organizations_url":"https://api.github.com/users/Reo-LEI/orgs","repos_url":"https://api.github.com/users/Reo-LEI/repos","events_url":"https://api.github.com/users/Reo-LEI/events{/privacy}","received_events_url":"https://api.github.com/users/Reo-LEI/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-24T02:31:39Z","updated_at":"2021-11-24T02:31:39Z","author_association":"CONTRIBUTOR","body":"Is this table created under the Iceberg catalog? From the result, this looks like a normal flink table. Can you post the complete SQL statement? @fengsen-neu ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/977427488/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/977541758","html_url":"https://github.com/apache/iceberg/pull/3207#issuecomment-977541758","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3207","id":977541758,"node_id":"IC_kwDOCW7NX846RBp-","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-24T05:18:39Z","updated_at":"2021-11-24T05:18:39Z","author_association":"CONTRIBUTOR","body":"close because we have added the support through `delete-file-threshold` and `use-starting-sequence-number`","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/977541758/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/977549837","html_url":"https://github.com/apache/iceberg/issues/1378#issuecomment-977549837","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1378","id":977549837,"node_id":"IC_kwDOCW7NX846RDoN","user":{"login":"KarlManong","id":2627662,"node_id":"MDQ6VXNlcjI2Mjc2NjI=","avatar_url":"https://avatars.githubusercontent.com/u/2627662?v=4","gravatar_id":"","url":"https://api.github.com/users/KarlManong","html_url":"https://github.com/KarlManong","followers_url":"https://api.github.com/users/KarlManong/followers","following_url":"https://api.github.com/users/KarlManong/following{/other_user}","gists_url":"https://api.github.com/users/KarlManong/gists{/gist_id}","starred_url":"https://api.github.com/users/KarlManong/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/KarlManong/subscriptions","organizations_url":"https://api.github.com/users/KarlManong/orgs","repos_url":"https://api.github.com/users/KarlManong/repos","events_url":"https://api.github.com/users/KarlManong/events{/privacy}","received_events_url":"https://api.github.com/users/KarlManong/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-24T05:38:43Z","updated_at":"2021-11-24T05:38:43Z","author_association":"CONTRIBUTOR","body":"I got the same issue when using version 0.12.1 on spark 3.1.2 executed by kyuubi.\r\n\r\n```\r\nDriver stacktrace:\r\n\r\n        at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2258)\r\n\r\n        at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2207)\r\n\r\n        at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2206)\r\n\r\n        at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)\r\n\r\n        at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)\r\n\r\n        at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)\r\n\r\n        at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2206)\r\n\r\n        at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1079)\r\n\r\n        at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1079)\r\n\r\n        at scala.Option.foreach(Option.scala:407)\r\n\r\n        at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1079)\r\n\r\n        at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:2445)\r\n\r\n        at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2387)\r\n\r\n        at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2376)\r\n\r\n        at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)\r\n\r\n        at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:868)\r\n\r\n        at org.apache.spark.SparkContext.runJob(SparkContext.scala:2196)\r\n\r\n        at org.apache.spark.SparkContext.runJob(SparkContext.scala:2217)\r\n\r\n        at org.apache.spark.SparkContext.runJob(SparkContext.scala:2236)\r\n\r\n        at org.apache.spark.SparkContext.runJob(SparkContext.scala:2261)\r\n\r\n        at org.apache.spark.rdd.RDD.$anonfun$collect$1(RDD.scala:1030)\r\n\r\n        at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\r\n\r\n        at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)\r\n\r\n        at org.apache.spark.rdd.RDD.withScope(RDD.scala:414)\r\n\r\n        at org.apache.spark.rdd.RDD.collect(RDD.scala:1029)\r\n\r\n        at org.apache.spark.sql.execution.SparkPlan.executeCollect(SparkPlan.scala:390)\r\n\r\n        at org.apache.spark.sql.Dataset.collectFromPlan(Dataset.scala:3697)\r\n\r\n        at org.apache.spark.sql.Dataset.$anonfun$collect$1(Dataset.scala:2966)\r\n\r\n        at org.apache.spark.sql.Dataset.$anonfun$withAction$1(Dataset.scala:3688)\r\n\r\n        at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$5(SQLExecution.scala:103)\r\n\r\n        at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:163)\r\n\r\n        at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:90)\r\n\r\n        at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:775)\r\n\r\n        at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:64)\r\n\r\n        at org.apache.spark.sql.Dataset.withAction(Dataset.scala:3686)\r\n\r\n        at org.apache.spark.sql.Dataset.collect(Dataset.scala:2966)\r\n\r\n        at org.apache.kyuubi.engine.spark.operation.ExecuteStatement.$anonfun$executeStatement$1(ExecuteStatement.scala:88)\r\n\r\n        at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)\r\n\r\n        at org.apache.kyuubi.engine.spark.operation.ExecuteStatement.withLocalProperties(ExecuteStatement.scala:134)\r\n\r\n        at org.apache.kyuubi.engine.spark.operation.ExecuteStatement.org$apache$kyuubi$engine$spark$operation$ExecuteStatement$$executeStatement(ExecuteStatement.scala:80)\r\n\r\n        at org.apache.kyuubi.engine.spark.operation.ExecuteStatement$$anon$1.run(ExecuteStatement.scala:103)\r\n\r\n        at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source)\r\n\r\n        at java.base/java.util.concurrent.FutureTask.run(Unknown Source)\r\n\r\n        at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)\r\n\r\n        at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)\r\n\r\n        at java.base/java.lang.Thread.run(Unknown Source)\r\n\r\nCaused by: java.lang.IllegalArgumentException: Missing required field: data_file\r\n\r\n        at org.apache.iceberg.relocated.com.google.common.base.Preconditions.checkArgument(Preconditions.java:217)\r\n\r\n        at org.apache.iceberg.avro.BuildAvroProjection.record(BuildAvroProjection.java:99)\r\n\r\n        at org.apache.iceberg.avro.BuildAvroProjection.record(BuildAvroProjection.java:43)\r\n\r\n        at org.apache.iceberg.avro.AvroCustomOrderSchemaVisitor.visit(AvroCustomOrderSchemaVisitor.java:51)\r\n\r\n        at org.apache.iceberg.avro.AvroSchemaUtil.buildAvroProjection(AvroSchemaUtil.java:105)\r\n\r\n        at org.apache.iceberg.avro.ProjectionDatumReader.setSchema(ProjectionDatumReader.java:68)\r\n\r\n        at org.apache.iceberg.shaded.org.apache.avro.file.DataFileStream.initialize(DataFileStream.java:133)\r\n\r\n        at org.apache.iceberg.shaded.org.apache.avro.file.DataFileReader.<init>(DataFileReader.java:130)\r\n\r\n        at org.apache.iceberg.shaded.org.apache.avro.file.DataFileReader.<init>(DataFileReader.java:122)\r\n\r\n        at org.apache.iceberg.shaded.org.apache.avro.file.DataFileReader.openReader(DataFileReader.java:66)\r\n\r\n        at org.apache.iceberg.avro.AvroIterable.newFileReader(AvroIterable.java:100)\r\n\r\n        at org.apache.iceberg.avro.AvroIterable.iterator(AvroIterable.java:77)\r\n\r\n        at org.apache.iceberg.io.CloseableIterable$4$1.<init>(CloseableIterable.java:99)\r\n\r\n        at org.apache.iceberg.io.CloseableIterable$4.iterator(CloseableIterable.java:98)\r\n\r\n        at org.apache.iceberg.io.CloseableIterable.lambda$filter$0(CloseableIterable.java:79)\r\n\r\n        at org.apache.iceberg.io.CloseableIterable$2.iterator(CloseableIterable.java:73)\r\n\r\n        at org.apache.iceberg.io.CloseableIterable$4$1.<init>(CloseableIterable.java:99)\r\n\r\n        at org.apache.iceberg.io.CloseableIterable$4.iterator(CloseableIterable.java:98)\r\n\r\n        at org.apache.iceberg.ManifestReader.iterator(ManifestReader.java:233)\r\n\r\n        at org.apache.iceberg.io.CloseableIterable$4$1.<init>(CloseableIterable.java:99)\r\n\r\n        at org.apache.iceberg.io.CloseableIterable$4.iterator(CloseableIterable.java:98)\r\n\r\n        at org.apache.iceberg.io.CloseableIterable$4$1.<init>(CloseableIterable.java:99)\r\n\r\n        at org.apache.iceberg.io.CloseableIterable$4.iterator(CloseableIterable.java:98)\r\n\r\n        at org.apache.iceberg.io.CloseableIterable$4.iterator(CloseableIterable.java:90)\r\n\r\n        at org.apache.iceberg.util.Filter.lambda$filter$0(Filter.java:35)\r\n\r\n        at org.apache.iceberg.io.CloseableIterable$2.iterator(CloseableIterable.java:73)\r\n\r\n        at org.apache.iceberg.spark.source.RowDataReader.open(RowDataReader.java:78)\r\n\r\n        at org.apache.iceberg.spark.source.BaseDataReader.next(BaseDataReader.java:93)\r\n\r\n        at org.apache.spark.sql.execution.datasources.v2.PartitionIterator.hasNext(DataSourceRDD.scala:79)\r\n\r\n        at org.apache.spark.sql.execution.datasources.v2.MetricsIterator.hasNext(DataSourceRDD.scala:112)\r\n\r\n        at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)\r\n\r\n        at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:458)\r\n\r\n        at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.agg_doAggregateWithoutKey_1$(Unknown Source)\r\n\r\n        at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.agg_doAggregateWithoutKey_0$(Unknown Source)\r\n\r\n        at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)\r\n\r\n        at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)\r\n\r\n        at org.apache.spark.sql.execution.WholeStageCodegenExec$$anon$1.hasNext(WholeStageCodegenExec.scala:755)\r\n\r\n        at org.apache.spark.sql.execution.SparkPlan.$anonfun$getByteArrayRdd$1(SparkPlan.scala:345)\r\n\r\n        at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:898)\r\n\r\n        at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:898)\r\n\r\n        at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)\r\n\r\n        at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:373)\r\n\r\n        at org.apache.spark.rdd.RDD.iterator(RDD.scala:337)\r\n\r\n        at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:90)\r\n\r\n        at org.apache.spark.scheduler.Task.run(Task.scala:131)\r\n\r\n        at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$3(Executor.scala:498)\r\n\r\n        at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1439)\r\n\r\n        at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:501)\r\n\r\n        ... 3 more (state=,code=0)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/977549837/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/977574577","html_url":"https://github.com/apache/iceberg/issues/1378#issuecomment-977574577","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1378","id":977574577,"node_id":"IC_kwDOCW7NX846RJqx","user":{"login":"KarlManong","id":2627662,"node_id":"MDQ6VXNlcjI2Mjc2NjI=","avatar_url":"https://avatars.githubusercontent.com/u/2627662?v=4","gravatar_id":"","url":"https://api.github.com/users/KarlManong","html_url":"https://github.com/KarlManong","followers_url":"https://api.github.com/users/KarlManong/followers","following_url":"https://api.github.com/users/KarlManong/following{/other_user}","gists_url":"https://api.github.com/users/KarlManong/gists{/gist_id}","starred_url":"https://api.github.com/users/KarlManong/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/KarlManong/subscriptions","organizations_url":"https://api.github.com/users/KarlManong/orgs","repos_url":"https://api.github.com/users/KarlManong/repos","events_url":"https://api.github.com/users/KarlManong/events{/privacy}","received_events_url":"https://api.github.com/users/KarlManong/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-24T06:35:00Z","updated_at":"2021-11-24T06:35:00Z","author_association":"CONTRIBUTOR","body":"A very brief Test is here: \r\n```java\r\n/*\r\n * Licensed to the Apache Software Foundation (ASF) under one\r\n * or more contributor license agreements.  See the NOTICE file\r\n * distributed with this work for additional information\r\n * regarding copyright ownership.  The ASF licenses this file\r\n * to you under the Apache License, Version 2.0 (the\r\n * \"License\"); you may not use this file except in compliance\r\n * with the License.  You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing,\r\n * software distributed under the License is distributed on an\r\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n * KIND, either express or implied.  See the License for the\r\n * specific language governing permissions and limitations\r\n * under the License.\r\n */\r\n\r\npackage org.apache.iceberg.spark.sql;\r\n\r\nimport java.util.Map;\r\nimport org.apache.iceberg.spark.SparkCatalogTestBase;\r\nimport org.junit.After;\r\nimport org.junit.Before;\r\nimport org.junit.Test;\r\nimport org.junit.jupiter.api.Assertions;\r\n\r\nimport static org.hamcrest.CoreMatchers.instanceOf;\r\nimport static org.hamcrest.MatcherAssert.assertThat;\r\nimport static org.junit.jupiter.api.Assertions.fail;\r\n\r\npublic class TestPartitionedTable extends SparkCatalogTestBase {\r\n  public TestPartitionedTable(String catalogName, String implementation, Map<String, String> config) {\r\n    super(catalogName, implementation, config);\r\n  }\r\n\r\n  @Before\r\n  public void createTables() {\r\n    sql(\r\n        \"CREATE TABLE %s (id bigint, data string, create_date date) USING iceberg PARTITIONED BY (days(create_date))\",\r\n        tableName);\r\n    sql(\r\n        \"INSERT INTO %s VALUES (1, 'a', date '2021-11-11'), (2, 'b', date '2021-11-11'), (3, 'c', date '2021-11-11')\",\r\n        tableName);\r\n  }\r\n\r\n  @After\r\n  public void removeTables() {\r\n    sql(\"DROP TABLE IF EXISTS %s\", tableName);\r\n  }\r\n\r\n  @Test\r\n  public void testCount() {\r\n    try {\r\n      sql(\"SELECT count(1) FROM %s.files\", tableName);\r\n      fail(\"No exception!\");\r\n    } catch (Exception e) {\r\n      Throwable cause = e.getCause();\r\n      assertThat(cause, instanceOf(IllegalArgumentException.class));\r\n      Assertions.assertEquals(\"Missing required field: data_file\", cause.getMessage());\r\n    }\r\n  }\r\n}\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/977574577/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/977579447","html_url":"https://github.com/apache/iceberg/issues/1378#issuecomment-977579447","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1378","id":977579447,"node_id":"IC_kwDOCW7NX846RK23","user":{"login":"KarlManong","id":2627662,"node_id":"MDQ6VXNlcjI2Mjc2NjI=","avatar_url":"https://avatars.githubusercontent.com/u/2627662?v=4","gravatar_id":"","url":"https://api.github.com/users/KarlManong","html_url":"https://github.com/KarlManong","followers_url":"https://api.github.com/users/KarlManong/followers","following_url":"https://api.github.com/users/KarlManong/following{/other_user}","gists_url":"https://api.github.com/users/KarlManong/gists{/gist_id}","starred_url":"https://api.github.com/users/KarlManong/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/KarlManong/subscriptions","organizations_url":"https://api.github.com/users/KarlManong/orgs","repos_url":"https://api.github.com/users/KarlManong/repos","events_url":"https://api.github.com/users/KarlManong/events{/privacy}","received_events_url":"https://api.github.com/users/KarlManong/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-24T06:45:24Z","updated_at":"2021-11-24T06:45:24Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer Could you please have a look?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/977579447/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/977617796","html_url":"https://github.com/apache/iceberg/pull/3425#issuecomment-977617796","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3425","id":977617796,"node_id":"IC_kwDOCW7NX846RUOE","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-24T07:53:20Z","updated_at":"2021-11-24T07:53:20Z","author_association":"CONTRIBUTOR","body":"Sorry for the delayed reply @rymurr @nastra @omarsmak @harshm-dev @ajantha-bhat \r\n\r\nI have updated based on the comments and also replied questions in the design doc, please let me know if there is any further question.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/977617796/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/977642780","html_url":"https://github.com/apache/iceberg/pull/2598#issuecomment-977642780","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2598","id":977642780,"node_id":"IC_kwDOCW7NX846RaUc","user":{"login":"wangyinsheng","id":13392313,"node_id":"MDQ6VXNlcjEzMzkyMzEz","avatar_url":"https://avatars.githubusercontent.com/u/13392313?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyinsheng","html_url":"https://github.com/wangyinsheng","followers_url":"https://api.github.com/users/wangyinsheng/followers","following_url":"https://api.github.com/users/wangyinsheng/following{/other_user}","gists_url":"https://api.github.com/users/wangyinsheng/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyinsheng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyinsheng/subscriptions","organizations_url":"https://api.github.com/users/wangyinsheng/orgs","repos_url":"https://api.github.com/users/wangyinsheng/repos","events_url":"https://api.github.com/users/wangyinsheng/events{/privacy}","received_events_url":"https://api.github.com/users/wangyinsheng/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-24T08:26:54Z","updated_at":"2021-11-24T08:26:54Z","author_association":"CONTRIBUTOR","body":"@edgarRd I got the same exception, is there any update?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/977642780/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/977718918","html_url":"https://github.com/apache/iceberg/pull/2217#issuecomment-977718918","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2217","id":977718918,"node_id":"IC_kwDOCW7NX846Rs6G","user":{"login":"MichaelTiemannOSC","id":72577720,"node_id":"MDQ6VXNlcjcyNTc3NzIw","avatar_url":"https://avatars.githubusercontent.com/u/72577720?v=4","gravatar_id":"","url":"https://api.github.com/users/MichaelTiemannOSC","html_url":"https://github.com/MichaelTiemannOSC","followers_url":"https://api.github.com/users/MichaelTiemannOSC/followers","following_url":"https://api.github.com/users/MichaelTiemannOSC/following{/other_user}","gists_url":"https://api.github.com/users/MichaelTiemannOSC/gists{/gist_id}","starred_url":"https://api.github.com/users/MichaelTiemannOSC/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MichaelTiemannOSC/subscriptions","organizations_url":"https://api.github.com/users/MichaelTiemannOSC/orgs","repos_url":"https://api.github.com/users/MichaelTiemannOSC/repos","events_url":"https://api.github.com/users/MichaelTiemannOSC/events{/privacy}","received_events_url":"https://api.github.com/users/MichaelTiemannOSC/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-24T10:00:31Z","updated_at":"2021-11-24T10:00:31Z","author_association":"NONE","body":"Has this PR gone dormant due to acceptance of [#2210?](https://github.com/apache/iceberg/pull/2210)\r\n\r\nI'm using a Trino environment where it's easy to write Hive parquet files from pandas, but I haven't found the fast path from pandas to Iceberg.  (Row-by-row insertion is too slow.)  I'm here because I thought table migration might be an answer...","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/977718918/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/977799683","html_url":"https://github.com/apache/iceberg/pull/2217#issuecomment-977799683","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2217","id":977799683,"node_id":"IC_kwDOCW7NX846SAoD","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-24T11:44:31Z","updated_at":"2021-11-24T11:44:31Z","author_association":"CONTRIBUTOR","body":"> I'm using a Trino environment where it's easy to write Hive parquet files from pandas, but I haven't found the fast path from pandas to Iceberg. (Row-by-row insertion is too slow.) I'm here because I thought table migration might be an answer...\r\n\r\nWe implemented Hive(external) to Iceberg migration in the Hive repo: https://issues.apache.org/jira/browse/HIVE-25008\r\n\r\nNot sure it helps you, but just for the record is someone stumbles to this issue again\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/977799683/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/977801969","html_url":"https://github.com/apache/iceberg/issues/3599#issuecomment-977801969","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3599","id":977801969,"node_id":"IC_kwDOCW7NX846SBLx","user":{"login":"fengsen-neu","id":58256617,"node_id":"MDQ6VXNlcjU4MjU2NjE3","avatar_url":"https://avatars.githubusercontent.com/u/58256617?v=4","gravatar_id":"","url":"https://api.github.com/users/fengsen-neu","html_url":"https://github.com/fengsen-neu","followers_url":"https://api.github.com/users/fengsen-neu/followers","following_url":"https://api.github.com/users/fengsen-neu/following{/other_user}","gists_url":"https://api.github.com/users/fengsen-neu/gists{/gist_id}","starred_url":"https://api.github.com/users/fengsen-neu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fengsen-neu/subscriptions","organizations_url":"https://api.github.com/users/fengsen-neu/orgs","repos_url":"https://api.github.com/users/fengsen-neu/repos","events_url":"https://api.github.com/users/fengsen-neu/events{/privacy}","received_events_url":"https://api.github.com/users/fengsen-neu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-24T11:47:48Z","updated_at":"2021-11-24T11:49:08Z","author_association":"NONE","body":"> Is this table created under the Iceberg catalog? From the result, this looks like a normal flink table. Can you post the complete SQL statement? @fengsen-neu\r\n@Reo-LEI \r\n![image](https://user-images.githubusercontent.com/58256617/143232615-9e39e61f-11fb-4f7a-89ea-9cca37222cfe.png)\r\n![image](https://user-images.githubusercontent.com/58256617/143232951-6924d868-be78-466f-a4d7-42cf08567110.png)\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/977801969/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/977975664","html_url":"https://github.com/apache/iceberg/issues/1378#issuecomment-977975664","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1378","id":977975664,"node_id":"IC_kwDOCW7NX846Srlw","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-24T15:19:31Z","updated_at":"2021-11-24T15:19:31Z","author_association":"MEMBER","body":"Should be fixed with https://github.com/apache/iceberg/pull/2953","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/977975664/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/978082796","html_url":"https://github.com/apache/iceberg/issues/1378#issuecomment-978082796","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1378","id":978082796,"node_id":"IC_kwDOCW7NX846TFvs","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-24T17:26:42Z","updated_at":"2021-11-24T17:26:42Z","author_association":"CONTRIBUTOR","body":"@KarlManong, can you try with the current master?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/978082796/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/978119415","html_url":"https://github.com/apache/iceberg/issues/3246#issuecomment-978119415","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3246","id":978119415,"node_id":"IC_kwDOCW7NX846TOr3","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-24T18:18:57Z","updated_at":"2021-11-24T18:18:57Z","author_association":"CONTRIBUTOR","body":"I'm closing this because `GC_ENABLED` already implements what we want.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/978119415/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/978173854","html_url":"https://github.com/apache/iceberg/pull/3602#issuecomment-978173854","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3602","id":978173854,"node_id":"IC_kwDOCW7NX846Tb-e","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-24T19:48:20Z","updated_at":"2021-11-24T19:48:20Z","author_association":"CONTRIBUTOR","body":"Thanks, @openinx!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/978173854/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/978176764","html_url":"https://github.com/apache/iceberg/pull/3590#issuecomment-978176764","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3590","id":978176764,"node_id":"IC_kwDOCW7NX846Tcr8","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-24T19:53:19Z","updated_at":"2021-11-24T19:53:19Z","author_association":"CONTRIBUTOR","body":"Thanks for reviewing, @jackye1995!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/978176764/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/978177518","html_url":"https://github.com/apache/iceberg/pull/3593#issuecomment-978177518","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3593","id":978177518,"node_id":"IC_kwDOCW7NX846Tc3u","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-24T19:54:32Z","updated_at":"2021-11-24T19:54:32Z","author_association":"CONTRIBUTOR","body":"Thanks for the reviews, everyone! I'm going to merge this and we can consider adding dynamic configuration as an additional feature.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/978177518/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/978313699","html_url":"https://github.com/apache/iceberg/pull/3425#issuecomment-978313699","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3425","id":978313699,"node_id":"IC_kwDOCW7NX846T-Hj","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-24T22:04:52Z","updated_at":"2021-11-24T22:04:52Z","author_association":"CONTRIBUTOR","body":"@rdblue thanks for the detailed review, I have made the following changes:\r\n\r\n1. `refs` is changed to a map type given the fact that all reference names must be unique in the table\r\n2. `max-ref-age-ms` is added\r\n3. `current-branch` is removed\r\n2. I removed the `snapshot tagging and branching` page for now to make this more focused on the spec change, and moved retention policy into the spec. I will continue to edit the page based on your suggestions, but I think it's better to have that published after the `UpdateSnapshotReference` API is implemented, so we can also provide code snippets for the specific use cases.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/978313699/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/978729793","html_url":"https://github.com/apache/iceberg/issues/3599#issuecomment-978729793","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3599","id":978729793,"node_id":"IC_kwDOCW7NX846VjtB","user":{"login":"fengsen-neu","id":58256617,"node_id":"MDQ6VXNlcjU4MjU2NjE3","avatar_url":"https://avatars.githubusercontent.com/u/58256617?v=4","gravatar_id":"","url":"https://api.github.com/users/fengsen-neu","html_url":"https://github.com/fengsen-neu","followers_url":"https://api.github.com/users/fengsen-neu/followers","following_url":"https://api.github.com/users/fengsen-neu/following{/other_user}","gists_url":"https://api.github.com/users/fengsen-neu/gists{/gist_id}","starred_url":"https://api.github.com/users/fengsen-neu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fengsen-neu/subscriptions","organizations_url":"https://api.github.com/users/fengsen-neu/orgs","repos_url":"https://api.github.com/users/fengsen-neu/repos","events_url":"https://api.github.com/users/fengsen-neu/events{/privacy}","received_events_url":"https://api.github.com/users/fengsen-neu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-25T01:57:13Z","updated_at":"2021-11-25T01:57:13Z","author_association":"NONE","body":"Don't the primary key contain unique constraints within the same partition or snapshot? if not, what't the primary key used for? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/978729793/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/978732259","html_url":"https://github.com/apache/iceberg/issues/3599#issuecomment-978732259","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3599","id":978732259,"node_id":"IC_kwDOCW7NX846VkTj","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-25T02:04:08Z","updated_at":"2021-11-25T02:04:08Z","author_association":"MEMBER","body":"@fengsen-neu ,  You will need to make sure those PR got merged in your flink-iceberg-runtime libarary [1], [2]. And enable the switch `write.upsert.enabled=true`.   It will recommend to use the apache iceberg master branch to build the runtime library.\r\n\r\n[1]. https://github.com/apache/iceberg/pull/3504/files#diff-5620e28d3a7d13259b12e251b9eca2f59c66fd3ab96d6b62c36062f1f5ac0ca1R251\r\n[2]. https://github.com/apache/iceberg/pull/2863\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/978732259/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/978769688","html_url":"https://github.com/apache/iceberg/issues/1378#issuecomment-978769688","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1378","id":978769688,"node_id":"IC_kwDOCW7NX846VtcY","user":{"login":"KarlManong","id":2627662,"node_id":"MDQ6VXNlcjI2Mjc2NjI=","avatar_url":"https://avatars.githubusercontent.com/u/2627662?v=4","gravatar_id":"","url":"https://api.github.com/users/KarlManong","html_url":"https://github.com/KarlManong","followers_url":"https://api.github.com/users/KarlManong/followers","following_url":"https://api.github.com/users/KarlManong/following{/other_user}","gists_url":"https://api.github.com/users/KarlManong/gists{/gist_id}","starred_url":"https://api.github.com/users/KarlManong/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/KarlManong/subscriptions","organizations_url":"https://api.github.com/users/KarlManong/orgs","repos_url":"https://api.github.com/users/KarlManong/repos","events_url":"https://api.github.com/users/KarlManong/events{/privacy}","received_events_url":"https://api.github.com/users/KarlManong/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-25T02:39:11Z","updated_at":"2021-11-25T02:39:21Z","author_association":"CONTRIBUTOR","body":"> Should be fixed with #2953\r\n\r\nconfirmed.\r\n\r\nThank U !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/978769688/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/978795501","html_url":"https://github.com/apache/iceberg/issues/3604#issuecomment-978795501","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3604","id":978795501,"node_id":"IC_kwDOCW7NX846Vzvt","user":{"login":"zhongyujiang","id":42907416,"node_id":"MDQ6VXNlcjQyOTA3NDE2","avatar_url":"https://avatars.githubusercontent.com/u/42907416?v=4","gravatar_id":"","url":"https://api.github.com/users/zhongyujiang","html_url":"https://github.com/zhongyujiang","followers_url":"https://api.github.com/users/zhongyujiang/followers","following_url":"https://api.github.com/users/zhongyujiang/following{/other_user}","gists_url":"https://api.github.com/users/zhongyujiang/gists{/gist_id}","starred_url":"https://api.github.com/users/zhongyujiang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhongyujiang/subscriptions","organizations_url":"https://api.github.com/users/zhongyujiang/orgs","repos_url":"https://api.github.com/users/zhongyujiang/repos","events_url":"https://api.github.com/users/zhongyujiang/events{/privacy}","received_events_url":"https://api.github.com/users/zhongyujiang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-25T03:34:55Z","updated_at":"2021-11-25T03:34:55Z","author_association":"CONTRIBUTOR","body":"In #3605, ApplyNameMapping builds list/map type with the originally name for return, which  solves the conflicts while reading migrated Iceberg table mentioned in this issue, @chenjunjiedada @rdblue  can you help review this pr? Thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/978795501/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/978817124","html_url":"https://github.com/apache/iceberg/pull/3000#issuecomment-978817124","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3000","id":978817124,"node_id":"IC_kwDOCW7NX846V5Bk","user":{"login":"smallx","id":16517035,"node_id":"MDQ6VXNlcjE2NTE3MDM1","avatar_url":"https://avatars.githubusercontent.com/u/16517035?v=4","gravatar_id":"","url":"https://api.github.com/users/smallx","html_url":"https://github.com/smallx","followers_url":"https://api.github.com/users/smallx/followers","following_url":"https://api.github.com/users/smallx/following{/other_user}","gists_url":"https://api.github.com/users/smallx/gists{/gist_id}","starred_url":"https://api.github.com/users/smallx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/smallx/subscriptions","organizations_url":"https://api.github.com/users/smallx/orgs","repos_url":"https://api.github.com/users/smallx/repos","events_url":"https://api.github.com/users/smallx/events{/privacy}","received_events_url":"https://api.github.com/users/smallx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-25T04:21:43Z","updated_at":"2021-11-25T04:21:43Z","author_association":"CONTRIBUTOR","body":"close this, i will create a new pr","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/978817124/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/978818800","html_url":"https://github.com/apache/iceberg/issues/3507#issuecomment-978818800","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3507","id":978818800,"node_id":"IC_kwDOCW7NX846V5bw","user":{"login":"ayush-san","id":57655135,"node_id":"MDQ6VXNlcjU3NjU1MTM1","avatar_url":"https://avatars.githubusercontent.com/u/57655135?v=4","gravatar_id":"","url":"https://api.github.com/users/ayush-san","html_url":"https://github.com/ayush-san","followers_url":"https://api.github.com/users/ayush-san/followers","following_url":"https://api.github.com/users/ayush-san/following{/other_user}","gists_url":"https://api.github.com/users/ayush-san/gists{/gist_id}","starred_url":"https://api.github.com/users/ayush-san/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ayush-san/subscriptions","organizations_url":"https://api.github.com/users/ayush-san/orgs","repos_url":"https://api.github.com/users/ayush-san/repos","events_url":"https://api.github.com/users/ayush-san/events{/privacy}","received_events_url":"https://api.github.com/users/ayush-san/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-25T04:26:26Z","updated_at":"2021-11-25T04:26:26Z","author_association":"NONE","body":"@openinx My tables were already created in v2 format using 0.11.x iceberg version. Now after the release of 0.12.1, I wanted to move my flow to it. \r\n\r\nCan you suggest how can I do that now? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/978818800/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/978847678","html_url":"https://github.com/apache/iceberg/pull/3606#issuecomment-978847678","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3606","id":978847678,"node_id":"IC_kwDOCW7NX846WAe-","user":{"login":"smallx","id":16517035,"node_id":"MDQ6VXNlcjE2NTE3MDM1","avatar_url":"https://avatars.githubusercontent.com/u/16517035?v=4","gravatar_id":"","url":"https://api.github.com/users/smallx","html_url":"https://github.com/smallx","followers_url":"https://api.github.com/users/smallx/followers","following_url":"https://api.github.com/users/smallx/following{/other_user}","gists_url":"https://api.github.com/users/smallx/gists{/gist_id}","starred_url":"https://api.github.com/users/smallx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/smallx/subscriptions","organizations_url":"https://api.github.com/users/smallx/orgs","repos_url":"https://api.github.com/users/smallx/repos","events_url":"https://api.github.com/users/smallx/events{/privacy}","received_events_url":"https://api.github.com/users/smallx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-25T05:27:31Z","updated_at":"2021-11-25T05:27:31Z","author_association":"CONTRIBUTOR","body":"@kbendick @pvary Can you help me to run github workflows, thanks.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/978847678/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/978918750","html_url":"https://github.com/apache/iceberg/pull/3605#issuecomment-978918750","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3605","id":978918750,"node_id":"IC_kwDOCW7NX846WR1e","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-25T07:49:58Z","updated_at":"2021-11-25T07:49:58Z","author_association":"COLLABORATOR","body":"Looks correct, could you please add a unit test for this？ ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/978918750/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/979258365","html_url":"https://github.com/apache/iceberg/issues/3599#issuecomment-979258365","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3599","id":979258365,"node_id":"IC_kwDOCW7NX846Xkv9","user":{"login":"fengsen-neu","id":58256617,"node_id":"MDQ6VXNlcjU4MjU2NjE3","avatar_url":"https://avatars.githubusercontent.com/u/58256617?v=4","gravatar_id":"","url":"https://api.github.com/users/fengsen-neu","html_url":"https://github.com/fengsen-neu","followers_url":"https://api.github.com/users/fengsen-neu/followers","following_url":"https://api.github.com/users/fengsen-neu/following{/other_user}","gists_url":"https://api.github.com/users/fengsen-neu/gists{/gist_id}","starred_url":"https://api.github.com/users/fengsen-neu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fengsen-neu/subscriptions","organizations_url":"https://api.github.com/users/fengsen-neu/orgs","repos_url":"https://api.github.com/users/fengsen-neu/repos","events_url":"https://api.github.com/users/fengsen-neu/events{/privacy}","received_events_url":"https://api.github.com/users/fengsen-neu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-25T14:26:10Z","updated_at":"2021-11-25T14:26:10Z","author_association":"NONE","body":"> @fengsen-neu , You will need to make sure those PR got merged in your flink-iceberg-runtime libarary [1], [2]. And enable the switch `write.upsert.enabled=true`. It will recommend to use the apache iceberg master branch to build the runtime library.\r\n> \r\n> [1]. https://github.com/apache/iceberg/pull/3504/files#diff-5620e28d3a7d13259b12e251b9eca2f59c66fd3ab96d6b62c36062f1f5ac0ca1R251 [2]. #2863\r\n\r\n@openinx Thank you very much, it works.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/979258365/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/979424495","html_url":"https://github.com/apache/iceberg/issues/3607#issuecomment-979424495","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3607","id":979424495,"node_id":"IC_kwDOCW7NX846YNTv","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-25T18:56:17Z","updated_at":"2021-11-25T18:56:17Z","author_association":"MEMBER","body":"The match expressions are not pushed down and are only applied to the result of the \"ON\" join clause. This means any pushdowns you want need to occur in the \"ON\" clause. So in your case you can just add \"part_date_col\" predicate  into the \"on\" restriction and it should push down as you expect.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/979424495/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/979709616","html_url":"https://github.com/apache/iceberg/pull/3608#issuecomment-979709616","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3608","id":979709616,"node_id":"IC_kwDOCW7NX846ZS6w","user":{"login":"felixYyu","id":3785228,"node_id":"MDQ6VXNlcjM3ODUyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3785228?v=4","gravatar_id":"","url":"https://api.github.com/users/felixYyu","html_url":"https://github.com/felixYyu","followers_url":"https://api.github.com/users/felixYyu/followers","following_url":"https://api.github.com/users/felixYyu/following{/other_user}","gists_url":"https://api.github.com/users/felixYyu/gists{/gist_id}","starred_url":"https://api.github.com/users/felixYyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixYyu/subscriptions","organizations_url":"https://api.github.com/users/felixYyu/orgs","repos_url":"https://api.github.com/users/felixYyu/repos","events_url":"https://api.github.com/users/felixYyu/events{/privacy}","received_events_url":"https://api.github.com/users/felixYyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-26T05:39:21Z","updated_at":"2021-11-26T05:39:21Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer can you review this pr, thanks you very much.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/979709616/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/979833271","html_url":"https://github.com/apache/iceberg/pull/3459#issuecomment-979833271","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3459","id":979833271,"node_id":"IC_kwDOCW7NX846ZxG3","user":{"login":"KnightChess","id":20125927,"node_id":"MDQ6VXNlcjIwMTI1OTI3","avatar_url":"https://avatars.githubusercontent.com/u/20125927?v=4","gravatar_id":"","url":"https://api.github.com/users/KnightChess","html_url":"https://github.com/KnightChess","followers_url":"https://api.github.com/users/KnightChess/followers","following_url":"https://api.github.com/users/KnightChess/following{/other_user}","gists_url":"https://api.github.com/users/KnightChess/gists{/gist_id}","starred_url":"https://api.github.com/users/KnightChess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/KnightChess/subscriptions","organizations_url":"https://api.github.com/users/KnightChess/orgs","repos_url":"https://api.github.com/users/KnightChess/repos","events_url":"https://api.github.com/users/KnightChess/events{/privacy}","received_events_url":"https://api.github.com/users/KnightChess/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-26T09:49:36Z","updated_at":"2021-11-26T09:49:36Z","author_association":"CONTRIBUTOR","body":"When solve #3609 , I think maybe ShowPartitionExec need use \"maximal\" spec like https://github.com/apache/iceberg/pull/3609#discussion_r757336415 to format partitionData instead of use `partitionSchema()`when using iceberg table","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/979833271/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/979879684","html_url":"https://github.com/apache/iceberg/issues/2456#issuecomment-979879684","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2456","id":979879684,"node_id":"IC_kwDOCW7NX846Z8cE","user":{"login":"redsnow1992","id":6743846,"node_id":"MDQ6VXNlcjY3NDM4NDY=","avatar_url":"https://avatars.githubusercontent.com/u/6743846?v=4","gravatar_id":"","url":"https://api.github.com/users/redsnow1992","html_url":"https://github.com/redsnow1992","followers_url":"https://api.github.com/users/redsnow1992/followers","following_url":"https://api.github.com/users/redsnow1992/following{/other_user}","gists_url":"https://api.github.com/users/redsnow1992/gists{/gist_id}","starred_url":"https://api.github.com/users/redsnow1992/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/redsnow1992/subscriptions","organizations_url":"https://api.github.com/users/redsnow1992/orgs","repos_url":"https://api.github.com/users/redsnow1992/repos","events_url":"https://api.github.com/users/redsnow1992/events{/privacy}","received_events_url":"https://api.github.com/users/redsnow1992/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-26T10:55:50Z","updated_at":"2021-11-26T10:55:50Z","author_association":"NONE","body":"`coalesce` the nullable field can change to not null\r\nlike `coalesce(field, not_null)`","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/979879684/reactions","total_count":4,"+1":4,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/979966157","html_url":"https://github.com/apache/iceberg/pull/3596#issuecomment-979966157","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3596","id":979966157,"node_id":"IC_kwDOCW7NX846aRjN","user":{"login":"xingbowu","id":12458911,"node_id":"MDQ6VXNlcjEyNDU4OTEx","avatar_url":"https://avatars.githubusercontent.com/u/12458911?v=4","gravatar_id":"","url":"https://api.github.com/users/xingbowu","html_url":"https://github.com/xingbowu","followers_url":"https://api.github.com/users/xingbowu/followers","following_url":"https://api.github.com/users/xingbowu/following{/other_user}","gists_url":"https://api.github.com/users/xingbowu/gists{/gist_id}","starred_url":"https://api.github.com/users/xingbowu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xingbowu/subscriptions","organizations_url":"https://api.github.com/users/xingbowu/orgs","repos_url":"https://api.github.com/users/xingbowu/repos","events_url":"https://api.github.com/users/xingbowu/events{/privacy}","received_events_url":"https://api.github.com/users/xingbowu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-26T13:07:54Z","updated_at":"2021-11-26T13:07:54Z","author_association":"CONTRIBUTOR","body":"> Looks like we will need to set few attributions for the `AliyunOSSMockRule` when constructing the mock rule by `testRule = AliyunOSSMockRule.builder().silent().build();` in here https://github.com/apache/iceberg/pull/3596/files#diff-3062807bde819a7913ca06f9e5a400aa27187f4fdac49bcf2d33b72dc2adba64R59\r\n> \r\n> Will the system environment variable `ALIYUN_TEST_OSS_TEST_RULE_CLASS` also work for the `AliyunOSSMockRule` ?\r\n\r\n`AliyunOSSMockRule` can be default behavior and 'ALIYUN_TEST_OSS_TEST_RULE_CLASS' works for `OSSIntegrationTestRule`","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/979966157/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/980120712","html_url":"https://github.com/apache/iceberg/pull/3612#issuecomment-980120712","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3612","id":980120712,"node_id":"IC_kwDOCW7NX846a3SI","user":{"login":"hameizi","id":18445460,"node_id":"MDQ6VXNlcjE4NDQ1NDYw","avatar_url":"https://avatars.githubusercontent.com/u/18445460?v=4","gravatar_id":"","url":"https://api.github.com/users/hameizi","html_url":"https://github.com/hameizi","followers_url":"https://api.github.com/users/hameizi/followers","following_url":"https://api.github.com/users/hameizi/following{/other_user}","gists_url":"https://api.github.com/users/hameizi/gists{/gist_id}","starred_url":"https://api.github.com/users/hameizi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hameizi/subscriptions","organizations_url":"https://api.github.com/users/hameizi/orgs","repos_url":"https://api.github.com/users/hameizi/repos","events_url":"https://api.github.com/users/hameizi/events{/privacy}","received_events_url":"https://api.github.com/users/hameizi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-26T16:40:51Z","updated_at":"2021-11-26T16:40:51Z","author_association":"CONTRIBUTOR","body":"@jackye1995 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/980120712/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/980327279","html_url":"https://github.com/apache/iceberg/pull/3579#issuecomment-980327279","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3579","id":980327279,"node_id":"IC_kwDOCW7NX846bptv","user":{"login":"rymurr","id":2022305,"node_id":"MDQ6VXNlcjIwMjIzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/2022305?v=4","gravatar_id":"","url":"https://api.github.com/users/rymurr","html_url":"https://github.com/rymurr","followers_url":"https://api.github.com/users/rymurr/followers","following_url":"https://api.github.com/users/rymurr/following{/other_user}","gists_url":"https://api.github.com/users/rymurr/gists{/gist_id}","starred_url":"https://api.github.com/users/rymurr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rymurr/subscriptions","organizations_url":"https://api.github.com/users/rymurr/orgs","repos_url":"https://api.github.com/users/rymurr/repos","events_url":"https://api.github.com/users/rymurr/events{/privacy}","received_events_url":"https://api.github.com/users/rymurr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-26T19:18:26Z","updated_at":"2021-11-26T19:18:26Z","author_association":"CONTRIBUTOR","body":"I like the idea of getting them from the iceberg catalog. I am trying to do that now but I am not sure how to cleanly. `Procedure` and associated classes all rely explicitly on Spark so the Iceberg `Catalog` can't extend `ProcedureCatalog` directly. I am wondering about adding a method something like `Class procedureCatalog(String executionEngine)` to `Catalog` via a new interface. This could return the class for a custom procedure catalog that `SparkCatalog` or equivalent for other engines could use to instantiate new procedures. Thoughts?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/980327279/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/980383960","html_url":"https://github.com/apache/iceberg/pull/3580#issuecomment-980383960","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3580","id":980383960,"node_id":"IC_kwDOCW7NX846b3jY","user":{"login":"rymurr","id":2022305,"node_id":"MDQ6VXNlcjIwMjIzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/2022305?v=4","gravatar_id":"","url":"https://api.github.com/users/rymurr","html_url":"https://github.com/rymurr","followers_url":"https://api.github.com/users/rymurr/followers","following_url":"https://api.github.com/users/rymurr/following{/other_user}","gists_url":"https://api.github.com/users/rymurr/gists{/gist_id}","starred_url":"https://api.github.com/users/rymurr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rymurr/subscriptions","organizations_url":"https://api.github.com/users/rymurr/orgs","repos_url":"https://api.github.com/users/rymurr/repos","events_url":"https://api.github.com/users/rymurr/events{/privacy}","received_events_url":"https://api.github.com/users/rymurr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-26T20:03:54Z","updated_at":"2021-11-26T20:03:54Z","author_association":"CONTRIBUTOR","body":"I quite like immutables and I think its very flexible. Especially for serde stuff. This would simplify a lot of our data objects and would introduce a bit of certainty/good practices into them w/ the immutability guarantees. However, it probably makes sense to start w/ a less critical object than `TableMetadata` as a proof of concept.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/980383960/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/980404118","html_url":"https://github.com/apache/iceberg/pull/3326#issuecomment-980404118","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3326","id":980404118,"node_id":"IC_kwDOCW7NX846b8eW","user":{"login":"rymurr","id":2022305,"node_id":"MDQ6VXNlcjIwMjIzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/2022305?v=4","gravatar_id":"","url":"https://api.github.com/users/rymurr","html_url":"https://github.com/rymurr","followers_url":"https://api.github.com/users/rymurr/followers","following_url":"https://api.github.com/users/rymurr/following{/other_user}","gists_url":"https://api.github.com/users/rymurr/gists{/gist_id}","starred_url":"https://api.github.com/users/rymurr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rymurr/subscriptions","organizations_url":"https://api.github.com/users/rymurr/orgs","repos_url":"https://api.github.com/users/rymurr/repos","events_url":"https://api.github.com/users/rymurr/events{/privacy}","received_events_url":"https://api.github.com/users/rymurr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-26T20:19:24Z","updated_at":"2021-11-26T20:19:24Z","author_association":"CONTRIBUTOR","body":"Hey @harshm-dev personally I am +0 on this change. I think it would be really good to rationalise the `type` and `catalog-*` parameters and this does so. I am not sure how other people are using these fields and if its disruptive or not. What do others think?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/980404118/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/980423958","html_url":"https://github.com/apache/iceberg/pull/3326#issuecomment-980423958","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3326","id":980423958,"node_id":"IC_kwDOCW7NX846cBUW","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-26T20:35:24Z","updated_at":"2021-11-26T20:57:57Z","author_association":"CONTRIBUTOR","body":"> Thanks for the change Harsh! I've been thinking a lot about this change and I like it but I think it also highlights a confusing or awkward part of the Spark configuration. `type` and `catalog-type` kinda mean the same thing and when to use which is probably not super obvious for an end user. I wonder if we could deprecate one of them (my vote would be to deprecate `type`) and compare the other against first the Enum you've defined below and if no matches then look up the class name via reflection.\r\n\r\nI too have some concern about restricting the ability for people to make additional catalogs, though I do like standardizing the configs with specific naming patterns for reasons I'll outline below.\r\n\r\nBut TLDR: I agree with @rymurr that it seems we're heading further away from the direction of a general `catalog-impl`, which I think should be the foundation so that things are built in such a way that more options can be included.\r\n\r\nI think in time, as Iceberg grows to be a more common piece of people's architecture, we'll likely see more 3rd party connectors that can't be open sourced for whatever reason or where it wouldn't make sense to integrate them into the main repository due to licensing issues. It's imported to ensure these folks have an integration path for more widespread adoption.\r\n\r\nI really do appreciate the contribution @harshm-dev, and will admit for a while I felt this was the better way to go, but thinking on it more I'm in agreement with @rymurr and feel that this might be steering us away from the general case of `catalog-impl` (notes below on an example).\r\n\r\nBut I'd consider waiting until the Thanksgiving holiday is over in the US (so at least next week) for last thoughts from others before closing this PR @harshmdev. There might be use cases I'm missing where this makes sense and is a valuable addition to keeping `catalog-impl` (eg possibly with trino which does require more declared up front AFAIK or something else I'm not quite seeing).\r\n\r\n\r\n__**Specific concerns** (specific argument for general `catalog-impl` - feel free to skip)__:\r\n\r\nAs far as configs go, I have had some concerns with the Flink catalog builder API. I'll grab the specific classes and open an issue if need be.\r\n\r\nThe newer Flink connector API requires configuration options to be declared (both required and optional). We currently implement against the deprecated interface but long term we'll have to move off. The new API doesn't seem to allow the `*` option we presently use (last I checked at least). In order to make specific catalog configs work for catalogs that aren't part of Iceberg's distributed source / aren't \"well known types\", I currently feel we should move further in the direction of standardizing on a configuration format that can be specified by `catalog-impl` and then allow that to hook in at runtime to Flinks configuration declaration, etc. I'm very open to alternative arguments though.\r\n\r\nIf we continue to have to support `catalog-impl`, it should probably be the first class concept so that things like the above don't get missed for the base case.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/980423958/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/980434126","html_url":"https://github.com/apache/iceberg/pull/3326#issuecomment-980434126","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3326","id":980434126,"node_id":"IC_kwDOCW7NX846cDzO","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-26T21:02:40Z","updated_at":"2021-11-26T21:02:40Z","author_association":"CONTRIBUTOR","body":"> If we're using this method for few known types (hive/hadoop), why not do it for all the known types?\r\n\r\nI wasn't part of the discussion then, but it seems `type` is more for backwards compatibility as there's already a large number of jobs in existence from the days when `type` was the only config.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/980434126/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/980438934","html_url":"https://github.com/apache/iceberg/pull/3326#issuecomment-980438934","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3326","id":980438934,"node_id":"IC_kwDOCW7NX846cE-W","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-26T21:19:32Z","updated_at":"2021-11-26T21:21:10Z","author_association":"CONTRIBUTOR","body":"> Hey @harshm-dev personally I am +0 on this change. I think it would be really good to rationalise the `type` and `catalog-*` parameters and this does so. I am not sure how other people are using these fields and if its disruptive or not. What do others think?\r\n\r\nI'm +0 and as stated would like to do a deeper look across all engines on how configs are provided and needed. I know for example my knowledge in Hive on Tez / map-reduce (classic Hive) is limited.\r\n\r\nOne thing that breaking out enums or additional interfaces might help with is adding the ability to instantiate catalogs in situations where user's don't have `Configuration` on their classpath (e.g. with some Flink environments as one example). Right now `catalog-impl` has a dependency on `Configurable` but in some cases that's not necessary (per user reports). But I'd wait before attempting to approach that issue until others can chime in.\r\n\r\nThis next week is AWS re:invent. So some folks have been pretty busy and might be until that's over.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/980438934/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/980442740","html_url":"https://github.com/apache/iceberg/pull/3561#issuecomment-980442740","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3561","id":980442740,"node_id":"IC_kwDOCW7NX846cF50","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-26T21:32:53Z","updated_at":"2021-11-26T21:32:53Z","author_association":"CONTRIBUTOR","body":"Thanks for the reviews and questions everybody! It's very much appreciated.\r\n\r\nIt is a holiday in the US, but I will get to everybody's questions or input as soon as possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/980442740/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/980637193","html_url":"https://github.com/apache/iceberg/pull/3605#issuecomment-980637193","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3605","id":980637193,"node_id":"IC_kwDOCW7NX846c1YJ","user":{"login":"zhongyujiang","id":42907416,"node_id":"MDQ6VXNlcjQyOTA3NDE2","avatar_url":"https://avatars.githubusercontent.com/u/42907416?v=4","gravatar_id":"","url":"https://api.github.com/users/zhongyujiang","html_url":"https://github.com/zhongyujiang","followers_url":"https://api.github.com/users/zhongyujiang/followers","following_url":"https://api.github.com/users/zhongyujiang/following{/other_user}","gists_url":"https://api.github.com/users/zhongyujiang/gists{/gist_id}","starred_url":"https://api.github.com/users/zhongyujiang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhongyujiang/subscriptions","organizations_url":"https://api.github.com/users/zhongyujiang/orgs","repos_url":"https://api.github.com/users/zhongyujiang/repos","events_url":"https://api.github.com/users/zhongyujiang/events{/privacy}","received_events_url":"https://api.github.com/users/zhongyujiang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-27T14:37:16Z","updated_at":"2021-11-27T14:37:16Z","author_association":"CONTRIBUTOR","body":"> Looks correct, could you please add a unit test for this？\r\n\r\nOf course!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/980637193/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/980645315","html_url":"https://github.com/apache/iceberg/pull/3605#issuecomment-980645315","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3605","id":980645315,"node_id":"IC_kwDOCW7NX846c3XD","user":{"login":"zhongyujiang","id":42907416,"node_id":"MDQ6VXNlcjQyOTA3NDE2","avatar_url":"https://avatars.githubusercontent.com/u/42907416?v=4","gravatar_id":"","url":"https://api.github.com/users/zhongyujiang","html_url":"https://github.com/zhongyujiang","followers_url":"https://api.github.com/users/zhongyujiang/followers","following_url":"https://api.github.com/users/zhongyujiang/following{/other_user}","gists_url":"https://api.github.com/users/zhongyujiang/gists{/gist_id}","starred_url":"https://api.github.com/users/zhongyujiang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhongyujiang/subscriptions","organizations_url":"https://api.github.com/users/zhongyujiang/orgs","repos_url":"https://api.github.com/users/zhongyujiang/repos","events_url":"https://api.github.com/users/zhongyujiang/events{/privacy}","received_events_url":"https://api.github.com/users/zhongyujiang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-27T15:42:47Z","updated_at":"2021-11-27T15:42:47Z","author_association":"CONTRIBUTOR","body":"Hi @chenjunjiedada, I found that [RemoveIds](https://github.com/apache/iceberg/blob/master/parquet/src/main/java/org/apache/iceberg/parquet/RemoveIds.java#L50) haven't keep the original name of repeatedElement of list/map type too:\r\n```\r\n@Override\r\n  public Type list(GroupType array, Type item) {\r\n    return Types.list(array.getRepetition())\r\n        .element(item)\r\n        .named(array.getName());\r\n  }\r\n```\r\nI think this also need a fix.\r\nAnd speaking of unit test, I found that [TestPruneColumns](https://github.com/apache/iceberg/blob/master/parquet/src/test/java/org/apache/iceberg/parquet/TestPruneColumns.java) already did a similar one for PruneColumns, maybe I can reuse the fileSchema in it, so can I just rename TestPruneColumns to TestParquetTypeVisitor and put the unit tests for RemoveIds and ApplyNameMapping in it? What do you think?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/980645315/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/980697525","html_url":"https://github.com/apache/iceberg/pull/3378#issuecomment-980697525","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3378","id":980697525,"node_id":"IC_kwDOCW7NX846dEG1","user":{"login":"samredai","id":43911210,"node_id":"MDQ6VXNlcjQzOTExMjEw","avatar_url":"https://avatars.githubusercontent.com/u/43911210?v=4","gravatar_id":"","url":"https://api.github.com/users/samredai","html_url":"https://github.com/samredai","followers_url":"https://api.github.com/users/samredai/followers","following_url":"https://api.github.com/users/samredai/following{/other_user}","gists_url":"https://api.github.com/users/samredai/gists{/gist_id}","starred_url":"https://api.github.com/users/samredai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samredai/subscriptions","organizations_url":"https://api.github.com/users/samredai/orgs","repos_url":"https://api.github.com/users/samredai/repos","events_url":"https://api.github.com/users/samredai/events{/privacy}","received_events_url":"https://api.github.com/users/samredai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-27T16:47:40Z","updated_at":"2021-11-27T16:47:40Z","author_association":"CONTRIBUTOR","body":"Closing this for now. The discussion should continue over in this issue: https://github.com/apache/iceberg/issues/3616","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/980697525/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/980844020","html_url":"https://github.com/apache/iceberg/issues/3616#issuecomment-980844020","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3616","id":980844020,"node_id":"IC_kwDOCW7NX846dn30","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-28T05:44:13Z","updated_at":"2021-11-28T05:44:30Z","author_association":"MEMBER","body":"> A separate but related proposal is to separate the docs out into their own iceberg-docs repo.\r\n\r\n@samredai \r\nRegarding this, If we move the docs to separate repo. It may be difficult to synchronise the code PR and doc PR. Merging also is extra effort. Some dev may forget to raise doc PR. \r\n\r\nSo, Is it possible to keep the docs currently where it is and separate repo will import *.md files from main repo and build site docs from some github actions ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/980844020/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/980848231","html_url":"https://github.com/apache/iceberg/pull/3589#issuecomment-980848231","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3589","id":980848231,"node_id":"IC_kwDOCW7NX846do5n","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-28T06:30:15Z","updated_at":"2021-11-28T06:30:15Z","author_association":"MEMBER","body":"@rdblue , @jackye1995 , @RussellSpitzer : I see that this PR is not moving as people are not happy with procedure rename (breaking change). So I have reverted that change and pushed remaining changes. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/980848231/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/980966600","html_url":"https://github.com/apache/iceberg/issues/3615#issuecomment-980966600","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3615","id":980966600,"node_id":"IC_kwDOCW7NX846eFzI","user":{"login":"felixYyu","id":3785228,"node_id":"MDQ6VXNlcjM3ODUyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3785228?v=4","gravatar_id":"","url":"https://api.github.com/users/felixYyu","html_url":"https://github.com/felixYyu","followers_url":"https://api.github.com/users/felixYyu/followers","following_url":"https://api.github.com/users/felixYyu/following{/other_user}","gists_url":"https://api.github.com/users/felixYyu/gists{/gist_id}","starred_url":"https://api.github.com/users/felixYyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixYyu/subscriptions","organizations_url":"https://api.github.com/users/felixYyu/orgs","repos_url":"https://api.github.com/users/felixYyu/repos","events_url":"https://api.github.com/users/felixYyu/events{/privacy}","received_events_url":"https://api.github.com/users/felixYyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-28T08:09:29Z","updated_at":"2021-11-28T08:09:29Z","author_association":"CONTRIBUTOR","body":"cc @rdblue @RussellSpitzer ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/980966600/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/981050908","html_url":"https://github.com/apache/iceberg/issues/3585#issuecomment-981050908","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3585","id":981050908,"node_id":"IC_kwDOCW7NX846eaYc","user":{"login":"felixYyu","id":3785228,"node_id":"MDQ6VXNlcjM3ODUyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3785228?v=4","gravatar_id":"","url":"https://api.github.com/users/felixYyu","html_url":"https://github.com/felixYyu","followers_url":"https://api.github.com/users/felixYyu/followers","following_url":"https://api.github.com/users/felixYyu/following{/other_user}","gists_url":"https://api.github.com/users/felixYyu/gists{/gist_id}","starred_url":"https://api.github.com/users/felixYyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixYyu/subscriptions","organizations_url":"https://api.github.com/users/felixYyu/orgs","repos_url":"https://api.github.com/users/felixYyu/repos","events_url":"https://api.github.com/users/felixYyu/events{/privacy}","received_events_url":"https://api.github.com/users/felixYyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-28T09:16:10Z","updated_at":"2021-11-28T09:16:10Z","author_association":"CONTRIBUTOR","body":"add  .config(\"spark.sql.sources.partitionOverwriteMode\", \"dynamic\") to try","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/981050908/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/981129564","html_url":"https://github.com/apache/iceberg/pull/3375#issuecomment-981129564","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3375","id":981129564,"node_id":"IC_kwDOCW7NX846etlc","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-28T18:24:12Z","updated_at":"2021-11-28T18:24:12Z","author_association":"MEMBER","body":"@RussellSpitzer : As I have mentioned above, I couldn't avoid custom parser for sort order as brining existing parser will cause circular dependency. Also moving procedure to spark extension module is also not possible due to dependency on it on spark-3.2 module.\r\n\r\nSo, today I thought why not move some part of parser code to spark-3.2 and handle the same. So, I found a hack to do it.\r\nIt is not clean, But it helps avoiding custom sort order parser as you suggested.\r\n\r\nI just have to move `SetWriteDistributionAndOrdering`  from spark-3.2-extensions to spark-3.2 and append a prefix of \"ALTER TABLE temp WRITE ORDERED BY\" internally to parse as plan to collect sort order. \r\n\r\nI have pushed as a separate commit, please have a look. I think this method can avoid custom sort order parser.\r\n\r\ncc: @rymurr , @rdblue  ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/981129564/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/981223645","html_url":"https://github.com/apache/iceberg/pull/3276#issuecomment-981223645","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3276","id":981223645,"node_id":"IC_kwDOCW7NX846fEjd","user":{"login":"velctor","id":39006258,"node_id":"MDQ6VXNlcjM5MDA2MjU4","avatar_url":"https://avatars.githubusercontent.com/u/39006258?v=4","gravatar_id":"","url":"https://api.github.com/users/velctor","html_url":"https://github.com/velctor","followers_url":"https://api.github.com/users/velctor/followers","following_url":"https://api.github.com/users/velctor/following{/other_user}","gists_url":"https://api.github.com/users/velctor/gists{/gist_id}","starred_url":"https://api.github.com/users/velctor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/velctor/subscriptions","organizations_url":"https://api.github.com/users/velctor/orgs","repos_url":"https://api.github.com/users/velctor/repos","events_url":"https://api.github.com/users/velctor/events{/privacy}","received_events_url":"https://api.github.com/users/velctor/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-29T01:53:36Z","updated_at":"2021-11-29T01:53:36Z","author_association":"NONE","body":"@rdblue @electrum Thanks very much! The version that I used is 359, I will merge with the PR trinodb/trino#8504 to test.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/981223645/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/981235742","html_url":"https://github.com/apache/iceberg/pull/3390#issuecomment-981235742","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3390","id":981235742,"node_id":"IC_kwDOCW7NX846fHge","user":{"login":"q977734161","id":8123755,"node_id":"MDQ6VXNlcjgxMjM3NTU=","avatar_url":"https://avatars.githubusercontent.com/u/8123755?v=4","gravatar_id":"","url":"https://api.github.com/users/q977734161","html_url":"https://github.com/q977734161","followers_url":"https://api.github.com/users/q977734161/followers","following_url":"https://api.github.com/users/q977734161/following{/other_user}","gists_url":"https://api.github.com/users/q977734161/gists{/gist_id}","starred_url":"https://api.github.com/users/q977734161/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/q977734161/subscriptions","organizations_url":"https://api.github.com/users/q977734161/orgs","repos_url":"https://api.github.com/users/q977734161/repos","events_url":"https://api.github.com/users/q977734161/events{/privacy}","received_events_url":"https://api.github.com/users/q977734161/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-29T02:26:01Z","updated_at":"2021-11-29T02:26:01Z","author_association":"CONTRIBUTOR","body":"close","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/981235742/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/981324745","html_url":"https://github.com/apache/iceberg/pull/3612#issuecomment-981324745","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3612","id":981324745,"node_id":"IC_kwDOCW7NX846fdPJ","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-29T06:20:19Z","updated_at":"2021-11-29T06:20:19Z","author_association":"CONTRIBUTOR","body":"I'd like to also invite @rdblue to take a look since we have been discussing about this feature.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/981324745/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/981335741","html_url":"https://github.com/apache/iceberg/pull/3612#issuecomment-981335741","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3612","id":981335741,"node_id":"IC_kwDOCW7NX846ff69","user":{"login":"hameizi","id":18445460,"node_id":"MDQ6VXNlcjE4NDQ1NDYw","avatar_url":"https://avatars.githubusercontent.com/u/18445460?v=4","gravatar_id":"","url":"https://api.github.com/users/hameizi","html_url":"https://github.com/hameizi","followers_url":"https://api.github.com/users/hameizi/followers","following_url":"https://api.github.com/users/hameizi/following{/other_user}","gists_url":"https://api.github.com/users/hameizi/gists{/gist_id}","starred_url":"https://api.github.com/users/hameizi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hameizi/subscriptions","organizations_url":"https://api.github.com/users/hameizi/orgs","repos_url":"https://api.github.com/users/hameizi/repos","events_url":"https://api.github.com/users/hameizi/events{/privacy}","received_events_url":"https://api.github.com/users/hameizi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-29T06:48:38Z","updated_at":"2021-11-29T06:48:38Z","author_association":"CONTRIBUTOR","body":"@jackye1995 fixed all","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/981335741/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/981540815","html_url":"https://github.com/apache/iceberg/issues/3607#issuecomment-981540815","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3607","id":981540815,"node_id":"IC_kwDOCW7NX846gR_P","user":{"login":"elferherrera","id":6942205,"node_id":"MDQ6VXNlcjY5NDIyMDU=","avatar_url":"https://avatars.githubusercontent.com/u/6942205?v=4","gravatar_id":"","url":"https://api.github.com/users/elferherrera","html_url":"https://github.com/elferherrera","followers_url":"https://api.github.com/users/elferherrera/followers","following_url":"https://api.github.com/users/elferherrera/following{/other_user}","gists_url":"https://api.github.com/users/elferherrera/gists{/gist_id}","starred_url":"https://api.github.com/users/elferherrera/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elferherrera/subscriptions","organizations_url":"https://api.github.com/users/elferherrera/orgs","repos_url":"https://api.github.com/users/elferherrera/repos","events_url":"https://api.github.com/users/elferherrera/events{/privacy}","received_events_url":"https://api.github.com/users/elferherrera/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-29T11:19:32Z","updated_at":"2021-11-29T11:19:32Z","author_association":"NONE","body":"@RussellSpitzer is it possible for you to elaborate a bit more what you mean with pushdown?\r\n\r\nAlso, based on your suggestion, the merge query should look like this?\r\n```\r\nMERGE INTO iceberg_hive_cat.iceberg_poc_db.iceberg_tab target\r\nUSING (SELECT * FROM source)\r\nON target.col1 = source.col1 AND target.col2 = target.col2 AND target.col3 = source.col3 AND part_date_col between '2021-01-01' and '2021-01-16'\r\n```\r\n\r\nBtw, how does this work with hidden partitions?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/981540815/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/981552957","html_url":"https://github.com/apache/iceberg/pull/3596#issuecomment-981552957","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3596","id":981552957,"node_id":"IC_kwDOCW7NX846gU89","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-29T11:36:11Z","updated_at":"2021-11-29T11:36:11Z","author_association":"MEMBER","body":"@xingbowu, did all the test cases run correctly in your local env ?  I tried to verify all the test cases by using the integration test rule by exporting the following environment variables, and find there are many broken cases: \r\n\r\n```\r\nexport ALIYUN_TEST_OSS_TEST_RULE_CLASS=org.apache.iceberg.aliyun.oss.OSSIntegrationTestRule\r\nexport ALIYUN_TEST_BUCKET=iceberg-test\r\nexport ALIYUN_TEST_ACCESS_KEY_ID=******\r\nexport ALIYUN_TEST_ACCESS_KEY_SECRET=******\r\nexport ALIYUN_TEST_OSS_WAREHOUSE=oss://iceberg-test/ci\r\nexport ALIYUN_TEST_OSS_ENDPOINT=oss-cn-hangzhou.aliyuncs.com\r\n\r\n➜  apache-iceberg git:(3596) ./gradlew iceberg-aliyun:test      \r\n\r\n> Task :iceberg-aliyun:test\r\n\r\norg.apache.iceberg.aliyun.oss.TestOSSInputStream > testClose FAILED\r\n    com.aliyun.oss.ClientException: Connection error due to: Connection pool shut down\r\n    [ErrorCode]: Unknown\r\n    [RequestId]: Unknown\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:170)\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequest(ServiceClient.java:70)\r\n        at com.aliyun.oss.internal.OSSOperation.send(OSSOperation.java:83)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:145)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:102)\r\n        at com.aliyun.oss.internal.OSSBucketOperation.getBucketAcl(OSSBucketOperation.java:321)\r\n        at com.aliyun.oss.internal.OSSBucketOperation.doesBucketExists(OSSBucketOperation.java:433)\r\n        at com.aliyun.oss.OSSClient.doesBucketExist(OSSClient.java:438)\r\n        at com.aliyun.oss.OSSClient.doesBucketExist(OSSClient.java:433)\r\n        at org.apache.iceberg.aliyun.oss.OSSIntegrationTestRule.setUpBucket(OSSIntegrationTestRule.java:84)\r\n        at org.apache.iceberg.aliyun.oss.AliyunOSSTestBase.before(AliyunOSSTestBase.java:39)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)\r\n        at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)\r\n        at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)\r\n        at org.junit.internal.runners.statements.RunBefores.invokeMethod(RunBefores.java:33)\r\n        at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24)\r\n        at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)\r\n        at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)\r\n        at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)\r\n        at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)\r\n        at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)\r\n        at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)\r\n        at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)\r\n        at org.apache.iceberg.aliyun.oss.AliyunOSSTestRule$1.evaluate(AliyunOSSTestRule.java:50)\r\n        at org.junit.rules.RunRules.evaluate(RunRules.java:20)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.ParentRunner.run(ParentRunner.java:413)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.runTestClass(JUnitTestClassExecutor.java:110)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:58)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:38)\r\n        at org.gradle.api.internal.tasks.testing.junit.AbstractJUnitTestClassProcessor.processTestClass(AbstractJUnitTestClassProcessor.java:62)\r\n        at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:51)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:36)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)\r\n        at org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:33)\r\n        at org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:94)\r\n        at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker$2.run(TestWorker.java:176)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.executeAndMaintainThreadName(TestWorker.java:129)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:100)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:60)\r\n        at org.gradle.process.internal.worker.child.ActionExecutionWorker.execute(ActionExecutionWorker.java:56)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:133)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:71)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.run(GradleWorkerMain.java:69)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.main(GradleWorkerMain.java:74)\r\n\r\n        Caused by:\r\n        java.lang.IllegalStateException: Connection pool shut down\r\n            at org.apache.http.util.Asserts.check(Asserts.java:34)\r\n            at org.apache.http.pool.AbstractConnPool.lease(AbstractConnPool.java:184)\r\n            at org.apache.http.impl.conn.PoolingHttpClientConnectionManager.requestConnection(PoolingHttpClientConnectionManager.java:251)\r\n            at org.apache.http.impl.execchain.MainClientExec.execute(MainClientExec.java:175)\r\n            at org.apache.http.impl.execchain.ProtocolExec.execute(ProtocolExec.java:184)\r\n            at org.apache.http.impl.execchain.RedirectExec.execute(RedirectExec.java:110)\r\n            at org.apache.http.impl.client.InternalHttpClient.doExecute(InternalHttpClient.java:184)\r\n            at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:82)\r\n            at com.aliyun.oss.common.comm.DefaultServiceClient.sendRequestCore(DefaultServiceClient.java:138)\r\n            at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:133)\r\n            ... 57 more\r\n\r\n    com.aliyun.oss.ClientException: Connection error due to: Connection pool shut down\r\n    [ErrorCode]: Unknown\r\n    [RequestId]: Unknown\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:170)\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequest(ServiceClient.java:70)\r\n        at com.aliyun.oss.internal.OSSOperation.send(OSSOperation.java:83)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:145)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:102)\r\n        at com.aliyun.oss.internal.OSSBucketOperation.listObjectsV2(OSSBucketOperation.java:487)\r\n        at com.aliyun.oss.OSSClient.listObjectsV2(OSSClient.java:466)\r\n        at org.apache.iceberg.aliyun.oss.OSSIntegrationTestRule.tearDownBucket(OSSIntegrationTestRule.java:96)\r\n        at org.apache.iceberg.aliyun.oss.AliyunOSSTestBase.after(AliyunOSSTestBase.java:44)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)\r\n        at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)\r\n        at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)\r\n        at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46)\r\n        at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)\r\n        at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)\r\n        at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)\r\n        at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)\r\n        at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)\r\n        at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)\r\n        at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)\r\n        at org.apache.iceberg.aliyun.oss.AliyunOSSTestRule$1.evaluate(AliyunOSSTestRule.java:50)\r\n        at org.junit.rules.RunRules.evaluate(RunRules.java:20)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.ParentRunner.run(ParentRunner.java:413)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.runTestClass(JUnitTestClassExecutor.java:110)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:58)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:38)\r\n        at org.gradle.api.internal.tasks.testing.junit.AbstractJUnitTestClassProcessor.processTestClass(AbstractJUnitTestClassProcessor.java:62)\r\n        at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:51)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:36)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)\r\n        at org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:33)\r\n        at org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:94)\r\n        at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker$2.run(TestWorker.java:176)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.executeAndMaintainThreadName(TestWorker.java:129)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:100)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:60)\r\n        at org.gradle.process.internal.worker.child.ActionExecutionWorker.execute(ActionExecutionWorker.java:56)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:133)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:71)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.run(GradleWorkerMain.java:69)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.main(GradleWorkerMain.java:74)\r\n\r\n        Caused by:\r\n        java.lang.IllegalStateException: Connection pool shut down\r\n            at org.apache.http.util.Asserts.check(Asserts.java:34)\r\n            at org.apache.http.pool.AbstractConnPool.lease(AbstractConnPool.java:184)\r\n            at org.apache.http.impl.conn.PoolingHttpClientConnectionManager.requestConnection(PoolingHttpClientConnectionManager.java:251)\r\n            at org.apache.http.impl.execchain.MainClientExec.execute(MainClientExec.java:175)\r\n            at org.apache.http.impl.execchain.ProtocolExec.execute(ProtocolExec.java:184)\r\n            at org.apache.http.impl.execchain.RedirectExec.execute(RedirectExec.java:110)\r\n            at org.apache.http.impl.client.InternalHttpClient.doExecute(InternalHttpClient.java:184)\r\n            at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:82)\r\n            at com.aliyun.oss.common.comm.DefaultServiceClient.sendRequestCore(DefaultServiceClient.java:138)\r\n            at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:133)\r\n            ... 54 more\r\n\r\norg.apache.iceberg.aliyun.oss.TestOSSInputStream > testRead FAILED\r\n    com.aliyun.oss.ClientException: Connection error due to: Connection pool shut down\r\n    [ErrorCode]: Unknown\r\n    [RequestId]: Unknown\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:170)\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequest(ServiceClient.java:70)\r\n        at com.aliyun.oss.internal.OSSOperation.send(OSSOperation.java:83)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:145)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:102)\r\n        at com.aliyun.oss.internal.OSSBucketOperation.getBucketAcl(OSSBucketOperation.java:321)\r\n        at com.aliyun.oss.internal.OSSBucketOperation.doesBucketExists(OSSBucketOperation.java:433)\r\n        at com.aliyun.oss.OSSClient.doesBucketExist(OSSClient.java:438)\r\n        at com.aliyun.oss.OSSClient.doesBucketExist(OSSClient.java:433)\r\n        at org.apache.iceberg.aliyun.oss.OSSIntegrationTestRule.setUpBucket(OSSIntegrationTestRule.java:84)\r\n        at org.apache.iceberg.aliyun.oss.AliyunOSSTestBase.before(AliyunOSSTestBase.java:39)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)\r\n        at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)\r\n        at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)\r\n        at org.junit.internal.runners.statements.RunBefores.invokeMethod(RunBefores.java:33)\r\n        at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24)\r\n        at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)\r\n        at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)\r\n        at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)\r\n        at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)\r\n        at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)\r\n        at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)\r\n        at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)\r\n        at org.apache.iceberg.aliyun.oss.AliyunOSSTestRule$1.evaluate(AliyunOSSTestRule.java:50)\r\n        at org.junit.rules.RunRules.evaluate(RunRules.java:20)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.ParentRunner.run(ParentRunner.java:413)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.runTestClass(JUnitTestClassExecutor.java:110)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:58)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:38)\r\n        at org.gradle.api.internal.tasks.testing.junit.AbstractJUnitTestClassProcessor.processTestClass(AbstractJUnitTestClassProcessor.java:62)\r\n        at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:51)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:36)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)\r\n        at org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:33)\r\n        at org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:94)\r\n        at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker$2.run(TestWorker.java:176)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.executeAndMaintainThreadName(TestWorker.java:129)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:100)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:60)\r\n        at org.gradle.process.internal.worker.child.ActionExecutionWorker.execute(ActionExecutionWorker.java:56)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:133)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:71)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.run(GradleWorkerMain.java:69)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.main(GradleWorkerMain.java:74)\r\n\r\n        Caused by:\r\n        java.lang.IllegalStateException: Connection pool shut down\r\n            at org.apache.http.util.Asserts.check(Asserts.java:34)\r\n            at org.apache.http.pool.AbstractConnPool.lease(AbstractConnPool.java:184)\r\n            at org.apache.http.impl.conn.PoolingHttpClientConnectionManager.requestConnection(PoolingHttpClientConnectionManager.java:251)\r\n            at org.apache.http.impl.execchain.MainClientExec.execute(MainClientExec.java:175)\r\n            at org.apache.http.impl.execchain.ProtocolExec.execute(ProtocolExec.java:184)\r\n            at org.apache.http.impl.execchain.RedirectExec.execute(RedirectExec.java:110)\r\n            at org.apache.http.impl.client.InternalHttpClient.doExecute(InternalHttpClient.java:184)\r\n            at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:82)\r\n            at com.aliyun.oss.common.comm.DefaultServiceClient.sendRequestCore(DefaultServiceClient.java:138)\r\n            at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:133)\r\n            ... 57 more\r\n\r\n    com.aliyun.oss.ClientException: Connection error due to: Connection pool shut down\r\n    [ErrorCode]: Unknown\r\n    [RequestId]: Unknown\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:170)\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequest(ServiceClient.java:70)\r\n        at com.aliyun.oss.internal.OSSOperation.send(OSSOperation.java:83)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:145)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:102)\r\n        at com.aliyun.oss.internal.OSSBucketOperation.listObjectsV2(OSSBucketOperation.java:487)\r\n        at com.aliyun.oss.OSSClient.listObjectsV2(OSSClient.java:466)\r\n        at org.apache.iceberg.aliyun.oss.OSSIntegrationTestRule.tearDownBucket(OSSIntegrationTestRule.java:96)\r\n        at org.apache.iceberg.aliyun.oss.AliyunOSSTestBase.after(AliyunOSSTestBase.java:44)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)\r\n        at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)\r\n        at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)\r\n        at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46)\r\n        at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)\r\n        at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)\r\n        at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)\r\n        at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)\r\n        at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)\r\n        at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)\r\n        at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)\r\n        at org.apache.iceberg.aliyun.oss.AliyunOSSTestRule$1.evaluate(AliyunOSSTestRule.java:50)\r\n        at org.junit.rules.RunRules.evaluate(RunRules.java:20)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.ParentRunner.run(ParentRunner.java:413)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.runTestClass(JUnitTestClassExecutor.java:110)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:58)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:38)\r\n        at org.gradle.api.internal.tasks.testing.junit.AbstractJUnitTestClassProcessor.processTestClass(AbstractJUnitTestClassProcessor.java:62)\r\n        at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:51)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:36)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)\r\n        at org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:33)\r\n        at org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:94)\r\n        at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker$2.run(TestWorker.java:176)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.executeAndMaintainThreadName(TestWorker.java:129)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:100)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:60)\r\n        at org.gradle.process.internal.worker.child.ActionExecutionWorker.execute(ActionExecutionWorker.java:56)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:133)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:71)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.run(GradleWorkerMain.java:69)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.main(GradleWorkerMain.java:74)\r\n\r\n        Caused by:\r\n        java.lang.IllegalStateException: Connection pool shut down\r\n            at org.apache.http.util.Asserts.check(Asserts.java:34)\r\n            at org.apache.http.pool.AbstractConnPool.lease(AbstractConnPool.java:184)\r\n            at org.apache.http.impl.conn.PoolingHttpClientConnectionManager.requestConnection(PoolingHttpClientConnectionManager.java:251)\r\n            at org.apache.http.impl.execchain.MainClientExec.execute(MainClientExec.java:175)\r\n            at org.apache.http.impl.execchain.ProtocolExec.execute(ProtocolExec.java:184)\r\n            at org.apache.http.impl.execchain.RedirectExec.execute(RedirectExec.java:110)\r\n            at org.apache.http.impl.client.InternalHttpClient.doExecute(InternalHttpClient.java:184)\r\n            at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:82)\r\n            at com.aliyun.oss.common.comm.DefaultServiceClient.sendRequestCore(DefaultServiceClient.java:138)\r\n            at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:133)\r\n            ... 54 more\r\n\r\norg.apache.iceberg.aliyun.oss.TestOSSInputStream > testSeek FAILED\r\n    com.aliyun.oss.ClientException: Connection error due to: Connection pool shut down\r\n    [ErrorCode]: Unknown\r\n    [RequestId]: Unknown\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:170)\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequest(ServiceClient.java:70)\r\n        at com.aliyun.oss.internal.OSSOperation.send(OSSOperation.java:83)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:145)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:102)\r\n        at com.aliyun.oss.internal.OSSBucketOperation.getBucketAcl(OSSBucketOperation.java:321)\r\n        at com.aliyun.oss.internal.OSSBucketOperation.doesBucketExists(OSSBucketOperation.java:433)\r\n        at com.aliyun.oss.OSSClient.doesBucketExist(OSSClient.java:438)\r\n        at com.aliyun.oss.OSSClient.doesBucketExist(OSSClient.java:433)\r\n        at org.apache.iceberg.aliyun.oss.OSSIntegrationTestRule.setUpBucket(OSSIntegrationTestRule.java:84)\r\n        at org.apache.iceberg.aliyun.oss.AliyunOSSTestBase.before(AliyunOSSTestBase.java:39)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)\r\n        at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)\r\n        at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)\r\n        at org.junit.internal.runners.statements.RunBefores.invokeMethod(RunBefores.java:33)\r\n        at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24)\r\n        at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)\r\n        at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)\r\n        at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)\r\n        at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)\r\n        at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)\r\n        at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)\r\n        at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)\r\n        at org.apache.iceberg.aliyun.oss.AliyunOSSTestRule$1.evaluate(AliyunOSSTestRule.java:50)\r\n        at org.junit.rules.RunRules.evaluate(RunRules.java:20)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.ParentRunner.run(ParentRunner.java:413)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.runTestClass(JUnitTestClassExecutor.java:110)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:58)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:38)\r\n        at org.gradle.api.internal.tasks.testing.junit.AbstractJUnitTestClassProcessor.processTestClass(AbstractJUnitTestClassProcessor.java:62)\r\n        at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:51)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:36)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)\r\n        at org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:33)\r\n        at org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:94)\r\n        at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker$2.run(TestWorker.java:176)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.executeAndMaintainThreadName(TestWorker.java:129)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:100)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:60)\r\n        at org.gradle.process.internal.worker.child.ActionExecutionWorker.execute(ActionExecutionWorker.java:56)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:133)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:71)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.run(GradleWorkerMain.java:69)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.main(GradleWorkerMain.java:74)\r\n\r\n        Caused by:\r\n        java.lang.IllegalStateException: Connection pool shut down\r\n            at org.apache.http.util.Asserts.check(Asserts.java:34)\r\n            at org.apache.http.pool.AbstractConnPool.lease(AbstractConnPool.java:184)\r\n            at org.apache.http.impl.conn.PoolingHttpClientConnectionManager.requestConnection(PoolingHttpClientConnectionManager.java:251)\r\n            at org.apache.http.impl.execchain.MainClientExec.execute(MainClientExec.java:175)\r\n            at org.apache.http.impl.execchain.ProtocolExec.execute(ProtocolExec.java:184)\r\n            at org.apache.http.impl.execchain.RedirectExec.execute(RedirectExec.java:110)\r\n            at org.apache.http.impl.client.InternalHttpClient.doExecute(InternalHttpClient.java:184)\r\n            at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:82)\r\n            at com.aliyun.oss.common.comm.DefaultServiceClient.sendRequestCore(DefaultServiceClient.java:138)\r\n            at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:133)\r\n            ... 57 more\r\n\r\n    com.aliyun.oss.ClientException: Connection error due to: Connection pool shut down\r\n    [ErrorCode]: Unknown\r\n    [RequestId]: Unknown\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:170)\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequest(ServiceClient.java:70)\r\n        at com.aliyun.oss.internal.OSSOperation.send(OSSOperation.java:83)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:145)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:102)\r\n        at com.aliyun.oss.internal.OSSBucketOperation.listObjectsV2(OSSBucketOperation.java:487)\r\n        at com.aliyun.oss.OSSClient.listObjectsV2(OSSClient.java:466)\r\n        at org.apache.iceberg.aliyun.oss.OSSIntegrationTestRule.tearDownBucket(OSSIntegrationTestRule.java:96)\r\n        at org.apache.iceberg.aliyun.oss.AliyunOSSTestBase.after(AliyunOSSTestBase.java:44)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)\r\n        at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)\r\n        at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)\r\n        at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46)\r\n        at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)\r\n        at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)\r\n        at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)\r\n        at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)\r\n        at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)\r\n        at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)\r\n        at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)\r\n        at org.apache.iceberg.aliyun.oss.AliyunOSSTestRule$1.evaluate(AliyunOSSTestRule.java:50)\r\n        at org.junit.rules.RunRules.evaluate(RunRules.java:20)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.ParentRunner.run(ParentRunner.java:413)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.runTestClass(JUnitTestClassExecutor.java:110)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:58)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:38)\r\n        at org.gradle.api.internal.tasks.testing.junit.AbstractJUnitTestClassProcessor.processTestClass(AbstractJUnitTestClassProcessor.java:62)\r\n        at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:51)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:36)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)\r\n        at org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:33)\r\n        at org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:94)\r\n        at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker$2.run(TestWorker.java:176)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.executeAndMaintainThreadName(TestWorker.java:129)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:100)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:60)\r\n        at org.gradle.process.internal.worker.child.ActionExecutionWorker.execute(ActionExecutionWorker.java:56)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:133)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:71)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.run(GradleWorkerMain.java:69)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.main(GradleWorkerMain.java:74)\r\n\r\n        Caused by:\r\n        java.lang.IllegalStateException: Connection pool shut down\r\n            at org.apache.http.util.Asserts.check(Asserts.java:34)\r\n            at org.apache.http.pool.AbstractConnPool.lease(AbstractConnPool.java:184)\r\n            at org.apache.http.impl.conn.PoolingHttpClientConnectionManager.requestConnection(PoolingHttpClientConnectionManager.java:251)\r\n            at org.apache.http.impl.execchain.MainClientExec.execute(MainClientExec.java:175)\r\n            at org.apache.http.impl.execchain.ProtocolExec.execute(ProtocolExec.java:184)\r\n            at org.apache.http.impl.execchain.RedirectExec.execute(RedirectExec.java:110)\r\n            at org.apache.http.impl.client.InternalHttpClient.doExecute(InternalHttpClient.java:184)\r\n            at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:82)\r\n            at com.aliyun.oss.common.comm.DefaultServiceClient.sendRequestCore(DefaultServiceClient.java:138)\r\n            at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:133)\r\n            ... 54 more\r\n\r\norg.apache.iceberg.aliyun.oss.TestOSSOutputFile > testLocation FAILED\r\n    com.aliyun.oss.ClientException: Connection error due to: Connection pool shut down\r\n    [ErrorCode]: Unknown\r\n    [RequestId]: Unknown\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:170)\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequest(ServiceClient.java:70)\r\n        at com.aliyun.oss.internal.OSSOperation.send(OSSOperation.java:83)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:145)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:102)\r\n        at com.aliyun.oss.internal.OSSBucketOperation.getBucketAcl(OSSBucketOperation.java:321)\r\n        at com.aliyun.oss.internal.OSSBucketOperation.doesBucketExists(OSSBucketOperation.java:433)\r\n        at com.aliyun.oss.OSSClient.doesBucketExist(OSSClient.java:438)\r\n        at com.aliyun.oss.OSSClient.doesBucketExist(OSSClient.java:433)\r\n        at org.apache.iceberg.aliyun.oss.OSSIntegrationTestRule.setUpBucket(OSSIntegrationTestRule.java:84)\r\n        at org.apache.iceberg.aliyun.oss.AliyunOSSTestBase.before(AliyunOSSTestBase.java:39)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)\r\n        at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)\r\n        at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)\r\n        at org.junit.internal.runners.statements.RunBefores.invokeMethod(RunBefores.java:33)\r\n        at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24)\r\n        at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)\r\n        at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)\r\n        at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)\r\n        at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)\r\n        at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)\r\n        at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)\r\n        at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)\r\n        at org.apache.iceberg.aliyun.oss.AliyunOSSTestRule$1.evaluate(AliyunOSSTestRule.java:50)\r\n        at org.junit.rules.RunRules.evaluate(RunRules.java:20)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.ParentRunner.run(ParentRunner.java:413)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.runTestClass(JUnitTestClassExecutor.java:110)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:58)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:38)\r\n        at org.gradle.api.internal.tasks.testing.junit.AbstractJUnitTestClassProcessor.processTestClass(AbstractJUnitTestClassProcessor.java:62)\r\n        at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:51)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:36)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)\r\n        at org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:33)\r\n        at org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:94)\r\n        at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker$2.run(TestWorker.java:176)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.executeAndMaintainThreadName(TestWorker.java:129)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:100)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:60)\r\n        at org.gradle.process.internal.worker.child.ActionExecutionWorker.execute(ActionExecutionWorker.java:56)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:133)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:71)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.run(GradleWorkerMain.java:69)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.main(GradleWorkerMain.java:74)\r\n\r\n        Caused by:\r\n        java.lang.IllegalStateException: Connection pool shut down\r\n            at org.apache.http.util.Asserts.check(Asserts.java:34)\r\n            at org.apache.http.pool.AbstractConnPool.lease(AbstractConnPool.java:184)\r\n            at org.apache.http.impl.conn.PoolingHttpClientConnectionManager.requestConnection(PoolingHttpClientConnectionManager.java:251)\r\n            at org.apache.http.impl.execchain.MainClientExec.execute(MainClientExec.java:175)\r\n            at org.apache.http.impl.execchain.ProtocolExec.execute(ProtocolExec.java:184)\r\n            at org.apache.http.impl.execchain.RedirectExec.execute(RedirectExec.java:110)\r\n            at org.apache.http.impl.client.InternalHttpClient.doExecute(InternalHttpClient.java:184)\r\n            at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:82)\r\n            at com.aliyun.oss.common.comm.DefaultServiceClient.sendRequestCore(DefaultServiceClient.java:138)\r\n            at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:133)\r\n            ... 57 more\r\n\r\n    com.aliyun.oss.ClientException: Connection error due to: Connection pool shut down\r\n    [ErrorCode]: Unknown\r\n    [RequestId]: Unknown\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:170)\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequest(ServiceClient.java:70)\r\n        at com.aliyun.oss.internal.OSSOperation.send(OSSOperation.java:83)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:145)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:102)\r\n        at com.aliyun.oss.internal.OSSBucketOperation.listObjectsV2(OSSBucketOperation.java:487)\r\n        at com.aliyun.oss.OSSClient.listObjectsV2(OSSClient.java:466)\r\n        at org.apache.iceberg.aliyun.oss.OSSIntegrationTestRule.tearDownBucket(OSSIntegrationTestRule.java:96)\r\n        at org.apache.iceberg.aliyun.oss.AliyunOSSTestBase.after(AliyunOSSTestBase.java:44)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)\r\n        at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)\r\n        at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)\r\n        at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46)\r\n        at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)\r\n        at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)\r\n        at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)\r\n        at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)\r\n        at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)\r\n        at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)\r\n        at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)\r\n        at org.apache.iceberg.aliyun.oss.AliyunOSSTestRule$1.evaluate(AliyunOSSTestRule.java:50)\r\n        at org.junit.rules.RunRules.evaluate(RunRules.java:20)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.ParentRunner.run(ParentRunner.java:413)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.runTestClass(JUnitTestClassExecutor.java:110)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:58)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:38)\r\n        at org.gradle.api.internal.tasks.testing.junit.AbstractJUnitTestClassProcessor.processTestClass(AbstractJUnitTestClassProcessor.java:62)\r\n        at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:51)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:36)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)\r\n        at org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:33)\r\n        at org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:94)\r\n        at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker$2.run(TestWorker.java:176)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.executeAndMaintainThreadName(TestWorker.java:129)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:100)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:60)\r\n        at org.gradle.process.internal.worker.child.ActionExecutionWorker.execute(ActionExecutionWorker.java:56)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:133)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:71)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.run(GradleWorkerMain.java:69)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.main(GradleWorkerMain.java:74)\r\n\r\n        Caused by:\r\n        java.lang.IllegalStateException: Connection pool shut down\r\n            at org.apache.http.util.Asserts.check(Asserts.java:34)\r\n            at org.apache.http.pool.AbstractConnPool.lease(AbstractConnPool.java:184)\r\n            at org.apache.http.impl.conn.PoolingHttpClientConnectionManager.requestConnection(PoolingHttpClientConnectionManager.java:251)\r\n            at org.apache.http.impl.execchain.MainClientExec.execute(MainClientExec.java:175)\r\n            at org.apache.http.impl.execchain.ProtocolExec.execute(ProtocolExec.java:184)\r\n            at org.apache.http.impl.execchain.RedirectExec.execute(RedirectExec.java:110)\r\n            at org.apache.http.impl.client.InternalHttpClient.doExecute(InternalHttpClient.java:184)\r\n            at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:82)\r\n            at com.aliyun.oss.common.comm.DefaultServiceClient.sendRequestCore(DefaultServiceClient.java:138)\r\n            at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:133)\r\n            ... 54 more\r\n\r\norg.apache.iceberg.aliyun.oss.TestOSSOutputFile > testWriteFile FAILED\r\n    com.aliyun.oss.ClientException: Connection error due to: Connection pool shut down\r\n    [ErrorCode]: Unknown\r\n    [RequestId]: Unknown\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:170)\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequest(ServiceClient.java:70)\r\n        at com.aliyun.oss.internal.OSSOperation.send(OSSOperation.java:83)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:145)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:102)\r\n        at com.aliyun.oss.internal.OSSBucketOperation.getBucketAcl(OSSBucketOperation.java:321)\r\n        at com.aliyun.oss.internal.OSSBucketOperation.doesBucketExists(OSSBucketOperation.java:433)\r\n        at com.aliyun.oss.OSSClient.doesBucketExist(OSSClient.java:438)\r\n        at com.aliyun.oss.OSSClient.doesBucketExist(OSSClient.java:433)\r\n        at org.apache.iceberg.aliyun.oss.OSSIntegrationTestRule.setUpBucket(OSSIntegrationTestRule.java:84)\r\n        at org.apache.iceberg.aliyun.oss.AliyunOSSTestBase.before(AliyunOSSTestBase.java:39)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)\r\n        at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)\r\n        at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)\r\n        at org.junit.internal.runners.statements.RunBefores.invokeMethod(RunBefores.java:33)\r\n        at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24)\r\n        at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)\r\n        at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)\r\n        at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)\r\n        at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)\r\n        at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)\r\n        at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)\r\n        at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)\r\n        at org.apache.iceberg.aliyun.oss.AliyunOSSTestRule$1.evaluate(AliyunOSSTestRule.java:50)\r\n        at org.junit.rules.RunRules.evaluate(RunRules.java:20)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.ParentRunner.run(ParentRunner.java:413)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.runTestClass(JUnitTestClassExecutor.java:110)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:58)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:38)\r\n        at org.gradle.api.internal.tasks.testing.junit.AbstractJUnitTestClassProcessor.processTestClass(AbstractJUnitTestClassProcessor.java:62)\r\n        at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:51)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:36)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)\r\n        at org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:33)\r\n        at org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:94)\r\n        at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker$2.run(TestWorker.java:176)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.executeAndMaintainThreadName(TestWorker.java:129)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:100)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:60)\r\n        at org.gradle.process.internal.worker.child.ActionExecutionWorker.execute(ActionExecutionWorker.java:56)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:133)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:71)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.run(GradleWorkerMain.java:69)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.main(GradleWorkerMain.java:74)\r\n\r\n        Caused by:\r\n        java.lang.IllegalStateException: Connection pool shut down\r\n            at org.apache.http.util.Asserts.check(Asserts.java:34)\r\n            at org.apache.http.pool.AbstractConnPool.lease(AbstractConnPool.java:184)\r\n            at org.apache.http.impl.conn.PoolingHttpClientConnectionManager.requestConnection(PoolingHttpClientConnectionManager.java:251)\r\n            at org.apache.http.impl.execchain.MainClientExec.execute(MainClientExec.java:175)\r\n            at org.apache.http.impl.execchain.ProtocolExec.execute(ProtocolExec.java:184)\r\n            at org.apache.http.impl.execchain.RedirectExec.execute(RedirectExec.java:110)\r\n            at org.apache.http.impl.client.InternalHttpClient.doExecute(InternalHttpClient.java:184)\r\n            at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:82)\r\n            at com.aliyun.oss.common.comm.DefaultServiceClient.sendRequestCore(DefaultServiceClient.java:138)\r\n            at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:133)\r\n            ... 57 more\r\n\r\n    com.aliyun.oss.ClientException: Connection error due to: Connection pool shut down\r\n    [ErrorCode]: Unknown\r\n    [RequestId]: Unknown\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:170)\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequest(ServiceClient.java:70)\r\n        at com.aliyun.oss.internal.OSSOperation.send(OSSOperation.java:83)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:145)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:102)\r\n        at com.aliyun.oss.internal.OSSBucketOperation.listObjectsV2(OSSBucketOperation.java:487)\r\n        at com.aliyun.oss.OSSClient.listObjectsV2(OSSClient.java:466)\r\n        at org.apache.iceberg.aliyun.oss.OSSIntegrationTestRule.tearDownBucket(OSSIntegrationTestRule.java:96)\r\n        at org.apache.iceberg.aliyun.oss.AliyunOSSTestBase.after(AliyunOSSTestBase.java:44)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)\r\n        at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)\r\n        at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)\r\n        at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46)\r\n        at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)\r\n        at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)\r\n        at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)\r\n        at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)\r\n        at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)\r\n        at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)\r\n        at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)\r\n        at org.apache.iceberg.aliyun.oss.AliyunOSSTestRule$1.evaluate(AliyunOSSTestRule.java:50)\r\n        at org.junit.rules.RunRules.evaluate(RunRules.java:20)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.ParentRunner.run(ParentRunner.java:413)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.runTestClass(JUnitTestClassExecutor.java:110)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:58)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:38)\r\n        at org.gradle.api.internal.tasks.testing.junit.AbstractJUnitTestClassProcessor.processTestClass(AbstractJUnitTestClassProcessor.java:62)\r\n        at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:51)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:36)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)\r\n        at org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:33)\r\n        at org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:94)\r\n        at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker$2.run(TestWorker.java:176)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.executeAndMaintainThreadName(TestWorker.java:129)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:100)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:60)\r\n        at org.gradle.process.internal.worker.child.ActionExecutionWorker.execute(ActionExecutionWorker.java:56)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:133)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:71)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.run(GradleWorkerMain.java:69)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.main(GradleWorkerMain.java:74)\r\n\r\n        Caused by:\r\n        java.lang.IllegalStateException: Connection pool shut down\r\n            at org.apache.http.util.Asserts.check(Asserts.java:34)\r\n            at org.apache.http.pool.AbstractConnPool.lease(AbstractConnPool.java:184)\r\n            at org.apache.http.impl.conn.PoolingHttpClientConnectionManager.requestConnection(PoolingHttpClientConnectionManager.java:251)\r\n            at org.apache.http.impl.execchain.MainClientExec.execute(MainClientExec.java:175)\r\n            at org.apache.http.impl.execchain.ProtocolExec.execute(ProtocolExec.java:184)\r\n            at org.apache.http.impl.execchain.RedirectExec.execute(RedirectExec.java:110)\r\n            at org.apache.http.impl.client.InternalHttpClient.doExecute(InternalHttpClient.java:184)\r\n            at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:82)\r\n            at com.aliyun.oss.common.comm.DefaultServiceClient.sendRequestCore(DefaultServiceClient.java:138)\r\n            at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:133)\r\n            ... 54 more\r\n\r\norg.apache.iceberg.aliyun.oss.TestOSSOutputFile > testToInputFile FAILED\r\n    com.aliyun.oss.ClientException: Connection error due to: Connection pool shut down\r\n    [ErrorCode]: Unknown\r\n    [RequestId]: Unknown\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:170)\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequest(ServiceClient.java:70)\r\n        at com.aliyun.oss.internal.OSSOperation.send(OSSOperation.java:83)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:145)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:102)\r\n        at com.aliyun.oss.internal.OSSBucketOperation.getBucketAcl(OSSBucketOperation.java:321)\r\n        at com.aliyun.oss.internal.OSSBucketOperation.doesBucketExists(OSSBucketOperation.java:433)\r\n        at com.aliyun.oss.OSSClient.doesBucketExist(OSSClient.java:438)\r\n        at com.aliyun.oss.OSSClient.doesBucketExist(OSSClient.java:433)\r\n        at org.apache.iceberg.aliyun.oss.OSSIntegrationTestRule.setUpBucket(OSSIntegrationTestRule.java:84)\r\n        at org.apache.iceberg.aliyun.oss.AliyunOSSTestBase.before(AliyunOSSTestBase.java:39)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)\r\n        at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)\r\n        at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)\r\n        at org.junit.internal.runners.statements.RunBefores.invokeMethod(RunBefores.java:33)\r\n        at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24)\r\n        at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)\r\n        at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)\r\n        at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)\r\n        at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)\r\n        at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)\r\n        at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)\r\n        at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)\r\n        at org.apache.iceberg.aliyun.oss.AliyunOSSTestRule$1.evaluate(AliyunOSSTestRule.java:50)\r\n        at org.junit.rules.RunRules.evaluate(RunRules.java:20)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.ParentRunner.run(ParentRunner.java:413)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.runTestClass(JUnitTestClassExecutor.java:110)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:58)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:38)\r\n        at org.gradle.api.internal.tasks.testing.junit.AbstractJUnitTestClassProcessor.processTestClass(AbstractJUnitTestClassProcessor.java:62)\r\n        at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:51)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:36)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)\r\n        at org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:33)\r\n        at org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:94)\r\n        at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker$2.run(TestWorker.java:176)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.executeAndMaintainThreadName(TestWorker.java:129)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:100)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:60)\r\n        at org.gradle.process.internal.worker.child.ActionExecutionWorker.execute(ActionExecutionWorker.java:56)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:133)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:71)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.run(GradleWorkerMain.java:69)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.main(GradleWorkerMain.java:74)\r\n\r\n        Caused by:\r\n        java.lang.IllegalStateException: Connection pool shut down\r\n            at org.apache.http.util.Asserts.check(Asserts.java:34)\r\n            at org.apache.http.pool.AbstractConnPool.lease(AbstractConnPool.java:184)\r\n            at org.apache.http.impl.conn.PoolingHttpClientConnectionManager.requestConnection(PoolingHttpClientConnectionManager.java:251)\r\n            at org.apache.http.impl.execchain.MainClientExec.execute(MainClientExec.java:175)\r\n            at org.apache.http.impl.execchain.ProtocolExec.execute(ProtocolExec.java:184)\r\n            at org.apache.http.impl.execchain.RedirectExec.execute(RedirectExec.java:110)\r\n            at org.apache.http.impl.client.InternalHttpClient.doExecute(InternalHttpClient.java:184)\r\n            at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:82)\r\n            at com.aliyun.oss.common.comm.DefaultServiceClient.sendRequestCore(DefaultServiceClient.java:138)\r\n            at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:133)\r\n            ... 57 more\r\n\r\n    com.aliyun.oss.ClientException: Connection error due to: Connection pool shut down\r\n    [ErrorCode]: Unknown\r\n    [RequestId]: Unknown\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:170)\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequest(ServiceClient.java:70)\r\n        at com.aliyun.oss.internal.OSSOperation.send(OSSOperation.java:83)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:145)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:102)\r\n        at com.aliyun.oss.internal.OSSBucketOperation.listObjectsV2(OSSBucketOperation.java:487)\r\n        at com.aliyun.oss.OSSClient.listObjectsV2(OSSClient.java:466)\r\n        at org.apache.iceberg.aliyun.oss.OSSIntegrationTestRule.tearDownBucket(OSSIntegrationTestRule.java:96)\r\n        at org.apache.iceberg.aliyun.oss.AliyunOSSTestBase.after(AliyunOSSTestBase.java:44)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)\r\n        at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)\r\n        at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)\r\n        at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46)\r\n        at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)\r\n        at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)\r\n        at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)\r\n        at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)\r\n        at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)\r\n        at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)\r\n        at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)\r\n        at org.apache.iceberg.aliyun.oss.AliyunOSSTestRule$1.evaluate(AliyunOSSTestRule.java:50)\r\n        at org.junit.rules.RunRules.evaluate(RunRules.java:20)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.ParentRunner.run(ParentRunner.java:413)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.runTestClass(JUnitTestClassExecutor.java:110)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:58)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:38)\r\n        at org.gradle.api.internal.tasks.testing.junit.AbstractJUnitTestClassProcessor.processTestClass(AbstractJUnitTestClassProcessor.java:62)\r\n        at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:51)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:36)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)\r\n        at org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:33)\r\n        at org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:94)\r\n        at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker$2.run(TestWorker.java:176)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.executeAndMaintainThreadName(TestWorker.java:129)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:100)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:60)\r\n        at org.gradle.process.internal.worker.child.ActionExecutionWorker.execute(ActionExecutionWorker.java:56)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:133)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:71)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.run(GradleWorkerMain.java:69)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.main(GradleWorkerMain.java:74)\r\n\r\n        Caused by:\r\n        java.lang.IllegalStateException: Connection pool shut down\r\n            at org.apache.http.util.Asserts.check(Asserts.java:34)\r\n            at org.apache.http.pool.AbstractConnPool.lease(AbstractConnPool.java:184)\r\n            at org.apache.http.impl.conn.PoolingHttpClientConnectionManager.requestConnection(PoolingHttpClientConnectionManager.java:251)\r\n            at org.apache.http.impl.execchain.MainClientExec.execute(MainClientExec.java:175)\r\n            at org.apache.http.impl.execchain.ProtocolExec.execute(ProtocolExec.java:184)\r\n            at org.apache.http.impl.execchain.RedirectExec.execute(RedirectExec.java:110)\r\n            at org.apache.http.impl.client.InternalHttpClient.doExecute(InternalHttpClient.java:184)\r\n            at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:82)\r\n            at com.aliyun.oss.common.comm.DefaultServiceClient.sendRequestCore(DefaultServiceClient.java:138)\r\n            at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:133)\r\n            ... 54 more\r\n\r\norg.apache.iceberg.aliyun.oss.TestOSSOutputFile > testFromLocation FAILED\r\n    com.aliyun.oss.ClientException: Connection error due to: Connection pool shut down\r\n    [ErrorCode]: Unknown\r\n    [RequestId]: Unknown\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:170)\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequest(ServiceClient.java:70)\r\n        at com.aliyun.oss.internal.OSSOperation.send(OSSOperation.java:83)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:145)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:102)\r\n        at com.aliyun.oss.internal.OSSBucketOperation.getBucketAcl(OSSBucketOperation.java:321)\r\n        at com.aliyun.oss.internal.OSSBucketOperation.doesBucketExists(OSSBucketOperation.java:433)\r\n        at com.aliyun.oss.OSSClient.doesBucketExist(OSSClient.java:438)\r\n        at com.aliyun.oss.OSSClient.doesBucketExist(OSSClient.java:433)\r\n        at org.apache.iceberg.aliyun.oss.OSSIntegrationTestRule.setUpBucket(OSSIntegrationTestRule.java:84)\r\n        at org.apache.iceberg.aliyun.oss.AliyunOSSTestBase.before(AliyunOSSTestBase.java:39)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)\r\n        at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)\r\n        at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)\r\n        at org.junit.internal.runners.statements.RunBefores.invokeMethod(RunBefores.java:33)\r\n        at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24)\r\n        at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)\r\n        at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)\r\n        at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)\r\n        at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)\r\n        at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)\r\n        at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)\r\n        at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)\r\n        at org.apache.iceberg.aliyun.oss.AliyunOSSTestRule$1.evaluate(AliyunOSSTestRule.java:50)\r\n        at org.junit.rules.RunRules.evaluate(RunRules.java:20)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.ParentRunner.run(ParentRunner.java:413)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.runTestClass(JUnitTestClassExecutor.java:110)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:58)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:38)\r\n        at org.gradle.api.internal.tasks.testing.junit.AbstractJUnitTestClassProcessor.processTestClass(AbstractJUnitTestClassProcessor.java:62)\r\n        at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:51)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:36)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)\r\n        at org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:33)\r\n        at org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:94)\r\n        at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker$2.run(TestWorker.java:176)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.executeAndMaintainThreadName(TestWorker.java:129)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:100)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:60)\r\n        at org.gradle.process.internal.worker.child.ActionExecutionWorker.execute(ActionExecutionWorker.java:56)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:133)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:71)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.run(GradleWorkerMain.java:69)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.main(GradleWorkerMain.java:74)\r\n\r\n        Caused by:\r\n        java.lang.IllegalStateException: Connection pool shut down\r\n            at org.apache.http.util.Asserts.check(Asserts.java:34)\r\n            at org.apache.http.pool.AbstractConnPool.lease(AbstractConnPool.java:184)\r\n            at org.apache.http.impl.conn.PoolingHttpClientConnectionManager.requestConnection(PoolingHttpClientConnectionManager.java:251)\r\n            at org.apache.http.impl.execchain.MainClientExec.execute(MainClientExec.java:175)\r\n            at org.apache.http.impl.execchain.ProtocolExec.execute(ProtocolExec.java:184)\r\n            at org.apache.http.impl.execchain.RedirectExec.execute(RedirectExec.java:110)\r\n            at org.apache.http.impl.client.InternalHttpClient.doExecute(InternalHttpClient.java:184)\r\n            at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:82)\r\n            at com.aliyun.oss.common.comm.DefaultServiceClient.sendRequestCore(DefaultServiceClient.java:138)\r\n            at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:133)\r\n            ... 57 more\r\n\r\n    com.aliyun.oss.ClientException: Connection error due to: Connection pool shut down\r\n    [ErrorCode]: Unknown\r\n    [RequestId]: Unknown\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:170)\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequest(ServiceClient.java:70)\r\n        at com.aliyun.oss.internal.OSSOperation.send(OSSOperation.java:83)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:145)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:102)\r\n        at com.aliyun.oss.internal.OSSBucketOperation.listObjectsV2(OSSBucketOperation.java:487)\r\n        at com.aliyun.oss.OSSClient.listObjectsV2(OSSClient.java:466)\r\n        at org.apache.iceberg.aliyun.oss.OSSIntegrationTestRule.tearDownBucket(OSSIntegrationTestRule.java:96)\r\n        at org.apache.iceberg.aliyun.oss.AliyunOSSTestBase.after(AliyunOSSTestBase.java:44)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)\r\n        at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)\r\n        at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)\r\n        at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46)\r\n        at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)\r\n        at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)\r\n        at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)\r\n        at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)\r\n        at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)\r\n        at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)\r\n        at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)\r\n        at org.apache.iceberg.aliyun.oss.AliyunOSSTestRule$1.evaluate(AliyunOSSTestRule.java:50)\r\n        at org.junit.rules.RunRules.evaluate(RunRules.java:20)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.ParentRunner.run(ParentRunner.java:413)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.runTestClass(JUnitTestClassExecutor.java:110)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:58)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:38)\r\n        at org.gradle.api.internal.tasks.testing.junit.AbstractJUnitTestClassProcessor.processTestClass(AbstractJUnitTestClassProcessor.java:62)\r\n        at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:51)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:36)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)\r\n        at org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:33)\r\n        at org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:94)\r\n        at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker$2.run(TestWorker.java:176)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.executeAndMaintainThreadName(TestWorker.java:129)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:100)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:60)\r\n        at org.gradle.process.internal.worker.child.ActionExecutionWorker.execute(ActionExecutionWorker.java:56)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:133)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:71)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.run(GradleWorkerMain.java:69)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.main(GradleWorkerMain.java:74)\r\n\r\n        Caused by:\r\n        java.lang.IllegalStateException: Connection pool shut down\r\n            at org.apache.http.util.Asserts.check(Asserts.java:34)\r\n            at org.apache.http.pool.AbstractConnPool.lease(AbstractConnPool.java:184)\r\n            at org.apache.http.impl.conn.PoolingHttpClientConnectionManager.requestConnection(PoolingHttpClientConnectionManager.java:251)\r\n            at org.apache.http.impl.execchain.MainClientExec.execute(MainClientExec.java:175)\r\n            at org.apache.http.impl.execchain.ProtocolExec.execute(ProtocolExec.java:184)\r\n            at org.apache.http.impl.execchain.RedirectExec.execute(RedirectExec.java:110)\r\n            at org.apache.http.impl.client.InternalHttpClient.doExecute(InternalHttpClient.java:184)\r\n            at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:82)\r\n            at com.aliyun.oss.common.comm.DefaultServiceClient.sendRequestCore(DefaultServiceClient.java:138)\r\n            at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:133)\r\n            ... 54 more\r\n\r\norg.apache.iceberg.aliyun.oss.TestOSSOutputFile > testCreateOrOverwrite FAILED\r\n    com.aliyun.oss.ClientException: Connection error due to: Connection pool shut down\r\n    [ErrorCode]: Unknown\r\n    [RequestId]: Unknown\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:170)\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequest(ServiceClient.java:70)\r\n        at com.aliyun.oss.internal.OSSOperation.send(OSSOperation.java:83)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:145)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:102)\r\n        at com.aliyun.oss.internal.OSSBucketOperation.getBucketAcl(OSSBucketOperation.java:321)\r\n        at com.aliyun.oss.internal.OSSBucketOperation.doesBucketExists(OSSBucketOperation.java:433)\r\n        at com.aliyun.oss.OSSClient.doesBucketExist(OSSClient.java:438)\r\n        at com.aliyun.oss.OSSClient.doesBucketExist(OSSClient.java:433)\r\n        at org.apache.iceberg.aliyun.oss.OSSIntegrationTestRule.setUpBucket(OSSIntegrationTestRule.java:84)\r\n        at org.apache.iceberg.aliyun.oss.AliyunOSSTestBase.before(AliyunOSSTestBase.java:39)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)\r\n        at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)\r\n        at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)\r\n        at org.junit.internal.runners.statements.RunBefores.invokeMethod(RunBefores.java:33)\r\n        at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24)\r\n        at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)\r\n        at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)\r\n        at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)\r\n        at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)\r\n        at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)\r\n        at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)\r\n        at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)\r\n        at org.apache.iceberg.aliyun.oss.AliyunOSSTestRule$1.evaluate(AliyunOSSTestRule.java:50)\r\n        at org.junit.rules.RunRules.evaluate(RunRules.java:20)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.ParentRunner.run(ParentRunner.java:413)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.runTestClass(JUnitTestClassExecutor.java:110)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:58)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:38)\r\n        at org.gradle.api.internal.tasks.testing.junit.AbstractJUnitTestClassProcessor.processTestClass(AbstractJUnitTestClassProcessor.java:62)\r\n        at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:51)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:36)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)\r\n        at org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:33)\r\n        at org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:94)\r\n        at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker$2.run(TestWorker.java:176)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.executeAndMaintainThreadName(TestWorker.java:129)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:100)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:60)\r\n        at org.gradle.process.internal.worker.child.ActionExecutionWorker.execute(ActionExecutionWorker.java:56)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:133)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:71)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.run(GradleWorkerMain.java:69)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.main(GradleWorkerMain.java:74)\r\n\r\n        Caused by:\r\n        java.lang.IllegalStateException: Connection pool shut down\r\n            at org.apache.http.util.Asserts.check(Asserts.java:34)\r\n            at org.apache.http.pool.AbstractConnPool.lease(AbstractConnPool.java:184)\r\n            at org.apache.http.impl.conn.PoolingHttpClientConnectionManager.requestConnection(PoolingHttpClientConnectionManager.java:251)\r\n            at org.apache.http.impl.execchain.MainClientExec.execute(MainClientExec.java:175)\r\n            at org.apache.http.impl.execchain.ProtocolExec.execute(ProtocolExec.java:184)\r\n            at org.apache.http.impl.execchain.RedirectExec.execute(RedirectExec.java:110)\r\n            at org.apache.http.impl.client.InternalHttpClient.doExecute(InternalHttpClient.java:184)\r\n            at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:82)\r\n            at com.aliyun.oss.common.comm.DefaultServiceClient.sendRequestCore(DefaultServiceClient.java:138)\r\n            at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:133)\r\n            ... 57 more\r\n\r\n    com.aliyun.oss.ClientException: Connection error due to: Connection pool shut down\r\n    [ErrorCode]: Unknown\r\n    [RequestId]: Unknown\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:170)\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequest(ServiceClient.java:70)\r\n        at com.aliyun.oss.internal.OSSOperation.send(OSSOperation.java:83)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:145)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:102)\r\n        at com.aliyun.oss.internal.OSSBucketOperation.listObjectsV2(OSSBucketOperation.java:487)\r\n        at com.aliyun.oss.OSSClient.listObjectsV2(OSSClient.java:466)\r\n        at org.apache.iceberg.aliyun.oss.OSSIntegrationTestRule.tearDownBucket(OSSIntegrationTestRule.java:96)\r\n        at org.apache.iceberg.aliyun.oss.AliyunOSSTestBase.after(AliyunOSSTestBase.java:44)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)\r\n        at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)\r\n        at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)\r\n        at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46)\r\n        at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)\r\n        at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)\r\n        at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)\r\n        at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)\r\n        at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)\r\n        at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)\r\n        at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)\r\n        at org.apache.iceberg.aliyun.oss.AliyunOSSTestRule$1.evaluate(AliyunOSSTestRule.java:50)\r\n        at org.junit.rules.RunRules.evaluate(RunRules.java:20)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.ParentRunner.run(ParentRunner.java:413)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.runTestClass(JUnitTestClassExecutor.java:110)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:58)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:38)\r\n        at org.gradle.api.internal.tasks.testing.junit.AbstractJUnitTestClassProcessor.processTestClass(AbstractJUnitTestClassProcessor.java:62)\r\n        at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:51)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:36)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)\r\n        at org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:33)\r\n        at org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:94)\r\n        at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker$2.run(TestWorker.java:176)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.executeAndMaintainThreadName(TestWorker.java:129)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:100)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:60)\r\n        at org.gradle.process.internal.worker.child.ActionExecutionWorker.execute(ActionExecutionWorker.java:56)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:133)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:71)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.run(GradleWorkerMain.java:69)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.main(GradleWorkerMain.java:74)\r\n\r\n        Caused by:\r\n        java.lang.IllegalStateException: Connection pool shut down\r\n            at org.apache.http.util.Asserts.check(Asserts.java:34)\r\n            at org.apache.http.pool.AbstractConnPool.lease(AbstractConnPool.java:184)\r\n            at org.apache.http.impl.conn.PoolingHttpClientConnectionManager.requestConnection(PoolingHttpClientConnectionManager.java:251)\r\n            at org.apache.http.impl.execchain.MainClientExec.execute(MainClientExec.java:175)\r\n            at org.apache.http.impl.execchain.ProtocolExec.execute(ProtocolExec.java:184)\r\n            at org.apache.http.impl.execchain.RedirectExec.execute(RedirectExec.java:110)\r\n            at org.apache.http.impl.client.InternalHttpClient.doExecute(InternalHttpClient.java:184)\r\n            at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:82)\r\n            at com.aliyun.oss.common.comm.DefaultServiceClient.sendRequestCore(DefaultServiceClient.java:138)\r\n            at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:133)\r\n            ... 54 more\r\n\r\norg.apache.iceberg.aliyun.oss.TestOSSOutputFile > testCreate FAILED\r\n    com.aliyun.oss.ClientException: Connection error due to: Connection pool shut down\r\n    [ErrorCode]: Unknown\r\n    [RequestId]: Unknown\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:170)\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequest(ServiceClient.java:70)\r\n        at com.aliyun.oss.internal.OSSOperation.send(OSSOperation.java:83)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:145)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:102)\r\n        at com.aliyun.oss.internal.OSSBucketOperation.getBucketAcl(OSSBucketOperation.java:321)\r\n        at com.aliyun.oss.internal.OSSBucketOperation.doesBucketExists(OSSBucketOperation.java:433)\r\n        at com.aliyun.oss.OSSClient.doesBucketExist(OSSClient.java:438)\r\n        at com.aliyun.oss.OSSClient.doesBucketExist(OSSClient.java:433)\r\n        at org.apache.iceberg.aliyun.oss.OSSIntegrationTestRule.setUpBucket(OSSIntegrationTestRule.java:84)\r\n        at org.apache.iceberg.aliyun.oss.AliyunOSSTestBase.before(AliyunOSSTestBase.java:39)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)\r\n        at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)\r\n        at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)\r\n        at org.junit.internal.runners.statements.RunBefores.invokeMethod(RunBefores.java:33)\r\n        at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24)\r\n        at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)\r\n        at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)\r\n        at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)\r\n        at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)\r\n        at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)\r\n        at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)\r\n        at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)\r\n        at org.apache.iceberg.aliyun.oss.AliyunOSSTestRule$1.evaluate(AliyunOSSTestRule.java:50)\r\n        at org.junit.rules.RunRules.evaluate(RunRules.java:20)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.ParentRunner.run(ParentRunner.java:413)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.runTestClass(JUnitTestClassExecutor.java:110)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:58)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:38)\r\n        at org.gradle.api.internal.tasks.testing.junit.AbstractJUnitTestClassProcessor.processTestClass(AbstractJUnitTestClassProcessor.java:62)\r\n        at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:51)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:36)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)\r\n        at org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:33)\r\n        at org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:94)\r\n        at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker$2.run(TestWorker.java:176)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.executeAndMaintainThreadName(TestWorker.java:129)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:100)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:60)\r\n        at org.gradle.process.internal.worker.child.ActionExecutionWorker.execute(ActionExecutionWorker.java:56)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:133)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:71)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.run(GradleWorkerMain.java:69)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.main(GradleWorkerMain.java:74)\r\n\r\n        Caused by:\r\n        java.lang.IllegalStateException: Connection pool shut down\r\n            at org.apache.http.util.Asserts.check(Asserts.java:34)\r\n            at org.apache.http.pool.AbstractConnPool.lease(AbstractConnPool.java:184)\r\n            at org.apache.http.impl.conn.PoolingHttpClientConnectionManager.requestConnection(PoolingHttpClientConnectionManager.java:251)\r\n            at org.apache.http.impl.execchain.MainClientExec.execute(MainClientExec.java:175)\r\n            at org.apache.http.impl.execchain.ProtocolExec.execute(ProtocolExec.java:184)\r\n            at org.apache.http.impl.execchain.RedirectExec.execute(RedirectExec.java:110)\r\n            at org.apache.http.impl.client.InternalHttpClient.doExecute(InternalHttpClient.java:184)\r\n            at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:82)\r\n            at com.aliyun.oss.common.comm.DefaultServiceClient.sendRequestCore(DefaultServiceClient.java:138)\r\n            at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:133)\r\n            ... 57 more\r\n\r\n    com.aliyun.oss.ClientException: Connection error due to: Connection pool shut down\r\n    [ErrorCode]: Unknown\r\n    [RequestId]: Unknown\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:170)\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequest(ServiceClient.java:70)\r\n        at com.aliyun.oss.internal.OSSOperation.send(OSSOperation.java:83)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:145)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:102)\r\n        at com.aliyun.oss.internal.OSSBucketOperation.listObjectsV2(OSSBucketOperation.java:487)\r\n        at com.aliyun.oss.OSSClient.listObjectsV2(OSSClient.java:466)\r\n        at org.apache.iceberg.aliyun.oss.OSSIntegrationTestRule.tearDownBucket(OSSIntegrationTestRule.java:96)\r\n        at org.apache.iceberg.aliyun.oss.AliyunOSSTestBase.after(AliyunOSSTestBase.java:44)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)\r\n        at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)\r\n        at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)\r\n        at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46)\r\n        at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)\r\n        at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)\r\n        at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)\r\n        at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)\r\n        at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)\r\n        at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)\r\n        at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)\r\n        at org.apache.iceberg.aliyun.oss.AliyunOSSTestRule$1.evaluate(AliyunOSSTestRule.java:50)\r\n        at org.junit.rules.RunRules.evaluate(RunRules.java:20)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.ParentRunner.run(ParentRunner.java:413)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.runTestClass(JUnitTestClassExecutor.java:110)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:58)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:38)\r\n        at org.gradle.api.internal.tasks.testing.junit.AbstractJUnitTestClassProcessor.processTestClass(AbstractJUnitTestClassProcessor.java:62)\r\n        at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:51)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:36)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)\r\n        at org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:33)\r\n        at org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:94)\r\n        at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker$2.run(TestWorker.java:176)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.executeAndMaintainThreadName(TestWorker.java:129)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:100)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:60)\r\n        at org.gradle.process.internal.worker.child.ActionExecutionWorker.execute(ActionExecutionWorker.java:56)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:133)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:71)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.run(GradleWorkerMain.java:69)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.main(GradleWorkerMain.java:74)\r\n\r\n        Caused by:\r\n        java.lang.IllegalStateException: Connection pool shut down\r\n            at org.apache.http.util.Asserts.check(Asserts.java:34)\r\n            at org.apache.http.pool.AbstractConnPool.lease(AbstractConnPool.java:184)\r\n            at org.apache.http.impl.conn.PoolingHttpClientConnectionManager.requestConnection(PoolingHttpClientConnectionManager.java:251)\r\n            at org.apache.http.impl.execchain.MainClientExec.execute(MainClientExec.java:175)\r\n            at org.apache.http.impl.execchain.ProtocolExec.execute(ProtocolExec.java:184)\r\n            at org.apache.http.impl.execchain.RedirectExec.execute(RedirectExec.java:110)\r\n            at org.apache.http.impl.client.InternalHttpClient.doExecute(InternalHttpClient.java:184)\r\n            at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:82)\r\n            at com.aliyun.oss.common.comm.DefaultServiceClient.sendRequestCore(DefaultServiceClient.java:138)\r\n            at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:133)\r\n            ... 54 more\r\n\r\norg.apache.iceberg.aliyun.oss.TestOSSOutputStream > testWrite FAILED\r\n    com.aliyun.oss.ClientException: Connection error due to: Connection pool shut down\r\n    [ErrorCode]: Unknown\r\n    [RequestId]: Unknown\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:170)\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequest(ServiceClient.java:70)\r\n        at com.aliyun.oss.internal.OSSOperation.send(OSSOperation.java:83)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:145)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:102)\r\n        at com.aliyun.oss.internal.OSSBucketOperation.getBucketAcl(OSSBucketOperation.java:321)\r\n        at com.aliyun.oss.internal.OSSBucketOperation.doesBucketExists(OSSBucketOperation.java:433)\r\n        at com.aliyun.oss.OSSClient.doesBucketExist(OSSClient.java:438)\r\n        at com.aliyun.oss.OSSClient.doesBucketExist(OSSClient.java:433)\r\n        at org.apache.iceberg.aliyun.oss.OSSIntegrationTestRule.setUpBucket(OSSIntegrationTestRule.java:84)\r\n        at org.apache.iceberg.aliyun.oss.AliyunOSSTestBase.before(AliyunOSSTestBase.java:39)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)\r\n        at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)\r\n        at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)\r\n        at org.junit.internal.runners.statements.RunBefores.invokeMethod(RunBefores.java:33)\r\n        at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24)\r\n        at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)\r\n        at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)\r\n        at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)\r\n        at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)\r\n        at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)\r\n        at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)\r\n        at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)\r\n        at org.apache.iceberg.aliyun.oss.AliyunOSSTestRule$1.evaluate(AliyunOSSTestRule.java:50)\r\n        at org.junit.rules.RunRules.evaluate(RunRules.java:20)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.ParentRunner.run(ParentRunner.java:413)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.runTestClass(JUnitTestClassExecutor.java:110)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:58)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:38)\r\n        at org.gradle.api.internal.tasks.testing.junit.AbstractJUnitTestClassProcessor.processTestClass(AbstractJUnitTestClassProcessor.java:62)\r\n        at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:51)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:36)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)\r\n        at org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:33)\r\n        at org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:94)\r\n        at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker$2.run(TestWorker.java:176)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.executeAndMaintainThreadName(TestWorker.java:129)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:100)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:60)\r\n        at org.gradle.process.internal.worker.child.ActionExecutionWorker.execute(ActionExecutionWorker.java:56)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:133)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:71)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.run(GradleWorkerMain.java:69)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.main(GradleWorkerMain.java:74)\r\n\r\n        Caused by:\r\n        java.lang.IllegalStateException: Connection pool shut down\r\n            at org.apache.http.util.Asserts.check(Asserts.java:34)\r\n            at org.apache.http.pool.AbstractConnPool.lease(AbstractConnPool.java:184)\r\n            at org.apache.http.impl.conn.PoolingHttpClientConnectionManager.requestConnection(PoolingHttpClientConnectionManager.java:251)\r\n            at org.apache.http.impl.execchain.MainClientExec.execute(MainClientExec.java:175)\r\n            at org.apache.http.impl.execchain.ProtocolExec.execute(ProtocolExec.java:184)\r\n            at org.apache.http.impl.execchain.RedirectExec.execute(RedirectExec.java:110)\r\n            at org.apache.http.impl.client.InternalHttpClient.doExecute(InternalHttpClient.java:184)\r\n            at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:82)\r\n            at com.aliyun.oss.common.comm.DefaultServiceClient.sendRequestCore(DefaultServiceClient.java:138)\r\n            at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:133)\r\n            ... 57 more\r\n\r\n    com.aliyun.oss.ClientException: Connection error due to: Connection pool shut down\r\n    [ErrorCode]: Unknown\r\n    [RequestId]: Unknown\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:170)\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequest(ServiceClient.java:70)\r\n        at com.aliyun.oss.internal.OSSOperation.send(OSSOperation.java:83)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:145)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:102)\r\n        at com.aliyun.oss.internal.OSSBucketOperation.listObjectsV2(OSSBucketOperation.java:487)\r\n        at com.aliyun.oss.OSSClient.listObjectsV2(OSSClient.java:466)\r\n        at org.apache.iceberg.aliyun.oss.OSSIntegrationTestRule.tearDownBucket(OSSIntegrationTestRule.java:96)\r\n        at org.apache.iceberg.aliyun.oss.AliyunOSSTestBase.after(AliyunOSSTestBase.java:44)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)\r\n        at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)\r\n        at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)\r\n        at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46)\r\n        at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)\r\n        at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)\r\n        at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)\r\n        at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)\r\n        at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)\r\n        at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)\r\n        at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)\r\n        at org.apache.iceberg.aliyun.oss.AliyunOSSTestRule$1.evaluate(AliyunOSSTestRule.java:50)\r\n        at org.junit.rules.RunRules.evaluate(RunRules.java:20)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.ParentRunner.run(ParentRunner.java:413)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.runTestClass(JUnitTestClassExecutor.java:110)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:58)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:38)\r\n        at org.gradle.api.internal.tasks.testing.junit.AbstractJUnitTestClassProcessor.processTestClass(AbstractJUnitTestClassProcessor.java:62)\r\n        at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:51)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:36)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)\r\n        at org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:33)\r\n        at org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:94)\r\n        at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker$2.run(TestWorker.java:176)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.executeAndMaintainThreadName(TestWorker.java:129)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:100)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:60)\r\n        at org.gradle.process.internal.worker.child.ActionExecutionWorker.execute(ActionExecutionWorker.java:56)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:133)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:71)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.run(GradleWorkerMain.java:69)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.main(GradleWorkerMain.java:74)\r\n\r\n        Caused by:\r\n        java.lang.IllegalStateException: Connection pool shut down\r\n            at org.apache.http.util.Asserts.check(Asserts.java:34)\r\n            at org.apache.http.pool.AbstractConnPool.lease(AbstractConnPool.java:184)\r\n            at org.apache.http.impl.conn.PoolingHttpClientConnectionManager.requestConnection(PoolingHttpClientConnectionManager.java:251)\r\n            at org.apache.http.impl.execchain.MainClientExec.execute(MainClientExec.java:175)\r\n            at org.apache.http.impl.execchain.ProtocolExec.execute(ProtocolExec.java:184)\r\n            at org.apache.http.impl.execchain.RedirectExec.execute(RedirectExec.java:110)\r\n            at org.apache.http.impl.client.InternalHttpClient.doExecute(InternalHttpClient.java:184)\r\n            at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:82)\r\n            at com.aliyun.oss.common.comm.DefaultServiceClient.sendRequestCore(DefaultServiceClient.java:138)\r\n            at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:133)\r\n            ... 54 more\r\n\r\norg.apache.iceberg.aliyun.oss.TestOSSInputFile > testOSSInputFile FAILED\r\n    com.aliyun.oss.ClientException: Connection error due to: Connection pool shut down\r\n    [ErrorCode]: Unknown\r\n    [RequestId]: Unknown\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:170)\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequest(ServiceClient.java:70)\r\n        at com.aliyun.oss.internal.OSSOperation.send(OSSOperation.java:83)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:145)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:102)\r\n        at com.aliyun.oss.internal.OSSBucketOperation.getBucketAcl(OSSBucketOperation.java:321)\r\n        at com.aliyun.oss.internal.OSSBucketOperation.doesBucketExists(OSSBucketOperation.java:433)\r\n        at com.aliyun.oss.OSSClient.doesBucketExist(OSSClient.java:438)\r\n        at com.aliyun.oss.OSSClient.doesBucketExist(OSSClient.java:433)\r\n        at org.apache.iceberg.aliyun.oss.OSSIntegrationTestRule.setUpBucket(OSSIntegrationTestRule.java:84)\r\n        at org.apache.iceberg.aliyun.oss.AliyunOSSTestBase.before(AliyunOSSTestBase.java:39)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)\r\n        at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)\r\n        at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)\r\n        at org.junit.internal.runners.statements.RunBefores.invokeMethod(RunBefores.java:33)\r\n        at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24)\r\n        at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)\r\n        at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)\r\n        at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)\r\n        at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)\r\n        at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)\r\n        at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)\r\n        at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)\r\n        at org.apache.iceberg.aliyun.oss.AliyunOSSTestRule$1.evaluate(AliyunOSSTestRule.java:50)\r\n        at org.junit.rules.RunRules.evaluate(RunRules.java:20)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.ParentRunner.run(ParentRunner.java:413)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.runTestClass(JUnitTestClassExecutor.java:110)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:58)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:38)\r\n        at org.gradle.api.internal.tasks.testing.junit.AbstractJUnitTestClassProcessor.processTestClass(AbstractJUnitTestClassProcessor.java:62)\r\n        at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:51)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:36)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)\r\n        at org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:33)\r\n        at org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:94)\r\n        at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker$2.run(TestWorker.java:176)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.executeAndMaintainThreadName(TestWorker.java:129)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:100)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:60)\r\n        at org.gradle.process.internal.worker.child.ActionExecutionWorker.execute(ActionExecutionWorker.java:56)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:133)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:71)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.run(GradleWorkerMain.java:69)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.main(GradleWorkerMain.java:74)\r\n\r\n        Caused by:\r\n        java.lang.IllegalStateException: Connection pool shut down\r\n            at org.apache.http.util.Asserts.check(Asserts.java:34)\r\n            at org.apache.http.pool.AbstractConnPool.lease(AbstractConnPool.java:184)\r\n            at org.apache.http.impl.conn.PoolingHttpClientConnectionManager.requestConnection(PoolingHttpClientConnectionManager.java:251)\r\n            at org.apache.http.impl.execchain.MainClientExec.execute(MainClientExec.java:175)\r\n            at org.apache.http.impl.execchain.ProtocolExec.execute(ProtocolExec.java:184)\r\n            at org.apache.http.impl.execchain.RedirectExec.execute(RedirectExec.java:110)\r\n            at org.apache.http.impl.client.InternalHttpClient.doExecute(InternalHttpClient.java:184)\r\n            at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:82)\r\n            at com.aliyun.oss.common.comm.DefaultServiceClient.sendRequestCore(DefaultServiceClient.java:138)\r\n            at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:133)\r\n            ... 57 more\r\n\r\n    com.aliyun.oss.ClientException: Connection error due to: Connection pool shut down\r\n    [ErrorCode]: Unknown\r\n    [RequestId]: Unknown\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:170)\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequest(ServiceClient.java:70)\r\n        at com.aliyun.oss.internal.OSSOperation.send(OSSOperation.java:83)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:145)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:102)\r\n        at com.aliyun.oss.internal.OSSBucketOperation.listObjectsV2(OSSBucketOperation.java:487)\r\n        at com.aliyun.oss.OSSClient.listObjectsV2(OSSClient.java:466)\r\n        at org.apache.iceberg.aliyun.oss.OSSIntegrationTestRule.tearDownBucket(OSSIntegrationTestRule.java:96)\r\n        at org.apache.iceberg.aliyun.oss.AliyunOSSTestBase.after(AliyunOSSTestBase.java:44)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)\r\n        at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)\r\n        at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)\r\n        at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46)\r\n        at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)\r\n        at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)\r\n        at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)\r\n        at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)\r\n        at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)\r\n        at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)\r\n        at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)\r\n        at org.apache.iceberg.aliyun.oss.AliyunOSSTestRule$1.evaluate(AliyunOSSTestRule.java:50)\r\n        at org.junit.rules.RunRules.evaluate(RunRules.java:20)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.ParentRunner.run(ParentRunner.java:413)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.runTestClass(JUnitTestClassExecutor.java:110)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:58)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:38)\r\n        at org.gradle.api.internal.tasks.testing.junit.AbstractJUnitTestClassProcessor.processTestClass(AbstractJUnitTestClassProcessor.java:62)\r\n        at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:51)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:36)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)\r\n        at org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:33)\r\n        at org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:94)\r\n        at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker$2.run(TestWorker.java:176)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.executeAndMaintainThreadName(TestWorker.java:129)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:100)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:60)\r\n        at org.gradle.process.internal.worker.child.ActionExecutionWorker.execute(ActionExecutionWorker.java:56)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:133)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:71)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.run(GradleWorkerMain.java:69)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.main(GradleWorkerMain.java:74)\r\n\r\n        Caused by:\r\n        java.lang.IllegalStateException: Connection pool shut down\r\n            at org.apache.http.util.Asserts.check(Asserts.java:34)\r\n            at org.apache.http.pool.AbstractConnPool.lease(AbstractConnPool.java:184)\r\n            at org.apache.http.impl.conn.PoolingHttpClientConnectionManager.requestConnection(PoolingHttpClientConnectionManager.java:251)\r\n            at org.apache.http.impl.execchain.MainClientExec.execute(MainClientExec.java:175)\r\n            at org.apache.http.impl.execchain.ProtocolExec.execute(ProtocolExec.java:184)\r\n            at org.apache.http.impl.execchain.RedirectExec.execute(RedirectExec.java:110)\r\n            at org.apache.http.impl.client.InternalHttpClient.doExecute(InternalHttpClient.java:184)\r\n            at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:82)\r\n            at com.aliyun.oss.common.comm.DefaultServiceClient.sendRequestCore(DefaultServiceClient.java:138)\r\n            at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:133)\r\n            ... 54 more\r\n\r\norg.apache.iceberg.aliyun.oss.TestOSSInputFile > testReadFile FAILED\r\n    com.aliyun.oss.ClientException: Connection error due to: Connection pool shut down\r\n    [ErrorCode]: Unknown\r\n    [RequestId]: Unknown\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:170)\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequest(ServiceClient.java:70)\r\n        at com.aliyun.oss.internal.OSSOperation.send(OSSOperation.java:83)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:145)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:102)\r\n        at com.aliyun.oss.internal.OSSBucketOperation.getBucketAcl(OSSBucketOperation.java:321)\r\n        at com.aliyun.oss.internal.OSSBucketOperation.doesBucketExists(OSSBucketOperation.java:433)\r\n        at com.aliyun.oss.OSSClient.doesBucketExist(OSSClient.java:438)\r\n        at com.aliyun.oss.OSSClient.doesBucketExist(OSSClient.java:433)\r\n        at org.apache.iceberg.aliyun.oss.OSSIntegrationTestRule.setUpBucket(OSSIntegrationTestRule.java:84)\r\n        at org.apache.iceberg.aliyun.oss.AliyunOSSTestBase.before(AliyunOSSTestBase.java:39)\r\n        at sun.reflect.GeneratedMethodAccessor20.invoke(Unknown Source)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)\r\n        at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)\r\n        at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)\r\n        at org.junit.internal.runners.statements.RunBefores.invokeMethod(RunBefores.java:33)\r\n        at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24)\r\n        at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)\r\n        at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)\r\n        at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)\r\n        at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)\r\n        at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)\r\n        at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)\r\n        at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)\r\n        at org.apache.iceberg.aliyun.oss.AliyunOSSTestRule$1.evaluate(AliyunOSSTestRule.java:50)\r\n        at org.junit.rules.RunRules.evaluate(RunRules.java:20)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.ParentRunner.run(ParentRunner.java:413)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.runTestClass(JUnitTestClassExecutor.java:110)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:58)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:38)\r\n        at org.gradle.api.internal.tasks.testing.junit.AbstractJUnitTestClassProcessor.processTestClass(AbstractJUnitTestClassProcessor.java:62)\r\n        at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:51)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:36)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)\r\n        at org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:33)\r\n        at org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:94)\r\n        at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker$2.run(TestWorker.java:176)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.executeAndMaintainThreadName(TestWorker.java:129)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:100)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:60)\r\n        at org.gradle.process.internal.worker.child.ActionExecutionWorker.execute(ActionExecutionWorker.java:56)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:133)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:71)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.run(GradleWorkerMain.java:69)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.main(GradleWorkerMain.java:74)\r\n\r\n        Caused by:\r\n        java.lang.IllegalStateException: Connection pool shut down\r\n            at org.apache.http.util.Asserts.check(Asserts.java:34)\r\n            at org.apache.http.pool.AbstractConnPool.lease(AbstractConnPool.java:184)\r\n            at org.apache.http.impl.conn.PoolingHttpClientConnectionManager.requestConnection(PoolingHttpClientConnectionManager.java:251)\r\n            at org.apache.http.impl.execchain.MainClientExec.execute(MainClientExec.java:175)\r\n            at org.apache.http.impl.execchain.ProtocolExec.execute(ProtocolExec.java:184)\r\n            at org.apache.http.impl.execchain.RedirectExec.execute(RedirectExec.java:110)\r\n            at org.apache.http.impl.client.InternalHttpClient.doExecute(InternalHttpClient.java:184)\r\n            at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:82)\r\n            at com.aliyun.oss.common.comm.DefaultServiceClient.sendRequestCore(DefaultServiceClient.java:138)\r\n            at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:133)\r\n            ... 56 more\r\n\r\n    com.aliyun.oss.ClientException: Connection error due to: Connection pool shut down\r\n    [ErrorCode]: Unknown\r\n    [RequestId]: Unknown\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:170)\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequest(ServiceClient.java:70)\r\n        at com.aliyun.oss.internal.OSSOperation.send(OSSOperation.java:83)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:145)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:102)\r\n        at com.aliyun.oss.internal.OSSBucketOperation.listObjectsV2(OSSBucketOperation.java:487)\r\n        at com.aliyun.oss.OSSClient.listObjectsV2(OSSClient.java:466)\r\n        at org.apache.iceberg.aliyun.oss.OSSIntegrationTestRule.tearDownBucket(OSSIntegrationTestRule.java:96)\r\n        at org.apache.iceberg.aliyun.oss.AliyunOSSTestBase.after(AliyunOSSTestBase.java:44)\r\n        at sun.reflect.GeneratedMethodAccessor21.invoke(Unknown Source)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)\r\n        at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)\r\n        at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)\r\n        at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46)\r\n        at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)\r\n        at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)\r\n        at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)\r\n        at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)\r\n        at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)\r\n        at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)\r\n        at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)\r\n        at org.apache.iceberg.aliyun.oss.AliyunOSSTestRule$1.evaluate(AliyunOSSTestRule.java:50)\r\n        at org.junit.rules.RunRules.evaluate(RunRules.java:20)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.ParentRunner.run(ParentRunner.java:413)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.runTestClass(JUnitTestClassExecutor.java:110)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:58)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:38)\r\n        at org.gradle.api.internal.tasks.testing.junit.AbstractJUnitTestClassProcessor.processTestClass(AbstractJUnitTestClassProcessor.java:62)\r\n        at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:51)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:36)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)\r\n        at org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:33)\r\n        at org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:94)\r\n        at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker$2.run(TestWorker.java:176)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.executeAndMaintainThreadName(TestWorker.java:129)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:100)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:60)\r\n        at org.gradle.process.internal.worker.child.ActionExecutionWorker.execute(ActionExecutionWorker.java:56)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:133)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:71)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.run(GradleWorkerMain.java:69)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.main(GradleWorkerMain.java:74)\r\n\r\n        Caused by:\r\n        java.lang.IllegalStateException: Connection pool shut down\r\n            at org.apache.http.util.Asserts.check(Asserts.java:34)\r\n            at org.apache.http.pool.AbstractConnPool.lease(AbstractConnPool.java:184)\r\n            at org.apache.http.impl.conn.PoolingHttpClientConnectionManager.requestConnection(PoolingHttpClientConnectionManager.java:251)\r\n            at org.apache.http.impl.execchain.MainClientExec.execute(MainClientExec.java:175)\r\n            at org.apache.http.impl.execchain.ProtocolExec.execute(ProtocolExec.java:184)\r\n            at org.apache.http.impl.execchain.RedirectExec.execute(RedirectExec.java:110)\r\n            at org.apache.http.impl.client.InternalHttpClient.doExecute(InternalHttpClient.java:184)\r\n            at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:82)\r\n            at com.aliyun.oss.common.comm.DefaultServiceClient.sendRequestCore(DefaultServiceClient.java:138)\r\n            at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:133)\r\n            ... 53 more\r\n\r\norg.apache.iceberg.aliyun.oss.TestOSSInputFile > testGetLength FAILED\r\n    com.aliyun.oss.ClientException: Connection error due to: Connection pool shut down\r\n    [ErrorCode]: Unknown\r\n    [RequestId]: Unknown\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:170)\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequest(ServiceClient.java:70)\r\n        at com.aliyun.oss.internal.OSSOperation.send(OSSOperation.java:83)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:145)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:102)\r\n        at com.aliyun.oss.internal.OSSBucketOperation.getBucketAcl(OSSBucketOperation.java:321)\r\n        at com.aliyun.oss.internal.OSSBucketOperation.doesBucketExists(OSSBucketOperation.java:433)\r\n        at com.aliyun.oss.OSSClient.doesBucketExist(OSSClient.java:438)\r\n        at com.aliyun.oss.OSSClient.doesBucketExist(OSSClient.java:433)\r\n        at org.apache.iceberg.aliyun.oss.OSSIntegrationTestRule.setUpBucket(OSSIntegrationTestRule.java:84)\r\n        at org.apache.iceberg.aliyun.oss.AliyunOSSTestBase.before(AliyunOSSTestBase.java:39)\r\n        at sun.reflect.GeneratedMethodAccessor20.invoke(Unknown Source)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)\r\n        at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)\r\n        at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)\r\n        at org.junit.internal.runners.statements.RunBefores.invokeMethod(RunBefores.java:33)\r\n        at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24)\r\n        at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)\r\n        at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)\r\n        at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)\r\n        at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)\r\n        at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)\r\n        at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)\r\n        at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)\r\n        at org.apache.iceberg.aliyun.oss.AliyunOSSTestRule$1.evaluate(AliyunOSSTestRule.java:50)\r\n        at org.junit.rules.RunRules.evaluate(RunRules.java:20)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.ParentRunner.run(ParentRunner.java:413)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.runTestClass(JUnitTestClassExecutor.java:110)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:58)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:38)\r\n        at org.gradle.api.internal.tasks.testing.junit.AbstractJUnitTestClassProcessor.processTestClass(AbstractJUnitTestClassProcessor.java:62)\r\n        at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:51)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:36)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)\r\n        at org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:33)\r\n        at org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:94)\r\n        at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker$2.run(TestWorker.java:176)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.executeAndMaintainThreadName(TestWorker.java:129)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:100)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:60)\r\n        at org.gradle.process.internal.worker.child.ActionExecutionWorker.execute(ActionExecutionWorker.java:56)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:133)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:71)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.run(GradleWorkerMain.java:69)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.main(GradleWorkerMain.java:74)\r\n\r\n        Caused by:\r\n        java.lang.IllegalStateException: Connection pool shut down\r\n            at org.apache.http.util.Asserts.check(Asserts.java:34)\r\n            at org.apache.http.pool.AbstractConnPool.lease(AbstractConnPool.java:184)\r\n            at org.apache.http.impl.conn.PoolingHttpClientConnectionManager.requestConnection(PoolingHttpClientConnectionManager.java:251)\r\n            at org.apache.http.impl.execchain.MainClientExec.execute(MainClientExec.java:175)\r\n            at org.apache.http.impl.execchain.ProtocolExec.execute(ProtocolExec.java:184)\r\n            at org.apache.http.impl.execchain.RedirectExec.execute(RedirectExec.java:110)\r\n            at org.apache.http.impl.client.InternalHttpClient.doExecute(InternalHttpClient.java:184)\r\n            at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:82)\r\n            at com.aliyun.oss.common.comm.DefaultServiceClient.sendRequestCore(DefaultServiceClient.java:138)\r\n            at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:133)\r\n            ... 56 more\r\n\r\n    com.aliyun.oss.ClientException: Connection error due to: Connection pool shut down\r\n    [ErrorCode]: Unknown\r\n    [RequestId]: Unknown\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:170)\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequest(ServiceClient.java:70)\r\n        at com.aliyun.oss.internal.OSSOperation.send(OSSOperation.java:83)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:145)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:102)\r\n        at com.aliyun.oss.internal.OSSBucketOperation.listObjectsV2(OSSBucketOperation.java:487)\r\n        at com.aliyun.oss.OSSClient.listObjectsV2(OSSClient.java:466)\r\n        at org.apache.iceberg.aliyun.oss.OSSIntegrationTestRule.tearDownBucket(OSSIntegrationTestRule.java:96)\r\n        at org.apache.iceberg.aliyun.oss.AliyunOSSTestBase.after(AliyunOSSTestBase.java:44)\r\n        at sun.reflect.GeneratedMethodAccessor21.invoke(Unknown Source)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)\r\n        at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)\r\n        at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)\r\n        at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46)\r\n        at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)\r\n        at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)\r\n        at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)\r\n        at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)\r\n        at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)\r\n        at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)\r\n        at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)\r\n        at org.apache.iceberg.aliyun.oss.AliyunOSSTestRule$1.evaluate(AliyunOSSTestRule.java:50)\r\n        at org.junit.rules.RunRules.evaluate(RunRules.java:20)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.ParentRunner.run(ParentRunner.java:413)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.runTestClass(JUnitTestClassExecutor.java:110)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:58)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:38)\r\n        at org.gradle.api.internal.tasks.testing.junit.AbstractJUnitTestClassProcessor.processTestClass(AbstractJUnitTestClassProcessor.java:62)\r\n        at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:51)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:36)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)\r\n        at org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:33)\r\n        at org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:94)\r\n        at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker$2.run(TestWorker.java:176)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.executeAndMaintainThreadName(TestWorker.java:129)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:100)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:60)\r\n        at org.gradle.process.internal.worker.child.ActionExecutionWorker.execute(ActionExecutionWorker.java:56)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:133)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:71)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.run(GradleWorkerMain.java:69)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.main(GradleWorkerMain.java:74)\r\n\r\n        Caused by:\r\n        java.lang.IllegalStateException: Connection pool shut down\r\n            at org.apache.http.util.Asserts.check(Asserts.java:34)\r\n            at org.apache.http.pool.AbstractConnPool.lease(AbstractConnPool.java:184)\r\n            at org.apache.http.impl.conn.PoolingHttpClientConnectionManager.requestConnection(PoolingHttpClientConnectionManager.java:251)\r\n            at org.apache.http.impl.execchain.MainClientExec.execute(MainClientExec.java:175)\r\n            at org.apache.http.impl.execchain.ProtocolExec.execute(ProtocolExec.java:184)\r\n            at org.apache.http.impl.execchain.RedirectExec.execute(RedirectExec.java:110)\r\n            at org.apache.http.impl.client.InternalHttpClient.doExecute(InternalHttpClient.java:184)\r\n            at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:82)\r\n            at com.aliyun.oss.common.comm.DefaultServiceClient.sendRequestCore(DefaultServiceClient.java:138)\r\n            at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:133)\r\n            ... 53 more\r\n\r\norg.apache.iceberg.aliyun.oss.TestOSSInputFile > testExists FAILED\r\n    com.aliyun.oss.ClientException: Connection error due to: Connection pool shut down\r\n    [ErrorCode]: Unknown\r\n    [RequestId]: Unknown\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:170)\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequest(ServiceClient.java:70)\r\n        at com.aliyun.oss.internal.OSSOperation.send(OSSOperation.java:83)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:145)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:102)\r\n        at com.aliyun.oss.internal.OSSBucketOperation.getBucketAcl(OSSBucketOperation.java:321)\r\n        at com.aliyun.oss.internal.OSSBucketOperation.doesBucketExists(OSSBucketOperation.java:433)\r\n        at com.aliyun.oss.OSSClient.doesBucketExist(OSSClient.java:438)\r\n        at com.aliyun.oss.OSSClient.doesBucketExist(OSSClient.java:433)\r\n        at org.apache.iceberg.aliyun.oss.OSSIntegrationTestRule.setUpBucket(OSSIntegrationTestRule.java:84)\r\n        at org.apache.iceberg.aliyun.oss.AliyunOSSTestBase.before(AliyunOSSTestBase.java:39)\r\n        at sun.reflect.GeneratedMethodAccessor20.invoke(Unknown Source)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)\r\n        at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)\r\n        at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)\r\n        at org.junit.internal.runners.statements.RunBefores.invokeMethod(RunBefores.java:33)\r\n        at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24)\r\n        at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)\r\n        at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)\r\n        at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)\r\n        at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)\r\n        at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)\r\n        at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)\r\n        at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)\r\n        at org.apache.iceberg.aliyun.oss.AliyunOSSTestRule$1.evaluate(AliyunOSSTestRule.java:50)\r\n        at org.junit.rules.RunRules.evaluate(RunRules.java:20)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.ParentRunner.run(ParentRunner.java:413)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.runTestClass(JUnitTestClassExecutor.java:110)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:58)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:38)\r\n        at org.gradle.api.internal.tasks.testing.junit.AbstractJUnitTestClassProcessor.processTestClass(AbstractJUnitTestClassProcessor.java:62)\r\n        at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:51)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:36)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)\r\n        at org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:33)\r\n        at org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:94)\r\n        at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker$2.run(TestWorker.java:176)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.executeAndMaintainThreadName(TestWorker.java:129)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:100)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:60)\r\n        at org.gradle.process.internal.worker.child.ActionExecutionWorker.execute(ActionExecutionWorker.java:56)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:133)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:71)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.run(GradleWorkerMain.java:69)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.main(GradleWorkerMain.java:74)\r\n\r\n        Caused by:\r\n        java.lang.IllegalStateException: Connection pool shut down\r\n            at org.apache.http.util.Asserts.check(Asserts.java:34)\r\n            at org.apache.http.pool.AbstractConnPool.lease(AbstractConnPool.java:184)\r\n            at org.apache.http.impl.conn.PoolingHttpClientConnectionManager.requestConnection(PoolingHttpClientConnectionManager.java:251)\r\n            at org.apache.http.impl.execchain.MainClientExec.execute(MainClientExec.java:175)\r\n            at org.apache.http.impl.execchain.ProtocolExec.execute(ProtocolExec.java:184)\r\n            at org.apache.http.impl.execchain.RedirectExec.execute(RedirectExec.java:110)\r\n            at org.apache.http.impl.client.InternalHttpClient.doExecute(InternalHttpClient.java:184)\r\n            at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:82)\r\n            at com.aliyun.oss.common.comm.DefaultServiceClient.sendRequestCore(DefaultServiceClient.java:138)\r\n            at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:133)\r\n            ... 56 more\r\n\r\n    com.aliyun.oss.ClientException: Connection error due to: Connection pool shut down\r\n    [ErrorCode]: Unknown\r\n    [RequestId]: Unknown\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:170)\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequest(ServiceClient.java:70)\r\n        at com.aliyun.oss.internal.OSSOperation.send(OSSOperation.java:83)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:145)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:102)\r\n        at com.aliyun.oss.internal.OSSBucketOperation.listObjectsV2(OSSBucketOperation.java:487)\r\n        at com.aliyun.oss.OSSClient.listObjectsV2(OSSClient.java:466)\r\n        at org.apache.iceberg.aliyun.oss.OSSIntegrationTestRule.tearDownBucket(OSSIntegrationTestRule.java:96)\r\n        at org.apache.iceberg.aliyun.oss.AliyunOSSTestBase.after(AliyunOSSTestBase.java:44)\r\n        at sun.reflect.GeneratedMethodAccessor21.invoke(Unknown Source)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)\r\n        at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)\r\n        at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)\r\n        at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46)\r\n        at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)\r\n        at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)\r\n        at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)\r\n        at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)\r\n        at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)\r\n        at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)\r\n        at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)\r\n        at org.apache.iceberg.aliyun.oss.AliyunOSSTestRule$1.evaluate(AliyunOSSTestRule.java:50)\r\n        at org.junit.rules.RunRules.evaluate(RunRules.java:20)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.ParentRunner.run(ParentRunner.java:413)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.runTestClass(JUnitTestClassExecutor.java:110)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:58)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:38)\r\n        at org.gradle.api.internal.tasks.testing.junit.AbstractJUnitTestClassProcessor.processTestClass(AbstractJUnitTestClassProcessor.java:62)\r\n        at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:51)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:36)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)\r\n        at org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:33)\r\n        at org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:94)\r\n        at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker$2.run(TestWorker.java:176)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.executeAndMaintainThreadName(TestWorker.java:129)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:100)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:60)\r\n        at org.gradle.process.internal.worker.child.ActionExecutionWorker.execute(ActionExecutionWorker.java:56)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:133)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:71)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.run(GradleWorkerMain.java:69)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.main(GradleWorkerMain.java:74)\r\n\r\n        Caused by:\r\n        java.lang.IllegalStateException: Connection pool shut down\r\n            at org.apache.http.util.Asserts.check(Asserts.java:34)\r\n            at org.apache.http.pool.AbstractConnPool.lease(AbstractConnPool.java:184)\r\n            at org.apache.http.impl.conn.PoolingHttpClientConnectionManager.requestConnection(PoolingHttpClientConnectionManager.java:251)\r\n            at org.apache.http.impl.execchain.MainClientExec.execute(MainClientExec.java:175)\r\n            at org.apache.http.impl.execchain.ProtocolExec.execute(ProtocolExec.java:184)\r\n            at org.apache.http.impl.execchain.RedirectExec.execute(RedirectExec.java:110)\r\n            at org.apache.http.impl.client.InternalHttpClient.doExecute(InternalHttpClient.java:184)\r\n            at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:82)\r\n            at com.aliyun.oss.common.comm.DefaultServiceClient.sendRequestCore(DefaultServiceClient.java:138)\r\n            at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:133)\r\n            ... 53 more\r\n\r\norg.apache.iceberg.aliyun.oss.mock.TestLocalAliyunOSS > testDeleteBucket FAILED\r\n    com.aliyun.oss.OSSException: The bucket has objects. Please delete them first.\r\n    [ErrorCode]: BucketNotEmpty\r\n    [RequestId]: 61A4ABC8BEAC053634593368\r\n    [HostId]: iceberg-test.oss-cn-hangzhou.aliyuncs.com\r\n    [ResponseError]:\r\n    <?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n    <Error>\r\n      <Code>BucketNotEmpty</Code>\r\n      <Message>The bucket has objects. Please delete them first.</Message>\r\n      <RequestId>61A4ABC8BEAC053634593368</RequestId>\r\n      <HostId>iceberg-test.oss-cn-hangzhou.aliyuncs.com</HostId>\r\n      <BucketName>iceberg-test</BucketName>\r\n    </Error>\r\n        at com.aliyun.oss.common.utils.ExceptionFactory.createOSSException(ExceptionFactory.java:100)\r\n        at com.aliyun.oss.internal.OSSErrorResponseHandler.handle(OSSErrorResponseHandler.java:70)\r\n        at com.aliyun.oss.common.comm.ServiceClient.handleResponse(ServiceClient.java:257)\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:140)\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequest(ServiceClient.java:70)\r\n        at com.aliyun.oss.internal.OSSOperation.send(OSSOperation.java:83)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:145)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:102)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:97)\r\n        at com.aliyun.oss.internal.OSSBucketOperation.deleteBucket(OSSBucketOperation.java:231)\r\n        at com.aliyun.oss.OSSClient.deleteBucket(OSSClient.java:352)\r\n        at com.aliyun.oss.OSSClient.deleteBucket(OSSClient.java:347)\r\n        at org.apache.iceberg.aliyun.oss.mock.TestLocalAliyunOSS.testDeleteBucket(TestLocalAliyunOSS.java:100)\r\n\r\norg.apache.iceberg.aliyun.oss.mock.TestLocalAliyunOSS > testBuckets FAILED\r\n    com.aliyun.oss.OSSException: The bucket has objects. Please delete them first.\r\n    [ErrorCode]: BucketNotEmpty\r\n    [RequestId]: 61A4ABC8231683313760ACC4\r\n    [HostId]: iceberg-test.oss-cn-hangzhou.aliyuncs.com\r\n    [ResponseError]:\r\n    <?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n    <Error>\r\n      <Code>BucketNotEmpty</Code>\r\n      <Message>The bucket has objects. Please delete them first.</Message>\r\n      <RequestId>61A4ABC8231683313760ACC4</RequestId>\r\n      <HostId>iceberg-test.oss-cn-hangzhou.aliyuncs.com</HostId>\r\n      <BucketName>iceberg-test</BucketName>\r\n    </Error>\r\n        at com.aliyun.oss.common.utils.ExceptionFactory.createOSSException(ExceptionFactory.java:100)\r\n        at com.aliyun.oss.internal.OSSErrorResponseHandler.handle(OSSErrorResponseHandler.java:70)\r\n        at com.aliyun.oss.common.comm.ServiceClient.handleResponse(ServiceClient.java:257)\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequestImpl(ServiceClient.java:140)\r\n        at com.aliyun.oss.common.comm.ServiceClient.sendRequest(ServiceClient.java:70)\r\n        at com.aliyun.oss.internal.OSSOperation.send(OSSOperation.java:83)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:145)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:102)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:97)\r\n        at com.aliyun.oss.internal.OSSBucketOperation.deleteBucket(OSSBucketOperation.java:231)\r\n        at com.aliyun.oss.OSSClient.deleteBucket(OSSClient.java:352)\r\n        at com.aliyun.oss.OSSClient.deleteBucket(OSSClient.java:347)\r\n        at org.apache.iceberg.aliyun.oss.mock.TestLocalAliyunOSS.testBuckets(TestLocalAliyunOSS.java:75)\r\n\r\norg.apache.iceberg.aliyun.oss.mock.TestLocalAliyunOSS > testPutObject FAILED\r\n    org.junit.ComparisonFailure: expected:<6[e796fee4afcb1ce49f17ad8e214d]996> but was:<6[E796FEE4AFCB1CE49F17AD8E214D]996>\r\n        at org.junit.Assert.assertEquals(Assert.java:117)\r\n        at org.junit.Assert.assertEquals(Assert.java:146)\r\n        at org.apache.iceberg.aliyun.oss.mock.TestLocalAliyunOSS.testPutObject(TestLocalAliyunOSS.java:115)\r\n\r\n37 tests completed, 17 failed\r\n\r\n> Task :iceberg-aliyun:test FAILED\r\n\r\nFAILURE: Build failed with an exception.\r\n\r\n* What went wrong:\r\nExecution failed for task ':iceberg-aliyun:test'.\r\n> There were failing tests. See the report at: file:///Users/openinx/software/apache-iceberg/aliyun/build/reports/tests/test/index.html\r\n\r\n* Try:\r\n> Run with --stacktrace option to get the stack trace.\r\n> Run with --info or --debug option to get more log output.\r\n> Run with --scan to get full insights.\r\n\r\n* Get more help at https://help.gradle.org\r\n\r\nBUILD FAILED in 13s\r\n13 actionable tasks: 2 executed, 11 up-to-date\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/981552957/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/981646949","html_url":"https://github.com/apache/iceberg/issues/3621#issuecomment-981646949","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3621","id":981646949,"node_id":"IC_kwDOCW7NX846gr5l","user":{"login":"findepi","id":144328,"node_id":"MDQ6VXNlcjE0NDMyOA==","avatar_url":"https://avatars.githubusercontent.com/u/144328?v=4","gravatar_id":"","url":"https://api.github.com/users/findepi","html_url":"https://github.com/findepi","followers_url":"https://api.github.com/users/findepi/followers","following_url":"https://api.github.com/users/findepi/following{/other_user}","gists_url":"https://api.github.com/users/findepi/gists{/gist_id}","starred_url":"https://api.github.com/users/findepi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/findepi/subscriptions","organizations_url":"https://api.github.com/users/findepi/orgs","repos_url":"https://api.github.com/users/findepi/repos","events_url":"https://api.github.com/users/findepi/events{/privacy}","received_events_url":"https://api.github.com/users/findepi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-29T13:44:03Z","updated_at":"2021-11-29T15:21:01Z","author_association":"MEMBER","body":"Iceberg 0.12 (`iceberg-spark3-runtime-0.12.jar`) bundles shaded version of\r\nParquet 1.12.\r\n\r\nSince\r\nhttps://github.com/apache/parquet-mr/commit/279255df0c050aa95b5f5eb5963cf7eae5b8d180\r\n(`apache-parquet-1.12.0-rc2` and newer), Parquet requires\r\n`com.github.luben.zstd.ZstdInputStream` to have 2-arg constructor (InputStream,\r\nBufferPool). This is available since\r\nhttps://github.com/luben/zstd-jni/commit/dd2588edd302823fa534de1516e4ae6d6dc6417e,\r\ni.e. zstd-jni `v1.4.5-8` and newer.\r\n\r\n- my spark runtime\r\n  (https://archive.apache.org/dist/spark/spark-3.0.0/spark-3.0.0-bin-hadoop2.7.tgz)\r\n  includes `zstd-jni-1.4.4-3.jar`, so too old for Parquet 1.12 to decode\r\n  ZSTD-compressed parquet files.\r\n\r\n- iceberg seems to bundle zstd-jni too, not sure which version \r\n  (might relate to https://github.com/apache/iceberg/pull/3058)\r\n\r\ni tried using newer spark versions, 3.1.2 and 3.2.0 (both seem to bundle\r\nsufficiently new `zstd-jni`), but was getting \r\n```\r\njava.lang.NoSuchMethodError: 'void org.apache.spark.sql.internal.VariableSubstitution.<init>(org.apache.spark.sql.internal.SQLConf)\r\n```\r\n(i am not sure whether i was testing this with Iceberg 0.12 or 0.11 though)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/981646949/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/981664871","html_url":"https://github.com/apache/iceberg/issues/3617#issuecomment-981664871","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3617","id":981664871,"node_id":"IC_kwDOCW7NX846gwRn","user":{"login":"rajarshisarkar","id":4561678,"node_id":"MDQ6VXNlcjQ1NjE2Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/4561678?v=4","gravatar_id":"","url":"https://api.github.com/users/rajarshisarkar","html_url":"https://github.com/rajarshisarkar","followers_url":"https://api.github.com/users/rajarshisarkar/followers","following_url":"https://api.github.com/users/rajarshisarkar/following{/other_user}","gists_url":"https://api.github.com/users/rajarshisarkar/gists{/gist_id}","starred_url":"https://api.github.com/users/rajarshisarkar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rajarshisarkar/subscriptions","organizations_url":"https://api.github.com/users/rajarshisarkar/orgs","repos_url":"https://api.github.com/users/rajarshisarkar/repos","events_url":"https://api.github.com/users/rajarshisarkar/events{/privacy}","received_events_url":"https://api.github.com/users/rajarshisarkar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-29T14:05:26Z","updated_at":"2021-11-29T14:05:26Z","author_association":"CONTRIBUTOR","body":"Seems like Spark has a validation in `CheckAnalysis` to restrict changing nullable column to non-nullable.\r\n\r\nhttps://github.com/apache/spark/blob/5d45a415f3a29898d92380380cfd82bfc7f579ea/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/analysis/CheckAnalysis.scala#L1009-L1013","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/981664871/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/981737185","html_url":"https://github.com/apache/iceberg/issues/3621#issuecomment-981737185","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3621","id":981737185,"node_id":"IC_kwDOCW7NX846hB7h","user":{"login":"findepi","id":144328,"node_id":"MDQ6VXNlcjE0NDMyOA==","avatar_url":"https://avatars.githubusercontent.com/u/144328?v=4","gravatar_id":"","url":"https://api.github.com/users/findepi","html_url":"https://github.com/findepi","followers_url":"https://api.github.com/users/findepi/followers","following_url":"https://api.github.com/users/findepi/following{/other_user}","gists_url":"https://api.github.com/users/findepi/gists{/gist_id}","starred_url":"https://api.github.com/users/findepi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/findepi/subscriptions","organizations_url":"https://api.github.com/users/findepi/orgs","repos_url":"https://api.github.com/users/findepi/repos","events_url":"https://api.github.com/users/findepi/events{/privacy}","received_events_url":"https://api.github.com/users/findepi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-29T15:21:58Z","updated_at":"2021-11-29T15:21:58Z","author_association":"MEMBER","body":"Iceberg 0.12.1 + Spark 3.1.1 seem to work fine.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/981737185/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/981737541","html_url":"https://github.com/apache/iceberg/issues/3607#issuecomment-981737541","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3607","id":981737541,"node_id":"IC_kwDOCW7NX846hCBF","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-29T15:22:19Z","updated_at":"2021-11-29T15:22:19Z","author_association":"MEMBER","body":"```\r\nMERGE INTO iceberg_hive_cat.iceberg_poc_db.iceberg_tab target\r\nUSING source // no need to select here I believe\r\nON target.col1 = source.col1 AND target.col2 = target.col2 AND target.col3 = source.col3 AND part_date_col between '2021-01-01' and '2021-01-16'\r\n```\r\n\r\nIt works with hidden partitions as well.\r\n\r\nThe MERGE INTO is performed by first doing a an join of Target vs Source where (ON CLAUSE)\r\nIn the join it can then push the contents of on clause down to both target and source if possible. The join type is dependent on the types of \"matched\" clauses. For example a \"not matched\" requires an outer join, a \"matched\" clause only requires an inner join. \r\n\r\nMatched clauses are then applied to specific rows in the result of this join. Because they are not applied universally the predicates inside the match clause cannot be pushed down to \"source\" or \"target\"This is why any pushdown clauses muse be in the \"ON\".\r\n\r\nThis works in on hidden partitioning as well, just as it would in a normal query. If the predicate is on a column that has been partitioned we transform the predicate into the value that was used in partitioning. Certain predicates cannot be transformed though and require a full scan.\r\n\r\nFor example if you say `purchase_ts = timestampOf(2021-01-01)` and you have actually partitioning on `day(purchase_ts)` it transforms the predicate into `day(purchase_ts) = day(timestampOf(2021-01-01)`. \r\n\r\nBut if the partitioning was `bucket(userId)` and your predicate was `userId > 50` there is no way to transform the >50 because bucket uses a hashing. In this case you would want to query on `userID in (50,51,52 ....)` since we can transform equality predicates with the bucket function.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/981737541/reactions","total_count":11,"+1":11,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/981744479","html_url":"https://github.com/apache/iceberg/issues/3621#issuecomment-981744479","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3621","id":981744479,"node_id":"IC_kwDOCW7NX846hDtf","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-29T15:29:40Z","updated_at":"2021-11-29T15:29:40Z","author_association":"MEMBER","body":"Ah yeah we hit this and changed the Spark jni version. @kbendick may remember more?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/981744479/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/981787972","html_url":"https://github.com/apache/iceberg/issues/3621#issuecomment-981787972","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3621","id":981787972,"node_id":"IC_kwDOCW7NX846hOVE","user":{"login":"findepi","id":144328,"node_id":"MDQ6VXNlcjE0NDMyOA==","avatar_url":"https://avatars.githubusercontent.com/u/144328?v=4","gravatar_id":"","url":"https://api.github.com/users/findepi","html_url":"https://github.com/findepi","followers_url":"https://api.github.com/users/findepi/followers","following_url":"https://api.github.com/users/findepi/following{/other_user}","gists_url":"https://api.github.com/users/findepi/gists{/gist_id}","starred_url":"https://api.github.com/users/findepi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/findepi/subscriptions","organizations_url":"https://api.github.com/users/findepi/orgs","repos_url":"https://api.github.com/users/findepi/repos","events_url":"https://api.github.com/users/findepi/events{/privacy}","received_events_url":"https://api.github.com/users/findepi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-29T16:15:45Z","updated_at":"2021-11-29T16:15:45Z","author_association":"MEMBER","body":"@RussellSpitzer thanks for looking into this.\r\n\r\n> Ah yeah we hit this and changed the Spark jni version.\r\n\r\n\r\n\r\nyou mean replacing `zstd-jni-1.4.4-3.jar` with a newer version?\r\nthis could work too,  as long as version shipping with Iceberg isn't picked (https://github.com/apache/iceberg/pull/3058 doesn't seem to be on 0.12.x branch)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/981787972/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/981837253","html_url":"https://github.com/apache/iceberg/issues/3616#issuecomment-981837253","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3616","id":981837253,"node_id":"IC_kwDOCW7NX846haXF","user":{"login":"samredai","id":43911210,"node_id":"MDQ6VXNlcjQzOTExMjEw","avatar_url":"https://avatars.githubusercontent.com/u/43911210?v=4","gravatar_id":"","url":"https://api.github.com/users/samredai","html_url":"https://github.com/samredai","followers_url":"https://api.github.com/users/samredai/followers","following_url":"https://api.github.com/users/samredai/following{/other_user}","gists_url":"https://api.github.com/users/samredai/gists{/gist_id}","starred_url":"https://api.github.com/users/samredai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samredai/subscriptions","organizations_url":"https://api.github.com/users/samredai/orgs","repos_url":"https://api.github.com/users/samredai/repos","events_url":"https://api.github.com/users/samredai/events{/privacy}","received_events_url":"https://api.github.com/users/samredai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-29T17:10:55Z","updated_at":"2021-11-29T17:10:55Z","author_association":"CONTRIBUTOR","body":"@ajantha-bhat I covered this a bit in my reply to Jack on the dev mailing list. We definitely could keep the docs as part of the main repo but there's extra effort on that end as well. The main one being that we'd need to align the branching pattern of the source code with the doc site versioning (`0.12.0` and `0.12.1` branches instead of `0.12.x`, for example). If we go with a separate repo, we would still maintain a copy of the docs in the main repo, and a release of a new iceberg version would include a process of pushing the docs directory to the `iceberg-docs` repo in a branch that matches the version number (we could automate that). The only time commits directly to the iceberg-docs would be required is to fix parts of the previously released versions.\r\n\r\nThere are definitely pros and cons to either direction so a healthy discussion around this would be great. (Although I know this has already been explored in previous convos)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/981837253/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/981911334","html_url":"https://github.com/apache/iceberg/issues/3585#issuecomment-981911334","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3585","id":981911334,"node_id":"IC_kwDOCW7NX846hscm","user":{"login":"racevedoo","id":5193063,"node_id":"MDQ6VXNlcjUxOTMwNjM=","avatar_url":"https://avatars.githubusercontent.com/u/5193063?v=4","gravatar_id":"","url":"https://api.github.com/users/racevedoo","html_url":"https://github.com/racevedoo","followers_url":"https://api.github.com/users/racevedoo/followers","following_url":"https://api.github.com/users/racevedoo/following{/other_user}","gists_url":"https://api.github.com/users/racevedoo/gists{/gist_id}","starred_url":"https://api.github.com/users/racevedoo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/racevedoo/subscriptions","organizations_url":"https://api.github.com/users/racevedoo/orgs","repos_url":"https://api.github.com/users/racevedoo/repos","events_url":"https://api.github.com/users/racevedoo/events{/privacy}","received_events_url":"https://api.github.com/users/racevedoo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-29T18:42:52Z","updated_at":"2021-11-29T18:42:52Z","author_association":"CONTRIBUTOR","body":"> add .config(\"spark.sql.sources.partitionOverwriteMode\", \"dynamic\") to try\r\n\r\njust tried it, got the same error","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/981911334/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/981913847","html_url":"https://github.com/apache/iceberg/issues/3621#issuecomment-981913847","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3621","id":981913847,"node_id":"IC_kwDOCW7NX846htD3","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-29T18:46:33Z","updated_at":"2021-11-29T18:58:04Z","author_association":"CONTRIBUTOR","body":"I believe @RussellSpitzer is referring to upgrading the zstd-jni version with a later version. So your question is correct @findepi.\r\n\r\nIdeally, it should come from Spark (at least for spark3-runtime) which was the point of #3058  \r\n\r\n> this could work too, as long as version shipping with Iceberg isn't picked (#3058 doesn't seem to be on 0.12.x branch)\r\n\r\nYou are right, it does appear that #3058 was never included in 0.12.1 or the 0.12.x branch in general.\r\n\r\n0.12.0 was released prior to that PR being merged, and then with the repo layout changes and only grabbing for bugs it seems we might have missed it when preparing 0.12.1.\r\n\r\nI'll be sure to add that to the upcoming 0.13.0 release. Not sure if https://github.com/apache/iceberg/pull/3058 itself merits a patch release. Would it be possible to exclude the dependency from the trino side momentarily?\r\n\r\nWhat do others think?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/981913847/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/981916343","html_url":"https://github.com/apache/iceberg/pull/3058#issuecomment-981916343","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3058","id":981916343,"node_id":"IC_kwDOCW7NX846htq3","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-29T18:50:01Z","updated_at":"2021-11-29T18:50:01Z","author_association":"CONTRIBUTOR","body":"I added this to 0.13.0 milestone as it appears it didn't ship with 0.12.1.\r\n\r\nI'm not sure if this merits a patch release to 0.12.2... I'd say since we're in progress towards 0.13.0 that it would be easier to hold off.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/981916343/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/981920584","html_url":"https://github.com/apache/iceberg/issues/3621#issuecomment-981920584","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3621","id":981920584,"node_id":"IC_kwDOCW7NX846hutI","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-29T18:55:49Z","updated_at":"2021-11-29T18:55:49Z","author_association":"CONTRIBUTOR","body":"It might be possible to disable the buffer pool (which would not be great from a performance standpoint, but might be helpful in working around the original issue): https://github.com/apache/parquet-mr/pull/903\r\n\r\nThe relevant parquet config is `parquet.compression.codec.zstd.bufferPool.enabled`. That might stop it from using that particular constructor.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/981920584/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/981921693","html_url":"https://github.com/apache/iceberg/issues/3062#issuecomment-981921693","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3062","id":981921693,"node_id":"IC_kwDOCW7NX846hu-d","user":{"login":"kishendas","id":528086,"node_id":"MDQ6VXNlcjUyODA4Ng==","avatar_url":"https://avatars.githubusercontent.com/u/528086?v=4","gravatar_id":"","url":"https://api.github.com/users/kishendas","html_url":"https://github.com/kishendas","followers_url":"https://api.github.com/users/kishendas/followers","following_url":"https://api.github.com/users/kishendas/following{/other_user}","gists_url":"https://api.github.com/users/kishendas/gists{/gist_id}","starred_url":"https://api.github.com/users/kishendas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kishendas/subscriptions","organizations_url":"https://api.github.com/users/kishendas/orgs","repos_url":"https://api.github.com/users/kishendas/repos","events_url":"https://api.github.com/users/kishendas/events{/privacy}","received_events_url":"https://api.github.com/users/kishendas/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-29T18:57:20Z","updated_at":"2021-11-29T18:57:20Z","author_association":"NONE","body":"We have also observed this same behavior with Iceberg 0.10 version on Databricks environment, where Input/Output metrics ( bytesRead and bytesWritten) are not showing up. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/981921693/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/981922987","html_url":"https://github.com/apache/iceberg/issues/3621#issuecomment-981922987","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3621","id":981922987,"node_id":"IC_kwDOCW7NX846hvSr","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-29T18:59:15Z","updated_at":"2021-11-29T18:59:15Z","author_association":"CONTRIBUTOR","body":"> Not sure if #3058 itself merits a patch release\r\n\r\nI wonder if Trino can hold on  https://github.com/trinodb/trino/pull/10045 to wait for 0.13.0 for the fix given it's just around the corner.\r\n\r\nBut from correctness perspective I think it's good to have a 0.12.2 for this later.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/981922987/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/981959293","html_url":"https://github.com/apache/iceberg/issues/3620#issuecomment-981959293","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3620","id":981959293,"node_id":"IC_kwDOCW7NX846h4J9","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-29T19:46:23Z","updated_at":"2021-11-29T19:46:23Z","author_association":"CONTRIBUTOR","body":"I'm not sure why it's trying to resolve to `working@mymachine`.\r\n\r\nFor example, when it tries this webpage: https://repo1.maven.org/maven2/org/slf4j/slf4j-api/\r\n\r\nIt tries https://repo1.maven.org/maven2/org/slf4j/slf4j-api/working@mymachine.\r\n\r\nBut going to that webpage, they're all a list of versions, such as https://repo1.maven.org/maven2/org/slf4j/slf4j-api/1.7.10/\r\n\r\nSo what I'm most confused about is how it has resolved the slf4j dependency as `working@mymachine`.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/981959293/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/981961435","html_url":"https://github.com/apache/iceberg/issues/3620#issuecomment-981961435","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3620","id":981961435,"node_id":"IC_kwDOCW7NX846h4rb","user":{"login":"racevedoo","id":5193063,"node_id":"MDQ6VXNlcjUxOTMwNjM=","avatar_url":"https://avatars.githubusercontent.com/u/5193063?v=4","gravatar_id":"","url":"https://api.github.com/users/racevedoo","html_url":"https://github.com/racevedoo","followers_url":"https://api.github.com/users/racevedoo/followers","following_url":"https://api.github.com/users/racevedoo/following{/other_user}","gists_url":"https://api.github.com/users/racevedoo/gists{/gist_id}","starred_url":"https://api.github.com/users/racevedoo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/racevedoo/subscriptions","organizations_url":"https://api.github.com/users/racevedoo/orgs","repos_url":"https://api.github.com/users/racevedoo/repos","events_url":"https://api.github.com/users/racevedoo/events{/privacy}","received_events_url":"https://api.github.com/users/racevedoo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-29T19:49:21Z","updated_at":"2021-11-29T19:49:21Z","author_association":"CONTRIBUTOR","body":"I'm really confused about the `working@mymachine` too, but couldn't find the root cause. Were you able to reproduce @kbendick ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/981961435/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/981961774","html_url":"https://github.com/apache/iceberg/issues/3620#issuecomment-981961774","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3620","id":981961774,"node_id":"IC_kwDOCW7NX846h4wu","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-29T19:49:49Z","updated_at":"2021-11-29T19:49:49Z","author_association":"CONTRIBUTOR","body":"Oh. On further inspection, it looks like it resolves to both 1.7.25 and 1.7.30 for slf4j-core, which is causing the issue.\r\n\r\nhttps://gist.github.com/racevedoo/3530bce04364629f81217e78dea66071#file-spark-shell-log-L371-L375\r\n\r\nThe `working@mymachine` seems to come from your local classpath of slf4j.\r\n\r\n```\r\n        :: evicted modules:\r\n        org.slf4j#slf4j-api;1.7.25 by [org.slf4j#slf4j-api;working@mymachine] in [default]\r\n        org.slf4j#slf4j-api;working@mymachine by [org.slf4j#slf4j-api;1.7.30] in [default]\r\n        com.fasterxml.jackson.core#jackson-core;2.11.3 by [com.fasterxml.jackson.core#jackson-core;2.11.4] in [default]\r\n        com.fasterxml.jackson.core#jackson-databind;2.11.3 by [com.fasterxml.jackson.core#jackson-databind;2.11.4] in [default]\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/981961774/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/981964054","html_url":"https://github.com/apache/iceberg/issues/3620#issuecomment-981964054","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3620","id":981964054,"node_id":"IC_kwDOCW7NX846h5UW","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-29T19:53:03Z","updated_at":"2021-11-29T19:53:03Z","author_association":"CONTRIBUTOR","body":"I get a similar issue, though the path is `working@Kyles-Computer`.\r\n\r\nLet's try removing some of the glue deps etc and see if maybe that's what's causing the issue?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/981964054/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/981966694","html_url":"https://github.com/apache/iceberg/issues/3620#issuecomment-981966694","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3620","id":981966694,"node_id":"IC_kwDOCW7NX846h59m","user":{"login":"racevedoo","id":5193063,"node_id":"MDQ6VXNlcjUxOTMwNjM=","avatar_url":"https://avatars.githubusercontent.com/u/5193063?v=4","gravatar_id":"","url":"https://api.github.com/users/racevedoo","html_url":"https://github.com/racevedoo","followers_url":"https://api.github.com/users/racevedoo/followers","following_url":"https://api.github.com/users/racevedoo/following{/other_user}","gists_url":"https://api.github.com/users/racevedoo/gists{/gist_id}","starred_url":"https://api.github.com/users/racevedoo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/racevedoo/subscriptions","organizations_url":"https://api.github.com/users/racevedoo/orgs","repos_url":"https://api.github.com/users/racevedoo/repos","events_url":"https://api.github.com/users/racevedoo/events{/privacy}","received_events_url":"https://api.github.com/users/racevedoo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-29T19:56:52Z","updated_at":"2021-11-29T19:56:52Z","author_association":"CONTRIBUTOR","body":"I got the same issue with no dependencies other than `iceberg-spark-3.2-runtime`\r\n```\r\nspark-shell --repositories https://repository.apache.org/content/repositories/snapshots \\\r\n --packages org.apache.iceberg:iceberg-spark-3.2-runtime:0.13.0-SNAPSHOT\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/981966694/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/981969283","html_url":"https://github.com/apache/iceberg/issues/3620#issuecomment-981969283","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3620","id":981969283,"node_id":"IC_kwDOCW7NX846h6mD","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-29T20:00:50Z","updated_at":"2021-11-29T20:00:50Z","author_association":"CONTRIBUTOR","body":"Yeah I did as well. I admittedly havne't used the snapshot dependency pulling it from the snapshot repo.\r\n\r\ncc @nastra who setup the SNAPSHOT release process. Wondering if you can reproduce an issue with trying to start a Spark 3.2 shell with iceberg 0.13.0-SNAPSHOT.\r\n\r\n```\r\n# Assuming spark-shell is linked to Spark 3.2.0.\r\nspark-shell --repositories https://repository.apache.org/content/repositories/snapshots --packages org.apache.iceberg:iceberg-spark3-runtime:0.12.1\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/981969283/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/981982865","html_url":"https://github.com/apache/iceberg/issues/3621#issuecomment-981982865","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3621","id":981982865,"node_id":"IC_kwDOCW7NX846h96R","user":{"login":"findepi","id":144328,"node_id":"MDQ6VXNlcjE0NDMyOA==","avatar_url":"https://avatars.githubusercontent.com/u/144328?v=4","gravatar_id":"","url":"https://api.github.com/users/findepi","html_url":"https://github.com/findepi","followers_url":"https://api.github.com/users/findepi/followers","following_url":"https://api.github.com/users/findepi/following{/other_user}","gists_url":"https://api.github.com/users/findepi/gists{/gist_id}","starred_url":"https://api.github.com/users/findepi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/findepi/subscriptions","organizations_url":"https://api.github.com/users/findepi/orgs","repos_url":"https://api.github.com/users/findepi/repos","events_url":"https://api.github.com/users/findepi/events{/privacy}","received_events_url":"https://api.github.com/users/findepi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-29T20:17:29Z","updated_at":"2021-11-29T20:17:40Z","author_association":"MEMBER","body":"> Would it be possible to exclude the dependency from the trino side momentarily?\r\n\r\nTrino doesn't use the Parquet reader bundled with Iceberg, so it is not affected.\r\n\r\nI faced this problem in Trino's compatibility tests against Spark, where the Iceberg+Spark setup we have was failing. I thing I solved this (https://github.com/apache/iceberg/issues/3621#issuecomment-981737185, https://github.com/trinodb/docker-images/pull/119). Will close this issue once i can confirm with the CI. \r\n\r\n\r\n\r\n> The relevant parquet config is `parquet.compression.codec.zstd.bufferPool.enabled`. That might stop it from using that particular constructor.\r\n\r\nfor posterity -- my cursory reading of Parquet code suggests that this flag controls what kind of BufferPool is passed to the problematic constructor, not whether the constructor is used. Thus, it seems not effective to enable running with older zstd-jni version.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/981982865/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/982018225","html_url":"https://github.com/apache/iceberg/issues/3393#issuecomment-982018225","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3393","id":982018225,"node_id":"IC_kwDOCW7NX846iGix","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-29T20:59:56Z","updated_at":"2021-11-29T20:59:56Z","author_association":"CONTRIBUTOR","body":"@openinx I am following up on this, but wondering if you have any new information on this to add?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/982018225/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/982087771","html_url":"https://github.com/apache/iceberg/pull/3622#issuecomment-982087771","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3622","id":982087771,"node_id":"IC_kwDOCW7NX846iXhb","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-29T22:38:52Z","updated_at":"2021-11-29T22:38:52Z","author_association":"CONTRIBUTOR","body":"Could you add a check in tests to verify the behavior?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/982087771/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/982107480","html_url":"https://github.com/apache/iceberg/pull/3624#issuecomment-982107480","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3624","id":982107480,"node_id":"IC_kwDOCW7NX846icVY","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-29T23:09:10Z","updated_at":"2021-11-29T23:09:10Z","author_association":"CONTRIBUTOR","body":"This looks good to me. Thanks for getting this ready, @kbendick! I'll leave this open for a bit to make sure everyone agrees on the module names.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/982107480/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/982122940","html_url":"https://github.com/apache/iceberg/pull/3623#issuecomment-982122940","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3623","id":982122940,"node_id":"IC_kwDOCW7NX846igG8","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-29T23:20:14Z","updated_at":"2021-11-29T23:20:14Z","author_association":"CONTRIBUTOR","body":"Once a decision is made with respect to the new Spark naming convention (with Scala versions), https://github.com/apache/iceberg/pull/3624, I'll update this PR to reflect that.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/982122940/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/982131502","html_url":"https://github.com/apache/iceberg/issues/3621#issuecomment-982131502","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3621","id":982131502,"node_id":"IC_kwDOCW7NX846iiMu","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-29T23:35:43Z","updated_at":"2021-11-29T23:35:43Z","author_association":"CONTRIBUTOR","body":"> I faced this problem in Trino's compatibility tests against Spark\r\n\r\nYes the compatibility test is what I am talking about on Trino side. If that's fixed then it should be fine.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/982131502/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/982135982","html_url":"https://github.com/apache/iceberg/issues/3393#issuecomment-982135982","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3393","id":982135982,"node_id":"IC_kwDOCW7NX846ijSu","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-29T23:46:14Z","updated_at":"2021-11-29T23:46:14Z","author_association":"CONTRIBUTOR","body":"I'm marking this as important for 0.13.0.\r\n\r\nIt seems that this bug only occurs when CBO is on, but I really don't know enough about Hive to be able to say much beyond that.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/982135982/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/982151865","html_url":"https://github.com/apache/iceberg/pull/3624#issuecomment-982151865","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3624","id":982151865,"node_id":"IC_kwDOCW7NX846inK5","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-30T00:14:20Z","updated_at":"2021-11-30T00:14:20Z","author_association":"CONTRIBUTOR","body":"> Probably need to have system properties for supported scala versions in the future, but it should be fine for now since we only support one version.\r\n\r\nAgreed. There are also gradle plugins to support multiple Scala versions from the same module if we want to try those. I thought it was too complicated for the current build, since we only support 2.12 at the moment. We can put that off until later.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/982151865/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/982157204","html_url":"https://github.com/apache/iceberg/pull/3624#issuecomment-982157204","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3624","id":982157204,"node_id":"IC_kwDOCW7NX846ioeU","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-30T00:22:00Z","updated_at":"2021-11-30T03:56:55Z","author_association":"CONTRIBUTOR","body":"> > Probably need to have system properties for supported scala versions in the future, but it should be fine for now since we only support one version.\r\n> \r\n> Agreed. There are also gradle plugins to support multiple Scala versions from the same module if we want to try those. I thought it was too complicated for the current build, since we only support 2.12 at the moment. We can put that off until later.\r\n\r\nAgreed. I looked into some of the plugins, but there didn't seem to be a clear winner / most commonly used one. So given that there's only the one version I figured I'd let it be for now.\r\n\r\nIf anybody has preference or input on a Gradle plugin to manage multi-version Scala builds, please feel free to mention them 🙂","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/982157204/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/982179988","html_url":"https://github.com/apache/iceberg/pull/3059#issuecomment-982179988","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3059","id":982179988,"node_id":"IC_kwDOCW7NX846iuCU","user":{"login":"xinbinhuang","id":27927454,"node_id":"MDQ6VXNlcjI3OTI3NDU0","avatar_url":"https://avatars.githubusercontent.com/u/27927454?v=4","gravatar_id":"","url":"https://api.github.com/users/xinbinhuang","html_url":"https://github.com/xinbinhuang","followers_url":"https://api.github.com/users/xinbinhuang/followers","following_url":"https://api.github.com/users/xinbinhuang/following{/other_user}","gists_url":"https://api.github.com/users/xinbinhuang/gists{/gist_id}","starred_url":"https://api.github.com/users/xinbinhuang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xinbinhuang/subscriptions","organizations_url":"https://api.github.com/users/xinbinhuang/orgs","repos_url":"https://api.github.com/users/xinbinhuang/repos","events_url":"https://api.github.com/users/xinbinhuang/events{/privacy}","received_events_url":"https://api.github.com/users/xinbinhuang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-30T00:57:11Z","updated_at":"2021-11-30T00:57:23Z","author_association":"CONTRIBUTOR","body":"@rdblue @aokolnychyi @kbendick  would you help take a look when you have time? Would love to get this merged before it goes into stale. thank you :)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/982179988/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/982219000","html_url":"https://github.com/apache/iceberg/issues/3617#issuecomment-982219000","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3617","id":982219000,"node_id":"IC_kwDOCW7NX846i3j4","user":{"login":"Initial-neko","id":40999666,"node_id":"MDQ6VXNlcjQwOTk5NjY2","avatar_url":"https://avatars.githubusercontent.com/u/40999666?v=4","gravatar_id":"","url":"https://api.github.com/users/Initial-neko","html_url":"https://github.com/Initial-neko","followers_url":"https://api.github.com/users/Initial-neko/followers","following_url":"https://api.github.com/users/Initial-neko/following{/other_user}","gists_url":"https://api.github.com/users/Initial-neko/gists{/gist_id}","starred_url":"https://api.github.com/users/Initial-neko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Initial-neko/subscriptions","organizations_url":"https://api.github.com/users/Initial-neko/orgs","repos_url":"https://api.github.com/users/Initial-neko/repos","events_url":"https://api.github.com/users/Initial-neko/events{/privacy}","received_events_url":"https://api.github.com/users/Initial-neko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-30T02:22:45Z","updated_at":"2021-11-30T02:22:45Z","author_association":"NONE","body":"> \r\n\r\nThis operation may be unsafe if not used properly，I get answer from slack。\r\n\r\nDaniel Weeks ：**This is a bit of an edge case and while you could technically support deeper inspection of the data to allow those modifications, it currently isn't supported.  The API does allow for a workaround, but that can be problematic if used incorrectly.**","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/982219000/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/982221430","html_url":"https://github.com/apache/iceberg/issues/3507#issuecomment-982221430","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3507","id":982221430,"node_id":"IC_kwDOCW7NX846i4J2","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-30T02:28:30Z","updated_at":"2021-11-30T02:28:30Z","author_association":"MEMBER","body":"@ayush-san , then I think we will write a simple tool to convert the unstable v2 format from 0.11.x to the stable v2 format like 0.12.1 version. I think the key thing is converting the `schema` changes which was introduced from #2096.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/982221430/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/982224788","html_url":"https://github.com/apache/iceberg/pull/3269#issuecomment-982224788","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3269","id":982224788,"node_id":"IC_kwDOCW7NX846i4-U","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-30T02:36:57Z","updated_at":"2021-11-30T02:36:57Z","author_association":"CONTRIBUTOR","body":"@rdblue do you intend to go forward with some form of this PR as a way to enable implementing schema for snapshot for Spark 3 (until what Huaxin proposes is implemented in a released Spark version)? Do we have to wait for a decision on @nastra's proposal in https://docs.google.com/document/d/1KSgkVYnIMlWEbAT1qSnnnLS-gc0kdgHlWR6Ud08HOhA/edit# to change `TableIdentifier`? From your comments on that document, I have the impression that you do not think `TableIdentifier` should be changed.\r\nIf you do think a form of this PR is the way forward but are currently very busy, I'm happy to incorporate some form of this PR in a single PR to support schema for snapshot in Spark 3 (basically an update of #3314).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/982224788/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]