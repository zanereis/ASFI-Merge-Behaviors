[{"url":"https://api.github.com/repos/apache/druid/issues/comments/283488223","html_url":"https://github.com/apache/druid/pull/3981#issuecomment-283488223","issue_url":"https://api.github.com/repos/apache/druid/issues/3981","id":283488223,"node_id":"MDEyOklzc3VlQ29tbWVudDI4MzQ4ODIyMw==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-01T22:13:42Z","updated_at":"2017-03-01T22:13:42Z","author_association":"CONTRIBUTOR","body":"@kaijianding, this generally looks good to me. Could you include a test, ideally one for behavior and one for serde of the task itself?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/283488223/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/283491360","html_url":"https://github.com/apache/druid/pull/3895#issuecomment-283491360","issue_url":"https://api.github.com/repos/apache/druid/issues/3895","id":283491360,"node_id":"MDEyOklzc3VlQ29tbWVudDI4MzQ5MTM2MA==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-01T22:26:21Z","updated_at":"2017-03-01T22:26:21Z","author_association":"CONTRIBUTOR","body":"ðŸ‘ \r\n\r\n@schmee, have you been able to fill out the CLA?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/283491360/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/283491582","html_url":"https://github.com/apache/druid/pull/3989#issuecomment-283491582","issue_url":"https://api.github.com/repos/apache/druid/issues/3989","id":283491582,"node_id":"MDEyOklzc3VlQ29tbWVudDI4MzQ5MTU4Mg==","user":{"login":"fjy","id":428325,"node_id":"MDQ6VXNlcjQyODMyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/428325?v=4","gravatar_id":"","url":"https://api.github.com/users/fjy","html_url":"https://github.com/fjy","followers_url":"https://api.github.com/users/fjy/followers","following_url":"https://api.github.com/users/fjy/following{/other_user}","gists_url":"https://api.github.com/users/fjy/gists{/gist_id}","starred_url":"https://api.github.com/users/fjy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fjy/subscriptions","organizations_url":"https://api.github.com/users/fjy/orgs","repos_url":"https://api.github.com/users/fjy/repos","events_url":"https://api.github.com/users/fjy/events{/privacy}","received_events_url":"https://api.github.com/users/fjy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-01T22:27:10Z","updated_at":"2017-03-01T22:27:10Z","author_association":"CONTRIBUTOR","body":"ðŸ‘ ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/283491582/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/283492397","html_url":"https://github.com/apache/druid/pull/3704#issuecomment-283492397","issue_url":"https://api.github.com/repos/apache/druid/issues/3704","id":283492397,"node_id":"MDEyOklzc3VlQ29tbWVudDI4MzQ5MjM5Nw==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-01T22:30:16Z","updated_at":"2017-03-01T22:30:16Z","author_association":"CONTRIBUTOR","body":"@anshbansal thanks, and thank you for the contribution!","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/283492397/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/283523086","html_url":"https://github.com/apache/druid/pull/3989#issuecomment-283523086","issue_url":"https://api.github.com/repos/apache/druid/issues/3989","id":283523086,"node_id":"MDEyOklzc3VlQ29tbWVudDI4MzUyMzA4Ng==","user":{"login":"fjy","id":428325,"node_id":"MDQ6VXNlcjQyODMyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/428325?v=4","gravatar_id":"","url":"https://api.github.com/users/fjy","html_url":"https://github.com/fjy","followers_url":"https://api.github.com/users/fjy/followers","following_url":"https://api.github.com/users/fjy/following{/other_user}","gists_url":"https://api.github.com/users/fjy/gists{/gist_id}","starred_url":"https://api.github.com/users/fjy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fjy/subscriptions","organizations_url":"https://api.github.com/users/fjy/orgs","repos_url":"https://api.github.com/users/fjy/repos","events_url":"https://api.github.com/users/fjy/events{/privacy}","received_events_url":"https://api.github.com/users/fjy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-02T01:04:00Z","updated_at":"2017-03-02T01:04:00Z","author_association":"CONTRIBUTOR","body":"@gianm can you reverse this? i had too many tabs open and merged teh wrong PR :P","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/283523086/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/283523245","html_url":"https://github.com/apache/druid/pull/3989#issuecomment-283523245","issue_url":"https://api.github.com/repos/apache/druid/issues/3989","id":283523245,"node_id":"MDEyOklzc3VlQ29tbWVudDI4MzUyMzI0NQ==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-02T01:04:55Z","updated_at":"2017-03-02T01:04:55Z","author_association":"CONTRIBUTOR","body":"Sure, I'll revert the commit and re-open the PR","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/283523245/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/283523328","html_url":"https://github.com/apache/druid/pull/3986#issuecomment-283523328","issue_url":"https://api.github.com/repos/apache/druid/issues/3986","id":283523328,"node_id":"MDEyOklzc3VlQ29tbWVudDI4MzUyMzMyOA==","user":{"login":"fjy","id":428325,"node_id":"MDQ6VXNlcjQyODMyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/428325?v=4","gravatar_id":"","url":"https://api.github.com/users/fjy","html_url":"https://github.com/fjy","followers_url":"https://api.github.com/users/fjy/followers","following_url":"https://api.github.com/users/fjy/following{/other_user}","gists_url":"https://api.github.com/users/fjy/gists{/gist_id}","starred_url":"https://api.github.com/users/fjy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fjy/subscriptions","organizations_url":"https://api.github.com/users/fjy/orgs","repos_url":"https://api.github.com/users/fjy/repos","events_url":"https://api.github.com/users/fjy/events{/privacy}","received_events_url":"https://api.github.com/users/fjy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-02T01:05:25Z","updated_at":"2017-03-02T01:05:25Z","author_association":"CONTRIBUTOR","body":"ðŸ‘ \r\n\r\nThis was the PR I thought I was merging before accidentally merging https://github.com/druid-io/druid/pull/3989","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/283523328/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/283523929","html_url":"https://github.com/apache/druid/pull/3991#issuecomment-283523929","issue_url":"https://api.github.com/repos/apache/druid/issues/3991","id":283523929,"node_id":"MDEyOklzc3VlQ29tbWVudDI4MzUyMzkyOQ==","user":{"login":"fjy","id":428325,"node_id":"MDQ6VXNlcjQyODMyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/428325?v=4","gravatar_id":"","url":"https://api.github.com/users/fjy","html_url":"https://github.com/fjy","followers_url":"https://api.github.com/users/fjy/followers","following_url":"https://api.github.com/users/fjy/following{/other_user}","gists_url":"https://api.github.com/users/fjy/gists{/gist_id}","starred_url":"https://api.github.com/users/fjy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fjy/subscriptions","organizations_url":"https://api.github.com/users/fjy/orgs","repos_url":"https://api.github.com/users/fjy/repos","events_url":"https://api.github.com/users/fjy/events{/privacy}","received_events_url":"https://api.github.com/users/fjy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-02T01:08:53Z","updated_at":"2017-03-02T01:08:53Z","author_association":"CONTRIBUTOR","body":"ðŸ‘ ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/283523929/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/283523966","html_url":"https://github.com/apache/druid/pull/3989#issuecomment-283523966","issue_url":"https://api.github.com/repos/apache/druid/issues/3989","id":283523966,"node_id":"MDEyOklzc3VlQ29tbWVudDI4MzUyMzk2Ng==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-02T01:09:06Z","updated_at":"2017-03-02T01:09:06Z","author_association":"CONTRIBUTOR","body":"Reverted in e63eefd7ff51f5b319aa940b111c7cec1a289d27 and reopened in #3991","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/283523966/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/283527659","html_url":"https://github.com/apache/druid/issues/3944#issuecomment-283527659","issue_url":"https://api.github.com/repos/apache/druid/issues/3944","id":283527659,"node_id":"MDEyOklzc3VlQ29tbWVudDI4MzUyNzY1OQ==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-02T01:30:09Z","updated_at":"2017-03-02T01:30:09Z","author_association":"CONTRIBUTOR","body":"@nishantmonu51 could you please write something up for \"Improved Kerberos support\"?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/283527659/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/283542075","html_url":"https://github.com/apache/druid/pull/3990#issuecomment-283542075","issue_url":"https://api.github.com/repos/apache/druid/issues/3990","id":283542075,"node_id":"MDEyOklzc3VlQ29tbWVudDI4MzU0MjA3NQ==","user":{"login":"drcrallen","id":8213081,"node_id":"MDQ6VXNlcjgyMTMwODE=","avatar_url":"https://avatars.githubusercontent.com/u/8213081?v=4","gravatar_id":"","url":"https://api.github.com/users/drcrallen","html_url":"https://github.com/drcrallen","followers_url":"https://api.github.com/users/drcrallen/followers","following_url":"https://api.github.com/users/drcrallen/following{/other_user}","gists_url":"https://api.github.com/users/drcrallen/gists{/gist_id}","starred_url":"https://api.github.com/users/drcrallen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/drcrallen/subscriptions","organizations_url":"https://api.github.com/users/drcrallen/orgs","repos_url":"https://api.github.com/users/drcrallen/repos","events_url":"https://api.github.com/users/drcrallen/events{/privacy}","received_events_url":"https://api.github.com/users/drcrallen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-02T03:01:15Z","updated_at":"2017-03-02T03:01:15Z","author_association":"CONTRIBUTOR","body":"This changes a few `ISE` to `IOException` but that's probably more correct.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/283542075/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/283636148","html_url":"https://github.com/apache/druid/issues/3944#issuecomment-283636148","issue_url":"https://api.github.com/repos/apache/druid/issues/3944","id":283636148,"node_id":"MDEyOklzc3VlQ29tbWVudDI4MzYzNjE0OA==","user":{"login":"nishantmonu51","id":5023786,"node_id":"MDQ6VXNlcjUwMjM3ODY=","avatar_url":"https://avatars.githubusercontent.com/u/5023786?v=4","gravatar_id":"","url":"https://api.github.com/users/nishantmonu51","html_url":"https://github.com/nishantmonu51","followers_url":"https://api.github.com/users/nishantmonu51/followers","following_url":"https://api.github.com/users/nishantmonu51/following{/other_user}","gists_url":"https://api.github.com/users/nishantmonu51/gists{/gist_id}","starred_url":"https://api.github.com/users/nishantmonu51/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nishantmonu51/subscriptions","organizations_url":"https://api.github.com/users/nishantmonu51/orgs","repos_url":"https://api.github.com/users/nishantmonu51/repos","events_url":"https://api.github.com/users/nishantmonu51/events{/privacy}","received_events_url":"https://api.github.com/users/nishantmonu51/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-02T12:05:20Z","updated_at":"2017-03-02T12:05:20Z","author_association":"MEMBER","body":"@gianm, Updated the initial comment with kerberos authentication. ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/283636148/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/283698843","html_url":"https://github.com/apache/druid/issues/3944#issuecomment-283698843","issue_url":"https://api.github.com/repos/apache/druid/issues/3944","id":283698843,"node_id":"MDEyOklzc3VlQ29tbWVudDI4MzY5ODg0Mw==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-02T16:15:20Z","updated_at":"2017-03-02T16:15:20Z","author_association":"CONTRIBUTOR","body":"Thanks @nishantmonu51 ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/283698843/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/283745799","html_url":"https://github.com/apache/druid/pull/3981#issuecomment-283745799","issue_url":"https://api.github.com/repos/apache/druid/issues/3981","id":283745799,"node_id":"MDEyOklzc3VlQ29tbWVudDI4Mzc0NTc5OQ==","user":{"login":"kaijianding","id":8663725,"node_id":"MDQ6VXNlcjg2NjM3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/8663725?v=4","gravatar_id":"","url":"https://api.github.com/users/kaijianding","html_url":"https://github.com/kaijianding","followers_url":"https://api.github.com/users/kaijianding/followers","following_url":"https://api.github.com/users/kaijianding/following{/other_user}","gists_url":"https://api.github.com/users/kaijianding/gists{/gist_id}","starred_url":"https://api.github.com/users/kaijianding/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaijianding/subscriptions","organizations_url":"https://api.github.com/users/kaijianding/orgs","repos_url":"https://api.github.com/users/kaijianding/repos","events_url":"https://api.github.com/users/kaijianding/events{/privacy}","received_events_url":"https://api.github.com/users/kaijianding/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-02T18:59:09Z","updated_at":"2017-03-02T18:59:09Z","author_association":"CONTRIBUTOR","body":"ut added, @gianm ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/283745799/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/283812684","html_url":"https://github.com/apache/druid/pull/3993#issuecomment-283812684","issue_url":"https://api.github.com/repos/apache/druid/issues/3993","id":283812684,"node_id":"MDEyOklzc3VlQ29tbWVudDI4MzgxMjY4NA==","user":{"login":"fjy","id":428325,"node_id":"MDQ6VXNlcjQyODMyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/428325?v=4","gravatar_id":"","url":"https://api.github.com/users/fjy","html_url":"https://github.com/fjy","followers_url":"https://api.github.com/users/fjy/followers","following_url":"https://api.github.com/users/fjy/following{/other_user}","gists_url":"https://api.github.com/users/fjy/gists{/gist_id}","starred_url":"https://api.github.com/users/fjy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fjy/subscriptions","organizations_url":"https://api.github.com/users/fjy/orgs","repos_url":"https://api.github.com/users/fjy/repos","events_url":"https://api.github.com/users/fjy/events{/privacy}","received_events_url":"https://api.github.com/users/fjy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-02T23:09:53Z","updated_at":"2017-03-02T23:09:53Z","author_association":"CONTRIBUTOR","body":"ðŸ‘ ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/283812684/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/283813118","html_url":"https://github.com/apache/druid/pull/3993#issuecomment-283813118","issue_url":"https://api.github.com/repos/apache/druid/issues/3993","id":283813118,"node_id":"MDEyOklzc3VlQ29tbWVudDI4MzgxMzExOA==","user":{"login":"jon-wei","id":8729063,"node_id":"MDQ6VXNlcjg3MjkwNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8729063?v=4","gravatar_id":"","url":"https://api.github.com/users/jon-wei","html_url":"https://github.com/jon-wei","followers_url":"https://api.github.com/users/jon-wei/followers","following_url":"https://api.github.com/users/jon-wei/following{/other_user}","gists_url":"https://api.github.com/users/jon-wei/gists{/gist_id}","starred_url":"https://api.github.com/users/jon-wei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jon-wei/subscriptions","organizations_url":"https://api.github.com/users/jon-wei/orgs","repos_url":"https://api.github.com/users/jon-wei/repos","events_url":"https://api.github.com/users/jon-wei/events{/privacy}","received_events_url":"https://api.github.com/users/jon-wei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-02T23:11:58Z","updated_at":"2017-03-02T23:11:58Z","author_association":"CONTRIBUTOR","body":":+1:","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/283813118/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/283813410","html_url":"https://github.com/apache/druid/pull/3993#issuecomment-283813410","issue_url":"https://api.github.com/repos/apache/druid/issues/3993","id":283813410,"node_id":"MDEyOklzc3VlQ29tbWVudDI4MzgxMzQxMA==","user":{"login":"jon-wei","id":8729063,"node_id":"MDQ6VXNlcjg3MjkwNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8729063?v=4","gravatar_id":"","url":"https://api.github.com/users/jon-wei","html_url":"https://github.com/jon-wei","followers_url":"https://api.github.com/users/jon-wei/followers","following_url":"https://api.github.com/users/jon-wei/following{/other_user}","gists_url":"https://api.github.com/users/jon-wei/gists{/gist_id}","starred_url":"https://api.github.com/users/jon-wei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jon-wei/subscriptions","organizations_url":"https://api.github.com/users/jon-wei/orgs","repos_url":"https://api.github.com/users/jon-wei/repos","events_url":"https://api.github.com/users/jon-wei/events{/privacy}","received_events_url":"https://api.github.com/users/jon-wei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-02T23:13:28Z","updated_at":"2017-03-02T23:13:28Z","author_association":"CONTRIBUTOR","body":"skipping travis since these are only doc changes","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/283813410/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/283814803","html_url":"https://github.com/apache/druid/pull/3928#issuecomment-283814803","issue_url":"https://api.github.com/repos/apache/druid/issues/3928","id":283814803,"node_id":"MDEyOklzc3VlQ29tbWVudDI4MzgxNDgwMw==","user":{"login":"jon-wei","id":8729063,"node_id":"MDQ6VXNlcjg3MjkwNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8729063?v=4","gravatar_id":"","url":"https://api.github.com/users/jon-wei","html_url":"https://github.com/jon-wei","followers_url":"https://api.github.com/users/jon-wei/followers","following_url":"https://api.github.com/users/jon-wei/following{/other_user}","gists_url":"https://api.github.com/users/jon-wei/gists{/gist_id}","starred_url":"https://api.github.com/users/jon-wei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jon-wei/subscriptions","organizations_url":"https://api.github.com/users/jon-wei/orgs","repos_url":"https://api.github.com/users/jon-wei/repos","events_url":"https://api.github.com/users/jon-wei/events{/privacy}","received_events_url":"https://api.github.com/users/jon-wei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-02T23:20:16Z","updated_at":"2017-03-02T23:20:16Z","author_association":"CONTRIBUTOR","body":"I'm okay with this PR going with the shared extractionFn for now, I'll review again after splitting out the filter","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/283814803/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/283816240","html_url":"https://github.com/apache/druid/pull/3995#issuecomment-283816240","issue_url":"https://api.github.com/repos/apache/druid/issues/3995","id":283816240,"node_id":"MDEyOklzc3VlQ29tbWVudDI4MzgxNjI0MA==","user":{"login":"fjy","id":428325,"node_id":"MDQ6VXNlcjQyODMyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/428325?v=4","gravatar_id":"","url":"https://api.github.com/users/fjy","html_url":"https://github.com/fjy","followers_url":"https://api.github.com/users/fjy/followers","following_url":"https://api.github.com/users/fjy/following{/other_user}","gists_url":"https://api.github.com/users/fjy/gists{/gist_id}","starred_url":"https://api.github.com/users/fjy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fjy/subscriptions","organizations_url":"https://api.github.com/users/fjy/orgs","repos_url":"https://api.github.com/users/fjy/repos","events_url":"https://api.github.com/users/fjy/events{/privacy}","received_events_url":"https://api.github.com/users/fjy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-02T23:27:23Z","updated_at":"2017-03-02T23:27:23Z","author_association":"CONTRIBUTOR","body":"ðŸ‘ ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/283816240/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/283818272","html_url":"https://github.com/apache/druid/issues/3892#issuecomment-283818272","issue_url":"https://api.github.com/repos/apache/druid/issues/3892","id":283818272,"node_id":"MDEyOklzc3VlQ29tbWVudDI4MzgxODI3Mg==","user":{"login":"leerho","id":12941506,"node_id":"MDQ6VXNlcjEyOTQxNTA2","avatar_url":"https://avatars.githubusercontent.com/u/12941506?v=4","gravatar_id":"","url":"https://api.github.com/users/leerho","html_url":"https://github.com/leerho","followers_url":"https://api.github.com/users/leerho/followers","following_url":"https://api.github.com/users/leerho/following{/other_user}","gists_url":"https://api.github.com/users/leerho/gists{/gist_id}","starred_url":"https://api.github.com/users/leerho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leerho/subscriptions","organizations_url":"https://api.github.com/users/leerho/orgs","repos_url":"https://api.github.com/users/leerho/repos","events_url":"https://api.github.com/users/leerho/events{/privacy}","received_events_url":"https://api.github.com/users/leerho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-02T23:38:03Z","updated_at":"2017-03-02T23:38:03Z","author_association":"CONTRIBUTOR","body":"@leventov \r\n\r\nI have a a design issue perhaps you could comment on:\r\n\r\nA `ByteBuffer` has an internal ReadOnly / Writable state (as does a file).  Because we now have only one implementation, `WritableMemoryImpl`, the internal helper class `AccessByteBuffer` must return a `WritableMemoryImpl`. Similarly, the `AccessDirectMap` also returns a `WritableMemoryImpl`.\r\n\r\nClose():\r\n\r\nI do not provide close() in `Memory`, it is only available in `WritableMemory`.  I don't want downstream read-only users to inadvertently close the original BB or Map object.\r\n\r\nThis means that I can't provide in `Memory` a `public static Memory wrap(ByteBuffer)` or a `public static Memory map(file ...)` because ultimately these objects need to be closed so that the atomic valid flag is set to false and propagates to any child regions.\r\n\r\nSo the only way to create a RO `Memory` instance of a BB (or map) is via `asReadOnly()` from a `WritableMemory` instance. This also means that I cannot throw an error during construction if the user attempts to create a `WritableMemory` of a RO BB or Map.\r\n\r\nAnd, the only way during runtime to detect a write against a `WritableMemory` instance of a RO BB is when asserts are enabled. Can we live with this?\r\n\r\nMaps are safer in that if the file is RO, the OS will throw an error on an attempted write.\r\n\r\nAny better ideas?\r\n\r\n\r\n\r\n\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/283818272/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/283821420","html_url":"https://github.com/apache/druid/issues/3892#issuecomment-283821420","issue_url":"https://api.github.com/repos/apache/druid/issues/3892","id":283821420,"node_id":"MDEyOklzc3VlQ29tbWVudDI4MzgyMTQyMA==","user":{"login":"leventov","id":609240,"node_id":"MDQ6VXNlcjYwOTI0MA==","avatar_url":"https://avatars.githubusercontent.com/u/609240?v=4","gravatar_id":"","url":"https://api.github.com/users/leventov","html_url":"https://github.com/leventov","followers_url":"https://api.github.com/users/leventov/followers","following_url":"https://api.github.com/users/leventov/following{/other_user}","gists_url":"https://api.github.com/users/leventov/gists{/gist_id}","starred_url":"https://api.github.com/users/leventov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leventov/subscriptions","organizations_url":"https://api.github.com/users/leventov/orgs","repos_url":"https://api.github.com/users/leventov/repos","events_url":"https://api.github.com/users/leventov/events{/privacy}","received_events_url":"https://api.github.com/users/leventov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-02T23:54:57Z","updated_at":"2017-03-02T23:55:32Z","author_association":"MEMBER","body":"@leerho \r\n\r\n`Memory` should also be closeable, because it's needed for a common pattern:\r\n```java\r\ntry (Memory mem = Memory.map(file)) {\r\n  .. read something from file\r\n}\r\n```\r\n\r\nI didn't understand it clearly but probably the rest of the problem will go away also.\r\n\r\nDownstream read-only users can inadvertently close Memory: I agree it's not great, but currently I think it's a required trade-off (maybe my mind will change when we do actual Druid code migration and see how it works). As I noted here: https://github.com/druid-io/druid/issues/3892#issuecomment-280742485, `Memory.close()` should be rarely used. Maybe we can apply policy that any `Memory` object is closed only in the case class as where it's created, if a class accepts `Memory` as a parameter (downstream user), it must not close it.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/283821420/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/283826137","html_url":"https://github.com/apache/druid/pull/3995#issuecomment-283826137","issue_url":"https://api.github.com/repos/apache/druid/issues/3995","id":283826137,"node_id":"MDEyOklzc3VlQ29tbWVudDI4MzgyNjEzNw==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-03T00:21:01Z","updated_at":"2017-03-03T00:21:01Z","author_association":"CONTRIBUTOR","body":"thanks @jon-wei !","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/283826137/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/283834618","html_url":"https://github.com/apache/druid/issues/3892#issuecomment-283834618","issue_url":"https://api.github.com/repos/apache/druid/issues/3892","id":283834618,"node_id":"MDEyOklzc3VlQ29tbWVudDI4MzgzNDYxOA==","user":{"login":"leerho","id":12941506,"node_id":"MDQ6VXNlcjEyOTQxNTA2","avatar_url":"https://avatars.githubusercontent.com/u/12941506?v=4","gravatar_id":"","url":"https://api.github.com/users/leerho","html_url":"https://github.com/leerho","followers_url":"https://api.github.com/users/leerho/followers","following_url":"https://api.github.com/users/leerho/following{/other_user}","gists_url":"https://api.github.com/users/leerho/gists{/gist_id}","starred_url":"https://api.github.com/users/leerho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leerho/subscriptions","organizations_url":"https://api.github.com/users/leerho/orgs","repos_url":"https://api.github.com/users/leerho/repos","events_url":"https://api.github.com/users/leerho/events{/privacy}","received_events_url":"https://api.github.com/users/leerho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-03T01:10:02Z","updated_at":"2017-03-03T01:10:02Z","author_association":"CONTRIBUTOR","body":"@leventov \r\n\r\nThe pattern I am worried about is:\r\n\r\n```\r\nWritableMemory wmem = WritableMemory.writableWrap(ByteBuffer writableBB);\r\nMemory mem = wmem.asReadOnly();\r\n\r\n// pass mem as an argument to 1000 different downstream clients that need read access ...\r\n// ...if any one of them accidentally calls close() you are hosed! \r\n\r\nwmem.close(); //The owner of the original object should be the only one closing it.\r\n```\r\nI don't understand what your \"tradeoff\" concern is.  Since we only have one way to instantiate a BB we could make it less verbose: `WritableMemory wmem = WritableMemory.wrap(BB)`.   Or perhaps we could make the name more concise: `WriteMemory` or `Wmemory`.  So we would have:\r\n\r\n```\r\nWMemory wmem = WMemory.wrap(ByteBuffer writableBB);\r\nMemory mem = wmem.asReadOnly();\r\n```\r\n\r\nI would recommend that we start with not allowing Memory.close().  Memory.close may be rare in Druid, but I am worried about other environments including Yahoo!\r\n \r\n\r\n\r\n\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/283834618/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/283835053","html_url":"https://github.com/apache/druid/issues/3994#issuecomment-283835053","issue_url":"https://api.github.com/repos/apache/druid/issues/3994","id":283835053,"node_id":"MDEyOklzc3VlQ29tbWVudDI4MzgzNTA1Mw==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-03T01:12:44Z","updated_at":"2017-03-03T01:12:44Z","author_association":"CONTRIBUTOR","body":"@praveev, are you working on a patch for this?\r\n\r\nIt also looks like we don't have many tests for DurationGranularity -- just a serde test, no query tests. It'd be good to add some usages of DurationGranularity to the query tests, like GroupByQueryRunnerTest et al.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/283835053/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/283835324","html_url":"https://github.com/apache/druid/issues/3994#issuecomment-283835324","issue_url":"https://api.github.com/repos/apache/druid/issues/3994","id":283835324,"node_id":"MDEyOklzc3VlQ29tbWVudDI4MzgzNTMyNA==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-03T01:14:19Z","updated_at":"2017-03-03T01:15:14Z","author_association":"CONTRIBUTOR","body":"As well as tests for its basic methods like increment, toDateTime, and so on.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/283835324/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/283837795","html_url":"https://github.com/apache/druid/issues/3994#issuecomment-283837795","issue_url":"https://api.github.com/repos/apache/druid/issues/3994","id":283837795,"node_id":"MDEyOklzc3VlQ29tbWVudDI4MzgzNzc5NQ==","user":{"login":"praveev","id":297278,"node_id":"MDQ6VXNlcjI5NzI3OA==","avatar_url":"https://avatars.githubusercontent.com/u/297278?v=4","gravatar_id":"","url":"https://api.github.com/users/praveev","html_url":"https://github.com/praveev","followers_url":"https://api.github.com/users/praveev/followers","following_url":"https://api.github.com/users/praveev/following{/other_user}","gists_url":"https://api.github.com/users/praveev/gists{/gist_id}","starred_url":"https://api.github.com/users/praveev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/praveev/subscriptions","organizations_url":"https://api.github.com/users/praveev/orgs","repos_url":"https://api.github.com/users/praveev/repos","events_url":"https://api.github.com/users/praveev/events{/privacy}","received_events_url":"https://api.github.com/users/praveev/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-03T01:28:57Z","updated_at":"2017-03-03T01:30:20Z","author_association":"CONTRIBUTOR","body":"yup. we're deploying other stuff as well. so i want to see if there are any other issues, i should have a patch tomorrow. so far this is the only one we've seen.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/283837795/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/283838095","html_url":"https://github.com/apache/druid/issues/3994#issuecomment-283838095","issue_url":"https://api.github.com/repos/apache/druid/issues/3994","id":283838095,"node_id":"MDEyOklzc3VlQ29tbWVudDI4MzgzODA5NQ==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-03T01:30:49Z","updated_at":"2017-03-03T01:30:49Z","author_association":"CONTRIBUTOR","body":"great!","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/283838095/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/283838626","html_url":"https://github.com/apache/druid/issues/3892#issuecomment-283838626","issue_url":"https://api.github.com/repos/apache/druid/issues/3892","id":283838626,"node_id":"MDEyOklzc3VlQ29tbWVudDI4MzgzODYyNg==","user":{"login":"leventov","id":609240,"node_id":"MDQ6VXNlcjYwOTI0MA==","avatar_url":"https://avatars.githubusercontent.com/u/609240?v=4","gravatar_id":"","url":"https://api.github.com/users/leventov","html_url":"https://github.com/leventov","followers_url":"https://api.github.com/users/leventov/followers","following_url":"https://api.github.com/users/leventov/following{/other_user}","gists_url":"https://api.github.com/users/leventov/gists{/gist_id}","starred_url":"https://api.github.com/users/leventov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leventov/subscriptions","organizations_url":"https://api.github.com/users/leventov/orgs","repos_url":"https://api.github.com/users/leventov/repos","events_url":"https://api.github.com/users/leventov/events{/privacy}","received_events_url":"https://api.github.com/users/leventov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-03T01:33:59Z","updated_at":"2017-03-03T01:33:59Z","author_association":"MEMBER","body":"Ok, let's try something like `MemoryHandle extends AutoCloseable`, with `Memory get()` method.  `Memory.map()` and `allocateDirect` return `MemoryHandle`, other static factory methods return just `Memory`. And `Memory` with `WritableMemory` are _not_ AutoCloseable.\r\n\r\nThen the pattern above is\r\n```java\r\ntry (MemoryHandle mh = Memory.map(file)) {\r\n  Memory mem = mh.get();\r\n  .. read from file\r\n}\r\n```\r\n\r\n> Memory mem = wmem.asReadOnly();\r\n\r\nShouldn't need `asReadOnly()`, just upcast: `Memory mem = wmem;`. And actually this line not needed, just pass `wmem` to methods that accept `Memory`.\r\n\r\n> WriteMemory, Wmemory\r\n\r\nI like natural English `WritableMemory` most","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/283838626/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/283845243","html_url":"https://github.com/apache/druid/issues/3892#issuecomment-283845243","issue_url":"https://api.github.com/repos/apache/druid/issues/3892","id":283845243,"node_id":"MDEyOklzc3VlQ29tbWVudDI4Mzg0NTI0Mw==","user":{"login":"leerho","id":12941506,"node_id":"MDQ6VXNlcjEyOTQxNTA2","avatar_url":"https://avatars.githubusercontent.com/u/12941506?v=4","gravatar_id":"","url":"https://api.github.com/users/leerho","html_url":"https://github.com/leerho","followers_url":"https://api.github.com/users/leerho/followers","following_url":"https://api.github.com/users/leerho/following{/other_user}","gists_url":"https://api.github.com/users/leerho/gists{/gist_id}","starred_url":"https://api.github.com/users/leerho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leerho/subscriptions","organizations_url":"https://api.github.com/users/leerho/orgs","repos_url":"https://api.github.com/users/leerho/repos","events_url":"https://api.github.com/users/leerho/events{/privacy}","received_events_url":"https://api.github.com/users/leerho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-03T02:14:48Z","updated_at":"2017-03-03T02:14:48Z","author_association":"CONTRIBUTOR","body":"@leventov \r\n\r\nDoes your MemoryHandle  apply to BB?  Could you give me a skeleton of what MH extends and includes?\r\n\r\n\r\nI need the asReadOnly to set the readOnly flag, which an upcast will not do.  The RO flag is the only backup to detect a improper cast of (WritableMemory) memory.  \r\n\r\n\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/283845243/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/283848935","html_url":"https://github.com/apache/druid/issues/3892#issuecomment-283848935","issue_url":"https://api.github.com/repos/apache/druid/issues/3892","id":283848935,"node_id":"MDEyOklzc3VlQ29tbWVudDI4Mzg0ODkzNQ==","user":{"login":"leventov","id":609240,"node_id":"MDQ6VXNlcjYwOTI0MA==","avatar_url":"https://avatars.githubusercontent.com/u/609240?v=4","gravatar_id":"","url":"https://api.github.com/users/leventov","html_url":"https://github.com/leventov","followers_url":"https://api.github.com/users/leventov/followers","following_url":"https://api.github.com/users/leventov/following{/other_user}","gists_url":"https://api.github.com/users/leventov/gists{/gist_id}","starred_url":"https://api.github.com/users/leventov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leventov/subscriptions","organizations_url":"https://api.github.com/users/leventov/orgs","repos_url":"https://api.github.com/users/leventov/repos","events_url":"https://api.github.com/users/leventov/events{/privacy}","received_events_url":"https://api.github.com/users/leventov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-03T02:39:38Z","updated_at":"2017-03-03T02:40:33Z","author_association":"MEMBER","body":"> Does your MemoryHandle apply to BB?\r\n\r\nIf you mean \"should `Memory.wrap(BB)` return MemoryHandle\" I think no, because somebody who allocated BB should care about closing it.\r\n\r\n`MemoryHandle` should be similar to [`MappedByteBufferHandler`](https://github.com/druid-io/druid/blob/657e4512d2a6499a9d0609b2cc32d134e9507e3a/java-util/src/main/java/io/druid/java/util/common/MappedByteBufferHandler.java). Since Memory still want to be able to catch use-after-free, `Cleaner` should still be private to `Memory` (`WritableMemoryImpl`). The only difference is that `Memory.close()` made package-private, and only `MemoryHandleImpl` can access it. (`MemoryHandle` itself is an interface)\r\n\r\n> I need the asReadOnly to set the readOnly flag, which an upcast will not do. The RO flag is the only backup to detect a improper cast of (WritableMemory) memory.\r\n\r\nYou shouldn't be able to obtain `WritableMemory` which is not actually writable, in the first place :)\r\nIf `asReadOnly()` just makes a check and returns `this`, it's ok","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/283848935/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/283855705","html_url":"https://github.com/apache/druid/issues/3892#issuecomment-283855705","issue_url":"https://api.github.com/repos/apache/druid/issues/3892","id":283855705,"node_id":"MDEyOklzc3VlQ29tbWVudDI4Mzg1NTcwNQ==","user":{"login":"leerho","id":12941506,"node_id":"MDQ6VXNlcjEyOTQxNTA2","avatar_url":"https://avatars.githubusercontent.com/u/12941506?v=4","gravatar_id":"","url":"https://api.github.com/users/leerho","html_url":"https://github.com/leerho","followers_url":"https://api.github.com/users/leerho/followers","following_url":"https://api.github.com/users/leerho/following{/other_user}","gists_url":"https://api.github.com/users/leerho/gists{/gist_id}","starred_url":"https://api.github.com/users/leerho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leerho/subscriptions","organizations_url":"https://api.github.com/users/leerho/orgs","repos_url":"https://api.github.com/users/leerho/repos","events_url":"https://api.github.com/users/leerho/events{/privacy}","received_events_url":"https://api.github.com/users/leerho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-03T03:30:26Z","updated_at":"2017-03-03T03:30:26Z","author_association":"CONTRIBUTOR","body":"@leventov \r\n\r\nSomething like:\r\n\r\n```\r\npublic final class MemoryHandler implements AutoCloseable {\r\n  private final WritableMemory wmem;\r\n\r\n  MemoryHandler( WritableMemoryImpl wmem) {\r\n    this.wmem = wmem;\r\n  }\r\n\r\n  public Memory get() { return wmem.asReadOnly(); } //sets the RO flag\r\n  public WritableMemory getWritable() { return wmem; }\r\n  \r\n  //calls the package private close() method of wmem\r\n  public void close() { wmem.close(); }\r\n}\r\n```\r\n`AccessByteBuffer`, `AllocateDirectMap` and `AllocateDirect` all extend `WritableMemoryImpl` and return MH.  So do all the static methods that create heap array backed `Memory` or `WritableMemory`. \r\n\r\nNow the only way to close the retained `WritableMemoryImpl` is through MH and there can be only one owner of an MH.  This also means MH is the only class that the compiler detects that requires a close() or should be implemented with try-with-resource.\r\n\r\nThe rest of the hierarchy is the same.  \r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/283855705/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/283864490","html_url":"https://github.com/apache/druid/issues/3996#issuecomment-283864490","issue_url":"https://api.github.com/repos/apache/druid/issues/3996","id":283864490,"node_id":"MDEyOklzc3VlQ29tbWVudDI4Mzg2NDQ5MA==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-03T04:46:37Z","updated_at":"2017-03-03T04:46:37Z","author_association":"CONTRIBUTOR","body":"@mjaow, what's the reason that you're posting a large amount of data to the lookup config endpoint? It's not really meant to store a lot of data; it does support in-line lookups but that's meant for small ones. If you have a big lookup file it would work better to put it on s3 or http and reference that file from your lookup definition.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/283864490/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/283951681","html_url":"https://github.com/apache/druid/issues/3944#issuecomment-283951681","issue_url":"https://api.github.com/repos/apache/druid/issues/3944","id":283951681,"node_id":"MDEyOklzc3VlQ29tbWVudDI4Mzk1MTY4MQ==","user":{"login":"yaochitc","id":2282372,"node_id":"MDQ6VXNlcjIyODIzNzI=","avatar_url":"https://avatars.githubusercontent.com/u/2282372?v=4","gravatar_id":"","url":"https://api.github.com/users/yaochitc","html_url":"https://github.com/yaochitc","followers_url":"https://api.github.com/users/yaochitc/followers","following_url":"https://api.github.com/users/yaochitc/following{/other_user}","gists_url":"https://api.github.com/users/yaochitc/gists{/gist_id}","starred_url":"https://api.github.com/users/yaochitc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yaochitc/subscriptions","organizations_url":"https://api.github.com/users/yaochitc/orgs","repos_url":"https://api.github.com/users/yaochitc/repos","events_url":"https://api.github.com/users/yaochitc/events{/privacy}","received_events_url":"https://api.github.com/users/yaochitc/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-03T13:24:32Z","updated_at":"2017-03-03T13:24:32Z","author_association":"NONE","body":"lgtm","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/283951681/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/283994551","html_url":"https://github.com/apache/druid/issues/2262#issuecomment-283994551","issue_url":"https://api.github.com/repos/apache/druid/issues/2262","id":283994551,"node_id":"MDEyOklzc3VlQ29tbWVudDI4Mzk5NDU1MQ==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-03T16:07:02Z","updated_at":"2017-03-03T16:07:02Z","author_association":"CONTRIBUTOR","body":"@himanshug do you know if this is still an issue? We ran into a similar issue with groupBy v2 and I'm wondering if IntervalChunkingQueryRunner is just generally broken. It chunks up the query and then concats the returned sequences without putting them through a merger, which seems like a bad ideaâ€¦","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/283994551/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284011243","html_url":"https://github.com/apache/druid/issues/3997#issuecomment-284011243","issue_url":"https://api.github.com/repos/apache/druid/issues/3997","id":284011243,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDAxMTI0Mw==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-03T17:06:29Z","updated_at":"2017-03-03T17:06:29Z","author_association":"CONTRIBUTOR","body":"Thanks @akashdw for the report, I added this to 0.10.0.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284011243/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284011896","html_url":"https://github.com/apache/druid/pull/3992#issuecomment-284011896","issue_url":"https://api.github.com/repos/apache/druid/issues/3992","id":284011896,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDAxMTg5Ng==","user":{"login":"himanshug","id":246308,"node_id":"MDQ6VXNlcjI0NjMwOA==","avatar_url":"https://avatars.githubusercontent.com/u/246308?v=4","gravatar_id":"","url":"https://api.github.com/users/himanshug","html_url":"https://github.com/himanshug","followers_url":"https://api.github.com/users/himanshug/followers","following_url":"https://api.github.com/users/himanshug/following{/other_user}","gists_url":"https://api.github.com/users/himanshug/gists{/gist_id}","starred_url":"https://api.github.com/users/himanshug/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/himanshug/subscriptions","organizations_url":"https://api.github.com/users/himanshug/orgs","repos_url":"https://api.github.com/users/himanshug/repos","events_url":"https://api.github.com/users/himanshug/events{/privacy}","received_events_url":"https://api.github.com/users/himanshug/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-03T17:09:06Z","updated_at":"2017-03-03T17:09:06Z","author_association":"CONTRIBUTOR","body":"@gianm updated doc and fixed formatting","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284011896/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284012511","html_url":"https://github.com/apache/druid/pull/3981#issuecomment-284012511","issue_url":"https://api.github.com/repos/apache/druid/issues/3981","id":284012511,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDAxMjUxMQ==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-03T17:11:26Z","updated_at":"2017-03-03T17:11:26Z","author_association":"CONTRIBUTOR","body":"still ðŸ‘  after latest changes. thanks for identifying and removing the unneeded code.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284012511/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284024173","html_url":"https://github.com/apache/druid/pull/3999#issuecomment-284024173","issue_url":"https://api.github.com/repos/apache/druid/issues/3999","id":284024173,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDAyNDE3Mw==","user":{"login":"fjy","id":428325,"node_id":"MDQ6VXNlcjQyODMyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/428325?v=4","gravatar_id":"","url":"https://api.github.com/users/fjy","html_url":"https://github.com/fjy","followers_url":"https://api.github.com/users/fjy/followers","following_url":"https://api.github.com/users/fjy/following{/other_user}","gists_url":"https://api.github.com/users/fjy/gists{/gist_id}","starred_url":"https://api.github.com/users/fjy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fjy/subscriptions","organizations_url":"https://api.github.com/users/fjy/orgs","repos_url":"https://api.github.com/users/fjy/repos","events_url":"https://api.github.com/users/fjy/events{/privacy}","received_events_url":"https://api.github.com/users/fjy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-03T17:56:12Z","updated_at":"2017-03-03T17:56:12Z","author_association":"CONTRIBUTOR","body":"ðŸ‘ ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284024173/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284027762","html_url":"https://github.com/apache/druid/pull/3999#issuecomment-284027762","issue_url":"https://api.github.com/repos/apache/druid/issues/3999","id":284027762,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDAyNzc2Mg==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-03T18:10:10Z","updated_at":"2017-03-03T18:10:10Z","author_association":"CONTRIBUTOR","body":"I'm going to make one tweak to the wording, please don't merge just yet","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284027762/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284028415","html_url":"https://github.com/apache/druid/pull/3999#issuecomment-284028415","issue_url":"https://api.github.com/repos/apache/druid/issues/3999","id":284028415,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDAyODQxNQ==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-03T18:12:53Z","updated_at":"2017-03-03T18:12:53Z","author_association":"CONTRIBUTOR","body":"Haha, oops. I'll do another PR","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284028415/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284029829","html_url":"https://github.com/apache/druid/pull/4000#issuecomment-284029829","issue_url":"https://api.github.com/repos/apache/druid/issues/4000","id":284029829,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDAyOTgyOQ==","user":{"login":"fjy","id":428325,"node_id":"MDQ6VXNlcjQyODMyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/428325?v=4","gravatar_id":"","url":"https://api.github.com/users/fjy","html_url":"https://github.com/fjy","followers_url":"https://api.github.com/users/fjy/followers","following_url":"https://api.github.com/users/fjy/following{/other_user}","gists_url":"https://api.github.com/users/fjy/gists{/gist_id}","starred_url":"https://api.github.com/users/fjy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fjy/subscriptions","organizations_url":"https://api.github.com/users/fjy/orgs","repos_url":"https://api.github.com/users/fjy/repos","events_url":"https://api.github.com/users/fjy/events{/privacy}","received_events_url":"https://api.github.com/users/fjy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-03T18:18:52Z","updated_at":"2017-03-03T18:18:52Z","author_association":"CONTRIBUTOR","body":"ðŸ‘ ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284029829/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284033283","html_url":"https://github.com/apache/druid/pull/4001#issuecomment-284033283","issue_url":"https://api.github.com/repos/apache/druid/issues/4001","id":284033283,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDAzMzI4Mw==","user":{"login":"himanshug","id":246308,"node_id":"MDQ6VXNlcjI0NjMwOA==","avatar_url":"https://avatars.githubusercontent.com/u/246308?v=4","gravatar_id":"","url":"https://api.github.com/users/himanshug","html_url":"https://github.com/himanshug","followers_url":"https://api.github.com/users/himanshug/followers","following_url":"https://api.github.com/users/himanshug/following{/other_user}","gists_url":"https://api.github.com/users/himanshug/gists{/gist_id}","starred_url":"https://api.github.com/users/himanshug/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/himanshug/subscriptions","organizations_url":"https://api.github.com/users/himanshug/orgs","repos_url":"https://api.github.com/users/himanshug/repos","events_url":"https://api.github.com/users/himanshug/events{/privacy}","received_events_url":"https://api.github.com/users/himanshug/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-03T18:32:49Z","updated_at":"2017-03-03T18:32:49Z","author_association":"CONTRIBUTOR","body":":+1:","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284033283/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284035468","html_url":"https://github.com/apache/druid/pull/4001#issuecomment-284035468","issue_url":"https://api.github.com/repos/apache/druid/issues/4001","id":284035468,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDAzNTQ2OA==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-03T18:41:34Z","updated_at":"2017-03-03T18:42:44Z","author_association":"CONTRIBUTOR","body":"Looks good @praveev. A couple questions,\r\n\r\n- did you test this in a live cluster?\r\n- could you please add a query test to one or more of the query runner tests that uses a DurationGranularity? Like GroupByQueryRunnerTest or equivalents for timeseries, topN. Right now there are no tests that make sure duration granularities work well in the query engines (in the past, there were, since some of the predefined granularities were durations but now they are all periods). This should be doable by copying one of the existing tests that uses hour, day, etc gran and replacing the gran with `new DurationGranularity(86400L, 0L)` or similar","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284035468/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284037793","html_url":"https://github.com/apache/druid/pull/4001#issuecomment-284037793","issue_url":"https://api.github.com/repos/apache/druid/issues/4001","id":284037793,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDAzNzc5Mw==","user":{"login":"praveev","id":297278,"node_id":"MDQ6VXNlcjI5NzI3OA==","avatar_url":"https://avatars.githubusercontent.com/u/297278?v=4","gravatar_id":"","url":"https://api.github.com/users/praveev","html_url":"https://github.com/praveev","followers_url":"https://api.github.com/users/praveev/followers","following_url":"https://api.github.com/users/praveev/following{/other_user}","gists_url":"https://api.github.com/users/praveev/gists{/gist_id}","starred_url":"https://api.github.com/users/praveev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/praveev/subscriptions","organizations_url":"https://api.github.com/users/praveev/orgs","repos_url":"https://api.github.com/users/praveev/repos","events_url":"https://api.github.com/users/praveev/events{/privacy}","received_events_url":"https://api.github.com/users/praveev/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-03T18:50:09Z","updated_at":"2017-03-03T18:50:09Z","author_association":"CONTRIBUTOR","body":"@gianm yup we've tested this fix on live cluster yesterday. i forgot about the GroupByQueryRunnerTest. Added now.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284037793/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284038251","html_url":"https://github.com/apache/druid/issues/2262#issuecomment-284038251","issue_url":"https://api.github.com/repos/apache/druid/issues/2262","id":284038251,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDAzODI1MQ==","user":{"login":"himanshug","id":246308,"node_id":"MDQ6VXNlcjI0NjMwOA==","avatar_url":"https://avatars.githubusercontent.com/u/246308?v=4","gravatar_id":"","url":"https://api.github.com/users/himanshug","html_url":"https://github.com/himanshug","followers_url":"https://api.github.com/users/himanshug/followers","following_url":"https://api.github.com/users/himanshug/following{/other_user}","gists_url":"https://api.github.com/users/himanshug/gists{/gist_id}","starred_url":"https://api.github.com/users/himanshug/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/himanshug/subscriptions","organizations_url":"https://api.github.com/users/himanshug/orgs","repos_url":"https://api.github.com/users/himanshug/repos","events_url":"https://api.github.com/users/himanshug/events{/privacy}","received_events_url":"https://api.github.com/users/himanshug/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-03T18:51:53Z","updated_at":"2017-03-03T18:51:53Z","author_association":"CONTRIBUTOR","body":"@gianm \r\n> if IntervalChunkingQueryRunner is just generally broken. It chunks up the query and then concats the returned sequences without putting them through a merger, which seems like a bad ideaâ€¦\r\n\r\nit does put the results obtained from individual chunks through `toolChest.mergeResults(..)` before concatenation...\r\n\r\npipeline is like.....\r\n```\r\nnew FluentQueryRunnerBuilder<>(toolChest)\r\n        .create(\r\n            new RetryQueryRunner<>(\r\n                baseClient,\r\n                toolChest,\r\n                retryConfig,\r\n                objectMapper\r\n            )\r\n        )\r\n        .applyPreMergeDecoration()  //chunking, merging of individual chunk results and their concatenation happens here\r\n        .mergeResults()\r\n        .applyPostMergeDecoration()\r\n        .emitCPUTimeMetric(emitter)\r\n        .postProcess(postProcessing);\r\n\r\n```\r\n\r\nthere was another issue reported https://groups.google.com/forum/#!topic/druid-user/S8zfWDIrncQ .... i investigated that one in detail and found https://github.com/druid-io/druid/pull/2586 was the cause ... it was fixed in https://github.com/druid-io/druid/pull/2601 ... and the issue reported was acknowledged to be fixed by that patch.\r\n\r\nI can't remember if I really looked much into topN case , however `chunkPeriod` was mostly intended to optimize the groupBy-v1 queries where it served well... we should probably document to use it only with groupBy.\r\n\r\nit should work with groupByV2 ideally, does it not work even for flat groupBy-v2 queries?\r\n\r\nhowever benefits of chunking with sort-merge in v2 might not be same, so may be it is time to retire chunking along with groupBy-V1 .\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284038251/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284045469","html_url":"https://github.com/apache/druid/issues/2262#issuecomment-284045469","issue_url":"https://api.github.com/repos/apache/druid/issues/2262","id":284045469,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDA0NTQ2OQ==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-03T19:19:59Z","updated_at":"2017-03-03T19:19:59Z","author_association":"CONTRIBUTOR","body":"What do you mean by \"flat\" groupBy queries? No subqueries? The query we ran into problems on was non-nested and had granularity \"all\". It did have a union datasource though.\r\n\r\nI was talking about this part of IntervalChunkingQueryRunner:\r\n\r\n```java\r\n    return Sequences.concat(\r\n        Lists.newArrayList(\r\n            FunctionalIterable.create(chunkIntervals).transform(\r\n                new Function<Interval, Sequence<T>>()\r\n                {\r\n                  @Override\r\n                  public Sequence<T> apply(Interval singleInterval)\r\n                  {\r\n                    return new AsyncQueryRunner<T>(\r\n                        //Note: it is assumed that toolChest.mergeResults(..) gives a query runner that is\r\n                        //not lazy i.e. it does most of its work on call to run() method\r\n                        toolChest.mergeResults(\r\n                            new MetricsEmittingQueryRunner<T>(\r\n                                emitter,\r\n                                new Function<Query<T>, ServiceMetricEvent.Builder>()\r\n                                {\r\n                                  @Override\r\n                                  public ServiceMetricEvent.Builder apply(Query<T> input)\r\n                                  {\r\n                                    return toolChest.makeMetricBuilder(input);\r\n                                  }\r\n                                },\r\n                                baseRunner,\r\n                                \"query/intervalChunk/time\",\r\n                                ImmutableMap.of(\"chunkInterval\", singleInterval.toString())\r\n                            ).withWaitMeasuredFromNow()\r\n                        ),\r\n                        executor, queryWatcher\r\n                    ).run(\r\n                        query.withQuerySegmentSpec(new MultipleIntervalSegmentSpec(Arrays.asList(singleInterval))),\r\n                        responseContext\r\n                    );\r\n                  }\r\n                }\r\n            )\r\n        )\r\n    );\r\n```\r\n\r\nEach individual chunk of results is merged with `mergeResults` but then the `Sequences.concat` is applied to the chunks. I was thinking that concat of the chunk results makes it not possible to do a streaming merge later on, which is done by all the query types other than groupBy v1 (it materializes and re-sorts rather than doing a streaming merge).\r\n\r\nI think the current code should work ok for granularity \"all\" in query types like topN and timeseries but might not work for granularity != \"all\". I haven't tested this yet though. Do you know if the topN query that was confirmed fixed by #2601 used granularity \"all\" or not?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284045469/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284046390","html_url":"https://github.com/apache/druid/issues/2262#issuecomment-284046390","issue_url":"https://api.github.com/repos/apache/druid/issues/2262","id":284046390,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDA0NjM5MA==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-03T19:23:40Z","updated_at":"2017-03-03T19:24:13Z","author_association":"CONTRIBUTOR","body":"> I think the current code should work ok for granularity \"all\" in query types like topN and timeseries but might not work for granularity != \"all\".\r\n\r\nFwiw the reason I'm guessing this is because with granularity \"all\", for topN and timeseries, there will only be one result in the end. So concat is fine since they'll all end up getting merged together. With granularity != \"all\" there should be multiple results in the end and the concat could make results that should get merged be non-adjacent when they come from different chunks, and that non-adjacency would mess up streaming merging.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284046390/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284046889","html_url":"https://github.com/apache/druid/issues/2262#issuecomment-284046889","issue_url":"https://api.github.com/repos/apache/druid/issues/2262","id":284046889,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDA0Njg4OQ==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-03T19:25:41Z","updated_at":"2017-03-03T19:25:47Z","author_association":"CONTRIBUTOR","body":"Maybe it would be enough to use `new MergeSequence(query.getResultOrdering(), ...)` rather than `Sequences.concat(...)`.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284046889/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284048534","html_url":"https://github.com/apache/druid/pull/3981#issuecomment-284048534","issue_url":"https://api.github.com/repos/apache/druid/issues/3981","id":284048534,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDA0ODUzNA==","user":{"login":"himanshug","id":246308,"node_id":"MDQ6VXNlcjI0NjMwOA==","avatar_url":"https://avatars.githubusercontent.com/u/246308?v=4","gravatar_id":"","url":"https://api.github.com/users/himanshug","html_url":"https://github.com/himanshug","followers_url":"https://api.github.com/users/himanshug/followers","following_url":"https://api.github.com/users/himanshug/following{/other_user}","gists_url":"https://api.github.com/users/himanshug/gists{/gist_id}","starred_url":"https://api.github.com/users/himanshug/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/himanshug/subscriptions","organizations_url":"https://api.github.com/users/himanshug/orgs","repos_url":"https://api.github.com/users/himanshug/repos","events_url":"https://api.github.com/users/himanshug/events{/privacy}","received_events_url":"https://api.github.com/users/himanshug/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-03T19:32:21Z","updated_at":"2017-03-03T19:32:21Z","author_association":"CONTRIBUTOR","body":"@kaijianding  you removed overriding of isReady(..) as well ... i thought it was good because segment list is automatically figured out so no need to fetch segment list again and match as is done in MergeTaskBase.isReady(..) ?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284048534/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284051431","html_url":"https://github.com/apache/druid/issues/2262#issuecomment-284051431","issue_url":"https://api.github.com/repos/apache/druid/issues/2262","id":284051431,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDA1MTQzMQ==","user":{"login":"himanshug","id":246308,"node_id":"MDQ6VXNlcjI0NjMwOA==","avatar_url":"https://avatars.githubusercontent.com/u/246308?v=4","gravatar_id":"","url":"https://api.github.com/users/himanshug","html_url":"https://github.com/himanshug","followers_url":"https://api.github.com/users/himanshug/followers","following_url":"https://api.github.com/users/himanshug/following{/other_user}","gists_url":"https://api.github.com/users/himanshug/gists{/gist_id}","starred_url":"https://api.github.com/users/himanshug/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/himanshug/subscriptions","organizations_url":"https://api.github.com/users/himanshug/orgs","repos_url":"https://api.github.com/users/himanshug/repos","events_url":"https://api.github.com/users/himanshug/events{/privacy}","received_events_url":"https://api.github.com/users/himanshug/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-03T19:44:10Z","updated_at":"2017-03-03T19:44:10Z","author_association":"CONTRIBUTOR","body":"@gianm good point... yeah, switching to `MergeSequence(..)` would fix it for streaming merge.... when I did it , I was probably too much into groupBy-v1 merging .\r\nwith that change, it should start working for groupBy V2 \r\n\r\nhowever , we should still limit it only to groupBy queries probably ... topN e.g. might still produce different result with/without chunking due to the limit push down on aggregator and approximate nature.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284051431/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284067186","html_url":"https://github.com/apache/druid/issues/3892#issuecomment-284067186","issue_url":"https://api.github.com/repos/apache/druid/issues/3892","id":284067186,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDA2NzE4Ng==","user":{"login":"leventov","id":609240,"node_id":"MDQ6VXNlcjYwOTI0MA==","avatar_url":"https://avatars.githubusercontent.com/u/609240?v=4","gravatar_id":"","url":"https://api.github.com/users/leventov","html_url":"https://github.com/leventov","followers_url":"https://api.github.com/users/leventov/followers","following_url":"https://api.github.com/users/leventov/following{/other_user}","gists_url":"https://api.github.com/users/leventov/gists{/gist_id}","starred_url":"https://api.github.com/users/leventov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leventov/subscriptions","organizations_url":"https://api.github.com/users/leventov/orgs","repos_url":"https://api.github.com/users/leventov/repos","events_url":"https://api.github.com/users/leventov/events{/privacy}","received_events_url":"https://api.github.com/users/leventov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-03T20:53:08Z","updated_at":"2017-03-03T20:53:08Z","author_association":"MEMBER","body":"@leerho \r\n\r\nI forgot that we have Memory and WritableMemory, in this case I would prefer to have two separate interfaces `MemoryHandle` and `WritableMemoryHandle extends MemoryHandle`, both with a single `get()` method, because `getWritable()` allows `Memory.map(file).getWritable()`, that shouldn't be allowed.\r\n\r\n> AccessByteBuffer, AllocateDirectMap and AllocateDirect all extend WritableMemoryImpl\r\n\r\nI don't understand why it is needed to have subclasses with only specialized constructors. It will make difficult to implement `NonNativeWritableMemoryImpl`. I suggest to implement AccessByteBuffer's, AllocateDirectMap's and AllocateDirect's logic in static factory methods, then passing all prepared arguments to `WritableMemoryImpl` or `NonNativeWritableMemoryImpl` constructors.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284067186/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284067549","html_url":"https://github.com/apache/druid/issues/3892#issuecomment-284067549","issue_url":"https://api.github.com/repos/apache/druid/issues/3892","id":284067549,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDA2NzU0OQ==","user":{"login":"leventov","id":609240,"node_id":"MDQ6VXNlcjYwOTI0MA==","avatar_url":"https://avatars.githubusercontent.com/u/609240?v=4","gravatar_id":"","url":"https://api.github.com/users/leventov","html_url":"https://github.com/leventov","followers_url":"https://api.github.com/users/leventov/followers","following_url":"https://api.github.com/users/leventov/following{/other_user}","gists_url":"https://api.github.com/users/leventov/gists{/gist_id}","starred_url":"https://api.github.com/users/leventov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leventov/subscriptions","organizations_url":"https://api.github.com/users/leventov/orgs","repos_url":"https://api.github.com/users/leventov/repos","events_url":"https://api.github.com/users/leventov/events{/privacy}","received_events_url":"https://api.github.com/users/leventov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-03T20:54:53Z","updated_at":"2017-03-03T20:54:53Z","author_association":"MEMBER","body":"Also I want to return to `asReadOnly()`, I don't actually understand what exactly it will check? It should be possible to upcast `WritableMemory` to `Memory`, because during query processing some buffers first act as writable, and then as read-only.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284067549/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284069938","html_url":"https://github.com/apache/druid/pull/4003#issuecomment-284069938","issue_url":"https://api.github.com/repos/apache/druid/issues/4003","id":284069938,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDA2OTkzOA==","user":{"login":"himanshug","id":246308,"node_id":"MDQ6VXNlcjI0NjMwOA==","avatar_url":"https://avatars.githubusercontent.com/u/246308?v=4","gravatar_id":"","url":"https://api.github.com/users/himanshug","html_url":"https://github.com/himanshug","followers_url":"https://api.github.com/users/himanshug/followers","following_url":"https://api.github.com/users/himanshug/following{/other_user}","gists_url":"https://api.github.com/users/himanshug/gists{/gist_id}","starred_url":"https://api.github.com/users/himanshug/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/himanshug/subscriptions","organizations_url":"https://api.github.com/users/himanshug/orgs","repos_url":"https://api.github.com/users/himanshug/repos","events_url":"https://api.github.com/users/himanshug/events{/privacy}","received_events_url":"https://api.github.com/users/himanshug/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-03T21:06:03Z","updated_at":"2017-03-03T21:06:03Z","author_association":"CONTRIBUTOR","body":":+1:","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284069938/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284080980","html_url":"https://github.com/apache/druid/pull/4003#issuecomment-284080980","issue_url":"https://api.github.com/repos/apache/druid/issues/4003","id":284080980,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDA4MDk4MA==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-03T21:56:09Z","updated_at":"2017-03-03T21:56:09Z","author_association":"CONTRIBUTOR","body":"Taking a look now. @akashdw have you tried this on a live cluster to confirm the fix?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284080980/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284081143","html_url":"https://github.com/apache/druid/issues/3892#issuecomment-284081143","issue_url":"https://api.github.com/repos/apache/druid/issues/3892","id":284081143,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDA4MTE0Mw==","user":{"login":"leerho","id":12941506,"node_id":"MDQ6VXNlcjEyOTQxNTA2","avatar_url":"https://avatars.githubusercontent.com/u/12941506?v=4","gravatar_id":"","url":"https://api.github.com/users/leerho","html_url":"https://github.com/leerho","followers_url":"https://api.github.com/users/leerho/followers","following_url":"https://api.github.com/users/leerho/following{/other_user}","gists_url":"https://api.github.com/users/leerho/gists{/gist_id}","starred_url":"https://api.github.com/users/leerho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leerho/subscriptions","organizations_url":"https://api.github.com/users/leerho/orgs","repos_url":"https://api.github.com/users/leerho/repos","events_url":"https://api.github.com/users/leerho/events{/privacy}","received_events_url":"https://api.github.com/users/leerho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-03T21:56:50Z","updated_at":"2017-03-03T21:56:50Z","author_association":"CONTRIBUTOR","body":"@leventov \r\n\r\nWhat is making things tricky is that we only have one implementation, `WritableMemoryImpl`, which allows problematic casts. I am beginning to feel that splitting into two impls would be a lot cleaner, safer, and just not worry about the 30+ duplicated methods.  I have already organized the code in the  `WritableMemoryImpl` class so that all the RO methods are together, so a simple copy & paste should be straightforward.  \r\n\r\nWith two impls, `asReadOnly` creates a new class, and going from a Memory to WritableMemory would never be possible.\r\n\r\n###\r\n**One impl:**\r\nThe readOnly flag is only checked on the write methods with an assert.  So if you cast a Memory object to a WritableMemory the readOnly flag will be true and not change and will throw an assertion error (with -ea).\r\n\r\nAs I explained before, ByteBuffers and Maps have their own internal RO/W state.  And because we have only one writable impl, we can end up with an RO map/BB wrapped by the writable impl.  This creates the need for the readOnly flag and the assert check of W methods.\r\n\r\nIf you do Memory mem = (WritableMemory)writableMem, the readOnly flag remains false (writable). the Memory API prevents writes,  but then this also allows a downstream client to do the reverse cast, since the underlying impl is the same.  I don't see any easy solution to this other than having two impls.\r\n\r\n###\r\nI do like the MemoryHandler idea as it isolates only those objects that actually require `AutoCloseable` from those that do not.   \r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284081143/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284082722","html_url":"https://github.com/apache/druid/pull/3985#issuecomment-284082722","issue_url":"https://api.github.com/repos/apache/druid/issues/3985","id":284082722,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDA4MjcyMg==","user":{"login":"himanshug","id":246308,"node_id":"MDQ6VXNlcjI0NjMwOA==","avatar_url":"https://avatars.githubusercontent.com/u/246308?v=4","gravatar_id":"","url":"https://api.github.com/users/himanshug","html_url":"https://github.com/himanshug","followers_url":"https://api.github.com/users/himanshug/followers","following_url":"https://api.github.com/users/himanshug/following{/other_user}","gists_url":"https://api.github.com/users/himanshug/gists{/gist_id}","starred_url":"https://api.github.com/users/himanshug/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/himanshug/subscriptions","organizations_url":"https://api.github.com/users/himanshug/orgs","repos_url":"https://api.github.com/users/himanshug/repos","events_url":"https://api.github.com/users/himanshug/events{/privacy}","received_events_url":"https://api.github.com/users/himanshug/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-03T22:03:37Z","updated_at":"2017-03-03T22:03:37Z","author_association":"CONTRIBUTOR","body":":+1:\r\n\r\nnote: this PR adds following method to SupervisorSpec\r\n`List<String> getDataSources();`","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284082722/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284082804","html_url":"https://github.com/apache/druid/pull/4003#issuecomment-284082804","issue_url":"https://api.github.com/repos/apache/druid/issues/4003","id":284082804,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDA4MjgwNA==","user":{"login":"akashdw","id":5886276,"node_id":"MDQ6VXNlcjU4ODYyNzY=","avatar_url":"https://avatars.githubusercontent.com/u/5886276?v=4","gravatar_id":"","url":"https://api.github.com/users/akashdw","html_url":"https://github.com/akashdw","followers_url":"https://api.github.com/users/akashdw/followers","following_url":"https://api.github.com/users/akashdw/following{/other_user}","gists_url":"https://api.github.com/users/akashdw/gists{/gist_id}","starred_url":"https://api.github.com/users/akashdw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/akashdw/subscriptions","organizations_url":"https://api.github.com/users/akashdw/orgs","repos_url":"https://api.github.com/users/akashdw/repos","events_url":"https://api.github.com/users/akashdw/events{/privacy}","received_events_url":"https://api.github.com/users/akashdw/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-03T22:03:58Z","updated_at":"2017-03-03T22:06:35Z","author_association":"CONTRIBUTOR","body":"@gianm  tested puller pusher and it worked, but just found a small correction to be made. Uploading a new patch.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284082804/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284083265","html_url":"https://github.com/apache/druid/issues/2262#issuecomment-284083265","issue_url":"https://api.github.com/repos/apache/druid/issues/2262","id":284083265,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDA4MzI2NQ==","user":{"login":"himanshug","id":246308,"node_id":"MDQ6VXNlcjI0NjMwOA==","avatar_url":"https://avatars.githubusercontent.com/u/246308?v=4","gravatar_id":"","url":"https://api.github.com/users/himanshug","html_url":"https://github.com/himanshug","followers_url":"https://api.github.com/users/himanshug/followers","following_url":"https://api.github.com/users/himanshug/following{/other_user}","gists_url":"https://api.github.com/users/himanshug/gists{/gist_id}","starred_url":"https://api.github.com/users/himanshug/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/himanshug/subscriptions","organizations_url":"https://api.github.com/users/himanshug/orgs","repos_url":"https://api.github.com/users/himanshug/repos","events_url":"https://api.github.com/users/himanshug/events{/privacy}","received_events_url":"https://api.github.com/users/himanshug/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-03T22:06:06Z","updated_at":"2017-03-03T22:06:06Z","author_association":"CONTRIBUTOR","body":"also, after `MergeSequence` change and with streaming merge in groupBy v2, most likely toolchest.mergeResults(..) call inside chunking query runner can be removed.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284083265/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284083448","html_url":"https://github.com/apache/druid/issues/2262#issuecomment-284083448","issue_url":"https://api.github.com/repos/apache/druid/issues/2262","id":284083448,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDA4MzQ0OA==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-03T22:06:59Z","updated_at":"2017-03-03T22:06:59Z","author_association":"CONTRIBUTOR","body":"@himanshug I can start working on a patch for this unless you already areâ€¦Â please let me know either way","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284083448/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284086442","html_url":"https://github.com/apache/druid/issues/3892#issuecomment-284086442","issue_url":"https://api.github.com/repos/apache/druid/issues/3892","id":284086442,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDA4NjQ0Mg==","user":{"login":"leerho","id":12941506,"node_id":"MDQ6VXNlcjEyOTQxNTA2","avatar_url":"https://avatars.githubusercontent.com/u/12941506?v=4","gravatar_id":"","url":"https://api.github.com/users/leerho","html_url":"https://github.com/leerho","followers_url":"https://api.github.com/users/leerho/followers","following_url":"https://api.github.com/users/leerho/following{/other_user}","gists_url":"https://api.github.com/users/leerho/gists{/gist_id}","starred_url":"https://api.github.com/users/leerho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leerho/subscriptions","organizations_url":"https://api.github.com/users/leerho/orgs","repos_url":"https://api.github.com/users/leerho/repos","events_url":"https://api.github.com/users/leerho/events{/privacy}","received_events_url":"https://api.github.com/users/leerho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-03T22:21:24Z","updated_at":"2017-03-03T22:21:24Z","author_association":"CONTRIBUTOR","body":"@leventov \r\n\r\n> I don't understand why it is needed to have subclasses with only specialized constructors. It will make difficult to implement NonNativeWritableMemoryImpl.\r\n\r\n- AllocateDirect and AllocateDirectMap both require Cleaner as a field.  The Cleaners have different implementations.  These two need to be a subclass so that a user call of close() at the root of the hierarchy does the work specified in the appropriate subclass.\r\n\r\n- Also, the WritableMemoryImpl class is already huge, so I was looking for opportunities to split out well defined subsets of code.\r\n\r\n- AccessByteBuffer has a lot of specialized logic so it made sense to make it a separate class.\r\n\r\nHonestly, I haven't thought much about how to extend all this for BigEndian, or Positional either.  I am just trying to get the basic functioning done with a workable public API.  \r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284086442/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284086710","html_url":"https://github.com/apache/druid/issues/2262#issuecomment-284086710","issue_url":"https://api.github.com/repos/apache/druid/issues/2262","id":284086710,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDA4NjcxMA==","user":{"login":"himanshug","id":246308,"node_id":"MDQ6VXNlcjI0NjMwOA==","avatar_url":"https://avatars.githubusercontent.com/u/246308?v=4","gravatar_id":"","url":"https://api.github.com/users/himanshug","html_url":"https://github.com/himanshug","followers_url":"https://api.github.com/users/himanshug/followers","following_url":"https://api.github.com/users/himanshug/following{/other_user}","gists_url":"https://api.github.com/users/himanshug/gists{/gist_id}","starred_url":"https://api.github.com/users/himanshug/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/himanshug/subscriptions","organizations_url":"https://api.github.com/users/himanshug/orgs","repos_url":"https://api.github.com/users/himanshug/repos","events_url":"https://api.github.com/users/himanshug/events{/privacy}","received_events_url":"https://api.github.com/users/himanshug/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-03T22:22:42Z","updated_at":"2017-03-03T22:22:42Z","author_association":"CONTRIBUTOR","body":"@gianm feel free to add the patch ... i haven't started on anything. thanks","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284086710/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284086886","html_url":"https://github.com/apache/druid/pull/4003#issuecomment-284086886","issue_url":"https://api.github.com/repos/apache/druid/issues/4003","id":284086886,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDA4Njg4Ng==","user":{"login":"himanshug","id":246308,"node_id":"MDQ6VXNlcjI0NjMwOA==","avatar_url":"https://avatars.githubusercontent.com/u/246308?v=4","gravatar_id":"","url":"https://api.github.com/users/himanshug","html_url":"https://github.com/himanshug","followers_url":"https://api.github.com/users/himanshug/followers","following_url":"https://api.github.com/users/himanshug/following{/other_user}","gists_url":"https://api.github.com/users/himanshug/gists{/gist_id}","starred_url":"https://api.github.com/users/himanshug/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/himanshug/subscriptions","organizations_url":"https://api.github.com/users/himanshug/orgs","repos_url":"https://api.github.com/users/himanshug/repos","events_url":"https://api.github.com/users/himanshug/events{/privacy}","received_events_url":"https://api.github.com/users/himanshug/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-03T22:23:32Z","updated_at":"2017-03-03T22:23:32Z","author_association":"CONTRIBUTOR","body":"@akashdw  what is the \"small correction\" ?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284086886/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284087734","html_url":"https://github.com/apache/druid/pull/4003#issuecomment-284087734","issue_url":"https://api.github.com/repos/apache/druid/issues/4003","id":284087734,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDA4NzczNA==","user":{"login":"akashdw","id":5886276,"node_id":"MDQ6VXNlcjU4ODYyNzY=","avatar_url":"https://avatars.githubusercontent.com/u/5886276?v=4","gravatar_id":"","url":"https://api.github.com/users/akashdw","html_url":"https://github.com/akashdw","followers_url":"https://api.github.com/users/akashdw/followers","following_url":"https://api.github.com/users/akashdw/following{/other_user}","gists_url":"https://api.github.com/users/akashdw/gists{/gist_id}","starred_url":"https://api.github.com/users/akashdw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/akashdw/subscriptions","organizations_url":"https://api.github.com/users/akashdw/orgs","repos_url":"https://api.github.com/users/akashdw/repos","events_url":"https://api.github.com/users/akashdw/events{/privacy}","received_events_url":"https://api.github.com/users/akashdw/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-03T22:27:39Z","updated_at":"2017-03-03T22:27:39Z","author_association":"CONTRIBUTOR","body":"Written descriptor file in hdfs is missing load spec https://github.com/druid-io/druid/pull/4003/files#diff-43eb9286d827e862f82f83f06e495fe1R137. Adding a test to actually read the value of descriptor file instead of only relying on returned DataSegment object after the push. ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284087734/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284089112","html_url":"https://github.com/apache/druid/pull/4003#issuecomment-284089112","issue_url":"https://api.github.com/repos/apache/druid/issues/4003","id":284089112,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDA4OTExMg==","user":{"login":"himanshug","id":246308,"node_id":"MDQ6VXNlcjI0NjMwOA==","avatar_url":"https://avatars.githubusercontent.com/u/246308?v=4","gravatar_id":"","url":"https://api.github.com/users/himanshug","html_url":"https://github.com/himanshug","followers_url":"https://api.github.com/users/himanshug/followers","following_url":"https://api.github.com/users/himanshug/following{/other_user}","gists_url":"https://api.github.com/users/himanshug/gists{/gist_id}","starred_url":"https://api.github.com/users/himanshug/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/himanshug/subscriptions","organizations_url":"https://api.github.com/users/himanshug/orgs","repos_url":"https://api.github.com/users/himanshug/repos","events_url":"https://api.github.com/users/himanshug/events{/privacy}","received_events_url":"https://api.github.com/users/himanshug/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-03T22:34:32Z","updated_at":"2017-03-03T22:34:32Z","author_association":"CONTRIBUTOR","body":"thanks for testing and catching that. :+1:","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284089112/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284090426","html_url":"https://github.com/apache/druid/pull/4002#issuecomment-284090426","issue_url":"https://api.github.com/repos/apache/druid/issues/4002","id":284090426,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDA5MDQyNg==","user":{"login":"himanshug","id":246308,"node_id":"MDQ6VXNlcjI0NjMwOA==","avatar_url":"https://avatars.githubusercontent.com/u/246308?v=4","gravatar_id":"","url":"https://api.github.com/users/himanshug","html_url":"https://github.com/himanshug","followers_url":"https://api.github.com/users/himanshug/followers","following_url":"https://api.github.com/users/himanshug/following{/other_user}","gists_url":"https://api.github.com/users/himanshug/gists{/gist_id}","starred_url":"https://api.github.com/users/himanshug/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/himanshug/subscriptions","organizations_url":"https://api.github.com/users/himanshug/orgs","repos_url":"https://api.github.com/users/himanshug/repos","events_url":"https://api.github.com/users/himanshug/events{/privacy}","received_events_url":"https://api.github.com/users/himanshug/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-03T22:40:34Z","updated_at":"2017-03-03T22:40:40Z","author_association":"CONTRIBUTOR","body":":+1:","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284090426/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284092216","html_url":"https://github.com/apache/druid/pull/4003#issuecomment-284092216","issue_url":"https://api.github.com/repos/apache/druid/issues/4003","id":284092216,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDA5MjIxNg==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-03T22:49:32Z","updated_at":"2017-03-03T22:49:32Z","author_association":"CONTRIBUTOR","body":"@akashdw is the PR updated with the new patch? If so I'll take a look","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284092216/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284093295","html_url":"https://github.com/apache/druid/pull/4003#issuecomment-284093295","issue_url":"https://api.github.com/repos/apache/druid/issues/4003","id":284093295,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDA5MzI5NQ==","user":{"login":"akashdw","id":5886276,"node_id":"MDQ6VXNlcjU4ODYyNzY=","avatar_url":"https://avatars.githubusercontent.com/u/5886276?v=4","gravatar_id":"","url":"https://api.github.com/users/akashdw","html_url":"https://github.com/akashdw","followers_url":"https://api.github.com/users/akashdw/followers","following_url":"https://api.github.com/users/akashdw/following{/other_user}","gists_url":"https://api.github.com/users/akashdw/gists{/gist_id}","starred_url":"https://api.github.com/users/akashdw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/akashdw/subscriptions","organizations_url":"https://api.github.com/users/akashdw/orgs","repos_url":"https://api.github.com/users/akashdw/repos","events_url":"https://api.github.com/users/akashdw/events{/privacy}","received_events_url":"https://api.github.com/users/akashdw/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-03T22:55:09Z","updated_at":"2017-03-03T22:55:36Z","author_association":"CONTRIBUTOR","body":"@gianm @himanshug  I tested out the puller/pusher with the last version and both worked. Found load spec is missing while doing manual validation of descriptor file stored in hdfs. \r\nSorry for missing out that check and creating this PR without validating actual content of the file. \r\nUploaded a new patch, please review.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284093295/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284112521","html_url":"https://github.com/apache/druid/issues/3892#issuecomment-284112521","issue_url":"https://api.github.com/repos/apache/druid/issues/3892","id":284112521,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDExMjUyMQ==","user":{"login":"leerho","id":12941506,"node_id":"MDQ6VXNlcjEyOTQxNTA2","avatar_url":"https://avatars.githubusercontent.com/u/12941506?v=4","gravatar_id":"","url":"https://api.github.com/users/leerho","html_url":"https://github.com/leerho","followers_url":"https://api.github.com/users/leerho/followers","following_url":"https://api.github.com/users/leerho/following{/other_user}","gists_url":"https://api.github.com/users/leerho/gists{/gist_id}","starred_url":"https://api.github.com/users/leerho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leerho/subscriptions","organizations_url":"https://api.github.com/users/leerho/orgs","repos_url":"https://api.github.com/users/leerho/repos","events_url":"https://api.github.com/users/leerho/events{/privacy}","received_events_url":"https://api.github.com/users/leerho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-04T01:06:59Z","updated_at":"2017-03-04T01:06:59Z","author_association":"CONTRIBUTOR","body":"@leventov \r\n\r\nUsing an intermediate interface we can leverage AllocateDirect, AllocateDirectMap and AccessByteBuffer across multiple implementations.\r\n\r\nSince positional will need to leverage both NE and BE, it should be a true interface.\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284112521/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284112908","html_url":"https://github.com/apache/druid/pull/3981#issuecomment-284112908","issue_url":"https://api.github.com/repos/apache/druid/issues/3981","id":284112908,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDExMjkwOA==","user":{"login":"kaijianding","id":8663725,"node_id":"MDQ6VXNlcjg2NjM3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/8663725?v=4","gravatar_id":"","url":"https://api.github.com/users/kaijianding","html_url":"https://github.com/kaijianding","followers_url":"https://api.github.com/users/kaijianding/followers","following_url":"https://api.github.com/users/kaijianding/following{/other_user}","gists_url":"https://api.github.com/users/kaijianding/gists{/gist_id}","starred_url":"https://api.github.com/users/kaijianding/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaijianding/subscriptions","organizations_url":"https://api.github.com/users/kaijianding/orgs","repos_url":"https://api.github.com/users/kaijianding/repos","events_url":"https://api.github.com/users/kaijianding/events{/privacy}","received_events_url":"https://api.github.com/users/kaijianding/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-04T01:10:19Z","updated_at":"2017-03-04T01:10:19Z","author_association":"CONTRIBUTOR","body":"SubTask.run() is called directly inside SameIntervalMergeTask.run() after SameIntervalMergeTask.isReady() called.\r\nIn this way, I think SubTask is not submitted to task queue, so the `isReady` is not going to be called, that's why I removed `isReady` from SubTask. @himanshug ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284112908/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284116295","html_url":"https://github.com/apache/druid/issues/2262#issuecomment-284116295","issue_url":"https://api.github.com/repos/apache/druid/issues/2262","id":284116295,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDExNjI5NQ==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-04T01:43:19Z","updated_at":"2017-03-04T01:45:32Z","author_association":"CONTRIBUTOR","body":"Raised a patch with tests in #4004 ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284116295/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284120037","html_url":"https://github.com/apache/druid/pull/4004#issuecomment-284120037","issue_url":"https://api.github.com/repos/apache/druid/issues/4004","id":284120037,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDEyMDAzNw==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-04T02:28:15Z","updated_at":"2017-03-04T02:28:15Z","author_association":"CONTRIBUTOR","body":"Added some docs and a new test describing behavior with subqueries + chunkPeriod.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284120037/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284130848","html_url":"https://github.com/apache/druid/pull/4004#issuecomment-284130848","issue_url":"https://api.github.com/repos/apache/druid/issues/4004","id":284130848,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDEzMDg0OA==","user":{"login":"fjy","id":428325,"node_id":"MDQ6VXNlcjQyODMyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/428325?v=4","gravatar_id":"","url":"https://api.github.com/users/fjy","html_url":"https://github.com/fjy","followers_url":"https://api.github.com/users/fjy/followers","following_url":"https://api.github.com/users/fjy/following{/other_user}","gists_url":"https://api.github.com/users/fjy/gists{/gist_id}","starred_url":"https://api.github.com/users/fjy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fjy/subscriptions","organizations_url":"https://api.github.com/users/fjy/orgs","repos_url":"https://api.github.com/users/fjy/repos","events_url":"https://api.github.com/users/fjy/events{/privacy}","received_events_url":"https://api.github.com/users/fjy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-04T06:04:59Z","updated_at":"2017-03-04T06:04:59Z","author_association":"CONTRIBUTOR","body":"ðŸ‘ ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284130848/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284130877","html_url":"https://github.com/apache/druid/pull/4004#issuecomment-284130877","issue_url":"https://api.github.com/repos/apache/druid/issues/4004","id":284130877,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDEzMDg3Nw==","user":{"login":"fjy","id":428325,"node_id":"MDQ6VXNlcjQyODMyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/428325?v=4","gravatar_id":"","url":"https://api.github.com/users/fjy","html_url":"https://github.com/fjy","followers_url":"https://api.github.com/users/fjy/followers","following_url":"https://api.github.com/users/fjy/following{/other_user}","gists_url":"https://api.github.com/users/fjy/gists{/gist_id}","starred_url":"https://api.github.com/users/fjy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fjy/subscriptions","organizations_url":"https://api.github.com/users/fjy/orgs","repos_url":"https://api.github.com/users/fjy/repos","events_url":"https://api.github.com/users/fjy/events{/privacy}","received_events_url":"https://api.github.com/users/fjy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-04T06:05:36Z","updated_at":"2017-03-04T06:05:36Z","author_association":"CONTRIBUTOR","body":"@gianm tests are failing","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284130877/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284132369","html_url":"https://github.com/apache/druid/issues/3025#issuecomment-284132369","issue_url":"https://api.github.com/repos/apache/druid/issues/3025","id":284132369,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDEzMjM2OQ==","user":{"login":"HongZhu","id":26179808,"node_id":"MDQ6VXNlcjI2MTc5ODA4","avatar_url":"https://avatars.githubusercontent.com/u/26179808?v=4","gravatar_id":"","url":"https://api.github.com/users/HongZhu","html_url":"https://github.com/HongZhu","followers_url":"https://api.github.com/users/HongZhu/followers","following_url":"https://api.github.com/users/HongZhu/following{/other_user}","gists_url":"https://api.github.com/users/HongZhu/gists{/gist_id}","starred_url":"https://api.github.com/users/HongZhu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HongZhu/subscriptions","organizations_url":"https://api.github.com/users/HongZhu/orgs","repos_url":"https://api.github.com/users/HongZhu/repos","events_url":"https://api.github.com/users/HongZhu/events{/privacy}","received_events_url":"https://api.github.com/users/HongZhu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-04T06:41:30Z","updated_at":"2017-03-04T06:41:30Z","author_association":"NONE","body":"Any updates? \r\n@ottomata - have you identified a workaround? \r\n\r\nI believe that I have encountered the same issue while performing batch ingestion of Snappy compressed Avro files into Druid. \r\n\r\nHere is the exception: \r\norg.apache.hadoop.mapred.TaskAttemptListenerImpl: Task: attempt_1486340755723_533930_m_001362_0 - exited : org.xerial.snappy.SnappyNative.uncompressedLength(Ljava/lang/Object;II)I\r\n\r\nFor our druid installation (druid-0.9.2.1), druid-avro-extensions has snappy-java-1.0.5.jar installed (which doesn't have the native libraries for our hardware platform - x86_64). Native snappy support for Druid processes will be a good solution, just like the way snappy is integrated with Hadoop via installed native libraries. \r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284132369/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284165905","html_url":"https://github.com/apache/druid/pull/4004#issuecomment-284165905","issue_url":"https://api.github.com/repos/apache/druid/issues/4004","id":284165905,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDE2NTkwNQ==","user":{"login":"drcrallen","id":8213081,"node_id":"MDQ6VXNlcjgyMTMwODE=","avatar_url":"https://avatars.githubusercontent.com/u/8213081?v=4","gravatar_id":"","url":"https://api.github.com/users/drcrallen","html_url":"https://github.com/drcrallen","followers_url":"https://api.github.com/users/drcrallen/followers","following_url":"https://api.github.com/users/drcrallen/following{/other_user}","gists_url":"https://api.github.com/users/drcrallen/gists{/gist_id}","starred_url":"https://api.github.com/users/drcrallen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/drcrallen/subscriptions","organizations_url":"https://api.github.com/users/drcrallen/orgs","repos_url":"https://api.github.com/users/drcrallen/repos","events_url":"https://api.github.com/users/drcrallen/events{/privacy}","received_events_url":"https://api.github.com/users/drcrallen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-04T17:16:27Z","updated_at":"2017-03-04T17:16:27Z","author_association":"CONTRIBUTOR","body":"The interval chunking query decorator is called in the `preMergeQueryDecoration` methods. Now you're doing merges in the pre-merge. This seems like a violation of the expected query execution ordering.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284165905/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284168835","html_url":"https://github.com/apache/druid/pull/4004#issuecomment-284168835","issue_url":"https://api.github.com/repos/apache/druid/issues/4004","id":284168835,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDE2ODgzNQ==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-04T17:59:45Z","updated_at":"2017-03-04T17:59:45Z","author_association":"CONTRIBUTOR","body":"The interval chunking decorator did merges before (it does toolChest.mergeResults) so at least I didn't make it worse! But this patch is no good for other reasons, which I am in the middle of writing up. chunkPeriod has an interesting historyâ€¦","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284168835/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284170586","html_url":"https://github.com/apache/druid/pull/4006#issuecomment-284170586","issue_url":"https://api.github.com/repos/apache/druid/issues/4006","id":284170586,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDE3MDU4Ng==","user":{"login":"fjy","id":428325,"node_id":"MDQ6VXNlcjQyODMyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/428325?v=4","gravatar_id":"","url":"https://api.github.com/users/fjy","html_url":"https://github.com/fjy","followers_url":"https://api.github.com/users/fjy/followers","following_url":"https://api.github.com/users/fjy/following{/other_user}","gists_url":"https://api.github.com/users/fjy/gists{/gist_id}","starred_url":"https://api.github.com/users/fjy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fjy/subscriptions","organizations_url":"https://api.github.com/users/fjy/orgs","repos_url":"https://api.github.com/users/fjy/repos","events_url":"https://api.github.com/users/fjy/events{/privacy}","received_events_url":"https://api.github.com/users/fjy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-04T18:24:58Z","updated_at":"2017-03-04T18:24:58Z","author_association":"CONTRIBUTOR","body":"ðŸ‘ ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284170586/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284171911","html_url":"https://github.com/apache/druid/pull/4004#issuecomment-284171911","issue_url":"https://api.github.com/repos/apache/druid/issues/4004","id":284171911,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDE3MTkxMQ==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-04T18:42:32Z","updated_at":"2017-03-04T18:42:32Z","author_association":"CONTRIBUTOR","body":"@himanshug @drcrallen @fjy after looking into this more I have learned some facts about chunkPeriod.\r\n\r\n- In the olden days (initial OSS Druid), chunkPeriod was implemented as `Sequences.concat(lazyIterableOfChunkSequences)` and so queries were executed sequentially. The sequences for later chunks weren't created until earlier chunks had finished, and this had the effect of reducing load on the historicals (since they'd only see part of each query at once).\r\n- But, TWIST: Druid 0.6.71 included commit 1d1ec1d8556be02878b68f4daad1b6b0aaa886d0, which effectively disabled chunkPeriod since it bypasses chunking if `period.getMillis() == 0`, which is true for any period that doesn't have a millisecond component. To get a nonzero millis component you'd have to use a period like `\"PT60.001S\"` which I doubt anyone was doing.\r\n- Later on, Druid 0.7.1 included #1150, where chunkPeriod was re-implemented as `Sequences.concat(Lists.newArrayList(lazyIterableOfChunkSequences))`. Doing `Lists.newArrayList` creates the sequences eagerly, which sends queries to the cluster in parallel. Additionally, the sequences are created in a thread pool, and the the chunks are all wrapped in `toolChest.mergeResults(...)` before sequences are created, which for groupBy v1 means each chunk is merged in its own thread in parallel. This patch also fixed the `period.getMillis() == 0` check, so chunking started doing something again.\r\n- So in particular, #1150 changed chunkPeriod from something that was meant to decrease resource impact on historical nodes (by breaking up long queries and running them sequentially), into something that is meant to break up long queries and run them in _parallel_, which would either leave resource impact unchanged or increase it, especially on the broker.\r\n- The docs still say that chunkPeriod breaks queries into \"shorter interval queries, reducing the impact on resources\". I think the docs are wrong now in that regard.\r\n- The old behavior was useful at reducing resource impact for any query type, but the current behavior is only useful for parallelizing queries where `toolChest.mergeResults(...).run(...)` does merging eagerly, which is only groupBy v1. Other types like timeseries, topN, groupBy v2, all do merging lazily, so parallelizing the call to `toolChest.mergeResults(...).run(...)` isn't useful.\r\n\r\nMy question for you all: is this analysis correct and if so what should we do about it? Druid 0.6.71 and 0.7.1 are pretty old, so we've had the current behavior for quite a long time, and it seems to have gone un-noticed by anyone that might have been using chunkPeriod for its old purpose.\r\n\r\nMy vote for 0.10.0 would be to update the docs to reflect reality (chunkPeriod makes queries more resource intensive, not less, by parallelizing merging on the broker, and is only useful for groupBy v1). I'd also suggest including code to ignore chunkPeriod for groupBy v2 queries since it makes the results wrong, and even if that were fixed, it wouldn't really do anything useful anyway.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284171911/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284173541","html_url":"https://github.com/apache/druid/pull/4007#issuecomment-284173541","issue_url":"https://api.github.com/repos/apache/druid/issues/4007","id":284173541,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDE3MzU0MQ==","user":{"login":"fjy","id":428325,"node_id":"MDQ6VXNlcjQyODMyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/428325?v=4","gravatar_id":"","url":"https://api.github.com/users/fjy","html_url":"https://github.com/fjy","followers_url":"https://api.github.com/users/fjy/followers","following_url":"https://api.github.com/users/fjy/following{/other_user}","gists_url":"https://api.github.com/users/fjy/gists{/gist_id}","starred_url":"https://api.github.com/users/fjy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fjy/subscriptions","organizations_url":"https://api.github.com/users/fjy/orgs","repos_url":"https://api.github.com/users/fjy/repos","events_url":"https://api.github.com/users/fjy/events{/privacy}","received_events_url":"https://api.github.com/users/fjy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-04T19:07:03Z","updated_at":"2017-03-04T19:07:03Z","author_association":"CONTRIBUTOR","body":"ðŸ‘ ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284173541/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284178735","html_url":"https://github.com/apache/druid/pull/4002#issuecomment-284178735","issue_url":"https://api.github.com/repos/apache/druid/issues/4002","id":284178735,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDE3ODczNQ==","user":{"login":"akashdw","id":5886276,"node_id":"MDQ6VXNlcjU4ODYyNzY=","avatar_url":"https://avatars.githubusercontent.com/u/5886276?v=4","gravatar_id":"","url":"https://api.github.com/users/akashdw","html_url":"https://github.com/akashdw","followers_url":"https://api.github.com/users/akashdw/followers","following_url":"https://api.github.com/users/akashdw/following{/other_user}","gists_url":"https://api.github.com/users/akashdw/gists{/gist_id}","starred_url":"https://api.github.com/users/akashdw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/akashdw/subscriptions","organizations_url":"https://api.github.com/users/akashdw/orgs","repos_url":"https://api.github.com/users/akashdw/repos","events_url":"https://api.github.com/users/akashdw/events{/privacy}","received_events_url":"https://api.github.com/users/akashdw/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-04T20:31:23Z","updated_at":"2017-03-04T20:31:23Z","author_association":"CONTRIBUTOR","body":"ðŸ‘ ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284178735/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284199445","html_url":"https://github.com/apache/druid/pull/4010#issuecomment-284199445","issue_url":"https://api.github.com/repos/apache/druid/issues/4010","id":284199445,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDE5OTQ0NQ==","user":{"login":"fjy","id":428325,"node_id":"MDQ6VXNlcjQyODMyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/428325?v=4","gravatar_id":"","url":"https://api.github.com/users/fjy","html_url":"https://github.com/fjy","followers_url":"https://api.github.com/users/fjy/followers","following_url":"https://api.github.com/users/fjy/following{/other_user}","gists_url":"https://api.github.com/users/fjy/gists{/gist_id}","starred_url":"https://api.github.com/users/fjy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fjy/subscriptions","organizations_url":"https://api.github.com/users/fjy/orgs","repos_url":"https://api.github.com/users/fjy/repos","events_url":"https://api.github.com/users/fjy/events{/privacy}","received_events_url":"https://api.github.com/users/fjy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-05T02:07:17Z","updated_at":"2017-03-05T02:07:17Z","author_association":"CONTRIBUTOR","body":"ðŸ‘ ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284199445/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284199459","html_url":"https://github.com/apache/druid/pull/4009#issuecomment-284199459","issue_url":"https://api.github.com/repos/apache/druid/issues/4009","id":284199459,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDE5OTQ1OQ==","user":{"login":"fjy","id":428325,"node_id":"MDQ6VXNlcjQyODMyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/428325?v=4","gravatar_id":"","url":"https://api.github.com/users/fjy","html_url":"https://github.com/fjy","followers_url":"https://api.github.com/users/fjy/followers","following_url":"https://api.github.com/users/fjy/following{/other_user}","gists_url":"https://api.github.com/users/fjy/gists{/gist_id}","starred_url":"https://api.github.com/users/fjy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fjy/subscriptions","organizations_url":"https://api.github.com/users/fjy/orgs","repos_url":"https://api.github.com/users/fjy/repos","events_url":"https://api.github.com/users/fjy/events{/privacy}","received_events_url":"https://api.github.com/users/fjy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-05T02:07:27Z","updated_at":"2017-03-05T02:07:27Z","author_association":"CONTRIBUTOR","body":"ðŸ‘ ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284199459/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284199525","html_url":"https://github.com/apache/druid/pull/4004#issuecomment-284199525","issue_url":"https://api.github.com/repos/apache/druid/issues/4004","id":284199525,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDE5OTUyNQ==","user":{"login":"fjy","id":428325,"node_id":"MDQ6VXNlcjQyODMyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/428325?v=4","gravatar_id":"","url":"https://api.github.com/users/fjy","html_url":"https://github.com/fjy","followers_url":"https://api.github.com/users/fjy/followers","following_url":"https://api.github.com/users/fjy/following{/other_user}","gists_url":"https://api.github.com/users/fjy/gists{/gist_id}","starred_url":"https://api.github.com/users/fjy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fjy/subscriptions","organizations_url":"https://api.github.com/users/fjy/orgs","repos_url":"https://api.github.com/users/fjy/repos","events_url":"https://api.github.com/users/fjy/events{/privacy}","received_events_url":"https://api.github.com/users/fjy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-05T02:09:25Z","updated_at":"2017-03-05T02:09:25Z","author_association":"CONTRIBUTOR","body":"ðŸ‘ on updating docs for 0.10.0 to reflect reality","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284199525/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284219533","html_url":"https://github.com/apache/druid/issues/4005#issuecomment-284219533","issue_url":"https://api.github.com/repos/apache/druid/issues/4005","id":284219533,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDIxOTUzMw==","user":{"login":"rocknrollnerd","id":4882763,"node_id":"MDQ6VXNlcjQ4ODI3NjM=","avatar_url":"https://avatars.githubusercontent.com/u/4882763?v=4","gravatar_id":"","url":"https://api.github.com/users/rocknrollnerd","html_url":"https://github.com/rocknrollnerd","followers_url":"https://api.github.com/users/rocknrollnerd/followers","following_url":"https://api.github.com/users/rocknrollnerd/following{/other_user}","gists_url":"https://api.github.com/users/rocknrollnerd/gists{/gist_id}","starred_url":"https://api.github.com/users/rocknrollnerd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rocknrollnerd/subscriptions","organizations_url":"https://api.github.com/users/rocknrollnerd/orgs","repos_url":"https://api.github.com/users/rocknrollnerd/repos","events_url":"https://api.github.com/users/rocknrollnerd/events{/privacy}","received_events_url":"https://api.github.com/users/rocknrollnerd/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-05T10:41:27Z","updated_at":"2017-03-05T10:41:27Z","author_association":"NONE","body":"Ah, figured it out. Turns out it was a network interface issue: I used to run coordinator with `_JAVA_OPTIONS=\"-Djava.net.preferIPv6Addresses=true -Djava.net.preferIPv6Stack=true\"`, and disabling it solved the problem. Also I should've posted that on Google's Druid support group rather then here. Apologies.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284219533/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284248476","html_url":"https://github.com/apache/druid/pull/4004#issuecomment-284248476","issue_url":"https://api.github.com/repos/apache/druid/issues/4004","id":284248476,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDI0ODQ3Ng==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-05T18:14:54Z","updated_at":"2017-03-05T18:15:06Z","author_association":"CONTRIBUTOR","body":"@himanshug @drcrallen @fjy Updated PR description and top comment with a new fix, disabling chunkPeriod for groupBy v2. It wouldn't help much anyway (see https://github.com/druid-io/druid/pull/4004#issuecomment-284171911)  and doesn't mesh well with how groupBy v2 merges results.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284248476/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284253708","html_url":"https://github.com/apache/druid/pull/4004#issuecomment-284253708","issue_url":"https://api.github.com/repos/apache/druid/issues/4004","id":284253708,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDI1MzcwOA==","user":{"login":"fjy","id":428325,"node_id":"MDQ6VXNlcjQyODMyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/428325?v=4","gravatar_id":"","url":"https://api.github.com/users/fjy","html_url":"https://github.com/fjy","followers_url":"https://api.github.com/users/fjy/followers","following_url":"https://api.github.com/users/fjy/following{/other_user}","gists_url":"https://api.github.com/users/fjy/gists{/gist_id}","starred_url":"https://api.github.com/users/fjy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fjy/subscriptions","organizations_url":"https://api.github.com/users/fjy/orgs","repos_url":"https://api.github.com/users/fjy/repos","events_url":"https://api.github.com/users/fjy/events{/privacy}","received_events_url":"https://api.github.com/users/fjy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-05T19:30:42Z","updated_at":"2017-03-05T19:30:42Z","author_association":"CONTRIBUTOR","body":"ðŸ‘ \r\n","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284253708/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284289571","html_url":"https://github.com/apache/druid/issues/3996#issuecomment-284289571","issue_url":"https://api.github.com/repos/apache/druid/issues/3996","id":284289571,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDI4OTU3MQ==","user":{"login":"mjaow","id":8275883,"node_id":"MDQ6VXNlcjgyNzU4ODM=","avatar_url":"https://avatars.githubusercontent.com/u/8275883?v=4","gravatar_id":"","url":"https://api.github.com/users/mjaow","html_url":"https://github.com/mjaow","followers_url":"https://api.github.com/users/mjaow/followers","following_url":"https://api.github.com/users/mjaow/following{/other_user}","gists_url":"https://api.github.com/users/mjaow/gists{/gist_id}","starred_url":"https://api.github.com/users/mjaow/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mjaow/subscriptions","organizations_url":"https://api.github.com/users/mjaow/orgs","repos_url":"https://api.github.com/users/mjaow/repos","events_url":"https://api.github.com/users/mjaow/events{/privacy}","received_events_url":"https://api.github.com/users/mjaow/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-06T02:43:34Z","updated_at":"2017-03-06T02:43:34Z","author_association":"NONE","body":"@gianm  my teamates use hdfs for storage not s3,so can i just use hdfs and reference the file from my lookup?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284289571/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284342921","html_url":"https://github.com/apache/druid/issues/4011#issuecomment-284342921","issue_url":"https://api.github.com/repos/apache/druid/issues/4011","id":284342921,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDM0MjkyMQ==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-06T09:21:16Z","updated_at":"2017-03-06T09:21:16Z","author_association":"CONTRIBUTOR","body":"@naman-aasaan, according to the docs,\r\n\r\n> First and Last aggregator cannot be used in ingestion spec, and should only be specified as part of queries.\r\n\r\nSo the thing you're doing is not supported at this time. What are you trying to accomplish? Maybe there's another way or maybe this is a missing feature.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284342921/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284344227","html_url":"https://github.com/apache/druid/issues/4011#issuecomment-284344227","issue_url":"https://api.github.com/repos/apache/druid/issues/4011","id":284344227,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDM0NDIyNw==","user":{"login":"codewithnaman","id":19516326,"node_id":"MDQ6VXNlcjE5NTE2MzI2","avatar_url":"https://avatars.githubusercontent.com/u/19516326?v=4","gravatar_id":"","url":"https://api.github.com/users/codewithnaman","html_url":"https://github.com/codewithnaman","followers_url":"https://api.github.com/users/codewithnaman/followers","following_url":"https://api.github.com/users/codewithnaman/following{/other_user}","gists_url":"https://api.github.com/users/codewithnaman/gists{/gist_id}","starred_url":"https://api.github.com/users/codewithnaman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codewithnaman/subscriptions","organizations_url":"https://api.github.com/users/codewithnaman/orgs","repos_url":"https://api.github.com/users/codewithnaman/repos","events_url":"https://api.github.com/users/codewithnaman/events{/privacy}","received_events_url":"https://api.github.com/users/codewithnaman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-06T09:26:28Z","updated_at":"2017-03-06T09:26:28Z","author_association":"NONE","body":"Hi Gianm, We have requirement of finding out last value with re-indexing from 24 hours of data.\r\n What is the way forward ? We were highly relying upon this aggregation type.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284344227/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284345570","html_url":"https://github.com/apache/druid/issues/3996#issuecomment-284345570","issue_url":"https://api.github.com/repos/apache/druid/issues/3996","id":284345570,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDM0NTU3MA==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-06T09:32:08Z","updated_at":"2017-03-06T09:32:08Z","author_association":"CONTRIBUTOR","body":"I think HDFS should work for lookup files if you have the\ndruid-hdfs-storage extension loaded.\n\nOn Sun, Mar 5, 2017 at 6:43 PM, mjaow <notifications@github.com> wrote:\n\n> @gianm <https://github.com/gianm> my teamates use hdfs for storage not\n> s3,so can i just use hdfs and reference the file from my lookup?\n>\n> â€”\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/druid-io/druid/issues/3996#issuecomment-284289571>,\n> or mute the thread\n> <https://github.com/notifications/unsubscribe-auth/ABKGezaLJ3wcuopqfE_G3rB1GpJF91fmks5ri3LZgaJpZM4MR1to>\n> .\n>\n","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284345570/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284346268","html_url":"https://github.com/apache/druid/issues/4011#issuecomment-284346268","issue_url":"https://api.github.com/repos/apache/druid/issues/4011","id":284346268,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDM0NjI2OA==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-06T09:34:55Z","updated_at":"2017-03-06T09:34:55Z","author_association":"CONTRIBUTOR","body":"If you just want the last row matching a certain filter, you can do a select query with a filter, threshold: 1, and descending: true. You don't need reindexing for that.\r\n\r\nIf that's not what you want then could you describe what you're looking for in more detail?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284346268/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284348090","html_url":"https://github.com/apache/druid/issues/4011#issuecomment-284348090","issue_url":"https://api.github.com/repos/apache/druid/issues/4011","id":284348090,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDM0ODA5MA==","user":{"login":"codewithnaman","id":19516326,"node_id":"MDQ6VXNlcjE5NTE2MzI2","avatar_url":"https://avatars.githubusercontent.com/u/19516326?v=4","gravatar_id":"","url":"https://api.github.com/users/codewithnaman","html_url":"https://github.com/codewithnaman","followers_url":"https://api.github.com/users/codewithnaman/followers","following_url":"https://api.github.com/users/codewithnaman/following{/other_user}","gists_url":"https://api.github.com/users/codewithnaman/gists{/gist_id}","starred_url":"https://api.github.com/users/codewithnaman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codewithnaman/subscriptions","organizations_url":"https://api.github.com/users/codewithnaman/orgs","repos_url":"https://api.github.com/users/codewithnaman/repos","events_url":"https://api.github.com/users/codewithnaman/events{/privacy}","received_events_url":"https://api.github.com/users/codewithnaman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-06T09:42:52Z","updated_at":"2017-03-06T09:42:52Z","author_association":"NONE","body":"Hi Gianm, \r\n\r\nWe have raw data being stored in Druid data source and we need to send some of the aggregations on 24 hours of data to some other interface.\r\n\r\nWe are thinking to perform re indexing on 24 hours of raw data to prepare aggregated feed where we need to prepare multiple aggregations on the raw metrics like SUM, MIN, MAX, LAST.  etc. \r\n\r\nIt looks odd to me if we have to read complete raw data again through standalone Java and prepare those required aggregations. We have around 8million rows coming per 15 mins and it comes to around 768 million for 24 hours.\r\n\r\nKindly suggest the way forward.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284348090/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284351909","html_url":"https://github.com/apache/druid/issues/4011#issuecomment-284351909","issue_url":"https://api.github.com/repos/apache/druid/issues/4011","id":284351909,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDM1MTkwOQ==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-06T09:59:08Z","updated_at":"2017-03-06T09:59:08Z","author_association":"CONTRIBUTOR","body":"Could you use a groupBy query instead of reindexing to prepare the aggregation? With groupBy v2 we can now spill to disk so the only limit is disk space. That should work, since groupBy supports all those aggregations.\r\n\r\nIf you have to use reindexing, the for that to work, someone (possibly you) would have to make the last aggregators work at indexing time. This would probably involve a new column type (pair of timestamp + value) similar to how the variance aggregator works.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284351909/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284358634","html_url":"https://github.com/apache/druid/issues/4011#issuecomment-284358634","issue_url":"https://api.github.com/repos/apache/druid/issues/4011","id":284358634,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDM1ODYzNA==","user":{"login":"codewithnaman","id":19516326,"node_id":"MDQ6VXNlcjE5NTE2MzI2","avatar_url":"https://avatars.githubusercontent.com/u/19516326?v=4","gravatar_id":"","url":"https://api.github.com/users/codewithnaman","html_url":"https://github.com/codewithnaman","followers_url":"https://api.github.com/users/codewithnaman/followers","following_url":"https://api.github.com/users/codewithnaman/following{/other_user}","gists_url":"https://api.github.com/users/codewithnaman/gists{/gist_id}","starred_url":"https://api.github.com/users/codewithnaman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codewithnaman/subscriptions","organizations_url":"https://api.github.com/users/codewithnaman/orgs","repos_url":"https://api.github.com/users/codewithnaman/repos","events_url":"https://api.github.com/users/codewithnaman/events{/privacy}","received_events_url":"https://api.github.com/users/codewithnaman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-06T10:28:08Z","updated_at":"2017-03-06T10:28:08Z","author_association":"NONE","body":"Hi Gian, I can try groupBy query but the only problem looks to be about data - we have raw data for around 7.5 million subelments  and output of groupBy query is going to be little bit more than 7.5 million.\r\n\r\nKindly suggest.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284358634/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284374064","html_url":"https://github.com/apache/druid/issues/4011#issuecomment-284374064","issue_url":"https://api.github.com/repos/apache/druid/issues/4011","id":284374064,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDM3NDA2NA==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-06T11:41:49Z","updated_at":"2017-03-06T11:41:49Z","author_association":"CONTRIBUTOR","body":"7.5 million rows in the result should be okay. If necessary you can enable spilling to disk for groupBy using `druid.query.groupBy.maxOnDiskStorage`.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284374064/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284460815","html_url":"https://github.com/apache/druid/pull/4004#issuecomment-284460815","issue_url":"https://api.github.com/repos/apache/druid/issues/4004","id":284460815,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDQ2MDgxNQ==","user":{"login":"himanshug","id":246308,"node_id":"MDQ6VXNlcjI0NjMwOA==","avatar_url":"https://avatars.githubusercontent.com/u/246308?v=4","gravatar_id":"","url":"https://api.github.com/users/himanshug","html_url":"https://github.com/himanshug","followers_url":"https://api.github.com/users/himanshug/followers","following_url":"https://api.github.com/users/himanshug/following{/other_user}","gists_url":"https://api.github.com/users/himanshug/gists{/gist_id}","starred_url":"https://api.github.com/users/himanshug/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/himanshug/subscriptions","organizations_url":"https://api.github.com/users/himanshug/orgs","repos_url":"https://api.github.com/users/himanshug/repos","events_url":"https://api.github.com/users/himanshug/events{/privacy}","received_events_url":"https://api.github.com/users/himanshug/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-06T17:01:36Z","updated_at":"2017-03-06T17:01:36Z","author_association":"CONTRIBUTOR","body":"@gianm thanks for looking it up.\r\n\r\nI believe we should also remove it from [Search|Select|TopN|Timeseries]QueryToolChest.preMergeDecoration(..) . I have not seen it being used and helpful anywhere except GroupBy-v1 queries. (we can fix it too but I don't see that worth it)\r\nso effectively, chunkPeriod in its current form would retire with GroupBy-v1. ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284460815/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284466897","html_url":"https://github.com/apache/druid/pull/3981#issuecomment-284466897","issue_url":"https://api.github.com/repos/apache/druid/issues/3981","id":284466897,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDQ2Njg5Nw==","user":{"login":"himanshug","id":246308,"node_id":"MDQ6VXNlcjI0NjMwOA==","avatar_url":"https://avatars.githubusercontent.com/u/246308?v=4","gravatar_id":"","url":"https://api.github.com/users/himanshug","html_url":"https://github.com/himanshug","followers_url":"https://api.github.com/users/himanshug/followers","following_url":"https://api.github.com/users/himanshug/following{/other_user}","gists_url":"https://api.github.com/users/himanshug/gists{/gist_id}","starred_url":"https://api.github.com/users/himanshug/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/himanshug/subscriptions","organizations_url":"https://api.github.com/users/himanshug/orgs","repos_url":"https://api.github.com/users/himanshug/repos","events_url":"https://api.github.com/users/himanshug/events{/privacy}","received_events_url":"https://api.github.com/users/himanshug/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-06T17:21:28Z","updated_at":"2017-03-06T17:21:28Z","author_association":"CONTRIBUTOR","body":"@kaijianding yeah, its fine then.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284466897/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284474240","html_url":"https://github.com/apache/druid/pull/4013#issuecomment-284474240","issue_url":"https://api.github.com/repos/apache/druid/issues/4013","id":284474240,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDQ3NDI0MA==","user":{"login":"fjy","id":428325,"node_id":"MDQ6VXNlcjQyODMyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/428325?v=4","gravatar_id":"","url":"https://api.github.com/users/fjy","html_url":"https://github.com/fjy","followers_url":"https://api.github.com/users/fjy/followers","following_url":"https://api.github.com/users/fjy/following{/other_user}","gists_url":"https://api.github.com/users/fjy/gists{/gist_id}","starred_url":"https://api.github.com/users/fjy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fjy/subscriptions","organizations_url":"https://api.github.com/users/fjy/orgs","repos_url":"https://api.github.com/users/fjy/repos","events_url":"https://api.github.com/users/fjy/events{/privacy}","received_events_url":"https://api.github.com/users/fjy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-06T17:46:18Z","updated_at":"2017-03-06T17:46:18Z","author_association":"CONTRIBUTOR","body":"ðŸ‘ ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284474240/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284474342","html_url":"https://github.com/apache/druid/pull/4012#issuecomment-284474342","issue_url":"https://api.github.com/repos/apache/druid/issues/4012","id":284474342,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDQ3NDM0Mg==","user":{"login":"fjy","id":428325,"node_id":"MDQ6VXNlcjQyODMyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/428325?v=4","gravatar_id":"","url":"https://api.github.com/users/fjy","html_url":"https://github.com/fjy","followers_url":"https://api.github.com/users/fjy/followers","following_url":"https://api.github.com/users/fjy/following{/other_user}","gists_url":"https://api.github.com/users/fjy/gists{/gist_id}","starred_url":"https://api.github.com/users/fjy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fjy/subscriptions","organizations_url":"https://api.github.com/users/fjy/orgs","repos_url":"https://api.github.com/users/fjy/repos","events_url":"https://api.github.com/users/fjy/events{/privacy}","received_events_url":"https://api.github.com/users/fjy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-06T17:46:39Z","updated_at":"2017-03-06T17:46:39Z","author_association":"CONTRIBUTOR","body":"ðŸ‘ ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284474342/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/284478625","html_url":"https://github.com/apache/druid/pull/4012#issuecomment-284478625","issue_url":"https://api.github.com/repos/apache/druid/issues/4012","id":284478625,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NDQ3ODYyNQ==","user":{"login":"jon-wei","id":8729063,"node_id":"MDQ6VXNlcjg3MjkwNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8729063?v=4","gravatar_id":"","url":"https://api.github.com/users/jon-wei","html_url":"https://github.com/jon-wei","followers_url":"https://api.github.com/users/jon-wei/followers","following_url":"https://api.github.com/users/jon-wei/following{/other_user}","gists_url":"https://api.github.com/users/jon-wei/gists{/gist_id}","starred_url":"https://api.github.com/users/jon-wei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jon-wei/subscriptions","organizations_url":"https://api.github.com/users/jon-wei/orgs","repos_url":"https://api.github.com/users/jon-wei/repos","events_url":"https://api.github.com/users/jon-wei/events{/privacy}","received_events_url":"https://api.github.com/users/jon-wei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-06T18:01:16Z","updated_at":"2017-03-06T18:01:16Z","author_association":"CONTRIBUTOR","body":":+1: ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/284478625/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]