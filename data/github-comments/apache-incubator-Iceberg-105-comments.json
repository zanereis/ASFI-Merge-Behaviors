[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/894646781","html_url":"https://github.com/apache/iceberg/issues/2899#issuecomment-894646781","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2899","id":894646781,"node_id":"IC_kwDOCW7NX841Uzn9","user":{"login":"candily","id":761113,"node_id":"MDQ6VXNlcjc2MTExMw==","avatar_url":"https://avatars.githubusercontent.com/u/761113?v=4","gravatar_id":"","url":"https://api.github.com/users/candily","html_url":"https://github.com/candily","followers_url":"https://api.github.com/users/candily/followers","following_url":"https://api.github.com/users/candily/following{/other_user}","gists_url":"https://api.github.com/users/candily/gists{/gist_id}","starred_url":"https://api.github.com/users/candily/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/candily/subscriptions","organizations_url":"https://api.github.com/users/candily/orgs","repos_url":"https://api.github.com/users/candily/repos","events_url":"https://api.github.com/users/candily/events{/privacy}","received_events_url":"https://api.github.com/users/candily/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-07T12:11:33Z","updated_at":"2021-08-07T12:11:33Z","author_association":"NONE","body":"Re-reading this, I think the intent is that you should just use the [built-in Spark bucket transform](https://spark.apache.org/docs/3.1.1/api/scala/org/apache/spark/sql/functions$.html#bucket(numBuckets:Int,e:org.apache.spark.sql.Column):org.apache.spark.sql.Column) for initially specifying the output table partitioning, and use the Iceberg UDF for sorting within a partition.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/894646781/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/894691328","html_url":"https://github.com/apache/iceberg/issues/2939#issuecomment-894691328","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2939","id":894691328,"node_id":"IC_kwDOCW7NX841U-gA","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-07T18:39:01Z","updated_at":"2021-08-07T18:39:01Z","author_association":"CONTRIBUTOR","body":"I see that I missed https://github.com/apache/iceberg/blob/111fe810c81eb2fea7d849ecc21daedd1c429355/spark3-extensions/src/main/scala/org/apache/spark/sql/catalyst/optimizer/RewriteDelete.scala#L98.\r\nIn https://github.com/apache/iceberg/blob/111fe810c81eb2fea7d849ecc21daedd1c429355/spark3-extensions/src/main/scala/org/apache/spark/sql/catalyst/utils/DistributionAndOrderingUtils.scala#L97-L101 we handle instantiating RepartitionByExpression according to the Spark version.\r\nI'll put up a PR with a fix.\r\nSorry about that.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/894691328/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/894700212","html_url":"https://github.com/apache/iceberg/pull/2954#issuecomment-894700212","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2954","id":894700212,"node_id":"IC_kwDOCW7NX841VAq0","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-07T19:54:23Z","updated_at":"2021-08-07T19:54:23Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer @coolderli this is a fix for the RepartitionByExpression issue.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/894700212/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/894708752","html_url":"https://github.com/apache/iceberg/pull/2954#issuecomment-894708752","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2954","id":894708752,"node_id":"IC_kwDOCW7NX841VCwQ","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-07T21:29:21Z","updated_at":"2021-08-07T21:29:21Z","author_association":"MEMBER","body":"Let's add in a test which would trigger this. I assume we hit this because we have no tests hitting rewrite delete?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/894708752/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/894717376","html_url":"https://github.com/apache/iceberg/pull/2954#issuecomment-894717376","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2954","id":894717376,"node_id":"IC_kwDOCW7NX841VE3A","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-07T23:20:16Z","updated_at":"2021-08-07T23:23:12Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer we have tests that hit rewrite delete, just not rewrite delete with distribution mode.\r\nIn https://github.com/apache/iceberg/blob/ee7fe3833ebd7d4321cec43987094c9f5d9664fb/spark3-extensions/src/main/scala/org/apache/spark/sql/catalyst/optimizer/RewriteDelete.scala#L94-L96\r\nit is only if there is a distribution mode that we need to call RepartitionByExpression.\r\nAs @coolderli is adding tests in #2911 for distribution mode, and those tests would trigger this, I didn't feel the need to add something.\r\nHowever, I would like to see this go into 0.12.0.\r\nLet me know what you think.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/894717376/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/894729072","html_url":"https://github.com/apache/iceberg/pull/2954#issuecomment-894729072","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2954","id":894729072,"node_id":"IC_kwDOCW7NX841VHtw","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-08T01:38:37Z","updated_at":"2021-08-08T01:38:37Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer I created a separate PR, #2955, with tests that fail without this change.\r\nThe tests are a subset of what @coolderli is adding in #2911, but the test change should be reverted if he rebases his PR on it since his change is more extensive.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/894729072/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/894729200","html_url":"https://github.com/apache/iceberg/pull/2955#issuecomment-894729200","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2955","id":894729200,"node_id":"IC_kwDOCW7NX841VHvw","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-08T01:40:47Z","updated_at":"2021-08-08T01:40:47Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer we can use this if you'd like to have some tests that show the issue now, or we can use #2954 and wait for #2911 for such tests.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/894729200/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/894999879","html_url":"https://github.com/apache/iceberg/pull/2893#issuecomment-894999879","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2893","id":894999879,"node_id":"IC_kwDOCW7NX841WJ1H","user":{"login":"empcl","id":28925346,"node_id":"MDQ6VXNlcjI4OTI1MzQ2","avatar_url":"https://avatars.githubusercontent.com/u/28925346?v=4","gravatar_id":"","url":"https://api.github.com/users/empcl","html_url":"https://github.com/empcl","followers_url":"https://api.github.com/users/empcl/followers","following_url":"https://api.github.com/users/empcl/following{/other_user}","gists_url":"https://api.github.com/users/empcl/gists{/gist_id}","starred_url":"https://api.github.com/users/empcl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/empcl/subscriptions","organizations_url":"https://api.github.com/users/empcl/orgs","repos_url":"https://api.github.com/users/empcl/repos","events_url":"https://api.github.com/users/empcl/events{/privacy}","received_events_url":"https://api.github.com/users/empcl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-09T07:06:55Z","updated_at":"2021-08-09T07:06:55Z","author_association":"NONE","body":"Hi, @massdosage Could you please review this PR ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/894999879/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":1},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895092906","html_url":"https://github.com/apache/iceberg/pull/2866#issuecomment-895092906","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2866","id":895092906,"node_id":"IC_kwDOCW7NX841Wgiq","user":{"login":"rymurr","id":2022305,"node_id":"MDQ6VXNlcjIwMjIzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/2022305?v=4","gravatar_id":"","url":"https://api.github.com/users/rymurr","html_url":"https://github.com/rymurr","followers_url":"https://api.github.com/users/rymurr/followers","following_url":"https://api.github.com/users/rymurr/following{/other_user}","gists_url":"https://api.github.com/users/rymurr/gists{/gist_id}","starred_url":"https://api.github.com/users/rymurr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rymurr/subscriptions","organizations_url":"https://api.github.com/users/rymurr/orgs","repos_url":"https://api.github.com/users/rymurr/repos","events_url":"https://api.github.com/users/rymurr/events{/privacy}","received_events_url":"https://api.github.com/users/rymurr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-09T09:52:27Z","updated_at":"2021-08-09T09:52:27Z","author_association":"CONTRIBUTOR","body":"Hey @jun-he did you push the new commits? I dont see the changes you mentioned in the comments. Maybe my GH diff is just not rendering correctly?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895092906/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895177137","html_url":"https://github.com/apache/iceberg/pull/2850#issuecomment-895177137","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2850","id":895177137,"node_id":"IC_kwDOCW7NX841W1Gx","user":{"login":"sshkvar","id":3986221,"node_id":"MDQ6VXNlcjM5ODYyMjE=","avatar_url":"https://avatars.githubusercontent.com/u/3986221?v=4","gravatar_id":"","url":"https://api.github.com/users/sshkvar","html_url":"https://github.com/sshkvar","followers_url":"https://api.github.com/users/sshkvar/followers","following_url":"https://api.github.com/users/sshkvar/following{/other_user}","gists_url":"https://api.github.com/users/sshkvar/gists{/gist_id}","starred_url":"https://api.github.com/users/sshkvar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sshkvar/subscriptions","organizations_url":"https://api.github.com/users/sshkvar/orgs","repos_url":"https://api.github.com/users/sshkvar/repos","events_url":"https://api.github.com/users/sshkvar/events{/privacy}","received_events_url":"https://api.github.com/users/sshkvar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-09T12:20:17Z","updated_at":"2021-08-09T12:20:17Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer @kbendick the same functionality already merged to Trino Iceberg connector https://github.com/trinodb/trino/pull/6063\r\nAlso as @pvary mentioned the same PR opened to the Hive https://issues.apache.org/jira/browse/HIVE-24906\r\n\r\nThis functionality will allow us to avoid issue with table rename as I described above. \r\nI will be really appreciate for the review, I am ready to work on it and want to hear you opinion about it","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895177137/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895194533","html_url":"https://github.com/apache/iceberg/pull/2854#issuecomment-895194533","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2854","id":895194533,"node_id":"IC_kwDOCW7NX841W5Wl","user":{"login":"sshkvar","id":3986221,"node_id":"MDQ6VXNlcjM5ODYyMjE=","avatar_url":"https://avatars.githubusercontent.com/u/3986221?v=4","gravatar_id":"","url":"https://api.github.com/users/sshkvar","html_url":"https://github.com/sshkvar","followers_url":"https://api.github.com/users/sshkvar/followers","following_url":"https://api.github.com/users/sshkvar/following{/other_user}","gists_url":"https://api.github.com/users/sshkvar/gists{/gist_id}","starred_url":"https://api.github.com/users/sshkvar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sshkvar/subscriptions","organizations_url":"https://api.github.com/users/sshkvar/orgs","repos_url":"https://api.github.com/users/sshkvar/repos","events_url":"https://api.github.com/users/sshkvar/events{/privacy}","received_events_url":"https://api.github.com/users/sshkvar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-09T12:48:59Z","updated_at":"2021-08-09T12:48:59Z","author_association":"CONTRIBUTOR","body":"@kbendick I have changed test and now use `spark` catalog for getting Table info. \r\nAlso I rebased this branch to have only 1 commit. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895194533/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895242592","html_url":"https://github.com/apache/iceberg/issues/2900#issuecomment-895242592","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2900","id":895242592,"node_id":"IC_kwDOCW7NX841XFFg","user":{"login":"ayush-san","id":57655135,"node_id":"MDQ6VXNlcjU3NjU1MTM1","avatar_url":"https://avatars.githubusercontent.com/u/57655135?v=4","gravatar_id":"","url":"https://api.github.com/users/ayush-san","html_url":"https://github.com/ayush-san","followers_url":"https://api.github.com/users/ayush-san/followers","following_url":"https://api.github.com/users/ayush-san/following{/other_user}","gists_url":"https://api.github.com/users/ayush-san/gists{/gist_id}","starred_url":"https://api.github.com/users/ayush-san/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ayush-san/subscriptions","organizations_url":"https://api.github.com/users/ayush-san/orgs","repos_url":"https://api.github.com/users/ayush-san/repos","events_url":"https://api.github.com/users/ayush-san/events{/privacy}","received_events_url":"https://api.github.com/users/ayush-san/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-09T13:54:09Z","updated_at":"2021-08-09T13:54:09Z","author_association":"NONE","body":"@stevenzwu, I tried my heap dumps with MAT and the denominator tree output points to `org.apache.iceberg.TableMetadata` class\r\n\r\nI am attaching the output I generated by using [auto-mat](https://github.com/jfrog/auto-mat)\r\n\r\n[Top Consumers.pdf](https://github.com/apache/iceberg/files/6954933/Top.Consumers.pdf)\r\n\r\nAlso IcebergFilesCommitter and `org.apache.iceberg.TableMetadata` both appear as leak suspects\r\n\r\n![image](https://user-images.githubusercontent.com/57655135/128717484-5fdbb8a5-2d0a-4df8-9149-d5f5a34d640c.png)\r\n![image](https://user-images.githubusercontent.com/57655135/128717345-7f3ba37f-dcc2-4f6f-a626-d2bc46333fd0.png)\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895242592/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895244837","html_url":"https://github.com/apache/iceberg/issues/2900#issuecomment-895244837","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2900","id":895244837,"node_id":"IC_kwDOCW7NX841XFol","user":{"login":"ayush-san","id":57655135,"node_id":"MDQ6VXNlcjU3NjU1MTM1","avatar_url":"https://avatars.githubusercontent.com/u/57655135?v=4","gravatar_id":"","url":"https://api.github.com/users/ayush-san","html_url":"https://github.com/ayush-san","followers_url":"https://api.github.com/users/ayush-san/followers","following_url":"https://api.github.com/users/ayush-san/following{/other_user}","gists_url":"https://api.github.com/users/ayush-san/gists{/gist_id}","starred_url":"https://api.github.com/users/ayush-san/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ayush-san/subscriptions","organizations_url":"https://api.github.com/users/ayush-san/orgs","repos_url":"https://api.github.com/users/ayush-san/repos","events_url":"https://api.github.com/users/ayush-san/events{/privacy}","received_events_url":"https://api.github.com/users/ayush-san/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-09T13:56:53Z","updated_at":"2021-08-09T13:56:53Z","author_association":"NONE","body":"Also as I was going through the task logs, I can see that almost all the time taken by my tables during checkpointing is due to opening multiple Avro metadata files. Is it due to the fact that I am not running maintenance procedures(compaction/expirying snapshots) on my CDC table or due to s3 thorttling?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895244837/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895292382","html_url":"https://github.com/apache/iceberg/issues/2934#issuecomment-895292382","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2934","id":895292382,"node_id":"IC_kwDOCW7NX841XRPe","user":{"login":"cccs-br","id":56260250,"node_id":"MDQ6VXNlcjU2MjYwMjUw","avatar_url":"https://avatars.githubusercontent.com/u/56260250?v=4","gravatar_id":"","url":"https://api.github.com/users/cccs-br","html_url":"https://github.com/cccs-br","followers_url":"https://api.github.com/users/cccs-br/followers","following_url":"https://api.github.com/users/cccs-br/following{/other_user}","gists_url":"https://api.github.com/users/cccs-br/gists{/gist_id}","starred_url":"https://api.github.com/users/cccs-br/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cccs-br/subscriptions","organizations_url":"https://api.github.com/users/cccs-br/orgs","repos_url":"https://api.github.com/users/cccs-br/repos","events_url":"https://api.github.com/users/cccs-br/events{/privacy}","received_events_url":"https://api.github.com/users/cccs-br/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-09T14:54:20Z","updated_at":"2021-08-09T14:54:20Z","author_association":"NONE","body":"Thanks @RussellSpitzer .  Is that something that you guys fixed in iceberg directly? - or you had to adjust your queries to get around it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895292382/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895293363","html_url":"https://github.com/apache/iceberg/issues/2934#issuecomment-895293363","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2934","id":895293363,"node_id":"IC_kwDOCW7NX841XRez","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-09T14:55:31Z","updated_at":"2021-08-09T14:59:08Z","author_association":"MEMBER","body":"This is something that needs to be fixed in Iceberg, we haven't run into this yet but @manishmalhotrawork and I were talking about possible fixes over the weekend.\r\n\r\nI'm pretty sure the issue here is in predicate translation, we have a function sparkSql() which doesn't handle ByteBuffers even though those are valid predicates in evaluators. See\r\n\r\nhttps://github.com/apache/iceberg/blob/40e626a168a3137b42d023fb8f8f3835f3cd0a78/spark3/src/main/java/org/apache/iceberg/spark/Spark3Util.java#L718-L721\r\n\r\n I think we just need to convert incoming byteBuffers to byteArrays here\r\n\r\nhttps://github.com/apache/iceberg/blob/40e626a168a3137b42d023fb8f8f3835f3cd0a78/spark3/src/main/java/org/apache/iceberg/spark/SparkFilters.java#L198-L209\r\n\r\nSo that the rest of our SparkUtil code will work with byte buffer literals generated by Spark","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895293363/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895299796","html_url":"https://github.com/apache/iceberg/issues/2934#issuecomment-895299796","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2934","id":895299796,"node_id":"IC_kwDOCW7NX841XTDU","user":{"login":"cccs-br","id":56260250,"node_id":"MDQ6VXNlcjU2MjYwMjUw","avatar_url":"https://avatars.githubusercontent.com/u/56260250?v=4","gravatar_id":"","url":"https://api.github.com/users/cccs-br","html_url":"https://github.com/cccs-br","followers_url":"https://api.github.com/users/cccs-br/followers","following_url":"https://api.github.com/users/cccs-br/following{/other_user}","gists_url":"https://api.github.com/users/cccs-br/gists{/gist_id}","starred_url":"https://api.github.com/users/cccs-br/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cccs-br/subscriptions","organizations_url":"https://api.github.com/users/cccs-br/orgs","repos_url":"https://api.github.com/users/cccs-br/repos","events_url":"https://api.github.com/users/cccs-br/events{/privacy}","received_events_url":"https://api.github.com/users/cccs-br/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-09T15:03:01Z","updated_at":"2021-08-09T15:03:01Z","author_association":"NONE","body":"Ok, great.  Will you reference this issue in PR when it comes in?  I'd just like to know when this gets merged and eventually released so we can upgrade our iceberg lib as soon as it becomes available.\r\n\r\nThanks again.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895299796/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895336767","html_url":"https://github.com/apache/iceberg/pull/2866#issuecomment-895336767","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2866","id":895336767,"node_id":"IC_kwDOCW7NX841XcE_","user":{"login":"jun-he","id":12246263,"node_id":"MDQ6VXNlcjEyMjQ2MjYz","avatar_url":"https://avatars.githubusercontent.com/u/12246263?v=4","gravatar_id":"","url":"https://api.github.com/users/jun-he","html_url":"https://github.com/jun-he","followers_url":"https://api.github.com/users/jun-he/followers","following_url":"https://api.github.com/users/jun-he/following{/other_user}","gists_url":"https://api.github.com/users/jun-he/gists{/gist_id}","starred_url":"https://api.github.com/users/jun-he/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jun-he/subscriptions","organizations_url":"https://api.github.com/users/jun-he/orgs","repos_url":"https://api.github.com/users/jun-he/repos","events_url":"https://api.github.com/users/jun-he/events{/privacy}","received_events_url":"https://api.github.com/users/jun-he/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-09T15:51:20Z","updated_at":"2021-08-09T15:51:20Z","author_association":"COLLABORATOR","body":"@rymurr  oops, just force pushed the changes. Sorry about it. Can you take a look? Thanks.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895336767/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895340841","html_url":"https://github.com/apache/iceberg/issues/2900#issuecomment-895340841","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2900","id":895340841,"node_id":"IC_kwDOCW7NX841XdEp","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-09T15:56:58Z","updated_at":"2021-08-09T18:33:52Z","author_association":"CONTRIBUTOR","body":"@ayush-san you might have the right hutch regarding \" not running maintenance procedures\"? You can verify the hypothesis by writing to a new empty table, which should eliminate the factor. if you are not seeing the GC issue after the switch, that will likely confirm the theory. \r\n\r\nHow long have you been running the ingestion job to Iceberg? When did you start to see the problem since the beginning of the job? How often do you checkpoint/commit? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895340841/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895448436","html_url":"https://github.com/apache/iceberg/pull/2943#issuecomment-895448436","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2943","id":895448436,"node_id":"IC_kwDOCW7NX841X3V0","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-09T18:37:11Z","updated_at":"2021-08-09T18:37:11Z","author_association":"CONTRIBUTOR","body":"I found a couple of minor things. Nothing that should block this from getting into the release though. We can fix the minor stuff later.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895448436/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895454141","html_url":"https://github.com/apache/iceberg/pull/2926#issuecomment-895454141","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2926","id":895454141,"node_id":"IC_kwDOCW7NX841X4u9","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-09T18:45:13Z","updated_at":"2021-08-09T18:45:13Z","author_association":"CONTRIBUTOR","body":"@szehon-ho, could you fix the conflict?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895454141/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895458095","html_url":"https://github.com/apache/iceberg/pull/2948#issuecomment-895458095","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2948","id":895458095,"node_id":"IC_kwDOCW7NX841X5sv","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-09T18:51:59Z","updated_at":"2021-08-09T18:51:59Z","author_association":"CONTRIBUTOR","body":"Looks good to me overall. I'd like to get this into 0.12.0 to fix the failure, too.\r\n\r\nOut of curiosity, how was this passing before? Wouldn't this have failed before the assert fix?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895458095/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895489641","html_url":"https://github.com/apache/iceberg/pull/2948#issuecomment-895489641","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2948","id":895489641,"node_id":"IC_kwDOCW7NX841YBZp","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-09T19:40:47Z","updated_at":"2021-08-09T19:40:47Z","author_association":"CONTRIBUTOR","body":"@rdblue yeah it should have been breaking since the commit #2721, but I assumed the integration tests were run by Kyle and did not verify it, and we never merged that change to our internal repo to test, so didn't find out the issue until now. \r\n\r\nI think we have been talking about contributing an AWS account to run the integration tests as a part of the CI for any change related to the AWS module. It is currently application in progress, it should be the best way to avoid this kind of issue in the future.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895489641/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895538624","html_url":"https://github.com/apache/iceberg/pull/2954#issuecomment-895538624","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2954","id":895538624,"node_id":"IC_kwDOCW7NX841YNXA","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-09T20:55:26Z","updated_at":"2021-08-09T20:55:26Z","author_association":"CONTRIBUTOR","body":"Thanks, @wypoon! I'm glad this was caught in time for the release.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895538624/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895541881","html_url":"https://github.com/apache/iceberg/pull/2943#issuecomment-895541881","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2943","id":895541881,"node_id":"IC_kwDOCW7NX841YOJ5","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-09T20:58:39Z","updated_at":"2021-08-09T20:58:39Z","author_association":"CONTRIBUTOR","body":"Thanks, @ismailsimsek! This should make it into the 0.12.0 release.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895541881/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895547740","html_url":"https://github.com/apache/iceberg/pull/2954#issuecomment-895547740","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2954","id":895547740,"node_id":"IC_kwDOCW7NX841YPlc","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-09T21:04:28Z","updated_at":"2021-08-09T21:04:28Z","author_association":"CONTRIBUTOR","body":"Thanks to @coolderli for finding the issue!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895547740/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895567688","html_url":"https://github.com/apache/iceberg/pull/2955#issuecomment-895567688","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2955","id":895567688,"node_id":"IC_kwDOCW7NX841YUdI","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-09T21:37:13Z","updated_at":"2021-08-09T21:37:13Z","author_association":"CONTRIBUTOR","body":"Abandoned in favor of #2954.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895567688/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895570521","html_url":"https://github.com/apache/iceberg/pull/2951#issuecomment-895570521","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2951","id":895570521,"node_id":"IC_kwDOCW7NX841YVJZ","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-09T21:42:53Z","updated_at":"2021-08-09T21:42:53Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer can you take a quick look at this?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895570521/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895577035","html_url":"https://github.com/apache/iceberg/pull/2951#issuecomment-895577035","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2951","id":895577035,"node_id":"IC_kwDOCW7NX841YWvL","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-09T21:55:56Z","updated_at":"2021-08-09T21:55:56Z","author_association":"CONTRIBUTOR","body":"Thanks, @szehon-ho! Great to have fixes for flaky tests!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895577035/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895601472","html_url":"https://github.com/apache/iceberg/pull/2926#issuecomment-895601472","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2926","id":895601472,"node_id":"IC_kwDOCW7NX841YctA","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-09T22:48:57Z","updated_at":"2021-08-09T22:48:57Z","author_association":"COLLABORATOR","body":"Done, seems it passed","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895601472/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895605253","html_url":"https://github.com/apache/iceberg/pull/2926#issuecomment-895605253","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2926","id":895605253,"node_id":"IC_kwDOCW7NX841YdoF","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-09T22:59:08Z","updated_at":"2021-08-09T22:59:08Z","author_association":"CONTRIBUTOR","body":"Merged! Thanks @szehon-ho, nice work!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895605253/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895651872","html_url":"https://github.com/apache/iceberg/pull/2911#issuecomment-895651872","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2911","id":895651872,"node_id":"IC_kwDOCW7NX841YpAg","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-10T01:04:33Z","updated_at":"2021-08-10T01:04:33Z","author_association":"CONTRIBUTOR","body":"@coolderli #2954 is merged. If you rebase on master, the test failures when running against Spark 3.1 should be fixed.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895651872/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895653892","html_url":"https://github.com/apache/iceberg/pull/2779#issuecomment-895653892","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2779","id":895653892,"node_id":"IC_kwDOCW7NX841YpgE","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-10T01:09:48Z","updated_at":"2021-08-10T01:09:48Z","author_association":"COLLABORATOR","body":"@RussellSpitzer  changed to select after your fix, if you want to take another look?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895653892/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895713796","html_url":"https://github.com/apache/iceberg/issues/2900#issuecomment-895713796","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2900","id":895713796,"node_id":"IC_kwDOCW7NX841Y4IE","user":{"login":"ayush-san","id":57655135,"node_id":"MDQ6VXNlcjU3NjU1MTM1","avatar_url":"https://avatars.githubusercontent.com/u/57655135?v=4","gravatar_id":"","url":"https://api.github.com/users/ayush-san","html_url":"https://github.com/ayush-san","followers_url":"https://api.github.com/users/ayush-san/followers","following_url":"https://api.github.com/users/ayush-san/following{/other_user}","gists_url":"https://api.github.com/users/ayush-san/gists{/gist_id}","starred_url":"https://api.github.com/users/ayush-san/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ayush-san/subscriptions","organizations_url":"https://api.github.com/users/ayush-san/orgs","repos_url":"https://api.github.com/users/ayush-san/repos","events_url":"https://api.github.com/users/ayush-san/events{/privacy}","received_events_url":"https://api.github.com/users/ayush-san/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-10T04:11:25Z","updated_at":"2021-08-10T04:11:25Z","author_association":"NONE","body":"> How long have you been running the ingestion job to Iceberg? When did you start to see the problem since the beginning of the job?\r\n\r\nWe are running 5 jobs with 90 somethings tables for about 2 months now and have only started getting GC errors from the last week. We never faced this issue while doing the POC with just 10 tables. \r\n\r\n> How often do you checkpoint/commit?\r\n\r\nWe have a checkpoint at every 10 min \r\n\r\n\r\n@stevenzwu Since now the consistency issue(https://github.com/apache/iceberg/issues/2308) with rewrite action will be solved in 0.12, I can start running maintenance procedures for the streaming job too\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895713796/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895776237","html_url":"https://github.com/apache/iceberg/issues/2907#issuecomment-895776237","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2907","id":895776237,"node_id":"IC_kwDOCW7NX841ZHXt","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-10T06:54:20Z","updated_at":"2021-08-10T06:54:20Z","author_association":"CONTRIBUTOR","body":"This has been closed by the linked PR.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895776237/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895778108","html_url":"https://github.com/apache/iceberg/pull/2953#issuecomment-895778108","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2953","id":895778108,"node_id":"IC_kwDOCW7NX841ZH08","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-10T06:57:36Z","updated_at":"2021-08-10T06:57:36Z","author_association":"CONTRIBUTOR","body":"> This in turn requires fixing the alternate PruneColumn methods for Avro\r\n> and Parquet to respect that they will now have selected field ID's for non\r\n> primitive nodes.\r\n\r\nDo you know if anything needs to be done for ORC @RussellSpitzer? I'm helping out with ORC more going forward and if you're aware of anything that needs to be updated there, if you don't have time to update it, if you make an issue I'll see if I can grab it (or at the least we'll have the issue to track).\r\n\r\nIf you're not sure then possibly you can add a unit test for ORC as well? If it fails, open an issue (or I will) and then we can follow up on it after. =)\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895778108/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895801700","html_url":"https://github.com/apache/iceberg/pull/2916#issuecomment-895801700","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2916","id":895801700,"node_id":"IC_kwDOCW7NX841ZNlk","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-10T07:36:27Z","updated_at":"2021-08-10T07:36:27Z","author_association":"CONTRIBUTOR","body":"> When iceberg write pos-delete file there is one default value 'DEFAULT_RECORDS_NUM_THRESHOLD = 100_000L'. When pos-delete records number attain 100_000 will open one new file, so when there is too much pos-delete records will create too much pos-delete. So in this PR add configuration write.records-num-threshold that users can control pos-delete file number.\r\n\r\nWhen you say that there is one default value, does this value previously exist (and is simply not exposed)? I'm not seeing any reference to anything resembling this config in the diff. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895801700/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895803138","html_url":"https://github.com/apache/iceberg/issues/2918#issuecomment-895803138","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2918","id":895803138,"node_id":"IC_kwDOCW7NX841ZN8C","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-10T07:38:48Z","updated_at":"2021-08-10T07:38:48Z","author_association":"CONTRIBUTOR","body":"Can you show an example diagram where the filter / FlinkCDCSource has a parallelism > 1? Right now, all of your examples have parallelism of 1 for the `Source` and the `Filter`.\r\n\r\nAlso, correct me if I'm wrong, but the `Filter` operation isn't _required_ to be part of the job's DAG at all, right?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895803138/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895805995","html_url":"https://github.com/apache/iceberg/pull/2916#issuecomment-895805995","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2916","id":895805995,"node_id":"IC_kwDOCW7NX841ZOor","user":{"login":"hameizi","id":18445460,"node_id":"MDQ6VXNlcjE4NDQ1NDYw","avatar_url":"https://avatars.githubusercontent.com/u/18445460?v=4","gravatar_id":"","url":"https://api.github.com/users/hameizi","html_url":"https://github.com/hameizi","followers_url":"https://api.github.com/users/hameizi/followers","following_url":"https://api.github.com/users/hameizi/following{/other_user}","gists_url":"https://api.github.com/users/hameizi/gists{/gist_id}","starred_url":"https://api.github.com/users/hameizi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hameizi/subscriptions","organizations_url":"https://api.github.com/users/hameizi/orgs","repos_url":"https://api.github.com/users/hameizi/repos","events_url":"https://api.github.com/users/hameizi/events{/privacy}","received_events_url":"https://api.github.com/users/hameizi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-10T07:43:50Z","updated_at":"2021-08-10T07:43:50Z","author_association":"CONTRIBUTOR","body":"> > When iceberg write pos-delete file there is one default value 'DEFAULT_RECORDS_NUM_THRESHOLD = 100_000L'. When pos-delete records number attain 100_000 will open one new file, so when there is too much pos-delete records will create too much pos-delete. So in this PR add configuration write.records-num-threshold that users can control pos-delete file number.\r\n> \r\n> When you say that there is one default value, does this value previously exist (and is simply not exposed)? I'm not seeing any reference to anything resembling this config in the diff.\r\n\r\n@kbendick Yes, there is one default value previously exist and it is 100_000L.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895805995/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895824959","html_url":"https://github.com/apache/iceberg/pull/2948#issuecomment-895824959","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2948","id":895824959,"node_id":"IC_kwDOCW7NX841ZTQ_","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-10T08:12:25Z","updated_at":"2021-08-10T08:13:58Z","author_association":"CONTRIBUTOR","body":"> @rdblue yeah it should have been breaking since the commit #2721, but I assumed the integration tests were run by Kyle and did not verify it, and we never merged that change to our internal repo to test, so didn't find out the issue until now.\r\n> \r\n> I think we have been talking about contributing an AWS account to run the integration tests as a part of the CI for any change related to the AWS module. It is currently application in progress, it should be the best way to avoid this kind of issue in the future.\r\n\r\nThanks for this fix. I also (mistakenly) assumed that these tests were run during CI.\r\n\r\nIt would be great if there were a way to run the integration tests on a semi-regular basis, or to add this to CI (even using dynamo-local and friends if need be to do it during CI - though ideally with real infrastructure would be preferable as I know at least dynamo-local isn't quite the same as DynamoDB from past experience). Or, do we have documentation for running these specific tests? I regularly run some test suites against AWS (in addition to other infrastructure) for things like releases, but it's just my own ad-hoc set up for things like ensuring table creation works, etc.\r\n\r\nFWIW, I just pulled master and I still get NPE when running `./gradlew :iceberg-aws:integrationTest`. How am I supposed to be running these? When I run `./gradlew clean build`, everything passes. But running `./gradlew :iceberg-aws:integrationTest` gives me several failures.\r\n\r\n```\r\n> Task :iceberg-aws:integrationTest\r\n\r\norg.apache.iceberg.aws.glue.GlueCatalogNamespaceTest > classMethod FAILED\r\n    java.lang.ExceptionInInitializerError\r\n        Caused by: software.amazon.awssdk.core.exception.SdkClientException\r\n\r\norg.apache.iceberg.aws.glue.GlueCatalogNamespaceTest > classMethod FAILED\r\n    java.lang.NoClassDefFoundError\r\n\r\norg.apache.iceberg.aws.glue.GlueCatalogCommitFailureTest > classMethod FAILED\r\n    java.lang.NoClassDefFoundError\r\n\r\n..... (more NoClassDefFoundError).\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895824959/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895832934","html_url":"https://github.com/apache/iceberg/pull/2948#issuecomment-895832934","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2948","id":895832934,"node_id":"IC_kwDOCW7NX841ZVNm","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-10T08:23:49Z","updated_at":"2021-08-10T08:23:49Z","author_association":"CONTRIBUTOR","body":"Maybe in the interim, we can add a `README.md` file to the `aws/src/integration` or something? I'm not able to get this to work at all locally - I assume it requires input parameters etc.\r\n\r\nAt the least, when testing releases etc, I can run the S3 specific subset of these (as I don't use GlueCatalog etc currently, but do make use of S3FileIO).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895832934/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895833275","html_url":"https://github.com/apache/iceberg/pull/2948#issuecomment-895833275","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2948","id":895833275,"node_id":"IC_kwDOCW7NX841ZVS7","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-10T08:24:20Z","updated_at":"2021-08-10T08:27:53Z","author_association":"CONTRIBUTOR","body":"cc @jackye1995 On the above two questions (sorry for multiple comments).\r\n\r\nIf there's anything I can do to help, including adding a dynamodb-local dockerfile, please let me know. I'm always hesitant to use dynamodb-local, because in my past experience it is not quite close enough to real DynamoDB, but I imagine that would be better than not running it at all.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895833275/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895834862","html_url":"https://github.com/apache/iceberg/pull/2948#issuecomment-895834862","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2948","id":895834862,"node_id":"IC_kwDOCW7NX841ZVru","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-10T08:26:43Z","updated_at":"2021-08-10T08:26:43Z","author_association":"CONTRIBUTOR","body":"> Looks good to me overall. I'd like to get this into 0.12.0 to fix the failure, too.\r\n> \r\n> Out of curiosity, how was this passing before? Wouldn't this have failed before the assert fix?\r\n\r\nTo answer your question somewhat more directly @rdblue of how this was passing before, this doesn't appear to be run during any of our existing automation. Even running them manually, one has to have the environment set up for it. TIL.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895834862/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895855628","html_url":"https://github.com/apache/iceberg/pull/2933#issuecomment-895855628","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2933","id":895855628,"node_id":"IC_kwDOCW7NX841ZawM","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-10T08:58:46Z","updated_at":"2021-08-10T08:59:42Z","author_association":"CONTRIBUTOR","body":"Thank you for your contribution @mayursrivastava! One small nit: can you update the PR title to be a bit more descriptive?\r\n\r\nI'm particularly interested in the vectorized parquet read paths, but the PR title alone doesn't convey much info to me. Maybe `[ARROW] Vectorized Parquet Reads - Assertions + Correctness Checks for Deletion Files`? Will leave that up to you as it's your PR, but it would be great if you could update the PR title :slightly","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895855628/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895856095","html_url":"https://github.com/apache/iceberg/pull/2933#issuecomment-895856095","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2933","id":895856095,"node_id":"IC_kwDOCW7NX841Za3f","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-10T08:59:30Z","updated_at":"2021-08-10T08:59:30Z","author_association":"CONTRIBUTOR","body":"So SORRY! I fat fingered the close PR button when trying to use an emoji 🙃 \r\n\r\nThank you for your contribution @mayursrivastava! One small nit: can you update the PR title to be a bit more descriptive?\r\n\r\nI'm particularly interested in the vectorized parquet read paths, but the PR title alone doesn't convey much info to me. Maybe [ARROW] Vectorized Parquet Reads - Assertions + Correctness Checks for Deletion Files? Will leave that up to you as it's your PR, but it would be great if you could update the PR title 🙂 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895856095/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895862288","html_url":"https://github.com/apache/iceberg/pull/2933#issuecomment-895862288","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2933","id":895862288,"node_id":"IC_kwDOCW7NX841ZcYQ","user":{"login":"mayursrivastava","id":8659624,"node_id":"MDQ6VXNlcjg2NTk2MjQ=","avatar_url":"https://avatars.githubusercontent.com/u/8659624?v=4","gravatar_id":"","url":"https://api.github.com/users/mayursrivastava","html_url":"https://github.com/mayursrivastava","followers_url":"https://api.github.com/users/mayursrivastava/followers","following_url":"https://api.github.com/users/mayursrivastava/following{/other_user}","gists_url":"https://api.github.com/users/mayursrivastava/gists{/gist_id}","starred_url":"https://api.github.com/users/mayursrivastava/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mayursrivastava/subscriptions","organizations_url":"https://api.github.com/users/mayursrivastava/orgs","repos_url":"https://api.github.com/users/mayursrivastava/repos","events_url":"https://api.github.com/users/mayursrivastava/events{/privacy}","received_events_url":"https://api.github.com/users/mayursrivastava/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-10T09:08:29Z","updated_at":"2021-08-10T09:08:29Z","author_association":"CONTRIBUTOR","body":"@kbendick Thanks! I changed the pr title","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895862288/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895949083","html_url":"https://github.com/apache/iceberg/issues/2931#issuecomment-895949083","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2931","id":895949083,"node_id":"IC_kwDOCW7NX841Zxkb","user":{"login":"ayush-san","id":57655135,"node_id":"MDQ6VXNlcjU3NjU1MTM1","avatar_url":"https://avatars.githubusercontent.com/u/57655135?v=4","gravatar_id":"","url":"https://api.github.com/users/ayush-san","html_url":"https://github.com/ayush-san","followers_url":"https://api.github.com/users/ayush-san/followers","following_url":"https://api.github.com/users/ayush-san/following{/other_user}","gists_url":"https://api.github.com/users/ayush-san/gists{/gist_id}","starred_url":"https://api.github.com/users/ayush-san/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ayush-san/subscriptions","organizations_url":"https://api.github.com/users/ayush-san/orgs","repos_url":"https://api.github.com/users/ayush-san/repos","events_url":"https://api.github.com/users/ayush-san/events{/privacy}","received_events_url":"https://api.github.com/users/ayush-san/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-10T11:24:32Z","updated_at":"2021-08-10T11:24:32Z","author_association":"NONE","body":"@flyrain Running expire-snapshot action will trigger a much bigger issue and will cause the job to fail. Issue - https://github.com/apache/iceberg/pull/2603\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895949083/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895952463","html_url":"https://github.com/apache/iceberg/issues/2808#issuecomment-895952463","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2808","id":895952463,"node_id":"IC_kwDOCW7NX841ZyZP","user":{"login":"wg1026688210","id":14267759,"node_id":"MDQ6VXNlcjE0MjY3NzU5","avatar_url":"https://avatars.githubusercontent.com/u/14267759?v=4","gravatar_id":"","url":"https://api.github.com/users/wg1026688210","html_url":"https://github.com/wg1026688210","followers_url":"https://api.github.com/users/wg1026688210/followers","following_url":"https://api.github.com/users/wg1026688210/following{/other_user}","gists_url":"https://api.github.com/users/wg1026688210/gists{/gist_id}","starred_url":"https://api.github.com/users/wg1026688210/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wg1026688210/subscriptions","organizations_url":"https://api.github.com/users/wg1026688210/orgs","repos_url":"https://api.github.com/users/wg1026688210/repos","events_url":"https://api.github.com/users/wg1026688210/events{/privacy}","received_events_url":"https://api.github.com/users/wg1026688210/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-10T11:30:18Z","updated_at":"2021-08-10T11:30:18Z","author_association":"CONTRIBUTOR","body":"[initializeState will get the max-committed-checkpointid from iceberg table ](https://github.com/apache/iceberg/blob/7a3bfedf25cb74624ed898cec81e3bcadffb2373/flink/src/main/java/org/apache/iceberg/flink/sink/IcebergFilesCommitter.java#L143-L146) and  [notifyCheckpointComplete also check whether checkpointid is greater than max-committed-checkpointid](https://github.com/apache/iceberg/blob/7a3bfedf25cb74624ed898cec81e3bcadffb2373/flink/src/main/java/org/apache/iceberg/flink/sink/IcebergFilesCommitter.java#L188) .I  am  confused why the commits have the same  the max-committed-checkpointid","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895952463/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895956035","html_url":"https://github.com/apache/iceberg/issues/2808#issuecomment-895956035","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2808","id":895956035,"node_id":"IC_kwDOCW7NX841ZzRD","user":{"login":"wg1026688210","id":14267759,"node_id":"MDQ6VXNlcjE0MjY3NzU5","avatar_url":"https://avatars.githubusercontent.com/u/14267759?v=4","gravatar_id":"","url":"https://api.github.com/users/wg1026688210","html_url":"https://github.com/wg1026688210","followers_url":"https://api.github.com/users/wg1026688210/followers","following_url":"https://api.github.com/users/wg1026688210/following{/other_user}","gists_url":"https://api.github.com/users/wg1026688210/gists{/gist_id}","starred_url":"https://api.github.com/users/wg1026688210/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wg1026688210/subscriptions","organizations_url":"https://api.github.com/users/wg1026688210/orgs","repos_url":"https://api.github.com/users/wg1026688210/repos","events_url":"https://api.github.com/users/wg1026688210/events{/privacy}","received_events_url":"https://api.github.com/users/wg1026688210/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-10T11:36:47Z","updated_at":"2021-08-10T11:36:47Z","author_association":"CONTRIBUTOR","body":"did you set the 'execution.checkpointing.tolerable-failed-checkpoints' as @stevenzwu  said","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895956035/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895960999","html_url":"https://github.com/apache/iceberg/issues/2900#issuecomment-895960999","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2900","id":895960999,"node_id":"IC_kwDOCW7NX841Z0en","user":{"login":"ayush-san","id":57655135,"node_id":"MDQ6VXNlcjU3NjU1MTM1","avatar_url":"https://avatars.githubusercontent.com/u/57655135?v=4","gravatar_id":"","url":"https://api.github.com/users/ayush-san","html_url":"https://github.com/ayush-san","followers_url":"https://api.github.com/users/ayush-san/followers","following_url":"https://api.github.com/users/ayush-san/following{/other_user}","gists_url":"https://api.github.com/users/ayush-san/gists{/gist_id}","starred_url":"https://api.github.com/users/ayush-san/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ayush-san/subscriptions","organizations_url":"https://api.github.com/users/ayush-san/orgs","repos_url":"https://api.github.com/users/ayush-san/repos","events_url":"https://api.github.com/users/ayush-san/events{/privacy}","received_events_url":"https://api.github.com/users/ayush-san/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-10T11:46:06Z","updated_at":"2021-08-10T11:46:06Z","author_association":"NONE","body":"I ran the following maintenance procedure on my streaming table and the metadata size was reduced considerably. Also checkpoint for this table came down to 700ms from earlier 8-9 mins.\r\n\r\n```\r\nActions.forTable(table).rewriteDataFiles().targetSizeInBytes(256 * 1024 * 1024).execute();\r\nspark.sql(\"CALL hive.system.rewrite_manifests('db_name.table_name')\").show()\r\nspark.sql(\"CALL hive.system.expire_snapshots(table => 'db_name.table_name', older_than => 1628428025000, retain_last => 5)\").show()\r\nspark.sql(\"CALL catalog_name.system.remove_orphan_files(table => 'db_name.table_name')\").show()\r\n```\r\n\r\nBut running expire_snapshots action leads to a bigger issue of flink job not being able to resume from the checkpoint due to this https://github.com/apache/iceberg/issues/2482 \r\n\r\nError: `org.apache.iceberg.exceptions.ValidationException: Cannot determine history between starting snapshot null and current 7571686194699158451`\r\n\r\n@stevenzwu @rdblue Is there any plan to update expire-snapshot action implementation? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/895960999/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/896121910","html_url":"https://github.com/apache/iceberg/issues/2900#issuecomment-896121910","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2900","id":896121910,"node_id":"IC_kwDOCW7NX841abw2","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-10T15:33:53Z","updated_at":"2021-08-10T15:33:53Z","author_association":"CONTRIBUTOR","body":"@ayush-san, the problem is that expiring snapshots dropped snapshots that were needed to reconstruct the history of your table between the last checkpoint and the current state. Because Flink can't determine what changed between those two, it throws an error. There isn't anything wrong with the table or the snapshot expiration, it is just that you expired snapshots that you ended up needing to use.\r\n\r\nTo avoid the problem, I recommend keeping snapshots around for a longer period of time so that you don't expire snapshots that haven't been processed by your job yet.\r\n\r\nIt looks like you'd also benefit from compaction in the streaming job, which we've been discussing elsewhere. There have been a few ideas around this, but the one I like the best is a second set of writers that write larger files across checkpoints once the content has already been committed. When those files get large enough, they swap the small files for a large one.\r\n\r\nGetting back to the purpose of this issue, it looks like the problem was probably that there was too much metadata for each table. Regular maintenance is probably the right fix.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/896121910/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/896124921","html_url":"https://github.com/apache/iceberg/pull/2878#issuecomment-896124921","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2878","id":896124921,"node_id":"IC_kwDOCW7NX841acf5","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-10T16:05:04Z","updated_at":"2021-08-10T16:05:04Z","author_association":"CONTRIBUTOR","body":"I agree that the catalog should be `Closeable` and not `AutoCloseable`. We use `Closeable` in Iceberg rather than `AutoCloseable` and I don't see much benefit in making the APIs more confusing by introducing `AutoCloseable` too.\r\n\r\nI'm also not clear on the lifecycle of catalogs. Can you give me more context on when you'd close a catalog?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/896124921/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/896127530","html_url":"https://github.com/apache/iceberg/pull/2956#issuecomment-896127530","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2956","id":896127530,"node_id":"IC_kwDOCW7NX841adIq","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-10T16:24:05Z","updated_at":"2021-08-10T16:24:05Z","author_association":"CONTRIBUTOR","body":"Good news. Everything works correctly. I had an issue in another change that led me thinking we had a conflict but it was a misleading error message. My bad.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/896127530/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/896326936","html_url":"https://github.com/apache/iceberg/pull/2945#issuecomment-896326936","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2945","id":896326936,"node_id":"IC_kwDOCW7NX841bN0Y","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-10T21:27:42Z","updated_at":"2021-08-10T21:27:42Z","author_association":"CONTRIBUTOR","body":"@openinx, could you please take a look whenever you get a second? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/896326936/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/896486746","html_url":"https://github.com/apache/iceberg/issues/2900#issuecomment-896486746","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2900","id":896486746,"node_id":"IC_kwDOCW7NX841b01a","user":{"login":"ayush-san","id":57655135,"node_id":"MDQ6VXNlcjU3NjU1MTM1","avatar_url":"https://avatars.githubusercontent.com/u/57655135?v=4","gravatar_id":"","url":"https://api.github.com/users/ayush-san","html_url":"https://github.com/ayush-san","followers_url":"https://api.github.com/users/ayush-san/followers","following_url":"https://api.github.com/users/ayush-san/following{/other_user}","gists_url":"https://api.github.com/users/ayush-san/gists{/gist_id}","starred_url":"https://api.github.com/users/ayush-san/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ayush-san/subscriptions","organizations_url":"https://api.github.com/users/ayush-san/orgs","repos_url":"https://api.github.com/users/ayush-san/repos","events_url":"https://api.github.com/users/ayush-san/events{/privacy}","received_events_url":"https://api.github.com/users/ayush-san/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-11T04:15:01Z","updated_at":"2021-08-11T09:43:59Z","author_association":"NONE","body":"@rdblue Since the main issue here is that table metadata keeps on increasing in the streaming use case. Will only running `remove_orphan_files` keep the metadata directory in check as per my understanding it will not find any orphans files without expire_snapshot action? \r\n\r\nAlso, can you help me understand why does flink need to reconstruct the history of the table? Or please point me towards any design doc/ conversation thread that will me help understand flink-iceberg better? Since I have seen that during every checkpoint all tables reads through all metadata Avro files. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/896486746/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/896500936","html_url":"https://github.com/apache/iceberg/pull/2933#issuecomment-896500936","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2933","id":896500936,"node_id":"IC_kwDOCW7NX841b4TI","user":{"login":"mayursrivastava","id":8659624,"node_id":"MDQ6VXNlcjg2NTk2MjQ=","avatar_url":"https://avatars.githubusercontent.com/u/8659624?v=4","gravatar_id":"","url":"https://api.github.com/users/mayursrivastava","html_url":"https://github.com/mayursrivastava","followers_url":"https://api.github.com/users/mayursrivastava/followers","following_url":"https://api.github.com/users/mayursrivastava/following{/other_user}","gists_url":"https://api.github.com/users/mayursrivastava/gists{/gist_id}","starred_url":"https://api.github.com/users/mayursrivastava/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mayursrivastava/subscriptions","organizations_url":"https://api.github.com/users/mayursrivastava/orgs","repos_url":"https://api.github.com/users/mayursrivastava/repos","events_url":"https://api.github.com/users/mayursrivastava/events{/privacy}","received_events_url":"https://api.github.com/users/mayursrivastava/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-11T04:59:58Z","updated_at":"2021-08-11T04:59:58Z","author_association":"CONTRIBUTOR","body":"How can I trigger the Java CI that got canceled?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/896500936/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/896514498","html_url":"https://github.com/apache/iceberg/pull/2925#issuecomment-896514498","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2925","id":896514498,"node_id":"IC_kwDOCW7NX841b7nC","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-11T05:35:10Z","updated_at":"2021-08-11T05:35:10Z","author_association":"COLLABORATOR","body":"Updated, and also turned off serialzable isolation by default (can turn it on as well)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/896514498/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/896517819","html_url":"https://github.com/apache/iceberg/pull/2933#issuecomment-896517819","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2933","id":896517819,"node_id":"IC_kwDOCW7NX841b8a7","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-11T05:44:05Z","updated_at":"2021-08-11T05:44:05Z","author_association":"COLLABORATOR","body":"Not sure, but hacky way, can amend last commit with no change and force push","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/896517819/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/896548451","html_url":"https://github.com/apache/iceberg/issues/2751#issuecomment-896548451","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2751","id":896548451,"node_id":"IC_kwDOCW7NX841cD5j","user":{"login":"hankfanchiu","id":13294681,"node_id":"MDQ6VXNlcjEzMjk0Njgx","avatar_url":"https://avatars.githubusercontent.com/u/13294681?v=4","gravatar_id":"","url":"https://api.github.com/users/hankfanchiu","html_url":"https://github.com/hankfanchiu","followers_url":"https://api.github.com/users/hankfanchiu/followers","following_url":"https://api.github.com/users/hankfanchiu/following{/other_user}","gists_url":"https://api.github.com/users/hankfanchiu/gists{/gist_id}","starred_url":"https://api.github.com/users/hankfanchiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hankfanchiu/subscriptions","organizations_url":"https://api.github.com/users/hankfanchiu/orgs","repos_url":"https://api.github.com/users/hankfanchiu/repos","events_url":"https://api.github.com/users/hankfanchiu/events{/privacy}","received_events_url":"https://api.github.com/users/hankfanchiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-11T06:50:16Z","updated_at":"2021-08-11T06:50:16Z","author_association":"NONE","body":"> I would say that by the current state of the things we handle it as a case independent\r\n\r\n@pvary, given that the Hive MetaStore does not support case-insensitive filtering on a table's parameter, should I close my #2722, then?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/896548451/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/896762257","html_url":"https://github.com/apache/iceberg/issues/2482#issuecomment-896762257","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2482","id":896762257,"node_id":"IC_kwDOCW7NX841c4GR","user":{"login":"ayush-san","id":57655135,"node_id":"MDQ6VXNlcjU3NjU1MTM1","avatar_url":"https://avatars.githubusercontent.com/u/57655135?v=4","gravatar_id":"","url":"https://api.github.com/users/ayush-san","html_url":"https://github.com/ayush-san","followers_url":"https://api.github.com/users/ayush-san/followers","following_url":"https://api.github.com/users/ayush-san/following{/other_user}","gists_url":"https://api.github.com/users/ayush-san/gists{/gist_id}","starred_url":"https://api.github.com/users/ayush-san/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ayush-san/subscriptions","organizations_url":"https://api.github.com/users/ayush-san/orgs","repos_url":"https://api.github.com/users/ayush-san/repos","events_url":"https://api.github.com/users/ayush-san/events{/privacy}","received_events_url":"https://api.github.com/users/ayush-san/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-11T11:54:01Z","updated_at":"2021-08-11T11:58:02Z","author_association":"NONE","body":"> should stop to traverse the null snapshot even if it's a parent of others\r\n\r\n@openinx I think we should calculate the startingSnapshotId inside the [IcebergFilesCommitter](https://github.com/apache/iceberg/blob/master/flink/src/main/java/org/apache/iceberg/flink/sink/IcebergFilesCommitter.java). Since it does maintain checkpoint id and flink job id. We can add startingSnapshotId too in the summary. \r\n\r\n@rdblue What do you think? I think it might answer your [question](https://github.com/apache/iceberg/pull/2603/files#r652149167) too. Since the committer will update the startingSnapshotId from the summary and validation will only consider the table history from that point","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/896762257/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/896901564","html_url":"https://github.com/apache/iceberg/pull/2960#issuecomment-896901564","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2960","id":896901564,"node_id":"IC_kwDOCW7NX841daG8","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-11T15:00:00Z","updated_at":"2021-08-11T15:00:00Z","author_association":"MEMBER","body":"Solves #2895 \r\n\r\n#2895 is Caused by attempting to build a dynamic replace operation which contains no files. This is currently not allowed. We can either change this to a NOOP in Spark or allow it in Iceberg. This PR changes the operation to a NOOP in Spark.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/896901564/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/896902148","html_url":"https://github.com/apache/iceberg/pull/2960#issuecomment-896902148","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2960","id":896902148,"node_id":"IC_kwDOCW7NX841daQE","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-11T15:00:43Z","updated_at":"2021-08-11T15:00:43Z","author_association":"MEMBER","body":"@binhnv Could please review as well","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/896902148/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/896934206","html_url":"https://github.com/apache/iceberg/pull/2953#issuecomment-896934206","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2953","id":896934206,"node_id":"IC_kwDOCW7NX841diE-","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-11T15:40:27Z","updated_at":"2021-08-11T15:40:27Z","author_association":"MEMBER","body":"> > This in turn requires fixing the alternate PruneColumn methods for Avro\r\n> > and Parquet to respect that they will now have selected field ID's for non\r\n> > primitive nodes.\r\n> \r\n> Do you know if anything needs to be done for ORC @RussellSpitzer? I'm helping out with ORC more going forward and if you're aware of anything that needs to be updated there, if you don't have time to update it, if you make an issue I'll see if I can grab it (or at the least we'll have the issue to track).\r\n> \r\n> If you're not sure then possibly you can add a unit test for ORC as well? If it fails, open an issue (or I will) and then we can follow up on it after. =)\r\n\r\nI don't think so, we don't have any custom ORC projection code as far as I can tell. It just uses the output of a TypeUtil.selectNot() \r\n\r\nhttps://github.com/apache/iceberg/blob/68091037944ff7e9de91e7b619f313a8e98c1adc/spark/src/main/java/org/apache/iceberg/spark/source/RowDataReader.java#L158-L159\r\n\r\nagainst the ORC schema to determine what to read and then uses that directly here : \r\n\r\nhttps://github.com/apache/iceberg/blob/970e8aac60081c7d286ab0f7e12e428b3309dd34/orc/src/main/java/org/apache/iceberg/orc/ORC.java#L315-L319\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/896934206/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/896938862","html_url":"https://github.com/apache/iceberg/issues/2482#issuecomment-896938862","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2482","id":896938862,"node_id":"IC_kwDOCW7NX841djNu","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-11T15:46:03Z","updated_at":"2021-08-11T15:46:03Z","author_association":"CONTRIBUTOR","body":"@ayush-san, I don't think I understand what you're suggesting.\r\n\r\nThe PR was trying to support a narrow case where history is no longer available, but you don't actually need history because the starting snapshot is null. That's not all that useful because you probably have a non-null starting snapshot ID.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/896938862/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/896986169","html_url":"https://github.com/apache/iceberg/issues/2482#issuecomment-896986169","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2482","id":896986169,"node_id":"IC_kwDOCW7NX841duw5","user":{"login":"ayush-san","id":57655135,"node_id":"MDQ6VXNlcjU3NjU1MTM1","avatar_url":"https://avatars.githubusercontent.com/u/57655135?v=4","gravatar_id":"","url":"https://api.github.com/users/ayush-san","html_url":"https://github.com/ayush-san","followers_url":"https://api.github.com/users/ayush-san/followers","following_url":"https://api.github.com/users/ayush-san/following{/other_user}","gists_url":"https://api.github.com/users/ayush-san/gists{/gist_id}","starred_url":"https://api.github.com/users/ayush-san/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ayush-san/subscriptions","organizations_url":"https://api.github.com/users/ayush-san/orgs","repos_url":"https://api.github.com/users/ayush-san/repos","events_url":"https://api.github.com/users/ayush-san/events{/privacy}","received_events_url":"https://api.github.com/users/ayush-san/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-11T16:49:10Z","updated_at":"2021-08-11T16:49:10Z","author_association":"NONE","body":"@rdblue The PR was trying to handle the case when the validation try to build history from the initial snapshot but that snapshot doesn't exist because of the expire-snapshot action\r\n\r\nHere, I am suggesting that we add the last snapshot id in the snapshot summary of expire-snapshot action and use that to set  startingSnapshotId so that validation will only consider the table history from that point.\r\n\r\nWe do something similar in [IcebergFilesCommitter](https://github.com/apache/iceberg/blob/master/flink/src/main/java/org/apache/iceberg/flink/sink/IcebergFilesCommitter.java) as we store the flink job id and checkpoint id in snapshot summary. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/896986169/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/897017924","html_url":"https://github.com/apache/iceberg/issues/2482#issuecomment-897017924","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2482","id":897017924,"node_id":"IC_kwDOCW7NX841d2hE","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-11T17:35:31Z","updated_at":"2021-08-11T17:35:31Z","author_association":"CONTRIBUTOR","body":"@ayush-san, let me make sure I understand. Say a table has snapshots 1, 2, 3, 4, and 5, and that there is a Flink streaming process that has consumed through snapshot 2. Then, someone expires snapshots and removes 1, 2, and 3 so the table only has snapshots 4 and 5. The validation that is failing looks at 5, then 4, then sees that there is no snapshot 3. Because it can't provide the rows appended in 3, it fails.\r\n\r\nIt sounds like you're suggesting that we could keep track of the oldest snapshot in the table and use that for startingSnapshotId. So instead of the Flink job starting from snapshot 2 and reading snapshots 3, 4, and 5, it would start from snapshot 3 and read only 4 and 5. The problem is that this automatically skips rows from snapshot 3, which isn't correct.\r\n\r\nIt also sounds like you're suggesting that we annotate a snapshot, which I don't think would be necessary because we could always traverse parents from the current table state and only process the snapshots that are available.\r\n\r\nWhat the committer is doing is different. The committer keeps the checkpoint ID in the snapshot summary so that it can check whether a given checkpoint has been committed to the table already. That makes commits exactly-once when the snapshot history is longer than the time the application was unable to commit.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/897017924/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/897061722","html_url":"https://github.com/apache/iceberg/pull/2960#issuecomment-897061722","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2960","id":897061722,"node_id":"IC_kwDOCW7NX841eBNa","user":{"login":"binhnv","id":1392955,"node_id":"MDQ6VXNlcjEzOTI5NTU=","avatar_url":"https://avatars.githubusercontent.com/u/1392955?v=4","gravatar_id":"","url":"https://api.github.com/users/binhnv","html_url":"https://github.com/binhnv","followers_url":"https://api.github.com/users/binhnv/followers","following_url":"https://api.github.com/users/binhnv/following{/other_user}","gists_url":"https://api.github.com/users/binhnv/gists{/gist_id}","starred_url":"https://api.github.com/users/binhnv/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/binhnv/subscriptions","organizations_url":"https://api.github.com/users/binhnv/orgs","repos_url":"https://api.github.com/users/binhnv/repos","events_url":"https://api.github.com/users/binhnv/events{/privacy}","received_events_url":"https://api.github.com/users/binhnv/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-11T18:41:02Z","updated_at":"2021-08-11T18:41:02Z","author_association":"NONE","body":"Thank you for fixing this. The change looks good to me and it is also consistent with Hive's behavior.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/897061722/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/897094553","html_url":"https://github.com/apache/iceberg/pull/2960#issuecomment-897094553","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2960","id":897094553,"node_id":"IC_kwDOCW7NX841eJOZ","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-11T19:31:47Z","updated_at":"2021-08-11T19:31:47Z","author_association":"MEMBER","body":"Thanks @rdblue + @binhnv for reviews! Will merge","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/897094553/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/897232258","html_url":"https://github.com/apache/iceberg/issues/2962#issuecomment-897232258","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2962","id":897232258,"node_id":"IC_kwDOCW7NX841eq2C","user":{"login":"prodeezy","id":1474591,"node_id":"MDQ6VXNlcjE0NzQ1OTE=","avatar_url":"https://avatars.githubusercontent.com/u/1474591?v=4","gravatar_id":"","url":"https://api.github.com/users/prodeezy","html_url":"https://github.com/prodeezy","followers_url":"https://api.github.com/users/prodeezy/followers","following_url":"https://api.github.com/users/prodeezy/following{/other_user}","gists_url":"https://api.github.com/users/prodeezy/gists{/gist_id}","starred_url":"https://api.github.com/users/prodeezy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/prodeezy/subscriptions","organizations_url":"https://api.github.com/users/prodeezy/orgs","repos_url":"https://api.github.com/users/prodeezy/repos","events_url":"https://api.github.com/users/prodeezy/events{/privacy}","received_events_url":"https://api.github.com/users/prodeezy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-11T23:41:17Z","updated_at":"2021-08-11T23:42:11Z","author_association":"CONTRIBUTOR","body":"Currently we had to recompile rebased iceberg with parquet 1.11.0 and it started working again. There seems to be a regression in 1.11.0. Will create a gist to repro this issue. Wondering if others are facing this as well. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/897232258/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/897243149","html_url":"https://github.com/apache/iceberg/issues/2962#issuecomment-897243149","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2962","id":897243149,"node_id":"IC_kwDOCW7NX841etgN","user":{"login":"prodeezy","id":1474591,"node_id":"MDQ6VXNlcjE0NzQ1OTE=","avatar_url":"https://avatars.githubusercontent.com/u/1474591?v=4","gravatar_id":"","url":"https://api.github.com/users/prodeezy","html_url":"https://github.com/prodeezy","followers_url":"https://api.github.com/users/prodeezy/followers","following_url":"https://api.github.com/users/prodeezy/following{/other_user}","gists_url":"https://api.github.com/users/prodeezy/gists{/gist_id}","starred_url":"https://api.github.com/users/prodeezy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/prodeezy/subscriptions","organizations_url":"https://api.github.com/users/prodeezy/orgs","repos_url":"https://api.github.com/users/prodeezy/repos","events_url":"https://api.github.com/users/prodeezy/events{/privacy}","received_events_url":"https://api.github.com/users/prodeezy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-12T00:08:41Z","updated_at":"2021-08-12T00:08:41Z","author_association":"CONTRIBUTOR","body":"changes in 1.11.1 since 1.11.0 \r\n\r\nhttps://github.com/apache/parquet-mr/blob/apache-parquet-1.11.1/CHANGES.md","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/897243149/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/897257645","html_url":"https://github.com/apache/iceberg/pull/2845#issuecomment-897257645","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2845","id":897257645,"node_id":"IC_kwDOCW7NX841exCt","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-12T00:36:39Z","updated_at":"2021-08-12T00:36:39Z","author_association":"CONTRIBUTOR","body":"@jackye1995 has there been any further discussion on this?\r\n\r\nI was also going to open a PR to allow for a default location, as many users create many tables and don't want to configure a location per table (e.g. they want a warehouse-like location, but with object storage randomness in the path).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/897257645/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/897264794","html_url":"https://github.com/apache/iceberg/issues/2962#issuecomment-897264794","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2962","id":897264794,"node_id":"IC_kwDOCW7NX841eyya","user":{"login":"julienledem","id":367841,"node_id":"MDQ6VXNlcjM2Nzg0MQ==","avatar_url":"https://avatars.githubusercontent.com/u/367841?v=4","gravatar_id":"","url":"https://api.github.com/users/julienledem","html_url":"https://github.com/julienledem","followers_url":"https://api.github.com/users/julienledem/followers","following_url":"https://api.github.com/users/julienledem/following{/other_user}","gists_url":"https://api.github.com/users/julienledem/gists{/gist_id}","starred_url":"https://api.github.com/users/julienledem/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/julienledem/subscriptions","organizations_url":"https://api.github.com/users/julienledem/orgs","repos_url":"https://api.github.com/users/julienledem/repos","events_url":"https://api.github.com/users/julienledem/events{/privacy}","received_events_url":"https://api.github.com/users/julienledem/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-12T00:58:18Z","updated_at":"2021-08-12T00:58:18Z","author_association":"MEMBER","body":"I don't have much insight in this change but this looks suspicious:\r\nhttps://github.com/apache/parquet-mr/commit/32e9578894506df07d65bbeb012a44ec7746ddcb\r\nFrom: \r\nhttps://github.com/apache/parquet-mr/compare/apache-parquet-1.11.0...apache-parquet-1.11.1\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/897264794/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/897338009","html_url":"https://github.com/apache/iceberg/issues/2482#issuecomment-897338009","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2482","id":897338009,"node_id":"IC_kwDOCW7NX841fEqZ","user":{"login":"ayush-san","id":57655135,"node_id":"MDQ6VXNlcjU3NjU1MTM1","avatar_url":"https://avatars.githubusercontent.com/u/57655135?v=4","gravatar_id":"","url":"https://api.github.com/users/ayush-san","html_url":"https://github.com/ayush-san","followers_url":"https://api.github.com/users/ayush-san/followers","following_url":"https://api.github.com/users/ayush-san/following{/other_user}","gists_url":"https://api.github.com/users/ayush-san/gists{/gist_id}","starred_url":"https://api.github.com/users/ayush-san/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ayush-san/subscriptions","organizations_url":"https://api.github.com/users/ayush-san/orgs","repos_url":"https://api.github.com/users/ayush-san/repos","events_url":"https://api.github.com/users/ayush-san/events{/privacy}","received_events_url":"https://api.github.com/users/ayush-san/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-12T04:22:06Z","updated_at":"2021-08-12T04:22:06Z","author_association":"NONE","body":"> It sounds like you're suggesting that we could keep track of the oldest snapshot in the table and use that for startingSnapshotId. So instead of the Flink job starting from snapshot 2 and reading snapshots 3, 4, and 5, it would start from snapshot 3 and read only 4 and 5. The problem is that this automatically skips rows from snapshot 3, which isn't correct.\r\n\r\n@rdblue So what should be the ideal way around this? Since running regular maintenance procedures(Compaction, expire-snapshots, deleting orphans files, etc) are really important for streaming pipelines as they will keep metadata size in check. But currently, we cannot run expire snapshots as the flink validation will fail. \r\n\r\nMy logic for annotating a snapshot was that any reader/writer will know that the table doesn't contain all the snapshots, so they can update their execution according to that. Yes, we can always traverse parents from the current table state and only process the snapshots that are available but shouldn't an action that alters the table metadata should be the one providing this information? \r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/897338009/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/897447138","html_url":"https://github.com/apache/iceberg/pull/2950#issuecomment-897447138","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2950","id":897447138,"node_id":"IC_kwDOCW7NX841ffTi","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-12T08:26:45Z","updated_at":"2021-08-12T08:29:03Z","author_association":"COLLABORATOR","body":"Yea I personally prefer Metastore as well due to Hive docs, I would guess the camel case comes originally from the Hive code itself (HiveMetaStore and HiveMetaStoreClient being the main classes..), so I didnt see the original casing as a problem.  \r\n\r\nAnyway, removed camel case.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/897447138/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/897527833","html_url":"https://github.com/apache/iceberg/issues/2958#issuecomment-897527833","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2958","id":897527833,"node_id":"IC_kwDOCW7NX841fzAZ","user":{"login":"coolderli","id":38486782,"node_id":"MDQ6VXNlcjM4NDg2Nzgy","avatar_url":"https://avatars.githubusercontent.com/u/38486782?v=4","gravatar_id":"","url":"https://api.github.com/users/coolderli","html_url":"https://github.com/coolderli","followers_url":"https://api.github.com/users/coolderli/followers","following_url":"https://api.github.com/users/coolderli/following{/other_user}","gists_url":"https://api.github.com/users/coolderli/gists{/gist_id}","starred_url":"https://api.github.com/users/coolderli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coolderli/subscriptions","organizations_url":"https://api.github.com/users/coolderli/orgs","repos_url":"https://api.github.com/users/coolderli/repos","events_url":"https://api.github.com/users/coolderli/events{/privacy}","received_events_url":"https://api.github.com/users/coolderli/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-12T10:32:15Z","updated_at":"2021-08-12T10:32:15Z","author_association":"CONTRIBUTOR","body":"I have already meet this problem, here is my stack:\r\n```\r\n2021-05-14,12:52:40,185 WARN org.apache.iceberg.io.PartitionedWriter: Duplicate key: [11] == [11]\r\n2021-05-14,12:52:40,185 ERROR org.apache.spark.util.Utils: Aborting task\r\njava.lang.IllegalStateException: Already closed files for partition: id_bucket=11\r\n```\r\n\r\nI solve it by set `alter table xxx set TBLPROPERTIES ('write.spark.fanout.enabled'='true');`","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/897527833/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/897529761","html_url":"https://github.com/apache/iceberg/issues/2946#issuecomment-897529761","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2946","id":897529761,"node_id":"IC_kwDOCW7NX841fzeh","user":{"login":"coolderli","id":38486782,"node_id":"MDQ6VXNlcjM4NDg2Nzgy","avatar_url":"https://avatars.githubusercontent.com/u/38486782?v=4","gravatar_id":"","url":"https://api.github.com/users/coolderli","html_url":"https://github.com/coolderli","followers_url":"https://api.github.com/users/coolderli/followers","following_url":"https://api.github.com/users/coolderli/following{/other_user}","gists_url":"https://api.github.com/users/coolderli/gists{/gist_id}","starred_url":"https://api.github.com/users/coolderli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coolderli/subscriptions","organizations_url":"https://api.github.com/users/coolderli/orgs","repos_url":"https://api.github.com/users/coolderli/repos","events_url":"https://api.github.com/users/coolderli/events{/privacy}","received_events_url":"https://api.github.com/users/coolderli/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-12T10:35:41Z","updated_at":"2021-08-12T10:35:41Z","author_association":"CONTRIBUTOR","body":"Found the answer. I think the `streaming` represent if the source is bounded. Maybe it should be replaced by `unbounded`.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/897529761/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/897531168","html_url":"https://github.com/apache/iceberg/issues/2959#issuecomment-897531168","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2959","id":897531168,"node_id":"IC_kwDOCW7NX841fz0g","user":{"login":"coolderli","id":38486782,"node_id":"MDQ6VXNlcjM4NDg2Nzgy","avatar_url":"https://avatars.githubusercontent.com/u/38486782?v=4","gravatar_id":"","url":"https://api.github.com/users/coolderli","html_url":"https://github.com/coolderli","followers_url":"https://api.github.com/users/coolderli/followers","following_url":"https://api.github.com/users/coolderli/following{/other_user}","gists_url":"https://api.github.com/users/coolderli/gists{/gist_id}","starred_url":"https://api.github.com/users/coolderli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coolderli/subscriptions","organizations_url":"https://api.github.com/users/coolderli/orgs","repos_url":"https://api.github.com/users/coolderli/repos","events_url":"https://api.github.com/users/coolderli/events{/privacy}","received_events_url":"https://api.github.com/users/coolderli/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-12T10:38:08Z","updated_at":"2021-08-12T10:38:08Z","author_association":"CONTRIBUTOR","body":"这里有个[issue](https://github.com/apache/iceberg/pull/2629) 记录了这个问题","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/897531168/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/897532755","html_url":"https://github.com/apache/iceberg/issues/2947#issuecomment-897532755","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2947","id":897532755,"node_id":"IC_kwDOCW7NX841f0NT","user":{"login":"coolderli","id":38486782,"node_id":"MDQ6VXNlcjM4NDg2Nzgy","avatar_url":"https://avatars.githubusercontent.com/u/38486782?v=4","gravatar_id":"","url":"https://api.github.com/users/coolderli","html_url":"https://github.com/coolderli","followers_url":"https://api.github.com/users/coolderli/followers","following_url":"https://api.github.com/users/coolderli/following{/other_user}","gists_url":"https://api.github.com/users/coolderli/gists{/gist_id}","starred_url":"https://api.github.com/users/coolderli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coolderli/subscriptions","organizations_url":"https://api.github.com/users/coolderli/orgs","repos_url":"https://api.github.com/users/coolderli/repos","events_url":"https://api.github.com/users/coolderli/events{/privacy}","received_events_url":"https://api.github.com/users/coolderli/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-12T10:40:52Z","updated_at":"2021-08-12T10:40:52Z","author_association":"CONTRIBUTOR","body":"Thanks. I'll check it out.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/897532755/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/897545328","html_url":"https://github.com/apache/iceberg/pull/2890#issuecomment-897545328","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2890","id":897545328,"node_id":"IC_kwDOCW7NX841f3Rw","user":{"login":"ConeyLiu","id":12733256,"node_id":"MDQ6VXNlcjEyNzMzMjU2","avatar_url":"https://avatars.githubusercontent.com/u/12733256?v=4","gravatar_id":"","url":"https://api.github.com/users/ConeyLiu","html_url":"https://github.com/ConeyLiu","followers_url":"https://api.github.com/users/ConeyLiu/followers","following_url":"https://api.github.com/users/ConeyLiu/following{/other_user}","gists_url":"https://api.github.com/users/ConeyLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/ConeyLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ConeyLiu/subscriptions","organizations_url":"https://api.github.com/users/ConeyLiu/orgs","repos_url":"https://api.github.com/users/ConeyLiu/repos","events_url":"https://api.github.com/users/ConeyLiu/events{/privacy}","received_events_url":"https://api.github.com/users/ConeyLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-12T11:02:52Z","updated_at":"2021-08-12T11:02:52Z","author_association":"CONTRIBUTOR","body":"Hi @aokolnychyi, could you help to review this? Thanks a lot.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/897545328/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/897579847","html_url":"https://github.com/apache/iceberg/issues/2861#issuecomment-897579847","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2861","id":897579847,"node_id":"IC_kwDOCW7NX841f_tH","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-12T11:58:32Z","updated_at":"2021-08-12T11:58:32Z","author_association":"CONTRIBUTOR","body":"I think we can convert it to a scala stream by adding a decorator in the org.apache.iceberg.flink package, using the implicit conversion of scala. I can try to do it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/897579847/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/897706224","html_url":"https://github.com/apache/iceberg/issues/2468#issuecomment-897706224","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2468","id":897706224,"node_id":"IC_kwDOCW7NX841gejw","user":{"login":"caneGuy","id":26762018,"node_id":"MDQ6VXNlcjI2NzYyMDE4","avatar_url":"https://avatars.githubusercontent.com/u/26762018?v=4","gravatar_id":"","url":"https://api.github.com/users/caneGuy","html_url":"https://github.com/caneGuy","followers_url":"https://api.github.com/users/caneGuy/followers","following_url":"https://api.github.com/users/caneGuy/following{/other_user}","gists_url":"https://api.github.com/users/caneGuy/gists{/gist_id}","starred_url":"https://api.github.com/users/caneGuy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/caneGuy/subscriptions","organizations_url":"https://api.github.com/users/caneGuy/orgs","repos_url":"https://api.github.com/users/caneGuy/repos","events_url":"https://api.github.com/users/caneGuy/events{/privacy}","received_events_url":"https://api.github.com/users/caneGuy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-12T14:51:58Z","updated_at":"2021-08-12T15:08:57Z","author_association":"CONTRIBUTOR","body":"This may be caused by:\r\n```\r\ntry {\r\n        ctor = DynConstructors.builder(Catalog.class).impl(impl).buildChecked();\r\n      } catch (NoSuchMethodException e) {\r\n        throw new IllegalArgumentException(String.format(\r\n                \"Cannot initialize Catalog implementation %s: %s\", impl, e.getMessage()), e);\r\n      }\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/897706224/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/897718055","html_url":"https://github.com/apache/iceberg/issues/2468#issuecomment-897718055","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2468","id":897718055,"node_id":"IC_kwDOCW7NX841ghcn","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-12T15:06:35Z","updated_at":"2021-08-12T15:06:35Z","author_association":"MEMBER","body":"That does sound a lot like the runtime classpath has multiple implementations of HiveCatalog or HadoopCatalog. Are you sure that there aren't multiple iceberg-flink runtime jars?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/897718055/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/897834916","html_url":"https://github.com/apache/iceberg/pull/2961#issuecomment-897834916","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2961","id":897834916,"node_id":"IC_kwDOCW7NX841g9-k","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-12T17:43:00Z","updated_at":"2021-08-12T17:43:00Z","author_association":"CONTRIBUTOR","body":"@szehon-ho @RussellSpitzer \r\n\r\nThanks for the timely review! \r\n\r\nAround the documentation, because this will technically be v3 change, we need to add one more column for all tables in the spec doc, I will update that later.\r\n\r\nFor the update snapshot changes like `replaceCurrentSnapshot`, `addStagedSnashot`, I am not updating those in this PR and trying to only consolidate on the changes to the spec.\r\n\r\nOne potential alternative that I would like to just present is to directly have a `Map<String, Long>` snapshot tags map in the `TableMetadata` spec. The advantages are:\r\n1.  we do not need to build the index which is beneficial when there are many snapshots in the table.\r\n2. updates to the tag only updates the tag map itself and do not need to rewrite the snapshot information.\r\n\r\nThe disadvantages are:\r\n1. we prefer to update individual components in the spec if possible instead of adding more top-level fields in the table metadata spec. This was the principle we followed when adding row identifier in schema instead of table metadata.\r\n2. not as easy to update the snapshots system table to add the tags field\r\n3. the index is already built anyway for snapshot id mapping, so the marginal cost for indexing tags is not too bad\r\n4. changes like snapshot expiration needs to also update the tags information\r\n\r\nBased on these considerations I think adding the tags directly in the snapshot spec sounds more reasonable to me. Please let me know if anyone thinks otherwise or has any better approaches.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/897834916/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/897879632","html_url":"https://github.com/apache/iceberg/pull/2963#issuecomment-897879632","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2963","id":897879632,"node_id":"IC_kwDOCW7NX841hI5Q","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-12T18:40:15Z","updated_at":"2021-08-12T18:40:15Z","author_association":"CONTRIBUTOR","body":"Thanks for rewording this and provide more clarification!\r\n\r\nThere is an ongoing PR #2845 to finalize the exact way that `ObjectStorageLocationProvider` resolves the root path. Let's wait for that to finalize and then update accordingly before merging this change.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/897879632/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/897900861","html_url":"https://github.com/apache/iceberg/pull/2845#issuecomment-897900861","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2845","id":897900861,"node_id":"IC_kwDOCW7NX841hOE9","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-12T19:14:32Z","updated_at":"2021-08-12T19:14:32Z","author_association":"CONTRIBUTOR","body":"@kbendick thanks for the approval. We discussed offline, and I think the use cases that we are trying to achieve require this fallback strategy.\r\n\r\nUse case 1: user creates table and want to use `ObjectStorageLocationProvider` with the default table path. Currently this will throw a NPE because it requires `write.object-storage.path` to be set. But the user might not really know what is the root path of the table, and we should not break this abstraction. So a fallback to the default table root path should be desirable.\r\n\r\nUse case 2: user has an existing table with `write.folder-storage.path` set, and would like to enable object storage mode by updating the table property. With change to use case 1, this will directly fallback to the default table location instead of the folder storage path, but the correct behavior is for the Iceberg table to respect the `write.folder-storage.path` and use it as the root.\r\n\r\nSo the 2 levels of fallback is required. I will go merge the PR, thanks for all the discussion.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/897900861/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/897968033","html_url":"https://github.com/apache/iceberg/pull/2963#issuecomment-897968033","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2963","id":897968033,"node_id":"IC_kwDOCW7NX841heeh","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-12T21:06:42Z","updated_at":"2021-08-12T21:06:42Z","author_association":"CONTRIBUTOR","body":"@cobookman the PR referenced is merged, could you update the documentation with the correct path resolution strategy? Thank you!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/897968033/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/897972554","html_url":"https://github.com/apache/iceberg/issues/2958#issuecomment-897972554","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2958","id":897972554,"node_id":"IC_kwDOCW7NX841hflK","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-12T21:14:23Z","updated_at":"2021-08-12T21:14:23Z","author_association":"CONTRIBUTOR","body":"```\r\nCaused by: java.lang.IllegalStateException: Already closed files for partition: id_bucket=3\r\n\tat org.apache.iceberg.io.PartitionedWriter.write(PartitionedWriter.java:69)\r\n\tat org.apache.spark.sql.execution.datasources.v2.DataWritingSparkTask$.$anonfun$run$7(WriteToDataSourceV2Exec.scala:441)\r\n\tat org.apache.spark.util.Utils$.tryWithSafeFinallyAndFailureCallbacks(Utils.scala:1411)\r\n\tat org.apache.spark.sql.execution.datasources.v2.DataWritingSparkTask$.run(WriteToDataSourceV2Exec.scala:477)\r\n\tat org.apache.spark.sql.execution.datasources.v2.V2TableWriteExec.$anonfun$writeWithV2$2(WriteToDataSourceV2Exec.scala:385)\r\n\tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:90)\r\n\tat org.apache.spark.scheduler.Task.run(Task.scala:127)\r\n\tat org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$3(Executor.scala:446)\r\n\tat org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1377)\r\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:449)\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n\tat java.lang.Thread.run(Thread.java:748)\r\n```\r\n\r\n看你上传的报错，@coolderli 的方法应该是对的，需要使用fanout writer。因为在使用bucket函数的情况下通常你无法对数据进行提前预判排序，所以不使用fanout writer必然会出现这个问题。理论上你也可以提前计算出每一行是哪个bucket然后以此进行排序再写入，这样就不需要fanout，但是就比较麻烦。","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/897972554/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/898044204","html_url":"https://github.com/apache/iceberg/issues/2959#issuecomment-898044204","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2959","id":898044204,"node_id":"IC_kwDOCW7NX841hxEs","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-12T23:41:35Z","updated_at":"2021-08-12T23:41:35Z","author_association":"CONTRIBUTOR","body":"close issue for duplication.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/898044204/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/898091999","html_url":"https://github.com/apache/iceberg/issues/2962#issuecomment-898091999","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2962","id":898091999,"node_id":"IC_kwDOCW7NX841h8vf","user":{"login":"prodeezy","id":1474591,"node_id":"MDQ6VXNlcjE0NzQ1OTE=","avatar_url":"https://avatars.githubusercontent.com/u/1474591?v=4","gravatar_id":"","url":"https://api.github.com/users/prodeezy","html_url":"https://github.com/prodeezy","followers_url":"https://api.github.com/users/prodeezy/followers","following_url":"https://api.github.com/users/prodeezy/following{/other_user}","gists_url":"https://api.github.com/users/prodeezy/gists{/gist_id}","starred_url":"https://api.github.com/users/prodeezy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/prodeezy/subscriptions","organizations_url":"https://api.github.com/users/prodeezy/orgs","repos_url":"https://api.github.com/users/prodeezy/repos","events_url":"https://api.github.com/users/prodeezy/events{/privacy}","received_events_url":"https://api.github.com/users/prodeezy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-13T01:32:13Z","updated_at":"2021-08-13T01:32:13Z","author_association":"CONTRIBUTOR","body":"Sample data written using Iceberg v0.9.0 (with parquet 1.11.0) : https://drive.google.com/drive/folders/1GckUAYZpOYJQtkTFtavKzpqxKzXkCbqy?usp=sharing\r\n\r\nFails when reading using code from tag: apache-iceberg-0.10.0\r\n\r\n```\r\nspark-shell --jars spark-runtime/build/libs/iceberg-spark-runtime-0.10.0.jar\r\n\r\n > spark.read.format(\"iceberg\").load(\"iceberg_issue_2962_parquet_1_11_0\").show(false)\r\n\r\n[Stage 0:>   (0 + 1) / 1]2021-08-12 17:58:28 ERROR Executor:91 - Exception in task 0.0 in stage 0.0 (TID 0)\r\njava.lang.IllegalArgumentException: [segmentMembership, map, key] required binary key (STRING) = 2 is not in the store: [] 8\r\n```\r\n\r\n\r\nIf i switch to parquet 1.11.0 and rebuild, it starts reading just fine.\r\n```\r\nscala> spark.read.format(\"iceberg\").load(\"/tools/iceberg_issue_2962_parquet_1_11_0\").show(false)\r\n+------------------------------------------------------------------------------------------------+\r\n|segmentMembership                                                                               |\r\n+------------------------------------------------------------------------------------------------+\r\n|[AEPSegmentMatch -> []]                                                                         |\r\n|[AEPSegmentMatch -> []]                                                                         |\r\n|[AEPSegmentMatch -> []]                                                                         |\r\n|[AEPSegmentMatch -> []]                                                                         |\r\n|[AEPSegmentMatch -> [cea3dda5-5604-4548-a031-148867e425b5 -> [, existing, 2021-04-28 03:34:36]]]|\r\n|[AEPSegmentMatch -> [cea3dda5-5604-4548-a031-148867e425b5 -> [, existing, 2021-04-28 03:34:36]]]|\r\n|[AEPSegmentMatch -> [cea3dda5-5604-4548-a031-148867e425b5 -> [, existing, 2021-04-28 03:34:37]]]|\r\n|[AEPSegmentMatch -> [cea3dda5-5604-4548-a031-148867e425b5 -> [, existing, 2021-04-28 03:34:37]]]|\r\n+------------------------------------------------------------------------------------------------+\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/898091999/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/898145724","html_url":"https://github.com/apache/iceberg/pull/2847#issuecomment-898145724","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2847","id":898145724,"node_id":"IC_kwDOCW7NX841iJ28","user":{"login":"mechgouki","id":8364215,"node_id":"MDQ6VXNlcjgzNjQyMTU=","avatar_url":"https://avatars.githubusercontent.com/u/8364215?v=4","gravatar_id":"","url":"https://api.github.com/users/mechgouki","html_url":"https://github.com/mechgouki","followers_url":"https://api.github.com/users/mechgouki/followers","following_url":"https://api.github.com/users/mechgouki/following{/other_user}","gists_url":"https://api.github.com/users/mechgouki/gists{/gist_id}","starred_url":"https://api.github.com/users/mechgouki/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mechgouki/subscriptions","organizations_url":"https://api.github.com/users/mechgouki/orgs","repos_url":"https://api.github.com/users/mechgouki/repos","events_url":"https://api.github.com/users/mechgouki/events{/privacy}","received_events_url":"https://api.github.com/users/mechgouki/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-13T02:57:58Z","updated_at":"2021-09-01T08:13:36Z","author_association":"NONE","body":"@kbendick @rdblue \r\nWe would like to hear the suggestion whether we should wait for this the first new PR(1 of 3) pass the review and then start to post the rest ?\r\nOr\r\nShould we just go ahead to post the rest 2 PRs now?\r\n \r\n @openinx ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/898145724/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/898161450","html_url":"https://github.com/apache/iceberg/pull/2867#issuecomment-898161450","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2867","id":898161450,"node_id":"IC_kwDOCW7NX841iNsq","user":{"login":"hameizi","id":18445460,"node_id":"MDQ6VXNlcjE4NDQ1NDYw","avatar_url":"https://avatars.githubusercontent.com/u/18445460?v=4","gravatar_id":"","url":"https://api.github.com/users/hameizi","html_url":"https://github.com/hameizi","followers_url":"https://api.github.com/users/hameizi/followers","following_url":"https://api.github.com/users/hameizi/following{/other_user}","gists_url":"https://api.github.com/users/hameizi/gists{/gist_id}","starred_url":"https://api.github.com/users/hameizi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hameizi/subscriptions","organizations_url":"https://api.github.com/users/hameizi/orgs","repos_url":"https://api.github.com/users/hameizi/repos","events_url":"https://api.github.com/users/hameizi/events{/privacy}","received_events_url":"https://api.github.com/users/hameizi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-13T03:23:00Z","updated_at":"2021-08-13T07:06:50Z","author_association":"CONTRIBUTOR","body":"> > @hameizi can you try some setup like this for the stress testing with your auto compaction change here?\r\n> > \r\n> > * a simple job just read data from Kafka and writes to Iceberg (e.g. partitioned by ingestion/processing time).\r\n> > * writer: parallelism of 10 (higher can be better)\r\n> > * I would expect each of the 10 writer tasks probably can write data in the order of MBs/sec.\r\n> \r\n> I'm sorry that maybe my test can't up to the standard as you say. I can test one more later.\r\n\r\n@stevenzwu I test one case, parallelism of 10, 30000+ records/sec(max 60000+/sec), partition by hour, 3GB memory of per taskmanager. It's no problem for me.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/898161450/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/898174231","html_url":"https://github.com/apache/iceberg/issues/2958#issuecomment-898174231","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2958","id":898174231,"node_id":"IC_kwDOCW7NX841iQ0X","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-13T04:01:04Z","updated_at":"2021-08-13T04:01:04Z","author_association":"CONTRIBUTOR","body":"@zephaniah-wzf 可以发一下具体的堆栈吗","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/898174231/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/898187675","html_url":"https://github.com/apache/iceberg/pull/2963#issuecomment-898187675","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2963","id":898187675,"node_id":"IC_kwDOCW7NX841iUGb","user":{"login":"cobookman","id":1738983,"node_id":"MDQ6VXNlcjE3Mzg5ODM=","avatar_url":"https://avatars.githubusercontent.com/u/1738983?v=4","gravatar_id":"","url":"https://api.github.com/users/cobookman","html_url":"https://github.com/cobookman","followers_url":"https://api.github.com/users/cobookman/followers","following_url":"https://api.github.com/users/cobookman/following{/other_user}","gists_url":"https://api.github.com/users/cobookman/gists{/gist_id}","starred_url":"https://api.github.com/users/cobookman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cobookman/subscriptions","organizations_url":"https://api.github.com/users/cobookman/orgs","repos_url":"https://api.github.com/users/cobookman/repos","events_url":"https://api.github.com/users/cobookman/events{/privacy}","received_events_url":"https://api.github.com/users/cobookman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-13T04:44:04Z","updated_at":"2021-08-13T05:01:44Z","author_association":"CONTRIBUTOR","body":"> @cobookman the PR referenced is merged, could you update the documentation with the correct path resolution strategy? Thank you!\r\n\r\nHappy to, just want to understand what the expected write behaviour is for folder-storage & s3. Having the following fail on my end.\r\n```\r\nCREATE TABLE my_catalog.my_ns.my_table (\r\n    id bigint,\r\n    data string,\r\n    category string)\r\nUSING iceberg\r\nOPTIONS (\r\n    'write.object-storage.enabled'=true, \r\n    'write.folder-storage.path'='s3://some-bucket/some-random-folder/')\r\nPARTITIONED BY (category);\r\n\r\nINSERT INTO my_catalog.my_ns.my_table VALUES (1, \"some data\", \"some category\");\r\njava.lang.NullPointerException\r\n\tat org.apache.iceberg.LocationProviders.stripTrailingSlash(LocationProviders.java:135)\r\n\tat org.apache.iceberg.LocationProviders.access$000(LocationProviders.java:34)\r\n\tat org.apache.iceberg.LocationProviders$ObjectStoreLocationProvider.<init>(LocationProviders.java:99)\r\n\tat org.apache.iceberg.LocationProviders.locationsFor(LocationProviders.java:65)\r\n\tat org.apache.iceberg.BaseMetastoreTableOperations.locationProvider(BaseMetastoreTableOperations.java:200)\r\n\tat org.apache.iceberg.BaseTable.locationProvider(BaseTable.java:219)\r\n\tat org.apache.iceberg.spark.source.SparkWrite.createWriterFactory(SparkWrite.java:172)\r\n\tat org.apache.iceberg.spark.source.SparkWrite.access$600(SparkWrite.java:87)\r\n\tat org.apache.iceberg.spark.source.SparkWrite$BaseBatchWrite.createBatchWriterFactory(SparkWrite.java:226)\r\n```\r\n\r\nOmitting the `'write.object-storage.enabled'=true` avoids the NULL Pointer exception, but also falls back to the hive driver, writing data to:\r\n`s3://some-bucket/some-random-folder/category=some+category/00000-2-13441dd2-137a-42d1-9c6b-9ccc29a2ebeb-00001.parquet`\r\n\r\n```\r\nspark-sql> CREATE TABLE my_catalog.my_ns.my_table (\r\n         >     id bigint,\r\n         >     data string,\r\n         >     category string)\r\n         > USING iceberg\r\n         > OPTIONS (\r\n         >     'write.folder-storage.path'='s3://some-bucket/some-random-folder/')\r\n         > PARTITIONED BY (category);\r\nTime taken: 2.021 seconds\r\nspark-sql> INSERT INTO my_catalog.my_ns.my_table VALUES (1, \"some data\", \"some category\");\r\nTime taken: 3.968 seconds\r\n```\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/898187675/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/898207396","html_url":"https://github.com/apache/iceberg/pull/2905#issuecomment-898207396","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2905","id":898207396,"node_id":"IC_kwDOCW7NX841iY6k","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-13T05:49:16Z","updated_at":"2021-08-13T05:49:16Z","author_association":"CONTRIBUTOR","body":"@openinx @JingsongLi @rdblue can you help take a look?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/898207396/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/898209231","html_url":"https://github.com/apache/iceberg/issues/2808#issuecomment-898209231","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2808","id":898209231,"node_id":"IC_kwDOCW7NX841iZXP","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-13T05:54:30Z","updated_at":"2021-08-13T05:54:30Z","author_association":"CONTRIBUTOR","body":"I didn't notice the `max-committed-checkpointid` are the same in those two commits. then the scenario described in my earlier comment is probably not the case.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/898209231/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/898209403","html_url":"https://github.com/apache/iceberg/pull/2963#issuecomment-898209403","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2963","id":898209403,"node_id":"IC_kwDOCW7NX841iZZ7","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-13T05:55:00Z","updated_at":"2021-08-13T05:55:20Z","author_association":"CONTRIBUTOR","body":"@cobookman The new resolution strategy is the following:\r\n- if `write.object-storage.path` is set, use it\r\n- if not found, fallback to `write.folder-storage.path`\r\n- if not found, use `<tableLocation>/data`\r\n\r\nI think you are testing using an older version. I have added some more tests in Spark SQL, in case you want some examples: https://github.com/apache/iceberg/pull/2966/files\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/898209403/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/898222690","html_url":"https://github.com/apache/iceberg/pull/2963#issuecomment-898222690","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2963","id":898222690,"node_id":"IC_kwDOCW7NX841icpi","user":{"login":"cobookman","id":1738983,"node_id":"MDQ6VXNlcjE3Mzg5ODM=","avatar_url":"https://avatars.githubusercontent.com/u/1738983?v=4","gravatar_id":"","url":"https://api.github.com/users/cobookman","html_url":"https://github.com/cobookman","followers_url":"https://api.github.com/users/cobookman/followers","following_url":"https://api.github.com/users/cobookman/following{/other_user}","gists_url":"https://api.github.com/users/cobookman/gists{/gist_id}","starred_url":"https://api.github.com/users/cobookman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cobookman/subscriptions","organizations_url":"https://api.github.com/users/cobookman/orgs","repos_url":"https://api.github.com/users/cobookman/repos","events_url":"https://api.github.com/users/cobookman/events{/privacy}","received_events_url":"https://api.github.com/users/cobookman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-13T06:26:29Z","updated_at":"2021-08-13T06:26:29Z","author_association":"CONTRIBUTOR","body":"/faceplam yep that was it, wasn't using the lastest on github. Got it to work, and will update the docs.\r\n\r\n```sql\r\nCREATE TABLE my_catalog.my-db.my_table (\r\n     id bigint,\r\n     data string,\r\n     category string)\r\nUSING iceberg\r\nOPTIONS (\r\n     'write.object-storage.enabled'=true,\r\n      'write.folder-storage.path'='s3://my-bucket/some-random-folder/')\r\nPARTITIONED BY (category);\r\n```\r\n\r\nWrites to: \r\n```\r\ns3://my-bucket/some-random-folder/21e81572/my-db.db/my_table/category=some+category/00000-0-5413ff19-edbc-41f9-ad2a-8ac1551ef3e1-00001.parquet`\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/898222690/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/898233392","html_url":"https://github.com/apache/iceberg/pull/2961#issuecomment-898233392","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2961","id":898233392,"node_id":"IC_kwDOCW7NX841ifQw","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-13T06:53:41Z","updated_at":"2021-08-13T06:53:41Z","author_association":"COLLABORATOR","body":"Agree,  seems simpler having tag on the Snapshot directly than Snapshot map on the table metadata.  (if i understand the two choices right). It seems TableMetadata loads all snapshots anyway, so in any case there must be a reverse indexing to support Snapshot.tags() method","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/898233392/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/898234171","html_url":"https://github.com/apache/iceberg/issues/2958#issuecomment-898234171","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2958","id":898234171,"node_id":"IC_kwDOCW7NX841ifc7","user":{"login":"zephaniah-wzf","id":53243075,"node_id":"MDQ6VXNlcjUzMjQzMDc1","avatar_url":"https://avatars.githubusercontent.com/u/53243075?v=4","gravatar_id":"","url":"https://api.github.com/users/zephaniah-wzf","html_url":"https://github.com/zephaniah-wzf","followers_url":"https://api.github.com/users/zephaniah-wzf/followers","following_url":"https://api.github.com/users/zephaniah-wzf/following{/other_user}","gists_url":"https://api.github.com/users/zephaniah-wzf/gists{/gist_id}","starred_url":"https://api.github.com/users/zephaniah-wzf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zephaniah-wzf/subscriptions","organizations_url":"https://api.github.com/users/zephaniah-wzf/orgs","repos_url":"https://api.github.com/users/zephaniah-wzf/repos","events_url":"https://api.github.com/users/zephaniah-wzf/events{/privacy}","received_events_url":"https://api.github.com/users/zephaniah-wzf/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-13T06:55:38Z","updated_at":"2021-08-13T06:55:38Z","author_association":"NONE","body":"> @zephaniah-wzf 可以发一下具体的堆栈吗\r\n\r\n[报错信息.txt](https://github.com/apache/iceberg/files/6980457/default.txt)\r\n还是会报那样的错误，有点不合理啊","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/898234171/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/898322236","html_url":"https://github.com/apache/iceberg/pull/2109#issuecomment-898322236","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2109","id":898322236,"node_id":"IC_kwDOCW7NX841i088","user":{"login":"liubo1022126","id":47106533,"node_id":"MDQ6VXNlcjQ3MTA2NTMz","avatar_url":"https://avatars.githubusercontent.com/u/47106533?v=4","gravatar_id":"","url":"https://api.github.com/users/liubo1022126","html_url":"https://github.com/liubo1022126","followers_url":"https://api.github.com/users/liubo1022126/followers","following_url":"https://api.github.com/users/liubo1022126/following{/other_user}","gists_url":"https://api.github.com/users/liubo1022126/gists{/gist_id}","starred_url":"https://api.github.com/users/liubo1022126/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liubo1022126/subscriptions","organizations_url":"https://api.github.com/users/liubo1022126/orgs","repos_url":"https://api.github.com/users/liubo1022126/repos","events_url":"https://api.github.com/users/liubo1022126/events{/privacy}","received_events_url":"https://api.github.com/users/liubo1022126/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-13T09:28:00Z","updated_at":"2021-08-13T09:28:00Z","author_association":"NONE","body":"> We actually implemented this in a slightly different way of calculating the watermark. Instead of using Flink watermark, we add some additional metadata (min, max, sum, count) per DataFile for the timestamp column. In the committer, we use the min of min to decide the watermark value. We never regress the watermark value. Those metadata can also help us calculate metrics for ingestion latency (commit time - event/Kafka time): like min, max, avg.\r\n> \r\n> Just to share, by no means that I am suggesting changing the approach in this PR. It is perfectly good.\r\n\r\nthx @stevenzwu @rdblue, that sounds great! We also need to embed the iceberg table, which is regarded as real-time table, into our workflow. Is there any doc or patch for your implementation?  ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/898322236/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/898595026","html_url":"https://github.com/apache/iceberg/pull/2240#issuecomment-898595026","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2240","id":898595026,"node_id":"IC_kwDOCW7NX841j3jS","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-13T16:54:29Z","updated_at":"2021-08-13T16:54:29Z","author_association":"COLLABORATOR","body":"@aokolnychyi No problem, thanks for the review, addressed the comments and implemented only for new WriterFactory, when you are ready for another look.\r\n  \r\nBy the way, I was thinking to move out the ORC nested column metric fix to a separate patch, what do you think?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/898595026/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]