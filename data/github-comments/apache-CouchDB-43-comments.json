[{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/376956729","html_url":"https://github.com/apache/couchdb/issues/1232#issuecomment-376956729","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1232","id":376956729,"node_id":"MDEyOklzc3VlQ29tbWVudDM3Njk1NjcyOQ==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-28T16:50:15Z","updated_at":"2018-03-28T16:50:15Z","author_association":"MEMBER","body":"@eiri problem is eunit standard timeouts. So even if we do a spinloop of ‚Äúdo until success‚Äù, we‚Äôd run into the eunit timeout. We can raise that of course, but we‚Äôll be doing that a lot.\r\n\r\nMaybe there is a way to set a timeout globally and set it to really long for travis and jenkins runs, so we never run into them‚Ñ¢","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/376956729/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/376957518","html_url":"https://github.com/apache/couchdb/issues/1227#issuecomment-376957518","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1227","id":376957518,"node_id":"MDEyOklzc3VlQ29tbWVudDM3Njk1NzUxOA==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-28T16:52:46Z","updated_at":"2018-03-28T16:52:46Z","author_association":"MEMBER","body":"+1","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/376957518/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/376999626","html_url":"https://github.com/apache/couchdb/issues/1238#issuecomment-376999626","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1238","id":376999626,"node_id":"MDEyOklzc3VlQ29tbWVudDM3Njk5OTYyNg==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-28T19:02:17Z","updated_at":"2018-03-28T19:02:17Z","author_association":"MEMBER","body":"@janl Your fix failed on Jenkins, reopening :(\r\n\r\nhttps://builds.apache.org/blue/organizations/jenkins/CouchDB/detail/master/231/pipeline\r\n\r\n```\r\ntest/javascript/tests/users_db_security.js                     \r\n    Error: undefined\r\nTrace back (most recent call first):\r\n    \r\n  52: test/javascript/test_setup.js\r\n      T((void 0))\r\n  35: test/javascript/tests/users_db_security.js\r\n      (\"jchris\")\r\n  39: test/javascript/tests/users_db_security.js\r\n      ([object Object],\"org.couchdb.user:jchris\",\"jchris\")\r\n 111: test/javascript/tests/users_db_security.js\r\n      (\"bcrypt\",(function (derived_key) {TEquals(60, derived_key.length, \"de\r\n 413: test/javascript/tests/users_db_security.js\r\n      ()\r\n 395: test/javascript/couch_test_runner.js\r\n      run_on_modified_server([object Array],(function () {try {testFun(schem\r\n 411: test/javascript/tests/users_db_security.js\r\n      (\"bcrypt\",1,[object Array])\r\n 399: test/javascript/tests/users_db_security.js\r\n      ()\r\n  37: test/javascript/cli_runner.js\r\n      runTest()\r\n  48: test/javascript/cli_runner.js\r\n      \r\nfail\r\n```\r\n\r\nhttps://couchdb-vm2.apache.org/ci_errorlogs/jenkins-couchdb-231-2018-03-28T17:21:43.727450/couchlog.tar.gz\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/376999626/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/377021566","html_url":"https://github.com/apache/couchdb/issues/1235#issuecomment-377021566","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1235","id":377021566,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NzAyMTU2Ng==","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-28T20:16:42Z","updated_at":"2018-03-28T20:16:42Z","author_association":"MEMBER","body":"We have considered a (fundamental) change within CouchDB that would allow a revision to have multiple parents. This would change conflict resolution from what you describe (posting a new merged revision and then deleting the unwanted siblings) to a single doc update, which (should it pass all the VDU's) would apply the 'merged' update and resolve all the conflicts.\r\n\r\nAre we describing the same problem now?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/377021566/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/377038084","html_url":"https://github.com/apache/couchdb/pull/1252#issuecomment-377038084","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1252","id":377038084,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NzAzODA4NA==","user":{"login":"chewbranca","id":5326,"node_id":"MDQ6VXNlcjUzMjY=","avatar_url":"https://avatars.githubusercontent.com/u/5326?v=4","gravatar_id":"","url":"https://api.github.com/users/chewbranca","html_url":"https://github.com/chewbranca","followers_url":"https://api.github.com/users/chewbranca/followers","following_url":"https://api.github.com/users/chewbranca/following{/other_user}","gists_url":"https://api.github.com/users/chewbranca/gists{/gist_id}","starred_url":"https://api.github.com/users/chewbranca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chewbranca/subscriptions","organizations_url":"https://api.github.com/users/chewbranca/orgs","repos_url":"https://api.github.com/users/chewbranca/repos","events_url":"https://api.github.com/users/chewbranca/events{/privacy}","received_events_url":"https://api.github.com/users/chewbranca/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-28T21:11:16Z","updated_at":"2018-03-28T21:11:16Z","author_association":"CONTRIBUTOR","body":"+1","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/377038084/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/377042785","html_url":"https://github.com/apache/couchdb/pull/1251#issuecomment-377042785","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1251","id":377042785,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NzA0Mjc4NQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-28T21:27:05Z","updated_at":"2018-03-28T21:27:05Z","author_association":"MEMBER","body":"@davisp is this at all related to #1221 ? i'm not sure it does since it looks like the reported bug applies even when shards have not yet been substituted. if so ignore this comment.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/377042785/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/377043045","html_url":"https://github.com/apache/couchdb/issues/1221#issuecomment-377043045","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1221","id":377043045,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NzA0MzA0NQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-28T21:27:58Z","updated_at":"2018-03-28T21:27:58Z","author_association":"MEMBER","body":"I wonder if this is related to #984 and @rnewson 's investigation there.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/377043045/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/377043222","html_url":"https://github.com/apache/couchdb/pull/1251#issuecomment-377043222","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1251","id":377043222,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NzA0MzIyMg==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-28T21:28:35Z","updated_at":"2018-03-28T21:28:35Z","author_association":"MEMBER","body":"@wohali Narp. That's unrelated.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/377043222/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/377065018","html_url":"https://github.com/apache/couchdb/pull/1251#issuecomment-377065018","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1251","id":377065018,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NzA2NTAxOA==","user":{"login":"chewbranca","id":5326,"node_id":"MDQ6VXNlcjUzMjY=","avatar_url":"https://avatars.githubusercontent.com/u/5326?v=4","gravatar_id":"","url":"https://api.github.com/users/chewbranca","html_url":"https://github.com/chewbranca","followers_url":"https://api.github.com/users/chewbranca/followers","following_url":"https://api.github.com/users/chewbranca/following{/other_user}","gists_url":"https://api.github.com/users/chewbranca/gists{/gist_id}","starred_url":"https://api.github.com/users/chewbranca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chewbranca/subscriptions","organizations_url":"https://api.github.com/users/chewbranca/orgs","repos_url":"https://api.github.com/users/chewbranca/repos","events_url":"https://api.github.com/users/chewbranca/events{/privacy}","received_events_url":"https://api.github.com/users/chewbranca/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-28T22:56:34Z","updated_at":"2018-03-28T22:56:34Z","author_association":"CONTRIBUTOR","body":"+1","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/377065018/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/377186093","html_url":"https://github.com/apache/couchdb/issues/546#issuecomment-377186093","issue_url":"https://api.github.com/repos/apache/couchdb/issues/546","id":377186093,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NzE4NjA5Mw==","user":{"login":"arunp123","id":4498477,"node_id":"MDQ6VXNlcjQ0OTg0Nzc=","avatar_url":"https://avatars.githubusercontent.com/u/4498477?v=4","gravatar_id":"","url":"https://api.github.com/users/arunp123","html_url":"https://github.com/arunp123","followers_url":"https://api.github.com/users/arunp123/followers","following_url":"https://api.github.com/users/arunp123/following{/other_user}","gists_url":"https://api.github.com/users/arunp123/gists{/gist_id}","starred_url":"https://api.github.com/users/arunp123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/arunp123/subscriptions","organizations_url":"https://api.github.com/users/arunp123/orgs","repos_url":"https://api.github.com/users/arunp123/repos","events_url":"https://api.github.com/users/arunp123/events{/privacy}","received_events_url":"https://api.github.com/users/arunp123/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-29T09:58:54Z","updated_at":"2018-03-29T09:58:54Z","author_association":"NONE","body":"installing libmozjs185-dev fixed my problem","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/377186093/reactions","total_count":2,"+1":1,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/377190829","html_url":"https://github.com/apache/couchdb/issues/1221#issuecomment-377190829","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1221","id":377190829,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NzE5MDgyOQ==","user":{"login":"kdoran","id":721262,"node_id":"MDQ6VXNlcjcyMTI2Mg==","avatar_url":"https://avatars.githubusercontent.com/u/721262?v=4","gravatar_id":"","url":"https://api.github.com/users/kdoran","html_url":"https://github.com/kdoran","followers_url":"https://api.github.com/users/kdoran/followers","following_url":"https://api.github.com/users/kdoran/following{/other_user}","gists_url":"https://api.github.com/users/kdoran/gists{/gist_id}","starred_url":"https://api.github.com/users/kdoran/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kdoran/subscriptions","organizations_url":"https://api.github.com/users/kdoran/orgs","repos_url":"https://api.github.com/users/kdoran/repos","events_url":"https://api.github.com/users/kdoran/events{/privacy}","received_events_url":"https://api.github.com/users/kdoran/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-29T10:17:41Z","updated_at":"2018-03-29T10:17:41Z","author_association":"NONE","body":"@wohali yup, sorry for the delay! Here's a quick js example I ran in the chrome devtools console while on the fauxton page on my local CouchDB, which is 2.1.0 as a single node. The same discrepancy between `seq` and `last_seq` also happens when running this on a remote EC2 CouchDB running 2.1.1 also as a single node:\r\n\r\n```\r\ncouchUrl = 'http://localhost:5984/'\r\ndbName = 'sync-test'\r\npromise = fetch(couchUrl + dbName + '/_all_docs?limit=1&descending=true', \r\n  {\r\n    headers: {'Content-Type': 'application/json'},\r\n    credentials: 'include'\r\n  }\r\n).then(resp => resp.json()).then(response => response.rows[0].id)\r\n.then(doc_id => {\r\n  return fetch(couchUrl + dbName + '/_changes?limit=10&filter=_doc_ids', \r\n    {\r\n      method: 'POST', \r\n      body: JSON.stringify({ doc_ids: [ doc_id ] }),\r\n      headers: {'Content-Type': 'application/json'}\r\n    }\r\n  ).then(resp => resp.json()).then(resp => JSON.stringify(resp, null, 2))\r\n})\r\nPromise.resolve(\r\n  promise\r\n).then(console.log)\r\n```\r\n\r\nthe response:\r\n\r\n```\r\n{\r\n  \"results\": [\r\n    {\r\n      \"seq\": \"94-g1AAAAB5eJzLYWBgYMpgTmEQTM4vTc5ISXLIyU9OzMnILy7JAUklMiTV____PyvRGI-iPBYgydAApP6D1GYwJ2rnAgXYU1MtUsyNjLDpywIABfcnAA\",\r\n      \"id\": \"9::remote\",\r\n      \"changes\": [\r\n        {\r\n          \"rev\": \"1-967a00dff5e02add41819138abb3284d\"\r\n        }\r\n      ]\r\n    }\r\n  ],\r\n  \"last_seq\": \"128-g1AAAACbeJzLYWBgYMpgTmEQTM4vTc5ISXLIyU9OzMnILy7JAUklMiTV____PyuDOdEnFyjAnmaanGZsmoRNAx5j8liAJEMDkPoPNc0EbFpqqkWKuZERNn1ZALTyMYU\",\r\n  \"pending\": 0\r\n}\r\n```\r\n\r\nand here is the result when I run that same snippet on my local 1.6.1 CouchDB:\r\n\r\n```\r\n{\r\n  \"results\": [\r\n    {\r\n      \"seq\": 9,\r\n      \"id\": \"9::remote\",\r\n      \"changes\": [\r\n        {\r\n          \"rev\": \"1-967a00dff5e02add41819138abb3284d\"\r\n        }\r\n      ]\r\n    }\r\n  ],\r\n  \"last_seq\": 1019\r\n}\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/377190829/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/377205555","html_url":"https://github.com/apache/couchdb/pull/1200#issuecomment-377205555","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1200","id":377205555,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NzIwNTU1NQ==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-29T11:26:11Z","updated_at":"2018-03-29T11:26:11Z","author_association":"MEMBER","body":"Thanks for the great discussion here. Closing this out in favour of the new proposed approach: https://github.com/apache/couchdb/pull/1253","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/377205555/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/377207053","html_url":"https://github.com/apache/couchdb/issues/1238#issuecomment-377207053","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1238","id":377207053,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NzIwNzA1Mw==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-29T11:32:59Z","updated_at":"2018-03-29T11:32:59Z","author_association":"MEMBER","body":"on it\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/377207053/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/377231543","html_url":"https://github.com/apache/couchdb/issues/1238#issuecomment-377231543","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1238","id":377231543,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NzIzMTU0Mw==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-29T13:16:10Z","updated_at":"2018-03-29T13:16:10Z","author_association":"MEMBER","body":"Two points:\r\n1. we are in dire need of rewriting this test file\r\n2. it *might* be that this failure points to pbkdf not working as we expect it to for config admins. I‚Äôll keep investigating.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/377231543/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/377241308","html_url":"https://github.com/apache/couchdb/pull/1253#issuecomment-377241308","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1253","id":377241308,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NzI0MTMwOA==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-29T13:50:20Z","updated_at":"2018-03-29T13:50:20Z","author_association":"MEMBER","body":"The travis fails here point to https://github.com/apache/couchdb/blob/master/test/javascript/tests/attachments.js#L300-L301 where we allow attachments stubs to be written verbatim and without length info. There is code to resolve this, but it requires reading the attachment info from disk.\r\n\r\nI‚Äôm not yet implementing this because I wan‚Äôt a review of the approach here first. Could be perf-prohibitive on the write path, tho.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/377241308/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/377274171","html_url":"https://github.com/apache/couchdb/issues/1238#issuecomment-377274171","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1238","id":377274171,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NzI3NDE3MQ==","user":{"login":"eiri","id":70542,"node_id":"MDQ6VXNlcjcwNTQy","avatar_url":"https://avatars.githubusercontent.com/u/70542?v=4","gravatar_id":"","url":"https://api.github.com/users/eiri","html_url":"https://github.com/eiri","followers_url":"https://api.github.com/users/eiri/followers","following_url":"https://api.github.com/users/eiri/following{/other_user}","gists_url":"https://api.github.com/users/eiri/gists{/gist_id}","starred_url":"https://api.github.com/users/eiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eiri/subscriptions","organizations_url":"https://api.github.com/users/eiri/orgs","repos_url":"https://api.github.com/users/eiri/repos","events_url":"https://api.github.com/users/eiri/events{/privacy}","received_events_url":"https://api.github.com/users/eiri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-29T15:30:58Z","updated_at":"2018-03-29T15:30:58Z","author_association":"MEMBER","body":"1. Totally agree, this test and the whole javascript suite are **really** hard to follow. It'd be amazing to revive Russel's suggestion to migrate it to Elixir.\r\n\r\n2. I think it's not that `pbkdf` or `bcrypt` don't work as expected, but rather hashing on heavily restricted CI hosts is not able to complete [within 5 sec](https://github.com/apache/couchdb/blob/master/test/javascript/tests/users_db_security.js#L110)\r\n\r\nIn the logs from the failed jenkins' test I found:\r\n```\r\n[notice] 2018-03-28T17:21:33.282844Z node1@127.0.0.1 <0.32515.3> a82be2eaf1 127.0.0.1:15984 127.0.0.1 undefined PUT /_users/org.couchdb.user%3Ajchris 201 ok 511\r\n[warning] 2018-03-28T17:21:38.285265Z node1@127.0.0.1 <0.32515.3> 59932a5bfc couch_httpd_auth: Authentication failed for user jchris from 127.0.0.1\r\n[notice] 2018-03-28T17:21:38.285724Z node1@127.0.0.1 <0.32515.3> 59932a5bfc 127.0.0.1:15984 127.0.0.1 undefined POST /_session 401 ok 2\r\n```\r\n\r\nAnd when I insert something like\r\n```javascript\r\n    if (scheme == \"bcrypt\") {\r\n      wait(500);\r\n    }\r\n    else {\r\n      wait(5000);\r\n    }\r\n```\r\nat line 110 of `users_db_security.js` I'm getting the same failure and stack trace.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/377274171/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/377274262","html_url":"https://github.com/apache/couchdb/issues/1238#issuecomment-377274262","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1238","id":377274262,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NzI3NDI2Mg==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-29T15:31:14Z","updated_at":"2018-03-29T15:31:14Z","author_association":"MEMBER","body":"s/pbkdf/bcrypt/ apologies ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/377274262/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/377287292","html_url":"https://github.com/apache/couchdb/pull/1255#issuecomment-377287292","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1255","id":377287292,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NzI4NzI5Mg==","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-29T16:11:32Z","updated_at":"2018-03-29T16:11:32Z","author_association":"MEMBER","body":"+1","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/377287292/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/377292201","html_url":"https://github.com/apache/couchdb/issues/1238#issuecomment-377292201","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1238","id":377292201,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NzI5MjIwMQ==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-29T16:26:59Z","updated_at":"2018-03-29T16:26:59Z","author_association":"MEMBER","body":"This is it, we need to send log_rounds to 1 as well","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/377292201/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/377314335","html_url":"https://github.com/apache/couchdb/issues/1238#issuecomment-377314335","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1238","id":377314335,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NzMxNDMzNQ==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-29T17:38:34Z","updated_at":"2018-03-29T17:38:34Z","author_association":"MEMBER","body":"Fixed in https://github.com/apache/couchdb/pull/1258","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/377314335/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/377356072","html_url":"https://github.com/apache/couchdb/issues/1226#issuecomment-377356072","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1226","id":377356072,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NzM1NjA3Mg==","user":{"login":"eiri","id":70542,"node_id":"MDQ6VXNlcjcwNTQy","avatar_url":"https://avatars.githubusercontent.com/u/70542?v=4","gravatar_id":"","url":"https://api.github.com/users/eiri","html_url":"https://github.com/eiri","followers_url":"https://api.github.com/users/eiri/followers","following_url":"https://api.github.com/users/eiri/following{/other_user}","gists_url":"https://api.github.com/users/eiri/gists{/gist_id}","starred_url":"https://api.github.com/users/eiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eiri/subscriptions","organizations_url":"https://api.github.com/users/eiri/orgs","repos_url":"https://api.github.com/users/eiri/repos","events_url":"https://api.github.com/users/eiri/events{/privacy}","received_events_url":"https://api.github.com/users/eiri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-29T20:06:12Z","updated_at":"2018-03-29T20:06:12Z","author_association":"MEMBER","body":"Good news - this is doable and not even overly esoteric. Bad news  - the change is touching a lot of modules and needs a record change, so writing tests, migration code and then getting someone to review going to take a while.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/377356072/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/377358283","html_url":"https://github.com/apache/couchdb/pull/1139#issuecomment-377358283","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1139","id":377358283,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NzM1ODI4Mw==","user":{"login":"jjrodrig","id":1001724,"node_id":"MDQ6VXNlcjEwMDE3MjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1001724?v=4","gravatar_id":"","url":"https://api.github.com/users/jjrodrig","html_url":"https://github.com/jjrodrig","followers_url":"https://api.github.com/users/jjrodrig/followers","following_url":"https://api.github.com/users/jjrodrig/following{/other_user}","gists_url":"https://api.github.com/users/jjrodrig/gists{/gist_id}","starred_url":"https://api.github.com/users/jjrodrig/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jjrodrig/subscriptions","organizations_url":"https://api.github.com/users/jjrodrig/orgs","repos_url":"https://api.github.com/users/jjrodrig/repos","events_url":"https://api.github.com/users/jjrodrig/events{/privacy}","received_events_url":"https://api.github.com/users/jjrodrig/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-29T20:13:39Z","updated_at":"2018-03-29T20:13:39Z","author_association":"CONTRIBUTOR","body":"@wohali I'll modify the condition to respond with 200 - Ok only if we have a response from all the nodes, If we have a positive response from some of them 202-Accepted is returned.\r\n\r\nThe problem I see is that the behaviour is not consistent with the creation where the quorum is considered, but is better than the current situation which returns a 500-Error","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/377358283/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/377359278","html_url":"https://github.com/apache/couchdb/issues/1226#issuecomment-377359278","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1226","id":377359278,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NzM1OTI3OA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-29T20:17:24Z","updated_at":"2018-03-29T20:17:24Z","author_association":"MEMBER","body":"Thanks @eiri, good to know. Let's not merge this into `master` until 2.2.0 is released, then.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/377359278/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/377556469","html_url":"https://github.com/apache/couchdb/issues/1235#issuecomment-377556469","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1235","id":377556469,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NzU1NjQ2OQ==","user":{"login":"ondra-novak","id":9439234,"node_id":"MDQ6VXNlcjk0MzkyMzQ=","avatar_url":"https://avatars.githubusercontent.com/u/9439234?v=4","gravatar_id":"","url":"https://api.github.com/users/ondra-novak","html_url":"https://github.com/ondra-novak","followers_url":"https://api.github.com/users/ondra-novak/followers","following_url":"https://api.github.com/users/ondra-novak/following{/other_user}","gists_url":"https://api.github.com/users/ondra-novak/gists{/gist_id}","starred_url":"https://api.github.com/users/ondra-novak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ondra-novak/subscriptions","organizations_url":"https://api.github.com/users/ondra-novak/orgs","repos_url":"https://api.github.com/users/ondra-novak/repos","events_url":"https://api.github.com/users/ondra-novak/events{/privacy}","received_events_url":"https://api.github.com/users/ondra-novak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-30T15:58:05Z","updated_at":"2018-03-30T15:58:05Z","author_association":"NONE","body":"Sounds promising. I agree. It describing the same problem and your proposal would solve it definitely.\r\n\r\n----\r\n\r\n Actually I have come up with a similar thought when thinking about the problem. The purpose of the \"_merged\" field would be to specify multiple parents. Once the document with such field is received, the database would \"purge\" opened revisions that are mentioned in the list. This would also solve problem with multiplication of deleted conflicts that are still considered as opened.\r\n\r\nThe main benefit of such idea is that removing conflicts along with the document update would be atomic and no more deleted conflicts would be left opened.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/377556469/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/377574554","html_url":"https://github.com/apache/couchdb/pull/1246#issuecomment-377574554","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1246","id":377574554,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NzU3NDU1NA==","user":{"login":"chewbranca","id":5326,"node_id":"MDQ6VXNlcjUzMjY=","avatar_url":"https://avatars.githubusercontent.com/u/5326?v=4","gravatar_id":"","url":"https://api.github.com/users/chewbranca","html_url":"https://github.com/chewbranca","followers_url":"https://api.github.com/users/chewbranca/followers","following_url":"https://api.github.com/users/chewbranca/following{/other_user}","gists_url":"https://api.github.com/users/chewbranca/gists{/gist_id}","starred_url":"https://api.github.com/users/chewbranca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chewbranca/subscriptions","organizations_url":"https://api.github.com/users/chewbranca/orgs","repos_url":"https://api.github.com/users/chewbranca/repos","events_url":"https://api.github.com/users/chewbranca/events{/privacy}","received_events_url":"https://api.github.com/users/chewbranca/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-30T17:18:57Z","updated_at":"2018-03-30T17:18:57Z","author_association":"CONTRIBUTOR","body":"@janl:\r\n\r\n0) sounds good, üëç \r\n\r\n1) agreed. In principle the check https://github.com/apache/couchdb/blob/884db891de6f7004f31a9a1a9d50b0162b1dca8e/src/chttpd/src/chttpd_auth_request.erl#L94-L96 _seems_ like it should do the right things and obviate the need for the check in `chttp_db:do_db_Req`, so this seems like the right approach, but we'll also want to keep in mind @davisp's point in https://github.com/apache/couchdb/pull/1246#issuecomment-376569046.\r\n\r\n2) the blocker for cassim is the current security dichotomy where we have clustered level security in `chttpd`, and shard local security in `couch_db.erl`. We need to remove the shard local security model and then cassim will be rocking. There's been some discussion around this a few times, and the general consensus seems to be folks are on board with dropping the shard local security model. Now we just need to make it happen.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/377574554/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/377941896","html_url":"https://github.com/apache/couchdb/pull/1259#issuecomment-377941896","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1259","id":377941896,"node_id":"MDEyOklzc3VlQ29tbWVudDM3Nzk0MTg5Ng==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-02T14:31:02Z","updated_at":"2018-04-02T14:31:02Z","author_association":"CONTRIBUTOR","body":"Good call @salsa-dev \r\n\r\nAnd as you say docs has it as `deflate_N` https://github.com/apache/couchdb-documentation/blame/2742d1ef4f9449050ae9232ce697439477482dfa/src/config/couchdb.rst#L77\r\n\r\n+1","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/377941896/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/377980376","html_url":"https://github.com/apache/couchdb/issues/1053#issuecomment-377980376","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1053","id":377980376,"node_id":"MDEyOklzc3VlQ29tbWVudDM3Nzk4MDM3Ng==","user":{"login":"paulocoghi","id":378397,"node_id":"MDQ6VXNlcjM3ODM5Nw==","avatar_url":"https://avatars.githubusercontent.com/u/378397?v=4","gravatar_id":"","url":"https://api.github.com/users/paulocoghi","html_url":"https://github.com/paulocoghi","followers_url":"https://api.github.com/users/paulocoghi/followers","following_url":"https://api.github.com/users/paulocoghi/following{/other_user}","gists_url":"https://api.github.com/users/paulocoghi/gists{/gist_id}","starred_url":"https://api.github.com/users/paulocoghi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/paulocoghi/subscriptions","organizations_url":"https://api.github.com/users/paulocoghi/orgs","repos_url":"https://api.github.com/users/paulocoghi/repos","events_url":"https://api.github.com/users/paulocoghi/events{/privacy}","received_events_url":"https://api.github.com/users/paulocoghi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-02T17:06:31Z","updated_at":"2018-04-02T17:06:31Z","author_association":"NONE","body":"> couchup replicate -a --login admin --password {ADMIN_PASSWORD}\r\n\r\nThis needs to be mentioned in couchup documentation: http://docs.couchdb.org/en/latest/install/upgrading.html#couchup-utility","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/377980376/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378029507","html_url":"https://github.com/apache/couchdb/issues/1053#issuecomment-378029507","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1053","id":378029507,"node_id":"MDEyOklzc3VlQ29tbWVudDM3ODAyOTUwNw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-02T20:09:38Z","updated_at":"2018-04-02T20:09:38Z","author_association":"MEMBER","body":"@paulocoghi pull requests on https://github.com/apache/couchdb-documentation are welcome!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378029507/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378055149","html_url":"https://github.com/apache/couchdb/pull/1260#issuecomment-378055149","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1260","id":378055149,"node_id":"MDEyOklzc3VlQ29tbWVudDM3ODA1NTE0OQ==","user":{"login":"tonysun83","id":6991573,"node_id":"MDQ6VXNlcjY5OTE1NzM=","avatar_url":"https://avatars.githubusercontent.com/u/6991573?v=4","gravatar_id":"","url":"https://api.github.com/users/tonysun83","html_url":"https://github.com/tonysun83","followers_url":"https://api.github.com/users/tonysun83/followers","following_url":"https://api.github.com/users/tonysun83/following{/other_user}","gists_url":"https://api.github.com/users/tonysun83/gists{/gist_id}","starred_url":"https://api.github.com/users/tonysun83/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tonysun83/subscriptions","organizations_url":"https://api.github.com/users/tonysun83/orgs","repos_url":"https://api.github.com/users/tonysun83/repos","events_url":"https://api.github.com/users/tonysun83/events{/privacy}","received_events_url":"https://api.github.com/users/tonysun83/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-02T21:39:36Z","updated_at":"2018-04-02T21:39:36Z","author_association":"CONTRIBUTOR","body":"+1","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378055149/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378088499","html_url":"https://github.com/apache/couchdb/issues/1261#issuecomment-378088499","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1261","id":378088499,"node_id":"MDEyOklzc3VlQ29tbWVudDM3ODA4ODQ5OQ==","user":{"login":"eiri","id":70542,"node_id":"MDQ6VXNlcjcwNTQy","avatar_url":"https://avatars.githubusercontent.com/u/70542?v=4","gravatar_id":"","url":"https://api.github.com/users/eiri","html_url":"https://github.com/eiri","followers_url":"https://api.github.com/users/eiri/followers","following_url":"https://api.github.com/users/eiri/following{/other_user}","gists_url":"https://api.github.com/users/eiri/gists{/gist_id}","starred_url":"https://api.github.com/users/eiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eiri/subscriptions","organizations_url":"https://api.github.com/users/eiri/orgs","repos_url":"https://api.github.com/users/eiri/repos","events_url":"https://api.github.com/users/eiri/events{/privacy}","received_events_url":"https://api.github.com/users/eiri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-03T00:19:56Z","updated_at":"2018-04-03T00:19:56Z","author_association":"MEMBER","body":"The error clearly says that you don't have a target database you are trying to replicate into. Create database `testing7` on the nodes `couchdb2` and `couchdb3` before replication or add an attribute `create_target: true` in your replication payload as [specified in documentation](http://docs.couchdb.org/en/2.1.0/api/server/common.html#post--_replicate) ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378088499/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378228093","html_url":"https://github.com/apache/couchdb/issues/1142#issuecomment-378228093","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1142","id":378228093,"node_id":"MDEyOklzc3VlQ29tbWVudDM3ODIyODA5Mw==","user":{"login":"eiri","id":70542,"node_id":"MDQ6VXNlcjcwNTQy","avatar_url":"https://avatars.githubusercontent.com/u/70542?v=4","gravatar_id":"","url":"https://api.github.com/users/eiri","html_url":"https://github.com/eiri","followers_url":"https://api.github.com/users/eiri/followers","following_url":"https://api.github.com/users/eiri/following{/other_user}","gists_url":"https://api.github.com/users/eiri/gists{/gist_id}","starred_url":"https://api.github.com/users/eiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eiri/subscriptions","organizations_url":"https://api.github.com/users/eiri/orgs","repos_url":"https://api.github.com/users/eiri/repos","events_url":"https://api.github.com/users/eiri/events{/privacy}","received_events_url":"https://api.github.com/users/eiri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-03T12:11:48Z","updated_at":"2018-04-03T12:11:48Z","author_association":"MEMBER","body":"Hi @AlexanderKaraberov - I heard that view changes implementation is _conceptually_ broken in mrview implementation, it appears to work in the simple cases, but quickly goes south once keys in views starting to be removed and then reappear. I know at least one corner case where seq btree in mrview is not working correctly. What I'm trying to say is that it's not simply a question of wiring view changes through fabric and removing `fast_view` shortcut, there are a good chance you are wasting your time on a broken feature.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378228093/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378235429","html_url":"https://github.com/apache/couchdb/issues/1142#issuecomment-378235429","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1142","id":378235429,"node_id":"MDEyOklzc3VlQ29tbWVudDM3ODIzNTQyOQ==","user":{"login":"AlexanderKaraberov","id":3254818,"node_id":"MDQ6VXNlcjMyNTQ4MTg=","avatar_url":"https://avatars.githubusercontent.com/u/3254818?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexanderKaraberov","html_url":"https://github.com/AlexanderKaraberov","followers_url":"https://api.github.com/users/AlexanderKaraberov/followers","following_url":"https://api.github.com/users/AlexanderKaraberov/following{/other_user}","gists_url":"https://api.github.com/users/AlexanderKaraberov/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexanderKaraberov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexanderKaraberov/subscriptions","organizations_url":"https://api.github.com/users/AlexanderKaraberov/orgs","repos_url":"https://api.github.com/users/AlexanderKaraberov/repos","events_url":"https://api.github.com/users/AlexanderKaraberov/events{/privacy}","received_events_url":"https://api.github.com/users/AlexanderKaraberov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-03T12:40:00Z","updated_at":"2018-04-04T13:33:40Z","author_association":"CONTRIBUTOR","body":"Hi @eiri \r\n\r\nCould you please describe this\r\n\r\n> one corner case where seq btree in mrview is not working correctly\r\n\r\nand maybe some other failed test cases? This will be much appreciated. We tested this implementation using some basic test cases namely filtered replication, and basic filtering by `key`s using Apache Bench for profiling. Everything seems to work just fine. \r\nThe requests we were using are:\r\n1. `_changes?style=all_docs&filter=_view&view=index/type&key=\"some_key\"` \r\n2. `_changes?feed=normal&heartbeat=300000&style=all_docs&since=some_seq&filter=_view&key=\"some_key\"&view=repl/type` \r\n\r\nwhere design documents `index/type` and `repl/type` have `\"seq_indexed\": true` and `keyseq_indexed: true`. Just in case our implementation is based on `couch_mrview:count_view_changes_since()` +               `couch_mrview:view_changes_since()` which are called in `fabric_rpc:changes()`. \r\n\r\n**UPDATED**","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378235429/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378247381","html_url":"https://github.com/apache/couchdb/issues/1142#issuecomment-378247381","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1142","id":378247381,"node_id":"MDEyOklzc3VlQ29tbWVudDM3ODI0NzM4MQ==","user":{"login":"eiri","id":70542,"node_id":"MDQ6VXNlcjcwNTQy","avatar_url":"https://avatars.githubusercontent.com/u/70542?v=4","gravatar_id":"","url":"https://api.github.com/users/eiri","html_url":"https://github.com/eiri","followers_url":"https://api.github.com/users/eiri/followers","following_url":"https://api.github.com/users/eiri/following{/other_user}","gists_url":"https://api.github.com/users/eiri/gists{/gist_id}","starred_url":"https://api.github.com/users/eiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eiri/subscriptions","organizations_url":"https://api.github.com/users/eiri/orgs","repos_url":"https://api.github.com/users/eiri/repos","events_url":"https://api.github.com/users/eiri/events{/privacy}","received_events_url":"https://api.github.com/users/eiri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-03T13:20:28Z","updated_at":"2018-04-03T13:20:28Z","author_association":"MEMBER","body":"The issue with seq btree described here #592. In nutshell the problem is that unlike db's btree keys that always strings, views keys in seq btree could be anything, so sorting could yield unexpected results.\r\n\r\nFor the keys re-entering issues, I haven't ran into that myself, but views changes been discussed recently on dev channel and one of the senior developers mentioned that in scenario when the same keys appear in a view, then removed with docs updated or deleted and then reappearing again with new updates the view changes breaks pretty quickly. The general consensus was that we'd want to remove current implementation rather than trying to fix it and then redo it anew. Making a changes feed work properly is not a very trivial task as discussed on this thread #831","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378247381/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378254832","html_url":"https://github.com/apache/couchdb/issues/1142#issuecomment-378254832","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1142","id":378254832,"node_id":"MDEyOklzc3VlQ29tbWVudDM3ODI1NDgzMg==","user":{"login":"AlexanderKaraberov","id":3254818,"node_id":"MDQ6VXNlcjMyNTQ4MTg=","avatar_url":"https://avatars.githubusercontent.com/u/3254818?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexanderKaraberov","html_url":"https://github.com/AlexanderKaraberov","followers_url":"https://api.github.com/users/AlexanderKaraberov/followers","following_url":"https://api.github.com/users/AlexanderKaraberov/following{/other_user}","gists_url":"https://api.github.com/users/AlexanderKaraberov/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexanderKaraberov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexanderKaraberov/subscriptions","organizations_url":"https://api.github.com/users/AlexanderKaraberov/orgs","repos_url":"https://api.github.com/users/AlexanderKaraberov/repos","events_url":"https://api.github.com/users/AlexanderKaraberov/events{/privacy}","received_events_url":"https://api.github.com/users/AlexanderKaraberov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-03T13:43:55Z","updated_at":"2018-04-03T18:20:04Z","author_association":"CONTRIBUTOR","body":"@eiri Thanks for information.\r\nYou said `then redo it anew`. Is this somewhere in the roadmap? If yes i can try to help with this.\r\nI'm asking for the reason that this functionality is crucial for us since otherwise replication to mobile clients will be broken in our case. Also `_changes` without `fast_view` is super slow and unusable even for a medium scale production use case unfortunately. And even if it was fast we still need a proper filtering by key. The same is true for `mango` selectors workaround which we implemented before exposing `fast_view` to `fabric_rpc`.\r\nAlso as I understood sending a PR with `couch_mrview:count_view_changes_since()`/`couch_mrview:view_changes_since()` in `fabric_rpc` is useless because it relies on a broken `mrview` implementation?\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378254832/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378275516","html_url":"https://github.com/apache/couchdb/issues/1142#issuecomment-378275516","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1142","id":378275516,"node_id":"MDEyOklzc3VlQ29tbWVudDM3ODI3NTUxNg==","user":{"login":"eiri","id":70542,"node_id":"MDQ6VXNlcjcwNTQy","avatar_url":"https://avatars.githubusercontent.com/u/70542?v=4","gravatar_id":"","url":"https://api.github.com/users/eiri","html_url":"https://github.com/eiri","followers_url":"https://api.github.com/users/eiri/followers","following_url":"https://api.github.com/users/eiri/following{/other_user}","gists_url":"https://api.github.com/users/eiri/gists{/gist_id}","starred_url":"https://api.github.com/users/eiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eiri/subscriptions","organizations_url":"https://api.github.com/users/eiri/orgs","repos_url":"https://api.github.com/users/eiri/repos","events_url":"https://api.github.com/users/eiri/events{/privacy}","received_events_url":"https://api.github.com/users/eiri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-03T14:44:30Z","updated_at":"2018-04-03T14:44:30Z","author_association":"MEMBER","body":"I don't think that redo work on any roadmap currently, the possibility was just brushed casually. I've sent a email to dev mail list to discuss that.\r\n\r\nNormal view's btree uses custom sorter, but seq btree rely on erlang native collision. It's sorting on an update seq first, a key second and since key can be of any type, but change's `since` attribute evaluates to a string, that renders changes feed none-resumable in some cases. I hope that makes sense.\r\n\r\nIt's an easy fix, naturally, but afaik the issues with current implementation run deeper, on how `seq` and `kseq` interact, so I never got to it.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378275516/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378302060","html_url":"https://github.com/apache/couchdb/issues/1142#issuecomment-378302060","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1142","id":378302060,"node_id":"MDEyOklzc3VlQ29tbWVudDM3ODMwMjA2MA==","user":{"login":"AlexanderKaraberov","id":3254818,"node_id":"MDQ6VXNlcjMyNTQ4MTg=","avatar_url":"https://avatars.githubusercontent.com/u/3254818?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexanderKaraberov","html_url":"https://github.com/AlexanderKaraberov","followers_url":"https://api.github.com/users/AlexanderKaraberov/followers","following_url":"https://api.github.com/users/AlexanderKaraberov/following{/other_user}","gists_url":"https://api.github.com/users/AlexanderKaraberov/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexanderKaraberov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexanderKaraberov/subscriptions","organizations_url":"https://api.github.com/users/AlexanderKaraberov/orgs","repos_url":"https://api.github.com/users/AlexanderKaraberov/repos","events_url":"https://api.github.com/users/AlexanderKaraberov/events{/privacy}","received_events_url":"https://api.github.com/users/AlexanderKaraberov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-03T15:59:20Z","updated_at":"2018-04-03T18:23:27Z","author_association":"CONTRIBUTOR","body":"Hey @eiri  I just want to clarify a few last things in order to sort everything out. \r\nAs I understood by \"custom sorter\" you meant [view collation](http://docs.couchdb.org/en/latest/ddocs/views/collation.html#views-collation) and  `SeqBtree`/`KeyBySeqBtree` works the same as [raw collation](http://docs.couchdb.org/en/latest/ddocs/views/collation.html#raw-collation)? \r\nYet I still don't understand how sorting is related to constructing output for `_changes` feed since for that we keep a separate index ordered by `seq` of the database. I mean I understand the case with key removing and deletion but how sorting can affect existing index built by `seq`?\r\nTo add up, we have an index: `{seq, viewKey}` where for key `abc` we have a seq `\"<<4-g1AAAA>>\"`.\r\nHow can this be affected by sorting/collation?\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378302060/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378306577","html_url":"https://github.com/apache/couchdb/issues/1142#issuecomment-378306577","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1142","id":378306577,"node_id":"MDEyOklzc3VlQ29tbWVudDM3ODMwNjU3Nw==","user":{"login":"AlexanderKaraberov","id":3254818,"node_id":"MDQ6VXNlcjMyNTQ4MTg=","avatar_url":"https://avatars.githubusercontent.com/u/3254818?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexanderKaraberov","html_url":"https://github.com/AlexanderKaraberov","followers_url":"https://api.github.com/users/AlexanderKaraberov/followers","following_url":"https://api.github.com/users/AlexanderKaraberov/following{/other_user}","gists_url":"https://api.github.com/users/AlexanderKaraberov/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexanderKaraberov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexanderKaraberov/subscriptions","organizations_url":"https://api.github.com/users/AlexanderKaraberov/orgs","repos_url":"https://api.github.com/users/AlexanderKaraberov/repos","events_url":"https://api.github.com/users/AlexanderKaraberov/events{/privacy}","received_events_url":"https://api.github.com/users/AlexanderKaraberov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-03T16:13:22Z","updated_at":"2018-04-03T16:38:59Z","author_association":"CONTRIBUTOR","body":"Also as I understood from [this issue](https://github.com/apache/couchdb/issues/592) I can fix this by implementing a proper collation when `kseq` index is constructed: \r\n\r\n> We need to specify custom less function on seq_btree creation and normalize keys in it.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378306577/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378340158","html_url":"https://github.com/apache/couchdb/issues/1142#issuecomment-378340158","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1142","id":378340158,"node_id":"MDEyOklzc3VlQ29tbWVudDM3ODM0MDE1OA==","user":{"login":"eiri","id":70542,"node_id":"MDQ6VXNlcjcwNTQy","avatar_url":"https://avatars.githubusercontent.com/u/70542?v=4","gravatar_id":"","url":"https://api.github.com/users/eiri","html_url":"https://github.com/eiri","followers_url":"https://api.github.com/users/eiri/followers","following_url":"https://api.github.com/users/eiri/following{/other_user}","gists_url":"https://api.github.com/users/eiri/gists{/gist_id}","starred_url":"https://api.github.com/users/eiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eiri/subscriptions","organizations_url":"https://api.github.com/users/eiri/orgs","repos_url":"https://api.github.com/users/eiri/repos","events_url":"https://api.github.com/users/eiri/events{/privacy}","received_events_url":"https://api.github.com/users/eiri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-03T17:56:07Z","updated_at":"2018-04-03T17:56:07Z","author_association":"MEMBER","body":"The seq btree _is_ that separate index and its keys [are tuples of update seq and view key](https://github.com/apache/couchdb/blob/master/src/couch_mrview/src/couch_mrview_updater.erl#L104). So if your keys are strings, then you can pull changes since given update seq, because `{<<\"4-g1AAAA\">>, <<>>} < {<<\"4-g1AAAA\">>, <<\"abc\">>}` is `true`, but when your keys are, say, integers, you can't, since `{<<\"4-g1AAAA\">>, <<>>} < {<<\"4-g1AAAA\">>, 10}` is `false`. I hope that makes it clearer.\r\n\r\nYes, as I said, it's easy to remediate by setting custom collation on `seq` btree (note, that `kseq` is _different_ index and its collation set the same as view's), but it doesn't fix a deeper issue with the whole implementation.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378340158/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378355092","html_url":"https://github.com/apache/couchdb/pull/1144#issuecomment-378355092","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1144","id":378355092,"node_id":"MDEyOklzc3VlQ29tbWVudDM3ODM1NTA5Mg==","user":{"login":"eiri","id":70542,"node_id":"MDQ6VXNlcjcwNTQy","avatar_url":"https://avatars.githubusercontent.com/u/70542?v=4","gravatar_id":"","url":"https://api.github.com/users/eiri","html_url":"https://github.com/eiri","followers_url":"https://api.github.com/users/eiri/followers","following_url":"https://api.github.com/users/eiri/following{/other_user}","gists_url":"https://api.github.com/users/eiri/gists{/gist_id}","starred_url":"https://api.github.com/users/eiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eiri/subscriptions","organizations_url":"https://api.github.com/users/eiri/orgs","repos_url":"https://api.github.com/users/eiri/repos","events_url":"https://api.github.com/users/eiri/events{/privacy}","received_events_url":"https://api.github.com/users/eiri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-03T18:43:46Z","updated_at":"2018-04-03T18:43:46Z","author_association":"MEMBER","body":"I am willing to +1 it, the tests themselves look good, but they, understandably, take a long time to run. I just re-run just that one suite on my not too weak MBP and it took `[done in 287.081 s]`, so I'm afraid it'll kick Travis and Jenkins in the guts if it'd be part of standard eunit run.\r\n\r\n@nickva do you think we can move it to a separate `make` target somehow? It's nice to have those, don't get me wrong, but they are quite specific bit, so we probably don't need to run them for every change?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378355092/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378357545","html_url":"https://github.com/apache/couchdb/pull/1144#issuecomment-378357545","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1144","id":378357545,"node_id":"MDEyOklzc3VlQ29tbWVudDM3ODM1NzU0NQ==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-03T18:51:45Z","updated_at":"2018-04-03T18:52:44Z","author_association":"CONTRIBUTOR","body":"@eiri @wohali Thanks for taking a look\r\n\r\nI rebased it. I'll see maybe I'll try to reduce the branchiness and the generated sizes a bit to speed things up. So maybe it adds another 2-3 minutes but not 5\r\n\r\nHow are these times looking?\r\n```\r\nmodule 'couch_key_tree_prop_tests'\r\n  couch_key_tree_prop_tests:49: revtree_merge_random_nodes_test_...[0.493 s] ok\r\n  couch_key_tree_prop_tests:154: after_stemming_paths_are_shorter_test_...[0.269 s] ok\r\n  couch_key_tree_prop_tests:175: leaf_count_test_...[0.255 s] ok\r\n  couch_key_tree_prop_tests:136: after_stemming_all_leaves_are_present_test_...[0.262 s] ok\r\n  couch_key_tree_prop_tests:99: stemming_results_in_same_or_less_total_revs_test_...[0.260 s] ok\r\n  couch_key_tree_prop_tests:63: revtree_merge_some_existing_some_new_test_...[23.715 s] ok\r\n  couch_key_tree_prop_tests:117: stem_path_expect_size_to_get_smaller_test_...[5.431 s] ok\r\n  couch_key_tree_prop_tests:182: get_leafs_test_...[0.224 s] ok\r\n  couch_key_tree_prop_tests:32: revtree_merge_with_subset_of_own_nodes_test_...[35.110 s] ok\r\n  couch_key_tree_prop_tests:84: no_change_stemming_deeper_than_current_depth_test_...[0.253 s] ok\r\n  [done in 66.302 s]\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378357545/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378389508","html_url":"https://github.com/apache/couchdb/issues/1106#issuecomment-378389508","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1106","id":378389508,"node_id":"MDEyOklzc3VlQ29tbWVudDM3ODM4OTUwOA==","user":{"login":"ThibaultJanBeyer","id":12467511,"node_id":"MDQ6VXNlcjEyNDY3NTEx","avatar_url":"https://avatars.githubusercontent.com/u/12467511?v=4","gravatar_id":"","url":"https://api.github.com/users/ThibaultJanBeyer","html_url":"https://github.com/ThibaultJanBeyer","followers_url":"https://api.github.com/users/ThibaultJanBeyer/followers","following_url":"https://api.github.com/users/ThibaultJanBeyer/following{/other_user}","gists_url":"https://api.github.com/users/ThibaultJanBeyer/gists{/gist_id}","starred_url":"https://api.github.com/users/ThibaultJanBeyer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ThibaultJanBeyer/subscriptions","organizations_url":"https://api.github.com/users/ThibaultJanBeyer/orgs","repos_url":"https://api.github.com/users/ThibaultJanBeyer/repos","events_url":"https://api.github.com/users/ThibaultJanBeyer/events{/privacy}","received_events_url":"https://api.github.com/users/ThibaultJanBeyer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-03T20:34:45Z","updated_at":"2018-04-03T20:35:36Z","author_association":"NONE","body":"Got a similar issue\r\n```\r\nerror | \"unknown_error\"\r\nreason | \"badarg\"\r\nref | 749894463\r\n```\r\n\r\nIt happened when I changed the settings values of the auth `timeout`. I Set it to `86.400` for one day. But I think it took 86 seconds because of the `.`. So I tried to set it to `86400` but got the error mentioned above asap as the value \"saved\"‚Ä¶\r\n\r\nPlease fix.\r\n\r\nFor the meantime, is there any way to undo the changes?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378389508/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378394019","html_url":"https://github.com/apache/couchdb/pull/1144#issuecomment-378394019","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1144","id":378394019,"node_id":"MDEyOklzc3VlQ29tbWVudDM3ODM5NDAxOQ==","user":{"login":"eiri","id":70542,"node_id":"MDQ6VXNlcjcwNTQy","avatar_url":"https://avatars.githubusercontent.com/u/70542?v=4","gravatar_id":"","url":"https://api.github.com/users/eiri","html_url":"https://github.com/eiri","followers_url":"https://api.github.com/users/eiri/followers","following_url":"https://api.github.com/users/eiri/following{/other_user}","gists_url":"https://api.github.com/users/eiri/gists{/gist_id}","starred_url":"https://api.github.com/users/eiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eiri/subscriptions","organizations_url":"https://api.github.com/users/eiri/orgs","repos_url":"https://api.github.com/users/eiri/repos","events_url":"https://api.github.com/users/eiri/events{/privacy}","received_events_url":"https://api.github.com/users/eiri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-03T20:47:51Z","updated_at":"2018-04-03T20:47:51Z","author_association":"MEMBER","body":"Ok, `[done in 67.107 s]` locally and ~30mins on Travis, I think we can live with that. Merge it and we'll see what Jenkins have to say.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378394019/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378413083","html_url":"https://github.com/apache/couchdb/issues/1264#issuecomment-378413083","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1264","id":378413083,"node_id":"MDEyOklzc3VlQ29tbWVudDM3ODQxMzA4Mw==","user":{"login":"eiri","id":70542,"node_id":"MDQ6VXNlcjcwNTQy","avatar_url":"https://avatars.githubusercontent.com/u/70542?v=4","gravatar_id":"","url":"https://api.github.com/users/eiri","html_url":"https://github.com/eiri","followers_url":"https://api.github.com/users/eiri/followers","following_url":"https://api.github.com/users/eiri/following{/other_user}","gists_url":"https://api.github.com/users/eiri/gists{/gist_id}","starred_url":"https://api.github.com/users/eiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eiri/subscriptions","organizations_url":"https://api.github.com/users/eiri/orgs","repos_url":"https://api.github.com/users/eiri/repos","events_url":"https://api.github.com/users/eiri/events{/privacy}","received_events_url":"https://api.github.com/users/eiri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-03T21:59:25Z","updated_at":"2018-04-03T21:59:25Z","author_association":"MEMBER","body":"I assume `[1]` should point to a code line?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378413083/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378415193","html_url":"https://github.com/apache/couchdb/issues/1264#issuecomment-378415193","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1264","id":378415193,"node_id":"MDEyOklzc3VlQ29tbWVudDM3ODQxNTE5Mw==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-03T22:08:23Z","updated_at":"2018-04-03T22:08:23Z","author_association":"MEMBER","body":"[1] https://github.com/apache/couchdb/blob/02c9429d738e21f5dc5a92c33059e491e551a2f7/src/fabric/src/fabric_doc_attachments.erl#L93","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378415193/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378427159","html_url":"https://github.com/apache/couchdb/issues/1264#issuecomment-378427159","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1264","id":378427159,"node_id":"MDEyOklzc3VlQ29tbWVudDM3ODQyNzE1OQ==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-03T23:05:54Z","updated_at":"2018-04-03T23:06:32Z","author_association":"CONTRIBUTOR","body":"Maybe the easiest fix is that middleman process in `after Timeout` kills the receiver process:\r\n\r\n```\r\n    after Timeout ->\r\n        exit(Receiver, kill),\r\n        ok\r\n```\r\n\r\nAlso timeout is the `[fabric] request_timeout = 60000` maybe we really want that to be `[fabric] attachments_timeout = 600000` since it involves attachment uploading","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378427159/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378429940","html_url":"https://github.com/apache/couchdb/issues/1264#issuecomment-378429940","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1264","id":378429940,"node_id":"MDEyOklzc3VlQ29tbWVudDM3ODQyOTk0MA==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-03T23:20:35Z","updated_at":"2018-04-03T23:20:35Z","author_association":"CONTRIBUTOR","body":"And maybe we don't want the attachment timeout as that would be a total timeout for whole attachment upload but here it is really per-chunk so 60 sec seems about right","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378429940/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378433655","html_url":"https://github.com/apache/couchdb/issues/1264#issuecomment-378433655","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1264","id":378433655,"node_id":"MDEyOklzc3VlQ29tbWVudDM3ODQzMzY1NQ==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-03T23:42:04Z","updated_at":"2018-04-03T23:42:04Z","author_association":"MEMBER","body":"+1 after swapping that timeout config as you suggest","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378433655/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378465526","html_url":"https://github.com/apache/couchdb/issues/927#issuecomment-378465526","issue_url":"https://api.github.com/repos/apache/couchdb/issues/927","id":378465526,"node_id":"MDEyOklzc3VlQ29tbWVudDM3ODQ2NTUyNg==","user":{"login":"bgottlob","id":3633212,"node_id":"MDQ6VXNlcjM2MzMyMTI=","avatar_url":"https://avatars.githubusercontent.com/u/3633212?v=4","gravatar_id":"","url":"https://api.github.com/users/bgottlob","html_url":"https://github.com/bgottlob","followers_url":"https://api.github.com/users/bgottlob/followers","following_url":"https://api.github.com/users/bgottlob/following{/other_user}","gists_url":"https://api.github.com/users/bgottlob/gists{/gist_id}","starred_url":"https://api.github.com/users/bgottlob/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bgottlob/subscriptions","organizations_url":"https://api.github.com/users/bgottlob/orgs","repos_url":"https://api.github.com/users/bgottlob/repos","events_url":"https://api.github.com/users/bgottlob/events{/privacy}","received_events_url":"https://api.github.com/users/bgottlob/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-04T03:03:19Z","updated_at":"2018-04-04T03:03:19Z","author_association":"CONTRIBUTOR","body":"@janl I can give this a shot if no one else is currently looking at this.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378465526/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378486235","html_url":"https://github.com/apache/couchdb/pull/1265#issuecomment-378486235","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1265","id":378486235,"node_id":"MDEyOklzc3VlQ29tbWVudDM3ODQ4NjIzNQ==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-04T05:38:26Z","updated_at":"2018-04-04T05:38:26Z","author_association":"CONTRIBUTOR","body":"@davisp updated with attachments timeout value instead of default request timeout as suggested","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378486235/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378597834","html_url":"https://github.com/apache/couchdb/issues/1142#issuecomment-378597834","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1142","id":378597834,"node_id":"MDEyOklzc3VlQ29tbWVudDM3ODU5NzgzNA==","user":{"login":"AlexanderKaraberov","id":3254818,"node_id":"MDQ6VXNlcjMyNTQ4MTg=","avatar_url":"https://avatars.githubusercontent.com/u/3254818?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexanderKaraberov","html_url":"https://github.com/AlexanderKaraberov","followers_url":"https://api.github.com/users/AlexanderKaraberov/followers","following_url":"https://api.github.com/users/AlexanderKaraberov/following{/other_user}","gists_url":"https://api.github.com/users/AlexanderKaraberov/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexanderKaraberov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexanderKaraberov/subscriptions","organizations_url":"https://api.github.com/users/AlexanderKaraberov/orgs","repos_url":"https://api.github.com/users/AlexanderKaraberov/repos","events_url":"https://api.github.com/users/AlexanderKaraberov/events{/privacy}","received_events_url":"https://api.github.com/users/AlexanderKaraberov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-04T13:22:47Z","updated_at":"2018-04-04T15:43:27Z","author_association":"CONTRIBUTOR","body":"Hi @eiri \r\nThanks for the explanation, it clarified this issue for me. One more question though :)\r\nI know that you are going to remove `seq` and `kseq` b-tree logic completely from the `mrview` according to dev mailing list, but unfortunately we have to stick to this \"broken\" implementation for now in our own fork until proper implementation will be re-introduced (I mentioned reasons in the previous comment). So I'm curious is it possible to re-implement `Seq` index a little bit and instead of\r\n```erlang\r\n{Seq, Key} -> {DocID, EmittedValue, DocRev}\r\n```\r\nhave something akin to:\r\n```erlang\r\n{Seq, phash2(Key)} -> {DocID, EmittedValue, DocRev}\r\n```\r\nfor a better performance? Since we only care about the order by `seq` in case of `Seq` index and here we need `Key` only to deduplicate stuff, unlike in `KeyBySeq` index where a particular `Key` matters.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378597834/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378645557","html_url":"https://github.com/apache/couchdb/issues/1142#issuecomment-378645557","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1142","id":378645557,"node_id":"MDEyOklzc3VlQ29tbWVudDM3ODY0NTU1Nw==","user":{"login":"eiri","id":70542,"node_id":"MDQ6VXNlcjcwNTQy","avatar_url":"https://avatars.githubusercontent.com/u/70542?v=4","gravatar_id":"","url":"https://api.github.com/users/eiri","html_url":"https://github.com/eiri","followers_url":"https://api.github.com/users/eiri/followers","following_url":"https://api.github.com/users/eiri/following{/other_user}","gists_url":"https://api.github.com/users/eiri/gists{/gist_id}","starred_url":"https://api.github.com/users/eiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eiri/subscriptions","organizations_url":"https://api.github.com/users/eiri/orgs","repos_url":"https://api.github.com/users/eiri/repos","events_url":"https://api.github.com/users/eiri/events{/privacy}","received_events_url":"https://api.github.com/users/eiri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-04T15:38:46Z","updated_at":"2018-04-04T15:38:46Z","author_association":"MEMBER","body":"> So I'm curious is it possible to re-implement Seq index a little bit...\r\n\r\nProbably, maybe?.. I don't know, to be honest, I haven't thought too hard about it. Setting custom `less` on `seq_btree` feels like a less hacky approach to me and I'd simply serialize key to binary to take a randomness of hashing out of the equation.\r\n\r\nI presume the keys were used on seq btree because a view can emit multiple keys per db update. Which, I imagine, would give a duplicated entires in `_changed` feed when filtering used, no idea how replicator suppose to handle that.\r\n\r\nHonestly I'd be very wary of using a known broken feature in a production even if it works in a small subset of the tests and talking from experience migrating production views from fork to upstream, especially when file format changed, is a _huge_ PITA. But that's your call, obviously, I don't see this feature to get into active development too soon.  ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378645557/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378652055","html_url":"https://github.com/apache/couchdb/issues/1142#issuecomment-378652055","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1142","id":378652055,"node_id":"MDEyOklzc3VlQ29tbWVudDM3ODY1MjA1NQ==","user":{"login":"AlexanderKaraberov","id":3254818,"node_id":"MDQ6VXNlcjMyNTQ4MTg=","avatar_url":"https://avatars.githubusercontent.com/u/3254818?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexanderKaraberov","html_url":"https://github.com/AlexanderKaraberov","followers_url":"https://api.github.com/users/AlexanderKaraberov/followers","following_url":"https://api.github.com/users/AlexanderKaraberov/following{/other_user}","gists_url":"https://api.github.com/users/AlexanderKaraberov/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexanderKaraberov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexanderKaraberov/subscriptions","organizations_url":"https://api.github.com/users/AlexanderKaraberov/orgs","repos_url":"https://api.github.com/users/AlexanderKaraberov/repos","events_url":"https://api.github.com/users/AlexanderKaraberov/events{/privacy}","received_events_url":"https://api.github.com/users/AlexanderKaraberov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-04T15:56:49Z","updated_at":"2018-04-04T15:56:49Z","author_association":"CONTRIBUTOR","body":"> Honestly I'd be very wary of using a known broken feature in a production\r\n\r\nYes I know but do I really have a choice? I can't think about any other alternatives to `fast_view`. Before this we tried to use mango selectors with some hackery on the `nginx` side to make `Couchbase Lite` replication work, but unfortunately selectors also are too slow and have [some other issues](https://github.com/apache/couchdb/issues/1151). Simply avoiding using `seq` and `kseq` indexes proved to be outright slow and completely unusable in production scale. I'm not sure there is a forth alternative currently.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378652055/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378672568","html_url":"https://github.com/apache/couchdb/issues/1142#issuecomment-378672568","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1142","id":378672568,"node_id":"MDEyOklzc3VlQ29tbWVudDM3ODY3MjU2OA==","user":{"login":"eiri","id":70542,"node_id":"MDQ6VXNlcjcwNTQy","avatar_url":"https://avatars.githubusercontent.com/u/70542?v=4","gravatar_id":"","url":"https://api.github.com/users/eiri","html_url":"https://github.com/eiri","followers_url":"https://api.github.com/users/eiri/followers","following_url":"https://api.github.com/users/eiri/following{/other_user}","gists_url":"https://api.github.com/users/eiri/gists{/gist_id}","starred_url":"https://api.github.com/users/eiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eiri/subscriptions","organizations_url":"https://api.github.com/users/eiri/orgs","repos_url":"https://api.github.com/users/eiri/repos","events_url":"https://api.github.com/users/eiri/events{/privacy}","received_events_url":"https://api.github.com/users/eiri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-04T17:01:58Z","updated_at":"2018-04-04T17:01:58Z","author_association":"MEMBER","body":"I don't know much about Couchbase Lite, but in Couch there are also native erlang views, though they are their own can of worms around security afaik. However I see you point, just thought it'd be fair to give you a warning.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378672568/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378700369","html_url":"https://github.com/apache/couchdb/issues/1254#issuecomment-378700369","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1254","id":378700369,"node_id":"MDEyOklzc3VlQ29tbWVudDM3ODcwMDM2OQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-04T18:31:36Z","updated_at":"2018-04-04T18:31:36Z","author_association":"MEMBER","body":"@katsel Hi! Really glad to see this pop up here. Feel free to post a pull request when you're ready.\r\n\r\nIf you want a code review prior to the code being 100% ready, just mark your PR with [WIP] and people will know that it's not in its final state.\r\n\r\nThank you again for taking the initiative on this work!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378700369/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378862014","html_url":"https://github.com/apache/couchdb/issues/1266#issuecomment-378862014","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1266","id":378862014,"node_id":"MDEyOklzc3VlQ29tbWVudDM3ODg2MjAxNA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-05T08:39:05Z","updated_at":"2018-04-05T08:39:05Z","author_association":"MEMBER","body":"When you say \"version 2.2.0\" do you mean you are running from `master`? Can you provide a git reference (commit) against which you are running? 2.2.0 isn't released yet.\r\n\r\n/cc @nickva  ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378862014/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378865095","html_url":"https://github.com/apache/couchdb/issues/1266#issuecomment-378865095","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1266","id":378865095,"node_id":"MDEyOklzc3VlQ29tbWVudDM3ODg2NTA5NQ==","user":{"login":"pnagle","id":13343356,"node_id":"MDQ6VXNlcjEzMzQzMzU2","avatar_url":"https://avatars.githubusercontent.com/u/13343356?v=4","gravatar_id":"","url":"https://api.github.com/users/pnagle","html_url":"https://github.com/pnagle","followers_url":"https://api.github.com/users/pnagle/followers","following_url":"https://api.github.com/users/pnagle/following{/other_user}","gists_url":"https://api.github.com/users/pnagle/gists{/gist_id}","starred_url":"https://api.github.com/users/pnagle/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pnagle/subscriptions","organizations_url":"https://api.github.com/users/pnagle/orgs","repos_url":"https://api.github.com/users/pnagle/repos","events_url":"https://api.github.com/users/pnagle/events{/privacy}","received_events_url":"https://api.github.com/users/pnagle/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-05T08:50:40Z","updated_at":"2018-04-05T08:50:40Z","author_association":"NONE","body":"Yes, we are running from the master. Git reference 101f29b22fe7a4b9864404dbfe6e4782b8abfff6.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378865095/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378889940","html_url":"https://github.com/apache/couchdb/issues/1266#issuecomment-378889940","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1266","id":378889940,"node_id":"MDEyOklzc3VlQ29tbWVudDM3ODg4OTk0MA==","user":{"login":"jiangphcn","id":18000622,"node_id":"MDQ6VXNlcjE4MDAwNjIy","avatar_url":"https://avatars.githubusercontent.com/u/18000622?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangphcn","html_url":"https://github.com/jiangphcn","followers_url":"https://api.github.com/users/jiangphcn/followers","following_url":"https://api.github.com/users/jiangphcn/following{/other_user}","gists_url":"https://api.github.com/users/jiangphcn/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangphcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangphcn/subscriptions","organizations_url":"https://api.github.com/users/jiangphcn/orgs","repos_url":"https://api.github.com/users/jiangphcn/repos","events_url":"https://api.github.com/users/jiangphcn/events{/privacy}","received_events_url":"https://api.github.com/users/jiangphcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-05T10:24:27Z","updated_at":"2018-04-05T10:24:27Z","author_association":"CONTRIBUTOR","body":"Just want to exclude one possible scenario: which user you are using to check replication document? Is it owner or other users? We intentionally hide credential information for readers using https://github.com/apache/couchdb/pull/1126. Of course, this PR will not have impact on replication functionality, just for the purpose of security. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378889940/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378894847","html_url":"https://github.com/apache/couchdb/issues/1266#issuecomment-378894847","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1266","id":378894847,"node_id":"MDEyOklzc3VlQ29tbWVudDM3ODg5NDg0Nw==","user":{"login":"pnagle","id":13343356,"node_id":"MDQ6VXNlcjEzMzQzMzU2","avatar_url":"https://avatars.githubusercontent.com/u/13343356?v=4","gravatar_id":"","url":"https://api.github.com/users/pnagle","html_url":"https://github.com/pnagle","followers_url":"https://api.github.com/users/pnagle/followers","following_url":"https://api.github.com/users/pnagle/following{/other_user}","gists_url":"https://api.github.com/users/pnagle/gists{/gist_id}","starred_url":"https://api.github.com/users/pnagle/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pnagle/subscriptions","organizations_url":"https://api.github.com/users/pnagle/orgs","repos_url":"https://api.github.com/users/pnagle/repos","events_url":"https://api.github.com/users/pnagle/events{/privacy}","received_events_url":"https://api.github.com/users/pnagle/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-05T10:44:41Z","updated_at":"2018-04-05T10:44:41Z","author_association":"NONE","body":"We are using owner/admin. This happens on a lot of the documents and replication is failing but those documents whose headers are still available is working properly. Does replication jobs update the replication documents? Or is it happening because of replication document update conflict? Or an error in replication of replication database?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/378894847/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/379179322","html_url":"https://github.com/apache/couchdb/issues/1149#issuecomment-379179322","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1149","id":379179322,"node_id":"MDEyOklzc3VlQ29tbWVudDM3OTE3OTMyMg==","user":{"login":"snilaxan","id":3293837,"node_id":"MDQ6VXNlcjMyOTM4Mzc=","avatar_url":"https://avatars.githubusercontent.com/u/3293837?v=4","gravatar_id":"","url":"https://api.github.com/users/snilaxan","html_url":"https://github.com/snilaxan","followers_url":"https://api.github.com/users/snilaxan/followers","following_url":"https://api.github.com/users/snilaxan/following{/other_user}","gists_url":"https://api.github.com/users/snilaxan/gists{/gist_id}","starred_url":"https://api.github.com/users/snilaxan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/snilaxan/subscriptions","organizations_url":"https://api.github.com/users/snilaxan/orgs","repos_url":"https://api.github.com/users/snilaxan/repos","events_url":"https://api.github.com/users/snilaxan/events{/privacy}","received_events_url":"https://api.github.com/users/snilaxan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-06T08:02:57Z","updated_at":"2018-04-06T08:02:57Z","author_association":"NONE","body":"Thanks @wohali \r\n\r\nYes. In our system, we have two version of SpiderMonkey (libmozjs) with Ubuntu 14, 16 OS. \r\n- libmozjs185-1.0 / libmozjs185-dev\r\n- libmozjs-24-0v5 / libmozjs-24-0v5-dbg / libmozjs-24-bin / libmozjs-24-bin-dbg / libmozjs-24-dev \r\n\r\nWe have some errors on CouchDB logs but not sure whether those errors are related to this issues. please find errors details below.\r\n\r\nWe are getting some errors like following in logs, But actually, this DB file exists on the file system.\r\n\r\n> [Fri, 06 Apr 2018 00:20:51 GMT] [error] [<0.21294.2882>] Could not open file /data/couchdb-data/products.couch: no such file or directory\r\n\r\n\r\nSome errors like following in logs. Might be in replication flow.\r\n> [Fri, 06 Apr 2018 06:48:25 GMT] [error] [<0.4545.3660>] {error_report,<0.31.0>,\r\n                         {<0.4545.3660>,crash_report,\r\n                          [[{initial_call,\r\n                             {couch_replicator_httpc_pool,init,\r\n                              ['Argument__1']}},\r\n                            {pid,<0.4545.3660>},\r\n                            {registered_name,[]},\r\n                            {error_info,\r\n                             {exit,killed,\r\n                              [{gen_server,terminate,6,\r\n                                [{file,\"gen_server.erl\"},{line,744}]},\r\n                               {proc_lib,init_p_do_apply,3,\r\n                                [{file,\"proc_lib.erl\"},{line,239}]}]}},\r\n                            {ancestors,\r\n                             [<0.15098.3662>,couch_replicator_job_sup,\r\n                              couch_primary_services,couch_server_sup,\r\n                              <0.32.0>]},\r\n                            {messages,[]},\r\n                            {links,[]},\r\n                            {dictionary,[]},\r\n                            {trap_exit,true},\r\n                            {status,running},\r\n                            {heap_size,610},\r\n                            {stack_size,27},\r\n                            {reductions,188}],\r\n                           []]}}","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/379179322/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/379252125","html_url":"https://github.com/apache/couchdb/issues/1101#issuecomment-379252125","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1101","id":379252125,"node_id":"MDEyOklzc3VlQ29tbWVudDM3OTI1MjEyNQ==","user":{"login":"fynnlyte","id":19202953,"node_id":"MDQ6VXNlcjE5MjAyOTUz","avatar_url":"https://avatars.githubusercontent.com/u/19202953?v=4","gravatar_id":"","url":"https://api.github.com/users/fynnlyte","html_url":"https://github.com/fynnlyte","followers_url":"https://api.github.com/users/fynnlyte/followers","following_url":"https://api.github.com/users/fynnlyte/following{/other_user}","gists_url":"https://api.github.com/users/fynnlyte/gists{/gist_id}","starred_url":"https://api.github.com/users/fynnlyte/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fynnlyte/subscriptions","organizations_url":"https://api.github.com/users/fynnlyte/orgs","repos_url":"https://api.github.com/users/fynnlyte/repos","events_url":"https://api.github.com/users/fynnlyte/events{/privacy}","received_events_url":"https://api.github.com/users/fynnlyte/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-06T13:24:31Z","updated_at":"2018-04-06T13:24:31Z","author_association":"NONE","body":"I was tired of adding and deleting DDocs when searching for conflicts in a DB so I've tried this simple Mango-query in Fauxton:\r\n```\r\n{\r\n   \"selector\": {\r\n      \"_conflicts\": {\r\n         \"$exists\": true\r\n      }\r\n   }\r\n}\r\n```\r\nBut no documents were returned even though conflicts existed. Might be because the \"_conflicts\" -‚ÄØkey is not visible by default. It would help a lot if this was possible via Fauxton.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/379252125/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/379684802","html_url":"https://github.com/apache/couchdb/issues/1266#issuecomment-379684802","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1266","id":379684802,"node_id":"MDEyOklzc3VlQ29tbWVudDM3OTY4NDgwMg==","user":{"login":"jiangphcn","id":18000622,"node_id":"MDQ6VXNlcjE4MDAwNjIy","avatar_url":"https://avatars.githubusercontent.com/u/18000622?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangphcn","html_url":"https://github.com/jiangphcn","followers_url":"https://api.github.com/users/jiangphcn/followers","following_url":"https://api.github.com/users/jiangphcn/following{/other_user}","gists_url":"https://api.github.com/users/jiangphcn/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangphcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangphcn/subscriptions","organizations_url":"https://api.github.com/users/jiangphcn/orgs","repos_url":"https://api.github.com/users/jiangphcn/repos","events_url":"https://api.github.com/users/jiangphcn/events{/privacy}","received_events_url":"https://api.github.com/users/jiangphcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-09T09:04:26Z","updated_at":"2018-04-09T09:04:26Z","author_association":"CONTRIBUTOR","body":"For the case I mentioned above, it is just for display. So the actual content of replication content is not changed when non-owner is trying to view replication document. \r\n\r\nFor the case you mentioned, you mean that you are using owner/admin. If the header in replication document is not visible to owner, I don't believe that it belongs to the case I mentioned. There must be other concern case which causes the failure of replication.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/379684802/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/379797549","html_url":"https://github.com/apache/couchdb/pull/1118#issuecomment-379797549","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1118","id":379797549,"node_id":"MDEyOklzc3VlQ29tbWVudDM3OTc5NzU0OQ==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-09T15:43:22Z","updated_at":"2018-04-09T15:43:22Z","author_association":"MEMBER","body":"+1, but would like a team-cloudant +1 as well","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/379797549/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/379801216","html_url":"https://github.com/apache/couchdb/pull/1144#issuecomment-379801216","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1144","id":379801216,"node_id":"MDEyOklzc3VlQ29tbWVudDM3OTgwMTIxNg==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-09T15:54:13Z","updated_at":"2018-04-09T15:54:13Z","author_association":"MEMBER","body":"For posterity, we need to mirror new dependencies into Apache infrastructure when adding them - not just check that they are compatibly licensed. This should have been done at the same time as this merge landing.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/379801216/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/379811199","html_url":"https://github.com/apache/couchdb/pull/1270#issuecomment-379811199","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1270","id":379811199,"node_id":"MDEyOklzc3VlQ29tbWVudDM3OTgxMTE5OQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-09T16:25:03Z","updated_at":"2018-04-09T16:25:03Z","author_association":"MEMBER","body":"+1 after Travis passes :)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/379811199/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/379827228","html_url":"https://github.com/apache/couchdb/pull/1272#issuecomment-379827228","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1272","id":379827228,"node_id":"MDEyOklzc3VlQ29tbWVudDM3OTgyNzIyOA==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-09T17:17:44Z","updated_at":"2018-04-09T17:17:44Z","author_association":"MEMBER","body":"What's the motivation here? We're already logging when compaction finishes so seems kinda fishy to have it recorded twice. Also not sure on adding it to the API as it'd seem out of place for non-compacting storage engines.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/379827228/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/379836700","html_url":"https://github.com/apache/couchdb/pull/1272#issuecomment-379836700","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1272","id":379836700,"node_id":"MDEyOklzc3VlQ29tbWVudDM3OTgzNjcwMA==","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-09T17:49:27Z","updated_at":"2018-04-09T17:49:27Z","author_association":"MEMBER","body":"@davisp the motivation is to allow users to know when old revisions are finally gone from the live database files, handy if you need/want to know that a delete has finally happened.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/379836700/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/379840336","html_url":"https://github.com/apache/couchdb/pull/1272#issuecomment-379840336","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1272","id":379840336,"node_id":"MDEyOklzc3VlQ29tbWVudDM3OTg0MDMzNg==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-09T18:00:55Z","updated_at":"2018-04-09T18:00:55Z","author_association":"MEMBER","body":"Ah makes sense. Only thing that concerns me is that clustered purge work is happening around this as well so we'll want to figure out how best to order things for that.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/379840336/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/379856614","html_url":"https://github.com/apache/couchdb/pull/1029#issuecomment-379856614","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1029","id":379856614,"node_id":"MDEyOklzc3VlQ29tbWVudDM3OTg1NjYxNA==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-09T18:54:16Z","updated_at":"2018-04-09T18:54:16Z","author_association":"MEMBER","body":"-1 on this change. The bug is whatever is happening in purge that's broken. Dropping documents during compaction is a big no-go for me as that's kind of the crux of our consistency during compaction swaps.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/379856614/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/380029505","html_url":"https://github.com/apache/couchdb/issues/1183#issuecomment-380029505","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1183","id":380029505,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MDAyOTUwNQ==","user":{"login":"abhishiv","id":37350,"node_id":"MDQ6VXNlcjM3MzUw","avatar_url":"https://avatars.githubusercontent.com/u/37350?v=4","gravatar_id":"","url":"https://api.github.com/users/abhishiv","html_url":"https://github.com/abhishiv","followers_url":"https://api.github.com/users/abhishiv/followers","following_url":"https://api.github.com/users/abhishiv/following{/other_user}","gists_url":"https://api.github.com/users/abhishiv/gists{/gist_id}","starred_url":"https://api.github.com/users/abhishiv/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/abhishiv/subscriptions","organizations_url":"https://api.github.com/users/abhishiv/orgs","repos_url":"https://api.github.com/users/abhishiv/repos","events_url":"https://api.github.com/users/abhishiv/events{/privacy}","received_events_url":"https://api.github.com/users/abhishiv/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-10T09:09:23Z","updated_at":"2018-04-10T09:09:45Z","author_association":"NONE","body":"> I think the hmac encoding of the username provides only slightly better security, but it is confusing to users. Perhaps the http auth should allow both options at the same time, either the secret directly (#1174), or the encoded username. If an attacker already knows about the secret, it is trivial to generate the tokens, so there is no harm in allowing the secret as a token, if users desire it.\r\n\r\nBenefit of encoding username is that it disallows malicious users from accessing others databases. If we were to allow directly supplying secret - specially when using it with a browser client like pouchdb.\r\n\r\nIf we were to allow both, at least we should document this point.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/380029505/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/380053300","html_url":"https://github.com/apache/couchdb/issues/1008#issuecomment-380053300","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1008","id":380053300,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MDA1MzMwMA==","user":{"login":"ghost","id":10137,"node_id":"MDQ6VXNlcjEwMTM3","avatar_url":"https://avatars.githubusercontent.com/u/10137?v=4","gravatar_id":"","url":"https://api.github.com/users/ghost","html_url":"https://github.com/ghost","followers_url":"https://api.github.com/users/ghost/followers","following_url":"https://api.github.com/users/ghost/following{/other_user}","gists_url":"https://api.github.com/users/ghost/gists{/gist_id}","starred_url":"https://api.github.com/users/ghost/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ghost/subscriptions","organizations_url":"https://api.github.com/users/ghost/orgs","repos_url":"https://api.github.com/users/ghost/repos","events_url":"https://api.github.com/users/ghost/events{/privacy}","received_events_url":"https://api.github.com/users/ghost/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-10T10:34:40Z","updated_at":"2018-04-10T10:34:40Z","author_association":"NONE","body":"Same error , Erlang 6.2\r\n\r\n\r\n[error] 2018-04-10T10:10:59.860288Z nonode@nohost <0.14711.9> bcb49f8b6b rexi_server: from: nonode@nohost(<0.32062.6>) mfa: fabric_rpc:reduce_view/4 throw:{timeout,{gen_server,call,[couch_proc_manager,{get_proc,<<\"javascript\">>},5000]}} [{couch_mrview_util,get_view_index_state,5,[{file,\"src/couch_mrview_util.erl\"},{line,101}]},{couch_mrview_util,get_view,4,[{file,\"src/couch_mrview_util.erl\"},{line,45}]},{couch_mrview,query_view,6,[{file,\"src/couch_mrview.erl\"},{line,244}]},{rexi_server,init_p,3,[{file,\"src/rexi_server.erl\"},{line,139}]}]","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/380053300/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/380071719","html_url":"https://github.com/apache/couchdb/pull/1029#issuecomment-380071719","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1029","id":380071719,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MDA3MTcxOQ==","user":{"login":"starting","id":306779,"node_id":"MDQ6VXNlcjMwNjc3OQ==","avatar_url":"https://avatars.githubusercontent.com/u/306779?v=4","gravatar_id":"","url":"https://api.github.com/users/starting","html_url":"https://github.com/starting","followers_url":"https://api.github.com/users/starting/followers","following_url":"https://api.github.com/users/starting/following{/other_user}","gists_url":"https://api.github.com/users/starting/gists{/gist_id}","starred_url":"https://api.github.com/users/starting/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/starting/subscriptions","organizations_url":"https://api.github.com/users/starting/orgs","repos_url":"https://api.github.com/users/starting/repos","events_url":"https://api.github.com/users/starting/events{/privacy}","received_events_url":"https://api.github.com/users/starting/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-10T11:53:25Z","updated_at":"2018-04-10T11:54:05Z","author_association":"NONE","body":"I too share your view @davisp.   \r\n\r\nWhat should we do if a document not present in the db during compaction? I feel it is better to be flexible and notify the error, rather failing complete compaction process. This help for the availability of the database. \r\n\r\nIn Summary, We should find and fix the root of this issue, but still a single document failure should not cause the whole DB to be unavailable. (I couldn't still find an exact location that generates this issue). ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/380071719/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/380110853","html_url":"https://github.com/apache/couchdb/issues/1267#issuecomment-380110853","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1267","id":380110853,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MDExMDg1Mw==","user":{"login":"olivenvrac","id":31409996,"node_id":"MDQ6VXNlcjMxNDA5OTk2","avatar_url":"https://avatars.githubusercontent.com/u/31409996?v=4","gravatar_id":"","url":"https://api.github.com/users/olivenvrac","html_url":"https://github.com/olivenvrac","followers_url":"https://api.github.com/users/olivenvrac/followers","following_url":"https://api.github.com/users/olivenvrac/following{/other_user}","gists_url":"https://api.github.com/users/olivenvrac/gists{/gist_id}","starred_url":"https://api.github.com/users/olivenvrac/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/olivenvrac/subscriptions","organizations_url":"https://api.github.com/users/olivenvrac/orgs","repos_url":"https://api.github.com/users/olivenvrac/repos","events_url":"https://api.github.com/users/olivenvrac/events{/privacy}","received_events_url":"https://api.github.com/users/olivenvrac/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-10T14:05:11Z","updated_at":"2018-04-10T14:05:11Z","author_association":"NONE","body":"there is a mistake in my introduction : i don't have any problem with the continuous replication. Just with the replication beetween PouchDB and CouchDB.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/380110853/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/380123703","html_url":"https://github.com/apache/couchdb/issues/1274#issuecomment-380123703","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1274","id":380123703,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MDEyMzcwMw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-10T14:36:36Z","updated_at":"2018-04-10T14:36:36Z","author_association":"MEMBER","body":"Can you try upgrading to 1.7.1 first? 1.6.1 has known security issues, for a start.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/380123703/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/380130263","html_url":"https://github.com/apache/couchdb/pull/1029#issuecomment-380130263","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1029","id":380130263,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MDEzMDI2Mw==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-10T14:52:52Z","updated_at":"2018-04-10T14:52:52Z","author_association":"MEMBER","body":"At the very least this should be a required flag or config setting. Preferably I'd even just never commit it and document it as a temp fix that can be compiled and dropped in separately to fix broken compactions. Having code on master that drops data during compactions scares the daylights out of me.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/380130263/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/380131597","html_url":"https://github.com/apache/couchdb/pull/1272#issuecomment-380131597","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1272","id":380131597,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MDEzMTU5Nw==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-10T14:56:30Z","updated_at":"2018-04-10T14:56:30Z","author_association":"MEMBER","body":"I'm also mulling over how we might make this a bit more general rather than specifically inserting a last_compaction_time or w/e. Seems like having a storage-engine-defined set of extra info would be generally useful. Only sticking point is how we combine that for the cluster endpoint.\r\n\r\nThough on a semi-related note I was wanting an option the other day to show me the db info blobs for all shards rather than the combined version. Perhaps if we do that we can make an arbitrary \"engine_info\" key that allows storage engines to expose any data they might feel like having there?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/380131597/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/380415007","html_url":"https://github.com/apache/couchdb/issues/1184#issuecomment-380415007","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1184","id":380415007,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MDQxNTAwNw==","user":{"login":"jareware","id":560055,"node_id":"MDQ6VXNlcjU2MDA1NQ==","avatar_url":"https://avatars.githubusercontent.com/u/560055?v=4","gravatar_id":"","url":"https://api.github.com/users/jareware","html_url":"https://github.com/jareware","followers_url":"https://api.github.com/users/jareware/followers","following_url":"https://api.github.com/users/jareware/following{/other_user}","gists_url":"https://api.github.com/users/jareware/gists{/gist_id}","starred_url":"https://api.github.com/users/jareware/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jareware/subscriptions","organizations_url":"https://api.github.com/users/jareware/orgs","repos_url":"https://api.github.com/users/jareware/repos","events_url":"https://api.github.com/users/jareware/events{/privacy}","received_events_url":"https://api.github.com/users/jareware/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-11T11:10:45Z","updated_at":"2018-04-11T11:10:45Z","author_association":"NONE","body":"Also ran into this issue:\r\n\r\n```\r\n{ error: 'unknown_error',\r\n  reason: 'badarg',\r\n  ref: 4258677272,\r\n  name: 'unknown_error',\r\n  status: 500,\r\n  message: 'badarg' }\r\n```\r\n\r\nLooking at the DB logs around that time:\r\n\r\n```\r\nApr 11 13:58:11 [error] 2018-04-11T10:58:10.848863Z nonode@nohost <0.2276.41> 59b7147c82 rexi_server: from: nonode@nohost(<0.2106.41>) mfa: fabric_rpc:update_docs/3 exit:{timeout,{gen_server,call,[couch_proc_manager,{get_proc,{doc,<<\"_design/myUpdateValidation\">>,{1,[<<100,39,93,199,51,195,88,67,22,50,78,244,160,45,176,213>>]},{[{<<\"validate_doc_update\">>,<<\"function (newDoc, oldDoc, userCtx) { /* redacted */ }\">>}]},[],false,[]},{<<\"_design/myUpdateValidation\">>,<<\"1-64275dc733c3584316324ef4a02db0d5\">>}},5000]}} [{gen_server,call,3,[{file,\"gen_server.erl\"},{line,190}]},{couch_query_servers,get_ddoc_process,2,[{file,\"src/couch_query_servers.erl\"},{line,498}]},{couch_query_servers,with_ddoc_proc,2,[{file,\"src/couch_query_servers.erl\"},{line,463}]},{couch_query_servers,validate_doc_update,5,[{file,\"src/couch_query_servers.erl\"},{line,318}]},{couch_db,'-validate_doc_update_int/3-lc$^0/1-0-',5,[{file,\"src/couch_db.erl\"},{line,784}]},{couch_db,'-validate_doc_update_int/3-fun-0-',3,[{file,\"src/couch_db.erl\"},{line,784}]},{couch_stats,update_histogram,2,[{file,\"src/couch_stats.erl\"},{line,102}]},{couch_db,'-prep_and_validate_updates/6-fun-1-',3,[{file,\"src/couch_db.erl\"},{line,878}]}] \r\nApr 11 13:58:11 [error] 2018-04-11T10:58:10.862568Z nonode@nohost <0.2106.41> 59b7147c82 req_err(4258677272) unknown_error : badarg \r\nApr 11 13:58:11     [<<\"dict:fetch/2 L130\">>,<<\"couch_util:-reorder_results/2-lc$^1/1-1-/2 L456\">>,<<\"fabric_doc_update:go/3 L41\">>,<<\"fabric:update_docs/3 L259\">>,<<\"chttpd_db:db_req/2 L428\">>,<<\"chttpd:process_request/1 L295\">>,<<\"chttpd:handle_request_int/1 L231\">>,<<\"mochiweb_http:headers/6 L91\">>] \r\nApr 11 13:58:11 [error] 2018-04-11T10:58:10.863338Z nonode@nohost <0.2305.41> -------- CRASH REPORT Process  (<0.2305.41>) with 1 neighbors exited with reason: bad return value {os_process_error,\"OS process timed out.\"} at gen_server:init_it/6(line:334) <= proc_lib:init_p_do_apply/3(line:237); initial_call: {couch_os_process,init,['Argument__1']}, ancestors: [<0.2286.41>], messages: [], links: [<0.2286.41>], dictionary: [], trap_exit: false, status: running, heap_size: 987, stack_size: 27, reductions: 264 \r\nApr 11 13:58:11 [error] 2018-04-11T10:58:10.863546Z nonode@nohost <0.2307.41> -------- CRASH REPORT Process  (<0.2307.41>) with 1 neighbors exited with reason: bad return value {os_process_error,\"OS process timed out.\"} at gen_server:init_it/6(line:334) <= proc_lib:init_p_do_apply/3(line:237); initial_call: {couch_os_process,init,['Argument__1']}, ancestors: [<0.2267.41>], messages: [], links: [<0.2267.41>], dictionary: [], trap_exit: false, status: running, heap_size: 987, stack_size: 27, reductions: 264 \r\nApr 11 13:58:11 [error] 2018-04-11T10:58:10.863766Z nonode@nohost <0.2280.41> -------- CRASH REPORT Process  (<0.2280.41>) with 1 neighbors exited with reason: bad return value {os_process_error,\"OS process timed out.\"} at gen_server:init_it/6(line:334) <= proc_lib:init_p_do_apply/3(line:237); initial_call: {couch_os_process,init,['Argument__1']}, ancestors: [<0.2266.41>], messages: [], links: [<0.2266.41>], dictionary: [], trap_exit: false, status: running, heap_size: 987, stack_size: 27, reductions: 264 \r\nApr 11 13:58:11 [error] 2018-04-11T10:58:10.874587Z nonode@nohost <0.2306.41> -------- CRASH REPORT Process  (<0.2306.41>) with 1 neighbors exited with reason: bad return value {os_process_error,\"OS process timed out.\"} at gen_server:init_it/6(line:334) <= proc_lib:init_p_do_apply/3(line:237); initial_call: {couch_os_process,init,['Argument__1']}, ancestors: [<0.2268.41>], messages: [], links: [<0.2268.41>], dictionary: [], trap_exit: false, status: running, heap_size: 987, stack_size: 27, reductions: 264 \r\nApr 11 13:58:11 sh: sh: echo: I/O error \r\nApr 11 13:58:11 echo: I/O error \r\nApr 11 13:58:11 sh: sh: echo: I/O error \r\nApr 11 13:58:11 sh: echo: I/O error \r\nApr 11 13:58:11 echo: I/O error \r\n```\r\n\r\nThe strange thing is that this seems sporadic: trying to reproduce it with a smaller bulk POST always succeeded, and now even the larger bulk POST (with prod data) seems to work.\r\n\r\nWill update this issue if I learn more.\r\n\r\nRunning the official Docker image of 2.1.1 on AWS EC2, if it helps.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/380415007/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/380415938","html_url":"https://github.com/apache/couchdb/issues/1184#issuecomment-380415938","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1184","id":380415938,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MDQxNTkzOA==","user":{"login":"jareware","id":560055,"node_id":"MDQ6VXNlcjU2MDA1NQ==","avatar_url":"https://avatars.githubusercontent.com/u/560055?v=4","gravatar_id":"","url":"https://api.github.com/users/jareware","html_url":"https://github.com/jareware","followers_url":"https://api.github.com/users/jareware/followers","following_url":"https://api.github.com/users/jareware/following{/other_user}","gists_url":"https://api.github.com/users/jareware/gists{/gist_id}","starred_url":"https://api.github.com/users/jareware/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jareware/subscriptions","organizations_url":"https://api.github.com/users/jareware/orgs","repos_url":"https://api.github.com/users/jareware/repos","events_url":"https://api.github.com/users/jareware/events{/privacy}","received_events_url":"https://api.github.com/users/jareware/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-11T11:14:46Z","updated_at":"2018-04-11T11:14:46Z","author_association":"NONE","body":"Curiously, https://github.com/apache/couchdb/issues/1106#issuecomment-378389508 reports having changed `_config/couch_httpd_auth/timeout` to a higher value, and then getting this error. I have also changed the default to 31556952 (i.e. one year).\r\n\r\nIf/when this issue reappears, I'll see if changing it matters.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/380415938/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/380442650","html_url":"https://github.com/apache/couchdb/pull/1273#issuecomment-380442650","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1273","id":380442650,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MDQ0MjY1MA==","user":{"login":"eiri","id":70542,"node_id":"MDQ6VXNlcjcwNTQy","avatar_url":"https://avatars.githubusercontent.com/u/70542?v=4","gravatar_id":"","url":"https://api.github.com/users/eiri","html_url":"https://github.com/eiri","followers_url":"https://api.github.com/users/eiri/followers","following_url":"https://api.github.com/users/eiri/following{/other_user}","gists_url":"https://api.github.com/users/eiri/gists{/gist_id}","starred_url":"https://api.github.com/users/eiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eiri/subscriptions","organizations_url":"https://api.github.com/users/eiri/orgs","repos_url":"https://api.github.com/users/eiri/repos","events_url":"https://api.github.com/users/eiri/events{/privacy}","received_events_url":"https://api.github.com/users/eiri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-11T12:59:13Z","updated_at":"2018-04-11T12:59:13Z","author_association":"MEMBER","body":"@iilyak Amusingly, now when `mem3_shards` tests are actually running this exposed what appears to be a race in `mem3` test suite. I'm getting the suite failing on me about once in five runs with:\r\n```\r\n mem3_shards:679: t_cache_insert_ignores_stale_update_and_kills_worker...ok\r\n  Test mem3_shards changes listener\r\n    mem3_shards:754: should_kill_changes_listener_on_shutdown...*failed*\r\nin function mem3_shards:'-should_kill_changes_listener_on_shutdown/1-fun-1-'/1 (src/mem3_shards.erl, line 757)\r\nin call from mem3_shards:'-should_kill_changes_listener_on_shutdown/1-fun-4-'/1 (src/mem3_shards.erl, line 757)\r\n**error:{assertion_failed,[{module,mem3_shards},\r\n                   {line,757},\r\n                   {expression,\"is_process_alive ( ChangesPid )\"},\r\n                   {expected,true},\r\n                   {value,false}]}\r\n\r\n\r\n    [done in 0.003 s]\r\n  [done in 1.471 s]\r\n```\r\n\r\nGoing to fix that before merging, don't want to make our pipeline more finicky, than it is already. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/380442650/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/380493233","html_url":"https://github.com/apache/couchdb/issues/1184#issuecomment-380493233","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1184","id":380493233,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MDQ5MzIzMw==","user":{"login":"eiri","id":70542,"node_id":"MDQ6VXNlcjcwNTQy","avatar_url":"https://avatars.githubusercontent.com/u/70542?v=4","gravatar_id":"","url":"https://api.github.com/users/eiri","html_url":"https://github.com/eiri","followers_url":"https://api.github.com/users/eiri/followers","following_url":"https://api.github.com/users/eiri/following{/other_user}","gists_url":"https://api.github.com/users/eiri/gists{/gist_id}","starred_url":"https://api.github.com/users/eiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eiri/subscriptions","organizations_url":"https://api.github.com/users/eiri/orgs","repos_url":"https://api.github.com/users/eiri/repos","events_url":"https://api.github.com/users/eiri/events{/privacy}","received_events_url":"https://api.github.com/users/eiri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-11T15:25:47Z","updated_at":"2018-04-11T15:25:47Z","author_association":"MEMBER","body":"@jareware Thank you for the logs snippet, that really helped to reproduce this.\r\n\r\nSo what's happening is that when the bulk size exceeds 100 docs we are switching to a different data structure when reordering the results, to speed things up. If an update validator function takes too long, os process will throw timeout, but the whole batch will be processed nevertheless. It seems that in 2.1.1 that timeout from the update validator was swallowed up the pipe and an attempt to fetch the missing key on reorder was throwing an exception.\r\n\r\nEvidently it was fixed since then. I can't pinpoint where that happened, but when I run the same case on current master it handles the error fine:\r\n```json\r\n...\r\n   {\r\n        \"id\": \"1719307e8c6a14bc1f89f6e9570612bd\", \r\n        \"ok\": true, \r\n        \"rev\": \"1-1aefbf37f7524ef1d7708843e035d128\"\r\n    }, \r\n    {\r\n        \"error\": \"os_process_error\", \r\n        \"id\": \"1719307e8c6a14bc1f89f6e957061b2d\", \r\n        \"reason\": \"OS process timed out.\"\r\n    }, \r\n    {\r\n        \"id\": \"1719307e8c6a14bc1f89f6e957062769\", \r\n        \"ok\": true, \r\n        \"rev\": \"1-ca8a74b9258d00dc126bbae88ab1844f\"\r\n    }, \r\n...\r\n```\r\n\r\nThis can be reproduces with validation fun looking something like this.\r\n```javascript\r\nfunction(newDoc, oldDoc, userCtx) {\r\n  if (newDoc.timeout) {\r\n    var now = new Date().getTime();\r\n    while(new Date().getTime() < now + 60000) { }\r\n  }\r\n}\r\n```\r\nThe bulk's payload needs to be larger than 100 docs and have at least one doc with field `\"timeout\": true`.\r\n\r\nNote, that the config parameter `[couch_httpd_auth]` `timeout` not really related to this, os process timeout configured by `[couchdb]` `os_process_timeout` and is 5 seconds by default.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/380493233/reactions","total_count":4,"+1":4,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/380580320","html_url":"https://github.com/apache/couchdb/issues/1278#issuecomment-380580320","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1278","id":380580320,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MDU4MDMyMA==","user":{"login":"chewbranca","id":5326,"node_id":"MDQ6VXNlcjUzMjY=","avatar_url":"https://avatars.githubusercontent.com/u/5326?v=4","gravatar_id":"","url":"https://api.github.com/users/chewbranca","html_url":"https://github.com/chewbranca","followers_url":"https://api.github.com/users/chewbranca/followers","following_url":"https://api.github.com/users/chewbranca/following{/other_user}","gists_url":"https://api.github.com/users/chewbranca/gists{/gist_id}","starred_url":"https://api.github.com/users/chewbranca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chewbranca/subscriptions","organizations_url":"https://api.github.com/users/chewbranca/orgs","repos_url":"https://api.github.com/users/chewbranca/repos","events_url":"https://api.github.com/users/chewbranca/events{/privacy}","received_events_url":"https://api.github.com/users/chewbranca/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-11T20:10:40Z","updated_at":"2018-04-11T20:10:40Z","author_association":"CONTRIBUTOR","body":"First pass at this in https://github.com/apache/couchdb/commit/29e5ea9ff4ec0d43cff78d0f527451ea85e141f4\r\n\r\nSample output:\r\n\r\n```json\r\n$ curl -u adm:pass localhost:15984/foo/_info\r\n{\r\n  \"cluster\": [\r\n    {\r\n      \"q\": 8,\r\n      \"n\": 3,\r\n      \"w\": 2,\r\n      \"r\": 2\r\n    }\r\n  ],\r\n  \"c0000000-dfffffff\": [\r\n    {\r\n      \"node\": \"node1@127.0.0.1\",\r\n      \"db_name\": \"shards/c0000000-dfffffff/foo.1523467682\",\r\n      \"engine\": \"couch_bt_engine\",\r\n      \"doc_count\": 0,\r\n      \"doc_del_count\": 0,\r\n      \"update_seq\": 0,\r\n      \"purge_seq\": 0,\r\n      \"compact_running\": false,\r\n      \"sizes\": {\r\n        \"active\": 0,\r\n        \"external\": 0,\r\n        \"file\": 363\r\n      },\r\n      \"disk_size\": 363,\r\n      \"data_size\": 0,\r\n      \"other\": {\r\n        \"data_size\": 0\r\n      },\r\n      \"instance_start_time\": \"1523477072436594\",\r\n      \"disk_format_version\": 6,\r\n      \"committed_update_seq\": 0,\r\n      \"compacted_seq\": 0,\r\n      \"uuid\": \"93e9c614cfdec506b2a3e86e0f862e40\"\r\n    },\r\n    {\r\n      \"node\": \"node3@127.0.0.1\",\r\n      \"db_name\": \"shards/c0000000-dfffffff/foo.1523467682\",\r\n      \"engine\": \"couch_bt_engine\",\r\n      \"doc_count\": 0,\r\n      \"doc_del_count\": 0,\r\n      \"update_seq\": 0,\r\n      \"purge_seq\": 0,\r\n      \"compact_running\": false,\r\n      \"sizes\": {\r\n        \"active\": 0,\r\n        \"external\": 0,\r\n        \"file\": 372\r\n      },\r\n      \"disk_size\": 372,\r\n      \"data_size\": 0,\r\n      \"other\": {\r\n        \"data_size\": 0\r\n      },\r\n      \"instance_start_time\": \"1523477073236134\",\r\n      \"disk_format_version\": 6,\r\n      \"committed_update_seq\": 0,\r\n      \"compacted_seq\": 0,\r\n      \"uuid\": \"d4bd9acb9185c40017146de61ce9ef8c\"\r\n    },\r\n    {\r\n      \"node\": \"node2@127.0.0.1\",\r\n      \"db_name\": \"shards/c0000000-dfffffff/foo.1523467682\",\r\n      \"engine\": \"couch_bt_engine\",\r\n      \"doc_count\": 0,\r\n      \"doc_del_count\": 0,\r\n      \"update_seq\": 0,\r\n      \"purge_seq\": 0,\r\n      \"compact_running\": false,\r\n      \"sizes\": {\r\n        \"active\": 0,\r\n        \"external\": 0,\r\n        \"file\": 372\r\n      },\r\n      \"disk_size\": 372,\r\n      \"data_size\": 0,\r\n      \"other\": {\r\n        \"data_size\": 0\r\n      },\r\n      \"instance_start_time\": \"1523477071956592\",\r\n      \"disk_format_version\": 6,\r\n      \"committed_update_seq\": 0,\r\n      \"compacted_seq\": 0,\r\n      \"uuid\": \"d2c4a3791428ce91c3d724ec026e7e97\"\r\n    }\r\n  ],\r\n  \"20000000-3fffffff\": [\r\n    {\r\n      \"node\": \"node1@127.0.0.1\",\r\n      \"db_name\": \"shards/20000000-3fffffff/foo.1523467682\",\r\n      \"engine\": \"couch_bt_engine\",\r\n      \"doc_count\": 0,\r\n      \"doc_del_count\": 0,\r\n      \"update_seq\": 0,\r\n      \"purge_seq\": 0,\r\n      \"compact_running\": false,\r\n      \"sizes\": {\r\n        \"active\": 0,\r\n        \"external\": 0,\r\n        \"file\": 426\r\n      },\r\n      \"disk_size\": 426,\r\n      \"data_size\": 0,\r\n      \"other\": {\r\n        \"data_size\": 0\r\n      },\r\n      \"instance_start_time\": \"1523477072464646\",\r\n      \"disk_format_version\": 6,\r\n      \"committed_update_seq\": 0,\r\n      \"compacted_seq\": 0,\r\n      \"uuid\": \"a6efd374c089f24c4f4e74430fd96dfb\"\r\n    },\r\n    {\r\n      \"node\": \"node2@127.0.0.1\",\r\n      \"db_name\": \"shards/20000000-3fffffff/foo.1523467682\",\r\n      \"engine\": \"couch_bt_engine\",\r\n      \"doc_count\": 0,\r\n      \"doc_del_count\": 0,\r\n      \"update_seq\": 0,\r\n      \"purge_seq\": 0,\r\n      \"compact_running\": false,\r\n      \"sizes\": {\r\n        \"active\": 0,\r\n        \"external\": 0,\r\n        \"file\": 417\r\n      },\r\n      \"disk_size\": 417,\r\n      \"data_size\": 0,\r\n      \"other\": {\r\n        \"data_size\": 0\r\n      },\r\n      \"instance_start_time\": \"1523477071999464\",\r\n      \"disk_format_version\": 6,\r\n      \"committed_update_seq\": 0,\r\n      \"compacted_seq\": 0,\r\n      \"uuid\": \"6f8713a17ff7573d25daad683a995f66\"\r\n    },\r\n    {\r\n      \"node\": \"node3@127.0.0.1\",\r\n      \"db_name\": \"shards/20000000-3fffffff/foo.1523467682\",\r\n      \"engine\": \"couch_bt_engine\",\r\n      \"doc_count\": 0,\r\n      \"doc_del_count\": 0,\r\n      \"update_seq\": 0,\r\n      \"purge_seq\": 0,\r\n      \"compact_running\": false,\r\n      \"sizes\": {\r\n        \"active\": 0,\r\n        \"external\": 0,\r\n        \"file\": 417\r\n      },\r\n      \"disk_size\": 417,\r\n      \"data_size\": 0,\r\n      \"other\": {\r\n        \"data_size\": 0\r\n      },\r\n      \"instance_start_time\": \"1523477073242300\",\r\n      \"disk_format_version\": 6,\r\n      \"committed_update_seq\": 0,\r\n      \"compacted_seq\": 0,\r\n      \"uuid\": \"3b1ac6799e50623aa4b1ee318751ed8f\"\r\n    }\r\n  ],\r\n  \"60000000-7fffffff\": [\r\n    {\r\n      \"node\": \"node1@127.0.0.1\",\r\n      \"db_name\": \"shards/60000000-7fffffff/foo.1523467682\",\r\n      \"engine\": \"couch_bt_engine\",\r\n      \"doc_count\": 0,\r\n      \"doc_del_count\": 0,\r\n      \"update_seq\": 0,\r\n      \"purge_seq\": 0,\r\n      \"compact_running\": false,\r\n      \"sizes\": {\r\n        \"active\": 0,\r\n        \"external\": 0,\r\n        \"file\": 408\r\n      },\r\n      \"disk_size\": 408,\r\n      \"data_size\": 0,\r\n      \"other\": {\r\n        \"data_size\": 0\r\n      },\r\n      \"instance_start_time\": \"1523477072462895\",\r\n      \"disk_format_version\": 6,\r\n      \"committed_update_seq\": 0,\r\n      \"compacted_seq\": 0,\r\n      \"uuid\": \"9fdb9c1c0c0d9d001223bab8ad3df6a8\"\r\n    },\r\n    {\r\n      \"node\": \"node3@127.0.0.1\",\r\n      \"db_name\": \"shards/60000000-7fffffff/foo.1523467682\",\r\n      \"engine\": \"couch_bt_engine\",\r\n      \"doc_count\": 0,\r\n      \"doc_del_count\": 0,\r\n      \"update_seq\": 0,\r\n      \"purge_seq\": 0,\r\n      \"compact_running\": false,\r\n      \"sizes\": {\r\n        \"active\": 0,\r\n        \"external\": 0,\r\n        \"file\": 426\r\n      },\r\n      \"disk_size\": 426,\r\n      \"data_size\": 0,\r\n      \"other\": {\r\n        \"data_size\": 0\r\n      },\r\n      \"instance_start_time\": \"1523477073237239\",\r\n      \"disk_format_version\": 6,\r\n      \"committed_update_seq\": 0,\r\n      \"compacted_seq\": 0,\r\n      \"uuid\": \"e8f0d07865f2cb72ca973387f45943d1\"\r\n    },\r\n    {\r\n      \"node\": \"node2@127.0.0.1\",\r\n      \"db_name\": \"shards/60000000-7fffffff/foo.1523467682\",\r\n      \"engine\": \"couch_bt_engine\",\r\n      \"doc_count\": 0,\r\n      \"doc_del_count\": 0,\r\n      \"update_seq\": 0,\r\n      \"purge_seq\": 0,\r\n      \"compact_running\": false,\r\n      \"sizes\": {\r\n        \"active\": 0,\r\n        \"external\": 0,\r\n        \"file\": 435\r\n      },\r\n      \"disk_size\": 435,\r\n      \"data_size\": 0,\r\n      \"other\": {\r\n        \"data_size\": 0\r\n      },\r\n      \"instance_start_time\": \"1523477071961138\",\r\n      \"disk_format_version\": 6,\r\n      \"committed_update_seq\": 0,\r\n      \"compacted_seq\": 0,\r\n      \"uuid\": \"dedca0b3bdafb9ce343e7e6f46df184b\"\r\n    }\r\n  ],\r\n  \"e0000000-ffffffff\": [\r\n    {\r\n      \"node\": \"node1@127.0.0.1\",\r\n      \"db_name\": \"shards/e0000000-ffffffff/foo.1523467682\",\r\n      \"engine\": \"couch_bt_engine\",\r\n      \"doc_count\": 0,\r\n      \"doc_del_count\": 0,\r\n      \"update_seq\": 0,\r\n      \"purge_seq\": 0,\r\n      \"compact_running\": false,\r\n      \"sizes\": {\r\n        \"active\": 0,\r\n        \"external\": 0,\r\n        \"file\": 417\r\n      },\r\n      \"disk_size\": 417,\r\n      \"data_size\": 0,\r\n      \"other\": {\r\n        \"data_size\": 0\r\n      },\r\n      \"instance_start_time\": \"1523477072430401\",\r\n      \"disk_format_version\": 6,\r\n      \"committed_update_seq\": 0,\r\n      \"compacted_seq\": 0,\r\n      \"uuid\": \"3d5d18b024e87099e2c06550e547601a\"\r\n    },\r\n    {\r\n      \"node\": \"node2@127.0.0.1\",\r\n      \"db_name\": \"shards/e0000000-ffffffff/foo.1523467682\",\r\n      \"engine\": \"couch_bt_engine\",\r\n      \"doc_count\": 0,\r\n      \"doc_del_count\": 0,\r\n      \"update_seq\": 0,\r\n      \"purge_seq\": 0,\r\n      \"compact_running\": false,\r\n      \"sizes\": {\r\n        \"active\": 0,\r\n        \"external\": 0,\r\n        \"file\": 417\r\n      },\r\n      \"disk_size\": 417,\r\n      \"data_size\": 0,\r\n      \"other\": {\r\n        \"data_size\": 0\r\n      },\r\n      \"instance_start_time\": \"1523477071956612\",\r\n      \"disk_format_version\": 6,\r\n      \"committed_update_seq\": 0,\r\n      \"compacted_seq\": 0,\r\n      \"uuid\": \"c0c15b7452a4a27b0548896454e58b62\"\r\n    },\r\n    {\r\n      \"node\": \"node3@127.0.0.1\",\r\n      \"db_name\": \"shards/e0000000-ffffffff/foo.1523467682\",\r\n      \"engine\": \"couch_bt_engine\",\r\n      \"doc_count\": 0,\r\n      \"doc_del_count\": 0,\r\n      \"update_seq\": 0,\r\n      \"purge_seq\": 0,\r\n      \"compact_running\": false,\r\n      \"sizes\": {\r\n        \"active\": 0,\r\n        \"external\": 0,\r\n        \"file\": 435\r\n      },\r\n      \"disk_size\": 435,\r\n      \"data_size\": 0,\r\n      \"other\": {\r\n        \"data_size\": 0\r\n      },\r\n      \"instance_start_time\": \"1523477073236154\",\r\n      \"disk_format_version\": 6,\r\n      \"committed_update_seq\": 0,\r\n      \"compacted_seq\": 0,\r\n      \"uuid\": \"19c301651c7805e563e604a05ff5a4d2\"\r\n    }\r\n  ],\r\n  \"a0000000-bfffffff\": [\r\n    {\r\n      \"node\": \"node1@127.0.0.1\",\r\n      \"db_name\": \"shards/a0000000-bfffffff/foo.1523467682\",\r\n      \"engine\": \"couch_bt_engine\",\r\n      \"doc_count\": 0,\r\n      \"doc_del_count\": 0,\r\n      \"update_seq\": 0,\r\n      \"purge_seq\": 0,\r\n      \"compact_running\": false,\r\n      \"sizes\": {\r\n        \"active\": 0,\r\n        \"external\": 0,\r\n        \"file\": 372\r\n      },\r\n      \"disk_size\": 372,\r\n      \"data_size\": 0,\r\n      \"other\": {\r\n        \"data_size\": 0\r\n      },\r\n      \"instance_start_time\": \"1523477072435637\",\r\n      \"disk_format_version\": 6,\r\n      \"committed_update_seq\": 0,\r\n      \"compacted_seq\": 0,\r\n      \"uuid\": \"10b05bd79fa0c687c9278a1be4d52655\"\r\n    },\r\n    {\r\n      \"node\": \"node3@127.0.0.1\",\r\n      \"db_name\": \"shards/a0000000-bfffffff/foo.1523467682\",\r\n      \"engine\": \"couch_bt_engine\",\r\n      \"doc_count\": 0,\r\n      \"doc_del_count\": 0,\r\n      \"update_seq\": 0,\r\n      \"purge_seq\": 0,\r\n      \"compact_running\": false,\r\n      \"sizes\": {\r\n        \"active\": 0,\r\n        \"external\": 0,\r\n        \"file\": 372\r\n      },\r\n      \"disk_size\": 372,\r\n      \"data_size\": 0,\r\n      \"other\": {\r\n        \"data_size\": 0\r\n      },\r\n      \"instance_start_time\": \"1523477073236989\",\r\n      \"disk_format_version\": 6,\r\n      \"committed_update_seq\": 0,\r\n      \"compacted_seq\": 0,\r\n      \"uuid\": \"016120607e4033560501df5200348d79\"\r\n    },\r\n    {\r\n      \"node\": \"node2@127.0.0.1\",\r\n      \"db_name\": \"shards/a0000000-bfffffff/foo.1523467682\",\r\n      \"engine\": \"couch_bt_engine\",\r\n      \"doc_count\": 0,\r\n      \"doc_del_count\": 0,\r\n      \"update_seq\": 0,\r\n      \"purge_seq\": 0,\r\n      \"compact_running\": false,\r\n      \"sizes\": {\r\n        \"active\": 0,\r\n        \"external\": 0,\r\n        \"file\": 363\r\n      },\r\n      \"disk_size\": 363,\r\n      \"data_size\": 0,\r\n      \"other\": {\r\n        \"data_size\": 0\r\n      },\r\n      \"instance_start_time\": \"1523477071956934\",\r\n      \"disk_format_version\": 6,\r\n      \"committed_update_seq\": 0,\r\n      \"compacted_seq\": 0,\r\n      \"uuid\": \"9e3007e8b50000e0d8d8edbd6503f618\"\r\n    }\r\n  ],\r\n  \"00000000-1fffffff\": [\r\n    {\r\n      \"node\": \"node1@127.0.0.1\",\r\n      \"db_name\": \"shards/00000000-1fffffff/foo.1523467682\",\r\n      \"engine\": \"couch_bt_engine\",\r\n      \"doc_count\": 0,\r\n      \"doc_del_count\": 0,\r\n      \"update_seq\": 0,\r\n      \"purge_seq\": 0,\r\n      \"compact_running\": false,\r\n      \"sizes\": {\r\n        \"active\": 0,\r\n        \"external\": 0,\r\n        \"file\": 426\r\n      },\r\n      \"disk_size\": 426,\r\n      \"data_size\": 0,\r\n      \"other\": {\r\n        \"data_size\": 0\r\n      },\r\n      \"instance_start_time\": \"1523477072463438\",\r\n      \"disk_format_version\": 6,\r\n      \"committed_update_seq\": 0,\r\n      \"compacted_seq\": 0,\r\n      \"uuid\": \"f02ab0ed43b3e8d751858cb09ef68629\"\r\n    },\r\n    {\r\n      \"node\": \"node3@127.0.0.1\",\r\n      \"db_name\": \"shards/00000000-1fffffff/foo.1523467682\",\r\n      \"engine\": \"couch_bt_engine\",\r\n      \"doc_count\": 0,\r\n      \"doc_del_count\": 0,\r\n      \"update_seq\": 0,\r\n      \"purge_seq\": 0,\r\n      \"compact_running\": false,\r\n      \"sizes\": {\r\n        \"active\": 0,\r\n        \"external\": 0,\r\n        \"file\": 435\r\n      },\r\n      \"disk_size\": 435,\r\n      \"data_size\": 0,\r\n      \"other\": {\r\n        \"data_size\": 0\r\n      },\r\n      \"instance_start_time\": \"1523477073242390\",\r\n      \"disk_format_version\": 6,\r\n      \"committed_update_seq\": 0,\r\n      \"compacted_seq\": 0,\r\n      \"uuid\": \"4eafc1a5d99f0186262d6e18b158bff2\"\r\n    },\r\n    {\r\n      \"node\": \"node2@127.0.0.1\",\r\n      \"db_name\": \"shards/00000000-1fffffff/foo.1523467682\",\r\n      \"engine\": \"couch_bt_engine\",\r\n      \"doc_count\": 0,\r\n      \"doc_del_count\": 0,\r\n      \"update_seq\": 0,\r\n      \"purge_seq\": 0,\r\n      \"compact_running\": false,\r\n      \"sizes\": {\r\n        \"active\": 0,\r\n        \"external\": 0,\r\n        \"file\": 426\r\n      },\r\n      \"disk_size\": 426,\r\n      \"data_size\": 0,\r\n      \"other\": {\r\n        \"data_size\": 0\r\n      },\r\n      \"instance_start_time\": \"1523477072002749\",\r\n      \"disk_format_version\": 6,\r\n      \"committed_update_seq\": 0,\r\n      \"compacted_seq\": 0,\r\n      \"uuid\": \"4f5b9ad166ad799e8fcee215c12b0174\"\r\n    }\r\n  ],\r\n  \"40000000-5fffffff\": [\r\n    {\r\n      \"node\": \"node1@127.0.0.1\",\r\n      \"db_name\": \"shards/40000000-5fffffff/foo.1523467682\",\r\n      \"engine\": \"couch_bt_engine\",\r\n      \"doc_count\": 0,\r\n      \"doc_del_count\": 0,\r\n      \"update_seq\": 0,\r\n      \"purge_seq\": 0,\r\n      \"compact_running\": false,\r\n      \"sizes\": {\r\n        \"active\": 0,\r\n        \"external\": 0,\r\n        \"file\": 372\r\n      },\r\n      \"disk_size\": 372,\r\n      \"data_size\": 0,\r\n      \"other\": {\r\n        \"data_size\": 0\r\n      },\r\n      \"instance_start_time\": \"1523477072465036\",\r\n      \"disk_format_version\": 6,\r\n      \"committed_update_seq\": 0,\r\n      \"compacted_seq\": 0,\r\n      \"uuid\": \"517a4b80cb945f782221b54ce2a19289\"\r\n    },\r\n    {\r\n      \"node\": \"node3@127.0.0.1\",\r\n      \"db_name\": \"shards/40000000-5fffffff/foo.1523467682\",\r\n      \"engine\": \"couch_bt_engine\",\r\n      \"doc_count\": 0,\r\n      \"doc_del_count\": 0,\r\n      \"update_seq\": 0,\r\n      \"purge_seq\": 0,\r\n      \"compact_running\": false,\r\n      \"sizes\": {\r\n        \"active\": 0,\r\n        \"external\": 0,\r\n        \"file\": 363\r\n      },\r\n      \"disk_size\": 363,\r\n      \"data_size\": 0,\r\n      \"other\": {\r\n        \"data_size\": 0\r\n      },\r\n      \"instance_start_time\": \"1523477073241846\",\r\n      \"disk_format_version\": 6,\r\n      \"committed_update_seq\": 0,\r\n      \"compacted_seq\": 0,\r\n      \"uuid\": \"3e83fc508aec5d54b7030f8f9e916097\"\r\n    },\r\n    {\r\n      \"node\": \"node2@127.0.0.1\",\r\n      \"db_name\": \"shards/40000000-5fffffff/foo.1523467682\",\r\n      \"engine\": \"couch_bt_engine\",\r\n      \"doc_count\": 0,\r\n      \"doc_del_count\": 0,\r\n      \"update_seq\": 0,\r\n      \"purge_seq\": 0,\r\n      \"compact_running\": false,\r\n      \"sizes\": {\r\n        \"active\": 0,\r\n        \"external\": 0,\r\n        \"file\": 363\r\n      },\r\n      \"disk_size\": 363,\r\n      \"data_size\": 0,\r\n      \"other\": {\r\n        \"data_size\": 0\r\n      },\r\n      \"instance_start_time\": \"1523477071999486\",\r\n      \"disk_format_version\": 6,\r\n      \"committed_update_seq\": 0,\r\n      \"compacted_seq\": 0,\r\n      \"uuid\": \"5a1c4c279b7cf6f7fa74f0fdb90379a7\"\r\n    }\r\n  ],\r\n  \"80000000-9fffffff\": [\r\n    {\r\n      \"node\": \"node1@127.0.0.1\",\r\n      \"db_name\": \"shards/80000000-9fffffff/foo.1523467682\",\r\n      \"engine\": \"couch_bt_engine\",\r\n      \"doc_count\": 0,\r\n      \"doc_del_count\": 0,\r\n      \"update_seq\": 0,\r\n      \"purge_seq\": 0,\r\n      \"compact_running\": false,\r\n      \"sizes\": {\r\n        \"active\": 0,\r\n        \"external\": 0,\r\n        \"file\": 372\r\n      },\r\n      \"disk_size\": 372,\r\n      \"data_size\": 0,\r\n      \"other\": {\r\n        \"data_size\": 0\r\n      },\r\n      \"instance_start_time\": \"1523477072445630\",\r\n      \"disk_format_version\": 6,\r\n      \"committed_update_seq\": 0,\r\n      \"compacted_seq\": 0,\r\n      \"uuid\": \"5a9f7552bdb04a938754fbc6060a2639\"\r\n    },\r\n    {\r\n      \"node\": \"node3@127.0.0.1\",\r\n      \"db_name\": \"shards/80000000-9fffffff/foo.1523467682\",\r\n      \"engine\": \"couch_bt_engine\",\r\n      \"doc_count\": 0,\r\n      \"doc_del_count\": 0,\r\n      \"update_seq\": 0,\r\n      \"purge_seq\": 0,\r\n      \"compact_running\": false,\r\n      \"sizes\": {\r\n        \"active\": 0,\r\n        \"external\": 0,\r\n        \"file\": 372\r\n      },\r\n      \"disk_size\": 372,\r\n      \"data_size\": 0,\r\n      \"other\": {\r\n        \"data_size\": 0\r\n      },\r\n      \"instance_start_time\": \"1523477073237006\",\r\n      \"disk_format_version\": 6,\r\n      \"committed_update_seq\": 0,\r\n      \"compacted_seq\": 0,\r\n      \"uuid\": \"acc4c996ecc232d053badfaab5da07a3\"\r\n    },\r\n    {\r\n      \"node\": \"node2@127.0.0.1\",\r\n      \"db_name\": \"shards/80000000-9fffffff/foo.1523467682\",\r\n      \"engine\": \"couch_bt_engine\",\r\n      \"doc_count\": 0,\r\n      \"doc_del_count\": 0,\r\n      \"update_seq\": 0,\r\n      \"purge_seq\": 0,\r\n      \"compact_running\": false,\r\n      \"sizes\": {\r\n        \"active\": 0,\r\n        \"external\": 0,\r\n        \"file\": 363\r\n      },\r\n      \"disk_size\": 363,\r\n      \"data_size\": 0,\r\n      \"other\": {\r\n        \"data_size\": 0\r\n      },\r\n      \"instance_start_time\": \"1523477071956950\",\r\n      \"disk_format_version\": 6,\r\n      \"committed_update_seq\": 0,\r\n      \"compacted_seq\": 0,\r\n      \"uuid\": \"5a51709992c93ade79824a0bb989265e\"\r\n    }\r\n  ]\r\n}\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/380580320/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/380722280","html_url":"https://github.com/apache/couchdb/issues/1184#issuecomment-380722280","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1184","id":380722280,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MDcyMjI4MA==","user":{"login":"jareware","id":560055,"node_id":"MDQ6VXNlcjU2MDA1NQ==","avatar_url":"https://avatars.githubusercontent.com/u/560055?v=4","gravatar_id":"","url":"https://api.github.com/users/jareware","html_url":"https://github.com/jareware","followers_url":"https://api.github.com/users/jareware/followers","following_url":"https://api.github.com/users/jareware/following{/other_user}","gists_url":"https://api.github.com/users/jareware/gists{/gist_id}","starred_url":"https://api.github.com/users/jareware/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jareware/subscriptions","organizations_url":"https://api.github.com/users/jareware/orgs","repos_url":"https://api.github.com/users/jareware/repos","events_url":"https://api.github.com/users/jareware/events{/privacy}","received_events_url":"https://api.github.com/users/jareware/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-12T08:31:08Z","updated_at":"2018-04-12T08:31:08Z","author_association":"NONE","body":"Thanks a lot for the thoughtful reply! And I'm glad this has been fixed on master already.\r\n\r\nSuppose this still leaves me with the mystery of how my humble little validation function could take over 5 seconds to complete (it really doesn't do anything besides comparing a few values on the doc and user context), but maybe I'll start by upping that timeout.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/380722280/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/380736113","html_url":"https://github.com/apache/couchdb/issues/1266#issuecomment-380736113","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1266","id":380736113,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MDczNjExMw==","user":{"login":"pnagle","id":13343356,"node_id":"MDQ6VXNlcjEzMzQzMzU2","avatar_url":"https://avatars.githubusercontent.com/u/13343356?v=4","gravatar_id":"","url":"https://api.github.com/users/pnagle","html_url":"https://github.com/pnagle","followers_url":"https://api.github.com/users/pnagle/followers","following_url":"https://api.github.com/users/pnagle/following{/other_user}","gists_url":"https://api.github.com/users/pnagle/gists{/gist_id}","starred_url":"https://api.github.com/users/pnagle/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pnagle/subscriptions","organizations_url":"https://api.github.com/users/pnagle/orgs","repos_url":"https://api.github.com/users/pnagle/repos","events_url":"https://api.github.com/users/pnagle/events{/privacy}","received_events_url":"https://api.github.com/users/pnagle/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-12T09:19:07Z","updated_at":"2018-04-12T09:19:07Z","author_association":"NONE","body":"Thanks for the prompt reply guys. Have you found anything? If you want any more clarifications let me know.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/380736113/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/380801120","html_url":"https://github.com/apache/couchdb/issues/1266#issuecomment-380801120","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1266","id":380801120,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MDgwMTEyMA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-12T13:16:10Z","updated_at":"2018-04-12T13:16:10Z","author_association":"MEMBER","body":"If you can provide a script that allows for regular reproduction of the problem, that'd be very helpful.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/380801120/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/380826262","html_url":"https://github.com/apache/couchdb/issues/1073#issuecomment-380826262","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1073","id":380826262,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MDgyNjI2Mg==","user":{"login":"grahamsnz","id":13211139,"node_id":"MDQ6VXNlcjEzMjExMTM5","avatar_url":"https://avatars.githubusercontent.com/u/13211139?v=4","gravatar_id":"","url":"https://api.github.com/users/grahamsnz","html_url":"https://github.com/grahamsnz","followers_url":"https://api.github.com/users/grahamsnz/followers","following_url":"https://api.github.com/users/grahamsnz/following{/other_user}","gists_url":"https://api.github.com/users/grahamsnz/gists{/gist_id}","starred_url":"https://api.github.com/users/grahamsnz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/grahamsnz/subscriptions","organizations_url":"https://api.github.com/users/grahamsnz/orgs","repos_url":"https://api.github.com/users/grahamsnz/repos","events_url":"https://api.github.com/users/grahamsnz/events{/privacy}","received_events_url":"https://api.github.com/users/grahamsnz/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-12T14:31:34Z","updated_at":"2018-04-12T14:33:47Z","author_association":"NONE","body":"@wohali I'm also experiencing this remaining `rexi` issue. I'm not using the replicator but a custom tool which copies batches of 100 documents from a source. \r\n\r\nWhen the below `rexi` error occurs, the batch fails to provide the copy tool with the needed `201 OK` which allows the next batch of 100 documents to be sent. Without the affirmative reply, my document copy tool fails to progress and it's position is lost. \r\n\r\n```\r\n[error] 2018-04-12T14:32:14.885843Z couchdb@hostname-removed <0.20568.192> -------- rexi_server: from: couchdb@hostname-removed(<0.28033.198>) mfa: fabric_rpc:all_docs/3 exit:timeout [{rexi,init_stream,1,[{file,\"src/rexi.erl\"},{line,256}]},{rexi,stream2,3,[{file,\"src/rexi.erl\"},{line,204}]},{fabric_rpc,view_cb,2,[{file,\"src/fabric_rpc.erl\"},{line,308}]},{couch_mrview,finish_fold,2,[{file,\"src/couch_mrview.erl\"},{line,642}]},{rexi_server,init_p,3,[{file,\"src/rexi_server.erl\"},{line,139}]}]\r\n[error] 2018-04-12T14:32:14.886158Z couchdb@hostname-removed <0.2978.199> -------- rexi_server: from: couchdb@hostname-removed(<0.28033.198>) mfa: fabric_rpc:all_docs/3 exit:timeout [{rexi,init_stream,1,[{file,\"src/rexi.erl\"},{line,256}]},{rexi,stream2,3,[{file,\"src/rexi.erl\"},{line,204}]},{fabric_rpc,view_cb,2,[{file,\"src/fabric_rpc.erl\"},{line,308}]},{couch_mrview,map_fold,3,[{file,\"src/couch_mrview.erl\"},{line,511}]},{couch_btree,stream_kv_node2,8,[{file,\"src/couch_btree.erl\"},{line,848}]},{couch_btree,stream_kp_node,8,[{file,\"src/couch_btree.erl\"},{line,819}]},{couch_btree,fold,4,[{file,\"src/couch_btree.erl\"},{line,222}]},{couch_db,enum_docs,5,[{file,\"src/couch_db.erl\"},{line,1450}]}]\r\n[error] 2018-04-12T14:32:14.886183Z couchdb@hostname-removed <0.3631.188> -------- rexi_server: from: couchdb@hostname-removed(<0.28033.198>) mfa: fabric_rpc:all_docs/3 exit:timeout [{rexi,init_stream,1,[{file,\"src/rexi.erl\"},{line,256}]},{rexi,stream2,3,[{file,\"src/rexi.erl\"},{line,204}]},{fabric_rpc,view_cb,2,[{file,\"src/fabric_rpc.erl\"},{line,308}]},{couch_mrview,finish_fold,2,[{file,\"src/couch_mrview.erl\"},{line,642}]},{rexi_server,init_p,3,[{file,\"src/rexi_server.erl\"},{line,139}]}]\r\n[error] 2018-04-12T14:32:14.886279Z couchdb@hostname-removed <0.22947.194> -------- rexi_server: from: couchdb@hostname-removed(<0.28033.198>) mfa: fabric_rpc:all_docs/3 exit:timeout [{rexi,init_stream,1,[{file,\"src/rexi.erl\"},{line,256}]},{rexi,stream2,3,[{file,\"src/rexi.erl\"},{line,204}]},{fabric_rpc,view_cb,2,[{file,\"src/fabric_rpc.erl\"},{line,308}]},{couch_mrview,finish_fold,2,[{file,\"src/couch_mrview.erl\"},{line,642}]},{rexi_server,init_p,3,[{file,\"src/rexi_server.erl\"},{line,139}]}]\r\n[error] 2018-04-12T14:32:14.886336Z couchdb@hostname-removed <0.31484.202> -------- rexi_server: from: couchdb@hostname-removed(<0.28033.198>) mfa: fabric_rpc:all_docs/3 exit:timeout [{rexi,init_stream,1,[{file,\"src/rexi.erl\"},{line,256}]},{rexi,stream2,3,[{file,\"src/rexi.erl\"},{line,204}]},{fabric_rpc,view_cb,2,[{file,\"src/fabric_rpc.erl\"},{line,308}]},{couch_mrview,map_fold,3,[{file,\"src/couch_mrview.erl\"},{line,511}]},{couch_btree,stream_kv_node2,8,[{file,\"src/couch_btree.erl\"},{line,848}]},{couch_btree,stream_kp_node,8,[{file,\"src/couch_btree.erl\"},{line,819}]},{couch_btree,fold,4,[{file,\"src/couch_btree.erl\"},{line,222}]},{couch_db,enum_docs,5,[{file,\"src/couch_db.erl\"},{line,1450}]}]\r\n[error] 2018-04-12T14:32:14.886809Z couchdb@hostname-removed <0.30230.195> -------- rexi_server: from: couchdb@hostname-removed(<0.28033.198>) mfa: fabric_rpc:all_docs/3 exit:timeout [{rexi,init_stream,1,[{file,\"src/rexi.erl\"},{line,256}]},{rexi,stream2,3,[{file,\"src/rexi.erl\"},{line,204}]},{fabric_rpc,view_cb,2,[{file,\"src/fabric_rpc.erl\"},{line,308}]},{couch_mrview,map_fold,3,[{file,\"src/couch_mrview.erl\"},{line,511}]},{couch_btree,stream_kv_node2,8,[{file,\"src/couch_btree.erl\"},{line,848}]},{couch_btree,stream_kp_node,8,[{file,\"src/couch_btree.erl\"},{line,819}]},{couch_btree,fold,4,[{file,\"src/couch_btree.erl\"},{line,222}]},{couch_db,enum_docs,5,[{file,\"src/couch_db.erl\"},{line,1450}]}]\r\n[error] 2018-04-12T14:32:14.886892Z couchdb@hostname-removed <0.17694.179> -------- rexi_server: from: couchdb@hostname-removed(<0.28033.198>) mfa: fabric_rpc:all_docs/3 exit:timeout [{rexi,init_stream,1,[{file,\"src/rexi.erl\"},{line,256}]},{rexi,stream2,3,[{file,\"src/rexi.erl\"},{line,204}]},{fabric_rpc,view_cb,2,[{file,\"src/fabric_rpc.erl\"},{line,308}]},{couch_mrview,map_fold,3,[{file,\"src/couch_mrview.erl\"},{line,511}]},{couch_btree,stream_kv_node2,8,[{file,\"src/couch_btree.erl\"},{line,848}]},{couch_btree,stream_kp_node,8,[{file,\"src/couch_btree.erl\"},{line,819}]},{couch_btree,fold,4,[{file,\"src/couch_btree.erl\"},{line,222}]},{couch_db,enum_docs,5,[{file,\"src/couch_db.erl\"},{line,1450}]}]\r\n[error] 2018-04-12T14:32:14.887968Z couchdb@hostname-removed <0.20630.199> -------- rexi_server: from: couchdb@hostname-removed(<0.28033.198>) mfa: fabric_rpc:all_docs/3 exit:timeout [{rexi,init_stream,1,[{file,\"src/rexi.erl\"},{line,256}]},{rexi,stream2,3,[{file,\"src/rexi.erl\"},{line,204}]},{fabric_rpc,view_cb,2,[{file,\"src/fabric_rpc.erl\"},{line,308}]},{couch_mrview,map_fold,3,[{file,\"src/couch_mrview.erl\"},{line,511}]},{couch_btree,stream_kv_node2,8,[{file,\"src/couch_btree.erl\"},{line,848}]},{couch_btree,stream_kp_node,8,[{file,\"src/couch_btree.erl\"},{line,819}]},{couch_btree,fold,4,[{file,\"src/couch_btree.erl\"},{line,222}]},{couch_db,enum_docs,5,[{file,\"src/couch_db.erl\"},{line,1450}]}]\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/380826262/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/380857954","html_url":"https://github.com/apache/couchdb/issues/1073#issuecomment-380857954","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1073","id":380857954,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MDg1Nzk1NA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-12T16:04:02Z","updated_at":"2018-04-12T16:04:02Z","author_association":"MEMBER","body":"@grahamsnz Can you please file a new issue? Thanks. You can reference this one in that.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/380857954/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/380858688","html_url":"https://github.com/apache/couchdb/issues/1279#issuecomment-380858688","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1279","id":380858688,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MDg1ODY4OA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-12T16:06:27Z","updated_at":"2018-04-12T16:06:27Z","author_association":"MEMBER","body":"1. CouchDB 2.0.0 is outdated and has serious security holes, upgrade to 2.1.1 as soon as possible\r\n2. Looks like your `default.ini` file is outdated, be sure to update to the latest as shipped with the product. You should never modify `default.ini` yourself. Always only update `etc/local.ini` or  `etc/local.d.*.ini` files.\r\n\r\nIf the above doesn't solve your problem, request a reopen of this issue and post additional detail.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/380858688/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/380905813","html_url":"https://github.com/apache/couchdb/pull/1187#issuecomment-380905813","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1187","id":380905813,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MDkwNTgxMw==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-12T18:43:46Z","updated_at":"2018-04-12T18:43:46Z","author_association":"MEMBER","body":"Here's a list of tests I thought of while going through the refactoring work on my brach:\r\n\r\nhttps://gist.github.com/davisp/722a61c9d7ba03dc383fff481b61ca61","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/380905813/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/381126539","html_url":"https://github.com/apache/couchdb/pull/1273#issuecomment-381126539","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1273","id":381126539,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MTEyNjUzOQ==","user":{"login":"eiri","id":70542,"node_id":"MDQ6VXNlcjcwNTQy","avatar_url":"https://avatars.githubusercontent.com/u/70542?v=4","gravatar_id":"","url":"https://api.github.com/users/eiri","html_url":"https://github.com/eiri","followers_url":"https://api.github.com/users/eiri/followers","following_url":"https://api.github.com/users/eiri/following{/other_user}","gists_url":"https://api.github.com/users/eiri/gists{/gist_id}","starred_url":"https://api.github.com/users/eiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eiri/subscriptions","organizations_url":"https://api.github.com/users/eiri/orgs","repos_url":"https://api.github.com/users/eiri/repos","events_url":"https://api.github.com/users/eiri/events{/privacy}","received_events_url":"https://api.github.com/users/eiri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-13T12:55:59Z","updated_at":"2018-04-13T13:11:10Z","author_association":"MEMBER","body":"...and just like this I can't reproduce it anymore. I'm going to open a separate issue for mem3_shards test and rebase and merge this PR.\r\n\r\n*Update:* #1282","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/381126539/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/381225892","html_url":"https://github.com/apache/couchdb/pull/1283#issuecomment-381225892","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1283","id":381225892,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MTIyNTg5Mg==","user":{"login":"chewbranca","id":5326,"node_id":"MDQ6VXNlcjUzMjY=","avatar_url":"https://avatars.githubusercontent.com/u/5326?v=4","gravatar_id":"","url":"https://api.github.com/users/chewbranca","html_url":"https://github.com/chewbranca","followers_url":"https://api.github.com/users/chewbranca/followers","following_url":"https://api.github.com/users/chewbranca/following{/other_user}","gists_url":"https://api.github.com/users/chewbranca/gists{/gist_id}","starred_url":"https://api.github.com/users/chewbranca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chewbranca/subscriptions","organizations_url":"https://api.github.com/users/chewbranca/orgs","repos_url":"https://api.github.com/users/chewbranca/repos","events_url":"https://api.github.com/users/chewbranca/events{/privacy}","received_events_url":"https://api.github.com/users/chewbranca/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-13T18:40:00Z","updated_at":"2018-04-13T18:40:00Z","author_association":"CONTRIBUTOR","body":"+1","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/381225892/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/381226262","html_url":"https://github.com/apache/couchdb/pull/1283#issuecomment-381226262","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1283","id":381226262,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MTIyNjI2Mg==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-13T18:41:22Z","updated_at":"2018-04-13T18:41:22Z","author_association":"CONTRIBUTOR","body":"Default is false though. +1 after switching to default","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/381226262/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/381226698","html_url":"https://github.com/apache/couchdb/pull/1283#issuecomment-381226698","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1283","id":381226698,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MTIyNjY5OA==","user":{"login":"chewbranca","id":5326,"node_id":"MDQ6VXNlcjUzMjY=","avatar_url":"https://avatars.githubusercontent.com/u/5326?v=4","gravatar_id":"","url":"https://api.github.com/users/chewbranca","html_url":"https://github.com/chewbranca","followers_url":"https://api.github.com/users/chewbranca/followers","following_url":"https://api.github.com/users/chewbranca/following{/other_user}","gists_url":"https://api.github.com/users/chewbranca/gists{/gist_id}","starred_url":"https://api.github.com/users/chewbranca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chewbranca/subscriptions","organizations_url":"https://api.github.com/users/chewbranca/orgs","repos_url":"https://api.github.com/users/chewbranca/repos","events_url":"https://api.github.com/users/chewbranca/events{/privacy}","received_events_url":"https://api.github.com/users/chewbranca/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-13T18:42:58Z","updated_at":"2018-04-13T18:42:58Z","author_association":"CONTRIBUTOR","body":"@nickva docs say to uncomment the line to enable though. So either need to update the docs to reflect the default value and changing it, or leave it as is. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/381226698/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/381233069","html_url":"https://github.com/apache/couchdb/pull/1283#issuecomment-381233069","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1283","id":381233069,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MTIzMzA2OQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-13T19:05:55Z","updated_at":"2018-04-13T19:05:55Z","author_association":"MEMBER","body":"Updated as @nickva requests since that matches how everything else is done (include the default value, commented out)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/381233069/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/381239564","html_url":"https://github.com/apache/couchdb/issues/884#issuecomment-381239564","issue_url":"https://api.github.com/repos/apache/couchdb/issues/884","id":381239564,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MTIzOTU2NA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-13T19:32:00Z","updated_at":"2018-04-13T19:32:00Z","author_association":"MEMBER","body":"Saw this as recently as today... :(","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/381239564/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/381306681","html_url":"https://github.com/apache/couchdb/issues/1266#issuecomment-381306681","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1266","id":381306681,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MTMwNjY4MQ==","user":{"login":"pnagle","id":13343356,"node_id":"MDQ6VXNlcjEzMzQzMzU2","avatar_url":"https://avatars.githubusercontent.com/u/13343356?v=4","gravatar_id":"","url":"https://api.github.com/users/pnagle","html_url":"https://github.com/pnagle","followers_url":"https://api.github.com/users/pnagle/followers","following_url":"https://api.github.com/users/pnagle/following{/other_user}","gists_url":"https://api.github.com/users/pnagle/gists{/gist_id}","starred_url":"https://api.github.com/users/pnagle/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pnagle/subscriptions","organizations_url":"https://api.github.com/users/pnagle/orgs","repos_url":"https://api.github.com/users/pnagle/repos","events_url":"https://api.github.com/users/pnagle/events{/privacy}","received_events_url":"https://api.github.com/users/pnagle/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-14T06:09:52Z","updated_at":"2018-04-14T06:09:52Z","author_association":"NONE","body":"Sure, we are working on the script. Will share as soon as we get it done.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/381306681/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/381333794","html_url":"https://github.com/apache/couchdb/issues/774#issuecomment-381333794","issue_url":"https://api.github.com/repos/apache/couchdb/issues/774","id":381333794,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MTMzMzc5NA==","user":{"login":"devios1","id":1421060,"node_id":"MDQ6VXNlcjE0MjEwNjA=","avatar_url":"https://avatars.githubusercontent.com/u/1421060?v=4","gravatar_id":"","url":"https://api.github.com/users/devios1","html_url":"https://github.com/devios1","followers_url":"https://api.github.com/users/devios1/followers","following_url":"https://api.github.com/users/devios1/following{/other_user}","gists_url":"https://api.github.com/users/devios1/gists{/gist_id}","starred_url":"https://api.github.com/users/devios1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/devios1/subscriptions","organizations_url":"https://api.github.com/users/devios1/orgs","repos_url":"https://api.github.com/users/devios1/repos","events_url":"https://api.github.com/users/devios1/events{/privacy}","received_events_url":"https://api.github.com/users/devios1/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-14T14:41:32Z","updated_at":"2018-04-14T14:41:32Z","author_association":"NONE","body":"To others struggling with this issue, I found this answer on SO to be the solution: https://stackoverflow.com/a/41122156/238948","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/381333794/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/381496003","html_url":"https://github.com/apache/couchdb/issues/774#issuecomment-381496003","issue_url":"https://api.github.com/repos/apache/couchdb/issues/774","id":381496003,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MTQ5NjAwMw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-16T06:45:41Z","updated_at":"2018-04-16T06:45:41Z","author_association":"MEMBER","body":"@devios1 And this is in our documentation: http://docs.couchdb.org/en/2.1.1/maintenance/performance.html#system-resource-limits","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/381496003/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/381680367","html_url":"https://github.com/apache/couchdb/issues/1282#issuecomment-381680367","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1282","id":381680367,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MTY4MDM2Nw==","user":{"login":"eiri","id":70542,"node_id":"MDQ6VXNlcjcwNTQy","avatar_url":"https://avatars.githubusercontent.com/u/70542?v=4","gravatar_id":"","url":"https://api.github.com/users/eiri","html_url":"https://github.com/eiri","followers_url":"https://api.github.com/users/eiri/followers","following_url":"https://api.github.com/users/eiri/following{/other_user}","gists_url":"https://api.github.com/users/eiri/gists{/gist_id}","starred_url":"https://api.github.com/users/eiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eiri/subscriptions","organizations_url":"https://api.github.com/users/eiri/orgs","repos_url":"https://api.github.com/users/eiri/repos","events_url":"https://api.github.com/users/eiri/events{/privacy}","received_events_url":"https://api.github.com/users/eiri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-16T17:12:55Z","updated_at":"2018-04-16T17:12:55Z","author_association":"MEMBER","body":"Minimal set of test suites to reproduce: `make eunit apps=mem3 suites=mem3_sync_security_test,mem3_util_test,mem3_shards`","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/381680367/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/381873193","html_url":"https://github.com/apache/couchdb/issues/1051#issuecomment-381873193","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1051","id":381873193,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MTg3MzE5Mw==","user":{"login":"jareware","id":560055,"node_id":"MDQ6VXNlcjU2MDA1NQ==","avatar_url":"https://avatars.githubusercontent.com/u/560055?v=4","gravatar_id":"","url":"https://api.github.com/users/jareware","html_url":"https://github.com/jareware","followers_url":"https://api.github.com/users/jareware/followers","following_url":"https://api.github.com/users/jareware/following{/other_user}","gists_url":"https://api.github.com/users/jareware/gists{/gist_id}","starred_url":"https://api.github.com/users/jareware/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jareware/subscriptions","organizations_url":"https://api.github.com/users/jareware/orgs","repos_url":"https://api.github.com/users/jareware/repos","events_url":"https://api.github.com/users/jareware/events{/privacy}","received_events_url":"https://api.github.com/users/jareware/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-17T07:12:09Z","updated_at":"2018-04-17T07:12:09Z","author_association":"NONE","body":"We're on the (new) IBM-hosted Cloudant, and have randomly gotten a few:\r\n\r\n```\r\n{ error: 'unknown_error', \r\n  reason: 'function_clause', \r\n  ref: 687197157, \r\n  name: 'unknown_error', \r\n  status: 500, \r\n  message: 'function_clause' } \r\n```\r\n\r\non our logs. It's from a `_changes` listener, so shouldn't have anything to do with password hashing.\r\n\r\nAny ideas..?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/381873193/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/381972442","html_url":"https://github.com/apache/couchdb/issues/1051#issuecomment-381972442","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1051","id":381972442,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MTk3MjQ0Mg==","user":{"login":"eiri","id":70542,"node_id":"MDQ6VXNlcjcwNTQy","avatar_url":"https://avatars.githubusercontent.com/u/70542?v=4","gravatar_id":"","url":"https://api.github.com/users/eiri","html_url":"https://github.com/eiri","followers_url":"https://api.github.com/users/eiri/followers","following_url":"https://api.github.com/users/eiri/following{/other_user}","gists_url":"https://api.github.com/users/eiri/gists{/gist_id}","starred_url":"https://api.github.com/users/eiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eiri/subscriptions","organizations_url":"https://api.github.com/users/eiri/orgs","repos_url":"https://api.github.com/users/eiri/repos","events_url":"https://api.github.com/users/eiri/events{/privacy}","received_events_url":"https://api.github.com/users/eiri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-17T12:21:19Z","updated_at":"2018-04-17T12:21:19Z","author_association":"MEMBER","body":"Exit reason `function_clause` is a pretty generic erlang error, meaning that no matching function clause was found when evaluating a function call. It could be thrown from any part of CouchDB and error 500 with `unknown_error` is just `chttpd`'s error wrapper for all generic failures on a server side. \r\n\r\nIt's impossible to tell what went wrong just by this gist, try to raise this with Cloudant's support next time you'll get this error and provide them account, database name and ref number, so they can trace the error in the server side logs.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/381972442/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/382004345","html_url":"https://github.com/apache/couchdb/issues/1284#issuecomment-382004345","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1284","id":382004345,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MjAwNDM0NQ==","user":{"login":"eiri","id":70542,"node_id":"MDQ6VXNlcjcwNTQy","avatar_url":"https://avatars.githubusercontent.com/u/70542?v=4","gravatar_id":"","url":"https://api.github.com/users/eiri","html_url":"https://github.com/eiri","followers_url":"https://api.github.com/users/eiri/followers","following_url":"https://api.github.com/users/eiri/following{/other_user}","gists_url":"https://api.github.com/users/eiri/gists{/gist_id}","starred_url":"https://api.github.com/users/eiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eiri/subscriptions","organizations_url":"https://api.github.com/users/eiri/orgs","repos_url":"https://api.github.com/users/eiri/repos","events_url":"https://api.github.com/users/eiri/events{/privacy}","received_events_url":"https://api.github.com/users/eiri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-17T14:03:49Z","updated_at":"2018-04-17T14:03:49Z","author_association":"MEMBER","body":"No there are not such functionality in couch_log. This is traditionally done with external tools, e.g. [logrotate](https://manpages.debian.org/jessie/logrotate/logrotate.8.en.html).","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/382004345/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]