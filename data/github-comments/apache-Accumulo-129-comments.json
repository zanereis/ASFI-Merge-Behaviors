[{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1936750665","html_url":"https://github.com/apache/accumulo/issues/4251#issuecomment-1936750665","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4251","id":1936750665,"node_id":"IC_kwDOACaFSM5zcHhJ","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-09T23:54:37Z","updated_at":"2024-02-09T23:54:37Z","author_association":"CONTRIBUTOR","body":"I thought this might be the same issue as #4209 that was fixed in #4248 because the test is starting/stopping servers, but I tested locally with the latest after the fix was merged and it's still timing out for me so this needs to be looked at more to see if it's something related or different.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1936750665/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1937087564","html_url":"https://github.com/apache/accumulo/issues/4251#issuecomment-1937087564","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4251","id":1937087564,"node_id":"IC_kwDOACaFSM5zdZxM","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-10T18:17:30Z","updated_at":"2024-02-10T18:17:30Z","author_association":"CONTRIBUTOR","body":"I'm seeing similar threads hung in the Manager to #4209 that look to be related to the test stopping the tablet server so the Manager can't scan and seems to be stuck waiting on the `ClientTabletCache`. Both TabletGroupWatcher and Fate threads are waiting. The test is waiting for metadata table to come back (stuck trying to scan the table) after starting the server again but it seems like it's stuck forever which may be because the Manager is stuck so the Tserver can't come back. \r\n\r\n```\r\n\"Fate work finder\" #67 daemon prio=5 os_prio=0 cpu=120.97ms elapsed=68.39s tid=0x00007f66a4106b30 nid=0x2e7eb waiting on condition  [0x00007f6720246000]\r\n   java.lang.Thread.State: TIMED_WAITING (sleeping)\r\n        at java.lang.Thread.sleep(java.base@17.0.10/Native Method)\r\n        at java.lang.Thread.sleep(java.base@17.0.10/Thread.java:344)\r\n        at java.util.concurrent.TimeUnit.sleep(java.base@17.0.10/TimeUnit.java:446)\r\n        at com.google.common.util.concurrent.Uninterruptibles.sleepUninterruptibly(Uninterruptibles.java:406)\r\n        at org.apache.accumulo.core.clientImpl.RootClientTabletCache.findTablet(RootClientTabletCache.java:149)\r\n        at org.apache.accumulo.core.clientImpl.ClientTabletCache.findTablet(ClientTabletCache.java:120)\r\n        at org.apache.accumulo.core.clientImpl.ClientTabletCacheImpl.lookupTablet(ClientTabletCacheImpl.java:712)\r\n        at org.apache.accumulo.core.clientImpl.ClientTabletCacheImpl.lookupTabletLocationAndCheckLock(ClientTabletCacheImpl.java:891)\r\n        at org.apache.accumulo.core.clientImpl.ClientTabletCacheImpl._findTablet(ClientTabletCacheImpl.java:881)\r\n        at org.apache.accumulo.core.clientImpl.ClientTabletCacheImpl.findTablets(ClientTabletCacheImpl.java:340)\r\n        at org.apache.accumulo.core.clientImpl.ClientTabletCacheImpl.findTablets(ClientTabletCacheImpl.java:450)\r\n        at org.apache.accumulo.core.clientImpl.ClientTabletCacheImpl.processInvalidated(ClientTabletCacheImpl.java:933)\r\n        at org.apache.accumulo.core.clientImpl.ClientTabletCacheImpl.processInvalidatedAndCheckLock(ClientTabletCacheImpl.java:898)\r\n        at org.apache.accumulo.core.clientImpl.ClientTabletCacheImpl._findTablet(ClientTabletCacheImpl.java:862)\r\n        at org.apache.accumulo.core.clientImpl.ClientTabletCacheImpl.findTablet(ClientTabletCacheImpl.java:552)\r\n        at org.apache.accumulo.core.clientImpl.ThriftScanner.getNextScanAddress(ThriftScanner.java:559)\r\n        at org.apache.accumulo.core.clientImpl.ThriftScanner.scan(ThriftScanner.java:662)\r\n        at org.apache.accumulo.core.clientImpl.ScannerIterator.readBatch(ScannerIterator.java:159)\r\n        - locked <0x00000000f4761588> (a org.apache.accumulo.core.clientImpl.ThriftScanner$ScanState)\r\n        at org.apache.accumulo.core.clientImpl.ScannerIterator.getNextBatch(ScannerIterator.java:177)\r\n        at org.apache.accumulo.core.clientImpl.ScannerIterator.hasNext(ScannerIterator.java:111)\r\n        at java.util.Iterator.forEachRemaining(java.base@17.0.10/Iterator.java:132)\r\n        at java.util.Spliterators$IteratorSpliterator.forEachRemaining(java.base@17.0.10/Spliterators.java:1845)\r\n        at java.util.stream.AbstractPipeline.copyInto(java.base@17.0.10/AbstractPipeline.java:509)\r\n        at java.util.stream.AbstractPipeline.wrapAndCopyInto(java.base@17.0.10/AbstractPipeline.java:499)\r\n        at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(java.base@17.0.10/ForEachOps.java:150)\r\n        at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(java.base@17.0.10/ForEachOps.java:173)\r\n        at java.util.stream.AbstractPipeline.evaluate(java.base@17.0.10/AbstractPipeline.java:234)\r\n        at java.util.stream.ReferencePipeline.forEach(java.base@17.0.10/ReferencePipeline.java:596)\r\n        at org.apache.accumulo.core.fate.AbstractFateStore.runnable(AbstractFateStore.java:175)\r\n        at org.apache.accumulo.core.logging.FateLogger$1.runnable(FateLogger.java:125)\r\n        at org.apache.accumulo.core.fate.Fate$WorkFinder.run(Fate.java:93)\r\n        at org.apache.accumulo.core.trace.TraceWrappedRunnable.run(TraceWrappedRunnable.java:52)\r\n        at java.lang.Thread.run(java.base@17.0.10/Thread.java:840)\r\n\r\n   Locked ownable synchronizers:\r\n        - <0x00000000f1231a48> (a java.util.concurrent.locks.ReentrantReadWriteLock$NonfairSync)\r\n        - <0x00000000f124a2a8> (a java.util.concurrent.locks.ReentrantReadWriteLock$NonfairSync)\r\n```        \r\n\r\n```\r\n\"Watching Normal Tablets\" #53 daemon prio=5 os_prio=0 cpu=120.39ms elapsed=68.40s tid=0x00007f66a40e6a30 nid=0x2e7df waiting on condition  [0x00007f6720d51000]\r\n   java.lang.Thread.State: WAITING (parking)\r\n        at jdk.internal.misc.Unsafe.park(java.base@17.0.10/Native Method)\r\n        - parking to wait for  <0x00000000f124a2a8> (a java.util.concurrent.locks.ReentrantReadWriteLock$NonfairSync)\r\n        at java.util.concurrent.locks.LockSupport.park(java.base@17.0.10/LockSupport.java:211)\r\n        at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquire(java.base@17.0.10/AbstractQueuedSynchronizer.java:715)\r\n        at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireShared(java.base@17.0.10/AbstractQueuedSynchronizer.java:1027)\r\n        at java.util.concurrent.locks.ReentrantReadWriteLock$ReadLock.lock(java.base@17.0.10/ReentrantReadWriteLock.java:738)\r\n        at org.apache.accumulo.core.clientImpl.ClientTabletCacheImpl.findTablets(ClientTabletCacheImpl.java:417)\r\n        at org.apache.accumulo.core.clientImpl.ClientTabletCache.binRanges(ClientTabletCache.java:174)\r\n        at org.apache.accumulo.core.clientImpl.SyncingClientTabletCache.binRanges(SyncingClientTabletCache.java:97)\r\n        at org.apache.accumulo.core.clientImpl.TimeoutClientTabletCache.binRanges(TimeoutClientTabletCache.java:110)\r\n        at org.apache.accumulo.core.clientImpl.TabletServerBatchReaderIterator.binRanges(TabletServerBatchReaderIterator.java:275)\r\n        at org.apache.accumulo.core.clientImpl.TabletServerBatchReaderIterator.lookup(TabletServerBatchReaderIterator.java:249)\r\n        - locked <0x00000000f44f2c40> (a org.apache.accumulo.core.clientImpl.TabletServerBatchReaderIterator)\r\n        at org.apache.accumulo.core.clientImpl.TabletServerBatchReaderIterator.<init>(TabletServerBatchReaderIterator.java:172)\r\n        at org.apache.accumulo.core.clientImpl.TabletServerBatchReader.iterator(TabletServerBatchReader.java:118)\r\n        at org.apache.accumulo.server.manager.state.TabletManagementScanner.<init>(TabletManagementScanner.java:95)\r\n        at org.apache.accumulo.server.manager.state.MetaDataStateStore.iterator(MetaDataStateStore.java:63)\r\n        at org.apache.accumulo.server.manager.state.LoggingTabletStateStore.iterator(LoggingTabletStateStore.java:60)\r\n        at org.apache.accumulo.server.manager.state.TabletStateStore.iterator(TabletStateStore.java:62)\r\n        at org.apache.accumulo.manager.TabletGroupWatcher.run(TabletGroupWatcher.java:681)\r\n\r\n   Locked ownable synchronizers:\r\n        - None\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1937087564/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1938904490","html_url":"https://github.com/apache/accumulo/issues/4253#issuecomment-1938904490","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4253","id":1938904490,"node_id":"IC_kwDOACaFSM5zkVWq","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-12T15:32:25Z","updated_at":"2024-02-12T15:32:25Z","author_association":"CONTRIBUTOR","body":"Is the Zoo store is for system initiated FATE transactions, and the Table store is for user initiated FATE transactions, or is it the case that the Zoo store is for FATE transactions on the System tables, and the Table store is for FATE transactions on user tables?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1938904490/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1939072977","html_url":"https://github.com/apache/accumulo/issues/4253#issuecomment-1939072977","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4253","id":1939072977,"node_id":"IC_kwDOACaFSM5zk-fR","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-12T16:23:12Z","updated_at":"2024-02-12T16:23:12Z","author_association":"CONTRIBUTOR","body":"It's the latter: The Zoo store is only going to be used to store FATE transactions for system tables (root, metadata, etc). Everything else (for now at least, more below) goes into the Table store for other tables so that performance is better now that Accumulo will generate a lot more FATE operations for all the system initiated transactions. \r\n\r\nThere was discussion with @keith-turner about splitting up the Table store into 2 stores (or 2 sections of the table) to separate out user vs system initiated operations but for now we decided to just put everything into one Table store and see how it goes. So we could end up with a 3rd store at some point if we need it (system tables in Zoo store, Table store for Users ops and Table store for system ops for all other tables)","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1939072977/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1939078956","html_url":"https://github.com/apache/accumulo/issues/4253#issuecomment-1939078956","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4253","id":1939078956,"node_id":"IC_kwDOACaFSM5zk_8s","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-12T16:26:20Z","updated_at":"2024-02-12T16:26:20Z","author_association":"CONTRIBUTOR","body":"So, maybe instead of `ZooStore` and `AccumuloStore`, name them `SystemTableFateStore` and `UserTableFateStore`. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1939078956/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1939096908","html_url":"https://github.com/apache/accumulo/pull/4255#issuecomment-1939096908","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4255","id":1939096908,"node_id":"IC_kwDOACaFSM5zlEVM","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-12T16:34:22Z","updated_at":"2024-02-12T16:34:22Z","author_association":"CONTRIBUTOR","body":"This commit also changes the tablet mgmt iterator to always indicate if volume recovery is needed.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1939096908/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1939128844","html_url":"https://github.com/apache/accumulo/issues/4251#issuecomment-1939128844","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4251","id":1939128844,"node_id":"IC_kwDOACaFSM5zlMIM","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-12T16:47:53Z","updated_at":"2024-02-12T16:47:53Z","author_association":"CONTRIBUTOR","body":"Created #4255 as a fix for this.  Below are some notes from debugging this.  After the test got stuck, noticed the tserver could not recover its write ahead logs.  The following warn was from the tserver logs\r\n\r\n```\r\n2024-02-12T10:09:39,395 53 [tserver.AssignmentHandler] WARN : exception trying to assign tablet +r<< null\r\njava.lang.RuntimeException: Error recovering tablet +r<< from log files\r\n        at org.apache.accumulo.tserver.tablet.Tablet.<init>(Tablet.java:292) ~[classes/:?]\r\n        at org.apache.accumulo.tserver.AssignmentHandler.run(AssignmentHandler.java:140) ~[classes/:?]\r\n        at org.apache.accumulo.tserver.TabletClientHandler.lambda$loadTablet$8(TabletClientHandler.java:948) ~[classes/:?]\r\n        at org.apache.accumulo.core.trace.TraceWrappedRunnable.run(TraceWrappedRunnable.java:52) [classes/:?]\r\n        at java.base/java.lang.Thread.run(Thread.java:829) [?:?]\r\nCaused by: java.io.IOException: Unable to find recovery files for extent +r<< logEntry: file:/home/accumulo/git/accumulo/test/target/mini-tests/org.apache.accumulo.test.functional.WALSunnyDayIT_test/accumulo/wal/host1+46715/a04ee587-bf44-4667-b0e1-68b4460e369f\r\n        at org.apache.accumulo.tserver.TabletServer.recover(TabletServer.java:903) ~[classes/:?]\r\n        at org.apache.accumulo.tserver.tablet.Tablet.<init>(Tablet.java:258) ~[classes/:?]\r\n        ... 4 more\r\n```\r\n\r\nWas wondering if the GC had deleted the walog, took a look in the GC logs and did not see evidence of that.\r\n\r\n```\r\naccumulo@host1:~/git/accumulo/test/target/mini-tests/org.apache.accumulo.test.functional.WALSunnyDayIT_test/logs$ grep GarbageCollectWriteAheadLogs *\r\nSimpleGarbageCollector_426288884.out:2024-02-12T10:09:21,906 31 [gc.GarbageCollectWriteAheadLogs] INFO : Fetched 3 files for 1 servers in 0.01 seconds\r\nSimpleGarbageCollector_426288884.out:2024-02-12T10:09:21,948 31 [gc.GarbageCollectWriteAheadLogs] INFO : 1 log entries scanned in 0.04 seconds\r\nSimpleGarbageCollector_426288884.out:2024-02-12T10:09:21,949 31 [gc.GarbageCollectWriteAheadLogs] DEBUG: Removing UNREFERENCED WAL file:/home/accumulo/git/accumulo/test/target/mini-tests/org.apache.accumulo.test.functional.WALSunnyDayIT_test/accumulo/wal/host1+46715/f9934e85-cb37-4f91-8a97-30fd194b4e81\r\nSimpleGarbageCollector_426288884.out:2024-02-12T10:09:21,952 31 [gc.GarbageCollectWriteAheadLogs] INFO : 1 total logs removed from 1 servers in 0.00 seconds\r\nSimpleGarbageCollector_426288884.out:2024-02-12T10:09:21,952 31 [gc.GarbageCollectWriteAheadLogs] INFO : 0 recovery logs removed\r\nSimpleGarbageCollector_426288884.out:2024-02-12T10:09:21,970 31 [gc.GarbageCollectWriteAheadLogs] INFO : 0 markers removed in 0.02 seconds\r\n```\r\n\r\nAlso looked and found the wals existed in the file system.\r\n\r\n```\r\naccumulo@host1:~/git/accumulo/test/target/mini-tests/org.apache.accumulo.test.functional.WALSunnyDayIT_test/accumulo/wal/host1+46715$ ls -al\r\ntotal 164\r\ndrwxr-xr-x 2 accumulo accumulo      4 Feb 12 10:09 .\r\ndrwxr-xr-x 3 accumulo accumulo      3 Feb 12 10:09 ..\r\n-rwxr-xr-x 1 accumulo accumulo 136688 Feb 12 10:09 a04ee587-bf44-4667-b0e1-68b4460e369f\r\n-rwxr-xr-x 1 accumulo accumulo     86 Feb 12 10:09 bc70a463-1bb4-4659-b38f-25cf11b5bbf0\r\n```\r\n\r\nSo what was missing was the sorted version of the files, those had never been created.  For the manager to initiate log sort, the TabletGroupWatcher should see the TabletManagementIterator return `ManagementAction.NEEDS_VOLUME_REPLACEMENT` for the root tablet.  Looking in the manager logs, never saw this.  It was only returning `NEEDS_LOCATION_UPDATE`.\r\n\r\n```\r\n2024-02-12T10:09:37,272 49 [manager.Manager] TRACE: [Root Table] Shutting down all Tservers: false, dependentCount: 0 Extent: +r<<, state: HOSTED, goal: HOSTED actions:[NEEDS_LOCATION_UPDATE]\r\n2024-02-12T10:09:38,260 102 [bulkVer2.TabletRefresher] DEBUG: Sleeping for 1000ms before retrying operation : compaction:+r<< waiting for 1 tservers to refresh their tablets metadata \r\n2024-02-12T10:09:39,178 49 [manager.Manager] TRACE: [Root Table] Shutting down all Tservers: false, dependentCount: 0 Extent: +r<<, state: ASSIGNED_TO_DEAD_SERVER, goal: HOSTED actions:[NEEDS_LOCATION_UPDATE]\r\n2024-02-12T10:09:39,195 49 [tablet.location] DEBUG: Unassigned +r<< with 1 walogs\r\n2024-02-12T10:09:39,306 49 [manager.Manager] TRACE: [Root Table] Shutting down all Tservers: false, dependentCount: 0 Extent: +r<<, state: UNASSIGNED, goal: HOSTED actions:[NEEDS_LOCATION_UPDATE]\r\n2024-02-12T10:09:39,310 49 [tablet.location] DEBUG: Assigned +r<< to host1:41953[1000019a115001c]\r\n2024-02-12T10:09:39,414 49 [manager.Manager] TRACE: [Root Table] Shutting down all Tservers: false, dependentCount: 0 Extent: +r<<, state: ASSIGNED, goal: HOSTED actions:[NEEDS_LOCATION_UPDATE]\r\n```\r\n\r\nLooked at the TabletManagementIterator source and noticed special code block for when manager state is not normal.  The test sets the manager state to SAFE_MODE, so this was uncovering the bug.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1939128844/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1939132290","html_url":"https://github.com/apache/accumulo/pull/4255#issuecomment-1939132290","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4255","id":1939132290,"node_id":"IC_kwDOACaFSM5zlM-C","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-12T16:49:52Z","updated_at":"2024-02-12T16:49:52Z","author_association":"CONTRIBUTOR","body":"I put some notes on #4251 showing some of the steps taken while debugging this problem.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1939132290/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1939227846","html_url":"https://github.com/apache/accumulo/issues/4253#issuecomment-1939227846","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4253","id":1939227846,"node_id":"IC_kwDOACaFSM5zlkTG","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-12T17:45:28Z","updated_at":"2024-02-12T17:45:28Z","author_association":"CONTRIBUTOR","body":"> So, maybe instead of `ZooStore` and `AccumuloStore`, name them `SystemTableFateStore` and `UserTableFateStore`.\r\n\r\nSounds fine to me unless anyone else has any suggestions. I think the plan is to wait until all the outstanding FATE stuff to be merged and then we can do the rename to not break any open PRs","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1939227846/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1939629767","html_url":"https://github.com/apache/accumulo/issues/4256#issuecomment-1939629767","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4256","id":1939629767,"node_id":"IC_kwDOACaFSM5znGbH","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-12T21:39:12Z","updated_at":"2024-02-12T21:41:39Z","author_association":"CONTRIBUTOR","body":"Some of the conditions handled in the code linked in the description are also handled in more detail in lower level parts of the code.  For those cases it may be better to always rely on the lower level conditions.\r\n\r\nhttps://github.com/apache/accumulo/blob/0739f7ee6d4db2931d855abefea00e70a32ada86/server/base/src/main/java/org/apache/accumulo/server/manager/state/TabletGoalState.java#L176\r\n\r\nhttps://github.com/apache/accumulo/blob/0739f7ee6d4db2931d855abefea00e70a32ada86/server/base/src/main/java/org/apache/accumulo/server/manager/state/TabletGoalState.java#L97-L99\r\n\r\nHaving two different code paths for handling the same situation makes it harder to test the code.   The higher level check prevents the lower level checks from ever running and those lower level checks handle more conditions.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1939629767/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1939654885","html_url":"https://github.com/apache/accumulo/issues/4256#issuecomment-1939654885","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4256","id":1939654885,"node_id":"IC_kwDOACaFSM5znMjl","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-12T21:54:11Z","updated_at":"2024-02-12T21:54:11Z","author_association":"CONTRIBUTOR","body":"Would be useful to try removing the specialized code and only calling ` computeTabletManagementActions(tm, actions);` AND running all ITs to see if anything breaks.  However need to get all of the ITs reliably working in elasticity before doing this experiment.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1939654885/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1939763968","html_url":"https://github.com/apache/accumulo/pull/4259#issuecomment-1939763968","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4259","id":1939763968,"node_id":"IC_kwDOACaFSM5znnMA","user":{"login":"EdColeman","id":7047700,"node_id":"MDQ6VXNlcjcwNDc3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/7047700?v=4","gravatar_id":"","url":"https://api.github.com/users/EdColeman","html_url":"https://github.com/EdColeman","followers_url":"https://api.github.com/users/EdColeman/followers","following_url":"https://api.github.com/users/EdColeman/following{/other_user}","gists_url":"https://api.github.com/users/EdColeman/gists{/gist_id}","starred_url":"https://api.github.com/users/EdColeman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdColeman/subscriptions","organizations_url":"https://api.github.com/users/EdColeman/orgs","repos_url":"https://api.github.com/users/EdColeman/repos","events_url":"https://api.github.com/users/EdColeman/events{/privacy}","received_events_url":"https://api.github.com/users/EdColeman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-12T23:13:30Z","updated_at":"2024-02-12T23:13:30Z","author_association":"CONTRIBUTOR","body":"This is targeted for elasticity.  Would any of the similar compaction tests in main benefit from a similar narrowing?  Or is this strictly unique to elasticity?  Could be out of scope for this change, but didn't want to pass up an opportunity if we could improve the compaction tests in general. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1939763968/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1941630260","html_url":"https://github.com/apache/accumulo/issues/4234#issuecomment-1941630260","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4234","id":1941630260,"node_id":"IC_kwDOACaFSM5zuu00","user":{"login":"ArbaazKhan1","id":29344877,"node_id":"MDQ6VXNlcjI5MzQ0ODc3","avatar_url":"https://avatars.githubusercontent.com/u/29344877?v=4","gravatar_id":"","url":"https://api.github.com/users/ArbaazKhan1","html_url":"https://github.com/ArbaazKhan1","followers_url":"https://api.github.com/users/ArbaazKhan1/followers","following_url":"https://api.github.com/users/ArbaazKhan1/following{/other_user}","gists_url":"https://api.github.com/users/ArbaazKhan1/gists{/gist_id}","starred_url":"https://api.github.com/users/ArbaazKhan1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ArbaazKhan1/subscriptions","organizations_url":"https://api.github.com/users/ArbaazKhan1/orgs","repos_url":"https://api.github.com/users/ArbaazKhan1/repos","events_url":"https://api.github.com/users/ArbaazKhan1/events{/privacy}","received_events_url":"https://api.github.com/users/ArbaazKhan1/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-13T14:23:53Z","updated_at":"2024-02-13T14:23:53Z","author_association":"CONTRIBUTOR","body":"I can take a look at this","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1941630260/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1942017682","html_url":"https://github.com/apache/accumulo/pull/4258#issuecomment-1942017682","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4258","id":1942017682,"node_id":"IC_kwDOACaFSM5zwNaS","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-13T17:03:26Z","updated_at":"2024-02-13T20:39:07Z","author_association":"MEMBER","body":"Working on build failure fix\r\nEdit: Fixed","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1942017682/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1942120714","html_url":"https://github.com/apache/accumulo/pull/4259#issuecomment-1942120714","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4259","id":1942120714,"node_id":"IC_kwDOACaFSM5zwmkK","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-13T18:06:49Z","updated_at":"2024-02-13T18:06:49Z","author_association":"CONTRIBUTOR","body":"Made the change in 2.1 and merged forward","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1942120714/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1943736188","html_url":"https://github.com/apache/accumulo/issues/4232#issuecomment-1943736188","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4232","id":1943736188,"node_id":"IC_kwDOACaFSM5z2w98","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-14T13:08:13Z","updated_at":"2024-02-14T13:08:13Z","author_association":"CONTRIBUTOR","body":"Closed with the merge of #4239. We can create a new issue for making the log sorting processes resource group aware at a later time if that makes sense.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1943736188/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1944017514","html_url":"https://github.com/apache/accumulo/pull/4242#issuecomment-1944017514","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4242","id":1944017514,"node_id":"IC_kwDOACaFSM5z31pq","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-14T15:04:10Z","updated_at":"2024-02-14T15:04:10Z","author_association":"CONTRIBUTOR","body":"This comment is not for a change on this PR, it just a discussion comment about eventually adding the functionality in this PR to ZK store.  To add support for this in ZK store it seems like somehow we need the information about expected status for an operation pushed up into AbstractFateStore and then ieach mpl can enforce the expectation.    For example somehow we put the fact that delete() expects statuses {X,Y,Z} in AbstractFateStore and then both stores check this requirement in their own way.  Then the existing ITs that test both stores can verify these status checks are working.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1944017514/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1944110104","html_url":"https://github.com/apache/accumulo/pull/4223#issuecomment-1944110104","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4223","id":1944110104,"node_id":"IC_kwDOACaFSM5z4MQY","user":{"login":"ddanielr","id":12480877,"node_id":"MDQ6VXNlcjEyNDgwODc3","avatar_url":"https://avatars.githubusercontent.com/u/12480877?v=4","gravatar_id":"","url":"https://api.github.com/users/ddanielr","html_url":"https://github.com/ddanielr","followers_url":"https://api.github.com/users/ddanielr/followers","following_url":"https://api.github.com/users/ddanielr/following{/other_user}","gists_url":"https://api.github.com/users/ddanielr/gists{/gist_id}","starred_url":"https://api.github.com/users/ddanielr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ddanielr/subscriptions","organizations_url":"https://api.github.com/users/ddanielr/orgs","repos_url":"https://api.github.com/users/ddanielr/repos","events_url":"https://api.github.com/users/ddanielr/events{/privacy}","received_events_url":"https://api.github.com/users/ddanielr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-14T15:51:45Z","updated_at":"2024-02-14T15:51:45Z","author_association":"CONTRIBUTOR","body":"Talked with @EdColeman about this PR. \r\nThe two main concerns:\r\n\r\n1. If the job min and max wait properties were changing the thrift communication call. \r\nThis is not the case as the RetryableThriftCall class uses these options to configure a Retry object.\r\nhttps://github.com/apache/accumulo/blob/f28b55dc254051fea8a3666628fee9868f800a5d/server/base/src/main/java/org/apache/accumulo/server/compaction/RetryableThriftCall.java#L72-L83 \r\n\r\nThe underlying thrift call is not using these properties and remains unaffected. \r\n\r\n2. Not setting `maxRetries` would leave the compactor in a state where it appeared hung unless a logging level of `trace` was used. \r\n\r\nAttempted to correctly calculate the `maxRetries` period and pass that value. \r\nFound that the calculation is prone to errors. Opened #4261 to handle that issue separately. \r\n\r\nUpon further review, the RetryableThriftCall has logging logic that would display log messages of warn during this infinite wait state. This meets the expectation that the user can determine that the compactor is not hung and is looking for work.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1944110104/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1944110457","html_url":"https://github.com/apache/accumulo/pull/4242#issuecomment-1944110457","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4242","id":1944110457,"node_id":"IC_kwDOACaFSM5z4MV5","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-14T15:51:57Z","updated_at":"2024-02-14T15:51:57Z","author_association":"MEMBER","body":"@cshannon @keith-turner I added a test to make sure things only pass with push() when the expected statuses are present. This logic can be easily applied to the other methods as well. This was added in 73faa93df358732d8c11937f9ede655e9e162990. \r\n\r\n#4246 is tracking the effort to move the current test case in AccumuloStoreIT into FateStoreIT so it will run against both AccumuloStore and FateStore. The checks and tests added in this PR will push AccumuloStore and ZooStore a bit further apart in terms of what is checked. Do you think it is fine to keep things how they are now (adding these checks and tests for them) and then bringing ZooStore up to spec? Then we can move the test cases from AccumuloStoreIT into FateStoreIT.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1944110457/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1944115725","html_url":"https://github.com/apache/accumulo/issues/4262#issuecomment-1944115725","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4262","id":1944115725,"node_id":"IC_kwDOACaFSM5z4NoN","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-14T15:54:35Z","updated_at":"2024-02-14T15:54:35Z","author_association":"CONTRIBUTOR","body":"Marked this for version 2.1.3 on the assumption that #4244 will be in 2.1.3.  If that turns out to not be the case then the version on this could change.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1944115725/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1944223752","html_url":"https://github.com/apache/accumulo/issues/4262#issuecomment-1944223752","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4262","id":1944223752,"node_id":"IC_kwDOACaFSM5z4oAI","user":{"login":"EdColeman","id":7047700,"node_id":"MDQ6VXNlcjcwNDc3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/7047700?v=4","gravatar_id":"","url":"https://api.github.com/users/EdColeman","html_url":"https://github.com/EdColeman","followers_url":"https://api.github.com/users/EdColeman/followers","following_url":"https://api.github.com/users/EdColeman/following{/other_user}","gists_url":"https://api.github.com/users/EdColeman/gists{/gist_id}","starred_url":"https://api.github.com/users/EdColeman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdColeman/subscriptions","organizations_url":"https://api.github.com/users/EdColeman/orgs","repos_url":"https://api.github.com/users/EdColeman/repos","events_url":"https://api.github.com/users/EdColeman/events{/privacy}","received_events_url":"https://api.github.com/users/EdColeman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-14T16:52:11Z","updated_at":"2024-02-14T16:52:11Z","author_association":"CONTRIBUTOR","body":"I am currently working this as part of #4244 ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1944223752/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1944262073","html_url":"https://github.com/apache/accumulo/pull/4244#issuecomment-1944262073","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4244","id":1944262073,"node_id":"IC_kwDOACaFSM5z4xW5","user":{"login":"EdColeman","id":7047700,"node_id":"MDQ6VXNlcjcwNDc3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/7047700?v=4","gravatar_id":"","url":"https://api.github.com/users/EdColeman","html_url":"https://github.com/EdColeman","followers_url":"https://api.github.com/users/EdColeman/followers","following_url":"https://api.github.com/users/EdColeman/following{/other_user}","gists_url":"https://api.github.com/users/EdColeman/gists{/gist_id}","starred_url":"https://api.github.com/users/EdColeman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdColeman/subscriptions","organizations_url":"https://api.github.com/users/EdColeman/orgs","repos_url":"https://api.github.com/users/EdColeman/repos","events_url":"https://api.github.com/users/EdColeman/events{/privacy}","received_events_url":"https://api.github.com/users/EdColeman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-14T17:13:49Z","updated_at":"2024-02-14T17:13:49Z","author_association":"CONTRIBUTOR","body":"I marked this as a blocker for 2.1.3.  The SPI likely should go in some form into 2.1.3.  Rather that merge this now, I working issue #4262 that could have additional improvements.  If 2.1.3 release is ready, then what exists can be merged now and changes handled later.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1944262073/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1944302046","html_url":"https://github.com/apache/accumulo/pull/4242#issuecomment-1944302046","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4242","id":1944302046,"node_id":"IC_kwDOACaFSM5z47He","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-14T17:39:50Z","updated_at":"2024-02-14T17:39:50Z","author_association":"CONTRIBUTOR","body":"> This comment is not for a change on this PR, it just a discussion comment about eventually adding the functionality in this PR to ZK store. To add support for this in ZK store it seems like somehow we need the information about expected status for an operation pushed up into AbstractFateStore and then ieach mpl can enforce the expectation. For example somehow we put the fact that delete() expects statuses {X,Y,Z} in AbstractFateStore and then both stores check this requirement in their own way. Then the existing ITs that test both stores can verify these status checks are working.\r\n\r\nThat would be interesting if we can enforce this with ZK. With Accumulo it can be atomic with conditional mutations (obviously) but I would assume in ZK we'd not be able to do it with one operation, we'd have to do a read to get the status information and update so it wouldn't be Atomic. I guess we could enforce this by having to synchronize/lock in the ZK implementation so that we can read the status and prevent it from being changed until we are done","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1944302046/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1944368383","html_url":"https://github.com/apache/accumulo/pull/4242#issuecomment-1944368383","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4242","id":1944368383,"node_id":"IC_kwDOACaFSM5z5LT_","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-14T18:22:59Z","updated_at":"2024-02-14T18:22:59Z","author_association":"CONTRIBUTOR","body":"> I would assume in ZK we'd not be able to do it with one operation, we'd have to do a read to get the status information and update so it wouldn't be Atomic. \r\n\r\nThat is a good point, because we store the fate ZK data in multiple ZK nodes we can not perform atomic computations across them.  Can only atomically operate on ZK storage if the data is in a single node. I had forgot about that.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1944368383/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1944375250","html_url":"https://github.com/apache/accumulo/pull/4242#issuecomment-1944375250","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4242","id":1944375250,"node_id":"IC_kwDOACaFSM5z5M_S","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-14T18:27:55Z","updated_at":"2024-02-14T18:27:55Z","author_association":"CONTRIBUTOR","body":"> I guess we could enforce this by having to synchronize/lock in the ZK implementation so that we can read the status and prevent it from being changed until we are done\r\n\r\nThe conditions in this PR are just extra validation.  We are assuming that a reservation is held for all updates already.  We could read the status before doing an operation in the ZK store while the reservation is held.  It would not be as good as the check in accumulo, but the validation would still be useful for detecting problems.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1944375250/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1944439283","html_url":"https://github.com/apache/accumulo/pull/4247#issuecomment-1944439283","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4247","id":1944439283,"node_id":"IC_kwDOACaFSM5z5cnz","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-14T19:14:35Z","updated_at":"2024-02-14T19:14:35Z","author_association":"MEMBER","body":"Completed review changes:\r\n- FateId refactored (better Pattern for FateId and simpler validation)\r\n- CompactionMetadata GSonData changed to use the canonical FateId string instead of FateId (note that old data may need to be considered here)\r\n- SelectedFiles renamed \"txid\" --> \"fateId\". SelectedFilesTest updated to be consistent with changes\r\n- CompactionConfigStorage added Preconditions check\r\n- Changed compactionHints in TabletManagementParameters from Map<FateId,Map<String,String>> --> Map<String,Map<String,String>>: required changes to TabletManagementParameters, CompactionConfigStorage, CompactionJobGenerator, TabletManagementParametersTest, Manager, CancelCompactions, and PreDeleteTable\r\n- AmpleConditionalWriterIT.testCompacted() reordering of FateIds","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1944439283/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1944503685","html_url":"https://github.com/apache/accumulo/pull/4247#issuecomment-1944503685","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4247","id":1944503685,"node_id":"IC_kwDOACaFSM5z5sWF","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-14T20:01:46Z","updated_at":"2024-02-14T20:01:46Z","author_association":"CONTRIBUTOR","body":"> Changed compactionHints in TabletManagementParameters from Map<FateId,Map<String,String>> --> Map<String,Map<String,String>>: required changes to TabletManagementParameters, CompactionConfigStorage, CompactionJobGenerator, TabletManagementParametersTest, Manager, CancelCompactions, and PreDeleteTable\r\n\r\nSorry I did not communicate very clearly for the comment about that.  Was not looking to change the external map type parameters for TabletManagementParameters to have a key type of String.  Just thought it would be good to change internal map used for json so that the json encoding would cleaner.  So was thinking  of pattern like the following.\r\n\r\n * The public methods on TabletManagementParameters use `Map<FateId,Map<String,String>>`\r\n * Internally for json encoding `Map<FateId,Map<String,String>>` is converted to/from `Map<String,Map<String,String>>`\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1944503685/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1944509944","html_url":"https://github.com/apache/accumulo/pull/4247#issuecomment-1944509944","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4247","id":1944509944,"node_id":"IC_kwDOACaFSM5z5t34","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-14T20:06:24Z","updated_at":"2024-02-14T20:06:24Z","author_association":"MEMBER","body":"> > Changed compactionHints in TabletManagementParameters from Map<FateId,Map<String,String>> --> Map<String,Map<String,String>>: required changes to TabletManagementParameters, CompactionConfigStorage, CompactionJobGenerator, TabletManagementParametersTest, Manager, CancelCompactions, and PreDeleteTable\r\n> \r\n> Sorry I did not communicate very clearly for the comment about that. Was not looking to change the external map type parameters for TabletManagementParameters to have a key type of String. Just thought it would be good to change internal map used for json so that the json encoding would cleaner. So was thinking of pattern like the following.\r\n> \r\n> * The public methods on TabletManagementParameters use `Map<FateId,Map<String,String>>`\r\n> * Internally for json encoding `Map<FateId,Map<String,String>>` is converted to/from `Map<String,Map<String,String>>`\r\n\r\nAh gotcha. Will fix.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1944509944/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1945036600","html_url":"https://github.com/apache/accumulo/pull/4263#issuecomment-1945036600","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4263","id":1945036600,"node_id":"IC_kwDOACaFSM5z7uc4","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-14T23:41:23Z","updated_at":"2024-02-14T23:41:23Z","author_association":"CONTRIBUTOR","body":"@kevinrr888 this is a follow up fix for #4247.  I ran into this NPE with calling fateId.canonical() while running some test.  I went ahead and merged after build checks passed so that system compactions would work in the branch.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1945036600/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1946101371","html_url":"https://github.com/apache/accumulo/pull/4247#issuecomment-1946101371","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4247","id":1946101371,"node_id":"IC_kwDOACaFSM5z_yZ7","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-15T13:30:29Z","updated_at":"2024-02-15T13:30:58Z","author_association":"CONTRIBUTOR","body":"@kevinrr888 - The latest IT run is failing (stacktrace below). I think it might be due to this merge. Just an FYI...\r\n\r\n```\r\norg.opentest4j.AssertionFailedError: Test json should be identical to actual metadata at this point ==> expected: \r\n<{\"fateId\":\"FATE:USER:0000000000000002\",\"selAll\":true,\"files\":[\"\r\n{\\\"path\\\":\\\"hdfs://localhost:8020/accumulo/tables/2a/default_tablet/F0000070.rf\\\",\\\"startRow\\\":\\\"\\\",\\\"endRow\\\":\\\"\\\"}\",\"\r\n{\\\"path\\\":\\\"hdfs://localhost:8020/accumulo/tables/2a/default_tablet/F0000071.rf\\\",\\\"startRow\\\":\\\"\\\",\\\"endRow\\\":\\\"\\\"}\",\"\r\n{\\\"path\\\":\\\"hdfs://localhost:8020/accumulo/tables/2a/default_tablet/F0000072.rf\\\",\\\"startRow\\\":\\\"\\\",\\\"endRow\\\":\\\"\\\"}\"]}> \r\nbut was: <{\"txid\":\"FATE:USER:0000000000000002\",\"selAll\":true,\"files\":[\"\r\n{\\\"path\\\":\\\"hdfs://localhost:8020/accumulo/tables/2a/default_tablet/F0000070.rf\\\",\\\"startRow\\\":\\\"\\\",\\\"endRow\\\":\\\"\\\"}\",\"\r\n{\\\"path\\\":\\\"hdfs://localhost:8020/accumulo/tables/2a/default_tablet/F0000071.rf\\\",\\\"startRow\\\":\\\"\\\",\\\"endRow\\\":\\\"\\\"}\",\"\r\n{\\\"path\\\":\\\"hdfs://localhost:8020/accumulo/tables/2a/default_tablet/F0000072.rf\\\",\\\"startRow\\\":\\\"\\\",\\\"endRow\\\":\\\"\\\"}\"]}>\r\n\r\n```","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1946101371/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1946214571","html_url":"https://github.com/apache/accumulo/pull/4247#issuecomment-1946214571","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4247","id":1946214571,"node_id":"IC_kwDOACaFSM50AOCr","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-15T14:31:19Z","updated_at":"2024-02-15T14:31:19Z","author_association":"MEMBER","body":"> @kevinrr888 - The latest IT run is failing (stacktrace below). I think it might be due to this merge. Just an FYI...\r\n> \r\n> ```\r\n> org.opentest4j.AssertionFailedError: Test json should be identical to actual metadata at this point ==> expected: \r\n> <{\"fateId\":\"FATE:USER:0000000000000002\",\"selAll\":true,\"files\":[\"\r\n> {\\\"path\\\":\\\"hdfs://localhost:8020/accumulo/tables/2a/default_tablet/F0000070.rf\\\",\\\"startRow\\\":\\\"\\\",\\\"endRow\\\":\\\"\\\"}\",\"\r\n> {\\\"path\\\":\\\"hdfs://localhost:8020/accumulo/tables/2a/default_tablet/F0000071.rf\\\",\\\"startRow\\\":\\\"\\\",\\\"endRow\\\":\\\"\\\"}\",\"\r\n> {\\\"path\\\":\\\"hdfs://localhost:8020/accumulo/tables/2a/default_tablet/F0000072.rf\\\",\\\"startRow\\\":\\\"\\\",\\\"endRow\\\":\\\"\\\"}\"]}> \r\n> but was: <{\"txid\":\"FATE:USER:0000000000000002\",\"selAll\":true,\"files\":[\"\r\n> {\\\"path\\\":\\\"hdfs://localhost:8020/accumulo/tables/2a/default_tablet/F0000070.rf\\\",\\\"startRow\\\":\\\"\\\",\\\"endRow\\\":\\\"\\\"}\",\"\r\n> {\\\"path\\\":\\\"hdfs://localhost:8020/accumulo/tables/2a/default_tablet/F0000071.rf\\\",\\\"startRow\\\":\\\"\\\",\\\"endRow\\\":\\\"\\\"}\",\"\r\n> {\\\"path\\\":\\\"hdfs://localhost:8020/accumulo/tables/2a/default_tablet/F0000072.rf\\\",\\\"startRow\\\":\\\"\\\",\\\"endRow\\\":\\\"\\\"}\"]}>\r\n> ```\r\n\r\nThanks for pointing this out. I created https://github.com/apache/accumulo/pull/4265","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1946214571/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1946296385","html_url":"https://github.com/apache/accumulo/pull/4242#issuecomment-1946296385","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4242","id":1946296385,"node_id":"IC_kwDOACaFSM50AiBB","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-15T15:13:38Z","updated_at":"2024-02-15T15:13:38Z","author_association":"CONTRIBUTOR","body":"Looking at this PR I realized we do not have  test for the failure case in Fate.   Opened #4266 ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1946296385/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1946415329","html_url":"https://github.com/apache/accumulo/pull/4175#issuecomment-1946415329","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4175","id":1946415329,"node_id":"IC_kwDOACaFSM50A_Dh","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-15T16:05:23Z","updated_at":"2024-02-15T16:05:23Z","author_association":"CONTRIBUTOR","body":"Now that #4227 is merged, it would be good to merge elasticity into this branch and then add unit test for this new code.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1946415329/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1946621997","html_url":"https://github.com/apache/accumulo/pull/4267#issuecomment-1946621997","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4267","id":1946621997,"node_id":"IC_kwDOACaFSM50Bxgt","user":{"login":"EdColeman","id":7047700,"node_id":"MDQ6VXNlcjcwNDc3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/7047700?v=4","gravatar_id":"","url":"https://api.github.com/users/EdColeman","html_url":"https://github.com/EdColeman","followers_url":"https://api.github.com/users/EdColeman/followers","following_url":"https://api.github.com/users/EdColeman/following{/other_user}","gists_url":"https://api.github.com/users/EdColeman/gists{/gist_id}","starred_url":"https://api.github.com/users/EdColeman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdColeman/subscriptions","organizations_url":"https://api.github.com/users/EdColeman/orgs","repos_url":"https://api.github.com/users/EdColeman/repos","events_url":"https://api.github.com/users/EdColeman/events{/privacy}","received_events_url":"https://api.github.com/users/EdColeman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-15T17:09:38Z","updated_at":"2024-02-15T17:09:38Z","author_association":"CONTRIBUTOR","body":"Is this something that is specific to elasticity and resource groups?  There is similar code in 2.1.3","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1946621997/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1946717279","html_url":"https://github.com/apache/accumulo/pull/4267#issuecomment-1946717279","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4267","id":1946717279,"node_id":"IC_kwDOACaFSM50CIxf","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-15T17:38:15Z","updated_at":"2024-02-15T17:38:15Z","author_association":"CONTRIBUTOR","body":"> Is this something that is specific to elasticity and resource groups? There is similar code in 2.1.3\r\n\r\nExternalCompactionUtil is in 2.1, but there is no code that is using it to stop and start compactors in a test.\r\nMemoryStarvedMajcIT does exist in 3.1, but it doesn't call ExternalCompactionUtil and it doesn't stop/start Compactors.\r\nI think this is specific to elasticity.\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1946717279/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1946734129","html_url":"https://github.com/apache/accumulo/issues/4268#issuecomment-1946734129","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4268","id":1946734129,"node_id":"IC_kwDOACaFSM50CM4x","user":{"login":"EdColeman","id":7047700,"node_id":"MDQ6VXNlcjcwNDc3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/7047700?v=4","gravatar_id":"","url":"https://api.github.com/users/EdColeman","html_url":"https://github.com/EdColeman","followers_url":"https://api.github.com/users/EdColeman/followers","following_url":"https://api.github.com/users/EdColeman/following{/other_user}","gists_url":"https://api.github.com/users/EdColeman/gists{/gist_id}","starred_url":"https://api.github.com/users/EdColeman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdColeman/subscriptions","organizations_url":"https://api.github.com/users/EdColeman/orgs","repos_url":"https://api.github.com/users/EdColeman/repos","events_url":"https://api.github.com/users/EdColeman/events{/privacy}","received_events_url":"https://api.github.com/users/EdColeman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-15T17:43:31Z","updated_at":"2024-02-15T17:43:31Z","author_association":"CONTRIBUTOR","body":"Would it be sufficient to have the manager check the expected version?  If the manager does not start, then wouldn't everything kind of wait for assignments and never do do anything?  \r\n\r\nIn particular, the GC?  I think it would hold (or error) until it could scan the metadata table - which, until the manager is online would remain unenviable?  \r\n\r\nElasticity may need additional checks though.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1946734129/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1946795277","html_url":"https://github.com/apache/accumulo/pull/4242#issuecomment-1946795277","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4242","id":1946795277,"node_id":"IC_kwDOACaFSM50Cb0N","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-15T18:02:24Z","updated_at":"2024-02-15T18:02:24Z","author_association":"MEMBER","body":"In d0e44d2 I added test coverage to all 3 of the methods that were changed in AccumuloStore. The test makes sure only the expected statuses allow the operation to succeed.\r\n\r\nFor some reason, `pop()` is succeeding when the status is `NEW` even though we are requiring that only `FAILED_IN_PROGRESS` is present. I am not sure where the bug is. It could be in my test logic or elsewhere. Still looking into that but thought I would push my changes so far in case someone else spots whats going on and so others can see the test.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1946795277/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1946853978","html_url":"https://github.com/apache/accumulo/issues/4268#issuecomment-1946853978","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4268","id":1946853978,"node_id":"IC_kwDOACaFSM50CqJa","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-15T18:21:01Z","updated_at":"2024-02-15T18:21:01Z","author_association":"CONTRIBUTOR","body":"> Would it be sufficient to have the manager check the expected version? If the manager does not start, then wouldn't everything kind of wait for assignments and never do do anything?\r\n\r\nI think its best if all server do this check and I think they currently do.  There could be a situation where the 3.1 manager is up and running, 3.1 tservers are up and hosting metadata tables, and a 2.1 tserver is started.  Do not want that 2.1 tserver to attempt to participate with the running 3.1 servers.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1946853978/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1947330081","html_url":"https://github.com/apache/accumulo/pull/4269#issuecomment-1947330081","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4269","id":1947330081,"node_id":"IC_kwDOACaFSM50EeYh","user":{"login":"EdColeman","id":7047700,"node_id":"MDQ6VXNlcjcwNDc3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/7047700?v=4","gravatar_id":"","url":"https://api.github.com/users/EdColeman","html_url":"https://github.com/EdColeman","followers_url":"https://api.github.com/users/EdColeman/followers","following_url":"https://api.github.com/users/EdColeman/following{/other_user}","gists_url":"https://api.github.com/users/EdColeman/gists{/gist_id}","starred_url":"https://api.github.com/users/EdColeman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdColeman/subscriptions","organizations_url":"https://api.github.com/users/EdColeman/orgs","repos_url":"https://api.github.com/users/EdColeman/repos","events_url":"https://api.github.com/users/EdColeman/events{/privacy}","received_events_url":"https://api.github.com/users/EdColeman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-15T20:59:14Z","updated_at":"2024-02-15T20:59:14Z","author_association":"CONTRIBUTOR","body":"It looks like DistributedWorkQueue (DWQ) was intended as a general utility that was not tied specifically to log recovery.  In 2.1.3 it looks like besides log recovery it was used in replication and bulk import v1.  Those will have been removed in elasticity, but that does not change the intent DWQ being a general utility that can be used elsewhere again.\r\n\r\nTying the implementation to a specific property (GENERAL_RECOVERY_WALOG_SORT_INTERVAL) does not seem the way to go.  Even if the property was renamed, it would impact everything using a DWQ, and may be hard to know for a user. (I set the WAL sort time to XX and now Foo seems to be shorter / longer too)\r\n\r\nMaybe one of these alternatives:\r\n\r\na) Create a class that extends DWQ that is used explicitly for log sorting and then use the property in that class and pass it down into DWQ.  (The current 1 min could remain the default in DWQ)\r\nb) extend the test time for a period to allow for the one minute delay.  RecoveryIT is not a sunny test and as long a test can run in parallel, the overall time for a full set of ITs may not change much with this test running longer.\r\n\r\nIn general, it does not seem desirable to add a general, user settable property to support one test.\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1947330081/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1947336632","html_url":"https://github.com/apache/accumulo/pull/4269#issuecomment-1947336632","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4269","id":1947336632,"node_id":"IC_kwDOACaFSM50Ef-4","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-15T21:04:27Z","updated_at":"2024-02-15T21:04:27Z","author_association":"CONTRIBUTOR","body":"That's fair, the fix to the test is just to increase the timeout. I can close this PR and put up another that just has that change.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1947336632/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1947358976","html_url":"https://github.com/apache/accumulo/pull/4269#issuecomment-1947358976","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4269","id":1947358976,"node_id":"IC_kwDOACaFSM50ElcA","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-15T21:21:09Z","updated_at":"2024-02-15T21:21:09Z","author_association":"CONTRIBUTOR","body":"Closing in favor of #4271 ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1947358976/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1947361731","html_url":"https://github.com/apache/accumulo/pull/4270#issuecomment-1947361731","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4270","id":1947361731,"node_id":"IC_kwDOACaFSM50EmHD","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-15T21:22:27Z","updated_at":"2024-02-15T21:22:27Z","author_association":"CONTRIBUTOR","body":"@keith-turner , @cshannon - added you as reviewers for your awareness. I'm going to merge without your review.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1947361731/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1948394552","html_url":"https://github.com/apache/accumulo/pull/4254#issuecomment-1948394552","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4254","id":1948394552,"node_id":"IC_kwDOACaFSM50IiQ4","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-16T13:33:33Z","updated_at":"2024-02-16T13:33:33Z","author_association":"CONTRIBUTOR","body":"> Not proposing any changes in the following comment. It was just something I thought about and decided was not worthwhile, but wanted to put up for discussion in case my logic was off.\r\n> \r\nThis is an interesting idea that I hadn't thought of but I agree that for now it is likely not necessary. I would not expect there to be a ton of user compactions spamming things and causing the system jobs to block. However, I am glad you mentioned this and pointed it out because in the future if things change with how the system works or the assumptions are wrong we could go back and add in the check there to prevent creating the jobs in the first place.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1948394552/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1948536809","html_url":"https://github.com/apache/accumulo/issues/4273#issuecomment-1948536809","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4273","id":1948536809,"node_id":"IC_kwDOACaFSM50JE_p","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-16T14:58:02Z","updated_at":"2024-02-16T14:58:02Z","author_association":"CONTRIBUTOR","body":"For naming, could have the following property names.\r\n\r\n```\r\ncompaction.services.planner.factory\r\ncompaction.services.planner.factory.config\r\n```\r\n\r\nAnd the following SPI with `Planner` in the name and changed `forName` to `forService`.\r\n\r\n```java\r\ninterface CompactionPlannerFactory {\r\n   void init(PluginEnvironment env);\r\n   CompactionPlanner forService(String serviceName);\r\n}\r\n\r\ninterface CompactionPlanner {\r\n  Set<GroupConfig> getGroups();\r\n  List<Job> plan(tabletPlanningInformation);\r\n}\r\n```","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1948536809/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1948742507","html_url":"https://github.com/apache/accumulo/issues/4266#issuecomment-1948742507","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4266","id":1948742507,"node_id":"IC_kwDOACaFSM50J3Nr","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-16T16:04:07Z","updated_at":"2024-02-16T16:04:07Z","author_association":"MEMBER","body":"I would like to work on this.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1948742507/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1948804960","html_url":"https://github.com/apache/accumulo/issues/4276#issuecomment-1948804960","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4276","id":1948804960,"node_id":"IC_kwDOACaFSM50KGdg","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-16T16:25:21Z","updated_at":"2024-02-16T16:25:21Z","author_association":"CONTRIBUTOR","body":"I will take a look at this issue, I don't think it would take too long to update and would be a nice change.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1948804960/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1948935265","html_url":"https://github.com/apache/accumulo/pull/4242#issuecomment-1948935265","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4242","id":1948935265,"node_id":"IC_kwDOACaFSM50KmRh","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-16T17:18:04Z","updated_at":"2024-02-16T17:18:04Z","author_association":"MEMBER","body":"Fixed the test in 62786e1. Everything should be good to go now.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1948935265/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1949359267","html_url":"https://github.com/apache/accumulo/pull/4208#issuecomment-1949359267","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4208","id":1949359267,"node_id":"IC_kwDOACaFSM50MNyj","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-16T21:28:19Z","updated_at":"2024-02-16T21:28:19Z","author_association":"MEMBER","body":"Closing this PR as superseded by #4279","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1949359267/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1949508904","html_url":"https://github.com/apache/accumulo/issues/4217#issuecomment-1949508904","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4217","id":1949508904,"node_id":"IC_kwDOACaFSM50MyUo","user":{"login":"ddanielr","id":12480877,"node_id":"MDQ6VXNlcjEyNDgwODc3","avatar_url":"https://avatars.githubusercontent.com/u/12480877?v=4","gravatar_id":"","url":"https://api.github.com/users/ddanielr","html_url":"https://github.com/ddanielr","followers_url":"https://api.github.com/users/ddanielr/followers","following_url":"https://api.github.com/users/ddanielr/following{/other_user}","gists_url":"https://api.github.com/users/ddanielr/gists{/gist_id}","starred_url":"https://api.github.com/users/ddanielr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ddanielr/subscriptions","organizations_url":"https://api.github.com/users/ddanielr/orgs","repos_url":"https://api.github.com/users/ddanielr/repos","events_url":"https://api.github.com/users/ddanielr/events{/privacy}","received_events_url":"https://api.github.com/users/ddanielr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-17T00:07:26Z","updated_at":"2024-02-17T00:07:26Z","author_association":"CONTRIBUTOR","body":"#4223 has been merged. Closing issue.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1949508904/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1950261926","html_url":"https://github.com/apache/accumulo/pull/4254#issuecomment-1950261926","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4254","id":1950261926,"node_id":"IC_kwDOACaFSM50PqKm","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-17T17:23:24Z","updated_at":"2024-02-17T17:23:24Z","author_association":"CONTRIBUTOR","body":"@keith-turner - This is ready for another review I think, the only outstanding thing is if the test still needs updates. I updated the test to write more data as suggested which should try and trigger another system compaction and I verify that the user compaction runs by checking the CompactionKind but I still am not quite happy with and it and not seeing a good way to verify that the system compaction was indeed blocked as the system compaction thread is a bit non-deterministic in when it runs to look for work so trying to see if there is some state to track but not sure there is. I almost wonder if that might be a better unit test or mocking. Anyways, if you have a chance today you can take a look otherwise I will probably look at the test again tomorrow if I have time.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1950261926/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1951406170","html_url":"https://github.com/apache/accumulo/pull/4254#issuecomment-1951406170","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4254","id":1951406170,"node_id":"IC_kwDOACaFSM50UBha","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-18T18:22:18Z","updated_at":"2024-02-18T18:22:18Z","author_association":"CONTRIBUTOR","body":"@keith-turner - I think this is good to go now. I updated my test today to check and verify that the next compaction to run after writing more data to trigger a second SYSTEM compaction is a USER compaction and not the SYSTEM compaction that is triggered from the data write (my previous version yesterday only ensured the USER compaction eventually ran but did not guarantee it was the next one). \r\n\r\nWell, when I did this my test started to fail and was showing another SYSTEM compaction kept running. I started debugging and noticed that every time the check was done inside `CompactionCoordinator` to see if there were pending requested user compactions it was false even after it was set to true by the fate operation. I couldn't figure out why and finally found it in `TabletManagementIterator`...I forgot to add the new marker column to the list of columns to fetch, once I did that it started to read it and things now work as expected where the SYSTEM compaction gets blocked by the pending USER compaction when the test is run and if you change the fate operation to no longer set the marker then the test fails because Accumulo runs another SYSTEM compaction instead of the USER compaction.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1951406170/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1954167089","html_url":"https://github.com/apache/accumulo/pull/4254#issuecomment-1954167089","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4254","id":1954167089,"node_id":"IC_kwDOACaFSM50ejkx","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-20T13:00:05Z","updated_at":"2024-02-20T13:02:24Z","author_association":"CONTRIBUTOR","body":"@keith-turner - After I fixed the issue with the column `USER_COMPACTION_REQUESTED` not being read by the scanner inside `TabletManagementIterator` I realized that the `ensureFetched()` check didn't throw an exception like I would have expected and I didn't know why because I looked and there are already unit [tests](https://github.com/apache/accumulo/pull/4254/files#diff-833ba5d112ec590dbe3788ebcb73ef87f3128eff3810ad6dd9bf046567d7ad0aR338) I added that show that check does work and throws an exception if missing.\r\n\r\nSo I investigated and it is because the column was added to the fetchedCols inside TabletManagement by adding it to the `CONFIGURED_COLUMNS` set [here](https://github.com/apache/accumulo/pull/4254/files#diff-a5e21c00133e7d52c9de49a1a42583ac55f7257daab36825638ed4dbbf0d9acbR48). That meant that when the [getUserCompactionsRequested()](https://github.com/apache/accumulo/pull/4254/files#diff-f7cd33f7e1f9321ed285551c95577effc1f35880f80dcaa6e1c74d1ccae8987eR412) was called it didn't throw an illegal state exception since the column was added to the fetched set. \r\n\r\nHowever, we it still didn't work until the actual column was [added](https://github.com/apache/accumulo/pull/4254/files#diff-1adf517589f978e7f9cae95a7fdb404a52db469edf102500c3e2885ea7c0eb77R141) to the scanner in my latest commit. I'm thinking there must be a better way to handle that or I missed something because the state check is saying that it was fetched but it wasn't with how it's set up so wondering if there is a better way to do this so it would fail if the scanner is missing the column. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1954167089/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1954571696","html_url":"https://github.com/apache/accumulo/issues/4149#issuecomment-1954571696","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4149","id":1954571696,"node_id":"IC_kwDOACaFSM50gGWw","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-20T16:19:39Z","updated_at":"2024-02-20T16:19:39Z","author_association":"CONTRIBUTOR","body":"Closing this as fixed for now by #4214","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1954571696/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1954629136","html_url":"https://github.com/apache/accumulo/issues/4149#issuecomment-1954629136","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4149","id":1954629136,"node_id":"IC_kwDOACaFSM50gUYQ","user":{"login":"EdColeman","id":7047700,"node_id":"MDQ6VXNlcjcwNDc3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/7047700?v=4","gravatar_id":"","url":"https://api.github.com/users/EdColeman","html_url":"https://github.com/EdColeman","followers_url":"https://api.github.com/users/EdColeman/followers","following_url":"https://api.github.com/users/EdColeman/following{/other_user}","gists_url":"https://api.github.com/users/EdColeman/gists{/gist_id}","starred_url":"https://api.github.com/users/EdColeman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdColeman/subscriptions","organizations_url":"https://api.github.com/users/EdColeman/orgs","repos_url":"https://api.github.com/users/EdColeman/repos","events_url":"https://api.github.com/users/EdColeman/events{/privacy}","received_events_url":"https://api.github.com/users/EdColeman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-20T16:48:40Z","updated_at":"2024-02-20T16:48:40Z","author_association":"CONTRIBUTOR","body":"#4214 does not look to be a \"fix\". It adds information to the precondition check which may help track down the issue if it occurs.  Would it be better to leave this open to prompt additional work on determining the root cause?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1954629136/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1954836703","html_url":"https://github.com/apache/accumulo/issues/4266#issuecomment-1954836703","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4266","id":1954836703,"node_id":"IC_kwDOACaFSM50hHDf","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-20T18:37:52Z","updated_at":"2024-02-20T18:37:52Z","author_association":"MEMBER","body":"Created PR https://github.com/apache/accumulo/pull/4282","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1954836703/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1954841486","html_url":"https://github.com/apache/accumulo/issues/4277#issuecomment-1954841486","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4277","id":1954841486,"node_id":"IC_kwDOACaFSM50hIOO","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-20T18:40:37Z","updated_at":"2024-02-20T18:40:37Z","author_association":"MEMBER","body":"I would like to work on this","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1954841486/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1954959271","html_url":"https://github.com/apache/accumulo/issues/4149#issuecomment-1954959271","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4149","id":1954959271,"node_id":"IC_kwDOACaFSM50hk-n","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-20T19:58:39Z","updated_at":"2024-02-20T19:58:39Z","author_association":"CONTRIBUTOR","body":"@EdColeman - that's true, my reasoning is that #4214 adds information to help track down the issue, which given the velocity of the code changes in the elasticity branch may never be seen again. Opening a new issue in the future, presumably with more information, should be sufficient. It may also be likely that if this happens again in the future, the reporter doesn't see this issue, and creates a new issue anyway.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1954959271/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1956575713","html_url":"https://github.com/apache/accumulo/pull/4162#issuecomment-1956575713","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4162","id":1956575713,"node_id":"IC_kwDOACaFSM50nvnh","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-21T12:45:13Z","updated_at":"2024-02-21T12:45:13Z","author_association":"CONTRIBUTOR","body":"This PR fixes #3611 ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1956575713/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1956577057","html_url":"https://github.com/apache/accumulo/issues/3611#issuecomment-1956577057","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3611","id":1956577057,"node_id":"IC_kwDOACaFSM50nv8h","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-21T12:45:56Z","updated_at":"2024-02-21T12:45:56Z","author_association":"CONTRIBUTOR","body":"Closed by #4162 ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1956577057/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1956603045","html_url":"https://github.com/apache/accumulo/issues/3888#issuecomment-1956603045","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3888","id":1956603045,"node_id":"IC_kwDOACaFSM50n2Sl","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-21T13:00:54Z","updated_at":"2024-02-21T13:00:54Z","author_association":"CONTRIBUTOR","body":"@keith-turner - I looked at this function and I think it's still relevant. I have questions about the implementation, but if it has worked in the past I have no issue with it.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1956603045/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1956615282","html_url":"https://github.com/apache/accumulo/pull/4206#issuecomment-1956615282","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4206","id":1956615282,"node_id":"IC_kwDOACaFSM50n5Ry","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-21T13:07:52Z","updated_at":"2024-02-21T13:07:52Z","author_association":"CONTRIBUTOR","body":"Closing this in favor of #3746 ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1956615282/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1956657449","html_url":"https://github.com/apache/accumulo/pull/3974#issuecomment-1956657449","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3974","id":1956657449,"node_id":"IC_kwDOACaFSM50oDkp","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-21T13:31:11Z","updated_at":"2024-02-21T13:31:11Z","author_association":"CONTRIBUTOR","body":"@ctubbsii - This has been modified to call `ConfigCheckUtil.validate` like other parts of the codebase. This will log a warning for any unknown properties and throw an error for malformed or incorrect properties (wrong type, etc.). Can you re-review when you get a chance? I'd like to get this merged up.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1956657449/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1957074225","html_url":"https://github.com/apache/accumulo/issues/3314#issuecomment-1957074225","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3314","id":1957074225,"node_id":"IC_kwDOACaFSM50ppUx","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-21T15:58:23Z","updated_at":"2024-02-21T15:58:23Z","author_association":"CONTRIBUTOR","body":"Modified SuspendedTabletsIT in #4286 to confirm that tablet suspension is cleared on a subsequent normal tablet unload","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1957074225/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1957373438","html_url":"https://github.com/apache/accumulo/pull/4287#issuecomment-1957373438","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4287","id":1957373438,"node_id":"IC_kwDOACaFSM50qyX-","user":{"login":"EdColeman","id":7047700,"node_id":"MDQ6VXNlcjcwNDc3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/7047700?v=4","gravatar_id":"","url":"https://api.github.com/users/EdColeman","html_url":"https://github.com/EdColeman","followers_url":"https://api.github.com/users/EdColeman/followers","following_url":"https://api.github.com/users/EdColeman/following{/other_user}","gists_url":"https://api.github.com/users/EdColeman/gists{/gist_id}","starred_url":"https://api.github.com/users/EdColeman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdColeman/subscriptions","organizations_url":"https://api.github.com/users/EdColeman/orgs","repos_url":"https://api.github.com/users/EdColeman/repos","events_url":"https://api.github.com/users/EdColeman/events{/privacy}","received_events_url":"https://api.github.com/users/EdColeman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-21T17:19:52Z","updated_at":"2024-02-21T17:19:52Z","author_association":"CONTRIBUTOR","body":"Is this targeting an incorrect branch?  Should it be elasticity instead of main?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1957373438/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1957419888","html_url":"https://github.com/apache/accumulo/pull/4287#issuecomment-1957419888","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4287","id":1957419888,"node_id":"IC_kwDOACaFSM50q9tw","user":{"login":"ArbaazKhan1","id":29344877,"node_id":"MDQ6VXNlcjI5MzQ0ODc3","avatar_url":"https://avatars.githubusercontent.com/u/29344877?v=4","gravatar_id":"","url":"https://api.github.com/users/ArbaazKhan1","html_url":"https://github.com/ArbaazKhan1","followers_url":"https://api.github.com/users/ArbaazKhan1/followers","following_url":"https://api.github.com/users/ArbaazKhan1/following{/other_user}","gists_url":"https://api.github.com/users/ArbaazKhan1/gists{/gist_id}","starred_url":"https://api.github.com/users/ArbaazKhan1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ArbaazKhan1/subscriptions","organizations_url":"https://api.github.com/users/ArbaazKhan1/orgs","repos_url":"https://api.github.com/users/ArbaazKhan1/repos","events_url":"https://api.github.com/users/ArbaazKhan1/events{/privacy}","received_events_url":"https://api.github.com/users/ArbaazKhan1/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-21T17:32:39Z","updated_at":"2024-02-21T17:32:39Z","author_association":"CONTRIBUTOR","body":"No, It should be in elasticity. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1957419888/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1957455153","html_url":"https://github.com/apache/accumulo/pull/4287#issuecomment-1957455153","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4287","id":1957455153,"node_id":"IC_kwDOACaFSM50rGUx","user":{"login":"EdColeman","id":7047700,"node_id":"MDQ6VXNlcjcwNDc3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/7047700?v=4","gravatar_id":"","url":"https://api.github.com/users/EdColeman","html_url":"https://github.com/EdColeman","followers_url":"https://api.github.com/users/EdColeman/followers","following_url":"https://api.github.com/users/EdColeman/following{/other_user}","gists_url":"https://api.github.com/users/EdColeman/gists{/gist_id}","starred_url":"https://api.github.com/users/EdColeman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdColeman/subscriptions","organizations_url":"https://api.github.com/users/EdColeman/orgs","repos_url":"https://api.github.com/users/EdColeman/repos","events_url":"https://api.github.com/users/EdColeman/events{/privacy}","received_events_url":"https://api.github.com/users/EdColeman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-21T17:39:52Z","updated_at":"2024-02-21T17:39:52Z","author_association":"CONTRIBUTOR","body":"Did you consider sharing the error counter with the metrics.  With one counter used for the checks and exported as a metric, that may help keep those values in sync as well as protect against future changes where one or the other was used someplace without realizing that they need to be updated together.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1957455153/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1957490338","html_url":"https://github.com/apache/accumulo/pull/3974#issuecomment-1957490338","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3974","id":1957490338,"node_id":"IC_kwDOACaFSM50rO6i","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-21T17:46:43Z","updated_at":"2024-02-21T17:46:43Z","author_association":"CONTRIBUTOR","body":"I talked with @ctubbsii regarding this and he had two suggestions:\r\n\r\n  1. This check likely makes sense for all upgrades, not just between specific versions\r\n  2. Move the check to later in the upgrade process to ensure that all other upgrades are done. There could be an upgrade to the property structure or something that precludes this check from succeeding.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1957490338/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1957493641","html_url":"https://github.com/apache/accumulo/pull/3974#issuecomment-1957493641","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3974","id":1957493641,"node_id":"IC_kwDOACaFSM50rPuJ","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-21T17:47:41Z","updated_at":"2024-02-21T17:47:41Z","author_association":"MEMBER","body":"Oh, also, this might be useful to put in 3.1, or even 2.1 as an extra upgrade check.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1957493641/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1957571392","html_url":"https://github.com/apache/accumulo/pull/4287#issuecomment-1957571392","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4287","id":1957571392,"node_id":"IC_kwDOACaFSM50ritA","user":{"login":"ArbaazKhan1","id":29344877,"node_id":"MDQ6VXNlcjI5MzQ0ODc3","avatar_url":"https://avatars.githubusercontent.com/u/29344877?v=4","gravatar_id":"","url":"https://api.github.com/users/ArbaazKhan1","html_url":"https://github.com/ArbaazKhan1","followers_url":"https://api.github.com/users/ArbaazKhan1/followers","following_url":"https://api.github.com/users/ArbaazKhan1/following{/other_user}","gists_url":"https://api.github.com/users/ArbaazKhan1/gists{/gist_id}","starred_url":"https://api.github.com/users/ArbaazKhan1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ArbaazKhan1/subscriptions","organizations_url":"https://api.github.com/users/ArbaazKhan1/orgs","repos_url":"https://api.github.com/users/ArbaazKhan1/repos","events_url":"https://api.github.com/users/ArbaazKhan1/events{/privacy}","received_events_url":"https://api.github.com/users/ArbaazKhan1/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-21T18:08:21Z","updated_at":"2024-02-21T18:08:21Z","author_association":"CONTRIBUTOR","body":"I haven't, how would I go about sharing it with the metrics. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1957571392/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1957758493","html_url":"https://github.com/apache/accumulo/pull/4282#issuecomment-1957758493","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4282","id":1957758493,"node_id":"IC_kwDOACaFSM50sQYd","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-21T19:31:06Z","updated_at":"2024-02-21T19:31:06Z","author_association":"MEMBER","body":"- Removed `SUBMITTED` check in the new test `testRepoFails` (not needed - \r\n  tested elsewhere)\r\n- Changed tests `testTransactionStatus` and `testCancelWhileInCall` to start\r\n  the transaction runners after the `SUBMITTED` check (the race condition\r\nexisted in these tests too)\r\n- Resolved race condition on checking the `FAILED` state of the\r\n  transaction in `testRepoFails`","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1957758493/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1957781326","html_url":"https://github.com/apache/accumulo/pull/4287#issuecomment-1957781326","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4287","id":1957781326,"node_id":"IC_kwDOACaFSM50sV9O","user":{"login":"EdColeman","id":7047700,"node_id":"MDQ6VXNlcjcwNDc3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/7047700?v=4","gravatar_id":"","url":"https://api.github.com/users/EdColeman","html_url":"https://github.com/EdColeman","followers_url":"https://api.github.com/users/EdColeman/followers","following_url":"https://api.github.com/users/EdColeman/following{/other_user}","gists_url":"https://api.github.com/users/EdColeman/gists{/gist_id}","starred_url":"https://api.github.com/users/EdColeman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdColeman/subscriptions","organizations_url":"https://api.github.com/users/EdColeman/orgs","repos_url":"https://api.github.com/users/EdColeman/repos","events_url":"https://api.github.com/users/EdColeman/events{/privacy}","received_events_url":"https://api.github.com/users/EdColeman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-21T19:45:47Z","updated_at":"2024-02-21T19:45:47Z","author_association":"CONTRIBUTOR","body":"One way would be like: https://docs.micrometer.io/micrometer/reference/concepts/gauges.html#_manually_incrementing_or_decrementing_a_gauge\r\n\r\nbut not sure that is feasible here.  It may also be possible to \"wrap\" an AtomicIntger / Long with the metrics registration.  That is, create an Atomic and then pass that to the metrics during registration (rather than creating and using the reference as shown in that reference)","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1957781326/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1957786355","html_url":"https://github.com/apache/accumulo/pull/3974#issuecomment-1957786355","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3974","id":1957786355,"node_id":"IC_kwDOACaFSM50sXLz","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-21T19:49:00Z","updated_at":"2024-02-21T19:49:00Z","author_association":"CONTRIBUTOR","body":"Closing in favor of #4289 ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1957786355/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1957838848","html_url":"https://github.com/apache/accumulo/pull/3914#issuecomment-1957838848","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3914","id":1957838848,"node_id":"IC_kwDOACaFSM50skAA","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-21T20:20:26Z","updated_at":"2024-02-21T20:20:26Z","author_association":"CONTRIBUTOR","body":"> This looks good the only thing I noticed is I think we may be able to remove some of the validation checks now that seem redundant with conditional mutations such as in MergeTablets\r\n\r\nThose validations are still useful as they check the expected state when reading tablets in addition to when writing.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1957838848/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1959405102","html_url":"https://github.com/apache/accumulo/pull/4242#issuecomment-1959405102","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4242","id":1959405102,"node_id":"IC_kwDOACaFSM50yiYu","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-22T12:57:09Z","updated_at":"2024-02-22T12:57:09Z","author_association":"CONTRIBUTOR","body":"There is an IT that is failing, I'm assuming due to this change. Here's the error:\r\n\r\n```\r\n[ERROR] Tests run: 8, Failures: 0, Errors: 1, Skipped: 0, Time elapsed: 31.03 s <<< FAILURE! -- in org.apache.accumulo.test.fate.accumulo.AccumuloStoreFateIT\r\n[ERROR] org.apache.accumulo.test.fate.accumulo.AccumuloStoreFateIT.testCreateWithKeyInProgress -- Time elapsed: 0.507 s <<< ERROR!\r\njava.lang.IllegalStateException: Failed to write mutation REJECTED org.apache.accumulo.core.data.ConditionalMutation@9d62870b\r\n\tat org.apache.accumulo.core.fate.accumulo.FateMutatorImpl.mutate(FateMutatorImpl.java:178)\r\n\tat org.apache.accumulo.core.fate.accumulo.AccumuloStore$FateTxStoreImpl.delete(AccumuloStore.java:391)\r\n\tat org.apache.accumulo.test.fate.accumulo.FateStoreIT.testCreateWithKeyInProgress(FateStoreIT.java:345)\r\n\tat org.apache.accumulo.test.fate.accumulo.AccumuloStoreFateIT.executeTest(AccumuloStoreFateIT.java:57)\r\n\tat org.apache.accumulo.test.fate.FateTestRunner.executeTest(FateTestRunner.java:33)\r\n\tat org.apache.accumulo.test.fate.accumulo.FateStoreIT.testCreateWithKeyInProgress(FateStoreIT.java:325)\r\n\tat java.base/java.lang.reflect.Method.invoke(Method.java:568)\r\n\tat java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)\r\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)\r\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\r\n\tat java.base/java.lang.Thread.run(Thread.java:840)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1959405102/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1959611653","html_url":"https://github.com/apache/accumulo/pull/4242#issuecomment-1959611653","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4242","id":1959611653,"node_id":"IC_kwDOACaFSM50zU0F","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-22T14:49:46Z","updated_at":"2024-02-22T14:49:46Z","author_association":"CONTRIBUTOR","body":"I can take a quick look at the test","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1959611653/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1959613509","html_url":"https://github.com/apache/accumulo/pull/4242#issuecomment-1959613509","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4242","id":1959613509,"node_id":"IC_kwDOACaFSM50zVRF","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-22T14:50:42Z","updated_at":"2024-02-22T14:50:42Z","author_association":"MEMBER","body":"I found what was wrong and have a fix for it. I can make a quick PR now @cshannon @dlmarion ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1959613509/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1959615368","html_url":"https://github.com/apache/accumulo/pull/4242#issuecomment-1959615368","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4242","id":1959615368,"node_id":"IC_kwDOACaFSM50zVuI","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-22T14:51:40Z","updated_at":"2024-02-22T14:51:40Z","author_association":"CONTRIBUTOR","body":"> I found what was wrong and have a fix for it. I can make a quick PR now @cshannon @dlmarion\r\n\r\n@DomGarguilo - sounds good, i peaked and I assume the state just needs to be set before the deletion","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1959615368/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1959911698","html_url":"https://github.com/apache/accumulo/issues/3972#issuecomment-1959911698","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3972","id":1959911698,"node_id":"IC_kwDOACaFSM500eES","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-22T17:20:21Z","updated_at":"2024-02-22T17:20:21Z","author_association":"CONTRIBUTOR","body":"Closed by #4289 which validates the configuration during the upgrade.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1959911698/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1959917838","html_url":"https://github.com/apache/accumulo/issues/4168#issuecomment-1959917838","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4168","id":1959917838,"node_id":"IC_kwDOACaFSM500fkO","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-22T17:23:53Z","updated_at":"2024-02-22T17:23:53Z","author_association":"MEMBER","body":"I would like to work on this","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1959917838/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1960171113","html_url":"https://github.com/apache/accumulo/pull/4286#issuecomment-1960171113","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4286","id":1960171113,"node_id":"IC_kwDOACaFSM501dZp","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-22T19:56:40Z","updated_at":"2024-02-22T19:56:40Z","author_association":"CONTRIBUTOR","body":"I talked with @keith-turner . He is working on a different PR for this.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1960171113/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1960305181","html_url":"https://github.com/apache/accumulo/pull/4286#issuecomment-1960305181","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4286","id":1960305181,"node_id":"IC_kwDOACaFSM501-Id","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-22T21:00:49Z","updated_at":"2024-02-22T21:00:49Z","author_association":"CONTRIBUTOR","body":"OPened #4295.  Was finally able to figure out the mystery around #3314 because of [this comment](https://github.com/apache/accumulo/blob/f2adaebba28b5e47ea03a850254e901a0c7be371/server/manager/src/main/java/org/apache/accumulo/manager/TabletGroupWatcher.java#L333) plus where the comment fell in the code.  At the place where comment fell a tablets goal state is !HOSTED and its current state is SUSPENDED.  So that lead me to suspect the intent of the code was to clear suspend markers for offline tables.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1960305181/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1960331467","html_url":"https://github.com/apache/accumulo/pull/4295#issuecomment-1960331467","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4295","id":1960331467,"node_id":"IC_kwDOACaFSM502EjL","user":{"login":"EdColeman","id":7047700,"node_id":"MDQ6VXNlcjcwNDc3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/7047700?v=4","gravatar_id":"","url":"https://api.github.com/users/EdColeman","html_url":"https://github.com/EdColeman","followers_url":"https://api.github.com/users/EdColeman/followers","following_url":"https://api.github.com/users/EdColeman/following{/other_user}","gists_url":"https://api.github.com/users/EdColeman/gists{/gist_id}","starred_url":"https://api.github.com/users/EdColeman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdColeman/subscriptions","organizations_url":"https://api.github.com/users/EdColeman/orgs","repos_url":"https://api.github.com/users/EdColeman/repos","events_url":"https://api.github.com/users/EdColeman/events{/privacy}","received_events_url":"https://api.github.com/users/EdColeman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-22T21:19:50Z","updated_at":"2024-02-22T21:19:50Z","author_association":"CONTRIBUTOR","body":"With these changes.  What is the suspend state when:\r\n\r\n1. A tablet server is stopped.\r\n2. A tablet server crashes (killed)\r\n\r\nIn both of those cases when the tablet(s) are reloaded, is the suspend state still set and subject to the timeout?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1960331467/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1960338353","html_url":"https://github.com/apache/accumulo/pull/4295#issuecomment-1960338353","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4295","id":1960338353,"node_id":"IC_kwDOACaFSM502GOx","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-22T21:23:18Z","updated_at":"2024-02-22T21:23:18Z","author_association":"CONTRIBUTOR","body":"> In both of those cases when the tablet(s) are reloaded, is the suspend state still set and subject to the timeout?\r\n\r\nYeah I think so and the existing test was checking for this.  I added the following line to the test after tservers were killed to be sure that tablets were in the suspended state.\r\n\r\n```\r\nassertTrue(ds.suspendedCount > 0);\r\n```","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1960338353/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1960513598","html_url":"https://github.com/apache/accumulo/pull/4295#issuecomment-1960513598","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4295","id":1960513598,"node_id":"IC_kwDOACaFSM502xA-","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-22T23:34:57Z","updated_at":"2024-02-22T23:34:57Z","author_association":"CONTRIBUTOR","body":"> As long as this preserves the behavior that the suspend duration can be used for rolling restarts with tservers either stopped by command or by a kill (crash).\r\n\r\nI did not change that behavior in this PR.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1960513598/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1960575908","html_url":"https://github.com/apache/accumulo/pull/4254#issuecomment-1960575908","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4254","id":1960575908,"node_id":"IC_kwDOACaFSM503AOk","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-23T00:39:15Z","updated_at":"2024-02-23T00:39:15Z","author_association":"CONTRIBUTOR","body":">  I'm thinking there must be a better way to handle that or I missed something because the state check is saying that it was fetched but it wasn't with how it's set up so wondering if there is a better way to do this so it would fail if the scanner is missing the column.\r\n\r\nKinda related, I had made [this comment](https://github.com/apache/accumulo/blob/58be770cb54331081965ef5689e5722a0d47797e/server/base/src/main/java/org/apache/accumulo/server/manager/state/TabletManagementIterator.java#L127) and thought I had opened an issue but could not find it.  The code has evolved a lot from main and is fetching a lot more columns. I think we could remove all of the fetches and get everything for the tablet.   That would simplify things for the problem you ran into.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1960575908/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1961272222","html_url":"https://github.com/apache/accumulo/pull/4254#issuecomment-1961272222","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4254","id":1961272222,"node_id":"IC_kwDOACaFSM505qOe","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-23T12:50:13Z","updated_at":"2024-02-23T12:50:13Z","author_association":"CONTRIBUTOR","body":"> Kinda related, I had made [this comment](https://github.com/apache/accumulo/blob/58be770cb54331081965ef5689e5722a0d47797e/server/base/src/main/java/org/apache/accumulo/server/manager/state/TabletManagementIterator.java#L127) and thought I had opened an issue but could not find it. The code has evolved a lot from main and is fetching a lot more columns. I think we could remove all of the fetches and get everything for the tablet. That would simplify things for the problem you ran into.\r\n\r\nThat makes sense, I'm thinking that might be best to change as a separate follow on to track/test it separately.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1961272222/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1961594906","html_url":"https://github.com/apache/accumulo/pull/4297#issuecomment-1961594906","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4297","id":1961594906,"node_id":"IC_kwDOACaFSM5065Aa","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-23T16:05:02Z","updated_at":"2024-02-23T16:05:02Z","author_association":"CONTRIBUTOR","body":"This current PR is for main, I'll fix the conflicts when merging into elasticity after this is merged to main","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1961594906/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1961596511","html_url":"https://github.com/apache/accumulo/issues/4273#issuecomment-1961596511","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4273","id":1961596511,"node_id":"IC_kwDOACaFSM5065Zf","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-23T16:05:59Z","updated_at":"2024-02-23T16:05:59Z","author_association":"CONTRIBUTOR","body":"Thinking about property validation, something that I just added to the Upgrader in 2.1.3, having properties defined in the SPI classes and not in Property.java makes validation incomplete. It might be good for the service provider interfaces to extend a common base interface that has a method which returns a property validator object. That would let the SPI implementer use whatever properties they like, but we still have a way to validate that the configuration is correct.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1961596511/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1961600616","html_url":"https://github.com/apache/accumulo/pull/4297#issuecomment-1961600616","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4297","id":1961600616,"node_id":"IC_kwDOACaFSM5066Zo","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-23T16:08:27Z","updated_at":"2024-02-23T16:36:50Z","author_association":"CONTRIBUTOR","body":"Actually in elasticity virtually everything is a conflict so it will be simpler to merge this forward as an empty commit and then just do a separate PR for elasticity, #4298 ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1961600616/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1961712374","html_url":"https://github.com/apache/accumulo/issues/3546#issuecomment-1961712374","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3546","id":1961712374,"node_id":"IC_kwDOACaFSM507Vr2","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-23T17:22:37Z","updated_at":"2024-02-23T17:22:37Z","author_association":"CONTRIBUTOR","body":"I talked with @ddanielr about this issue and #4273 as they seem to overlap a little. I'm going to change the existing configuration down to one group in a PR. He said that @keith-turner made a change recently that would give root and meta priority over user tables within one group. I want to see how much faster the ITs run when we are only starting one compactor for MAC vs four.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1961712374/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1961867958","html_url":"https://github.com/apache/accumulo/issues/4273#issuecomment-1961867958","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4273","id":1961867958,"node_id":"IC_kwDOACaFSM5077q2","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-23T19:23:00Z","updated_at":"2024-02-23T19:23:00Z","author_association":"CONTRIBUTOR","body":"Had a discussion with @ddanielr about this. Taking into account #3546 I think the default configuration should be simple. As in:\r\n\r\n```\r\n[\r\n  {\r\n    \"cs1\": {\r\n      \"maxOpenFilesPerJob\": \"30\",\r\n      \"groups\": [\r\n          {\r\n            \"name\": \"default\",\r\n          }\r\n      ]\r\n    }\r\n  }\r\n]\r\n```","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1961867958/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1962004964","html_url":"https://github.com/apache/accumulo/pull/4302#issuecomment-1962004964","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4302","id":1962004964,"node_id":"IC_kwDOACaFSM508dHk","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-23T21:20:55Z","updated_at":"2024-02-23T21:20:55Z","author_association":"CONTRIBUTOR","body":"I've run a few ITs with this and no longer see the exception pop up in the Manager log","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1962004964/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1962088554","html_url":"https://github.com/apache/accumulo/issues/4177#issuecomment-1962088554","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4177","id":1962088554,"node_id":"IC_kwDOACaFSM508xhq","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-23T22:33:18Z","updated_at":"2024-02-23T22:33:35Z","author_association":"CONTRIBUTOR","body":"I have started looking into this issue and working on a PR. #4178 added a spot to store the new column and information after the refactor [here](https://github.com/apache/accumulo/blob/d7348ae5219e40f7e960eb585b14960a1a242bcd/server/manager/src/main/java/org/apache/accumulo/manager/tableOps/split/FindSplits.java#L78) inside of the FindSplits repo","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1962088554/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1962395883","html_url":"https://github.com/apache/accumulo/pull/4299#issuecomment-1962395883","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4299","id":1962395883,"node_id":"IC_kwDOACaFSM5098jr","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-24T15:04:28Z","updated_at":"2024-02-24T15:04:28Z","author_association":"CONTRIBUTOR","body":"Got a successful IT run, took a little over 15 minutes off of the time","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1962395883/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1962724888","html_url":"https://github.com/apache/accumulo/issues/4177#issuecomment-1962724888","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4177","id":1962724888,"node_id":"IC_kwDOACaFSM50_M4Y","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-24T20:34:23Z","updated_at":"2024-02-24T20:34:23Z","author_association":"CONTRIBUTOR","body":"I have a prototype working for this issue but it still needs some polishing and some more testing, but I should be able to submit a PR soon. I'm also waiting to submit a PR because I based the branch for this PR off of #4254 to avoid merge conflicts since both PRs modify the Metadata schema and add new columns so once that PR is merged I can rebase off elasticity and then create a PR for this","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1962724888/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1964107761","html_url":"https://github.com/apache/accumulo/issues/4303#issuecomment-1964107761","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4303","id":1964107761,"node_id":"IC_kwDOACaFSM51Eefx","user":{"login":"alerman","id":119506,"node_id":"MDQ6VXNlcjExOTUwNg==","avatar_url":"https://avatars.githubusercontent.com/u/119506?v=4","gravatar_id":"","url":"https://api.github.com/users/alerman","html_url":"https://github.com/alerman","followers_url":"https://api.github.com/users/alerman/followers","following_url":"https://api.github.com/users/alerman/following{/other_user}","gists_url":"https://api.github.com/users/alerman/gists{/gist_id}","starred_url":"https://api.github.com/users/alerman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alerman/subscriptions","organizations_url":"https://api.github.com/users/alerman/orgs","repos_url":"https://api.github.com/users/alerman/repos","events_url":"https://api.github.com/users/alerman/events{/privacy}","received_events_url":"https://api.github.com/users/alerman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-26T13:08:19Z","updated_at":"2024-02-26T13:08:19Z","author_association":"CONTRIBUTOR","body":"As a side note this happens with or without --disable-tab-completion","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1964107761/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1964458065","html_url":"https://github.com/apache/accumulo/issues/4303#issuecomment-1964458065","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4303","id":1964458065,"node_id":"IC_kwDOACaFSM51F0BR","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-26T15:44:50Z","updated_at":"2024-02-26T15:44:50Z","author_association":"CONTRIBUTOR","body":"Looks like this is the code in question: https://github.com/apache/accumulo/blob/2.1/core/src/main/java/org/apache/accumulo/core/rpc/clients/TServerClient.java#L64-L77","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1964458065/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1964638047","html_url":"https://github.com/apache/accumulo/issues/4305#issuecomment-1964638047","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4305","id":1964638047,"node_id":"IC_kwDOACaFSM51Gf9f","user":{"login":"EdColeman","id":7047700,"node_id":"MDQ6VXNlcjcwNDc3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/7047700?v=4","gravatar_id":"","url":"https://api.github.com/users/EdColeman","html_url":"https://github.com/EdColeman","followers_url":"https://api.github.com/users/EdColeman/followers","following_url":"https://api.github.com/users/EdColeman/following{/other_user}","gists_url":"https://api.github.com/users/EdColeman/gists{/gist_id}","starred_url":"https://api.github.com/users/EdColeman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdColeman/subscriptions","organizations_url":"https://api.github.com/users/EdColeman/orgs","repos_url":"https://api.github.com/users/EdColeman/repos","events_url":"https://api.github.com/users/EdColeman/events{/privacy}","received_events_url":"https://api.github.com/users/EdColeman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-26T16:53:17Z","updated_at":"2024-02-26T16:53:17Z","author_association":"CONTRIBUTOR","body":"Is the import directory and the import files somewhere in hdfs under the accumulo namespace?  Maybe something like `/accumulo/infiles`   The import does a hdfs rename - from the import dir to a directory under the `/accumulo/tables/[TID]/xxxx` it does not copy the files - that's why they need to be in the same hdfs namespace.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1964638047/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1964943799","html_url":"https://github.com/apache/accumulo/issues/4305#issuecomment-1964943799","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4305","id":1964943799,"node_id":"IC_kwDOACaFSM51Hqm3","user":{"login":"RangaSamudrala","id":31590624,"node_id":"MDQ6VXNlcjMxNTkwNjI0","avatar_url":"https://avatars.githubusercontent.com/u/31590624?v=4","gravatar_id":"","url":"https://api.github.com/users/RangaSamudrala","html_url":"https://github.com/RangaSamudrala","followers_url":"https://api.github.com/users/RangaSamudrala/followers","following_url":"https://api.github.com/users/RangaSamudrala/following{/other_user}","gists_url":"https://api.github.com/users/RangaSamudrala/gists{/gist_id}","starred_url":"https://api.github.com/users/RangaSamudrala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RangaSamudrala/subscriptions","organizations_url":"https://api.github.com/users/RangaSamudrala/orgs","repos_url":"https://api.github.com/users/RangaSamudrala/repos","events_url":"https://api.github.com/users/RangaSamudrala/events{/privacy}","received_events_url":"https://api.github.com/users/RangaSamudrala/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-26T18:58:35Z","updated_at":"2024-02-26T19:00:11Z","author_association":"NONE","body":"No, they are present in a separate file system. What if I provide the directory path as `file://<absolute directory path>` ?\r\n\r\nI see the same issue when I use `importtable`  command. I presume the underlying problem is the same.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1964943799/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1965005410","html_url":"https://github.com/apache/accumulo/issues/4114#issuecomment-1965005410","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4114","id":1965005410,"node_id":"IC_kwDOACaFSM51H5pi","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-26T19:10:27Z","updated_at":"2024-02-26T19:10:27Z","author_association":"MEMBER","body":"Closing as completed by #4242","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1965005410/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]