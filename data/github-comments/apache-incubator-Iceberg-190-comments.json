[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203012423","html_url":"https://github.com/apache/iceberg/pull/5419#issuecomment-1203012423","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5419","id":1203012423,"node_id":"IC_kwDOCW7NX85HtINH","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-02T17:23:18Z","updated_at":"2022-08-02T17:34:39Z","author_association":"MEMBER","body":"@rdblue, @RussellSpitzer : This PR needs some more work (mentioned TODO in the description).\r\nBut I would like to have early feedback about this Iceberg spec modification.\r\n\r\nThe actual issue scenario is passing with this change.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203012423/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203037586","html_url":"https://github.com/apache/iceberg/pull/5327#issuecomment-1203037586","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5327","id":1203037586,"node_id":"IC_kwDOCW7NX85HtOWS","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-02T17:50:35Z","updated_at":"2022-08-02T17:50:35Z","author_association":"COLLABORATOR","body":"So still to me it makess sense to add a force option to registerTable.  Initially we were debating between adding a new Catalog API , or re-using registerTable with force option.  I initially preferred the first as its more clear to user, but I guess @rdblue is not a fan of adding the new API.  \r\n\r\nSo we could do this, today we throw an error if the table exists, but if force==true, we just call drop table.  And clarify in the docs what force option does.  I would probably also in the code move some the logic to read the metadataFile up and then add a Precondition that the file exists, before the if (table.exists() block) because now it will drop if force=true.  \r\n\r\n@RussellSpitzer @flyrain does that sound like it will work ?  ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203037586/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203044827","html_url":"https://github.com/apache/iceberg/pull/5409#issuecomment-1203044827","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5409","id":1203044827,"node_id":"IC_kwDOCW7NX85HtQHb","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-02T17:58:35Z","updated_at":"2022-08-02T17:58:35Z","author_association":"MEMBER","body":"I noted offline, this now needs tests for all of the modified Schema Update calls.\r\n\r\nI think the spark test should be relocated see note and I provided a hint on how to rename columns without creating a new class, although you'll see in the suggested test destination we have a \"jsonToDF\" function you can use as well","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203044827/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203045400","html_url":"https://github.com/apache/iceberg/pull/5367#issuecomment-1203045400","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5367","id":1203045400,"node_id":"IC_kwDOCW7NX85HtQQY","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-02T17:59:12Z","updated_at":"2022-08-02T17:59:12Z","author_association":"COLLABORATOR","body":"Merged , thanks @singhpk234 , we can follow up if there are more concerns.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203045400/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203050349","html_url":"https://github.com/apache/iceberg/pull/5413#issuecomment-1203050349","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5413","id":1203050349,"node_id":"IC_kwDOCW7NX85HtRdt","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-02T18:03:50Z","updated_at":"2022-08-02T18:03:50Z","author_association":"COLLABORATOR","body":"Merged, thanks @amogh-jahagirdar ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203050349/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203057145","html_url":"https://github.com/apache/iceberg/issues/5370#issuecomment-1203057145","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5370","id":1203057145,"node_id":"IC_kwDOCW7NX85HtTH5","user":{"login":"cccs-jc","id":56140112,"node_id":"MDQ6VXNlcjU2MTQwMTEy","avatar_url":"https://avatars.githubusercontent.com/u/56140112?v=4","gravatar_id":"","url":"https://api.github.com/users/cccs-jc","html_url":"https://github.com/cccs-jc","followers_url":"https://api.github.com/users/cccs-jc/followers","following_url":"https://api.github.com/users/cccs-jc/following{/other_user}","gists_url":"https://api.github.com/users/cccs-jc/gists{/gist_id}","starred_url":"https://api.github.com/users/cccs-jc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cccs-jc/subscriptions","organizations_url":"https://api.github.com/users/cccs-jc/orgs","repos_url":"https://api.github.com/users/cccs-jc/repos","events_url":"https://api.github.com/users/cccs-jc/events{/privacy}","received_events_url":"https://api.github.com/users/cccs-jc/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-02T18:09:15Z","updated_at":"2022-08-02T18:09:15Z","author_association":"CONTRIBUTOR","body":"cool, please don't hesitate to reach out for some of our lessons learn etc","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203057145/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203063521","html_url":"https://github.com/apache/iceberg/issues/5370#issuecomment-1203063521","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5370","id":1203063521,"node_id":"IC_kwDOCW7NX85HtUrh","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-02T18:16:19Z","updated_at":"2022-08-02T18:18:09Z","author_association":"CONTRIBUTOR","body":"Cool thank you!\r\n\r\nI think we have a traditional Spark UDF you can register already (or examples in the JMH perf tears that show how to do it).\r\n\r\nYou might consider trying it and seeing if to see if they match / any other issues or differences.\r\n\r\nThe original PR for allowing data to be rewritten on sort using a \"zorder\" strategy (with example usage from Spark) is here: https://github.com/apache/iceberg/pull/3983","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203063521/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203066113","html_url":"https://github.com/apache/iceberg/pull/5327#issuecomment-1203066113","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5327","id":1203066113,"node_id":"IC_kwDOCW7NX85HtVUB","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-02T18:19:31Z","updated_at":"2022-08-02T18:19:31Z","author_association":"MEMBER","body":"> So we could do this, today we throw an error if the table exists, but if force==true, we just call drop table. And clarify in the docs what force option does. I would probably also in the code move some the logic to read the metadataFile up and then add a Precondition that the file exists, before the if (table.exists() block) because now it will drop if force=true.\r\n> \r\n> @RussellSpitzer @flyrain does that sound like it will work ?\r\n\r\nI prefer this approach (I think I said so before :) ) I still want the default of \"don't crash a table that's already there\" but I like having the option of \"succeed no matter what\". I think \"delete\" + \"register\" is fine even if we don't swap it atomically. My original thought was for folks doing more dangerous live swaps where we are shifting between two valid metadata.json s but even a small amount of downtime for that wouldn't be a big deal.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203066113/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203066130","html_url":"https://github.com/apache/iceberg/issues/5370#issuecomment-1203066130","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5370","id":1203066130,"node_id":"IC_kwDOCW7NX85HtVUS","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-02T18:19:32Z","updated_at":"2022-08-02T18:19:44Z","author_association":"CONTRIBUTOR","body":"And the utility functions to interleave bits from that PR will be used eventually in the function catalog.\r\n\r\nI'll reach out to you offline to see your experience as well @cccs-jc ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203066130/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203073623","html_url":"https://github.com/apache/iceberg/pull/5327#issuecomment-1203073623","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5327","id":1203073623,"node_id":"IC_kwDOCW7NX85HtXJX","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-02T18:28:22Z","updated_at":"2022-08-02T18:28:22Z","author_association":"COLLABORATOR","body":"> I prefer this approach (I think I said so before :) ) \r\n\r\nYes fine you win :).  Yea the only kind of downside is if we error re-creating the table, the table is dropped as the two are not atomic.  But register can just be called again in that case.  Agree its not worth the complexity to implement atomicity for a small gain.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203073623/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203076657","html_url":"https://github.com/apache/iceberg/pull/5302#issuecomment-1203076657","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5302","id":1203076657,"node_id":"IC_kwDOCW7NX85HtX4x","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-02T18:31:55Z","updated_at":"2022-08-02T18:31:55Z","author_association":"CONTRIBUTOR","body":"gentle ping @rdblue @aokolnychyi @RussellSpitzer","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203076657/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203077697","html_url":"https://github.com/apache/iceberg/pull/5327#issuecomment-1203077697","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5327","id":1203077697,"node_id":"IC_kwDOCW7NX85HtYJB","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-02T18:33:10Z","updated_at":"2022-08-02T18:33:28Z","author_association":"CONTRIBUTOR","body":"My concern for dropping table is that a catalog like HMS usually has hooks to react on events like a table is dropped. We don't really want to drop a table here, but it may trigger something unexpected.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203077697/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203078101","html_url":"https://github.com/apache/iceberg/pull/5327#issuecomment-1203078101","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5327","id":1203078101,"node_id":"IC_kwDOCW7NX85HtYPV","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-02T18:33:38Z","updated_at":"2022-08-02T18:33:38Z","author_association":"MEMBER","body":"> > I prefer this approach (I think I said so before :) )\r\n> \r\n> Yes fine you win :). Yea the only kind of downside is if we error re-creating the table, the table is dropped as the two are not atomic. But register can just be called again in that case. Agree its not worth the complexity to implement atomicity for a small gain.\r\n\r\nI thought we could just switch the \"create\" to an \"alter\" and keep atomicity but I didn't look too much into that.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203078101/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203078396","html_url":"https://github.com/apache/iceberg/pull/5302#issuecomment-1203078396","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5302","id":1203078396,"node_id":"IC_kwDOCW7NX85HtYT8","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-02T18:33:57Z","updated_at":"2022-08-02T18:33:57Z","author_association":"CONTRIBUTOR","body":"also cc @flyrain @szehon-ho @kbendick ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203078396/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203082550","html_url":"https://github.com/apache/iceberg/pull/5413#issuecomment-1203082550","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5413","id":1203082550,"node_id":"IC_kwDOCW7NX85HtZU2","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-02T18:38:58Z","updated_at":"2022-08-02T18:38:58Z","author_association":"CONTRIBUTOR","body":"Thanks for the review Szehon!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203082550/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203087530","html_url":"https://github.com/apache/iceberg/pull/5376#issuecomment-1203087530","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5376","id":1203087530,"node_id":"IC_kwDOCW7NX85Htaiq","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-02T18:44:48Z","updated_at":"2022-08-02T18:44:48Z","author_association":"COLLABORATOR","body":"All Spark tests are updated/fixed now.\r\n\r\nFyi @RussellSpitzer @aokolnychyi @rdblue if you guys have time to leave some feedback.  There are new tests added but its a bit big to show 'Files Changed': [TestMetadataTableMetricsColumns.java](https://github.com/apache/iceberg/pull/5376/files#diff-b2056d565254122d3c10959f8cb9b69e23d2e4d0cdf91418ef32d44c83c3d30f)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203087530/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203262487","html_url":"https://github.com/apache/iceberg/issues/5414#issuecomment-1203262487","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5414","id":1203262487,"node_id":"IC_kwDOCW7NX85HuFQX","user":{"login":"jessiedanwang","id":25239320,"node_id":"MDQ6VXNlcjI1MjM5MzIw","avatar_url":"https://avatars.githubusercontent.com/u/25239320?v=4","gravatar_id":"","url":"https://api.github.com/users/jessiedanwang","html_url":"https://github.com/jessiedanwang","followers_url":"https://api.github.com/users/jessiedanwang/followers","following_url":"https://api.github.com/users/jessiedanwang/following{/other_user}","gists_url":"https://api.github.com/users/jessiedanwang/gists{/gist_id}","starred_url":"https://api.github.com/users/jessiedanwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jessiedanwang/subscriptions","organizations_url":"https://api.github.com/users/jessiedanwang/orgs","repos_url":"https://api.github.com/users/jessiedanwang/repos","events_url":"https://api.github.com/users/jessiedanwang/events{/privacy}","received_events_url":"https://api.github.com/users/jessiedanwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-02T22:09:23Z","updated_at":"2022-08-02T22:09:23Z","author_association":"NONE","body":"thanks for getting back. I have tried cross-account IAM role, and the issue with createTable is gone, however, i am getting the following error when trying to write data to the table using df.writeTo(\"ns_name.xxxxxx\").append()\r\n\r\nDo i need to add inputFormat when creating table? Here is how iceberg table is created\r\nscala> val tableProperties = Map(\r\n      \"table_type\" -> \"iceberg\",\r\n      \"format-version\" -> \"2\",\r\n      \"write.distribution-mode\" -> \"hash\",\r\n      \"write.spark.fanout.enabled\" -> \"true\",\r\n      \"write.parquet.compression-codec\" -> \"snappy\",\r\n      \"write.avro.compression-codec\" -> \"snappy\",\r\n      \"write.metadata.delete-after-commit.enabled\" -> \"true\",\r\n      \"write.metadata.previous-versions-max\" -> \"3\",\r\n      \"write.target-file-size-bytes\" -> s\"$GIGABYTE\"\r\n    )\r\nscala> catalog.createTable(TableIdentifier.of(Namespace.of(database), tableName), schema, partitionSpec, JavaConverters.mapAsJavaMap(tableProperties))\r\n\r\n\r\norg.apache.spark.sql.AnalysisException: org.apache.hadoop.hive.ql.metadata.HiveException: Unable to fetch table xxxxxx. StorageDescriptor#InputFormat cannot be null for table: xxxxxx (Service: null; Status Code: 0; Error Code: null; Request ID: null; Proxy: null)\r\n\tat org.apache.spark.sql.hive.HiveExternalCatalog.withClient(HiveExternalCatalog.scala:135)\r\n\tat org.apache.spark.sql.hive.HiveExternalCatalog.tableExists(HiveExternalCatalog.scala:879)\r\n\tat org.apache.spark.sql.catalyst.catalog.ExternalCatalogWithListener.tableExists(ExternalCatalogWithListener.scala:146)\r\n\tat org.apache.spark.sql.catalyst.catalog.SessionCatalog.tableExists(SessionCatalog.scala:462)\r\n\tat org.apache.spark.sql.catalyst.catalog.SessionCatalog.requireTableExists(SessionCatalog.scala:197)\r\n\tat org.apache.spark.sql.catalyst.catalog.SessionCatalog.getTableRawMetadata(SessionCatalog.scala:488)\r\n\tat org.apache.spark.sql.catalyst.catalog.SessionCatalog.getTableMetadata(SessionCatalog.scala:474)\r\n\tat org.apache.spark.sql.execution.datasources.v2.V2SessionCatalog.loadTable(V2SessionCatalog.scala:65)\r\n\tat org.apache.spark.sql.connector.catalog.CatalogV2Util$.loadTable(CatalogV2Util.scala:282)\r\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$.loaded$lzycompute$1(Analyzer.scala:1183)\r\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$.loaded$1(Analyzer.scala:1183)\r\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$.$anonfun$lookupRelation$3(Analyzer.scala:1221)\r\n\tat scala.Option.orElse(Option.scala:447)\r\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$.org$apache$spark$sql$catalyst$analysis$Analyzer$ResolveRelations$$lookupRelation(Analyzer.scala:1220)\r\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$$anonfun$apply$10.applyOrElse(Analyzer.scala:1130)\r\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$$anonfun$apply$10.applyOrElse(Analyzer.scala:1112)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.$anonfun$resolveOperatorsUp$3(AnalysisHelper.scala:90)\r\n\tat org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(TreeNode.scala:75)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.$anonfun$resolveOperatorsUp$1(AnalysisHelper.scala:90)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$.allowInvokingTransformsInAnalyzer(AnalysisHelper.scala:221)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.resolveOperatorsUp(AnalysisHelper.scala:86)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.resolveOperatorsUp$(AnalysisHelper.scala:84)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.resolveOperatorsUp(LogicalPlan.scala:29)\r\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$.apply(Analyzer.scala:1112)\r\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$.apply(Analyzer.scala:1077)\r\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor.$anonfun$execute$1(RuleExecutor.scala:220)\r\n\tat scala.collection.LinearSeqOptimized.foldLeft(LinearSeqOptimized.scala:126)\r\n\tat scala.collection.LinearSeqOptimized.foldLeft$(LinearSeqOptimized.scala:122)\r\n\tat scala.collection.immutable.List.foldLeft(List.scala:89)\r\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor.executeBatch$1(RuleExecutor.scala:217)\r\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor.$anonfun$execute$6(RuleExecutor.scala:290)\r\n\tat scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)\r\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor$RuleExecutionContext$.withContext(RuleExecutor.scala:333)\r\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor.$anonfun$execute$5(RuleExecutor.scala:290)\r\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor.$anonfun$execute$5$adapted(RuleExecutor.scala:280)\r\n\tat scala.collection.immutable.List.foreach(List.scala:392)\r\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor.execute(RuleExecutor.scala:280)\r\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor.execute(RuleExecutor.scala:192)\r\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.org$apache$spark$sql$catalyst$analysis$Analyzer$$executeSameContext(Analyzer.scala:196)\r\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.execute(Analyzer.scala:190)\r\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.execute(Analyzer.scala:155)\r\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor.$anonfun$executeAndTrack$1(RuleExecutor.scala:183)\r\n\tat org.apache.spark.sql.catalyst.QueryPlanningTracker$.withTracker(QueryPlanningTracker.scala:107)\r\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor.executeAndTrack(RuleExecutor.scala:183)\r\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.$anonfun$executeAndCheck$1(Analyzer.scala:174)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$.markInAnalyzer(AnalysisHelper.scala:228)\r\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.executeAndCheck(Analyzer.scala:173)\r\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$analyzed$1(QueryExecution.scala:73)\r\n\tat org.apache.spark.sql.catalyst.QueryPlanningTracker.measurePhase(QueryPlanningTracker.scala:192)\r\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$1(QueryExecution.scala:163)\r\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:775)\r\n\tat org.apache.spark.sql.execution.QueryExecution.executePhase(QueryExecution.scala:163)\r\n\tat org.apache.spark.sql.execution.QueryExecution.analyzed$lzycompute(QueryExecution.scala:73)\r\n\tat org.apache.spark.sql.execution.QueryExecution.analyzed(QueryExecution.scala:71)\r\n\tat org.apache.spark.sql.execution.QueryExecution.assertAnalyzed(QueryExecution.scala:63)\r\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$withCachedData$1(QueryExecution.scala:77)\r\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:775)\r\n\tat org.apache.spark.sql.execution.QueryExecution.withCachedData$lzycompute(QueryExecution.scala:76)\r\n\tat org.apache.spark.sql.execution.QueryExecution.withCachedData(QueryExecution.scala:76)\r\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$optimizedPlan$1(QueryExecution.scala:87)\r\n\tat org.apache.spark.sql.catalyst.QueryPlanningTracker.measurePhase(QueryPlanningTracker.scala:192)\r\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$1(QueryExecution.scala:163)\r\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:775)\r\n\tat org.apache.spark.sql.execution.QueryExecution.executePhase(QueryExecution.scala:163)\r\n\tat org.apache.spark.sql.execution.QueryExecution.optimizedPlan$lzycompute(QueryExecution.scala:84)\r\n\tat org.apache.spark.sql.execution.QueryExecution.optimizedPlan(QueryExecution.scala:84)\r\n\tat org.apache.spark.sql.execution.QueryExecution.assertOptimized(QueryExecution.scala:95)\r\n\tat org.apache.spark.sql.execution.QueryExecution.executedPlan$lzycompute(QueryExecution.scala:113)\r\n\tat org.apache.spark.sql.execution.QueryExecution.executedPlan(QueryExecution.scala:110)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.executeQuery$1(SQLExecution.scala:105)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:135)\r\n\tat org.apache.spark.sql.catalyst.QueryPlanningTracker$.withTracker(QueryPlanningTracker.scala:107)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.withTracker(SQLExecution.scala:232)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$5(SQLExecution.scala:135)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:253)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:134)\r\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:775)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:68)\r\n\tat org.apache.spark.sql.DataFrameWriterV2.runCommand(DataFrameWriterV2.scala:196)\r\n\tat org.apache.spark.sql.DataFrameWriterV2.append(DataFrameWriterV2.scala:149)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203262487/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203268307","html_url":"https://github.com/apache/iceberg/pull/5373#issuecomment-1203268307","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5373","id":1203268307,"node_id":"IC_kwDOCW7NX85HuGrT","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-02T22:17:58Z","updated_at":"2022-08-02T23:52:24Z","author_association":"COLLABORATOR","body":"> I'm not sure about throwing an exception if a user specify delete function and if the file io supports bulk delete is the way to go, because then we're changing the behavior of the exposed deleteFunc API. I think if deleteFunc is set, the procedure continues to use that as a source of truth regardless of bulk delete support or not. If we throw an exception, that would mean user's code would need to get rewritten if it's using S3FileIO and running this procedure with custom delete. Let me know if i'm misunderstanding!\r\n\r\n> That being said, now we are changing the behavior if they do not specify a delete func and if it supports bulk delete. This change is less intrusive because it changes internally how the procedure runs and is not really exposed to a user. Let me know what you think.\r\n\r\nMaybe it was a bit of a misunderstanding, I was talking about the flag you are discussing with @dramaticlly (useBulkDelete).  So I was thinking, if useBulkDelete is on && deleteFunc is set, then its a misconfiguration.\r\n\r\nBut are we doing the flag?  Or are you suggesting, is to have deleteFunc always take precedence, ie if (deleteFunc set), always use the single file deleteFunc.   Otherwise, if FileIO supports bulkOperations, automatically use the bulk delete?\r\n\r\n\r\n> Also now we are delegating task management to the file IO, which I think makes sense but there's another argument that each procedure should control this since failure handling or retries would depend on the desired behavior for the procedure. What are peoples thoughts here? @dramaticlly @aokolnychyi @RussellSpitzer @karuppayya\r\n\r\nWhats the choice here, I suppose we will have to have an extra parameter on supportBulkOperations FileIOs to control retry, and this can be set by the various procedures?  I think after #5379 it will be easy to implement , as S3FileIO can just pass that parameter to Tasks?  ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203268307/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203269802","html_url":"https://github.com/apache/iceberg/pull/5375#issuecomment-1203269802","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5375","id":1203269802,"node_id":"IC_kwDOCW7NX85HuHCq","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-02T22:20:19Z","updated_at":"2022-08-02T22:20:19Z","author_association":"COLLABORATOR","body":"I think we need to coordinate with @amogh-jahagirdar who is also working on this on #5373.  There seems a few prs trying to use the bulk delete, and see if we can push the retry logic to the FileIO?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203269802/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203270642","html_url":"https://github.com/apache/iceberg/pull/5412#issuecomment-1203270642","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5412","id":1203270642,"node_id":"IC_kwDOCW7NX85HuHPy","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-02T22:21:33Z","updated_at":"2022-08-02T22:21:33Z","author_association":"COLLABORATOR","body":"Probably we need to synchronize with @amogh-jahagirdar on whether we need a bulkDeleteFunc, and whether retry happens at S3FileIO layer or not.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203270642/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203286166","html_url":"https://github.com/apache/iceberg/pull/5391#issuecomment-1203286166","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5391","id":1203286166,"node_id":"IC_kwDOCW7NX85HuLCW","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-02T22:46:40Z","updated_at":"2022-08-02T22:46:40Z","author_association":"CONTRIBUTOR","body":"@Fokko, I tried to fix `_annotate_namespace` to get this in, but the tests are failing. Looks like it is caused by merging #5421.\r\n\r\nAlso, I think we should make sure there's a test that catches the `locationUri` problem. Otherwise, this is good to merge when tests are passing.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203286166/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203290076","html_url":"https://github.com/apache/iceberg/pull/4871#issuecomment-1203290076","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4871","id":1203290076,"node_id":"IC_kwDOCW7NX85HuL_c","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-02T22:53:37Z","updated_at":"2022-08-02T22:53:37Z","author_association":"CONTRIBUTOR","body":"Thanks, @rzhang10! The latest changes look good. I merged this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203290076/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203293145","html_url":"https://github.com/apache/iceberg/pull/5391#issuecomment-1203293145","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5391","id":1203293145,"node_id":"IC_kwDOCW7NX85HuMvZ","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-02T22:59:16Z","updated_at":"2022-08-02T22:59:16Z","author_association":"CONTRIBUTOR","body":"@rdblue Not a problem at all, I've fixed the conflicts. \r\n\r\nhttps://github.com/apache/iceberg/pull/5391#discussion_r934034766 is still open, but we can also handle it in a backport. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203293145/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203327648","html_url":"https://github.com/apache/iceberg/pull/5391#issuecomment-1203327648","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5391","id":1203327648,"node_id":"IC_kwDOCW7NX85HuVKg","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-02T23:50:24Z","updated_at":"2022-08-02T23:50:24Z","author_association":"CONTRIBUTOR","body":"Merged! Awesome work, @Fokko!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203327648/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":1,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203339664","html_url":"https://github.com/apache/iceberg/issues/4035#issuecomment-1203339664","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4035","id":1203339664,"node_id":"IC_kwDOCW7NX85HuYGQ","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2022-08-03T00:13:22Z","updated_at":"2022-08-03T00:13:22Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203339664/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203339776","html_url":"https://github.com/apache/iceberg/issues/3920#issuecomment-1203339776","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3920","id":1203339776,"node_id":"IC_kwDOCW7NX85HuYIA","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2022-08-03T00:13:32Z","updated_at":"2022-08-03T00:13:32Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203339776/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203381169","html_url":"https://github.com/apache/iceberg/pull/5360#issuecomment-1203381169","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5360","id":1203381169,"node_id":"IC_kwDOCW7NX85HuiOx","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-03T01:29:14Z","updated_at":"2022-08-03T01:29:14Z","author_association":"CONTRIBUTOR","body":"@samredai, I think the next steps on this are to open PRs for the io and catalog modules. We need to think a bit more about what we want to expose from the expressions module. I think we may want something like the `Expressions` class in Java that hides creating references and literals.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203381169/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203390337","html_url":"https://github.com/apache/iceberg/issues/4190#issuecomment-1203390337","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4190","id":1203390337,"node_id":"IC_kwDOCW7NX85HukeB","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-03T01:46:14Z","updated_at":"2022-08-03T01:46:14Z","author_association":"CONTRIBUTOR","body":"I personally look forward to seeing your PR.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203390337/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203418242","html_url":"https://github.com/apache/iceberg/pull/4926#issuecomment-1203418242","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4926","id":1203418242,"node_id":"IC_kwDOCW7NX85HurSC","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-03T02:40:23Z","updated_at":"2022-08-03T02:51:27Z","author_association":"CONTRIBUTOR","body":"@namrathamyske Thanks for all the work on this! I've raised a PR https://github.com/namrathamyske/iceberg/pull/1/files to your fork, just addressing some of the comments @rdblue brought up, would love to get your thoughts on it. Also @rdblue would like to get your take as well.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203418242/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203422405","html_url":"https://github.com/apache/iceberg/pull/5375#issuecomment-1203422405","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5375","id":1203422405,"node_id":"IC_kwDOCW7NX85HusTF","user":{"login":"dungdm93","id":6848311,"node_id":"MDQ6VXNlcjY4NDgzMTE=","avatar_url":"https://avatars.githubusercontent.com/u/6848311?v=4","gravatar_id":"","url":"https://api.github.com/users/dungdm93","html_url":"https://github.com/dungdm93","followers_url":"https://api.github.com/users/dungdm93/followers","following_url":"https://api.github.com/users/dungdm93/following{/other_user}","gists_url":"https://api.github.com/users/dungdm93/gists{/gist_id}","starred_url":"https://api.github.com/users/dungdm93/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dungdm93/subscriptions","organizations_url":"https://api.github.com/users/dungdm93/orgs","repos_url":"https://api.github.com/users/dungdm93/repos","events_url":"https://api.github.com/users/dungdm93/events{/privacy}","received_events_url":"https://api.github.com/users/dungdm93/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-03T02:48:44Z","updated_at":"2022-08-03T02:48:44Z","author_association":"CONTRIBUTOR","body":"I don't think we should put retry logic into bulk delete. Because different client may wanna use different config. For examples `BaseTransaction` use `noRetry` while `HiveIcebergRecordWriter` use [`retry(3)`](https://github.com/apache/iceberg/blob/263441752393834c384a04d861cda1b8cb136a63/mr/src/main/java/org/apache/iceberg/mr/hive/HiveIcebergRecordWriter.java#L101)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203422405/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203423371","html_url":"https://github.com/apache/iceberg/pull/5392#issuecomment-1203423371","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5392","id":1203423371,"node_id":"IC_kwDOCW7NX85HusiL","user":{"login":"manuzhang","id":1191767,"node_id":"MDQ6VXNlcjExOTE3Njc=","avatar_url":"https://avatars.githubusercontent.com/u/1191767?v=4","gravatar_id":"","url":"https://api.github.com/users/manuzhang","html_url":"https://github.com/manuzhang","followers_url":"https://api.github.com/users/manuzhang/followers","following_url":"https://api.github.com/users/manuzhang/following{/other_user}","gists_url":"https://api.github.com/users/manuzhang/gists{/gist_id}","starred_url":"https://api.github.com/users/manuzhang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/manuzhang/subscriptions","organizations_url":"https://api.github.com/users/manuzhang/orgs","repos_url":"https://api.github.com/users/manuzhang/repos","events_url":"https://api.github.com/users/manuzhang/events{/privacy}","received_events_url":"https://api.github.com/users/manuzhang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-03T02:50:32Z","updated_at":"2022-08-03T02:50:32Z","author_association":"COLLABORATOR","body":"Not sure. The furthest I can track is https://github.com/apache/iceberg/pull/2591 and the behavior is same as now.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203423371/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203433139","html_url":"https://github.com/apache/iceberg/pull/5375#issuecomment-1203433139","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5375","id":1203433139,"node_id":"IC_kwDOCW7NX85Huu6z","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-03T03:11:10Z","updated_at":"2022-08-03T03:17:48Z","author_association":"CONTRIBUTOR","body":"@dungdm93 Not sure about comparing transactions and record writers but I think I understand what you're getting at. Another view on this (and I think this is what you are thinking, let me know if it's not) is that procedures should be in control of their retry strategy, failure handling and so on; not the FIleIO implementation because procedures/actions may want different configurations at different times.\r\n\r\nMy only doubt is that building a public Util which wraps around the existing Task framework mainly just for batch deletion seems heavy handed at this point in time. My feeling is that we shouldn't add public Util classes or any public kind of APIs unless we are really sure they will get used and so that's why I put it in the file IO implementation for simplicity; that seems more easily reversible in case folks want more configuration on retry behavior for different procedures. If we know that we want this customizability up front, then I think this makes sense. Right now looking at the implementation, it seems as though the desired delete behavior is basically the same, the only difference between the integrations is if we use concurrent execution or not (which I still think the fileIO layer should handle?)\r\n\r\nWould like to get the communities thoughts! @dungdm93 @szehon-ho @danielcweeks @rdblue ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203433139/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203467785","html_url":"https://github.com/apache/iceberg/issues/4190#issuecomment-1203467785","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4190","id":1203467785,"node_id":"IC_kwDOCW7NX85Hu3YJ","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-03T04:24:53Z","updated_at":"2022-08-03T04:51:05Z","author_association":"CONTRIBUTOR","body":"@lintingbin2009 it might be helpful to describe the solution at high-level design in this issue or some doc.\r\n\r\n> Every time newAppender is called, we will refresh the table schema and use the latest table schema to write the data file\r\n\r\nThis sounds expensive and may not work well at scale. if every writer task needs to poll table for every file, it can create a lot of load on the Iceberg metadata system. Ideally, the table schema polling and change should done by operator coordinator.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203467785/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203551979","html_url":"https://github.com/apache/iceberg/issues/4190#issuecomment-1203551979","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4190","id":1203551979,"node_id":"IC_kwDOCW7NX85HvL7r","user":{"login":"lintingbin","id":5699014,"node_id":"MDQ6VXNlcjU2OTkwMTQ=","avatar_url":"https://avatars.githubusercontent.com/u/5699014?v=4","gravatar_id":"","url":"https://api.github.com/users/lintingbin","html_url":"https://github.com/lintingbin","followers_url":"https://api.github.com/users/lintingbin/followers","following_url":"https://api.github.com/users/lintingbin/following{/other_user}","gists_url":"https://api.github.com/users/lintingbin/gists{/gist_id}","starred_url":"https://api.github.com/users/lintingbin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lintingbin/subscriptions","organizations_url":"https://api.github.com/users/lintingbin/orgs","repos_url":"https://api.github.com/users/lintingbin/repos","events_url":"https://api.github.com/users/lintingbin/events{/privacy}","received_events_url":"https://api.github.com/users/lintingbin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-03T06:48:04Z","updated_at":"2022-08-03T06:48:04Z","author_association":"CONTRIBUTOR","body":"@hililiwei @stevenzwu https://github.com/apache/iceberg/pull/5425 This is my PR. Hope to have some suggestions. Now we test in an environment with a parallelism of about 40. The checkpoint time is the same as before the dynamic refresh schema is not added.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203551979/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203559865","html_url":"https://github.com/apache/iceberg/pull/5334#issuecomment-1203559865","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5334","id":1203559865,"node_id":"IC_kwDOCW7NX85HvN25","user":{"login":"a49a","id":12015546,"node_id":"MDQ6VXNlcjEyMDE1NTQ2","avatar_url":"https://avatars.githubusercontent.com/u/12015546?v=4","gravatar_id":"","url":"https://api.github.com/users/a49a","html_url":"https://github.com/a49a","followers_url":"https://api.github.com/users/a49a/followers","following_url":"https://api.github.com/users/a49a/following{/other_user}","gists_url":"https://api.github.com/users/a49a/gists{/gist_id}","starred_url":"https://api.github.com/users/a49a/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/a49a/subscriptions","organizations_url":"https://api.github.com/users/a49a/orgs","repos_url":"https://api.github.com/users/a49a/repos","events_url":"https://api.github.com/users/a49a/events{/privacy}","received_events_url":"https://api.github.com/users/a49a/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-03T06:57:54Z","updated_at":"2022-08-03T06:58:25Z","author_association":"CONTRIBUTOR","body":"@rdblue I have moved this option into the Flink section. Please review it. Thanks a lot.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203559865/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203649949","html_url":"https://github.com/apache/iceberg/issues/3928#issuecomment-1203649949","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3928","id":1203649949,"node_id":"IC_kwDOCW7NX85Hvj2d","user":{"login":"ggershinsky","id":12033212,"node_id":"MDQ6VXNlcjEyMDMzMjEy","avatar_url":"https://avatars.githubusercontent.com/u/12033212?v=4","gravatar_id":"","url":"https://api.github.com/users/ggershinsky","html_url":"https://github.com/ggershinsky","followers_url":"https://api.github.com/users/ggershinsky/followers","following_url":"https://api.github.com/users/ggershinsky/following{/other_user}","gists_url":"https://api.github.com/users/ggershinsky/gists{/gist_id}","starred_url":"https://api.github.com/users/ggershinsky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ggershinsky/subscriptions","organizations_url":"https://api.github.com/users/ggershinsky/orgs","repos_url":"https://api.github.com/users/ggershinsky/repos","events_url":"https://api.github.com/users/ggershinsky/events{/privacy}","received_events_url":"https://api.github.com/users/ggershinsky/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-03T08:32:54Z","updated_at":"2022-08-03T08:32:54Z","author_association":"CONTRIBUTOR","body":"Thanks Kyle, looks like this worked. \r\nWe indeed still need this feature; its turn will come after the encryption basics are fully merged.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203649949/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203714505","html_url":"https://github.com/apache/iceberg/issues/5414#issuecomment-1203714505","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5414","id":1203714505,"node_id":"IC_kwDOCW7NX85HvznJ","user":{"login":"singhpk234","id":35593236,"node_id":"MDQ6VXNlcjM1NTkzMjM2","avatar_url":"https://avatars.githubusercontent.com/u/35593236?v=4","gravatar_id":"","url":"https://api.github.com/users/singhpk234","html_url":"https://github.com/singhpk234","followers_url":"https://api.github.com/users/singhpk234/followers","following_url":"https://api.github.com/users/singhpk234/following{/other_user}","gists_url":"https://api.github.com/users/singhpk234/gists{/gist_id}","starred_url":"https://api.github.com/users/singhpk234/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/singhpk234/subscriptions","organizations_url":"https://api.github.com/users/singhpk234/orgs","repos_url":"https://api.github.com/users/singhpk234/repos","events_url":"https://api.github.com/users/singhpk234/events{/privacy}","received_events_url":"https://api.github.com/users/singhpk234/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-03T09:34:27Z","updated_at":"2022-08-03T09:35:09Z","author_association":"CONTRIBUTOR","body":"> however, i am getting the following error when trying to write data to the table using df.writeTo(\"ns_name.xxxxxx\").append()\r\n\r\nI think this is happening because you haven't specified the catalog name in identifier of write to and niether made `my_catalog` as default .... \r\n\r\ncan you please try doing : `df.writeTo(\"my_catalog.ns_name.xxxxxx\").append()` instead (ref : https://iceberg.apache.org/docs/latest/spark-writes/#appending-data)\r\n\r\nref : A ticket stating similar issue : https://github.com/apache/iceberg/issues/2202#issuecomment-786301938\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203714505/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203731009","html_url":"https://github.com/apache/iceberg/pull/5367#issuecomment-1203731009","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5367","id":1203731009,"node_id":"IC_kwDOCW7NX85Hv3pB","user":{"login":"singhpk234","id":35593236,"node_id":"MDQ6VXNlcjM1NTkzMjM2","avatar_url":"https://avatars.githubusercontent.com/u/35593236?v=4","gravatar_id":"","url":"https://api.github.com/users/singhpk234","html_url":"https://github.com/singhpk234","followers_url":"https://api.github.com/users/singhpk234/followers","following_url":"https://api.github.com/users/singhpk234/following{/other_user}","gists_url":"https://api.github.com/users/singhpk234/gists{/gist_id}","starred_url":"https://api.github.com/users/singhpk234/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/singhpk234/subscriptions","organizations_url":"https://api.github.com/users/singhpk234/orgs","repos_url":"https://api.github.com/users/singhpk234/repos","events_url":"https://api.github.com/users/singhpk234/events{/privacy}","received_events_url":"https://api.github.com/users/singhpk234/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-03T09:50:46Z","updated_at":"2022-08-03T09:50:46Z","author_association":"CONTRIBUTOR","body":"Thanks for the review @szehon-ho, @rdblue !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203731009/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203849742","html_url":"https://github.com/apache/iceberg/issues/3941#issuecomment-1203849742","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3941","id":1203849742,"node_id":"IC_kwDOCW7NX85HwUoO","user":{"login":"donatobarone","id":12485295,"node_id":"MDQ6VXNlcjEyNDg1Mjk1","avatar_url":"https://avatars.githubusercontent.com/u/12485295?v=4","gravatar_id":"","url":"https://api.github.com/users/donatobarone","html_url":"https://github.com/donatobarone","followers_url":"https://api.github.com/users/donatobarone/followers","following_url":"https://api.github.com/users/donatobarone/following{/other_user}","gists_url":"https://api.github.com/users/donatobarone/gists{/gist_id}","starred_url":"https://api.github.com/users/donatobarone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/donatobarone/subscriptions","organizations_url":"https://api.github.com/users/donatobarone/orgs","repos_url":"https://api.github.com/users/donatobarone/repos","events_url":"https://api.github.com/users/donatobarone/events{/privacy}","received_events_url":"https://api.github.com/users/donatobarone/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-03T11:52:28Z","updated_at":"2022-08-03T11:52:28Z","author_association":"NONE","body":"I see there is a draft PR for this change, but no updates since the 20th of May, is there any approximate timeline on when this will be released? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1203849742/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204082330","html_url":"https://github.com/apache/iceberg/pull/5036#issuecomment-1204082330","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5036","id":1204082330,"node_id":"IC_kwDOCW7NX85HxNaa","user":{"login":"SinghAsDev","id":4915557,"node_id":"MDQ6VXNlcjQ5MTU1NTc=","avatar_url":"https://avatars.githubusercontent.com/u/4915557?v=4","gravatar_id":"","url":"https://api.github.com/users/SinghAsDev","html_url":"https://github.com/SinghAsDev","followers_url":"https://api.github.com/users/SinghAsDev/followers","following_url":"https://api.github.com/users/SinghAsDev/following{/other_user}","gists_url":"https://api.github.com/users/SinghAsDev/gists{/gist_id}","starred_url":"https://api.github.com/users/SinghAsDev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SinghAsDev/subscriptions","organizations_url":"https://api.github.com/users/SinghAsDev/orgs","repos_url":"https://api.github.com/users/SinghAsDev/repos","events_url":"https://api.github.com/users/SinghAsDev/events{/privacy}","received_events_url":"https://api.github.com/users/SinghAsDev/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-03T15:13:47Z","updated_at":"2022-08-03T15:13:47Z","author_association":"CONTRIBUTOR","body":"@pvary @szehon-ho @rdblue I think this is ready now? The one test failure is not related to this diff. I will force push to re-trigger the checks.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204082330/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204100668","html_url":"https://github.com/apache/iceberg/issues/5414#issuecomment-1204100668","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5414","id":1204100668,"node_id":"IC_kwDOCW7NX85HxR48","user":{"login":"jessiedanwang","id":25239320,"node_id":"MDQ6VXNlcjI1MjM5MzIw","avatar_url":"https://avatars.githubusercontent.com/u/25239320?v=4","gravatar_id":"","url":"https://api.github.com/users/jessiedanwang","html_url":"https://github.com/jessiedanwang","followers_url":"https://api.github.com/users/jessiedanwang/followers","following_url":"https://api.github.com/users/jessiedanwang/following{/other_user}","gists_url":"https://api.github.com/users/jessiedanwang/gists{/gist_id}","starred_url":"https://api.github.com/users/jessiedanwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jessiedanwang/subscriptions","organizations_url":"https://api.github.com/users/jessiedanwang/orgs","repos_url":"https://api.github.com/users/jessiedanwang/repos","events_url":"https://api.github.com/users/jessiedanwang/events{/privacy}","received_events_url":"https://api.github.com/users/jessiedanwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-03T15:21:42Z","updated_at":"2022-08-03T15:21:42Z","author_association":"NONE","body":"The issue is resolved after specifying the catalog name, thanks a lot! \r\n\r\nNow i am getting KyroException when using 'MERGE INTO'\r\n\r\nHere is what we did,\r\ndf.createOrReplaceGlobalTempView(\"temp_view\")\r\n\r\nMERGE INTO my_catalog.ns_name.table_name t\r\nUSING (SELECT * FROM global_temp.temp_view) s\r\nON s.id = t.id\r\nWHEN MATCHED THEN UPDATE SET *\r\nWHEN NOT MATCHED THEN INSERT *\r\n\r\nHere is error message\r\n22/08/03 14:29:11 WARN TaskSetManager: Lost task 8.0 in stage 15.0 (TID 1041) (xxx.xxx.xxx.xxx executor 12): java.io.IOException: com.esotericsoftware.kryo.KryoException: java.lang.UnsupportedOperationException\r\nSerialization trace:\r\nproperties (org.apache.iceberg.aws.s3.S3FileIO)\r\nio (org.apache.iceberg.spark.source.SerializableTableWithSize)\r\n\tat org.apache.spark.util.Utils$.tryOrIOException(Utils.scala:1412)\r\n\tat org.apache.spark.broadcast.TorrentBroadcast.readBroadcastBlock(TorrentBroadcast.scala:226)\r\n\tat org.apache.spark.broadcast.TorrentBroadcast.getValue(TorrentBroadcast.scala:103)\r\n\tat org.apache.spark.broadcast.Broadcast.value(Broadcast.scala:70)\r\n\tat org.apache.iceberg.spark.source.SparkWrite$WriterFactory.createWriter(SparkWrite.java:566)\r\n\tat org.apache.iceberg.spark.source.SparkWrite$WriterFactory.createWriter(SparkWrite.java:561)\r\n\tat org.apache.spark.sql.execution.datasources.v2.DataWritingSparkTask$.run(WriteToDataSourceV2Exec.scala:408)\r\n\tat org.apache.spark.sql.execution.datasources.v2.V2TableWriteExec.$anonfun$writeWithV2$2(WriteToDataSourceV2Exec.scala:360)\r\n\tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:90)\r\n\tat org.apache.spark.scheduler.Task.run(Task.scala:131)\r\n\tat org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$3(Executor.scala:497)\r\n\tat org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1439)\r\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:500)\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n\tat java.lang.Thread.run(Thread.java:750)\r\nCaused by: com.esotericsoftware.kryo.KryoException: java.lang.UnsupportedOperationException\r\nSerialization trace:\r\nproperties (org.apache.iceberg.aws.s3.S3FileIO)\r\nio (org.apache.iceberg.spark.source.SerializableTableWithSize)\r\n\tat com.esotericsoftware.kryo.serializers.ObjectField.read(ObjectField.java:144)\r\n\tat com.esotericsoftware.kryo.serializers.FieldSerializer.read(FieldSerializer.java:543)\r\n\tat com.esotericsoftware.kryo.Kryo.readObject(Kryo.java:731)\r\n\tat com.esotericsoftware.kryo.serializers.ObjectField.read(ObjectField.java:125)\r\n\tat com.esotericsoftware.kryo.serializers.FieldSerializer.read(FieldSerializer.java:543)\r\n\tat com.esotericsoftware.kryo.Kryo.readClassAndObject(Kryo.java:813)\r\n\tat org.apache.spark.serializer.KryoDeserializationStream.readObject(KryoSerializer.scala:297)\r\n\tat org.apache.spark.broadcast.TorrentBroadcast$.$anonfun$unBlockifyObject$4(TorrentBroadcast.scala:336)\r\n\tat org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1439)\r\n\tat org.apache.spark.broadcast.TorrentBroadcast$.unBlockifyObject(TorrentBroadcast.scala:338)\r\n\tat org.apache.spark.broadcast.TorrentBroadcast.$anonfun$readBroadcastBlock$4(TorrentBroadcast.scala:257)\r\n\tat scala.Option.getOrElse(Option.scala:189)\r\n\tat org.apache.spark.broadcast.TorrentBroadcast.$anonfun$readBroadcastBlock$2(TorrentBroadcast.scala:231)\r\n\tat org.apache.spark.util.KeyLock.withLock(KeyLock.scala:64)\r\n\tat org.apache.spark.broadcast.TorrentBroadcast.$anonfun$readBroadcastBlock$1(TorrentBroadcast.scala:226)\r\n\tat org.apache.spark.util.Utils$.tryOrIOException(Utils.scala:1405)\r\n\t... 15 more\r\nCaused by: java.lang.UnsupportedOperationException\r\n\tat org.apache.iceberg.relocated.com.google.common.collect.ImmutableMap.put(ImmutableMap.java:714)\r\n\tat com.esotericsoftware.kryo.serializers.MapSerializer.read(MapSerializer.java:162)\r\n\tat com.esotericsoftware.kryo.serializers.MapSerializer.read(MapSerializer.java:39)\r\n\tat com.esotericsoftware.kryo.Kryo.readObject(Kryo.java:731)\r\n\tat com.esotericsoftware.kryo.serializers.ObjectField.read(ObjectField.java:125)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204100668/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204248317","html_url":"https://github.com/apache/iceberg/pull/4826#issuecomment-1204248317","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4826","id":1204248317,"node_id":"IC_kwDOCW7NX85Hx179","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-03T17:14:27Z","updated_at":"2022-08-03T17:14:27Z","author_association":"MEMBER","body":"@rdblue , @RussellSpitzer : ping...","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204248317/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204248363","html_url":"https://github.com/apache/iceberg/pull/5375#issuecomment-1204248363","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5375","id":1204248363,"node_id":"IC_kwDOCW7NX85Hx18r","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-03T17:14:28Z","updated_at":"2022-08-03T17:14:28Z","author_association":"COLLABORATOR","body":"> I don't think we should put retry logic into bulk delete. Because different client may wanna use different config. For examples BaseTransaction use noRetry while HiveIcebergRecordWriter use [retry(3)](https://github.com/apache/iceberg/blob/263441752393834c384a04d861cda1b8cb136a63/mr/src/main/java/org/apache/iceberg/mr/hive/HiveIcebergRecordWriter.java#L101)\r\n\r\n> @dungdm93 Not sure about comparing transactions and record writers but I think I understand what you're getting at. Another view on this (and I think this is what you are thinking, let me know if it's not) is that procedures should be in control of their retry strategy, failure handling and so on; not the FIleIO implementation because procedures/actions may want different configurations at different times.\r\n\r\nTo me, if we have decided to push down the batching logic S3FileIO.deleteFiles() which seems the case, I'm not sure I see another way than for the S3FileIO to handle the retry logic.  The caller cannot retry the whole thing in bulk, because some batches may succeeded and others failed, right?  If thats the case, the only thing we can do then is to have the callers pass in different options for retry to S3FileIO, to preserve their original intent?  For example expireSnapshot has retry (3), and these ones here have no retry, like you mentioned.  Or maybe I'm not being imaginative enough.  ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204248363/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204289036","html_url":"https://github.com/apache/iceberg/pull/5159#issuecomment-1204289036","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5159","id":1204289036,"node_id":"IC_kwDOCW7NX85Hx_4M","user":{"login":"danielcweeks","id":4925077,"node_id":"MDQ6VXNlcjQ5MjUwNzc=","avatar_url":"https://avatars.githubusercontent.com/u/4925077?v=4","gravatar_id":"","url":"https://api.github.com/users/danielcweeks","html_url":"https://github.com/danielcweeks","followers_url":"https://api.github.com/users/danielcweeks/followers","following_url":"https://api.github.com/users/danielcweeks/following{/other_user}","gists_url":"https://api.github.com/users/danielcweeks/gists{/gist_id}","starred_url":"https://api.github.com/users/danielcweeks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielcweeks/subscriptions","organizations_url":"https://api.github.com/users/danielcweeks/orgs","repos_url":"https://api.github.com/users/danielcweeks/repos","events_url":"https://api.github.com/users/danielcweeks/events{/privacy}","received_events_url":"https://api.github.com/users/danielcweeks/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-03T17:51:42Z","updated_at":"2022-08-03T17:51:42Z","author_association":"CONTRIBUTOR","body":"The concept of location ownership and catalog behaviors around it are something that I feel we need to be more specific about.  While this may work for specific uses of HiveCatalog, it very likely wouldn't be consistent across catalog implementations and even has some potential side-effects (e.g. renamed tables may end up sharing location and result in dropping data incorrectly).  \r\n\r\nThese behaviors should really be owned by the Catalog (not the table) and should be tied to specific guarantees of the catalog implementation (i.e. de-conflicted/unique locations). \r\n\r\nI agree we want to be able to support this behavior, but I don't feel like this approach is comprehensive enough to address the problem. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204289036/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204305966","html_url":"https://github.com/apache/iceberg/issues/3941#issuecomment-1204305966","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3941","id":1204305966,"node_id":"IC_kwDOCW7NX85HyEAu","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-03T18:07:00Z","updated_at":"2022-08-03T18:07:00Z","author_association":"CONTRIBUTOR","body":"We've made a lot of progress on that. Here is the page to trace the progress, https://github.com/apache/iceberg/projects/26. There are more PRs merged and PRs in the review. Unfortunately, I don't have the permission to update the page. \r\nWe don't have a timeline. I'd guess the CDC feature for copy-on-write will be available in 2 month. cc @aokolnychyi @RussellSpitzer ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204305966/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204319969","html_url":"https://github.com/apache/iceberg/issues/5414#issuecomment-1204319969","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5414","id":1204319969,"node_id":"IC_kwDOCW7NX85HyHbh","user":{"login":"singhpk234","id":35593236,"node_id":"MDQ6VXNlcjM1NTkzMjM2","avatar_url":"https://avatars.githubusercontent.com/u/35593236?v=4","gravatar_id":"","url":"https://api.github.com/users/singhpk234","html_url":"https://github.com/singhpk234","followers_url":"https://api.github.com/users/singhpk234/followers","following_url":"https://api.github.com/users/singhpk234/following{/other_user}","gists_url":"https://api.github.com/users/singhpk234/gists{/gist_id}","starred_url":"https://api.github.com/users/singhpk234/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/singhpk234/subscriptions","organizations_url":"https://api.github.com/users/singhpk234/orgs","repos_url":"https://api.github.com/users/singhpk234/repos","events_url":"https://api.github.com/users/singhpk234/events{/privacy}","received_events_url":"https://api.github.com/users/singhpk234/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-03T18:20:35Z","updated_at":"2022-08-03T18:20:35Z","author_association":"CONTRIBUTOR","body":">Caused by: java.lang.UnsupportedOperationException\r\nat org.apache.iceberg.relocated.com.google.common.collect.ImmutableMap.put(ImmutableMap.java:714)\r\n\r\nI think this is happening because Kryo is not able to serialize / de-serialize Immutable map (this comes from `properties` in S3FileIO). (ref : https://groups.google.com/g/kryo-users/c/KP2FiJHFTzs). \r\n\r\npossible work-around : \r\n1. use Java serializer.\r\n2. you can use https://github.com/magro/kryo-serializers which has classes for Immutable Map, and register via methods described here https://spark.apache.org/docs/latest/tuning.html#data-serialization. As the twitter chill library also doesn't contains this : https://github.com/twitter/chill/issues/66\r\n\r\n\r\nHere is a sample test case in iceberg for the same, which fails in master : \r\n```java\r\n  @Test\r\n  public void testImmutableMapWithKryo() throws IOException {\r\n    Map<String, String> dummyMap = ImmutableMap.of(\"x\", \"y\");\r\n    KryoHelpers.roundTripSerialize(dummyMap);\r\n  }\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204319969/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204328588","html_url":"https://github.com/apache/iceberg/pull/5268#issuecomment-1204328588","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5268","id":1204328588,"node_id":"IC_kwDOCW7NX85HyJiM","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-03T18:29:21Z","updated_at":"2022-08-03T18:29:21Z","author_association":"CONTRIBUTOR","body":"Thanks @nastra! I just merged this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204328588/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204333933","html_url":"https://github.com/apache/iceberg/pull/5405#issuecomment-1204333933","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5405","id":1204333933,"node_id":"IC_kwDOCW7NX85HyK1t","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-03T18:34:50Z","updated_at":"2022-08-03T18:34:50Z","author_association":"CONTRIBUTOR","body":"@Fokko, these changes look fine to me. I'll defer to @pvary to merge when he's had a chance to review.\r\n\r\nI'm not sure that I understand how this fixes the initial failure case though. Was it just that the last `/` was missing?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204333933/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204339304","html_url":"https://github.com/apache/iceberg/pull/4588#issuecomment-1204339304","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4588","id":1204339304,"node_id":"IC_kwDOCW7NX85HyMJo","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-03T18:40:05Z","updated_at":"2022-08-03T18:40:05Z","author_association":"CONTRIBUTOR","body":"I ran `IcebergSourceParquetPosDeleteBenchmark` and `IcebergSourceParquetEqDeleteBenchmark` on the state of master when I last rebased and on my last change. The results for `readIceberg` and `readIcebergVectorized` are as follows:\r\n<img width=\"1395\" alt=\"Screen Shot 2022-08-03 at 11 13 05 AM\" src=\"https://user-images.githubusercontent.com/3925490/182683434-1f1a6583-703f-4b96-a671-9049a1ea46ab.png\">\r\n\r\nThere is hardly any difference for `IcebergSourceParquetPosDeleteBenchmark`.\r\nFor `IcebergSourceParquetEqDeleteBenchmark`, the numbers show greater difference (some worse and some better, comparing after to before), but due to the much greater variances, I think the differences are within the variances.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204339304/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204340488","html_url":"https://github.com/apache/iceberg/pull/4588#issuecomment-1204340488","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4588","id":1204340488,"node_id":"IC_kwDOCW7NX85HyMcI","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-03T18:41:13Z","updated_at":"2022-08-03T18:41:13Z","author_association":"CONTRIBUTOR","body":"I'm going to rebase on master again and conform to the new spotless code style so that this can merge.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204340488/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204340849","html_url":"https://github.com/apache/iceberg/pull/5405#issuecomment-1204340849","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5405","id":1204340849,"node_id":"IC_kwDOCW7NX85HyMhx","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-03T18:41:35Z","updated_at":"2022-08-03T18:43:37Z","author_association":"CONTRIBUTOR","body":"@rdblue Thanks for reviewing. It is when the location is somewhere without a child. The trailing `/` is automatically removed from hive warehouse dir. This way you can never use a base url because it thinks it is a relative path:\r\n```\r\nWelcome to\r\n      ____              __\r\n     / __/__  ___ _____/ /__\r\n    _\\ \\/ _ \\/ _ `/ __/  '_/\r\n   /___/ .__/\\_,_/_/ /_/\\_\\   version 3.3.0\r\n      /_/\r\n         \r\nUsing Scala version 2.12.15 (OpenJDK 64-Bit Server VM, Java 18.0.2)\r\nType in expressions to have them evaluated.\r\nType :help for more information.\r\n\r\nscala> import org.apache.hadoop.fs.Path\r\nimport org.apache.hadoop.fs.Path\r\n\r\nscala> new Path(\"s3://warehouse\", \"nyc\")\r\njava.lang.IllegalArgumentException: java.net.URISyntaxException: Relative path in absolute URI: s3://warehousenyc\r\n  at org.apache.hadoop.fs.Path.initialize(Path.java:263)\r\n  at org.apache.hadoop.fs.Path.<init>(Path.java:161)\r\n  at org.apache.hadoop.fs.Path.<init>(Path.java:119)\r\n  ... 43 elided\r\nCaused by: java.net.URISyntaxException: Relative path in absolute URI: s3://warehousenyc\r\n  at java.base/java.net.URI.checkPath(URI.java:1998)\r\n  at java.base/java.net.URI.<init>(URI.java:780)\r\n  at org.apache.hadoop.fs.Path.initialize(Path.java:260)\r\n  ... 45 more\r\n\r\nscala> new Path(\"s3://warehouse/\", \"nyc\")\r\nres2: org.apache.hadoop.fs.Path = s3://warehouse/nyc\r\n\r\nscala> new Path(\"s3://warehouse/abc\", \"nyc\")\r\nres3: org.apache.hadoop.fs.Path = s3://warehouse/abc/nyc\r\n```\r\nI think we should just remove the Hadoop Path here.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204340849/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204612037","html_url":"https://github.com/apache/iceberg/issues/4040#issuecomment-1204612037","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4040","id":1204612037,"node_id":"IC_kwDOCW7NX85HzOvF","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2022-08-04T00:12:32Z","updated_at":"2022-08-04T00:12:32Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204612037/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204612135","html_url":"https://github.com/apache/iceberg/issues/3916#issuecomment-1204612135","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3916","id":1204612135,"node_id":"IC_kwDOCW7NX85HzOwn","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2022-08-04T00:12:41Z","updated_at":"2022-08-04T00:12:41Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204612135/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204612154","html_url":"https://github.com/apache/iceberg/issues/3913#issuecomment-1204612154","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3913","id":1204612154,"node_id":"IC_kwDOCW7NX85HzOw6","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2022-08-04T00:12:44Z","updated_at":"2022-08-04T00:12:44Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204612154/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204613763","html_url":"https://github.com/apache/iceberg/issues/4040#issuecomment-1204613763","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4040","id":1204613763,"node_id":"IC_kwDOCW7NX85HzPKD","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-04T00:15:11Z","updated_at":"2022-08-04T00:15:11Z","author_association":"CONTRIBUTOR","body":"Closing this as we’re using one now in the OpenAPI validation GH action which is good enough.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204613763/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204617847","html_url":"https://github.com/apache/iceberg/issues/5356#issuecomment-1204617847","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5356","id":1204617847,"node_id":"IC_kwDOCW7NX85HzQJ3","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-04T00:21:32Z","updated_at":"2022-08-04T00:21:32Z","author_association":"CONTRIBUTOR","body":"I also think that your fork doesn’t have the latest tags and can confirm this is working for me.\r\n\r\nIf you `git fetch upstream —all` (replacing upstream with apache or whatever you call the Apache GitHub remote repository), you should be good.\r\n\r\nHere’s where it’s specified btw: https://github.com/apache/iceberg/blob/1b989c86a3c0da0bbe7d5f385618116cd899bdf2/.palantir/revapi.yml#L2\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204617847/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204620163","html_url":"https://github.com/apache/iceberg/issues/5356#issuecomment-1204620163","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5356","id":1204620163,"node_id":"IC_kwDOCW7NX85HzQuD","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-04T00:25:04Z","updated_at":"2022-08-04T00:25:04Z","author_association":"CONTRIBUTOR","body":"Oh I just noticed you’re trying on 0.12.0. Is that intentional?\r\n\r\nPreviously, the previous version was determined off of a tag on the master branch `release-base-0.xx.yy` like `release-base-0.13.0`.\r\n\r\nIf you’re intentionally on 0.12.0, then revapi shouldn’t be run there at all and I’d love to find out how that happened. If it’s just stating `release-base-0.12.0`, then that’s the last “release-base” tag you have and you need to fetch release-base-0.13.0 and others via `git fetch`.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204620163/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204670595","html_url":"https://github.com/apache/iceberg/pull/5312#issuecomment-1204670595","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5312","id":1204670595,"node_id":"IC_kwDOCW7NX85HzdCD","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-04T02:00:03Z","updated_at":"2022-08-04T02:00:03Z","author_association":"CONTRIBUTOR","body":"I suggest the following order:\r\n1. Squash all commits (if you're going to do this, might as well do it first).\r\n2. Rebase against master at commit before [99b41eb](https://github.com/apache/iceberg/commit/99b41eb9fbae1eb6c0501ce1fd1c9008893583b4) (otherwise build will fail due to spotless being enforced) -- I normally build after the rebase to make sure the rebase is correct.\r\n3. Rebase against HEAD of master.\r\n4. Run `./gradlew spotlessApply`. I would build after that.\r\n\r\nIf we are going to rebase against master twice, before the spotlessApply (\"Big Bang\") and then to HEAD, in the first rebase, the code base has not yet been updated to the new style, so running `./gradlew spotlessApply` after this rebase means you're going to change a ton of files (correct me if I'm wrong, but `./gradlew spotlessApply` would apply to everything, right?). Why do this when you're going to rebase again on HEAD where the \"Big Bang\" has happened? I'd think you want to run `./gradlew spotlessApply` at a point where it'd at most modify the files that are added/modified in your change.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204670595/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204690039","html_url":"https://github.com/apache/iceberg/issues/5414#issuecomment-1204690039","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5414","id":1204690039,"node_id":"IC_kwDOCW7NX85Hzhx3","user":{"login":"jessiedanwang","id":25239320,"node_id":"MDQ6VXNlcjI1MjM5MzIw","avatar_url":"https://avatars.githubusercontent.com/u/25239320?v=4","gravatar_id":"","url":"https://api.github.com/users/jessiedanwang","html_url":"https://github.com/jessiedanwang","followers_url":"https://api.github.com/users/jessiedanwang/followers","following_url":"https://api.github.com/users/jessiedanwang/following{/other_user}","gists_url":"https://api.github.com/users/jessiedanwang/gists{/gist_id}","starred_url":"https://api.github.com/users/jessiedanwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jessiedanwang/subscriptions","organizations_url":"https://api.github.com/users/jessiedanwang/orgs","repos_url":"https://api.github.com/users/jessiedanwang/repos","events_url":"https://api.github.com/users/jessiedanwang/events{/privacy}","received_events_url":"https://api.github.com/users/jessiedanwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-04T02:39:56Z","updated_at":"2022-08-04T02:39:56Z","author_association":"NONE","body":"Thanks for getting back to me quickly. I am still getting the same error after adding the following, do i miss anything here?\r\n\r\nval sparkConf = new SparkConf().setAppName(appName).registerKryoClasses(Array(classOf[com.google.common.collect.ImmutableList[Any]], classOf[com.google.common.collect.ImmutableMap[Any, Any]]))\r\n\r\nspark = SparkSession\r\n        .builder()\r\n        .config(\"spark.sql.legacy.parquet.datetimeRebaseModeInWrite\", \"CORRECTED\")\r\n        .config(\"spark.sql.extensions\", \"org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions\") // Iceberg related configs\r\n        .config(\"spark.sql.autoBroadcastJoinThreshold\", \"-1\")\r\n        .config(\"spark.sql.adaptive.autoBroadcastJoinThreshold\", \"-1\")\r\n        .config(s\"spark.sql.catalog.iceberg_catalog\", \"org.apache.iceberg.spark.SparkCatalog\")\r\n        .config(s\"spark.sql.catalog.iceberg_catalog.warehouse\", warehousePath)\r\n        .config(s\"spark.sql.catalog.iceberg_catalog.catalog-impl\", \"org.apache.iceberg.aws.glue.GlueCatalog\")\r\n        .config(s\"spark.sql.catalog.iceberg_catalog.io-impl\", \"org.apache.iceberg.aws.s3.S3FileIO\")\r\n        .config(s\"spark.sql.catalog.iceberg_catalog.client.factory\", \"org.apache.iceberg.aws.AssumeRoleAwsClientFactory\")\r\n        .config(s\"spark.sql.catalog.iceberg_catalog.client.assume-role.arn\", s\"arn:aws:iam::$catalogId:role/$role\")\r\n        .config(s\"spark.sql.catalog.iceberg_catalog.client.assume-role.region\", \"us-east-2\")\r\n        .config(\"spark.sql.iceberg.handle-timestamp-without-timezone\", \"true\")\r\n        .config(\"spark.hadoop.hive.metastore.glue.catalogid\", catalogId)\r\n        .config(\"spark.serializer\", \"org.apache.spark.serializer.KryoSerializer\")\r\n        .config(sparkConf)\r\n        .enableHiveSupport()\r\n        .getOrCreate()\r\n\r\nI have also tried the following, same error as well,\r\n\r\nspark = SparkSession\r\n        .builder()\r\n        .config(\"spark.serializer\", \"org.apache.spark.serializer.KryoSerializer\")\r\n        .config(\"spark.kryo.registrator\", \"xxx.xxx.CustomKryoRegistrator\")\r\n        ....\r\n\r\nimport com.esotericsoftware.kryo.Kryo\r\nimport de.javakaffee.kryoserializers.guava.{ImmutableListSerializer, ImmutableSetSerializer, ImmutableMapSerializer}\r\nimport org.apache.spark.serializer.KryoRegistrator\r\n\r\nclass CustomKryoRegistrator extends KryoRegistrator {\r\n  override def registerClasses(kryo: Kryo): Unit = {\r\n    ImmutableListSerializer.registerSerializers(kryo)\r\n    ImmutableSetSerializer.registerSerializers(kryo)\r\n    ImmutableMapSerializer.registerSerializers(kryo)\r\n  }\r\n}\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204690039/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204766647","html_url":"https://github.com/apache/iceberg/issues/5387#issuecomment-1204766647","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5387","id":1204766647,"node_id":"IC_kwDOCW7NX85Hz0e3","user":{"login":"singhpk234","id":35593236,"node_id":"MDQ6VXNlcjM1NTkzMjM2","avatar_url":"https://avatars.githubusercontent.com/u/35593236?v=4","gravatar_id":"","url":"https://api.github.com/users/singhpk234","html_url":"https://github.com/singhpk234","followers_url":"https://api.github.com/users/singhpk234/followers","following_url":"https://api.github.com/users/singhpk234/following{/other_user}","gists_url":"https://api.github.com/users/singhpk234/gists{/gist_id}","starred_url":"https://api.github.com/users/singhpk234/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/singhpk234/subscriptions","organizations_url":"https://api.github.com/users/singhpk234/orgs","repos_url":"https://api.github.com/users/singhpk234/repos","events_url":"https://api.github.com/users/singhpk234/events{/privacy}","received_events_url":"https://api.github.com/users/singhpk234/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-04T05:10:13Z","updated_at":"2022-08-04T05:10:13Z","author_association":"CONTRIBUTOR","body":"fixed via :\r\n- https://github.com/apache/iceberg/pull/5366\r\n\r\ncc @nastra ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204766647/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204787368","html_url":"https://github.com/apache/iceberg/pull/5392#issuecomment-1204787368","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5392","id":1204787368,"node_id":"IC_kwDOCW7NX85Hz5io","user":{"login":"manuzhang","id":1191767,"node_id":"MDQ6VXNlcjExOTE3Njc=","avatar_url":"https://avatars.githubusercontent.com/u/1191767?v=4","gravatar_id":"","url":"https://api.github.com/users/manuzhang","html_url":"https://github.com/manuzhang","followers_url":"https://api.github.com/users/manuzhang/followers","following_url":"https://api.github.com/users/manuzhang/following{/other_user}","gists_url":"https://api.github.com/users/manuzhang/gists{/gist_id}","starred_url":"https://api.github.com/users/manuzhang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/manuzhang/subscriptions","organizations_url":"https://api.github.com/users/manuzhang/orgs","repos_url":"https://api.github.com/users/manuzhang/repos","events_url":"https://api.github.com/users/manuzhang/events{/privacy}","received_events_url":"https://api.github.com/users/manuzhang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-04T05:44:07Z","updated_at":"2022-08-04T05:44:07Z","author_association":"COLLABORATOR","body":"@rdblue Any more concerns or suggestions for this PR?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204787368/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204790712","html_url":"https://github.com/apache/iceberg/issues/5387#issuecomment-1204790712","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5387","id":1204790712,"node_id":"IC_kwDOCW7NX85Hz6W4","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-04T05:50:05Z","updated_at":"2022-08-04T05:50:05Z","author_association":"CONTRIBUTOR","body":"thanks for fixing this @singhpk234 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204790712/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204812269","html_url":"https://github.com/apache/iceberg/issues/5414#issuecomment-1204812269","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5414","id":1204812269,"node_id":"IC_kwDOCW7NX85Hz_nt","user":{"login":"singhpk234","id":35593236,"node_id":"MDQ6VXNlcjM1NTkzMjM2","avatar_url":"https://avatars.githubusercontent.com/u/35593236?v=4","gravatar_id":"","url":"https://api.github.com/users/singhpk234","html_url":"https://github.com/singhpk234","followers_url":"https://api.github.com/users/singhpk234/followers","following_url":"https://api.github.com/users/singhpk234/following{/other_user}","gists_url":"https://api.github.com/users/singhpk234/gists{/gist_id}","starred_url":"https://api.github.com/users/singhpk234/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/singhpk234/subscriptions","organizations_url":"https://api.github.com/users/singhpk234/orgs","repos_url":"https://api.github.com/users/singhpk234/repos","events_url":"https://api.github.com/users/singhpk234/events{/privacy}","received_events_url":"https://api.github.com/users/singhpk234/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-04T06:21:26Z","updated_at":"2022-08-04T06:21:26Z","author_association":"CONTRIBUTOR","body":"I see now, why this would not work basically in iceberg we have relocated guava, from `com.google.common.collect.ImmutableMap` to `org.apache.iceberg.relocated.com.google.common.collect.ImmutableMap`\r\n\r\nthe serializer for guava in https://github.com/magro/kryo-serializers, won't work now as they are trying to make obj of `com.google.common.collect.ImmutableMap` during deserialization ref [CP](https://github.com/magro/kryo-serializers/blob/master/src/main/java/de/javakaffee/kryoserializers/guava/ImmutableMapSerializer.java#L7)\r\n\r\nI was able to make the test case above pass via writing a custom serializer which on deserialization creates `org.apache.iceberg.relocated.com.google.common.collect.ImmutableMap` in KryoHelper ... \r\n\r\n``` java\r\nimport com.google.common.collect.Maps;\r\nimport org.apache.iceberg.relocated.com.google.common.collect.ImmutableMap;\r\n\r\n    Kryo kryo = new KryoSerializer(new SparkConf()).newKryo();\r\n\r\n    kryo.register(java.util.HashMap.class);\r\n    final ImmutableRelocatedMapSerializer serializer = new ImmutableRelocatedMapSerializer();\r\n    kryo.register(obj.getClass(), serializer);\r\n\r\n  public static class ImmutableRelocatedMapSerializer extends\r\n      Serializer<ImmutableMap> {\r\n\r\n    private static final boolean DOES_NOT_ACCEPT_NULL = true;\r\n    private static final boolean IMMUTABLE = true;\r\n\r\n    public ImmutableRelocatedMapSerializer() {\r\n      super(DOES_NOT_ACCEPT_NULL, IMMUTABLE);\r\n    }\r\n\r\n    @Override\r\n    public void write(Kryo kryo, Output output, ImmutableMap object) {\r\n      kryo.writeObject(output, Maps.newHashMap(object));\r\n    }\r\n\r\n    @Override\r\n    public ImmutableMap read(Kryo kryo, Input input, Class<ImmutableMap> type) {\r\n      Map map = kryo.readObject(input, HashMap.class);\r\n      return ImmutableMap.copyOf(map);\r\n    }\r\n  }\r\n```\r\n\r\nso in this case you might wanna do something like this here, to achieve kryo serialization .. \r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204812269/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204817971","html_url":"https://github.com/apache/iceberg/issues/5414#issuecomment-1204817971","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5414","id":1204817971,"node_id":"IC_kwDOCW7NX85H0BAz","user":{"login":"singhpk234","id":35593236,"node_id":"MDQ6VXNlcjM1NTkzMjM2","avatar_url":"https://avatars.githubusercontent.com/u/35593236?v=4","gravatar_id":"","url":"https://api.github.com/users/singhpk234","html_url":"https://github.com/singhpk234","followers_url":"https://api.github.com/users/singhpk234/followers","following_url":"https://api.github.com/users/singhpk234/following{/other_user}","gists_url":"https://api.github.com/users/singhpk234/gists{/gist_id}","starred_url":"https://api.github.com/users/singhpk234/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/singhpk234/subscriptions","organizations_url":"https://api.github.com/users/singhpk234/orgs","repos_url":"https://api.github.com/users/singhpk234/repos","events_url":"https://api.github.com/users/singhpk234/events{/privacy}","received_events_url":"https://api.github.com/users/singhpk234/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-04T06:28:19Z","updated_at":"2022-08-04T06:28:19Z","author_association":"CONTRIBUTOR","body":"We have faced similar issues before, for ex : https://github.com/apache/iceberg/pull/549/files\r\n\r\nI think the  fix was to use to use java collection instead https://github.com/apache/iceberg/pull/546, which needs to be made at iceberg end. \r\n\r\nwill try attempting a fix for it. \r\n\r\ncc @rdblue @kbendick @jzhuge ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204817971/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204837665","html_url":"https://github.com/apache/iceberg/pull/2096#issuecomment-1204837665","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2096","id":1204837665,"node_id":"IC_kwDOCW7NX85H0F0h","user":{"login":"lintingbin","id":5699014,"node_id":"MDQ6VXNlcjU2OTkwMTQ=","avatar_url":"https://avatars.githubusercontent.com/u/5699014?v=4","gravatar_id":"","url":"https://api.github.com/users/lintingbin","html_url":"https://github.com/lintingbin","followers_url":"https://api.github.com/users/lintingbin/followers","following_url":"https://api.github.com/users/lintingbin/following{/other_user}","gists_url":"https://api.github.com/users/lintingbin/gists{/gist_id}","starred_url":"https://api.github.com/users/lintingbin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lintingbin/subscriptions","organizations_url":"https://api.github.com/users/lintingbin/orgs","repos_url":"https://api.github.com/users/lintingbin/repos","events_url":"https://api.github.com/users/lintingbin/events{/privacy}","received_events_url":"https://api.github.com/users/lintingbin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-04T06:50:23Z","updated_at":"2022-08-04T06:50:23Z","author_association":"CONTRIBUTOR","body":"@yyanyy @rdblue Whether you have considered cleaning up the schemas field, the schema that is not referenced by any snapshot will also be saved forever. It will cause the problem that the metadata file is too large. https://github.com/apache/iceberg/issues/5219","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204837665/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204851431","html_url":"https://github.com/apache/iceberg/pull/5312#issuecomment-1204851431","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5312","id":1204851431,"node_id":"IC_kwDOCW7NX85H0JLn","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-04T07:06:18Z","updated_at":"2022-08-04T07:06:18Z","author_association":"CONTRIBUTOR","body":"> I suggest the following order:\r\n> \r\n> 1. Squash all commits (if you're going to do this, might as well do it first).\r\n> 2. Rebase against master at commit before [99b41eb](https://github.com/apache/iceberg/commit/99b41eb9fbae1eb6c0501ce1fd1c9008893583b4) (otherwise build will fail due to spotless being enforced) -- I normally build after the rebase to make sure the rebase is correct.\r\n> 3. Rebase against HEAD of master.\r\n> 4. Run `./gradlew spotlessApply`. I would build after that.\r\n> \r\n> If we are going to rebase against master twice, before the spotlessApply (\"Big Bang\") and then to HEAD, in the first rebase, the code base has not yet been updated to the new style, so running `./gradlew spotlessApply` after this rebase means you're going to change a ton of files (correct me if I'm wrong, but `./gradlew spotlessApply` would apply to everything, right?). Why do this when you're going to rebase again on HEAD where the \"Big Bang\" has happened? I'd think you want to run `./gradlew spotlessApply` at a point where it'd at most modify the files that are added/modified in your change.\r\n\r\nThe idea with squashing is to include all the changes from running `./gradlew spotlessApply` locally, so yes, this will change a ton of unrelated files, including the ones that are being modified for a PR. If you add those formatting changes into your commit and then do a rebase against latest `master`, then the only diff that should be left is the actual files that have been modified for that particular PR. \r\nThis should minimize the amount of merge conflicts to an absolute minimum.\r\n\r\nOn the other hand, if you rebase changes (that are formatted with the old style) against latest `master` before locally applying `./gradlew spotlessApply`, then you'll certainly will have more conflicts (consisting of style + code changes).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204851431/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204890915","html_url":"https://github.com/apache/iceberg/pull/5036#issuecomment-1204890915","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5036","id":1204890915,"node_id":"IC_kwDOCW7NX85H0S0j","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-04T07:46:47Z","updated_at":"2022-08-04T07:46:47Z","author_association":"CONTRIBUTOR","body":"Thanks @SinghAsDev for the PR and @szehon-ho for the review!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204890915/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204998527","html_url":"https://github.com/apache/iceberg/pull/5281#issuecomment-1204998527","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5281","id":1204998527,"node_id":"IC_kwDOCW7NX85H0tF_","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-04T09:26:11Z","updated_at":"2022-08-08T07:51:46Z","author_association":"CONTRIBUTOR","body":"`\r\nALTER TABLE table DROP  TAG reference\r\n`\r\n\r\nHow about add ` IF EXIST` key?\r\n\r\n`\r\nALTER TABLE table DROP TAG {IF EXISTS} reference\r\n`\r\n\r\n@amogh-jahagirdar ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1204998527/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1205003013","html_url":"https://github.com/apache/iceberg/pull/5435#issuecomment-1205003013","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5435","id":1205003013,"node_id":"IC_kwDOCW7NX85H0uMF","user":{"login":"ConeyLiu","id":12733256,"node_id":"MDQ6VXNlcjEyNzMzMjU2","avatar_url":"https://avatars.githubusercontent.com/u/12733256?v=4","gravatar_id":"","url":"https://api.github.com/users/ConeyLiu","html_url":"https://github.com/ConeyLiu","followers_url":"https://api.github.com/users/ConeyLiu/followers","following_url":"https://api.github.com/users/ConeyLiu/following{/other_user}","gists_url":"https://api.github.com/users/ConeyLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/ConeyLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ConeyLiu/subscriptions","organizations_url":"https://api.github.com/users/ConeyLiu/orgs","repos_url":"https://api.github.com/users/ConeyLiu/repos","events_url":"https://api.github.com/users/ConeyLiu/events{/privacy}","received_events_url":"https://api.github.com/users/ConeyLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-04T09:30:16Z","updated_at":"2022-08-04T09:30:16Z","author_association":"CONTRIBUTOR","body":"Hi, @huaxingao @rdblue @kbendick . Could you help to review this when you are free? Thanks a lot.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1205003013/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1205104504","html_url":"https://github.com/apache/iceberg/pull/5405#issuecomment-1205104504","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5405","id":1205104504,"node_id":"IC_kwDOCW7NX85H1G94","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-04T11:03:30Z","updated_at":"2022-08-04T11:03:30Z","author_association":"CONTRIBUTOR","body":"Thanks @Fokko for the fix and Ryan for the review!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1205104504/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1205217146","html_url":"https://github.com/apache/iceberg/issues/5414#issuecomment-1205217146","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5414","id":1205217146,"node_id":"IC_kwDOCW7NX85H1id6","user":{"login":"jessiedanwang","id":25239320,"node_id":"MDQ6VXNlcjI1MjM5MzIw","avatar_url":"https://avatars.githubusercontent.com/u/25239320?v=4","gravatar_id":"","url":"https://api.github.com/users/jessiedanwang","html_url":"https://github.com/jessiedanwang","followers_url":"https://api.github.com/users/jessiedanwang/followers","following_url":"https://api.github.com/users/jessiedanwang/following{/other_user}","gists_url":"https://api.github.com/users/jessiedanwang/gists{/gist_id}","starred_url":"https://api.github.com/users/jessiedanwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jessiedanwang/subscriptions","organizations_url":"https://api.github.com/users/jessiedanwang/orgs","repos_url":"https://api.github.com/users/jessiedanwang/repos","events_url":"https://api.github.com/users/jessiedanwang/events{/privacy}","received_events_url":"https://api.github.com/users/jessiedanwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-04T12:53:52Z","updated_at":"2022-08-04T12:53:52Z","author_association":"NONE","body":"thanks for looking into this, do i have to wait for the fix at iceberg end? Or i can create a custom serializer for org.apache.iceberg.relocated.com.google.common.collect.ImmutableMap using the code you provided above? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1205217146/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1205241012","html_url":"https://github.com/apache/iceberg/pull/5284#issuecomment-1205241012","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5284","id":1205241012,"node_id":"IC_kwDOCW7NX85H1oS0","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-04T13:14:36Z","updated_at":"2022-08-04T13:14:36Z","author_association":"MEMBER","body":"Somehow this problem disappeared.\r\nIceberg 0.14.0 spark3.2 and spark3.3 doesn't have this issue anymore.\r\n\r\nOnly spark 3.1 has an issue.\r\n\r\nI still need to figure out which PR fixed this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1205241012/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1205446523","html_url":"https://github.com/apache/iceberg/issues/5414#issuecomment-1205446523","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5414","id":1205446523,"node_id":"IC_kwDOCW7NX85H2ad7","user":{"login":"singhpk234","id":35593236,"node_id":"MDQ6VXNlcjM1NTkzMjM2","avatar_url":"https://avatars.githubusercontent.com/u/35593236?v=4","gravatar_id":"","url":"https://api.github.com/users/singhpk234","html_url":"https://github.com/singhpk234","followers_url":"https://api.github.com/users/singhpk234/followers","following_url":"https://api.github.com/users/singhpk234/following{/other_user}","gists_url":"https://api.github.com/users/singhpk234/gists{/gist_id}","starred_url":"https://api.github.com/users/singhpk234/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/singhpk234/subscriptions","organizations_url":"https://api.github.com/users/singhpk234/orgs","repos_url":"https://api.github.com/users/singhpk234/repos","events_url":"https://api.github.com/users/singhpk234/events{/privacy}","received_events_url":"https://api.github.com/users/singhpk234/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-04T15:57:19Z","updated_at":"2022-08-04T15:57:19Z","author_association":"CONTRIBUTOR","body":"> i can create a custom serializer for org.apache.iceberg.relocated.com.google.common.collect.ImmutableMap using the code you provided above\r\n\r\nI think attempting custom serializer as temp workaround  should be fair, iceberg has point releases as well, please keep an eye for 0.14.1, there are also snapshots for present master published in maven as well (not a recommended approach) once this is in.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1205446523/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1205506576","html_url":"https://github.com/apache/iceberg/pull/5436#issuecomment-1205506576","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5436","id":1205506576,"node_id":"IC_kwDOCW7NX85H2pIQ","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-04T16:39:42Z","updated_at":"2022-08-04T16:39:42Z","author_association":"CONTRIBUTOR","body":"I don't think that we want to do this. We discussed this when introducing the FIleIO API, but `__enter__` and `__exit__` don't fit well. Looks like you hit some of the problems:\r\n* This introduces `FileAlreadyOpenError` because `InputFile` can be used for only one stream at a time\r\n* The overwrite option needs to be added to `OutputFile` even though that's an option for the writer to decide, not `FileIO`\r\n\r\nI'm all for adding `__enter__` and `__exit__` support though. What about adding it for `InputStream` and `OutputStream`? We could have `__exit__` call `close`. Then usage would look like this:\r\n\r\n```python\r\nfile = io.newInputFile(\"s3://bucket/path.parquet\")\r\nwith file.create(overwrite=True) as f:\r\n    f.write(...)\r\n\r\nwith file.toInputFile().open() as f:\r\n    f.read(...)\r\n```\r\n\r\nI also think that the `close` method should still exist. We just want to make `__exit__` call that method.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1205506576/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1205519772","html_url":"https://github.com/apache/iceberg/pull/4926#issuecomment-1205519772","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4926","id":1205519772,"node_id":"IC_kwDOCW7NX85H2sWc","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-04T16:52:04Z","updated_at":"2022-08-04T16:52:04Z","author_association":"CONTRIBUTOR","body":"Thanks for the review on the PR @namrathamyske.  @rdblue could we get a review on the updated PR when you get a chance?  Thanks! ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1205519772/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1205525395","html_url":"https://github.com/apache/iceberg/pull/4588#issuecomment-1205525395","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4588","id":1205525395,"node_id":"IC_kwDOCW7NX85H2tuT","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-04T16:57:47Z","updated_at":"2022-08-04T17:01:29Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer @flyrain I have rebased on master. @flyrain I have fixed the bug you pointed out; thank you for pointing it out. (As a result of fixing the bug, it became unnecessary to change `PositionDeleteIndex`.)\r\nPlease review this again. I kept the changes in Spark 3.2, since I was rebasing. I can port the changes to Spark 3.3 in this same PR (and am inclined to do so), if the changes look good to you.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1205525395/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1205529731","html_url":"https://github.com/apache/iceberg/pull/5284#issuecomment-1205529731","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5284","id":1205529731,"node_id":"IC_kwDOCW7NX85H2uyD","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-04T17:02:11Z","updated_at":"2022-08-04T17:03:06Z","author_association":"MEMBER","body":"Found it. \r\nFixed by https://github.com/apache/iceberg/pull/5247 by not using SparkCatalog for the rewriteDataFIles, which was using SQLConf instead of SessionConf for building the IcebergCatalog. \r\n\r\nAnd this change only present in spark-3.3 and 3.2. Hence, spark-3.0 still has issues for Nessie.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1205529731/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1205533975","html_url":"https://github.com/apache/iceberg/pull/5436#issuecomment-1205533975","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5436","id":1205533975,"node_id":"IC_kwDOCW7NX85H2v0X","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-04T17:06:29Z","updated_at":"2022-08-04T17:22:22Z","author_association":"CONTRIBUTOR","body":"@rdblue I also thought about that, but the `{Input,Output}Stream` is part of PyArrow, so that's not something that we control. We could add it to the protocol, but then we require the libraries to implement it (I think most of them do actually, pyarrow does). I can keep the original `open` and `close` in place, and add the`__enter__` and `__exit__` for convenience (but then we still need to split).\r\n\r\nUpdate: S3FS also has the `__enter__` and `__exit__`, so I think we can add them to the protocol 👍🏻 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1205533975/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1205547639","html_url":"https://github.com/apache/iceberg/pull/5436#issuecomment-1205547639","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5436","id":1205547639,"node_id":"IC_kwDOCW7NX85H2zJ3","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-04T17:18:44Z","updated_at":"2022-08-04T17:18:44Z","author_association":"CONTRIBUTOR","body":"I don't think that we should add `__enter__` and `__exit__` to `InputFile` or `OutputFile` because of the inability to use them as factories as intended.\r\n\r\nCan we get around the implementations not supporting `__enter__` and `__exit__` by adding them using `object.__setattr__` when we create them?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1205547639/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1205552368","html_url":"https://github.com/apache/iceberg/issues/5414#issuecomment-1205552368","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5414","id":1205552368,"node_id":"IC_kwDOCW7NX85H20Tw","user":{"login":"jessiedanwang","id":25239320,"node_id":"MDQ6VXNlcjI1MjM5MzIw","avatar_url":"https://avatars.githubusercontent.com/u/25239320?v=4","gravatar_id":"","url":"https://api.github.com/users/jessiedanwang","html_url":"https://github.com/jessiedanwang","followers_url":"https://api.github.com/users/jessiedanwang/followers","following_url":"https://api.github.com/users/jessiedanwang/following{/other_user}","gists_url":"https://api.github.com/users/jessiedanwang/gists{/gist_id}","starred_url":"https://api.github.com/users/jessiedanwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jessiedanwang/subscriptions","organizations_url":"https://api.github.com/users/jessiedanwang/orgs","repos_url":"https://api.github.com/users/jessiedanwang/repos","events_url":"https://api.github.com/users/jessiedanwang/events{/privacy}","received_events_url":"https://api.github.com/users/jessiedanwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-04T17:23:10Z","updated_at":"2022-08-04T17:23:10Z","author_association":"NONE","body":"thanks a lot, will keep an eye for 0.14.1. In the meantime, i am trying to create custom serializer as follows, but got compilation error for newHashMap, looks like it does not work with relocated immutableMap?\r\n\r\noverloaded method value newHashMap with alternatives:\r\n  [K, V](x$1: java.util.Map[_ <: K, _ <: V])java.util.HashMap[K,V] <and>\r\n  [K, V]()java.util.HashMap[K,V]\r\n cannot be applied to (org.apache.iceberg.relocated.com.google.common.collect.ImmutableMap[Any,Any])\r\n\r\nimport com.esotericsoftware.kryo.Kryo\r\nimport com.esotericsoftware.kryo.Serializer\r\nimport com.esotericsoftware.kryo.io.Input\r\nimport com.esotericsoftware.kryo.io.Output\r\nimport com.google.common.collect.Maps\r\nimport org.apache.iceberg.relocated.com.google.common.collect.ImmutableMap\r\n\r\nclass ImmutableMapSerializer(acceptNull: Boolean = true, immutable: Boolean = true) extends Serializer[ImmutableMap[Any,Any]](acceptNull, immutable) {\r\n\r\n  override def write (kryo: Kryo, output: Output, map: ImmutableMap[Any,Any]): Unit = {\r\n    kryo.writeObject(output, Maps.newHashMap(map) )\r\n  }\r\n\r\n  override def read (kryo: Kryo, input: Input, dataype: Class[ImmutableMap[Any,Any]]): ImmutableMap[Any,Any] = {\r\n    val map: java.util.Map[Any,Any] = kryo.readObject (input, classOf[java.util.HashMap[Any,Any]] )\r\n    return ImmutableMap.copyOf(map)\r\n  }\r\n}\r\n\r\nand also,\r\n\r\nclass CustomKryoRegistrator extends KryoRegistrator {\r\n  override def registerClasses(kryo: Kryo): Unit = {\r\n    val serializer = new ImmutableMapSerializer()\r\n    kryo.register(classOf[java.util.HashMap[Any,Any]])\r\n    kryo.register(classOf[ImmutableMap[Any,Any]], serializer)\r\n    kryo.register(Class.forName(\"org.apache.iceberg.relocated.com.google.common.collect.ImmutableMap\"), serializer)\r\n  }\r\n}","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1205552368/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1205555838","html_url":"https://github.com/apache/iceberg/pull/5436#issuecomment-1205555838","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5436","id":1205555838,"node_id":"IC_kwDOCW7NX85H21J-","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-04T17:26:34Z","updated_at":"2022-08-04T17:26:34Z","author_association":"CONTRIBUTOR","body":"Let me take a stab at adding them to the streams, I think that will work quite well 👍🏻 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1205555838/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1205608572","html_url":"https://github.com/apache/iceberg/pull/5436#issuecomment-1205608572","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5436","id":1205608572,"node_id":"IC_kwDOCW7NX85H3CB8","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-04T18:16:28Z","updated_at":"2022-08-04T18:16:28Z","author_association":"CONTRIBUTOR","body":"@rdblue Looks much cleaner, I'm confident that this also will work with future FileIO implementations.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1205608572/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1205785008","html_url":"https://github.com/apache/iceberg/pull/5441#issuecomment-1205785008","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5441","id":1205785008,"node_id":"IC_kwDOCW7NX85H3tGw","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-04T21:25:40Z","updated_at":"2022-08-04T21:25:40Z","author_association":"MEMBER","body":"Thanks for breaking this up. It should make it easier for folks cherry-picking in the future!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1205785008/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1205787084","html_url":"https://github.com/apache/iceberg/pull/5409#issuecomment-1205787084","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5409","id":1205787084,"node_id":"IC_kwDOCW7NX85H3tnM","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-04T21:28:15Z","updated_at":"2022-08-04T21:28:15Z","author_association":"MEMBER","body":"Closed as this is split into #5440 and #5441 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1205787084/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1205787995","html_url":"https://github.com/apache/iceberg/pull/5440#issuecomment-1205787995","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5440","id":1205787995,"node_id":"IC_kwDOCW7NX85H3t1b","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-04T21:29:24Z","updated_at":"2022-08-04T21:29:24Z","author_association":"MEMBER","body":"Reviewed in #5409","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1205787995/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1205795565","html_url":"https://github.com/apache/iceberg/pull/5441#issuecomment-1205795565","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5441","id":1205795565,"node_id":"IC_kwDOCW7NX85H3vrt","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-04T21:38:54Z","updated_at":"2022-08-04T21:38:54Z","author_association":"MEMBER","body":"Reviewed in #5409 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1205795565/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1205832653","html_url":"https://github.com/apache/iceberg/pull/4428#issuecomment-1205832653","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4428","id":1205832653,"node_id":"IC_kwDOCW7NX85H34vN","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-04T22:30:24Z","updated_at":"2022-08-04T22:30:24Z","author_association":"CONTRIBUTOR","body":"Looks like we have a consensus for this, @amogh-jahagirdar could you do a rebase to make sure spotless check passes?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1205832653/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1205901213","html_url":"https://github.com/apache/iceberg/issues/4012#issuecomment-1205901213","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4012","id":1205901213,"node_id":"IC_kwDOCW7NX85H4Jed","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2022-08-05T00:14:15Z","updated_at":"2022-08-05T00:14:15Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1205901213/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1205901289","html_url":"https://github.com/apache/iceberg/issues/3909#issuecomment-1205901289","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3909","id":1205901289,"node_id":"IC_kwDOCW7NX85H4Jfp","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2022-08-05T00:14:21Z","updated_at":"2022-08-05T00:14:21Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1205901289/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1205957334","html_url":"https://github.com/apache/iceberg/pull/5313#issuecomment-1205957334","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5313","id":1205957334,"node_id":"IC_kwDOCW7NX85H4XLW","user":{"login":"a49a","id":12015546,"node_id":"MDQ6VXNlcjEyMDE1NTQ2","avatar_url":"https://avatars.githubusercontent.com/u/12015546?v=4","gravatar_id":"","url":"https://api.github.com/users/a49a","html_url":"https://github.com/a49a","followers_url":"https://api.github.com/users/a49a/followers","following_url":"https://api.github.com/users/a49a/following{/other_user}","gists_url":"https://api.github.com/users/a49a/gists{/gist_id}","starred_url":"https://api.github.com/users/a49a/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/a49a/subscriptions","organizations_url":"https://api.github.com/users/a49a/orgs","repos_url":"https://api.github.com/users/a49a/repos","events_url":"https://api.github.com/users/a49a/events{/privacy}","received_events_url":"https://api.github.com/users/a49a/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-05T02:03:08Z","updated_at":"2022-08-05T02:03:08Z","author_association":"CONTRIBUTOR","body":"cc @rdblue @RussellSpitzer @huaxingao @kbendick  Please review it, thanks a lot.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1205957334/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1205981155","html_url":"https://github.com/apache/iceberg/issues/5414#issuecomment-1205981155","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5414","id":1205981155,"node_id":"IC_kwDOCW7NX85H4c_j","user":{"login":"jessiedanwang","id":25239320,"node_id":"MDQ6VXNlcjI1MjM5MzIw","avatar_url":"https://avatars.githubusercontent.com/u/25239320?v=4","gravatar_id":"","url":"https://api.github.com/users/jessiedanwang","html_url":"https://github.com/jessiedanwang","followers_url":"https://api.github.com/users/jessiedanwang/followers","following_url":"https://api.github.com/users/jessiedanwang/following{/other_user}","gists_url":"https://api.github.com/users/jessiedanwang/gists{/gist_id}","starred_url":"https://api.github.com/users/jessiedanwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jessiedanwang/subscriptions","organizations_url":"https://api.github.com/users/jessiedanwang/orgs","repos_url":"https://api.github.com/users/jessiedanwang/repos","events_url":"https://api.github.com/users/jessiedanwang/events{/privacy}","received_events_url":"https://api.github.com/users/jessiedanwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-05T02:44:22Z","updated_at":"2022-08-05T02:44:22Z","author_association":"NONE","body":"where is the source for org.apache.iceberg.relocated.com.google.common.collect.ImmutableMap? Can not seem to find it in the apache iceberg repo?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1205981155/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1206001615","html_url":"https://github.com/apache/iceberg/pull/3990#issuecomment-1206001615","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3990","id":1206001615,"node_id":"IC_kwDOCW7NX85H4h_P","user":{"login":"peterxiong13","id":40230517,"node_id":"MDQ6VXNlcjQwMjMwNTE3","avatar_url":"https://avatars.githubusercontent.com/u/40230517?v=4","gravatar_id":"","url":"https://api.github.com/users/peterxiong13","html_url":"https://github.com/peterxiong13","followers_url":"https://api.github.com/users/peterxiong13/followers","following_url":"https://api.github.com/users/peterxiong13/following{/other_user}","gists_url":"https://api.github.com/users/peterxiong13/gists{/gist_id}","starred_url":"https://api.github.com/users/peterxiong13/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/peterxiong13/subscriptions","organizations_url":"https://api.github.com/users/peterxiong13/orgs","repos_url":"https://api.github.com/users/peterxiong13/repos","events_url":"https://api.github.com/users/peterxiong13/events{/privacy}","received_events_url":"https://api.github.com/users/peterxiong13/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-05T03:25:49Z","updated_at":"2022-08-05T03:25:49Z","author_association":"NONE","body":"@coolderli，\r\nI used the source code of 0.13.1 to modify, compile and test it. It's basically no problem. However, in the test, I found that some partitions failed to completely clean up the deleted files. I looked at it. The reason is that the serial number of the data files is smaller than that of the deleted files. The merge is run every 2 hours, and it is not merged? Is there no need to merge because the primary key of the data file does not appear in the deleted file? When Flink writes data, it turns on the upsert mode. In this way, if only pure insert data will also generate delete delete files?\r\n\r\nIn addition, I also downloaded version 0.14.0, and found that this part of the modification is relatively large. The original modification seems to be inapplicable. Is there a PR to solve this problem?\r\n\r\n我用0.13.1的源码修改编译测了下，基本没问题。不过在测试中发现有部分分区出现删除文件没有完全清理掉的情况，我看了下，是因为有数据文件的序号比删除文件的小，合并是2小时跑一次，没有合并到？是否因为数据文件的主键没有出现在删除文件中，所以一直不需要合并？flink写数据过来的时候，开启了upsert模式，这样如果只是纯insert的数据也会产生delete的删除文件吗？\r\n另外我也下载了0.14.0版，发现这部分修改比较大，原修改好像不适用了，是否有解决此问题的pr？","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1206001615/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1206006989","html_url":"https://github.com/apache/iceberg/pull/3990#issuecomment-1206006989","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3990","id":1206006989,"node_id":"IC_kwDOCW7NX85H4jTN","user":{"login":"coolderli","id":38486782,"node_id":"MDQ6VXNlcjM4NDg2Nzgy","avatar_url":"https://avatars.githubusercontent.com/u/38486782?v=4","gravatar_id":"","url":"https://api.github.com/users/coolderli","html_url":"https://github.com/coolderli","followers_url":"https://api.github.com/users/coolderli/followers","following_url":"https://api.github.com/users/coolderli/following{/other_user}","gists_url":"https://api.github.com/users/coolderli/gists{/gist_id}","starred_url":"https://api.github.com/users/coolderli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coolderli/subscriptions","organizations_url":"https://api.github.com/users/coolderli/orgs","repos_url":"https://api.github.com/users/coolderli/repos","events_url":"https://api.github.com/users/coolderli/events{/privacy}","received_events_url":"https://api.github.com/users/coolderli/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-05T03:37:58Z","updated_at":"2022-08-05T03:38:27Z","author_association":"CONTRIBUTOR","body":"> @coolderli， I used the source code of 0.13.1 to modify, compile and test it. It's basically no problem. However, in the test, I found that some partitions failed to completely clean up the deleted files. I looked at it. The reason is that the serial number of the data files is smaller than that of the deleted files. The merge is run every 2 hours, and it is not merged? Is there no need to merge because the primary key of the data file does not appear in the deleted file? When Flink writes data, it turns on the upsert mode. In this way, if only pure insert data will also generate delete delete files?\r\n> \r\n> In addition, I also downloaded version 0.14.0, and found that this part of the modification is relatively large. The original modification seems to be inapplicable. Is there a PR to solve this problem?\r\n> \r\n> 我用0.13.1的源码修改编译测了下，基本没问题。不过在测试中发现有部分分区出现删除文件没有完全清理掉的情况，我看了下，是因为有数据文件的序号比删除文件的小，合并是2小时跑一次，没有合并到？是否因为数据文件的主键没有出现在删除文件中，所以一直不需要合并？flink写数据过来的时候，开启了upsert模式，这样如果只是纯insert的数据也会产生delete的删除文件吗？ 另外我也下载了0.14.0版，发现这部分修改比较大，原修改好像不适用了，是否有解决此问题的pr？\r\n\r\n@peterxiong13  We have no pr for 0.14.0. The deleted file is not removed because there is the sequence number of some equality delete files that are identical to the data files. These deleted files will not be deleted when selecting the files that smaller than the min sequence number.\r\n\r\n我们暂时没有 0.14.0 的 pr。有些文件没有完全清除掉是有一部分 equality delete file 的 sequence number 和 min sequence number相同。这部分文件在选择 小于 min sequence number 的 文件时没有被删掉。","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1206006989/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1206011582","html_url":"https://github.com/apache/iceberg/pull/5382#issuecomment-1206011582","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5382","id":1206011582,"node_id":"IC_kwDOCW7NX85H4ka-","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-05T03:49:00Z","updated_at":"2022-08-05T03:49:00Z","author_association":"CONTRIBUTOR","body":"Thanks for reviewing, @Reo-LEI @kbendick @stevenzwu @szehon-ho @flyrain!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1206011582/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1206020974","html_url":"https://github.com/apache/iceberg/pull/5382#issuecomment-1206020974","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5382","id":1206020974,"node_id":"IC_kwDOCW7NX85H4mtu","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-05T04:11:06Z","updated_at":"2022-08-05T04:11:06Z","author_association":"CONTRIBUTOR","body":"> Are we going to support the filter on the CDC type? For example, users are only interested in deleted rows.\r\n\r\nYeah, we can definitely add this in the future once a use case comes along.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1206020974/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1206080680","html_url":"https://github.com/apache/iceberg/pull/5439#issuecomment-1206080680","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5439","id":1206080680,"node_id":"IC_kwDOCW7NX85H41So","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-05T06:11:07Z","updated_at":"2022-08-05T06:54:15Z","author_association":"CONTRIBUTOR","body":"This is mostly for local testing (against my local file system), but I also think we'll need this in the case of HDFS. We could just stub them out for object stores. I agree that we should leave potential harmful methods such as `ls` out 👍🏻 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1206080680/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1206098431","html_url":"https://github.com/apache/iceberg/pull/3990#issuecomment-1206098431","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3990","id":1206098431,"node_id":"IC_kwDOCW7NX85H45n_","user":{"login":"peterxiong13","id":40230517,"node_id":"MDQ6VXNlcjQwMjMwNTE3","avatar_url":"https://avatars.githubusercontent.com/u/40230517?v=4","gravatar_id":"","url":"https://api.github.com/users/peterxiong13","html_url":"https://github.com/peterxiong13","followers_url":"https://api.github.com/users/peterxiong13/followers","following_url":"https://api.github.com/users/peterxiong13/following{/other_user}","gists_url":"https://api.github.com/users/peterxiong13/gists{/gist_id}","starred_url":"https://api.github.com/users/peterxiong13/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/peterxiong13/subscriptions","organizations_url":"https://api.github.com/users/peterxiong13/orgs","repos_url":"https://api.github.com/users/peterxiong13/repos","events_url":"https://api.github.com/users/peterxiong13/events{/privacy}","received_events_url":"https://api.github.com/users/peterxiong13/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-05T06:39:31Z","updated_at":"2022-08-05T06:39:31Z","author_association":"NONE","body":"> > @coolderli， I used the source code of 0.13.1 to modify, compile and test it. It's basically no problem. However, in the test, I found that some partitions failed to completely clean up the deleted files. I looked at it. The reason is that the serial number of the data files is smaller than that of the deleted files. The merge is run every 2 hours, and it is not merged? Is there no need to merge because the primary key of the data file does not appear in the deleted file? When Flink writes data, it turns on the upsert mode. In this way, if only pure insert data will also generate delete delete files?\r\n> > In addition, I also downloaded version 0.14.0, and found that this part of the modification is relatively large. The original modification seems to be inapplicable. Is there a PR to solve this problem?\r\n> > 我用0.13.1的源码修改编译测了下，基本没问题。不过在测试中发现有部分分区出现删除文件没有完全清理掉的情况，我看了下，是因为有数据文件的序号比删除文件的小，合并是2小时跑一次，没有合并到？是否因为数据文件的主键没有出现在删除文件中，所以一直不需要合并？flink写数据过来的时候，开启了upsert模式，这样如果只是纯insert的数据也会产生delete的删除文件吗？ 另外我也下载了0.14.0版，发现这部分修改比较大，原修改好像不适用了，是否有解决此问题的pr？\r\n> \r\n> @peterxiong13 We have no pr for 0.14.0. The deleted file is not removed because there is the sequence number of some equality delete files that are identical to the data files. These deleted files will not be deleted when selecting the files that smaller than the min sequence number.\r\n> \r\n> 我们暂时没有 0.14.0 的 pr。有些文件没有完全清除掉是有一部分 equality delete file 的 sequence number 和 min sequence number相同。这部分文件在选择 小于 min sequence number 的 文件时没有被删掉。\r\n\r\nThank you very much for your reply. Does the distribution need to meet the function of partition evolution by comparing the global serial number? However, the longer the comparison time according to the global sequence number, the more deleted files will be left, and the whole table must be rewritten before it can be cleaned up. We plan to use iceberg to save historical data for a long time, which is not appropriate. I hope the community can fix this problem as soon as possible and clear the obstacles for the development of iceberg\r\n\r\n非常感谢您的回复。发行版按照全局序号比较是否因为需要满足分区演进的功能呢？但按全局序号比较时间越长遗留的删除文件就会越多，必须整表重写才会清理掉。我们打算用iceberg保存长时间的历史数据，这样就不太合适了。希望社区能尽快修复此问题，为iceberg的发展扫清障碍","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1206098431/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1206641413","html_url":"https://github.com/apache/iceberg/pull/4428#issuecomment-1206641413","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4428","id":1206641413,"node_id":"IC_kwDOCW7NX85H6-MF","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-05T16:35:09Z","updated_at":"2022-08-05T16:35:09Z","author_association":"CONTRIBUTOR","body":"Thanks for the work! Given the conversation history I think @rdblue is also good with adding these APIs, and other people have all approved. Thanks for all the reviews!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1206641413/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1206672889","html_url":"https://github.com/apache/iceberg/pull/4588#issuecomment-1206672889","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4588","id":1206672889,"node_id":"IC_kwDOCW7NX85H7F35","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-05T17:13:46Z","updated_at":"2022-08-05T17:13:46Z","author_association":"CONTRIBUTOR","body":"I have ported the changes to Spark 3.3. The Spark 3.3 changes are identical to the Spark 3.2 changes (the affected files are identical at this point).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1206672889/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1206737909","html_url":"https://github.com/apache/iceberg/pull/5021#issuecomment-1206737909","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5021","id":1206737909,"node_id":"IC_kwDOCW7NX85H7Vv1","user":{"login":"findepi","id":144328,"node_id":"MDQ6VXNlcjE0NDMyOA==","avatar_url":"https://avatars.githubusercontent.com/u/144328?v=4","gravatar_id":"","url":"https://api.github.com/users/findepi","html_url":"https://github.com/findepi","followers_url":"https://api.github.com/users/findepi/followers","following_url":"https://api.github.com/users/findepi/following{/other_user}","gists_url":"https://api.github.com/users/findepi/gists{/gist_id}","starred_url":"https://api.github.com/users/findepi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/findepi/subscriptions","organizations_url":"https://api.github.com/users/findepi/orgs","repos_url":"https://api.github.com/users/findepi/repos","events_url":"https://api.github.com/users/findepi/events{/privacy}","received_events_url":"https://api.github.com/users/findepi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-05T18:29:34Z","updated_at":"2022-08-05T18:29:34Z","author_association":"MEMBER","body":"@rdblue thank you for a careful review. Comments applied, the code is much better now.\r\nThe potentially immature changes to TableMetadata are moved to https://github.com/apache/iceberg/pull/5450\r\n\r\nCan you please take another look?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1206737909/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]