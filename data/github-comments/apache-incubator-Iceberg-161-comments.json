[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1092511176","html_url":"https://github.com/apache/iceberg/issues/4527#issuecomment-1092511176","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4527","id":1092511176,"node_id":"IC_kwDOCW7NX85BHmXI","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-08T07:05:18Z","updated_at":"2022-04-08T07:05:18Z","author_association":"MEMBER","body":"You choose the spark 3.2 iceberg jar but your are running Spark 3.1. Use the 3.1 jar. Also don't specify org.apache.spark Spark jars using packages since all of that will be on the classpath anyway","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1092511176/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1092515041","html_url":"https://github.com/apache/iceberg/issues/4527#issuecomment-1092515041","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4527","id":1092515041,"node_id":"IC_kwDOCW7NX85BHnTh","user":{"login":"vshinde-medacist","id":103242772,"node_id":"U_kgDOBidcFA","avatar_url":"https://avatars.githubusercontent.com/u/103242772?v=4","gravatar_id":"","url":"https://api.github.com/users/vshinde-medacist","html_url":"https://github.com/vshinde-medacist","followers_url":"https://api.github.com/users/vshinde-medacist/followers","following_url":"https://api.github.com/users/vshinde-medacist/following{/other_user}","gists_url":"https://api.github.com/users/vshinde-medacist/gists{/gist_id}","starred_url":"https://api.github.com/users/vshinde-medacist/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vshinde-medacist/subscriptions","organizations_url":"https://api.github.com/users/vshinde-medacist/orgs","repos_url":"https://api.github.com/users/vshinde-medacist/repos","events_url":"https://api.github.com/users/vshinde-medacist/events{/privacy}","received_events_url":"https://api.github.com/users/vshinde-medacist/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-08T07:08:20Z","updated_at":"2022-04-08T07:08:20Z","author_association":"NONE","body":"> Any pointer in the right direction for troubleshooting would be really helpful.\r\n\r\nThanks for the swift reply @RussellSpitzer, making suggested changes and testing this quickly, will get back to you.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1092515041/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1092534036","html_url":"https://github.com/apache/iceberg/issues/4527#issuecomment-1092534036","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4527","id":1092534036,"node_id":"IC_kwDOCW7NX85BHr8U","user":{"login":"vshinde-medacist","id":103242772,"node_id":"U_kgDOBidcFA","avatar_url":"https://avatars.githubusercontent.com/u/103242772?v=4","gravatar_id":"","url":"https://api.github.com/users/vshinde-medacist","html_url":"https://github.com/vshinde-medacist","followers_url":"https://api.github.com/users/vshinde-medacist/followers","following_url":"https://api.github.com/users/vshinde-medacist/following{/other_user}","gists_url":"https://api.github.com/users/vshinde-medacist/gists{/gist_id}","starred_url":"https://api.github.com/users/vshinde-medacist/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vshinde-medacist/subscriptions","organizations_url":"https://api.github.com/users/vshinde-medacist/orgs","repos_url":"https://api.github.com/users/vshinde-medacist/repos","events_url":"https://api.github.com/users/vshinde-medacist/events{/privacy}","received_events_url":"https://api.github.com/users/vshinde-medacist/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-08T07:21:17Z","updated_at":"2022-04-08T07:21:17Z","author_association":"NONE","body":"After using the correct dependency version, we are able to launch the Spark shell with Iceberg so closing the issue.\r\n```cmd\r\nspark-shell --packages org.apache.iceberg:iceberg-spark-runtime-3.1_2.12:0.13.1\r\n```\r\n\r\nThanks @RussellSpitzer, really appreciate this. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1092534036/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1092552050","html_url":"https://github.com/apache/iceberg/pull/4512#issuecomment-1092552050","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4512","id":1092552050,"node_id":"IC_kwDOCW7NX85BHwVy","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-08T07:42:44Z","updated_at":"2022-04-08T07:42:44Z","author_association":"CONTRIBUTOR","body":"I will push this change on Monday if nobody raises concerns till then.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1092552050/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1092561979","html_url":"https://github.com/apache/iceberg/pull/4463#issuecomment-1092561979","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4463","id":1092561979,"node_id":"IC_kwDOCW7NX85BHyw7","user":{"login":"polaris6","id":29967142,"node_id":"MDQ6VXNlcjI5OTY3MTQy","avatar_url":"https://avatars.githubusercontent.com/u/29967142?v=4","gravatar_id":"","url":"https://api.github.com/users/polaris6","html_url":"https://github.com/polaris6","followers_url":"https://api.github.com/users/polaris6/followers","following_url":"https://api.github.com/users/polaris6/following{/other_user}","gists_url":"https://api.github.com/users/polaris6/gists{/gist_id}","starred_url":"https://api.github.com/users/polaris6/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/polaris6/subscriptions","organizations_url":"https://api.github.com/users/polaris6/orgs","repos_url":"https://api.github.com/users/polaris6/repos","events_url":"https://api.github.com/users/polaris6/events{/privacy}","received_events_url":"https://api.github.com/users/polaris6/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-08T07:54:39Z","updated_at":"2022-04-16T02:33:22Z","author_association":"CONTRIBUTOR","body":"@openinx Hi openinx, excuse me, could you please help me to review this pr again? thank you very much!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1092561979/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1093064072","html_url":"https://github.com/apache/iceberg/pull/2372#issuecomment-1093064072","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2372","id":1093064072,"node_id":"IC_kwDOCW7NX85BJtWI","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-08T16:26:18Z","updated_at":"2022-04-08T16:26:18Z","author_association":"CONTRIBUTOR","body":"Yes, CDC needs to read the deleted row. As I mentioned in the mail list, one of options is to leverage `_isDeleted` column. I got a local implementation for parquet vectorized read. Will post it soon. Would appreciate your feedback, @chenjunjiedada ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1093064072/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1093082899","html_url":"https://github.com/apache/iceberg/pull/4456#issuecomment-1093082899","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4456","id":1093082899,"node_id":"IC_kwDOCW7NX85BJx8T","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-08T16:50:11Z","updated_at":"2022-04-08T16:50:11Z","author_association":"COLLABORATOR","body":"Merged, thanks @flyrain for the changes","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1093082899/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1093086966","html_url":"https://github.com/apache/iceberg/pull/3482#issuecomment-1093086966","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3482","id":1093086966,"node_id":"IC_kwDOCW7NX85BJy72","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-08T16:55:53Z","updated_at":"2022-04-08T16:55:53Z","author_association":"COLLABORATOR","body":"Merged, thanks @KnightChess for your patience and contribution","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1093086966/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1093122623","html_url":"https://github.com/apache/iceberg/pull/4456#issuecomment-1093122623","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4456","id":1093122623,"node_id":"IC_kwDOCW7NX85BJ7o_","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-08T17:36:20Z","updated_at":"2022-04-08T17:36:20Z","author_association":"CONTRIBUTOR","body":"Thanks @szehon-ho! Thanks all for the review, @singhpk234, @RussellSpitzer, @anuragmantri.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1093122623/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1093124935","html_url":"https://github.com/apache/iceberg/pull/4418#issuecomment-1093124935","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4418","id":1093124935,"node_id":"IC_kwDOCW7NX85BJ8NH","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-08T17:39:24Z","updated_at":"2022-04-08T17:39:24Z","author_association":"CONTRIBUTOR","body":"Closing in favor of https://github.com/apache/iceberg/pull/4519","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1093124935/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1093454915","html_url":"https://github.com/apache/iceberg/pull/4529#issuecomment-1093454915","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4529","id":1093454915,"node_id":"IC_kwDOCW7NX85BLMxD","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-08T23:07:06Z","updated_at":"2022-04-08T23:07:06Z","author_association":"CONTRIBUTOR","body":"@rdblue @openinx @yittg @kbendick please take a look when you get a chance","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1093454915/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1093531778","html_url":"https://github.com/apache/iceberg/pull/3482#issuecomment-1093531778","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3482","id":1093531778,"node_id":"IC_kwDOCW7NX85BLfiC","user":{"login":"KnightChess","id":20125927,"node_id":"MDQ6VXNlcjIwMTI1OTI3","avatar_url":"https://avatars.githubusercontent.com/u/20125927?v=4","gravatar_id":"","url":"https://api.github.com/users/KnightChess","html_url":"https://github.com/KnightChess","followers_url":"https://api.github.com/users/KnightChess/followers","following_url":"https://api.github.com/users/KnightChess/following{/other_user}","gists_url":"https://api.github.com/users/KnightChess/gists{/gist_id}","starred_url":"https://api.github.com/users/KnightChess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/KnightChess/subscriptions","organizations_url":"https://api.github.com/users/KnightChess/orgs","repos_url":"https://api.github.com/users/KnightChess/repos","events_url":"https://api.github.com/users/KnightChess/events{/privacy}","received_events_url":"https://api.github.com/users/KnightChess/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-09T00:45:22Z","updated_at":"2022-04-09T00:45:22Z","author_association":"CONTRIBUTOR","body":"thanks @szehon-ho @rdblue @jackye1995 @samredai a lot for instruct patiently ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1093531778/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1093587082","html_url":"https://github.com/apache/iceberg/pull/2372#issuecomment-1093587082","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2372","id":1093587082,"node_id":"IC_kwDOCW7NX85BLtCK","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-09T02:06:56Z","updated_at":"2022-04-09T02:06:56Z","author_association":"COLLABORATOR","body":"@flyrain Sounds great! Let me close this one as it is left behind too long.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1093587082/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1093732644","html_url":"https://github.com/apache/iceberg/issues/4457#issuecomment-1093732644","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4457","id":1093732644,"node_id":"IC_kwDOCW7NX85BMQkk","user":{"login":"yeshvantbhavnasi","id":20260478,"node_id":"MDQ6VXNlcjIwMjYwNDc4","avatar_url":"https://avatars.githubusercontent.com/u/20260478?v=4","gravatar_id":"","url":"https://api.github.com/users/yeshvantbhavnasi","html_url":"https://github.com/yeshvantbhavnasi","followers_url":"https://api.github.com/users/yeshvantbhavnasi/followers","following_url":"https://api.github.com/users/yeshvantbhavnasi/following{/other_user}","gists_url":"https://api.github.com/users/yeshvantbhavnasi/gists{/gist_id}","starred_url":"https://api.github.com/users/yeshvantbhavnasi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yeshvantbhavnasi/subscriptions","organizations_url":"https://api.github.com/users/yeshvantbhavnasi/orgs","repos_url":"https://api.github.com/users/yeshvantbhavnasi/repos","events_url":"https://api.github.com/users/yeshvantbhavnasi/events{/privacy}","received_events_url":"https://api.github.com/users/yeshvantbhavnasi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-09T06:17:51Z","updated_at":"2022-04-09T06:17:51Z","author_association":"NONE","body":"Problem was the number of partition on the dataframe was large, causing s3 read to fail. \r\n- Did a `df.repartition(df.rdd.numberOfPartition*10)` and it started working ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1093732644/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094088176","html_url":"https://github.com/apache/iceberg/pull/3482#issuecomment-1094088176","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3482","id":1094088176,"node_id":"IC_kwDOCW7NX85BNnXw","user":{"login":"samredai","id":43911210,"node_id":"MDQ6VXNlcjQzOTExMjEw","avatar_url":"https://avatars.githubusercontent.com/u/43911210?v=4","gravatar_id":"","url":"https://api.github.com/users/samredai","html_url":"https://github.com/samredai","followers_url":"https://api.github.com/users/samredai/followers","following_url":"https://api.github.com/users/samredai/following{/other_user}","gists_url":"https://api.github.com/users/samredai/gists{/gist_id}","starred_url":"https://api.github.com/users/samredai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samredai/subscriptions","organizations_url":"https://api.github.com/users/samredai/orgs","repos_url":"https://api.github.com/users/samredai/repos","events_url":"https://api.github.com/users/samredai/events{/privacy}","received_events_url":"https://api.github.com/users/samredai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-09T17:15:33Z","updated_at":"2022-04-09T17:15:33Z","author_association":"CONTRIBUTOR","body":"Thanks @KnightChess!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094088176/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094347534","html_url":"https://github.com/apache/iceberg/pull/4308#issuecomment-1094347534","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4308","id":1094347534,"node_id":"IC_kwDOCW7NX85BOmsO","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-10T18:51:57Z","updated_at":"2022-04-10T18:51:57Z","author_association":"CONTRIBUTOR","body":"@kunal0829, can you write up a doc that summarizes the proposed serialization formats?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094347534/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094355060","html_url":"https://github.com/apache/iceberg/pull/2577#issuecomment-1094355060","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2577","id":1094355060,"node_id":"IC_kwDOCW7NX85BOoh0","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-10T19:38:04Z","updated_at":"2022-04-10T19:38:04Z","author_association":"CONTRIBUTOR","body":"Since this hasn't been updated recently, I'm going to go ahead and close it. Feel free to reopen if you have the time to update it!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094355060/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094355297","html_url":"https://github.com/apache/iceberg/pull/2780#issuecomment-1094355297","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2780","id":1094355297,"node_id":"IC_kwDOCW7NX85BOolh","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-10T19:39:44Z","updated_at":"2022-04-10T19:39:44Z","author_association":"CONTRIBUTOR","body":"I'm going to close this since there hasn't been an update in a while. I'm also concerned that this leaks user data into logs, so we should probably look more into the notification for making this info available, rather than updating the description.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094355297/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094355409","html_url":"https://github.com/apache/iceberg/pull/3367#issuecomment-1094355409","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3367","id":1094355409,"node_id":"IC_kwDOCW7NX85BOonR","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-10T19:40:30Z","updated_at":"2022-04-10T19:40:30Z","author_association":"CONTRIBUTOR","body":"I'm going to close this since I think it's stale and has been replaced by #3579.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094355409/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094355584","html_url":"https://github.com/apache/iceberg/pull/3579#issuecomment-1094355584","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3579","id":1094355584,"node_id":"IC_kwDOCW7NX85BOoqA","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-10T19:41:27Z","updated_at":"2022-04-10T19:41:27Z","author_association":"CONTRIBUTOR","body":"Since this hasn't been moving for a while, I'm going to close it. I think the right way to do this is to register directly with Spark.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094355584/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094355813","html_url":"https://github.com/apache/iceberg/pull/3326#issuecomment-1094355813","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3326","id":1094355813,"node_id":"IC_kwDOCW7NX85BOotl","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-10T19:43:07Z","updated_at":"2022-04-10T19:43:07Z","author_association":"CONTRIBUTOR","body":"Looks like this is stale and most people don't see much value in it. I'm going to close it, but we can revisit the decision if anyone feels strongly that it should be done. Thanks for working on this, @harshm-dev.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094355813/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094359054","html_url":"https://github.com/apache/iceberg/pull/4468#issuecomment-1094359054","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4468","id":1094359054,"node_id":"IC_kwDOCW7NX85BOpgO","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-10T20:03:08Z","updated_at":"2022-04-10T20:03:08Z","author_association":"CONTRIBUTOR","body":"Thanks, @dramaticlly!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094359054/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094366382","html_url":"https://github.com/apache/iceberg/pull/4531#issuecomment-1094366382","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4531","id":1094366382,"node_id":"IC_kwDOCW7NX85BOrSu","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-10T20:50:20Z","updated_at":"2022-04-10T20:50:20Z","author_association":"CONTRIBUTOR","body":"Looks good to me! Just one checkstyle problem:\r\n\r\n```\r\n[ERROR] /home/runner/work/iceberg/iceberg/flink/v1.14/flink/src/test/java/org/apache/iceberg/flink/source/TestFlinkScanSql.java:192: Prefer using Lists.newArrayList() instead. [RegexpSingleline]\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094366382/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094366960","html_url":"https://github.com/apache/iceberg/pull/4530#issuecomment-1094366960","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4530","id":1094366960,"node_id":"IC_kwDOCW7NX85BOrbw","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-10T20:53:55Z","updated_at":"2022-04-10T20:53:55Z","author_association":"CONTRIBUTOR","body":"I agree with @singhpk234. Because delete files can affect more than one file and not all deletes in a file are for a given data file, this is not a good approach for correctly estimating the final row count. In addition, file size is used to scale the row count within a single file. Delete files could have a completely different compression ratio so this is going to be very unreliable.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094366960/reactions","total_count":3,"+1":2,"-1":0,"laugh":1,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094367704","html_url":"https://github.com/apache/iceberg/pull/4528#issuecomment-1094367704","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4528","id":1094367704,"node_id":"IC_kwDOCW7NX85BOrnY","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-10T20:56:10Z","updated_at":"2022-04-10T20:56:10Z","author_association":"CONTRIBUTOR","body":"@flashJd, could you coordinate with @stevenzwu? He has been working on Flink streaming reads and is a great person to discuss features like this with.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094367704/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094370049","html_url":"https://github.com/apache/iceberg/pull/4519#issuecomment-1094370049","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4519","id":1094370049,"node_id":"IC_kwDOCW7NX85BOsMB","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-10T21:10:14Z","updated_at":"2022-04-10T21:10:14Z","author_association":"CONTRIBUTOR","body":"@openinx, I think this is serious enough that we should not keep writing data in the 0.13.2 release if we can't fix it. Since we can't fix it in Flink 1.12, I think the right option is to disable it and ask the user to upgrade. If you want to fix it for the release, that would be great. But since we will probably remove support for 1.12 in the next release anyway, I don't think it makes much sense to spend time on it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094370049/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094370689","html_url":"https://github.com/apache/iceberg/pull/4518#issuecomment-1094370689","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4518","id":1094370689,"node_id":"IC_kwDOCW7NX85BOsWB","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-10T21:14:25Z","updated_at":"2022-04-10T21:14:25Z","author_association":"CONTRIBUTOR","body":"Switching to use more Guava classes is probably not a good idea.\r\n\r\n@rizaon, do you have use cases where this has helped? If so, what were they? This adds quite a bit of complexity and memory overhead that we purposely avoided up to now so I want to make sure it is worth the change.\r\n\r\nHave you considered adding a caching FileIO instance? That could be used for more use cases than just manifest files and job planning. For example, a FileIO read-through cache could cache delete files that might be reused for tasks. This could be configured by file path, making it easy to determine what to cache. Plus, we could use more options than just in-memory, like a distributed cache or local disk.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094370689/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094371542","html_url":"https://github.com/apache/iceberg/pull/4517#issuecomment-1094371542","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4517","id":1094371542,"node_id":"IC_kwDOCW7NX85BOsjW","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-10T21:17:58Z","updated_at":"2022-04-10T21:17:58Z","author_association":"CONTRIBUTOR","body":"@singhpk234, this is going to get the size of `latestSnapshot.addedFiles()` either way because it needs to calculate that value to pass it into the property check.\r\n\r\n@SreeramGarlapati makes a good point, but if the added files property is present, then it seems to me like we could use it and fall back to reading the snapshot.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094371542/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094375187","html_url":"https://github.com/apache/iceberg/pull/4512#issuecomment-1094375187","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4512","id":1094375187,"node_id":"IC_kwDOCW7NX85BOtcT","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-10T21:36:25Z","updated_at":"2022-04-10T21:36:25Z","author_association":"CONTRIBUTOR","body":"I don't think that this is the right approach.\r\n\r\nIn most cases, the residual evaluator is small because the initial expression is small. Plus, the residual evaluator is reused for all of the tasks, so there is only one in memory. Eagerly evaluating the residual could create a huge number of expressions in memory, one for each partition at a minimum and probably on per file split.\r\n\r\nI also don't think this would help very much because if the large expression with thousands of literal values is not eliminated by the residual evaluator, it would be retained in the resulting expressions.\r\n\r\nOverall, I think that the right balance is to keep the residual evaluator here. There will be some cases where that is expensive, but much better in the average case. The cases where it is expensive are cases where the large expression is already in memory anyway.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094375187/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094376204","html_url":"https://github.com/apache/iceberg/pull/4507#issuecomment-1094376204","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4507","id":1094376204,"node_id":"IC_kwDOCW7NX85BOtsM","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-10T21:43:58Z","updated_at":"2022-04-10T21:43:58Z","author_association":"CONTRIBUTOR","body":"I'm not sure how the changes in this PR would help, since it just makes a warning more broad. The catch clauses that are updated here don't actually change what happens other than to log a warning in unrelated cases.\r\n\r\nI'm also skeptical that this is the right thing to do. The chance of an OOM causing a commit to appear like it did not succeed when it actually did is incredibly small... and besides, cleanup is run when a `RuntimeException` is caught. That means that an Error wouldn't actually cause the commit path to remove live data files.\r\n\r\n@southernriver, It sounds like the problem that you actually hit was with Spark's error handling and cleanup instead? Maybe we should change the Spark writer instead to avoid triggering its abort path in certain cases. That's a very different change.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094376204/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094438409","html_url":"https://github.com/apache/iceberg/pull/4531#issuecomment-1094438409","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4531","id":1094438409,"node_id":"IC_kwDOCW7NX85BO84J","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-11T01:04:06Z","updated_at":"2022-04-11T01:04:06Z","author_association":"CONTRIBUTOR","body":"Thanks, @yittg!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094438409/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094462606","html_url":"https://github.com/apache/iceberg/issues/4515#issuecomment-1094462606","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4515","id":1094462606,"node_id":"IC_kwDOCW7NX85BPCyO","user":{"login":"yittg","id":4429171,"node_id":"MDQ6VXNlcjQ0MjkxNzE=","avatar_url":"https://avatars.githubusercontent.com/u/4429171?v=4","gravatar_id":"","url":"https://api.github.com/users/yittg","html_url":"https://github.com/yittg","followers_url":"https://api.github.com/users/yittg/followers","following_url":"https://api.github.com/users/yittg/following{/other_user}","gists_url":"https://api.github.com/users/yittg/gists{/gist_id}","starred_url":"https://api.github.com/users/yittg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yittg/subscriptions","organizations_url":"https://api.github.com/users/yittg/orgs","repos_url":"https://api.github.com/users/yittg/repos","events_url":"https://api.github.com/users/yittg/events{/privacy}","received_events_url":"https://api.github.com/users/yittg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-11T01:51:40Z","updated_at":"2022-04-11T02:53:20Z","author_association":"CONTRIBUTOR","body":"@openinx , actually it happens in calcite rel converter.\r\nOnly pure literal tuples can be converted to LogicalValues node, otherwise it will be converted to multiple LogicalProject -> LogicalUnion nodes.\r\n\r\nChange `TO_DATE('xxxx-xx-xx')` to `DATE 'xxxx-xx-xx'` can make it a literal node and avoid being converted to union nodes.\r\n\r\nFYR:\r\n\r\nhttps://github.com/apache/calcite/blob/32babcb90aa5940bdd75760021abab6459a9cca4/core/src/main/java/org/apache/calcite/sql2rel/SqlToRelConverter.java#L4472-L4475\r\n\r\n\r\nhttps://github.com/apache/calcite/blob/32babcb90aa5940bdd75760021abab6459a9cca4/core/src/main/java/org/apache/calcite/sql2rel/SqlToRelConverter.java#L1733-L1741","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094462606/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094463391","html_url":"https://github.com/apache/iceberg/pull/4528#issuecomment-1094463391","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4528","id":1094463391,"node_id":"IC_kwDOCW7NX85BPC-f","user":{"login":"flashJd","id":23452216,"node_id":"MDQ6VXNlcjIzNDUyMjE2","avatar_url":"https://avatars.githubusercontent.com/u/23452216?v=4","gravatar_id":"","url":"https://api.github.com/users/flashJd","html_url":"https://github.com/flashJd","followers_url":"https://api.github.com/users/flashJd/followers","following_url":"https://api.github.com/users/flashJd/following{/other_user}","gists_url":"https://api.github.com/users/flashJd/gists{/gist_id}","starred_url":"https://api.github.com/users/flashJd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flashJd/subscriptions","organizations_url":"https://api.github.com/users/flashJd/orgs","repos_url":"https://api.github.com/users/flashJd/repos","events_url":"https://api.github.com/users/flashJd/events{/privacy}","received_events_url":"https://api.github.com/users/flashJd/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-11T01:53:50Z","updated_at":"2022-04-11T01:53:50Z","author_association":"CONTRIBUTOR","body":"> @flashJd, could you coordinate with @stevenzwu? He has been working on Flink streaming reads and is a great person to discuss features like this with.\r\n\r\nIt's my pleasure to coordinate with stevenzwu, could you review it  and give me some advice @stevenzwu, Looking forward to your reply.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094463391/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094464138","html_url":"https://github.com/apache/iceberg/pull/4507#issuecomment-1094464138","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4507","id":1094464138,"node_id":"IC_kwDOCW7NX85BPDKK","user":{"login":"southernriver","id":20614350,"node_id":"MDQ6VXNlcjIwNjE0MzUw","avatar_url":"https://avatars.githubusercontent.com/u/20614350?v=4","gravatar_id":"","url":"https://api.github.com/users/southernriver","html_url":"https://github.com/southernriver","followers_url":"https://api.github.com/users/southernriver/followers","following_url":"https://api.github.com/users/southernriver/following{/other_user}","gists_url":"https://api.github.com/users/southernriver/gists{/gist_id}","starred_url":"https://api.github.com/users/southernriver/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/southernriver/subscriptions","organizations_url":"https://api.github.com/users/southernriver/orgs","repos_url":"https://api.github.com/users/southernriver/repos","events_url":"https://api.github.com/users/southernriver/events{/privacy}","received_events_url":"https://api.github.com/users/southernriver/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-11T01:55:59Z","updated_at":"2022-04-11T01:55:59Z","author_association":"CONTRIBUTOR","body":"> I'm not sure how the changes in this PR would help, since it just makes a warning more broad. The catch clauses that are updated here don't actually change what happens other than to log a warning in unrelated cases.\r\n> \r\n> I'm also skeptical that this is the right thing to do. The chance of an OOM causing a commit to appear like it did not succeed when it actually did is incredibly small... and besides, cleanup is run when a `RuntimeException` is caught. That means that an Error wouldn't actually cause the commit path to remove live data files.\r\n> \r\n> @southernriver, It sounds like the problem that you actually hit was with Spark's error handling and cleanup instead? Maybe we should change the Spark writer instead to avoid triggering its abort path in certain cases. That's a very different change.\r\n\r\n@rdblue Thanks for your comment.  Iceberg itself implements the SparkWrite#abort method and could delete datafile with uncatched `java.lang.Error` or `java.lang.Exception`.  ` RuntimeException` can not cover`OutOfMemoryError` , so I did catch all `java.lang.Throwable` to avoid clean-up live data files. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094464138/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094464513","html_url":"https://github.com/apache/iceberg/pull/4464#issuecomment-1094464513","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4464","id":1094464513,"node_id":"IC_kwDOCW7NX85BPDQB","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-11T01:57:09Z","updated_at":"2022-04-11T01:57:09Z","author_association":"MEMBER","body":"ping @rdblue ..","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094464513/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094501133","html_url":"https://github.com/apache/iceberg/pull/4529#issuecomment-1094501133","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4529","id":1094501133,"node_id":"IC_kwDOCW7NX85BPMMN","user":{"login":"yittg","id":4429171,"node_id":"MDQ6VXNlcjQ0MjkxNzE=","avatar_url":"https://avatars.githubusercontent.com/u/4429171?v=4","gravatar_id":"","url":"https://api.github.com/users/yittg","html_url":"https://github.com/yittg","followers_url":"https://api.github.com/users/yittg/followers","following_url":"https://api.github.com/users/yittg/following{/other_user}","gists_url":"https://api.github.com/users/yittg/gists{/gist_id}","starred_url":"https://api.github.com/users/yittg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yittg/subscriptions","organizations_url":"https://api.github.com/users/yittg/orgs","repos_url":"https://api.github.com/users/yittg/repos","events_url":"https://api.github.com/users/yittg/events{/privacy}","received_events_url":"https://api.github.com/users/yittg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-11T03:17:29Z","updated_at":"2022-04-11T03:17:29Z","author_association":"CONTRIBUTOR","body":"thanks @stevenzwu for providing this change.\r\nPersonally, i'm not quite sure should we use a such big change to achieve this target.\r\nI wonder whether it is a better option to use a special invalid snapshot id value to do the same thing, such as `-1`. Checking this special value can be equivalent with null checking.\r\n\r\nOr please correct me if it has other effects. Also looking forward others' opinions.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094501133/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094640751","html_url":"https://github.com/apache/iceberg/pull/4308#issuecomment-1094640751","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4308","id":1094640751,"node_id":"IC_kwDOCW7NX85BPuRv","user":{"login":"kunal0829","id":24599931,"node_id":"MDQ6VXNlcjI0NTk5OTMx","avatar_url":"https://avatars.githubusercontent.com/u/24599931?v=4","gravatar_id":"","url":"https://api.github.com/users/kunal0829","html_url":"https://github.com/kunal0829","followers_url":"https://api.github.com/users/kunal0829/followers","following_url":"https://api.github.com/users/kunal0829/following{/other_user}","gists_url":"https://api.github.com/users/kunal0829/gists{/gist_id}","starred_url":"https://api.github.com/users/kunal0829/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kunal0829/subscriptions","organizations_url":"https://api.github.com/users/kunal0829/orgs","repos_url":"https://api.github.com/users/kunal0829/repos","events_url":"https://api.github.com/users/kunal0829/events{/privacy}","received_events_url":"https://api.github.com/users/kunal0829/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-11T07:18:44Z","updated_at":"2022-04-11T07:18:44Z","author_association":"NONE","body":"@rdblue  Here is an example write up that explains the proposed format: https://docs.google.com/document/d/1CvOfsVAMezqQyyAwIn0qfew9EvlX-5PIvKGHPzlHldA/edit?usp=sharing\r\n\r\nPlease let me know if you have any questions about the proposed format","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094640751/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094646392","html_url":"https://github.com/apache/iceberg/issues/4515#issuecomment-1094646392","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4515","id":1094646392,"node_id":"IC_kwDOCW7NX85BPvp4","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-11T07:25:22Z","updated_at":"2022-04-11T07:25:22Z","author_association":"CONTRIBUTOR","body":"@yittg this is great work finding this and fixing it. I am just getting back from being out of office, so am catching up on this now.\r\n\r\nThank you to @singhpk234 and @openinx as well for all of the work on this. Really appreciate your thorough analysis.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094646392/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094658955","html_url":"https://github.com/apache/iceberg/pull/4512#issuecomment-1094658955","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4512","id":1094658955,"node_id":"IC_kwDOCW7NX85BPyuL","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-11T07:41:17Z","updated_at":"2022-04-11T07:41:17Z","author_association":"CONTRIBUTOR","body":"Thanks @rdblue for the review!\r\nWill have to find another solution then. We need to serialize the tasks and send them to the executors. When we have this big residual, then we have to serialize it for every task which is a serious unnecessary overhead, especially when the resulting expression is small.\r\n\r\n@szlta suggested that - in case the residuals are the same for every task in a table scan - we could serialize the residuals independently and send them by a different / table scan level method, and before executing the task we can restore the residuals.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094658955/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094663855","html_url":"https://github.com/apache/iceberg/pull/4415#issuecomment-1094663855","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4415","id":1094663855,"node_id":"IC_kwDOCW7NX85BPz6v","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-11T07:47:18Z","updated_at":"2022-04-11T07:47:18Z","author_association":"CONTRIBUTOR","body":"The usage of `TO_DATE` causes calcite to generate a plan which adds a union across all of the `VALUES` entries, causing them to potentially be omitted in parallel which makes the plan not what is expected.\r\n\r\nThis is discussed in length here: https://github.com/apache/iceberg/issues/4515","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094663855/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094678071","html_url":"https://github.com/apache/iceberg/issues/644#issuecomment-1094678071","issue_url":"https://api.github.com/repos/apache/iceberg/issues/644","id":1094678071,"node_id":"IC_kwDOCW7NX85BP3Y3","user":{"login":"felixYyu","id":3785228,"node_id":"MDQ6VXNlcjM3ODUyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3785228?v=4","gravatar_id":"","url":"https://api.github.com/users/felixYyu","html_url":"https://github.com/felixYyu","followers_url":"https://api.github.com/users/felixYyu/followers","following_url":"https://api.github.com/users/felixYyu/following{/other_user}","gists_url":"https://api.github.com/users/felixYyu/gists{/gist_id}","starred_url":"https://api.github.com/users/felixYyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixYyu/subscriptions","organizations_url":"https://api.github.com/users/felixYyu/orgs","repos_url":"https://api.github.com/users/felixYyu/repos","events_url":"https://api.github.com/users/felixYyu/events{/privacy}","received_events_url":"https://api.github.com/users/felixYyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-11T08:03:58Z","updated_at":"2022-04-11T08:03:58Z","author_association":"CONTRIBUTOR","body":"@jzhuge interested and happy to help too.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094678071/reactions","total_count":3,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":3},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094729211","html_url":"https://github.com/apache/iceberg/pull/4532#issuecomment-1094729211","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4532","id":1094729211,"node_id":"IC_kwDOCW7NX85BQD37","user":{"login":"yittg","id":4429171,"node_id":"MDQ6VXNlcjQ0MjkxNzE=","avatar_url":"https://avatars.githubusercontent.com/u/4429171?v=4","gravatar_id":"","url":"https://api.github.com/users/yittg","html_url":"https://github.com/yittg","followers_url":"https://api.github.com/users/yittg/followers","following_url":"https://api.github.com/users/yittg/following{/other_user}","gists_url":"https://api.github.com/users/yittg/gists{/gist_id}","starred_url":"https://api.github.com/users/yittg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yittg/subscriptions","organizations_url":"https://api.github.com/users/yittg/orgs","repos_url":"https://api.github.com/users/yittg/repos","events_url":"https://api.github.com/users/yittg/events{/privacy}","received_events_url":"https://api.github.com/users/yittg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-11T08:47:54Z","updated_at":"2022-04-11T08:47:54Z","author_association":"CONTRIBUTOR","body":"@kbendick i've changed this PR to contain only the first part.\r\n\r\nI'll create another PR for the second part after this being merged, if necessary. If the current test data is already enough, we can just drop the second part. :)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094729211/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094761649","html_url":"https://github.com/apache/iceberg/pull/4519#issuecomment-1094761649","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4519","id":1094761649,"node_id":"IC_kwDOCW7NX85BQLyx","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-11T09:03:43Z","updated_at":"2022-04-11T09:03:43Z","author_association":"MEMBER","body":"> Since we can't fix it in Flink 1.12, I think the right option is to disable it and ask the user to upgrade. \r\n\r\nSorry, maybe I missed something. Is there any blocker that we cannot just fix this bug in flink 1.12 ? In my context, I think the approach to fix the bug in fink 1.12 is just porting the patch from flink1.13/1.14 to flink1.12, I usually just export it to a patch file and replace the `v1.14` to `v1.12` globally.\r\n\r\nI can also understand that we are planing to remove the flink 1.12 in the next iceberg release 0.14.0.  But in iceberg release 0.13.2,  I don't think we should remove flink 1.12 support because it's a bugfix release.  So for the release 0.13.2,  the correct approach is fixing this bug or disabling the `UPSERT` write feature. For me, fixing this bug in flink 1.12 seems more reasonable.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094761649/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094802300","html_url":"https://github.com/apache/iceberg/pull/4514#issuecomment-1094802300","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4514","id":1094802300,"node_id":"IC_kwDOCW7NX85BQVt8","user":{"login":"vanliu-tx","id":64360028,"node_id":"MDQ6VXNlcjY0MzYwMDI4","avatar_url":"https://avatars.githubusercontent.com/u/64360028?v=4","gravatar_id":"","url":"https://api.github.com/users/vanliu-tx","html_url":"https://github.com/vanliu-tx","followers_url":"https://api.github.com/users/vanliu-tx/followers","following_url":"https://api.github.com/users/vanliu-tx/following{/other_user}","gists_url":"https://api.github.com/users/vanliu-tx/gists{/gist_id}","starred_url":"https://api.github.com/users/vanliu-tx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vanliu-tx/subscriptions","organizations_url":"https://api.github.com/users/vanliu-tx/orgs","repos_url":"https://api.github.com/users/vanliu-tx/repos","events_url":"https://api.github.com/users/vanliu-tx/events{/privacy}","received_events_url":"https://api.github.com/users/vanliu-tx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-11T09:26:43Z","updated_at":"2022-04-11T09:26:43Z","author_association":"CONTRIBUTOR","body":"@rdblue @RussellSpitzer @aokolnychyi  could you help to merge this bug fix?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1094802300/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1095211042","html_url":"https://github.com/apache/iceberg/pull/4519#issuecomment-1095211042","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4519","id":1095211042,"node_id":"IC_kwDOCW7NX85BR5gi","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-11T15:39:04Z","updated_at":"2022-04-11T15:39:04Z","author_association":"CONTRIBUTOR","body":"> Is there any blocker that we cannot just fix this bug in flink 1.12 ? In my context, I think the approach to fix the bug in fink 1.12 is just porting the patch from flink1.13/1.14 to flink1.12, I usually just export it to a patch file and replace the v1.14 to v1.12 globally.\r\n\r\nMy understanding is that there is a bug in Flink 1.12 that prevents us from fixing this, but I'm not sure what that is. I think we'll need @kbendick to jump in and give the details.\r\n\r\nI agree with you, if we can easily adapt the fix for 1.13 and 1.14, then we should just fix it!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1095211042/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1095245484","html_url":"https://github.com/apache/iceberg/pull/4512#issuecomment-1095245484","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4512","id":1095245484,"node_id":"IC_kwDOCW7NX85BSB6s","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-11T16:02:21Z","updated_at":"2022-04-11T16:02:21Z","author_association":"CONTRIBUTOR","body":"@pvary, we could introduce a table property that enables this, maybe? That could address the issue for this case, but not change the default behavior.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1095245484/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1095288984","html_url":"https://github.com/apache/iceberg/pull/4512#issuecomment-1095288984","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4512","id":1095288984,"node_id":"IC_kwDOCW7NX85BSMiY","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-11T16:42:37Z","updated_at":"2022-04-11T16:42:37Z","author_association":"CONTRIBUTOR","body":"@rdblue: Definitely! Let us check the possibilities and come back with a suggestion.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1095288984/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1095389667","html_url":"https://github.com/apache/iceberg/pull/4518#issuecomment-1095389667","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4518","id":1095389667,"node_id":"IC_kwDOCW7NX85BSlHj","user":{"login":"rizaon","id":6033430,"node_id":"MDQ6VXNlcjYwMzM0MzA=","avatar_url":"https://avatars.githubusercontent.com/u/6033430?v=4","gravatar_id":"","url":"https://api.github.com/users/rizaon","html_url":"https://github.com/rizaon","followers_url":"https://api.github.com/users/rizaon/followers","following_url":"https://api.github.com/users/rizaon/following{/other_user}","gists_url":"https://api.github.com/users/rizaon/gists{/gist_id}","starred_url":"https://api.github.com/users/rizaon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rizaon/subscriptions","organizations_url":"https://api.github.com/users/rizaon/orgs","repos_url":"https://api.github.com/users/rizaon/repos","events_url":"https://api.github.com/users/rizaon/events{/privacy}","received_events_url":"https://api.github.com/users/rizaon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-11T18:16:16Z","updated_at":"2022-04-11T18:16:16Z","author_association":"CONTRIBUTOR","body":"Hi @rdblue, thank you for your feedback.\r\n\r\nWe found a slow query compilation issue against the Iceberg table in our recent Apache Impala build. Impala uses Iceberg's HiveCatalog and HadoopFileIO instance with an S3A input stream to access data from S3. We did a full 10 TB TPC-DS benchmark and found that query compilation can go for several seconds, while it used to be less than a second with native hive tables. This slowness in single query compilation is due to the requirement to call planFiles several times, even for scan nodes targetting the same table. We also see several socket read operations that spend hundreds of milliseconds during planFiles, presumably due to S3A HTTP HEAD request overhead and backward seek overhead (issue #4508). This is especially hurt fast-running queries.\r\n\r\nWe tried this caching solution and it help speed up Impala query compilation almost 5x faster compared to without on Iceberg tables. Our original solution, however, is to put a Caffeine cache as a singleton in AvroIO.java. I thought it is better to supply the cache from outside.\r\n\r\nI have not considered the solution of adding a caching FileIO instance. I'm pretty new to the Iceberg codebase but interested to follow up on that if it can yield a better integration. Will it require a new class of Catalog/Table as well, or can we improve on the existing HiveCatalog & HadoopFileIO?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1095389667/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1095393793","html_url":"https://github.com/apache/iceberg/pull/4518#issuecomment-1095393793","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4518","id":1095393793,"node_id":"IC_kwDOCW7NX85BSmIB","user":{"login":"rizaon","id":6033430,"node_id":"MDQ6VXNlcjYwMzM0MzA=","avatar_url":"https://avatars.githubusercontent.com/u/6033430?v=4","gravatar_id":"","url":"https://api.github.com/users/rizaon","html_url":"https://github.com/rizaon","followers_url":"https://api.github.com/users/rizaon/followers","following_url":"https://api.github.com/users/rizaon/following{/other_user}","gists_url":"https://api.github.com/users/rizaon/gists{/gist_id}","starred_url":"https://api.github.com/users/rizaon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rizaon/subscriptions","organizations_url":"https://api.github.com/users/rizaon/orgs","repos_url":"https://api.github.com/users/rizaon/repos","events_url":"https://api.github.com/users/rizaon/events{/privacy}","received_events_url":"https://api.github.com/users/rizaon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-11T18:18:45Z","updated_at":"2022-04-11T18:18:45Z","author_association":"CONTRIBUTOR","body":"A relevant Impala's JIRA is here:\r\nhttps://issues.apache.org/jira/browse/IMPALA-11171","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1095393793/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1095405864","html_url":"https://github.com/apache/iceberg/pull/4518#issuecomment-1095405864","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4518","id":1095405864,"node_id":"IC_kwDOCW7NX85BSpEo","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-11T18:29:07Z","updated_at":"2022-04-11T18:29:07Z","author_association":"CONTRIBUTOR","body":"@rizaon, caching in the FileIO layer would be much more general. You could do things like detect that the file size is less than some threshold and cache it in memory, or detect file names under `metadata` and cache those. I highly recommend looking into the FileIO API!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1095405864/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1095460067","html_url":"https://github.com/apache/iceberg/pull/4525#issuecomment-1095460067","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4525","id":1095460067,"node_id":"IC_kwDOCW7NX85BS2Tj","user":{"login":"rzhang10","id":75445426,"node_id":"MDQ6VXNlcjc1NDQ1NDI2","avatar_url":"https://avatars.githubusercontent.com/u/75445426?v=4","gravatar_id":"","url":"https://api.github.com/users/rzhang10","html_url":"https://github.com/rzhang10","followers_url":"https://api.github.com/users/rzhang10/followers","following_url":"https://api.github.com/users/rzhang10/following{/other_user}","gists_url":"https://api.github.com/users/rzhang10/gists{/gist_id}","starred_url":"https://api.github.com/users/rzhang10/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rzhang10/subscriptions","organizations_url":"https://api.github.com/users/rzhang10/orgs","repos_url":"https://api.github.com/users/rzhang10/repos","events_url":"https://api.github.com/users/rzhang10/events{/privacy}","received_events_url":"https://api.github.com/users/rzhang10/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-11T19:16:43Z","updated_at":"2022-04-11T19:16:54Z","author_association":"CONTRIBUTOR","body":"@rdblue \r\n\r\nI see your major concern in the reviews is regarding using Jackson in Iceberg-api module.\r\n\r\nLet me put my thoughts here in one place to answer all the questions above, the core problem is whether we should represent the default value in memory in `JsonNode` or Java primitives.\r\n\r\nThe reason I chose Jackson is that:\r\n- Jackson has more robust json validation utils, which come in handy here.\r\n- Jackson `JsonNoe` is also `java.io.Serializable`.\r\n- Jackson is also used in the Iceberg-core module as a dependency. I believe whenever iceberg is used as a library, iceberg-api and iceberg-core will both be dependent upon. So I wouldn't believe introducing Jackson in the API module will (additionally) pollute downstream dependencies.\r\n\r\nIf we take the java primitive approach, I think my current code could be adapted this way:\r\n\r\nMaintain the current json validation logic, then add a `ValueParser` with `toJson` and `fromJson` to convert between json and their respective java primitive representations. The structure of the current code will pretty much stay the same.\r\n\r\nLet me know your thoughts and I'm open to further discussions too.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1095460067/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1095474807","html_url":"https://github.com/apache/iceberg/pull/4520#issuecomment-1095474807","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4520","id":1095474807,"node_id":"IC_kwDOCW7NX85BS553","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-11T19:29:47Z","updated_at":"2022-04-11T19:29:47Z","author_association":"COLLABORATOR","body":"@rdblue would you also want to take a look at this too if you have some time (as its a bit tricky code)?  Thanks","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1095474807/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1095477586","html_url":"https://github.com/apache/iceberg/issues/2225#issuecomment-1095477586","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2225","id":1095477586,"node_id":"IC_kwDOCW7NX85BS6lS","user":{"login":"austince","id":4655775,"node_id":"MDQ6VXNlcjQ2NTU3NzU=","avatar_url":"https://avatars.githubusercontent.com/u/4655775?v=4","gravatar_id":"","url":"https://api.github.com/users/austince","html_url":"https://github.com/austince","followers_url":"https://api.github.com/users/austince/followers","following_url":"https://api.github.com/users/austince/following{/other_user}","gists_url":"https://api.github.com/users/austince/gists{/gist_id}","starred_url":"https://api.github.com/users/austince/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/austince/subscriptions","organizations_url":"https://api.github.com/users/austince/orgs","repos_url":"https://api.github.com/users/austince/repos","events_url":"https://api.github.com/users/austince/events{/privacy}","received_events_url":"https://api.github.com/users/austince/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-11T19:32:24Z","updated_at":"2022-04-11T19:32:24Z","author_association":"NONE","body":"I believe the `FlinkSource` builder would need to migrate to [Flink's new source interface](https://nightlies.apache.org/flink/flink-docs-release-1.14/docs/dev/datastream/sources/#the-data-source-api) to support this case. Currently, this builder just uses `StreamExecutionEnvironment#createInput(..)` which does not support this:\r\nhttps://github.com/apache/iceberg/blob/910f2712c7b731181c4a72fb6b8c66addeb76dd9/flink/v1.14/flink/src/main/java/org/apache/iceberg/flink/source/FlinkSource.java#L228-L232","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1095477586/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1095496964","html_url":"https://github.com/apache/iceberg/pull/4525#issuecomment-1095496964","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4525","id":1095496964,"node_id":"IC_kwDOCW7NX85BS_UE","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-11T19:50:05Z","updated_at":"2022-04-11T19:50:05Z","author_association":"CONTRIBUTOR","body":"@rzhang10, it's okay to add the library to the API module if that's what is needed, although I'd like to see if we actually need it there or if we can convert values to/from JSON in core.\r\n\r\nFor the in-memory representation, we do need to use the common representation and not JsonNode. We also cannot leak Jackson classes in the API module.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1095496964/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1095607821","html_url":"https://github.com/apache/iceberg/pull/4495#issuecomment-1095607821","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4495","id":1095607821,"node_id":"IC_kwDOCW7NX85BTaYN","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-11T21:56:48Z","updated_at":"2022-04-11T21:56:48Z","author_association":"CONTRIBUTOR","body":"> +1 once checkstyle is fixed. Here's the error:\r\n> \r\n> ```\r\n> [ERROR] /home/runner/work/iceberg/iceberg/core/src/test/java/org/apache/iceberg/rest/RESTCatalogAdapter.java:22:8: Unused import - java.io.Closeable. [UnusedImports]\r\n> ```\r\n\r\nThis has been removed. Once CI completes this should be good to go.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1095607821/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1095624358","html_url":"https://github.com/apache/iceberg/pull/4520#issuecomment-1095624358","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4520","id":1095624358,"node_id":"IC_kwDOCW7NX85BTeam","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-11T22:10:19Z","updated_at":"2022-04-11T22:48:16Z","author_association":"COLLABORATOR","body":"Adding an observation, the case where wrong results are filtered out is limited to V2 tables, where partition fields are removed (ie, see the initial description).\r\n\r\nIn tests for any partition spec modification in V1 (in V1, fields are never removed), or V2 tables where partition fields are modified or added but not removed, we get a IndexOutOfBoundsException in the ManifestEvaluator if we try to query files written by different partition spec than current one.\r\n\r\nStill worth to fix, just making a note for the impact.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1095624358/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1095656554","html_url":"https://github.com/apache/iceberg/issues/3941#issuecomment-1095656554","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3941","id":1095656554,"node_id":"IC_kwDOCW7NX85BTmRq","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-11T22:34:50Z","updated_at":"2022-04-11T22:34:50Z","author_association":"CONTRIBUTOR","body":"The draft PR is here, https://github.com/apache/iceberg/pull/4539. Let me know if you have any feedback.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1095656554/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1095658141","html_url":"https://github.com/apache/iceberg/pull/4512#issuecomment-1095658141","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4512","id":1095658141,"node_id":"IC_kwDOCW7NX85BTmqd","user":{"login":"rbalamohan","id":7969713,"node_id":"MDQ6VXNlcjc5Njk3MTM=","avatar_url":"https://avatars.githubusercontent.com/u/7969713?v=4","gravatar_id":"","url":"https://api.github.com/users/rbalamohan","html_url":"https://github.com/rbalamohan","followers_url":"https://api.github.com/users/rbalamohan/followers","following_url":"https://api.github.com/users/rbalamohan/following{/other_user}","gists_url":"https://api.github.com/users/rbalamohan/gists{/gist_id}","starred_url":"https://api.github.com/users/rbalamohan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rbalamohan/subscriptions","organizations_url":"https://api.github.com/users/rbalamohan/orgs","repos_url":"https://api.github.com/users/rbalamohan/repos","events_url":"https://api.github.com/users/rbalamohan/events{/privacy}","received_events_url":"https://api.github.com/users/rbalamohan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-11T22:37:15Z","updated_at":"2022-04-11T22:37:15Z","author_association":"CONTRIBUTOR","body":"@rdblue , @pvary : We may have to look at other possibilities. One potential issue in adding it to table property is that, we may not know the query pattern of end users. So it would be difficult to specify it in table property.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1095658141/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1095660002","html_url":"https://github.com/apache/iceberg/pull/4466#issuecomment-1095660002","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4466","id":1095660002,"node_id":"IC_kwDOCW7NX85BTnHi","user":{"login":"dramaticlly","id":5961173,"node_id":"MDQ6VXNlcjU5NjExNzM=","avatar_url":"https://avatars.githubusercontent.com/u/5961173?v=4","gravatar_id":"","url":"https://api.github.com/users/dramaticlly","html_url":"https://github.com/dramaticlly","followers_url":"https://api.github.com/users/dramaticlly/followers","following_url":"https://api.github.com/users/dramaticlly/following{/other_user}","gists_url":"https://api.github.com/users/dramaticlly/gists{/gist_id}","starred_url":"https://api.github.com/users/dramaticlly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dramaticlly/subscriptions","organizations_url":"https://api.github.com/users/dramaticlly/orgs","repos_url":"https://api.github.com/users/dramaticlly/repos","events_url":"https://api.github.com/users/dramaticlly/events{/privacy}","received_events_url":"https://api.github.com/users/dramaticlly/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-11T22:40:06Z","updated_at":"2022-04-11T22:40:06Z","author_association":"CONTRIBUTOR","body":"Thanks @CircArgs , we actually merged #4468 to renamed the expression module structure. Maybe you will want to rename accordingly from `expression` to `expressions` so we dont have both of expression module? Some rebase of the change might be needed as well\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1095660002/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1095661430","html_url":"https://github.com/apache/iceberg/issues/3228#issuecomment-1095661430","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3228","id":1095661430,"node_id":"IC_kwDOCW7NX85BTnd2","user":{"login":"samredai","id":43911210,"node_id":"MDQ6VXNlcjQzOTExMjEw","avatar_url":"https://avatars.githubusercontent.com/u/43911210?v=4","gravatar_id":"","url":"https://api.github.com/users/samredai","html_url":"https://github.com/samredai","followers_url":"https://api.github.com/users/samredai/followers","following_url":"https://api.github.com/users/samredai/following{/other_user}","gists_url":"https://api.github.com/users/samredai/gists{/gist_id}","starred_url":"https://api.github.com/users/samredai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samredai/subscriptions","organizations_url":"https://api.github.com/users/samredai/orgs","repos_url":"https://api.github.com/users/samredai/repos","events_url":"https://api.github.com/users/samredai/events{/privacy}","received_events_url":"https://api.github.com/users/samredai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-11T22:42:18Z","updated_at":"2022-04-11T22:42:54Z","author_association":"CONTRIBUTOR","body":"Now that schema has been merged I think we need a couple more PRs in order to close this:\r\n1. PartitionField\r\n2. PartitionSpec\r\n3. PartitionSpecBuilder\r\n\r\nFor 3. I know we discussed whether we should go with the builder pattern or just lean into python's ability for named optional arguments. There might be a middle ground in there where we use the builder pattern (to maintain consistency with the java codebase) and simply use that builder in the `PartitionSpec` dunder init.\r\n\r\nAnyone interested, please feel free to tackle any of these items!  ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1095661430/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1095665228","html_url":"https://github.com/apache/iceberg/issues/3228#issuecomment-1095665228","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3228","id":1095665228,"node_id":"IC_kwDOCW7NX85BToZM","user":{"login":"dramaticlly","id":5961173,"node_id":"MDQ6VXNlcjU5NjExNzM=","avatar_url":"https://avatars.githubusercontent.com/u/5961173?v=4","gravatar_id":"","url":"https://api.github.com/users/dramaticlly","html_url":"https://github.com/dramaticlly","followers_url":"https://api.github.com/users/dramaticlly/followers","following_url":"https://api.github.com/users/dramaticlly/following{/other_user}","gists_url":"https://api.github.com/users/dramaticlly/gists{/gist_id}","starred_url":"https://api.github.com/users/dramaticlly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dramaticlly/subscriptions","organizations_url":"https://api.github.com/users/dramaticlly/orgs","repos_url":"https://api.github.com/users/dramaticlly/repos","events_url":"https://api.github.com/users/dramaticlly/events{/privacy}","received_events_url":"https://api.github.com/users/dramaticlly/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-11T22:49:01Z","updated_at":"2022-04-11T22:49:01Z","author_association":"CONTRIBUTOR","body":"I can help by starting with PartitionSpec! ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1095665228/reactions","total_count":2,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1095709285","html_url":"https://github.com/apache/iceberg/pull/4540#issuecomment-1095709285","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4540","id":1095709285,"node_id":"IC_kwDOCW7NX85BTzJl","user":{"login":"liuml07","id":159186,"node_id":"MDQ6VXNlcjE1OTE4Ng==","avatar_url":"https://avatars.githubusercontent.com/u/159186?v=4","gravatar_id":"","url":"https://api.github.com/users/liuml07","html_url":"https://github.com/liuml07","followers_url":"https://api.github.com/users/liuml07/followers","following_url":"https://api.github.com/users/liuml07/following{/other_user}","gists_url":"https://api.github.com/users/liuml07/gists{/gist_id}","starred_url":"https://api.github.com/users/liuml07/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liuml07/subscriptions","organizations_url":"https://api.github.com/users/liuml07/orgs","repos_url":"https://api.github.com/users/liuml07/repos","events_url":"https://api.github.com/users/liuml07/events{/privacy}","received_events_url":"https://api.github.com/users/liuml07/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-11T23:57:24Z","updated_at":"2022-04-11T23:57:24Z","author_association":"MEMBER","body":"\r\n<img width=\"1278\" alt=\"Screen Shot 2022-04-11 at 4 44 08 PM\" src=\"https://user-images.githubusercontent.com/159186/162851836-e6f07aec-97a5-48f8-8b92-46fb99ca85a3.png\">\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1095709285/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1095807404","html_url":"https://github.com/apache/iceberg/pull/4495#issuecomment-1095807404","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4495","id":1095807404,"node_id":"IC_kwDOCW7NX85BULGs","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-12T01:52:01Z","updated_at":"2022-04-12T01:52:01Z","author_association":"CONTRIBUTOR","body":"Thanks, @kbendick!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1095807404/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1095831603","html_url":"https://github.com/apache/iceberg/pull/4541#issuecomment-1095831603","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4541","id":1095831603,"node_id":"IC_kwDOCW7NX85BURAz","user":{"login":"yittg","id":4429171,"node_id":"MDQ6VXNlcjQ0MjkxNzE=","avatar_url":"https://avatars.githubusercontent.com/u/4429171?v=4","gravatar_id":"","url":"https://api.github.com/users/yittg","html_url":"https://github.com/yittg","followers_url":"https://api.github.com/users/yittg/followers","following_url":"https://api.github.com/users/yittg/following{/other_user}","gists_url":"https://api.github.com/users/yittg/gists{/gist_id}","starred_url":"https://api.github.com/users/yittg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yittg/subscriptions","organizations_url":"https://api.github.com/users/yittg/orgs","repos_url":"https://api.github.com/users/yittg/repos","events_url":"https://api.github.com/users/yittg/events{/privacy}","received_events_url":"https://api.github.com/users/yittg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-12T02:10:16Z","updated_at":"2022-04-12T02:10:16Z","author_association":"CONTRIBUTOR","body":"Tests fail due to #4533, wait it being merged.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1095831603/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1095833728","html_url":"https://github.com/apache/iceberg/pull/4512#issuecomment-1095833728","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4512","id":1095833728,"node_id":"IC_kwDOCW7NX85BURiA","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-12T02:12:15Z","updated_at":"2022-04-12T02:12:15Z","author_association":"CONTRIBUTOR","body":"We may not know the query pattern, but I think it is more common to have simple predicates than to have an IN clause with tens of thousands of values. I'll give this some thought, though.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1095833728/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1095844443","html_url":"https://github.com/apache/iceberg/pull/4529#issuecomment-1095844443","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4529","id":1095844443,"node_id":"IC_kwDOCW7NX85BUUJb","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-12T02:21:59Z","updated_at":"2022-04-12T02:57:44Z","author_association":"CONTRIBUTOR","body":"@yittg this proposal is after the discussion with Ryan. The original plan was to provide an overloaded `appendsBetween` with `long` and `Long`. But during implementation, I found that overload caused compiling error as I mentioned in one of the comments. So I have to rename the new method to `appendsInRange`, which unfortunately is not as good a name as `appendsBetween`. This PR is actually relatively small change even though it touched many files.\r\n\r\nRegarding special value, I am not sure if there is a special invalid snapshot id that Iceberg reserves in the table format spec. The only special value is `null`. E.g., the earliest snapshot has `parent-snapshot-id` as null.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1095844443/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1095870154","html_url":"https://github.com/apache/iceberg/pull/4529#issuecomment-1095870154","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4529","id":1095870154,"node_id":"IC_kwDOCW7NX85BUabK","user":{"login":"yittg","id":4429171,"node_id":"MDQ6VXNlcjQ0MjkxNzE=","avatar_url":"https://avatars.githubusercontent.com/u/4429171?v=4","gravatar_id":"","url":"https://api.github.com/users/yittg","html_url":"https://github.com/yittg","followers_url":"https://api.github.com/users/yittg/followers","following_url":"https://api.github.com/users/yittg/following{/other_user}","gists_url":"https://api.github.com/users/yittg/gists{/gist_id}","starred_url":"https://api.github.com/users/yittg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yittg/subscriptions","organizations_url":"https://api.github.com/users/yittg/orgs","repos_url":"https://api.github.com/users/yittg/repos","events_url":"https://api.github.com/users/yittg/events{/privacy}","received_events_url":"https://api.github.com/users/yittg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-12T02:44:17Z","updated_at":"2022-04-12T02:44:17Z","author_association":"CONTRIBUTOR","body":"@stevenzwu Thanks for your explanation and great work.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1095870154/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1095872950","html_url":"https://github.com/apache/iceberg/pull/4495#issuecomment-1095872950","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4495","id":1095872950,"node_id":"IC_kwDOCW7NX85BUbG2","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-12T02:46:53Z","updated_at":"2022-04-12T02:46:53Z","author_association":"CONTRIBUTOR","body":"> Thanks, @kbendick!\r\n\r\nThanks for the review! Im much happier this with than I was with the original.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1095872950/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1095879020","html_url":"https://github.com/apache/iceberg/pull/4464#issuecomment-1095879020","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4464","id":1095879020,"node_id":"IC_kwDOCW7NX85BUcls","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-12T02:51:48Z","updated_at":"2022-04-12T02:51:48Z","author_association":"CONTRIBUTOR","body":"Thanks, @ajantha-bhat! Nice work.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1095879020/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1095893289","html_url":"https://github.com/apache/iceberg/pull/4541#issuecomment-1095893289","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4541","id":1095893289,"node_id":"IC_kwDOCW7NX85BUgEp","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-12T03:03:25Z","updated_at":"2022-04-12T03:03:25Z","author_association":"CONTRIBUTOR","body":"Here's a link to the unit test shared code that openinx had mentioned would be good to clean up / reuse across several tests: https://github.com/apache/iceberg/pull/4364#discussion_r833870953","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1095893289/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1096092140","html_url":"https://github.com/apache/iceberg/pull/4541#issuecomment-1096092140","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4541","id":1096092140,"node_id":"IC_kwDOCW7NX85BVQns","user":{"login":"yittg","id":4429171,"node_id":"MDQ6VXNlcjQ0MjkxNzE=","avatar_url":"https://avatars.githubusercontent.com/u/4429171?v=4","gravatar_id":"","url":"https://api.github.com/users/yittg","html_url":"https://github.com/yittg","followers_url":"https://api.github.com/users/yittg/followers","following_url":"https://api.github.com/users/yittg/following{/other_user}","gists_url":"https://api.github.com/users/yittg/gists{/gist_id}","starred_url":"https://api.github.com/users/yittg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yittg/subscriptions","organizations_url":"https://api.github.com/users/yittg/orgs","repos_url":"https://api.github.com/users/yittg/repos","events_url":"https://api.github.com/users/yittg/events{/privacy}","received_events_url":"https://api.github.com/users/yittg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-12T05:38:14Z","updated_at":"2022-04-12T05:50:06Z","author_association":"CONTRIBUTOR","body":"@kbendick After making it more fuzzy locally, i found these tests get unstable again. I'll try to figure out whether they are real failed cases caused by UPSERT logical or others, or it's just because the cases are too fuzzy to be tested.\r\n\r\nI'll update this change if they are valid test cases, and change this PR to WIP temporarily.\r\nMaybe the current static cases is enough to focus on UPSERT relative logical, i'll add other cases if it failed because other reasons.\r\n\r\nAnd about the tests architecture / utilities, i noticed it also. I'm very interested in improving them and making the tests more accurate and wider coverage, and making iceberg more robust finally.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1096092140/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1096131994","html_url":"https://github.com/apache/iceberg/issues/3636#issuecomment-1096131994","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3636","id":1096131994,"node_id":"IC_kwDOCW7NX85BVaWa","user":{"login":"ubyyj","id":12639959,"node_id":"MDQ6VXNlcjEyNjM5OTU5","avatar_url":"https://avatars.githubusercontent.com/u/12639959?v=4","gravatar_id":"","url":"https://api.github.com/users/ubyyj","html_url":"https://github.com/ubyyj","followers_url":"https://api.github.com/users/ubyyj/followers","following_url":"https://api.github.com/users/ubyyj/following{/other_user}","gists_url":"https://api.github.com/users/ubyyj/gists{/gist_id}","starred_url":"https://api.github.com/users/ubyyj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ubyyj/subscriptions","organizations_url":"https://api.github.com/users/ubyyj/orgs","repos_url":"https://api.github.com/users/ubyyj/repos","events_url":"https://api.github.com/users/ubyyj/events{/privacy}","received_events_url":"https://api.github.com/users/ubyyj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-12T06:09:35Z","updated_at":"2022-04-12T06:51:15Z","author_association":"NONE","body":"hit the same issue in 0.13.1 in many queries, merge into, insert overwrite, etc.\r\nbelow is an example:\r\n`INSERT OVERWRITE mytable\r\nSELECT *\r\nFROM youjunyuan.mytable_v2_20020408\r\nWHERE dt = '2022-03-21' and action='reportImpressionsTS'\r\norder by hh, user_id`","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1096131994/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1096143698","html_url":"https://github.com/apache/iceberg/issues/104#issuecomment-1096143698","issue_url":"https://api.github.com/repos/apache/iceberg/issues/104","id":1096143698,"node_id":"IC_kwDOCW7NX85BVdNS","user":{"login":"ubyyj","id":12639959,"node_id":"MDQ6VXNlcjEyNjM5OTU5","avatar_url":"https://avatars.githubusercontent.com/u/12639959?v=4","gravatar_id":"","url":"https://api.github.com/users/ubyyj","html_url":"https://github.com/ubyyj","followers_url":"https://api.github.com/users/ubyyj/followers","following_url":"https://api.github.com/users/ubyyj/following{/other_user}","gists_url":"https://api.github.com/users/ubyyj/gists{/gist_id}","starred_url":"https://api.github.com/users/ubyyj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ubyyj/subscriptions","organizations_url":"https://api.github.com/users/ubyyj/orgs","repos_url":"https://api.github.com/users/ubyyj/repos","events_url":"https://api.github.com/users/ubyyj/events{/privacy}","received_events_url":"https://api.github.com/users/ubyyj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-12T06:18:27Z","updated_at":"2022-04-12T06:18:27Z","author_association":"NONE","body":"still seeing this in 0.13.1 whenever I try to overwrite or update data in spark, and the query failed at the end.\r\n\r\n22/04/12 06:03:00 ERROR v2.OverwritePartitionsDynamicExec: Data source write support IcebergBatchWrite(table=spark_catalog.default.actions_v2, format=PARQUET) aborted.\r\norg.apache.spark.SparkException: Writing job aborted\r\n\tat org.apache.spark.sql.errors.QueryExecutionErrors$.writingJobAbortedError(QueryExecutionErrors.scala:613)\r\n\tat org.apache.spark.sql.execution.datasources.v2.V2TableWriteExec.writeWithV2(WriteToDataSourceV2Exec.scala:386)\r\n\tat org.apache.spark.sql.execution.datasources.v2.V2TableWriteExec.writeWithV2$(WriteToDataSourceV2Exec.scala:330)\r\n\tat org.apache.spark.sql.execution.datasources.v2.OverwritePartitionsDynamicExec.writeWithV2(WriteToDataSourceV2Exec.scala:271)\r\n\tat org.apache.spark.sql.execution.datasources.v2.V2ExistingTableWriteExec.run(WriteToDataSourceV2Exec.scala:309)\r\n\tat org.apache.spark.sql.execution.datasources.v2.V2ExistingTableWriteExec.run$(WriteToDataSourceV2Exec.scala:308)\r\n\tat org.apache.spark.sql.execution.datasources.v2.OverwritePartitionsDynamicExec.run(WriteToDataSourceV2Exec.scala:271)\r\n\tat org.apache.spark.sql.execution.datasources.v2.V2CommandExec.result$lzycompute(V2CommandExec.scala:43)\r\n\tat org.apache.spark.sql.execution.datasources.v2.V2CommandExec.result(V2CommandExec.scala:43)\r\n\tat org.apache.spark.sql.execution.datasources.v2.V2CommandExec.executeCollect(V2CommandExec.scala:49)\r\n\r\n...\r\ncom.amazonaws.SdkClientException: Unable to execute HTTP request: Timeout waiting for connection from pool\r\n\tat org.apache.hadoop.fs.s3a.S3AUtils.translateException(S3AUtils.java:125)\r\n\tat org.apache.hadoop.fs.s3a.S3AUtils.translateException(S3AUtils.java:101)\r\n\tat org.apache.hadoop.fs.s3a.S3AFileSystem.getFileStatus(S3AFileSystem.java:1571)\r\n\tat org.apache.hadoop.fs.s3a.S3AFileSystem.create(S3AFileSystem.java:555)\r\n\tat org.apache.hadoop.fs.FileSystem.create(FileSystem.java:932)\r\n\tat org.apache.hadoop.fs.FileSystem.create(FileSystem.java:913)\r\n\tat org.apache.hadoop.fs.FileSystem.create(FileSystem.java:810)\r\n\tat org.apache.iceberg.hadoop.HadoopOutputFile.createOrOverwrite(HadoopOutputFile.java:85)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1096143698/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1096187335","html_url":"https://github.com/apache/iceberg/issues/3636#issuecomment-1096187335","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3636","id":1096187335,"node_id":"IC_kwDOCW7NX85BVn3H","user":{"login":"ubyyj","id":12639959,"node_id":"MDQ6VXNlcjEyNjM5OTU5","avatar_url":"https://avatars.githubusercontent.com/u/12639959?v=4","gravatar_id":"","url":"https://api.github.com/users/ubyyj","html_url":"https://github.com/ubyyj","followers_url":"https://api.github.com/users/ubyyj/followers","following_url":"https://api.github.com/users/ubyyj/following{/other_user}","gists_url":"https://api.github.com/users/ubyyj/gists{/gist_id}","starred_url":"https://api.github.com/users/ubyyj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ubyyj/subscriptions","organizations_url":"https://api.github.com/users/ubyyj/orgs","repos_url":"https://api.github.com/users/ubyyj/repos","events_url":"https://api.github.com/users/ubyyj/events{/privacy}","received_events_url":"https://api.github.com/users/ubyyj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-12T06:50:38Z","updated_at":"2022-04-12T06:50:38Z","author_association":"NONE","body":"here is the full call stack:\r\n`22/04/12 06:02:30 WARN hadoop.HadoopStreams: Unclosed input stream created by:\r\n\torg.apache.iceberg.hadoop.HadoopStreams$HadoopSeekableInputStream.<init>(HadoopStreams.java:81)\r\n\torg.apache.iceberg.hadoop.HadoopStreams.wrap(HadoopStreams.java:56)\r\n\torg.apache.iceberg.hadoop.HadoopInputFile.newStream(HadoopInputFile.java:175)\r\n\torg.apache.iceberg.avro.AvroIterable.newFileReader(AvroIterable.java:101)\r\n\torg.apache.iceberg.avro.AvroIterable.iterator(AvroIterable.java:77)\r\n\torg.apache.iceberg.io.CloseableIterable$4$1.<init>(CloseableIterable.java:99)\r\n\torg.apache.iceberg.io.CloseableIterable$4.iterator(CloseableIterable.java:98)\r\n\torg.apache.iceberg.io.CloseableIterable$4.iterator(CloseableIterable.java:90)\r\n\tjava.lang.Iterable.forEach(Iterable.java:74)\r\n\torg.apache.iceberg.ManifestFilterManager.filterManifestWithDeletedFiles(ManifestFilterManager.java:385)\r\n\torg.apache.iceberg.ManifestFilterManager.filterManifest(ManifestFilterManager.java:308)\r\n\torg.apache.iceberg.ManifestFilterManager.lambda$filterManifests$0(ManifestFilterManager.java:186)\r\n\torg.apache.iceberg.util.Tasks$Builder.runTaskWithRetry(Tasks.java:404)\r\n\torg.apache.iceberg.util.Tasks$Builder.access$300(Tasks.java:70)\r\n\torg.apache.iceberg.util.Tasks$Builder$1.run(Tasks.java:310)\r\n\tjava.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)\r\n\tjava.util.concurrent.FutureTask.run(FutureTask.java:266)\r\n\tjava.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n\tjava.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n\tjava.lang.Thread.run(Thread.java:748)`\r\n\r\n`22/04/12 06:03:00 ERROR v2.OverwritePartitionsDynamicExec: Data source write support IcebergBatchWrite(table=spark_catalog.default.mytable, format=PARQUET) aborted.\r\norg.apache.spark.SparkException: Writing job aborted\r\n\tat org.apache.spark.sql.errors.QueryExecutionErrors$.writingJobAbortedError(QueryExecutionErrors.scala:613)\r\n\tat org.apache.spark.sql.execution.datasources.v2.V2TableWriteExec.writeWithV2(WriteToDataSourceV2Exec.scala:386)\r\n\tat org.apache.spark.sql.execution.datasources.v2.V2TableWriteExec.writeWithV2$(WriteToDataSourceV2Exec.scala:330)\r\n\tat org.apache.spark.sql.execution.datasources.v2.OverwritePartitionsDynamicExec.writeWithV2(WriteToDataSourceV2Exec.scala:271)\r\n\tat org.apache.spark.sql.execution.datasources.v2.V2ExistingTableWriteExec.run(WriteToDataSourceV2Exec.scala:309)\r\n\tat org.apache.spark.sql.execution.datasources.v2.V2ExistingTableWriteExec.run$(WriteToDataSourceV2Exec.scala:308)\r\n\tat org.apache.spark.sql.execution.datasources.v2.OverwritePartitionsDynamicExec.run(WriteToDataSourceV2Exec.scala:271)\r\n\tat org.apache.spark.sql.execution.datasources.v2.V2CommandExec.result$lzycompute(V2CommandExec.scala:43)\r\n\tat org.apache.spark.sql.execution.datasources.v2.V2CommandExec.result(V2CommandExec.scala:43)\r\n\tat org.apache.spark.sql.execution.datasources.v2.V2CommandExec.executeCollect(V2CommandExec.scala:49)\r\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:110)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$5(SQLExecution.scala:103)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:163)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:90)\r\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:775)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:64)\r\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:110)\r\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:106)\r\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:481)\r\n\tat org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(TreeNode.scala:82)\r\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:481)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:30)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:30)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:30)\r\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:457)\r\n\tat org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:106)\r\n\tat org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:93)\r\n\tat org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:91)\r\n\tat org.apache.spark.sql.Dataset.<init>(Dataset.scala:219)\r\n\tat org.apache.spark.sql.Dataset$.$anonfun$ofRows$2(Dataset.scala:99)\r\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:775)\r\n\tat org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:96)\r\n\tat org.apache.spark.sql.SparkSession.$anonfun$sql$1(SparkSession.scala:618)\r\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:775)\r\n\tat org.apache.spark.sql.SparkSession.sql(SparkSession.scala:613)\r\n\tat org.apache.spark.sql.SQLContext.sql(SQLContext.scala:651)\r\n\tat org.apache.spark.sql.hive.thriftserver.SparkSQLDriver.run(SparkSQLDriver.scala:67)\r\n\tat org.apache.spark.sql.hive.thriftserver.SparkSQLCLIDriver.processCmd(SparkSQLCLIDriver.scala:384)\r\n\tat org.apache.spark.sql.hive.thriftserver.SparkSQLCLIDriver.$anonfun$processLine$1(SparkSQLCLIDriver.scala:504)\r\n\tat org.apache.spark.sql.hive.thriftserver.SparkSQLCLIDriver.$anonfun$processLine$1$adapted(SparkSQLCLIDriver.scala:498)\r\n\tat scala.collection.Iterator.foreach(Iterator.scala:943)\r\n\tat scala.collection.Iterator.foreach$(Iterator.scala:943)\r\n\tat scala.collection.AbstractIterator.foreach(Iterator.scala:1431)\r\n\tat scala.collection.IterableLike.foreach(IterableLike.scala:74)\r\n\tat scala.collection.IterableLike.foreach$(IterableLike.scala:73)\r\n\tat scala.collection.AbstractIterable.foreach(Iterable.scala:56)\r\n\tat org.apache.spark.sql.hive.thriftserver.SparkSQLCLIDriver.processLine(SparkSQLCLIDriver.scala:498)\r\n\tat org.apache.spark.sql.hive.thriftserver.SparkSQLCLIDriver$.main(SparkSQLCLIDriver.scala:287)\r\n\tat org.apache.spark.sql.hive.thriftserver.SparkSQLCLIDriver.main(SparkSQLCLIDriver.scala)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.lang.reflect.Method.invoke(Method.java:498)\r\n\tat org.apache.spark.deploy.JavaMainApplication.start(SparkApplication.scala:52)\r\n\tat org.apache.spark.deploy.SparkSubmit.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:955)\r\n\tat org.apache.spark.deploy.SparkSubmit.doRunMain$1(SparkSubmit.scala:180)\r\n\tat org.apache.spark.deploy.SparkSubmit.submit(SparkSubmit.scala:203)\r\n\tat org.apache.spark.deploy.SparkSubmit.doSubmit(SparkSubmit.scala:90)\r\n\tat org.apache.spark.deploy.SparkSubmit$$anon$2.doSubmit(SparkSubmit.scala:1043)\r\n\tat org.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:1052)\r\n\tat org.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)\r\nCaused by: org.apache.iceberg.exceptions.RuntimeIOException: Failed to create file: s3a://mybucket/mytable/metadata/b1506cbf-2dd4-42b3-9dc4-81d798a0ca75-m14.avro\r\n\tat org.apache.iceberg.hadoop.HadoopOutputFile.createOrOverwrite(HadoopOutputFile.java:87)\r\n\tat org.apache.iceberg.avro.AvroFileAppender.<init>(AvroFileAppender.java:51)\r\n\tat org.apache.iceberg.avro.Avro$WriteBuilder.build(Avro.java:198)\r\n\tat org.apache.iceberg.ManifestWriter$V2Writer.newAppender(ManifestWriter.java:211)\r\n\tat org.apache.iceberg.ManifestWriter.<init>(ManifestWriter.java:58)\r\n\tat org.apache.iceberg.ManifestWriter.<init>(ManifestWriter.java:34)\r\n\tat org.apache.iceberg.ManifestWriter$V2Writer.<init>(ManifestWriter.java:189)\r\n\tat org.apache.iceberg.ManifestFiles.write(ManifestFiles.java:119)\r\n\tat org.apache.iceberg.SnapshotProducer.newManifestWriter(SnapshotProducer.java:370)\r\n\tat org.apache.iceberg.MergingSnapshotProducer$DataFileFilterManager.newManifestWriter(MergingSnapshotProducer.java:711)\r\n\tat org.apache.iceberg.ManifestFilterManager.filterManifestWithDeletedFiles(ManifestFilterManager.java:383)\r\n\tat org.apache.iceberg.ManifestFilterManager.filterManifest(ManifestFilterManager.java:308)\r\n\tat org.apache.iceberg.ManifestFilterManager.lambda$filterManifests$0(ManifestFilterManager.java:186)\r\n\tat org.apache.iceberg.util.Tasks$Builder.runTaskWithRetry(Tasks.java:404)\r\n\tat org.apache.iceberg.util.Tasks$Builder.access$300(Tasks.java:70)\r\n\tat org.apache.iceberg.util.Tasks$Builder$1.run(Tasks.java:310)\r\n\tat java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)\r\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:266)\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n\tat java.lang.Thread.run(Thread.java:748)\r\nCaused by: java.io.InterruptedIOException: getFileStatus on s3a://mybucket/mytable/metadata/b1506cbf-2dd4-42b3-9dc4-81d798a0ca75-m14.avro: com.amazonaws.SdkClientException: Unable to execute HTTP request: Timeout waiting for connection from pool\r\n\tat org.apache.hadoop.fs.s3a.S3AUtils.translateException(S3AUtils.java:125)\r\n\tat org.apache.hadoop.fs.s3a.S3AUtils.translateException(S3AUtils.java:101)\r\n\tat org.apache.hadoop.fs.s3a.S3AFileSystem.getFileStatus(S3AFileSystem.java:1571)\r\n\tat org.apache.hadoop.fs.s3a.S3AFileSystem.create(S3AFileSystem.java:555)\r\n\tat org.apache.hadoop.fs.FileSystem.create(FileSystem.java:932)\r\n\tat org.apache.hadoop.fs.FileSystem.create(FileSystem.java:913)\r\n\tat org.apache.hadoop.fs.FileSystem.create(FileSystem.java:810)\r\n\tat org.apache.iceberg.hadoop.HadoopOutputFile.createOrOverwrite(HadoopOutputFile.java:85)\r\n\t... 20 more\r\nCaused by: com.amazonaws.SdkClientException: Unable to execute HTTP request: Timeout waiting for connection from pool\r\n\tat com.amazonaws.http.AmazonHttpClient$RequestExecutor.handleRetryableException(AmazonHttpClient.java:1175)\r\n\tat com.amazonaws.http.AmazonHttpClient$RequestExecutor.executeHelper(AmazonHttpClient.java:1121)\r\n\tat com.amazonaws.http.AmazonHttpClient$RequestExecutor.doExecute(AmazonHttpClient.java:770)\r\n\tat com.amazonaws.http.AmazonHttpClient$RequestExecutor.executeWithTimer(AmazonHttpClient.java:744)\r\n\tat com.amazonaws.http.AmazonHttpClient$RequestExecutor.execute(AmazonHttpClient.java:726)\r\n\tat com.amazonaws.http.AmazonHttpClient$RequestExecutor.access$500(AmazonHttpClient.java:686)\r\n\tat com.amazonaws.http.AmazonHttpClient$RequestExecutionBuilderImpl.execute(AmazonHttpClient.java:668)\r\n\tat com.amazonaws.http.AmazonHttpClient.execute(AmazonHttpClient.java:532)\r\n\tat com.amazonaws.http.AmazonHttpClient.execute(AmazonHttpClient.java:512)\r\n\tat com.amazonaws.services.s3.AmazonS3Client.invoke(AmazonS3Client.java:4926)\r\n\tat com.amazonaws.services.s3.AmazonS3Client.invoke(AmazonS3Client.java:4872)\r\n\tat com.amazonaws.services.s3.AmazonS3Client.getObjectMetadata(AmazonS3Client.java:1321)\r\n\tat com.amazonaws.services.s3.AmazonS3Client.getObjectMetadata(AmazonS3Client.java:1295)\r\n\tat org.apache.hadoop.fs.s3a.S3AFileSystem.getObjectMetadata(S3AFileSystem.java:904)\r\n\tat org.apache.hadoop.fs.s3a.S3AFileSystem.getFileStatus(S3AFileSystem.java:1553)`","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1096187335/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1096245636","html_url":"https://github.com/apache/iceberg/pull/4534#issuecomment-1096245636","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4534","id":1096245636,"node_id":"IC_kwDOCW7NX85BV2GE","user":{"login":"findepi","id":144328,"node_id":"MDQ6VXNlcjE0NDMyOA==","avatar_url":"https://avatars.githubusercontent.com/u/144328?v=4","gravatar_id":"","url":"https://api.github.com/users/findepi","html_url":"https://github.com/findepi","followers_url":"https://api.github.com/users/findepi/followers","following_url":"https://api.github.com/users/findepi/following{/other_user}","gists_url":"https://api.github.com/users/findepi/gists{/gist_id}","starred_url":"https://api.github.com/users/findepi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/findepi/subscriptions","organizations_url":"https://api.github.com/users/findepi/orgs","repos_url":"https://api.github.com/users/findepi/repos","events_url":"https://api.github.com/users/findepi/events{/privacy}","received_events_url":"https://api.github.com/users/findepi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-12T07:26:43Z","updated_at":"2022-04-12T07:26:43Z","author_association":"MEMBER","body":"AC","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1096245636/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1096418224","html_url":"https://github.com/apache/iceberg/pull/4536#issuecomment-1096418224","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4536","id":1096418224,"node_id":"IC_kwDOCW7NX85BWgOw","user":{"login":"marton-bod","id":19599214,"node_id":"MDQ6VXNlcjE5NTk5MjE0","avatar_url":"https://avatars.githubusercontent.com/u/19599214?v=4","gravatar_id":"","url":"https://api.github.com/users/marton-bod","html_url":"https://github.com/marton-bod","followers_url":"https://api.github.com/users/marton-bod/followers","following_url":"https://api.github.com/users/marton-bod/following{/other_user}","gists_url":"https://api.github.com/users/marton-bod/gists{/gist_id}","starred_url":"https://api.github.com/users/marton-bod/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marton-bod/subscriptions","organizations_url":"https://api.github.com/users/marton-bod/orgs","repos_url":"https://api.github.com/users/marton-bod/repos","events_url":"https://api.github.com/users/marton-bod/events{/privacy}","received_events_url":"https://api.github.com/users/marton-bod/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-12T09:12:31Z","updated_at":"2022-04-12T09:12:31Z","author_association":"COLLABORATOR","body":"PR for the iceberg-docs: https://github.com/apache/iceberg-docs/pull/72\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1096418224/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1096431433","html_url":"https://github.com/apache/iceberg/pull/4541#issuecomment-1096431433","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4541","id":1096431433,"node_id":"IC_kwDOCW7NX85BWjdJ","user":{"login":"yittg","id":4429171,"node_id":"MDQ6VXNlcjQ0MjkxNzE=","avatar_url":"https://avatars.githubusercontent.com/u/4429171?v=4","gravatar_id":"","url":"https://api.github.com/users/yittg","html_url":"https://github.com/yittg","followers_url":"https://api.github.com/users/yittg/followers","following_url":"https://api.github.com/users/yittg/following{/other_user}","gists_url":"https://api.github.com/users/yittg/gists{/gist_id}","starred_url":"https://api.github.com/users/yittg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yittg/subscriptions","organizations_url":"https://api.github.com/users/yittg/orgs","repos_url":"https://api.github.com/users/yittg/repos","events_url":"https://api.github.com/users/yittg/events{/privacy}","received_events_url":"https://api.github.com/users/yittg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-12T09:21:02Z","updated_at":"2022-04-12T09:21:02Z","author_association":"CONTRIBUTOR","body":"@kbendick After diving deeper in Flink, for batch mode jobs, the records emitted to `keyBy` node will be sorted. In iceberg, records written to table with identifier fields will always be distributed with `keyBy` identifier fields. And I believe the sorter is unstable, so the records with same key can be swapped.\r\n\r\nSo here all records will be sorted before being emitted into IcebergStreamWriter. And records with same key can be out of order.\r\n\r\nSo dynamic generated case can break these cases, however, static records can always be sorted in the same way i think.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1096431433/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1096443213","html_url":"https://github.com/apache/iceberg/pull/4541#issuecomment-1096443213","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4541","id":1096443213,"node_id":"IC_kwDOCW7NX85BWmVN","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-12T09:29:59Z","updated_at":"2022-04-12T09:32:00Z","author_association":"CONTRIBUTOR","body":"> @kbendick After diving deeper in Flink, for batch mode jobs, the records emitted to `keyBy` node will be sorted. In iceberg, records written to table with identifier fields will always be distributed with `keyBy` identifier fields. And I believe the sorter is unstable, so the records with same key can be swapped.\r\n> \r\n> So here all records will be sorted before being emitted into IcebergStreamWriter. And records with same key can be out of order.\r\n> \r\n> So dynamic generated case can break these cases, however, static records can always be sorted in the same way i think.\r\n\r\nI really appreciate the thorough research.\r\n\r\nWe (at least I) are hoping to migrate to some of the newer Flink Table API after we deprecate 1.12. Hopefully this will make things a bit more straightforward. (So using ResolvedSchema and LogicalSchema  vs just Schema, things like that).\r\n\r\nIm opening a PR to support Flink 1.15 tomorrow (the release candidate anyway). Its just a port with the minimum required changes to make it work. And then the process of upgrading to the newer APIs can begin.\r\n\r\nHowever, theres one test case somewhat in this realm (change data capture) that isnt passing in the 1.15 rc0. Ill tag you and hopefully if you have time you can take a look? Id greatly appreciate it.\r\n\r\nAlso feel free to reach out on Slack. Not sure what time zone youre in but Id love to ask you a few questions (if even asynchronously).\r\n\r\nThanks again for all the work youve put in, especially recently! @yittg ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1096443213/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1096448941","html_url":"https://github.com/apache/iceberg/issues/1372#issuecomment-1096448941","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1372","id":1096448941,"node_id":"IC_kwDOCW7NX85BWnut","user":{"login":"fmouaffo","id":39360168,"node_id":"MDQ6VXNlcjM5MzYwMTY4","avatar_url":"https://avatars.githubusercontent.com/u/39360168?v=4","gravatar_id":"","url":"https://api.github.com/users/fmouaffo","html_url":"https://github.com/fmouaffo","followers_url":"https://api.github.com/users/fmouaffo/followers","following_url":"https://api.github.com/users/fmouaffo/following{/other_user}","gists_url":"https://api.github.com/users/fmouaffo/gists{/gist_id}","starred_url":"https://api.github.com/users/fmouaffo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmouaffo/subscriptions","organizations_url":"https://api.github.com/users/fmouaffo/orgs","repos_url":"https://api.github.com/users/fmouaffo/repos","events_url":"https://api.github.com/users/fmouaffo/events{/privacy}","received_events_url":"https://api.github.com/users/fmouaffo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-12T09:34:22Z","updated_at":"2022-04-12T09:34:22Z","author_association":"NONE","body":"> If I understand correctly, Spark 2.4 does not support creating tables in SQL [spark guide](https://iceberg.apache.org/spark/#spark).\r\n> \r\n> Maybe you can use the Iceberg API to build table and then write data [createTable](https://iceberg.apache.org/java-api-quickstart/#create-a-table).\r\n\r\nWere you able to use the Iceberg API to build table in a spark 2.4 configuration?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1096448941/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1096469237","html_url":"https://github.com/apache/iceberg/pull/4541#issuecomment-1096469237","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4541","id":1096469237,"node_id":"IC_kwDOCW7NX85BWsr1","user":{"login":"yittg","id":4429171,"node_id":"MDQ6VXNlcjQ0MjkxNzE=","avatar_url":"https://avatars.githubusercontent.com/u/4429171?v=4","gravatar_id":"","url":"https://api.github.com/users/yittg","html_url":"https://github.com/yittg","followers_url":"https://api.github.com/users/yittg/followers","following_url":"https://api.github.com/users/yittg/following{/other_user}","gists_url":"https://api.github.com/users/yittg/gists{/gist_id}","starred_url":"https://api.github.com/users/yittg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yittg/subscriptions","organizations_url":"https://api.github.com/users/yittg/orgs","repos_url":"https://api.github.com/users/yittg/repos","events_url":"https://api.github.com/users/yittg/events{/privacy}","received_events_url":"https://api.github.com/users/yittg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-12T09:49:46Z","updated_at":"2022-04-12T09:49:46Z","author_association":"CONTRIBUTOR","body":"@kbendick feel free to ping me, will be glad if i can help.\r\n\r\nAnd closing this PR.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1096469237/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1096818564","html_url":"https://github.com/apache/iceberg/pull/4512#issuecomment-1096818564","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4512","id":1096818564,"node_id":"IC_kwDOCW7NX85BYB-E","user":{"login":"szlta","id":40628386,"node_id":"MDQ6VXNlcjQwNjI4Mzg2","avatar_url":"https://avatars.githubusercontent.com/u/40628386?v=4","gravatar_id":"","url":"https://api.github.com/users/szlta","html_url":"https://github.com/szlta","followers_url":"https://api.github.com/users/szlta/followers","following_url":"https://api.github.com/users/szlta/following{/other_user}","gists_url":"https://api.github.com/users/szlta/gists{/gist_id}","starred_url":"https://api.github.com/users/szlta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szlta/subscriptions","organizations_url":"https://api.github.com/users/szlta/orgs","repos_url":"https://api.github.com/users/szlta/repos","events_url":"https://api.github.com/users/szlta/events{/privacy}","received_events_url":"https://api.github.com/users/szlta/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-12T14:40:18Z","updated_at":"2022-04-12T14:40:18Z","author_association":"CONTRIBUTOR","body":"I propose another way to solve this for Hive (I'm not sure if this is an issue for other engines, or if they even serialize the tasks the same way a Tez AM does in Hive ecosystem..)\r\n\r\nAs @rdblue mentioned, the expression that goes with the file scan tasks is actually not a \"residual\" one, but rather the original data filter. This is good for us, as now we know that for any Hive job the expression is the same object - so we can transfer it another way to Hive execution processes:\r\n\r\n- The expression itself is generated via https://github.com/apache/iceberg/blob/master/mr/src/main/java/org/apache/iceberg/mr/hive/HiveIcebergInputFormat.java#L82-L93 before split generation within the AM. There's nothing to prevent us from reusing this same logic on the executors.\r\n- At the same time we can ask ignoreResiduals() on the table scan, so that Iceberg only uses the filter for split generation, but won't actually attach it to the file scan tasks, and therefore their enwrapping splits.\r\n- On the execution side we can just simply retrieve the original filter expression by the logic above and evaluate it against the current task (whose spec and partition value information are present anyway), ending up with the actual residual expression for the task. This is then passed to the underlying file formats the same way as before.\r\n\r\nI've opened a PR for this in the Hive repo for now: https://github.com/apache/hive/pull/3203\r\nIt looks like there will be some bigger refactors required to separate MR and Hive related stuff in the MR module in the Iceberg repo before this solution could be ported here too.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1096818564/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1096877673","html_url":"https://github.com/apache/iceberg/pull/2105#issuecomment-1096877673","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2105","id":1096877673,"node_id":"IC_kwDOCW7NX85BYQZp","user":{"login":"klam-shop","id":78921373,"node_id":"MDQ6VXNlcjc4OTIxMzcz","avatar_url":"https://avatars.githubusercontent.com/u/78921373?v=4","gravatar_id":"","url":"https://api.github.com/users/klam-shop","html_url":"https://github.com/klam-shop","followers_url":"https://api.github.com/users/klam-shop/followers","following_url":"https://api.github.com/users/klam-shop/following{/other_user}","gists_url":"https://api.github.com/users/klam-shop/gists{/gist_id}","starred_url":"https://api.github.com/users/klam-shop/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/klam-shop/subscriptions","organizations_url":"https://api.github.com/users/klam-shop/orgs","repos_url":"https://api.github.com/users/klam-shop/repos","events_url":"https://api.github.com/users/klam-shop/events{/privacy}","received_events_url":"https://api.github.com/users/klam-shop/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-12T15:29:06Z","updated_at":"2022-04-12T15:29:06Z","author_association":"NONE","body":" Is work still ongoing for the FLIP-27 IceBerg Flink source? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1096877673/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1096911818","html_url":"https://github.com/apache/iceberg/pull/4512#issuecomment-1096911818","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4512","id":1096911818,"node_id":"IC_kwDOCW7NX85BYYvK","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-12T15:59:12Z","updated_at":"2022-04-12T15:59:12Z","author_association":"CONTRIBUTOR","body":"So is the idea to ignore residuals and to run the original filter on every split? That seems reasonable to me.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1096911818/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1096956287","html_url":"https://github.com/apache/iceberg/pull/4512#issuecomment-1096956287","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4512","id":1096956287,"node_id":"IC_kwDOCW7NX85BYjl_","user":{"login":"szlta","id":40628386,"node_id":"MDQ6VXNlcjQwNjI4Mzg2","avatar_url":"https://avatars.githubusercontent.com/u/40628386?v=4","gravatar_id":"","url":"https://api.github.com/users/szlta","html_url":"https://github.com/szlta","followers_url":"https://api.github.com/users/szlta/followers","following_url":"https://api.github.com/users/szlta/following{/other_user}","gists_url":"https://api.github.com/users/szlta/gists{/gist_id}","starred_url":"https://api.github.com/users/szlta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szlta/subscriptions","organizations_url":"https://api.github.com/users/szlta/orgs","repos_url":"https://api.github.com/users/szlta/repos","events_url":"https://api.github.com/users/szlta/events{/privacy}","received_events_url":"https://api.github.com/users/szlta/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-12T16:42:20Z","updated_at":"2022-04-12T16:42:20Z","author_association":"CONTRIBUTOR","body":"Almost.. we would still be running residuals, they'd just take a different way to their final evaluation.\r\n\r\nSo right we're transferring the filter expression within every split. This expression hangs on every baseFileScanTask.residuals.expr in its original form i.e. un-evaluated against partition info. (This actually makes it less of a \"residual\" so to speak.)\r\nIf the expression is big and we have thousands of splits, this leads to OOM at the point where every split is getting serialized. (A limitation of TezAM is that streamed serialization is not possible..)\r\nOn the executors, after deserialization we have these baseFileScanTasks along with the original filter expressions which get evaluated against the partition value of the task when we call task.residual(), and thus it becomes an actual \"residual\" expression to be pushed down to file format libs.\r\n\r\nSo far this is how it works currently.\r\n\r\nMy proposal is that since the expressions that get serialized into the splits are always all the same for a given job, Hive should call ignoreResiduals() to make Iceberg set Expressions.alwaysTrue() in the baseFileScanTask instances. Therefore we don't serialize the original filter expressions into every split. We can do this, because the original filter can be retrieved from the Hive job conf anyway. Then with a little trick on the executor processes, we won't take task.residual(), but instead look for the original filter in the job conf, evaluate it according to the current task (spec and partition), and pass the resulting real residual filter to file formats/record readers.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1096956287/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1097040456","html_url":"https://github.com/apache/iceberg/pull/2105#issuecomment-1097040456","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2105","id":1097040456,"node_id":"IC_kwDOCW7NX85BY4JI","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-12T18:15:03Z","updated_at":"2022-04-12T18:15:03Z","author_association":"CONTRIBUTOR","body":"@klam-shop yes, The uber draft PR is meant for the full context for how things work together. It is being broken down to smaller PRs for easier code review. \r\n\r\nyou can check the project for progress. https://github.com/apache/iceberg/projects/23. We are about 60% merged.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1097040456/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1097057876","html_url":"https://github.com/apache/iceberg/pull/2105#issuecomment-1097057876","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2105","id":1097057876,"node_id":"IC_kwDOCW7NX85BY8ZU","user":{"login":"klam-shop","id":78921373,"node_id":"MDQ6VXNlcjc4OTIxMzcz","avatar_url":"https://avatars.githubusercontent.com/u/78921373?v=4","gravatar_id":"","url":"https://api.github.com/users/klam-shop","html_url":"https://github.com/klam-shop","followers_url":"https://api.github.com/users/klam-shop/followers","following_url":"https://api.github.com/users/klam-shop/following{/other_user}","gists_url":"https://api.github.com/users/klam-shop/gists{/gist_id}","starred_url":"https://api.github.com/users/klam-shop/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/klam-shop/subscriptions","organizations_url":"https://api.github.com/users/klam-shop/orgs","repos_url":"https://api.github.com/users/klam-shop/repos","events_url":"https://api.github.com/users/klam-shop/events{/privacy}","received_events_url":"https://api.github.com/users/klam-shop/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-12T18:33:15Z","updated_at":"2022-04-12T18:33:15Z","author_association":"NONE","body":"Thanks for the quick response @stevenzwu! Do you have an idea of when the FLIP-27 source will be completed?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1097057876/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1097096902","html_url":"https://github.com/apache/iceberg/pull/4503#issuecomment-1097096902","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4503","id":1097096902,"node_id":"IC_kwDOCW7NX85BZF7G","user":{"login":"bijanhoule","id":7012524,"node_id":"MDQ6VXNlcjcwMTI1MjQ=","avatar_url":"https://avatars.githubusercontent.com/u/7012524?v=4","gravatar_id":"","url":"https://api.github.com/users/bijanhoule","html_url":"https://github.com/bijanhoule","followers_url":"https://api.github.com/users/bijanhoule/followers","following_url":"https://api.github.com/users/bijanhoule/following{/other_user}","gists_url":"https://api.github.com/users/bijanhoule/gists{/gist_id}","starred_url":"https://api.github.com/users/bijanhoule/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bijanhoule/subscriptions","organizations_url":"https://api.github.com/users/bijanhoule/orgs","repos_url":"https://api.github.com/users/bijanhoule/repos","events_url":"https://api.github.com/users/bijanhoule/events{/privacy}","received_events_url":"https://api.github.com/users/bijanhoule/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-12T18:51:30Z","updated_at":"2022-04-12T18:51:30Z","author_association":"CONTRIBUTOR","body":"Thanks for the feedback all!  I'll take another pass and adjust a few things:\r\n- move to the spark-specific api and use a dataset input rather than temp table\r\n- add support for `modified_time` and enforce `older_than`.  Originally the thought was to keep this out for simplicity, but I agree it's probably safer to just make it a requirement.\r\n- separate out test cases and add coverage for the above","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1097096902/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1097104830","html_url":"https://github.com/apache/iceberg/pull/4516#issuecomment-1097104830","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4516","id":1097104830,"node_id":"IC_kwDOCW7NX85BZH2-","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-12T19:00:30Z","updated_at":"2022-04-12T19:00:30Z","author_association":"COLLABORATOR","body":"Thanks @szlta for change and @rdblue for taking a look, let's work on the subsequent issue.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1097104830/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1097143217","html_url":"https://github.com/apache/iceberg/pull/2105#issuecomment-1097143217","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2105","id":1097143217,"node_id":"IC_kwDOCW7NX85BZROx","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-12T19:42:53Z","updated_at":"2022-04-12T19:42:53Z","author_association":"CONTRIBUTOR","body":"@klam-shop should be done before end of Q2. right now, main challenge is committers' review bandwidth.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1097143217/reactions","total_count":3,"+1":3,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1097345957","html_url":"https://github.com/apache/iceberg/pull/4544#issuecomment-1097345957","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4544","id":1097345957,"node_id":"IC_kwDOCW7NX85BaCul","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-12T23:21:17Z","updated_at":"2022-04-12T23:21:17Z","author_association":"CONTRIBUTOR","body":"Thanks, @samredai!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1097345957/reactions","total_count":2,"+1":1,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1097347336","html_url":"https://github.com/apache/iceberg/pull/4543#issuecomment-1097347336","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4543","id":1097347336,"node_id":"IC_kwDOCW7NX85BaDEI","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-12T23:22:20Z","updated_at":"2022-04-12T23:22:20Z","author_association":"CONTRIBUTOR","body":"Thanks, @findepi!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1097347336/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1097540857","html_url":"https://github.com/apache/iceberg/pull/4500#issuecomment-1097540857","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4500","id":1097540857,"node_id":"IC_kwDOCW7NX85BayT5","user":{"login":"rajarshisarkar","id":4561678,"node_id":"MDQ6VXNlcjQ1NjE2Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/4561678?v=4","gravatar_id":"","url":"https://api.github.com/users/rajarshisarkar","html_url":"https://github.com/rajarshisarkar","followers_url":"https://api.github.com/users/rajarshisarkar/followers","following_url":"https://api.github.com/users/rajarshisarkar/following{/other_user}","gists_url":"https://api.github.com/users/rajarshisarkar/gists{/gist_id}","starred_url":"https://api.github.com/users/rajarshisarkar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rajarshisarkar/subscriptions","organizations_url":"https://api.github.com/users/rajarshisarkar/orgs","repos_url":"https://api.github.com/users/rajarshisarkar/repos","events_url":"https://api.github.com/users/rajarshisarkar/events{/privacy}","received_events_url":"https://api.github.com/users/rajarshisarkar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-13T04:25:03Z","updated_at":"2022-04-13T04:25:03Z","author_association":"CONTRIBUTOR","body":"I have made changes to `OSSFileIO`, `S3FileIO`, `EcsFileIO`, and `GCSFileIO`. PR is ready for next round of review.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1097540857/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1097639833","html_url":"https://github.com/apache/iceberg/issues/4542#issuecomment-1097639833","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4542","id":1097639833,"node_id":"IC_kwDOCW7NX85BbKeZ","user":{"login":"ConeyLiu","id":12733256,"node_id":"MDQ6VXNlcjEyNzMzMjU2","avatar_url":"https://avatars.githubusercontent.com/u/12733256?v=4","gravatar_id":"","url":"https://api.github.com/users/ConeyLiu","html_url":"https://github.com/ConeyLiu","followers_url":"https://api.github.com/users/ConeyLiu/followers","following_url":"https://api.github.com/users/ConeyLiu/following{/other_user}","gists_url":"https://api.github.com/users/ConeyLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/ConeyLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ConeyLiu/subscriptions","organizations_url":"https://api.github.com/users/ConeyLiu/orgs","repos_url":"https://api.github.com/users/ConeyLiu/repos","events_url":"https://api.github.com/users/ConeyLiu/events{/privacy}","received_events_url":"https://api.github.com/users/ConeyLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-13T07:13:12Z","updated_at":"2022-04-13T07:13:12Z","author_association":"CONTRIBUTOR","body":"You should [add new column](https://iceberg.apache.org/docs/latest/spark-ddl/#alter-table--add-column) first.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1097639833/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1097663051","html_url":"https://github.com/apache/iceberg/issues/4542#issuecomment-1097663051","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4542","id":1097663051,"node_id":"IC_kwDOCW7NX85BbQJL","user":{"login":"vshinde-medacist","id":103242772,"node_id":"U_kgDOBidcFA","avatar_url":"https://avatars.githubusercontent.com/u/103242772?v=4","gravatar_id":"","url":"https://api.github.com/users/vshinde-medacist","html_url":"https://github.com/vshinde-medacist","followers_url":"https://api.github.com/users/vshinde-medacist/followers","following_url":"https://api.github.com/users/vshinde-medacist/following{/other_user}","gists_url":"https://api.github.com/users/vshinde-medacist/gists{/gist_id}","starred_url":"https://api.github.com/users/vshinde-medacist/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vshinde-medacist/subscriptions","organizations_url":"https://api.github.com/users/vshinde-medacist/orgs","repos_url":"https://api.github.com/users/vshinde-medacist/repos","events_url":"https://api.github.com/users/vshinde-medacist/events{/privacy}","received_events_url":"https://api.github.com/users/vshinde-medacist/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-13T07:40:52Z","updated_at":"2022-04-13T07:40:52Z","author_association":"NONE","body":"> You should [add new column](https://iceberg.apache.org/docs/latest/spark-ddl/#alter-table--add-column) first.\r\n\r\nThanks @ConeyLiu, let me test this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1097663051/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1097685801","html_url":"https://github.com/apache/iceberg/pull/4516#issuecomment-1097685801","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4516","id":1097685801,"node_id":"IC_kwDOCW7NX85BbVsp","user":{"login":"szlta","id":40628386,"node_id":"MDQ6VXNlcjQwNjI4Mzg2","avatar_url":"https://avatars.githubusercontent.com/u/40628386?v=4","gravatar_id":"","url":"https://api.github.com/users/szlta","html_url":"https://github.com/szlta","followers_url":"https://api.github.com/users/szlta/followers","following_url":"https://api.github.com/users/szlta/following{/other_user}","gists_url":"https://api.github.com/users/szlta/gists{/gist_id}","starred_url":"https://api.github.com/users/szlta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szlta/subscriptions","organizations_url":"https://api.github.com/users/szlta/orgs","repos_url":"https://api.github.com/users/szlta/repos","events_url":"https://api.github.com/users/szlta/events{/privacy}","received_events_url":"https://api.github.com/users/szlta/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-13T08:06:59Z","updated_at":"2022-04-13T08:06:59Z","author_association":"CONTRIBUTOR","body":"Thanks a lot for the review @szehon-ho and @rdblue ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1097685801/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1097799907","html_url":"https://github.com/apache/iceberg/issues/4549#issuecomment-1097799907","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4549","id":1097799907,"node_id":"IC_kwDOCW7NX85Bbxjj","user":{"login":"rajarshisarkar","id":4561678,"node_id":"MDQ6VXNlcjQ1NjE2Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/4561678?v=4","gravatar_id":"","url":"https://api.github.com/users/rajarshisarkar","html_url":"https://github.com/rajarshisarkar","followers_url":"https://api.github.com/users/rajarshisarkar/followers","following_url":"https://api.github.com/users/rajarshisarkar/following{/other_user}","gists_url":"https://api.github.com/users/rajarshisarkar/gists{/gist_id}","starred_url":"https://api.github.com/users/rajarshisarkar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rajarshisarkar/subscriptions","organizations_url":"https://api.github.com/users/rajarshisarkar/orgs","repos_url":"https://api.github.com/users/rajarshisarkar/repos","events_url":"https://api.github.com/users/rajarshisarkar/events{/privacy}","received_events_url":"https://api.github.com/users/rajarshisarkar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-13T09:30:54Z","updated_at":"2022-04-13T09:30:54Z","author_association":"CONTRIBUTOR","body":"Hi, please refer: https://aws.amazon.com/premiumsupport/knowledge-center/athena-hive-metastore-error/","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1097799907/reactions","total_count":8,"+1":1,"-1":7,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1097823775","html_url":"https://github.com/apache/iceberg/issues/3636#issuecomment-1097823775","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3636","id":1097823775,"node_id":"IC_kwDOCW7NX85Bb3Yf","user":{"login":"ubyyj","id":12639959,"node_id":"MDQ6VXNlcjEyNjM5OTU5","avatar_url":"https://avatars.githubusercontent.com/u/12639959?v=4","gravatar_id":"","url":"https://api.github.com/users/ubyyj","html_url":"https://github.com/ubyyj","followers_url":"https://api.github.com/users/ubyyj/followers","following_url":"https://api.github.com/users/ubyyj/following{/other_user}","gists_url":"https://api.github.com/users/ubyyj/gists{/gist_id}","starred_url":"https://api.github.com/users/ubyyj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ubyyj/subscriptions","organizations_url":"https://api.github.com/users/ubyyj/orgs","repos_url":"https://api.github.com/users/ubyyj/repos","events_url":"https://api.github.com/users/ubyyj/events{/privacy}","received_events_url":"https://api.github.com/users/ubyyj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-13T09:43:41Z","updated_at":"2022-04-14T05:04:25Z","author_association":"NONE","body":"I believe it happens because there was too many open files and close them too late.\r\nTo work around the issue, you can control the thread pool size as below:\r\nwhen start spark sql\r\n`--conf \"spark.executor.extraJavaOptions=-Diceberg.worker.num-threads=1\" --conf \"spark.driver.extraJavaOptions=-Diceberg.worker.num-threads=1\"`\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1097823775/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1098007657","html_url":"https://github.com/apache/iceberg/pull/4537#issuecomment-1098007657","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4537","id":1098007657,"node_id":"IC_kwDOCW7NX85BckRp","user":{"login":"findepi","id":144328,"node_id":"MDQ6VXNlcjE0NDMyOA==","avatar_url":"https://avatars.githubusercontent.com/u/144328?v=4","gravatar_id":"","url":"https://api.github.com/users/findepi","html_url":"https://github.com/findepi","followers_url":"https://api.github.com/users/findepi/followers","following_url":"https://api.github.com/users/findepi/following{/other_user}","gists_url":"https://api.github.com/users/findepi/gists{/gist_id}","starred_url":"https://api.github.com/users/findepi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/findepi/subscriptions","organizations_url":"https://api.github.com/users/findepi/orgs","repos_url":"https://api.github.com/users/findepi/repos","events_url":"https://api.github.com/users/findepi/events{/privacy}","received_events_url":"https://api.github.com/users/findepi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-13T12:45:28Z","updated_at":"2022-04-13T12:45:28Z","author_association":"MEMBER","body":"@rdblue i applied most of the comments (no more `jackson-datatype-jdk8`, json-related annotations, `get` in accessor names). I also switched over from base16-encoded test \"fixtures\" to test resources.\r\n\r\nI switched writing to use `ByteBuffer`, this removes removed data copying upon compression.\r\nThis is as a fixup for now. Please let me know if you want me to use `ByteBuffer` in the reader/writer APIs as well?\r\nIt seems `byte[]` works there well (eg because uncompressed size is known, so no need to re-allocation), so please confirm before I apply further changes.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1098007657/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1098274889","html_url":"https://github.com/apache/iceberg/pull/4537#issuecomment-1098274889","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4537","id":1098274889,"node_id":"IC_kwDOCW7NX85BdlhJ","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-13T16:52:35Z","updated_at":"2022-04-13T16:52:35Z","author_association":"CONTRIBUTOR","body":"@findepi, I would prefer to use `ByteBuffer` everywhere. If the backing buffer was easy to allocate and work with, that's great. But you're not forced to reallocate if it is not.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1098274889/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1098345892","html_url":"https://github.com/apache/iceberg/pull/4553#issuecomment-1098345892","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4553","id":1098345892,"node_id":"IC_kwDOCW7NX85Bd22k","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-13T18:15:43Z","updated_at":"2022-04-13T18:15:43Z","author_association":"CONTRIBUTOR","body":"The following one test, `org.apache.iceberg.flink.TestChangeLogTable#testChangeLogOnDataKey` (both partitioned and unpartitioned) is failing. It _does_ relate somewhat to updated parts of the code (marked by the comment `// UPDATE`).\r\n\r\nIn this test, the primary key fo the changelog table is the same as the partition schema (vs a subset).\r\n\r\n```\r\norg.apache.iceberg.flink.TestChangeLogTable > testChangeLogOnDataKey[PartitionedTable=true] FAILED\r\n    java.lang.AssertionError: Should have the expected records for the checkpoint#2 expected:<[Record(1, aaa), Record(2, ccc), Record(2, aaa), Record(1, ccc)]> but was:<[Record(1, aaa), Record(2, bbb), Record(2, ccc), Record(2, aaa), Record(1, bbb, 1, false), Record(1, ccc)]>\r\n        at org.junit.Assert.fail(Assert.java:89)\r\n        at org.junit.Assert.failNotEquals(Assert.java:835)\r\n        at org.junit.Assert.assertEquals(Assert.java:120)\r\n        at org.apache.iceberg.flink.TestChangeLogTable.testSqlChangeLog(TestChangeLogTable.java:285)\r\n        at org.apache.iceberg.flink.TestChangeLogTable.testChangeLogOnDataKey(TestChangeLogTable.java:167)\r\n\r\norg.apache.iceberg.flink.TestChangeLogTable > testChangeLogOnDataKey[PartitionedTable=false] FAILED\r\n    java.lang.AssertionError: Should have the expected records for the checkpoint#2 expected:<[Record(1, aaa), Record(2, ccc), Record(2, aaa), Record(1, ccc)]> but was:<[Record(1, aaa), Record(2, bbb), Record(2, ccc), Record(2, aaa), Record(1, bbb, 2, false), Record(1, ccc)]>\r\n        at org.junit.Assert.fail(Assert.java:89)\r\n        at org.junit.Assert.failNotEquals(Assert.java:835)\r\n        at org.junit.Assert.assertEquals(Assert.java:120)\r\n        at org.apache.iceberg.flink.TestChangeLogTable.testSqlChangeLog(TestChangeLogTable.java:285)\r\n        at org.apache.iceberg.flink.TestChangeLogTable.testChangeLogOnDataKey(TestChangeLogTable.java:167)\r\n```\r\n\r\ncc @yittg as you recently spent time digging into the `TestFlinkUpsert` tests, which are related. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1098345892/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]