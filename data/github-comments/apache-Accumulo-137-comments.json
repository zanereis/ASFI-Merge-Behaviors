[{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2183564180","html_url":"https://github.com/apache/accumulo/pull/4690#issuecomment-2183564180","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4690","id":2183564180,"node_id":"IC_kwDOACaFSM6CJouU","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-21T23:04:56Z","updated_at":"2024-06-21T23:04:56Z","author_association":"CONTRIBUTOR","body":"I'm hoping everything is correct now, there were a few test failures from the full IT run that showed that a couple of extra fixes/changes needed to be back ported as well such as excluding all Accumulo namespace tables from scans by a scan server and also from the memory detection check. I will keep an eye on the full IT build and check back if all the failures are now resolved. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2183564180/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2184017851","html_url":"https://github.com/apache/accumulo/issues/4687#issuecomment-2184017851","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4687","id":2184017851,"node_id":"IC_kwDOACaFSM6CLXe7","user":{"login":"EdColeman","id":7047700,"node_id":"MDQ6VXNlcjcwNDc3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/7047700?v=4","gravatar_id":"","url":"https://api.github.com/users/EdColeman","html_url":"https://github.com/EdColeman","followers_url":"https://api.github.com/users/EdColeman/followers","following_url":"https://api.github.com/users/EdColeman/following{/other_user}","gists_url":"https://api.github.com/users/EdColeman/gists{/gist_id}","starred_url":"https://api.github.com/users/EdColeman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdColeman/subscriptions","organizations_url":"https://api.github.com/users/EdColeman/orgs","repos_url":"https://api.github.com/users/EdColeman/repos","events_url":"https://api.github.com/users/EdColeman/events{/privacy}","received_events_url":"https://api.github.com/users/EdColeman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-22T12:39:55Z","updated_at":"2024-06-22T12:39:55Z","author_association":"CONTRIBUTOR","body":"If run on a schedule, and similar to FATEs, there could be some simple metrics - maybe error count and run-time would be enough.  A non-zero error count could then be used to prompt / alert to investigate further.  The run time could allow for trending over time as a proxy for a performance measurement of the subsystems that are used in the check(s)  \r\n\r\nMetrics for timing sub-system checks would could add more fidelity if there are some discrete subsystems that are being used.  (time to scan fate table, time to scan metadata table ...)","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2184017851/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2184027667","html_url":"https://github.com/apache/accumulo/pull/4690#issuecomment-2184027667","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4690","id":2184027667,"node_id":"IC_kwDOACaFSM6CLZ4T","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-22T13:11:03Z","updated_at":"2024-06-22T13:11:03Z","author_association":"CONTRIBUTOR","body":"Everything looks good in main now, full IT build passed.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2184027667/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2184030173","html_url":"https://github.com/apache/accumulo/issues/4664#issuecomment-2184030173","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4664","id":2184030173,"node_id":"IC_kwDOACaFSM6CLafd","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-22T13:21:01Z","updated_at":"2024-06-22T13:21:24Z","author_association":"CONTRIBUTOR","body":"i'm researching this now and so far async thrift may not be a great option. Besides the extremely poor documentation (non-existent) I have found some blog posts that make it sound like it's not truly async and that a thread is still used per RPC call. I'm not sure if this is true or not until I dive more into the code as there's literally no information anywhere about async thrift. The lack of information also makes me a bit skeptical about using it because it probably means no one else is and there could be bugs that haven't been worked out.\r\n\r\nI have a few ideas that I am thinking through and and can list them here when I finish researching. This may end up in a situation where we need a different solution than Thrift for this use case depending on how the async code looks.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2184030173/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2184123313","html_url":"https://github.com/apache/accumulo/issues/4664#issuecomment-2184123313","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4664","id":2184123313,"node_id":"IC_kwDOACaFSM6CLxOx","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-22T17:34:17Z","updated_at":"2024-06-22T17:34:17Z","author_association":"CONTRIBUTOR","body":"I looked into this quite a bit today to see if async thrift may work. We have a lot of custom code for Thrift and we currently [disallow](https://github.com/apache/accumulo/blob/fc309ccd6de99e95520f0ffdfd445bc1b97fe261/server/base/src/main/java/org/apache/accumulo/server/rpc/CustomNonBlockingServer.java#L103) Async thrift processors. The processors are generated but we are not using it anywhere. It would take some work to try things out and I think we would need to stand up another server as there is an open issue that mentions multiplex processors not working. I don't think Async thrift is the best approach to try because of the lack of documentation and support and other issues.\r\n\r\nI talked offline to @keith-turner a bit about this and it seems like gRPC might be a good alternate to try as a trial as noted in a previous comment. gRPC supports async and streaming RPC so it looks like it would work. A compactor could send in the request and the server could offload and wait to complete the [StreamObserver](https://grpc.github.io/grpc-java/javadoc/io/grpc/stub/StreamObserver.html) that comes in until there is a new job available. CompleteableFuture could likely be used here to make the code easier to manage (I will let @keith-turner comment on this). By doing this we could handle a lot of requests and they would not be taking up threads while waiting.\r\n\r\nI also had a few other alternate ideas:\r\n\r\n1) We could create create an http REST endpoint using Jetty for this and use the Async servlet API. It would be easy to have a simple endpoint for the compactors to hit and the server can offload the async request until a job is available and then respond. The main drawback is having to stand up a new http service separate from everything else, similar to gRPC. However with gRPC that could potentially be re-used in the future for other services where as we would not want to use REST for some things (like scans)\r\n\r\n2) We could redesign things entirely to use an embedded broker in the coordinator (such as Apache ActiveMQ or Artemis). We could create one or more queues for compaction jobs, the compactors could subscribe to the queue and the coordinator would publish jobs to the queue. The compactor consumers would need to configure a prefetch setting of 1 so that only 1 job is sent at a time so that it won't receive another until ready. This would work well but the drawback is having to configure a broker and having to do a lot of refactoring to the current architecture. It would be quite a big overhaul to how things work today.\r\n\r\n3) We could invert things so the coordinator keeps track of free compactors and just sends a message to a free server with a job vs the compactors trying to query. This seems like it may not work well because things would get out of sync and add complexity to the coordinator.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2184123313/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2184134362","html_url":"https://github.com/apache/accumulo/issues/4692#issuecomment-2184134362","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4692","id":2184134362,"node_id":"IC_kwDOACaFSM6CLz7a","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-22T18:07:05Z","updated_at":"2024-06-22T18:07:05Z","author_association":"CONTRIBUTOR","body":"There seems to be some existing code that creates the fate table in upgrade.  However it does not seem to do everything the init code does like set some initial table properties.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2184134362/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2184135099","html_url":"https://github.com/apache/accumulo/issues/4652#issuecomment-2184135099","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4652","id":2184135099,"node_id":"IC_kwDOACaFSM6CL0G7","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-22T18:09:23Z","updated_at":"2024-06-22T18:09:23Z","author_association":"CONTRIBUTOR","body":"#4692 is related.  Both of these will need to create new tables in upgrade, ideally they can share code as much as possible when doing this.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2184135099/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2184138522","html_url":"https://github.com/apache/accumulo/issues/4692#issuecomment-2184138522","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4692","id":2184138522,"node_id":"IC_kwDOACaFSM6CL08a","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-22T18:19:23Z","updated_at":"2024-06-22T18:20:08Z","author_association":"CONTRIBUTOR","body":"The following is some code that I found that init runs, but could not find upgrade running. Possible I missed something.\r\n\r\nhttps://github.com/apache/accumulo/blob/46d8c0b71deb4e7287eff0158e7014247f929ae2/server/base/src/main/java/org/apache/accumulo/server/init/FileSystemInitializer.java#L179","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2184138522/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2184144460","html_url":"https://github.com/apache/accumulo/issues/4684#issuecomment-2184144460","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4684","id":2184144460,"node_id":"IC_kwDOACaFSM6CL2ZM","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-22T18:27:04Z","updated_at":"2024-06-22T18:27:04Z","author_association":"CONTRIBUTOR","body":"I am not super familiar with the code for caching but it looks like the entire cache is invalidated on changes. \r\n\r\nWould it be possible to user an observer and just have Zookeeper send notifications when the node changes for the table name/id? The cache could get updates for table creation and deletions.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2184144460/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2184153842","html_url":"https://github.com/apache/accumulo/issues/4687#issuecomment-2184153842","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4687","id":2184153842,"node_id":"IC_kwDOACaFSM6CL4ry","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-22T18:52:03Z","updated_at":"2024-06-22T18:52:03Z","author_association":"CONTRIBUTOR","body":">  I could also see this command expanding with a few flags to make it more powerful such as being able to define which things to check\r\n\r\nI suspect that would be needed because some checks will take a bit of time to run. If someone wants to run a specific check then they may not want to wait on everything to run.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2184153842/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2184169539","html_url":"https://github.com/apache/accumulo/issues/4684#issuecomment-2184169539","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4684","id":2184169539,"node_id":"IC_kwDOACaFSM6CL8hD","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-22T19:53:21Z","updated_at":"2024-06-22T19:55:13Z","author_association":"CONTRIBUTOR","body":"> Would it be possible to user an observer and just have Zookeeper send notifications when the node changes for the table name/id? The cache could get updates for table creation and deletions.\r\n\r\nDiscussed this with @cshannon offline.  Suspect writing would need custom ZK code to keep the cache up to date.  The goal is to have a `Map<TableName, TableId>` however in ZK we have `Map<TableId, TableName>` .  With enough custome observers may be able to keep the  `Map<TableName, TableId>`  up to date based on changes in ZK. \r\n\r\nAn alternative approach may be to create `Map<TableName, TableId>` in zookeeper as an index conceptually.  This would make the accumulo client code super simple as it could use zoocache for the  `Map<TableName, TableId>` stored in zookeeper.  The only problem is this index in ZK needs to be kept consistent.  The consistency may not be a problem though because all table operations like create, import, clone, rename, and delete that would need to update this   `Map<TableName, TableId>` index in zk already run as fate operations.  So the updates to this index could easily be done via fate.  If the code added to fate is simple then a lot of complex client code could be removed and it may result in a net simplification of the code base, not sure though. This would probably not be a change for 2.1.x initially.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2184169539/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2184174884","html_url":"https://github.com/apache/accumulo/issues/4684#issuecomment-2184174884","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4684","id":2184174884,"node_id":"IC_kwDOACaFSM6CL90k","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-22T20:08:14Z","updated_at":"2024-06-22T20:08:14Z","author_association":"CONTRIBUTOR","body":"Looking into how the fate operations work currently they call `Utils.getTableNameLock().lock()` to ensure only a single fate operation does anything with table names.  If we ever allow fate operations to run on multiple processes, then this would not work very well as this lock assumes only one process runs fate operations at a time.  If `Map<TableName, TableId>` exist in zookeeper, then we could possibly remove the need for  `Utils.getTableNameLock().lock()`  and use the ability to have atomic operations on the `Map<TableName, TableId>`  in zookeeper to ensure that two tables are not created with the same name concurrently.  So there may be an additional benefit to having `Map<TableName, TableId>`  in zookeeper.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2184174884/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2184256693","html_url":"https://github.com/apache/accumulo/issues/4664#issuecomment-2184256693","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4664","id":2184256693,"node_id":"IC_kwDOACaFSM6CMRy1","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-23T00:03:48Z","updated_at":"2024-06-23T00:09:10Z","author_association":"CONTRIBUTOR","body":"> CompleteableFuture could likely be used here to make the code easier to manage (I will let @keith-turner comment on this).\r\n\r\nIf we add the the following to CompactionJobQueues\r\n\r\n```java\r\n  public CompletableFuture<MetaJob> getAsync(CompactorGroupId groupId) {\r\n    // TODO implement\r\n    throw new UnsupportedOperationException();\r\n  }\r\n```\r\n\r\nthen hoping if we can get an async way to handle job request RPC that the following could be done in CompactionCoordinator\r\n\r\n```java\r\n  /**\r\n   * Process an RPC from a compactor to get a compaction job asynchronously.\r\n   * \r\n   * @param callback a RPC callback that will send the compaction job back to the compactor\r\n   */\r\n  public void getCompactionJob(String groupName, String compactorAddress,\r\n      String externalCompactionId, Consumer<TExternalCompactionJob> callback) {\r\n    CompactorGroupId groupId = CompactorGroupId.of(groupName);\r\n    CompletableFuture<CompactionJobQueues.MetaJob> future = jobQueues.getAsync(groupId);\r\n    // TODO if nothing is done then the reservation and RPC callback will run in the thread that\r\n    // completes the future which would probably be a TGW thread. This is easy to remedy w/\r\n    // completable future\r\n    // TODO need to timeout and return nothing periodically, completablefuture has mechanism for\r\n    // this that need investigation to see if workable\r\n    future.thenApply(metaJob -> reserve(compactorAddress, externalCompactionId, metaJob))\r\n        .thenAccept(callback);\r\n  }\r\n\r\n  // this method comes from copying existing code in CompactionCoordinator to function\r\n  private TExternalCompactionJob reserve(String compactorAddress, String externalCompactionId,\r\n      CompactionJobQueues.MetaJob metaJob) {\r\n    // reserve the compaction job\r\n    Optional<CompactionConfig> compactionConfig = getCompactionConfig(metaJob);\r\n\r\n    // this method may reread the metadata, do not use the metadata in metaJob for anything after\r\n    // this method\r\n    CompactionMetadata ecm = null;\r\n\r\n    var kind = metaJob.getJob().getKind();\r\n\r\n    // Only reserve user compactions when the config is present. When compactions are canceled the\r\n    // config is deleted.\r\n    var cid = ExternalCompactionId.from(externalCompactionId);\r\n    if (kind == CompactionKind.SYSTEM\r\n        || (kind == CompactionKind.USER && compactionConfig.isPresent())) {\r\n      ecm = reserveCompaction(metaJob, compactorAddress, cid);\r\n    }\r\n\r\n    if (ecm != null) {\r\n      return createThriftJob(externalCompactionId, ecm, metaJob, compactionConfig);\r\n    } else {\r\n      return new TExternalCompactionJob();\r\n    }\r\n  }\r\n```\r\n\r\n ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2184256693/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2186492632","html_url":"https://github.com/apache/accumulo/issues/4684#issuecomment-2186492632","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4684","id":2186492632,"node_id":"IC_kwDOACaFSM6CUzrY","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-24T12:43:24Z","updated_at":"2024-06-24T12:43:24Z","author_association":"CONTRIBUTOR","body":"> If we ever allow fate operations to run on multiple processes, then this would not work very well as this lock assumes only one process runs fate operations at a time.\r\n\r\nIf the table path in ZooKeeper included the namespace, then you could just lock the namespace when creating, cloning, renaming, or importing a table to ensure table names are unique. This would also reduce your search space in ZooKeeper.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2186492632/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2186880375","html_url":"https://github.com/apache/accumulo/pull/3978#issuecomment-2186880375","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3978","id":2186880375,"node_id":"IC_kwDOACaFSM6CWSV3","user":{"login":"ddanielr","id":12480877,"node_id":"MDQ6VXNlcjEyNDgwODc3","avatar_url":"https://avatars.githubusercontent.com/u/12480877?v=4","gravatar_id":"","url":"https://api.github.com/users/ddanielr","html_url":"https://github.com/ddanielr","followers_url":"https://api.github.com/users/ddanielr/followers","following_url":"https://api.github.com/users/ddanielr/following{/other_user}","gists_url":"https://api.github.com/users/ddanielr/gists{/gist_id}","starred_url":"https://api.github.com/users/ddanielr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ddanielr/subscriptions","organizations_url":"https://api.github.com/users/ddanielr/orgs","repos_url":"https://api.github.com/users/ddanielr/repos","events_url":"https://api.github.com/users/ddanielr/events{/privacy}","received_events_url":"https://api.github.com/users/ddanielr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-24T15:45:03Z","updated_at":"2024-06-24T15:45:03Z","author_association":"CONTRIBUTOR","body":"Move this from 2.1.3 to 2.1.4 due to the possibility of new errors being thrown on server startup. \r\nOnce 2.1.3 is released, this can get merged into 2.1","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2186880375/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2187144520","html_url":"https://github.com/apache/accumulo/pull/4685#issuecomment-2187144520","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4685","id":2187144520,"node_id":"IC_kwDOACaFSM6CXS1I","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-24T18:15:18Z","updated_at":"2024-06-24T18:15:18Z","author_association":"CONTRIBUTOR","body":"Interesting, CreateTableIT ran in 173s in `main` and 155s in `elasticity`.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2187144520/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2187151506","html_url":"https://github.com/apache/accumulo/issues/4684#issuecomment-2187151506","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4684","id":2187151506,"node_id":"IC_kwDOACaFSM6CXUiS","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-24T18:19:56Z","updated_at":"2024-06-24T18:19:56Z","author_association":"CONTRIBUTOR","body":"#4685 is merged and I think is a sufficient improvement for the 2.1.3 patch release. I'm going to close this, unless there are any objections.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2187151506/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2187323096","html_url":"https://github.com/apache/accumulo/pull/4683#issuecomment-2187323096","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4683","id":2187323096,"node_id":"IC_kwDOACaFSM6CX-bY","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-24T20:11:50Z","updated_at":"2024-06-24T20:11:50Z","author_association":"MEMBER","body":"From https://github.com/apache/accumulo/pull/4688, `MetaFateStore.FateTxStoreImpl.top()` was changed to no longer throw a NNE and instead return null. I checked to see if any of the other methods called in the try-catch block of `getTransactionStatus()` could throw a NNE and they do not. `top()` was the only method that did not handle and threw the NNE if encountered. So, the original issue of a NNE exception occurring in `getTransactionStatus()` causing the print/summary commands to fail is no longer a problem in elasticity (from what I can tell). So, now the check for a NNE exception in `getTransactionStatus()` is unneccessary but doesn't hurt to keep in case of future changes to `MetaFateStore.FateTxStoreImpl` resulting in these methods throwing a NNE. For `testFatePrintAndSummaryCommandsWithInProgressTxns()`, I mock that the NNE can occur in the try-catch block (even though this won't happen in the current implementation) and ensure that it is properly handled.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2187323096/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2187389020","html_url":"https://github.com/apache/accumulo/issues/4684#issuecomment-2187389020","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4684","id":2187389020,"node_id":"IC_kwDOACaFSM6CYOhc","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-24T20:56:59Z","updated_at":"2024-06-24T20:56:59Z","author_association":"CONTRIBUTOR","body":"> https://github.com/apache/accumulo/pull/4685 is merged and I think is a sufficient improvement for the 2.1.3 patch release. I'm going to close this, unless there are any objections.\r\n\r\nI opened an issue about creating an index in zookeeper for mapping table names to table ids.  That seems to have multiple benefits and was something discussed related to this issue, but no need to keep this issue open for that.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2187389020/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2187458685","html_url":"https://github.com/apache/accumulo/issues/4684#issuecomment-2187458685","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4684","id":2187458685,"node_id":"IC_kwDOACaFSM6CYfh9","user":{"login":"elahrvivaz","id":7715322,"node_id":"MDQ6VXNlcjc3MTUzMjI=","avatar_url":"https://avatars.githubusercontent.com/u/7715322?v=4","gravatar_id":"","url":"https://api.github.com/users/elahrvivaz","html_url":"https://github.com/elahrvivaz","followers_url":"https://api.github.com/users/elahrvivaz/followers","following_url":"https://api.github.com/users/elahrvivaz/following{/other_user}","gists_url":"https://api.github.com/users/elahrvivaz/gists{/gist_id}","starred_url":"https://api.github.com/users/elahrvivaz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elahrvivaz/subscriptions","organizations_url":"https://api.github.com/users/elahrvivaz/orgs","repos_url":"https://api.github.com/users/elahrvivaz/repos","events_url":"https://api.github.com/users/elahrvivaz/events{/privacy}","received_events_url":"https://api.github.com/users/elahrvivaz/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-24T21:41:44Z","updated_at":"2024-06-24T21:41:44Z","author_association":"NONE","body":"thanks for the quick turn-around!","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2187458685/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2187560469","html_url":"https://github.com/apache/accumulo/pull/4697#issuecomment-2187560469","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4697","id":2187560469,"node_id":"IC_kwDOACaFSM6CY4YV","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-24T22:54:01Z","updated_at":"2024-06-24T22:54:01Z","author_association":"CONTRIBUTOR","body":"> I did some crude benchmarking using SplitMillionIT and saw a decrease in time taken per 10,000 splits in the test. Per 10,000 splits, over 5 runs I saw an average time of 827.8ms on elasticity and 822.4ms on this branch. This difference seems negligible but I at least did not notice a performance decrease.\r\n\r\nFor SplitMillionIT it is adding splits in order so it always splits the last tablet in the table.  So its only ever splitting a single a tablet at a time, so should not see much difference for that case.  Wrote the test below and  saw big time differences for it.  This test creates a lot of tablets, waits for them to be hosted, then splits many of the tablets.  For this scenario, lots of tablets need to be unassigned inorder to split.  Included time I saw after the test code.\r\n\r\n\r\n```java\r\npublic class SpliRandomIT extends ConfigurableMacBase {\r\n\r\n  private static final Logger log = LoggerFactory.getLogger(SpliRandomIT.class);\r\n\r\n  @Override\r\n  public void configure(MiniAccumuloConfigImpl cfg, Configuration hadoopCoreSite) {\r\n    cfg.setMemory(ServerType.MANAGER, 1, MemoryUnit.GIGABYTE);\r\n    cfg.setMemory(ServerType.TABLET_SERVER, 1, MemoryUnit.GIGABYTE);\r\n    cfg.setProperty(Property.MANAGER_FATE_THREADPOOL_SIZE, \"64\");\r\n  }\r\n\r\n  @SuppressFBWarnings(value = {\"PREDICTABLE_RANDOM\", \"DMI_RANDOM_USED_ONLY_ONCE\"},\r\n      justification = \"predictable random is ok for testing\")\r\n  @Test\r\n  public void testRandom() throws Exception {\r\n\r\n    try (AccumuloClient c = Accumulo.newClient().from(getClientProperties()).build()) {\r\n      String tableName = getUniqueNames(1)[0];\r\n\r\n      Random rand = new Random();\r\n      var ntc = new NewTableConfiguration().withInitialTabletAvailability(TabletAvailability.HOSTED)\r\n          .withSplits(createSplits(rand, 1000));\r\n      c.tableOperations().create(tableName, ntc);\r\n\r\n      // wait for all 1000 tablets to be assigned, split will have to get them unassigned\r\n      Wait.waitFor(() -> countLocationless(c, tableName) == 0);\r\n\r\n      addSplits(c, tableName, createSplits(rand, 1000));\r\n\r\n      Wait.waitFor(() -> countLocationless(c, tableName) == 0);\r\n\r\n      addSplits(c, tableName, createSplits(rand, 1000));\r\n    }\r\n  }\r\n\r\n  private static SortedSet<Text> createSplits(Random random, int num) {\r\n    return random.longs().limit(num).mapToObj(l -> String.format(\"%016x\", l)).map(Text::new)\r\n        .collect(Collectors.toCollection(TreeSet::new));\r\n  }\r\n\r\n  private static void addSplits(AccumuloClient c, String tableName, SortedSet<Text> splits)\r\n      throws Exception {\r\n    long t1 = System.currentTimeMillis();\r\n    c.tableOperations().addSplits(tableName, splits);\r\n    long t2 = System.currentTimeMillis();\r\n    log.info(\"Added {} splits in {}ms\", splits.size(), t2 - t1);\r\n  }\r\n\r\n  private long countLocationless(AccumuloClient c, String tableName) throws Exception {\r\n    return c.tableOperations().getTabletInformation(tableName, new Range())\r\n        .filter(ti -> ti.getLocation().isEmpty()).count();\r\n  }\r\n}\r\n\r\n```\r\n\r\nWithout the change in this PR, saw the following times for the test above.\r\n\r\n```\r\n2024-06-24T18:41:32,787 35 [functional.SpliRandomIT] INFO : Added 1000 splits in 37640ms\r\n2024-06-24T18:42:23,246 35 [functional.SpliRandomIT] INFO : Added 1000 splits in 50408ms\r\n```\r\n\r\nwith the changes in this PR, saw the times below.\r\n\r\n```\r\n2024-06-24T18:32:11,098 35 [admin.TableOperations] INFO : time to seed 518 14615ms\r\n2024-06-24T18:32:12,599 35 [functional.SpliRandomIT] INFO : Added 1000 splits in 16209ms\r\n2024-06-24T18:32:20,655 35 [admin.TableOperations] INFO : time to seed 654 7953ms\r\n2024-06-24T18:32:22,538 35 [functional.SpliRandomIT] INFO : Added 1000 splits in 9877ms\r\n```\r\n\r\nThe `time to seed` log message comes from making the following change.\r\n\r\n```diff\r\ndiff --git a/core/src/main/java/org/apache/accumulo/core/clientImpl/TableOperationsImpl.java b/core/src/main/java/org/apache/accumulo/core/clientImpl/TableOperationsImpl.java\r\nindex 213e8ba291..62ceb4b618 100644\r\n--- a/core/src/main/java/org/apache/accumulo/core/clientImpl/TableOperationsImpl.java\r\n+++ b/core/src/main/java/org/apache/accumulo/core/clientImpl/TableOperationsImpl.java\r\n@@ -162,6 +162,7 @@ import org.apache.accumulo.core.util.OpTimer;\r\n import org.apache.accumulo.core.util.Pair;\r\n import org.apache.accumulo.core.util.Retry;\r\n import org.apache.accumulo.core.util.TextUtil;\r\n+import org.apache.accumulo.core.util.time.NanoTime;\r\n import org.apache.accumulo.core.volume.VolumeConfiguration;\r\n import org.apache.hadoop.fs.FileStatus;\r\n import org.apache.hadoop.fs.FileSystem;\r\n@@ -498,6 +499,7 @@ public class TableOperationsImpl extends TableOperationsHelper {\r\n       final ByteBuffer EMPTY = ByteBuffer.allocate(0);\r\n \r\n       // begin the fate operation for each tablet without waiting for the operation to complete\r\n+      var start = NanoTime.now();\r\n       for (Entry<KeyExtent,List<Text>> splitsForTablet : tabletSplits.entrySet()) {\r\n         var extent = splitsForTablet.getKey();\r\n \r\n@@ -519,6 +521,7 @@ public class TableOperationsImpl extends TableOperationsHelper {\r\n           throw new RuntimeException(e);\r\n         }\r\n       }\r\n+      log.info(\"time to seed {} {}ms\", tabletSplits.size(), start.elapsed().toMillis());\r\n \r\n       // after all operations have been started, wait for them to complete\r\n       for (Pair<TFateId,List<Text>> entry : opids) {\r\n```\r\n\r\nThe times from  `time to seed` suggest we could still benefit from using a thread pool for the RPCs to seed the fate operations.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2187560469/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2187652119","html_url":"https://github.com/apache/accumulo/pull/4685#issuecomment-2187652119","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4685","id":2187652119,"node_id":"IC_kwDOACaFSM6CZOwX","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-24T23:57:18Z","updated_at":"2024-06-24T23:57:18Z","author_association":"CONTRIBUTOR","body":"> Interesting, CreateTableIT ran in 173s in main and 155s in elasticity.\r\n\r\nMaybe its some of the fate changes made in elasticity.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2187652119/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2189114678","html_url":"https://github.com/apache/accumulo/pull/4685#issuecomment-2189114678","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4685","id":2189114678,"node_id":"IC_kwDOACaFSM6Cez02","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-25T14:25:49Z","updated_at":"2024-06-25T14:25:49Z","author_association":"CONTRIBUTOR","body":"CreateTableIT times out in the `2.1` IT builds, but not for `main` or `elasticity`.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2189114678/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2189405268","html_url":"https://github.com/apache/accumulo/pull/4683#issuecomment-2189405268","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4683","id":2189405268,"node_id":"IC_kwDOACaFSM6Cf6xU","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-25T16:26:29Z","updated_at":"2024-06-25T16:26:29Z","author_association":"CONTRIBUTOR","body":"From a tech debt perspective it may be best to remove the handling of NoNodeException from AdminUtil since its not expected to happen now.  Having the handling for NoNodeException may cause someone to spend time carrying it forward when refactoring AdminUtil, which would be uneeded work.  If we remove the handling for NNE, not sure there is anything to test.  We have the test for the fate stores to verify they handle the non-existent case in a uniform way.  It would probably be good to put those expectations in the javadoc on the fate store interfaces, but that is not something for this PR.  Wondering if this PR should be abandoned or changed to remove the NNE handling.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2189405268/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2189409954","html_url":"https://github.com/apache/accumulo/pull/4683#issuecomment-2189409954","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4683","id":2189409954,"node_id":"IC_kwDOACaFSM6Cf76i","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-25T16:28:57Z","updated_at":"2024-06-25T16:33:15Z","author_association":"CONTRIBUTOR","body":"Maybe there is something to test for these changes still if NNE handling is removed.  We want to test that admin util handles the case of something showing up in list and then no longer existing when its accessed.  Just want to ensure that admin util code does not fail in that case or report junk.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2189409954/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2189426456","html_url":"https://github.com/apache/accumulo/pull/4697#issuecomment-2189426456","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4697","id":2189426456,"node_id":"IC_kwDOACaFSM6Cf_8Y","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-25T16:37:20Z","updated_at":"2024-06-25T16:37:20Z","author_association":"MEMBER","body":"Since this is approved and is an improvement on its own ill merge this in and make a follow on PR to add the other suggested optimization.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2189426456/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2189428392","html_url":"https://github.com/apache/accumulo/pull/4695#issuecomment-2189428392","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4695","id":2189428392,"node_id":"IC_kwDOACaFSM6CgAao","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-25T16:38:21Z","updated_at":"2024-06-25T16:56:00Z","author_association":"CONTRIBUTOR","body":"> Wonder if attempting to identify a set of \"flapping\" tservers at the info level would be possible.\r\n\r\nI was pondering that too.  Thinking we can start with the trace logging as it has a low maintenance burden and if its not sufficient add something more complex later.  If needed, the trace logging may help inform a next step. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2189428392/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2189760925","html_url":"https://github.com/apache/accumulo/issues/4633#issuecomment-2189760925","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4633","id":2189760925,"node_id":"IC_kwDOACaFSM6ChRmd","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-25T19:02:35Z","updated_at":"2024-06-25T19:02:35Z","author_association":"MEMBER","body":"Closing as completed via #4697","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2189760925/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2189764050","html_url":"https://github.com/apache/accumulo/pull/4683#issuecomment-2189764050","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4683","id":2189764050,"node_id":"IC_kwDOACaFSM6ChSXS","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-25T19:03:57Z","updated_at":"2024-06-25T19:03:57Z","author_association":"MEMBER","body":"Yeah, I wasn't sure how I would test it after removal of the NNE handling in AdminUtil and wasn't sure if this handling would be better left in or removed. I have just removed the NNE handling in AdminUtil and reworked the test. Now, the test ensures AdminUtil.getTransactionStatus() functions as expected if there is a FateId returned from the list() command that doesn't exist. This simplified the test a lot too.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2189764050/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2191915161","html_url":"https://github.com/apache/accumulo/pull/4701#issuecomment-2191915161","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4701","id":2191915161,"node_id":"IC_kwDOACaFSM6CpfiZ","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-26T14:54:13Z","updated_at":"2024-06-26T14:54:13Z","author_association":"CONTRIBUTOR","body":"I also changed this code in #4703 ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2191915161/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2192212481","html_url":"https://github.com/apache/accumulo/pull/4702#issuecomment-2192212481","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4702","id":2192212481,"node_id":"IC_kwDOACaFSM6CqoIB","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-26T16:59:11Z","updated_at":"2024-06-26T16:59:11Z","author_association":"CONTRIBUTOR","body":"I need to target this change to the main branch instead of elasticity.  The IT exist there and I think the public APIs its using are the same in main, even though the impl is very different.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2192212481/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2192547772","html_url":"https://github.com/apache/accumulo/issues/4708#issuecomment-2192547772","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4708","id":2192547772,"node_id":"IC_kwDOACaFSM6Cr5-8","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-26T20:14:45Z","updated_at":"2024-06-26T20:14:45Z","author_association":"CONTRIBUTOR","body":"Noticed this bug by running ComprehensiveIT and looking at ClientContext coverage data using #4704.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2192547772/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2192548946","html_url":"https://github.com/apache/accumulo/issues/4708#issuecomment-2192548946","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4708","id":2192548946,"node_id":"IC_kwDOACaFSM6Cr6RS","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-26T20:15:27Z","updated_at":"2024-06-26T20:15:27Z","author_association":"CONTRIBUTOR","body":"This fix could be done 2.1.3, but it does not need to hold up 2.1.3 which is why I placed it in 2.1.4","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2192548946/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2192549848","html_url":"https://github.com/apache/accumulo/issues/4707#issuecomment-2192549848","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4707","id":2192549848,"node_id":"IC_kwDOACaFSM6Cr6fY","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-26T20:15:48Z","updated_at":"2024-06-26T20:48:45Z","author_association":"MEMBER","body":"Closing not actually a problem, missed the else branch at the end that will stopAll if the command is stopAll and just stop a single server otherwise. This execute method probably should still be cleaned up, and maybe a deprecation msg is missing from stopMaster, but will close this issue and open a new one if needed","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2192549848/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2192607736","html_url":"https://github.com/apache/accumulo/issues/4587#issuecomment-2192607736","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4587","id":2192607736,"node_id":"IC_kwDOACaFSM6CsIn4","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-26T20:51:56Z","updated_at":"2024-06-26T20:51:56Z","author_association":"CONTRIBUTOR","body":"We have issues open for some upgrade task.  Plan to do a survey of the code and see if any other issue need to be opened and find all of the issues that are currently open.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2192607736/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2192621256","html_url":"https://github.com/apache/accumulo/issues/4587#issuecomment-2192621256","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4587","id":2192621256,"node_id":"IC_kwDOACaFSM6CsL7I","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-26T21:02:05Z","updated_at":"2024-06-26T21:02:05Z","author_association":"CONTRIBUTOR","body":"Some of the issues currently open re upgrade are #4692, #4652, #4637, #4315.   For the survey of what may need to be done for upgrade, plan to look over what is currently done for upgrade, metadata schema changes, zookeeper schema changes, and prop changes.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2192621256/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2194799730","html_url":"https://github.com/apache/accumulo/pull/4711#issuecomment-2194799730","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4711","id":2194799730,"node_id":"IC_kwDOACaFSM6C0fxy","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-27T14:08:52Z","updated_at":"2024-06-27T14:08:52Z","author_association":"CONTRIBUTOR","body":"With these changes I believe all of the fate steps related to table operations will be run using FlakyFate in ITs.  There are some fate operations related to stopping tservers that may not be exercised using FlakyFate.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2194799730/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2195564535","html_url":"https://github.com/apache/accumulo/issues/4706#issuecomment-2195564535","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4706","id":2195564535,"node_id":"IC_kwDOACaFSM6C3af3","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-27T19:54:19Z","updated_at":"2024-06-27T19:54:19Z","author_association":"MEMBER","body":"I don't think Pair is public API either.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2195564535/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2195568895","html_url":"https://github.com/apache/accumulo/issues/4706#issuecomment-2195568895","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4706","id":2195568895,"node_id":"IC_kwDOACaFSM6C3bj_","user":{"login":"meatballspaghetti","id":69256191,"node_id":"MDQ6VXNlcjY5MjU2MTkx","avatar_url":"https://avatars.githubusercontent.com/u/69256191?v=4","gravatar_id":"","url":"https://api.github.com/users/meatballspaghetti","html_url":"https://github.com/meatballspaghetti","followers_url":"https://api.github.com/users/meatballspaghetti/followers","following_url":"https://api.github.com/users/meatballspaghetti/following{/other_user}","gists_url":"https://api.github.com/users/meatballspaghetti/gists{/gist_id}","starred_url":"https://api.github.com/users/meatballspaghetti/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/meatballspaghetti/subscriptions","organizations_url":"https://api.github.com/users/meatballspaghetti/orgs","repos_url":"https://api.github.com/users/meatballspaghetti/repos","events_url":"https://api.github.com/users/meatballspaghetti/events{/privacy}","received_events_url":"https://api.github.com/users/meatballspaghetti/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-27T19:57:17Z","updated_at":"2024-06-27T19:57:17Z","author_association":"CONTRIBUTOR","body":"I can look into this.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2195568895/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2195575912","html_url":"https://github.com/apache/accumulo/issues/4706#issuecomment-2195575912","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4706","id":2195575912,"node_id":"IC_kwDOACaFSM6C3dRo","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-27T20:02:04Z","updated_at":"2024-06-27T20:02:04Z","author_association":"CONTRIBUTOR","body":"> I don't think Pair is public API either.\r\n\r\nCorrect, Pair is not public API.  Currently this class is only used by test code.  The class could be moved out of public API into a test package.  Or the class could be deleted and replaced with something more generic because it only has two fields.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2195575912/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2195577371","html_url":"https://github.com/apache/accumulo/issues/4706#issuecomment-2195577371","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4706","id":2195577371,"node_id":"IC_kwDOACaFSM6C3dob","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-27T20:03:06Z","updated_at":"2024-06-27T20:03:06Z","author_association":"MEMBER","body":"Thanks @keith-turner . I think I misunderstood the ticket to mean that the public API needed to use Pair or Map.Entry. I now understand you meant that the test code that's using it could do that instead of this class.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2195577371/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2195595741","html_url":"https://github.com/apache/accumulo/issues/4706#issuecomment-2195595741","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4706","id":2195595741,"node_id":"IC_kwDOACaFSM6C3iHd","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-27T20:14:27Z","updated_at":"2024-06-27T20:14:27Z","author_association":"CONTRIBUTOR","body":"> I now understand you meant that the test code that's using it could do that instead of this class.\n\nYeah and I am uncertain about what is best for the test code because I only took a quick glance at it.  Not sure of the details of how the test code is using the class. So the suggestion to use Pair or Entry may not be a good one.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2195595741/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2195636277","html_url":"https://github.com/apache/accumulo/issues/4647#issuecomment-2195636277","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4647","id":2195636277,"node_id":"IC_kwDOACaFSM6C3sA1","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-27T20:44:13Z","updated_at":"2024-06-27T20:44:13Z","author_association":"MEMBER","body":"This issue can be closed: https://github.com/apache/accumulo/pull/4696\r\nWhile one of the above is not complete, that has it's own issue for it","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2195636277/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2195637622","html_url":"https://github.com/apache/accumulo/issues/4614#issuecomment-2195637622","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4614","id":2195637622,"node_id":"IC_kwDOACaFSM6C3sV2","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-27T20:45:16Z","updated_at":"2024-06-27T20:45:16Z","author_association":"MEMBER","body":"This issue can be closed: https://github.com/apache/accumulo/pull/4683","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2195637622/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2195704650","html_url":"https://github.com/apache/accumulo/pull/4712#issuecomment-2195704650","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4712","id":2195704650,"node_id":"IC_kwDOACaFSM6C38tK","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-27T21:38:45Z","updated_at":"2024-06-27T21:38:45Z","author_association":"CONTRIBUTOR","body":"For #4587 was reviewing what is outstanding for the elasticity upgrade I noticed these two unused zookeeper constants.  Seems they can be removed from ZK if they exist in the 3.1 upgrade.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2195704650/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2195790547","html_url":"https://github.com/apache/accumulo/issues/4587#issuecomment-2195790547","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4587","id":2195790547,"node_id":"IC_kwDOACaFSM6C4RrT","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-27T22:48:53Z","updated_at":"2024-06-27T22:49:24Z","author_association":"CONTRIBUTOR","body":"Compared the files Constants.java, MetadataSchema.java, and Property.java across  elasticity and main branches.  Analyzing  Constants.java resulted in opening #4712 and #4713.   Looking at MetadataSchema.java did not see anything to do, did notice #4637.\r\n\r\nLooking at Property.java the only table property that was removed was `table.compaction.selector`.  Wondering if we want to delete this if it exists on upgrade.   There are also some properties that could have been set at the system level that were deleted.  This is related to #4315, but more general.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2195790547/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2195800742","html_url":"https://github.com/apache/accumulo/issues/4587#issuecomment-2195800742","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4587","id":2195800742,"node_id":"IC_kwDOACaFSM6C4UKm","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-27T23:00:32Z","updated_at":"2024-06-27T23:00:32Z","author_association":"CONTRIBUTOR","body":"The upgrade code in elasticity currently has no tests.  Will need to add test.  Was pondering doing the following for testing upgrade.\r\n\r\n * Create an IT in main/3.1 branch that  : \r\n    * runs mini accumulo\r\n    * creates data in zookeeper and metadata table that upgrade would need to delete\r\n    * stops all processes\r\n    * then creates a  zip file of the mini accumulo directory\r\n * In the elasticity branch do the following :\r\n   * copy the zip file created in the 3.1 branch to test resources\r\n   * create an IT that initializes a mini accumulo instance using this zip file\r\n   * verify upgrade happened\r\n   * add a comment to the IT about running the test in the other branch to update the zip file\r\n\r\nThe IT in elasticity could use this MAC functionality https://github.com/apache/accumulo/blob/f0e38490324930c20577318b0d7fd300cdb6f167/minicluster/src/main/java/org/apache/accumulo/miniclusterImpl/MiniAccumuloConfigImpl.java#L737\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2195800742/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2196816056","html_url":"https://github.com/apache/accumulo/issues/4692#issuecomment-2196816056","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4692","id":2196816056,"node_id":"IC_kwDOACaFSM6C8MC4","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-28T12:38:19Z","updated_at":"2024-06-28T12:38:19Z","author_association":"CONTRIBUTOR","body":"Besides setting properties there seems to be a couple more things that would need to be done during upgrade that FileSystemInitializer is handling for a new system. All of it is driven by the FileSystemInitializer initialize() method:\r\n\r\n1. We need to create the new directories for the new table which is done [here](https://github.com/apache/accumulo/blob/4e62c46309bd0e17ec0af47f3943fabe0fa87943/server/base/src/main/java/org/apache/accumulo/server/init/FileSystemInitializer.java#L108-L114) and [here](https://github.com/apache/accumulo/blob/4e62c46309bd0e17ec0af47f3943fabe0fa87943/server/base/src/main/java/org/apache/accumulo/server/init/FileSystemInitializer.java#L132-L134) \r\n2. We need to add entries to the metadata table for the new Fate tablet which is done [here](https://github.com/apache/accumulo/blob/4e62c46309bd0e17ec0af47f3943fabe0fa87943/server/base/src/main/java/org/apache/accumulo/server/init/FileSystemInitializer.java#L139-L144)\r\n\r\n@keith-turner - I am not sure if I am missing anything else or if that is it. I am thinking we might need to do some refactoring with the initializer so that the upgrade code can also use it. Because the new Scan ref table is used in both 3.1 and elasticity maybe that should be done first in #4652 and include some refactoring, and then we can update elasticity upgrade to use it for Fate as well. It might be tricky to do both tables together in the same commit with Fate only applying to elasticity.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2196816056/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2197071096","html_url":"https://github.com/apache/accumulo/issues/4664#issuecomment-2197071096","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4664","id":2197071096,"node_id":"IC_kwDOACaFSM6C9KT4","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-28T14:27:30Z","updated_at":"2024-06-28T14:27:30Z","author_association":"CONTRIBUTOR","body":"I'm working on trying out gRPC now to see how it goes. I figure it would be good to get something simple to at least compare how it could work and see if we want to go that direction. Besides a hello world RPC to try things, my plan would be to try and create one RPC for now, which is the getCompactionJob() RPC that exists in the CompactionCoordinatorService and see if it would work.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2197071096/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2200013746","html_url":"https://github.com/apache/accumulo/pull/4709#issuecomment-2200013746","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4709","id":2200013746,"node_id":"IC_kwDOACaFSM6DIYuy","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-01T12:27:36Z","updated_at":"2024-07-01T12:27:36Z","author_association":"CONTRIBUTOR","body":"@keith-turner  - good catch on these latest comments. I had some things outside of the loop that should have been inside of it. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2200013746/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2200795596","html_url":"https://github.com/apache/accumulo/issues/4692#issuecomment-2200795596","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4692","id":2200795596,"node_id":"IC_kwDOACaFSM6DLXnM","user":{"login":"ddanielr","id":12480877,"node_id":"MDQ6VXNlcjEyNDgwODc3","avatar_url":"https://avatars.githubusercontent.com/u/12480877?v=4","gravatar_id":"","url":"https://api.github.com/users/ddanielr","html_url":"https://github.com/ddanielr","followers_url":"https://api.github.com/users/ddanielr/followers","following_url":"https://api.github.com/users/ddanielr/following{/other_user}","gists_url":"https://api.github.com/users/ddanielr/gists{/gist_id}","starred_url":"https://api.github.com/users/ddanielr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ddanielr/subscriptions","organizations_url":"https://api.github.com/users/ddanielr/orgs","repos_url":"https://api.github.com/users/ddanielr/repos","events_url":"https://api.github.com/users/ddanielr/events{/privacy}","received_events_url":"https://api.github.com/users/ddanielr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-01T18:45:57Z","updated_at":"2024-07-01T18:45:57Z","author_association":"CONTRIBUTOR","body":"@cshannon The last piece you need is the table node creation in ZK. \r\nThat is handled within the ZooKeeperInitializer [here](https://github.com/apache/accumulo/blob/4e62c46309bd0e17ec0af47f3943fabe0fa87943/server/base/src/main/java/org/apache/accumulo/server/init/ZooKeeperInitializer.java#L123-L126). \r\n\r\nIf this isn't called then the `setTableProperties` method will fail because the top-level table entry in ZK doesn't exist yet.\r\n\r\nI agree that the init code needs to be refactored so both upgrade and init can use it.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2200795596/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2200796759","html_url":"https://github.com/apache/accumulo/pull/4716#issuecomment-2200796759","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4716","id":2200796759,"node_id":"IC_kwDOACaFSM6DLX5X","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-01T18:46:45Z","updated_at":"2024-07-01T18:46:45Z","author_association":"MEMBER","body":"So far I have backported the changes as they exist in elasticity and tried to get the test working. Right now I can see the metric for the compactor and scan server in the test but am not seeing it for the tserver yet (no metric at all) and am not sure why.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2200796759/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2200951493","html_url":"https://github.com/apache/accumulo/pull/4716#issuecomment-2200951493","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4716","id":2200951493,"node_id":"IC_kwDOACaFSM6DL9rF","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-01T20:18:15Z","updated_at":"2024-07-01T20:18:15Z","author_association":"MEMBER","body":"> but am not seeing it for the tserver yet (no metric at all) and am not sure why.\r\n\r\nLooked into this a bit and it seems like micrometer only reports the metric after it changes and since the tserver never became idle, the value for this metric was never emitted.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2200951493/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2201381477","html_url":"https://github.com/apache/accumulo/pull/4718#issuecomment-2201381477","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4718","id":2201381477,"node_id":"IC_kwDOACaFSM6DNmpl","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-01T23:23:06Z","updated_at":"2024-07-01T23:23:21Z","author_association":"CONTRIBUTOR","body":"I attempted the approach of zipping the output of generating an accumulo instance for upgrade testing so that it could be placed in test/resources.  However this was problematic because accumulo metadata contains absolute paths making it not relocatable.  So decided to go with the approach of running the 3.1 and 4.0 code on the same system and same directory manually now for upgrade testing.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2201381477/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2201475903","html_url":"https://github.com/apache/accumulo/pull/4717#issuecomment-2201475903","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4717","id":2201475903,"node_id":"IC_kwDOACaFSM6DN9s_","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-02T00:02:43Z","updated_at":"2024-07-02T00:02:43Z","author_association":"CONTRIBUTOR","body":"These bugs were found running #4718 and #4719","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2201475903/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2203359587","html_url":"https://github.com/apache/accumulo/pull/4524#issuecomment-2203359587","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4524","id":2203359587,"node_id":"IC_kwDOACaFSM6DVJlj","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-02T14:22:40Z","updated_at":"2024-07-02T14:22:40Z","author_association":"MEMBER","body":"@keith-turner Thanks for the review. I addressed the suggested changes. This PR is ready for re-review","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2203359587/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2203863283","html_url":"https://github.com/apache/accumulo/issues/4692#issuecomment-2203863283","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4692","id":2203863283,"node_id":"IC_kwDOACaFSM6DXEjz","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-02T17:07:05Z","updated_at":"2024-07-02T17:07:05Z","author_association":"CONTRIBUTOR","body":"I plan to get the test in #4717 and #4718 working with 2.1.  Then will have a way to test upgrade from 2.1->3.1 and 2.1->4.0.  Once that is in place can make the 2.1 code create some scan refs prior to upgrade and verify in 3.1 and 4.0 that they are deleted after upgrade.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2203863283/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2204003882","html_url":"https://github.com/apache/accumulo/issues/4426#issuecomment-2204003882","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4426","id":2204003882,"node_id":"IC_kwDOACaFSM6DXm4q","user":{"login":"ddanielr","id":12480877,"node_id":"MDQ6VXNlcjEyNDgwODc3","avatar_url":"https://avatars.githubusercontent.com/u/12480877?v=4","gravatar_id":"","url":"https://api.github.com/users/ddanielr","html_url":"https://github.com/ddanielr","followers_url":"https://api.github.com/users/ddanielr/followers","following_url":"https://api.github.com/users/ddanielr/following{/other_user}","gists_url":"https://api.github.com/users/ddanielr/gists{/gist_id}","starred_url":"https://api.github.com/users/ddanielr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ddanielr/subscriptions","organizations_url":"https://api.github.com/users/ddanielr/orgs","repos_url":"https://api.github.com/users/ddanielr/repos","events_url":"https://api.github.com/users/ddanielr/events{/privacy}","received_events_url":"https://api.github.com/users/ddanielr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-02T18:15:46Z","updated_at":"2024-07-02T18:15:46Z","author_association":"CONTRIBUTOR","body":"Adding a version number to the cluster would imply that we have various schema support across major accumulo versions. \r\nGiven the upgrade paths, I don't think that is a pattern of support we want to adopt.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2204003882/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2204442844","html_url":"https://github.com/apache/accumulo/issues/4135#issuecomment-2204442844","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4135","id":2204442844,"node_id":"IC_kwDOACaFSM6DZSDc","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-02T21:14:45Z","updated_at":"2024-07-02T21:14:45Z","author_association":"MEMBER","body":"Haven't seen this in awhile. Can reopen if it's still an issue.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2204442844/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2204461817","html_url":"https://github.com/apache/accumulo/issues/4456#issuecomment-2204461817","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4456","id":2204461817,"node_id":"IC_kwDOACaFSM6DZWr5","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-02T21:21:20Z","updated_at":"2024-07-02T21:21:20Z","author_association":"MEMBER","body":"@jmark99 are you working on this?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2204461817/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2204475528","html_url":"https://github.com/apache/accumulo/pull/4592#issuecomment-2204475528","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4592","id":2204475528,"node_id":"IC_kwDOACaFSM6DZaCI","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-02T21:26:08Z","updated_at":"2024-07-02T21:26:08Z","author_association":"MEMBER","body":"This seems related to #4469","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2204475528/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2204494829","html_url":"https://github.com/apache/accumulo/issues/4666#issuecomment-2204494829","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4666","id":2204494829,"node_id":"IC_kwDOACaFSM6DZevt","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-02T21:37:51Z","updated_at":"2024-07-02T21:37:51Z","author_association":"MEMBER","body":"@ddanielr Does this still occur after #4681 ?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2204494829/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2205904712","html_url":"https://github.com/apache/accumulo/issues/4456#issuecomment-2205904712","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4456","id":2205904712,"node_id":"IC_kwDOACaFSM6De29I","user":{"login":"jmark99","id":31573345,"node_id":"MDQ6VXNlcjMxNTczMzQ1","avatar_url":"https://avatars.githubusercontent.com/u/31573345?v=4","gravatar_id":"","url":"https://api.github.com/users/jmark99","html_url":"https://github.com/jmark99","followers_url":"https://api.github.com/users/jmark99/followers","following_url":"https://api.github.com/users/jmark99/following{/other_user}","gists_url":"https://api.github.com/users/jmark99/gists{/gist_id}","starred_url":"https://api.github.com/users/jmark99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jmark99/subscriptions","organizations_url":"https://api.github.com/users/jmark99/orgs","repos_url":"https://api.github.com/users/jmark99/repos","events_url":"https://api.github.com/users/jmark99/events{/privacy}","received_events_url":"https://api.github.com/users/jmark99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-03T11:56:58Z","updated_at":"2024-07-03T11:56:58Z","author_association":"CONTRIBUTOR","body":"@ctubbsii yes. Started looking this week. Should have a PR early next week as I'm away the rest of this week.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2205904712/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2206725753","html_url":"https://github.com/apache/accumulo/pull/4691#issuecomment-2206725753","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4691","id":2206725753,"node_id":"IC_kwDOACaFSM6Dh_Z5","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-03T16:12:56Z","updated_at":"2024-07-03T16:12:56Z","author_association":"CONTRIBUTOR","body":"After we merge this forward into Elasticity, I think we could follow the same pattern here and use it to fix up the upgrade for the Fate table as part of #4692","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2206725753/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2206921002","html_url":"https://github.com/apache/accumulo/issues/4460#issuecomment-2206921002","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4460","id":2206921002,"node_id":"IC_kwDOACaFSM6DivEq","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-03T18:07:53Z","updated_at":"2024-07-03T18:07:53Z","author_association":"MEMBER","body":"I will look into this","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2206921002/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2207871651","html_url":"https://github.com/apache/accumulo/pull/4726#issuecomment-2207871651","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4726","id":2207871651,"node_id":"IC_kwDOACaFSM6DmXKj","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-04T02:09:24Z","updated_at":"2024-07-04T02:09:24Z","author_association":"CONTRIBUTOR","body":"This change was made in support of #4715 ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2207871651/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2210803981","html_url":"https://github.com/apache/accumulo/issues/4724#issuecomment-2210803981","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4724","id":2210803981,"node_id":"IC_kwDOACaFSM6DxjEN","user":{"login":"meatballspaghetti","id":69256191,"node_id":"MDQ6VXNlcjY5MjU2MTkx","avatar_url":"https://avatars.githubusercontent.com/u/69256191?v=4","gravatar_id":"","url":"https://api.github.com/users/meatballspaghetti","html_url":"https://github.com/meatballspaghetti","followers_url":"https://api.github.com/users/meatballspaghetti/followers","following_url":"https://api.github.com/users/meatballspaghetti/following{/other_user}","gists_url":"https://api.github.com/users/meatballspaghetti/gists{/gist_id}","starred_url":"https://api.github.com/users/meatballspaghetti/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/meatballspaghetti/subscriptions","organizations_url":"https://api.github.com/users/meatballspaghetti/orgs","repos_url":"https://api.github.com/users/meatballspaghetti/repos","events_url":"https://api.github.com/users/meatballspaghetti/events{/privacy}","received_events_url":"https://api.github.com/users/meatballspaghetti/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-05T12:37:27Z","updated_at":"2024-07-05T12:37:27Z","author_association":"CONTRIBUTOR","body":"I can look into this.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2210803981/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2210997041","html_url":"https://github.com/apache/accumulo/pull/4726#issuecomment-2210997041","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4726","id":2210997041,"node_id":"IC_kwDOACaFSM6DySMx","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-05T14:39:51Z","updated_at":"2024-07-05T14:41:05Z","author_association":"CONTRIBUTOR","body":"> For now it makes sense to keep both the sync and async methods for getting a job as the current code still uses that until https://github.com/apache/accumulo/pull/4715 is done, but I was wondering if you were planning to drop the sync entry point to get a job eventually? \r\n\r\nYeah, it we can drop it once it becomes unused.  Could possibly drop it in #4715, but do not have to.  If we do not drop it in #4715 we need to remember to open an issue to drop it before merging #4715.\r\n\r\n\r\nI realized there is a problem with the new code for the case where nothing is ever added to the priority queue, get async is called repeatedly, and the futures are canceled. In this case the canceled futures will build up in memory.  I think this easy to handle though, will open up a follow on PR to handle that case.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2210997041/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2211137616","html_url":"https://github.com/apache/accumulo/pull/4715#issuecomment-2211137616","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4715","id":2211137616,"node_id":"IC_kwDOACaFSM6Dy0hQ","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-05T16:22:33Z","updated_at":"2024-07-05T16:22:33Z","author_association":"CONTRIBUTOR","body":"I pushed up changes that take advantage of #4726 to get a new job async that returns a CompletableFuture. The result is not sent back to the client (coordinator) util the job is completed. To make it simple I just copied the relevant code out of the Thrift method because the current method can't return a CompletableFuture as it's an RPC service. We need to decide if we want to keep the Thrift code around temporarily so either RPC can be used or to just drop it. I also went ahead and dropped the loop that tries to get another job if the reservation fails to simplify things. I figure we just return the empty job and it would try again and that is fine.\r\n\r\nThere are a couple things we could probably improve here. First, I am using future.thenApply() and future.thenAccept() and it woud probably be better to use a thread pool and the Async versions of those methods. Second, there's currently no timeout so we need to look at having a timeout so things are not waiting forever.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2211137616/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2211225660","html_url":"https://github.com/apache/accumulo/pull/4727#issuecomment-2211225660","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4727","id":2211225660,"node_id":"IC_kwDOACaFSM6DzKA8","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-05T17:57:42Z","updated_at":"2024-07-05T17:57:42Z","author_association":"CONTRIBUTOR","body":"> I am wondering if we could eventually have futures be auto removed on a timeout or cancel but not sure.\r\n\r\nI added a test in 9462ca8 related to timeouts.  It seems that once it has timed out it will look done and this would cause add to skip it and the cleanup code added here to remove it.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2211225660/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2211229675","html_url":"https://github.com/apache/accumulo/pull/4716#issuecomment-2211229675","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4716","id":2211229675,"node_id":"IC_kwDOACaFSM6DzK_r","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-05T18:01:06Z","updated_at":"2024-07-05T18:01:06Z","author_association":"MEMBER","body":"removing the WIP label as I think this is ready for review now. The only thing I need to fix is the `CompactorTest` which is failing in the builds. I am not sure whats going on there, maybe something wrong with the mocking in that test now.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2211229675/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2211231189","html_url":"https://github.com/apache/accumulo/pull/4727#issuecomment-2211231189","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4727","id":2211231189,"node_id":"IC_kwDOACaFSM6DzLXV","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-05T18:02:16Z","updated_at":"2024-07-05T18:02:16Z","author_association":"CONTRIBUTOR","body":"> Also, I was wondering what happens if the client disconnects/errors before the future completes. \r\n\r\nI suspect the the completable future step that writes the response will get an exception on write.  The future will still be removed from the internal queue because its removed from the queue and then completed, this error will happen on completion.  So the future object should not hang around in this case and we would probably get a server side log related to the error.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2211231189/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2211380275","html_url":"https://github.com/apache/accumulo/pull/4592#issuecomment-2211380275","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4592","id":2211380275,"node_id":"IC_kwDOACaFSM6Dzvwz","user":{"login":"ddanielr","id":12480877,"node_id":"MDQ6VXNlcjEyNDgwODc3","avatar_url":"https://avatars.githubusercontent.com/u/12480877?v=4","gravatar_id":"","url":"https://api.github.com/users/ddanielr","html_url":"https://github.com/ddanielr","followers_url":"https://api.github.com/users/ddanielr/followers","following_url":"https://api.github.com/users/ddanielr/following{/other_user}","gists_url":"https://api.github.com/users/ddanielr/gists{/gist_id}","starred_url":"https://api.github.com/users/ddanielr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ddanielr/subscriptions","organizations_url":"https://api.github.com/users/ddanielr/orgs","repos_url":"https://api.github.com/users/ddanielr/repos","events_url":"https://api.github.com/users/ddanielr/events{/privacy}","received_events_url":"https://api.github.com/users/ddanielr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-05T20:28:52Z","updated_at":"2024-07-05T20:28:52Z","author_association":"CONTRIBUTOR","body":"@dlmarion Any other changes needed?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2211380275/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2211389540","html_url":"https://github.com/apache/accumulo/issues/4469#issuecomment-2211389540","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4469","id":2211389540,"node_id":"IC_kwDOACaFSM6DzyBk","user":{"login":"ddanielr","id":12480877,"node_id":"MDQ6VXNlcjEyNDgwODc3","avatar_url":"https://avatars.githubusercontent.com/u/12480877?v=4","gravatar_id":"","url":"https://api.github.com/users/ddanielr","html_url":"https://github.com/ddanielr","followers_url":"https://api.github.com/users/ddanielr/followers","following_url":"https://api.github.com/users/ddanielr/following{/other_user}","gists_url":"https://api.github.com/users/ddanielr/gists{/gist_id}","starred_url":"https://api.github.com/users/ddanielr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ddanielr/subscriptions","organizations_url":"https://api.github.com/users/ddanielr/orgs","repos_url":"https://api.github.com/users/ddanielr/repos","events_url":"https://api.github.com/users/ddanielr/events{/privacy}","received_events_url":"https://api.github.com/users/ddanielr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-05T20:39:58Z","updated_at":"2024-07-05T20:39:58Z","author_association":"CONTRIBUTOR","body":"@dtspence are the changes in https://github.com/apache/accumulo/pull/4592 sufficient for this issue? ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2211389540/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2214928441","html_url":"https://github.com/apache/accumulo/pull/3746#issuecomment-2214928441","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3746","id":2214928441,"node_id":"IC_kwDOACaFSM6EBSA5","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-08T18:46:13Z","updated_at":"2024-07-08T21:12:12Z","author_association":"CONTRIBUTOR","body":"I added `accumulo-access` to the ASF Jenkins (https://ci-builds.apache.org/job/Accumulo/job/Accumulo-Access-main) which should push the built jars into the snapshot repo. I'm wondering if that's enough to change the dependency from 1.0.0-beta to 1.0.0-SNAPSHOT as there have been changes since the beta release. It doesn't look like it's building reliably, but I just kicked a build off.\r\n\r\nUpdate: Build finished, new snapshot artifacts at https://repository.apache.org/content/repositories/snapshots/org/apache/accumulo/accumulo-access/1.0.0-SNAPSHOT/.\r\n\r\nUpdate #2: Since Accumulo's parent pom is the Apache Parent POM, we don't need to do anything to reference snapshot releases in the ASF repo. It's already included in the Parent POM.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2214928441/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2215463765","html_url":"https://github.com/apache/accumulo/issues/4708#issuecomment-2215463765","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4708","id":2215463765,"node_id":"IC_kwDOACaFSM6EDUtV","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-08T22:34:28Z","updated_at":"2024-07-08T22:34:28Z","author_association":"MEMBER","body":"I can work on this","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2215463765/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2215473359","html_url":"https://github.com/apache/accumulo/issues/4637#issuecomment-2215473359","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4637","id":2215473359,"node_id":"IC_kwDOACaFSM6EDXDP","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-08T22:43:06Z","updated_at":"2024-07-08T22:43:06Z","author_association":"MEMBER","body":"Closing as complete from https://github.com/apache/accumulo/pull/4725","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2215473359/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2220211526","html_url":"https://github.com/apache/accumulo/pull/4733#issuecomment-2220211526","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4733","id":2220211526,"node_id":"IC_kwDOACaFSM6EVb1G","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-10T11:02:16Z","updated_at":"2024-07-10T11:02:16Z","author_association":"CONTRIBUTOR","body":"Full IT build passed.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2220211526/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2220532051","html_url":"https://github.com/apache/accumulo/pull/4735#issuecomment-2220532051","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4735","id":2220532051,"node_id":"IC_kwDOACaFSM6EWqFT","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-10T13:36:48Z","updated_at":"2024-07-10T13:36:48Z","author_association":"CONTRIBUTOR","body":"This performance improvement could be easily back-ported to 2.1, just wasn't sure if we wanted to make this type of API change in a bugfix release.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2220532051/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2220639054","html_url":"https://github.com/apache/accumulo/issues/4641#issuecomment-2220639054","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4641","id":2220639054,"node_id":"IC_kwDOACaFSM6EXENO","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-10T14:17:31Z","updated_at":"2024-07-10T14:17:31Z","author_association":"CONTRIBUTOR","body":"@DomGarguilo - can this be closed?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2220639054/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2220644830","html_url":"https://github.com/apache/accumulo/issues/4641#issuecomment-2220644830","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4641","id":2220644830,"node_id":"IC_kwDOACaFSM6EXFne","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-10T14:19:33Z","updated_at":"2024-07-10T14:19:33Z","author_association":"MEMBER","body":"Closing as completed via #4716","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2220644830/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2221157911","html_url":"https://github.com/apache/accumulo/pull/4737#issuecomment-2221157911","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4737","id":2221157911,"node_id":"IC_kwDOACaFSM6EZC4X","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-10T18:18:17Z","updated_at":"2024-07-10T18:18:17Z","author_association":"MEMBER","body":"Converting to draft for now. Going to make another PR in 2.1 to clean up the duplicate logic outline above and merge that up first.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2221157911/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2221193494","html_url":"https://github.com/apache/accumulo/pull/4728#issuecomment-2221193494","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4728","id":2221193494,"node_id":"IC_kwDOACaFSM6EZLkW","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-10T18:40:45Z","updated_at":"2024-07-10T18:40:45Z","author_association":"CONTRIBUTOR","body":"@meatballspaghetti if this your first PR to Accumulo then feel free to make a PR to add yourself as a contributor on the [People page](https://github.com/apache/accumulo-website/blob/main/pages/people.md).","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2221193494/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2221227307","html_url":"https://github.com/apache/accumulo/issues/4738#issuecomment-2221227307","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4738","id":2221227307,"node_id":"IC_kwDOACaFSM6EZT0r","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-10T19:01:36Z","updated_at":"2024-07-10T19:01:36Z","author_association":"CONTRIBUTOR","body":"MutableByteSequence is not in a public API package so it would be easy to delete","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2221227307/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2221348918","html_url":"https://github.com/apache/accumulo/issues/4705#issuecomment-2221348918","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4705","id":2221348918,"node_id":"IC_kwDOACaFSM6EZxg2","user":{"login":"ArbaazKhan1","id":29344877,"node_id":"MDQ6VXNlcjI5MzQ0ODc3","avatar_url":"https://avatars.githubusercontent.com/u/29344877?v=4","gravatar_id":"","url":"https://api.github.com/users/ArbaazKhan1","html_url":"https://github.com/ArbaazKhan1","followers_url":"https://api.github.com/users/ArbaazKhan1/followers","following_url":"https://api.github.com/users/ArbaazKhan1/following{/other_user}","gists_url":"https://api.github.com/users/ArbaazKhan1/gists{/gist_id}","starred_url":"https://api.github.com/users/ArbaazKhan1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ArbaazKhan1/subscriptions","organizations_url":"https://api.github.com/users/ArbaazKhan1/orgs","repos_url":"https://api.github.com/users/ArbaazKhan1/repos","events_url":"https://api.github.com/users/ArbaazKhan1/events{/privacy}","received_events_url":"https://api.github.com/users/ArbaazKhan1/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-10T20:11:46Z","updated_at":"2024-07-10T20:11:46Z","author_association":"CONTRIBUTOR","body":"I can take a look at this\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2221348918/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2221772887","html_url":"https://github.com/apache/accumulo/pull/4715#issuecomment-2221772887","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4715","id":2221772887,"node_id":"IC_kwDOACaFSM6EbZBX","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-11T00:39:24Z","updated_at":"2024-07-11T00:51:50Z","author_association":"CONTRIBUTOR","body":"I was experimenting with this locally and its really neat to see it in action.\r\n\r\nMade the following throwaway changes to dae30cf746c135b061e4de87f21542e98c001dda.  The logging changes were to get a bit more information about timing.  The test changes were made to cause a surge of bulk import files after the system was sitting idle for a bit.\r\n\r\n```diff\r\ndiff --git a/server/manager/src/main/java/org/apache/accumulo/manager/compaction/coordinator/CompactionCoordinator.java b/server/manager/src/main/java/org/apache/accumulo/manager/compaction/coordinator/CompactionCoordinator.java\r\nindex ef07b78d8a..838fab35a7 100644\r\n--- a/server/manager/src/main/java/org/apache/accumulo/manager/compaction/coordinator/CompactionCoordinator.java\r\n+++ b/server/manager/src/main/java/org/apache/accumulo/manager/compaction/coordinator/CompactionCoordinator.java\r\n@@ -462,7 +462,7 @@ public class CompactionCoordinator\r\n     TIME_COMPACTOR_LAST_CHECKED.put(groupId, System.currentTimeMillis());\r\n \r\n     return jobQueues.getAsync(groupId).thenApply(metaJob -> {\r\n-      LOG.trace(\"Next metaJob is ready {}\", metaJob.getJob());\r\n+      LOG.debug(\"Next metaJob is ready {}\", metaJob.getJob());\r\n       Optional<CompactionConfig> compactionConfig = getCompactionConfig(metaJob);\r\n \r\n       // this method may reread the metadata, do not use the metadata in metaJob for anything after\r\n@@ -471,6 +471,7 @@ public class CompactionCoordinator\r\n \r\n       var kind = metaJob.getJob().getKind();\r\n \r\n+      LOG.debug(\"Reserving compaction job {}\", externalCompactionId);\r\n       // Only reserve user compactions when the config is present. When compactions are canceled the\r\n       // config is deleted.\r\n       var cid = ExternalCompactionId.from(externalCompactionId);\r\ndiff --git a/test/src/main/java/org/apache/accumulo/test/ComprehensiveBaseIT.java b/test/src/main/java/org/apache/accumulo/test/ComprehensiveBaseIT.java\r\nindex 1dc1c2c0f9..a3d5a61856 100644\r\n--- a/test/src/main/java/org/apache/accumulo/test/ComprehensiveBaseIT.java\r\n+++ b/test/src/main/java/org/apache/accumulo/test/ComprehensiveBaseIT.java\r\n@@ -96,6 +96,7 @@ import org.apache.accumulo.core.security.ColumnVisibility;\r\n import org.apache.accumulo.core.security.NamespacePermission;\r\n import org.apache.accumulo.core.security.SystemPermission;\r\n import org.apache.accumulo.core.security.TablePermission;\r\n+import org.apache.accumulo.core.util.UtilWaitThread;\r\n import org.apache.accumulo.harness.SharedMiniClusterBase;\r\n import org.apache.accumulo.test.util.Wait;\r\n import org.apache.hadoop.fs.FileUtil;\r\n@@ -126,12 +127,24 @@ public abstract class ComprehensiveBaseIT extends SharedMiniClusterBase {\r\n     try (AccumuloClient client = Accumulo.newClient().from(getClientProps()).build()) {\r\n       client.tableOperations().create(table);\r\n \r\n-      bulkImport(client, table, List.of(generateKeys(0, 100), generateKeys(100, 200)));\r\n+      // sleep for a bit to let compactors idle\r\n+      UtilWaitThread.sleep(60000);\r\n+\r\n+      // add 4 files to a single tablet, should cause tablet to need compaction\r\n+      bulkImport(client, table, List.of(generateKeys(0, 50), generateKeys(50, 100),\r\n+              generateKeys(100, 150), generateKeys(150, 200)));\r\n \r\n       verifyData(client, table, AUTHORIZATIONS, generateKeys(0, 200));\r\n \r\n+      UtilWaitThread.sleep(60000);\r\n+      \r\n+      // add 4 more files to tablet\r\n       bulkImport(client, table,\r\n-          List.of(generateKeys(200, 300), generateKeys(300, 400), generateKeys(400, 500)));\r\n+          List.of(generateKeys(200, 300), generateKeys(300, 400),\r\n+                  generateKeys(400, 450), generateKeys(450, 500)));\r\n+\r\n+      UtilWaitThread.sleep(60000);\r\n+\r\n \r\n       verifyData(client, table, AUTHORIZATIONS, generateKeys(0, 500));\r\n     }\r\n\r\n```\r\n\r\nRan the modified test ad then looked in the manager log and saw the following.\r\n\r\n```\r\n2024-07-10T19:55:04,450 120 [manager.EventCoordinator] DEBUG: Bulk load completed on tablet 1<<\r\n2024-07-10T19:55:04,455 63 [compaction.CompactionJobGenerator] DEBUG: Planning for 1<< [SYSTEM, USER] 1445803685\r\n2024-07-10T19:55:04,456 63 [manager.TabletGroupWatcher] DEBUG: 1<< may need compacting adding 1 jobs\r\n2024-07-10T19:55:04,456 63 [coordinator.CompactionCoordinator] DEBUG: Reserving compaction job ECID-db4c21aa-b615-4109-b3dd-3fc544f8c391\r\n2024-07-10T19:55:04,459 63 [tablet.files] DEBUG: Compacting 1<< id:ECID-db4c21aa-b615-4109-b3dd-3fc544f8c391 group:default compactor:localhost:9133 priority:-32759 size:35 KB kind:SYSTEM files:[I000005p.rf, I000005o.rf, I000005n.rf, I000005m.rf]\r\n2024-07-10T19:55:04,459 63 [coordinator.CompactionCoordinator] INFO : Found job ECID-db4c21aa-b615-4109-b3dd-3fc544f8c391\r\n2024-07-10T19:55:04,460 63 [rpc.ThriftProtobufUtil] DEBUG: PExternalCompactionJob: externalCompactionId: \"ECID-db4c21aa-b615-4109-b3dd-3fc544f8c391\"\r\n2024-07-10T19:55:04,508 87 [fate.Fate] INFO : Seeding FATE:USER:914dd323-a684-38af-aaaf-7cb202a9e672 Commit compaction ECID-db4c21aa-b615-4109-b3dd-3fc544f8c391\r\n```\r\n\r\nSummarizing the above log messages.\r\n\r\n * A time +0ms the bulk import completed adding files to the tablet and signaled the TGW (tablet group watcher).\r\n * At time +6ms the TGW adds a job to the compaction queue\r\n * At time +6ms an async rpc job request starts processing the job\r\n * At time +9ms the async rpc job request finishes reserving the  job\r\n * At time +10ms the last observed lob message for the async rpc job request is seen, at this point its  about to write the return value of the rpc\r\n * At time +58ms the compactor has completed the compaction and has made another RPC to the coordinator to start the fate operation that will commit the compaction.  With the changes in #4524 we may be able to avoid this RPC and have the compactor process start the fate op to commit a compaction itself.\r\n\r\nSo this is really neat, the async request starts working immediately after the job is queued and within 3ms to 4ms has reserved the job and returned it to the compactor. \r\n\r\nSaw something else that was interesting besides timing in the logs. The numbers after the times in the logs are thread ids.  So thread id `63` is the TGW thread id.  Can see that currently the TGW thread ends up processing the async RPC job reservation and response.  Once that is changed to use another thread we should see a different thread id in the logs for those steps.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2221772887/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2223535162","html_url":"https://github.com/apache/accumulo/pull/4740#issuecomment-2223535162","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4740","id":2223535162,"node_id":"IC_kwDOACaFSM6EiHQ6","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-11T17:50:09Z","updated_at":"2024-07-11T17:50:09Z","author_association":"MEMBER","body":"Working on a test for the compactor metric to make sure it goes back to busy when a compaction is running then back to idle afterwards.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2223535162/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2223655965","html_url":"https://github.com/apache/accumulo/issues/4666#issuecomment-2223655965","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4666","id":2223655965,"node_id":"IC_kwDOACaFSM6Eikwd","user":{"login":"ddanielr","id":12480877,"node_id":"MDQ6VXNlcjEyNDgwODc3","avatar_url":"https://avatars.githubusercontent.com/u/12480877?v=4","gravatar_id":"","url":"https://api.github.com/users/ddanielr","html_url":"https://github.com/ddanielr","followers_url":"https://api.github.com/users/ddanielr/followers","following_url":"https://api.github.com/users/ddanielr/following{/other_user}","gists_url":"https://api.github.com/users/ddanielr/gists{/gist_id}","starred_url":"https://api.github.com/users/ddanielr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ddanielr/subscriptions","organizations_url":"https://api.github.com/users/ddanielr/orgs","repos_url":"https://api.github.com/users/ddanielr/repos","events_url":"https://api.github.com/users/ddanielr/events{/privacy}","received_events_url":"https://api.github.com/users/ddanielr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-11T18:45:52Z","updated_at":"2024-07-11T18:45:52Z","author_association":"CONTRIBUTOR","body":"Unable to replicate this problem after #4681 was merged.\r\nClosing issue","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2223655965/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2223818306","html_url":"https://github.com/apache/accumulo/pull/4740#issuecomment-2223818306","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4740","id":2223818306,"node_id":"IC_kwDOACaFSM6EjMZC","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-11T19:59:14Z","updated_at":"2024-07-11T19:59:14Z","author_association":"MEMBER","body":"In 04ed08b I added a test case that checks that the compactor idle metric correctly tracks what we expect it to be before, during and after a compaction. I am able to get the test to pass using the old logic in compactor but with the new logic, the idle value is not returning to 0 as I expect. I am not sure why that is happening at the moment so was hoping someone might be able to spot a flaw in the new logic that sets the idle metric value.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2223818306/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2225432436","html_url":"https://github.com/apache/accumulo/pull/4715#issuecomment-2225432436","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4715","id":2225432436,"node_id":"IC_kwDOACaFSM6EpWd0","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-12T11:59:35Z","updated_at":"2024-07-12T11:59:35Z","author_association":"CONTRIBUTOR","body":"> For what is left to be done, what do you think can be done in the initial PR and what could be deferred to follow on PRs?\r\n\r\nI will take a look more today at the state of this and report what I think. The tricky part is definitely trying to figure out how big of a scope to make this task vs follow on tasks. We can likely make a lot of things follow on tasks (like SSL and kerberos support) because this is for the elasticity and 4.0 branch so it's not going to be released anytime soon so it's not like it has to be perfect. But if we defer things to follow on issues we should certainly document them so they are not forgotten.\r\n\r\nIt would be nice to at least clean up the protobuf definitions a bit (move things into different namespaces like thrift) and it would also be nice if we could drop the thrift <-> gRPC conversion entirely but I need to dive into the code and see how big of a change that is. I think we would want to use gRPC for all the RPC calls for the compaction service so I can look today to see how much effort that is and if it makes sense to do it now or split it up.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2225432436/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2226367361","html_url":"https://github.com/apache/accumulo/issues/4532#issuecomment-2226367361","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4532","id":2226367361,"node_id":"IC_kwDOACaFSM6Es6uB","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-12T21:18:32Z","updated_at":"2024-07-12T21:18:32Z","author_association":"CONTRIBUTOR","body":"@ArbaazKhan1 do you know if there is anything left for this issue?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2226367361/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2228742593","html_url":"https://github.com/apache/accumulo/issues/4532#issuecomment-2228742593","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4532","id":2228742593,"node_id":"IC_kwDOACaFSM6E1-nB","user":{"login":"ArbaazKhan1","id":29344877,"node_id":"MDQ6VXNlcjI5MzQ0ODc3","avatar_url":"https://avatars.githubusercontent.com/u/29344877?v=4","gravatar_id":"","url":"https://api.github.com/users/ArbaazKhan1","html_url":"https://github.com/ArbaazKhan1","followers_url":"https://api.github.com/users/ArbaazKhan1/followers","following_url":"https://api.github.com/users/ArbaazKhan1/following{/other_user}","gists_url":"https://api.github.com/users/ArbaazKhan1/gists{/gist_id}","starred_url":"https://api.github.com/users/ArbaazKhan1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ArbaazKhan1/subscriptions","organizations_url":"https://api.github.com/users/ArbaazKhan1/orgs","repos_url":"https://api.github.com/users/ArbaazKhan1/repos","events_url":"https://api.github.com/users/ArbaazKhan1/events{/privacy}","received_events_url":"https://api.github.com/users/ArbaazKhan1/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-15T15:12:55Z","updated_at":"2024-07-15T15:12:55Z","author_association":"CONTRIBUTOR","body":"No, everything should be finished for this issue. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2228742593/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2228823332","html_url":"https://github.com/apache/accumulo/issues/4738#issuecomment-2228823332","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4738","id":2228823332,"node_id":"IC_kwDOACaFSM6E2SUk","user":{"login":"meatballspaghetti","id":69256191,"node_id":"MDQ6VXNlcjY5MjU2MTkx","avatar_url":"https://avatars.githubusercontent.com/u/69256191?v=4","gravatar_id":"","url":"https://api.github.com/users/meatballspaghetti","html_url":"https://github.com/meatballspaghetti","followers_url":"https://api.github.com/users/meatballspaghetti/followers","following_url":"https://api.github.com/users/meatballspaghetti/following{/other_user}","gists_url":"https://api.github.com/users/meatballspaghetti/gists{/gist_id}","starred_url":"https://api.github.com/users/meatballspaghetti/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/meatballspaghetti/subscriptions","organizations_url":"https://api.github.com/users/meatballspaghetti/orgs","repos_url":"https://api.github.com/users/meatballspaghetti/repos","events_url":"https://api.github.com/users/meatballspaghetti/events{/privacy}","received_events_url":"https://api.github.com/users/meatballspaghetti/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-15T15:46:24Z","updated_at":"2024-07-15T15:46:24Z","author_association":"CONTRIBUTOR","body":"I can look into this.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2228823332/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2229710112","html_url":"https://github.com/apache/accumulo/pull/4740#issuecomment-2229710112","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4740","id":2229710112,"node_id":"IC_kwDOACaFSM6E5q0g","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-16T00:18:29Z","updated_at":"2024-07-16T00:18:29Z","author_association":"MEMBER","body":"I added another test case to test that the scan server idle metric behaves as expected (very similar to compactor test case)","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2229710112/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2231991529","html_url":"https://github.com/apache/accumulo/pull/4558#issuecomment-2231991529","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4558","id":2231991529,"node_id":"IC_kwDOACaFSM6FCXzp","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-16T23:38:06Z","updated_at":"2024-07-16T23:38:06Z","author_association":"MEMBER","body":"The changes here caused a compilation issue in my dev environment because apparently log4j-api is a transitive dependency of log4j-1.2-api and is needed indirectly because some of the classes that Category requires are in log4j-api and the 1.2 Logger class extends Category. So, by adding an entry for log4j-api for the test scope, it was prevented from being added transitively to the compile scope for log4j-1.2-api.\r\n\r\nIt did work in some environments, though... because log4j-api leaks into the compile time classpath from a lot of places (including Maven itself), but it's not strictly correct, and does break the build in some environments.\r\n\r\nI'm working on a fix for this, as well as some other cleanups.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2231991529/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2233667619","html_url":"https://github.com/apache/accumulo/pull/4740#issuecomment-2233667619","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4740","id":2233667619,"node_id":"IC_kwDOACaFSM6FIxAj","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-17T16:01:03Z","updated_at":"2024-07-17T16:09:08Z","author_association":"MEMBER","body":"Since the scope of this PR has changed slightly since it has been created, here is an updated description of changes in this PR:\r\n* `AbstractServer.updateIdleStatus()` was changed from having `Supplier<Boolean>` as its input to just a `boolean`. This was done to simplify things since the method was just using it as a boolean anyways\r\n    * the method was also renamed from `idleProcessCheck()` to `updateIdleStatus()`\r\n* The idle check in `Compactor` was simplified to just set the idle status to true or false during its operation. This removes duplicate logic that checks it has been idle for a period of time (already done in `AbstractServer.idleProcessCheck()`)\r\n* Adds test cases to ensure that the idle metric for Compactor and ScanServer behave as expected. Tserver was omitted since it is not expected to be idle in 2.1.\r\n\r\nEdit: The most critical portion to review here is probably the changes to the Compactor idle check. Just making sure that it makes sense to mark it as idle or not where I have it marked.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2233667619/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2233688347","html_url":"https://github.com/apache/accumulo/pull/4715#issuecomment-2233688347","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4715","id":2233688347,"node_id":"IC_kwDOACaFSM6FI2Eb","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-17T16:10:27Z","updated_at":"2024-07-17T16:10:27Z","author_association":"CONTRIBUTOR","body":"I have migrated most of Compaction Coordinator Service as gRPC at this point. I also updated the gRPC client to be shared across the different calls as the channel is thread safe and can be re-used, but we are not \"pooling\" different channels like Thrift. I still need to look more into how their client code works and if we need to pool or not. Some of the rpc calls are commented out because the Manager actually uses them.\r\n\r\nI also moved the gRPC objects into their own packages to model after our thrift model. We need to eventually move that into its own jar. This has been talked about a bit already, and that is looking at maybe having a common API for the RPC layer. That is something that I need to look more into and if we were going to do that how far we take it and the scope.  Whatever we decide we         should plan before we go too far. At the very least I think it would be nice to re-factor some things and have some common objects so we stop leaking rpc objects. For example, I think we should have a common object for tracing and credentials. Right now we are passing around TInfo and TCredentials (which I also created PInfo and PCredentials for protobuf) and I think stuff like that should be converted to common objects so we don't leak them. A good example is TCredentials [leaking](https://github.com/apache/accumulo/blob/8ed6dbad90ed9e37e6e33b2676032b5f80dc1ce0/core/src/main/java/org/apache/accumulo/core/clientImpl/ClientContext.java#L144) into ClientContext. It would be nice if we could have a more generic object and conversion.                                                                                                \r\n\r\nOther than that, I haven't had time to finish up the rest of the list yet, but there are still several things to do and I'm still looking at how to split things up and what to make follow on issues. This PR is getting pretty big by now so it would probably be best to move as much as possible into follow on issues to make things easier to review.                        ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2233688347/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2241699447","html_url":"https://github.com/apache/accumulo/pull/4715#issuecomment-2241699447","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4715","id":2241699447,"node_id":"IC_kwDOACaFSM6FnZ53","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-21T16:08:22Z","updated_at":"2024-07-21T16:08:22Z","author_association":"CONTRIBUTOR","body":"Here is an update to the current state of things. This PR has gotten quite large now so I think it's about time to wrap it up and look at follow on tasks for more work to be done. Below is where things are at for completed, still to be done in this PR, and future work.\r\n\r\n\r\n#### Finished:\r\n* Added a new gRPC module that contains all the necessary protobuf definitions for Compaction Coordinator Service (including common objects like KeyExtent. Updated the maven build to generate the protobuf objects and `CompactionCoordinator` service and to be proper dependencies of other modules.\r\n* Created a utiity class to convert between Thrift and Protobuf equivalent objects. This should hopefully be temporary until everything is converted.\r\n* Created another utility class to share a `ManagedChannel` for the gRPC connection across clients. This needs to be investigated more to see if pooling will be required (more listed under future work).\r\n* Completely replaced the Thrift version of the `CompactionCoordinator` service with a gRPC version. The Compactor and Monitor use this version now and create gRPC clients for the Compaction coordinator service. The thrift interface has been removed from the CompactionCoordinator. The Manager starts up the gRPC service and stops it on shutdown.\r\n* Replaced the thrift version of the compaction related thrift objects with protobuf versions, where possible, throughout the CompactionCoordinator code and related code.\r\n* getCompactionJob() RPC uses long polling now and is processed async by using the CompleteableFuture from the job queue. This unblocks the main io threads but there is still work to do with adding more thread pools for processing.\r\n* Updated `ClientContext` to contain a new credentials holder to hold both the grpc and thrift versions of credentials. \r\n* Created a property for defining the gRPC port for the Manager. The default port is used for testing for now.\r\n* Fixed some tests and `ExternalCompaction_1_IT` is now passing. (more work is needed for tests still)\r\n\r\n#### Todo in this PR:\r\n* Make sure the tests all pass and the build is in a good state. Some tests like `ExternalCompaction_2_IT` are hanging and require more work to be done like a timeout feature (listed as follow on work). So we may need to do something as a quick solution for those tests for now or just disable them.\r\n* Address any concerns or issues found during PR reviews.\r\n\r\n\r\n#### Follow on Work:\r\n* Update ServiceDescriptor to support gRPC and add the gRPC port for the manager to Zookeeper. \r\n* Add support for using a random port with gRPC when setting the port to 0.\r\n* Update MiniAccumulo cluster and tests to use a random port. This will require the random port feature to be implemented to find an open port and also ServiceDescriptor to work correcty with finding the gRPC service so clients can use it.\r\n* Add a thread pool for async rpc request response processing. We can use the async methods on CompletableFuture to take advantage of the thread pool.\r\n* Add accumulo config for thread pools for processing grpc request\r\n* Add the needed grpc jars and related jars (protobuf, etc) to tarball\r\n* Explore supporting kerberos and ssl w/ grpc\r\n* Look into pooling channels/connections for gRPC. ManagedChannel can be shared by multiple threads but it's still a bit unclear how they manage connections and if we need to implement our own custom pooling like we did for Thrift.\r\n* Investigate any other properties that need to be customized for the gRPC server and clients. It's netty based and there are a lot of different config options so we should look into what we can set (and their defaults) vs exposing as properties.\r\n* Convert more RPC layers, such as the Compactor service, to gRPC. When all of the compaction related items are changed over we can delete the Thrift related generated code (objects and compaction services) entirely.\r\n* Implement a timeout for the Compaction queue job CompletableFutures. This would be good to have a reasonable default in case the connections from Compactors associated with the future go away. \r\n* Investigate error and exception handling with gRPC. We need to make sure when there are exceptions that the client and server behave correctly and don't kill the connection unless it needs to and it does there is reconnection.\r\n* Finish fixing the other External compaction tests. A timeout is necessary to fix ExternalCompaction_2_IT test as tests hang for now. The issue is when the test kill the original compactors and starts up a do nothing compator. The issue is because of the long polling change, there is a race condition where the job is assigned to the future from the original compactor. Then when the compactor dies, the next one won't get a job assigned as the future never times out from the dead compactor even though the job was cleaned up by the dead compaction detector. \r\n* Explore how to implement tracing with gRPC. With Thrift we use TraceUtil and pass the TraceInfo object everywhere. There is code that was written to wrap all of these calls with a proxy. The proxy will look for the first argument and expect it to be trace info can can use that for debugging and metrics. With gRPC, there are no longer multiple arguments for RPC calls. Every call has exactly 1 object and that object contains all the fields necessary for the request so we would need to create a new version of this feature that would inspect the object being passed and look for the trace info.\r\n* Explore a common API for the RPC layer or at least minimizing what code touches the RPC objects. This needs to be talked about much more and a scope needs to be defined. It would be nice to minimiize the leakage of RPC objects but it's also tricky because we don't want to have to copy objects constantly. For example, we already convert between TKeyExent (and now PKeyExtent) and KeyExtent but I would not want to have to add a second conversion such as PKeyExtent<->Generic RPC KeyExtent<->KeyExtent. The RPC features and behavior are also very different between different RPC implementations such as gRPC being entirely async natively. Thrift also supports nulls where as Protobuf doesn't support null values.\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2241699447/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2242774301","html_url":"https://github.com/apache/accumulo/issues/4738#issuecomment-2242774301","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4738","id":2242774301,"node_id":"IC_kwDOACaFSM6FrgUd","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-22T11:54:46Z","updated_at":"2024-07-22T11:54:46Z","author_association":"CONTRIBUTOR","body":"@meatballspaghetti - Is there a pull request for your commit to merge it into the main repo?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2242774301/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2242819975","html_url":"https://github.com/apache/accumulo/issues/4738#issuecomment-2242819975","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4738","id":2242819975,"node_id":"IC_kwDOACaFSM6FrreH","user":{"login":"meatballspaghetti","id":69256191,"node_id":"MDQ6VXNlcjY5MjU2MTkx","avatar_url":"https://avatars.githubusercontent.com/u/69256191?v=4","gravatar_id":"","url":"https://api.github.com/users/meatballspaghetti","html_url":"https://github.com/meatballspaghetti","followers_url":"https://api.github.com/users/meatballspaghetti/followers","following_url":"https://api.github.com/users/meatballspaghetti/following{/other_user}","gists_url":"https://api.github.com/users/meatballspaghetti/gists{/gist_id}","starred_url":"https://api.github.com/users/meatballspaghetti/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/meatballspaghetti/subscriptions","organizations_url":"https://api.github.com/users/meatballspaghetti/orgs","repos_url":"https://api.github.com/users/meatballspaghetti/repos","events_url":"https://api.github.com/users/meatballspaghetti/events{/privacy}","received_events_url":"https://api.github.com/users/meatballspaghetti/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-22T12:19:05Z","updated_at":"2024-07-22T12:19:05Z","author_association":"CONTRIBUTOR","body":"> @meatballspaghetti - Is there a pull request for your commit to merge it into the main repo?\r\n\r\nYes, there is now #4745 .","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2242819975/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]