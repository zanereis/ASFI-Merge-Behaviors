[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005106714","html_url":"https://github.com/apache/iceberg/pull/2925#issuecomment-1005106714","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2925","id":1005106714,"node_id":"IC_kwDOCW7NX8476LYa","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-04T19:26:16Z","updated_at":"2022-01-04T19:26:16Z","author_association":"COLLABORATOR","body":"@rdblue @aokolnychyi  this is ready for another round, when you guys have time, thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005106714/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005107214","html_url":"https://github.com/apache/iceberg/issues/3582#issuecomment-1005107214","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3582","id":1005107214,"node_id":"IC_kwDOCW7NX8476LgO","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-04T19:27:03Z","updated_at":"2022-01-04T19:29:49Z","author_association":"COLLABORATOR","body":"Yep, cool, so if there's no ticket so far for adding parallelism in remove orphan , ill assign the issue for now to @dramaticlly, but let me know if there is","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005107214/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005107531","html_url":"https://github.com/apache/iceberg/pull/3813#issuecomment-1005107531","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3813","id":1005107531,"node_id":"IC_kwDOCW7NX8476LlL","user":{"login":"wizardxz","id":1550824,"node_id":"MDQ6VXNlcjE1NTA4MjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1550824?v=4","gravatar_id":"","url":"https://api.github.com/users/wizardxz","html_url":"https://github.com/wizardxz","followers_url":"https://api.github.com/users/wizardxz/followers","following_url":"https://api.github.com/users/wizardxz/following{/other_user}","gists_url":"https://api.github.com/users/wizardxz/gists{/gist_id}","starred_url":"https://api.github.com/users/wizardxz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wizardxz/subscriptions","organizations_url":"https://api.github.com/users/wizardxz/orgs","repos_url":"https://api.github.com/users/wizardxz/repos","events_url":"https://api.github.com/users/wizardxz/events{/privacy}","received_events_url":"https://api.github.com/users/wizardxz/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-04T19:27:32Z","updated_at":"2022-01-04T19:27:32Z","author_association":"NONE","body":"LGTM","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005107531/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005109596","html_url":"https://github.com/apache/iceberg/pull/3774#issuecomment-1005109596","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3774","id":1005109596,"node_id":"IC_kwDOCW7NX8476MFc","user":{"login":"wizardxz","id":1550824,"node_id":"MDQ6VXNlcjE1NTA4MjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1550824?v=4","gravatar_id":"","url":"https://api.github.com/users/wizardxz","html_url":"https://github.com/wizardxz","followers_url":"https://api.github.com/users/wizardxz/followers","following_url":"https://api.github.com/users/wizardxz/following{/other_user}","gists_url":"https://api.github.com/users/wizardxz/gists{/gist_id}","starred_url":"https://api.github.com/users/wizardxz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wizardxz/subscriptions","organizations_url":"https://api.github.com/users/wizardxz/orgs","repos_url":"https://api.github.com/users/wizardxz/repos","events_url":"https://api.github.com/users/wizardxz/events{/privacy}","received_events_url":"https://api.github.com/users/wizardxz/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-04T19:29:57Z","updated_at":"2022-01-04T19:29:57Z","author_association":"NONE","body":"LGTM","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005109596/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005111655","html_url":"https://github.com/apache/iceberg/issues/3709#issuecomment-1005111655","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3709","id":1005111655,"node_id":"IC_kwDOCW7NX8476Mln","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-04T19:33:09Z","updated_at":"2022-01-04T19:33:09Z","author_association":"CONTRIBUTOR","body":"I actually tried a PR for this. Will submit it in a few minutes.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005111655/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005120666","html_url":"https://github.com/apache/iceberg/pull/3840#issuecomment-1005120666","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3840","id":1005120666,"node_id":"IC_kwDOCW7NX8476Oya","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-04T19:47:44Z","updated_at":"2022-01-04T19:47:44Z","author_association":"CONTRIBUTOR","body":"Apart from one comment, LGTM.\r\n@izchen thanks for finding and fixing this!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005120666/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005124840","html_url":"https://github.com/apache/iceberg/pull/3799#issuecomment-1005124840","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3799","id":1005124840,"node_id":"IC_kwDOCW7NX8476Pzo","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-04T19:54:26Z","updated_at":"2022-01-04T19:54:26Z","author_association":"CONTRIBUTOR","body":"@izchen thanks for the explanation. I'd forgotten about the fact that `canDeleteWhere` was added to `SupportsDelete` only in Spark 3.1 and is not present in Spark 3.0. The fact that we didn't try to clean up all such differences when we reorganized the Spark support into separate directories tripped me up. I think I inadvertently omitted the `@Test` annotation for the new test and didn't mean to disable it, but this omission led to the CI passing.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005124840/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005129001","html_url":"https://github.com/apache/iceberg/pull/3760#issuecomment-1005129001","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3760","id":1005129001,"node_id":"IC_kwDOCW7NX8476Q0p","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-04T20:00:54Z","updated_at":"2022-01-04T20:00:54Z","author_association":"COLLABORATOR","body":"@aokolnychyi @RussellSpitzer could you guys take a look when you have some time?  Looks like the data is bad (can update the test case to make it more generic), but they are possible Parquet strings and Iceberg could be much more more graceful when getting such data","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005129001/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005129493","html_url":"https://github.com/apache/iceberg/issues/3709#issuecomment-1005129493","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3709","id":1005129493,"node_id":"IC_kwDOCW7NX8476Q8V","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-04T20:01:37Z","updated_at":"2022-01-04T20:01:37Z","author_association":"CONTRIBUTOR","body":"Here is the PR https://github.com/apache/iceberg/pull/3845","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005129493/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005138709","html_url":"https://github.com/apache/iceberg/pull/3842#issuecomment-1005138709","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3842","id":1005138709,"node_id":"IC_kwDOCW7NX8476TMV","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-04T20:15:58Z","updated_at":"2022-01-04T20:15:58Z","author_association":"CONTRIBUTOR","body":"Good catch, @xloya! Thank you for fixing this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005138709/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005257802","html_url":"https://github.com/apache/iceberg/pull/3632#issuecomment-1005257802","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3632","id":1005257802,"node_id":"IC_kwDOCW7NX8476wRK","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-04T23:46:17Z","updated_at":"2022-01-04T23:46:17Z","author_association":"CONTRIBUTOR","body":"Thanks, @CodingCat! Looks good to me. I'll merge this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005257802/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005265459","html_url":"https://github.com/apache/iceberg/issues/3835#issuecomment-1005265459","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3835","id":1005265459,"node_id":"IC_kwDOCW7NX8476yIz","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-05T00:04:32Z","updated_at":"2022-01-05T00:04:32Z","author_association":"CONTRIBUTOR","body":"It'd be better to provide more details to get help. Something like a full stack trace, what did you do to trigger the issue.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005265459/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005269353","html_url":"https://github.com/apache/iceberg/issues/3792#issuecomment-1005269353","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3792","id":1005269353,"node_id":"IC_kwDOCW7NX8476zFp","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-05T00:12:10Z","updated_at":"2022-10-19T00:22:06Z","author_association":"CONTRIBUTOR","body":"As a workaround, you can uses the the metastore APIs to drop the table. For HMS, you can fire a hive cli or a Hive Java API to do that.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005269353/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005273950","html_url":"https://github.com/apache/iceberg/issues/3783#issuecomment-1005273950","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3783","id":1005273950,"node_id":"IC_kwDOCW7NX84760Ne","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-05T00:21:55Z","updated_at":"2022-01-05T00:21:55Z","author_association":"CONTRIBUTOR","body":"@liangyouze. FYI. Table property sync between HMS and metadata.json files are going to be tricky. Other than the command \"alter table\", the other action can change the table property, for example, the table property need to be updated if you time travel the a previous version. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005273950/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005283192","html_url":"https://github.com/apache/iceberg/pull/3844#issuecomment-1005283192","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3844","id":1005283192,"node_id":"IC_kwDOCW7NX84762d4","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-05T00:40:48Z","updated_at":"2022-01-05T00:40:48Z","author_association":"CONTRIBUTOR","body":"Thanks, @smallx! This looks good and I can certainly see the desire for a quick truncate operation. The main problem is that Iceberg normally writes a delete entry for each data file that is deleted, so that snapshot expiration can clean them up. The snapshot expiration action would still work without those entries because it compares all of the reachable files in the metadata tree, but `table.expireSnapshots().commit()` would leak files if you used this. That's probably why the \"fast\" truncate is optional, right?\r\n\r\nAs for the implementation, what about making this part of the `DeleteFiles` API? You could add a `truncate` method there and detect when deleting with a `true` filter. Then this wouldn't need to add to the `Table` interface, which is already quite large.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005283192/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005319020","html_url":"https://github.com/apache/iceberg/pull/3842#issuecomment-1005319020","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3842","id":1005319020,"node_id":"IC_kwDOCW7NX8476_Ns","user":{"login":"xloya","id":26177232,"node_id":"MDQ6VXNlcjI2MTc3MjMy","avatar_url":"https://avatars.githubusercontent.com/u/26177232?v=4","gravatar_id":"","url":"https://api.github.com/users/xloya","html_url":"https://github.com/xloya","followers_url":"https://api.github.com/users/xloya/followers","following_url":"https://api.github.com/users/xloya/following{/other_user}","gists_url":"https://api.github.com/users/xloya/gists{/gist_id}","starred_url":"https://api.github.com/users/xloya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xloya/subscriptions","organizations_url":"https://api.github.com/users/xloya/orgs","repos_url":"https://api.github.com/users/xloya/repos","events_url":"https://api.github.com/users/xloya/events{/privacy}","received_events_url":"https://api.github.com/users/xloya/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-05T02:05:23Z","updated_at":"2022-01-05T02:05:23Z","author_association":"CONTRIBUTOR","body":"@rdblue Thanks for your review!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005319020/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005327948","html_url":"https://github.com/apache/iceberg/issues/3846#issuecomment-1005327948","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3846","id":1005327948,"node_id":"IC_kwDOCW7NX8477BZM","user":{"login":"Initial-neko","id":40999666,"node_id":"MDQ6VXNlcjQwOTk5NjY2","avatar_url":"https://avatars.githubusercontent.com/u/40999666?v=4","gravatar_id":"","url":"https://api.github.com/users/Initial-neko","html_url":"https://github.com/Initial-neko","followers_url":"https://api.github.com/users/Initial-neko/followers","following_url":"https://api.github.com/users/Initial-neko/following{/other_user}","gists_url":"https://api.github.com/users/Initial-neko/gists{/gist_id}","starred_url":"https://api.github.com/users/Initial-neko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Initial-neko/subscriptions","organizations_url":"https://api.github.com/users/Initial-neko/orgs","repos_url":"https://api.github.com/users/Initial-neko/repos","events_url":"https://api.github.com/users/Initial-neko/events{/privacy}","received_events_url":"https://api.github.com/users/Initial-neko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-05T02:25:46Z","updated_at":"2022-01-05T02:25:46Z","author_association":"NONE","body":"文件系统那边，你会发现metadata中版本号是冲突的。原因就是提交冲突了，平常的checkpoint提交不会这么频繁，所以在实际场景基本不会有这样的情况，sleep之后冲突的概率就变小了","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005327948/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005360552","html_url":"https://github.com/apache/iceberg/issues/3551#issuecomment-1005360552","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3551","id":1005360552,"node_id":"IC_kwDOCW7NX8477JWo","user":{"login":"Reo-LEI","id":17312872,"node_id":"MDQ6VXNlcjE3MzEyODcy","avatar_url":"https://avatars.githubusercontent.com/u/17312872?v=4","gravatar_id":"","url":"https://api.github.com/users/Reo-LEI","html_url":"https://github.com/Reo-LEI","followers_url":"https://api.github.com/users/Reo-LEI/followers","following_url":"https://api.github.com/users/Reo-LEI/following{/other_user}","gists_url":"https://api.github.com/users/Reo-LEI/gists{/gist_id}","starred_url":"https://api.github.com/users/Reo-LEI/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Reo-LEI/subscriptions","organizations_url":"https://api.github.com/users/Reo-LEI/orgs","repos_url":"https://api.github.com/users/Reo-LEI/repos","events_url":"https://api.github.com/users/Reo-LEI/events{/privacy}","received_events_url":"https://api.github.com/users/Reo-LEI/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-05T03:53:21Z","updated_at":"2022-01-05T03:53:21Z","author_association":"CONTRIBUTOR","body":"OK, I think I figure it out this problem. In #2898  of [EqualityFieldKeySelector](https://github.com/apache/iceberg/blob/14af007c7e6fa206cc44dbfde7546feb33718277/flink/v1.14/flink/src/main/java/org/apache/iceberg/flink/sink/EqualityFieldKeySelector.java#L73) return the `RowDataWrapper` as key directly. When we use RocksDB as flink state backend and distribute record through network, flink `StreamTaskNetworkOutput` will set key context by `StreamOperatorStateHandler` and RocksDB state backend will serialize the key by kryo. But kryo does not directly support serialized lamda functions, and finally we will got this error.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005360552/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005379999","html_url":"https://github.com/apache/iceberg/pull/3552#issuecomment-1005379999","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3552","id":1005379999,"node_id":"IC_kwDOCW7NX8477OGf","user":{"login":"Reo-LEI","id":17312872,"node_id":"MDQ6VXNlcjE3MzEyODcy","avatar_url":"https://avatars.githubusercontent.com/u/17312872?v=4","gravatar_id":"","url":"https://api.github.com/users/Reo-LEI","html_url":"https://github.com/Reo-LEI","followers_url":"https://api.github.com/users/Reo-LEI/followers","following_url":"https://api.github.com/users/Reo-LEI/following{/other_user}","gists_url":"https://api.github.com/users/Reo-LEI/gists{/gist_id}","starred_url":"https://api.github.com/users/Reo-LEI/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Reo-LEI/subscriptions","organizations_url":"https://api.github.com/users/Reo-LEI/orgs","repos_url":"https://api.github.com/users/Reo-LEI/repos","events_url":"https://api.github.com/users/Reo-LEI/events{/privacy}","received_events_url":"https://api.github.com/users/Reo-LEI/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-05T04:48:19Z","updated_at":"2022-01-05T04:48:19Z","author_association":"CONTRIBUTOR","body":"Thanks for your step in @rdblue @kbendick ! I figure it out this problem and wrote that on [comment](https://github.com/apache/iceberg/issues/3551#issuecomment-1005360552). \r\n\r\nI want to close this PR becasue not only the `RowDataWrapper` but also the `StructLikeWrapper` not support serialization(the lambda function of [JavaHash](https://github.com/apache/iceberg/blob/1a11038baaca9f4cf03674654a6d9a85f39a1ce1/api/src/main/java/org/apache/iceberg/types/JavaHash.java#L38) will cause the same error when kryo serialize it). So I will fix this problem on #2898 by use string as partition key.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005379999/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005419591","html_url":"https://github.com/apache/iceberg/pull/2898#issuecomment-1005419591","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2898","id":1005419591,"node_id":"IC_kwDOCW7NX8477XxH","user":{"login":"Reo-LEI","id":17312872,"node_id":"MDQ6VXNlcjE3MzEyODcy","avatar_url":"https://avatars.githubusercontent.com/u/17312872?v=4","gravatar_id":"","url":"https://api.github.com/users/Reo-LEI","html_url":"https://github.com/Reo-LEI","followers_url":"https://api.github.com/users/Reo-LEI/followers","following_url":"https://api.github.com/users/Reo-LEI/following{/other_user}","gists_url":"https://api.github.com/users/Reo-LEI/gists{/gist_id}","starred_url":"https://api.github.com/users/Reo-LEI/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Reo-LEI/subscriptions","organizations_url":"https://api.github.com/users/Reo-LEI/orgs","repos_url":"https://api.github.com/users/Reo-LEI/repos","events_url":"https://api.github.com/users/Reo-LEI/events{/privacy}","received_events_url":"https://api.github.com/users/Reo-LEI/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-05T06:34:25Z","updated_at":"2022-01-05T06:34:25Z","author_association":"CONTRIBUTOR","body":"I fix the kryo serialization problem of #3551, dose anybody can take an other look of this PR? If there are no other concerns about this PR, I think we can merge this. @rdblue @openinx @jackye1995 @stevenzwu @kbendick ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005419591/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005438345","html_url":"https://github.com/apache/iceberg/pull/3790#issuecomment-1005438345","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3790","id":1005438345,"node_id":"IC_kwDOCW7NX8477cWJ","user":{"login":"lirui-apache","id":5210788,"node_id":"MDQ6VXNlcjUyMTA3ODg=","avatar_url":"https://avatars.githubusercontent.com/u/5210788?v=4","gravatar_id":"","url":"https://api.github.com/users/lirui-apache","html_url":"https://github.com/lirui-apache","followers_url":"https://api.github.com/users/lirui-apache/followers","following_url":"https://api.github.com/users/lirui-apache/following{/other_user}","gists_url":"https://api.github.com/users/lirui-apache/gists{/gist_id}","starred_url":"https://api.github.com/users/lirui-apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lirui-apache/subscriptions","organizations_url":"https://api.github.com/users/lirui-apache/orgs","repos_url":"https://api.github.com/users/lirui-apache/repos","events_url":"https://api.github.com/users/lirui-apache/events{/privacy}","received_events_url":"https://api.github.com/users/lirui-apache/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-05T07:16:06Z","updated_at":"2022-01-05T07:16:06Z","author_association":"CONTRIBUTOR","body":"Hi @pvary , please take a look at the latest CI to find the reproduced failures.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005438345/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005444824","html_url":"https://github.com/apache/iceberg/pull/3790#issuecomment-1005444824","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3790","id":1005444824,"node_id":"IC_kwDOCW7NX8477d7Y","user":{"login":"lirui-apache","id":5210788,"node_id":"MDQ6VXNlcjUyMTA3ODg=","avatar_url":"https://avatars.githubusercontent.com/u/5210788?v=4","gravatar_id":"","url":"https://api.github.com/users/lirui-apache","html_url":"https://github.com/lirui-apache","followers_url":"https://api.github.com/users/lirui-apache/followers","following_url":"https://api.github.com/users/lirui-apache/following{/other_user}","gists_url":"https://api.github.com/users/lirui-apache/gists{/gist_id}","starred_url":"https://api.github.com/users/lirui-apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lirui-apache/subscriptions","organizations_url":"https://api.github.com/users/lirui-apache/orgs","repos_url":"https://api.github.com/users/lirui-apache/repos","events_url":"https://api.github.com/users/lirui-apache/events{/privacy}","received_events_url":"https://api.github.com/users/lirui-apache/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-05T07:29:16Z","updated_at":"2022-01-05T07:29:16Z","author_association":"CONTRIBUTOR","body":"My observation is `HMSHandler::threadLocalConf`, `HMSHandler::threadLocalTxn` and `TxnHandler::connPool` need to be cleaned up. We probably don't have to worry about `ObjectStore::prop` and `ObjectStore::pmf`, but again, I'd prefer to clean them anyway to be safe.\r\n\r\nAlternatively, we can disable JVM sharing between test classes.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005444824/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005459827","html_url":"https://github.com/apache/iceberg/pull/3840#issuecomment-1005459827","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3840","id":1005459827,"node_id":"IC_kwDOCW7NX8477hlz","user":{"login":"izchen","id":67534059,"node_id":"MDQ6VXNlcjY3NTM0MDU5","avatar_url":"https://avatars.githubusercontent.com/u/67534059?v=4","gravatar_id":"","url":"https://api.github.com/users/izchen","html_url":"https://github.com/izchen","followers_url":"https://api.github.com/users/izchen/followers","following_url":"https://api.github.com/users/izchen/following{/other_user}","gists_url":"https://api.github.com/users/izchen/gists{/gist_id}","starred_url":"https://api.github.com/users/izchen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/izchen/subscriptions","organizations_url":"https://api.github.com/users/izchen/orgs","repos_url":"https://api.github.com/users/izchen/repos","events_url":"https://api.github.com/users/izchen/events{/privacy}","received_events_url":"https://api.github.com/users/izchen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-05T07:59:11Z","updated_at":"2022-01-05T07:59:11Z","author_association":"CONTRIBUTOR","body":"Thank you everyone!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005459827/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005473503","html_url":"https://github.com/apache/iceberg/pull/3810#issuecomment-1005473503","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3810","id":1005473503,"node_id":"IC_kwDOCW7NX8477k7f","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-05T08:21:38Z","updated_at":"2022-01-05T08:21:38Z","author_association":"CONTRIBUTOR","body":"> @hililiwei: Do we have any tests for this in Parquet/Avro? I think it would b good to add some tests, so we can be sure that these configurations are working as expected.\r\n\r\n@pvary Checked, and seemed  no relevant tests. I added one unit test for ORC this time. How about let me open another PR for Parquet\\AVRO?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005473503/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005480488","html_url":"https://github.com/apache/iceberg/issues/3848#issuecomment-1005480488","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3848","id":1005480488,"node_id":"IC_kwDOCW7NX8477moo","user":{"login":"donghaihu","id":17972867,"node_id":"MDQ6VXNlcjE3OTcyODY3","avatar_url":"https://avatars.githubusercontent.com/u/17972867?v=4","gravatar_id":"","url":"https://api.github.com/users/donghaihu","html_url":"https://github.com/donghaihu","followers_url":"https://api.github.com/users/donghaihu/followers","following_url":"https://api.github.com/users/donghaihu/following{/other_user}","gists_url":"https://api.github.com/users/donghaihu/gists{/gist_id}","starred_url":"https://api.github.com/users/donghaihu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/donghaihu/subscriptions","organizations_url":"https://api.github.com/users/donghaihu/orgs","repos_url":"https://api.github.com/users/donghaihu/repos","events_url":"https://api.github.com/users/donghaihu/events{/privacy}","received_events_url":"https://api.github.com/users/donghaihu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-05T08:32:26Z","updated_at":"2022-01-05T08:32:26Z","author_association":"NONE","body":"question is commited!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005480488/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005495564","html_url":"https://github.com/apache/iceberg/pull/3681#issuecomment-1005495564","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3681","id":1005495564,"node_id":"IC_kwDOCW7NX8477qUM","user":{"login":"hameizi","id":18445460,"node_id":"MDQ6VXNlcjE4NDQ1NDYw","avatar_url":"https://avatars.githubusercontent.com/u/18445460?v=4","gravatar_id":"","url":"https://api.github.com/users/hameizi","html_url":"https://github.com/hameizi","followers_url":"https://api.github.com/users/hameizi/followers","following_url":"https://api.github.com/users/hameizi/following{/other_user}","gists_url":"https://api.github.com/users/hameizi/gists{/gist_id}","starred_url":"https://api.github.com/users/hameizi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hameizi/subscriptions","organizations_url":"https://api.github.com/users/hameizi/orgs","repos_url":"https://api.github.com/users/hameizi/repos","events_url":"https://api.github.com/users/hameizi/events{/privacy}","received_events_url":"https://api.github.com/users/hameizi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-05T08:56:26Z","updated_at":"2022-01-05T08:56:26Z","author_association":"CONTRIBUTOR","body":"@stevenzwu push one new commit fix.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005495564/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005556427","html_url":"https://github.com/apache/iceberg/pull/3670#issuecomment-1005556427","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3670","id":1005556427,"node_id":"IC_kwDOCW7NX84775LL","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-05T10:19:51Z","updated_at":"2022-01-05T10:19:51Z","author_association":"CONTRIBUTOR","body":"> > @kevinjqliu: Did you have time to check if the DDL time is changed when we only inserting to a Hive table and do not change the mertadata?\r\n> \r\n> @pvary seems like insert to the table changes the DDL time according to this. https://lists.apache.org/thread/44rr7q3wb2pfp7b5prgnb6vt2of1t41c\r\n\r\n@kevinjqliu: So Hive basically handles `DDL_TIME` incorrectly and updates it whenever there is some change to the table (maybe caused by the update of the table statistics). I would still consider this as a Hive bug and would be very cautious building features around this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005556427/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005646336","html_url":"https://github.com/apache/iceberg/pull/3790#issuecomment-1005646336","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3790","id":1005646336,"node_id":"IC_kwDOCW7NX8478PIA","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-05T12:31:29Z","updated_at":"2022-01-05T12:31:29Z","author_association":"CONTRIBUTOR","body":"> My observation is `HMSHandler::threadLocalConf`, `HMSHandler::threadLocalTxn` and `TxnHandler::connPool` need to be cleaned up. We probably don't have to worry about `ObjectStore::prop` and `ObjectStore::pmf`, but again, I'd prefer to clean them anyway to be safe.\r\n> \r\n> Alternatively, we can disable JVM sharing between test classes.\r\n\r\nThanks for the repro!\r\nI see that the issue is that the derby used by the TxnHandler throws an error when it is trying to clean up the database related items in the HMS DB. Did we see these errors in any other place then in the `AcidEventListener`?\r\n\r\nThe `AcidEventListener` creates a new TxnHandler every time when the methods are called with this code:\r\nhttps://github.com/apache/hive/blob/rel/release-2.3.9/metastore/src/java/org/apache/hadoop/hive/metastore/AcidEventListener.java#L71-L93\r\n```\r\n  private TxnStore getTxnHandler() {\r\n    boolean hackOn = HiveConf.getBoolVar(hiveConf, HiveConf.ConfVars.HIVE_IN_TEST) ||\r\n        HiveConf.getBoolVar(hiveConf, HiveConf.ConfVars.HIVE_IN_TEZ_TEST);\r\n    String origTxnMgr = null;\r\n    boolean origConcurrency = false;\r\n\r\n    // Since TxnUtils.getTxnStore calls TxnHandler.setConf -> checkQFileTestHack -> TxnDbUtil.setConfValues,\r\n    // which may change the values of below two entries, we need to avoid pulluting the original values\r\n    if (hackOn) {\r\n      origTxnMgr = hiveConf.getVar(HiveConf.ConfVars.HIVE_TXN_MANAGER);\r\n      origConcurrency = hiveConf.getBoolVar(HiveConf.ConfVars.HIVE_SUPPORT_CONCURRENCY);\r\n    }\r\n\r\n    txnHandler = TxnUtils.getTxnStore(hiveConf);\r\n\r\n    // Set them back\r\n    if (hackOn) {\r\n      hiveConf.setVar(HiveConf.ConfVars.HIVE_TXN_MANAGER, origTxnMgr);\r\n      hiveConf.setBoolVar(HiveConf.ConfVars.HIVE_SUPPORT_CONCURRENCY, origConcurrency);\r\n    }\r\n\r\n    return txnHandler;\r\n  }\r\n```\r\n\r\nThis is definitely related to the `TxnHandler::connPool` as you have correctly identified. I think if we close and set the connPool to null, then we can fix this particular issue.\r\n\r\nI would guess that the `HMSHandler::threadLocalTxn` is not related with this specific issue. Might have the same issue as above if we try to use it, but I would guess that cleaning up the connection pool would solve this issue as well, as the TxnHandler itself is mostly stateless.\r\n\r\nI think `HMSHandler::threadLocalConf` is unrelated to the above and can cause issues when initialising the default databases, roles etc. This could be solved by this in `TestHiveMetastore::newThriftServer`:\r\n```\r\n    baseHandler = HMS_HANDLER_CTOR.newInstance(\"new db based metaserver\", serverConf, false);\r\n    baseHandler.setConf(serverConf);\r\n    baseHandler.init();\r\n```\r\nBasically the `setConf` fixes the configuration issue, and calling the `init()` after `setConf` ensures that it already uses the correct configuration.\r\n\r\nIf I understand correctly all of the issues are caused by using a different derby root directory for the HMS instances. Before your fix we were trying to set different root directory for the derby, but effectively we were using the first one used for this thread. And since the files were not removed we were not having any issues. After the fix the directories were removed and this caused issues when we tried to read the derby files.\r\n\r\nSo an alternative solution could be reusing the same derby db between tests, and deleting the data between the tests, and deleting the files only at the JVM exit. In this case we would not need any magic in the test code.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005646336/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005657705","html_url":"https://github.com/apache/iceberg/pull/3810#issuecomment-1005657705","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3810","id":1005657705,"node_id":"IC_kwDOCW7NX8478R5p","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-05T12:48:29Z","updated_at":"2022-01-05T12:48:29Z","author_association":"CONTRIBUTOR","body":"@szlta: Would you mind taking a look at the tests?\r\n\r\nThanks,\r\nPeter","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005657705/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005675333","html_url":"https://github.com/apache/iceberg/pull/3790#issuecomment-1005675333","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3790","id":1005675333,"node_id":"IC_kwDOCW7NX8478WNF","user":{"login":"lirui-apache","id":5210788,"node_id":"MDQ6VXNlcjUyMTA3ODg=","avatar_url":"https://avatars.githubusercontent.com/u/5210788?v=4","gravatar_id":"","url":"https://api.github.com/users/lirui-apache","html_url":"https://github.com/lirui-apache","followers_url":"https://api.github.com/users/lirui-apache/followers","following_url":"https://api.github.com/users/lirui-apache/following{/other_user}","gists_url":"https://api.github.com/users/lirui-apache/gists{/gist_id}","starred_url":"https://api.github.com/users/lirui-apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lirui-apache/subscriptions","organizations_url":"https://api.github.com/users/lirui-apache/orgs","repos_url":"https://api.github.com/users/lirui-apache/repos","events_url":"https://api.github.com/users/lirui-apache/events{/privacy}","received_events_url":"https://api.github.com/users/lirui-apache/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-05T13:14:14Z","updated_at":"2022-01-05T13:14:14Z","author_association":"CONTRIBUTOR","body":">So an alternative solution could be reusing the same derby db between tests, and deleting the data between the tests, and deleting the files only at the JVM exit. In this case we would not need any magic in the test code.\r\n\r\nYes. I think that's also a viable solution. And we can go back with a shutdown hook like the 1st version of this PR.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005675333/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005739482","html_url":"https://github.com/apache/iceberg/pull/3844#issuecomment-1005739482","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3844","id":1005739482,"node_id":"IC_kwDOCW7NX8478l3a","user":{"login":"smallx","id":16517035,"node_id":"MDQ6VXNlcjE2NTE3MDM1","avatar_url":"https://avatars.githubusercontent.com/u/16517035?v=4","gravatar_id":"","url":"https://api.github.com/users/smallx","html_url":"https://github.com/smallx","followers_url":"https://api.github.com/users/smallx/followers","following_url":"https://api.github.com/users/smallx/following{/other_user}","gists_url":"https://api.github.com/users/smallx/gists{/gist_id}","starred_url":"https://api.github.com/users/smallx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/smallx/subscriptions","organizations_url":"https://api.github.com/users/smallx/orgs","repos_url":"https://api.github.com/users/smallx/repos","events_url":"https://api.github.com/users/smallx/events{/privacy}","received_events_url":"https://api.github.com/users/smallx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-05T14:36:20Z","updated_at":"2022-01-05T14:36:20Z","author_association":"CONTRIBUTOR","body":"Thanks for reviewing, @rdblue! I updated the code. I use `fastMode` (false by default) just to keep consistent with the behavior of Spark SQL `TRUNCATE TABLE ...`. I didn't notice the possible file leaks problem of `table.expireSnapshots().commit()` before.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005739482/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005889983","html_url":"https://github.com/apache/iceberg/pull/3837#issuecomment-1005889983","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3837","id":1005889983,"node_id":"IC_kwDOCW7NX8479Km_","user":{"login":"smallx","id":16517035,"node_id":"MDQ6VXNlcjE2NTE3MDM1","avatar_url":"https://avatars.githubusercontent.com/u/16517035?v=4","gravatar_id":"","url":"https://api.github.com/users/smallx","html_url":"https://github.com/smallx","followers_url":"https://api.github.com/users/smallx/followers","following_url":"https://api.github.com/users/smallx/following{/other_user}","gists_url":"https://api.github.com/users/smallx/gists{/gist_id}","starred_url":"https://api.github.com/users/smallx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/smallx/subscriptions","organizations_url":"https://api.github.com/users/smallx/orgs","repos_url":"https://api.github.com/users/smallx/repos","events_url":"https://api.github.com/users/smallx/events{/privacy}","received_events_url":"https://api.github.com/users/smallx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-05T16:43:26Z","updated_at":"2022-01-05T16:43:26Z","author_association":"CONTRIBUTOR","body":"Thanks @rdblue! I have updated the code.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005889983/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005943631","html_url":"https://github.com/apache/iceberg/issues/3665#issuecomment-1005943631","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3665","id":1005943631,"node_id":"IC_kwDOCW7NX8479XtP","user":{"login":"nssalian","id":8526007,"node_id":"MDQ6VXNlcjg1MjYwMDc=","avatar_url":"https://avatars.githubusercontent.com/u/8526007?v=4","gravatar_id":"","url":"https://api.github.com/users/nssalian","html_url":"https://github.com/nssalian","followers_url":"https://api.github.com/users/nssalian/followers","following_url":"https://api.github.com/users/nssalian/following{/other_user}","gists_url":"https://api.github.com/users/nssalian/gists{/gist_id}","starred_url":"https://api.github.com/users/nssalian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nssalian/subscriptions","organizations_url":"https://api.github.com/users/nssalian/orgs","repos_url":"https://api.github.com/users/nssalian/repos","events_url":"https://api.github.com/users/nssalian/events{/privacy}","received_events_url":"https://api.github.com/users/nssalian/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-05T17:50:50Z","updated_at":"2022-01-05T17:50:50Z","author_association":"CONTRIBUTOR","body":"@huaxingao , following up on this. Any update if this might be on the roadmap for Spark to add it part of the Dataframe,etc API?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005943631/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005955651","html_url":"https://github.com/apache/iceberg/issues/3665#issuecomment-1005955651","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3665","id":1005955651,"node_id":"IC_kwDOCW7NX8479apD","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-05T18:07:00Z","updated_at":"2022-01-05T18:07:00Z","author_association":"MEMBER","body":"I think we could add some implicits in Iceberg's Scala Modules outside of Spark as well. That might be a good path forward","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005955651/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005965139","html_url":"https://github.com/apache/iceberg/issues/3665#issuecomment-1005965139","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3665","id":1005965139,"node_id":"IC_kwDOCW7NX8479c9T","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-05T18:15:28Z","updated_at":"2022-01-05T18:15:28Z","author_association":"CONTRIBUTOR","body":"Sorry I didn't have a chance to check with the Spark SQL folks yet. Will do and get back to you this week.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005965139/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006039573","html_url":"https://github.com/apache/iceberg/issues/3849#issuecomment-1006039573","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3849","id":1006039573,"node_id":"IC_kwDOCW7NX8479vIV","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-05T20:06:10Z","updated_at":"2022-01-05T20:06:10Z","author_association":"MEMBER","body":"I'm not sure I see what schema is missing or being changed, can you narrow down your example? You can also use \r\n``` \r\n```json \r\n{\r\n  \"some\" : \"json\"\r\n}\r\n_```\r\n```\r\n (ignore the _) to wrap json code blocks","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006039573/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006097589","html_url":"https://github.com/apache/iceberg/issues/2976#issuecomment-1006097589","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2976","id":1006097589,"node_id":"IC_kwDOCW7NX84799S1","user":{"login":"gustavoatt","id":1475634,"node_id":"MDQ6VXNlcjE0NzU2MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/1475634?v=4","gravatar_id":"","url":"https://api.github.com/users/gustavoatt","html_url":"https://github.com/gustavoatt","followers_url":"https://api.github.com/users/gustavoatt/followers","following_url":"https://api.github.com/users/gustavoatt/following{/other_user}","gists_url":"https://api.github.com/users/gustavoatt/gists{/gist_id}","starred_url":"https://api.github.com/users/gustavoatt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gustavoatt/subscriptions","organizations_url":"https://api.github.com/users/gustavoatt/orgs","repos_url":"https://api.github.com/users/gustavoatt/repos","events_url":"https://api.github.com/users/gustavoatt/events{/privacy}","received_events_url":"https://api.github.com/users/gustavoatt/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-05T21:37:42Z","updated_at":"2022-01-05T21:37:42Z","author_association":"CONTRIBUTOR","body":"I'm seeing something similar only with Spark 3.1.x (it works fine on Spark 2.4.x and Spark 3.2.x) from my tests. Here is a repro I was able to create:\r\n\r\n```sql\r\nCREATE TABLE test_table (\r\n    `meta_data` STRUCT<`event_schema`: STRING, `id`: STRING, `tiers`: ARRAY<STRUCT<`id`: STRING, `type`: STRING, `hostname`: STRING, `ip_address`: STRING, `timestamp`: BIGINT, `sequences`: ARRAY<STRUCT<`key`: ARRAY<STRING>, `value`: BIGINT, `bytes_sent`: BIGINT>>>>, `kafka_metadata`: STRUCT<`topic`: STRING, `partition`: INT, `offset`: BIGINT>, `properties`: MAP<STRING, STRING>, `message_type`: STRING>,\r\n    `schema_version` STRING,\r\n    `context_user_id` BIGINT,\r\n    `context_visitor_id` STRING,\r\n    `schema` STRING,\r\n    `event_name` STRING,\r\n    `context` STRUCT<`timestamp`: BIGINT, `source`: STRING, `platform`: STRING, `user_agent`: STRING, `version`: STRING, `bev`: STRING, `user_id`: BIGINT, `hash_user_id`: STRING, `language`: STRING, `locale`: STRING, `campaign`: STRING, `affiliate_id`: STRING, `screen_width`: BIGINT, `screen_height`: BIGINT, `web`: STRUCT<`controller`: STRING, `page`: STRING, `action`: STRING, `rendered_on`: STRING, `viewport`: STRING, `req_uuid`: STRING, `page_uri`: STRING, `page_referrer`: STRING, `canonical_url`: STRING, `shardset`: STRING, `local_time`: STRING, `queued`: BOOLEAN, `canonical_host`: STRING, `app`: STRING, `section_id`: STRING>, `monorail`: STRUCT<`controller`: STRING, `action`: STRING, `api_client_id`: STRING, `api_device_id`: STRING, `api_client_name`: STRING, `api_protocol`: STRING, `api_version`: STRING, `api_resource`: STRING, `api_format`: STRING, `api_intents`: STRING>, `mobile`: STRUCT<`device_type`: STRING, `device_id`: STRING, `version_code`: BIGINT, `screen_orientation`: STRING, `network_type`: STRING, `carrier_name`: STRING, `carrier_country`: STRING, `build_type`: STRING, `view_class_name`: STRING, `native_mode`: STRING, `module_name`: STRING>, `extra_data`: MAP<STRING, STRING>, `client_session_id`: STRING, `bev_expiry`: STRING, `service_context`: STRUCT<`service_name`: STRING, `local_request_id`: STRING, `http_method_type`: STRING, `endpoint_name`: STRING, `global_request_chain_id`: STRING>, `page_name`: STRING, `amp_id`: STRING, `req_remote_host`: STRING, `amp_client_session_id`: STRING, `previous_page_name`: STRING, `visitor_id`: STRING, `impression_uuid`: STRING, `api_request_id`: STRING, `max_deferred_minutes`: BIGINT, `environment`: STRING, `device`: STRUCT<`device_year_class`: STRING>, `traffic_type`: STRING, `context_api_client_id`: STRING>,\r\n    `experiment` STRING,\r\n    `treatment` STRING,\r\n    `subject_type` STRING,\r\n    `subject_id` STRING,\r\n    `client` STRING,\r\n    `client_version` STRING,\r\n    `user_id` STRING,\r\n    `visitor_id` STRING,\r\n    `misa_id` STRING,\r\n    `listing_id` STRING,\r\n    `extra_data` MAP<STRING, STRING>,\r\n    `ds` STRING,\r\n    `hr` STRING\r\n)\r\nUSING iceberg\r\nPARTITIONED BY (ds, hr);\r\n\r\n-- Insert only nulls (but error happens even with non-null columns)\r\nINSERT INTO test_table (\r\n    meta_data,\r\n    schema_version,\r\n    context_user_id,\r\n    context_visitor_id,\r\n    schema,\r\n    event_name,\r\n    context,\r\n    experiment,\r\n    treatment,\r\n    subject_type,\r\n    subject_id,\r\n    client,\r\n    client_version,\r\n    user_id,\r\n    visitor_id,\r\n    misa_id,\r\n    listing_id,\r\n    extra_data,\r\n    ds,\r\n    hr\r\n)\r\nVALUES (\r\n    null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, '2022-01-01', '10'\r\n);\r\n\r\n-- If we select everything we have no issue whatsoever.\r\nSELECT *\r\nFROM test_table;\r\n\r\n-- However, if we try to filter based on any column we get a class cast exception, even though the results should be the\r\n-- same.\r\nSELECT *\r\nFROM test_table\r\nWHERE hr = '10';\r\n\r\n-- The same query above works if we select fewer columns. In this case selecting < 14 columns works correctly\r\nselect\r\n    meta_data,\r\n    schema_version,\r\n    context_user_id,\r\n    context_visitor_id,\r\n    schema,\r\n    event_name,\r\n    context,\r\n    experiment,\r\n    treatment,\r\n    subject_type,\r\n    subject_id,\r\n    client,\r\n    client_version,\r\n    user_id,\r\n    hr\r\nfrom test_table\r\nWHERE hr = '10';\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006097589/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006124021","html_url":"https://github.com/apache/iceberg/pull/3770#issuecomment-1006124021","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3770","id":1006124021,"node_id":"IC_kwDOCW7NX847-Dv1","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-05T22:20:42Z","updated_at":"2022-01-05T22:20:42Z","author_association":"CONTRIBUTOR","body":"@rymurr, any comments? We'd like to start working on the follow ups if you have a chance to take a look.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006124021/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006184999","html_url":"https://github.com/apache/iceberg/issues/3846#issuecomment-1006184999","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3846","id":1006184999,"node_id":"IC_kwDOCW7NX847-Son","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-06T00:27:13Z","updated_at":"2022-01-06T00:27:13Z","author_association":"CONTRIBUTOR","body":"Agree with @Initial-neko. Some \"insert\" might fail.\r\nTo verify it, you can execute the following command to get all snapshots after the execution. There are going to be 10 snapshots if all \"insert\" succeed.\r\n```\r\nselect * from test_ods_preview_read_data.snapshots\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006184999/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006189591","html_url":"https://github.com/apache/iceberg/issues/3833#issuecomment-1006189591","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3833","id":1006189591,"node_id":"IC_kwDOCW7NX847-TwX","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-06T00:38:04Z","updated_at":"2022-01-06T00:38:04Z","author_association":"CONTRIBUTOR","body":"You probably miss some scala lib in your job classpath. Here are a list of scala libs in my Spark job classpath for your reference.\r\n```\r\nscala-collection-compat_2.12-2.1.1.jar\r\nscala-compiler-2.12.15.jar\r\nscala-library-2.12.15.jar\r\nscala-parser-combinators_2.12-1.1.2.jar\r\nscala-reflect-2.12.15.jar\r\nscala-xml_2.12-1.2.0.jar\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006189591/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006214040","html_url":"https://github.com/apache/iceberg/pull/3852#issuecomment-1006214040","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3852","id":1006214040,"node_id":"IC_kwDOCW7NX847-ZuY","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-06T01:35:56Z","updated_at":"2022-01-06T01:35:56Z","author_association":"CONTRIBUTOR","body":"Hmm, the Flink CI must be flaky. The failing test passes for me locally.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006214040/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006216178","html_url":"https://github.com/apache/iceberg/issues/3783#issuecomment-1006216178","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3783","id":1006216178,"node_id":"IC_kwDOCW7NX847-aPy","user":{"login":"nssalian","id":8526007,"node_id":"MDQ6VXNlcjg1MjYwMDc=","avatar_url":"https://avatars.githubusercontent.com/u/8526007?v=4","gravatar_id":"","url":"https://api.github.com/users/nssalian","html_url":"https://github.com/nssalian","followers_url":"https://api.github.com/users/nssalian/followers","following_url":"https://api.github.com/users/nssalian/following{/other_user}","gists_url":"https://api.github.com/users/nssalian/gists{/gist_id}","starred_url":"https://api.github.com/users/nssalian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nssalian/subscriptions","organizations_url":"https://api.github.com/users/nssalian/orgs","repos_url":"https://api.github.com/users/nssalian/repos","events_url":"https://api.github.com/users/nssalian/events{/privacy}","received_events_url":"https://api.github.com/users/nssalian/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-06T01:41:47Z","updated_at":"2022-01-06T01:41:47Z","author_association":"CONTRIBUTOR","body":"@pvary do you know if there's a clean way to set the PartitionSpec into the Metastore while creating a table using the Hive Catalog? I see your code setting properties but would setting partition spec be \r\nFor the Hive Catalog, I see that the partition spec column names (`PKEY_NAME`) aren’t stored in the Hive Metastore in the `PARTITION_KEYS`. I don’t see the code doing anything for Partition spec. Ideally, it would have been great to have the partition spec column be a partition key so it can be represented in the schema.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006216178/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006268406","html_url":"https://github.com/apache/iceberg/pull/2807#issuecomment-1006268406","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2807","id":1006268406,"node_id":"IC_kwDOCW7NX847-m_2","user":{"login":"figurant","id":33807389,"node_id":"MDQ6VXNlcjMzODA3Mzg5","avatar_url":"https://avatars.githubusercontent.com/u/33807389?v=4","gravatar_id":"","url":"https://api.github.com/users/figurant","html_url":"https://github.com/figurant","followers_url":"https://api.github.com/users/figurant/followers","following_url":"https://api.github.com/users/figurant/following{/other_user}","gists_url":"https://api.github.com/users/figurant/gists{/gist_id}","starred_url":"https://api.github.com/users/figurant/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/figurant/subscriptions","organizations_url":"https://api.github.com/users/figurant/orgs","repos_url":"https://api.github.com/users/figurant/repos","events_url":"https://api.github.com/users/figurant/events{/privacy}","received_events_url":"https://api.github.com/users/figurant/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-06T04:06:39Z","updated_at":"2022-01-06T04:06:39Z","author_association":"NONE","body":"@wang-x-xia Hello, we are trying to use ecs and iceberg to build lake follow by this Dell doc https://www.delltechnologies.com/asset/zh-cn/products/storage/industry-market/apache-iceberg-dell-emc-ecs.pdf\r\nwhere can we find this jar? iceberg-ecs-catalog-0.12.0.jar\r\nthanks.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006268406/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006285191","html_url":"https://github.com/apache/iceberg/issues/2976#issuecomment-1006285191","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2976","id":1006285191,"node_id":"IC_kwDOCW7NX847-rGH","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-06T04:57:25Z","updated_at":"2022-01-06T04:59:06Z","author_association":"CONTRIBUTOR","body":"Which version(s) of Iceberg have people tried this with, and have _any_ been successful? Need to know if this is a regression or possibly a regression in Spark itself.\r\n\r\nAlso, does this work with plain Spark (if anybody has tried)?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006285191/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006286239","html_url":"https://github.com/apache/iceberg/issues/3849#issuecomment-1006286239","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3849","id":1006286239,"node_id":"IC_kwDOCW7NX847-rWf","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-06T05:00:58Z","updated_at":"2022-01-06T05:02:11Z","author_association":"MEMBER","body":"@naveenkrdremio \r\nI tried in 0.12.1 with my own testcase. I didn't face the issue. My testcase:\r\n\r\n ```\r\nsql(\"CREATE TABLE %s (id bigint NOT NULL, data string) USING iceberg\", tableName);\r\n\r\n    sql(\"INSERT INTO TABLE %s VALUES (1, 'a')\", tableName);\r\n    sql(\"INSERT INTO TABLE %s VALUES (2, 'b')\", tableName);\r\n\r\n    Table table = validationCatalog.loadTable(tableIdent);\r\n\r\n    Assert.assertEquals(\"Should be 2 snapshots\", 2, Iterables.size(table.snapshots()));\r\n\r\n    waitUntilAfter(table.currentSnapshot().timestampMillis());\r\n\r\n    sql(\"ALTER TABLE %s ADD COLUMN count1 int\", tableName);\r\n    sql(\"INSERT INTO TABLE %s VALUES (2, 'c', 10)\", tableName);\r\n\r\n    Timestamp currentTimestamp = Timestamp.from(Instant.ofEpochMilli(System.currentTimeMillis()));\r\n\r\n    table = validationCatalog.loadTable(tableIdent);\r\n    List<Long> id = new ArrayList<>();\r\n    table.snapshots().forEach(x -> id.add(x.snapshotId()));\r\n    table.expireSnapshots().expireSnapshotId(id.get(id.size() - 2)).commit();\r\n```\r\n\r\nFew observations: \r\n\r\nFrom your description, In V24 optional schema-id in the snapshots field is missing. But In V23 also I can see it is missing for the first snapshot. So, V23 is also result of previous expire snapshots ? \r\nAs Russell said better to narrow down further. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006286239/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006293595","html_url":"https://github.com/apache/iceberg/pull/3770#issuecomment-1006293595","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3770","id":1006293595,"node_id":"IC_kwDOCW7NX847-tJb","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-06T05:21:33Z","updated_at":"2022-01-06T05:21:33Z","author_association":"CONTRIBUTOR","body":"> @rymurr, any comments? We'd like to start working on the follow ups if you have a chance to take a look.\r\n\r\ncc @nastra as well @rymurr in case you have any final comments on the doc as it is. I know it's a lot to ingest, but I think if we can get this initial doc in, then we can hopefully make things smaller and begin to follow a more consistent pattern that we'll adapt to as we  all work more with OpenAPI.\r\n\r\nPlease keep in mind this is just the first of many patches and things to get this off the ground, so that work can begin somewhat more parallelized. Also, once we're all working on this API, if things need to be changed for practical reasons etc, I'm not opposed to that. I think those things will become more apparent as we make more progress.  😄 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006293595/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006309018","html_url":"https://github.com/apache/iceberg/pull/2639#issuecomment-1006309018","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2639","id":1006309018,"node_id":"IC_kwDOCW7NX847-w6a","user":{"login":"liujinhui1994","id":25769285,"node_id":"MDQ6VXNlcjI1NzY5Mjg1","avatar_url":"https://avatars.githubusercontent.com/u/25769285?v=4","gravatar_id":"","url":"https://api.github.com/users/liujinhui1994","html_url":"https://github.com/liujinhui1994","followers_url":"https://api.github.com/users/liujinhui1994/followers","following_url":"https://api.github.com/users/liujinhui1994/following{/other_user}","gists_url":"https://api.github.com/users/liujinhui1994/gists{/gist_id}","starred_url":"https://api.github.com/users/liujinhui1994/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liujinhui1994/subscriptions","organizations_url":"https://api.github.com/users/liujinhui1994/orgs","repos_url":"https://api.github.com/users/liujinhui1994/repos","events_url":"https://api.github.com/users/liujinhui1994/events{/privacy}","received_events_url":"https://api.github.com/users/liujinhui1994/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-06T06:06:05Z","updated_at":"2022-01-06T06:06:05Z","author_association":"NONE","body":"@ggershinsky  hello，Is there any latest development of this feature, we are looking forward to this feature","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006309018/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006319328","html_url":"https://github.com/apache/iceberg/pull/3460#issuecomment-1006319328","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3460","id":1006319328,"node_id":"IC_kwDOCW7NX847-zbg","user":{"login":"izchen","id":67534059,"node_id":"MDQ6VXNlcjY3NTM0MDU5","avatar_url":"https://avatars.githubusercontent.com/u/67534059?v=4","gravatar_id":"","url":"https://api.github.com/users/izchen","html_url":"https://github.com/izchen","followers_url":"https://api.github.com/users/izchen/followers","following_url":"https://api.github.com/users/izchen/following{/other_user}","gists_url":"https://api.github.com/users/izchen/gists{/gist_id}","starred_url":"https://api.github.com/users/izchen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/izchen/subscriptions","organizations_url":"https://api.github.com/users/izchen/orgs","repos_url":"https://api.github.com/users/izchen/repos","events_url":"https://api.github.com/users/izchen/events{/privacy}","received_events_url":"https://api.github.com/users/izchen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-06T06:32:45Z","updated_at":"2022-01-06T06:32:45Z","author_association":"CONTRIBUTOR","body":"I found a related trino community MR in the email. The current behavior of spark iceberg is used in this MR UT.\r\nhttps://github.com/trinodb/trino/pull/10214","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006319328/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006322589","html_url":"https://github.com/apache/iceberg/pull/3460#issuecomment-1006322589","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3460","id":1006322589,"node_id":"IC_kwDOCW7NX847-0Od","user":{"login":"izchen","id":67534059,"node_id":"MDQ6VXNlcjY3NTM0MDU5","avatar_url":"https://avatars.githubusercontent.com/u/67534059?v=4","gravatar_id":"","url":"https://api.github.com/users/izchen","html_url":"https://github.com/izchen","followers_url":"https://api.github.com/users/izchen/followers","following_url":"https://api.github.com/users/izchen/following{/other_user}","gists_url":"https://api.github.com/users/izchen/gists{/gist_id}","starred_url":"https://api.github.com/users/izchen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/izchen/subscriptions","organizations_url":"https://api.github.com/users/izchen/orgs","repos_url":"https://api.github.com/users/izchen/repos","events_url":"https://api.github.com/users/izchen/events{/privacy}","received_events_url":"https://api.github.com/users/izchen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-06T06:41:25Z","updated_at":"2022-01-06T06:41:25Z","author_association":"CONTRIBUTOR","body":"Do you think this PR is necessary? if not, I will close this PR.  Ping @rdblue @kbendick :)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006322589/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006325491","html_url":"https://github.com/apache/iceberg/issues/3849#issuecomment-1006325491","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3849","id":1006325491,"node_id":"IC_kwDOCW7NX847-07z","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-06T06:49:17Z","updated_at":"2022-01-06T06:49:17Z","author_association":"MEMBER","body":"@naveenkrdremio : I see only possibility of this issue happening is when we use iceberg version older than 0.12.1.\r\nBy any chance are you having two iceberg versions (which are not same)\r\none for spark create tables and one for java expire snapshot ?\r\n\r\nSo, basically no issue here, you might be using older iceberg version (which doesn't have schema id writing code)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006325491/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006327300","html_url":"https://github.com/apache/iceberg/issues/3849#issuecomment-1006327300","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3849","id":1006327300,"node_id":"IC_kwDOCW7NX847-1YE","user":{"login":"naveenkrdremio","id":85875105,"node_id":"MDQ6VXNlcjg1ODc1MTA1","avatar_url":"https://avatars.githubusercontent.com/u/85875105?v=4","gravatar_id":"","url":"https://api.github.com/users/naveenkrdremio","html_url":"https://github.com/naveenkrdremio","followers_url":"https://api.github.com/users/naveenkrdremio/followers","following_url":"https://api.github.com/users/naveenkrdremio/following{/other_user}","gists_url":"https://api.github.com/users/naveenkrdremio/gists{/gist_id}","starred_url":"https://api.github.com/users/naveenkrdremio/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/naveenkrdremio/subscriptions","organizations_url":"https://api.github.com/users/naveenkrdremio/orgs","repos_url":"https://api.github.com/users/naveenkrdremio/repos","events_url":"https://api.github.com/users/naveenkrdremio/events{/privacy}","received_events_url":"https://api.github.com/users/naveenkrdremio/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-06T06:53:58Z","updated_at":"2022-01-06T06:53:58Z","author_association":"NONE","body":"Thanks @ajantha-bhat .  Yes I was on two diff versions. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006327300/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006352825","html_url":"https://github.com/apache/iceberg/issues/3783#issuecomment-1006352825","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3783","id":1006352825,"node_id":"IC_kwDOCW7NX847-7m5","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-06T07:51:46Z","updated_at":"2022-01-06T07:51:46Z","author_association":"CONTRIBUTOR","body":"@nssalian: With Hive 2.x and 3.x you can chose from the following possibilities:\r\n- For identity partitions:\r\n```\r\nCREATE TABLE database_a.table_a (\r\n  id bigint, name string\r\n) PARTITIONED BY (\r\n  dept string\r\n) STORED BY 'org.apache.iceberg.mr.hive.HiveIcebergStorageHandler';\r\n```\r\n- For other partitioning schemas one can use the json formatted schema and partition specification - this is very hard to use, and we do not really recommend it:\r\n```\r\nCREATE EXTERNAL TABLE customers STORED BY 'org.apache.iceberg.mr.hive.HiveIcebergStorageHandler'\r\nLOCATION '.../default/customers'\r\nTBLPROPERTIES (\r\n   'iceberg.mr.table.schema'='{\"type\":\"struct\",\"schema-id\":0,\"fields\":[{\"id\":1,\"name\":\"customer_id\",\"required\":false,\"type\":\"long\"},{\"id\":2,\"name\":\"first_name\",\"required\":false,\"type\":\"string\",\"doc\":\"This is first name\"},{\"id\":3,\"name\":\"last_name\",\"required\":false,\"type\":\"string\",\"doc\":\"This is last name\"}]}',\r\n   'iceberg.mr.table.partition.spec'='{\"spec-id\":0,\"fields\":[]}')\r\n```\r\n\r\nIn Hive master @lcspinter created a PR which changes the Hive syntax and one can create tables with Iceberg partitioning schemas (https://issues.apache.org/jira/browse/HIVE-25179):\r\n```\r\nCREATE TABLE ... PARTITIONED BY SPEC( year(year_field), month(month_field), day(day_field), hour(hour_field), truncate(3, truncate_field), bucket(5, bucket_field bucket), identity_field ) STORED BY ICEBERG;\r\n```\r\n\r\nI hope this helps.\r\n\r\nThanks,\r\nPeter","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006352825/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006360787","html_url":"https://github.com/apache/iceberg/pull/3851#issuecomment-1006360787","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3851","id":1006360787,"node_id":"IC_kwDOCW7NX847-9jT","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-06T08:07:28Z","updated_at":"2022-01-06T08:07:28Z","author_association":"CONTRIBUTOR","body":"Can I use this to register an arbitrary table from any catalog (HadoopTable or HadoopCatalog or GlueCatalog) to the HiveCatalog?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006360787/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006426585","html_url":"https://github.com/apache/iceberg/pull/3231#issuecomment-1006426585","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3231","id":1006426585,"node_id":"IC_kwDOCW7NX847_NnZ","user":{"login":"liujinhui1994","id":25769285,"node_id":"MDQ6VXNlcjI1NzY5Mjg1","avatar_url":"https://avatars.githubusercontent.com/u/25769285?v=4","gravatar_id":"","url":"https://api.github.com/users/liujinhui1994","html_url":"https://github.com/liujinhui1994","followers_url":"https://api.github.com/users/liujinhui1994/followers","following_url":"https://api.github.com/users/liujinhui1994/following{/other_user}","gists_url":"https://api.github.com/users/liujinhui1994/gists{/gist_id}","starred_url":"https://api.github.com/users/liujinhui1994/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liujinhui1994/subscriptions","organizations_url":"https://api.github.com/users/liujinhui1994/orgs","repos_url":"https://api.github.com/users/liujinhui1994/repos","events_url":"https://api.github.com/users/liujinhui1994/events{/privacy}","received_events_url":"https://api.github.com/users/liujinhui1994/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-06T09:54:44Z","updated_at":"2022-01-06T09:54:44Z","author_association":"NONE","body":"@ggershinsky  Is this PR still going on?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006426585/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006465450","html_url":"https://github.com/apache/iceberg/pull/2807#issuecomment-1006465450","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2807","id":1006465450,"node_id":"IC_kwDOCW7NX847_XGq","user":{"login":"mechgouki","id":8364215,"node_id":"MDQ6VXNlcjgzNjQyMTU=","avatar_url":"https://avatars.githubusercontent.com/u/8364215?v=4","gravatar_id":"","url":"https://api.github.com/users/mechgouki","html_url":"https://github.com/mechgouki","followers_url":"https://api.github.com/users/mechgouki/followers","following_url":"https://api.github.com/users/mechgouki/following{/other_user}","gists_url":"https://api.github.com/users/mechgouki/gists{/gist_id}","starred_url":"https://api.github.com/users/mechgouki/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mechgouki/subscriptions","organizations_url":"https://api.github.com/users/mechgouki/orgs","repos_url":"https://api.github.com/users/mechgouki/repos","events_url":"https://api.github.com/users/mechgouki/events{/privacy}","received_events_url":"https://api.github.com/users/mechgouki/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-06T10:43:28Z","updated_at":"2022-01-06T10:43:28Z","author_association":"NONE","body":"> @wang-x-xia Hello, we are trying to use ecs and iceberg to build lake follow by this Dell doc https://www.delltechnologies.com/asset/zh-cn/products/storage/industry-market/apache-iceberg-dell-emc-ecs.pdf where can we find this jar? iceberg-ecs-catalog-0.12.0.jar thanks.\r\n\r\nWe was planned to merged this change into Iceberg 0.13 - but due to holiday , it did not happened.  So please send mail to dell emc channel to get the official support. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006465450/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006487455","html_url":"https://github.com/apache/iceberg/pull/2639#issuecomment-1006487455","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2639","id":1006487455,"node_id":"IC_kwDOCW7NX847_cef","user":{"login":"ggershinsky","id":12033212,"node_id":"MDQ6VXNlcjEyMDMzMjEy","avatar_url":"https://avatars.githubusercontent.com/u/12033212?v=4","gravatar_id":"","url":"https://api.github.com/users/ggershinsky","html_url":"https://github.com/ggershinsky","followers_url":"https://api.github.com/users/ggershinsky/followers","following_url":"https://api.github.com/users/ggershinsky/following{/other_user}","gists_url":"https://api.github.com/users/ggershinsky/gists{/gist_id}","starred_url":"https://api.github.com/users/ggershinsky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ggershinsky/subscriptions","organizations_url":"https://api.github.com/users/ggershinsky/orgs","repos_url":"https://api.github.com/users/ggershinsky/repos","events_url":"https://api.github.com/users/ggershinsky/events{/privacy}","received_events_url":"https://api.github.com/users/ggershinsky/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-06T11:11:51Z","updated_at":"2022-01-06T11:11:51Z","author_association":"CONTRIBUTOR","body":"hi @liujinhui1994 , yes, this feature is under active development. Per the community discussions, the encryption PRs will be updated in Q1'22; probably I'll have the commits ready later this month or in Feb.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006487455/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006487901","html_url":"https://github.com/apache/iceberg/pull/3231#issuecomment-1006487901","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3231","id":1006487901,"node_id":"IC_kwDOCW7NX847_cld","user":{"login":"ggershinsky","id":12033212,"node_id":"MDQ6VXNlcjEyMDMzMjEy","avatar_url":"https://avatars.githubusercontent.com/u/12033212?v=4","gravatar_id":"","url":"https://api.github.com/users/ggershinsky","html_url":"https://github.com/ggershinsky","followers_url":"https://api.github.com/users/ggershinsky/followers","following_url":"https://api.github.com/users/ggershinsky/following{/other_user}","gists_url":"https://api.github.com/users/ggershinsky/gists{/gist_id}","starred_url":"https://api.github.com/users/ggershinsky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ggershinsky/subscriptions","organizations_url":"https://api.github.com/users/ggershinsky/orgs","repos_url":"https://api.github.com/users/ggershinsky/repos","events_url":"https://api.github.com/users/ggershinsky/events{/privacy}","received_events_url":"https://api.github.com/users/ggershinsky/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-06T11:12:27Z","updated_at":"2022-01-06T11:12:27Z","author_association":"CONTRIBUTOR","body":"same as in https://github.com/apache/iceberg/pull/2639#issuecomment-1006487455","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006487901/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006642314","html_url":"https://github.com/apache/iceberg/issues/3843#issuecomment-1006642314","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3843","id":1006642314,"node_id":"IC_kwDOCW7NX848ACSK","user":{"login":"krisdas","id":5305131,"node_id":"MDQ6VXNlcjUzMDUxMzE=","avatar_url":"https://avatars.githubusercontent.com/u/5305131?v=4","gravatar_id":"","url":"https://api.github.com/users/krisdas","html_url":"https://github.com/krisdas","followers_url":"https://api.github.com/users/krisdas/followers","following_url":"https://api.github.com/users/krisdas/following{/other_user}","gists_url":"https://api.github.com/users/krisdas/gists{/gist_id}","starred_url":"https://api.github.com/users/krisdas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/krisdas/subscriptions","organizations_url":"https://api.github.com/users/krisdas/orgs","repos_url":"https://api.github.com/users/krisdas/repos","events_url":"https://api.github.com/users/krisdas/events{/privacy}","received_events_url":"https://api.github.com/users/krisdas/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-06T14:39:53Z","updated_at":"2022-01-06T14:39:53Z","author_association":"CONTRIBUTOR","body":"We encountered same problem and couldn't find a good solution. So we wrote some hacky code, which needs to be called by the client repeatedly after specific interval (essentially pull model). In the hacky code, we simply check, whether the asked partition exists or not, by running a query like \"select count(*) where partition=input partition\" and checking if the count is > 0.\r\n\r\nThis hacky code was not written in python but just as a console scala app, which can be called easily from airflow using bash operator. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006642314/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006666174","html_url":"https://github.com/apache/iceberg/issues/2976#issuecomment-1006666174","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2976","id":1006666174,"node_id":"IC_kwDOCW7NX848AIG-","user":{"login":"gustavoatt","id":1475634,"node_id":"MDQ6VXNlcjE0NzU2MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/1475634?v=4","gravatar_id":"","url":"https://api.github.com/users/gustavoatt","html_url":"https://github.com/gustavoatt","followers_url":"https://api.github.com/users/gustavoatt/followers","following_url":"https://api.github.com/users/gustavoatt/following{/other_user}","gists_url":"https://api.github.com/users/gustavoatt/gists{/gist_id}","starred_url":"https://api.github.com/users/gustavoatt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gustavoatt/subscriptions","organizations_url":"https://api.github.com/users/gustavoatt/orgs","repos_url":"https://api.github.com/users/gustavoatt/repos","events_url":"https://api.github.com/users/gustavoatt/events{/privacy}","received_events_url":"https://api.github.com/users/gustavoatt/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-06T15:10:45Z","updated_at":"2022-01-06T15:10:45Z","author_association":"CONTRIBUTOR","body":"@kbendick so far this is failing on Iceberg 0.12.x and on current master (as of yesterday). Let me test it out on 0.11 to verify whether it also happens on that version.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006666174/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006706504","html_url":"https://github.com/apache/iceberg/issues/2976#issuecomment-1006706504","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2976","id":1006706504,"node_id":"IC_kwDOCW7NX848AR9I","user":{"login":"edgarRd","id":266670,"node_id":"MDQ6VXNlcjI2NjY3MA==","avatar_url":"https://avatars.githubusercontent.com/u/266670?v=4","gravatar_id":"","url":"https://api.github.com/users/edgarRd","html_url":"https://github.com/edgarRd","followers_url":"https://api.github.com/users/edgarRd/followers","following_url":"https://api.github.com/users/edgarRd/following{/other_user}","gists_url":"https://api.github.com/users/edgarRd/gists{/gist_id}","starred_url":"https://api.github.com/users/edgarRd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/edgarRd/subscriptions","organizations_url":"https://api.github.com/users/edgarRd/orgs","repos_url":"https://api.github.com/users/edgarRd/repos","events_url":"https://api.github.com/users/edgarRd/events{/privacy}","received_events_url":"https://api.github.com/users/edgarRd/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-06T16:02:48Z","updated_at":"2022-01-06T16:03:41Z","author_association":"CONTRIBUTOR","body":"I don't think Iceberg `0.11` was compatible with Spark `3.1.x` but it may be worth checking if Spark `3.0.x` still works with Iceberg `0.11` as it does with `0.12`.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006706504/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006716342","html_url":"https://github.com/apache/iceberg/issues/2976#issuecomment-1006716342","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2976","id":1006716342,"node_id":"IC_kwDOCW7NX848AUW2","user":{"login":"gustavoatt","id":1475634,"node_id":"MDQ6VXNlcjE0NzU2MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/1475634?v=4","gravatar_id":"","url":"https://api.github.com/users/gustavoatt","html_url":"https://github.com/gustavoatt","followers_url":"https://api.github.com/users/gustavoatt/followers","following_url":"https://api.github.com/users/gustavoatt/following{/other_user}","gists_url":"https://api.github.com/users/gustavoatt/gists{/gist_id}","starred_url":"https://api.github.com/users/gustavoatt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gustavoatt/subscriptions","organizations_url":"https://api.github.com/users/gustavoatt/orgs","repos_url":"https://api.github.com/users/gustavoatt/repos","events_url":"https://api.github.com/users/gustavoatt/events{/privacy}","received_events_url":"https://api.github.com/users/gustavoatt/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-06T16:15:39Z","updated_at":"2022-01-06T16:15:39Z","author_association":"CONTRIBUTOR","body":"That's correct, iceberg `0.11` doesn't have support for Spark `3.1.x`. I'v tested iceberg `0.11` with Spark `3.0.x` and it works correctly.\r\n\r\nI also tested with plain Spark and there are no issues. I can only reproduce the error with Spark `3.1.x`  from Iceberg `>= 0.12`.\r\n\r\nHere is a test I ran from within the Iceberg repo that reproduces the issue:\r\n\r\n```diff\r\ndiff --git a/spark/v3.1/spark-extensions/src/test/java/org/apache/iceberg/spark/extensions/TestIcebergExpressions.java b/spark/v3.1/spark-extensions/src/test/java/org/apache/iceberg/spar\r\nindex ce88814c..e2f37f59 100644\r\n--- a/spark/v3.1/spark-extensions/src/test/java/org/apache/iceberg/spark/extensions/TestIcebergExpressions.java\r\n+++ b/spark/v3.1/spark-extensions/src/test/java/org/apache/iceberg/spark/extensions/TestIcebergExpressions.java\r\n@@ -28,6 +28,7 @@ import org.apache.spark.sql.Row;\r\n import org.apache.spark.sql.catalyst.expressions.IcebergTruncateTransform;\r\n import org.junit.After;\r\n import org.junit.Test;\r\n+import org.junit.Assert;\r\n\r\n public class TestIcebergExpressions extends SparkExtensionsTestBase {\r\n\r\n@@ -67,4 +68,64 @@ public class TestIcebergExpressions extends SparkExtensionsTestBase {\r\n         ImmutableList.of(row(100, 10000L, new BigDecimal(\"10.50\"), \"10\", \"12\")),\r\n         sql(\"SELECT int_c, long_c, dec_c, str_c, CAST(binary_c AS STRING) FROM v\"));\r\n   }\r\n+\r\n+  @Test\r\n+  public void testSelectAndFilterWithManyRows() {\r\n+    sql(\"DROP TABLE IF EXISTS %s\", tableName);\r\n+    sql(\"CREATE TABLE %s (\\n\" +\r\n+            \"  `meta_data` STRUCT<`event_schema`: STRING, `id`: STRING, `tiers`: ARRAY<STRUCT<`id`: STRING, `type`: STRING, `hostname`: STRING, `ip_address`: STRING, `timestamp`: BIGINT\r\n+            \"  `schema_version` STRING,\\n\" +\r\n+            \"  `context_user_id` BIGINT,\\n\" +\r\n+            \"  `context_visitor_id` STRING,\\n\" +\r\n+            \"  `schema` STRING,\\n\" +\r\n+            \"  `event_name` STRING,\\n\" +\r\n+            \"  `context` STRUCT<`timestamp`: BIGINT, `source`: STRING, `platform`: STRING, `user_agent`: STRING, `version`: STRING, `bev`: STRING, `user_id`: BIGINT, `hash_user_id`: STR\r\n+            \"  `experiment` STRING,\\n\" +\r\n+            \"  `treatment` STRING,\\n\" +\r\n+            \"  `subject_type` STRING,\\n\" +\r\n+            \"  `subject_id` STRING,\\n\" +\r\n+            \"  `client` STRING,\\n\" +\r\n+            \"  `client_version` STRING,\\n\" +\r\n+            \"  `user_id` STRING,\\n\" +\r\n+            \"  `visitor_id` STRING,\\n\" +\r\n+            \"  `misa_id` STRING,\\n\" +\r\n+            \"  `listing_id` STRING,\\n\" +\r\n+            \"  `extra_data` MAP<STRING, STRING>,\\n\" +\r\n+            \"  `ds` STRING,\\n\" +\r\n+            \"  `hr` STRING)\\n\" +\r\n+            \"USING iceberg\\n\" +\r\n+            \"PARTITIONED BY (ds, hr)\\n\", tableName);\r\n+\r\n+    sql(\r\n+        \"INSERT INTO %s (\\n\"\r\n+            + \"    meta_data,\\n\"\r\n+            + \"    schema_version,\\n\"\r\n+            + \"    context_user_id,\\n\"\r\n+            + \"    context_visitor_id,\\n\"\r\n+            + \"    schema,\\n\"\r\n+            + \"    event_name,\\n\"\r\n+            + \"    context,\\n\"\r\n+            + \"    experiment,\\n\"\r\n+            + \"    treatment,\\n\"\r\n+            + \"    subject_type,\\n\"\r\n+            + \"    subject_id,\\n\"\r\n+            + \"    client,\\n\"\r\n+            + \"    client_version,\\n\"\r\n+            + \"    user_id,\\n\"\r\n+            + \"    visitor_id,\\n\"\r\n+            + \"    misa_id,\\n\"\r\n+            + \"    listing_id,\\n\"\r\n+            + \"    extra_data,\\n\"\r\n+            + \"    ds,\\n\"\r\n+            + \"    hr\\n\"\r\n+            + \")\\n\"\r\n+            + \"VALUES (\\n\"\r\n+            + \"    null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, '2022-01-01', '10'         \\n\"\r\n+            + \")\",\r\n+        tableName);\r\n+\r\n+    Assert.assertEquals(1, sql(\"SELECT * FROM %s\", tableName).size());\r\n+\r\n+    Assert.assertEquals(1, sql(\"SELECT * FROM %s WHERE hr = '10'\", tableName).size());\r\n+  }\r\n }\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006716342/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006765201","html_url":"https://github.com/apache/iceberg/pull/3845#issuecomment-1006765201","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3845","id":1006765201,"node_id":"IC_kwDOCW7NX848AgSR","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-06T17:20:44Z","updated_at":"2022-01-06T17:20:44Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer @kbendick \r\nCould you please check one more time when you have a chance? Thank you very much!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006765201/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006767435","html_url":"https://github.com/apache/iceberg/pull/3745#issuecomment-1006767435","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3745","id":1006767435,"node_id":"IC_kwDOCW7NX848Ag1L","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-06T17:23:56Z","updated_at":"2022-01-06T17:23:56Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer @kbendick \r\nCould you please take one more look when you have time? Thanks a lot!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006767435/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":1},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006772135","html_url":"https://github.com/apache/iceberg/pull/3852#issuecomment-1006772135","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3852","id":1006772135,"node_id":"IC_kwDOCW7NX848Ah-n","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-06T17:30:29Z","updated_at":"2022-01-06T17:30:29Z","author_association":"CONTRIBUTOR","body":"@rdblue @jackye1995 @yyanyy this is the fallback part of using the snapshot schema when reading a snapshot. (It does not have to make it into 0.13.)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006772135/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006957232","html_url":"https://github.com/apache/iceberg/pull/3803#issuecomment-1006957232","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3803","id":1006957232,"node_id":"IC_kwDOCW7NX848BPKw","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-06T21:45:15Z","updated_at":"2022-01-06T21:45:15Z","author_association":"CONTRIBUTOR","body":"cc @racevedoo.\r\n\r\nAlso, maybe this change should wait until after the release, like with https://github.com/apache/iceberg/pull/3815? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006957232/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006974012","html_url":"https://github.com/apache/iceberg/pull/3803#issuecomment-1006974012","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3803","id":1006974012,"node_id":"IC_kwDOCW7NX848BTQ8","user":{"login":"racevedoo","id":5193063,"node_id":"MDQ6VXNlcjUxOTMwNjM=","avatar_url":"https://avatars.githubusercontent.com/u/5193063?v=4","gravatar_id":"","url":"https://api.github.com/users/racevedoo","html_url":"https://github.com/racevedoo","followers_url":"https://api.github.com/users/racevedoo/followers","following_url":"https://api.github.com/users/racevedoo/following{/other_user}","gists_url":"https://api.github.com/users/racevedoo/gists{/gist_id}","starred_url":"https://api.github.com/users/racevedoo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/racevedoo/subscriptions","organizations_url":"https://api.github.com/users/racevedoo/orgs","repos_url":"https://api.github.com/users/racevedoo/repos","events_url":"https://api.github.com/users/racevedoo/events{/privacy}","received_events_url":"https://api.github.com/users/racevedoo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-06T22:14:58Z","updated_at":"2022-01-06T22:14:58Z","author_association":"CONTRIBUTOR","body":"> cc @racevedoo.\n> \n> Also, maybe this change should wait until after the release, like with https://github.com/apache/iceberg/pull/3815? \n\nThis looks good to me, but I guess it can wait until after the release","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1006974012/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1007001251","html_url":"https://github.com/apache/iceberg/issues/3665#issuecomment-1007001251","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3665","id":1007001251,"node_id":"IC_kwDOCW7NX848BZ6j","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-06T23:08:04Z","updated_at":"2022-01-06T23:08:04Z","author_association":"CONTRIBUTOR","body":"Yes, it is possible to add the `Merge` API into `DataFrameWriterV2`. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1007001251/reactions","total_count":8,"+1":5,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":3,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1007022493","html_url":"https://github.com/apache/iceberg/pull/3845#issuecomment-1007022493","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3845","id":1007022493,"node_id":"IC_kwDOCW7NX848BfGd","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-06T23:52:29Z","updated_at":"2022-01-06T23:52:29Z","author_association":"CONTRIBUTOR","body":"> Is it correct to say that we can ignore checkConflict when we know there is no conflict? Like in the transformSpec, we can set checkConflict to false because we're already adding partitionPrefix?\r\nMy understanding is that we can ignore checkConflict when we know there is no conflict.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1007022493/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1007024823","html_url":"https://github.com/apache/iceberg/pull/3845#issuecomment-1007024823","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3845","id":1007024823,"node_id":"IC_kwDOCW7NX848Bfq3","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-06T23:58:33Z","updated_at":"2022-01-06T23:58:33Z","author_association":"MEMBER","body":"> > Is it correct to say that we can ignore checkConflict when we know there is no conflict? Like in the transformSpec, we can set checkConflict to false because we're already adding partitionPrefix?\r\n> > My understanding is that we can ignore checkConflict when we know there is no conflict.\r\n\r\nThat's what I think is a little broken in the current api, we have a \"buildUnchecked\" method which I would think should ignore all conflicts and such but since we check for conflicts during the \"identity\" method we can't get to that point","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1007024823/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1007072575","html_url":"https://github.com/apache/iceberg/pull/3817#issuecomment-1007072575","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3817","id":1007072575,"node_id":"IC_kwDOCW7NX848BrU_","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-07T01:44:19Z","updated_at":"2022-01-07T01:44:19Z","author_association":"CONTRIBUTOR","body":"> Thanks for taking this on @hililiwei!\r\n> \r\n> I left a few nits / open questions.\r\n> \r\n> Can we also add a test that disables locality and then performs a read to ensure that the new `FlinkInputSplit` works correctly when locality is disabled?\r\n\r\n@kbendick Thanks for your review. I'll try to add a unit test, and keep reported when get any progress.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1007072575/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1007074772","html_url":"https://github.com/apache/iceberg/pull/3797#issuecomment-1007074772","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3797","id":1007074772,"node_id":"IC_kwDOCW7NX848Br3U","user":{"login":"yittg","id":4429171,"node_id":"MDQ6VXNlcjQ0MjkxNzE=","avatar_url":"https://avatars.githubusercontent.com/u/4429171?v=4","gravatar_id":"","url":"https://api.github.com/users/yittg","html_url":"https://github.com/yittg","followers_url":"https://api.github.com/users/yittg/followers","following_url":"https://api.github.com/users/yittg/following{/other_user}","gists_url":"https://api.github.com/users/yittg/gists{/gist_id}","starred_url":"https://api.github.com/users/yittg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yittg/subscriptions","organizations_url":"https://api.github.com/users/yittg/orgs","repos_url":"https://api.github.com/users/yittg/repos","events_url":"https://api.github.com/users/yittg/events{/privacy}","received_events_url":"https://api.github.com/users/yittg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-07T01:50:16Z","updated_at":"2022-01-07T01:50:16Z","author_association":"CONTRIBUTOR","body":"@rdblue Do you think this make sense? Or what do you think?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1007074772/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1007086191","html_url":"https://github.com/apache/iceberg/issues/3853#issuecomment-1007086191","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3853","id":1007086191,"node_id":"IC_kwDOCW7NX848Bupv","user":{"login":"flyxu1991","id":72590534,"node_id":"MDQ6VXNlcjcyNTkwNTM0","avatar_url":"https://avatars.githubusercontent.com/u/72590534?v=4","gravatar_id":"","url":"https://api.github.com/users/flyxu1991","html_url":"https://github.com/flyxu1991","followers_url":"https://api.github.com/users/flyxu1991/followers","following_url":"https://api.github.com/users/flyxu1991/following{/other_user}","gists_url":"https://api.github.com/users/flyxu1991/gists{/gist_id}","starred_url":"https://api.github.com/users/flyxu1991/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyxu1991/subscriptions","organizations_url":"https://api.github.com/users/flyxu1991/orgs","repos_url":"https://api.github.com/users/flyxu1991/repos","events_url":"https://api.github.com/users/flyxu1991/events{/privacy}","received_events_url":"https://api.github.com/users/flyxu1991/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-07T02:18:09Z","updated_at":"2022-01-07T02:50:37Z","author_association":"NONE","body":"@RussellSpitzer @SreeramGarlapati may you help me to have a look at this issue","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1007086191/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1007133866","html_url":"https://github.com/apache/iceberg/pull/3856#issuecomment-1007133866","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3856","id":1007133866,"node_id":"IC_kwDOCW7NX848B6Sq","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-07T04:32:40Z","updated_at":"2022-01-07T04:32:40Z","author_association":"MEMBER","body":"CC: @jasonhughes248 , @rdblue , @rymurr ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1007133866/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1007150482","html_url":"https://github.com/apache/iceberg/issues/2976#issuecomment-1007150482","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2976","id":1007150482,"node_id":"IC_kwDOCW7NX848B-WS","user":{"login":"dev-lpq","id":43336508,"node_id":"MDQ6VXNlcjQzMzM2NTA4","avatar_url":"https://avatars.githubusercontent.com/u/43336508?v=4","gravatar_id":"","url":"https://api.github.com/users/dev-lpq","html_url":"https://github.com/dev-lpq","followers_url":"https://api.github.com/users/dev-lpq/followers","following_url":"https://api.github.com/users/dev-lpq/following{/other_user}","gists_url":"https://api.github.com/users/dev-lpq/gists{/gist_id}","starred_url":"https://api.github.com/users/dev-lpq/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dev-lpq/subscriptions","organizations_url":"https://api.github.com/users/dev-lpq/orgs","repos_url":"https://api.github.com/users/dev-lpq/repos","events_url":"https://api.github.com/users/dev-lpq/events{/privacy}","received_events_url":"https://api.github.com/users/dev-lpq/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-07T05:24:52Z","updated_at":"2022-01-07T05:24:52Z","author_association":"NONE","body":"@gustavoatt I have solved this issue. please check the jira, I think the case can solve the issue. \r\nhttps://issues.apache.org/jira/browse/SPARK-37621\r\nAnd suggest you can update the spark version to 3.2.0\r\nhttps://issues.apache.org/jira/browse/SPARK-35287","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1007150482/reactions","total_count":4,"+1":4,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1007212455","html_url":"https://github.com/apache/iceberg/pull/3857#issuecomment-1007212455","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3857","id":1007212455,"node_id":"IC_kwDOCW7NX848CNen","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-07T08:03:51Z","updated_at":"2022-01-07T08:08:24Z","author_association":"CONTRIBUTOR","body":"Thanks @openinx \r\n\r\n_Some questions for more context:_\r\n\r\nIs this due to Flink 1.13 only (e.g. fixed / not known to occur in 1.14 or 1.12) or did you just choose to implement in 1.13 for another reason?\r\n\r\n_Personal thoughts / comments:_\r\n\r\nThe SerializableSupplier is written as is to avoid calls to get on the user-side, but if that's prohibiting Kryo usage then I agree that it should be changed if need be.\r\n\r\nWe should likely consider updating the usage of `SerializableSupplier` to be consistent across versions eventually, even if it only affects one version, for ease of backporting etc.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1007212455/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1007243161","html_url":"https://github.com/apache/iceberg/pull/3857#issuecomment-1007243161","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3857","id":1007243161,"node_id":"IC_kwDOCW7NX848CU-Z","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-07T09:01:42Z","updated_at":"2022-01-07T09:01:42Z","author_association":"MEMBER","body":"> Is this due to Flink 1.13 only (e.g. fixed / not known to occur in 1.14 or 1.12) or did you just choose to implement in 1.13 for another reason?\r\n\r\nThe fix for `SerializableTable`  should be okay for all the flink versions.  I'm trying to add this test casest flink 1.13 firstly, it should also be applied to other flink versions. I think I will port those to flink 1.12  & flink 1.13 then.\r\n\r\n> The SerializableSupplier is written as is to avoid calls to get on the user-side. \r\n\r\nI think the `SerializableSupplier` is mainly designed for resolving the hadoop `Configuration` serialization & deserialization issues.  We maintain all the key-value pairs inside the in-memory HashMap from the hadoop `Configuration` and then restore to the hadoop `Configuration`  once we've transferred those bytes to engines's DAG operators ( Saying `SerializableSupplier#get`).\r\n\r\nThe current patch don't change the previous intentional design, instead it is trying to implement it in another way to fix the  flink kyro serialization issues. \r\n\r\nYes, I agree it's worth to port those test cases to other flink versions.\r\n\r\nThanks.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1007243161/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1007265607","html_url":"https://github.com/apache/iceberg/pull/3770#issuecomment-1007265607","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3770","id":1007265607,"node_id":"IC_kwDOCW7NX848CadH","user":{"login":"rymurr","id":2022305,"node_id":"MDQ6VXNlcjIwMjIzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/2022305?v=4","gravatar_id":"","url":"https://api.github.com/users/rymurr","html_url":"https://github.com/rymurr","followers_url":"https://api.github.com/users/rymurr/followers","following_url":"https://api.github.com/users/rymurr/following{/other_user}","gists_url":"https://api.github.com/users/rymurr/gists{/gist_id}","starred_url":"https://api.github.com/users/rymurr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rymurr/subscriptions","organizations_url":"https://api.github.com/users/rymurr/orgs","repos_url":"https://api.github.com/users/rymurr/repos","events_url":"https://api.github.com/users/rymurr/events{/privacy}","received_events_url":"https://api.github.com/users/rymurr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-07T09:37:23Z","updated_at":"2022-01-07T09:37:23Z","author_association":"CONTRIBUTOR","body":"Please don't wait for me. I will get to it next week and we can do a follow\nup if I raise anything.\n\n\n\nOn Thu, Jan 6, 2022 at 6:21 AM Kyle Bendickson ***@***.***>\nwrote:\n\n> @rymurr <https://github.com/rymurr>, any comments? We'd like to start\n> working on the follow ups if you have a chance to take a look.\n>\n> cc @nastra <https://github.com/nastra> as well @rymurr\n> <https://github.com/rymurr> in case you have any final comments on the\n> doc as it is. I know it's a lot to ingest, but I think if we can get this\n> initial doc in, then we can hopefully make things smaller and begin to\n> follow a more consistent pattern that we'll adapt to as we all work more\n> with OpenAPI.\n>\n> Please keep in mind this is just the first of many patches and things to\n> get this off the ground, so that work can begin somewhat more parallelized.\n> Also, once we're all working on this API, if things need to be changed for\n> practical reasons etc, I'm not opposed to that. I think those things will\n> become more apparent as we make more progress. 😄\n>\n> —\n> Reply to this email directly, view it on GitHub\n> <https://github.com/apache/iceberg/pull/3770#issuecomment-1006293595>, or\n> unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/AAPNXIL4GEPQKYMPM3KLX53UUURGTANCNFSM5KJ7LIWA>\n> .\n> You are receiving this because you were mentioned.Message ID:\n> ***@***.***>\n>\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1007265607/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1007409833","html_url":"https://github.com/apache/iceberg/pull/3857#issuecomment-1007409833","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3857","id":1007409833,"node_id":"IC_kwDOCW7NX848C9qp","user":{"login":"marton-bod","id":19599214,"node_id":"MDQ6VXNlcjE5NTk5MjE0","avatar_url":"https://avatars.githubusercontent.com/u/19599214?v=4","gravatar_id":"","url":"https://api.github.com/users/marton-bod","html_url":"https://github.com/marton-bod","followers_url":"https://api.github.com/users/marton-bod/followers","following_url":"https://api.github.com/users/marton-bod/following{/other_user}","gists_url":"https://api.github.com/users/marton-bod/gists{/gist_id}","starred_url":"https://api.github.com/users/marton-bod/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marton-bod/subscriptions","organizations_url":"https://api.github.com/users/marton-bod/orgs","repos_url":"https://api.github.com/users/marton-bod/repos","events_url":"https://api.github.com/users/marton-bod/events{/privacy}","received_events_url":"https://api.github.com/users/marton-bod/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-07T13:31:24Z","updated_at":"2022-01-07T13:31:24Z","author_association":"COLLABORATOR","body":"@openinx I'm assuming we would need a similar solution on the Hive side for this lamba?\r\nhttps://github.com/apache/iceberg/blob/master/mr/src/main/java/org/apache/iceberg/mr/hive/HiveIcebergStorageHandler.java#L209\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1007409833/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1007598045","html_url":"https://github.com/apache/iceberg/issues/2976#issuecomment-1007598045","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2976","id":1007598045,"node_id":"IC_kwDOCW7NX848Drnd","user":{"login":"gustavoatt","id":1475634,"node_id":"MDQ6VXNlcjE0NzU2MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/1475634?v=4","gravatar_id":"","url":"https://api.github.com/users/gustavoatt","html_url":"https://github.com/gustavoatt","followers_url":"https://api.github.com/users/gustavoatt/followers","following_url":"https://api.github.com/users/gustavoatt/following{/other_user}","gists_url":"https://api.github.com/users/gustavoatt/gists{/gist_id}","starred_url":"https://api.github.com/users/gustavoatt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gustavoatt/subscriptions","organizations_url":"https://api.github.com/users/gustavoatt/orgs","repos_url":"https://api.github.com/users/gustavoatt/repos","events_url":"https://api.github.com/users/gustavoatt/events{/privacy}","received_events_url":"https://api.github.com/users/gustavoatt/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-07T17:36:33Z","updated_at":"2022-01-07T17:36:33Z","author_association":"CONTRIBUTOR","body":"That's great @dev-lpq, thank you! Will try upgrading to Spark 3.2.0","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1007598045/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1007606883","html_url":"https://github.com/apache/iceberg/issues/3783#issuecomment-1007606883","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3783","id":1007606883,"node_id":"IC_kwDOCW7NX848Dtxj","user":{"login":"nssalian","id":8526007,"node_id":"MDQ6VXNlcjg1MjYwMDc=","avatar_url":"https://avatars.githubusercontent.com/u/8526007?v=4","gravatar_id":"","url":"https://api.github.com/users/nssalian","html_url":"https://github.com/nssalian","followers_url":"https://api.github.com/users/nssalian/followers","following_url":"https://api.github.com/users/nssalian/following{/other_user}","gists_url":"https://api.github.com/users/nssalian/gists{/gist_id}","starred_url":"https://api.github.com/users/nssalian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nssalian/subscriptions","organizations_url":"https://api.github.com/users/nssalian/orgs","repos_url":"https://api.github.com/users/nssalian/repos","events_url":"https://api.github.com/users/nssalian/events{/privacy}","received_events_url":"https://api.github.com/users/nssalian/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-07T17:50:26Z","updated_at":"2022-01-07T17:50:26Z","author_association":"CONTRIBUTOR","body":"Thanks for the response @pvary. I think identity partitions might suffice my use case.\r\nI should have added this in the initial note but I wanted to check if using \r\n```hiveCatalog.createTable(tableIdentifier, icebergSchema, icebergPSpec)``` to create a table makes an entry into the PARTITION_KEY. I checked the Metastore Db and I couldn't find it. Do you think we need to change the implementation to add partition information for this API call? I think it adds all the columns as regular columns.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1007606883/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1007617994","html_url":"https://github.com/apache/iceberg/pull/3844#issuecomment-1007617994","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3844","id":1007617994,"node_id":"IC_kwDOCW7NX848DwfK","user":{"login":"smallx","id":16517035,"node_id":"MDQ6VXNlcjE2NTE3MDM1","avatar_url":"https://avatars.githubusercontent.com/u/16517035?v=4","gravatar_id":"","url":"https://api.github.com/users/smallx","html_url":"https://github.com/smallx","followers_url":"https://api.github.com/users/smallx/followers","following_url":"https://api.github.com/users/smallx/following{/other_user}","gists_url":"https://api.github.com/users/smallx/gists{/gist_id}","starred_url":"https://api.github.com/users/smallx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/smallx/subscriptions","organizations_url":"https://api.github.com/users/smallx/orgs","repos_url":"https://api.github.com/users/smallx/repos","events_url":"https://api.github.com/users/smallx/events{/privacy}","received_events_url":"https://api.github.com/users/smallx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-07T18:04:57Z","updated_at":"2022-01-07T18:04:57Z","author_association":"CONTRIBUTOR","body":"I'm trying to fix possible file leaks in `table.expireSnapshots().commit()`.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1007617994/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1007663657","html_url":"https://github.com/apache/iceberg/pull/3857#issuecomment-1007663657","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3857","id":1007663657,"node_id":"IC_kwDOCW7NX848D7op","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-07T19:07:55Z","updated_at":"2022-01-07T19:08:29Z","author_association":"CONTRIBUTOR","body":"> > Is this due to Flink 1.13 only (e.g. fixed / not known to occur in 1.14 or 1.12) or did you just choose to implement in 1.13 for another reason?\r\n> \r\n> The fix for `SerializableTable` should be okay for all the flink versions. I'm trying to add this test casest flink 1.13 firstly, it should also be applied to other flink versions. I think I will port those to flink 1.12 & flink 1.13 then.\r\n\r\nPerfect. I just wasn't sure as sometimes people do 1.14 for new PRs (or Spark 3.2 for example). Since it wasn't latest, that's what made me ask if maybe this was 1.13 specific. But it's absolutely ok to do it in 1.13 first for review purposes. Thanks for clarifying!\r\n\r\n> > The SerializableSupplier is written as is to avoid calls to get on the user-side.\r\n> \r\n> I think the `SerializableSupplier` is mainly designed for resolving the hadoop `Configuration` serialization & deserialization issues. We maintain all the key-value pairs inside the in-memory HashMap from the hadoop `Configuration` and then restore to the hadoop `Configuration` once we've transferred those bytes to engines's DAG operators ( Saying `SerializableSupplier#get`).\r\n> \r\n> The current patch don't change the previous intentional design, instead it is trying to implement it in another way to fix the flink kyro serialization issues.\r\n\r\nThat's correct. My mistake. I meant the current usage that has the `::get` call inside of `serializeConfWith`. A minor historical detail. You are right, that the SerializableSupplier is to deal with SerDe issues. This doesn't change that. Sorry for any confusion.  👍 \r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1007663657/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1007769255","html_url":"https://github.com/apache/iceberg/pull/3770#issuecomment-1007769255","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3770","id":1007769255,"node_id":"IC_kwDOCW7NX848EVan","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-07T21:58:14Z","updated_at":"2022-01-07T21:58:14Z","author_association":"CONTRIBUTOR","body":"I merged this and we can pick up changes from @rymurr's review as we extend this. Thanks @jackye1995 and everyone on the original PR for all the input, and especially to @kbendick for getting this ready!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1007769255/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1007798382","html_url":"https://github.com/apache/iceberg/pull/3845#issuecomment-1007798382","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3845","id":1007798382,"node_id":"IC_kwDOCW7NX848Echu","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-07T22:46:16Z","updated_at":"2022-01-07T22:46:16Z","author_association":"CONTRIBUTOR","body":"Thank you very much everyone! ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1007798382/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1007809606","html_url":"https://github.com/apache/iceberg/pull/3837#issuecomment-1007809606","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3837","id":1007809606,"node_id":"IC_kwDOCW7NX848EfRG","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-07T23:09:40Z","updated_at":"2022-01-07T23:09:40Z","author_association":"CONTRIBUTOR","body":"Thanks for working on this, @smallx! I've been thinking about this since it wasn't clear at first what the behavior of a caching catalog _should_ be when a table is dropped and re-created. In the end, I think that the behavior in this PR is correct: if you call `REFRESH TABLE` then it should invalidate the cache and the next call to `load` should return whatever table is referenced by the given name.\r\n\r\nI think that the right way to implement this is actually a more direct approach, like your current version rather than the initial version. The `Catalog` should expose an `invalidateTable` method that should evict the table from the cache. A subsequent call to `loadTable` should reload the table. That's slightly different from the current version:\r\n1. We should add `invalidateTable` to `Catalog` so that you don't need to cast the catalog to `CachingCatalog`\r\n    * The default implementation should be a noop\r\n2. `SparkCatalog.invalidateTable` should not call `load`. Instead, the next table load should result in loading the table.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1007809606/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1007827860","html_url":"https://github.com/apache/iceberg/pull/3851#issuecomment-1007827860","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3851","id":1007827860,"node_id":"IC_kwDOCW7NX848EjuU","user":{"login":"anuragmantri","id":13743212,"node_id":"MDQ6VXNlcjEzNzQzMjEy","avatar_url":"https://avatars.githubusercontent.com/u/13743212?v=4","gravatar_id":"","url":"https://api.github.com/users/anuragmantri","html_url":"https://github.com/anuragmantri","followers_url":"https://api.github.com/users/anuragmantri/followers","following_url":"https://api.github.com/users/anuragmantri/following{/other_user}","gists_url":"https://api.github.com/users/anuragmantri/gists{/gist_id}","starred_url":"https://api.github.com/users/anuragmantri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/anuragmantri/subscriptions","organizations_url":"https://api.github.com/users/anuragmantri/orgs","repos_url":"https://api.github.com/users/anuragmantri/repos","events_url":"https://api.github.com/users/anuragmantri/events{/privacy}","received_events_url":"https://api.github.com/users/anuragmantri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-07T23:57:09Z","updated_at":"2022-01-07T23:57:09Z","author_association":"CONTRIBUTOR","body":"> Can I use this to register an arbitrary table from any catalog (HadoopTable or HadoopCatalog or GlueCatalog) to the HiveCatalog?\r\n\r\n@pvary - Yes, all this needs is the latest metadata file.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1007827860/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1007884015","html_url":"https://github.com/apache/iceberg/pull/3837#issuecomment-1007884015","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3837","id":1007884015,"node_id":"IC_kwDOCW7NX848Exbv","user":{"login":"smallx","id":16517035,"node_id":"MDQ6VXNlcjE2NTE3MDM1","avatar_url":"https://avatars.githubusercontent.com/u/16517035?v=4","gravatar_id":"","url":"https://api.github.com/users/smallx","html_url":"https://github.com/smallx","followers_url":"https://api.github.com/users/smallx/followers","following_url":"https://api.github.com/users/smallx/following{/other_user}","gists_url":"https://api.github.com/users/smallx/gists{/gist_id}","starred_url":"https://api.github.com/users/smallx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/smallx/subscriptions","organizations_url":"https://api.github.com/users/smallx/orgs","repos_url":"https://api.github.com/users/smallx/repos","events_url":"https://api.github.com/users/smallx/events{/privacy}","received_events_url":"https://api.github.com/users/smallx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-08T04:34:19Z","updated_at":"2022-01-08T04:34:19Z","author_association":"CONTRIBUTOR","body":"Thanks. I have updated the code. cc @rdblue @kbendick ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1007884015/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1007896178","html_url":"https://github.com/apache/iceberg/issues/3783#issuecomment-1007896178","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3783","id":1007896178,"node_id":"IC_kwDOCW7NX848E0Zy","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-08T06:32:46Z","updated_at":"2022-01-08T06:32:46Z","author_association":"CONTRIBUTOR","body":"@nssalian: Hive tables will be unpartitioned by design. See: https://iceberg.apache.org/#hive/\r\n\r\n> to Hive, the table appears to be unpartitioned although the underlying Iceberg table is partitioned.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1007896178/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1007897477","html_url":"https://github.com/apache/iceberg/pull/3851#issuecomment-1007897477","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3851","id":1007897477,"node_id":"IC_kwDOCW7NX848E0uF","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-08T06:45:46Z","updated_at":"2022-01-08T06:45:46Z","author_association":"CONTRIBUTOR","body":"> @pvary - Yes, all this needs is the latest metadata file.\r\n\r\nThis was my conclusion too (after I have left the comment I continued chewing on this one 😄) Then I went further, and this is where I am now:\r\n- What happens, if a table is modified in one of the catalogs (I suspect that this is catalog dependent as HiveCatalog will not follow the changes, but HadoopTable/HadoopCatalog might follow each others changes, as they rely on the file names) \r\n- Also issues will arise if we start expiring snapshots. If one catalog decides that one of the files are not needed anymore, then it could remove the file, even if the file is still needed for the other table. \r\n\r\nIs there a way to prevent this situation? \r\n\r\nThanks, Peter\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1007897477/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1007900531","html_url":"https://github.com/apache/iceberg/pull/3861#issuecomment-1007900531","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3861","id":1007900531,"node_id":"IC_kwDOCW7NX848E1dz","user":{"login":"smallx","id":16517035,"node_id":"MDQ6VXNlcjE2NTE3MDM1","avatar_url":"https://avatars.githubusercontent.com/u/16517035?v=4","gravatar_id":"","url":"https://api.github.com/users/smallx","html_url":"https://github.com/smallx","followers_url":"https://api.github.com/users/smallx/followers","following_url":"https://api.github.com/users/smallx/following{/other_user}","gists_url":"https://api.github.com/users/smallx/gists{/gist_id}","starred_url":"https://api.github.com/users/smallx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/smallx/subscriptions","organizations_url":"https://api.github.com/users/smallx/orgs","repos_url":"https://api.github.com/users/smallx/repos","events_url":"https://api.github.com/users/smallx/events{/privacy}","received_events_url":"https://api.github.com/users/smallx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-08T07:15:06Z","updated_at":"2022-01-08T07:15:06Z","author_association":"CONTRIBUTOR","body":"Could you help me to look at the code. cc @RussellSpitzer @rdblue ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1007900531/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1007968478","html_url":"https://github.com/apache/iceberg/pull/3855#issuecomment-1007968478","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3855","id":1007968478,"node_id":"IC_kwDOCW7NX848FGDe","user":{"login":"smallx","id":16517035,"node_id":"MDQ6VXNlcjE2NTE3MDM1","avatar_url":"https://avatars.githubusercontent.com/u/16517035?v=4","gravatar_id":"","url":"https://api.github.com/users/smallx","html_url":"https://github.com/smallx","followers_url":"https://api.github.com/users/smallx/followers","following_url":"https://api.github.com/users/smallx/following{/other_user}","gists_url":"https://api.github.com/users/smallx/gists{/gist_id}","starred_url":"https://api.github.com/users/smallx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/smallx/subscriptions","organizations_url":"https://api.github.com/users/smallx/orgs","repos_url":"https://api.github.com/users/smallx/repos","events_url":"https://api.github.com/users/smallx/events{/privacy}","received_events_url":"https://api.github.com/users/smallx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-08T11:44:16Z","updated_at":"2022-01-08T11:44:16Z","author_association":"CONTRIBUTOR","body":"And this one:\r\nhttps://github.com/apache/iceberg/blob/80fd7fd4f0ec365f3d002aaae40329bb7eed77d4/site/mkdocs.yml#L31","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1007968478/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1007971517","html_url":"https://github.com/apache/iceberg/pull/3857#issuecomment-1007971517","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3857","id":1007971517,"node_id":"IC_kwDOCW7NX848FGy9","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-08T12:09:32Z","updated_at":"2022-01-08T12:09:32Z","author_association":"MEMBER","body":"> @openinx I'm assuming we would need a similar solution on the Hive side for this lamba? https://github.com/apache/iceberg/blob/master/mr/src/main/java/org/apache/iceberg/mr/hive/HiveIcebergStorageHandler.java#L209\r\n\r\nWill apache hive use the kryo library to serialize & deserialize the table ? If sure, then I think it is also a bug that we hive need to fix.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1007971517/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1008348143","html_url":"https://github.com/apache/iceberg/pull/3501#issuecomment-1008348143","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3501","id":1008348143,"node_id":"IC_kwDOCW7NX848Givv","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-09T18:14:46Z","updated_at":"2022-01-09T18:14:46Z","author_association":"CONTRIBUTOR","body":"Looks good now. Thanks, @stevenzwu!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1008348143/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1008361235","html_url":"https://github.com/apache/iceberg/pull/3837#issuecomment-1008361235","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3837","id":1008361235,"node_id":"IC_kwDOCW7NX848Gl8T","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-09T19:41:25Z","updated_at":"2022-01-09T19:41:25Z","author_association":"CONTRIBUTOR","body":"@jackye1995, @RussellSpitzer, and @aokolnychyi, you may want to look at this as well since it adds a new method, `Catalog.invalidateTable`","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1008361235/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1008362372","html_url":"https://github.com/apache/iceberg/pull/3837#issuecomment-1008362372","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3837","id":1008362372,"node_id":"IC_kwDOCW7NX848GmOE","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-09T19:49:39Z","updated_at":"2022-01-09T19:49:39Z","author_association":"MEMBER","body":"I think this definitely the right approach, I saw this was linked after my comment on the other invalidate pr but haven't gotten a chance to read it all yet ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1008362372/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1008365594","html_url":"https://github.com/apache/iceberg/pull/3837#issuecomment-1008365594","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3837","id":1008365594,"node_id":"IC_kwDOCW7NX848GnAa","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-09T20:09:32Z","updated_at":"2022-01-09T20:09:32Z","author_association":"CONTRIBUTOR","body":"Thanks for the double check, @RussellSpitzer!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1008365594/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1008365713","html_url":"https://github.com/apache/iceberg/pull/3780#issuecomment-1008365713","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3780","id":1008365713,"node_id":"IC_kwDOCW7NX848GnCR","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-09T20:10:24Z","updated_at":"2022-01-09T20:10:24Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer, could you take a look at this? I have tests passing now.\r\n\r\nThis lazily creates Parquet writers to reduce memory consumption.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1008365713/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1008367834","html_url":"https://github.com/apache/iceberg/pull/3780#issuecomment-1008367834","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3780","id":1008367834,"node_id":"IC_kwDOCW7NX848Gnja","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-09T20:24:16Z","updated_at":"2022-01-09T20:24:16Z","author_association":"MEMBER","body":"So the idea here is we will have null writers instead of initialized empty writers? I'm about to get in a flight but I will check it out tomorrow","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1008367834/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":1,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1008425939","html_url":"https://github.com/apache/iceberg/pull/3780#issuecomment-1008425939","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3780","id":1008425939,"node_id":"IC_kwDOCW7NX848G1vT","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-09T21:20:07Z","updated_at":"2022-01-10T18:18:26Z","author_association":"CONTRIBUTOR","body":"This defers creating an actual Parquet file writer until the first row group is flushed. That avoids interacting with the underlying object store (which for GCS FIleSystem will allocate lots of memory) and removes the need to delete files that are closed with 0 records. But, the Iceberg writer structure is still maintained. So the writer classes other than Parquet are unchanged.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1008425939/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":1,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1008435722","html_url":"https://github.com/apache/iceberg/pull/3857#issuecomment-1008435722","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3857","id":1008435722,"node_id":"IC_kwDOCW7NX848G4IK","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-09T22:24:15Z","updated_at":"2022-01-09T22:24:15Z","author_association":"CONTRIBUTOR","body":"Thanks, @openinx! Do you want to port this to Flink 1.12 and 1.14 as well?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1008435722/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]