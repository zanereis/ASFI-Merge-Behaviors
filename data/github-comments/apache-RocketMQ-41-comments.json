[{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/536312102","html_url":"https://github.com/apache/rocketmq/pull/1501#issuecomment-536312102","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1501","id":536312102,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNjMxMjEwMg==","user":{"login":"coveralls","id":2354108,"node_id":"MDQ6VXNlcjIzNTQxMDg=","avatar_url":"https://avatars.githubusercontent.com/u/2354108?v=4","gravatar_id":"","url":"https://api.github.com/users/coveralls","html_url":"https://github.com/coveralls","followers_url":"https://api.github.com/users/coveralls/followers","following_url":"https://api.github.com/users/coveralls/following{/other_user}","gists_url":"https://api.github.com/users/coveralls/gists{/gist_id}","starred_url":"https://api.github.com/users/coveralls/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coveralls/subscriptions","organizations_url":"https://api.github.com/users/coveralls/orgs","repos_url":"https://api.github.com/users/coveralls/repos","events_url":"https://api.github.com/users/coveralls/events{/privacy}","received_events_url":"https://api.github.com/users/coveralls/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-09-29T15:19:05Z","updated_at":"2019-09-29T15:19:05Z","author_association":"NONE","body":"\n[![Coverage Status](https://coveralls.io/builds/25999326/badge)](https://coveralls.io/builds/25999326)\n\nCoverage decreased (-0.003%) to 50.602% when pulling **ab61acdd9c16f141af20dd6fe165254780cbb6b0 on ITonyLi:master** into **247e0bfbe4f17cd757a595f580f1801bb1934468 on apache:master**.\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/536312102/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/536369806","html_url":"https://github.com/apache/rocketmq/pull/1478#issuecomment-536369806","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1478","id":536369806,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNjM2OTgwNg==","user":{"login":"ChaosYjh","id":27771595,"node_id":"MDQ6VXNlcjI3NzcxNTk1","avatar_url":"https://avatars.githubusercontent.com/u/27771595?v=4","gravatar_id":"","url":"https://api.github.com/users/ChaosYjh","html_url":"https://github.com/ChaosYjh","followers_url":"https://api.github.com/users/ChaosYjh/followers","following_url":"https://api.github.com/users/ChaosYjh/following{/other_user}","gists_url":"https://api.github.com/users/ChaosYjh/gists{/gist_id}","starred_url":"https://api.github.com/users/ChaosYjh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ChaosYjh/subscriptions","organizations_url":"https://api.github.com/users/ChaosYjh/orgs","repos_url":"https://api.github.com/users/ChaosYjh/repos","events_url":"https://api.github.com/users/ChaosYjh/events{/privacy}","received_events_url":"https://api.github.com/users/ChaosYjh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-09-30T01:56:58Z","updated_at":"2019-09-30T01:56:58Z","author_association":"CONTRIBUTOR","body":"I think printing address is more clear too.And just printing channel.remoteAddress() will be ok.","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/536369806/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/536454200","html_url":"https://github.com/apache/rocketmq/pull/1500#issuecomment-536454200","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1500","id":536454200,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNjQ1NDIwMA==","user":{"login":"zongtanghu","id":5010883,"node_id":"MDQ6VXNlcjUwMTA4ODM=","avatar_url":"https://avatars.githubusercontent.com/u/5010883?v=4","gravatar_id":"","url":"https://api.github.com/users/zongtanghu","html_url":"https://github.com/zongtanghu","followers_url":"https://api.github.com/users/zongtanghu/followers","following_url":"https://api.github.com/users/zongtanghu/following{/other_user}","gists_url":"https://api.github.com/users/zongtanghu/gists{/gist_id}","starred_url":"https://api.github.com/users/zongtanghu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zongtanghu/subscriptions","organizations_url":"https://api.github.com/users/zongtanghu/orgs","repos_url":"https://api.github.com/users/zongtanghu/repos","events_url":"https://api.github.com/users/zongtanghu/events{/privacy}","received_events_url":"https://api.github.com/users/zongtanghu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-09-30T08:15:15Z","updated_at":"2019-09-30T08:15:15Z","author_association":"CONTRIBUTOR","body":"I think this pr is good,and approve it to be merged.And please to help to review it! @duhenglucky @RongtongJin @jonnxu @ShannonDing ","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/536454200/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/536460745","html_url":"https://github.com/apache/rocketmq/pull/1430#issuecomment-536460745","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1430","id":536460745,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNjQ2MDc0NQ==","user":{"login":"jonnxu","id":22720404,"node_id":"MDQ6VXNlcjIyNzIwNDA0","avatar_url":"https://avatars.githubusercontent.com/u/22720404?v=4","gravatar_id":"","url":"https://api.github.com/users/jonnxu","html_url":"https://github.com/jonnxu","followers_url":"https://api.github.com/users/jonnxu/followers","following_url":"https://api.github.com/users/jonnxu/following{/other_user}","gists_url":"https://api.github.com/users/jonnxu/gists{/gist_id}","starred_url":"https://api.github.com/users/jonnxu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jonnxu/subscriptions","organizations_url":"https://api.github.com/users/jonnxu/orgs","repos_url":"https://api.github.com/users/jonnxu/repos","events_url":"https://api.github.com/users/jonnxu/events{/privacy}","received_events_url":"https://api.github.com/users/jonnxu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-09-30T08:33:40Z","updated_at":"2019-09-30T08:33:40Z","author_association":"CONTRIBUTOR","body":"LGTM","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/536460745/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/536462708","html_url":"https://github.com/apache/rocketmq/pull/1500#issuecomment-536462708","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1500","id":536462708,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNjQ2MjcwOA==","user":{"login":"jonnxu","id":22720404,"node_id":"MDQ6VXNlcjIyNzIwNDA0","avatar_url":"https://avatars.githubusercontent.com/u/22720404?v=4","gravatar_id":"","url":"https://api.github.com/users/jonnxu","html_url":"https://github.com/jonnxu","followers_url":"https://api.github.com/users/jonnxu/followers","following_url":"https://api.github.com/users/jonnxu/following{/other_user}","gists_url":"https://api.github.com/users/jonnxu/gists{/gist_id}","starred_url":"https://api.github.com/users/jonnxu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jonnxu/subscriptions","organizations_url":"https://api.github.com/users/jonnxu/orgs","repos_url":"https://api.github.com/users/jonnxu/repos","events_url":"https://api.github.com/users/jonnxu/events{/privacy}","received_events_url":"https://api.github.com/users/jonnxu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-09-30T08:39:30Z","updated_at":"2019-09-30T08:39:30Z","author_association":"CONTRIBUTOR","body":"LGTM","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/536462708/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/536894347","html_url":"https://github.com/apache/rocketmq/issues/504#issuecomment-536894347","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/504","id":536894347,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNjg5NDM0Nw==","user":{"login":"beijing-penguin","id":10703753,"node_id":"MDQ6VXNlcjEwNzAzNzUz","avatar_url":"https://avatars.githubusercontent.com/u/10703753?v=4","gravatar_id":"","url":"https://api.github.com/users/beijing-penguin","html_url":"https://github.com/beijing-penguin","followers_url":"https://api.github.com/users/beijing-penguin/followers","following_url":"https://api.github.com/users/beijing-penguin/following{/other_user}","gists_url":"https://api.github.com/users/beijing-penguin/gists{/gist_id}","starred_url":"https://api.github.com/users/beijing-penguin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/beijing-penguin/subscriptions","organizations_url":"https://api.github.com/users/beijing-penguin/orgs","repos_url":"https://api.github.com/users/beijing-penguin/repos","events_url":"https://api.github.com/users/beijing-penguin/events{/privacy}","received_events_url":"https://api.github.com/users/beijing-penguin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-01T06:49:06Z","updated_at":"2019-10-01T10:36:59Z","author_association":"NONE","body":"我使用的最新4.5.2的master分支源代码 eclipse java启动,报错“No route info of this topic, TopicTest”\r\n我的步骤如下：  \r\n第一步启动Namesrv main方法-->org.apache.rocketmq.namesrv.NamesrvStartup.java\r\n```java\r\npublic static void main(String[] args) {\r\n        main0(args);\r\n    }\r\n\r\n    public static NamesrvController main0(String[] args) {\r\n\r\n        try {\r\n            NamesrvController controller = createNamesrvController(args);\r\n            controller.getNettyServerConfig().setListenPort(8888);\r\n            start(controller);\r\n            String tip = \"The Name Server boot success. serializeType=\" + RemotingCommand.getSerializeTypeConfigInThisServer();\r\n            log.info(tip);\r\n            System.out.printf(\"%s%n\", tip);\r\n            return controller;\r\n        } catch (Throwable e) {\r\n            e.printStackTrace();\r\n            System.exit(-1);\r\n        }\r\n\r\n        return null;\r\n    }\r\n```\r\n控制台输出：The Name Server boot success. serializeType=ROCKETMQ  \r\n第二步启动Broker的main方法--->org.apache.rocketmq.broker.BrokerStartup.java  \r\n并用代码设置setAutoCreateTopicEnable=true，如下\r\n```java\r\npublic static void main(String[] args) {\r\n        start(createBrokerController(args));\r\n    }\r\n\r\n    public static BrokerController start(BrokerController controller) {\r\n        try {\r\n            controller.getBrokerConfig().setNamesrvAddr(\"localhost:8888\");\r\n            controller.getBrokerConfig().setAutoCreateTopicEnable(true);\r\n            //controller.getBrokerConfig().setBrokerTopicEnable(true);\r\n            controller.getBrokerConfig().setBrokerIP1(\"localhost\");\r\n            System.err.println(controller.getBrokerAddr());\r\n            controller.start();\r\n            \r\n            String tip = \"The broker[\" + controller.getBrokerConfig().getBrokerName() + \", \"\r\n                + controller.getBrokerAddr() + \"] boot success. serializeType=\" + RemotingCommand.getSerializeTypeConfigInThisServer();\r\n\r\n            if (null != controller.getBrokerConfig().getNamesrvAddr()) {\r\n                tip += \" and name server is \" + controller.getBrokerConfig().getNamesrvAddr();\r\n            }\r\n\r\n            log.info(tip);\r\n            System.err.println(String.valueOf(controller.getBrokerConfig().isAutoCreateTopicEnable()));\r\n            System.out.printf(\"%s%n\", tip);\r\n            return controller;\r\n        } catch (Throwable e) {\r\n            e.printStackTrace();\r\n            System.exit(-1);\r\n        }\r\n\r\n        return null;\r\n    }\r\n```\r\n控制台输出：\r\nlocalhost:10911  \r\ntrue  \r\nThe broker[WIN-FMHILLP1PVS, localhost:10911] boot success. serializeType=ROCKETMQ and name server is localhost:8888  \r\n第三步，启动官方自带simaple中的org.apache.rocketmq.example.ordermessage.Producer.java  \r\n```java\r\n    public static void main(String[] args) throws MQClientException, InterruptedException {\r\n        DefaultMQProducer producer = new DefaultMQProducer(\"please_rename_unique_group_name\");\r\n        producer.setNamesrvAddr(\"localhost:8888\");\r\n        producer.start();\r\n\r\n        for (int i = 0; i < 1000; i++) {\r\n            try {\r\n                Message msg = new Message(\"TopicTest\" , \"TagA\",\r\n                    (\"Hello RocketMQ \" + i).getBytes(RemotingHelper.DEFAULT_CHARSET) \r\n                );\r\n\r\n                SendResult sendResult = producer.send(msg);\r\n                System.out.printf(\"%s%n\", sendResult);\r\n            } catch (Exception e) {\r\n                e.printStackTrace();\r\n                Thread.sleep(1000);\r\n            }\r\n        }\r\n        //producer.shutdown();\r\n    }\r\n```\r\n\r\n控制台输出：  \r\n```\r\norg.apache.rocketmq.client.exception.MQClientException: No route info of this topic, TopicTest\r\nSee http://rocketmq.apache.org/docs/faq/ for further details.\r\n\tat org.apache.rocketmq.client.impl.producer.DefaultMQProducerImpl.sendDefaultImpl(DefaultMQProducerImpl.java:657)\r\n\tat org.apache.rocketmq.client.impl.producer.DefaultMQProducerImpl.send(DefaultMQProducerImpl.java:1280)\r\n\tat org.apache.rocketmq.client.impl.producer.DefaultMQProducerImpl.send(DefaultMQProducerImpl.java:1226)\r\n\tat org.apache.rocketmq.client.producer.DefaultMQProducer.send(DefaultMQProducer.java:283)\r\n\tat org.apache.rocketmq.example.quickstart.Producer.main(Producer.java:40)\r\n```\r\n问题分析：  \r\n用的最新4.5.2官方源代码，我已经全部设置为localhost，且都设置对了namesrv的端口和地址，rpc协议无论是ROCKETMQ还是JSON，都会报No route info of this topic, TopicTest的异常。。","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/536894347/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/537040637","html_url":"https://github.com/apache/rocketmq/issues/504#issuecomment-537040637","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/504","id":537040637,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNzA0MDYzNw==","user":{"login":"RongtongJin","id":21963954,"node_id":"MDQ6VXNlcjIxOTYzOTU0","avatar_url":"https://avatars.githubusercontent.com/u/21963954?v=4","gravatar_id":"","url":"https://api.github.com/users/RongtongJin","html_url":"https://github.com/RongtongJin","followers_url":"https://api.github.com/users/RongtongJin/followers","following_url":"https://api.github.com/users/RongtongJin/following{/other_user}","gists_url":"https://api.github.com/users/RongtongJin/gists{/gist_id}","starred_url":"https://api.github.com/users/RongtongJin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RongtongJin/subscriptions","organizations_url":"https://api.github.com/users/RongtongJin/orgs","repos_url":"https://api.github.com/users/RongtongJin/repos","events_url":"https://api.github.com/users/RongtongJin/events{/privacy}","received_events_url":"https://api.github.com/users/RongtongJin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-01T13:39:31Z","updated_at":"2019-10-01T13:39:31Z","author_association":"CONTRIBUTOR","body":"@beijing-penguin \r\n当前已经有一个PR提交到develop分支，还未被合入主分支，你可以尝试一下develop分支的客户端代码，如果是下面第一个原因导致的no route info of this topic，会直接抛出相应的错误。\r\n\r\n对于修改之前的版本，**建议你检查一下客户端的日志，日志中会有更加详细的异常信息**，在控制台上只能看到抛出异常。\r\n\r\n此外，根据no route info of this topic出现的原因，建议你从以下几个方面排查。\r\n1. 确保producer能连接上nameserver并且能从nameserver中获取topic的元数据信息。\r\n  检查方法：通过查看日志、调试等方法进行检查，在最新的develop分支中该原因导致会直接抛出对应的异常。\r\n  可能的原因：客户端没有设置nameserver，防火墙等网络问题。\r\n2. 确保nameserver中包含了需要发送的topic的路由。\r\n  检查方法：通过admin工具或rocketmq web console进行检查。\r\n  可能的原因：\r\n（1）Topic不存在且Broker禁止自动创建Topic（autoCreateTopicEnable=false），且没有通过手工方式创建Topic。\r\n（2）Broker没有正确连接到NameServer（broker能定期向nameserver发送心跳）\r\n3. 其他原因：Netty版本问题，fastjson问题，topic权限问题（权限至少可写）\r\n  检查方法：需要通过查日志，调试等方法综合进行检查。\r\n\r\n期待你能告诉我最后的原因。","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/537040637/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/537064489","html_url":"https://github.com/apache/rocketmq/pull/1430#issuecomment-537064489","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1430","id":537064489,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNzA2NDQ4OQ==","user":{"login":"RongtongJin","id":21963954,"node_id":"MDQ6VXNlcjIxOTYzOTU0","avatar_url":"https://avatars.githubusercontent.com/u/21963954?v=4","gravatar_id":"","url":"https://api.github.com/users/RongtongJin","html_url":"https://github.com/RongtongJin","followers_url":"https://api.github.com/users/RongtongJin/followers","following_url":"https://api.github.com/users/RongtongJin/following{/other_user}","gists_url":"https://api.github.com/users/RongtongJin/gists{/gist_id}","starred_url":"https://api.github.com/users/RongtongJin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RongtongJin/subscriptions","organizations_url":"https://api.github.com/users/RongtongJin/orgs","repos_url":"https://api.github.com/users/RongtongJin/repos","events_url":"https://api.github.com/users/RongtongJin/events{/privacy}","received_events_url":"https://api.github.com/users/RongtongJin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-01T14:31:40Z","updated_at":"2019-10-01T14:31:40Z","author_association":"CONTRIBUTOR","body":"LGTM~","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/537064489/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/537106019","html_url":"https://github.com/apache/rocketmq/issues/504#issuecomment-537106019","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/504","id":537106019,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNzEwNjAxOQ==","user":{"login":"beijing-penguin","id":10703753,"node_id":"MDQ6VXNlcjEwNzAzNzUz","avatar_url":"https://avatars.githubusercontent.com/u/10703753?v=4","gravatar_id":"","url":"https://api.github.com/users/beijing-penguin","html_url":"https://github.com/beijing-penguin","followers_url":"https://api.github.com/users/beijing-penguin/followers","following_url":"https://api.github.com/users/beijing-penguin/following{/other_user}","gists_url":"https://api.github.com/users/beijing-penguin/gists{/gist_id}","starred_url":"https://api.github.com/users/beijing-penguin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/beijing-penguin/subscriptions","organizations_url":"https://api.github.com/users/beijing-penguin/orgs","repos_url":"https://api.github.com/users/beijing-penguin/repos","events_url":"https://api.github.com/users/beijing-penguin/events{/privacy}","received_events_url":"https://api.github.com/users/beijing-penguin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-01T16:01:00Z","updated_at":"2019-10-01T16:10:15Z","author_association":"NONE","body":"> @beijing-penguin\r\n> 当前已经有一个PR提交到develop分支，还未被合入主分支，你可以尝试一下develop分支的客户端代码，如果是下面第一个原因导致的no route info of this topic，会直接抛出相应的错误。\r\n> \r\n> 对于修改之前的版本，**建议你检查一下客户端的日志，日志中会有更加详细的异常信息**，在控制台上只能看到抛出异常。\r\n> \r\n> 此外，根据no route info of this topic出现的原因，建议你从以下几个方面排查。\r\n> \r\n> 1. 确保producer能连接上nameserver并且能从nameserver中获取topic的元数据信息。\r\n>    检查方法：通过查看日志、调试等方法进行检查，在最新的develop分支中该原因导致会直接抛出对应的异常。\r\n>    可能的原因：客户端没有设置nameserver，防火墙等网络问题。\r\n> 2. 确保nameserver中包含了需要发送的topic的路由。\r\n>    检查方法：通过admin工具或rocketmq web console进行检查。\r\n>    可能的原因：\r\n>    （1）Topic不存在且Broker禁止自动创建Topic（autoCreateTopicEnable=false），且没有通过手工方式创建Topic。\r\n>    （2）Broker没有正确连接到NameServer（broker能定期向nameserver发送心跳）\r\n> 3. 其他原因：Netty版本问题，fastjson问题，topic权限问题（权限至少可写）\r\n>    检查方法：需要通过查日志，调试等方法综合进行检查。\r\n> \r\n> 期待你能告诉我最后的原因。\r\n\r\n一、我切换到了develop分支，也尝试默认不设置，或者设置不同的namesrv端口\r\n![image](https://user-images.githubusercontent.com/10703753/65978275-fc96f880-e4a5-11e9-8afd-7cd360cb41a8.png)\r\n\r\n二，我是用eclipse本地启动，并且关闭了本地防火墙\r\n![image](https://user-images.githubusercontent.com/10703753/65978359-27814c80-e4a6-11e9-8974-0b07985c0931.png)\r\n\r\n三、我使用的是官方源代码，fastjson，netty等版本全部使用官方pom配置文件构建。。启动流程如下\r\n①启动namesrv，设置端口为8888  （尝试过不设置端口，默认使用9876，也会报异常）\r\n![image](https://user-images.githubusercontent.com/10703753/65978705-c6a64400-e4a6-11e9-8063-9976cfe42062.png)\r\n②启动broker，并设置controller.getBrokerConfig().setAutoCreateTopicEnable(true);\r\n![image](https://user-images.githubusercontent.com/10703753/65978917-138a1a80-e4a7-11e9-97d4-32df8fef4330.png)\r\n③设置producer.setNamesrvAddr(\"localhost:8888\");   运行生产者\r\n![image](https://user-images.githubusercontent.com/10703753/65979129-5c41d380-e4a7-11e9-900f-72427f0f7551.png)\r\n\r\n四、查看namesrv.log文件。抛出了一个奇怪的错误，exceptionCaught 127.0.0.1:49195  提示中的端口49195，是从来没设置过的这种端口。。。\r\n![image](https://user-images.githubusercontent.com/10703753/65979243-8a271800-e4a7-11e9-987d-77a64725b846.png)\r\n\r\n我的其他信息\r\nbroker.conf\r\n![image](https://user-images.githubusercontent.com/10703753/65979968-d6bf2300-e4a8-11e9-8d40-21569981ec52.png)\r\nbroker.log\r\n![image](https://user-images.githubusercontent.com/10703753/65980050-fe15f000-e4a8-11e9-8de9-899d22454e55.png)\r\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/537106019/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/537120658","html_url":"https://github.com/apache/rocketmq/issues/504#issuecomment-537120658","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/504","id":537120658,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNzEyMDY1OA==","user":{"login":"RongtongJin","id":21963954,"node_id":"MDQ6VXNlcjIxOTYzOTU0","avatar_url":"https://avatars.githubusercontent.com/u/21963954?v=4","gravatar_id":"","url":"https://api.github.com/users/RongtongJin","html_url":"https://github.com/RongtongJin","followers_url":"https://api.github.com/users/RongtongJin/followers","following_url":"https://api.github.com/users/RongtongJin/following{/other_user}","gists_url":"https://api.github.com/users/RongtongJin/gists{/gist_id}","starred_url":"https://api.github.com/users/RongtongJin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RongtongJin/subscriptions","organizations_url":"https://api.github.com/users/RongtongJin/orgs","repos_url":"https://api.github.com/users/RongtongJin/repos","events_url":"https://api.github.com/users/RongtongJin/events{/privacy}","received_events_url":"https://api.github.com/users/RongtongJin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-01T16:37:29Z","updated_at":"2019-10-01T16:42:47Z","author_association":"CONTRIBUTOR","body":"@beijing-penguin 客户端的日志（rocketmq_client.log）是否更加详细信息，这个更重要。另外nameserver日志中（namesrv.log）是否存在“new broker registered...“，如果不存在很可能是broker没有注册成功。","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/537120658/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/537172059","html_url":"https://github.com/apache/rocketmq/issues/1503#issuecomment-537172059","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1503","id":537172059,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNzE3MjA1OQ==","user":{"login":"Switch-vov","id":11993575,"node_id":"MDQ6VXNlcjExOTkzNTc1","avatar_url":"https://avatars.githubusercontent.com/u/11993575?v=4","gravatar_id":"","url":"https://api.github.com/users/Switch-vov","html_url":"https://github.com/Switch-vov","followers_url":"https://api.github.com/users/Switch-vov/followers","following_url":"https://api.github.com/users/Switch-vov/following{/other_user}","gists_url":"https://api.github.com/users/Switch-vov/gists{/gist_id}","starred_url":"https://api.github.com/users/Switch-vov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Switch-vov/subscriptions","organizations_url":"https://api.github.com/users/Switch-vov/orgs","repos_url":"https://api.github.com/users/Switch-vov/repos","events_url":"https://api.github.com/users/Switch-vov/events{/privacy}","received_events_url":"https://api.github.com/users/Switch-vov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-01T18:38:29Z","updated_at":"2019-10-01T18:38:29Z","author_association":"CONTRIBUTOR","body":"@duhenglucky please review it.","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/537172059/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/537174961","html_url":"https://github.com/apache/rocketmq/pull/1504#issuecomment-537174961","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1504","id":537174961,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNzE3NDk2MQ==","user":{"login":"coveralls","id":2354108,"node_id":"MDQ6VXNlcjIzNTQxMDg=","avatar_url":"https://avatars.githubusercontent.com/u/2354108?v=4","gravatar_id":"","url":"https://api.github.com/users/coveralls","html_url":"https://github.com/coveralls","followers_url":"https://api.github.com/users/coveralls/followers","following_url":"https://api.github.com/users/coveralls/following{/other_user}","gists_url":"https://api.github.com/users/coveralls/gists{/gist_id}","starred_url":"https://api.github.com/users/coveralls/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coveralls/subscriptions","organizations_url":"https://api.github.com/users/coveralls/orgs","repos_url":"https://api.github.com/users/coveralls/repos","events_url":"https://api.github.com/users/coveralls/events{/privacy}","received_events_url":"https://api.github.com/users/coveralls/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-01T18:45:04Z","updated_at":"2019-10-01T18:45:04Z","author_association":"NONE","body":"\n[![Coverage Status](https://coveralls.io/builds/26047698/badge)](https://coveralls.io/builds/26047698)\n\nCoverage increased (+0.02%) to 49.589% when pulling **006efae3aecf31ae5ea61300b2fb8d9615d49a43 on Switch-vov:develop** into **d99862a88a6a42babc68d2a417287b19fcddf298 on apache:develop**.\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/537174961/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/537277295","html_url":"https://github.com/apache/rocketmq/issues/504#issuecomment-537277295","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/504","id":537277295,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNzI3NzI5NQ==","user":{"login":"beijing-penguin","id":10703753,"node_id":"MDQ6VXNlcjEwNzAzNzUz","avatar_url":"https://avatars.githubusercontent.com/u/10703753?v=4","gravatar_id":"","url":"https://api.github.com/users/beijing-penguin","html_url":"https://github.com/beijing-penguin","followers_url":"https://api.github.com/users/beijing-penguin/followers","following_url":"https://api.github.com/users/beijing-penguin/following{/other_user}","gists_url":"https://api.github.com/users/beijing-penguin/gists{/gist_id}","starred_url":"https://api.github.com/users/beijing-penguin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/beijing-penguin/subscriptions","organizations_url":"https://api.github.com/users/beijing-penguin/orgs","repos_url":"https://api.github.com/users/beijing-penguin/repos","events_url":"https://api.github.com/users/beijing-penguin/events{/privacy}","received_events_url":"https://api.github.com/users/beijing-penguin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-01T23:50:34Z","updated_at":"2019-10-01T23:50:34Z","author_association":"NONE","body":"> @beijing-penguin 客户端的日志（rocketmq_client.log）是否更加详细信息，这个更重要。另外nameserver日志中（namesrv.log）是否存在“new broker registered...“，如果不存在很可能是broker没有注册成功。\r\n\r\nnamesrv.log 不存在new broker registered   这些关键字\r\n这是rocketmq_client.log客户端的日志。\r\n![image](https://user-images.githubusercontent.com/10703753/66008377-a8f9ce80-e4e8-11e9-8d53-8117e3d36cf5.png)\r\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/537277295/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/537305295","html_url":"https://github.com/apache/rocketmq/issues/504#issuecomment-537305295","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/504","id":537305295,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNzMwNTI5NQ==","user":{"login":"RongtongJin","id":21963954,"node_id":"MDQ6VXNlcjIxOTYzOTU0","avatar_url":"https://avatars.githubusercontent.com/u/21963954?v=4","gravatar_id":"","url":"https://api.github.com/users/RongtongJin","html_url":"https://github.com/RongtongJin","followers_url":"https://api.github.com/users/RongtongJin/followers","following_url":"https://api.github.com/users/RongtongJin/following{/other_user}","gists_url":"https://api.github.com/users/RongtongJin/gists{/gist_id}","starred_url":"https://api.github.com/users/RongtongJin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RongtongJin/subscriptions","organizations_url":"https://api.github.com/users/RongtongJin/orgs","repos_url":"https://api.github.com/users/RongtongJin/repos","events_url":"https://api.github.com/users/RongtongJin/events{/privacy}","received_events_url":"https://api.github.com/users/RongtongJin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-02T02:10:16Z","updated_at":"2019-10-02T02:10:16Z","author_association":"CONTRIBUTOR","body":"@beijing-penguin 引起no route info的主要原因是因为Broker没有正确连接到NameServer。我发现你在代码中设置namesever地址，如果设置nameserver要起作用，则设置代码须在controller.initialize()之前。另外推荐你采用其他方式配置nameserver，比如设置eclipse中设置broker程序参数 -n localhost:8888，可以看下nameserver的[最佳实践](http://rocketmq.apache.org/docs/best-practice-namesvr/)。","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/537305295/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/537305599","html_url":"https://github.com/apache/rocketmq/issues/1502#issuecomment-537305599","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1502","id":537305599,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNzMwNTU5OQ==","user":{"login":"RongtongJin","id":21963954,"node_id":"MDQ6VXNlcjIxOTYzOTU0","avatar_url":"https://avatars.githubusercontent.com/u/21963954?v=4","gravatar_id":"","url":"https://api.github.com/users/RongtongJin","html_url":"https://github.com/RongtongJin","followers_url":"https://api.github.com/users/RongtongJin/followers","following_url":"https://api.github.com/users/RongtongJin/following{/other_user}","gists_url":"https://api.github.com/users/RongtongJin/gists{/gist_id}","starred_url":"https://api.github.com/users/RongtongJin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RongtongJin/subscriptions","organizations_url":"https://api.github.com/users/RongtongJin/orgs","repos_url":"https://api.github.com/users/RongtongJin/repos","events_url":"https://api.github.com/users/RongtongJin/events{/privacy}","received_events_url":"https://api.github.com/users/RongtongJin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-02T02:12:07Z","updated_at":"2019-10-02T02:12:07Z","author_association":"CONTRIBUTOR","body":"ref #504 ","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/537305599/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/537317724","html_url":"https://github.com/apache/rocketmq/issues/504#issuecomment-537317724","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/504","id":537317724,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNzMxNzcyNA==","user":{"login":"beijing-penguin","id":10703753,"node_id":"MDQ6VXNlcjEwNzAzNzUz","avatar_url":"https://avatars.githubusercontent.com/u/10703753?v=4","gravatar_id":"","url":"https://api.github.com/users/beijing-penguin","html_url":"https://github.com/beijing-penguin","followers_url":"https://api.github.com/users/beijing-penguin/followers","following_url":"https://api.github.com/users/beijing-penguin/following{/other_user}","gists_url":"https://api.github.com/users/beijing-penguin/gists{/gist_id}","starred_url":"https://api.github.com/users/beijing-penguin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/beijing-penguin/subscriptions","organizations_url":"https://api.github.com/users/beijing-penguin/orgs","repos_url":"https://api.github.com/users/beijing-penguin/repos","events_url":"https://api.github.com/users/beijing-penguin/events{/privacy}","received_events_url":"https://api.github.com/users/beijing-penguin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-02T03:16:58Z","updated_at":"2019-10-02T03:16:58Z","author_association":"NONE","body":"> @beijing-penguin 引起no route info的主要原因是因为Broker没有正确连接到NameServer。我发现你在代码中设置namesever地址，如果设置nameserver要起作用，则设置代码须在controller.initialize()之前。另外推荐你采用其他方式配置nameserver，比如设置eclipse中设置broker程序参数 -n localhost:8888，可以看下nameserver的[最佳实践](http://rocketmq.apache.org/docs/best-practice-namesvr/)。\r\n\r\n非常感谢您的专业解答，确实  是broker main方法中设置controller应该在initialize()之前。我模拟命令行,再次用代码设置 args = new String[] {\"-n\",\"127.0.0.1:9876\",\"autoCreateTopicEnable=true\"};入参的方法，问题得到解决。。再次感谢。\r\n```java\r\npublic static void main(String[] args) {\r\n        args = new String[] {\"-n\",\"127.0.0.1:9876\",\"autoCreateTopicEnable=true\"};\r\n        start(createBrokerController(args));\r\n    }\r\n\r\n    public static BrokerController start(BrokerController controller) {\r\n        try {\r\n            //controller.getBrokerConfig().setBrokerIP1(\"localhost\");\r\n            //controller.getBrokerConfig().setNamesrvAddr(\"localhost:8888\");\r\n            //controller.getBrokerConfig().setAutoCreateTopicEnable(true);\r\n            controller.start();\r\n\r\n            String tip = \"The broker[\" + controller.getBrokerConfig().getBrokerName() + \", \"\r\n                + controller.getBrokerAddr() + \"] boot success. serializeType=\" + RemotingCommand.getSerializeTypeConfigInThisServer();\r\n\r\n            if (null != controller.getBrokerConfig().getNamesrvAddr()) {\r\n                tip += \" and name server is \" + controller.getBrokerConfig().getNamesrvAddr();\r\n            }\r\n\r\n            log.info(tip);\r\n            System.out.printf(\"%s%n\", tip);\r\n            return controller;\r\n        } catch (Throwable e) {\r\n            e.printStackTrace();\r\n            System.exit(-1);\r\n        }\r\n\r\n        return null;\r\n    }\r\n```","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/537317724/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/537318385","html_url":"https://github.com/apache/rocketmq/issues/1502#issuecomment-537318385","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1502","id":537318385,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNzMxODM4NQ==","user":{"login":"beijing-penguin","id":10703753,"node_id":"MDQ6VXNlcjEwNzAzNzUz","avatar_url":"https://avatars.githubusercontent.com/u/10703753?v=4","gravatar_id":"","url":"https://api.github.com/users/beijing-penguin","html_url":"https://github.com/beijing-penguin","followers_url":"https://api.github.com/users/beijing-penguin/followers","following_url":"https://api.github.com/users/beijing-penguin/following{/other_user}","gists_url":"https://api.github.com/users/beijing-penguin/gists{/gist_id}","starred_url":"https://api.github.com/users/beijing-penguin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/beijing-penguin/subscriptions","organizations_url":"https://api.github.com/users/beijing-penguin/orgs","repos_url":"https://api.github.com/users/beijing-penguin/repos","events_url":"https://api.github.com/users/beijing-penguin/events{/privacy}","received_events_url":"https://api.github.com/users/beijing-penguin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-02T03:21:01Z","updated_at":"2019-10-02T03:21:01Z","author_association":"NONE","body":"#504 ","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/537318385/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/538726236","html_url":"https://github.com/apache/rocketmq/issues/1450#issuecomment-538726236","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1450","id":538726236,"node_id":"MDEyOklzc3VlQ29tbWVudDUzODcyNjIzNg==","user":{"login":"CodeIngL","id":12370508,"node_id":"MDQ6VXNlcjEyMzcwNTA4","avatar_url":"https://avatars.githubusercontent.com/u/12370508?v=4","gravatar_id":"","url":"https://api.github.com/users/CodeIngL","html_url":"https://github.com/CodeIngL","followers_url":"https://api.github.com/users/CodeIngL/followers","following_url":"https://api.github.com/users/CodeIngL/following{/other_user}","gists_url":"https://api.github.com/users/CodeIngL/gists{/gist_id}","starred_url":"https://api.github.com/users/CodeIngL/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CodeIngL/subscriptions","organizations_url":"https://api.github.com/users/CodeIngL/orgs","repos_url":"https://api.github.com/users/CodeIngL/repos","events_url":"https://api.github.com/users/CodeIngL/events{/privacy}","received_events_url":"https://api.github.com/users/CodeIngL/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-06T09:07:58Z","updated_at":"2019-10-06T09:07:58Z","author_association":"NONE","body":"在nameServer中，一个broker名字对应一个BrokerData，BrokerData拥有一个clusterName\r\n    private final HashMap<String/* brokerName */, BrokerData> brokerAddrTable;\r\n 所以你要改名\r\n@superheizai ","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/538726236/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/538749574","html_url":"https://github.com/apache/rocketmq/issues/1450#issuecomment-538749574","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1450","id":538749574,"node_id":"MDEyOklzc3VlQ29tbWVudDUzODc0OTU3NA==","user":{"login":"superheizai","id":3948418,"node_id":"MDQ6VXNlcjM5NDg0MTg=","avatar_url":"https://avatars.githubusercontent.com/u/3948418?v=4","gravatar_id":"","url":"https://api.github.com/users/superheizai","html_url":"https://github.com/superheizai","followers_url":"https://api.github.com/users/superheizai/followers","following_url":"https://api.github.com/users/superheizai/following{/other_user}","gists_url":"https://api.github.com/users/superheizai/gists{/gist_id}","starred_url":"https://api.github.com/users/superheizai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/superheizai/subscriptions","organizations_url":"https://api.github.com/users/superheizai/orgs","repos_url":"https://api.github.com/users/superheizai/repos","events_url":"https://api.github.com/users/superheizai/events{/privacy}","received_events_url":"https://api.github.com/users/superheizai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-06T13:55:16Z","updated_at":"2019-10-06T13:55:16Z","author_association":"CONTRIBUTOR","body":"@CodeIngL , I know how to resolve the problem. What I want to know is if this result is RocketMQ wanted, or if this is a bug.  ","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/538749574/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/539268774","html_url":"https://github.com/apache/rocketmq/issues/1499#issuecomment-539268774","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1499","id":539268774,"node_id":"MDEyOklzc3VlQ29tbWVudDUzOTI2ODc3NA==","user":{"login":"duhenglucky","id":7938968,"node_id":"MDQ6VXNlcjc5Mzg5Njg=","avatar_url":"https://avatars.githubusercontent.com/u/7938968?v=4","gravatar_id":"","url":"https://api.github.com/users/duhenglucky","html_url":"https://github.com/duhenglucky","followers_url":"https://api.github.com/users/duhenglucky/followers","following_url":"https://api.github.com/users/duhenglucky/following{/other_user}","gists_url":"https://api.github.com/users/duhenglucky/gists{/gist_id}","starred_url":"https://api.github.com/users/duhenglucky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/duhenglucky/subscriptions","organizations_url":"https://api.github.com/users/duhenglucky/orgs","repos_url":"https://api.github.com/users/duhenglucky/repos","events_url":"https://api.github.com/users/duhenglucky/events{/privacy}","received_events_url":"https://api.github.com/users/duhenglucky/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-08T01:06:16Z","updated_at":"2019-10-08T01:06:16Z","author_association":"CONTRIBUTOR","body":"@jzdayz RocketMQ used the consumer group to manage consumption offset, so the new consumer group will almost certainly lead to repeated consumption.\r\nMore information can be referred [in here  ](https://github.com/apache/rocketmq/tree/master/docs)","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/539268774/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/539439318","html_url":"https://github.com/apache/rocketmq/issues/1450#issuecomment-539439318","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1450","id":539439318,"node_id":"MDEyOklzc3VlQ29tbWVudDUzOTQzOTMxOA==","user":{"login":"CodeIngL","id":12370508,"node_id":"MDQ6VXNlcjEyMzcwNTA4","avatar_url":"https://avatars.githubusercontent.com/u/12370508?v=4","gravatar_id":"","url":"https://api.github.com/users/CodeIngL","html_url":"https://github.com/CodeIngL","followers_url":"https://api.github.com/users/CodeIngL/followers","following_url":"https://api.github.com/users/CodeIngL/following{/other_user}","gists_url":"https://api.github.com/users/CodeIngL/gists{/gist_id}","starred_url":"https://api.github.com/users/CodeIngL/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CodeIngL/subscriptions","organizations_url":"https://api.github.com/users/CodeIngL/orgs","repos_url":"https://api.github.com/users/CodeIngL/repos","events_url":"https://api.github.com/users/CodeIngL/events{/privacy}","received_events_url":"https://api.github.com/users/CodeIngL/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-08T09:50:15Z","updated_at":"2019-10-08T09:50:15Z","author_association":"NONE","body":"请看BrokerData应该可以非常简单理解设计。 @superheizai ","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/539439318/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/539442432","html_url":"https://github.com/apache/rocketmq/issues/1482#issuecomment-539442432","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1482","id":539442432,"node_id":"MDEyOklzc3VlQ29tbWVudDUzOTQ0MjQzMg==","user":{"login":"CodeIngL","id":12370508,"node_id":"MDQ6VXNlcjEyMzcwNTA4","avatar_url":"https://avatars.githubusercontent.com/u/12370508?v=4","gravatar_id":"","url":"https://api.github.com/users/CodeIngL","html_url":"https://github.com/CodeIngL","followers_url":"https://api.github.com/users/CodeIngL/followers","following_url":"https://api.github.com/users/CodeIngL/following{/other_user}","gists_url":"https://api.github.com/users/CodeIngL/gists{/gist_id}","starred_url":"https://api.github.com/users/CodeIngL/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CodeIngL/subscriptions","organizations_url":"https://api.github.com/users/CodeIngL/orgs","repos_url":"https://api.github.com/users/CodeIngL/repos","events_url":"https://api.github.com/users/CodeIngL/events{/privacy}","received_events_url":"https://api.github.com/users/CodeIngL/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-08T09:58:30Z","updated_at":"2019-10-08T09:58:30Z","author_association":"NONE","body":"did you see retryTimesWhenSendAsyncFailed properties @liony ","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/539442432/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/539481030","html_url":"https://github.com/apache/rocketmq/issues/1190#issuecomment-539481030","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1190","id":539481030,"node_id":"MDEyOklzc3VlQ29tbWVudDUzOTQ4MTAzMA==","user":{"login":"tonfay","id":19604131,"node_id":"MDQ6VXNlcjE5NjA0MTMx","avatar_url":"https://avatars.githubusercontent.com/u/19604131?v=4","gravatar_id":"","url":"https://api.github.com/users/tonfay","html_url":"https://github.com/tonfay","followers_url":"https://api.github.com/users/tonfay/followers","following_url":"https://api.github.com/users/tonfay/following{/other_user}","gists_url":"https://api.github.com/users/tonfay/gists{/gist_id}","starred_url":"https://api.github.com/users/tonfay/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tonfay/subscriptions","organizations_url":"https://api.github.com/users/tonfay/orgs","repos_url":"https://api.github.com/users/tonfay/repos","events_url":"https://api.github.com/users/tonfay/events{/privacy}","received_events_url":"https://api.github.com/users/tonfay/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-08T12:04:00Z","updated_at":"2019-10-08T12:04:00Z","author_association":"NONE","body":"Also meet ","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/539481030/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/539500304","html_url":"https://github.com/apache/rocketmq/issues/1506#issuecomment-539500304","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1506","id":539500304,"node_id":"MDEyOklzc3VlQ29tbWVudDUzOTUwMDMwNA==","user":{"login":"ifplusor","id":9999114,"node_id":"MDQ6VXNlcjk5OTkxMTQ=","avatar_url":"https://avatars.githubusercontent.com/u/9999114?v=4","gravatar_id":"","url":"https://api.github.com/users/ifplusor","html_url":"https://github.com/ifplusor","followers_url":"https://api.github.com/users/ifplusor/followers","following_url":"https://api.github.com/users/ifplusor/following{/other_user}","gists_url":"https://api.github.com/users/ifplusor/gists{/gist_id}","starred_url":"https://api.github.com/users/ifplusor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ifplusor/subscriptions","organizations_url":"https://api.github.com/users/ifplusor/orgs","repos_url":"https://api.github.com/users/ifplusor/repos","events_url":"https://api.github.com/users/ifplusor/events{/privacy}","received_events_url":"https://api.github.com/users/ifplusor/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-08T12:57:43Z","updated_at":"2019-10-08T12:57:56Z","author_association":"CONTRIBUTOR","body":"Same issue in OffsetSerializeWrapper, \r\n\r\n```java\r\nprivate ConcurrentMap<MessageQueue, AtomicLong> offsetTable = new ConcurrentHashMap<MessageQueue, AtomicLong>();\r\n```\r\n\r\nthe key of offsetTable is MessageQueue **object**, but only string is accepted as object key in JSON standard.","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/539500304/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/539539114","html_url":"https://github.com/apache/rocketmq/pull/1509#issuecomment-539539114","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1509","id":539539114,"node_id":"MDEyOklzc3VlQ29tbWVudDUzOTUzOTExNA==","user":{"login":"coveralls","id":2354108,"node_id":"MDQ6VXNlcjIzNTQxMDg=","avatar_url":"https://avatars.githubusercontent.com/u/2354108?v=4","gravatar_id":"","url":"https://api.github.com/users/coveralls","html_url":"https://github.com/coveralls","followers_url":"https://api.github.com/users/coveralls/followers","following_url":"https://api.github.com/users/coveralls/following{/other_user}","gists_url":"https://api.github.com/users/coveralls/gists{/gist_id}","starred_url":"https://api.github.com/users/coveralls/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coveralls/subscriptions","organizations_url":"https://api.github.com/users/coveralls/orgs","repos_url":"https://api.github.com/users/coveralls/repos","events_url":"https://api.github.com/users/coveralls/events{/privacy}","received_events_url":"https://api.github.com/users/coveralls/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-08T14:25:33Z","updated_at":"2019-10-08T14:25:33Z","author_association":"NONE","body":"\n[![Coverage Status](https://coveralls.io/builds/26181861/badge)](https://coveralls.io/builds/26181861)\n\nCoverage decreased (-0.1%) to 49.408% when pulling **1db828ff5f7e64a866ca54c2e1e35dd270ac8340 on luxward:remove_symbol** into **430c62ec5807f962e9a29db782986437449301b3 on apache:develop**.\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/539539114/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/539749799","html_url":"https://github.com/apache/rocketmq/issues/1482#issuecomment-539749799","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1482","id":539749799,"node_id":"MDEyOklzc3VlQ29tbWVudDUzOTc0OTc5OQ==","user":{"login":"duhenglucky","id":7938968,"node_id":"MDQ6VXNlcjc5Mzg5Njg=","avatar_url":"https://avatars.githubusercontent.com/u/7938968?v=4","gravatar_id":"","url":"https://api.github.com/users/duhenglucky","html_url":"https://github.com/duhenglucky","followers_url":"https://api.github.com/users/duhenglucky/followers","following_url":"https://api.github.com/users/duhenglucky/following{/other_user}","gists_url":"https://api.github.com/users/duhenglucky/gists{/gist_id}","starred_url":"https://api.github.com/users/duhenglucky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/duhenglucky/subscriptions","organizations_url":"https://api.github.com/users/duhenglucky/orgs","repos_url":"https://api.github.com/users/duhenglucky/repos","events_url":"https://api.github.com/users/duhenglucky/events{/privacy}","received_events_url":"https://api.github.com/users/duhenglucky/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-08T23:42:45Z","updated_at":"2019-10-08T23:42:45Z","author_association":"CONTRIBUTOR","body":"@liony as @CodeIngL said if you just want to increase the retry times in async mode, please set retryTimesWhenSendAsyncFailed directly, and more detail can be found in org.apache.rocketmq.client.impl.MQClientAPIImpl#sendMessageAsync, so I will close this issue first, but if you have other questions, please feel free to reopen it.","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/539749799/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/539750190","html_url":"https://github.com/apache/rocketmq/issues/1508#issuecomment-539750190","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1508","id":539750190,"node_id":"MDEyOklzc3VlQ29tbWVudDUzOTc1MDE5MA==","user":{"login":"duhenglucky","id":7938968,"node_id":"MDQ6VXNlcjc5Mzg5Njg=","avatar_url":"https://avatars.githubusercontent.com/u/7938968?v=4","gravatar_id":"","url":"https://api.github.com/users/duhenglucky","html_url":"https://github.com/duhenglucky","followers_url":"https://api.github.com/users/duhenglucky/followers","following_url":"https://api.github.com/users/duhenglucky/following{/other_user}","gists_url":"https://api.github.com/users/duhenglucky/gists{/gist_id}","starred_url":"https://api.github.com/users/duhenglucky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/duhenglucky/subscriptions","organizations_url":"https://api.github.com/users/duhenglucky/orgs","repos_url":"https://api.github.com/users/duhenglucky/repos","events_url":"https://api.github.com/users/duhenglucky/events{/privacy}","received_events_url":"https://api.github.com/users/duhenglucky/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-08T23:44:35Z","updated_at":"2019-10-08T23:44:35Z","author_association":"CONTRIBUTOR","body":"@herenet PHP client is under development. If you are interested, please join us :)","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/539750190/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/539912140","html_url":"https://github.com/apache/rocketmq/pull/1509#issuecomment-539912140","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1509","id":539912140,"node_id":"MDEyOklzc3VlQ29tbWVudDUzOTkxMjE0MA==","user":{"login":"luxward","id":7685825,"node_id":"MDQ6VXNlcjc2ODU4MjU=","avatar_url":"https://avatars.githubusercontent.com/u/7685825?v=4","gravatar_id":"","url":"https://api.github.com/users/luxward","html_url":"https://github.com/luxward","followers_url":"https://api.github.com/users/luxward/followers","following_url":"https://api.github.com/users/luxward/following{/other_user}","gists_url":"https://api.github.com/users/luxward/gists{/gist_id}","starred_url":"https://api.github.com/users/luxward/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luxward/subscriptions","organizations_url":"https://api.github.com/users/luxward/orgs","repos_url":"https://api.github.com/users/luxward/repos","events_url":"https://api.github.com/users/luxward/events{/privacy}","received_events_url":"https://api.github.com/users/luxward/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-09T09:09:23Z","updated_at":"2019-10-09T09:38:32Z","author_association":"NONE","body":"@zhouxinyu please help me review this code. However, result of code checking is straight","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/539912140/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/539997815","html_url":"https://github.com/apache/rocketmq/issues/1465#issuecomment-539997815","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1465","id":539997815,"node_id":"MDEyOklzc3VlQ29tbWVudDUzOTk5NzgxNQ==","user":{"login":"CodeIngL","id":12370508,"node_id":"MDQ6VXNlcjEyMzcwNTA4","avatar_url":"https://avatars.githubusercontent.com/u/12370508?v=4","gravatar_id":"","url":"https://api.github.com/users/CodeIngL","html_url":"https://github.com/CodeIngL","followers_url":"https://api.github.com/users/CodeIngL/followers","following_url":"https://api.github.com/users/CodeIngL/following{/other_user}","gists_url":"https://api.github.com/users/CodeIngL/gists{/gist_id}","starred_url":"https://api.github.com/users/CodeIngL/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CodeIngL/subscriptions","organizations_url":"https://api.github.com/users/CodeIngL/orgs","repos_url":"https://api.github.com/users/CodeIngL/repos","events_url":"https://api.github.com/users/CodeIngL/events{/privacy}","received_events_url":"https://api.github.com/users/CodeIngL/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-09T13:21:01Z","updated_at":"2019-10-09T13:21:01Z","author_association":"NONE","body":"Do you think that extending and controlling the write queue (write>read) to delay consumption, stack messages, and block the consumption of a queue does not exist.\r\n\r\nThere is not enough evidence to enforce the constraint write<=read. Instead of limit, there is more flexibility and more scenes.","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/539997815/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/540004884","html_url":"https://github.com/apache/rocketmq/issues/1457#issuecomment-540004884","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1457","id":540004884,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MDAwNDg4NA==","user":{"login":"CodeIngL","id":12370508,"node_id":"MDQ6VXNlcjEyMzcwNTA4","avatar_url":"https://avatars.githubusercontent.com/u/12370508?v=4","gravatar_id":"","url":"https://api.github.com/users/CodeIngL","html_url":"https://github.com/CodeIngL","followers_url":"https://api.github.com/users/CodeIngL/followers","following_url":"https://api.github.com/users/CodeIngL/following{/other_user}","gists_url":"https://api.github.com/users/CodeIngL/gists{/gist_id}","starred_url":"https://api.github.com/users/CodeIngL/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CodeIngL/subscriptions","organizations_url":"https://api.github.com/users/CodeIngL/orgs","repos_url":"https://api.github.com/users/CodeIngL/repos","events_url":"https://api.github.com/users/CodeIngL/events{/privacy}","received_events_url":"https://api.github.com/users/CodeIngL/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-09T13:38:38Z","updated_at":"2019-10-09T13:38:38Z","author_association":"NONE","body":"Mq can't recognize whether your behavior should let us register, here is a special key:brokerPermission to trigger。 try it","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/540004884/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/540289986","html_url":"https://github.com/apache/rocketmq/issues/1153#issuecomment-540289986","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1153","id":540289986,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MDI4OTk4Ng==","user":{"login":"duhenglucky","id":7938968,"node_id":"MDQ6VXNlcjc5Mzg5Njg=","avatar_url":"https://avatars.githubusercontent.com/u/7938968?v=4","gravatar_id":"","url":"https://api.github.com/users/duhenglucky","html_url":"https://github.com/duhenglucky","followers_url":"https://api.github.com/users/duhenglucky/followers","following_url":"https://api.github.com/users/duhenglucky/following{/other_user}","gists_url":"https://api.github.com/users/duhenglucky/gists{/gist_id}","starred_url":"https://api.github.com/users/duhenglucky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/duhenglucky/subscriptions","organizations_url":"https://api.github.com/users/duhenglucky/orgs","repos_url":"https://api.github.com/users/duhenglucky/repos","events_url":"https://api.github.com/users/duhenglucky/events{/privacy}","received_events_url":"https://api.github.com/users/duhenglucky/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-10T01:52:05Z","updated_at":"2019-10-10T01:52:05Z","author_association":"CONTRIBUTOR","body":"this issue has been resolved in this [pr](https://github.com/apache/rocketmq/pulls?q=is%3Apr+is%3Aclosed)","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/540289986/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/540292872","html_url":"https://github.com/apache/rocketmq/issues/1137#issuecomment-540292872","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1137","id":540292872,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MDI5Mjg3Mg==","user":{"login":"duhenglucky","id":7938968,"node_id":"MDQ6VXNlcjc5Mzg5Njg=","avatar_url":"https://avatars.githubusercontent.com/u/7938968?v=4","gravatar_id":"","url":"https://api.github.com/users/duhenglucky","html_url":"https://github.com/duhenglucky","followers_url":"https://api.github.com/users/duhenglucky/followers","following_url":"https://api.github.com/users/duhenglucky/following{/other_user}","gists_url":"https://api.github.com/users/duhenglucky/gists{/gist_id}","starred_url":"https://api.github.com/users/duhenglucky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/duhenglucky/subscriptions","organizations_url":"https://api.github.com/users/duhenglucky/orgs","repos_url":"https://api.github.com/users/duhenglucky/repos","events_url":"https://api.github.com/users/duhenglucky/events{/privacy}","received_events_url":"https://api.github.com/users/duhenglucky/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-10T02:01:01Z","updated_at":"2019-10-10T02:01:01Z","author_association":"CONTRIBUTOR","body":"this issue has been resolved in this [pr](https://github.com/apache/rocketmq/pull/1403)","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/540292872/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/540293344","html_url":"https://github.com/apache/rocketmq/issues/1064#issuecomment-540293344","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1064","id":540293344,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MDI5MzM0NA==","user":{"login":"duhenglucky","id":7938968,"node_id":"MDQ6VXNlcjc5Mzg5Njg=","avatar_url":"https://avatars.githubusercontent.com/u/7938968?v=4","gravatar_id":"","url":"https://api.github.com/users/duhenglucky","html_url":"https://github.com/duhenglucky","followers_url":"https://api.github.com/users/duhenglucky/followers","following_url":"https://api.github.com/users/duhenglucky/following{/other_user}","gists_url":"https://api.github.com/users/duhenglucky/gists{/gist_id}","starred_url":"https://api.github.com/users/duhenglucky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/duhenglucky/subscriptions","organizations_url":"https://api.github.com/users/duhenglucky/orgs","repos_url":"https://api.github.com/users/duhenglucky/repos","events_url":"https://api.github.com/users/duhenglucky/events{/privacy}","received_events_url":"https://api.github.com/users/duhenglucky/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-10T02:02:20Z","updated_at":"2019-10-10T02:02:20Z","author_association":"CONTRIBUTOR","body":"this issue has been resolved in this [pr](https://github.com/apache/rocketmq/pull/1415)","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/540293344/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/540293576","html_url":"https://github.com/apache/rocketmq/issues/1042#issuecomment-540293576","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1042","id":540293576,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MDI5MzU3Ng==","user":{"login":"duhenglucky","id":7938968,"node_id":"MDQ6VXNlcjc5Mzg5Njg=","avatar_url":"https://avatars.githubusercontent.com/u/7938968?v=4","gravatar_id":"","url":"https://api.github.com/users/duhenglucky","html_url":"https://github.com/duhenglucky","followers_url":"https://api.github.com/users/duhenglucky/followers","following_url":"https://api.github.com/users/duhenglucky/following{/other_user}","gists_url":"https://api.github.com/users/duhenglucky/gists{/gist_id}","starred_url":"https://api.github.com/users/duhenglucky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/duhenglucky/subscriptions","organizations_url":"https://api.github.com/users/duhenglucky/orgs","repos_url":"https://api.github.com/users/duhenglucky/repos","events_url":"https://api.github.com/users/duhenglucky/events{/privacy}","received_events_url":"https://api.github.com/users/duhenglucky/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-10T02:02:59Z","updated_at":"2019-10-10T02:02:59Z","author_association":"CONTRIBUTOR","body":"fixed","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/540293576/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/540296161","html_url":"https://github.com/apache/rocketmq/issues/1064#issuecomment-540296161","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1064","id":540296161,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MDI5NjE2MQ==","user":{"login":"vongosling","id":635581,"node_id":"MDQ6VXNlcjYzNTU4MQ==","avatar_url":"https://avatars.githubusercontent.com/u/635581?v=4","gravatar_id":"","url":"https://api.github.com/users/vongosling","html_url":"https://github.com/vongosling","followers_url":"https://api.github.com/users/vongosling/followers","following_url":"https://api.github.com/users/vongosling/following{/other_user}","gists_url":"https://api.github.com/users/vongosling/gists{/gist_id}","starred_url":"https://api.github.com/users/vongosling/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vongosling/subscriptions","organizations_url":"https://api.github.com/users/vongosling/orgs","repos_url":"https://api.github.com/users/vongosling/repos","events_url":"https://api.github.com/users/vongosling/events{/privacy}","received_events_url":"https://api.github.com/users/vongosling/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-10T02:09:57Z","updated_at":"2019-10-10T02:09:57Z","author_association":"MEMBER","body":"@zhengjf1988 please refer to the pinned issue in issue home page. Any problem, please let us know:-)","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/540296161/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/540301075","html_url":"https://github.com/apache/rocketmq/issues/1511#issuecomment-540301075","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1511","id":540301075,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MDMwMTA3NQ==","user":{"login":"Messilimeng","id":12272166,"node_id":"MDQ6VXNlcjEyMjcyMTY2","avatar_url":"https://avatars.githubusercontent.com/u/12272166?v=4","gravatar_id":"","url":"https://api.github.com/users/Messilimeng","html_url":"https://github.com/Messilimeng","followers_url":"https://api.github.com/users/Messilimeng/followers","following_url":"https://api.github.com/users/Messilimeng/following{/other_user}","gists_url":"https://api.github.com/users/Messilimeng/gists{/gist_id}","starred_url":"https://api.github.com/users/Messilimeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Messilimeng/subscriptions","organizations_url":"https://api.github.com/users/Messilimeng/orgs","repos_url":"https://api.github.com/users/Messilimeng/repos","events_url":"https://api.github.com/users/Messilimeng/events{/privacy}","received_events_url":"https://api.github.com/users/Messilimeng/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-10T02:22:54Z","updated_at":"2019-10-10T02:22:54Z","author_association":"NONE","body":"%Cpu(s):  1.1 us,  0.5 sy,  0.0 ni, 98.3 id,  0.1 wa,  0.0 hi,  0.0 si,  0.0 st\r\nKiB Mem :  8058436 total,  1451536 free,  2666804 used,  3940096 buff/cache\r\nKiB Swap:  2097148 total,  2097148 free,        0 used.  4427420 avail Mem ","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/540301075/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/540333943","html_url":"https://github.com/apache/rocketmq/issues/1178#issuecomment-540333943","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1178","id":540333943,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MDMzMzk0Mw==","user":{"login":"Switch-vov","id":11993575,"node_id":"MDQ6VXNlcjExOTkzNTc1","avatar_url":"https://avatars.githubusercontent.com/u/11993575?v=4","gravatar_id":"","url":"https://api.github.com/users/Switch-vov","html_url":"https://github.com/Switch-vov","followers_url":"https://api.github.com/users/Switch-vov/followers","following_url":"https://api.github.com/users/Switch-vov/following{/other_user}","gists_url":"https://api.github.com/users/Switch-vov/gists{/gist_id}","starred_url":"https://api.github.com/users/Switch-vov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Switch-vov/subscriptions","organizations_url":"https://api.github.com/users/Switch-vov/orgs","repos_url":"https://api.github.com/users/Switch-vov/repos","events_url":"https://api.github.com/users/Switch-vov/events{/privacy}","received_events_url":"https://api.github.com/users/Switch-vov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-10T03:49:21Z","updated_at":"2019-10-10T03:50:44Z","author_association":"CONTRIBUTOR","body":"@xiangwangcheng @laosijikaichele\r\n\r\nAfter test it, it is reachable code, but it is very ambiguous.\r\nSo, I think it should be refactoring to below code.\r\n\r\nbefore update:\r\n\r\n``` java\r\n    private SendResult processSendResponse(\r\n        final String brokerName,\r\n        final Message msg,\r\n        final RemotingCommand response\r\n    ) throws MQBrokerException, RemotingCommandException {\r\n        switch (response.getCode()) {\r\n            case ResponseCode.FLUSH_DISK_TIMEOUT:\r\n            case ResponseCode.FLUSH_SLAVE_TIMEOUT:\r\n            case ResponseCode.SLAVE_NOT_AVAILABLE: {\r\n            }\r\n            case ResponseCode.SUCCESS: {\r\n                SendStatus sendStatus = SendStatus.SEND_OK;\r\n                switch (response.getCode()) {\r\n                    case ResponseCode.FLUSH_DISK_TIMEOUT:\r\n                        sendStatus = SendStatus.FLUSH_DISK_TIMEOUT;\r\n                        break;\r\n                    case ResponseCode.FLUSH_SLAVE_TIMEOUT:\r\n                        sendStatus = SendStatus.FLUSH_SLAVE_TIMEOUT;\r\n                        break;\r\n                    case ResponseCode.SLAVE_NOT_AVAILABLE:\r\n                        sendStatus = SendStatus.SLAVE_NOT_AVAILABLE;\r\n                        break;\r\n                    case ResponseCode.SUCCESS:\r\n                        sendStatus = SendStatus.SEND_OK;\r\n                        break;\r\n                    default:\r\n                        assert false;\r\n                        break;\r\n                }\r\n\r\n                // some code\r\n            }\r\n            default:\r\n                break;\r\n        }\r\n\r\n        throw new MQBrokerException(response.getCode(), response.getRemark());\r\n    }\r\n```\r\n\r\nupdated code:\r\n\r\n``` java\r\n    private SendResult processSendResponse(\r\n        final String brokerName,\r\n        final Message msg,\r\n        final RemotingCommand response\r\n    ) throws MQBrokerException, RemotingCommandException {\r\n        SendStatus sendStatus = null;\r\n        switch (response.getCode()) {\r\n            case ResponseCode.FLUSH_DISK_TIMEOUT: {\r\n                sendStatus = SendStatus.FLUSH_DISK_TIMEOUT;\r\n                break;\r\n            }\r\n            case ResponseCode.FLUSH_SLAVE_TIMEOUT: {\r\n                sendStatus = SendStatus.FLUSH_SLAVE_TIMEOUT;\r\n                break;\r\n            }\r\n            case ResponseCode.SLAVE_NOT_AVAILABLE: {\r\n                sendStatus = SendStatus.SLAVE_NOT_AVAILABLE;\r\n                break;\r\n            }\r\n            case ResponseCode.SUCCESS: {\r\n                sendStatus = SendStatus.SEND_OK;\r\n                break;\r\n            }\r\n            default:\r\n                break;\r\n        }\r\n\r\n        if (sendStatus != null) {\r\n            // some code\r\n        }\r\n\r\n        throw new MQBrokerException(response.getCode(), response.getRemark());\r\n    }\r\n\r\n```\r\n\r\nunit test code `org.apache.rocketmq.client.impl.MQClientAPIImplTest#testSendMessageSync_WithProcessSendResponseHandleException`:\r\n\r\n``` java\r\n    @Test\r\n    public void testSendMessageSync_WithProcessSendResponseHandleException() throws InterruptedException, RemotingException, MQBrokerException {\r\n        int[] responseCodes = {ResponseCode.FLUSH_DISK_TIMEOUT, ResponseCode.FLUSH_SLAVE_TIMEOUT,\r\n                ResponseCode.SLAVE_NOT_AVAILABLE};\r\n        SendStatus[] sendStatuses = {SendStatus.FLUSH_DISK_TIMEOUT, SendStatus.FLUSH_SLAVE_TIMEOUT, SendStatus.SLAVE_NOT_AVAILABLE};\r\n        for (int i = 0; i < responseCodes.length; i++) {\r\n            final int responseCode = responseCodes[i];\r\n            doAnswer(new Answer() {\r\n                @Override\r\n                public Object answer(InvocationOnMock mock) throws Throwable {\r\n                    RemotingCommand request = mock.getArgument(1);\r\n                    RemotingCommand response = createSuccessResponse(request);\r\n                    response.setCode(responseCode);\r\n                    return response;\r\n                }\r\n            }).when(remotingClient).invokeSync(anyString(), any(RemotingCommand.class), anyLong());\r\n\r\n            SendMessageRequestHeader requestHeader = createSendMessageRequestHeader();\r\n            SendResult sendResult = mqClientAPI.sendMessage(brokerAddr, brokerName, msg, requestHeader,\r\n                    3 * 1000, CommunicationMode.SYNC, new SendMessageContext(), defaultMQProducerImpl);\r\n            assertThat(sendResult.getSendStatus()).isEqualTo(sendStatuses[i]);\r\n        }\r\n    }\r\n```","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/540333943/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/540416126","html_url":"https://github.com/apache/rocketmq/issues/1178#issuecomment-540416126","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1178","id":540416126,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MDQxNjEyNg==","user":{"login":"Switch-vov","id":11993575,"node_id":"MDQ6VXNlcjExOTkzNTc1","avatar_url":"https://avatars.githubusercontent.com/u/11993575?v=4","gravatar_id":"","url":"https://api.github.com/users/Switch-vov","html_url":"https://github.com/Switch-vov","followers_url":"https://api.github.com/users/Switch-vov/followers","following_url":"https://api.github.com/users/Switch-vov/following{/other_user}","gists_url":"https://api.github.com/users/Switch-vov/gists{/gist_id}","starred_url":"https://api.github.com/users/Switch-vov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Switch-vov/subscriptions","organizations_url":"https://api.github.com/users/Switch-vov/orgs","repos_url":"https://api.github.com/users/Switch-vov/repos","events_url":"https://api.github.com/users/Switch-vov/events{/privacy}","received_events_url":"https://api.github.com/users/Switch-vov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-10T06:54:24Z","updated_at":"2019-10-10T07:19:02Z","author_association":"CONTRIBUTOR","body":"@xiangwangcheng I apply the PR. please review it.\r\n@laosijikaichele I think it should be refactor like the code in the above comment. If remove this code, the code process would be changed.","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/540416126/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/540423160","html_url":"https://github.com/apache/rocketmq/pull/1513#issuecomment-540423160","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1513","id":540423160,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MDQyMzE2MA==","user":{"login":"coveralls","id":2354108,"node_id":"MDQ6VXNlcjIzNTQxMDg=","avatar_url":"https://avatars.githubusercontent.com/u/2354108?v=4","gravatar_id":"","url":"https://api.github.com/users/coveralls","html_url":"https://github.com/coveralls","followers_url":"https://api.github.com/users/coveralls/followers","following_url":"https://api.github.com/users/coveralls/following{/other_user}","gists_url":"https://api.github.com/users/coveralls/gists{/gist_id}","starred_url":"https://api.github.com/users/coveralls/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coveralls/subscriptions","organizations_url":"https://api.github.com/users/coveralls/orgs","repos_url":"https://api.github.com/users/coveralls/repos","events_url":"https://api.github.com/users/coveralls/events{/privacy}","received_events_url":"https://api.github.com/users/coveralls/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-10T07:08:06Z","updated_at":"2019-10-10T07:08:06Z","author_association":"NONE","body":"\n[![Coverage Status](https://coveralls.io/builds/26224806/badge)](https://coveralls.io/builds/26224806)\n\nCoverage increased (+0.01%) to 49.531% when pulling **9eda296b7104d6a411c7cd220f2e307ad3cbc33d on Switch-vov:develop** into **430c62ec5807f962e9a29db782986437449301b3 on apache:develop**.\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/540423160/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/540471824","html_url":"https://github.com/apache/rocketmq/issues/1514#issuecomment-540471824","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1514","id":540471824,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MDQ3MTgyNA==","user":{"login":"RongNanNan","id":19367620,"node_id":"MDQ6VXNlcjE5MzY3NjIw","avatar_url":"https://avatars.githubusercontent.com/u/19367620?v=4","gravatar_id":"","url":"https://api.github.com/users/RongNanNan","html_url":"https://github.com/RongNanNan","followers_url":"https://api.github.com/users/RongNanNan/followers","following_url":"https://api.github.com/users/RongNanNan/following{/other_user}","gists_url":"https://api.github.com/users/RongNanNan/gists{/gist_id}","starred_url":"https://api.github.com/users/RongNanNan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RongNanNan/subscriptions","organizations_url":"https://api.github.com/users/RongNanNan/orgs","repos_url":"https://api.github.com/users/RongNanNan/repos","events_url":"https://api.github.com/users/RongNanNan/events{/privacy}","received_events_url":"https://api.github.com/users/RongNanNan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-10T08:58:50Z","updated_at":"2019-10-10T08:58:50Z","author_association":"NONE","body":"一般会时不时的出现busy的情况，这个时候重试另外一个broker就可以了\r\n高可用考虑：判断下次重试的broker是不是之前busy的重试的broker即可","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/540471824/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/540472159","html_url":"https://github.com/apache/rocketmq/issues/1514#issuecomment-540472159","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1514","id":540472159,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MDQ3MjE1OQ==","user":{"login":"RongNanNan","id":19367620,"node_id":"MDQ6VXNlcjE5MzY3NjIw","avatar_url":"https://avatars.githubusercontent.com/u/19367620?v=4","gravatar_id":"","url":"https://api.github.com/users/RongNanNan","html_url":"https://github.com/RongNanNan","followers_url":"https://api.github.com/users/RongNanNan/followers","following_url":"https://api.github.com/users/RongNanNan/following{/other_user}","gists_url":"https://api.github.com/users/RongNanNan/gists{/gist_id}","starred_url":"https://api.github.com/users/RongNanNan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RongNanNan/subscriptions","organizations_url":"https://api.github.com/users/RongNanNan/orgs","repos_url":"https://api.github.com/users/RongNanNan/repos","events_url":"https://api.github.com/users/RongNanNan/events{/privacy}","received_events_url":"https://api.github.com/users/RongNanNan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-10T08:59:42Z","updated_at":"2019-10-10T08:59:42Z","author_association":"NONE","body":"![image](https://user-images.githubusercontent.com/19367620/66554284-4c994d80-eb7f-11e9-87d2-59f2b1852779.png)\r\n![image](https://user-images.githubusercontent.com/19367620/66554303-57ec7900-eb7f-11e9-9112-4c2310162749.png)\r\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/540472159/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/540473166","html_url":"https://github.com/apache/rocketmq/issues/1514#issuecomment-540473166","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1514","id":540473166,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MDQ3MzE2Ng==","user":{"login":"RongNanNan","id":19367620,"node_id":"MDQ6VXNlcjE5MzY3NjIw","avatar_url":"https://avatars.githubusercontent.com/u/19367620?v=4","gravatar_id":"","url":"https://api.github.com/users/RongNanNan","html_url":"https://github.com/RongNanNan","followers_url":"https://api.github.com/users/RongNanNan/followers","following_url":"https://api.github.com/users/RongNanNan/following{/other_user}","gists_url":"https://api.github.com/users/RongNanNan/gists{/gist_id}","starred_url":"https://api.github.com/users/RongNanNan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RongNanNan/subscriptions","organizations_url":"https://api.github.com/users/RongNanNan/orgs","repos_url":"https://api.github.com/users/RongNanNan/repos","events_url":"https://api.github.com/users/RongNanNan/events{/privacy}","received_events_url":"https://api.github.com/users/RongNanNan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-10T09:01:53Z","updated_at":"2019-10-10T09:01:53Z","author_association":"NONE","body":"客户端的高可用一般时使用重试机制，busy的情况时考虑到保护broker，只要做到不会在向busy的broker发消息就可以了","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/540473166/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/540505335","html_url":"https://github.com/apache/rocketmq/pull/1516#issuecomment-540505335","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1516","id":540505335,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MDUwNTMzNQ==","user":{"login":"shenhui0509","id":9401184,"node_id":"MDQ6VXNlcjk0MDExODQ=","avatar_url":"https://avatars.githubusercontent.com/u/9401184?v=4","gravatar_id":"","url":"https://api.github.com/users/shenhui0509","html_url":"https://github.com/shenhui0509","followers_url":"https://api.github.com/users/shenhui0509/followers","following_url":"https://api.github.com/users/shenhui0509/following{/other_user}","gists_url":"https://api.github.com/users/shenhui0509/gists{/gist_id}","starred_url":"https://api.github.com/users/shenhui0509/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shenhui0509/subscriptions","organizations_url":"https://api.github.com/users/shenhui0509/orgs","repos_url":"https://api.github.com/users/shenhui0509/repos","events_url":"https://api.github.com/users/shenhui0509/events{/privacy}","received_events_url":"https://api.github.com/users/shenhui0509/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-10T10:25:06Z","updated_at":"2019-10-10T10:25:06Z","author_association":"NONE","body":"ping @duhenglucky @vongosling ","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/540505335/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/540515505","html_url":"https://github.com/apache/rocketmq/pull/1516#issuecomment-540515505","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1516","id":540515505,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MDUxNTUwNQ==","user":{"login":"duhenglucky","id":7938968,"node_id":"MDQ6VXNlcjc5Mzg5Njg=","avatar_url":"https://avatars.githubusercontent.com/u/7938968?v=4","gravatar_id":"","url":"https://api.github.com/users/duhenglucky","html_url":"https://github.com/duhenglucky","followers_url":"https://api.github.com/users/duhenglucky/followers","following_url":"https://api.github.com/users/duhenglucky/following{/other_user}","gists_url":"https://api.github.com/users/duhenglucky/gists{/gist_id}","starred_url":"https://api.github.com/users/duhenglucky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/duhenglucky/subscriptions","organizations_url":"https://api.github.com/users/duhenglucky/orgs","repos_url":"https://api.github.com/users/duhenglucky/repos","events_url":"https://api.github.com/users/duhenglucky/events{/privacy}","received_events_url":"https://api.github.com/users/duhenglucky/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-10T10:55:13Z","updated_at":"2019-10-10T10:55:13Z","author_association":"CONTRIBUTOR","body":"@shenhui0509 good job, thanks for your contribution, we will review this PR ASAP.","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/540515505/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/540515833","html_url":"https://github.com/apache/rocketmq/pull/1516#issuecomment-540515833","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1516","id":540515833,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MDUxNTgzMw==","user":{"login":"duhenglucky","id":7938968,"node_id":"MDQ6VXNlcjc5Mzg5Njg=","avatar_url":"https://avatars.githubusercontent.com/u/7938968?v=4","gravatar_id":"","url":"https://api.github.com/users/duhenglucky","html_url":"https://github.com/duhenglucky","followers_url":"https://api.github.com/users/duhenglucky/followers","following_url":"https://api.github.com/users/duhenglucky/following{/other_user}","gists_url":"https://api.github.com/users/duhenglucky/gists{/gist_id}","starred_url":"https://api.github.com/users/duhenglucky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/duhenglucky/subscriptions","organizations_url":"https://api.github.com/users/duhenglucky/orgs","repos_url":"https://api.github.com/users/duhenglucky/repos","events_url":"https://api.github.com/users/duhenglucky/events{/privacy}","received_events_url":"https://api.github.com/users/duhenglucky/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-10T10:56:07Z","updated_at":"2019-10-10T10:56:07Z","author_association":"CONTRIBUTOR","body":"@shenhui0509 and it would be nice if you can pull this request to develop branch","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/540515833/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/540523915","html_url":"https://github.com/apache/rocketmq/pull/1516#issuecomment-540523915","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1516","id":540523915,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MDUyMzkxNQ==","user":{"login":"shenhui0509","id":9401184,"node_id":"MDQ6VXNlcjk0MDExODQ=","avatar_url":"https://avatars.githubusercontent.com/u/9401184?v=4","gravatar_id":"","url":"https://api.github.com/users/shenhui0509","html_url":"https://github.com/shenhui0509","followers_url":"https://api.github.com/users/shenhui0509/followers","following_url":"https://api.github.com/users/shenhui0509/following{/other_user}","gists_url":"https://api.github.com/users/shenhui0509/gists{/gist_id}","starred_url":"https://api.github.com/users/shenhui0509/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shenhui0509/subscriptions","organizations_url":"https://api.github.com/users/shenhui0509/orgs","repos_url":"https://api.github.com/users/shenhui0509/repos","events_url":"https://api.github.com/users/shenhui0509/events{/privacy}","received_events_url":"https://api.github.com/users/shenhui0509/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-10T11:18:59Z","updated_at":"2019-10-10T11:18:59Z","author_association":"NONE","body":"> @shenhui0509 and it would be nice if you can pull this request to develop branch\r\n\r\ndone","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/540523915/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/540891434","html_url":"https://github.com/apache/rocketmq/issues/1360#issuecomment-540891434","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1360","id":540891434,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MDg5MTQzNA==","user":{"login":"liucyu","id":13191643,"node_id":"MDQ6VXNlcjEzMTkxNjQz","avatar_url":"https://avatars.githubusercontent.com/u/13191643?v=4","gravatar_id":"","url":"https://api.github.com/users/liucyu","html_url":"https://github.com/liucyu","followers_url":"https://api.github.com/users/liucyu/followers","following_url":"https://api.github.com/users/liucyu/following{/other_user}","gists_url":"https://api.github.com/users/liucyu/gists{/gist_id}","starred_url":"https://api.github.com/users/liucyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liucyu/subscriptions","organizations_url":"https://api.github.com/users/liucyu/orgs","repos_url":"https://api.github.com/users/liucyu/repos","events_url":"https://api.github.com/users/liucyu/events{/privacy}","received_events_url":"https://api.github.com/users/liucyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-11T03:58:52Z","updated_at":"2019-10-11T03:58:52Z","author_association":"NONE","body":"the core question is that `countDownLatch.await(timeout)` will block more than timeout that you set,but this phenomenon only appears when system  is under heavy load. And the solution to this problem is to manually execute `countDownLatch.countDown()`.\r\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/540891434/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/541045758","html_url":"https://github.com/apache/rocketmq/pull/1516#issuecomment-541045758","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1516","id":541045758,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MTA0NTc1OA==","user":{"login":"shenhui0509","id":9401184,"node_id":"MDQ6VXNlcjk0MDExODQ=","avatar_url":"https://avatars.githubusercontent.com/u/9401184?v=4","gravatar_id":"","url":"https://api.github.com/users/shenhui0509","html_url":"https://github.com/shenhui0509","followers_url":"https://api.github.com/users/shenhui0509/followers","following_url":"https://api.github.com/users/shenhui0509/following{/other_user}","gists_url":"https://api.github.com/users/shenhui0509/gists{/gist_id}","starred_url":"https://api.github.com/users/shenhui0509/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shenhui0509/subscriptions","organizations_url":"https://api.github.com/users/shenhui0509/orgs","repos_url":"https://api.github.com/users/shenhui0509/repos","events_url":"https://api.github.com/users/shenhui0509/events{/privacy}","received_events_url":"https://api.github.com/users/shenhui0509/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-11T12:34:26Z","updated_at":"2019-10-11T12:34:26Z","author_association":"NONE","body":"Hi, @duhenglucky, is it necessary to write a RIP? If needed, I'd like to write one.","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/541045758/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/541046664","html_url":"https://github.com/apache/rocketmq/pull/1516#issuecomment-541046664","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1516","id":541046664,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MTA0NjY2NA==","user":{"login":"xujianhai666","id":52450794,"node_id":"MDQ6VXNlcjUyNDUwNzk0","avatar_url":"https://avatars.githubusercontent.com/u/52450794?v=4","gravatar_id":"","url":"https://api.github.com/users/xujianhai666","html_url":"https://github.com/xujianhai666","followers_url":"https://api.github.com/users/xujianhai666/followers","following_url":"https://api.github.com/users/xujianhai666/following{/other_user}","gists_url":"https://api.github.com/users/xujianhai666/gists{/gist_id}","starred_url":"https://api.github.com/users/xujianhai666/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xujianhai666/subscriptions","organizations_url":"https://api.github.com/users/xujianhai666/orgs","repos_url":"https://api.github.com/users/xujianhai666/repos","events_url":"https://api.github.com/users/xujianhai666/events{/privacy}","received_events_url":"https://api.github.com/users/xujianhai666/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-11T12:37:36Z","updated_at":"2019-10-11T12:37:36Z","author_association":"MEMBER","body":"> Hi, @duhenglucky, is it necessary to write a RIP? If needed, I'd like to write one.\r\n\r\n@shenhui0509 @duhenglucky I think this pr is so important, A RIP is necessary","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/541046664/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/541119951","html_url":"https://github.com/apache/rocketmq/pull/1518#issuecomment-541119951","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1518","id":541119951,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MTExOTk1MQ==","user":{"login":"coveralls","id":2354108,"node_id":"MDQ6VXNlcjIzNTQxMDg=","avatar_url":"https://avatars.githubusercontent.com/u/2354108?v=4","gravatar_id":"","url":"https://api.github.com/users/coveralls","html_url":"https://github.com/coveralls","followers_url":"https://api.github.com/users/coveralls/followers","following_url":"https://api.github.com/users/coveralls/following{/other_user}","gists_url":"https://api.github.com/users/coveralls/gists{/gist_id}","starred_url":"https://api.github.com/users/coveralls/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coveralls/subscriptions","organizations_url":"https://api.github.com/users/coveralls/orgs","repos_url":"https://api.github.com/users/coveralls/repos","events_url":"https://api.github.com/users/coveralls/events{/privacy}","received_events_url":"https://api.github.com/users/coveralls/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-11T15:51:37Z","updated_at":"2019-10-12T08:02:20Z","author_association":"NONE","body":"\n[![Coverage Status](https://coveralls.io/builds/26273136/badge)](https://coveralls.io/builds/26273136)\n\nCoverage decreased (-0.09%) to 50.488% when pulling **06bcad0c6ceaaaf5bc46c784ea5fa1fc343998b9 on areyouok:tx** into **ce4478aa29e46db4e4b58e90142a63f5fd9168d8 on apache:master**.\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/541119951/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/541121124","html_url":"https://github.com/apache/rocketmq/issues/1517#issuecomment-541121124","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1517","id":541121124,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MTEyMTEyNA==","user":{"login":"areyouok","id":3192556,"node_id":"MDQ6VXNlcjMxOTI1NTY=","avatar_url":"https://avatars.githubusercontent.com/u/3192556?v=4","gravatar_id":"","url":"https://api.github.com/users/areyouok","html_url":"https://github.com/areyouok","followers_url":"https://api.github.com/users/areyouok/followers","following_url":"https://api.github.com/users/areyouok/following{/other_user}","gists_url":"https://api.github.com/users/areyouok/gists{/gist_id}","starred_url":"https://api.github.com/users/areyouok/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/areyouok/subscriptions","organizations_url":"https://api.github.com/users/areyouok/orgs","repos_url":"https://api.github.com/users/areyouok/repos","events_url":"https://api.github.com/users/areyouok/events{/privacy}","received_events_url":"https://api.github.com/users/areyouok/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-11T15:54:50Z","updated_at":"2019-10-11T15:54:50Z","author_association":"CONTRIBUTOR","body":"I create an PR to fix it.\r\n\r\nhttps://github.com/apache/rocketmq/pull/1518\r\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/541121124/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/541121461","html_url":"https://github.com/apache/rocketmq/pull/1518#issuecomment-541121461","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1518","id":541121461,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MTEyMTQ2MQ==","user":{"login":"areyouok","id":3192556,"node_id":"MDQ6VXNlcjMxOTI1NTY=","avatar_url":"https://avatars.githubusercontent.com/u/3192556?v=4","gravatar_id":"","url":"https://api.github.com/users/areyouok","html_url":"https://github.com/areyouok","followers_url":"https://api.github.com/users/areyouok/followers","following_url":"https://api.github.com/users/areyouok/following{/other_user}","gists_url":"https://api.github.com/users/areyouok/gists{/gist_id}","starred_url":"https://api.github.com/users/areyouok/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/areyouok/subscriptions","organizations_url":"https://api.github.com/users/areyouok/orgs","repos_url":"https://api.github.com/users/areyouok/repos","events_url":"https://api.github.com/users/areyouok/events{/privacy}","received_events_url":"https://api.github.com/users/areyouok/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-11T15:55:46Z","updated_at":"2019-10-11T15:55:46Z","author_association":"CONTRIBUTOR","body":"see #1517 ","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/541121461/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/541276152","html_url":"https://github.com/apache/rocketmq/pull/1516#issuecomment-541276152","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1516","id":541276152,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MTI3NjE1Mg==","user":{"login":"duhenglucky","id":7938968,"node_id":"MDQ6VXNlcjc5Mzg5Njg=","avatar_url":"https://avatars.githubusercontent.com/u/7938968?v=4","gravatar_id":"","url":"https://api.github.com/users/duhenglucky","html_url":"https://github.com/duhenglucky","followers_url":"https://api.github.com/users/duhenglucky/followers","following_url":"https://api.github.com/users/duhenglucky/following{/other_user}","gists_url":"https://api.github.com/users/duhenglucky/gists{/gist_id}","starred_url":"https://api.github.com/users/duhenglucky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/duhenglucky/subscriptions","organizations_url":"https://api.github.com/users/duhenglucky/orgs","repos_url":"https://api.github.com/users/duhenglucky/repos","events_url":"https://api.github.com/users/duhenglucky/events{/privacy}","received_events_url":"https://api.github.com/users/duhenglucky/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-12T02:41:57Z","updated_at":"2019-10-12T02:42:51Z","author_association":"CONTRIBUTOR","body":"@xujianhai666 good suggestion, @shenhui0509   This PR is indeed a relatively big change, and on the critical path, it is best to write a RIP to describe the scope of the relevant changes, as well as the key design in this PR, if you have any other question, please feel free ask me directly.","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/541276152/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/541276486","html_url":"https://github.com/apache/rocketmq/issues/1520#issuecomment-541276486","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1520","id":541276486,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MTI3NjQ4Ng==","user":{"login":"RongNanNan","id":19367620,"node_id":"MDQ6VXNlcjE5MzY3NjIw","avatar_url":"https://avatars.githubusercontent.com/u/19367620?v=4","gravatar_id":"","url":"https://api.github.com/users/RongNanNan","html_url":"https://github.com/RongNanNan","followers_url":"https://api.github.com/users/RongNanNan/followers","following_url":"https://api.github.com/users/RongNanNan/following{/other_user}","gists_url":"https://api.github.com/users/RongNanNan/gists{/gist_id}","starred_url":"https://api.github.com/users/RongNanNan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RongNanNan/subscriptions","organizations_url":"https://api.github.com/users/RongNanNan/orgs","repos_url":"https://api.github.com/users/RongNanNan/repos","events_url":"https://api.github.com/users/RongNanNan/events{/privacy}","received_events_url":"https://api.github.com/users/RongNanNan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-12T02:46:28Z","updated_at":"2019-10-12T02:46:28Z","author_association":"NONE","body":"consumerMode：BROADCASTING\r\nstatAll common return the consumer group accumulation = brokerOffet\r\n\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/541276486/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/541298931","html_url":"https://github.com/apache/rocketmq/pull/1522#issuecomment-541298931","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1522","id":541298931,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MTI5ODkzMQ==","user":{"login":"coveralls","id":2354108,"node_id":"MDQ6VXNlcjIzNTQxMDg=","avatar_url":"https://avatars.githubusercontent.com/u/2354108?v=4","gravatar_id":"","url":"https://api.github.com/users/coveralls","html_url":"https://github.com/coveralls","followers_url":"https://api.github.com/users/coveralls/followers","following_url":"https://api.github.com/users/coveralls/following{/other_user}","gists_url":"https://api.github.com/users/coveralls/gists{/gist_id}","starred_url":"https://api.github.com/users/coveralls/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coveralls/subscriptions","organizations_url":"https://api.github.com/users/coveralls/orgs","repos_url":"https://api.github.com/users/coveralls/repos","events_url":"https://api.github.com/users/coveralls/events{/privacy}","received_events_url":"https://api.github.com/users/coveralls/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-12T08:03:02Z","updated_at":"2019-10-12T08:03:02Z","author_association":"NONE","body":"\n[![Coverage Status](https://coveralls.io/builds/26273180/badge)](https://coveralls.io/builds/26273180)\n\nCoverage decreased (-0.1%) to 50.46% when pulling **d9dc8b00db390e60df8f1c1d499bdfc5cd4b65da on areyouok:tx_fix_doneList** into **ce4478aa29e46db4e4b58e90142a63f5fd9168d8 on apache:master**.\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/541298931/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/541299223","html_url":"https://github.com/apache/rocketmq/pull/1490#issuecomment-541299223","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1490","id":541299223,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MTI5OTIyMw==","user":{"login":"coveralls","id":2354108,"node_id":"MDQ6VXNlcjIzNTQxMDg=","avatar_url":"https://avatars.githubusercontent.com/u/2354108?v=4","gravatar_id":"","url":"https://api.github.com/users/coveralls","html_url":"https://github.com/coveralls","followers_url":"https://api.github.com/users/coveralls/followers","following_url":"https://api.github.com/users/coveralls/following{/other_user}","gists_url":"https://api.github.com/users/coveralls/gists{/gist_id}","starred_url":"https://api.github.com/users/coveralls/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coveralls/subscriptions","organizations_url":"https://api.github.com/users/coveralls/orgs","repos_url":"https://api.github.com/users/coveralls/repos","events_url":"https://api.github.com/users/coveralls/events{/privacy}","received_events_url":"https://api.github.com/users/coveralls/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-12T08:06:44Z","updated_at":"2019-10-12T08:06:44Z","author_association":"NONE","body":"\n[![Coverage Status](https://coveralls.io/builds/26273196/badge)](https://coveralls.io/builds/26273196)\n\nCoverage increased (+0.005%) to 49.525% when pulling **3db4961e869b23868e247f924b294c1c332ab157 on ysjjovo:develop** into **430c62ec5807f962e9a29db782986437449301b3 on apache:develop**.\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/541299223/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/541301834","html_url":"https://github.com/apache/rocketmq/pull/1521#issuecomment-541301834","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1521","id":541301834,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MTMwMTgzNA==","user":{"login":"coveralls","id":2354108,"node_id":"MDQ6VXNlcjIzNTQxMDg=","avatar_url":"https://avatars.githubusercontent.com/u/2354108?v=4","gravatar_id":"","url":"https://api.github.com/users/coveralls","html_url":"https://github.com/coveralls","followers_url":"https://api.github.com/users/coveralls/followers","following_url":"https://api.github.com/users/coveralls/following{/other_user}","gists_url":"https://api.github.com/users/coveralls/gists{/gist_id}","starred_url":"https://api.github.com/users/coveralls/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coveralls/subscriptions","organizations_url":"https://api.github.com/users/coveralls/orgs","repos_url":"https://api.github.com/users/coveralls/repos","events_url":"https://api.github.com/users/coveralls/events{/privacy}","received_events_url":"https://api.github.com/users/coveralls/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-12T08:36:02Z","updated_at":"2019-10-12T08:36:02Z","author_association":"NONE","body":"\n[![Coverage Status](https://coveralls.io/builds/26273401/badge)](https://coveralls.io/builds/26273401)\n\nCoverage decreased (-0.03%) to 50.55% when pulling **2318083824d6f154dd9d4288dd025fb4e278cac8 on areyouok:tx_fix_exec_service_full** into **ce4478aa29e46db4e4b58e90142a63f5fd9168d8 on apache:master**.\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/541301834/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/541303335","html_url":"https://github.com/apache/rocketmq/pull/1521#issuecomment-541303335","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1521","id":541303335,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MTMwMzMzNQ==","user":{"login":"areyouok","id":3192556,"node_id":"MDQ6VXNlcjMxOTI1NTY=","avatar_url":"https://avatars.githubusercontent.com/u/3192556?v=4","gravatar_id":"","url":"https://api.github.com/users/areyouok","html_url":"https://github.com/areyouok","followers_url":"https://api.github.com/users/areyouok/followers","following_url":"https://api.github.com/users/areyouok/following{/other_user}","gists_url":"https://api.github.com/users/areyouok/gists{/gist_id}","starred_url":"https://api.github.com/users/areyouok/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/areyouok/subscriptions","organizations_url":"https://api.github.com/users/areyouok/orgs","repos_url":"https://api.github.com/users/areyouok/repos","events_url":"https://api.github.com/users/areyouok/events{/privacy}","received_events_url":"https://api.github.com/users/areyouok/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-12T08:52:51Z","updated_at":"2019-10-12T08:52:51Z","author_association":"CONTRIBUTOR","body":"force push 了一下，这个测试是通过了，不知道为什么这里还是显示为未通过","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/541303335/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/541305136","html_url":"https://github.com/apache/rocketmq/pull/1523#issuecomment-541305136","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1523","id":541305136,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MTMwNTEzNg==","user":{"login":"coveralls","id":2354108,"node_id":"MDQ6VXNlcjIzNTQxMDg=","avatar_url":"https://avatars.githubusercontent.com/u/2354108?v=4","gravatar_id":"","url":"https://api.github.com/users/coveralls","html_url":"https://github.com/coveralls","followers_url":"https://api.github.com/users/coveralls/followers","following_url":"https://api.github.com/users/coveralls/following{/other_user}","gists_url":"https://api.github.com/users/coveralls/gists{/gist_id}","starred_url":"https://api.github.com/users/coveralls/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coveralls/subscriptions","organizations_url":"https://api.github.com/users/coveralls/orgs","repos_url":"https://api.github.com/users/coveralls/repos","events_url":"https://api.github.com/users/coveralls/events{/privacy}","received_events_url":"https://api.github.com/users/coveralls/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-12T09:14:01Z","updated_at":"2019-10-12T09:14:01Z","author_association":"NONE","body":"\n[![Coverage Status](https://coveralls.io/builds/26273522/badge)](https://coveralls.io/builds/26273522)\n\nCoverage decreased (-0.04%) to 49.482% when pulling **3db4961e869b23868e247f924b294c1c332ab157 on ysjjovo:some_imporvement** into **430c62ec5807f962e9a29db782986437449301b3 on apache:develop**.\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/541305136/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/541305312","html_url":"https://github.com/apache/rocketmq/pull/1524#issuecomment-541305312","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1524","id":541305312,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MTMwNTMxMg==","user":{"login":"coveralls","id":2354108,"node_id":"MDQ6VXNlcjIzNTQxMDg=","avatar_url":"https://avatars.githubusercontent.com/u/2354108?v=4","gravatar_id":"","url":"https://api.github.com/users/coveralls","html_url":"https://github.com/coveralls","followers_url":"https://api.github.com/users/coveralls/followers","following_url":"https://api.github.com/users/coveralls/following{/other_user}","gists_url":"https://api.github.com/users/coveralls/gists{/gist_id}","starred_url":"https://api.github.com/users/coveralls/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coveralls/subscriptions","organizations_url":"https://api.github.com/users/coveralls/orgs","repos_url":"https://api.github.com/users/coveralls/repos","events_url":"https://api.github.com/users/coveralls/events{/privacy}","received_events_url":"https://api.github.com/users/coveralls/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-12T09:15:53Z","updated_at":"2019-10-12T09:15:53Z","author_association":"NONE","body":"\n[![Coverage Status](https://coveralls.io/builds/26273531/badge)](https://coveralls.io/builds/26273531)\n\nCoverage decreased (-0.04%) to 49.482% when pulling **5b663675f27745c891ee3b5bf5339ea8091972b7 on ysjjovo:fix-some-typo** into **430c62ec5807f962e9a29db782986437449301b3 on apache:develop**.\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/541305312/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/541315577","html_url":"https://github.com/apache/rocketmq/pull/1525#issuecomment-541315577","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1525","id":541315577,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MTMxNTU3Nw==","user":{"login":"coveralls","id":2354108,"node_id":"MDQ6VXNlcjIzNTQxMDg=","avatar_url":"https://avatars.githubusercontent.com/u/2354108?v=4","gravatar_id":"","url":"https://api.github.com/users/coveralls","html_url":"https://github.com/coveralls","followers_url":"https://api.github.com/users/coveralls/followers","following_url":"https://api.github.com/users/coveralls/following{/other_user}","gists_url":"https://api.github.com/users/coveralls/gists{/gist_id}","starred_url":"https://api.github.com/users/coveralls/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coveralls/subscriptions","organizations_url":"https://api.github.com/users/coveralls/orgs","repos_url":"https://api.github.com/users/coveralls/repos","events_url":"https://api.github.com/users/coveralls/events{/privacy}","received_events_url":"https://api.github.com/users/coveralls/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-12T11:23:02Z","updated_at":"2019-10-12T11:23:02Z","author_association":"NONE","body":"\n[![Coverage Status](https://coveralls.io/builds/26274304/badge)](https://coveralls.io/builds/26274304)\n\nCoverage decreased (-0.002%) to 49.518% when pulling **a9b73d0192c6c52101151a40a1326b5276ccca2d on wlliqipeng:master** into **430c62ec5807f962e9a29db782986437449301b3 on apache:develop**.\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/541315577/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/541335442","html_url":"https://github.com/apache/rocketmq/issues/617#issuecomment-541335442","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/617","id":541335442,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MTMzNTQ0Mg==","user":{"login":"francisoliverlee","id":5908412,"node_id":"MDQ6VXNlcjU5MDg0MTI=","avatar_url":"https://avatars.githubusercontent.com/u/5908412?v=4","gravatar_id":"","url":"https://api.github.com/users/francisoliverlee","html_url":"https://github.com/francisoliverlee","followers_url":"https://api.github.com/users/francisoliverlee/followers","following_url":"https://api.github.com/users/francisoliverlee/following{/other_user}","gists_url":"https://api.github.com/users/francisoliverlee/gists{/gist_id}","starred_url":"https://api.github.com/users/francisoliverlee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/francisoliverlee/subscriptions","organizations_url":"https://api.github.com/users/francisoliverlee/orgs","repos_url":"https://api.github.com/users/francisoliverlee/repos","events_url":"https://api.github.com/users/francisoliverlee/events{/privacy}","received_events_url":"https://api.github.com/users/francisoliverlee/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-12T15:32:56Z","updated_at":"2019-10-12T15:32:56Z","author_association":"MEMBER","body":"@flackyang @scarletyoung @kevinwang0224 \r\nconsumer rule : consumers always want latest messages more than old ones.\r\n\r\ncheck how many messages in your topic's queues. found there's a trick, RocketMQ thinks if there're not manay messages, you would get all messages. even if you set CONSUME_FROM_LAST_OFFSE","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/541335442/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/541831021","html_url":"https://github.com/apache/rocketmq/pull/1516#issuecomment-541831021","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1516","id":541831021,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MTgzMTAyMQ==","user":{"login":"coveralls","id":2354108,"node_id":"MDQ6VXNlcjIzNTQxMDg=","avatar_url":"https://avatars.githubusercontent.com/u/2354108?v=4","gravatar_id":"","url":"https://api.github.com/users/coveralls","html_url":"https://github.com/coveralls","followers_url":"https://api.github.com/users/coveralls/followers","following_url":"https://api.github.com/users/coveralls/following{/other_user}","gists_url":"https://api.github.com/users/coveralls/gists{/gist_id}","starred_url":"https://api.github.com/users/coveralls/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coveralls/subscriptions","organizations_url":"https://api.github.com/users/coveralls/orgs","repos_url":"https://api.github.com/users/coveralls/repos","events_url":"https://api.github.com/users/coveralls/events{/privacy}","received_events_url":"https://api.github.com/users/coveralls/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-14T18:06:53Z","updated_at":"2019-12-05T08:27:11Z","author_association":"NONE","body":"\n[![Coverage Status](https://coveralls.io/builds/27429716/badge)](https://coveralls.io/builds/27429716)\n\nCoverage increased (+0.05%) to 50.534% when pulling **b143ff6d9b8baac322ec648ff898d2df41d93534 on shenhui0509:sync_pipeline** into **44569e4df6620fff61e43d782815f93a97e748ea on apache:develop**.\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/541831021/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/541998087","html_url":"https://github.com/apache/rocketmq/issues/296#issuecomment-541998087","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/296","id":541998087,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MTk5ODA4Nw==","user":{"login":"alisanguo","id":17509906,"node_id":"MDQ6VXNlcjE3NTA5OTA2","avatar_url":"https://avatars.githubusercontent.com/u/17509906?v=4","gravatar_id":"","url":"https://api.github.com/users/alisanguo","html_url":"https://github.com/alisanguo","followers_url":"https://api.github.com/users/alisanguo/followers","following_url":"https://api.github.com/users/alisanguo/following{/other_user}","gists_url":"https://api.github.com/users/alisanguo/gists{/gist_id}","starred_url":"https://api.github.com/users/alisanguo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alisanguo/subscriptions","organizations_url":"https://api.github.com/users/alisanguo/orgs","repos_url":"https://api.github.com/users/alisanguo/repos","events_url":"https://api.github.com/users/alisanguo/events{/privacy}","received_events_url":"https://api.github.com/users/alisanguo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-15T01:41:11Z","updated_at":"2019-10-15T01:41:11Z","author_association":"NONE","body":"我也碰到了相同的问题，小伙伴们有解决吗？\r\nI have the same question, do you have any solution?","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/541998087/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/542056485","html_url":"https://github.com/apache/rocketmq/pull/686#issuecomment-542056485","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/686","id":542056485,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MjA1NjQ4NQ==","user":{"login":"CoderLan0668","id":50652021,"node_id":"MDQ6VXNlcjUwNjUyMDIx","avatar_url":"https://avatars.githubusercontent.com/u/50652021?v=4","gravatar_id":"","url":"https://api.github.com/users/CoderLan0668","html_url":"https://github.com/CoderLan0668","followers_url":"https://api.github.com/users/CoderLan0668/followers","following_url":"https://api.github.com/users/CoderLan0668/following{/other_user}","gists_url":"https://api.github.com/users/CoderLan0668/gists{/gist_id}","starred_url":"https://api.github.com/users/CoderLan0668/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CoderLan0668/subscriptions","organizations_url":"https://api.github.com/users/CoderLan0668/orgs","repos_url":"https://api.github.com/users/CoderLan0668/repos","events_url":"https://api.github.com/users/CoderLan0668/events{/privacy}","received_events_url":"https://api.github.com/users/CoderLan0668/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-15T06:20:27Z","updated_at":"2019-10-15T06:20:27Z","author_association":"NONE","body":"@alaric27 你理解了这里为啥这样写吗？我在这里也很迷惑，跟你一开始的想法是一样的。","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/542056485/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/542063455","html_url":"https://github.com/apache/rocketmq/pull/686#issuecomment-542063455","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/686","id":542063455,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MjA2MzQ1NQ==","user":{"login":"CoderLan0668","id":50652021,"node_id":"MDQ6VXNlcjUwNjUyMDIx","avatar_url":"https://avatars.githubusercontent.com/u/50652021?v=4","gravatar_id":"","url":"https://api.github.com/users/CoderLan0668","html_url":"https://github.com/CoderLan0668","followers_url":"https://api.github.com/users/CoderLan0668/followers","following_url":"https://api.github.com/users/CoderLan0668/following{/other_user}","gists_url":"https://api.github.com/users/CoderLan0668/gists{/gist_id}","starred_url":"https://api.github.com/users/CoderLan0668/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CoderLan0668/subscriptions","organizations_url":"https://api.github.com/users/CoderLan0668/orgs","repos_url":"https://api.github.com/users/CoderLan0668/repos","events_url":"https://api.github.com/users/CoderLan0668/events{/privacy}","received_events_url":"https://api.github.com/users/CoderLan0668/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-15T06:42:57Z","updated_at":"2019-10-15T06:42:57Z","author_association":"NONE","body":"if (latencyFaultTolerance.isAvailable(mq.getBrokerName())) {\r\nif (null == lastBrokerName || mq.getBrokerName().equals(lastBrokerName))\r\nreturn mq;\r\n}\r\n\r\n@ShannonDing   i still do not understand the purpose of the code above。\r\n\r\nif latencyFaultTolerance.isAvailable(mq.getBrokerName() && null != lastBrokerName && ！mq.getBrokerName().equals(lastBrokerName)\r\n\r\nthe mq is good to be selected， is it right？ ","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/542063455/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/542074673","html_url":"https://github.com/apache/rocketmq/pull/686#issuecomment-542074673","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/686","id":542074673,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MjA3NDY3Mw==","user":{"login":"CoderLan0668","id":50652021,"node_id":"MDQ6VXNlcjUwNjUyMDIx","avatar_url":"https://avatars.githubusercontent.com/u/50652021?v=4","gravatar_id":"","url":"https://api.github.com/users/CoderLan0668","html_url":"https://github.com/CoderLan0668","followers_url":"https://api.github.com/users/CoderLan0668/followers","following_url":"https://api.github.com/users/CoderLan0668/following{/other_user}","gists_url":"https://api.github.com/users/CoderLan0668/gists{/gist_id}","starred_url":"https://api.github.com/users/CoderLan0668/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CoderLan0668/subscriptions","organizations_url":"https://api.github.com/users/CoderLan0668/orgs","repos_url":"https://api.github.com/users/CoderLan0668/repos","events_url":"https://api.github.com/users/CoderLan0668/events{/privacy}","received_events_url":"https://api.github.com/users/CoderLan0668/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-15T07:17:48Z","updated_at":"2019-10-15T07:17:48Z","author_association":"NONE","body":"> @alaric27\r\n> 我分析了一下，不知道对不对。\r\n> \r\n> ```\r\n> public MessageQueue selectOneMessageQueue(final TopicPublishInfo tpInfo, /*通常情况下，指上次请求失败时用到的节点*/final String lastBrokerName) {\r\n>         if (this.sendLatencyFaultEnable) {\r\n>             try {\r\n>                 // 外层轮询，下次请求时会选择下一个队列\r\n>                 int index = tpInfo.getSendWhichQueue().getAndIncrement();\r\n>                 for (int i = 0; i < tpInfo.getMessageQueueList().size(); i++) {\r\n>                     // index用于内层轮询，从而排除不可用的节点\r\n>                     int pos = Math.abs(index++) % tpInfo.getMessageQueueList().size();\r\n>                     if (pos < 0)\r\n>                         pos = 0;\r\n>                     MessageQueue mq = tpInfo.getMessageQueueList().get(pos);\r\n>                     // 验证可用性，latencyFaultTolerance存储了各个Broker发送消息的耗时，已经预估的下次可用时间点\r\n>                     if (latencyFaultTolerance.isAvailable(mq.getBrokerName())) {\r\n>                         // 如果是第一次请求，并且可用，则直接返回\r\n>                         // 如果是重试请求，则只使用brokerName等于lastBrokerName相同的，这点大家肯定有疑问：为啥要使用上次失败的，其实这里的lastBrokerName不单单指上次发送失败的节点，\r\n>                         // 它还能蕴含推荐节点的信息，本函数的后半段中会看到如何将推荐节点的信息传递到lastBrokerName\r\n>                         // 但是我觉得这样写的一个弊端是：当前可用节点，如果和上次失败时所用的节点不一致时，就会被排除掉，这也会影响效率\r\n>                         if (null == lastBrokerName || mq.getBrokerName().equals(lastBrokerName))\r\n>                             return mq;\r\n>                     }\r\n>                 }\r\n>                 // 走到这一步，代表所有节点都不可用（首次请求）或者上一次失败时用到的节点仍然不可用（重试请求）\r\n>                 // 随后，将所有不可用的节点，按照潜在可用性（当前可用与否>上次使用该节点时的调用耗时>预估的下次可使用时间），进行了排序，然后选择最优的结果\r\n>                 // 这里不用担心，连续重试时pickOneAtLeast每次都选择了相同节点，因为其内部也是用了轮训机制，会从最优->次优的顺序给出下一次推荐的节点\r\n>                 final String notBestBroker = latencyFaultTolerance.pickOneAtLeast();\r\n>                 //getQueueIdByBroker这个函数名也是惊到我了，完全和其功能不匹配，本行代码意在得到推荐节点是否仍然存在可写队列，如果存在，得出队列数\r\n>                 int writeQueueNums = tpInfo.getQueueIdByBroker(notBestBroker);\r\n>                 // 我们得到的推荐节点存在可写队列\r\n>                 if (writeQueueNums > 0) {\r\n>                     // 至此我们已经拿到了一个推荐节点，但是接下来代码的作者并没有简单地根据推荐节点来寻找队列，而是靠外层轮训找了下一个队列\r\n>                     // 如果在次重试过程中没有发生路由信息更新的话，该队列应该仍然是不可用的，并且很可能仍是最初失败的Broker节点的队列，\r\n>                     // 为什么这么说：假如消息队列为[BrokerA1,BrokerA2,BrokerA3,BrokerA4,BrokerB1,BrokerB2],只有当上一次轮训到BrokerA4时，这里才会跳过BrokerA而得到BrokerB的队列\r\n>                     // 而且，可能下次更新路由表时，该信息可能就会成为过期数据而被GC，我猜作者是觉得反正这个数据快没用了，不如把它替换成刚才得到的推荐节点信息，这样可以少new一个对象，还能增加下次查找时的效率\r\n>                     // 之所以说它能增加效率，是因为这个过程实质上是将一个很可能宕机的节点队列换成了最可能可用的节点信息，那么下次再轮训到这个节点时，实际上就跳过了寻找推荐节点的过程\r\n>                     final MessageQueue mq = tpInfo.selectOneMessageQueue();\r\n>                     if (notBestBroker != null) {\r\n>                         // 把得到的队列的BrokerName改成我们前面得到的推荐节点，这样如果再请求失败并且重试的时候，lastBrokerName其实存储的就是推荐节点的信息了，下次再执行本函数时就会优先使用推荐节点的其他队列\r\n>                         mq.setBrokerName(notBestBroker);\r\n>                         // 重新计算其队列编号，因为得到的这个队列数可能和推荐节点的队列数不一致，如果用了错误的队列序号，消息发送到Broker那时，肯定会报错\r\n>                         // 因此，这里基于外层轮询使用的index，对本次使用的队列编号进行了计算，我觉得这里最终达到的是随机选择的效果\r\n>                         mq.setQueueId(tpInfo.getSendWhichQueue().getAndIncrement() % writeQueueNums);\r\n>                     }\r\n>                     return mq;\r\n>                 } else { // 推荐节点不存在可写队列了，说明该节点可能已经宕机，并且NameServer已经删除了其路由信息，并且已经同步过来了\r\n>                     // 这时候可以将该节点从延迟统计表中删除，不在考虑该节点\r\n>                     latencyFaultTolerance.remove(notBestBroker);\r\n>                 }\r\n>             } catch (Exception e) {\r\n>                 log.error(\"Error occurred when selecting message queue\", e);\r\n>             }\r\n>             // 如果拿到的推荐节点已经不存在可写队列了，就随机选一个队列\r\n>             return tpInfo.selectOneMessageQueue();\r\n>         }\r\n>         // 默认策略\r\n>         return tpInfo.selectOneMessageQueue(lastBrokerName);\r\n>     }\r\n> ```\r\n--------------------------------------------------------------------------------------------\r\n\r\n这里：\r\n\r\n>                         // 把得到的队列的BrokerName改成我们前面得到的推荐节点，这样如果再请求失败并且重试的时候，lastBrokerName其实存储的就是推荐节点的信息了，下次再执行本函数时就会优先使用推荐节点的其他队列\r\n>                         mq.setBrokerName(notBestBroker);\r\n\r\n\r\n你的说法我完全不能理解，这里是选中了notBestBroker，如果再请求失败并且重试的时候，lastBrokerName就是这里的notBestBroker，不理解，为啥都失败了，还会优先使用notBestBroker。","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/542074673/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/542081271","html_url":"https://github.com/apache/rocketmq/pull/686#issuecomment-542081271","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/686","id":542081271,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MjA4MTI3MQ==","user":{"login":"BeiKeJieDeLiuLangMao","id":13994321,"node_id":"MDQ6VXNlcjEzOTk0MzIx","avatar_url":"https://avatars.githubusercontent.com/u/13994321?v=4","gravatar_id":"","url":"https://api.github.com/users/BeiKeJieDeLiuLangMao","html_url":"https://github.com/BeiKeJieDeLiuLangMao","followers_url":"https://api.github.com/users/BeiKeJieDeLiuLangMao/followers","following_url":"https://api.github.com/users/BeiKeJieDeLiuLangMao/following{/other_user}","gists_url":"https://api.github.com/users/BeiKeJieDeLiuLangMao/gists{/gist_id}","starred_url":"https://api.github.com/users/BeiKeJieDeLiuLangMao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BeiKeJieDeLiuLangMao/subscriptions","organizations_url":"https://api.github.com/users/BeiKeJieDeLiuLangMao/orgs","repos_url":"https://api.github.com/users/BeiKeJieDeLiuLangMao/repos","events_url":"https://api.github.com/users/BeiKeJieDeLiuLangMao/events{/privacy}","received_events_url":"https://api.github.com/users/BeiKeJieDeLiuLangMao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-15T07:36:31Z","updated_at":"2019-10-15T07:36:31Z","author_association":"NONE","body":"> > @alaric27\r\n> > 我分析了一下，不知道对不对。\r\n> > ```\r\n> > public MessageQueue selectOneMessageQueue(final TopicPublishInfo tpInfo, /*通常情况下，指上次请求失败时用到的节点*/final String lastBrokerName) {\r\n> >         if (this.sendLatencyFaultEnable) {\r\n> >             try {\r\n> >                 // 外层轮询，下次请求时会选择下一个队列\r\n> >                 int index = tpInfo.getSendWhichQueue().getAndIncrement();\r\n> >                 for (int i = 0; i < tpInfo.getMessageQueueList().size(); i++) {\r\n> >                     // index用于内层轮询，从而排除不可用的节点\r\n> >                     int pos = Math.abs(index++) % tpInfo.getMessageQueueList().size();\r\n> >                     if (pos < 0)\r\n> >                         pos = 0;\r\n> >                     MessageQueue mq = tpInfo.getMessageQueueList().get(pos);\r\n> >                     // 验证可用性，latencyFaultTolerance存储了各个Broker发送消息的耗时，已经预估的下次可用时间点\r\n> >                     if (latencyFaultTolerance.isAvailable(mq.getBrokerName())) {\r\n> >                         // 如果是第一次请求，并且可用，则直接返回\r\n> >                         // 如果是重试请求，则只使用brokerName等于lastBrokerName相同的，这点大家肯定有疑问：为啥要使用上次失败的，其实这里的lastBrokerName不单单指上次发送失败的节点，\r\n> >                         // 它还能蕴含推荐节点的信息，本函数的后半段中会看到如何将推荐节点的信息传递到lastBrokerName\r\n> >                         // 但是我觉得这样写的一个弊端是：当前可用节点，如果和上次失败时所用的节点不一致时，就会被排除掉，这也会影响效率\r\n> >                         if (null == lastBrokerName || mq.getBrokerName().equals(lastBrokerName))\r\n> >                             return mq;\r\n> >                     }\r\n> >                 }\r\n> >                 // 走到这一步，代表所有节点都不可用（首次请求）或者上一次失败时用到的节点仍然不可用（重试请求）\r\n> >                 // 随后，将所有不可用的节点，按照潜在可用性（当前可用与否>上次使用该节点时的调用耗时>预估的下次可使用时间），进行了排序，然后选择最优的结果\r\n> >                 // 这里不用担心，连续重试时pickOneAtLeast每次都选择了相同节点，因为其内部也是用了轮训机制，会从最优->次优的顺序给出下一次推荐的节点\r\n> >                 final String notBestBroker = latencyFaultTolerance.pickOneAtLeast();\r\n> >                 //getQueueIdByBroker这个函数名也是惊到我了，完全和其功能不匹配，本行代码意在得到推荐节点是否仍然存在可写队列，如果存在，得出队列数\r\n> >                 int writeQueueNums = tpInfo.getQueueIdByBroker(notBestBroker);\r\n> >                 // 我们得到的推荐节点存在可写队列\r\n> >                 if (writeQueueNums > 0) {\r\n> >                     // 至此我们已经拿到了一个推荐节点，但是接下来代码的作者并没有简单地根据推荐节点来寻找队列，而是靠外层轮训找了下一个队列\r\n> >                     // 如果在次重试过程中没有发生路由信息更新的话，该队列应该仍然是不可用的，并且很可能仍是最初失败的Broker节点的队列，\r\n> >                     // 为什么这么说：假如消息队列为[BrokerA1,BrokerA2,BrokerA3,BrokerA4,BrokerB1,BrokerB2],只有当上一次轮训到BrokerA4时，这里才会跳过BrokerA而得到BrokerB的队列\r\n> >                     // 而且，可能下次更新路由表时，该信息可能就会成为过期数据而被GC，我猜作者是觉得反正这个数据快没用了，不如把它替换成刚才得到的推荐节点信息，这样可以少new一个对象，还能增加下次查找时的效率\r\n> >                     // 之所以说它能增加效率，是因为这个过程实质上是将一个很可能宕机的节点队列换成了最可能可用的节点信息，那么下次再轮训到这个节点时，实际上就跳过了寻找推荐节点的过程\r\n> >                     final MessageQueue mq = tpInfo.selectOneMessageQueue();\r\n> >                     if (notBestBroker != null) {\r\n> >                         // 把得到的队列的BrokerName改成我们前面得到的推荐节点，这样如果再请求失败并且重试的时候，lastBrokerName其实存储的就是推荐节点的信息了，下次再执行本函数时就会优先使用推荐节点的其他队列\r\n> >                         mq.setBrokerName(notBestBroker);\r\n> >                         // 重新计算其队列编号，因为得到的这个队列数可能和推荐节点的队列数不一致，如果用了错误的队列序号，消息发送到Broker那时，肯定会报错\r\n> >                         // 因此，这里基于外层轮询使用的index，对本次使用的队列编号进行了计算，我觉得这里最终达到的是随机选择的效果\r\n> >                         mq.setQueueId(tpInfo.getSendWhichQueue().getAndIncrement() % writeQueueNums);\r\n> >                     }\r\n> >                     return mq;\r\n> >                 } else { // 推荐节点不存在可写队列了，说明该节点可能已经宕机，并且NameServer已经删除了其路由信息，并且已经同步过来了\r\n> >                     // 这时候可以将该节点从延迟统计表中删除，不在考虑该节点\r\n> >                     latencyFaultTolerance.remove(notBestBroker);\r\n> >                 }\r\n> >             } catch (Exception e) {\r\n> >                 log.error(\"Error occurred when selecting message queue\", e);\r\n> >             }\r\n> >             // 如果拿到的推荐节点已经不存在可写队列了，就随机选一个队列\r\n> >             return tpInfo.selectOneMessageQueue();\r\n> >         }\r\n> >         // 默认策略\r\n> >         return tpInfo.selectOneMessageQueue(lastBrokerName);\r\n> >     }\r\n> > ```\r\n> \r\n> 这里：\r\n> \r\n> > ```\r\n> >                     // 把得到的队列的BrokerName改成我们前面得到的推荐节点，这样如果再请求失败并且重试的时候，lastBrokerName其实存储的就是推荐节点的信息了，下次再执行本函数时就会优先使用推荐节点的其他队列\r\n> >                     mq.setBrokerName(notBestBroker);\r\n> > ```\r\n> \r\n> 你的说法我完全不能理解，这里是选中了notBestBroker，如果再请求失败并且重试的时候，lastBrokerName就是这里的notBestBroker，不理解，为啥都失败了，还会优先使用notBestBroker。\r\n\r\n如果发送失败了，还会优先使用notBestBroker，因为它很可能仍然是最佳的，但是要清楚这里还有一个前提，就是notBestBroker的 mq 可用时才会使用，如果mq仍然不可用的话，它还会进入后半段，再选下一个notBestBroker。\r\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/542081271/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/542085167","html_url":"https://github.com/apache/rocketmq/pull/686#issuecomment-542085167","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/686","id":542085167,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MjA4NTE2Nw==","user":{"login":"CoderLan0668","id":50652021,"node_id":"MDQ6VXNlcjUwNjUyMDIx","avatar_url":"https://avatars.githubusercontent.com/u/50652021?v=4","gravatar_id":"","url":"https://api.github.com/users/CoderLan0668","html_url":"https://github.com/CoderLan0668","followers_url":"https://api.github.com/users/CoderLan0668/followers","following_url":"https://api.github.com/users/CoderLan0668/following{/other_user}","gists_url":"https://api.github.com/users/CoderLan0668/gists{/gist_id}","starred_url":"https://api.github.com/users/CoderLan0668/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CoderLan0668/subscriptions","organizations_url":"https://api.github.com/users/CoderLan0668/orgs","repos_url":"https://api.github.com/users/CoderLan0668/repos","events_url":"https://api.github.com/users/CoderLan0668/events{/privacy}","received_events_url":"https://api.github.com/users/CoderLan0668/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-15T07:47:59Z","updated_at":"2019-10-15T07:47:59Z","author_association":"NONE","body":"> > > @alaric27\r\n> > > 我分析了一下，不知道对不对。\r\n> > > ```\r\n> > > public MessageQueue selectOneMessageQueue(final TopicPublishInfo tpInfo, /*通常情况下，指上次请求失败时用到的节点*/final String lastBrokerName) {\r\n> > >         if (this.sendLatencyFaultEnable) {\r\n> > >             try {\r\n> > >                 // 外层轮询，下次请求时会选择下一个队列\r\n> > >                 int index = tpInfo.getSendWhichQueue().getAndIncrement();\r\n> > >                 for (int i = 0; i < tpInfo.getMessageQueueList().size(); i++) {\r\n> > >                     // index用于内层轮询，从而排除不可用的节点\r\n> > >                     int pos = Math.abs(index++) % tpInfo.getMessageQueueList().size();\r\n> > >                     if (pos < 0)\r\n> > >                         pos = 0;\r\n> > >                     MessageQueue mq = tpInfo.getMessageQueueList().get(pos);\r\n> > >                     // 验证可用性，latencyFaultTolerance存储了各个Broker发送消息的耗时，已经预估的下次可用时间点\r\n> > >                     if (latencyFaultTolerance.isAvailable(mq.getBrokerName())) {\r\n> > >                         // 如果是第一次请求，并且可用，则直接返回\r\n> > >                         // 如果是重试请求，则只使用brokerName等于lastBrokerName相同的，这点大家肯定有疑问：为啥要使用上次失败的，其实这里的lastBrokerName不单单指上次发送失败的节点，\r\n> > >                         // 它还能蕴含推荐节点的信息，本函数的后半段中会看到如何将推荐节点的信息传递到lastBrokerName\r\n> > >                         // 但是我觉得这样写的一个弊端是：当前可用节点，如果和上次失败时所用的节点不一致时，就会被排除掉，这也会影响效率\r\n> > >                         if (null == lastBrokerName || mq.getBrokerName().equals(lastBrokerName))\r\n> > >                             return mq;\r\n> > >                     }\r\n> > >                 }\r\n> > >                 // 走到这一步，代表所有节点都不可用（首次请求）或者上一次失败时用到的节点仍然不可用（重试请求）\r\n> > >                 // 随后，将所有不可用的节点，按照潜在可用性（当前可用与否>上次使用该节点时的调用耗时>预估的下次可使用时间），进行了排序，然后选择最优的结果\r\n> > >                 // 这里不用担心，连续重试时pickOneAtLeast每次都选择了相同节点，因为其内部也是用了轮训机制，会从最优->次优的顺序给出下一次推荐的节点\r\n> > >                 final String notBestBroker = latencyFaultTolerance.pickOneAtLeast();\r\n> > >                 //getQueueIdByBroker这个函数名也是惊到我了，完全和其功能不匹配，本行代码意在得到推荐节点是否仍然存在可写队列，如果存在，得出队列数\r\n> > >                 int writeQueueNums = tpInfo.getQueueIdByBroker(notBestBroker);\r\n> > >                 // 我们得到的推荐节点存在可写队列\r\n> > >                 if (writeQueueNums > 0) {\r\n> > >                     // 至此我们已经拿到了一个推荐节点，但是接下来代码的作者并没有简单地根据推荐节点来寻找队列，而是靠外层轮训找了下一个队列\r\n> > >                     // 如果在次重试过程中没有发生路由信息更新的话，该队列应该仍然是不可用的，并且很可能仍是最初失败的Broker节点的队列，\r\n> > >                     // 为什么这么说：假如消息队列为[BrokerA1,BrokerA2,BrokerA3,BrokerA4,BrokerB1,BrokerB2],只有当上一次轮训到BrokerA4时，这里才会跳过BrokerA而得到BrokerB的队列\r\n> > >                     // 而且，可能下次更新路由表时，该信息可能就会成为过期数据而被GC，我猜作者是觉得反正这个数据快没用了，不如把它替换成刚才得到的推荐节点信息，这样可以少new一个对象，还能增加下次查找时的效率\r\n> > >                     // 之所以说它能增加效率，是因为这个过程实质上是将一个很可能宕机的节点队列换成了最可能可用的节点信息，那么下次再轮训到这个节点时，实际上就跳过了寻找推荐节点的过程\r\n> > >                     final MessageQueue mq = tpInfo.selectOneMessageQueue();\r\n> > >                     if (notBestBroker != null) {\r\n> > >                         // 把得到的队列的BrokerName改成我们前面得到的推荐节点，这样如果再请求失败并且重试的时候，lastBrokerName其实存储的就是推荐节点的信息了，下次再执行本函数时就会优先使用推荐节点的其他队列\r\n> > >                         mq.setBrokerName(notBestBroker);\r\n> > >                         // 重新计算其队列编号，因为得到的这个队列数可能和推荐节点的队列数不一致，如果用了错误的队列序号，消息发送到Broker那时，肯定会报错\r\n> > >                         // 因此，这里基于外层轮询使用的index，对本次使用的队列编号进行了计算，我觉得这里最终达到的是随机选择的效果\r\n> > >                         mq.setQueueId(tpInfo.getSendWhichQueue().getAndIncrement() % writeQueueNums);\r\n> > >                     }\r\n> > >                     return mq;\r\n> > >                 } else { // 推荐节点不存在可写队列了，说明该节点可能已经宕机，并且NameServer已经删除了其路由信息，并且已经同步过来了\r\n> > >                     // 这时候可以将该节点从延迟统计表中删除，不在考虑该节点\r\n> > >                     latencyFaultTolerance.remove(notBestBroker);\r\n> > >                 }\r\n> > >             } catch (Exception e) {\r\n> > >                 log.error(\"Error occurred when selecting message queue\", e);\r\n> > >             }\r\n> > >             // 如果拿到的推荐节点已经不存在可写队列了，就随机选一个队列\r\n> > >             return tpInfo.selectOneMessageQueue();\r\n> > >         }\r\n> > >         // 默认策略\r\n> > >         return tpInfo.selectOneMessageQueue(lastBrokerName);\r\n> > >     }\r\n> > > ```\r\n> > \r\n> > \r\n> > 这里：\r\n> > > ```\r\n> > >                     // 把得到的队列的BrokerName改成我们前面得到的推荐节点，这样如果再请求失败并且重试的时候，lastBrokerName其实存储的就是推荐节点的信息了，下次再执行本函数时就会优先使用推荐节点的其他队列\r\n> > >                     mq.setBrokerName(notBestBroker);\r\n> > > ```\r\n> > \r\n> > \r\n> > 你的说法我完全不能理解，这里是选中了notBestBroker，如果再请求失败并且重试的时候，lastBrokerName就是这里的notBestBroker，不理解，为啥都失败了，还会优先使用notBestBroker。\r\n> \r\n> 如果发送失败了，还会优先使用notBestBroker，因为它很可能仍然是最佳的，但是要清楚这里还有一个前提，就是notBestBroker的 mq 可用时才会使用，如果mq仍然不可用的话，它还会进入后半段，再选下一个notBestBroker。\r\n\r\n--------------------------------------------------------\r\n\r\n嗯 但是理论上 latencyFaultTolerance.isAvailable(mq.getBrokerName()) 如果是可用的，不应该就选出来了吗？为啥还要进入后半段？ 经过latencyFaultTolerance.isAvailable(mq.getBrokerName())筛选之后，不管是不是等于lastBrokerName，都是可以用的吧？这里有点不理解","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/542085167/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/542090059","html_url":"https://github.com/apache/rocketmq/pull/686#issuecomment-542090059","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/686","id":542090059,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MjA5MDA1OQ==","user":{"login":"BeiKeJieDeLiuLangMao","id":13994321,"node_id":"MDQ6VXNlcjEzOTk0MzIx","avatar_url":"https://avatars.githubusercontent.com/u/13994321?v=4","gravatar_id":"","url":"https://api.github.com/users/BeiKeJieDeLiuLangMao","html_url":"https://github.com/BeiKeJieDeLiuLangMao","followers_url":"https://api.github.com/users/BeiKeJieDeLiuLangMao/followers","following_url":"https://api.github.com/users/BeiKeJieDeLiuLangMao/following{/other_user}","gists_url":"https://api.github.com/users/BeiKeJieDeLiuLangMao/gists{/gist_id}","starred_url":"https://api.github.com/users/BeiKeJieDeLiuLangMao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BeiKeJieDeLiuLangMao/subscriptions","organizations_url":"https://api.github.com/users/BeiKeJieDeLiuLangMao/orgs","repos_url":"https://api.github.com/users/BeiKeJieDeLiuLangMao/repos","events_url":"https://api.github.com/users/BeiKeJieDeLiuLangMao/events{/privacy}","received_events_url":"https://api.github.com/users/BeiKeJieDeLiuLangMao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-15T08:01:20Z","updated_at":"2019-10-15T08:06:51Z","author_association":"NONE","body":"@CoderLan0668 \r\n\r\n我觉得这个循环在lastBrokerName为空时的效果是根据轮训找一个 mq 发送，如果 lastBrokerName 不为空，它的作用偏向于再确认一下这个 broker 是否现在变的可用了，如果可用就继续发, 我觉得他之所以想先看看这个 broker 是不是现在变的可用了，主要是因为它**可能**是后半段选择出的最佳 broker，它很可能还是最佳的，如果这个 broker不可用再去找下一个最优的发。但是，我们看到它现在的这种写法，会导致前半段的冗余遍历，我觉得它可以写成：\r\n```java\r\nif (null == lastBrokerName) {\r\n             for (int i = 0; i < tpInfo.getMessageQueueList().size(); i++) {\r\n                    int pos = Math.abs(index++) % tpInfo.getMessageQueueList().size();\r\n                    if (pos < 0)\r\n                        pos = 0;\r\n                    MessageQueue mq = tpInfo.getMessageQueueList().get(pos);\r\n                    if (latencyFaultTolerance.isAvailable(mq.getBrokerName())) {\r\n                            return mq;\r\n                    }\r\n                }\r\n} else {\r\n    if (latencyFaultTolerance.isAvailable(mq.getBrokerName())) {//官方没有这个，所以效率低了一些\r\n              for (int i = 0; i < tpInfo.getMessageQueueList().size(); i++) {\r\n                    int pos = Math.abs(index++) % tpInfo.getMessageQueueList().size();\r\n                    if (pos < 0)\r\n                        pos = 0;\r\n                    MessageQueue mq = tpInfo.getMessageQueueList().get(pos);\r\n                    if (latencyFaultTolerance.isAvailable(mq.getBrokerName()) && mq.getBrokerName().equals(lastBrokerName)) {\r\n                            return mq;\r\n                    }\r\n                }\r\n     }\r\n}\r\n// 后半段\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/542090059/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/542093429","html_url":"https://github.com/apache/rocketmq/pull/686#issuecomment-542093429","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/686","id":542093429,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MjA5MzQyOQ==","user":{"login":"CoderLan0668","id":50652021,"node_id":"MDQ6VXNlcjUwNjUyMDIx","avatar_url":"https://avatars.githubusercontent.com/u/50652021?v=4","gravatar_id":"","url":"https://api.github.com/users/CoderLan0668","html_url":"https://github.com/CoderLan0668","followers_url":"https://api.github.com/users/CoderLan0668/followers","following_url":"https://api.github.com/users/CoderLan0668/following{/other_user}","gists_url":"https://api.github.com/users/CoderLan0668/gists{/gist_id}","starred_url":"https://api.github.com/users/CoderLan0668/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CoderLan0668/subscriptions","organizations_url":"https://api.github.com/users/CoderLan0668/orgs","repos_url":"https://api.github.com/users/CoderLan0668/repos","events_url":"https://api.github.com/users/CoderLan0668/events{/privacy}","received_events_url":"https://api.github.com/users/CoderLan0668/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-15T08:10:45Z","updated_at":"2019-10-15T08:10:45Z","author_association":"NONE","body":"@BeiKeJieDeLiuLangMao  感觉“再确认一下这个 broker 是否现在变的可用了”这个逻辑其实没啥必要性吧？ 增加这个策略的目的不就是尽可能实现高可用低延时吗？直接选一个最优的就行了吧（可用->延时两个维度）。","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/542093429/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/542099117","html_url":"https://github.com/apache/rocketmq/pull/686#issuecomment-542099117","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/686","id":542099117,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MjA5OTExNw==","user":{"login":"BeiKeJieDeLiuLangMao","id":13994321,"node_id":"MDQ6VXNlcjEzOTk0MzIx","avatar_url":"https://avatars.githubusercontent.com/u/13994321?v=4","gravatar_id":"","url":"https://api.github.com/users/BeiKeJieDeLiuLangMao","html_url":"https://github.com/BeiKeJieDeLiuLangMao","followers_url":"https://api.github.com/users/BeiKeJieDeLiuLangMao/followers","following_url":"https://api.github.com/users/BeiKeJieDeLiuLangMao/following{/other_user}","gists_url":"https://api.github.com/users/BeiKeJieDeLiuLangMao/gists{/gist_id}","starred_url":"https://api.github.com/users/BeiKeJieDeLiuLangMao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BeiKeJieDeLiuLangMao/subscriptions","organizations_url":"https://api.github.com/users/BeiKeJieDeLiuLangMao/orgs","repos_url":"https://api.github.com/users/BeiKeJieDeLiuLangMao/repos","events_url":"https://api.github.com/users/BeiKeJieDeLiuLangMao/events{/privacy}","received_events_url":"https://api.github.com/users/BeiKeJieDeLiuLangMao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-15T08:25:42Z","updated_at":"2019-10-15T08:25:42Z","author_association":"NONE","body":"> @BeiKeJieDeLiuLangMao 感觉“再确认一下这个 broker 是否现在变的可用了”这个逻辑其实没啥必要性吧？ 增加这个策略的目的不就是尽可能实现高可用低延时吗？直接选一个最优的就行了吧（可用->延时两个维度）。\r\n\r\n失败通常伴随着一个较长的超时时间，在超时的这段时间里它也可能恢复了，它可能觉得为了这个潜在的可能性，进行一次判断，说不定能省略后面的步骤。","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/542099117/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/542102059","html_url":"https://github.com/apache/rocketmq/pull/686#issuecomment-542102059","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/686","id":542102059,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MjEwMjA1OQ==","user":{"login":"BeiKeJieDeLiuLangMao","id":13994321,"node_id":"MDQ6VXNlcjEzOTk0MzIx","avatar_url":"https://avatars.githubusercontent.com/u/13994321?v=4","gravatar_id":"","url":"https://api.github.com/users/BeiKeJieDeLiuLangMao","html_url":"https://github.com/BeiKeJieDeLiuLangMao","followers_url":"https://api.github.com/users/BeiKeJieDeLiuLangMao/followers","following_url":"https://api.github.com/users/BeiKeJieDeLiuLangMao/following{/other_user}","gists_url":"https://api.github.com/users/BeiKeJieDeLiuLangMao/gists{/gist_id}","starred_url":"https://api.github.com/users/BeiKeJieDeLiuLangMao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BeiKeJieDeLiuLangMao/subscriptions","organizations_url":"https://api.github.com/users/BeiKeJieDeLiuLangMao/orgs","repos_url":"https://api.github.com/users/BeiKeJieDeLiuLangMao/repos","events_url":"https://api.github.com/users/BeiKeJieDeLiuLangMao/events{/privacy}","received_events_url":"https://api.github.com/users/BeiKeJieDeLiuLangMao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-15T08:33:15Z","updated_at":"2019-10-15T08:33:15Z","author_association":"NONE","body":"@CoderLan0668 \r\n他这个地方的代码写的确实不好，但是如果按这个 PR 提出的删除判断方案进行，就会变成所有 mq 不可用时才使用统计的延时信息，而之前的效果是，全部 mq 不可用或者之前发送的 broker 不可用时，挑一个最优 broker 的 mq。","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/542102059/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/542104917","html_url":"https://github.com/apache/rocketmq/pull/686#issuecomment-542104917","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/686","id":542104917,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MjEwNDkxNw==","user":{"login":"CoderLan0668","id":50652021,"node_id":"MDQ6VXNlcjUwNjUyMDIx","avatar_url":"https://avatars.githubusercontent.com/u/50652021?v=4","gravatar_id":"","url":"https://api.github.com/users/CoderLan0668","html_url":"https://github.com/CoderLan0668","followers_url":"https://api.github.com/users/CoderLan0668/followers","following_url":"https://api.github.com/users/CoderLan0668/following{/other_user}","gists_url":"https://api.github.com/users/CoderLan0668/gists{/gist_id}","starred_url":"https://api.github.com/users/CoderLan0668/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CoderLan0668/subscriptions","organizations_url":"https://api.github.com/users/CoderLan0668/orgs","repos_url":"https://api.github.com/users/CoderLan0668/repos","events_url":"https://api.github.com/users/CoderLan0668/events{/privacy}","received_events_url":"https://api.github.com/users/CoderLan0668/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-15T08:40:17Z","updated_at":"2019-10-15T08:40:17Z","author_association":"NONE","body":"@BeiKeJieDeLiuLangMao  嗯 是这样的 你很棒","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/542104917/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/542124819","html_url":"https://github.com/apache/rocketmq/issues/1530#issuecomment-542124819","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1530","id":542124819,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MjEyNDgxOQ==","user":{"login":"duhenglucky","id":7938968,"node_id":"MDQ6VXNlcjc5Mzg5Njg=","avatar_url":"https://avatars.githubusercontent.com/u/7938968?v=4","gravatar_id":"","url":"https://api.github.com/users/duhenglucky","html_url":"https://github.com/duhenglucky","followers_url":"https://api.github.com/users/duhenglucky/followers","following_url":"https://api.github.com/users/duhenglucky/following{/other_user}","gists_url":"https://api.github.com/users/duhenglucky/gists{/gist_id}","starred_url":"https://api.github.com/users/duhenglucky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/duhenglucky/subscriptions","organizations_url":"https://api.github.com/users/duhenglucky/orgs","repos_url":"https://api.github.com/users/duhenglucky/repos","events_url":"https://api.github.com/users/duhenglucky/events{/privacy}","received_events_url":"https://api.github.com/users/duhenglucky/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-15T09:30:18Z","updated_at":"2019-10-15T09:30:18Z","author_association":"CONTRIBUTOR","body":"@971287765zy there's a fix of order message in broadcasting message mode, could you help to [verify](https://github.com/apache/rocketmq/pull/561) it?\r\nAs this issue repeat with https://github.com/apache/rocketmq/pull/561, so I will close it firstly.","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/542124819/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/542492927","html_url":"https://github.com/apache/rocketmq/pull/1422#issuecomment-542492927","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1422","id":542492927,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MjQ5MjkyNw==","user":{"login":"qqeasonchen","id":26195189,"node_id":"MDQ6VXNlcjI2MTk1MTg5","avatar_url":"https://avatars.githubusercontent.com/u/26195189?v=4","gravatar_id":"","url":"https://api.github.com/users/qqeasonchen","html_url":"https://github.com/qqeasonchen","followers_url":"https://api.github.com/users/qqeasonchen/followers","following_url":"https://api.github.com/users/qqeasonchen/following{/other_user}","gists_url":"https://api.github.com/users/qqeasonchen/gists{/gist_id}","starred_url":"https://api.github.com/users/qqeasonchen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/qqeasonchen/subscriptions","organizations_url":"https://api.github.com/users/qqeasonchen/orgs","repos_url":"https://api.github.com/users/qqeasonchen/repos","events_url":"https://api.github.com/users/qqeasonchen/events{/privacy}","received_events_url":"https://api.github.com/users/qqeasonchen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-16T03:20:23Z","updated_at":"2019-10-16T09:33:46Z","author_association":"CONTRIBUTOR","body":"> [Discuss]\r\n> Firstly, I wonder whether need a dependent ReplyMessageProcessor here, for the reply message, I think it just is a message that needs to push to the producer directly for accelerating, so how about just implement the executeSendMessageHookBefore method for push the message directly?\r\n> \r\n> Another, compared with just starting a consumer in the producer side to consume a reply message from the ReplyTo topic, what are the advantages of current implementation? it seems that the current practice is difficult to achieve reliable asynchronous transmission, used in scenarios where message calls cannot fail. but this implementation indeed reduced response latency, especially in the condition that ReputService is a little busy :)\r\n\r\n=====\r\n1. It's a  feasible way to implement with 'executeSendMessageHookBefore', Adding ReplyMessageProcessor meant to make code more clearly. ReplyMessageProcessor push reply message to producer and store message, so it needs to handle both push result and put message result.  If implement with `executeSendMessageHookBefore`, it would be a little more complex to handle the two result and return to producer. Both implement is Ok.\r\n2. There is a problem that rebalance result would change when new instance start or old instance stop.  It is more complex to guarantee that reply message would be deliver to accurate producer.","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/542492927/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/542494274","html_url":"https://github.com/apache/rocketmq/pull/1536#issuecomment-542494274","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1536","id":542494274,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MjQ5NDI3NA==","user":{"login":"coveralls","id":2354108,"node_id":"MDQ6VXNlcjIzNTQxMDg=","avatar_url":"https://avatars.githubusercontent.com/u/2354108?v=4","gravatar_id":"","url":"https://api.github.com/users/coveralls","html_url":"https://github.com/coveralls","followers_url":"https://api.github.com/users/coveralls/followers","following_url":"https://api.github.com/users/coveralls/following{/other_user}","gists_url":"https://api.github.com/users/coveralls/gists{/gist_id}","starred_url":"https://api.github.com/users/coveralls/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coveralls/subscriptions","organizations_url":"https://api.github.com/users/coveralls/orgs","repos_url":"https://api.github.com/users/coveralls/repos","events_url":"https://api.github.com/users/coveralls/events{/privacy}","received_events_url":"https://api.github.com/users/coveralls/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-16T03:26:20Z","updated_at":"2019-10-18T09:45:13Z","author_association":"NONE","body":"\n[![Coverage Status](https://coveralls.io/builds/26393780/badge)](https://coveralls.io/builds/26393780)\n\nCoverage increased (+0.04%) to 50.283% when pulling **93ab99e0596a8d6db279fd18a82e3a432988258f on wqliang:develop_fixHaTimeout** into **7c469fe949929ea039dfd8a6310db2f350ca316b on apache:develop**.\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/542494274/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/542500157","html_url":"https://github.com/apache/rocketmq/pull/686#issuecomment-542500157","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/686","id":542500157,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MjUwMDE1Nw==","user":{"login":"CoderLan0668","id":50652021,"node_id":"MDQ6VXNlcjUwNjUyMDIx","avatar_url":"https://avatars.githubusercontent.com/u/50652021?v=4","gravatar_id":"","url":"https://api.github.com/users/CoderLan0668","html_url":"https://github.com/CoderLan0668","followers_url":"https://api.github.com/users/CoderLan0668/followers","following_url":"https://api.github.com/users/CoderLan0668/following{/other_user}","gists_url":"https://api.github.com/users/CoderLan0668/gists{/gist_id}","starred_url":"https://api.github.com/users/CoderLan0668/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CoderLan0668/subscriptions","organizations_url":"https://api.github.com/users/CoderLan0668/orgs","repos_url":"https://api.github.com/users/CoderLan0668/repos","events_url":"https://api.github.com/users/CoderLan0668/events{/privacy}","received_events_url":"https://api.github.com/users/CoderLan0668/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-16T03:50:13Z","updated_at":"2019-10-16T03:50:13Z","author_association":"NONE","body":"@BeiKeJieDeLiuLangMao   后半段的选择最优逻辑你是怎么理解的？\r\n\r\n    @Override\r\n    public String pickOneAtLeast() {\r\n        final Enumeration<FaultItem> elements = this.faultItemTable.elements();\r\n        List<FaultItem> tmpList = new LinkedList<FaultItem>();\r\n        while (elements.hasMoreElements()) {\r\n            final FaultItem faultItem = elements.nextElement();\r\n            tmpList.add(faultItem);\r\n        }\r\n\r\n        if (!tmpList.isEmpty()) {\r\n            Collections.shuffle(tmpList);\r\n            // 按照可用与否、时延、预测的正常时间这几个维度排序\r\n            Collections.sort(tmpList);\r\n\r\n            final int half = tmpList.size() / 2;\r\n            if (half <= 0) {\r\n                //只有一个的情况下，选第一个\r\n                return tmpList.get(0).getName();\r\n            } else {\r\n               //这里选择了在列表的前半段轮转？\r\n                final int i = this.whichItemWorst.getAndIncrement() % half;\r\n                return tmpList.get(i).getName();\r\n            }\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n\r\n我不能理解这里为啥在broker列表的前半段进行轮转啊？ 这样就能选出最优的吗？\r\n\r\n理论上：\r\n            // 按照可用与否、时延、预测的正常时间这几个维度排序\r\n            Collections.sort(tmpList);\r\n\r\n排序之后，第一个不应该是最理想的吗？","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/542500157/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/542508728","html_url":"https://github.com/apache/rocketmq/pull/686#issuecomment-542508728","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/686","id":542508728,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MjUwODcyOA==","user":{"login":"BeiKeJieDeLiuLangMao","id":13994321,"node_id":"MDQ6VXNlcjEzOTk0MzIx","avatar_url":"https://avatars.githubusercontent.com/u/13994321?v=4","gravatar_id":"","url":"https://api.github.com/users/BeiKeJieDeLiuLangMao","html_url":"https://github.com/BeiKeJieDeLiuLangMao","followers_url":"https://api.github.com/users/BeiKeJieDeLiuLangMao/followers","following_url":"https://api.github.com/users/BeiKeJieDeLiuLangMao/following{/other_user}","gists_url":"https://api.github.com/users/BeiKeJieDeLiuLangMao/gists{/gist_id}","starred_url":"https://api.github.com/users/BeiKeJieDeLiuLangMao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BeiKeJieDeLiuLangMao/subscriptions","organizations_url":"https://api.github.com/users/BeiKeJieDeLiuLangMao/orgs","repos_url":"https://api.github.com/users/BeiKeJieDeLiuLangMao/repos","events_url":"https://api.github.com/users/BeiKeJieDeLiuLangMao/events{/privacy}","received_events_url":"https://api.github.com/users/BeiKeJieDeLiuLangMao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-16T04:32:49Z","updated_at":"2019-10-16T04:32:49Z","author_association":"NONE","body":"@CoderLan0668 \r\n你要注意到 whichItemWorst 是一个ThreadLocal对象，然后你再看它什么时候会发生轮转，它只有再请求再次失败后，才会发生轮转，这时候说明前一次得到的最佳broker仍然不能用（这样看，第一个就并不是实际意义的最佳broker，虽然在统计视图上来看他是最佳的），所以它依靠ThreadLocal进行了轮转，跳过上一次失败的节点。\r\n\r\n至于为什么只轮训前半段，我觉得是一种折中，它可能为了潜在的可能性（前半段节点再次变得可用），而放弃选择后半段的节点，因为后半段的节点相对来说更差一点。","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/542508728/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/542551794","html_url":"https://github.com/apache/rocketmq/pull/1529#issuecomment-542551794","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1529","id":542551794,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MjU1MTc5NA==","user":{"login":"coveralls","id":2354108,"node_id":"MDQ6VXNlcjIzNTQxMDg=","avatar_url":"https://avatars.githubusercontent.com/u/2354108?v=4","gravatar_id":"","url":"https://api.github.com/users/coveralls","html_url":"https://github.com/coveralls","followers_url":"https://api.github.com/users/coveralls/followers","following_url":"https://api.github.com/users/coveralls/following{/other_user}","gists_url":"https://api.github.com/users/coveralls/gists{/gist_id}","starred_url":"https://api.github.com/users/coveralls/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coveralls/subscriptions","organizations_url":"https://api.github.com/users/coveralls/orgs","repos_url":"https://api.github.com/users/coveralls/repos","events_url":"https://api.github.com/users/coveralls/events{/privacy}","received_events_url":"https://api.github.com/users/coveralls/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-16T06:56:40Z","updated_at":"2019-10-17T01:19:00Z","author_association":"NONE","body":"\n[![Coverage Status](https://coveralls.io/builds/26363822/badge)](https://coveralls.io/builds/26363822)\n\nCoverage increased (+0.2%) to 50.454% when pulling **d9fbb23dd49782651ddb376ffb99b615129aa9dc on keranbingaa:unit-test** into **7c469fe949929ea039dfd8a6310db2f350ca316b on apache:develop**.\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/542551794/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/542563081","html_url":"https://github.com/apache/rocketmq/pull/686#issuecomment-542563081","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/686","id":542563081,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MjU2MzA4MQ==","user":{"login":"CoderLan0668","id":50652021,"node_id":"MDQ6VXNlcjUwNjUyMDIx","avatar_url":"https://avatars.githubusercontent.com/u/50652021?v=4","gravatar_id":"","url":"https://api.github.com/users/CoderLan0668","html_url":"https://github.com/CoderLan0668","followers_url":"https://api.github.com/users/CoderLan0668/followers","following_url":"https://api.github.com/users/CoderLan0668/following{/other_user}","gists_url":"https://api.github.com/users/CoderLan0668/gists{/gist_id}","starred_url":"https://api.github.com/users/CoderLan0668/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CoderLan0668/subscriptions","organizations_url":"https://api.github.com/users/CoderLan0668/orgs","repos_url":"https://api.github.com/users/CoderLan0668/repos","events_url":"https://api.github.com/users/CoderLan0668/events{/privacy}","received_events_url":"https://api.github.com/users/CoderLan0668/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-16T07:27:47Z","updated_at":"2019-10-16T07:27:47Z","author_association":"NONE","body":"public class ThreadLocalIndex {\r\n    private final ThreadLocal<Integer> threadLocalIndex = new ThreadLocal<Integer>();\r\n    private final Random random = new Random();\r\n\r\n    public int getAndIncrement() {\r\n        Integer index = this.threadLocalIndex.get();\r\n        if (null == index) {\r\n            index = Math.abs(random.nextInt());\r\n            if (index < 0)\r\n                index = 0;\r\n            this.threadLocalIndex.set(index);\r\n        }\r\n\r\n        index = Math.abs(index + 1);\r\n        if (index < 0)\r\n            index = 0;\r\n\r\n        this.threadLocalIndex.set(index);\r\n        return index;\r\n    }\r\n}\r\n\r\n可以看到whichItemWorst在第一次getAndIncrement的时候，也没保证一定是0.，而是随机的。意味着有可能选到一个统计视图上处理中间的broker，并不是最优的，至少从统计视图上不是最优的。\r\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/542563081/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/542574225","html_url":"https://github.com/apache/rocketmq/pull/686#issuecomment-542574225","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/686","id":542574225,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MjU3NDIyNQ==","user":{"login":"BeiKeJieDeLiuLangMao","id":13994321,"node_id":"MDQ6VXNlcjEzOTk0MzIx","avatar_url":"https://avatars.githubusercontent.com/u/13994321?v=4","gravatar_id":"","url":"https://api.github.com/users/BeiKeJieDeLiuLangMao","html_url":"https://github.com/BeiKeJieDeLiuLangMao","followers_url":"https://api.github.com/users/BeiKeJieDeLiuLangMao/followers","following_url":"https://api.github.com/users/BeiKeJieDeLiuLangMao/following{/other_user}","gists_url":"https://api.github.com/users/BeiKeJieDeLiuLangMao/gists{/gist_id}","starred_url":"https://api.github.com/users/BeiKeJieDeLiuLangMao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BeiKeJieDeLiuLangMao/subscriptions","organizations_url":"https://api.github.com/users/BeiKeJieDeLiuLangMao/orgs","repos_url":"https://api.github.com/users/BeiKeJieDeLiuLangMao/repos","events_url":"https://api.github.com/users/BeiKeJieDeLiuLangMao/events{/privacy}","received_events_url":"https://api.github.com/users/BeiKeJieDeLiuLangMao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-16T07:56:45Z","updated_at":"2019-10-16T07:56:45Z","author_association":"NONE","body":"> public class ThreadLocalIndex {\r\n> private final ThreadLocal threadLocalIndex = new ThreadLocal();\r\n> private final Random random = new Random();\r\n> \r\n> ```\r\n> public int getAndIncrement() {\r\n>     Integer index = this.threadLocalIndex.get();\r\n>     if (null == index) {\r\n>         index = Math.abs(random.nextInt());\r\n>         if (index < 0)\r\n>             index = 0;\r\n>         this.threadLocalIndex.set(index);\r\n>     }\r\n> \r\n>     index = Math.abs(index + 1);\r\n>     if (index < 0)\r\n>         index = 0;\r\n> \r\n>     this.threadLocalIndex.set(index);\r\n>     return index;\r\n> }\r\n> ```\r\n> \r\n> }\r\n> \r\n> 可以看到whichItemWorst在第一次getAndIncrement的时候，也没保证一定是0.，而是随机的。意味着有可能选到一个统计视图上处理中间的broker，并不是最优的，至少从统计视图上不是最优的。\r\n\r\n我觉得它可能不是每次都追求一定要发给最优节点，就如图函数名一样它是 pickOneAtLeast 而不是 pickBestOne，你可以看到无论是 pickOneAtLeast 还是 whichItemWorst.getAndIncrement 都加入了很多的随机因素，他恐怕是怕如果发生网络问题后出现所有请求都打向单一节点（index0）的情况， 如果所有请求都打向同一个节点的话，可能会造成服务无法承受这么大压力，所以它用了很多随机因素来均衡这部分流量，但是他也不是完全随机，它多多少少参考了统计视图的结果。","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/542574225/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/543076700","html_url":"https://github.com/apache/rocketmq/issues/1540#issuecomment-543076700","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1540","id":543076700,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MzA3NjcwMA==","user":{"login":"duhenglucky","id":7938968,"node_id":"MDQ6VXNlcjc5Mzg5Njg=","avatar_url":"https://avatars.githubusercontent.com/u/7938968?v=4","gravatar_id":"","url":"https://api.github.com/users/duhenglucky","html_url":"https://github.com/duhenglucky","followers_url":"https://api.github.com/users/duhenglucky/followers","following_url":"https://api.github.com/users/duhenglucky/following{/other_user}","gists_url":"https://api.github.com/users/duhenglucky/gists{/gist_id}","starred_url":"https://api.github.com/users/duhenglucky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/duhenglucky/subscriptions","organizations_url":"https://api.github.com/users/duhenglucky/orgs","repos_url":"https://api.github.com/users/duhenglucky/repos","events_url":"https://api.github.com/users/duhenglucky/events{/privacy}","received_events_url":"https://api.github.com/users/duhenglucky/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-17T08:55:28Z","updated_at":"2019-10-17T08:55:28Z","author_association":"CONTRIBUTOR","body":"@TonyStark888 \r\n非常好的想法，首先，事务消息依赖于本地事务的执行时间，因此支持延迟的话，必须要考虑这两方面的因素，哪个因素比较重要也是值得商榷的。\r\n另外，如果要支持的话，就需要重新设计这个方案了，有兴趣的话，[可以在邮件列表里面讨论](https://rocketmq.apache.org/about/contact/)，这个issue一般用于bug report跟feature request，","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/543076700/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/543078614","html_url":"https://github.com/apache/rocketmq/issues/1539#issuecomment-543078614","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1539","id":543078614,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MzA3ODYxNA==","user":{"login":"duhenglucky","id":7938968,"node_id":"MDQ6VXNlcjc5Mzg5Njg=","avatar_url":"https://avatars.githubusercontent.com/u/7938968?v=4","gravatar_id":"","url":"https://api.github.com/users/duhenglucky","html_url":"https://github.com/duhenglucky","followers_url":"https://api.github.com/users/duhenglucky/followers","following_url":"https://api.github.com/users/duhenglucky/following{/other_user}","gists_url":"https://api.github.com/users/duhenglucky/gists{/gist_id}","starred_url":"https://api.github.com/users/duhenglucky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/duhenglucky/subscriptions","organizations_url":"https://api.github.com/users/duhenglucky/orgs","repos_url":"https://api.github.com/users/duhenglucky/repos","events_url":"https://api.github.com/users/duhenglucky/events{/privacy}","received_events_url":"https://api.github.com/users/duhenglucky/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-17T09:00:04Z","updated_at":"2019-10-17T09:00:04Z","author_association":"CONTRIBUTOR","body":"@971287765zy 广播模式的offset是本地持久的，并没有同步到服务端，如果需要的话，可以自己实现org.apache.rocketmq.client.consumer.store.OffsetStore","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/543078614/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/543078943","html_url":"https://github.com/apache/rocketmq/issues/1537#issuecomment-543078943","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1537","id":543078943,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MzA3ODk0Mw==","user":{"login":"duhenglucky","id":7938968,"node_id":"MDQ6VXNlcjc5Mzg5Njg=","avatar_url":"https://avatars.githubusercontent.com/u/7938968?v=4","gravatar_id":"","url":"https://api.github.com/users/duhenglucky","html_url":"https://github.com/duhenglucky","followers_url":"https://api.github.com/users/duhenglucky/followers","following_url":"https://api.github.com/users/duhenglucky/following{/other_user}","gists_url":"https://api.github.com/users/duhenglucky/gists{/gist_id}","starred_url":"https://api.github.com/users/duhenglucky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/duhenglucky/subscriptions","organizations_url":"https://api.github.com/users/duhenglucky/orgs","repos_url":"https://api.github.com/users/duhenglucky/repos","events_url":"https://api.github.com/users/duhenglucky/events{/privacy}","received_events_url":"https://api.github.com/users/duhenglucky/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-17T09:00:45Z","updated_at":"2019-10-17T09:00:45Z","author_association":"CONTRIBUTOR","body":"@qingmg 欢迎提个pr哈","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/543078943/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/543079904","html_url":"https://github.com/apache/rocketmq/issues/1538#issuecomment-543079904","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1538","id":543079904,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MzA3OTkwNA==","user":{"login":"duhenglucky","id":7938968,"node_id":"MDQ6VXNlcjc5Mzg5Njg=","avatar_url":"https://avatars.githubusercontent.com/u/7938968?v=4","gravatar_id":"","url":"https://api.github.com/users/duhenglucky","html_url":"https://github.com/duhenglucky","followers_url":"https://api.github.com/users/duhenglucky/followers","following_url":"https://api.github.com/users/duhenglucky/following{/other_user}","gists_url":"https://api.github.com/users/duhenglucky/gists{/gist_id}","starred_url":"https://api.github.com/users/duhenglucky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/duhenglucky/subscriptions","organizations_url":"https://api.github.com/users/duhenglucky/orgs","repos_url":"https://api.github.com/users/duhenglucky/repos","events_url":"https://api.github.com/users/duhenglucky/events{/privacy}","received_events_url":"https://api.github.com/users/duhenglucky/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-17T09:02:58Z","updated_at":"2019-10-17T09:02:58Z","author_association":"CONTRIBUTOR","body":"@amwyyyy  you can add the         consumer.setAccessChannel(AccessChannel.CLOUD); before start consumer.\r\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/543079904/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/543114537","html_url":"https://github.com/apache/rocketmq/pull/1541#issuecomment-543114537","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1541","id":543114537,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MzExNDUzNw==","user":{"login":"coveralls","id":2354108,"node_id":"MDQ6VXNlcjIzNTQxMDg=","avatar_url":"https://avatars.githubusercontent.com/u/2354108?v=4","gravatar_id":"","url":"https://api.github.com/users/coveralls","html_url":"https://github.com/coveralls","followers_url":"https://api.github.com/users/coveralls/followers","following_url":"https://api.github.com/users/coveralls/following{/other_user}","gists_url":"https://api.github.com/users/coveralls/gists{/gist_id}","starred_url":"https://api.github.com/users/coveralls/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coveralls/subscriptions","organizations_url":"https://api.github.com/users/coveralls/orgs","repos_url":"https://api.github.com/users/coveralls/repos","events_url":"https://api.github.com/users/coveralls/events{/privacy}","received_events_url":"https://api.github.com/users/coveralls/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-17T10:38:20Z","updated_at":"2019-10-17T10:38:20Z","author_association":"NONE","body":"\n[![Coverage Status](https://coveralls.io/builds/26371196/badge)](https://coveralls.io/builds/26371196)\n\nCoverage increased (+0.02%) to 50.522% when pulling **af039f56f2c0da0181a74ffe565a6322f22109f9 on qingmg:master** into **ed94087a7b7e63b7a9a3503206a7d5851a677e02 on apache:master**.\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/543114537/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/543120675","html_url":"https://github.com/apache/rocketmq/pull/1541#issuecomment-543120675","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1541","id":543120675,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MzEyMDY3NQ==","user":{"login":"duhenglucky","id":7938968,"node_id":"MDQ6VXNlcjc5Mzg5Njg=","avatar_url":"https://avatars.githubusercontent.com/u/7938968?v=4","gravatar_id":"","url":"https://api.github.com/users/duhenglucky","html_url":"https://github.com/duhenglucky","followers_url":"https://api.github.com/users/duhenglucky/followers","following_url":"https://api.github.com/users/duhenglucky/following{/other_user}","gists_url":"https://api.github.com/users/duhenglucky/gists{/gist_id}","starred_url":"https://api.github.com/users/duhenglucky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/duhenglucky/subscriptions","organizations_url":"https://api.github.com/users/duhenglucky/orgs","repos_url":"https://api.github.com/users/duhenglucky/repos","events_url":"https://api.github.com/users/duhenglucky/events{/privacy}","received_events_url":"https://api.github.com/users/duhenglucky/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-17T10:57:22Z","updated_at":"2019-10-17T10:57:22Z","author_association":"CONTRIBUTOR","body":"@qingmg please pull this request to develop branch and keep it clean without other's commits.","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/543120675/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/543169317","html_url":"https://github.com/apache/rocketmq/pull/1468#issuecomment-543169317","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1468","id":543169317,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MzE2OTMxNw==","user":{"login":"coveralls","id":2354108,"node_id":"MDQ6VXNlcjIzNTQxMDg=","avatar_url":"https://avatars.githubusercontent.com/u/2354108?v=4","gravatar_id":"","url":"https://api.github.com/users/coveralls","html_url":"https://github.com/coveralls","followers_url":"https://api.github.com/users/coveralls/followers","following_url":"https://api.github.com/users/coveralls/following{/other_user}","gists_url":"https://api.github.com/users/coveralls/gists{/gist_id}","starred_url":"https://api.github.com/users/coveralls/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coveralls/subscriptions","organizations_url":"https://api.github.com/users/coveralls/orgs","repos_url":"https://api.github.com/users/coveralls/repos","events_url":"https://api.github.com/users/coveralls/events{/privacy}","received_events_url":"https://api.github.com/users/coveralls/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-17T13:15:08Z","updated_at":"2019-10-17T13:15:08Z","author_association":"NONE","body":"\n[![Coverage Status](https://coveralls.io/builds/26373923/badge)](https://coveralls.io/builds/26373923)\n\nCoverage increased (+0.03%) to 50.271% when pulling **291aac82a5f6711e165346b9b0a638cfeec16718 on wqliang:notifyTopicConfigChange-dev** into **7c469fe949929ea039dfd8a6310db2f350ca316b on apache:develop**.\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/543169317/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/543446743","html_url":"https://github.com/apache/rocketmq/issues/1540#issuecomment-543446743","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1540","id":543446743,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MzQ0Njc0Mw==","user":{"login":"TonyStark888","id":9389430,"node_id":"MDQ6VXNlcjkzODk0MzA=","avatar_url":"https://avatars.githubusercontent.com/u/9389430?v=4","gravatar_id":"","url":"https://api.github.com/users/TonyStark888","html_url":"https://github.com/TonyStark888","followers_url":"https://api.github.com/users/TonyStark888/followers","following_url":"https://api.github.com/users/TonyStark888/following{/other_user}","gists_url":"https://api.github.com/users/TonyStark888/gists{/gist_id}","starred_url":"https://api.github.com/users/TonyStark888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TonyStark888/subscriptions","organizations_url":"https://api.github.com/users/TonyStark888/orgs","repos_url":"https://api.github.com/users/TonyStark888/repos","events_url":"https://api.github.com/users/TonyStark888/events{/privacy}","received_events_url":"https://api.github.com/users/TonyStark888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-18T01:49:36Z","updated_at":"2019-10-18T01:49:36Z","author_association":"NONE","body":"> @TonyStark888\r\n> 非常好的想法，首先，事务消息依赖于本地事务的执行时间，因此支持延迟的话，必须要考虑这两方面的因素，哪个因素比较重要也是值得商榷的。\r\n> 另外，如果要支持的话，就需要重新设计这个方案了，有兴趣的话，[可以在邮件列表里面讨论](https://rocketmq.apache.org/about/contact/)，这个issue一般用于bug report跟feature request，\r\n\r\n感谢专家的回复，个人建议事务消息可以不支持延迟发送，同时在事务消息对Message对象做一次清洗（屏蔽DelayTimeLevel），让DelayTimeLevel参数失效，这样上述的问题就不会发生。\r\n毕竟使用RocketMQ Client的童鞋因手抖误设置了DelayTimeLevel的现象还是存在的。","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/543446743/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/543461471","html_url":"https://github.com/apache/rocketmq/issues/1540#issuecomment-543461471","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1540","id":543461471,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MzQ2MTQ3MQ==","user":{"login":"duhenglucky","id":7938968,"node_id":"MDQ6VXNlcjc5Mzg5Njg=","avatar_url":"https://avatars.githubusercontent.com/u/7938968?v=4","gravatar_id":"","url":"https://api.github.com/users/duhenglucky","html_url":"https://github.com/duhenglucky","followers_url":"https://api.github.com/users/duhenglucky/followers","following_url":"https://api.github.com/users/duhenglucky/following{/other_user}","gists_url":"https://api.github.com/users/duhenglucky/gists{/gist_id}","starred_url":"https://api.github.com/users/duhenglucky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/duhenglucky/subscriptions","organizations_url":"https://api.github.com/users/duhenglucky/orgs","repos_url":"https://api.github.com/users/duhenglucky/repos","events_url":"https://api.github.com/users/duhenglucky/events{/privacy}","received_events_url":"https://api.github.com/users/duhenglucky/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-18T02:42:53Z","updated_at":"2019-10-18T02:42:53Z","author_association":"CONTRIBUTOR","body":"@TonyStark888 嗯，确实可以增加一些防御性设计，你愿意提交个PR来优化一下吗？社区同学会快速review的","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/543461471/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/543519449","html_url":"https://github.com/apache/rocketmq/pull/1543#issuecomment-543519449","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1543","id":543519449,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MzUxOTQ0OQ==","user":{"login":"duhenglucky","id":7938968,"node_id":"MDQ6VXNlcjc5Mzg5Njg=","avatar_url":"https://avatars.githubusercontent.com/u/7938968?v=4","gravatar_id":"","url":"https://api.github.com/users/duhenglucky","html_url":"https://github.com/duhenglucky","followers_url":"https://api.github.com/users/duhenglucky/followers","following_url":"https://api.github.com/users/duhenglucky/following{/other_user}","gists_url":"https://api.github.com/users/duhenglucky/gists{/gist_id}","starred_url":"https://api.github.com/users/duhenglucky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/duhenglucky/subscriptions","organizations_url":"https://api.github.com/users/duhenglucky/orgs","repos_url":"https://api.github.com/users/duhenglucky/repos","events_url":"https://api.github.com/users/duhenglucky/events{/privacy}","received_events_url":"https://api.github.com/users/duhenglucky/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-18T05:40:25Z","updated_at":"2019-10-18T05:40:25Z","author_association":"CONTRIBUTOR","body":"@TonyStark888  thanks for your contribution to RocketMQ and some suggestions:\r\n(1) change to English title please. (2) pull this request to develop branch (3) Fix the CI issue. ","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/543519449/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/543541094","html_url":"https://github.com/apache/rocketmq/issues/1538#issuecomment-543541094","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1538","id":543541094,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MzU0MTA5NA==","user":{"login":"amwyyyy","id":8274512,"node_id":"MDQ6VXNlcjgyNzQ1MTI=","avatar_url":"https://avatars.githubusercontent.com/u/8274512?v=4","gravatar_id":"","url":"https://api.github.com/users/amwyyyy","html_url":"https://github.com/amwyyyy","followers_url":"https://api.github.com/users/amwyyyy/followers","following_url":"https://api.github.com/users/amwyyyy/following{/other_user}","gists_url":"https://api.github.com/users/amwyyyy/gists{/gist_id}","starred_url":"https://api.github.com/users/amwyyyy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amwyyyy/subscriptions","organizations_url":"https://api.github.com/users/amwyyyy/orgs","repos_url":"https://api.github.com/users/amwyyyy/repos","events_url":"https://api.github.com/users/amwyyyy/events{/privacy}","received_events_url":"https://api.github.com/users/amwyyyy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-18T06:32:02Z","updated_at":"2019-10-18T06:32:02Z","author_association":"NONE","body":"> @amwyyyy you can add the consumer.setAccessChannel(AccessChannel.CLOUD); before start consumer.\r\n\r\nthis my test code, it can work, just can not see message track.\r\n```\r\npublic static void main(String[] args) throws MQClientException, RemotingException, InterruptedException, MQBrokerException {\r\n    // producer\r\n    DefaultMQProducer producer = new DefaultMQProducer(\"GID_TEST_SDK\", new AclClientRPCHook(new SessionCredentials(\"xxx\", \"xxx\")));\r\n    producer.setAccessChannel(AccessChannel.CLOUD);\r\n    producer.setNamesrvAddr(\"http://xxxx.cn-shanghai-finance-1.mq-internal.aliyuncs.com:8080\");\r\n    producer.start();\r\n    Message msg = new Message(\"TP_TEST_SDK\", \"tagA\", \"hello world!\".getBytes());\r\n    SendResult sendResult = producer.send(msg);\r\n    System.out.println(sendResult);\r\n\r\n    // consumer\r\n    RPCHook rpcHook = new AclClientRPCHook(new SessionCredentials(\"xxx\", \"xxx\"));\r\n    DefaultMQPushConsumer consumer = new DefaultMQPushConsumer(\"GID_TEST_SDK\", rpcHook, new AllocateMessageQueueAveragely());\r\n    consumer.setAccessChannel(AccessChannel.CLOUD);\r\n    consumer.setNamesrvAddr(\"http://xxx.cn-shanghai-finance-1.mq-internal.aliyuncs.com:8080\");\r\n    consumer.setMessageModel(MessageModel.CLUSTERING);\r\n    consumer.subscribe(\"TP_TEST_SDK\", \"*\");\r\n    consumer.registerMessageListener((MessageListenerConcurrently) (msgs, context) -> {\r\n      for (MessageExt messageExt : msgs) {\r\n        System.out.println(new String(messageExt.getBody()));\r\n      }\r\n      return ConsumeConcurrentlyStatus.CONSUME_SUCCESS;\r\n    });\r\n    consumer.start();\r\n}\r\n```","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/543541094/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/543552951","html_url":"https://github.com/apache/rocketmq/issues/1542#issuecomment-543552951","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1542","id":543552951,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MzU1Mjk1MQ==","user":{"login":"duhenglucky","id":7938968,"node_id":"MDQ6VXNlcjc5Mzg5Njg=","avatar_url":"https://avatars.githubusercontent.com/u/7938968?v=4","gravatar_id":"","url":"https://api.github.com/users/duhenglucky","html_url":"https://github.com/duhenglucky","followers_url":"https://api.github.com/users/duhenglucky/followers","following_url":"https://api.github.com/users/duhenglucky/following{/other_user}","gists_url":"https://api.github.com/users/duhenglucky/gists{/gist_id}","starred_url":"https://api.github.com/users/duhenglucky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/duhenglucky/subscriptions","organizations_url":"https://api.github.com/users/duhenglucky/orgs","repos_url":"https://api.github.com/users/duhenglucky/repos","events_url":"https://api.github.com/users/duhenglucky/events{/privacy}","received_events_url":"https://api.github.com/users/duhenglucky/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-18T06:57:47Z","updated_at":"2019-10-18T06:57:47Z","author_association":"CONTRIBUTOR","body":"1、按照CQ的最小位点开始消费。\r\n2、是的，。\r\n对RocketMQ有兴趣的话，最好在[邮件列表](https://rocketmq.apache.org/about/contact/)里面讨论，这个issue一般用于bug report跟feature request，","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/543552951/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/543555791","html_url":"https://github.com/apache/rocketmq/pull/1543#issuecomment-543555791","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1543","id":543555791,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MzU1NTc5MQ==","user":{"login":"coveralls","id":2354108,"node_id":"MDQ6VXNlcjIzNTQxMDg=","avatar_url":"https://avatars.githubusercontent.com/u/2354108?v=4","gravatar_id":"","url":"https://api.github.com/users/coveralls","html_url":"https://github.com/coveralls","followers_url":"https://api.github.com/users/coveralls/followers","following_url":"https://api.github.com/users/coveralls/following{/other_user}","gists_url":"https://api.github.com/users/coveralls/gists{/gist_id}","starred_url":"https://api.github.com/users/coveralls/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coveralls/subscriptions","organizations_url":"https://api.github.com/users/coveralls/orgs","repos_url":"https://api.github.com/users/coveralls/repos","events_url":"https://api.github.com/users/coveralls/events{/privacy}","received_events_url":"https://api.github.com/users/coveralls/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-18T07:03:52Z","updated_at":"2019-10-18T07:03:52Z","author_association":"NONE","body":"\n[![Coverage Status](https://coveralls.io/builds/26391334/badge)](https://coveralls.io/builds/26391334)\n\nCoverage decreased (-0.2%) to 50.421% when pulling **8488207cd906fcac596ef52988fdae11adfc6a86 on TonyStark888:4.7.0-transaction-message-delaytimelevel** into **034bebc1c2f3387d78377d0076d010e3bb625ad0 on apache:master**.\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/543555791/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/543563883","html_url":"https://github.com/apache/rocketmq/pull/1543#issuecomment-543563883","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1543","id":543563883,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MzU2Mzg4Mw==","user":{"login":"areyouok","id":3192556,"node_id":"MDQ6VXNlcjMxOTI1NTY=","avatar_url":"https://avatars.githubusercontent.com/u/3192556?v=4","gravatar_id":"","url":"https://api.github.com/users/areyouok","html_url":"https://github.com/areyouok","followers_url":"https://api.github.com/users/areyouok/followers","following_url":"https://api.github.com/users/areyouok/following{/other_user}","gists_url":"https://api.github.com/users/areyouok/gists{/gist_id}","starred_url":"https://api.github.com/users/areyouok/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/areyouok/subscriptions","organizations_url":"https://api.github.com/users/areyouok/orgs","repos_url":"https://api.github.com/users/areyouok/repos","events_url":"https://api.github.com/users/areyouok/events{/privacy}","received_events_url":"https://api.github.com/users/areyouok/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-18T07:21:25Z","updated_at":"2019-10-18T07:21:25Z","author_association":"CONTRIBUTOR","body":"@TonyStark888 如果你在关注事务消息，可以看一下我的fix\r\n\r\nhttps://github.com/areyouok/rocketmq/commits/4.5.2.fix\r\n\r\n我们的结论是当前版本4.5.2的事务消息不是生产可用的。当前我们一共发现4个问题，自定义事务超时时间的功能我们没有使用，所以没太关注。\r\n\r\n问题1，会导致每60秒内，最多有6秒（默认事务超时时间）的所有消息需要回查，我在这里进行了修复：\r\n\r\nhttps://github.com/areyouok/rocketmq/commit/a9d43fba4a3c5a9284dcb8ba2cbf218f80422e44\r\n\r\n问题2，end transaction打印日志过多，包括把消息正文以文本形式打印到日志中，这样在一定的压力下，end transaction的速度跟不上半消息的发送速度，最后end transaction就限流了（但是半消息发送没有限流），导致大量事务半消息发送成功但是commit操作全部丢失，这些消息最后都要回查，我在这里进行了修复：\r\n\r\nhttps://github.com/areyouok/rocketmq/commit/7393d5d2dc102403286da21d0cdc0403f9620662\r\n\r\n问题3：回查任务线程的ExecutorService的queue满2000以后，没有处理RejectedExecutionException，异常退出前renew了很多半消息，但是异常退出的时候没有处理移动位点。前面问题1、2导致了大量需要回查的半消息堆积，现在再加上问题3，这个时候集群就死全家了，会无限renew半消息。我们在生产环境下做压测，只进行了大约1个小时的压测，然后集群就陷入无限renew半消息的状态，过了两天3T的磁盘都要满了。我在这里进行了修复：\r\n\r\nhttps://github.com/areyouok/rocketmq/commit/d45005b69e4ce63261513f9c47d9696576fdff69\r\n\r\n问题4：op队列的位点要到下次检查的时候才移动，目前没有直接观察到严重后果，但是会影响性能，毕竟事务回查调度只有1个线程，堆积起来后果还是很严重的，我在这里进行了修复：\r\n\r\nhttps://github.com/areyouok/rocketmq/commit/abb05f0095830300a9ef539556b784bc62077b33\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/543563883/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/543565468","html_url":"https://github.com/apache/rocketmq/issues/1520#issuecomment-543565468","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1520","id":543565468,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MzU2NTQ2OA==","user":{"login":"duhenglucky","id":7938968,"node_id":"MDQ6VXNlcjc5Mzg5Njg=","avatar_url":"https://avatars.githubusercontent.com/u/7938968?v=4","gravatar_id":"","url":"https://api.github.com/users/duhenglucky","html_url":"https://github.com/duhenglucky","followers_url":"https://api.github.com/users/duhenglucky/followers","following_url":"https://api.github.com/users/duhenglucky/following{/other_user}","gists_url":"https://api.github.com/users/duhenglucky/gists{/gist_id}","starred_url":"https://api.github.com/users/duhenglucky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/duhenglucky/subscriptions","organizations_url":"https://api.github.com/users/duhenglucky/orgs","repos_url":"https://api.github.com/users/duhenglucky/repos","events_url":"https://api.github.com/users/duhenglucky/events{/privacy}","received_events_url":"https://api.github.com/users/duhenglucky/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-18T07:24:52Z","updated_at":"2019-10-18T07:24:52Z","author_association":"CONTRIBUTOR","body":"@RongNanNan BROADCASTING model will not update consumer offset to the broker.","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/543565468/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/543566539","html_url":"https://github.com/apache/rocketmq/issues/1519#issuecomment-543566539","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1519","id":543566539,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MzU2NjUzOQ==","user":{"login":"duhenglucky","id":7938968,"node_id":"MDQ6VXNlcjc5Mzg5Njg=","avatar_url":"https://avatars.githubusercontent.com/u/7938968?v=4","gravatar_id":"","url":"https://api.github.com/users/duhenglucky","html_url":"https://github.com/duhenglucky","followers_url":"https://api.github.com/users/duhenglucky/followers","following_url":"https://api.github.com/users/duhenglucky/following{/other_user}","gists_url":"https://api.github.com/users/duhenglucky/gists{/gist_id}","starred_url":"https://api.github.com/users/duhenglucky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/duhenglucky/subscriptions","organizations_url":"https://api.github.com/users/duhenglucky/orgs","repos_url":"https://api.github.com/users/duhenglucky/repos","events_url":"https://api.github.com/users/duhenglucky/events{/privacy}","received_events_url":"https://api.github.com/users/duhenglucky/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-18T07:27:14Z","updated_at":"2019-10-18T07:27:14Z","author_association":"CONTRIBUTOR","body":"@areyouok in order to avoid lost check request, will not update new offset when rejected.","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/543566539/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/543569882","html_url":"https://github.com/apache/rocketmq/issues/1512#issuecomment-543569882","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1512","id":543569882,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MzU2OTg4Mg==","user":{"login":"duhenglucky","id":7938968,"node_id":"MDQ6VXNlcjc5Mzg5Njg=","avatar_url":"https://avatars.githubusercontent.com/u/7938968?v=4","gravatar_id":"","url":"https://api.github.com/users/duhenglucky","html_url":"https://github.com/duhenglucky","followers_url":"https://api.github.com/users/duhenglucky/followers","following_url":"https://api.github.com/users/duhenglucky/following{/other_user}","gists_url":"https://api.github.com/users/duhenglucky/gists{/gist_id}","starred_url":"https://api.github.com/users/duhenglucky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/duhenglucky/subscriptions","organizations_url":"https://api.github.com/users/duhenglucky/orgs","repos_url":"https://api.github.com/users/duhenglucky/repos","events_url":"https://api.github.com/users/duhenglucky/events{/privacy}","received_events_url":"https://api.github.com/users/duhenglucky/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-18T07:34:33Z","updated_at":"2019-10-18T07:34:33Z","author_association":"CONTRIBUTOR","body":"@geektao RocketMQ provided a [litePullconsumer](https://github.com/apache/rocketmq/pull/1386) to replace previous pull implementation, could you give more advice about it?","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/543569882/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/543571358","html_url":"https://github.com/apache/rocketmq/issues/1510#issuecomment-543571358","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1510","id":543571358,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MzU3MTM1OA==","user":{"login":"duhenglucky","id":7938968,"node_id":"MDQ6VXNlcjc5Mzg5Njg=","avatar_url":"https://avatars.githubusercontent.com/u/7938968?v=4","gravatar_id":"","url":"https://api.github.com/users/duhenglucky","html_url":"https://github.com/duhenglucky","followers_url":"https://api.github.com/users/duhenglucky/followers","following_url":"https://api.github.com/users/duhenglucky/following{/other_user}","gists_url":"https://api.github.com/users/duhenglucky/gists{/gist_id}","starred_url":"https://api.github.com/users/duhenglucky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/duhenglucky/subscriptions","organizations_url":"https://api.github.com/users/duhenglucky/orgs","repos_url":"https://api.github.com/users/duhenglucky/repos","events_url":"https://api.github.com/users/duhenglucky/events{/privacy}","received_events_url":"https://api.github.com/users/duhenglucky/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-18T07:37:51Z","updated_at":"2019-10-18T07:37:51Z","author_association":"CONTRIBUTOR","body":"VIP channel used for command message transfer to prevent the message sending/consume socket is very busy lead to the command cannot be executed in time.","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/543571358/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]