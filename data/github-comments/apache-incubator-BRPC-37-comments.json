[{"url":"https://api.github.com/repos/apache/brpc/issues/comments/858216920","html_url":"https://github.com/apache/brpc/pull/1427#issuecomment-858216920","issue_url":"https://api.github.com/repos/apache/brpc/issues/1427","id":858216920,"node_id":"MDEyOklzc3VlQ29tbWVudDg1ODIxNjkyMA==","user":{"login":"guodongxiaren","id":5945107,"node_id":"MDQ6VXNlcjU5NDUxMDc=","avatar_url":"https://avatars.githubusercontent.com/u/5945107?v=4","gravatar_id":"","url":"https://api.github.com/users/guodongxiaren","html_url":"https://github.com/guodongxiaren","followers_url":"https://api.github.com/users/guodongxiaren/followers","following_url":"https://api.github.com/users/guodongxiaren/following{/other_user}","gists_url":"https://api.github.com/users/guodongxiaren/gists{/gist_id}","starred_url":"https://api.github.com/users/guodongxiaren/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/guodongxiaren/subscriptions","organizations_url":"https://api.github.com/users/guodongxiaren/orgs","repos_url":"https://api.github.com/users/guodongxiaren/repos","events_url":"https://api.github.com/users/guodongxiaren/events{/privacy}","received_events_url":"https://api.github.com/users/guodongxiaren/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-10T01:47:22Z","updated_at":"2021-06-10T01:47:22Z","author_association":"MEMBER","body":" \r\n\r\n> 能帮忙验证下目前master是不是把这个警告了去除了吗？\r\n\r\n去掉了，没有 [-Wclass-memaccess]的警告了。\r\n\r\n剩余一些高版本protobuf 给一些API标记了废弃，触发的[-Wdeprecated-declarations]编译警告，我后面再提交一个另外的PR。\r\n@zyearn ","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/858216920/reactions","total_count":2,"+1":0,"-1":0,"laugh":0,"hooray":2,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/858293322","html_url":"https://github.com/apache/brpc/issues/1428#issuecomment-858293322","issue_url":"https://api.github.com/repos/apache/brpc/issues/1428","id":858293322,"node_id":"MDEyOklzc3VlQ29tbWVudDg1ODI5MzMyMg==","user":{"login":"ChenChuang","id":3177358,"node_id":"MDQ6VXNlcjMxNzczNTg=","avatar_url":"https://avatars.githubusercontent.com/u/3177358?v=4","gravatar_id":"","url":"https://api.github.com/users/ChenChuang","html_url":"https://github.com/ChenChuang","followers_url":"https://api.github.com/users/ChenChuang/followers","following_url":"https://api.github.com/users/ChenChuang/following{/other_user}","gists_url":"https://api.github.com/users/ChenChuang/gists{/gist_id}","starred_url":"https://api.github.com/users/ChenChuang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ChenChuang/subscriptions","organizations_url":"https://api.github.com/users/ChenChuang/orgs","repos_url":"https://api.github.com/users/ChenChuang/repos","events_url":"https://api.github.com/users/ChenChuang/events{/privacy}","received_events_url":"https://api.github.com/users/ChenChuang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-10T04:39:12Z","updated_at":"2021-06-10T04:39:12Z","author_association":"NONE","body":"另外，我们在典型堆栈 [1] frame 4 观察到：\r\n(gdb) frame 4 \r\n#4  bthread::butex_wait (arg=0x7f84d508e230, expected_value=expected_value@entry=0, abstime=abstime@entry=0x0) at src/bthread/butex.cpp:622\r\n(gdb) p *g->_cur_meta\r\n$6 = {current_waiter = {<std::atomic<bthread::ButexWaiter*>> = {_M_b = {_M_p = 0x7f84ed7f3a20}}, <No data fields>}, current_sleep = 0, stop = false, interrupted = false, about_to_quit = false, version_lock = 1, version_butex = 0x7f8640124f70, tid = 60129595668, \r\n  fn = 0x12cb8b0 <brpc::ProcessInputMessage(void*)>, arg = 0x7f8bf8063210, stack = 0x7f84d400ca70, attr = {stack_type = 1, flags = 32, keytable_pool = 0x4bdebe0}, cpuwide_start_ns = 29493140553366624, stat = {cputime_ns = 0, nswitch = 0}, local_storage = {keytable = \r\n    0x7f84d509f9a0, assigned_data = 0x0, rpcz_parent_span = 0x0}}\r\n当前正在允许的 bthread 栈类型为 BTHREAD_STACKTYPE_PTHREAD，这个似乎不符合我的预期。我的预期是，处理 rpc 请求都是在 bthread 中执行的\r\n事发当时机器的内存负载不高，不太可能出现触发 因为 out of memory 强制将 bthread 的栈类型改为 pthread 的情况\r\n","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/858293322/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/858455580","html_url":"https://github.com/apache/brpc/issues/1428#issuecomment-858455580","issue_url":"https://api.github.com/repos/apache/brpc/issues/1428","id":858455580,"node_id":"MDEyOklzc3VlQ29tbWVudDg1ODQ1NTU4MA==","user":{"login":"cool-colo","id":20718701,"node_id":"MDQ6VXNlcjIwNzE4NzAx","avatar_url":"https://avatars.githubusercontent.com/u/20718701?v=4","gravatar_id":"","url":"https://api.github.com/users/cool-colo","html_url":"https://github.com/cool-colo","followers_url":"https://api.github.com/users/cool-colo/followers","following_url":"https://api.github.com/users/cool-colo/following{/other_user}","gists_url":"https://api.github.com/users/cool-colo/gists{/gist_id}","starred_url":"https://api.github.com/users/cool-colo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cool-colo/subscriptions","organizations_url":"https://api.github.com/users/cool-colo/orgs","repos_url":"https://api.github.com/users/cool-colo/repos","events_url":"https://api.github.com/users/cool-colo/events{/privacy}","received_events_url":"https://api.github.com/users/cool-colo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-10T09:13:23Z","updated_at":"2021-06-10T09:13:23Z","author_association":"NONE","body":"看这个线程栈, Done好像会往_remote_rq里塞东西，塞给哪个task group是随机的， 如果塞到对应rpc所在的task_group里面，并且rpc task run in pthread-mode, 并且其它task_group也洽好出现同样的情况，没办法互相working stealing,  就死锁了吧。\r\n","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/858455580/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/858611471","html_url":"https://github.com/apache/brpc/issues/1428#issuecomment-858611471","issue_url":"https://api.github.com/repos/apache/brpc/issues/1428","id":858611471,"node_id":"MDEyOklzc3VlQ29tbWVudDg1ODYxMTQ3MQ==","user":{"login":"ChenChuang","id":3177358,"node_id":"MDQ6VXNlcjMxNzczNTg=","avatar_url":"https://avatars.githubusercontent.com/u/3177358?v=4","gravatar_id":"","url":"https://api.github.com/users/ChenChuang","html_url":"https://github.com/ChenChuang","followers_url":"https://api.github.com/users/ChenChuang/followers","following_url":"https://api.github.com/users/ChenChuang/following{/other_user}","gists_url":"https://api.github.com/users/ChenChuang/gists{/gist_id}","starred_url":"https://api.github.com/users/ChenChuang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ChenChuang/subscriptions","organizations_url":"https://api.github.com/users/ChenChuang/orgs","repos_url":"https://api.github.com/users/ChenChuang/repos","events_url":"https://api.github.com/users/ChenChuang/events{/privacy}","received_events_url":"https://api.github.com/users/ChenChuang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-10T13:13:30Z","updated_at":"2021-06-10T13:13:30Z","author_association":"NONE","body":"已经解决。确实是因为该进程 map count 达到了 /proc/sys/vm/max_map_count 导致 allocate_stack_storage 失败，bthread 都进入了 pthread 模型，最终阻塞在 futex_wait_private","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/858611471/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/861005163","html_url":"https://github.com/apache/brpc/issues/1429#issuecomment-861005163","issue_url":"https://api.github.com/repos/apache/brpc/issues/1429","id":861005163,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MTAwNTE2Mw==","user":{"login":"zyearn","id":4475779,"node_id":"MDQ6VXNlcjQ0NzU3Nzk=","avatar_url":"https://avatars.githubusercontent.com/u/4475779?v=4","gravatar_id":"","url":"https://api.github.com/users/zyearn","html_url":"https://github.com/zyearn","followers_url":"https://api.github.com/users/zyearn/followers","following_url":"https://api.github.com/users/zyearn/following{/other_user}","gists_url":"https://api.github.com/users/zyearn/gists{/gist_id}","starred_url":"https://api.github.com/users/zyearn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zyearn/subscriptions","organizations_url":"https://api.github.com/users/zyearn/orgs","repos_url":"https://api.github.com/users/zyearn/repos","events_url":"https://api.github.com/users/zyearn/events{/privacy}","received_events_url":"https://api.github.com/users/zyearn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-14T21:23:05Z","updated_at":"2021-06-14T21:23:05Z","author_association":"MEMBER","body":"方便跑一下[heap profiler](https://github.com/apache/incubator-brpc/blob/master/docs/cn/heap_profiler.md)么？","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/861005163/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/861117639","html_url":"https://github.com/apache/brpc/issues/1429#issuecomment-861117639","issue_url":"https://api.github.com/repos/apache/brpc/issues/1429","id":861117639,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MTExNzYzOQ==","user":{"login":"ShaneTian","id":42370681,"node_id":"MDQ6VXNlcjQyMzcwNjgx","avatar_url":"https://avatars.githubusercontent.com/u/42370681?v=4","gravatar_id":"","url":"https://api.github.com/users/ShaneTian","html_url":"https://github.com/ShaneTian","followers_url":"https://api.github.com/users/ShaneTian/followers","following_url":"https://api.github.com/users/ShaneTian/following{/other_user}","gists_url":"https://api.github.com/users/ShaneTian/gists{/gist_id}","starred_url":"https://api.github.com/users/ShaneTian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ShaneTian/subscriptions","organizations_url":"https://api.github.com/users/ShaneTian/orgs","repos_url":"https://api.github.com/users/ShaneTian/repos","events_url":"https://api.github.com/users/ShaneTian/events{/privacy}","received_events_url":"https://api.github.com/users/ShaneTian/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-15T02:14:34Z","updated_at":"2021-06-15T02:30:04Z","author_association":"NONE","body":"> 方便跑一下[heap profiler](https://github.com/apache/incubator-brpc/blob/master/docs/cn/heap_profiler.md)么？\r\n\r\n@zyearn 使用如下命令报错，\r\n```bash\r\n$ tools/pprof --text localhost:9002/pprof/heap\r\nUse of uninitialized value $line in substitution (s///) at tools/pprof line 2705.\r\nhttp://localhost:9002/pprof/symbol doesn't exist\r\n```\r\n但是 server 代码没有开启 auth，请问是怎么回事呢？\r\n```cpp\r\n// Start the server.\r\nBRPC_NAMESPACE::ServerOptions options;\r\noptions.internal_port = FLAGS_internal_port;\r\noptions.idle_timeout_sec = FLAGS_idle_timeout_s;\r\noptions.thread_local_data_factory = &thread_data_factory;\r\nif (server.Start(FLAGS_port, &options) != 0) {\r\n    LOG(ERROR) << \"Failed to start server\";\r\n    return -1;\r\n\r\n```","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/861117639/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/861315334","html_url":"https://github.com/apache/brpc/issues/1168#issuecomment-861315334","issue_url":"https://api.github.com/repos/apache/brpc/issues/1168","id":861315334,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MTMxNTMzNA==","user":{"login":"zhengchengyao","id":7666172,"node_id":"MDQ6VXNlcjc2NjYxNzI=","avatar_url":"https://avatars.githubusercontent.com/u/7666172?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengchengyao","html_url":"https://github.com/zhengchengyao","followers_url":"https://api.github.com/users/zhengchengyao/followers","following_url":"https://api.github.com/users/zhengchengyao/following{/other_user}","gists_url":"https://api.github.com/users/zhengchengyao/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengchengyao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengchengyao/subscriptions","organizations_url":"https://api.github.com/users/zhengchengyao/orgs","repos_url":"https://api.github.com/users/zhengchengyao/repos","events_url":"https://api.github.com/users/zhengchengyao/events{/privacy}","received_events_url":"https://api.github.com/users/zhengchengyao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-15T08:52:37Z","updated_at":"2021-06-15T08:52:37Z","author_association":"NONE","body":"@gaodayue 您好，请问下，这个问题后面是怎么解决的？我们现在也遇到这个问题，非常感谢！","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/861315334/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/862053786","html_url":"https://github.com/apache/brpc/pull/1314#issuecomment-862053786","issue_url":"https://api.github.com/repos/apache/brpc/issues/1314","id":862053786,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MjA1Mzc4Ng==","user":{"login":"serverglen","id":38067377,"node_id":"MDQ6VXNlcjM4MDY3Mzc3","avatar_url":"https://avatars.githubusercontent.com/u/38067377?v=4","gravatar_id":"","url":"https://api.github.com/users/serverglen","html_url":"https://github.com/serverglen","followers_url":"https://api.github.com/users/serverglen/followers","following_url":"https://api.github.com/users/serverglen/following{/other_user}","gists_url":"https://api.github.com/users/serverglen/gists{/gist_id}","starred_url":"https://api.github.com/users/serverglen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/serverglen/subscriptions","organizations_url":"https://api.github.com/users/serverglen/orgs","repos_url":"https://api.github.com/users/serverglen/repos","events_url":"https://api.github.com/users/serverglen/events{/privacy}","received_events_url":"https://api.github.com/users/serverglen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-16T05:33:15Z","updated_at":"2021-06-16T05:33:15Z","author_association":"CONTRIBUTOR","body":"> Hi, 可以描述一下这个PR的一些情况吗？\r\n> \r\n> * 背景（比如实际场景是什么）\r\n> * 要解决什么问题\r\n> * 为什么wrr不能解决问题\r\n> * 真实场景的落地情况\r\n> \r\n> Thanks.\r\n\r\n1. 百度内部有的业务线有wr的需求\r\n2. 百度内部有的业务线有wr的需求\r\n3. 我理解wr也是需要的\r\n4. 百度内部已经上线了，目前没有收到异常反馈","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/862053786/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/862078854","html_url":"https://github.com/apache/brpc/pull/1431#issuecomment-862078854","issue_url":"https://api.github.com/repos/apache/brpc/issues/1431","id":862078854,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MjA3ODg1NA==","user":{"login":"jamesge","id":6566535,"node_id":"MDQ6VXNlcjY1NjY1MzU=","avatar_url":"https://avatars.githubusercontent.com/u/6566535?v=4","gravatar_id":"","url":"https://api.github.com/users/jamesge","html_url":"https://github.com/jamesge","followers_url":"https://api.github.com/users/jamesge/followers","following_url":"https://api.github.com/users/jamesge/following{/other_user}","gists_url":"https://api.github.com/users/jamesge/gists{/gist_id}","starred_url":"https://api.github.com/users/jamesge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jamesge/subscriptions","organizations_url":"https://api.github.com/users/jamesge/orgs","repos_url":"https://api.github.com/users/jamesge/repos","events_url":"https://api.github.com/users/jamesge/events{/privacy}","received_events_url":"https://api.github.com/users/jamesge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-16T06:19:46Z","updated_at":"2021-06-16T06:19:46Z","author_association":"CONTRIBUTOR","body":"这个改动可能会break一些应用层的代码，无法合入请谅解。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/862078854/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/862081650","html_url":"https://github.com/apache/brpc/pull/1358#issuecomment-862081650","issue_url":"https://api.github.com/repos/apache/brpc/issues/1358","id":862081650,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MjA4MTY1MA==","user":{"login":"jamesge","id":6566535,"node_id":"MDQ6VXNlcjY1NjY1MzU=","avatar_url":"https://avatars.githubusercontent.com/u/6566535?v=4","gravatar_id":"","url":"https://api.github.com/users/jamesge","html_url":"https://github.com/jamesge","followers_url":"https://api.github.com/users/jamesge/followers","following_url":"https://api.github.com/users/jamesge/following{/other_user}","gists_url":"https://api.github.com/users/jamesge/gists{/gist_id}","starred_url":"https://api.github.com/users/jamesge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jamesge/subscriptions","organizations_url":"https://api.github.com/users/jamesge/orgs","repos_url":"https://api.github.com/users/jamesge/repos","events_url":"https://api.github.com/users/jamesge/events{/privacy}","received_events_url":"https://api.github.com/users/jamesge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-16T06:23:44Z","updated_at":"2021-06-16T06:23:44Z","author_association":"CONTRIBUTOR","body":"This PR does not solve the issue, the removed comment clearly explains the details.","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/862081650/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/862086568","html_url":"https://github.com/apache/brpc/issues/1436#issuecomment-862086568","issue_url":"https://api.github.com/repos/apache/brpc/issues/1436","id":862086568,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MjA4NjU2OA==","user":{"login":"pengpengge","id":33371640,"node_id":"MDQ6VXNlcjMzMzcxNjQw","avatar_url":"https://avatars.githubusercontent.com/u/33371640?v=4","gravatar_id":"","url":"https://api.github.com/users/pengpengge","html_url":"https://github.com/pengpengge","followers_url":"https://api.github.com/users/pengpengge/followers","following_url":"https://api.github.com/users/pengpengge/following{/other_user}","gists_url":"https://api.github.com/users/pengpengge/gists{/gist_id}","starred_url":"https://api.github.com/users/pengpengge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pengpengge/subscriptions","organizations_url":"https://api.github.com/users/pengpengge/orgs","repos_url":"https://api.github.com/users/pengpengge/repos","events_url":"https://api.github.com/users/pengpengge/events{/privacy}","received_events_url":"https://api.github.com/users/pengpengge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-16T06:31:40Z","updated_at":"2021-06-16T06:31:40Z","author_association":"NONE","body":"选择new profile时会提示不可使用，但是其实能够生成分析的文件和相应图形界面。是否说明jemalloc也能够在brpc中无缝替代tcmalloc？","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/862086568/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/862274212","html_url":"https://github.com/apache/brpc/pull/1431#issuecomment-862274212","issue_url":"https://api.github.com/repos/apache/brpc/issues/1431","id":862274212,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MjI3NDIxMg==","user":{"login":"guodongxiaren","id":5945107,"node_id":"MDQ6VXNlcjU5NDUxMDc=","avatar_url":"https://avatars.githubusercontent.com/u/5945107?v=4","gravatar_id":"","url":"https://api.github.com/users/guodongxiaren","html_url":"https://github.com/guodongxiaren","followers_url":"https://api.github.com/users/guodongxiaren/followers","following_url":"https://api.github.com/users/guodongxiaren/following{/other_user}","gists_url":"https://api.github.com/users/guodongxiaren/gists{/gist_id}","starred_url":"https://api.github.com/users/guodongxiaren/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/guodongxiaren/subscriptions","organizations_url":"https://api.github.com/users/guodongxiaren/orgs","repos_url":"https://api.github.com/users/guodongxiaren/repos","events_url":"https://api.github.com/users/guodongxiaren/events{/privacy}","received_events_url":"https://api.github.com/users/guodongxiaren/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-16T10:50:51Z","updated_at":"2021-06-16T10:53:32Z","author_association":"MEMBER","body":"感觉还好，之前是按值返回的，应用代码应该也是按值接收的，这里改成返回引用也不影响。可能需要补充一个拷贝构造函数？\n\n另外就是如果brpc后续要支持ipv6的话，这个EndPoint类型里面的字段还会扩充吧。一次拷贝开销会更大。一点思考🤔","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/862274212/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/862643234","html_url":"https://github.com/apache/brpc/pull/1417#issuecomment-862643234","issue_url":"https://api.github.com/repos/apache/brpc/issues/1417","id":862643234,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MjY0MzIzNA==","user":{"login":"zyearn","id":4475779,"node_id":"MDQ6VXNlcjQ0NzU3Nzk=","avatar_url":"https://avatars.githubusercontent.com/u/4475779?v=4","gravatar_id":"","url":"https://api.github.com/users/zyearn","html_url":"https://github.com/zyearn","followers_url":"https://api.github.com/users/zyearn/followers","following_url":"https://api.github.com/users/zyearn/following{/other_user}","gists_url":"https://api.github.com/users/zyearn/gists{/gist_id}","starred_url":"https://api.github.com/users/zyearn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zyearn/subscriptions","organizations_url":"https://api.github.com/users/zyearn/orgs","repos_url":"https://api.github.com/users/zyearn/repos","events_url":"https://api.github.com/users/zyearn/events{/privacy}","received_events_url":"https://api.github.com/users/zyearn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-16T19:10:36Z","updated_at":"2021-06-16T19:10:36Z","author_association":"MEMBER","body":"Hi，能简单描述下这个PR的背景吗，是别的lib也依赖了gflags.so?","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/862643234/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/862652681","html_url":"https://github.com/apache/brpc/issues/1436#issuecomment-862652681","issue_url":"https://api.github.com/repos/apache/brpc/issues/1436","id":862652681,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MjY1MjY4MQ==","user":{"login":"zyearn","id":4475779,"node_id":"MDQ6VXNlcjQ0NzU3Nzk=","avatar_url":"https://avatars.githubusercontent.com/u/4475779?v=4","gravatar_id":"","url":"https://api.github.com/users/zyearn","html_url":"https://github.com/zyearn","followers_url":"https://api.github.com/users/zyearn/followers","following_url":"https://api.github.com/users/zyearn/following{/other_user}","gists_url":"https://api.github.com/users/zyearn/gists{/gist_id}","starred_url":"https://api.github.com/users/zyearn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zyearn/subscriptions","organizations_url":"https://api.github.com/users/zyearn/orgs","repos_url":"https://api.github.com/users/zyearn/repos","events_url":"https://api.github.com/users/zyearn/events{/privacy}","received_events_url":"https://api.github.com/users/zyearn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-16T19:25:59Z","updated_at":"2021-06-16T19:25:59Z","author_association":"MEMBER","body":"CPU profiler需要链接gperftools里ProfilerStart，你应该链接了这个lib才能启动profiler","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/862652681/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/862656682","html_url":"https://github.com/apache/brpc/pull/1314#issuecomment-862656682","issue_url":"https://api.github.com/repos/apache/brpc/issues/1314","id":862656682,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MjY1NjY4Mg==","user":{"login":"zyearn","id":4475779,"node_id":"MDQ6VXNlcjQ0NzU3Nzk=","avatar_url":"https://avatars.githubusercontent.com/u/4475779?v=4","gravatar_id":"","url":"https://api.github.com/users/zyearn","html_url":"https://github.com/zyearn","followers_url":"https://api.github.com/users/zyearn/followers","following_url":"https://api.github.com/users/zyearn/following{/other_user}","gists_url":"https://api.github.com/users/zyearn/gists{/gist_id}","starred_url":"https://api.github.com/users/zyearn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zyearn/subscriptions","organizations_url":"https://api.github.com/users/zyearn/orgs","repos_url":"https://api.github.com/users/zyearn/repos","events_url":"https://api.github.com/users/zyearn/events{/privacy}","received_events_url":"https://api.github.com/users/zyearn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-16T19:32:43Z","updated_at":"2021-06-16T19:33:02Z","author_association":"MEMBER","body":"1.可以简单描述一下这个需求吗，方便我们理解。\r\n3.为什么？","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/862656682/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/862726120","html_url":"https://github.com/apache/brpc/issues/1429#issuecomment-862726120","issue_url":"https://api.github.com/repos/apache/brpc/issues/1429","id":862726120,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MjcyNjEyMA==","user":{"login":"zyearn","id":4475779,"node_id":"MDQ6VXNlcjQ0NzU3Nzk=","avatar_url":"https://avatars.githubusercontent.com/u/4475779?v=4","gravatar_id":"","url":"https://api.github.com/users/zyearn","html_url":"https://github.com/zyearn","followers_url":"https://api.github.com/users/zyearn/followers","following_url":"https://api.github.com/users/zyearn/following{/other_user}","gists_url":"https://api.github.com/users/zyearn/gists{/gist_id}","starred_url":"https://api.github.com/users/zyearn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zyearn/subscriptions","organizations_url":"https://api.github.com/users/zyearn/orgs","repos_url":"https://api.github.com/users/zyearn/repos","events_url":"https://api.github.com/users/zyearn/events{/privacy}","received_events_url":"https://api.github.com/users/zyearn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-16T21:05:12Z","updated_at":"2021-06-16T21:05:12Z","author_association":"MEMBER","body":"这个问题之前没遇到过，先用网页版上的profiler跑一下？","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/862726120/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/862877923","html_url":"https://github.com/apache/brpc/issues/1437#issuecomment-862877923","issue_url":"https://api.github.com/repos/apache/brpc/issues/1437","id":862877923,"node_id":"MDEyOklzc3VlQ29tbWVudDg2Mjg3NzkyMw==","user":{"login":"cdjingit","id":31362185,"node_id":"MDQ6VXNlcjMxMzYyMTg1","avatar_url":"https://avatars.githubusercontent.com/u/31362185?v=4","gravatar_id":"","url":"https://api.github.com/users/cdjingit","html_url":"https://github.com/cdjingit","followers_url":"https://api.github.com/users/cdjingit/followers","following_url":"https://api.github.com/users/cdjingit/following{/other_user}","gists_url":"https://api.github.com/users/cdjingit/gists{/gist_id}","starred_url":"https://api.github.com/users/cdjingit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cdjingit/subscriptions","organizations_url":"https://api.github.com/users/cdjingit/orgs","repos_url":"https://api.github.com/users/cdjingit/repos","events_url":"https://api.github.com/users/cdjingit/events{/privacy}","received_events_url":"https://api.github.com/users/cdjingit/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-17T02:58:13Z","updated_at":"2021-06-17T02:58:13Z","author_association":"CONTRIBUTOR","body":"这个看着可能是业务代码处理请求中间抛出了exception，没有捕获，最后调用abort终止了进程。可以在server method加个try cacth看下。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/862877923/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/863091520","html_url":"https://github.com/apache/brpc/issues/1439#issuecomment-863091520","issue_url":"https://api.github.com/repos/apache/brpc/issues/1439","id":863091520,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MzA5MTUyMA==","user":{"login":"cdjingit","id":31362185,"node_id":"MDQ6VXNlcjMxMzYyMTg1","avatar_url":"https://avatars.githubusercontent.com/u/31362185?v=4","gravatar_id":"","url":"https://api.github.com/users/cdjingit","html_url":"https://github.com/cdjingit","followers_url":"https://api.github.com/users/cdjingit/followers","following_url":"https://api.github.com/users/cdjingit/following{/other_user}","gists_url":"https://api.github.com/users/cdjingit/gists{/gist_id}","starred_url":"https://api.github.com/users/cdjingit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cdjingit/subscriptions","organizations_url":"https://api.github.com/users/cdjingit/orgs","repos_url":"https://api.github.com/users/cdjingit/repos","events_url":"https://api.github.com/users/cdjingit/events{/privacy}","received_events_url":"https://api.github.com/users/cdjingit/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-17T09:38:55Z","updated_at":"2021-06-17T09:38:55Z","author_association":"CONTRIBUTOR","body":"vars页面搜索bthread_execq*","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/863091520/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/863100781","html_url":"https://github.com/apache/brpc/issues/1440#issuecomment-863100781","issue_url":"https://api.github.com/repos/apache/brpc/issues/1440","id":863100781,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MzEwMDc4MQ==","user":{"login":"cdjingit","id":31362185,"node_id":"MDQ6VXNlcjMxMzYyMTg1","avatar_url":"https://avatars.githubusercontent.com/u/31362185?v=4","gravatar_id":"","url":"https://api.github.com/users/cdjingit","html_url":"https://github.com/cdjingit","followers_url":"https://api.github.com/users/cdjingit/followers","following_url":"https://api.github.com/users/cdjingit/following{/other_user}","gists_url":"https://api.github.com/users/cdjingit/gists{/gist_id}","starred_url":"https://api.github.com/users/cdjingit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cdjingit/subscriptions","organizations_url":"https://api.github.com/users/cdjingit/orgs","repos_url":"https://api.github.com/users/cdjingit/repos","events_url":"https://api.github.com/users/cdjingit/events{/privacy}","received_events_url":"https://api.github.com/users/cdjingit/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-17T09:53:15Z","updated_at":"2021-06-17T09:53:15Z","author_association":"CONTRIBUTOR","body":"这个是客户端的值，没法透传给服务端。如果做需要在具体的协议层传输实现","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/863100781/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/863101912","html_url":"https://github.com/apache/brpc/issues/1440#issuecomment-863101912","issue_url":"https://api.github.com/repos/apache/brpc/issues/1440","id":863101912,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MzEwMTkxMg==","user":{"login":"hujianxin","id":9526904,"node_id":"MDQ6VXNlcjk1MjY5MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/9526904?v=4","gravatar_id":"","url":"https://api.github.com/users/hujianxin","html_url":"https://github.com/hujianxin","followers_url":"https://api.github.com/users/hujianxin/followers","following_url":"https://api.github.com/users/hujianxin/following{/other_user}","gists_url":"https://api.github.com/users/hujianxin/gists{/gist_id}","starred_url":"https://api.github.com/users/hujianxin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hujianxin/subscriptions","organizations_url":"https://api.github.com/users/hujianxin/orgs","repos_url":"https://api.github.com/users/hujianxin/repos","events_url":"https://api.github.com/users/hujianxin/events{/privacy}","received_events_url":"https://api.github.com/users/hujianxin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-17T09:54:55Z","updated_at":"2021-06-17T09:54:55Z","author_association":"NONE","body":"@cdjingit Hi 你好，server端如果想判断请求是否已经超时，超时则不再处理（浪费资源），这个有办法实现吗？","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/863101912/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/863106003","html_url":"https://github.com/apache/brpc/issues/1440#issuecomment-863106003","issue_url":"https://api.github.com/repos/apache/brpc/issues/1440","id":863106003,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MzEwNjAwMw==","user":{"login":"hujianxin","id":9526904,"node_id":"MDQ6VXNlcjk1MjY5MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/9526904?v=4","gravatar_id":"","url":"https://api.github.com/users/hujianxin","html_url":"https://github.com/hujianxin","followers_url":"https://api.github.com/users/hujianxin/followers","following_url":"https://api.github.com/users/hujianxin/following{/other_user}","gists_url":"https://api.github.com/users/hujianxin/gists{/gist_id}","starred_url":"https://api.github.com/users/hujianxin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hujianxin/subscriptions","organizations_url":"https://api.github.com/users/hujianxin/orgs","repos_url":"https://api.github.com/users/hujianxin/repos","events_url":"https://api.github.com/users/hujianxin/events{/privacy}","received_events_url":"https://api.github.com/users/hujianxin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-17T10:01:05Z","updated_at":"2021-06-17T10:01:05Z","author_association":"NONE","body":"目前grpc支持从server端的controller获取deadline，brpc的话，server端的controller无论是获取deadline还是timeout_ms都是默认值","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/863106003/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/863107484","html_url":"https://github.com/apache/brpc/issues/1440#issuecomment-863107484","issue_url":"https://api.github.com/repos/apache/brpc/issues/1440","id":863107484,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MzEwNzQ4NA==","user":{"login":"cdjingit","id":31362185,"node_id":"MDQ6VXNlcjMxMzYyMTg1","avatar_url":"https://avatars.githubusercontent.com/u/31362185?v=4","gravatar_id":"","url":"https://api.github.com/users/cdjingit","html_url":"https://github.com/cdjingit","followers_url":"https://api.github.com/users/cdjingit/followers","following_url":"https://api.github.com/users/cdjingit/following{/other_user}","gists_url":"https://api.github.com/users/cdjingit/gists{/gist_id}","starred_url":"https://api.github.com/users/cdjingit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cdjingit/subscriptions","organizations_url":"https://api.github.com/users/cdjingit/orgs","repos_url":"https://api.github.com/users/cdjingit/repos","events_url":"https://api.github.com/users/cdjingit/events{/privacy}","received_events_url":"https://api.github.com/users/cdjingit/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-17T10:03:05Z","updated_at":"2021-06-17T10:03:05Z","author_association":"CONTRIBUTOR","body":"可以开发实现，做法的话，可以由框架或者业务消息传递给下游：比如框架做的话，可以把该时间放到协议内部透传给下游，如果用baidu_std协议，可以放到meta data里。读取消息后，设置到control的相关字段里。传递的信息可以选择是剩余超时时间，或者是时间戳。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/863107484/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/863110790","html_url":"https://github.com/apache/brpc/issues/1440#issuecomment-863110790","issue_url":"https://api.github.com/repos/apache/brpc/issues/1440","id":863110790,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MzExMDc5MA==","user":{"login":"cdjingit","id":31362185,"node_id":"MDQ6VXNlcjMxMzYyMTg1","avatar_url":"https://avatars.githubusercontent.com/u/31362185?v=4","gravatar_id":"","url":"https://api.github.com/users/cdjingit","html_url":"https://github.com/cdjingit","followers_url":"https://api.github.com/users/cdjingit/followers","following_url":"https://api.github.com/users/cdjingit/following{/other_user}","gists_url":"https://api.github.com/users/cdjingit/gists{/gist_id}","starred_url":"https://api.github.com/users/cdjingit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cdjingit/subscriptions","organizations_url":"https://api.github.com/users/cdjingit/orgs","repos_url":"https://api.github.com/users/cdjingit/repos","events_url":"https://api.github.com/users/cdjingit/events{/privacy}","received_events_url":"https://api.github.com/users/cdjingit/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-17T10:07:39Z","updated_at":"2021-06-17T10:07:39Z","author_association":"CONTRIBUTOR","body":"类似的issue #https://github.com/apache/incubator-brpc/issues/232   #https://github.com/apache/incubator-brpc/issues/1316","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/863110790/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/863114682","html_url":"https://github.com/apache/brpc/issues/1439#issuecomment-863114682","issue_url":"https://api.github.com/repos/apache/brpc/issues/1439","id":863114682,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MzExNDY4Mg==","user":{"login":"xdlove","id":16837938,"node_id":"MDQ6VXNlcjE2ODM3OTM4","avatar_url":"https://avatars.githubusercontent.com/u/16837938?v=4","gravatar_id":"","url":"https://api.github.com/users/xdlove","html_url":"https://github.com/xdlove","followers_url":"https://api.github.com/users/xdlove/followers","following_url":"https://api.github.com/users/xdlove/following{/other_user}","gists_url":"https://api.github.com/users/xdlove/gists{/gist_id}","starred_url":"https://api.github.com/users/xdlove/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xdlove/subscriptions","organizations_url":"https://api.github.com/users/xdlove/orgs","repos_url":"https://api.github.com/users/xdlove/repos","events_url":"https://api.github.com/users/xdlove/events{/privacy}","received_events_url":"https://api.github.com/users/xdlove/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-17T10:13:07Z","updated_at":"2021-06-17T10:16:15Z","author_association":"NONE","body":"了解，如果想在代码里引用 ExecutionQueueVars 呢？目前这个函数 get_execq_vars 好像没有暴露接口出来~\r\nPing @cdjingit  ^~^","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/863114682/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/863114885","html_url":"https://github.com/apache/brpc/issues/1440#issuecomment-863114885","issue_url":"https://api.github.com/repos/apache/brpc/issues/1440","id":863114885,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MzExNDg4NQ==","user":{"login":"hujianxin","id":9526904,"node_id":"MDQ6VXNlcjk1MjY5MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/9526904?v=4","gravatar_id":"","url":"https://api.github.com/users/hujianxin","html_url":"https://github.com/hujianxin","followers_url":"https://api.github.com/users/hujianxin/followers","following_url":"https://api.github.com/users/hujianxin/following{/other_user}","gists_url":"https://api.github.com/users/hujianxin/gists{/gist_id}","starred_url":"https://api.github.com/users/hujianxin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hujianxin/subscriptions","organizations_url":"https://api.github.com/users/hujianxin/orgs","repos_url":"https://api.github.com/users/hujianxin/repos","events_url":"https://api.github.com/users/hujianxin/events{/privacy}","received_events_url":"https://api.github.com/users/hujianxin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-17T10:13:25Z","updated_at":"2021-06-17T10:13:25Z","author_association":"NONE","body":"> 可以开发实现，做法的话，可以由框架或者业务消息传递给下游：比如框架做的话，可以把该时间放到协议内部透传给下游，如果用baidu_std协议，可以放到meta data里。读取消息后，设置到control的相关字段里。传递的信息可以选择是剩余超时时间，或者是时间戳。\r\n\r\n目前来看，我们业务方是无法做到的吗？","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/863114885/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/863115222","html_url":"https://github.com/apache/brpc/issues/1440#issuecomment-863115222","issue_url":"https://api.github.com/repos/apache/brpc/issues/1440","id":863115222,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MzExNTIyMg==","user":{"login":"hujianxin","id":9526904,"node_id":"MDQ6VXNlcjk1MjY5MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/9526904?v=4","gravatar_id":"","url":"https://api.github.com/users/hujianxin","html_url":"https://github.com/hujianxin","followers_url":"https://api.github.com/users/hujianxin/followers","following_url":"https://api.github.com/users/hujianxin/following{/other_user}","gists_url":"https://api.github.com/users/hujianxin/gists{/gist_id}","starred_url":"https://api.github.com/users/hujianxin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hujianxin/subscriptions","organizations_url":"https://api.github.com/users/hujianxin/orgs","repos_url":"https://api.github.com/users/hujianxin/repos","events_url":"https://api.github.com/users/hujianxin/events{/privacy}","received_events_url":"https://api.github.com/users/hujianxin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-17T10:13:56Z","updated_at":"2021-06-17T10:13:56Z","author_association":"NONE","body":"感觉这种需求并不算trick","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/863115222/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/863127445","html_url":"https://github.com/apache/brpc/issues/1439#issuecomment-863127445","issue_url":"https://api.github.com/repos/apache/brpc/issues/1439","id":863127445,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MzEyNzQ0NQ==","user":{"login":"cdjingit","id":31362185,"node_id":"MDQ6VXNlcjMxMzYyMTg1","avatar_url":"https://avatars.githubusercontent.com/u/31362185?v=4","gravatar_id":"","url":"https://api.github.com/users/cdjingit","html_url":"https://github.com/cdjingit","followers_url":"https://api.github.com/users/cdjingit/followers","following_url":"https://api.github.com/users/cdjingit/following{/other_user}","gists_url":"https://api.github.com/users/cdjingit/gists{/gist_id}","starred_url":"https://api.github.com/users/cdjingit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cdjingit/subscriptions","organizations_url":"https://api.github.com/users/cdjingit/orgs","repos_url":"https://api.github.com/users/cdjingit/repos","events_url":"https://api.github.com/users/cdjingit/events{/privacy}","received_events_url":"https://api.github.com/users/cdjingit/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-17T10:33:37Z","updated_at":"2021-06-17T10:33:37Z","author_association":"CONTRIBUTOR","body":"> 了解，如果想在代码里引用 ExecutionQueueVars 呢？目前这个函数 get_execq_vars 好像没有暴露接口出来~\r\n> Ping @cdjingit ^~^\r\n\r\n这个函数可以获取相关vars的对象：[ExecutionQueueVars* get_execq_vars()](https://github.com/apache/incubator-brpc/blob/master/src/bthread/execution_queue.cpp#L64)。不过没有暴露出来，需要你自己把inline去掉。 ","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/863127445/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/863130552","html_url":"https://github.com/apache/brpc/issues/1438#issuecomment-863130552","issue_url":"https://api.github.com/repos/apache/brpc/issues/1438","id":863130552,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MzEzMDU1Mg==","user":{"login":"cdjingit","id":31362185,"node_id":"MDQ6VXNlcjMxMzYyMTg1","avatar_url":"https://avatars.githubusercontent.com/u/31362185?v=4","gravatar_id":"","url":"https://api.github.com/users/cdjingit","html_url":"https://github.com/cdjingit","followers_url":"https://api.github.com/users/cdjingit/followers","following_url":"https://api.github.com/users/cdjingit/following{/other_user}","gists_url":"https://api.github.com/users/cdjingit/gists{/gist_id}","starred_url":"https://api.github.com/users/cdjingit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cdjingit/subscriptions","organizations_url":"https://api.github.com/users/cdjingit/orgs","repos_url":"https://api.github.com/users/cdjingit/repos","events_url":"https://api.github.com/users/cdjingit/events{/privacy}","received_events_url":"https://api.github.com/users/cdjingit/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-17T10:39:10Z","updated_at":"2021-06-17T10:39:10Z","author_association":"CONTRIBUTOR","body":"目前实现一些对象池里的对象不会回收，所以内存使用量会和最大并发时的情况相关","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/863130552/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/863135880","html_url":"https://github.com/apache/brpc/issues/1438#issuecomment-863135880","issue_url":"https://api.github.com/repos/apache/brpc/issues/1438","id":863135880,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MzEzNTg4MA==","user":{"login":"panyfx","id":2850845,"node_id":"MDQ6VXNlcjI4NTA4NDU=","avatar_url":"https://avatars.githubusercontent.com/u/2850845?v=4","gravatar_id":"","url":"https://api.github.com/users/panyfx","html_url":"https://github.com/panyfx","followers_url":"https://api.github.com/users/panyfx/followers","following_url":"https://api.github.com/users/panyfx/following{/other_user}","gists_url":"https://api.github.com/users/panyfx/gists{/gist_id}","starred_url":"https://api.github.com/users/panyfx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/panyfx/subscriptions","organizations_url":"https://api.github.com/users/panyfx/orgs","repos_url":"https://api.github.com/users/panyfx/repos","events_url":"https://api.github.com/users/panyfx/events{/privacy}","received_events_url":"https://api.github.com/users/panyfx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-17T10:48:11Z","updated_at":"2021-06-17T10:48:11Z","author_association":"NONE","body":"这里最大并发是怎么影响内存的？内存增长有上限吗？有控制增长的方式没有？","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/863135880/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/863147463","html_url":"https://github.com/apache/brpc/issues/1439#issuecomment-863147463","issue_url":"https://api.github.com/repos/apache/brpc/issues/1439","id":863147463,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MzE0NzQ2Mw==","user":{"login":"xdlove","id":16837938,"node_id":"MDQ6VXNlcjE2ODM3OTM4","avatar_url":"https://avatars.githubusercontent.com/u/16837938?v=4","gravatar_id":"","url":"https://api.github.com/users/xdlove","html_url":"https://github.com/xdlove","followers_url":"https://api.github.com/users/xdlove/followers","following_url":"https://api.github.com/users/xdlove/following{/other_user}","gists_url":"https://api.github.com/users/xdlove/gists{/gist_id}","starred_url":"https://api.github.com/users/xdlove/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xdlove/subscriptions","organizations_url":"https://api.github.com/users/xdlove/orgs","repos_url":"https://api.github.com/users/xdlove/repos","events_url":"https://api.github.com/users/xdlove/events{/privacy}","received_events_url":"https://api.github.com/users/xdlove/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-17T11:07:41Z","updated_at":"2021-06-17T11:07:41Z","author_association":"NONE","body":"> > 了解，如果想在代码里引用 ExecutionQueueVars 呢？目前这个函数 get_execq_vars 好像没有暴露接口出来~\r\n> > Ping @cdjingit ^~^\r\n> \r\n> 这个函数可以获取相关vars的对象：[ExecutionQueueVars* get_execq_vars()](https://github.com/apache/incubator-brpc/blob/master/src/bthread/execution_queue.cpp#L64)。不过没有暴露出来，需要你自己把inline去掉。\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/863147463/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/863148260","html_url":"https://github.com/apache/brpc/issues/1439#issuecomment-863148260","issue_url":"https://api.github.com/repos/apache/brpc/issues/1439","id":863148260,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MzE0ODI2MA==","user":{"login":"xdlove","id":16837938,"node_id":"MDQ6VXNlcjE2ODM3OTM4","avatar_url":"https://avatars.githubusercontent.com/u/16837938?v=4","gravatar_id":"","url":"https://api.github.com/users/xdlove","html_url":"https://github.com/xdlove","followers_url":"https://api.github.com/users/xdlove/followers","following_url":"https://api.github.com/users/xdlove/following{/other_user}","gists_url":"https://api.github.com/users/xdlove/gists{/gist_id}","starred_url":"https://api.github.com/users/xdlove/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xdlove/subscriptions","organizations_url":"https://api.github.com/users/xdlove/orgs","repos_url":"https://api.github.com/users/xdlove/repos","events_url":"https://api.github.com/users/xdlove/events{/privacy}","received_events_url":"https://api.github.com/users/xdlove/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-17T11:08:48Z","updated_at":"2021-06-17T11:09:13Z","author_association":"NONE","body":"明白 ~ 我去打个 patch  Thx！","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/863148260/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/863182693","html_url":"https://github.com/apache/brpc/issues/1438#issuecomment-863182693","issue_url":"https://api.github.com/repos/apache/brpc/issues/1438","id":863182693,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MzE4MjY5Mw==","user":{"login":"panyfx","id":2850845,"node_id":"MDQ6VXNlcjI4NTA4NDU=","avatar_url":"https://avatars.githubusercontent.com/u/2850845?v=4","gravatar_id":"","url":"https://api.github.com/users/panyfx","html_url":"https://github.com/panyfx","followers_url":"https://api.github.com/users/panyfx/followers","following_url":"https://api.github.com/users/panyfx/following{/other_user}","gists_url":"https://api.github.com/users/panyfx/gists{/gist_id}","starred_url":"https://api.github.com/users/panyfx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/panyfx/subscriptions","organizations_url":"https://api.github.com/users/panyfx/orgs","repos_url":"https://api.github.com/users/panyfx/repos","events_url":"https://api.github.com/users/panyfx/events{/privacy}","received_events_url":"https://api.github.com/users/panyfx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-17T12:06:24Z","updated_at":"2021-06-17T12:06:24Z","author_association":"NONE","body":"[20210617.194732.heap - 20210617.141836.heap]\r\nUsing local file \r\nUsing local file ./rpc_data/profiling/c97ffa948718e4ef69f519900a705d04/20210617.194732.heap.\r\nAdjusting heap profiles for 1-in-524288 sampling rate\r\nHeap version 2\r\nAdjusting heap profiles for 1-in-524288 sampling rate\r\nHeap version 2\r\nTotal: 1336.6 MB\r\n   791.4  59.2%  59.2%    791.4  59.2% bthread_setspecific (inline)\r\n   393.1  29.4%  88.6%   1184.5  88.6% bthread_setspecific\r\n\r\n\r\n稳定的20并发压测5个多小时，内存上涨了1G多，这个正常吗？","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/863182693/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/863286712","html_url":"https://github.com/apache/brpc/issues/1441#issuecomment-863286712","issue_url":"https://api.github.com/repos/apache/brpc/issues/1441","id":863286712,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MzI4NjcxMg==","user":{"login":"corznoc","id":63059433,"node_id":"MDQ6VXNlcjYzMDU5NDMz","avatar_url":"https://avatars.githubusercontent.com/u/63059433?v=4","gravatar_id":"","url":"https://api.github.com/users/corznoc","html_url":"https://github.com/corznoc","followers_url":"https://api.github.com/users/corznoc/followers","following_url":"https://api.github.com/users/corznoc/following{/other_user}","gists_url":"https://api.github.com/users/corznoc/gists{/gist_id}","starred_url":"https://api.github.com/users/corznoc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/corznoc/subscriptions","organizations_url":"https://api.github.com/users/corznoc/orgs","repos_url":"https://api.github.com/users/corznoc/repos","events_url":"https://api.github.com/users/corznoc/events{/privacy}","received_events_url":"https://api.github.com/users/corznoc/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-17T14:26:46Z","updated_at":"2021-06-17T14:26:46Z","author_association":"NONE","body":"#1438 和这个有点像","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/863286712/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/863311347","html_url":"https://github.com/apache/brpc/issues/1439#issuecomment-863311347","issue_url":"https://api.github.com/repos/apache/brpc/issues/1439","id":863311347,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MzMxMTM0Nw==","user":{"login":"xdlove","id":16837938,"node_id":"MDQ6VXNlcjE2ODM3OTM4","avatar_url":"https://avatars.githubusercontent.com/u/16837938?v=4","gravatar_id":"","url":"https://api.github.com/users/xdlove","html_url":"https://github.com/xdlove","followers_url":"https://api.github.com/users/xdlove/followers","following_url":"https://api.github.com/users/xdlove/following{/other_user}","gists_url":"https://api.github.com/users/xdlove/gists{/gist_id}","starred_url":"https://api.github.com/users/xdlove/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xdlove/subscriptions","organizations_url":"https://api.github.com/users/xdlove/orgs","repos_url":"https://api.github.com/users/xdlove/repos","events_url":"https://api.github.com/users/xdlove/events{/privacy}","received_events_url":"https://api.github.com/users/xdlove/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-17T14:56:24Z","updated_at":"2021-06-17T14:56:24Z","author_association":"NONE","body":"hi 有个小问题想问一下 ~ \r\n为啥不统计每个 queue 的 vars 呀？目前是一个总的 vars 统计，业务上如果想知道不同 queue 的统计，好像没法知道？\r\nPing @cdjingit ","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/863311347/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/863693706","html_url":"https://github.com/apache/brpc/issues/1439#issuecomment-863693706","issue_url":"https://api.github.com/repos/apache/brpc/issues/1439","id":863693706,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MzY5MzcwNg==","user":{"login":"cdjingit","id":31362185,"node_id":"MDQ6VXNlcjMxMzYyMTg1","avatar_url":"https://avatars.githubusercontent.com/u/31362185?v=4","gravatar_id":"","url":"https://api.github.com/users/cdjingit","html_url":"https://github.com/cdjingit","followers_url":"https://api.github.com/users/cdjingit/followers","following_url":"https://api.github.com/users/cdjingit/following{/other_user}","gists_url":"https://api.github.com/users/cdjingit/gists{/gist_id}","starred_url":"https://api.github.com/users/cdjingit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cdjingit/subscriptions","organizations_url":"https://api.github.com/users/cdjingit/orgs","repos_url":"https://api.github.com/users/cdjingit/repos","events_url":"https://api.github.com/users/cdjingit/events{/privacy}","received_events_url":"https://api.github.com/users/cdjingit/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-18T01:59:11Z","updated_at":"2021-06-18T01:59:11Z","author_association":"CONTRIBUTOR","body":"> hi 有个小问题想问一下 ~\r\n> 为啥不统计每个 queue 的 vars 呀？目前是一个总的 vars 统计，业务上如果想知道不同 queue 的统计，好像没法知道？\r\n> Ping @cdjingit\r\n框架不会统计这么详细，这个可以由业务层面统计的。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/863693706/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/863748577","html_url":"https://github.com/apache/brpc/pull/1433#issuecomment-863748577","issue_url":"https://api.github.com/repos/apache/brpc/issues/1433","id":863748577,"node_id":"MDEyOklzc3VlQ29tbWVudDg2Mzc0ODU3Nw==","user":{"login":"guodongxiaren","id":5945107,"node_id":"MDQ6VXNlcjU5NDUxMDc=","avatar_url":"https://avatars.githubusercontent.com/u/5945107?v=4","gravatar_id":"","url":"https://api.github.com/users/guodongxiaren","html_url":"https://github.com/guodongxiaren","followers_url":"https://api.github.com/users/guodongxiaren/followers","following_url":"https://api.github.com/users/guodongxiaren/following{/other_user}","gists_url":"https://api.github.com/users/guodongxiaren/gists{/gist_id}","starred_url":"https://api.github.com/users/guodongxiaren/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/guodongxiaren/subscriptions","organizations_url":"https://api.github.com/users/guodongxiaren/orgs","repos_url":"https://api.github.com/users/guodongxiaren/repos","events_url":"https://api.github.com/users/guodongxiaren/events{/privacy}","received_events_url":"https://api.github.com/users/guodongxiaren/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-18T04:35:01Z","updated_at":"2021-06-18T04:35:01Z","author_association":"MEMBER","body":"@jamesge ","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/863748577/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/863851534","html_url":"https://github.com/apache/brpc/issues/296#issuecomment-863851534","issue_url":"https://api.github.com/repos/apache/brpc/issues/296","id":863851534,"node_id":"MDEyOklzc3VlQ29tbWVudDg2Mzg1MTUzNA==","user":{"login":"rpbear88","id":61613299,"node_id":"MDQ6VXNlcjYxNjEzMjk5","avatar_url":"https://avatars.githubusercontent.com/u/61613299?v=4","gravatar_id":"","url":"https://api.github.com/users/rpbear88","html_url":"https://github.com/rpbear88","followers_url":"https://api.github.com/users/rpbear88/followers","following_url":"https://api.github.com/users/rpbear88/following{/other_user}","gists_url":"https://api.github.com/users/rpbear88/gists{/gist_id}","starred_url":"https://api.github.com/users/rpbear88/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rpbear88/subscriptions","organizations_url":"https://api.github.com/users/rpbear88/orgs","repos_url":"https://api.github.com/users/rpbear88/repos","events_url":"https://api.github.com/users/rpbear88/events{/privacy}","received_events_url":"https://api.github.com/users/rpbear88/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-18T08:14:59Z","updated_at":"2021-06-18T08:14:59Z","author_association":"NONE","body":"感谢，我也被该问题困扰，终于找到看起来正确的解答了。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/863851534/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/864000630","html_url":"https://github.com/apache/brpc/issues/1443#issuecomment-864000630","issue_url":"https://api.github.com/repos/apache/brpc/issues/1443","id":864000630,"node_id":"MDEyOklzc3VlQ29tbWVudDg2NDAwMDYzMA==","user":{"login":"cdjingit","id":31362185,"node_id":"MDQ6VXNlcjMxMzYyMTg1","avatar_url":"https://avatars.githubusercontent.com/u/31362185?v=4","gravatar_id":"","url":"https://api.github.com/users/cdjingit","html_url":"https://github.com/cdjingit","followers_url":"https://api.github.com/users/cdjingit/followers","following_url":"https://api.github.com/users/cdjingit/following{/other_user}","gists_url":"https://api.github.com/users/cdjingit/gists{/gist_id}","starred_url":"https://api.github.com/users/cdjingit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cdjingit/subscriptions","organizations_url":"https://api.github.com/users/cdjingit/orgs","repos_url":"https://api.github.com/users/cdjingit/repos","events_url":"https://api.github.com/users/cdjingit/events{/privacy}","received_events_url":"https://api.github.com/users/cdjingit/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-18T12:24:59Z","updated_at":"2021-06-18T12:24:59Z","author_association":"CONTRIBUTOR","body":"g = tls_task_group 是切换的curr_stack重新被执行后的下一步执行的代码。当然可能会被调到别的pthread worker去执行","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/864000630/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/864152366","html_url":"https://github.com/apache/brpc/issues/1437#issuecomment-864152366","issue_url":"https://api.github.com/repos/apache/brpc/issues/1437","id":864152366,"node_id":"MDEyOklzc3VlQ29tbWVudDg2NDE1MjM2Ng==","user":{"login":"guodongxiaren","id":5945107,"node_id":"MDQ6VXNlcjU5NDUxMDc=","avatar_url":"https://avatars.githubusercontent.com/u/5945107?v=4","gravatar_id":"","url":"https://api.github.com/users/guodongxiaren","html_url":"https://github.com/guodongxiaren","followers_url":"https://api.github.com/users/guodongxiaren/followers","following_url":"https://api.github.com/users/guodongxiaren/following{/other_user}","gists_url":"https://api.github.com/users/guodongxiaren/gists{/gist_id}","starred_url":"https://api.github.com/users/guodongxiaren/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/guodongxiaren/subscriptions","organizations_url":"https://api.github.com/users/guodongxiaren/orgs","repos_url":"https://api.github.com/users/guodongxiaren/repos","events_url":"https://api.github.com/users/guodongxiaren/events{/privacy}","received_events_url":"https://api.github.com/users/guodongxiaren/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-18T16:28:57Z","updated_at":"2021-06-18T16:28:57Z","author_association":"MEMBER","body":"养成好习惯，给自己的代码函数接口加上noexcept声明。避免core进brpc框架内部。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/864152366/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/864448129","html_url":"https://github.com/apache/brpc/issues/1441#issuecomment-864448129","issue_url":"https://api.github.com/repos/apache/brpc/issues/1441","id":864448129,"node_id":"MDEyOklzc3VlQ29tbWVudDg2NDQ0ODEyOQ==","user":{"login":"lorinlee","id":16054841,"node_id":"MDQ6VXNlcjE2MDU0ODQx","avatar_url":"https://avatars.githubusercontent.com/u/16054841?v=4","gravatar_id":"","url":"https://api.github.com/users/lorinlee","html_url":"https://github.com/lorinlee","followers_url":"https://api.github.com/users/lorinlee/followers","following_url":"https://api.github.com/users/lorinlee/following{/other_user}","gists_url":"https://api.github.com/users/lorinlee/gists{/gist_id}","starred_url":"https://api.github.com/users/lorinlee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lorinlee/subscriptions","organizations_url":"https://api.github.com/users/lorinlee/orgs","repos_url":"https://api.github.com/users/lorinlee/repos","events_url":"https://api.github.com/users/lorinlee/events{/privacy}","received_events_url":"https://api.github.com/users/lorinlee/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-19T18:42:45Z","updated_at":"2021-06-19T18:51:04Z","author_association":"CONTRIBUTOR","body":"Hi, 可以尝试在第一次调用bthread_setspecific之前，先调用一次bthread_getspecific","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/864448129/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/864448991","html_url":"https://github.com/apache/brpc/issues/1438#issuecomment-864448991","issue_url":"https://api.github.com/repos/apache/brpc/issues/1438","id":864448991,"node_id":"MDEyOklzc3VlQ29tbWVudDg2NDQ0ODk5MQ==","user":{"login":"lorinlee","id":16054841,"node_id":"MDQ6VXNlcjE2MDU0ODQx","avatar_url":"https://avatars.githubusercontent.com/u/16054841?v=4","gravatar_id":"","url":"https://api.github.com/users/lorinlee","html_url":"https://github.com/lorinlee","followers_url":"https://api.github.com/users/lorinlee/followers","following_url":"https://api.github.com/users/lorinlee/following{/other_user}","gists_url":"https://api.github.com/users/lorinlee/gists{/gist_id}","starred_url":"https://api.github.com/users/lorinlee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lorinlee/subscriptions","organizations_url":"https://api.github.com/users/lorinlee/orgs","repos_url":"https://api.github.com/users/lorinlee/repos","events_url":"https://api.github.com/users/lorinlee/events{/privacy}","received_events_url":"https://api.github.com/users/lorinlee/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-19T18:50:32Z","updated_at":"2021-06-19T18:50:32Z","author_association":"CONTRIBUTOR","body":"Hi, 可以尝试在第一次调用bthread_setspecific之前，先调用一次bthread_getspecific","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/864448991/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/864449965","html_url":"https://github.com/apache/brpc/issues/1436#issuecomment-864449965","issue_url":"https://api.github.com/repos/apache/brpc/issues/1436","id":864449965,"node_id":"MDEyOklzc3VlQ29tbWVudDg2NDQ0OTk2NQ==","user":{"login":"lorinlee","id":16054841,"node_id":"MDQ6VXNlcjE2MDU0ODQx","avatar_url":"https://avatars.githubusercontent.com/u/16054841?v=4","gravatar_id":"","url":"https://api.github.com/users/lorinlee","html_url":"https://github.com/lorinlee","followers_url":"https://api.github.com/users/lorinlee/followers","following_url":"https://api.github.com/users/lorinlee/following{/other_user}","gists_url":"https://api.github.com/users/lorinlee/gists{/gist_id}","starred_url":"https://api.github.com/users/lorinlee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lorinlee/subscriptions","organizations_url":"https://api.github.com/users/lorinlee/orgs","repos_url":"https://api.github.com/users/lorinlee/repos","events_url":"https://api.github.com/users/lorinlee/events{/privacy}","received_events_url":"https://api.github.com/users/lorinlee/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-19T18:58:39Z","updated_at":"2021-06-19T18:58:39Z","author_association":"CONTRIBUTOR","body":"cpu profilter和tcmalloc是gperftools里的两个库，可以单独链接cpu profiler，可能要改下链接参数之类的。heap profiler是不支持jemalloc的，需要用jemalloc自带的工具","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/864449965/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/864519737","html_url":"https://github.com/apache/brpc/issues/1424#issuecomment-864519737","issue_url":"https://api.github.com/repos/apache/brpc/issues/1424","id":864519737,"node_id":"MDEyOklzc3VlQ29tbWVudDg2NDUxOTczNw==","user":{"login":"lorinlee","id":16054841,"node_id":"MDQ6VXNlcjE2MDU0ODQx","avatar_url":"https://avatars.githubusercontent.com/u/16054841?v=4","gravatar_id":"","url":"https://api.github.com/users/lorinlee","html_url":"https://github.com/lorinlee","followers_url":"https://api.github.com/users/lorinlee/followers","following_url":"https://api.github.com/users/lorinlee/following{/other_user}","gists_url":"https://api.github.com/users/lorinlee/gists{/gist_id}","starred_url":"https://api.github.com/users/lorinlee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lorinlee/subscriptions","organizations_url":"https://api.github.com/users/lorinlee/orgs","repos_url":"https://api.github.com/users/lorinlee/repos","events_url":"https://api.github.com/users/lorinlee/events{/privacy}","received_events_url":"https://api.github.com/users/lorinlee/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-20T08:38:03Z","updated_at":"2021-06-20T08:38:03Z","author_association":"CONTRIBUTOR","body":"server端网卡带宽多高呢，以及内存带宽目前多高？","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/864519737/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/864520048","html_url":"https://github.com/apache/brpc/issues/1425#issuecomment-864520048","issue_url":"https://api.github.com/repos/apache/brpc/issues/1425","id":864520048,"node_id":"MDEyOklzc3VlQ29tbWVudDg2NDUyMDA0OA==","user":{"login":"lorinlee","id":16054841,"node_id":"MDQ6VXNlcjE2MDU0ODQx","avatar_url":"https://avatars.githubusercontent.com/u/16054841?v=4","gravatar_id":"","url":"https://api.github.com/users/lorinlee","html_url":"https://github.com/lorinlee","followers_url":"https://api.github.com/users/lorinlee/followers","following_url":"https://api.github.com/users/lorinlee/following{/other_user}","gists_url":"https://api.github.com/users/lorinlee/gists{/gist_id}","starred_url":"https://api.github.com/users/lorinlee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lorinlee/subscriptions","organizations_url":"https://api.github.com/users/lorinlee/orgs","repos_url":"https://api.github.com/users/lorinlee/repos","events_url":"https://api.github.com/users/lorinlee/events{/privacy}","received_events_url":"https://api.github.com/users/lorinlee/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-20T08:40:27Z","updated_at":"2021-06-20T08:40:27Z","author_association":"CONTRIBUTOR","body":"可以提供一个最小复现的环境吗，比如一个Dockerfile加上一个小的代码片段","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/864520048/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/864520569","html_url":"https://github.com/apache/brpc/issues/1423#issuecomment-864520569","issue_url":"https://api.github.com/repos/apache/brpc/issues/1423","id":864520569,"node_id":"MDEyOklzc3VlQ29tbWVudDg2NDUyMDU2OQ==","user":{"login":"lorinlee","id":16054841,"node_id":"MDQ6VXNlcjE2MDU0ODQx","avatar_url":"https://avatars.githubusercontent.com/u/16054841?v=4","gravatar_id":"","url":"https://api.github.com/users/lorinlee","html_url":"https://github.com/lorinlee","followers_url":"https://api.github.com/users/lorinlee/followers","following_url":"https://api.github.com/users/lorinlee/following{/other_user}","gists_url":"https://api.github.com/users/lorinlee/gists{/gist_id}","starred_url":"https://api.github.com/users/lorinlee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lorinlee/subscriptions","organizations_url":"https://api.github.com/users/lorinlee/orgs","repos_url":"https://api.github.com/users/lorinlee/repos","events_url":"https://api.github.com/users/lorinlee/events{/privacy}","received_events_url":"https://api.github.com/users/lorinlee/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-20T08:45:07Z","updated_at":"2021-06-20T08:45:07Z","author_association":"CONTRIBUTOR","body":"pthread调用bthread::Mutex，和bthread调用blocking 接口都是安全的，不过不太建议在bthread中调用blocking接口","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/864520569/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/864529873","html_url":"https://github.com/apache/brpc/issues/1412#issuecomment-864529873","issue_url":"https://api.github.com/repos/apache/brpc/issues/1412","id":864529873,"node_id":"MDEyOklzc3VlQ29tbWVudDg2NDUyOTg3Mw==","user":{"login":"lorinlee","id":16054841,"node_id":"MDQ6VXNlcjE2MDU0ODQx","avatar_url":"https://avatars.githubusercontent.com/u/16054841?v=4","gravatar_id":"","url":"https://api.github.com/users/lorinlee","html_url":"https://github.com/lorinlee","followers_url":"https://api.github.com/users/lorinlee/followers","following_url":"https://api.github.com/users/lorinlee/following{/other_user}","gists_url":"https://api.github.com/users/lorinlee/gists{/gist_id}","starred_url":"https://api.github.com/users/lorinlee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lorinlee/subscriptions","organizations_url":"https://api.github.com/users/lorinlee/orgs","repos_url":"https://api.github.com/users/lorinlee/repos","events_url":"https://api.github.com/users/lorinlee/events{/privacy}","received_events_url":"https://api.github.com/users/lorinlee/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-20T10:06:23Z","updated_at":"2021-06-20T10:06:23Z","author_association":"CONTRIBUTOR","body":"Task的创建和向TaskGroup分发可以参考`bthread_start_background`和`bthread_start_urgent`的实现。微信交流群可以加我微信`lorinll`，我拉你到群里","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/864529873/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/864530238","html_url":"https://github.com/apache/brpc/issues/1410#issuecomment-864530238","issue_url":"https://api.github.com/repos/apache/brpc/issues/1410","id":864530238,"node_id":"MDEyOklzc3VlQ29tbWVudDg2NDUzMDIzOA==","user":{"login":"lorinlee","id":16054841,"node_id":"MDQ6VXNlcjE2MDU0ODQx","avatar_url":"https://avatars.githubusercontent.com/u/16054841?v=4","gravatar_id":"","url":"https://api.github.com/users/lorinlee","html_url":"https://github.com/lorinlee","followers_url":"https://api.github.com/users/lorinlee/followers","following_url":"https://api.github.com/users/lorinlee/following{/other_user}","gists_url":"https://api.github.com/users/lorinlee/gists{/gist_id}","starred_url":"https://api.github.com/users/lorinlee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lorinlee/subscriptions","organizations_url":"https://api.github.com/users/lorinlee/orgs","repos_url":"https://api.github.com/users/lorinlee/repos","events_url":"https://api.github.com/users/lorinlee/events{/privacy}","received_events_url":"https://api.github.com/users/lorinlee/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-20T10:09:21Z","updated_at":"2021-06-20T10:09:21Z","author_association":"CONTRIBUTOR","body":"如果client遇到超时关闭连接，但是server端还卡在和backupend通信中，并未结束请求，这时候CLOSE_WAIT是符合预期的","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/864530238/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/864720058","html_url":"https://github.com/apache/brpc/issues/1424#issuecomment-864720058","issue_url":"https://api.github.com/repos/apache/brpc/issues/1424","id":864720058,"node_id":"MDEyOklzc3VlQ29tbWVudDg2NDcyMDA1OA==","user":{"login":"guocanwen","id":11960192,"node_id":"MDQ6VXNlcjExOTYwMTky","avatar_url":"https://avatars.githubusercontent.com/u/11960192?v=4","gravatar_id":"","url":"https://api.github.com/users/guocanwen","html_url":"https://github.com/guocanwen","followers_url":"https://api.github.com/users/guocanwen/followers","following_url":"https://api.github.com/users/guocanwen/following{/other_user}","gists_url":"https://api.github.com/users/guocanwen/gists{/gist_id}","starred_url":"https://api.github.com/users/guocanwen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/guocanwen/subscriptions","organizations_url":"https://api.github.com/users/guocanwen/orgs","repos_url":"https://api.github.com/users/guocanwen/repos","events_url":"https://api.github.com/users/guocanwen/events{/privacy}","received_events_url":"https://api.github.com/users/guocanwen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-21T04:34:44Z","updated_at":"2021-06-21T04:34:44Z","author_association":"NONE","body":"我自己写了个rpc，现在已经把网卡打满了","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/864720058/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/864942284","html_url":"https://github.com/apache/brpc/issues/1406#issuecomment-864942284","issue_url":"https://api.github.com/repos/apache/brpc/issues/1406","id":864942284,"node_id":"MDEyOklzc3VlQ29tbWVudDg2NDk0MjI4NA==","user":{"login":"lorinlee","id":16054841,"node_id":"MDQ6VXNlcjE2MDU0ODQx","avatar_url":"https://avatars.githubusercontent.com/u/16054841?v=4","gravatar_id":"","url":"https://api.github.com/users/lorinlee","html_url":"https://github.com/lorinlee","followers_url":"https://api.github.com/users/lorinlee/followers","following_url":"https://api.github.com/users/lorinlee/following{/other_user}","gists_url":"https://api.github.com/users/lorinlee/gists{/gist_id}","starred_url":"https://api.github.com/users/lorinlee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lorinlee/subscriptions","organizations_url":"https://api.github.com/users/lorinlee/orgs","repos_url":"https://api.github.com/users/lorinlee/repos","events_url":"https://api.github.com/users/lorinlee/events{/privacy}","received_events_url":"https://api.github.com/users/lorinlee/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-21T11:03:17Z","updated_at":"2021-06-21T11:03:17Z","author_association":"CONTRIBUTOR","body":"Hi, the retry behavior can be controlled by yourself, you can disable retry by setting `ChannelOptions::max_retry`, or you can implement your own RetryPolicy and set it into `ChannelOptions::retry_policy`","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/864942284/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/864947378","html_url":"https://github.com/apache/brpc/issues/1406#issuecomment-864947378","issue_url":"https://api.github.com/repos/apache/brpc/issues/1406","id":864947378,"node_id":"MDEyOklzc3VlQ29tbWVudDg2NDk0NzM3OA==","user":{"login":"joway","id":8353464,"node_id":"MDQ6VXNlcjgzNTM0NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/8353464?v=4","gravatar_id":"","url":"https://api.github.com/users/joway","html_url":"https://github.com/joway","followers_url":"https://api.github.com/users/joway/followers","following_url":"https://api.github.com/users/joway/following{/other_user}","gists_url":"https://api.github.com/users/joway/gists{/gist_id}","starred_url":"https://api.github.com/users/joway/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/joway/subscriptions","organizations_url":"https://api.github.com/users/joway/orgs","repos_url":"https://api.github.com/users/joway/repos","events_url":"https://api.github.com/users/joway/events{/privacy}","received_events_url":"https://api.github.com/users/joway/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-21T11:10:41Z","updated_at":"2021-06-21T11:10:56Z","author_association":"NONE","body":"@lorinlee Hi, thanks for the answer. I know there are some options that could control this behavior. But just curious about the security of the default retry policy since most developers are using it.","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/864947378/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/865281608","html_url":"https://github.com/apache/brpc/issues/1406#issuecomment-865281608","issue_url":"https://api.github.com/repos/apache/brpc/issues/1406","id":865281608,"node_id":"MDEyOklzc3VlQ29tbWVudDg2NTI4MTYwOA==","user":{"login":"zyearn","id":4475779,"node_id":"MDQ6VXNlcjQ0NzU3Nzk=","avatar_url":"https://avatars.githubusercontent.com/u/4475779?v=4","gravatar_id":"","url":"https://api.github.com/users/zyearn","html_url":"https://github.com/zyearn","followers_url":"https://api.github.com/users/zyearn/followers","following_url":"https://api.github.com/users/zyearn/following{/other_user}","gists_url":"https://api.github.com/users/zyearn/gists{/gist_id}","starred_url":"https://api.github.com/users/zyearn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zyearn/subscriptions","organizations_url":"https://api.github.com/users/zyearn/orgs","repos_url":"https://api.github.com/users/zyearn/repos","events_url":"https://api.github.com/users/zyearn/events{/privacy}","received_events_url":"https://api.github.com/users/zyearn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-21T19:16:09Z","updated_at":"2021-06-21T19:16:09Z","author_association":"MEMBER","body":"ETIMEOUT is a connection timed our error per https://man7.org/linux/man-pages/man3/errno.3.html. If this error happens, RPC can't be sent to remote sides.","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/865281608/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/865485450","html_url":"https://github.com/apache/brpc/issues/1406#issuecomment-865485450","issue_url":"https://api.github.com/repos/apache/brpc/issues/1406","id":865485450,"node_id":"MDEyOklzc3VlQ29tbWVudDg2NTQ4NTQ1MA==","user":{"login":"cdjingit","id":31362185,"node_id":"MDQ6VXNlcjMxMzYyMTg1","avatar_url":"https://avatars.githubusercontent.com/u/31362185?v=4","gravatar_id":"","url":"https://api.github.com/users/cdjingit","html_url":"https://github.com/cdjingit","followers_url":"https://api.github.com/users/cdjingit/followers","following_url":"https://api.github.com/users/cdjingit/following{/other_user}","gists_url":"https://api.github.com/users/cdjingit/gists{/gist_id}","starred_url":"https://api.github.com/users/cdjingit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cdjingit/subscriptions","organizations_url":"https://api.github.com/users/cdjingit/orgs","repos_url":"https://api.github.com/users/cdjingit/repos","events_url":"https://api.github.com/users/cdjingit/events{/privacy}","received_events_url":"https://api.github.com/users/cdjingit/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-22T02:46:34Z","updated_at":"2021-06-22T02:46:34Z","author_association":"CONTRIBUTOR","body":"1. ETIMEOUT means that rpc reached the deadline. ETIMEOUT should not trigger to retry RPC. \r\n2. The default retry poliy refer the link: https://github.com/apache/incubator-brpc/blob/master/src/brpc/retry_policy.cpp#L33\r\n3. Framework can not guarantee idempotent。The idempotent is an application level function.","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/865485450/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/865495593","html_url":"https://github.com/apache/brpc/issues/1406#issuecomment-865495593","issue_url":"https://api.github.com/repos/apache/brpc/issues/1406","id":865495593,"node_id":"MDEyOklzc3VlQ29tbWVudDg2NTQ5NTU5Mw==","user":{"login":"joway","id":8353464,"node_id":"MDQ6VXNlcjgzNTM0NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/8353464?v=4","gravatar_id":"","url":"https://api.github.com/users/joway","html_url":"https://github.com/joway","followers_url":"https://api.github.com/users/joway/followers","following_url":"https://api.github.com/users/joway/following{/other_user}","gists_url":"https://api.github.com/users/joway/gists{/gist_id}","starred_url":"https://api.github.com/users/joway/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/joway/subscriptions","organizations_url":"https://api.github.com/users/joway/orgs","repos_url":"https://api.github.com/users/joway/repos","events_url":"https://api.github.com/users/joway/events{/privacy}","received_events_url":"https://api.github.com/users/joway/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-22T03:15:11Z","updated_at":"2021-06-22T03:15:11Z","author_association":"NONE","body":"@cdjingit @zyearn thanks very much, and I found a [doc](https://github.com/apache/incubator-brpc/blob/60159fc3f3e13490fb9806ea0a0cb0dcdbda7f7d/docs/en/client.md#q-how-to-make-requests-be-processed-once-and-only-once) has answered my question.\r\n\r\nIn summary, when using brpc users should make sure their services are idempotent otherwise they need to disable the default retry policy.","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/865495593/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/865499892","html_url":"https://github.com/apache/brpc/issues/1406#issuecomment-865499892","issue_url":"https://api.github.com/repos/apache/brpc/issues/1406","id":865499892,"node_id":"MDEyOklzc3VlQ29tbWVudDg2NTQ5OTg5Mg==","user":{"login":"lorinlee","id":16054841,"node_id":"MDQ6VXNlcjE2MDU0ODQx","avatar_url":"https://avatars.githubusercontent.com/u/16054841?v=4","gravatar_id":"","url":"https://api.github.com/users/lorinlee","html_url":"https://github.com/lorinlee","followers_url":"https://api.github.com/users/lorinlee/followers","following_url":"https://api.github.com/users/lorinlee/following{/other_user}","gists_url":"https://api.github.com/users/lorinlee/gists{/gist_id}","starred_url":"https://api.github.com/users/lorinlee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lorinlee/subscriptions","organizations_url":"https://api.github.com/users/lorinlee/orgs","repos_url":"https://api.github.com/users/lorinlee/repos","events_url":"https://api.github.com/users/lorinlee/events{/privacy}","received_events_url":"https://api.github.com/users/lorinlee/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-22T03:28:03Z","updated_at":"2021-06-22T03:28:03Z","author_association":"CONTRIBUTOR","body":"Hi @joway, another thing I have missed is the meaning of error code. You can see this [doc](https://github.com/apache/incubator-brpc/blob/master/docs/en/client.md), the `Settings` section. `ETIMEDOUT` is connection timeout but not rpc timeout, so it can be retried. `ERPCTIMEDOUT` means rpc timeout, which cannot be retried for the reason you said, and the DefaultRetryPolicy also not retry, so users needn't care about the default behavior.","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/865499892/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/865501140","html_url":"https://github.com/apache/brpc/issues/1406#issuecomment-865501140","issue_url":"https://api.github.com/repos/apache/brpc/issues/1406","id":865501140,"node_id":"MDEyOklzc3VlQ29tbWVudDg2NTUwMTE0MA==","user":{"login":"lorinlee","id":16054841,"node_id":"MDQ6VXNlcjE2MDU0ODQx","avatar_url":"https://avatars.githubusercontent.com/u/16054841?v=4","gravatar_id":"","url":"https://api.github.com/users/lorinlee","html_url":"https://github.com/lorinlee","followers_url":"https://api.github.com/users/lorinlee/followers","following_url":"https://api.github.com/users/lorinlee/following{/other_user}","gists_url":"https://api.github.com/users/lorinlee/gists{/gist_id}","starred_url":"https://api.github.com/users/lorinlee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lorinlee/subscriptions","organizations_url":"https://api.github.com/users/lorinlee/orgs","repos_url":"https://api.github.com/users/lorinlee/repos","events_url":"https://api.github.com/users/lorinlee/events{/privacy}","received_events_url":"https://api.github.com/users/lorinlee/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-22T03:32:09Z","updated_at":"2021-06-22T03:32:09Z","author_association":"CONTRIBUTOR","body":"and all error code meanings can be found in here [error code](https://github.com/apache/incubator-brpc/blob/master/docs/en/error_code.md)","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/865501140/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/865626615","html_url":"https://github.com/apache/brpc/pull/1252#issuecomment-865626615","issue_url":"https://api.github.com/repos/apache/brpc/issues/1252","id":865626615,"node_id":"MDEyOklzc3VlQ29tbWVudDg2NTYyNjYxNQ==","user":{"login":"serverglen","id":38067377,"node_id":"MDQ6VXNlcjM4MDY3Mzc3","avatar_url":"https://avatars.githubusercontent.com/u/38067377?v=4","gravatar_id":"","url":"https://api.github.com/users/serverglen","html_url":"https://github.com/serverglen","followers_url":"https://api.github.com/users/serverglen/followers","following_url":"https://api.github.com/users/serverglen/following{/other_user}","gists_url":"https://api.github.com/users/serverglen/gists{/gist_id}","starred_url":"https://api.github.com/users/serverglen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/serverglen/subscriptions","organizations_url":"https://api.github.com/users/serverglen/orgs","repos_url":"https://api.github.com/users/serverglen/repos","events_url":"https://api.github.com/users/serverglen/events{/privacy}","received_events_url":"https://api.github.com/users/serverglen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-22T06:10:35Z","updated_at":"2021-06-22T06:10:35Z","author_association":"CONTRIBUTOR","body":"@jamesge @zyearn 辛苦抽时间帮Review下，thanks.","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/865626615/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/866456327","html_url":"https://github.com/apache/brpc/pull/1314#issuecomment-866456327","issue_url":"https://api.github.com/repos/apache/brpc/issues/1314","id":866456327,"node_id":"MDEyOklzc3VlQ29tbWVudDg2NjQ1NjMyNw==","user":{"login":"serverglen","id":38067377,"node_id":"MDQ6VXNlcjM4MDY3Mzc3","avatar_url":"https://avatars.githubusercontent.com/u/38067377?v=4","gravatar_id":"","url":"https://api.github.com/users/serverglen","html_url":"https://github.com/serverglen","followers_url":"https://api.github.com/users/serverglen/followers","following_url":"https://api.github.com/users/serverglen/following{/other_user}","gists_url":"https://api.github.com/users/serverglen/gists{/gist_id}","starred_url":"https://api.github.com/users/serverglen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/serverglen/subscriptions","organizations_url":"https://api.github.com/users/serverglen/orgs","repos_url":"https://api.github.com/users/serverglen/repos","events_url":"https://api.github.com/users/serverglen/events{/privacy}","received_events_url":"https://api.github.com/users/serverglen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-23T01:43:21Z","updated_at":"2021-06-23T01:43:21Z","author_association":"CONTRIBUTOR","body":"> 1.可以简单描述一下这个需求吗，方便我们理解。\r\n> 3.为什么？\r\n\r\n1. 比如：百度内部语音业务解码器需要GPU机器，但是GPU卡型号，几卡等，直接影响服务的处理能力，所以需要根据机器的配置分配不同的访问权重\r\n3. 我理解wr和wrr不冲突，相当于加强版的random算法，而且这也是一种常见的负载均衡算法。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/866456327/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/866769000","html_url":"https://github.com/apache/brpc/issues/1446#issuecomment-866769000","issue_url":"https://api.github.com/repos/apache/brpc/issues/1446","id":866769000,"node_id":"MDEyOklzc3VlQ29tbWVudDg2Njc2OTAwMA==","user":{"login":"rpbear88","id":61613299,"node_id":"MDQ6VXNlcjYxNjEzMjk5","avatar_url":"https://avatars.githubusercontent.com/u/61613299?v=4","gravatar_id":"","url":"https://api.github.com/users/rpbear88","html_url":"https://github.com/rpbear88","followers_url":"https://api.github.com/users/rpbear88/followers","following_url":"https://api.github.com/users/rpbear88/following{/other_user}","gists_url":"https://api.github.com/users/rpbear88/gists{/gist_id}","starred_url":"https://api.github.com/users/rpbear88/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rpbear88/subscriptions","organizations_url":"https://api.github.com/users/rpbear88/orgs","repos_url":"https://api.github.com/users/rpbear88/repos","events_url":"https://api.github.com/users/rpbear88/events{/privacy}","received_events_url":"https://api.github.com/users/rpbear88/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-23T11:50:01Z","updated_at":"2021-06-23T11:50:01Z","author_association":"NONE","body":"后来我们发现，因为开启RDMA之后，IOBuf进行内存分配的全局函数被修改为block pool的相关函数了，这导致只要是使用IOBuf的逻辑都会使用该内存池。\r\n\r\n而我们业务使用的braft的log storage是选择的内存类型，所以这些log实际上都在内存里占用了IOBuf一直未释放，后来我们加上了定期snapshot就解决了这个问题。\r\n\r\nps：期间还出现了阶段性地重新选举的现象，经分析应该是我们在RDMA线程(开启了polling+inplace)分配过大的内存(10GB)时导致整个线程不能响应其他raft心跳等操作，导致leader失效了。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/866769000/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/867550280","html_url":"https://github.com/apache/brpc/issues/1447#issuecomment-867550280","issue_url":"https://api.github.com/repos/apache/brpc/issues/1447","id":867550280,"node_id":"MDEyOklzc3VlQ29tbWVudDg2NzU1MDI4MA==","user":{"login":"rpbear88","id":61613299,"node_id":"MDQ6VXNlcjYxNjEzMjk5","avatar_url":"https://avatars.githubusercontent.com/u/61613299?v=4","gravatar_id":"","url":"https://api.github.com/users/rpbear88","html_url":"https://github.com/rpbear88","followers_url":"https://api.github.com/users/rpbear88/followers","following_url":"https://api.github.com/users/rpbear88/following{/other_user}","gists_url":"https://api.github.com/users/rpbear88/gists{/gist_id}","starred_url":"https://api.github.com/users/rpbear88/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rpbear88/subscriptions","organizations_url":"https://api.github.com/users/rpbear88/orgs","repos_url":"https://api.github.com/users/rpbear88/repos","events_url":"https://api.github.com/users/rpbear88/events{/privacy}","received_events_url":"https://api.github.com/users/rpbear88/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-24T11:11:50Z","updated_at":"2021-06-24T11:11:50Z","author_association":"NONE","body":"另外，我们很想让所有bthread的调用修改为urgent的原地执行方式，但是braft中部分逻辑对锁的使用导致在这个场景下会死锁。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/867550280/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/867619622","html_url":"https://github.com/apache/brpc/issues/1392#issuecomment-867619622","issue_url":"https://api.github.com/repos/apache/brpc/issues/1392","id":867619622,"node_id":"MDEyOklzc3VlQ29tbWVudDg2NzYxOTYyMg==","user":{"login":"lorinlee","id":16054841,"node_id":"MDQ6VXNlcjE2MDU0ODQx","avatar_url":"https://avatars.githubusercontent.com/u/16054841?v=4","gravatar_id":"","url":"https://api.github.com/users/lorinlee","html_url":"https://github.com/lorinlee","followers_url":"https://api.github.com/users/lorinlee/followers","following_url":"https://api.github.com/users/lorinlee/following{/other_user}","gists_url":"https://api.github.com/users/lorinlee/gists{/gist_id}","starred_url":"https://api.github.com/users/lorinlee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lorinlee/subscriptions","organizations_url":"https://api.github.com/users/lorinlee/orgs","repos_url":"https://api.github.com/users/lorinlee/repos","events_url":"https://api.github.com/users/lorinlee/events{/privacy}","received_events_url":"https://api.github.com/users/lorinlee/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-24T13:04:12Z","updated_at":"2021-06-24T13:04:12Z","author_association":"CONTRIBUTOR","body":"请问brpc是用了哪个版本","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/867619622/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/867626524","html_url":"https://github.com/apache/brpc/issues/1392#issuecomment-867626524","issue_url":"https://api.github.com/repos/apache/brpc/issues/1392","id":867626524,"node_id":"MDEyOklzc3VlQ29tbWVudDg2NzYyNjUyNA==","user":{"login":"lorinlee","id":16054841,"node_id":"MDQ6VXNlcjE2MDU0ODQx","avatar_url":"https://avatars.githubusercontent.com/u/16054841?v=4","gravatar_id":"","url":"https://api.github.com/users/lorinlee","html_url":"https://github.com/lorinlee","followers_url":"https://api.github.com/users/lorinlee/followers","following_url":"https://api.github.com/users/lorinlee/following{/other_user}","gists_url":"https://api.github.com/users/lorinlee/gists{/gist_id}","starred_url":"https://api.github.com/users/lorinlee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lorinlee/subscriptions","organizations_url":"https://api.github.com/users/lorinlee/orgs","repos_url":"https://api.github.com/users/lorinlee/repos","events_url":"https://api.github.com/users/lorinlee/events{/privacy}","received_events_url":"https://api.github.com/users/lorinlee/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-24T13:13:47Z","updated_at":"2021-06-24T13:13:47Z","author_association":"CONTRIBUTOR","body":"看到是用了master，不过这边在ubuntu20.04的docker容器中并没有复现出来，是不是本地装了其他版本的gflags库？你可以用docker环境尝试编译一下吗，排除下是本地环境的问题","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/867626524/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/868474760","html_url":"https://github.com/apache/brpc/issues/1448#issuecomment-868474760","issue_url":"https://api.github.com/repos/apache/brpc/issues/1448","id":868474760,"node_id":"MDEyOklzc3VlQ29tbWVudDg2ODQ3NDc2MA==","user":{"login":"wuzhiguocarter","id":6290560,"node_id":"MDQ6VXNlcjYyOTA1NjA=","avatar_url":"https://avatars.githubusercontent.com/u/6290560?v=4","gravatar_id":"","url":"https://api.github.com/users/wuzhiguocarter","html_url":"https://github.com/wuzhiguocarter","followers_url":"https://api.github.com/users/wuzhiguocarter/followers","following_url":"https://api.github.com/users/wuzhiguocarter/following{/other_user}","gists_url":"https://api.github.com/users/wuzhiguocarter/gists{/gist_id}","starred_url":"https://api.github.com/users/wuzhiguocarter/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wuzhiguocarter/subscriptions","organizations_url":"https://api.github.com/users/wuzhiguocarter/orgs","repos_url":"https://api.github.com/users/wuzhiguocarter/repos","events_url":"https://api.github.com/users/wuzhiguocarter/events{/privacy}","received_events_url":"https://api.github.com/users/wuzhiguocarter/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-25T12:46:44Z","updated_at":"2021-06-25T12:46:44Z","author_association":"NONE","body":"A服务是纯brpc server\r\nB服务server端使用的thrift server，请求A服务使用的是brpc client","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/868474760/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/868507105","html_url":"https://github.com/apache/brpc/issues/1448#issuecomment-868507105","issue_url":"https://api.github.com/repos/apache/brpc/issues/1448","id":868507105,"node_id":"MDEyOklzc3VlQ29tbWVudDg2ODUwNzEwNQ==","user":{"login":"wuzhiguocarter","id":6290560,"node_id":"MDQ6VXNlcjYyOTA1NjA=","avatar_url":"https://avatars.githubusercontent.com/u/6290560?v=4","gravatar_id":"","url":"https://api.github.com/users/wuzhiguocarter","html_url":"https://github.com/wuzhiguocarter","followers_url":"https://api.github.com/users/wuzhiguocarter/followers","following_url":"https://api.github.com/users/wuzhiguocarter/following{/other_user}","gists_url":"https://api.github.com/users/wuzhiguocarter/gists{/gist_id}","starred_url":"https://api.github.com/users/wuzhiguocarter/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wuzhiguocarter/subscriptions","organizations_url":"https://api.github.com/users/wuzhiguocarter/orgs","repos_url":"https://api.github.com/users/wuzhiguocarter/repos","events_url":"https://api.github.com/users/wuzhiguocarter/events{/privacy}","received_events_url":"https://api.github.com/users/wuzhiguocarter/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-25T13:39:26Z","updated_at":"2021-06-25T13:39:26Z","author_association":"NONE","body":"查看brpc框架源码，Socket::Create方法也禁用了nagling","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/868507105/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/868970090","html_url":"https://github.com/apache/brpc/issues/1444#issuecomment-868970090","issue_url":"https://api.github.com/repos/apache/brpc/issues/1444","id":868970090,"node_id":"MDEyOklzc3VlQ29tbWVudDg2ODk3MDA5MA==","user":{"login":"lorinlee","id":16054841,"node_id":"MDQ6VXNlcjE2MDU0ODQx","avatar_url":"https://avatars.githubusercontent.com/u/16054841?v=4","gravatar_id":"","url":"https://api.github.com/users/lorinlee","html_url":"https://github.com/lorinlee","followers_url":"https://api.github.com/users/lorinlee/followers","following_url":"https://api.github.com/users/lorinlee/following{/other_user}","gists_url":"https://api.github.com/users/lorinlee/gists{/gist_id}","starred_url":"https://api.github.com/users/lorinlee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lorinlee/subscriptions","organizations_url":"https://api.github.com/users/lorinlee/orgs","repos_url":"https://api.github.com/users/lorinlee/repos","events_url":"https://api.github.com/users/lorinlee/events{/privacy}","received_events_url":"https://api.github.com/users/lorinlee/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-26T08:42:32Z","updated_at":"2021-06-26T08:42:32Z","author_association":"CONTRIBUTOR","body":"Hi @serverglen，如果已经有实现的话，是否可以提交上来呢","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/868970090/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/868970278","html_url":"https://github.com/apache/brpc/issues/1445#issuecomment-868970278","issue_url":"https://api.github.com/repos/apache/brpc/issues/1445","id":868970278,"node_id":"MDEyOklzc3VlQ29tbWVudDg2ODk3MDI3OA==","user":{"login":"lorinlee","id":16054841,"node_id":"MDQ6VXNlcjE2MDU0ODQx","avatar_url":"https://avatars.githubusercontent.com/u/16054841?v=4","gravatar_id":"","url":"https://api.github.com/users/lorinlee","html_url":"https://github.com/lorinlee","followers_url":"https://api.github.com/users/lorinlee/followers","following_url":"https://api.github.com/users/lorinlee/following{/other_user}","gists_url":"https://api.github.com/users/lorinlee/gists{/gist_id}","starred_url":"https://api.github.com/users/lorinlee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lorinlee/subscriptions","organizations_url":"https://api.github.com/users/lorinlee/orgs","repos_url":"https://api.github.com/users/lorinlee/repos","events_url":"https://api.github.com/users/lorinlee/events{/privacy}","received_events_url":"https://api.github.com/users/lorinlee/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-26T08:44:00Z","updated_at":"2021-06-26T08:44:00Z","author_association":"CONTRIBUTOR","body":"Hi @serverglen，如果已经有实现的话，可以提上来哈","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/868970278/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/869030952","html_url":"https://github.com/apache/brpc/issues/1447#issuecomment-869030952","issue_url":"https://api.github.com/repos/apache/brpc/issues/1447","id":869030952,"node_id":"MDEyOklzc3VlQ29tbWVudDg2OTAzMDk1Mg==","user":{"login":"lorinlee","id":16054841,"node_id":"MDQ6VXNlcjE2MDU0ODQx","avatar_url":"https://avatars.githubusercontent.com/u/16054841?v=4","gravatar_id":"","url":"https://api.github.com/users/lorinlee","html_url":"https://github.com/lorinlee","followers_url":"https://api.github.com/users/lorinlee/followers","following_url":"https://api.github.com/users/lorinlee/following{/other_user}","gists_url":"https://api.github.com/users/lorinlee/gists{/gist_id}","starred_url":"https://api.github.com/users/lorinlee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lorinlee/subscriptions","organizations_url":"https://api.github.com/users/lorinlee/orgs","repos_url":"https://api.github.com/users/lorinlee/repos","events_url":"https://api.github.com/users/lorinlee/events{/privacy}","received_events_url":"https://api.github.com/users/lorinlee/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-26T17:07:08Z","updated_at":"2021-06-26T17:07:08Z","author_association":"CONTRIBUTOR","body":"Hi @rpbear88 , 如文档所述，bthread创建是比较快的，主要耗时确实是在调度延迟。任务创建后直至被运行也有几个步骤，首先会在当前worker的rq中排队，若其他worker空闲，则会进行work stealing；其他worker可能之前处于挂起睡眠状态，work stealing之前还需要执行唤醒。而work stealing中可能会对多个TaskGroup进行尝试，极端负载下如果尝试多次也会造成很大的overhead，每次work stealing会先偷取某线程的rq，会有原子操作开销，之后会尝试remote_rq会有锁的开销，stealing之后由于cache locality不佳，也会有性能的损失。整体链路延迟可能会有几微秒到几十微秒不等","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/869030952/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/869031321","html_url":"https://github.com/apache/brpc/issues/1447#issuecomment-869031321","issue_url":"https://api.github.com/repos/apache/brpc/issues/1447","id":869031321,"node_id":"MDEyOklzc3VlQ29tbWVudDg2OTAzMTMyMQ==","user":{"login":"lorinlee","id":16054841,"node_id":"MDQ6VXNlcjE2MDU0ODQx","avatar_url":"https://avatars.githubusercontent.com/u/16054841?v=4","gravatar_id":"","url":"https://api.github.com/users/lorinlee","html_url":"https://github.com/lorinlee","followers_url":"https://api.github.com/users/lorinlee/followers","following_url":"https://api.github.com/users/lorinlee/following{/other_user}","gists_url":"https://api.github.com/users/lorinlee/gists{/gist_id}","starred_url":"https://api.github.com/users/lorinlee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lorinlee/subscriptions","organizations_url":"https://api.github.com/users/lorinlee/orgs","repos_url":"https://api.github.com/users/lorinlee/repos","events_url":"https://api.github.com/users/lorinlee/events{/privacy}","received_events_url":"https://api.github.com/users/lorinlee/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-26T17:10:00Z","updated_at":"2021-06-26T17:10:00Z","author_association":"CONTRIBUTOR","body":"另外关于braft的使用方式，可以咨询braft的同学哈","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/869031321/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/869033642","html_url":"https://github.com/apache/brpc/issues/1448#issuecomment-869033642","issue_url":"https://api.github.com/repos/apache/brpc/issues/1448","id":869033642,"node_id":"MDEyOklzc3VlQ29tbWVudDg2OTAzMzY0Mg==","user":{"login":"lorinlee","id":16054841,"node_id":"MDQ6VXNlcjE2MDU0ODQx","avatar_url":"https://avatars.githubusercontent.com/u/16054841?v=4","gravatar_id":"","url":"https://api.github.com/users/lorinlee","html_url":"https://github.com/lorinlee","followers_url":"https://api.github.com/users/lorinlee/followers","following_url":"https://api.github.com/users/lorinlee/following{/other_user}","gists_url":"https://api.github.com/users/lorinlee/gists{/gist_id}","starred_url":"https://api.github.com/users/lorinlee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lorinlee/subscriptions","organizations_url":"https://api.github.com/users/lorinlee/orgs","repos_url":"https://api.github.com/users/lorinlee/repos","events_url":"https://api.github.com/users/lorinlee/events{/privacy}","received_events_url":"https://api.github.com/users/lorinlee/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-26T17:27:36Z","updated_at":"2021-06-26T17:27:36Z","author_association":"CONTRIBUTOR","body":"Hi @wuzhiguocarter ，请问延迟高，是只测了B调用A服务这一小块的延迟吧？没有包含任何B的业务逻辑，只有rpc调用的开销，需要先排除B业务逻辑的开销哈。\r\n\r\n看有单独对A服务做压测，压测客户端是使用了brpc吗？压测期间在客户端看到的延迟是否正常？\r\nA服务耗时测的是哪部分的耗时，是否包括收到消息后的排队等待时间？B调用A的延迟avg和pct50是否也显著高于A服务本身的延迟？\r\n\r\n网络调用链路其实是比较长的，延迟高可能是客户端机器负载不稳定，可能是网络不稳定，也可能是某些badcase导致长尾，情况很多。对于延迟高的情况，建议增加一些指标，或者通过抓网络包，先定位到哪个阶段慢，再具体排查是什么原因导致的","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/869033642/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/869055121","html_url":"https://github.com/apache/brpc/issues/1449#issuecomment-869055121","issue_url":"https://api.github.com/repos/apache/brpc/issues/1449","id":869055121,"node_id":"MDEyOklzc3VlQ29tbWVudDg2OTA1NTEyMQ==","user":{"login":"lorinlee","id":16054841,"node_id":"MDQ6VXNlcjE2MDU0ODQx","avatar_url":"https://avatars.githubusercontent.com/u/16054841?v=4","gravatar_id":"","url":"https://api.github.com/users/lorinlee","html_url":"https://github.com/lorinlee","followers_url":"https://api.github.com/users/lorinlee/followers","following_url":"https://api.github.com/users/lorinlee/following{/other_user}","gists_url":"https://api.github.com/users/lorinlee/gists{/gist_id}","starred_url":"https://api.github.com/users/lorinlee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lorinlee/subscriptions","organizations_url":"https://api.github.com/users/lorinlee/orgs","repos_url":"https://api.github.com/users/lorinlee/repos","events_url":"https://api.github.com/users/lorinlee/events{/privacy}","received_events_url":"https://api.github.com/users/lorinlee/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-26T20:04:44Z","updated_at":"2021-06-26T20:04:44Z","author_association":"CONTRIBUTOR","body":"There may have another scenario that can make memory leaked. First, we call bthread_getspecific(key1) which borrows a KeyTable from KeyTablePool, and it has old values in slot `key1` and `key2` in this KeyTable, then we call bthread_setspecific(key2), the old value in slot key2 may leak.\r\n\r\nSo, at now, we must call `bthread_getspecific` and check if there already have an old value before calling `bthread_setspecific`, otherwise, a memory leak may happen.","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/869055121/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/869296344","html_url":"https://github.com/apache/brpc/issues/1448#issuecomment-869296344","issue_url":"https://api.github.com/repos/apache/brpc/issues/1448","id":869296344,"node_id":"MDEyOklzc3VlQ29tbWVudDg2OTI5NjM0NA==","user":{"login":"wuzhiguocarter","id":6290560,"node_id":"MDQ6VXNlcjYyOTA1NjA=","avatar_url":"https://avatars.githubusercontent.com/u/6290560?v=4","gravatar_id":"","url":"https://api.github.com/users/wuzhiguocarter","html_url":"https://github.com/wuzhiguocarter","followers_url":"https://api.github.com/users/wuzhiguocarter/followers","following_url":"https://api.github.com/users/wuzhiguocarter/following{/other_user}","gists_url":"https://api.github.com/users/wuzhiguocarter/gists{/gist_id}","starred_url":"https://api.github.com/users/wuzhiguocarter/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wuzhiguocarter/subscriptions","organizations_url":"https://api.github.com/users/wuzhiguocarter/orgs","repos_url":"https://api.github.com/users/wuzhiguocarter/repos","events_url":"https://api.github.com/users/wuzhiguocarter/events{/privacy}","received_events_url":"https://api.github.com/users/wuzhiguocarter/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-28T02:43:21Z","updated_at":"2021-06-28T02:43:21Z","author_association":"NONE","body":"1. 排除了负载不稳定\r\n2. 排除网络不稳定\r\n3. 排除badcase导致的长尾\r\n4. 压测客户端也是brpc client\r\n5. B调用A的延迟avg和pct50是否也显著高于A服务本身的延迟\r\n6. 抓包后发现ack_rtt > 20ms有很多，ping测试B->A rtt在0.1ms一下","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/869296344/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/869300436","html_url":"https://github.com/apache/brpc/issues/1444#issuecomment-869300436","issue_url":"https://api.github.com/repos/apache/brpc/issues/1444","id":869300436,"node_id":"MDEyOklzc3VlQ29tbWVudDg2OTMwMDQzNg==","user":{"login":"serverglen","id":38067377,"node_id":"MDQ6VXNlcjM4MDY3Mzc3","avatar_url":"https://avatars.githubusercontent.com/u/38067377?v=4","gravatar_id":"","url":"https://api.github.com/users/serverglen","html_url":"https://github.com/serverglen","followers_url":"https://api.github.com/users/serverglen/followers","following_url":"https://api.github.com/users/serverglen/following{/other_user}","gists_url":"https://api.github.com/users/serverglen/gists{/gist_id}","starred_url":"https://api.github.com/users/serverglen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/serverglen/subscriptions","organizations_url":"https://api.github.com/users/serverglen/orgs","repos_url":"https://api.github.com/users/serverglen/repos","events_url":"https://api.github.com/users/serverglen/events{/privacy}","received_events_url":"https://api.github.com/users/serverglen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-28T02:56:48Z","updated_at":"2021-06-28T02:56:48Z","author_association":"CONTRIBUTOR","body":"> Hi @serverglen，如果已经有实现的话，是否可以提交上来呢\r\n\r\n嗯，这几天提交上来。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/869300436/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/869391217","html_url":"https://github.com/apache/brpc/issues/1448#issuecomment-869391217","issue_url":"https://api.github.com/repos/apache/brpc/issues/1448","id":869391217,"node_id":"MDEyOklzc3VlQ29tbWVudDg2OTM5MTIxNw==","user":{"login":"chenzhangyi","id":6805583,"node_id":"MDQ6VXNlcjY4MDU1ODM=","avatar_url":"https://avatars.githubusercontent.com/u/6805583?v=4","gravatar_id":"","url":"https://api.github.com/users/chenzhangyi","html_url":"https://github.com/chenzhangyi","followers_url":"https://api.github.com/users/chenzhangyi/followers","following_url":"https://api.github.com/users/chenzhangyi/following{/other_user}","gists_url":"https://api.github.com/users/chenzhangyi/gists{/gist_id}","starred_url":"https://api.github.com/users/chenzhangyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenzhangyi/subscriptions","organizations_url":"https://api.github.com/users/chenzhangyi/orgs","repos_url":"https://api.github.com/users/chenzhangyi/repos","events_url":"https://api.github.com/users/chenzhangyi/events{/privacy}","received_events_url":"https://api.github.com/users/chenzhangyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-28T06:14:24Z","updated_at":"2021-06-28T06:14:24Z","author_association":"MEMBER","body":"可以用 ss 命令看下连接上的 queue size。 如果queue size比较大的话。 这个问题可能和\r\nhttps://github.com/apache/incubator-brpc/pull/1193 \r\n这个pr要解决的问题是类似的.","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/869391217/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/869862091","html_url":"https://github.com/apache/brpc/issues/1450#issuecomment-869862091","issue_url":"https://api.github.com/repos/apache/brpc/issues/1450","id":869862091,"node_id":"MDEyOklzc3VlQ29tbWVudDg2OTg2MjA5MQ==","user":{"login":"lorinlee","id":16054841,"node_id":"MDQ6VXNlcjE2MDU0ODQx","avatar_url":"https://avatars.githubusercontent.com/u/16054841?v=4","gravatar_id":"","url":"https://api.github.com/users/lorinlee","html_url":"https://github.com/lorinlee","followers_url":"https://api.github.com/users/lorinlee/followers","following_url":"https://api.github.com/users/lorinlee/following{/other_user}","gists_url":"https://api.github.com/users/lorinlee/gists{/gist_id}","starred_url":"https://api.github.com/users/lorinlee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lorinlee/subscriptions","organizations_url":"https://api.github.com/users/lorinlee/orgs","repos_url":"https://api.github.com/users/lorinlee/repos","events_url":"https://api.github.com/users/lorinlee/events{/privacy}","received_events_url":"https://api.github.com/users/lorinlee/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-28T17:12:00Z","updated_at":"2021-06-28T17:12:00Z","author_association":"CONTRIBUTOR","body":"是的，可以提PR修一下哈","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/869862091/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/870188572","html_url":"https://github.com/apache/brpc/pull/1143#issuecomment-870188572","issue_url":"https://api.github.com/repos/apache/brpc/issues/1143","id":870188572,"node_id":"MDEyOklzc3VlQ29tbWVudDg3MDE4ODU3Mg==","user":{"login":"TousakaRin","id":8801314,"node_id":"MDQ6VXNlcjg4MDEzMTQ=","avatar_url":"https://avatars.githubusercontent.com/u/8801314?v=4","gravatar_id":"","url":"https://api.github.com/users/TousakaRin","html_url":"https://github.com/TousakaRin","followers_url":"https://api.github.com/users/TousakaRin/followers","following_url":"https://api.github.com/users/TousakaRin/following{/other_user}","gists_url":"https://api.github.com/users/TousakaRin/gists{/gist_id}","starred_url":"https://api.github.com/users/TousakaRin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TousakaRin/subscriptions","organizations_url":"https://api.github.com/users/TousakaRin/orgs","repos_url":"https://api.github.com/users/TousakaRin/repos","events_url":"https://api.github.com/users/TousakaRin/events{/privacy}","received_events_url":"https://api.github.com/users/TousakaRin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-29T02:50:18Z","updated_at":"2021-06-29T02:50:18Z","author_association":"CONTRIBUTOR","body":"可能会破坏每一行的修改记录，这个pr先关闭了","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/870188572/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/870366701","html_url":"https://github.com/apache/brpc/issues/1425#issuecomment-870366701","issue_url":"https://api.github.com/repos/apache/brpc/issues/1425","id":870366701,"node_id":"MDEyOklzc3VlQ29tbWVudDg3MDM2NjcwMQ==","user":{"login":"dheart-joe","id":10397085,"node_id":"MDQ6VXNlcjEwMzk3MDg1","avatar_url":"https://avatars.githubusercontent.com/u/10397085?v=4","gravatar_id":"","url":"https://api.github.com/users/dheart-joe","html_url":"https://github.com/dheart-joe","followers_url":"https://api.github.com/users/dheart-joe/followers","following_url":"https://api.github.com/users/dheart-joe/following{/other_user}","gists_url":"https://api.github.com/users/dheart-joe/gists{/gist_id}","starred_url":"https://api.github.com/users/dheart-joe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dheart-joe/subscriptions","organizations_url":"https://api.github.com/users/dheart-joe/orgs","repos_url":"https://api.github.com/users/dheart-joe/repos","events_url":"https://api.github.com/users/dheart-joe/events{/privacy}","received_events_url":"https://api.github.com/users/dheart-joe/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-29T07:56:10Z","updated_at":"2021-06-29T07:56:10Z","author_association":"NONE","body":"我发现由于brpc的bhtread中覆盖了，系统的pthread_mutex_lock，所以有时候会莫名其他的找不到pthread_mutex_lock","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/870366701/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/870370193","html_url":"https://github.com/apache/brpc/issues/1425#issuecomment-870370193","issue_url":"https://api.github.com/repos/apache/brpc/issues/1425","id":870370193,"node_id":"MDEyOklzc3VlQ29tbWVudDg3MDM3MDE5Mw==","user":{"login":"dheart-joe","id":10397085,"node_id":"MDQ6VXNlcjEwMzk3MDg1","avatar_url":"https://avatars.githubusercontent.com/u/10397085?v=4","gravatar_id":"","url":"https://api.github.com/users/dheart-joe","html_url":"https://github.com/dheart-joe","followers_url":"https://api.github.com/users/dheart-joe/followers","following_url":"https://api.github.com/users/dheart-joe/following{/other_user}","gists_url":"https://api.github.com/users/dheart-joe/gists{/gist_id}","starred_url":"https://api.github.com/users/dheart-joe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dheart-joe/subscriptions","organizations_url":"https://api.github.com/users/dheart-joe/orgs","repos_url":"https://api.github.com/users/dheart-joe/repos","events_url":"https://api.github.com/users/dheart-joe/events{/privacy}","received_events_url":"https://api.github.com/users/dheart-joe/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-29T08:00:13Z","updated_at":"2021-06-29T08:00:13Z","author_association":"NONE","body":"brpc的pthread_mutex_lock\r\nnm -A brpc/lib/libbrpc.so | grep pthread_mutex_lock\r\nbrpc/lib/libbrpc.so:0000000000499610 T pthread_mutex_lock\r\nbrpc/lib/libbrpc.so:0000000000498270 T _ZN7bthread28first_sys_pthread_mutex_lockEP15pthread_mutex_t\r\nbrpc/lib/libbrpc.so:0000000000b9f3b0 d _ZN7bthreadL22sys_pthread_mutex_lockE\r\n\r\nphtread的pthread_mutex_lock\r\nnm -A /lib/x86_64-linux-gnu/libpthread.so.0 | grep pthread_mutex_lock\r\n/lib/x86_64-linux-gnu/libpthread.so.0:000000000000bfc0 t __GI___pthread_mutex_lock\r\n/lib/x86_64-linux-gnu/libpthread.so.0:000000000000bfc0 T __pthread_mutex_lock\r\n/lib/x86_64-linux-gnu/libpthread.so.0:000000000000bfc0 W pthread_mutex_lock\r\n/lib/x86_64-linux-gnu/libpthread.so.0:000000000000b8a0 t __pthread_mutex_lock_full\r\n\r\n我在猜可能其他项目用到brpc库的时候，估计要开启gcc的有关参数，才能解决这个冲突的问题，跟系统库的函数名冲突，是个比较麻烦的事情。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/870370193/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/870515557","html_url":"https://github.com/apache/brpc/issues/1122#issuecomment-870515557","issue_url":"https://api.github.com/repos/apache/brpc/issues/1122","id":870515557,"node_id":"MDEyOklzc3VlQ29tbWVudDg3MDUxNTU1Nw==","user":{"login":"wshilaji","id":37108887,"node_id":"MDQ6VXNlcjM3MTA4ODg3","avatar_url":"https://avatars.githubusercontent.com/u/37108887?v=4","gravatar_id":"","url":"https://api.github.com/users/wshilaji","html_url":"https://github.com/wshilaji","followers_url":"https://api.github.com/users/wshilaji/followers","following_url":"https://api.github.com/users/wshilaji/following{/other_user}","gists_url":"https://api.github.com/users/wshilaji/gists{/gist_id}","starred_url":"https://api.github.com/users/wshilaji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wshilaji/subscriptions","organizations_url":"https://api.github.com/users/wshilaji/orgs","repos_url":"https://api.github.com/users/wshilaji/repos","events_url":"https://api.github.com/users/wshilaji/events{/privacy}","received_events_url":"https://api.github.com/users/wshilaji/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-29T11:32:15Z","updated_at":"2021-06-29T11:32:15Z","author_association":"NONE","body":"大佬你解决了吗。我也遇到这个问题了","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/870515557/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/871270562","html_url":"https://github.com/apache/brpc/issues/1452#issuecomment-871270562","issue_url":"https://api.github.com/repos/apache/brpc/issues/1452","id":871270562,"node_id":"MDEyOklzc3VlQ29tbWVudDg3MTI3MDU2Mg==","user":{"login":"lorinlee","id":16054841,"node_id":"MDQ6VXNlcjE2MDU0ODQx","avatar_url":"https://avatars.githubusercontent.com/u/16054841?v=4","gravatar_id":"","url":"https://api.github.com/users/lorinlee","html_url":"https://github.com/lorinlee","followers_url":"https://api.github.com/users/lorinlee/followers","following_url":"https://api.github.com/users/lorinlee/following{/other_user}","gists_url":"https://api.github.com/users/lorinlee/gists{/gist_id}","starred_url":"https://api.github.com/users/lorinlee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lorinlee/subscriptions","organizations_url":"https://api.github.com/users/lorinlee/orgs","repos_url":"https://api.github.com/users/lorinlee/repos","events_url":"https://api.github.com/users/lorinlee/events{/privacy}","received_events_url":"https://api.github.com/users/lorinlee/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-30T10:08:23Z","updated_at":"2021-06-30T10:08:23Z","author_association":"CONTRIBUTOR","body":"Hi, thanks for your issue, but can you provide some detailed information about the apollo configuration?","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/871270562/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/871276397","html_url":"https://github.com/apache/brpc/issues/1441#issuecomment-871276397","issue_url":"https://api.github.com/repos/apache/brpc/issues/1441","id":871276397,"node_id":"MDEyOklzc3VlQ29tbWVudDg3MTI3NjM5Nw==","user":{"login":"lorinlee","id":16054841,"node_id":"MDQ6VXNlcjE2MDU0ODQx","avatar_url":"https://avatars.githubusercontent.com/u/16054841?v=4","gravatar_id":"","url":"https://api.github.com/users/lorinlee","html_url":"https://github.com/lorinlee","followers_url":"https://api.github.com/users/lorinlee/followers","following_url":"https://api.github.com/users/lorinlee/following{/other_user}","gists_url":"https://api.github.com/users/lorinlee/gists{/gist_id}","starred_url":"https://api.github.com/users/lorinlee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lorinlee/subscriptions","organizations_url":"https://api.github.com/users/lorinlee/orgs","repos_url":"https://api.github.com/users/lorinlee/repos","events_url":"https://api.github.com/users/lorinlee/events{/privacy}","received_events_url":"https://api.github.com/users/lorinlee/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-30T10:16:45Z","updated_at":"2021-06-30T10:16:45Z","author_association":"CONTRIBUTOR","body":"已经有对应的issue描述具体问题了，可以参考 #1449 ，这个issue先关掉了，如果有问题可以再打开哈","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/871276397/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/871276719","html_url":"https://github.com/apache/brpc/issues/1438#issuecomment-871276719","issue_url":"https://api.github.com/repos/apache/brpc/issues/1438","id":871276719,"node_id":"MDEyOklzc3VlQ29tbWVudDg3MTI3NjcxOQ==","user":{"login":"lorinlee","id":16054841,"node_id":"MDQ6VXNlcjE2MDU0ODQx","avatar_url":"https://avatars.githubusercontent.com/u/16054841?v=4","gravatar_id":"","url":"https://api.github.com/users/lorinlee","html_url":"https://github.com/lorinlee","followers_url":"https://api.github.com/users/lorinlee/followers","following_url":"https://api.github.com/users/lorinlee/following{/other_user}","gists_url":"https://api.github.com/users/lorinlee/gists{/gist_id}","starred_url":"https://api.github.com/users/lorinlee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lorinlee/subscriptions","organizations_url":"https://api.github.com/users/lorinlee/orgs","repos_url":"https://api.github.com/users/lorinlee/repos","events_url":"https://api.github.com/users/lorinlee/events{/privacy}","received_events_url":"https://api.github.com/users/lorinlee/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-30T10:17:13Z","updated_at":"2021-06-30T10:17:13Z","author_association":"CONTRIBUTOR","body":"已经有对应的issue描述具体问题了，可以参考 #1449 ，这个issue先关掉了，如果有问题可以再打开哈","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/871276719/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/871679935","html_url":"https://github.com/apache/brpc/issues/1440#issuecomment-871679935","issue_url":"https://api.github.com/repos/apache/brpc/issues/1440","id":871679935,"node_id":"MDEyOklzc3VlQ29tbWVudDg3MTY3OTkzNQ==","user":{"login":"zyearn","id":4475779,"node_id":"MDQ6VXNlcjQ0NzU3Nzk=","avatar_url":"https://avatars.githubusercontent.com/u/4475779?v=4","gravatar_id":"","url":"https://api.github.com/users/zyearn","html_url":"https://github.com/zyearn","followers_url":"https://api.github.com/users/zyearn/followers","following_url":"https://api.github.com/users/zyearn/following{/other_user}","gists_url":"https://api.github.com/users/zyearn/gists{/gist_id}","starred_url":"https://api.github.com/users/zyearn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zyearn/subscriptions","organizations_url":"https://api.github.com/users/zyearn/orgs","repos_url":"https://api.github.com/users/zyearn/repos","events_url":"https://api.github.com/users/zyearn/events{/privacy}","received_events_url":"https://api.github.com/users/zyearn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-30T19:46:06Z","updated_at":"2021-06-30T19:46:06Z","author_association":"MEMBER","body":"目前grpc协议支持，如果对端是grpc client的话，在brpc server端可以通过cntl.deadline_us()获取deadline","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/871679935/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/871862517","html_url":"https://github.com/apache/brpc/pull/1433#issuecomment-871862517","issue_url":"https://api.github.com/repos/apache/brpc/issues/1433","id":871862517,"node_id":"MDEyOklzc3VlQ29tbWVudDg3MTg2MjUxNw==","user":{"login":"cdjingit","id":31362185,"node_id":"MDQ6VXNlcjMxMzYyMTg1","avatar_url":"https://avatars.githubusercontent.com/u/31362185?v=4","gravatar_id":"","url":"https://api.github.com/users/cdjingit","html_url":"https://github.com/cdjingit","followers_url":"https://api.github.com/users/cdjingit/followers","following_url":"https://api.github.com/users/cdjingit/following{/other_user}","gists_url":"https://api.github.com/users/cdjingit/gists{/gist_id}","starred_url":"https://api.github.com/users/cdjingit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cdjingit/subscriptions","organizations_url":"https://api.github.com/users/cdjingit/orgs","repos_url":"https://api.github.com/users/cdjingit/repos","events_url":"https://api.github.com/users/cdjingit/events{/privacy}","received_events_url":"https://api.github.com/users/cdjingit/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-01T02:26:10Z","updated_at":"2021-07-01T02:26:10Z","author_association":"CONTRIBUTOR","body":"https://github.com/apache/incubator-brpc/issues/1300 这个可以提供类似的功能，供参考，不过需要注意一下control，request, response的析构顺序","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/871862517/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/871866542","html_url":"https://github.com/apache/brpc/issues/1449#issuecomment-871866542","issue_url":"https://api.github.com/repos/apache/brpc/issues/1449","id":871866542,"node_id":"MDEyOklzc3VlQ29tbWVudDg3MTg2NjU0Mg==","user":{"login":"cdjingit","id":31362185,"node_id":"MDQ6VXNlcjMxMzYyMTg1","avatar_url":"https://avatars.githubusercontent.com/u/31362185?v=4","gravatar_id":"","url":"https://api.github.com/users/cdjingit","html_url":"https://github.com/cdjingit","followers_url":"https://api.github.com/users/cdjingit/followers","following_url":"https://api.github.com/users/cdjingit/following{/other_user}","gists_url":"https://api.github.com/users/cdjingit/gists{/gist_id}","starred_url":"https://api.github.com/users/cdjingit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cdjingit/subscriptions","organizations_url":"https://api.github.com/users/cdjingit/orgs","repos_url":"https://api.github.com/users/cdjingit/repos","events_url":"https://api.github.com/users/cdjingit/events{/privacy}","received_events_url":"https://api.github.com/users/cdjingit/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-01T02:37:05Z","updated_at":"2021-07-01T02:37:05Z","author_association":"CONTRIBUTOR","body":"so, this memory leak is by design as the code comments. ","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/871866542/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/871893605","html_url":"https://github.com/apache/brpc/issues/1449#issuecomment-871893605","issue_url":"https://api.github.com/repos/apache/brpc/issues/1449","id":871893605,"node_id":"MDEyOklzc3VlQ29tbWVudDg3MTg5MzYwNQ==","user":{"login":"lorinlee","id":16054841,"node_id":"MDQ6VXNlcjE2MDU0ODQx","avatar_url":"https://avatars.githubusercontent.com/u/16054841?v=4","gravatar_id":"","url":"https://api.github.com/users/lorinlee","html_url":"https://github.com/lorinlee","followers_url":"https://api.github.com/users/lorinlee/followers","following_url":"https://api.github.com/users/lorinlee/following{/other_user}","gists_url":"https://api.github.com/users/lorinlee/gists{/gist_id}","starred_url":"https://api.github.com/users/lorinlee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lorinlee/subscriptions","organizations_url":"https://api.github.com/users/lorinlee/orgs","repos_url":"https://api.github.com/users/lorinlee/repos","events_url":"https://api.github.com/users/lorinlee/events{/privacy}","received_events_url":"https://api.github.com/users/lorinlee/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-01T03:54:04Z","updated_at":"2021-07-01T03:54:04Z","author_association":"CONTRIBUTOR","body":"@cdjingit There are some differences, the code comments just explain that memory leaks may occur if borrowing KeyTable in `bthread_setspecific`, so `bthread_setspecific` creates a new one KeyTable instead of borrowing, but this implementation needs special usage. For example, we must call bthread_getspecific before bthread_setspecific, otherwise infinite KeyTables will be created, which causes KeyTables memory to leak.","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/871893605/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/871996762","html_url":"https://github.com/apache/brpc/issues/1453#issuecomment-871996762","issue_url":"https://api.github.com/repos/apache/brpc/issues/1453","id":871996762,"node_id":"MDEyOklzc3VlQ29tbWVudDg3MTk5Njc2Mg==","user":{"login":"cdjingit","id":31362185,"node_id":"MDQ6VXNlcjMxMzYyMTg1","avatar_url":"https://avatars.githubusercontent.com/u/31362185?v=4","gravatar_id":"","url":"https://api.github.com/users/cdjingit","html_url":"https://github.com/cdjingit","followers_url":"https://api.github.com/users/cdjingit/followers","following_url":"https://api.github.com/users/cdjingit/following{/other_user}","gists_url":"https://api.github.com/users/cdjingit/gists{/gist_id}","starred_url":"https://api.github.com/users/cdjingit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cdjingit/subscriptions","organizations_url":"https://api.github.com/users/cdjingit/orgs","repos_url":"https://api.github.com/users/cdjingit/repos","events_url":"https://api.github.com/users/cdjingit/events{/privacy}","received_events_url":"https://api.github.com/users/cdjingit/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-01T07:26:51Z","updated_at":"2021-07-01T07:26:51Z","author_association":"CONTRIBUTOR","body":"https://github.com/apache/incubator-brpc/tree/rdma 这个版本支持","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/871996762/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/872113664","html_url":"https://github.com/apache/brpc/issues/1454#issuecomment-872113664","issue_url":"https://api.github.com/repos/apache/brpc/issues/1454","id":872113664,"node_id":"MDEyOklzc3VlQ29tbWVudDg3MjExMzY2NA==","user":{"login":"cdjingit","id":31362185,"node_id":"MDQ6VXNlcjMxMzYyMTg1","avatar_url":"https://avatars.githubusercontent.com/u/31362185?v=4","gravatar_id":"","url":"https://api.github.com/users/cdjingit","html_url":"https://github.com/cdjingit","followers_url":"https://api.github.com/users/cdjingit/followers","following_url":"https://api.github.com/users/cdjingit/following{/other_user}","gists_url":"https://api.github.com/users/cdjingit/gists{/gist_id}","starred_url":"https://api.github.com/users/cdjingit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cdjingit/subscriptions","organizations_url":"https://api.github.com/users/cdjingit/orgs","repos_url":"https://api.github.com/users/cdjingit/repos","events_url":"https://api.github.com/users/cdjingit/events{/privacy}","received_events_url":"https://api.github.com/users/cdjingit/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-01T10:14:32Z","updated_at":"2021-07-01T10:14:32Z","author_association":"CONTRIBUTOR","body":"可以详细列一下你们内部方案可能改动的点吗？我认为框架层面需要兼容protobuf2的。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/872113664/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/872138808","html_url":"https://github.com/apache/brpc/issues/1449#issuecomment-872138808","issue_url":"https://api.github.com/repos/apache/brpc/issues/1449","id":872138808,"node_id":"MDEyOklzc3VlQ29tbWVudDg3MjEzODgwOA==","user":{"login":"cdjingit","id":31362185,"node_id":"MDQ6VXNlcjMxMzYyMTg1","avatar_url":"https://avatars.githubusercontent.com/u/31362185?v=4","gravatar_id":"","url":"https://api.github.com/users/cdjingit","html_url":"https://github.com/cdjingit","followers_url":"https://api.github.com/users/cdjingit/followers","following_url":"https://api.github.com/users/cdjingit/following{/other_user}","gists_url":"https://api.github.com/users/cdjingit/gists{/gist_id}","starred_url":"https://api.github.com/users/cdjingit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cdjingit/subscriptions","organizations_url":"https://api.github.com/users/cdjingit/orgs","repos_url":"https://api.github.com/users/cdjingit/repos","events_url":"https://api.github.com/users/cdjingit/events{/privacy}","received_events_url":"https://api.github.com/users/cdjingit/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-01T10:57:36Z","updated_at":"2021-07-01T10:57:36Z","author_association":"CONTRIBUTOR","body":"@lorinlee  As doc [description](https://github.com/apache/incubator-brpc/blob/master/docs/cn/server.md#bthread-local), seems we MUST call bthread_getspecific to check KeyTables before bthread_setspecific. \r\nOtherwise, how to fix it? Add a bthread_getspecific check logic in bthread_setspecific.","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/872138808/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/872300187","html_url":"https://github.com/apache/brpc/pull/1433#issuecomment-872300187","issue_url":"https://api.github.com/repos/apache/brpc/issues/1433","id":872300187,"node_id":"MDEyOklzc3VlQ29tbWVudDg3MjMwMDE4Nw==","user":{"login":"guodongxiaren","id":5945107,"node_id":"MDQ6VXNlcjU5NDUxMDc=","avatar_url":"https://avatars.githubusercontent.com/u/5945107?v=4","gravatar_id":"","url":"https://api.github.com/users/guodongxiaren","html_url":"https://github.com/guodongxiaren","followers_url":"https://api.github.com/users/guodongxiaren/followers","following_url":"https://api.github.com/users/guodongxiaren/following{/other_user}","gists_url":"https://api.github.com/users/guodongxiaren/gists{/gist_id}","starred_url":"https://api.github.com/users/guodongxiaren/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/guodongxiaren/subscriptions","organizations_url":"https://api.github.com/users/guodongxiaren/orgs","repos_url":"https://api.github.com/users/guodongxiaren/repos","events_url":"https://api.github.com/users/guodongxiaren/events{/privacy}","received_events_url":"https://api.github.com/users/guodongxiaren/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-01T14:35:20Z","updated_at":"2021-07-01T14:35:20Z","author_association":"MEMBER","body":"> #1300 这个可以提供类似的功能，供参考，不过需要注意一下control，request, response的析构顺序\r\n\r\n不太一样吧。我这个偏业务，比如我是要根据业务场景的上下文状态，从request、response中**一次性**取出一些pb字段，组成一个json 或者新的pb，发给kafka。\r\n\r\n@cdjingit ","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/872300187/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/872659963","html_url":"https://github.com/apache/brpc/pull/1314#issuecomment-872659963","issue_url":"https://api.github.com/repos/apache/brpc/issues/1314","id":872659963,"node_id":"MDEyOklzc3VlQ29tbWVudDg3MjY1OTk2Mw==","user":{"login":"wwbmmm","id":3894631,"node_id":"MDQ6VXNlcjM4OTQ2MzE=","avatar_url":"https://avatars.githubusercontent.com/u/3894631?v=4","gravatar_id":"","url":"https://api.github.com/users/wwbmmm","html_url":"https://github.com/wwbmmm","followers_url":"https://api.github.com/users/wwbmmm/followers","following_url":"https://api.github.com/users/wwbmmm/following{/other_user}","gists_url":"https://api.github.com/users/wwbmmm/gists{/gist_id}","starred_url":"https://api.github.com/users/wwbmmm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wwbmmm/subscriptions","organizations_url":"https://api.github.com/users/wwbmmm/orgs","repos_url":"https://api.github.com/users/wwbmmm/repos","events_url":"https://api.github.com/users/wwbmmm/events{/privacy}","received_events_url":"https://api.github.com/users/wwbmmm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-02T02:07:48Z","updated_at":"2021-07-02T02:07:48Z","author_association":"CONTRIBUTOR","body":"> 1.可以简单描述一下这个需求吗，方便我们理解。\r\n> 3.为什么？\r\n\r\n由于rr和wrr都是基于TLS实现轮询的，在用户pthread数量很多的场景下，容易出现负载不均衡，这时使用random/wr可以达到更好的负载均衡的效果","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/872659963/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/872665659","html_url":"https://github.com/apache/brpc/issues/1449#issuecomment-872665659","issue_url":"https://api.github.com/repos/apache/brpc/issues/1449","id":872665659,"node_id":"MDEyOklzc3VlQ29tbWVudDg3MjY2NTY1OQ==","user":{"login":"wwbmmm","id":3894631,"node_id":"MDQ6VXNlcjM4OTQ2MzE=","avatar_url":"https://avatars.githubusercontent.com/u/3894631?v=4","gravatar_id":"","url":"https://api.github.com/users/wwbmmm","html_url":"https://github.com/wwbmmm","followers_url":"https://api.github.com/users/wwbmmm/followers","following_url":"https://api.github.com/users/wwbmmm/following{/other_user}","gists_url":"https://api.github.com/users/wwbmmm/gists{/gist_id}","starred_url":"https://api.github.com/users/wwbmmm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wwbmmm/subscriptions","organizations_url":"https://api.github.com/users/wwbmmm/orgs","repos_url":"https://api.github.com/users/wwbmmm/repos","events_url":"https://api.github.com/users/wwbmmm/events{/privacy}","received_events_url":"https://api.github.com/users/wwbmmm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-02T02:24:16Z","updated_at":"2021-07-02T02:24:16Z","author_association":"CONTRIBUTOR","body":"I had encountered this problem before, finally I created a wrapper class that ensure calling bthread_getspecific before bthread_setspecific:\r\n\r\n```cpp\r\n\r\ntemplate<typename T>\r\nclass BThreadLocal {\r\n    public:\r\n        BThreadLocal() {\r\n            bthread_key_create(&m_key,\r\n                [](void* p) {  delete (T*)p; });\r\n        }\r\n\r\n        T* get() const { \r\n            return (T*)bthread_getspecific(m_key); \r\n        }\r\n\r\n        T* get_or_create() {\r\n            T *p = get();\r\n            if (p == nullptr) {\r\n                p = new T();\r\n                set(p);\r\n            }\r\n            return p;\r\n        }\r\n\r\n        T *operator->() {\r\n            return get_or_create();\r\n        }\r\n\r\n        T &operator*() {\r\n            return *get_or_create();\r\n        }\r\n\r\n    private:\r\n        // User can't call set(), that may cause memory leak\r\n        int set(T* p) {\r\n            return bthread_setspecific(m_key, p);\r\n        }\r\n\r\n        bthread_key_t m_key;\r\n};\r\n```\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/872665659/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/872784052","html_url":"https://github.com/apache/brpc/issues/1452#issuecomment-872784052","issue_url":"https://api.github.com/repos/apache/brpc/issues/1452","id":872784052,"node_id":"MDEyOklzc3VlQ29tbWVudDg3Mjc4NDA1Mg==","user":{"login":"h-zh-cn","id":46153728,"node_id":"MDQ6VXNlcjQ2MTUzNzI4","avatar_url":"https://avatars.githubusercontent.com/u/46153728?v=4","gravatar_id":"","url":"https://api.github.com/users/h-zh-cn","html_url":"https://github.com/h-zh-cn","followers_url":"https://api.github.com/users/h-zh-cn/followers","following_url":"https://api.github.com/users/h-zh-cn/following{/other_user}","gists_url":"https://api.github.com/users/h-zh-cn/gists{/gist_id}","starred_url":"https://api.github.com/users/h-zh-cn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/h-zh-cn/subscriptions","organizations_url":"https://api.github.com/users/h-zh-cn/orgs","repos_url":"https://api.github.com/users/h-zh-cn/repos","events_url":"https://api.github.com/users/h-zh-cn/events{/privacy}","received_events_url":"https://api.github.com/users/h-zh-cn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-02T07:29:11Z","updated_at":"2021-07-02T07:29:11Z","author_association":"NONE","body":"> Hi, thanks for your issue, but can you provide some detailed information about the apollo configuration?\r\n\r\nhttps://github.com/ctripcorp/apollo\r\n\r\nApollo is a reliable configuration management system. It can centrally manage the configurations of different applications and different clusters. It is suitable for microservice configuration management scenarios.\r\n\r\nThe server side is developed based on Spring Boot and Spring Cloud, which can simply run without the need to install additional application containers such as Tomcat.\r\n\r\n**But there isn't cpp SDK**","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/872784052/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/872788703","html_url":"https://github.com/apache/brpc/issues/1454#issuecomment-872788703","issue_url":"https://api.github.com/repos/apache/brpc/issues/1454","id":872788703,"node_id":"MDEyOklzc3VlQ29tbWVudDg3Mjc4ODcwMw==","user":{"login":"qqsun8819","id":1409644,"node_id":"MDQ6VXNlcjE0MDk2NDQ=","avatar_url":"https://avatars.githubusercontent.com/u/1409644?v=4","gravatar_id":"","url":"https://api.github.com/users/qqsun8819","html_url":"https://github.com/qqsun8819","followers_url":"https://api.github.com/users/qqsun8819/followers","following_url":"https://api.github.com/users/qqsun8819/following{/other_user}","gists_url":"https://api.github.com/users/qqsun8819/gists{/gist_id}","starred_url":"https://api.github.com/users/qqsun8819/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/qqsun8819/subscriptions","organizations_url":"https://api.github.com/users/qqsun8819/orgs","repos_url":"https://api.github.com/users/qqsun8819/repos","events_url":"https://api.github.com/users/qqsun8819/events{/privacy}","received_events_url":"https://api.github.com/users/qqsun8819/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-02T07:38:03Z","updated_at":"2021-07-02T07:38:03Z","author_association":"NONE","body":"@cdjingit  好的，细节有些多，我们可以线下沟通一下不。我的qq是815326512","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/872788703/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/872801059","html_url":"https://github.com/apache/brpc/issues/1453#issuecomment-872801059","issue_url":"https://api.github.com/repos/apache/brpc/issues/1453","id":872801059,"node_id":"MDEyOklzc3VlQ29tbWVudDg3MjgwMTA1OQ==","user":{"login":"bystorm","id":15179542,"node_id":"MDQ6VXNlcjE1MTc5NTQy","avatar_url":"https://avatars.githubusercontent.com/u/15179542?v=4","gravatar_id":"","url":"https://api.github.com/users/bystorm","html_url":"https://github.com/bystorm","followers_url":"https://api.github.com/users/bystorm/followers","following_url":"https://api.github.com/users/bystorm/following{/other_user}","gists_url":"https://api.github.com/users/bystorm/gists{/gist_id}","starred_url":"https://api.github.com/users/bystorm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bystorm/subscriptions","organizations_url":"https://api.github.com/users/bystorm/orgs","repos_url":"https://api.github.com/users/bystorm/repos","events_url":"https://api.github.com/users/bystorm/events{/privacy}","received_events_url":"https://api.github.com/users/bystorm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-02T08:00:35Z","updated_at":"2021-07-02T08:00:35Z","author_association":"NONE","body":"有计划把rdma何如到主干吗？","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/872801059/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/872977666","html_url":"https://github.com/apache/brpc/pull/1314#issuecomment-872977666","issue_url":"https://api.github.com/repos/apache/brpc/issues/1314","id":872977666,"node_id":"MDEyOklzc3VlQ29tbWVudDg3Mjk3NzY2Ng==","user":{"login":"serverglen","id":38067377,"node_id":"MDQ6VXNlcjM4MDY3Mzc3","avatar_url":"https://avatars.githubusercontent.com/u/38067377?v=4","gravatar_id":"","url":"https://api.github.com/users/serverglen","html_url":"https://github.com/serverglen","followers_url":"https://api.github.com/users/serverglen/followers","following_url":"https://api.github.com/users/serverglen/following{/other_user}","gists_url":"https://api.github.com/users/serverglen/gists{/gist_id}","starred_url":"https://api.github.com/users/serverglen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/serverglen/subscriptions","organizations_url":"https://api.github.com/users/serverglen/orgs","repos_url":"https://api.github.com/users/serverglen/repos","events_url":"https://api.github.com/users/serverglen/events{/privacy}","received_events_url":"https://api.github.com/users/serverglen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-02T12:57:56Z","updated_at":"2021-07-02T12:57:56Z","author_association":"CONTRIBUTOR","body":"> 1.可以简单描述一下这个需求吗，方便我们理解。\r\n> 3.为什么？\r\n\r\n辛苦各位大佬抽时间看下这个PR哈，wr负载均衡算法在百度内部已经上线并验证过了。多谢啦！\r\n@zyearn @chenzhangyi @jamesge ","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/872977666/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/872986678","html_url":"https://github.com/apache/brpc/issues/1444#issuecomment-872986678","issue_url":"https://api.github.com/repos/apache/brpc/issues/1444","id":872986678,"node_id":"MDEyOklzc3VlQ29tbWVudDg3Mjk4NjY3OA==","user":{"login":"serverglen","id":38067377,"node_id":"MDQ6VXNlcjM4MDY3Mzc3","avatar_url":"https://avatars.githubusercontent.com/u/38067377?v=4","gravatar_id":"","url":"https://api.github.com/users/serverglen","html_url":"https://github.com/serverglen","followers_url":"https://api.github.com/users/serverglen/followers","following_url":"https://api.github.com/users/serverglen/following{/other_user}","gists_url":"https://api.github.com/users/serverglen/gists{/gist_id}","starred_url":"https://api.github.com/users/serverglen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/serverglen/subscriptions","organizations_url":"https://api.github.com/users/serverglen/orgs","repos_url":"https://api.github.com/users/serverglen/repos","events_url":"https://api.github.com/users/serverglen/events{/privacy}","received_events_url":"https://api.github.com/users/serverglen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-02T13:11:06Z","updated_at":"2021-07-02T13:11:06Z","author_association":"CONTRIBUTOR","body":"> Hi @serverglen，如果已经有实现的话，是否可以提交上来呢\r\n\r\n@lorinlee 已提交 #1457 ","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/872986678/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/873123937","html_url":"https://github.com/apache/brpc/pull/1252#issuecomment-873123937","issue_url":"https://api.github.com/repos/apache/brpc/issues/1252","id":873123937,"node_id":"MDEyOklzc3VlQ29tbWVudDg3MzEyMzkzNw==","user":{"login":"serverglen","id":38067377,"node_id":"MDQ6VXNlcjM4MDY3Mzc3","avatar_url":"https://avatars.githubusercontent.com/u/38067377?v=4","gravatar_id":"","url":"https://api.github.com/users/serverglen","html_url":"https://github.com/serverglen","followers_url":"https://api.github.com/users/serverglen/followers","following_url":"https://api.github.com/users/serverglen/following{/other_user}","gists_url":"https://api.github.com/users/serverglen/gists{/gist_id}","starred_url":"https://api.github.com/users/serverglen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/serverglen/subscriptions","organizations_url":"https://api.github.com/users/serverglen/orgs","repos_url":"https://api.github.com/users/serverglen/repos","events_url":"https://api.github.com/users/serverglen/events{/privacy}","received_events_url":"https://api.github.com/users/serverglen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-02T16:38:16Z","updated_at":"2021-07-02T16:38:16Z","author_association":"CONTRIBUTOR","body":"> > 这个基于 https://github.com/apache/incubator-brpc/blob/master/src/butil/process_util.h 中的ReadCommandLine改更好一些，现在这么改也不支持Mac OS。可以在process_util.h中改为两个函数ReadCommandLine和ReadCommandName，返回值也可以都改成std::string方便使用，不用传buf\r\n> \r\n> 辛苦帮触发下重新构建（不太稳定），thanks\r\n@zyearn @chenzhangyi @jamesge 辛苦各位大佬帮看下哈，这个PR一年前在百度内部就已经合入了，也经过线上验证了的，thanks！","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/873123937/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/873747722","html_url":"https://github.com/apache/brpc/issues/1454#issuecomment-873747722","issue_url":"https://api.github.com/repos/apache/brpc/issues/1454","id":873747722,"node_id":"MDEyOklzc3VlQ29tbWVudDg3Mzc0NzcyMg==","user":{"login":"cool-colo","id":20718701,"node_id":"MDQ6VXNlcjIwNzE4NzAx","avatar_url":"https://avatars.githubusercontent.com/u/20718701?v=4","gravatar_id":"","url":"https://api.github.com/users/cool-colo","html_url":"https://github.com/cool-colo","followers_url":"https://api.github.com/users/cool-colo/followers","following_url":"https://api.github.com/users/cool-colo/following{/other_user}","gists_url":"https://api.github.com/users/cool-colo/gists{/gist_id}","starred_url":"https://api.github.com/users/cool-colo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cool-colo/subscriptions","organizations_url":"https://api.github.com/users/cool-colo/orgs","repos_url":"https://api.github.com/users/cool-colo/repos","events_url":"https://api.github.com/users/cool-colo/events{/privacy}","received_events_url":"https://api.github.com/users/cool-colo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-05T03:03:07Z","updated_at":"2021-07-05T03:03:07Z","author_association":"NONE","body":"> @cdjingit 好的，细节有些多，我们可以线下沟通一下不。我的qq是815326512\r\n\r\n求patch啊， 我们也有这样的需求。 顺便提一下，protobuf3.15以上版本，又把optional和has_xxx加回来了。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/873747722/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/873757814","html_url":"https://github.com/apache/brpc/issues/1458#issuecomment-873757814","issue_url":"https://api.github.com/repos/apache/brpc/issues/1458","id":873757814,"node_id":"MDEyOklzc3VlQ29tbWVudDg3Mzc1NzgxNA==","user":{"login":"lorinlee","id":16054841,"node_id":"MDQ6VXNlcjE2MDU0ODQx","avatar_url":"https://avatars.githubusercontent.com/u/16054841?v=4","gravatar_id":"","url":"https://api.github.com/users/lorinlee","html_url":"https://github.com/lorinlee","followers_url":"https://api.github.com/users/lorinlee/followers","following_url":"https://api.github.com/users/lorinlee/following{/other_user}","gists_url":"https://api.github.com/users/lorinlee/gists{/gist_id}","starred_url":"https://api.github.com/users/lorinlee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lorinlee/subscriptions","organizations_url":"https://api.github.com/users/lorinlee/orgs","repos_url":"https://api.github.com/users/lorinlee/repos","events_url":"https://api.github.com/users/lorinlee/events{/privacy}","received_events_url":"https://api.github.com/users/lorinlee/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-05T03:30:41Z","updated_at":"2021-07-05T03:30:41Z","author_association":"CONTRIBUTOR","body":"merged, thanks!","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/873757814/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/873761594","html_url":"https://github.com/apache/brpc/issues/1454#issuecomment-873761594","issue_url":"https://api.github.com/repos/apache/brpc/issues/1454","id":873761594,"node_id":"MDEyOklzc3VlQ29tbWVudDg3Mzc2MTU5NA==","user":{"login":"cdjingit","id":31362185,"node_id":"MDQ6VXNlcjMxMzYyMTg1","avatar_url":"https://avatars.githubusercontent.com/u/31362185?v=4","gravatar_id":"","url":"https://api.github.com/users/cdjingit","html_url":"https://github.com/cdjingit","followers_url":"https://api.github.com/users/cdjingit/followers","following_url":"https://api.github.com/users/cdjingit/following{/other_user}","gists_url":"https://api.github.com/users/cdjingit/gists{/gist_id}","starred_url":"https://api.github.com/users/cdjingit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cdjingit/subscriptions","organizations_url":"https://api.github.com/users/cdjingit/orgs","repos_url":"https://api.github.com/users/cdjingit/repos","events_url":"https://api.github.com/users/cdjingit/events{/privacy}","received_events_url":"https://api.github.com/users/cdjingit/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-05T03:45:06Z","updated_at":"2021-07-05T03:45:06Z","author_association":"CONTRIBUTOR","body":"> @cdjingit 好的，细节有些多，我们可以线下沟通一下不。我的qq是815326512\r\n\r\n加我微信吧mojie865805","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/873761594/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/873823514","html_url":"https://github.com/apache/brpc/issues/1450#issuecomment-873823514","issue_url":"https://api.github.com/repos/apache/brpc/issues/1450","id":873823514,"node_id":"MDEyOklzc3VlQ29tbWVudDg3MzgyMzUxNA==","user":{"login":"jameseatorange","id":76277223,"node_id":"MDQ6VXNlcjc2Mjc3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/76277223?v=4","gravatar_id":"","url":"https://api.github.com/users/jameseatorange","html_url":"https://github.com/jameseatorange","followers_url":"https://api.github.com/users/jameseatorange/followers","following_url":"https://api.github.com/users/jameseatorange/following{/other_user}","gists_url":"https://api.github.com/users/jameseatorange/gists{/gist_id}","starred_url":"https://api.github.com/users/jameseatorange/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jameseatorange/subscriptions","organizations_url":"https://api.github.com/users/jameseatorange/orgs","repos_url":"https://api.github.com/users/jameseatorange/repos","events_url":"https://api.github.com/users/jameseatorange/events{/privacy}","received_events_url":"https://api.github.com/users/jameseatorange/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-05T05:56:04Z","updated_at":"2021-07-05T05:56:04Z","author_association":"NONE","body":"> 是的，可以提 PR 修一下哈\r\n\r\n好，我周末有空提个 PR","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/873823514/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]