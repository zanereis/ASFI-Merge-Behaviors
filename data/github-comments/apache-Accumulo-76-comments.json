[{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/959342501","html_url":"https://github.com/apache/accumulo/pull/2340#issuecomment-959342501","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2340","id":959342501,"node_id":"IC_kwDOACaFSM45Lmel","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-03T14:57:48Z","updated_at":"2021-11-03T14:57:48Z","author_association":"CONTRIBUTOR","body":">Regarding the BulkImport code above, I believe that in this case an Error would be handled by the AccumuloUncaughtExceptionHandler as this catches Exception, not Error, and the executor that is being used to run the CompletableFuture is being created by ThreadPools.\r\n\r\nWhen dealing with futures in Java, Java will take your runnable, supplier,caller, etc and wrap it with one of the following before queueing it on the executor.  That code catches throwable before the executor can ever see it.\r\n\r\n\r\nhttps://github.com/openjdk/jdk/blob/jdk-11%2B28/src/java.base/share/classes/java/util/concurrent/CompletableFuture.java#L1683-L1708\r\n\r\nhttps://github.com/openjdk/jdk/blob/da75f3c4ad5bdf25167a3ed80e51f567ab3dbd01/src/java.base/share/classes/java/util/concurrent/FutureTask.java#L263-L270\r\n\r\n\r\n>> If the goal of this change is to make it so that Accumulo client code never has to catch Error\r\n>\r\n> This change is to implement your suggestion in #2331 where you said:\r\n>\r\n>> I am not sure its appropriate for this particular case but one thing to consider in general from an API perspective is letting \r\n>> users pass in ExecutorServices and Thread Factories.\r\n\r\nYeah I realize that and I was uncertain about the potential solution then and I am still uncertain about it.  This PR has helped me think about it more deeply and see nuances that I was not aware of before.  Like before this PR I never realized how complex the ThreadPoolCreation process was and I thought a thread pool factory might be a simple solution to the problem.  Also while looking at this PR, I was thinking about instrumentation vs creation.\r\n\r\nHere is the instrumentation idea that I thought of and am also very uncertain about wether its a good solution. Instead of thread pool factory we could create thread pools in Accumulo client code and provide a user mechanism to instrument those thread pools like the following.\r\n\r\n```java\r\ninterface AccumuloClientInstrumentation {\r\n   ThreadPoolExecutor instrument(ThreadPoolExecutor tpe);\r\n   ScheduledThreadPoolExecutor instrument(ScheduledThreadPoolExecutor tpe);\r\n}\r\n```\r\n\r\n```java\r\nclass AccumuloClient {\r\n    /**\r\n     * When the following is set, Accumulo will call the instrumentation object whenever it creates any object that can be instrumented by the interface.\r\n     */\r\n    void enableInstrumentation(AccumuloClientInstrumentation aci);\r\n\r\n}\r\n```\r\n\r\nThe thing I don't like about this is that it seems  like it could break accumulo, maybe that is ok though.  Also seems like it could be tricky to use correctly like the thread pool factory concept.  I would not know if its workable/good w/o trying it like this PR is trying to thread pool factories.\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/959342501/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/959379417","html_url":"https://github.com/apache/accumulo/pull/2340#issuecomment-959379417","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2340","id":959379417,"node_id":"IC_kwDOACaFSM45LvfZ","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-03T15:08:31Z","updated_at":"2021-11-03T15:14:29Z","author_association":"CONTRIBUTOR","body":"Thanks for the clarification, I missed that CompletableFuture was catching Throwable. In that case, I would say that the BulkImport code is incorrect then. In the code section you [referenced](https://github.com/apache/accumulo/blob/785a3645261571f000a7adb3c7c72b07886f0587/core/src/main/java/org/apache/accumulo/core/clientImpl/bulk/BulkImport.java#L577-L579) should it not get the cause and throw it if it's an Error?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/959379417/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/959484271","html_url":"https://github.com/apache/accumulo/pull/2340#issuecomment-959484271","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2340","id":959484271,"node_id":"IC_kwDOACaFSM45MJFv","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-03T15:39:27Z","updated_at":"2021-11-03T15:39:27Z","author_association":"CONTRIBUTOR","body":">  In the code section you referenced should it not get the cause and throw it if it's an Error?\r\n\r\nWould not want to get the cause and the drop the ExecutionException.  The cause only has a stack trace for the background thread.  The stack trace in the ExecutionException usually provides the path from the user code to the point where something was put on a thread pool. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/959484271/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/959775697","html_url":"https://github.com/apache/accumulo/pull/2342#issuecomment-959775697","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2342","id":959775697,"node_id":"IC_kwDOACaFSM45NQPR","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-03T17:48:02Z","updated_at":"2021-11-03T17:48:02Z","author_association":"CONTRIBUTOR","body":"My last updates change the methods to return an `Optional<StoredTabletFile>` to indicate whether the file was written to metadata or not. This should prevent any future coding errors with that object being null. I also rewrote the IT to check this behavior since I don't think we have any tests like that yet. I don't think it is a critical test but it only takes ~20 seconds to run on my machine.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/959775697/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/959817323","html_url":"https://github.com/apache/accumulo/pull/2340#issuecomment-959817323","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2340","id":959817323,"node_id":"IC_kwDOACaFSM45NaZr","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-03T18:41:05Z","updated_at":"2021-11-03T18:55:16Z","author_association":"CONTRIBUTOR","body":"What are your thoughts about using [CompletableFuture.completeExceptionally​(Throwable ex)](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/CompletableFuture.html#completeExceptionally(java.lang.Throwable))  instead of doing:\r\n\r\n```\r\n   } catch (Exception e) { \r\n     throw new CompletionException(e); \r\n   } \r\n```\r\n\r\nEdit: Nevermind - looks like they both end up doing the same thing.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/959817323/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/959981251","html_url":"https://github.com/apache/accumulo/pull/2345#issuecomment-959981251","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2345","id":959981251,"node_id":"IC_kwDOACaFSM45OCbD","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-03T20:32:19Z","updated_at":"2021-11-03T20:32:19Z","author_association":"MEMBER","body":"As is stands, this currently only accepts a JSON used to configure `planner.opts.executors`. I wanted to put up a PR to elicit suggestions while I'm working. I'm planning to add test cases to cover all the errors that are tested for by this tool.\r\n\r\nI wanted to get input on:\r\n* What other verification should be done?\r\n* Should this tool only accept a JSON string as input? (or should should it accept a whole config file or something else?)","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/959981251/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/959990728","html_url":"https://github.com/apache/accumulo/issues/2341#issuecomment-959990728","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2341","id":959990728,"node_id":"IC_kwDOACaFSM45OEvI","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-03T20:36:35Z","updated_at":"2021-11-03T20:36:35Z","author_association":"CONTRIBUTOR","body":"@keith-ratcliffe do you know if you may have different version of iterators on your classpath? Maybe try -verbose:class to see what jar the iterators are being loaded from. I can't seem to reproduce this using an example jar from 2.0 and Uno running 2.1. I found a similar class in the examples repo, `ChunkCombiner` that extends SKVI and does a deepCopy on its source. This class gets loaded from a separate examples jar but its parent class gets loaded from a 2.1 jar:\r\n\r\n<pre>\r\ntserver_ip-10-113-12-25.out:[1287.552s][info][class,load  ] org.apache.accumulo.examples.filedata.ChunkCombiner source: file:/home/mike/workspace/uno/install/accumulo-2.1.0-SNAPSHOT/lib/accumulo-examples.jar\r\ntserver_ip-10-113-12-25.out:[28.990s][info][class,load] org.apache.accumulo.core.iterators.SortedMapIterator source: file:/home/mike/workspace/uno/install/accumulo-2.1.0-SNAPSHOT/lib/accumulo-core-2.1.0-SNAPSHOT.jar\r\n</pre>\r\n\r\nI even added some debugging to see that the iterator was initialized and did the deepCopy on the same source iterator:\r\n<pre>\r\n2021-11-03T16:28:11,379 [conf.IterConfigUtil] INFO : DUDE convertIters source: class org.apache.accumulo.core.iteratorsImpl.system.ColumnFamilySkippingIterator settings: []\r\n2021-11-03T16:28:11,379 [filedata.ChunkCombiner] INFO : DUDE call init. deepCopy on class org.apache.accumulo.core.iteratorsImpl.system.ColumnFamilySkippingIterator\r\n</pre>","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/959990728/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/960007378","html_url":"https://github.com/apache/accumulo/pull/2340#issuecomment-960007378","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2340","id":960007378,"node_id":"IC_kwDOACaFSM45OIzS","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-03T20:42:56Z","updated_at":"2021-11-03T20:42:56Z","author_association":"CONTRIBUTOR","body":"@ctubbsii @keith-turner  - I'm thinking about getting rid of the client supplied thread pools idea. Without that, this PR contains:\r\n 1. Modifying the AccumuloUncaughtExceptionHandler to not halt the VM when not running in an Accumulo server process\r\n 2. Use of CleanerUtil on all client side thread pools\r\n 3. Propagation of Error in background tasks/threads to the client","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/960007378/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/960105994","html_url":"https://github.com/apache/accumulo/issues/2341#issuecomment-960105994","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2341","id":960105994,"node_id":"IC_kwDOACaFSM45Og4K","user":{"login":"keith-ratcliffe","id":1606834,"node_id":"MDQ6VXNlcjE2MDY4MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/1606834?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-ratcliffe","html_url":"https://github.com/keith-ratcliffe","followers_url":"https://api.github.com/users/keith-ratcliffe/followers","following_url":"https://api.github.com/users/keith-ratcliffe/following{/other_user}","gists_url":"https://api.github.com/users/keith-ratcliffe/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-ratcliffe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-ratcliffe/subscriptions","organizations_url":"https://api.github.com/users/keith-ratcliffe/orgs","repos_url":"https://api.github.com/users/keith-ratcliffe/repos","events_url":"https://api.github.com/users/keith-ratcliffe/events{/privacy}","received_events_url":"https://api.github.com/users/keith-ratcliffe/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-03T21:25:39Z","updated_at":"2021-11-03T21:25:39Z","author_association":"CONTRIBUTOR","body":"> @keith-ratcliffe do you know if you may have different version of iterators on your classpath? ...\r\n\r\nAs far as Accumulo iterators, I only have the 2.1.0-SNAPSHOT versions on the classpath. In the deepCopy example you ran, did the code path include `LocalityGroupIterator`? Seems like that's one of the few, if not only, ways to trigger that explicit cast on deepCopy\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/960105994/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/960106478","html_url":"https://github.com/apache/accumulo/pull/2345#issuecomment-960106478","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2345","id":960106478,"node_id":"IC_kwDOACaFSM45Og_u","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-03T21:25:52Z","updated_at":"2021-11-03T21:25:52Z","author_association":"CONTRIBUTOR","body":"Others might have ideas but my use case was a command to run to prevent deployment errors that could be checked ahead of time. One possibility is to pass a properties file to the command. Another option could be to pass a property to check in the current running configuration. When a user sets a property with JSON in the shell it is very prone to errors so any way to avoid that as well would be great. I am just throwing some ideas out there since I didn't have specific requirements but I think you are on the right track. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/960106478/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/960121473","html_url":"https://github.com/apache/accumulo/issues/2341#issuecomment-960121473","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2341","id":960121473,"node_id":"IC_kwDOACaFSM45OkqB","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-03T21:32:55Z","updated_at":"2021-11-03T21:32:55Z","author_association":"CONTRIBUTOR","body":"> > @keith-ratcliffe do you know if you may have different version of iterators on your classpath? ...\r\n> \r\n> As far as Accumulo iterators, I only have the 2.1.0-SNAPSHOT versions on the classpath. In the deepCopy example you ran, did the code path include `LocalityGroupIterator`? Seems like that's one of the few, if not only, ways to trigger that explicit cast on deepCopy\r\n\r\nI don't think so. I will try again with locality groups and see if I can print the whole iterator runtime stack as well.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/960121473/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/960280862","html_url":"https://github.com/apache/accumulo/issues/2341#issuecomment-960280862","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2341","id":960280862,"node_id":"IC_kwDOACaFSM45PLke","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-03T23:11:24Z","updated_at":"2021-11-03T23:11:24Z","author_association":"CONTRIBUTOR","body":"> > @keith-ratcliffe do you know if you may have different version of iterators on your classpath? ...\r\n> \r\n> As far as Accumulo iterators, I only have the 2.1.0-SNAPSHOT versions on the classpath. In the deepCopy example you ran, did the code path include `LocalityGroupIterator`? Seems like that's one of the few, if not only, ways to trigger that explicit cast on deepCopy\r\n\r\nActually, I am not sure that matters. The `FileCompactor` will call the method even without any locality groups setup. Here is the part of the code in `compactLocalityGroup()` that creates the `ColumnFamilySkippingIterator` and then loads the configured iterators:\r\nhttps://github.com/apache/accumulo/blob/146b1d3d0dc2ade6f1888c9905d83e37d98aedbe/server/base/src/main/java/org/apache/accumulo/server/compaction/FileCompactor.java#L351-L359\r\n\r\nAnd here is the only place that method gets called. It will get called at least once (or once for each LG + 1):\r\nhttps://github.com/apache/accumulo/blob/146b1d3d0dc2ade6f1888c9905d83e37d98aedbe/server/base/src/main/java/org/apache/accumulo/server/compaction/FileCompactor.java#L219-L228","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/960280862/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/960289597","html_url":"https://github.com/apache/accumulo/issues/2341#issuecomment-960289597","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2341","id":960289597,"node_id":"IC_kwDOACaFSM45PNs9","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-03T23:22:05Z","updated_at":"2021-11-03T23:22:05Z","author_association":"CONTRIBUTOR","body":"Disregard my last comment. I see what you are talking about now. The problem could be with the cast in LocalityGroupIterator here:\r\nhttps://github.com/apache/accumulo/blob/6a74b4667e3bd33e34b5262c5dd8ea64167fb657/core/src/main/java/org/apache/accumulo/core/iteratorsImpl/system/LocalityGroupIterator.java#L48\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/960289597/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/960358617","html_url":"https://github.com/apache/accumulo/issues/2341#issuecomment-960358617","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2341","id":960358617,"node_id":"IC_kwDOACaFSM45PejZ","user":{"login":"keith-ratcliffe","id":1606834,"node_id":"MDQ6VXNlcjE2MDY4MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/1606834?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-ratcliffe","html_url":"https://github.com/keith-ratcliffe","followers_url":"https://api.github.com/users/keith-ratcliffe/followers","following_url":"https://api.github.com/users/keith-ratcliffe/following{/other_user}","gists_url":"https://api.github.com/users/keith-ratcliffe/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-ratcliffe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-ratcliffe/subscriptions","organizations_url":"https://api.github.com/users/keith-ratcliffe/orgs","repos_url":"https://api.github.com/users/keith-ratcliffe/repos","events_url":"https://api.github.com/users/keith-ratcliffe/events{/privacy}","received_events_url":"https://api.github.com/users/keith-ratcliffe/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T01:23:07Z","updated_at":"2021-11-04T01:23:07Z","author_association":"CONTRIBUTOR","body":"> Disregard my last comment. I see what you are talking about now. The problem could be with the cast in LocalityGroupIterator here:\r\n> \r\n> https://github.com/apache/accumulo/blob/6a74b4667e3bd33e34b5262c5dd8ea64167fb657/core/src/main/java/org/apache/accumulo/core/iteratorsImpl/system/LocalityGroupIterator.java#L48\r\n\r\nYep. Substituting in a new system-level subclass of SortedMapIterator, maybe “InterruptibleSortedMapIterator”, could do the trick, if reverting the change to the original class isn’t desired ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/960358617/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/961029453","html_url":"https://github.com/apache/accumulo/pull/2345#issuecomment-961029453","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2345","id":961029453,"node_id":"IC_kwDOACaFSM45SCVN","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T14:17:19Z","updated_at":"2021-11-04T14:17:19Z","author_association":"MEMBER","body":"> One possibility is to pass a properties file to the command\r\n\r\nThat's what I was thinking originally. I'll go ahead and try that.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/961029453/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/961035548","html_url":"https://github.com/apache/accumulo/pull/2340#issuecomment-961035548","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2340","id":961035548,"node_id":"IC_kwDOACaFSM45SD0c","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T14:20:10Z","updated_at":"2021-11-04T14:20:10Z","author_association":"CONTRIBUTOR","body":"Closing, will resubmit a new PR","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/961035548/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/961067347","html_url":"https://github.com/apache/accumulo/issues/2341#issuecomment-961067347","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2341","id":961067347,"node_id":"IC_kwDOACaFSM45SLlT","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T14:35:21Z","updated_at":"2021-11-04T14:35:21Z","author_association":"CONTRIBUTOR","body":"OK I finally was able to reproduce it locally using Uno and ChunkCombiner from examples. It is a bit of a pain to reproduce since it is a very specific situation but a good find either way. To add another layer to this bug, I also noticed testing that it depends on whether native map is used or not.\r\n\r\nNatvie map iterator has no problem loading:\r\n<pre>\r\n2021-11-04T10:04:53,287 [system.LocalityGroupIterator] INFO : DUDE about to cast for lg org.apache.accumulo.core.iteratorsImpl.system.LocalityGroupIterator$LocalityGroup@9abcd34 lg.iter = class org.apache.accumulo.tserver.NativeMap$NMSKVIter\r\n</pre>\r\nBut when not using them, you get the cast exception.\r\n<pre>\r\n2021-11-04T09:00:59,228 [system.LocalityGroupIterator] INFO : DUDE about to cast for lg org.apache.accumulo.core.iteratorsImpl.system.LocalityGroupIterator$LocalityGroup@75d0c58f lg.iter = class org.apache.accumulo.core.iteratorsImpl.system.InterruptibleMapIterator\r\n2021-11-04T09:00:59,228 [compaction.FileCompactor] ERROR: class org.apache.accumulo.core.iterators.SortedMapIterator cannot be cast to class org.apache.accumulo.core.iteratorsImpl.system.InterruptibleIterator (org.apache.accumulo.core.iterators.SortedMapIterator and org.apache.accumulo.core.iteratorsImpl.system.InterruptibleIterator are in unnamed module of loader 'app')\r\n</pre>","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/961067347/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/961186745","html_url":"https://github.com/apache/accumulo/pull/2342#issuecomment-961186745","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2342","id":961186745,"node_id":"IC_kwDOACaFSM45Sou5","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T16:03:31Z","updated_at":"2021-11-04T16:03:31Z","author_association":"CONTRIBUTOR","body":"> So overall I think this change is good. I haven't run into any issues while testing but I also haven't been able to reproduce the issue against main so I have only been able to go off of the results of your test for validation.\r\n\r\nI think the only thing you will see is a stacktrace in the log of the NPE. Assuming it doesn't lead to issues with new compactable code, everything else should work as expected.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/961186745/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/961217575","html_url":"https://github.com/apache/accumulo/pull/2342#issuecomment-961217575","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2342","id":961217575,"node_id":"IC_kwDOACaFSM45SwQn","user":{"login":"Manno15","id":29436247,"node_id":"MDQ6VXNlcjI5NDM2MjQ3","avatar_url":"https://avatars.githubusercontent.com/u/29436247?v=4","gravatar_id":"","url":"https://api.github.com/users/Manno15","html_url":"https://github.com/Manno15","followers_url":"https://api.github.com/users/Manno15/followers","following_url":"https://api.github.com/users/Manno15/following{/other_user}","gists_url":"https://api.github.com/users/Manno15/gists{/gist_id}","starred_url":"https://api.github.com/users/Manno15/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Manno15/subscriptions","organizations_url":"https://api.github.com/users/Manno15/orgs","repos_url":"https://api.github.com/users/Manno15/repos","events_url":"https://api.github.com/users/Manno15/events{/privacy}","received_events_url":"https://api.github.com/users/Manno15/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T16:36:54Z","updated_at":"2021-11-04T16:36:54Z","author_association":"CONTRIBUTOR","body":"> I think the only thing you will see is a stacktrace in the log of the NPE. Assuming it doesn't lead to issues with new compactable code, everything else should work as expected.\r\n\r\nI apparently forgot to read the iterator part of the ticket. I was able to reproduce the error now. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/961217575/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/961297031","html_url":"https://github.com/apache/accumulo/pull/2325#issuecomment-961297031","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2325","id":961297031,"node_id":"IC_kwDOACaFSM45TDqH","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T18:12:48Z","updated_at":"2021-11-04T18:12:48Z","author_association":"CONTRIBUTOR","body":"Closing since I don't think we want to do this revert.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/961297031/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/961338048","html_url":"https://github.com/apache/accumulo/pull/2342#issuecomment-961338048","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2342","id":961338048,"node_id":"IC_kwDOACaFSM45TNrA","user":{"login":"Manno15","id":29436247,"node_id":"MDQ6VXNlcjI5NDM2MjQ3","avatar_url":"https://avatars.githubusercontent.com/u/29436247?v=4","gravatar_id":"","url":"https://api.github.com/users/Manno15","html_url":"https://github.com/Manno15","followers_url":"https://api.github.com/users/Manno15/followers","following_url":"https://api.github.com/users/Manno15/following{/other_user}","gists_url":"https://api.github.com/users/Manno15/gists{/gist_id}","starred_url":"https://api.github.com/users/Manno15/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Manno15/subscriptions","organizations_url":"https://api.github.com/users/Manno15/orgs","repos_url":"https://api.github.com/users/Manno15/repos","events_url":"https://api.github.com/users/Manno15/events{/privacy}","received_events_url":"https://api.github.com/users/Manno15/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T19:08:33Z","updated_at":"2021-11-04T19:08:33Z","author_association":"CONTRIBUTOR","body":"These changes do fix the error though the logging is still confusing. The tserver logs still show the flush going through like there was no issue. While ingesting data I can see the entries being increases in the monitor but then they will eventually be removed and then will go back to 1 entry after a flush. Should there be additional logging to track what is going on otherwise the results are still kind of confusing?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/961338048/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/961343950","html_url":"https://github.com/apache/accumulo/issues/2343#issuecomment-961343950","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2343","id":961343950,"node_id":"IC_kwDOACaFSM45TPHO","user":{"login":"mjwall","id":2342,"node_id":"MDQ6VXNlcjIzNDI=","avatar_url":"https://avatars.githubusercontent.com/u/2342?v=4","gravatar_id":"","url":"https://api.github.com/users/mjwall","html_url":"https://github.com/mjwall","followers_url":"https://api.github.com/users/mjwall/followers","following_url":"https://api.github.com/users/mjwall/following{/other_user}","gists_url":"https://api.github.com/users/mjwall/gists{/gist_id}","starred_url":"https://api.github.com/users/mjwall/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mjwall/subscriptions","organizations_url":"https://api.github.com/users/mjwall/orgs","repos_url":"https://api.github.com/users/mjwall/repos","events_url":"https://api.github.com/users/mjwall/events{/privacy}","received_events_url":"https://api.github.com/users/mjwall/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T19:16:49Z","updated_at":"2021-11-04T19:16:49Z","author_association":"MEMBER","body":"> ```shell\r\n> while mvn clean process-test-classes surefire:test -pl start,core -Dtest=RFileTest -Dformatter.skip -Dimpsort.skip -Denforcer.skip -Dassembly.skip -Dsort.skip -Drat.skip -Dwarbucks.skip -Dmodernizer.skip -Dlicense.skip -Dremoteresources.skip; do true; done\r\n> ```\r\n\r\nthis would not catch the failure since it is only running the RFileTest","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/961343950/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/961358442","html_url":"https://github.com/apache/accumulo/pull/2342#issuecomment-961358442","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2342","id":961358442,"node_id":"IC_kwDOACaFSM45TSpq","user":{"login":"EdColeman","id":7047700,"node_id":"MDQ6VXNlcjcwNDc3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/7047700?v=4","gravatar_id":"","url":"https://api.github.com/users/EdColeman","html_url":"https://github.com/EdColeman","followers_url":"https://api.github.com/users/EdColeman/followers","following_url":"https://api.github.com/users/EdColeman/following{/other_user}","gists_url":"https://api.github.com/users/EdColeman/gists{/gist_id}","starred_url":"https://api.github.com/users/EdColeman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdColeman/subscriptions","organizations_url":"https://api.github.com/users/EdColeman/orgs","repos_url":"https://api.github.com/users/EdColeman/repos","events_url":"https://api.github.com/users/EdColeman/events{/privacy}","received_events_url":"https://api.github.com/users/EdColeman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T19:38:30Z","updated_at":"2021-11-04T19:38:30Z","author_association":"CONTRIBUTOR","body":"Just curious - what level is the of logging that you are seeing?  Additional logging at debug or higher could be noisy so systems that are running C.I. and end up with a lot of flushing.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/961358442/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/961367417","html_url":"https://github.com/apache/accumulo/pull/2342#issuecomment-961367417","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2342","id":961367417,"node_id":"IC_kwDOACaFSM45TU15","user":{"login":"Manno15","id":29436247,"node_id":"MDQ6VXNlcjI5NDM2MjQ3","avatar_url":"https://avatars.githubusercontent.com/u/29436247?v=4","gravatar_id":"","url":"https://api.github.com/users/Manno15","html_url":"https://github.com/Manno15","followers_url":"https://api.github.com/users/Manno15/followers","following_url":"https://api.github.com/users/Manno15/following{/other_user}","gists_url":"https://api.github.com/users/Manno15/gists{/gist_id}","starred_url":"https://api.github.com/users/Manno15/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Manno15/subscriptions","organizations_url":"https://api.github.com/users/Manno15/orgs","repos_url":"https://api.github.com/users/Manno15/repos","events_url":"https://api.github.com/users/Manno15/events{/privacy}","received_events_url":"https://api.github.com/users/Manno15/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T19:52:01Z","updated_at":"2021-11-04T19:52:01Z","author_association":"CONTRIBUTOR","body":"> Just curious - what level is the of logging that you are seeing? Additional logging at debug or higher could be noisy so systems that are running C.I. and end up with a lot of flushing.\r\n\r\nAt the debug level. I mostly mean in the instance that this failure would occur. Not necessarily every flush. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/961367417/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/961370699","html_url":"https://github.com/apache/accumulo/issues/2343#issuecomment-961370699","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2343","id":961370699,"node_id":"IC_kwDOACaFSM45TVpL","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T19:56:54Z","updated_at":"2021-11-04T19:56:54Z","author_association":"MEMBER","body":"> this would not catch the failure since it is only running the RFileTest\r\n\r\nYep. I figured that out later. This is why I couldn't reproduce it locally. Even running both tests couldn't reproduce it. I had to leave the tests unspecified, so that there was a greater chance of collision between the two tests, and that seemed to do the trick, after a few loops.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/961370699/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/961372137","html_url":"https://github.com/apache/accumulo/pull/2344#issuecomment-961372137","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2344","id":961372137,"node_id":"IC_kwDOACaFSM45TV_p","user":{"login":"mjwall","id":2342,"node_id":"MDQ6VXNlcjIzNDI=","avatar_url":"https://avatars.githubusercontent.com/u/2342?v=4","gravatar_id":"","url":"https://api.github.com/users/mjwall","html_url":"https://github.com/mjwall","followers_url":"https://api.github.com/users/mjwall/followers","following_url":"https://api.github.com/users/mjwall/following{/other_user}","gists_url":"https://api.github.com/users/mjwall/gists{/gist_id}","starred_url":"https://api.github.com/users/mjwall/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mjwall/subscriptions","organizations_url":"https://api.github.com/users/mjwall/orgs","repos_url":"https://api.github.com/users/mjwall/repos","events_url":"https://api.github.com/users/mjwall/events{/privacy}","received_events_url":"https://api.github.com/users/mjwall/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T19:59:01Z","updated_at":"2021-11-04T19:59:01Z","author_association":"MEMBER","body":"I was able to reproduce the error about 1 out of every 2 or 3 runs on a specific dev box with 16 cores.  Pulling in this patch, I ran the following for 30 mins on that box without a failure\r\n```\r\nmvn clean install -DskipTests\r\nwhile mvn test -pl core -Dformatter.skip -Dimpsort.skip -Denforcer.skip -Dassembly.skip -Dsort.skip -Drat.skip -Dwarbucks.skip -Dmodernizer.skip -Dlicense.skip -Dremoteresources.skip; do true; done\r\n```","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/961372137/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/961376735","html_url":"https://github.com/apache/accumulo/pull/2344#issuecomment-961376735","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2344","id":961376735,"node_id":"IC_kwDOACaFSM45TXHf","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T20:05:30Z","updated_at":"2021-11-04T20:05:30Z","author_association":"MEMBER","body":"> LGTM, I don't see how to approve a PR that has been merged, maybe I am missing it\r\n\r\nThat option goes away once it's merged. Your comment is sufficient. :smiley_cat:\r\nIf you had been able to reproduce it still after testing the merged PR, we'd have had to troubleshoot further or revert, but I tested for about 4 hours without seeing the failure again, so I had a high degree of confidence this was fixed and that wouldn't be necessary. That's why I went ahead and merged it.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/961376735/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/961378723","html_url":"https://github.com/apache/accumulo/pull/2344#issuecomment-961378723","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2344","id":961378723,"node_id":"IC_kwDOACaFSM45TXmj","user":{"login":"mjwall","id":2342,"node_id":"MDQ6VXNlcjIzNDI=","avatar_url":"https://avatars.githubusercontent.com/u/2342?v=4","gravatar_id":"","url":"https://api.github.com/users/mjwall","html_url":"https://github.com/mjwall","followers_url":"https://api.github.com/users/mjwall/followers","following_url":"https://api.github.com/users/mjwall/following{/other_user}","gists_url":"https://api.github.com/users/mjwall/gists{/gist_id}","starred_url":"https://api.github.com/users/mjwall/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mjwall/subscriptions","organizations_url":"https://api.github.com/users/mjwall/orgs","repos_url":"https://api.github.com/users/mjwall/repos","events_url":"https://api.github.com/users/mjwall/events{/privacy}","received_events_url":"https://api.github.com/users/mjwall/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T20:08:29Z","updated_at":"2021-11-04T20:08:29Z","author_association":"MEMBER","body":"> That option goes away once it's merged. Your comment is sufficient. smiley_cat If you had been able to reproduce it still after testing the merged PR, we'd have had to troubleshoot further or revert, but I tested for about 4 hours without seeing the failure again, so I had a high degree of confidence this was fixed and that wouldn't be necessary. That's why I went ahead and merged it.\r\n\r\nSounds like you were able to reproduce it locally, which I missed from the threads.  Thanks for fixing it.\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/961378723/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/961404194","html_url":"https://github.com/apache/accumulo/pull/2344#issuecomment-961404194","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2344","id":961404194,"node_id":"IC_kwDOACaFSM45Td0i","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T20:44:34Z","updated_at":"2021-11-04T20:44:34Z","author_association":"MEMBER","body":"> Sounds like you were able to reproduce it locally, which I missed from the threads. Thanks for fixing it.\r\n\r\nYes. I may have forgotten to mention it earlier. No problem!","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/961404194/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/961963851","html_url":"https://github.com/apache/accumulo/pull/2347#issuecomment-961963851","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2347","id":961963851,"node_id":"IC_kwDOACaFSM45VmdL","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-05T14:58:23Z","updated_at":"2021-11-05T14:58:23Z","author_association":"CONTRIBUTOR","body":"@Manno15 @ctubbsii thanks for taking a look at this. I guess I should have been more explicit or made this a draft PR because a lot of the code in your feedback was just yanked from the examples repo, specifically the [ChunkCombiner](https://github.com/apache/accumulo-examples/blob/main/src/main/java/org/apache/accumulo/examples/filedata/ChunkCombiner.java) to try and simulate what Datawave is doing with iterators. I am not sure if I should clean it up or just stick it in a test jar so we don't have to look at it. \r\n\r\nDo either of you know how to get MiniAccumuloCluster to load classes from a jar during runtime? I thought it might be a better test to do that but couldn't get it working.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/961963851/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/962005773","html_url":"https://github.com/apache/accumulo/issues/2348#issuecomment-962005773","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2348","id":962005773,"node_id":"IC_kwDOACaFSM45VwsN","user":{"login":"EdColeman","id":7047700,"node_id":"MDQ6VXNlcjcwNDc3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/7047700?v=4","gravatar_id":"","url":"https://api.github.com/users/EdColeman","html_url":"https://github.com/EdColeman","followers_url":"https://api.github.com/users/EdColeman/followers","following_url":"https://api.github.com/users/EdColeman/following{/other_user}","gists_url":"https://api.github.com/users/EdColeman/gists{/gist_id}","starred_url":"https://api.github.com/users/EdColeman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdColeman/subscriptions","organizations_url":"https://api.github.com/users/EdColeman/orgs","repos_url":"https://api.github.com/users/EdColeman/repos","events_url":"https://api.github.com/users/EdColeman/events{/privacy}","received_events_url":"https://api.github.com/users/EdColeman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-05T15:47:29Z","updated_at":"2021-11-05T15:47:29Z","author_association":"CONTRIBUTOR","body":"With property store changes this test with either need to change or will be OBE.  I'll look at it when the prop store final PR is ready.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/962005773/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/962013768","html_url":"https://github.com/apache/accumulo/pull/2342#issuecomment-962013768","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2342","id":962013768,"node_id":"IC_kwDOACaFSM45VypI","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-05T15:57:35Z","updated_at":"2021-11-05T15:57:35Z","author_association":"CONTRIBUTOR","body":"> While ingesting data I can see the entries being increases in the monitor but then they will eventually be removed and then will go back to 1 entry after a flush.\r\n\r\nHow are you ingesting data? I don't think the number of entries ingested through bulk import show up the monitor. Also, if you have this null iterator (realistically an iterator that shouldn't be run) configured for minc then it will essentially drop your entries on a flush. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/962013768/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/962024655","html_url":"https://github.com/apache/accumulo/pull/2342#issuecomment-962024655","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2342","id":962024655,"node_id":"IC_kwDOACaFSM45V1TP","user":{"login":"Manno15","id":29436247,"node_id":"MDQ6VXNlcjI5NDM2MjQ3","avatar_url":"https://avatars.githubusercontent.com/u/29436247?v=4","gravatar_id":"","url":"https://api.github.com/users/Manno15","html_url":"https://github.com/Manno15","followers_url":"https://api.github.com/users/Manno15/followers","following_url":"https://api.github.com/users/Manno15/following{/other_user}","gists_url":"https://api.github.com/users/Manno15/gists{/gist_id}","starred_url":"https://api.github.com/users/Manno15/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Manno15/subscriptions","organizations_url":"https://api.github.com/users/Manno15/orgs","repos_url":"https://api.github.com/users/Manno15/repos","events_url":"https://api.github.com/users/Manno15/events{/privacy}","received_events_url":"https://api.github.com/users/Manno15/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-05T16:11:04Z","updated_at":"2021-11-05T16:12:05Z","author_association":"CONTRIBUTOR","body":"> How are you ingesting data? I don't think the number of entries ingested through bulk import show up the monitor.\r\n\r\nI just did a small amount of continuous ingest.\r\n\r\n> Also, if you have this null iterator (realistically an iterator that shouldn't be run) configured for minc then it will essentially drop your entries on a flush.\r\n\r\nYeah, I did realize that. I should have revised my previous comment to be more clear on the issue I was suggesting. That it is unclear in the logs that something like that is occurring. If a user misconfigures an iterator but doesn't realize it, they might have a tough time determining what is going on in their system. The monitor could show files being dropped while the logs show that the flush was completed fully. Though maybe something like that won't realistically occur. \r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/962024655/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/962028714","html_url":"https://github.com/apache/accumulo/pull/2342#issuecomment-962028714","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2342","id":962028714,"node_id":"IC_kwDOACaFSM45V2Sq","user":{"login":"EdColeman","id":7047700,"node_id":"MDQ6VXNlcjcwNDc3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/7047700?v=4","gravatar_id":"","url":"https://api.github.com/users/EdColeman","html_url":"https://github.com/EdColeman","followers_url":"https://api.github.com/users/EdColeman/followers","following_url":"https://api.github.com/users/EdColeman/following{/other_user}","gists_url":"https://api.github.com/users/EdColeman/gists{/gist_id}","starred_url":"https://api.github.com/users/EdColeman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdColeman/subscriptions","organizations_url":"https://api.github.com/users/EdColeman/orgs","repos_url":"https://api.github.com/users/EdColeman/repos","events_url":"https://api.github.com/users/EdColeman/events{/privacy}","received_events_url":"https://api.github.com/users/EdColeman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-05T16:16:10Z","updated_at":"2021-11-05T16:16:10Z","author_association":"CONTRIBUTOR","body":"> I don't think the number of entries ingested through bulk import show up the monitor. \r\n\r\nThe entities counts for bulk ingest should show up after a compaction - I believe the numbers are pulled from the metadata file colFam for example:\r\n\r\n> 3< file:/default_tablet/F000009y.rf []    186,1\r\n\r\nwould be 186 bytes with 1 entry.  On bulk import, the size is known, but the entity count is 0.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/962028714/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/962029662","html_url":"https://github.com/apache/accumulo/issues/2348#issuecomment-962029662","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2348","id":962029662,"node_id":"IC_kwDOACaFSM45V2he","user":{"login":"Manno15","id":29436247,"node_id":"MDQ6VXNlcjI5NDM2MjQ3","avatar_url":"https://avatars.githubusercontent.com/u/29436247?v=4","gravatar_id":"","url":"https://api.github.com/users/Manno15","html_url":"https://github.com/Manno15","followers_url":"https://api.github.com/users/Manno15/followers","following_url":"https://api.github.com/users/Manno15/following{/other_user}","gists_url":"https://api.github.com/users/Manno15/gists{/gist_id}","starred_url":"https://api.github.com/users/Manno15/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Manno15/subscriptions","organizations_url":"https://api.github.com/users/Manno15/orgs","repos_url":"https://api.github.com/users/Manno15/repos","events_url":"https://api.github.com/users/Manno15/events{/privacy}","received_events_url":"https://api.github.com/users/Manno15/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-05T16:17:23Z","updated_at":"2021-11-05T16:17:23Z","author_association":"CONTRIBUTOR","body":"> With property store changes this test with either need to change or will be OBE. I'll look at it when the prop store final PR is ready.\r\n\r\nI figured it would but I wanted to make sure it was documented. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/962029662/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/962086055","html_url":"https://github.com/apache/accumulo/pull/2342#issuecomment-962086055","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2342","id":962086055,"node_id":"IC_kwDOACaFSM45WESn","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-05T17:35:06Z","updated_at":"2021-11-05T17:35:06Z","author_association":"CONTRIBUTOR","body":"> If a user misconfigures an iterator but doesn't realize it, they might have a tough time determining what is going on in their system. \r\n\r\nThis has been a tricky part of iterators for some time. I think the accumulo-iterator-test-harness package was added many versions ago to help with debugging iterators but I don't know of anyone who really uses it.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/962086055/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/962091348","html_url":"https://github.com/apache/accumulo/pull/2342#issuecomment-962091348","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2342","id":962091348,"node_id":"IC_kwDOACaFSM45WFlU","user":{"login":"Manno15","id":29436247,"node_id":"MDQ6VXNlcjI5NDM2MjQ3","avatar_url":"https://avatars.githubusercontent.com/u/29436247?v=4","gravatar_id":"","url":"https://api.github.com/users/Manno15","html_url":"https://github.com/Manno15","followers_url":"https://api.github.com/users/Manno15/followers","following_url":"https://api.github.com/users/Manno15/following{/other_user}","gists_url":"https://api.github.com/users/Manno15/gists{/gist_id}","starred_url":"https://api.github.com/users/Manno15/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Manno15/subscriptions","organizations_url":"https://api.github.com/users/Manno15/orgs","repos_url":"https://api.github.com/users/Manno15/repos","events_url":"https://api.github.com/users/Manno15/events{/privacy}","received_events_url":"https://api.github.com/users/Manno15/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-05T17:43:06Z","updated_at":"2021-11-05T17:43:06Z","author_association":"CONTRIBUTOR","body":"> This has been a tricky part of iterators for some time. I think the accumulo-iterator-test-harness package was added many versions ago to help with debugging iterators but I don't know of anyone who really uses it.\r\n\r\nI haven't looked into it directly, but could a log message be added when entries get dropped during a flush or when the newFile is empty? ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/962091348/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/962097872","html_url":"https://github.com/apache/accumulo/pull/2342#issuecomment-962097872","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2342","id":962097872,"node_id":"IC_kwDOACaFSM45WHLQ","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-05T17:52:48Z","updated_at":"2021-11-05T17:52:48Z","author_association":"CONTRIBUTOR","body":"> I haven't looked into it directly, but could a log message be added when entries get dropped during a flush or when the newFile is empty?\r\n\r\nYeah it is probably worth putting a debug statement. I don't think it should be warn or error since it can happen under perfectly normal conditions. It is probably not high level enough to log at info either.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/962097872/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/962150941","html_url":"https://github.com/apache/accumulo/pull/2345#issuecomment-962150941","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2345","id":962150941,"node_id":"IC_kwDOACaFSM45WUId","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-05T19:14:55Z","updated_at":"2021-11-05T22:30:11Z","author_association":"MEMBER","body":"> One possibility is to pass a properties file to the command\r\n\r\nI implemented this in the latest commit.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/962150941/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/962165002","html_url":"https://github.com/apache/accumulo/pull/2347#issuecomment-962165002","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2347","id":962165002,"node_id":"IC_kwDOACaFSM45WXkK","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-05T19:32:59Z","updated_at":"2021-11-05T19:32:59Z","author_association":"CONTRIBUTOR","body":"@ctubbsii @Manno15 This PR changed significantly since your initial reviews. I moved the iterators back to the iteratorsImpl package, along with moving SortedMapIterator there. The more I thought about it, the less I liked including InterruptibleIterator in the public API. We created the `YieldingKeyValueIterator` interface with the intention of public use so we don't need InterruptibleIterator in the API. I also rewrote the IT to just use a simple iterator that will still cause the class cast exception to happen without the fix.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/962165002/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/963101097","html_url":"https://github.com/apache/accumulo/pull/2337#issuecomment-963101097","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2337","id":963101097,"node_id":"IC_kwDOACaFSM45Z8Gp","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-08T12:25:10Z","updated_at":"2021-11-08T12:25:10Z","author_association":"CONTRIBUTOR","body":"I submitted #2346 as a solution to this for 2.1.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/963101097/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/963173895","html_url":"https://github.com/apache/accumulo/pull/2318#issuecomment-963173895","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2318","id":963173895,"node_id":"IC_kwDOACaFSM45aN4H","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-08T13:57:28Z","updated_at":"2021-11-08T13:57:28Z","author_association":"CONTRIBUTOR","body":"I was able to test this with the page I am working on in the Monitor and I think it is good to go. The only thing I noticed that by having the Monitor make calls to the Compaction Coordinator, it introduces a Thrift dependency to the Monitor:\r\n<pre>\r\n[INFO] --- maven-dependency-plugin:3.1.2:analyze-only (analyze) @ accumulo-monitor ---\r\n[WARNING] Used undeclared dependencies found:\r\n[WARNING]    org.apache.thrift:libthrift:jar:0.15.0:compile\r\n</pre>\r\n\r\nI am OK with this. I was actually surprised there wasn't one already. I guess all the calls that go through the Manager don't require a direct dependency.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/963173895/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/963399290","html_url":"https://github.com/apache/accumulo/issues/2350#issuecomment-963399290","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2350","id":963399290,"node_id":"IC_kwDOACaFSM45bE56","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-08T17:37:14Z","updated_at":"2021-11-08T17:37:14Z","author_association":"CONTRIBUTOR","body":"Here is when the Manager deleted the table:\r\n<pre>\r\n2021-11-08T12:20:31,099 [tableOps.Utils] INFO : table 2 (dcd003ecac0a015) locked for read operation: DELETE\r\n2021-11-08T12:20:31,111 [cancel.CancelCompactions] DEBUG: FATE[0dcd003ecac0a015] setting cancel compaction id to 1 for 2\r\n2021-11-08T12:20:31,114 [zookeeper.DistributedReadWriteLock] DEBUG: Removing lock entry 0 userData 0dcd003ecac0a015 lockType READ\r\n2021-11-08T12:20:31,116 [tableOps.Utils] INFO : table 2 (dcd003ecac0a015) unlocked for read\r\n2021-11-08T12:20:31,117 [zookeeper.DistributedReadWriteLock] DEBUG: Removing lock entry 0 userData 0dcd003ecac0a015 lockType READ\r\n2021-11-08T12:20:31,121 [tableOps.Utils] INFO : namespace +default (dcd003ecac0a015) unlocked for read\r\n2021-11-08T12:20:31,133 [zookeeper.DistributedReadWriteLock] INFO : Added lock entry 0 userData 0dcd003ecac0a015 lockTpye READ\r\n2021-11-08T12:20:31,134 [tableOps.Utils] INFO : namespace +default (dcd003ecac0a015) locked for read operation: DELETE\r\n2021-11-08T12:20:31,138 [zookeeper.DistributedReadWriteLock] INFO : Added lock entry 0 userData 0dcd003ecac0a015 lockType WRITE\r\n2021-11-08T12:20:31,139 [tableOps.Utils] INFO : table 2 (dcd003ecac0a015) locked for write operation: DELETE\r\n2021-11-08T12:20:31,141 [tables.TableManager] DEBUG: Transitioning state for table 2 from ONLINE to DELETING\r\n2021-11-08T12:20:31,142 [manager.EventCoordinator] INFO : deleting table 2 \r\n2021-11-08T12:20:31,143 [tables.TableManager] DEBUG: State transition to DELETING @ WatchedEvent state:SyncConnected type:NodeDataChanged path:/accumulo/2ab5ddfb-44ff-4d37-9\r\n538-f16e7c37c5c3/tables/2/state\r\n2021-11-08T12:20:31,143 [manager.EventCoordinator] INFO : Table state in zookeeper changed for 2 to DELETING\r\n</pre>","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/963399290/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/963427095","html_url":"https://github.com/apache/accumulo/pull/2347#issuecomment-963427095","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2347","id":963427095,"node_id":"IC_kwDOACaFSM45bLsX","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-08T18:09:59Z","updated_at":"2021-11-08T18:09:59Z","author_association":"CONTRIBUTOR","body":"> Changes look good, I don't fully know the impact of the interuptible changes but I didn't run into any issues while testing. Confirmed that these changes to fix the reported issue.\r\n\r\nThanks for testing these changes. Just curious, how did you reproduce the issue?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/963427095/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/963430813","html_url":"https://github.com/apache/accumulo/pull/2347#issuecomment-963430813","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2347","id":963430813,"node_id":"IC_kwDOACaFSM45bMmd","user":{"login":"Manno15","id":29436247,"node_id":"MDQ6VXNlcjI5NDM2MjQ3","avatar_url":"https://avatars.githubusercontent.com/u/29436247?v=4","gravatar_id":"","url":"https://api.github.com/users/Manno15","html_url":"https://github.com/Manno15","followers_url":"https://api.github.com/users/Manno15/followers","following_url":"https://api.github.com/users/Manno15/following{/other_user}","gists_url":"https://api.github.com/users/Manno15/gists{/gist_id}","starred_url":"https://api.github.com/users/Manno15/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Manno15/subscriptions","organizations_url":"https://api.github.com/users/Manno15/orgs","repos_url":"https://api.github.com/users/Manno15/repos","events_url":"https://api.github.com/users/Manno15/events{/privacy}","received_events_url":"https://api.github.com/users/Manno15/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-08T18:14:23Z","updated_at":"2021-11-08T18:14:23Z","author_association":"CONTRIBUTOR","body":"> Thanks for testing these changes. Just curious, how did you reproduce the issue?\r\n\r\nUsing the IT you created. So maybe that isn't a definitive test but it did fail against main while working with the rest of these changes.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/963430813/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/963512600","html_url":"https://github.com/apache/accumulo/pull/2345#issuecomment-963512600","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2345","id":963512600,"node_id":"IC_kwDOACaFSM45bgkY","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-08T19:46:38Z","updated_at":"2021-11-09T14:18:34Z","author_association":"MEMBER","body":"The current changes accept a file as input then verify the contents of that file. It seems like there should be more verification of the properties (possibly verifying the planner is set correctly) but I'm not sure what else should be added. Suggestions are welcome.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/963512600/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/963513533","html_url":"https://github.com/apache/accumulo/pull/2318#issuecomment-963513533","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2318","id":963513533,"node_id":"IC_kwDOACaFSM45bgy9","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-08T19:47:46Z","updated_at":"2021-11-08T19:47:46Z","author_association":"MEMBER","body":"> I was able to test this with the page I am working on in the Monitor and I think it is good to go. The only thing I noticed that by having the Monitor make calls to the Compaction Coordinator, it introduces a Thrift dependency to the Monitor:\r\n> \r\n> [INFO] --- maven-dependency-plugin:3.1.2:analyze-only (analyze) @ accumulo-monitor ---\r\n> [WARNING] Used undeclared dependencies found:\r\n> [WARNING]    org.apache.thrift:libthrift:jar:0.15.0:compile\r\n> I am OK with this. I was actually surprised there wasn't one already. I guess all the calls that go through the Manager don't require a direct dependency.\r\n\r\nI can't reproduce that, so I'm assuming you're describing changes not included in this PR. In general, it's best to keep our Thrift types from leaking too far from the RPC layer. The monitor shouldn't interact with Thrift at all. It should interact with other service APIs, and those service APIs should not leak Thrift types, if at all possible.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/963513533/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/963548309","html_url":"https://github.com/apache/accumulo/pull/2318#issuecomment-963548309","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2318","id":963548309,"node_id":"IC_kwDOACaFSM45bpSV","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-08T20:31:32Z","updated_at":"2021-11-08T20:31:32Z","author_association":"CONTRIBUTOR","body":"> I can't reproduce that, so I'm assuming you're describing changes not included in this PR. \r\n\r\nYes. I am using `CompactionCoordinatorService.Client` to call the method `getRunningCompactions`. It returns multiple thrift types, TExternalCompactionList and TExternalCompaction.\r\n\r\n> The monitor shouldn't interact with Thrift at all. It should interact with other service APIs, and those service APIs should not leak Thrift types, if at all possible.\r\n\r\nI don't understand what you mean. I am also not sure how the Monitor doesn't already have this dependency. The Monitor currently uses thrift types like `ManagerMonitorInfo` and `ManagerClientService` a great deal.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/963548309/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/963577504","html_url":"https://github.com/apache/accumulo/pull/2346#issuecomment-963577504","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2346","id":963577504,"node_id":"IC_kwDOACaFSM45bwag","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-08T21:12:10Z","updated_at":"2021-11-08T21:12:10Z","author_association":"CONTRIBUTOR","body":"I will look at making changes for the comments where I did not respond.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/963577504/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/963577965","html_url":"https://github.com/apache/accumulo/pull/2346#issuecomment-963577965","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2346","id":963577965,"node_id":"IC_kwDOACaFSM45bwht","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-08T21:12:37Z","updated_at":"2021-11-08T21:12:37Z","author_association":"CONTRIBUTOR","body":"I will look at making changes for the comments where I did not respond.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/963577965/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/964119878","html_url":"https://github.com/apache/accumulo/pull/2259#issuecomment-964119878","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2259","id":964119878,"node_id":"IC_kwDOACaFSM45d01G","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-09T12:47:29Z","updated_at":"2021-11-09T12:47:29Z","author_association":"CONTRIBUTOR","body":"@ctubbsii  - Did you resolve some/all of the issues raised in the comments? Which comments above need my attention?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/964119878/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/964326867","html_url":"https://github.com/apache/accumulo/pull/2342#issuecomment-964326867","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2342","id":964326867,"node_id":"IC_kwDOACaFSM45enXT","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-09T16:38:34Z","updated_at":"2021-11-09T16:38:34Z","author_association":"CONTRIBUTOR","body":"@Manno15 @keith-turner I was in the process of updating this PR based on your feedback and noticed that the tablet logger is deceptive when no entries in the file. With no entries, the temp file will get dropped before the rename so I added this temporary log statement to prove it...\r\nProof of concept debug line I added to DataFileManager.bringMinorCompactionOnline():\r\n<pre>\r\nif (dfv.getNumEntries() == 0) {\r\n    log.debug(\"Delete file cause its gonna be empty {}\", tmpDatafile);\r\n    vm.deleteRecursively(tmpDatafile.getPath());\r\n}\r\n</pre>\r\nFrom the logs:\r\n<pre>\r\n2021-11-09T11:25:47,482 [tablet.DatafileManager] DEBUG: Delete file cause its gonna be empty file:.../accumulo/tables/1/t-0000057/F0000002.rf_tmp\r\n2021-11-09T11:25:47,489 [tablet.files] DEBUG: Flushed 1;s;a created file:.../accumulo/tables/1/t-0000057/F0000002.rf from [memory]\r\n</pre>\r\nAnd the more I thought about it, this could be really tricky for an admin trying to debug an issue with a file. The File name is a nice unique thing to grep for in logs and this could be very misleading when troubleshooting. Since I am changing the type returned in this method, I think I am going to modify the `tablet.files` log statement for flush to only include the file when it gets stored in the metadata.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/964326867/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/964337461","html_url":"https://github.com/apache/accumulo/pull/2259#issuecomment-964337461","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2259","id":964337461,"node_id":"IC_kwDOACaFSM45ep81","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-09T16:49:40Z","updated_at":"2021-11-09T16:50:16Z","author_association":"MEMBER","body":"@dlmarion wrote:\r\n> Did you resolve some/all of the issues raised in the comments? Which comments above need my attention?\r\n\r\nI resolved some and marked them as \"Resolved\". Feel free to reply to any, but the comments I left \"Unresolved\" in my last code review are the ones that I think could benefit from your attention, as well as anything that you might want to roll back or change from my added commits.\r\n\r\n(Also note: I did run all the ITs and they all still pass.)\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/964337461/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/964412033","html_url":"https://github.com/apache/accumulo/pull/2342#issuecomment-964412033","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2342","id":964412033,"node_id":"IC_kwDOACaFSM45e8KB","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-09T18:18:12Z","updated_at":"2021-11-09T18:18:29Z","author_association":"CONTRIBUTOR","body":"> And the more I thought about it, this could be really tricky for an admin trying to debug an issue with a file.\r\n\r\nThat is tricky, nice find.  It would be really nice to fix the logging so it accurately portrays what actually happened.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/964412033/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/964501213","html_url":"https://github.com/apache/accumulo/pull/2304#issuecomment-964501213","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2304","id":964501213,"node_id":"IC_kwDOACaFSM45fR7d","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-09T20:15:06Z","updated_at":"2021-11-09T20:15:06Z","author_association":"CONTRIBUTOR","body":"I am still seeing this IT timeout. I noticed looking at the logs that processes were still running between the 2 tests. This makes me think things aren't shutting down properly between the tests or there . Here are the file timestamps of the logs:\r\n<pre>\r\n02:59:39 (main) ~/workspace/accumulo/test/target/mini-tests$ ls -ltr\r\ndrwxrwxr-x 7 mike mike 4096 Nov  9 14:45 org.apache.accumulo.test.functional.ConcurrentDeleteTableIT_testConcurrentFateOpsWithDelete\r\ndrwxrwxr-x 7 mike mike 4096 Nov  9 14:52 org.apache.accumulo.test.functional.ConcurrentDeleteTableIT_testConcurrentDeleteTablesOps\r\n</pre>\r\nThose directory creation times tell me that `testConcurrentFateOpsWithDelete` started first. But when I look at the timestamps of the logs:\r\n<pre>\r\ntestConcurrentFateOpsWithDelete/logs$ ls -ltr\r\n-rw-rw-r-- 1 mike mike   1131284 Nov  9 14:59 SimpleGarbageCollector_1239693537.out\r\n-rw-rw-r-- 1 mike mike 135419459 Nov  9 14:59 Manager_717820111.out\r\n-rw-rw-r-- 1 mike mike   2588193 Nov  9 14:59 TabletServer_517210456.out\r\n-rw-rw-r-- 1 mike mike   1777859 Nov  9 14:59 TabletServer_73347924.out\r\n-rw-rw-r-- 1 mike mike     23255 Nov  9 14:59 ZooKeeperServerMain_1076296094.out\r\ntestConcurrentDeleteTablesOps/logs$ ls -ltr\r\n-rw-rw-r-- 1 mike mike  5555 Nov  9 14:52 Initialize_121937298.out\r\n-rw-rw-r-- 1 mike mike  3910 Nov  9 14:52 Main_2053248710.out\r\n-rw-rw-r-- 1 mike mike     0 Nov  9 14:52 Manager_749914505.out\r\n-rw-rw-r-- 1 mike mike     0 Nov  9 14:52 SimpleGarbageCollector_450467038.out\r\n-rw-rw-r-- 1 mike mike 31288 Nov  9 14:52 TabletServer_2141990664.out\r\n-rw-rw-r-- 1 mike mike 34509 Nov  9 14:52 TabletServer_687609284.out\r\n-rw-rw-r-- 1 mike mike 21957 Nov  9 14:52 ZooKeeperServerMain_231826773.out\r\n</pre>\r\nThey appear to be running at the same time. It looks like the Manager and GC won't start up for the second test because they are still running in the first.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/964501213/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/964502910","html_url":"https://github.com/apache/accumulo/pull/2259#issuecomment-964502910","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2259","id":964502910,"node_id":"IC_kwDOACaFSM45fSV-","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-09T20:17:22Z","updated_at":"2021-11-09T20:37:06Z","author_association":"MEMBER","body":"@dlmarion I think I still have reservations about the \"right\" way to bootstrap OpenTelemetry from user preferences. However, I think marking the properties experimental should suffice for now (which I have done).\r\n\r\nThe main outstanding concern now is lack of preserving of existing sampling granularity... that issue overlaps with the shell behavior change, in that dynamically turning tracing on and off in the shell is effectively toggling between an `ALWAYS` sampler and a `NEVER` sampler, dynamically at runtime. Given the difficulty of configuring that, I'm willing to punt on that for now. When we do revisit it, it might be worth taking a look at how to customize the autoconfigure implementation with a [sampler customizer](https://github.com/open-telemetry/opentelemetry-java/blob/main/sdk-extensions/autoconfigure-spi/src/main/java/io/opentelemetry/sdk/autoconfigure/spi/AutoConfigurationCustomizer.java#L45)\r\n\r\nEDIT: Created followup issue #2352 to address sampling customization","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/964502910/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":1,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/964533549","html_url":"https://github.com/apache/accumulo/pull/2304#issuecomment-964533549","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2304","id":964533549,"node_id":"IC_kwDOACaFSM45fZ0t","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-09T20:53:00Z","updated_at":"2021-11-09T20:53:00Z","author_association":"MEMBER","body":"I also saw this fail again. I collected the logs and saw that Manager got stuck for a few minutes, while printing hundreds of thousands of `mergeInfo overlaps` DEBUG messages at a rate of around 25 lines/millisecond. I did not see leftover processes or indications of leftover processes like @milleruntime  saw, though.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/964533549/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/964547107","html_url":"https://github.com/apache/accumulo/pull/2318#issuecomment-964547107","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2318","id":964547107,"node_id":"IC_kwDOACaFSM45fdIj","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-09T21:11:16Z","updated_at":"2021-11-09T21:11:16Z","author_association":"MEMBER","body":"> > I can't reproduce that, so I'm assuming you're describing changes not included in this PR.\r\n> \r\n> Yes. I am using `CompactionCoordinatorService.Client` to call the method `getRunningCompactions`. It returns multiple thrift types, TExternalCompactionList and TExternalCompaction.\r\n\r\nIt's hard to troubleshoot without seeing your code.\r\n\r\n> > The monitor shouldn't interact with Thrift at all. It should interact with other service APIs, and those service APIs should not leak Thrift types, if at all possible.\r\n> \r\n> I don't understand what you mean. I am also not sure how the Monitor doesn't already have this dependency. The Monitor currently uses thrift types like `ManagerMonitorInfo` and `ManagerClientService` a great deal.\r\n\r\nI guess there are two kinds of \"Thrift types\". There's our autogenerated code, like those you mention (I still think they shouldn't leak into the monitor, but I guess they're not causing a problem right now) that are from our accumulo-core jar. And then there's types from the Thrift jar. maven-dependency-plugin is checking for compile-time dependencies, not runtime dependencies. So, it shouldn't complain unless the monitor references a type `org.apache.thrift.*`. For the examples you gave, we're never actually referencing any `org.apache.thrift.*` classes in the monitor, even if those classes themselves reference them (creating a runtime dependency).","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/964547107/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/964615695","html_url":"https://github.com/apache/accumulo/pull/2318#issuecomment-964615695","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2318","id":964615695,"node_id":"IC_kwDOACaFSM45ft4P","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-09T22:48:01Z","updated_at":"2021-11-09T22:48:01Z","author_association":"CONTRIBUTOR","body":"So it turns out I was introducing the thrift dependency by adding these two imports:\r\n<pre>\r\n-import org.apache.thrift.TException;\r\n-import org.apache.thrift.transport.TTransportException;\r\n</pre>\r\nSo I think what we have in the Monitor is a bit of a hack to get around this. By catching Exception, like we do when we get the ManagerClient, I can avoid importing the thrift exceptions and it doesn't complain about the dependency.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/964615695/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/965085657","html_url":"https://github.com/apache/accumulo/pull/2318#issuecomment-965085657","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2318","id":965085657,"node_id":"IC_kwDOACaFSM45hgnZ","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-10T12:29:25Z","updated_at":"2021-11-10T12:29:25Z","author_association":"CONTRIBUTOR","body":"I'll resolve the conflict and merge this morning","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/965085657/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/965133379","html_url":"https://github.com/apache/accumulo/issues/2323#issuecomment-965133379","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2323","id":965133379,"node_id":"IC_kwDOACaFSM45hsRD","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-10T13:22:30Z","updated_at":"2021-11-10T13:22:30Z","author_association":"CONTRIBUTOR","body":"Duplicate of https://github.com/apache/accumulo-website/issues/302","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/965133379/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/965254106","html_url":"https://github.com/apache/accumulo/pull/2318#issuecomment-965254106","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2318","id":965254106,"node_id":"IC_kwDOACaFSM45iJva","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-10T14:21:14Z","updated_at":"2021-11-10T14:21:14Z","author_association":"CONTRIBUTOR","body":"Sorry I forgot to mention one of the values missing from TExternalCompaction. The compaction kind is available on the coordinator but not set in the thrift object when calling getRunningCompactions(). I think it can be pulled from the job object.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/965254106/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/965444384","html_url":"https://github.com/apache/accumulo/issues/2353#issuecomment-965444384","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2353","id":965444384,"node_id":"IC_kwDOACaFSM45i4Mg","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-10T15:47:33Z","updated_at":"2021-11-10T15:47:33Z","author_association":"MEMBER","body":"It looks like there's a couple places in that class that only show the property without the suffix in the error message and/or logs.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/965444384/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/965507615","html_url":"https://github.com/apache/accumulo/pull/2354#issuecomment-965507615","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2354","id":965507615,"node_id":"IC_kwDOACaFSM45jHof","user":{"login":"alerman","id":119506,"node_id":"MDQ6VXNlcjExOTUwNg==","avatar_url":"https://avatars.githubusercontent.com/u/119506?v=4","gravatar_id":"","url":"https://api.github.com/users/alerman","html_url":"https://github.com/alerman","followers_url":"https://api.github.com/users/alerman/followers","following_url":"https://api.github.com/users/alerman/following{/other_user}","gists_url":"https://api.github.com/users/alerman/gists{/gist_id}","starred_url":"https://api.github.com/users/alerman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alerman/subscriptions","organizations_url":"https://api.github.com/users/alerman/orgs","repos_url":"https://api.github.com/users/alerman/repos","events_url":"https://api.github.com/users/alerman/events{/privacy}","received_events_url":"https://api.github.com/users/alerman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-10T16:22:04Z","updated_at":"2021-11-10T16:22:04Z","author_association":"CONTRIBUTOR","body":"Updated to also change the other 2 places I saw that should be changed.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/965507615/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/965571339","html_url":"https://github.com/apache/accumulo/pull/2259#issuecomment-965571339","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2259","id":965571339,"node_id":"IC_kwDOACaFSM45jXML","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-10T17:27:44Z","updated_at":"2021-11-10T17:33:12Z","author_association":"CONTRIBUTOR","body":"Confirmed that tracing still works using the instructions [here](https://github.com/apache/accumulo/pull/2259#issuecomment-931518384), [here](https://github.com/apache/accumulo/pull/2259#issuecomment-932394590), and [here](https://github.com/apache/accumulo/pull/2259#issuecomment-932399981). The only difference is that the version is no longer 1.6.0, it's 1.7.1. The java agent jar for 1.7.1 can be downloaded with:\r\n\r\n`wget https://search.maven.org/remotecontent?filepath=io/opentelemetry/javaagent/opentelemetry-javaagent/1.7.1/opentelemetry-javaagent-1.7.1.jar`\r\n\r\nThe updated maven pom.xml file to create the autoconfigured shaded jar is:\r\n\r\n```xml\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd\">\r\n  <modelVersion>4.0.0</modelVersion>\r\n  <groupId>org.apache.accumulo.tracing</groupId>\r\n  <artifactId>opentelemetry-autoconf-deps</artifactId>\r\n  <version>1.0.0-SNAPSHOT</version>\r\n  <packaging>pom</packaging>\r\n  <dependencyManagement>\r\n    <dependencies>\r\n      <dependency>\r\n        <groupId>io.opentelemetry</groupId>\r\n        <artifactId>opentelemetry-bom</artifactId>\r\n        <version>1.7.1</version>\r\n        <type>pom</type>\r\n        <scope>import</scope>\r\n      </dependency>\r\n      <dependency>\r\n        <groupId>io.opentelemetry</groupId>\r\n        <artifactId>opentelemetry-bom-alpha</artifactId>\r\n        <version>1.7.1-alpha</version>\r\n        <type>pom</type>\r\n        <scope>import</scope>\r\n      </dependency>\r\n    </dependencies>\r\n  </dependencyManagement>\r\n  <dependencies>\r\n    <dependency>\r\n      <groupId>io.grpc</groupId>\r\n      <artifactId>grpc-netty-shaded</artifactId>\r\n      <version>1.41.0</version>\r\n    </dependency>\r\n    <dependency>\r\n      <groupId>io.opentelemetry</groupId>\r\n      <artifactId>opentelemetry-exporter-jaeger</artifactId>\r\n    </dependency>\r\n    <dependency>\r\n      <groupId>io.opentelemetry</groupId>\r\n      <artifactId>opentelemetry-exporter-logging</artifactId>\r\n    </dependency>\r\n    <dependency>\r\n      <groupId>io.opentelemetry</groupId>\r\n      <artifactId>opentelemetry-exporter-otlp</artifactId>\r\n    </dependency>\r\n    <dependency>\r\n      <groupId>io.opentelemetry</groupId>\r\n      <artifactId>opentelemetry-exporter-otlp-common</artifactId>\r\n    </dependency>\r\n    <dependency>\r\n      <groupId>io.opentelemetry</groupId>\r\n      <artifactId>opentelemetry-exporter-otlp-trace</artifactId>\r\n    </dependency>\r\n    <dependency>\r\n      <groupId>io.opentelemetry</groupId>\r\n      <artifactId>opentelemetry-exporter-prometheus</artifactId>\r\n    </dependency>\r\n    <dependency>\r\n      <groupId>io.opentelemetry</groupId>\r\n      <artifactId>opentelemetry-exporter-zipkin</artifactId>\r\n    </dependency>\r\n    <dependency>\r\n      <groupId>io.opentelemetry</groupId>\r\n      <artifactId>opentelemetry-sdk-extension-autoconfigure</artifactId>\r\n    </dependency>\r\n  </dependencies>\r\n  <build>\r\n    <plugins>\r\n      <plugin>\r\n        <groupId>org.apache.maven.plugins</groupId>\r\n        <artifactId>maven-shade-plugin</artifactId>\r\n        <version>3.2.4</version>\r\n        <dependencies>\r\n          <dependency>\r\n            <groupId>com.hazelcast</groupId>\r\n            <artifactId>hazelcast-build-utils</artifactId>\r\n            <version>4.2.2</version>\r\n          </dependency>\r\n        </dependencies>\r\n        <executions>\r\n          <execution>\r\n            <goals>\r\n              <goal>shade</goal>\r\n            </goals>\r\n            <phase>package</phase>\r\n            <configuration>\r\n              <artifactSet>\r\n                <includes>\r\n                  <include>*.*</include>\r\n                </includes>\r\n              </artifactSet>\r\n              <createSourcesJar>true</createSourcesJar>\r\n              <dependencyReducedPomLocation>${project.build.directory}/.</dependencyReducedPomLocation>\r\n              <outputFile>${project.build.directory}/opentelemetry-autoconf-deps-${project.version}-shaded.jar</outputFile>\r\n              <shadedArtifactAttached>true</shadedArtifactAttached>\r\n              <shadeSourcesContent>true</shadeSourcesContent>\r\n              <transformers>\r\n                <transformer implementation=\"com.hazelcast.buildutils.HazelcastManifestTransformer\">\r\n                  <!-- the tag below is required due to a missing null-check it seems -->\r\n                  <overrideInstructions />\r\n                </transformer>\r\n                <transformer implementation=\"org.apache.maven.plugins.shade.resource.ApacheLicenseResourceTransformer\" />\r\n                <transformer implementation=\"org.apache.maven.plugins.shade.resource.ApacheNoticeResourceTransformer\" />\r\n                <transformer implementation=\"org.apache.maven.plugins.shade.resource.ServicesResourceTransformer\" />\r\n              </transformers>\r\n            </configuration>\r\n          </execution>\r\n        </executions>\r\n      </plugin>\r\n    </plugins>\r\n  </build>\r\n</project>\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/965571339/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/965659663","html_url":"https://github.com/apache/accumulo/issues/2355#issuecomment-965659663","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2355","id":965659663,"node_id":"IC_kwDOACaFSM45jswP","user":{"login":"Manno15","id":29436247,"node_id":"MDQ6VXNlcjI5NDM2MjQ3","avatar_url":"https://avatars.githubusercontent.com/u/29436247?v=4","gravatar_id":"","url":"https://api.github.com/users/Manno15","html_url":"https://github.com/Manno15","followers_url":"https://api.github.com/users/Manno15/followers","following_url":"https://api.github.com/users/Manno15/following{/other_user}","gists_url":"https://api.github.com/users/Manno15/gists{/gist_id}","starred_url":"https://api.github.com/users/Manno15/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Manno15/subscriptions","organizations_url":"https://api.github.com/users/Manno15/orgs","repos_url":"https://api.github.com/users/Manno15/repos","events_url":"https://api.github.com/users/Manno15/events{/privacy}","received_events_url":"https://api.github.com/users/Manno15/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-10T19:15:14Z","updated_at":"2021-11-10T19:15:14Z","author_association":"CONTRIBUTOR","body":"Seems some code was removed in #1490 that did change the value of `reservationsBlocked to true.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/965659663/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/965663371","html_url":"https://github.com/apache/accumulo/pull/2304#issuecomment-965663371","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2304","id":965663371,"node_id":"IC_kwDOACaFSM45jtqL","user":{"login":"Manno15","id":29436247,"node_id":"MDQ6VXNlcjI5NDM2MjQ3","avatar_url":"https://avatars.githubusercontent.com/u/29436247?v=4","gravatar_id":"","url":"https://api.github.com/users/Manno15","html_url":"https://github.com/Manno15","followers_url":"https://api.github.com/users/Manno15/followers","following_url":"https://api.github.com/users/Manno15/following{/other_user}","gists_url":"https://api.github.com/users/Manno15/gists{/gist_id}","starred_url":"https://api.github.com/users/Manno15/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Manno15/subscriptions","organizations_url":"https://api.github.com/users/Manno15/orgs","repos_url":"https://api.github.com/users/Manno15/repos","events_url":"https://api.github.com/users/Manno15/events{/privacy}","received_events_url":"https://api.github.com/users/Manno15/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-10T19:19:53Z","updated_at":"2021-11-10T19:19:53Z","author_association":"CONTRIBUTOR","body":"I cannot get this test to fail locally anymore. I did some rebasing to older commits and it passed there, now it is also passing when I add those commits back. The test will still take over 5 minutes to complete but no timeouts and no super large manager logs. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/965663371/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/965880084","html_url":"https://github.com/apache/accumulo/pull/2324#issuecomment-965880084","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2324","id":965880084,"node_id":"IC_kwDOACaFSM45kikU","user":{"login":"EdColeman","id":7047700,"node_id":"MDQ6VXNlcjcwNDc3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/7047700?v=4","gravatar_id":"","url":"https://api.github.com/users/EdColeman","html_url":"https://github.com/EdColeman","followers_url":"https://api.github.com/users/EdColeman/followers","following_url":"https://api.github.com/users/EdColeman/following{/other_user}","gists_url":"https://api.github.com/users/EdColeman/gists{/gist_id}","starred_url":"https://api.github.com/users/EdColeman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdColeman/subscriptions","organizations_url":"https://api.github.com/users/EdColeman/orgs","repos_url":"https://api.github.com/users/EdColeman/repos","events_url":"https://api.github.com/users/EdColeman/events{/privacy}","received_events_url":"https://api.github.com/users/EdColeman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-11T00:19:13Z","updated_at":"2021-11-11T00:19:13Z","author_association":"CONTRIBUTOR","body":"@keith-turner I had similar discussion with @ctubbsii concerning the VersionedProperties being the source of truth for the version. With your concerns, it seems that I did not achieve the possible independence from the storage of the properties.  Certain things had to be ZooKeeper specific, but I was aiming that the storage at the byte array level could leverage something other than ZooKeeper if that was determined that it could provide advantages.\r\n\r\nI'm now  thinking that this added complexity without a clear enough advantage at this time may be unwanted. I don't want to close this at this point.\r\n\r\nI'm going to set this to draft and look at updating this PR to uses the stat version.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/965880084/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/966441246","html_url":"https://github.com/apache/accumulo/issues/2355#issuecomment-966441246","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2355","id":966441246,"node_id":"IC_kwDOACaFSM45mrke","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-11T16:27:02Z","updated_at":"2021-11-11T16:27:02Z","author_association":"MEMBER","body":"The code in #1490 looks like it became vestigial after fixing issue #936 in PR #1313. The code here is now also vestigial. It was only ever used for scanning the root tablet when we relied on HDFS being the canonical source of truth for the files the root tablet was using. Since #1313, that is no longer needed. This can be cleaned up.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/966441246/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/967066273","html_url":"https://github.com/apache/accumulo/issues/2355#issuecomment-967066273","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2355","id":967066273,"node_id":"IC_kwDOACaFSM45pEKh","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-12T12:13:56Z","updated_at":"2021-11-12T12:13:56Z","author_association":"CONTRIBUTOR","body":"> The code in #1490 looks like it became vestigial after fixing issue #936 in PR #1313. The code here is now also vestigial. It was only ever used for scanning the root tablet when we relied on HDFS being the canonical source of truth for the files the root tablet was using. Since #1313, that is no longer needed. This can be cleaned up.\r\n\r\nI had a feeling this was the case but wasn't able to confirm it looking at the code. Thanks for looking at this!","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/967066273/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/967567259","html_url":"https://github.com/apache/accumulo/pull/2329#issuecomment-967567259","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2329","id":967567259,"node_id":"IC_kwDOACaFSM45q-eb","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-12T21:13:09Z","updated_at":"2021-11-12T21:13:09Z","author_association":"CONTRIBUTOR","body":"@keith-turner - can you take a look at my changes in 1755864 to see if this implementation seems sane. The high level notes are that I modified ZooStore to:\r\n\r\n  1. Keep a reference to the thread that is reserving the tx\r\n  2. Added a cancel method to call interrupt on the thread\r\n  \r\nThe calling Thread in most cases should be the Fate.TransactionRunner threads which already handle the Exception and transition the tx to FAILED_IN_PROGRESS and then ultimately unreserves the tx. I also fixed up a test and added FateIT with a test for preemption. Finally I took a stab at determining which FaTE transaction types should preempt.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/967567259/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/969087562","html_url":"https://github.com/apache/accumulo/pull/2304#issuecomment-969087562","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2304","id":969087562,"node_id":"IC_kwDOACaFSM45wxpK","user":{"login":"Manno15","id":29436247,"node_id":"MDQ6VXNlcjI5NDM2MjQ3","avatar_url":"https://avatars.githubusercontent.com/u/29436247?v=4","gravatar_id":"","url":"https://api.github.com/users/Manno15","html_url":"https://github.com/Manno15","followers_url":"https://api.github.com/users/Manno15/followers","following_url":"https://api.github.com/users/Manno15/following{/other_user}","gists_url":"https://api.github.com/users/Manno15/gists{/gist_id}","starred_url":"https://api.github.com/users/Manno15/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Manno15/subscriptions","organizations_url":"https://api.github.com/users/Manno15/orgs","repos_url":"https://api.github.com/users/Manno15/repos","events_url":"https://api.github.com/users/Manno15/events{/privacy}","received_events_url":"https://api.github.com/users/Manno15/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-15T16:32:10Z","updated_at":"2021-11-15T17:04:33Z","author_association":"CONTRIBUTOR","body":"I am now seeing some similar logs @ctubbsii and I had a run where Manager logs are quite large. Though the IT still passed for me. Looking into it further. \r\n\r\nAll the overlap logs seem to be when taking each tablet offline for deletion. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/969087562/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/970267282","html_url":"https://github.com/apache/accumulo/issues/1884#issuecomment-970267282","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1884","id":970267282,"node_id":"IC_kwDOACaFSM451RqS","user":{"login":"martin-g","id":232002,"node_id":"MDQ6VXNlcjIzMjAwMg==","avatar_url":"https://avatars.githubusercontent.com/u/232002?v=4","gravatar_id":"","url":"https://api.github.com/users/martin-g","html_url":"https://github.com/martin-g","followers_url":"https://api.github.com/users/martin-g/followers","following_url":"https://api.github.com/users/martin-g/following{/other_user}","gists_url":"https://api.github.com/users/martin-g/gists{/gist_id}","starred_url":"https://api.github.com/users/martin-g/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martin-g/subscriptions","organizations_url":"https://api.github.com/users/martin-g/orgs","repos_url":"https://api.github.com/users/martin-g/repos","events_url":"https://api.github.com/users/martin-g/events{/privacy}","received_events_url":"https://api.github.com/users/martin-g/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-16T13:19:49Z","updated_at":"2021-11-16T13:19:49Z","author_association":"MEMBER","body":"At https://martin-grigorov.medium.com/github-actions-arm64-runner-on-oracle-cloud-a77cdf7a325a I've explained how to use GitHub Actions self-hosted ARM64 runners on Oracle Cloud for free.\r\nAgain you will need to create an account at OracleCloud to be able to create the VM but apart from that the build setup would be the same as now. ASF Infra help is needed only to get the token for `./config.sh` step and to setup the security.\r\n\r\nLet me know if you are interested in this approach and if you need any kind of help!","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/970267282/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/970669358","html_url":"https://github.com/apache/accumulo/pull/2324#issuecomment-970669358","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2324","id":970669358,"node_id":"IC_kwDOACaFSM452z0u","user":{"login":"EdColeman","id":7047700,"node_id":"MDQ6VXNlcjcwNDc3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/7047700?v=4","gravatar_id":"","url":"https://api.github.com/users/EdColeman","html_url":"https://github.com/EdColeman","followers_url":"https://api.github.com/users/EdColeman/followers","following_url":"https://api.github.com/users/EdColeman/following{/other_user}","gists_url":"https://api.github.com/users/EdColeman/gists{/gist_id}","starred_url":"https://api.github.com/users/EdColeman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdColeman/subscriptions","organizations_url":"https://api.github.com/users/EdColeman/orgs","repos_url":"https://api.github.com/users/EdColeman/repos","events_url":"https://api.github.com/users/EdColeman/events{/privacy}","received_events_url":"https://api.github.com/users/EdColeman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-16T20:53:02Z","updated_at":"2021-11-16T20:53:02Z","author_association":"CONTRIBUTOR","body":"@keith-turner I removed saving the version in the ZooKeeper blob and use the stat version as you suggested.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/970669358/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/970673899","html_url":"https://github.com/apache/accumulo/pull/2317#issuecomment-970673899","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2317","id":970673899,"node_id":"IC_kwDOACaFSM45207r","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-16T20:59:31Z","updated_at":"2021-11-16T20:59:31Z","author_association":"MEMBER","body":"This appears to have been superseded by #2358","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/970673899/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/970739501","html_url":"https://github.com/apache/accumulo/issues/2361#issuecomment-970739501","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2361","id":970739501,"node_id":"IC_kwDOACaFSM453E8t","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-16T22:34:21Z","updated_at":"2021-11-16T22:34:21Z","author_association":"CONTRIBUTOR","body":"> I think this would be fairly easy to do using the RFile API.\r\n\r\nMay be best to do this with internal code that can access the rfile indexes directly.  Thinking that the rows in the rfile indexes could be used to quickly generate splits points.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/970739501/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/971509648","html_url":"https://github.com/apache/accumulo/pull/2329#issuecomment-971509648","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2329","id":971509648,"node_id":"IC_kwDOACaFSM456A-Q","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-17T11:55:52Z","updated_at":"2021-11-17T11:55:52Z","author_association":"CONTRIBUTOR","body":"@keith-turner  - I addressed the issues you raised. Did you happen to look at the FaTE types that are taking advantage of this mechanism?\r\n\r\nOne thing to note is that if there are T FaTE threads and F FaTE transactions for a table, and F > T, then the preemption for a transaction will only occur when one of the threads starts to process the tx. So, it may not be immediate.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/971509648/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/971591565","html_url":"https://github.com/apache/accumulo/pull/2317#issuecomment-971591565","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2317","id":971591565,"node_id":"IC_kwDOACaFSM456U-N","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-17T13:38:40Z","updated_at":"2021-11-17T13:38:40Z","author_association":"CONTRIBUTOR","body":"Whoops! I forgot I had opened this PR. Thanks @ctubbsii for the clean up.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/971591565/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/971683648","html_url":"https://github.com/apache/accumulo/pull/2358#issuecomment-971683648","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2358","id":971683648,"node_id":"IC_kwDOACaFSM456rdA","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-17T15:21:00Z","updated_at":"2021-11-17T15:21:00Z","author_association":"CONTRIBUTOR","body":"The data being populated in running compactions table could grow quite large and be inefficient when loading the table. I am going to do a follow on task to optimize the performance of fetching the data.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/971683648/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/971796219","html_url":"https://github.com/apache/accumulo/pull/2358#issuecomment-971796219","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2358","id":971796219,"node_id":"IC_kwDOACaFSM457G77","user":{"login":"Manno15","id":29436247,"node_id":"MDQ6VXNlcjI5NDM2MjQ3","avatar_url":"https://avatars.githubusercontent.com/u/29436247?v=4","gravatar_id":"","url":"https://api.github.com/users/Manno15","html_url":"https://github.com/Manno15","followers_url":"https://api.github.com/users/Manno15/followers","following_url":"https://api.github.com/users/Manno15/following{/other_user}","gists_url":"https://api.github.com/users/Manno15/gists{/gist_id}","starred_url":"https://api.github.com/users/Manno15/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Manno15/subscriptions","organizations_url":"https://api.github.com/users/Manno15/orgs","repos_url":"https://api.github.com/users/Manno15/repos","events_url":"https://api.github.com/users/Manno15/events{/privacy}","received_events_url":"https://api.github.com/users/Manno15/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-17T17:25:51Z","updated_at":"2021-11-17T17:25:51Z","author_association":"CONTRIBUTOR","body":"Does this PR align with issue #2286? I did notice in my testing that The Compaction Coordinator section has most of its column values right-aligned while the Compactors section has the column values left-aligned. Not a big deal but I wanted to point it out.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/971796219/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/971834653","html_url":"https://github.com/apache/accumulo/pull/2358#issuecomment-971834653","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2358","id":971834653,"node_id":"IC_kwDOACaFSM457QUd","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-17T18:14:18Z","updated_at":"2021-11-17T18:14:18Z","author_association":"CONTRIBUTOR","body":"> Does this PR align with issue #2286? I did notice in my testing that The Compaction Coordinator section has most of its column values right-aligned while the Compactors section has the column values left-aligned. Not a big deal but I wanted to point it out.\r\n\r\nI will find a new Bootstrap component for the Coordinator instead of the one row table.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/971834653/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/971972082","html_url":"https://github.com/apache/accumulo/pull/2358#issuecomment-971972082","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2358","id":971972082,"node_id":"IC_kwDOACaFSM457x3y","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-17T20:32:58Z","updated_at":"2021-11-17T20:32:58Z","author_association":"CONTRIBUTOR","body":"@Manno15 I redid the coordinator info to be in a panel with badges\r\n\r\n![new-coordinator](https://user-images.githubusercontent.com/11872539/142277896-7b7c9b50-8cc1-49fc-bf37-706ebfa71071.png)\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/971972082/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/972118749","html_url":"https://github.com/apache/accumulo/issues/2361#issuecomment-972118749","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2361","id":972118749,"node_id":"IC_kwDOACaFSM458Vrd","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-17T22:01:45Z","updated_at":"2021-11-17T22:01:45Z","author_association":"CONTRIBUTOR","body":"> > I think this would be fairly easy to do using the RFile API.\r\n> \r\n> May be best to do this with internal code that can access the rfile indexes directly. Thinking that the rows in the rfile indexes could be used to quickly generate splits points.\r\n\r\nAre you talking about the Key object stored here: https://github.com/apache/accumulo/blob/6a74b4667e3bd33e34b5262c5dd8ea64167fb657/core/src/main/java/org/apache/accumulo/core/file/rfile/MultiLevelIndex.java#L50\r\nAnd getting that index through the Rfile reader here:\r\nhttps://github.com/apache/accumulo/blob/6cfb9180a0d3e5115922314ff2062e0706ef0795/core/src/main/java/org/apache/accumulo/core/file/rfile/RFile.java#L1449","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/972118749/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/972149849","html_url":"https://github.com/apache/accumulo/issues/2361#issuecomment-972149849","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2361","id":972149849,"node_id":"IC_kwDOACaFSM458dRZ","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-17T22:22:02Z","updated_at":"2021-11-17T22:23:52Z","author_association":"CONTRIBUTOR","body":"> And getting that index through the Rfile reader here\r\n\r\nYeah that is the code I was thinking about.  Looked around and found the following code that the tserver uses to find a single split point by inspecting indexes.\r\n\r\nhttps://github.com/apache/accumulo/blob/f8bb900ae080fe0f54dfe04f9e1ad8c4dd2e7930/server/base/src/main/java/org/apache/accumulo/server/util/FileUtil.java#L289\r\n\r\nThe code makes two passes.  First it counts the number of index entries.  Second read through them again using a merged view of the indexes and takes the count/2 entry.  Could possibly do something similar for N entries.  Do one pass over the index data to count the entries and then another pass to take every count/N entry.  The code above falls back to scanning the data in the rfiles instead of the index from some cases, would probably need to do that sometime for this use case also.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/972149849/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/972357827","html_url":"https://github.com/apache/accumulo/pull/2358#issuecomment-972357827","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2358","id":972357827,"node_id":"IC_kwDOACaFSM459QDD","user":{"login":"Manno15","id":29436247,"node_id":"MDQ6VXNlcjI5NDM2MjQ3","avatar_url":"https://avatars.githubusercontent.com/u/29436247?v=4","gravatar_id":"","url":"https://api.github.com/users/Manno15","html_url":"https://github.com/Manno15","followers_url":"https://api.github.com/users/Manno15/followers","following_url":"https://api.github.com/users/Manno15/following{/other_user}","gists_url":"https://api.github.com/users/Manno15/gists{/gist_id}","starred_url":"https://api.github.com/users/Manno15/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Manno15/subscriptions","organizations_url":"https://api.github.com/users/Manno15/orgs","repos_url":"https://api.github.com/users/Manno15/repos","events_url":"https://api.github.com/users/Manno15/events{/privacy}","received_events_url":"https://api.github.com/users/Manno15/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-18T00:11:55Z","updated_at":"2021-11-18T00:11:55Z","author_association":"CONTRIBUTOR","body":"@milleruntime I like the look of that. I am going to take another pass through the PR tomorrow. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/972357827/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/973101955","html_url":"https://github.com/apache/accumulo/issues/2361#issuecomment-973101955","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2361","id":973101955,"node_id":"IC_kwDOACaFSM46AFuD","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-18T17:36:17Z","updated_at":"2021-11-18T17:36:17Z","author_association":"CONTRIBUTOR","body":"> The code above falls back to scanning the data in the rfiles instead of the index from some cases, would probably need to do that sometime for this use case also.\r\n\r\nWhat is the case where there is no index entries?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/973101955/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/973141536","html_url":"https://github.com/apache/accumulo/issues/2361#issuecomment-973141536","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2361","id":973141536,"node_id":"IC_kwDOACaFSM46APYg","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-18T18:26:48Z","updated_at":"2021-11-18T18:26:48Z","author_association":"CONTRIBUTOR","body":"> What is the case where there is no index entries?\r\n\r\nI think the following was the case I remembered.  MAybe this can happen when a tablet is only using a sub range of an rfile and  that subrange falls between index entries.  For this issue if the number of index entries is less than the desired number of splits, then may want to fall back to scanning the data.\r\n\r\nhttps://github.com/apache/accumulo/blob/f8bb900ae080fe0f54dfe04f9e1ad8c4dd2e7930/server/base/src/main/java/org/apache/accumulo/server/util/FileUtil.java#L327-L340","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/973141536/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/973228335","html_url":"https://github.com/apache/accumulo/issues/2361#issuecomment-973228335","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2361","id":973228335,"node_id":"IC_kwDOACaFSM46Akkv","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-18T20:18:15Z","updated_at":"2021-11-18T20:18:15Z","author_association":"CONTRIBUTOR","body":"> when a tablet is only using a sub range of an rfile and that subrange falls between index entries.\r\n\r\nOK so if I am looking at the entire rfile and not just a range, then maybe I don't have to worry about this case. The use case I was thinking of was where the user just has a file (or set of files) and want the splits across the whole file.\r\n\r\nAlso, I thought I could fall back calculating the splits just based on the size of the file (to prevent having to scan the file twice) but it doesn't look like that works.\r\n<pre>\r\nlong fileSize = fs.getFileStatus(file).getLen();\r\nlong splitSize = fileSize / numSplits;\r\n...\r\nint size = key.getSize() + val.getSize();\r\ncount += size;\r\nif (count > splitSize) {\r\n    splits.add(stripOffEmptyByte(key.getRow()));\r\n}\r\n</pre>","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/973228335/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/973242011","html_url":"https://github.com/apache/accumulo/issues/2362#issuecomment-973242011","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2362","id":973242011,"node_id":"IC_kwDOACaFSM46An6b","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-18T20:37:36Z","updated_at":"2021-11-18T20:37:36Z","author_association":"MEMBER","body":"I think I have a fix for this. We're using instanceof to enforce that the BlockingQueue only contains InternalJob types, and not other Runnables. However, I think we can do this at compile time with better generics instead of waiting until runtime.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/973242011/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/973254755","html_url":"https://github.com/apache/accumulo/issues/2361#issuecomment-973254755","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2361","id":973254755,"node_id":"IC_kwDOACaFSM46ArBj","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-18T20:49:13Z","updated_at":"2021-11-18T20:49:13Z","author_association":"CONTRIBUTOR","body":"> OK so if I am looking at the entire rfile and not just a range, then maybe I don't have to worry about this case.\r\n\r\nMay have to handle a case that is similar.  If a user request 100 split points and the files only have 60 index entries, then this is not enough satisfy the request.  Could scan the data instead of indexes in this case to get the 100 split points.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/973254755/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/973262661","html_url":"https://github.com/apache/accumulo/issues/2361#issuecomment-973262661","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2361","id":973262661,"node_id":"IC_kwDOACaFSM46As9F","user":{"login":"EdColeman","id":7047700,"node_id":"MDQ6VXNlcjcwNDc3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/7047700?v=4","gravatar_id":"","url":"https://api.github.com/users/EdColeman","html_url":"https://github.com/EdColeman","followers_url":"https://api.github.com/users/EdColeman/followers","following_url":"https://api.github.com/users/EdColeman/following{/other_user}","gists_url":"https://api.github.com/users/EdColeman/gists{/gist_id}","starred_url":"https://api.github.com/users/EdColeman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdColeman/subscriptions","organizations_url":"https://api.github.com/users/EdColeman/orgs","repos_url":"https://api.github.com/users/EdColeman/repos","events_url":"https://api.github.com/users/EdColeman/events{/privacy}","received_events_url":"https://api.github.com/users/EdColeman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-18T20:54:29Z","updated_at":"2021-11-18T20:54:29Z","author_association":"CONTRIBUTOR","body":"Another consideration may be to just accept the desired size (based on split threshold?) and then run through the file(s) and spit out a split that would be the row-index before the desired size was met / exceeded.\r\n\r\nAlso, depending on compression, file hdfs size and entity size may report differently. Assuming that you would track / care about the uncompressed size because I think that's what is maintained in the metadata and used in split calculations. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/973262661/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/973271761","html_url":"https://github.com/apache/accumulo/pull/2364#issuecomment-973271761","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2364","id":973271761,"node_id":"IC_kwDOACaFSM46AvLR","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-18T21:07:21Z","updated_at":"2021-11-18T21:07:21Z","author_association":"MEMBER","body":"On second thought, I don't think this is a good idea. Even if it worked, it makes too many assumptions about how the blocking queue is used internally to the executor. But, I don't think it will work anyway, because the comparator generic type won't match the wrapped Runnable type from OpenTelemetry.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/973271761/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/973395649","html_url":"https://github.com/apache/accumulo/pull/2358#issuecomment-973395649","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2358","id":973395649,"node_id":"IC_kwDOACaFSM46BNbB","user":{"login":"Manno15","id":29436247,"node_id":"MDQ6VXNlcjI5NDM2MjQ3","avatar_url":"https://avatars.githubusercontent.com/u/29436247?v=4","gravatar_id":"","url":"https://api.github.com/users/Manno15","html_url":"https://github.com/Manno15","followers_url":"https://api.github.com/users/Manno15/followers","following_url":"https://api.github.com/users/Manno15/following{/other_user}","gists_url":"https://api.github.com/users/Manno15/gists{/gist_id}","starred_url":"https://api.github.com/users/Manno15/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Manno15/subscriptions","organizations_url":"https://api.github.com/users/Manno15/orgs","repos_url":"https://api.github.com/users/Manno15/repos","events_url":"https://api.github.com/users/Manno15/events{/privacy}","received_events_url":"https://api.github.com/users/Manno15/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-18T23:12:36Z","updated_at":"2021-11-18T23:19:25Z","author_association":"CONTRIBUTOR","body":"@milleruntime For some reason the compaction coordinator panel did not populate any data on my end. Did you have to start the coordinator in a specific way or do any other configuring? For reference (this was taken while compactions were going on and I do have coordinator logs): \r\n![image](https://user-images.githubusercontent.com/29436247/142512035-e2314f57-0cb0-445c-80c4-bc5704e98f1a.png)\r\n\r\nI do really like the Running Compactions table and the info it provides. \r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/973395649/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/973556552","html_url":"https://github.com/apache/accumulo/pull/2358#issuecomment-973556552","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2358","id":973556552,"node_id":"IC_kwDOACaFSM46B0tI","user":{"login":"Manno15","id":29436247,"node_id":"MDQ6VXNlcjI5NDM2MjQ3","avatar_url":"https://avatars.githubusercontent.com/u/29436247?v=4","gravatar_id":"","url":"https://api.github.com/users/Manno15","html_url":"https://github.com/Manno15","followers_url":"https://api.github.com/users/Manno15/followers","following_url":"https://api.github.com/users/Manno15/following{/other_user}","gists_url":"https://api.github.com/users/Manno15/gists{/gist_id}","starred_url":"https://api.github.com/users/Manno15/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Manno15/subscriptions","organizations_url":"https://api.github.com/users/Manno15/orgs","repos_url":"https://api.github.com/users/Manno15/repos","events_url":"https://api.github.com/users/Manno15/events{/privacy}","received_events_url":"https://api.github.com/users/Manno15/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-19T00:22:43Z","updated_at":"2021-11-19T00:24:08Z","author_association":"CONTRIBUTOR","body":"I did notice something interesting, the value for 'Last Update' and 'Duration' inside the 'Running Compactions' table will be the same value while the progress bar shows 0%. The values update multiple times before the progress bar changes but those two values will still be equal to each other. Once, the progress bar changes (in my testing, it generally jumped to 78% or all the way to 98%) the values for those two columns will be their expected value. I.e. multiple seconds for duration and ms for last update. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/973556552/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/973970524","html_url":"https://github.com/apache/accumulo/pull/2358#issuecomment-973970524","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2358","id":973970524,"node_id":"IC_kwDOACaFSM46DZxc","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-19T10:54:57Z","updated_at":"2021-11-19T10:54:57Z","author_association":"CONTRIBUTOR","body":"> @milleruntime For some reason the compaction coordinator panel did not populate any data on my end. Did you have to start the coordinator in a specific way or do any other configuring? For reference (this was taken while compactions were going on and I do have coordinator logs): ![image](https://user-images.githubusercontent.com/29436247/142512035-e2314f57-0cb0-445c-80c4-bc5704e98f1a.png)\r\n> \r\n> I do really like the Running Compactions table and the info it provides.\r\n\r\nIf you have brought up the page with previous updates then your browser could have the JS cached. Doing a CTRL+F5 should do a hard refresh.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/973970524/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/974028448","html_url":"https://github.com/apache/accumulo/issues/2362#issuecomment-974028448","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2362","id":974028448,"node_id":"IC_kwDOACaFSM46Dn6g","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-19T12:25:47Z","updated_at":"2021-11-19T12:25:47Z","author_association":"MEMBER","body":"After some thought, I realized my first attempt won't work, but I think I can still fix this.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/974028448/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/974150159","html_url":"https://github.com/apache/accumulo/pull/2358#issuecomment-974150159","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2358","id":974150159,"node_id":"IC_kwDOACaFSM46EFoP","user":{"login":"Manno15","id":29436247,"node_id":"MDQ6VXNlcjI5NDM2MjQ3","avatar_url":"https://avatars.githubusercontent.com/u/29436247?v=4","gravatar_id":"","url":"https://api.github.com/users/Manno15","html_url":"https://github.com/Manno15","followers_url":"https://api.github.com/users/Manno15/followers","following_url":"https://api.github.com/users/Manno15/following{/other_user}","gists_url":"https://api.github.com/users/Manno15/gists{/gist_id}","starred_url":"https://api.github.com/users/Manno15/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Manno15/subscriptions","organizations_url":"https://api.github.com/users/Manno15/orgs","repos_url":"https://api.github.com/users/Manno15/repos","events_url":"https://api.github.com/users/Manno15/events{/privacy}","received_events_url":"https://api.github.com/users/Manno15/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-19T15:06:31Z","updated_at":"2021-11-19T15:06:31Z","author_association":"CONTRIBUTOR","body":"> If you have brought up the page with previous updates then your browser could have the JS cached. Doing a CTRL+F5 should do a hard refresh.\r\n\r\nThanks, that worked!","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/974150159/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/974180076","html_url":"https://github.com/apache/accumulo/pull/2358#issuecomment-974180076","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2358","id":974180076,"node_id":"IC_kwDOACaFSM46EM7s","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-19T15:40:07Z","updated_at":"2021-11-19T15:40:07Z","author_association":"CONTRIBUTOR","body":"> These changes look really good. Could something similar to the 'running compactions' table be added to the active compactions page to cover internal compactions?\r\n\r\nThere is some work that would need to be done to the internal plumbing but it might not be much work. @dlmarion had some ideas of how this could be done.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/974180076/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/974186512","html_url":"https://github.com/apache/accumulo/pull/2358#issuecomment-974186512","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2358","id":974186512,"node_id":"IC_kwDOACaFSM46EOgQ","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-19T15:48:23Z","updated_at":"2021-11-19T15:48:23Z","author_association":"CONTRIBUTOR","body":"@Manno15 The Compactor starts the FileCompactor in a separate thread, then in the main thread it periodically gets the stats and sends them to the Coordinator. The FileCompactor is the same object used in the TabletServers to perform major compactions. In theory, the TabletServer could periodically iterate over the major compaction threads that are in progress and do the same thing and send the stats to the Manager. See https://github.com/apache/accumulo/blob/main/server/compactor/src/main/java/org/apache/accumulo/compactor/Compactor.java#L682","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/974186512/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/974187794","html_url":"https://github.com/apache/accumulo/pull/2358#issuecomment-974187794","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2358","id":974187794,"node_id":"IC_kwDOACaFSM46EO0S","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-19T15:50:09Z","updated_at":"2021-11-19T15:50:09Z","author_association":"CONTRIBUTOR","body":"@milleruntime - Are you creating follow-on tickets for the recently completed compactions? If not, we might want to remove that map from the Coordinator. I think there was one other follow-on issue too, but I can't remember it right now.\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/974187794/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]