[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1425256351","html_url":"https://github.com/apache/iceberg/issues/6800#issuecomment-1425256351","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6800","id":1425256351,"node_id":"IC_kwDOCW7NX85U86-f","user":{"login":"xuzhiwen1255","id":105710753,"node_id":"U_kgDOBk0EoQ","avatar_url":"https://avatars.githubusercontent.com/u/105710753?v=4","gravatar_id":"","url":"https://api.github.com/users/xuzhiwen1255","html_url":"https://github.com/xuzhiwen1255","followers_url":"https://api.github.com/users/xuzhiwen1255/followers","following_url":"https://api.github.com/users/xuzhiwen1255/following{/other_user}","gists_url":"https://api.github.com/users/xuzhiwen1255/gists{/gist_id}","starred_url":"https://api.github.com/users/xuzhiwen1255/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xuzhiwen1255/subscriptions","organizations_url":"https://api.github.com/users/xuzhiwen1255/orgs","repos_url":"https://api.github.com/users/xuzhiwen1255/repos","events_url":"https://api.github.com/users/xuzhiwen1255/events{/privacy}","received_events_url":"https://api.github.com/users/xuzhiwen1255/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-10T06:30:19Z","updated_at":"2023-02-10T06:30:19Z","author_association":"CONTRIBUTOR","body":"\r\n> I think this is worth thinking about but I'm not sure it is as simple as this. Currently we don't really consider the json files to really have the same lifecycle as other metadata files. They aren't really expired since they aren't actually part of the history ...\r\n\r\nHowever, if you write to iceberg through flink and have high real-time requirements, then the ck interval will be very short. If it runs for a long time, I think the metadata-log may be relatively large, although recording this It doesn't take up too much space, but it's redundant. After all, the manifest-list file has been deleted, which makes it meaningless. But I don't know if there are other considerations in the design here.\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1425256351/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1425472316","html_url":"https://github.com/apache/iceberg/issues/6796#issuecomment-1425472316","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6796","id":1425472316,"node_id":"IC_kwDOCW7NX85U9vs8","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-10T09:16:41Z","updated_at":"2023-02-10T09:16:41Z","author_association":"CONTRIBUTOR","body":"Hey @romanstreamsets,\r\n\r\nThanks for opening up this issue. Do you want the field to be required or optional? There is a difference between the schema that's being parsed from the JSON and the one you define in the code:\r\n![image](https://user-images.githubusercontent.com/1134248/218050928-72357430-056e-4f72-a584-380b78e11d57.png)\r\n\r\nHowever, this should not result in issues with reading null values. Let me try to reproduce this on my end","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1425472316/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1425488573","html_url":"https://github.com/apache/iceberg/issues/6796#issuecomment-1425488573","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6796","id":1425488573,"node_id":"IC_kwDOCW7NX85U9zq9","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-10T09:25:23Z","updated_at":"2023-02-10T09:25:23Z","author_association":"CONTRIBUTOR","body":"Can you share how you append the records to the table? This blog might also be helpful for what you're trying to achieve: https://tabular.io/blog/java-api-part-3/","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1425488573/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1425519691","html_url":"https://github.com/apache/iceberg/issues/6798#issuecomment-1425519691","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6798","id":1425519691,"node_id":"IC_kwDOCW7NX85U97RL","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-10T09:39:08Z","updated_at":"2023-02-10T09:39:08Z","author_association":"CONTRIBUTOR","body":"Hey @haizhou-zhao thanks for the elaborate explanation, much appreciated.\r\n\r\nI ran into the same issue with generating the classes for PyIceberg. I tried to do this using the generator but ran into the same issue that a type can be both a string and an object (or a dictionary in Python world). I ended up generating the code and implementing a custom parser to distinguish between the primitive and complex types. Agreed that having this as an object is nicer because this would also allow us not to have to parse the `fixed[22]` and just have `{'typeId': 'fixed', 'length': 22}`. Changing this is possible, but would be quite a bit endeavor since we would have to keep backward compatibility.\r\n\r\nDid you consider relying on the Iceberg library itself for parsing the schema?\r\n\r\nRelated to https://github.com/apache/iceberg/pull/6672","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1425519691/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1425523063","html_url":"https://github.com/apache/iceberg/issues/6796#issuecomment-1425523063","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6796","id":1425523063,"node_id":"IC_kwDOCW7NX85U98F3","user":{"login":"romanstreamsets","id":94020795,"node_id":"U_kgDOBZqkuw","avatar_url":"https://avatars.githubusercontent.com/u/94020795?v=4","gravatar_id":"","url":"https://api.github.com/users/romanstreamsets","html_url":"https://github.com/romanstreamsets","followers_url":"https://api.github.com/users/romanstreamsets/followers","following_url":"https://api.github.com/users/romanstreamsets/following{/other_user}","gists_url":"https://api.github.com/users/romanstreamsets/gists{/gist_id}","starred_url":"https://api.github.com/users/romanstreamsets/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/romanstreamsets/subscriptions","organizations_url":"https://api.github.com/users/romanstreamsets/orgs","repos_url":"https://api.github.com/users/romanstreamsets/repos","events_url":"https://api.github.com/users/romanstreamsets/events{/privacy}","received_events_url":"https://api.github.com/users/romanstreamsets/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-10T09:42:06Z","updated_at":"2023-02-10T09:42:06Z","author_association":"NONE","body":"Hi @Fokko \r\nThat blog is exactly where I got my initial code. I have changed the source of my schema from \"manual\" to Avro schema supplied as a String, because that's my use case.\r\nSomething I have found since posting this issue.\r\nAs you reproduced, conversion of Avro Schema renders an Iceberg Schema where field IDs are numbered starting from 0. It doesn't matter whether fields are required or optional.\r\nHowever, at the time when I call catalog.createTable(..., icebergSchema, ...) method, in the resulting schema fields IDs will be numbered form 1.\r\nWhen I call \"create table\" in Spark/Hive, the schema is also created with fields IDs starting from 1.\r\nSo, my workaround currently is:\r\n```\r\navroConvertedSchema = AvroSchemaUtil.convert(avroSchema);\r\ntable = catalog.tableCreate(..., avroConvertedSchema, ...);\r\nicebergSchema = table.schema();\r\n... // then I use icebergSchema when writing records to the file\r\n```\r\nIn this case, avroConvertedSchema is not the same as icebergSchema, exactly in field IDs numbering.\r\nSo, the convert() method should number IDs from 1.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1425523063/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1425782324","html_url":"https://github.com/apache/iceberg/issues/6796#issuecomment-1425782324","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6796","id":1425782324,"node_id":"IC_kwDOCW7NX85U-7Y0","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-10T13:04:40Z","updated_at":"2023-02-10T13:04:40Z","author_association":"CONTRIBUTOR","body":"I think we have to start the schema from 1 anyway, I took the liberty and created a PR: https://github.com/apache/iceberg/pull/6802\r\n\r\nI'm still very curious to see whats going on with Hive, returning a null. But this requires me to setup a hive setup, but that takes a bit more time.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1425782324/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1425887503","html_url":"https://github.com/apache/iceberg/issues/6803#issuecomment-1425887503","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6803","id":1425887503,"node_id":"IC_kwDOCW7NX85U_VEP","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-10T14:29:24Z","updated_at":"2023-02-10T14:30:25Z","author_association":"CONTRIBUTOR","body":"your `iceberg-spark-runtime-3.2_2.12-0.13.2.jar` points to iceberg 0.13.2 while others use iceberg 1.1.0, so that would explain the issue (which is a result of mixed library versions on the class path). Can you retry with `iceberg-spark-runtime-3.2_2.12-1.1.0.jar` only and make sure to remove `iceberg-spark-runtime-3.2_2.12-0.13.2.jar`","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1425887503/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1425896304","html_url":"https://github.com/apache/iceberg/issues/6803#issuecomment-1425896304","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6803","id":1425896304,"node_id":"IC_kwDOCW7NX85U_XNw","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-10T14:36:40Z","updated_at":"2023-02-10T14:36:40Z","author_association":"MEMBER","body":"I believe @nastra  meant to edit your cli command like this\r\n~~--jars iceberg-hive-runtime-1.1.0.jar,iceberg-spark-runtime-3.2_2.12-0.13.2.jar,iceberg-api-1.1.0.jar~~ --packages org.apache.iceberg:iceberg-spark-runtime-3.2_2.12:1.1.0 \r\n\r\nThis would prevent the multiple versions and remove the unnecessary \"icberg-api\" which is already included in the runtime, and \"iceberg-hive-runtime\" jar which is not needed at all with spark.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1425896304/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426082854","html_url":"https://github.com/apache/iceberg/issues/6420#issuecomment-1426082854","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6420","id":1426082854,"node_id":"IC_kwDOCW7NX85VAEwm","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-10T16:56:18Z","updated_at":"2023-02-10T16:56:18Z","author_association":"CONTRIBUTOR","body":"@wmoustafa @JanKaul \r\n\r\nI had some brief discussion about this topic in the community sync this Wednesday, and looking at this thread, I think there is already a consensus about the MV spec. Can we proceed to the actual spec change? Do you have the bandwidth to do that? If not I am also interested in making that change.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426082854/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426085222","html_url":"https://github.com/apache/iceberg/pull/6799#issuecomment-1426085222","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6799","id":1426085222,"node_id":"IC_kwDOCW7NX85VAFVm","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-10T16:58:10Z","updated_at":"2023-02-10T16:58:10Z","author_association":"CONTRIBUTOR","body":"I am picking up https://github.com/apache/iceberg/pull/5893 where @sumeetgajjar left off, as he is now pursuing other projects.\r\n@rdblue I believe Sumeet has addressed your feedback. Compression level is an Integer, to allow for it to be null (for codecs that do not use compression level), and I have used `PropertyUtil.propertyAsNullableInt` to turn the String into an Integer. Sumeet has removed unnecessary changes from tests and only added new tests.\r\nI have rebased Sumeet's changes on master, fixed some issues, and moved the Flink changes from 1.15 to 1.16 (the current default Flink version).\r\nThis is ready for review.\r\ncc @nastra and @amogh-jahagirdar who reviewed the original PR as well.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426085222/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426168486","html_url":"https://github.com/apache/iceberg/issues/6798#issuecomment-1426168486","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6798","id":1426168486,"node_id":"IC_kwDOCW7NX85VAZqm","user":{"login":"haizhou-zhao","id":6187287,"node_id":"MDQ6VXNlcjYxODcyODc=","avatar_url":"https://avatars.githubusercontent.com/u/6187287?v=4","gravatar_id":"","url":"https://api.github.com/users/haizhou-zhao","html_url":"https://github.com/haizhou-zhao","followers_url":"https://api.github.com/users/haizhou-zhao/followers","following_url":"https://api.github.com/users/haizhou-zhao/following{/other_user}","gists_url":"https://api.github.com/users/haizhou-zhao/gists{/gist_id}","starred_url":"https://api.github.com/users/haizhou-zhao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/haizhou-zhao/subscriptions","organizations_url":"https://api.github.com/users/haizhou-zhao/orgs","repos_url":"https://api.github.com/users/haizhou-zhao/repos","events_url":"https://api.github.com/users/haizhou-zhao/events{/privacy}","received_events_url":"https://api.github.com/users/haizhou-zhao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-10T18:14:31Z","updated_at":"2023-02-10T18:14:31Z","author_association":"CONTRIBUTOR","body":"@Fokko Thanks for your response. If I understand you correctly, both of us found that the generated models from the provided OpenAPI spec is different from the existing models provided by iceberg java library, and therefore might be unusable to parse the existing schema and other Iceberg Metadata. So in summary, it sounds like the current OpenAPI spec is \"incorrect\". Let me know this is the right claim.\r\n\r\nFirst, thanks for bringing to my attention this PR https://github.com/apache/iceberg/pull/6672, I think this is a worthy effort and will improve the quality of Iceberg's Open API spec in the long run.\r\n\r\nSecondly, yes, I'm considering using iceberg-core library to parse Iceberg Metadata (including schema information). Just like what you experienced, I don't think the current OpenAPI generated model could be used to parse an Iceberg Metadata File, then using the original java lib sounds like a good temporary work around.\r\n\r\nFinally, since we talked about potentially correct the OpenAPI spec, I'd like to learn more about the \"endeavor\" we need to take to update it. Regarding backward compatibility, I'm trying to make a bold guess: if the current OpenAPI spec defined model is not usable for parsing Iceberg Metadata, then perhaps not very much people are actually using it? I'm trying to get an idea whether the current OpenAPI spec is closer to alpha testing, or it's fully production launched. If it is just in alpha testing stage, then perhaps backward compatibility is not very important?\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426168486/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426201751","html_url":"https://github.com/apache/iceberg/pull/6802#issuecomment-1426201751","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6802","id":1426201751,"node_id":"IC_kwDOCW7NX85VAhyX","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-10T18:47:08Z","updated_at":"2023-02-10T18:47:08Z","author_association":"CONTRIBUTOR","body":"I'm -1 on this change. I think that we want failures like #6796.\r\n\r\nWhen writing to a table, **you must always write using the table's schema**. You can't guess at what the schema will be or how the field IDs are probably assigned. It is always incorrect to create a table, create an Avro schema independently, and then use that Avro schema, even if it works in some cases because assignment is the same.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426201751/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426203778","html_url":"https://github.com/apache/iceberg/issues/6796#issuecomment-1426203778","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6796","id":1426203778,"node_id":"IC_kwDOCW7NX85VAiSC","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-10T18:49:27Z","updated_at":"2023-02-10T18:49:27Z","author_association":"CONTRIBUTOR","body":"I looked at @Fokko's PR, but I think that it doesn't address the underlying problem.\r\n\r\nIt looks like the flow here is to take a schema then convert to Iceberg and create a table. Then convert the schema to Avro and expect that it matches the table. That is incorrect. When writing to a table, you must always use the table's schema. Tables are responsible for assigning and tracking field IDs and you should never guess at what they will probably be.\r\n\r\nThe right solution is to convert your schema to Iceberg and create the table, then throw it away and use the table's schema. Convert the table schema to Avro and write records that way.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426203778/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426239116","html_url":"https://github.com/apache/iceberg/issues/6420#issuecomment-1426239116","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6420","id":1426239116,"node_id":"IC_kwDOCW7NX85VAq6M","user":{"login":"wmoustafa","id":10084105,"node_id":"MDQ6VXNlcjEwMDg0MTA1","avatar_url":"https://avatars.githubusercontent.com/u/10084105?v=4","gravatar_id":"","url":"https://api.github.com/users/wmoustafa","html_url":"https://github.com/wmoustafa","followers_url":"https://api.github.com/users/wmoustafa/followers","following_url":"https://api.github.com/users/wmoustafa/following{/other_user}","gists_url":"https://api.github.com/users/wmoustafa/gists{/gist_id}","starred_url":"https://api.github.com/users/wmoustafa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wmoustafa/subscriptions","organizations_url":"https://api.github.com/users/wmoustafa/orgs","repos_url":"https://api.github.com/users/wmoustafa/repos","events_url":"https://api.github.com/users/wmoustafa/events{/privacy}","received_events_url":"https://api.github.com/users/wmoustafa/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-10T19:23:14Z","updated_at":"2023-02-10T19:23:14Z","author_association":"CONTRIBUTOR","body":"+1. We can proceed.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426239116/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426338304","html_url":"https://github.com/apache/iceberg/pull/6642#issuecomment-1426338304","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6642","id":1426338304,"node_id":"IC_kwDOCW7NX85VBDIA","user":{"login":"JonasJ-ap","id":55990951,"node_id":"MDQ6VXNlcjU1OTkwOTUx","avatar_url":"https://avatars.githubusercontent.com/u/55990951?v=4","gravatar_id":"","url":"https://api.github.com/users/JonasJ-ap","html_url":"https://github.com/JonasJ-ap","followers_url":"https://api.github.com/users/JonasJ-ap/followers","following_url":"https://api.github.com/users/JonasJ-ap/following{/other_user}","gists_url":"https://api.github.com/users/JonasJ-ap/gists{/gist_id}","starred_url":"https://api.github.com/users/JonasJ-ap/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JonasJ-ap/subscriptions","organizations_url":"https://api.github.com/users/JonasJ-ap/orgs","repos_url":"https://api.github.com/users/JonasJ-ap/repos","events_url":"https://api.github.com/users/JonasJ-ap/events{/privacy}","received_events_url":"https://api.github.com/users/JonasJ-ap/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-10T20:59:45Z","updated_at":"2023-02-10T20:59:45Z","author_association":"CONTRIBUTOR","body":"Souds Good! Thank you for your suggestions.  After the last community sync, I re-investigate the whole process of this demo and realize that there is no proper way to guarantee the correct order of timeline replay. \r\n\r\nIn the new proposal, the expected migration guarantee is that we always migrate the table at the state of lastest COMPACTION. In other words, we only include the most updated base file in each file group of the hudi table. In this way, users can choose to do compaction before the migration if they want the most updated table or do nothing if they do not want to include newly arrived data.\r\n\r\nI will start to investigate the proper way to implement this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426338304/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426350972","html_url":"https://github.com/apache/iceberg/pull/6802#issuecomment-1426350972","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6802","id":1426350972,"node_id":"IC_kwDOCW7NX85VBGN8","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-10T21:09:29Z","updated_at":"2023-02-10T21:09:29Z","author_association":"CONTRIBUTOR","body":"@rdblue ah, I see also the problem now and I agree.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426350972/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426354103","html_url":"https://github.com/apache/iceberg/pull/6805#issuecomment-1426354103","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6805","id":1426354103,"node_id":"IC_kwDOCW7NX85VBG-3","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-10T21:13:12Z","updated_at":"2023-02-10T21:13:12Z","author_association":"CONTRIBUTOR","body":"Thanks @Guillem96 for opening this. And I agree that `Self` would be much nicer. However, I see that there are mypy errors. Both the original author and I tried using Self, but ended up with weird errors: https://github.com/apache/iceberg/pull/6233#discussion_r1027642501","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426354103/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426363841","html_url":"https://github.com/apache/iceberg/issues/6781#issuecomment-1426363841","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6781","id":1426363841,"node_id":"IC_kwDOCW7NX85VBJXB","user":{"login":"JonasJ-ap","id":55990951,"node_id":"MDQ6VXNlcjU1OTkwOTUx","avatar_url":"https://avatars.githubusercontent.com/u/55990951?v=4","gravatar_id":"","url":"https://api.github.com/users/JonasJ-ap","html_url":"https://github.com/JonasJ-ap","followers_url":"https://api.github.com/users/JonasJ-ap/followers","following_url":"https://api.github.com/users/JonasJ-ap/following{/other_user}","gists_url":"https://api.github.com/users/JonasJ-ap/gists{/gist_id}","starred_url":"https://api.github.com/users/JonasJ-ap/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JonasJ-ap/subscriptions","organizations_url":"https://api.github.com/users/JonasJ-ap/orgs","repos_url":"https://api.github.com/users/JonasJ-ap/repos","events_url":"https://api.github.com/users/JonasJ-ap/events{/privacy}","received_events_url":"https://api.github.com/users/JonasJ-ap/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-10T21:24:57Z","updated_at":"2023-02-10T21:28:35Z","author_association":"CONTRIBUTOR","body":"Thank you for your suggestion. I see the point that we should make the migration action work out-of-box. I will focus on the solution 2.\r\n\r\n>  Does each log has a unique ID? Is that useable by end users? \r\n\r\nEach delta log has a unique id called `version` associate with it. Delta Lake also have public API to construct a snapshot up til the specified log/version. Users can also give exact or rough timestamp and use APIs like [`getVersionAtOrAfterTimestamp`](https://delta-io.github.io/connectors/latest/delta-standalone/api/java/io/delta/standalone/DeltaLog.html#getVersionAtOrAfterTimestamp-long-) or [`getSnapshotForTimestampAsOf`](https://delta-io.github.io/connectors/latest/delta-standalone/api/java/io/delta/standalone/DeltaLog.html#getSnapshotForTimestampAsOf-long-) to retrieve the version number or the snapshot directly. Since delta lake offers many APIs to interact with the version number, I initially thought letting users configure the starting version may be a good idea. But now I agree that the starting version is better to be an internal conception in our migration logic\r\n\r\n> is that the same experience in Databricks Delta? I think it should not be, because there needs to be a process to keep the delta log size short\r\n\r\nI am not quite sure about the difference between Databricks Delta and Detla Lake tables on other platform (such as AWS). (My Databricks free account expires several weeks ago....). But for the delta log size I believe it is maintained separately and automatically by the Delta Lake table.\r\n\r\nRef: https://docs.delta.io/latest/delta-batch.html#-data-retention\r\nDelta Lake Logs that are older than `delta.logRententionDuration` will be deleted each time a checkpoint is formed (normally each 10 commits). Currently we rely on [`getVersionAtOrAfterTimestamp`](https://delta-io.github.io/connectors/latest/delta-standalone/api/java/io/delta/standalone/DeltaLog.html#getVersionAtOrAfterTimestamp-long-) API to determine the earliest  possible log version in the current table rather than hardcode `version 0` at the early stage of that PR. So I think Delta's log cleaning process is handled properly now. I will double-check this when doing the fix for `VACUUM` and apply similar try-catch logic to determine the start version if necessary. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426363841/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426384589","html_url":"https://github.com/apache/iceberg/pull/6792#issuecomment-1426384589","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6792","id":1426384589,"node_id":"IC_kwDOCW7NX85VBObN","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-10T21:48:04Z","updated_at":"2023-02-10T21:48:04Z","author_association":"CONTRIBUTOR","body":"Thanks, @jackye1995 @szehon-ho @singhpk234!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426384589/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426386512","html_url":"https://github.com/apache/iceberg/pull/6793#issuecomment-1426386512","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6793","id":1426386512,"node_id":"IC_kwDOCW7NX85VBO5Q","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-10T21:50:46Z","updated_at":"2023-02-10T21:50:46Z","author_association":"CONTRIBUTOR","body":"> I wonder if there's something at the spotless level we can configure so the comment formatting maximizes line length usage more. \r\n\r\nYeah, it would make sense to explore but I am also afraid purely auto formatting may be suboptimal in some cases. Let me know once you have PRs for other parts. I think it is better to make them targeted vs one giant PR.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426386512/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426386706","html_url":"https://github.com/apache/iceberg/pull/6793#issuecomment-1426386706","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6793","id":1426386706,"node_id":"IC_kwDOCW7NX85VBO8S","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-10T21:51:01Z","updated_at":"2023-02-10T21:51:01Z","author_association":"CONTRIBUTOR","body":"Thanks, @amogh-jahagirdar @Fokko!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426386706/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426394848","html_url":"https://github.com/apache/iceberg/pull/6637#issuecomment-1426394848","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6637","id":1426394848,"node_id":"IC_kwDOCW7NX85VBQ7g","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-10T21:59:33Z","updated_at":"2023-02-10T21:59:33Z","author_association":"CONTRIBUTOR","body":"All the comments are addressed and we have enough votes, so I will go ahead to merge it. I requested @aokolnychyi for further review and approval, but given it has been quite a few days, and there is a subsequent DROP TAG PR anyway, we can move forward and address any missing comments there.\r\n\r\nThanks for the contribution @hililiwei , and thanks everyone for the review!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426394848/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426404552","html_url":"https://github.com/apache/iceberg/issues/6778#issuecomment-1426404552","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6778","id":1426404552,"node_id":"IC_kwDOCW7NX85VBTTI","user":{"login":"agnes-xinyi-lu","id":124839592,"node_id":"U_kgDOB3DmqA","avatar_url":"https://avatars.githubusercontent.com/u/124839592?v=4","gravatar_id":"","url":"https://api.github.com/users/agnes-xinyi-lu","html_url":"https://github.com/agnes-xinyi-lu","followers_url":"https://api.github.com/users/agnes-xinyi-lu/followers","following_url":"https://api.github.com/users/agnes-xinyi-lu/following{/other_user}","gists_url":"https://api.github.com/users/agnes-xinyi-lu/gists{/gist_id}","starred_url":"https://api.github.com/users/agnes-xinyi-lu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/agnes-xinyi-lu/subscriptions","organizations_url":"https://api.github.com/users/agnes-xinyi-lu/orgs","repos_url":"https://api.github.com/users/agnes-xinyi-lu/repos","events_url":"https://api.github.com/users/agnes-xinyi-lu/events{/privacy}","received_events_url":"https://api.github.com/users/agnes-xinyi-lu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-10T22:09:46Z","updated_at":"2023-02-10T22:09:46Z","author_association":"CONTRIBUTOR","body":"I created a sample test to illustrate this issue : https://github.com/agnes-xinyi-lu/iceberg/pull/1\r\nBasically in the end the server thinks it committed the insertion but client thinks otherwise, which caused issues on both sides.\r\n@nastra @rdblue ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426404552/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426446813","html_url":"https://github.com/apache/iceberg/pull/6797#issuecomment-1426446813","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6797","id":1426446813,"node_id":"IC_kwDOCW7NX85VBdnd","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-10T22:50:55Z","updated_at":"2023-02-10T22:50:55Z","author_association":"COLLABORATOR","body":"Hi @dramaticlly , looking briefly through this code.  It seems we get added-files via snapshot summary so it seems ok to get it this way for changed-partitions.\r\n\r\nI'm a bit confused though, it seems it only sets if changed partitions <= write.summary.partition-limit, whose default is 0.  Does it usually set in your case?  Ref: https://github.com/apache/iceberg/blob/master/core/src/main/java/org/apache/iceberg/SnapshotSummary.java#L194 \r\n\r\nI havent walked through the code though, so I could be wrong.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426446813/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426455414","html_url":"https://github.com/apache/iceberg/pull/6717#issuecomment-1426455414","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6717","id":1426455414,"node_id":"IC_kwDOCW7NX85VBft2","user":{"login":"namrathamyske","id":17932873,"node_id":"MDQ6VXNlcjE3OTMyODcz","avatar_url":"https://avatars.githubusercontent.com/u/17932873?v=4","gravatar_id":"","url":"https://api.github.com/users/namrathamyske","html_url":"https://github.com/namrathamyske","followers_url":"https://api.github.com/users/namrathamyske/followers","following_url":"https://api.github.com/users/namrathamyske/following{/other_user}","gists_url":"https://api.github.com/users/namrathamyske/gists{/gist_id}","starred_url":"https://api.github.com/users/namrathamyske/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/namrathamyske/subscriptions","organizations_url":"https://api.github.com/users/namrathamyske/orgs","repos_url":"https://api.github.com/users/namrathamyske/repos","events_url":"https://api.github.com/users/namrathamyske/events{/privacy}","received_events_url":"https://api.github.com/users/namrathamyske/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-10T22:59:56Z","updated_at":"2023-02-10T22:59:56Z","author_association":"CONTRIBUTOR","body":"@aokolnychyi can you take a look at this ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426455414/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426514651","html_url":"https://github.com/apache/iceberg/issues/5216#issuecomment-1426514651","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5216","id":1426514651,"node_id":"IC_kwDOCW7NX85VBuLb","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-02-11T00:10:42Z","updated_at":"2023-02-11T00:10:42Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426514651/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426545094","html_url":"https://github.com/apache/iceberg/pull/6752#issuecomment-1426545094","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6752","id":1426545094,"node_id":"IC_kwDOCW7NX85VB1nG","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-11T00:59:10Z","updated_at":"2023-02-11T00:59:10Z","author_association":"CONTRIBUTOR","body":"Looks like all comments are addressed and we have enough vote, I will go ahead and merge this. We can address further comments in the subsequent DROP TAG PR if necessary. Thanks for the work @amogh-jahagirdar & @hililiwei , and thanks for everyone's review!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426545094/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426546586","html_url":"https://github.com/apache/iceberg/pull/6797#issuecomment-1426546586","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6797","id":1426546586,"node_id":"IC_kwDOCW7NX85VB1-a","user":{"login":"dramaticlly","id":5961173,"node_id":"MDQ6VXNlcjU5NjExNzM=","avatar_url":"https://avatars.githubusercontent.com/u/5961173?v=4","gravatar_id":"","url":"https://api.github.com/users/dramaticlly","html_url":"https://github.com/dramaticlly","followers_url":"https://api.github.com/users/dramaticlly/followers","following_url":"https://api.github.com/users/dramaticlly/following{/other_user}","gists_url":"https://api.github.com/users/dramaticlly/gists{/gist_id}","starred_url":"https://api.github.com/users/dramaticlly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dramaticlly/subscriptions","organizations_url":"https://api.github.com/users/dramaticlly/orgs","repos_url":"https://api.github.com/users/dramaticlly/repos","events_url":"https://api.github.com/users/dramaticlly/events{/privacy}","received_events_url":"https://api.github.com/users/dramaticlly/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-11T01:03:11Z","updated_at":"2023-02-11T01:03:11Z","author_association":"CONTRIBUTOR","body":"> Hi @dramaticlly , looking briefly through this code. It seems we get added-files via snapshot summary so it seems ok to get it this way for changed-partitions.\r\n> \r\n> I'm a bit confused though, it seems it only sets if changed partitions <= write.summary.partition-limit, whose default is 0. Does it usually set in your case? Ref: https://github.com/apache/iceberg/blob/master/core/src/main/java/org/apache/iceberg/SnapshotSummary.java#L194\r\n> \r\n> I havent walked through the code though, so I could be wrong.\r\n\r\nthank you @szehon-ho for the quick review. I believe what you linked line 194 is not for partition changed count, the [line 192](https://github.com/apache/iceberg/blob/master/core/src/main/java/org/apache/iceberg/SnapshotSummary.java#L192) is what matters, is only check if `trustPartitionMetrics` is evaluated to true. The `trustPartitionMetrics` is default to true in builder, only set to false when manifests get added per https://github.com/apache/iceberg/blob/master/core/src/main/java/org/apache/iceberg/SnapshotSummary.java#L142.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426546586/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426597008","html_url":"https://github.com/apache/iceberg/pull/6765#issuecomment-1426597008","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6765","id":1426597008,"node_id":"IC_kwDOCW7NX85VCCSQ","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-11T03:54:33Z","updated_at":"2023-02-11T03:54:33Z","author_association":"CONTRIBUTOR","body":"Merged. Thanks @pvary for the review.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426597008/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426768524","html_url":"https://github.com/apache/iceberg/issues/6420#issuecomment-1426768524","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6420","id":1426768524,"node_id":"IC_kwDOCW7NX85VCsKM","user":{"login":"JanKaul","id":19823005,"node_id":"MDQ6VXNlcjE5ODIzMDA1","avatar_url":"https://avatars.githubusercontent.com/u/19823005?v=4","gravatar_id":"","url":"https://api.github.com/users/JanKaul","html_url":"https://github.com/JanKaul","followers_url":"https://api.github.com/users/JanKaul/followers","following_url":"https://api.github.com/users/JanKaul/following{/other_user}","gists_url":"https://api.github.com/users/JanKaul/gists{/gist_id}","starred_url":"https://api.github.com/users/JanKaul/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JanKaul/subscriptions","organizations_url":"https://api.github.com/users/JanKaul/orgs","repos_url":"https://api.github.com/users/JanKaul/repos","events_url":"https://api.github.com/users/JanKaul/events{/privacy}","received_events_url":"https://api.github.com/users/JanKaul/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-11T13:23:31Z","updated_at":"2023-02-11T13:23:31Z","author_association":"NONE","body":"Thank you @jackye1995 for your initiative. I have created a new [google doc](https://docs.google.com/document/d/1UnhldHhe3Grz8JBngwXPA6ZZord1xMedY5ukEhZYF-A/edit?usp=sharing) to discuss the actual specification for materialized views.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426768524/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426775281","html_url":"https://github.com/apache/iceberg/issues/6420#issuecomment-1426775281","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6420","id":1426775281,"node_id":"IC_kwDOCW7NX85VCtzx","user":{"login":"JanKaul","id":19823005,"node_id":"MDQ6VXNlcjE5ODIzMDA1","avatar_url":"https://avatars.githubusercontent.com/u/19823005?v=4","gravatar_id":"","url":"https://api.github.com/users/JanKaul","html_url":"https://github.com/JanKaul","followers_url":"https://api.github.com/users/JanKaul/followers","following_url":"https://api.github.com/users/JanKaul/following{/other_user}","gists_url":"https://api.github.com/users/JanKaul/gists{/gist_id}","starred_url":"https://api.github.com/users/JanKaul/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JanKaul/subscriptions","organizations_url":"https://api.github.com/users/JanKaul/orgs","repos_url":"https://api.github.com/users/JanKaul/repos","events_url":"https://api.github.com/users/JanKaul/events{/privacy}","received_events_url":"https://api.github.com/users/JanKaul/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-11T13:47:53Z","updated_at":"2023-02-11T13:47:53Z","author_association":"NONE","body":"Another point I would like to discuss is whether the storage table should be registered in the catalog. I brought this up before but I think people haven't really voted for a solution. Generally the storage table can either be registered in the catalog or not. Most proposals in this thread suggested to register both the view and the storage table in the catalog. I would like to propose to only register the view in the catalog. My reasoning is that a materialized view is one logical entity and should therefore also appear in the catalog as one entity. This is also the behavior of most RDBMS and also cloud data warehouses like snowflake.\r\n\r\n|             | Strategy 1: register storage table in catalog                                                                                                      | Strategy 2: don't register storage table in catalog                                                                                                                                                                                     |\r\n| ----------- | -------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\r\n| Description | Metadata locations for the view and storage table are stored in the catalog. Since both locations are tracked, each transaction is automatically atomic. | Only the location of the main view is stored in the catalog. A reference to the storage table metadata location is stored in the main view. An atomic update of this reference is the basis for making atomic changes to the storage table metadata file. |\r\n| Pros        | <ul><li>Storage table can be addressed in the catalog</li><li>Simple implementation</li></ul>                                                            | <ul><li>only one entry for materialized view</li></ul>                                                                                                                                                                                                    |\r\n| Cons        | <ul><li>2 entities appear in the catalog</li></ul>                                                                                                       | <ul><li>definition of commit procedure</li></ul>                                                                                                                                                                                                          |\r\n\r\nReact with the following if you prefer one of the strategies:\r\n:tada:  for strategy 1\r\n:rocket: for strategy 2\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426775281/reactions","total_count":4,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":3,"eyes":1},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426821097","html_url":"https://github.com/apache/iceberg/issues/6420#issuecomment-1426821097","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6420","id":1426821097,"node_id":"IC_kwDOCW7NX85VC4_p","user":{"login":"wmoustafa","id":10084105,"node_id":"MDQ6VXNlcjEwMDg0MTA1","avatar_url":"https://avatars.githubusercontent.com/u/10084105?v=4","gravatar_id":"","url":"https://api.github.com/users/wmoustafa","html_url":"https://github.com/wmoustafa","followers_url":"https://api.github.com/users/wmoustafa/followers","following_url":"https://api.github.com/users/wmoustafa/following{/other_user}","gists_url":"https://api.github.com/users/wmoustafa/gists{/gist_id}","starred_url":"https://api.github.com/users/wmoustafa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wmoustafa/subscriptions","organizations_url":"https://api.github.com/users/wmoustafa/orgs","repos_url":"https://api.github.com/users/wmoustafa/repos","events_url":"https://api.github.com/users/wmoustafa/events{/privacy}","received_events_url":"https://api.github.com/users/wmoustafa/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-11T16:50:10Z","updated_at":"2023-02-11T16:50:10Z","author_association":"CONTRIBUTOR","body":"Agree it makes more sense to store as one logical entity. Also I think to register with two names, we would have to assign the view and the table different names. The consequences of that are not clear.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426821097/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426852565","html_url":"https://github.com/apache/iceberg/issues/6420#issuecomment-1426852565","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6420","id":1426852565,"node_id":"IC_kwDOCW7NX85VDArV","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-11T18:52:16Z","updated_at":"2023-02-11T18:57:21Z","author_association":"CONTRIBUTOR","body":"I think it has to be a catalog-specific decision, because as you said Snowflake has that hidden, but for example Trino view on Hive/Glue has the storage table exposed. So I am not sure if it needs to be a part of the spec or not.\r\n\r\nI think these are different type of catalogs, typically we distinguish them as **business data catalog** and **technical data catalog**. The former is more oriented for end user, whereas the later is more oriented to technical users that would like to see all the hidden stuffs.\r\n\r\nFrom implementation perspective, why does approach 2 need \"definition of commit procedure\" but not in 1? I think it's just a matter of hide the storage table or not, but there will always be 2 objects behind the scene.\r\n\r\nBtw, @nastra is already doing a proposal of multi-table transaction, so I think that problem will be solved there and we don't need to worry in the MV spec.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426852565/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426863641","html_url":"https://github.com/apache/iceberg/issues/6420#issuecomment-1426863641","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6420","id":1426863641,"node_id":"IC_kwDOCW7NX85VDDYZ","user":{"login":"JanKaul","id":19823005,"node_id":"MDQ6VXNlcjE5ODIzMDA1","avatar_url":"https://avatars.githubusercontent.com/u/19823005?v=4","gravatar_id":"","url":"https://api.github.com/users/JanKaul","html_url":"https://github.com/JanKaul","followers_url":"https://api.github.com/users/JanKaul/followers","following_url":"https://api.github.com/users/JanKaul/following{/other_user}","gists_url":"https://api.github.com/users/JanKaul/gists{/gist_id}","starred_url":"https://api.github.com/users/JanKaul/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JanKaul/subscriptions","organizations_url":"https://api.github.com/users/JanKaul/orgs","repos_url":"https://api.github.com/users/JanKaul/repos","events_url":"https://api.github.com/users/JanKaul/events{/privacy}","received_events_url":"https://api.github.com/users/JanKaul/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-11T19:50:28Z","updated_at":"2023-02-11T19:50:28Z","author_association":"NONE","body":"It would be great if we could make it a catalog-specific decision. But for that the metadata has to be designed to enable both strategies.\r\n\r\nI think the question is what do we use as an unique identifier for the storage table in the representation of the common view?\r\n\r\nOne approach is to use **table_name, namespace and catalog** as unique identifier. But this only works if the storage table is registered in the catalog. Furthermore, without being registered in the catalog, an atomic swap of the storage table metadata file cannot be guaranteed.\r\n\r\nAnother approach would be to use the **storage table metadata file location** as unique identifier. This makes using the catalog a bit more awkward because the tables have to be filtered for the metadata file location. But this approach wouldn't require the storage table to be registered in the catalog. And it would enable atomic transactions on the storage table by making atomic changes to the storage table metadata file location. This is what I meant by commit procedure.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426863641/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426865674","html_url":"https://github.com/apache/iceberg/pull/6772#issuecomment-1426865674","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6772","id":1426865674,"node_id":"IC_kwDOCW7NX85VDD4K","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-11T20:02:15Z","updated_at":"2023-02-11T20:02:15Z","author_association":"CONTRIBUTOR","body":"@amogh-jahagirdar @rajarshisarkar @singhpk234 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426865674/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426871224","html_url":"https://github.com/apache/iceberg/issues/6112#issuecomment-1426871224","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6112","id":1426871224,"node_id":"IC_kwDOCW7NX85VDFO4","user":{"login":"srilman","id":17444967,"node_id":"MDQ6VXNlcjE3NDQ0OTY3","avatar_url":"https://avatars.githubusercontent.com/u/17444967?v=4","gravatar_id":"","url":"https://api.github.com/users/srilman","html_url":"https://github.com/srilman","followers_url":"https://api.github.com/users/srilman/followers","following_url":"https://api.github.com/users/srilman/following{/other_user}","gists_url":"https://api.github.com/users/srilman/gists{/gist_id}","starred_url":"https://api.github.com/users/srilman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/srilman/subscriptions","organizations_url":"https://api.github.com/users/srilman/orgs","repos_url":"https://api.github.com/users/srilman/repos","events_url":"https://api.github.com/users/srilman/events{/privacy}","received_events_url":"https://api.github.com/users/srilman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-11T20:33:49Z","updated_at":"2023-02-11T20:34:03Z","author_association":"CONTRIBUTOR","body":"@MichaelDeSteven are you still working on this? I would like to pick this up if not.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426871224/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426873914","html_url":"https://github.com/apache/iceberg/pull/6772#issuecomment-1426873914","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6772","id":1426873914,"node_id":"IC_kwDOCW7NX85VDF46","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-11T20:48:57Z","updated_at":"2023-02-11T20:48:57Z","author_association":"CONTRIBUTOR","body":"We have different places for creating file path names,\r\n- `LocationProvider` for data files\r\n- `TableOperations.metadataFileLocation` for manifests and manifest lists\r\n-  catalog specific impl for metadata file location (e.g. `BaseMetastoreTableOperations.newTableMetadataFilePath`)\r\n\r\nSo I will restrict this PR to just data location, and do other ones later to avoid having too many changes in different places.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426873914/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426904716","html_url":"https://github.com/apache/iceberg/issues/5540#issuecomment-1426904716","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5540","id":1426904716,"node_id":"IC_kwDOCW7NX85VDNaM","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-02-12T00:12:41Z","updated_at":"2023-02-12T00:12:41Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426904716/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426904721","html_url":"https://github.com/apache/iceberg/issues/5538#issuecomment-1426904721","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5538","id":1426904721,"node_id":"IC_kwDOCW7NX85VDNaR","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-02-12T00:12:43Z","updated_at":"2023-02-12T00:12:43Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426904721/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426904726","html_url":"https://github.com/apache/iceberg/issues/5527#issuecomment-1426904726","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5527","id":1426904726,"node_id":"IC_kwDOCW7NX85VDNaW","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-02-12T00:12:45Z","updated_at":"2023-02-12T00:12:45Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426904726/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426904736","html_url":"https://github.com/apache/iceberg/issues/5487#issuecomment-1426904736","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5487","id":1426904736,"node_id":"IC_kwDOCW7NX85VDNag","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-02-12T00:12:47Z","updated_at":"2023-02-12T00:12:47Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426904736/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426943437","html_url":"https://github.com/apache/iceberg/pull/6686#issuecomment-1426943437","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6686","id":1426943437,"node_id":"IC_kwDOCW7NX85VDW3N","user":{"login":"dependabot[bot]","id":49699333,"node_id":"MDM6Qm90NDk2OTkzMzM=","avatar_url":"https://avatars.githubusercontent.com/in/29110?v=4","gravatar_id":"","url":"https://api.github.com/users/dependabot%5Bbot%5D","html_url":"https://github.com/apps/dependabot","followers_url":"https://api.github.com/users/dependabot%5Bbot%5D/followers","following_url":"https://api.github.com/users/dependabot%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/dependabot%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/dependabot%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dependabot%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/dependabot%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/dependabot%5Bbot%5D/repos","events_url":"https://api.github.com/users/dependabot%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/dependabot%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-02-12T04:57:59Z","updated_at":"2023-02-12T04:57:59Z","author_association":"CONTRIBUTOR","body":"Superseded by #6813.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426943437/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426951648","html_url":"https://github.com/apache/iceberg/issues/6800#issuecomment-1426951648","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6800","id":1426951648,"node_id":"IC_kwDOCW7NX85VDY3g","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-12T06:06:22Z","updated_at":"2023-02-12T06:06:22Z","author_association":"CONTRIBUTOR","body":"Right I remember seeing this during testing when working on some changes to the expire snapshots behavior. Ultimately though as a default behavior I think this is expected, because the metadata file is the root of the metadata tree and is the source of truth for snapshots, and the associated manifest list/manifest metadata files which get cleaned up during expire snapshots. So from this angle, the `ExpireSnapshot`s API should just focus on cleaning up snapshots + manifest list/manifest files based on a single metadata file. `RemoveOrphanFiles` should also be focused on just removing the invalid files themselves and should not get in the business of rewriting metadata.\r\n\r\n**For streaming use-cases would it make more sense to have some kind of \"retain last n\" metadata log entries table property?** \r\n\r\nThat way the number of metadata log entries is always bounded and you can configure according to your desires. cc @stevenzwu who's more familiar on the flink side. \r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426951648/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426952200","html_url":"https://github.com/apache/iceberg/issues/6800#issuecomment-1426952200","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6800","id":1426952200,"node_id":"IC_kwDOCW7NX85VDZAI","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-12T06:11:16Z","updated_at":"2023-02-12T06:11:16Z","author_association":"CONTRIBUTOR","body":"Actually we already have this table property: `write.metadata.previous-versions-max` https://iceberg.apache.org/docs/latest/configuration/#write-properties\r\nand looking at the code it enforces the metadata log size as well. @xuzhiwen1255 could you check if this works well for your streaming use case? \r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426952200/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426956147","html_url":"https://github.com/apache/iceberg/issues/6800#issuecomment-1426956147","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6800","id":1426956147,"node_id":"IC_kwDOCW7NX85VDZ9z","user":{"login":"xuzhiwen1255","id":105710753,"node_id":"U_kgDOBk0EoQ","avatar_url":"https://avatars.githubusercontent.com/u/105710753?v=4","gravatar_id":"","url":"https://api.github.com/users/xuzhiwen1255","html_url":"https://github.com/xuzhiwen1255","followers_url":"https://api.github.com/users/xuzhiwen1255/followers","following_url":"https://api.github.com/users/xuzhiwen1255/following{/other_user}","gists_url":"https://api.github.com/users/xuzhiwen1255/gists{/gist_id}","starred_url":"https://api.github.com/users/xuzhiwen1255/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xuzhiwen1255/subscriptions","organizations_url":"https://api.github.com/users/xuzhiwen1255/orgs","repos_url":"https://api.github.com/users/xuzhiwen1255/repos","events_url":"https://api.github.com/users/xuzhiwen1255/events{/privacy}","received_events_url":"https://api.github.com/users/xuzhiwen1255/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-12T06:43:41Z","updated_at":"2023-02-12T06:43:41Z","author_association":"CONTRIBUTOR","body":"> Actually we already have this table property: `write.metadata.previous-versions-max` https://iceberg.apache.org/docs/latest/configuration/#write-properties and looking at the code it enforces the metadata log size as well. @xuzhiwen1255 could you check if this works well for your streaming use case?\r\n\r\nThank you for your reply.\r\n\r\nI don't quite understand it.I guess if the manifest that this metadata.json file points to no longer exists, I guess it's an orphan file in a sense.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426956147/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426958142","html_url":"https://github.com/apache/iceberg/issues/6800#issuecomment-1426958142","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6800","id":1426958142,"node_id":"IC_kwDOCW7NX85VDac-","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-12T06:59:42Z","updated_at":"2023-02-12T07:04:10Z","author_association":"CONTRIBUTOR","body":"@xuzhiwen1255 I was replying to \r\n\r\n> However, if you write to iceberg through flink and have high real-time requirements, then the ck interval will be very short. If it runs for a long time, I think the metadata-log may be relatively large, although recording this It doesn't take up too much space, but it's redundant.\r\n\r\nThe table property `write.metadata.previous-versions-max` can be configured so that you can control what is the amount of metadata files to retain (and thus the metadata-log size). Please checkout https://iceberg.apache.org/docs/latest/maintenance/#remove-old-metadata-files. This has what you're looking for. \r\n\r\nBased on this you can configure what are considered the number of metadata files, and if there are any older metadata files beyond this \"previous versions\"  they will get cleaned up during orphan file removal. You can configure deleting metadata files on commit as well","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1426958142/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427005724","html_url":"https://github.com/apache/iceberg/issues/6803#issuecomment-1427005724","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6803","id":1427005724,"node_id":"IC_kwDOCW7NX85VDmEc","user":{"login":"suhavangupta","id":20744673,"node_id":"MDQ6VXNlcjIwNzQ0Njcz","avatar_url":"https://avatars.githubusercontent.com/u/20744673?v=4","gravatar_id":"","url":"https://api.github.com/users/suhavangupta","html_url":"https://github.com/suhavangupta","followers_url":"https://api.github.com/users/suhavangupta/followers","following_url":"https://api.github.com/users/suhavangupta/following{/other_user}","gists_url":"https://api.github.com/users/suhavangupta/gists{/gist_id}","starred_url":"https://api.github.com/users/suhavangupta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/suhavangupta/subscriptions","organizations_url":"https://api.github.com/users/suhavangupta/orgs","repos_url":"https://api.github.com/users/suhavangupta/repos","events_url":"https://api.github.com/users/suhavangupta/events{/privacy}","received_events_url":"https://api.github.com/users/suhavangupta/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-12T11:17:33Z","updated_at":"2023-02-12T11:17:33Z","author_association":"NONE","body":"thank you for your quick resonse. Version mismatch was the issue. Thanks","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427005724/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427091999","html_url":"https://github.com/apache/iceberg/issues/6420#issuecomment-1427091999","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6420","id":1427091999,"node_id":"IC_kwDOCW7NX85VD7If","user":{"login":"wmoustafa","id":10084105,"node_id":"MDQ6VXNlcjEwMDg0MTA1","avatar_url":"https://avatars.githubusercontent.com/u/10084105?v=4","gravatar_id":"","url":"https://api.github.com/users/wmoustafa","html_url":"https://github.com/wmoustafa","followers_url":"https://api.github.com/users/wmoustafa/followers","following_url":"https://api.github.com/users/wmoustafa/following{/other_user}","gists_url":"https://api.github.com/users/wmoustafa/gists{/gist_id}","starred_url":"https://api.github.com/users/wmoustafa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wmoustafa/subscriptions","organizations_url":"https://api.github.com/users/wmoustafa/orgs","repos_url":"https://api.github.com/users/wmoustafa/repos","events_url":"https://api.github.com/users/wmoustafa/events{/privacy}","received_events_url":"https://api.github.com/users/wmoustafa/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-12T17:50:33Z","updated_at":"2023-02-12T17:50:45Z","author_association":"CONTRIBUTOR","body":"I think using the user-facing table namespace as an identifier is catalog specific, so I do not think it can make it to the spec. Maybe we should answer: \r\n* Once an engine identifies it should use the storage table version of the view, how does it resolve the view identifier to perform a storage table scan instead of expanding the view text?\r\n\r\nI think this boils down to engines awareness of views being connected to storage tables, and navigating to the table scan APIs from a view entry point. I think using the table storage location (or table UUID) in the view still serves this requirement.\r\n\r\n> because the tables have to be filtered for the metadata file location.\r\n\r\nCould you clarify this a bit more? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427091999/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427096270","html_url":"https://github.com/apache/iceberg/pull/6651#issuecomment-1427096270","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6651","id":1427096270,"node_id":"IC_kwDOCW7NX85VD8LO","user":{"login":"namrathamyske","id":17932873,"node_id":"MDQ6VXNlcjE3OTMyODcz","avatar_url":"https://avatars.githubusercontent.com/u/17932873?v=4","gravatar_id":"","url":"https://api.github.com/users/namrathamyske","html_url":"https://github.com/namrathamyske","followers_url":"https://api.github.com/users/namrathamyske/followers","following_url":"https://api.github.com/users/namrathamyske/following{/other_user}","gists_url":"https://api.github.com/users/namrathamyske/gists{/gist_id}","starred_url":"https://api.github.com/users/namrathamyske/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/namrathamyske/subscriptions","organizations_url":"https://api.github.com/users/namrathamyske/orgs","repos_url":"https://api.github.com/users/namrathamyske/repos","events_url":"https://api.github.com/users/namrathamyske/events{/privacy}","received_events_url":"https://api.github.com/users/namrathamyske/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-12T18:08:50Z","updated_at":"2023-02-12T18:08:50Z","author_association":"CONTRIBUTOR","body":"I have removed all session relate conf changes as per https://github.com/apache/iceberg/pull/6651#discussion_r1101931339","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427096270/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427118191","html_url":"https://github.com/apache/iceberg/pull/6811#issuecomment-1427118191","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6811","id":1427118191,"node_id":"IC_kwDOCW7NX85VEBhv","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-12T19:56:12Z","updated_at":"2023-02-12T19:56:12Z","author_association":"CONTRIBUTOR","body":"+1 when tests are passing.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427118191/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427132713","html_url":"https://github.com/apache/iceberg/issues/6420#issuecomment-1427132713","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6420","id":1427132713,"node_id":"IC_kwDOCW7NX85VEFEp","user":{"login":"JanKaul","id":19823005,"node_id":"MDQ6VXNlcjE5ODIzMDA1","avatar_url":"https://avatars.githubusercontent.com/u/19823005?v=4","gravatar_id":"","url":"https://api.github.com/users/JanKaul","html_url":"https://github.com/JanKaul","followers_url":"https://api.github.com/users/JanKaul/followers","following_url":"https://api.github.com/users/JanKaul/following{/other_user}","gists_url":"https://api.github.com/users/JanKaul/gists{/gist_id}","starred_url":"https://api.github.com/users/JanKaul/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JanKaul/subscriptions","organizations_url":"https://api.github.com/users/JanKaul/orgs","repos_url":"https://api.github.com/users/JanKaul/repos","events_url":"https://api.github.com/users/JanKaul/events{/privacy}","received_events_url":"https://api.github.com/users/JanKaul/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-12T21:05:15Z","updated_at":"2023-02-12T21:05:15Z","author_association":"NONE","body":"When you want to use the metadata file location to retrieve the storage table from a catalog you would need to search all entries for one where the location field of the metadata matches the provided location. Not all catalogs might be capable of such an operation.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427132713/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427133575","html_url":"https://github.com/apache/iceberg/pull/6706#issuecomment-1427133575","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6706","id":1427133575,"node_id":"IC_kwDOCW7NX85VEFSH","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-12T21:09:40Z","updated_at":"2023-02-12T21:09:40Z","author_association":"CONTRIBUTOR","body":"Closing in favor of #6811.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427133575/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427150528","html_url":"https://github.com/apache/iceberg/issues/6796#issuecomment-1427150528","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6796","id":1427150528,"node_id":"IC_kwDOCW7NX85VEJbA","user":{"login":"romanstreamsets","id":94020795,"node_id":"U_kgDOBZqkuw","avatar_url":"https://avatars.githubusercontent.com/u/94020795?v=4","gravatar_id":"","url":"https://api.github.com/users/romanstreamsets","html_url":"https://github.com/romanstreamsets","followers_url":"https://api.github.com/users/romanstreamsets/followers","following_url":"https://api.github.com/users/romanstreamsets/following{/other_user}","gists_url":"https://api.github.com/users/romanstreamsets/gists{/gist_id}","starred_url":"https://api.github.com/users/romanstreamsets/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/romanstreamsets/subscriptions","organizations_url":"https://api.github.com/users/romanstreamsets/orgs","repos_url":"https://api.github.com/users/romanstreamsets/repos","events_url":"https://api.github.com/users/romanstreamsets/events{/privacy}","received_events_url":"https://api.github.com/users/romanstreamsets/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-12T22:35:44Z","updated_at":"2023-02-12T22:35:44Z","author_association":"NONE","body":"Hi @rdblue, what's the rationale behind such treatment of iceberg Schema when creating a table? -\r\n1. Create icebergSchema\r\n2. Create a table\r\n3. discard the original Schema\r\n4. get the correct icebergSchema from the table\r\n\r\nIt just looks like an unnecessary hoop.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427150528/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427158205","html_url":"https://github.com/apache/iceberg/pull/6598#issuecomment-1427158205","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6598","id":1427158205,"node_id":"IC_kwDOCW7NX85VELS9","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-12T23:08:11Z","updated_at":"2023-02-12T23:08:11Z","author_association":"CONTRIBUTOR","body":"No problem! Let me raise a PR to address the banned dependency, sorry about that","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427158205/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427162229","html_url":"https://github.com/apache/iceberg/pull/6651#issuecomment-1427162229","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6651","id":1427162229,"node_id":"IC_kwDOCW7NX85VEMR1","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-12T23:25:07Z","updated_at":"2023-02-12T23:26:35Z","author_association":"CONTRIBUTOR","body":"I raised some more tests to @namrathamyske branch https://github.com/namrathamyske/iceberg/pull/26 please take a look. A couple points I want to raise:\r\n\r\n1.) We won't be able to really write tests for the SparkPositionDeltaWrite until the SQL conf change is in because this PR just focuses on data frame write options. Currently (as far as I can tell) there aren't any row level operations that can be done through dataframes. So here we have 2 options, a.) either just leave the code in SparkPositionDeltaWrite as is, and address the tests in the SQL conf PR or b.) we just table the change for SparkPositionDelta for the SQL PR. My thinking is favoring option b, we shouldn't be merging any changes without test coverage there. Then this PR just focuses on coverage of all the dataframe write operations, which my PR above does address the remainder.\r\n\r\n2.) Behavior of createOrReplaceTable when the branch write option is passed in. Say for example a user does the following:\r\n\r\n```\r\ndata.writeTo(\"prod.db.table\")\r\n    .tableProperty(\"write.format.default\", \"orc\")\r\n    .partitionedBy($\"level\", days($\"ts\"))\r\n   .writeOption(SparkWriteOption.BRANCH, \"branch\")\r\n    .createOrReplace()\r\n```\r\nWhat should the desired behavior be? Currently what happens is the write will be performed on branch and then if it's a replace the main table state will stay the same. So the `replace`  loses its meaning. Another possible desired behavior is the branch is written to and replace will actually perform a replace branch to replace the head of main with the head of the target branch. This is what makes sense to me but I think it'll be hard to achieve this based on catalog/planner abstractions.\r\n\r\nMy thinking for this is we ideally prevent create/replace when there's a write option present just to avoid any confusion. If this isn't achievable then we should document it as a caveat on the behavior of the write option. \r\n\r\nThoughts @namrathamyske @jackye1995 @aokolnychyi @rdblue ?\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427162229/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427173364","html_url":"https://github.com/apache/iceberg/pull/6485#issuecomment-1427173364","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6485","id":1427173364,"node_id":"IC_kwDOCW7NX85VEO_0","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-13T00:09:21Z","updated_at":"2023-02-13T00:09:21Z","author_association":"CONTRIBUTOR","body":"Mostly looks good, but I think we should keep these in the encryption package.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427173364/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427174452","html_url":"https://github.com/apache/iceberg/issues/5553#issuecomment-1427174452","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5553","id":1427174452,"node_id":"IC_kwDOCW7NX85VEPQ0","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-02-13T00:12:16Z","updated_at":"2023-02-13T00:12:16Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427174452/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427174503","html_url":"https://github.com/apache/iceberg/issues/5415#issuecomment-1427174503","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5415","id":1427174503,"node_id":"IC_kwDOCW7NX85VEPRn","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-02-13T00:12:24Z","updated_at":"2023-02-13T00:12:24Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427174503/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427174521","html_url":"https://github.com/apache/iceberg/issues/5408#issuecomment-1427174521","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5408","id":1427174521,"node_id":"IC_kwDOCW7NX85VEPR5","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-02-13T00:12:26Z","updated_at":"2023-02-13T00:12:26Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427174521/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427187523","html_url":"https://github.com/apache/iceberg/pull/6646#issuecomment-1427187523","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6646","id":1427187523,"node_id":"IC_kwDOCW7NX85VESdD","user":{"login":"arminnajafi","id":9739243,"node_id":"MDQ6VXNlcjk3MzkyNDM=","avatar_url":"https://avatars.githubusercontent.com/u/9739243?v=4","gravatar_id":"","url":"https://api.github.com/users/arminnajafi","html_url":"https://github.com/arminnajafi","followers_url":"https://api.github.com/users/arminnajafi/followers","following_url":"https://api.github.com/users/arminnajafi/following{/other_user}","gists_url":"https://api.github.com/users/arminnajafi/gists{/gist_id}","starred_url":"https://api.github.com/users/arminnajafi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/arminnajafi/subscriptions","organizations_url":"https://api.github.com/users/arminnajafi/orgs","repos_url":"https://api.github.com/users/arminnajafi/repos","events_url":"https://api.github.com/users/arminnajafi/events{/privacy}","received_events_url":"https://api.github.com/users/arminnajafi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-13T00:55:49Z","updated_at":"2023-02-13T00:55:49Z","author_association":"CONTRIBUTOR","body":"Thanks for the review @Fokko !\r\n\r\nI addressed most of the comments in the new commits but also asked a few questions.\r\nLet me know whenever you get a chance to go over them. \r\nIt might be easier to discuss some of them in Slack. \r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427187523/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427193723","html_url":"https://github.com/apache/iceberg/issues/6800#issuecomment-1427193723","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6800","id":1427193723,"node_id":"IC_kwDOCW7NX85VET97","user":{"login":"xuzhiwen1255","id":105710753,"node_id":"U_kgDOBk0EoQ","avatar_url":"https://avatars.githubusercontent.com/u/105710753?v=4","gravatar_id":"","url":"https://api.github.com/users/xuzhiwen1255","html_url":"https://github.com/xuzhiwen1255","followers_url":"https://api.github.com/users/xuzhiwen1255/followers","following_url":"https://api.github.com/users/xuzhiwen1255/following{/other_user}","gists_url":"https://api.github.com/users/xuzhiwen1255/gists{/gist_id}","starred_url":"https://api.github.com/users/xuzhiwen1255/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xuzhiwen1255/subscriptions","organizations_url":"https://api.github.com/users/xuzhiwen1255/orgs","repos_url":"https://api.github.com/users/xuzhiwen1255/repos","events_url":"https://api.github.com/users/xuzhiwen1255/events{/privacy}","received_events_url":"https://api.github.com/users/xuzhiwen1255/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-13T01:12:40Z","updated_at":"2023-02-13T01:12:40Z","author_association":"CONTRIBUTOR","body":"> The table property write.metadata.previous-versions-max can be configured so that you can control what is the amount of metadata files to retain (and thus the metadata-log size). Please checkout https://iceberg.apache.org/docs/latest/maintenance/#remove-old-metadata-files. This has what you're looking for.\r\n\r\nThank you for your reply. I know this parameter is used to delete metadata.\r\n\r\nI have a question, that is, when a file is not referenced, it is an orphan file. If the metadata file does not reference the manifest file, should it be considered an orphan file?\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427193723/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427219370","html_url":"https://github.com/apache/iceberg/pull/6735#issuecomment-1427219370","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6735","id":1427219370,"node_id":"IC_kwDOCW7NX85VEaOq","user":{"login":"slfan1989","id":55643692,"node_id":"MDQ6VXNlcjU1NjQzNjky","avatar_url":"https://avatars.githubusercontent.com/u/55643692?v=4","gravatar_id":"","url":"https://api.github.com/users/slfan1989","html_url":"https://github.com/slfan1989","followers_url":"https://api.github.com/users/slfan1989/followers","following_url":"https://api.github.com/users/slfan1989/following{/other_user}","gists_url":"https://api.github.com/users/slfan1989/gists{/gist_id}","starred_url":"https://api.github.com/users/slfan1989/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/slfan1989/subscriptions","organizations_url":"https://api.github.com/users/slfan1989/orgs","repos_url":"https://api.github.com/users/slfan1989/repos","events_url":"https://api.github.com/users/slfan1989/events{/privacy}","received_events_url":"https://api.github.com/users/slfan1989/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-13T02:00:43Z","updated_at":"2023-02-13T02:00:43Z","author_association":"CONTRIBUTOR","body":"@jackye1995 Can you help to merge this pr into the trunk branch? Thank you very much!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427219370/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427268306","html_url":"https://github.com/apache/iceberg/pull/6735#issuecomment-1427268306","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6735","id":1427268306,"node_id":"IC_kwDOCW7NX85VEmLS","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-13T03:10:26Z","updated_at":"2023-02-13T03:10:26Z","author_association":"CONTRIBUTOR","body":"Typically we require two committers to sign off. I see you requested Fokko for review, let me see if I can find someone else tomorrow if he is not available. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427268306/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427286711","html_url":"https://github.com/apache/iceberg/issues/6816#issuecomment-1427286711","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6816","id":1427286711,"node_id":"IC_kwDOCW7NX85VEqq3","user":{"login":"xuzhiwen1255","id":105710753,"node_id":"U_kgDOBk0EoQ","avatar_url":"https://avatars.githubusercontent.com/u/105710753?v=4","gravatar_id":"","url":"https://api.github.com/users/xuzhiwen1255","html_url":"https://github.com/xuzhiwen1255","followers_url":"https://api.github.com/users/xuzhiwen1255/followers","following_url":"https://api.github.com/users/xuzhiwen1255/following{/other_user}","gists_url":"https://api.github.com/users/xuzhiwen1255/gists{/gist_id}","starred_url":"https://api.github.com/users/xuzhiwen1255/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xuzhiwen1255/subscriptions","organizations_url":"https://api.github.com/users/xuzhiwen1255/orgs","repos_url":"https://api.github.com/users/xuzhiwen1255/repos","events_url":"https://api.github.com/users/xuzhiwen1255/events{/privacy}","received_events_url":"https://api.github.com/users/xuzhiwen1255/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-13T03:34:06Z","updated_at":"2023-02-13T03:34:06Z","author_association":"CONTRIBUTOR","body":"Do you have upsert enabled?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427286711/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427301731","html_url":"https://github.com/apache/iceberg/issues/6816#issuecomment-1427301731","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6816","id":1427301731,"node_id":"IC_kwDOCW7NX85VEuVj","user":{"login":"skywalker2256","id":41573491,"node_id":"MDQ6VXNlcjQxNTczNDkx","avatar_url":"https://avatars.githubusercontent.com/u/41573491?v=4","gravatar_id":"","url":"https://api.github.com/users/skywalker2256","html_url":"https://github.com/skywalker2256","followers_url":"https://api.github.com/users/skywalker2256/followers","following_url":"https://api.github.com/users/skywalker2256/following{/other_user}","gists_url":"https://api.github.com/users/skywalker2256/gists{/gist_id}","starred_url":"https://api.github.com/users/skywalker2256/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/skywalker2256/subscriptions","organizations_url":"https://api.github.com/users/skywalker2256/orgs","repos_url":"https://api.github.com/users/skywalker2256/repos","events_url":"https://api.github.com/users/skywalker2256/events{/privacy}","received_events_url":"https://api.github.com/users/skywalker2256/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-13T03:57:42Z","updated_at":"2023-02-13T05:24:55Z","author_association":"NONE","body":"> Here is what I did.\r\n\r\nCREATE TABLE sample_9 (\r\n    id BIGINT COMMENT 'unique id',\r\n    data BIGINT ,\r\n   PRIMARY KEY(id) NOT ENFORCED\r\n) with ('format-version'='2',\r\n'write.upsert.enabled'='true')\r\n;\r\n\r\nquery sql :\r\nselect * from hive_catalog.iceberg_db.sample_9 /*+options('streaming'='true','monitor-interval'='5s')*/ ;\r\n\r\nresult:\r\n![image](https://user-images.githubusercontent.com/41573491/218367084-10ea34ef-f1fa-46bd-bb1b-7ea31ddf32c3.png)\r\n\r\n\r\nWhere do I set it wrong?Thanks!\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427301731/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427304989","html_url":"https://github.com/apache/iceberg/pull/6735#issuecomment-1427304989","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6735","id":1427304989,"node_id":"IC_kwDOCW7NX85VEvId","user":{"login":"slfan1989","id":55643692,"node_id":"MDQ6VXNlcjU1NjQzNjky","avatar_url":"https://avatars.githubusercontent.com/u/55643692?v=4","gravatar_id":"","url":"https://api.github.com/users/slfan1989","html_url":"https://github.com/slfan1989","followers_url":"https://api.github.com/users/slfan1989/followers","following_url":"https://api.github.com/users/slfan1989/following{/other_user}","gists_url":"https://api.github.com/users/slfan1989/gists{/gist_id}","starred_url":"https://api.github.com/users/slfan1989/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/slfan1989/subscriptions","organizations_url":"https://api.github.com/users/slfan1989/orgs","repos_url":"https://api.github.com/users/slfan1989/repos","events_url":"https://api.github.com/users/slfan1989/events{/privacy}","received_events_url":"https://api.github.com/users/slfan1989/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-13T04:02:00Z","updated_at":"2023-02-13T04:02:00Z","author_association":"CONTRIBUTOR","body":"> Typically we require two committers to sign off. I see you requested Fokko for review, let me see if I can find someone else tomorrow if he is not available.\r\n\r\nThank you for your reply!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427304989/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427324740","html_url":"https://github.com/apache/iceberg/pull/6660#issuecomment-1427324740","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6660","id":1427324740,"node_id":"IC_kwDOCW7NX85VEz9E","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-13T04:25:17Z","updated_at":"2023-02-13T04:25:17Z","author_association":"CONTRIBUTOR","body":"thanks @amogh-jahagirdar for the contribution and @jackye1995 and @hililiwei for review.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427324740/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427377920","html_url":"https://github.com/apache/iceberg/issues/6112#issuecomment-1427377920","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6112","id":1427377920,"node_id":"IC_kwDOCW7NX85VFA8A","user":{"login":"MichaelDeSteven","id":51652084,"node_id":"MDQ6VXNlcjUxNjUyMDg0","avatar_url":"https://avatars.githubusercontent.com/u/51652084?v=4","gravatar_id":"","url":"https://api.github.com/users/MichaelDeSteven","html_url":"https://github.com/MichaelDeSteven","followers_url":"https://api.github.com/users/MichaelDeSteven/followers","following_url":"https://api.github.com/users/MichaelDeSteven/following{/other_user}","gists_url":"https://api.github.com/users/MichaelDeSteven/gists{/gist_id}","starred_url":"https://api.github.com/users/MichaelDeSteven/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MichaelDeSteven/subscriptions","organizations_url":"https://api.github.com/users/MichaelDeSteven/orgs","repos_url":"https://api.github.com/users/MichaelDeSteven/repos","events_url":"https://api.github.com/users/MichaelDeSteven/events{/privacy}","received_events_url":"https://api.github.com/users/MichaelDeSteven/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-13T05:38:08Z","updated_at":"2023-02-13T05:38:08Z","author_association":"CONTRIBUTOR","body":"> @MichaelDeSteven are you still working on this? I would like to pick this up if not.\r\n\r\nI'm busying. you can pick it up，good luck.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427377920/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427383441","html_url":"https://github.com/apache/iceberg/issues/6816#issuecomment-1427383441","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6816","id":1427383441,"node_id":"IC_kwDOCW7NX85VFCSR","user":{"login":"xuzhiwen1255","id":105710753,"node_id":"U_kgDOBk0EoQ","avatar_url":"https://avatars.githubusercontent.com/u/105710753?v=4","gravatar_id":"","url":"https://api.github.com/users/xuzhiwen1255","html_url":"https://github.com/xuzhiwen1255","followers_url":"https://api.github.com/users/xuzhiwen1255/followers","following_url":"https://api.github.com/users/xuzhiwen1255/following{/other_user}","gists_url":"https://api.github.com/users/xuzhiwen1255/gists{/gist_id}","starred_url":"https://api.github.com/users/xuzhiwen1255/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xuzhiwen1255/subscriptions","organizations_url":"https://api.github.com/users/xuzhiwen1255/orgs","repos_url":"https://api.github.com/users/xuzhiwen1255/repos","events_url":"https://api.github.com/users/xuzhiwen1255/events{/privacy}","received_events_url":"https://api.github.com/users/xuzhiwen1255/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-13T05:46:56Z","updated_at":"2023-02-13T05:46:56Z","author_association":"CONTRIBUTOR","body":"iceberg does not support stream reading of tables with upsert enabled.\r\n\r\nIt is filtered out in the code, see https://github.com/apache/iceberg/blob/master/core/src/main/java/org/apache/iceberg/IncrementalDataTableScan.java#L128 here\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427383441/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427430612","html_url":"https://github.com/apache/iceberg/issues/6420#issuecomment-1427430612","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6420","id":1427430612,"node_id":"IC_kwDOCW7NX85VFNzU","user":{"login":"wmoustafa","id":10084105,"node_id":"MDQ6VXNlcjEwMDg0MTA1","avatar_url":"https://avatars.githubusercontent.com/u/10084105?v=4","gravatar_id":"","url":"https://api.github.com/users/wmoustafa","html_url":"https://github.com/wmoustafa","followers_url":"https://api.github.com/users/wmoustafa/followers","following_url":"https://api.github.com/users/wmoustafa/following{/other_user}","gists_url":"https://api.github.com/users/wmoustafa/gists{/gist_id}","starred_url":"https://api.github.com/users/wmoustafa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wmoustafa/subscriptions","organizations_url":"https://api.github.com/users/wmoustafa/orgs","repos_url":"https://api.github.com/users/wmoustafa/repos","events_url":"https://api.github.com/users/wmoustafa/events{/privacy}","received_events_url":"https://api.github.com/users/wmoustafa/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-13T06:46:04Z","updated_at":"2023-02-13T06:46:04Z","author_association":"CONTRIBUTOR","body":"I see. I think this goes back to my previous comment that the engine catalog APIs will have to be able to resolve views as tables. They will simply navigate to the storage table location from the view as an entry point. Engine catalog APIs may have to evolve to do that, along with view resolution implementation. @jackye1995 do you agree this is the workflow? @JanKaul, does this make filtering the catalog by table location not required?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427430612/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427460847","html_url":"https://github.com/apache/iceberg/pull/5029#issuecomment-1427460847","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5029","id":1427460847,"node_id":"IC_kwDOCW7NX85VFVLv","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-13T07:18:20Z","updated_at":"2023-02-13T07:18:20Z","author_association":"CONTRIBUTOR","body":"@stevenzwu  addressed the round of comments, PTAL, thx.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427460847/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427476988","html_url":"https://github.com/apache/iceberg/issues/6817#issuecomment-1427476988","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6817","id":1427476988,"node_id":"IC_kwDOCW7NX85VFZH8","user":{"login":"dramaticlly","id":5961173,"node_id":"MDQ6VXNlcjU5NjExNzM=","avatar_url":"https://avatars.githubusercontent.com/u/5961173?v=4","gravatar_id":"","url":"https://api.github.com/users/dramaticlly","html_url":"https://github.com/dramaticlly","followers_url":"https://api.github.com/users/dramaticlly/followers","following_url":"https://api.github.com/users/dramaticlly/following{/other_user}","gists_url":"https://api.github.com/users/dramaticlly/gists{/gist_id}","starred_url":"https://api.github.com/users/dramaticlly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dramaticlly/subscriptions","organizations_url":"https://api.github.com/users/dramaticlly/orgs","repos_url":"https://api.github.com/users/dramaticlly/repos","events_url":"https://api.github.com/users/dramaticlly/events{/privacy}","received_events_url":"https://api.github.com/users/dramaticlly/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-13T07:35:53Z","updated_at":"2023-02-13T07:35:53Z","author_association":"CONTRIBUTOR","body":"That's a good finding!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427476988/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427479240","html_url":"https://github.com/apache/iceberg/pull/6805#issuecomment-1427479240","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6805","id":1427479240,"node_id":"IC_kwDOCW7NX85VFZrI","user":{"login":"Guillem96","id":21279306,"node_id":"MDQ6VXNlcjIxMjc5MzA2","avatar_url":"https://avatars.githubusercontent.com/u/21279306?v=4","gravatar_id":"","url":"https://api.github.com/users/Guillem96","html_url":"https://github.com/Guillem96","followers_url":"https://api.github.com/users/Guillem96/followers","following_url":"https://api.github.com/users/Guillem96/following{/other_user}","gists_url":"https://api.github.com/users/Guillem96/gists{/gist_id}","starred_url":"https://api.github.com/users/Guillem96/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Guillem96/subscriptions","organizations_url":"https://api.github.com/users/Guillem96/orgs","repos_url":"https://api.github.com/users/Guillem96/repos","events_url":"https://api.github.com/users/Guillem96/events{/privacy}","received_events_url":"https://api.github.com/users/Guillem96/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-13T07:38:48Z","updated_at":"2023-02-13T07:39:19Z","author_association":"CONTRIBUTOR","body":"@Fokko If you require python 3.11 I don't see the reason to be compatible with `typing_extensions`, but anyways your  `TypeVar` usage is wrong, because there's no need for the class to be a generic if you can leverage the method definition to bound the `TypeVar` type.\r\n\r\nI implemented proper use of `TypeVar` in this new PR #6819.\r\n\r\nWith this implementation the type analyzer successfully keeps the `TableScan` type in the fluent calls of `select`, `filter`, etc.. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427479240/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427528840","html_url":"https://github.com/apache/iceberg/issues/6820#issuecomment-1427528840","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6820","id":1427528840,"node_id":"IC_kwDOCW7NX85VFlyI","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-13T08:22:49Z","updated_at":"2023-02-13T08:22:49Z","author_association":"CONTRIBUTOR","body":"Hey @Guillem96 thanks for raising this issue. It looks like you're using the `FsspecFileIO` to fetch the files. You can set it to PyArrow explicitly using:\r\n```\r\n    rest:\r\n        ...\r\n        py-io-impl: pyiceberg.io.pyarrow.PyArrowFileIO\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427528840/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427582965","html_url":"https://github.com/apache/iceberg/issues/6820#issuecomment-1427582965","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6820","id":1427582965,"node_id":"IC_kwDOCW7NX85VFy_1","user":{"login":"Guillem96","id":21279306,"node_id":"MDQ6VXNlcjIxMjc5MzA2","avatar_url":"https://avatars.githubusercontent.com/u/21279306?v=4","gravatar_id":"","url":"https://api.github.com/users/Guillem96","html_url":"https://github.com/Guillem96","followers_url":"https://api.github.com/users/Guillem96/followers","following_url":"https://api.github.com/users/Guillem96/following{/other_user}","gists_url":"https://api.github.com/users/Guillem96/gists{/gist_id}","starred_url":"https://api.github.com/users/Guillem96/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Guillem96/subscriptions","organizations_url":"https://api.github.com/users/Guillem96/orgs","repos_url":"https://api.github.com/users/Guillem96/repos","events_url":"https://api.github.com/users/Guillem96/events{/privacy}","received_events_url":"https://api.github.com/users/Guillem96/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-13T09:07:51Z","updated_at":"2023-02-13T09:10:04Z","author_association":"CONTRIBUTOR","body":"Thank you for the quick reply.\r\n\r\nFirst of all I want to apoligize because by reading the docs I cannot figure out how to configure the catalog.\r\n\r\nIf I update my catalog config to:\r\n\r\n```\r\ncatalog:\r\n  default:\r\n    type: glue\r\n    py-io-impl: pyiceberg.io.pyarrow.PyArrowFileIO\r\n```\r\n\r\nI'm getting this error when loading the table:\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"test_iceberg.py\", line 6, in <module>\r\n    table = catalog.load_table((\"...\", \"...\"))\r\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \".../lib/python3.11/site-packages/pyiceberg/catalog/glue.py\", line 278, in load_table\r\n    return self._convert_glue_to_iceberg(load_table_response.get(PROP_GLUE_TABLE, {}))\r\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \".../lib/python3.11/site-packages/pyiceberg/catalog/glue.py\", line 180, in _convert_glue_to_iceberg\r\n    metadata = FromInputFile.table_metadata(file)\r\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \".../lib/python3.11/site-packages/pyiceberg/serializers.py\", line 56, in table_metadata\r\n    with input_file.open() as input_stream:\r\n         ^^^^^^^^^^^^^^^^^\r\n  File \".../lib/python3.11/site-packages/pyiceberg/io/pyarrow.py\", line 197, in open\r\n    input_file = self._filesystem.open_input_file(self._path)\r\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"pyarrow/_fs.pyx\", line 770, in pyarrow._fs.FileSystem.open_input_file\r\n  File \"pyarrow/error.pxi\", line 144, in pyarrow.lib.pyarrow_internal_check_status\r\n  File \"pyarrow/error.pxi\", line 115, in pyarrow.lib.check_status\r\nOSError: When reading information for key 'iceberg_zstd_v3/metadata/00001-4c2dec16-77be-4a9d-8a47-00f74d2fd881.metadata.json' in bucket 'bucket-name': AWS Error UNKNOWN (HTTP status 301) during HeadObject operation: No response body.\r\n\r\n```\r\n\r\nI have AWS admin rights and I can check the the `HeadObject` api calls works fine in the same environment by:\r\n\r\n```\r\n$ aws s3api head-object --bucket bucket-name --key iceberg_zstd_v3/metadata/00001-4c2dec16-77be-4a9d-8a47-00f74d2fd881.metadata.json\r\n{\r\n    \"AcceptRanges\": \"bytes\",\r\n    \"LastModified\": \"2023-02-08T15:46:48+00:00\",\r\n    \"ContentLength\": 2974,\r\n    \"ContentType\": \"application/octet-stream\",\r\n    \"ServerSideEncryption\": \"aws:kms\",\r\n    \"Metadata\": {},\r\n    \"SSEKMSKeyId\": \"...\"\r\n}\r\n```\r\n\r\nSo you know what's going on? Why I cannot read the table metadata if I change the `py-io-impl`?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427582965/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427595456","html_url":"https://github.com/apache/iceberg/issues/6505#issuecomment-1427595456","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6505","id":1427595456,"node_id":"IC_kwDOCW7NX85VF2DA","user":{"login":"kiran94","id":7103956,"node_id":"MDQ6VXNlcjcxMDM5NTY=","avatar_url":"https://avatars.githubusercontent.com/u/7103956?v=4","gravatar_id":"","url":"https://api.github.com/users/kiran94","html_url":"https://github.com/kiran94","followers_url":"https://api.github.com/users/kiran94/followers","following_url":"https://api.github.com/users/kiran94/following{/other_user}","gists_url":"https://api.github.com/users/kiran94/gists{/gist_id}","starred_url":"https://api.github.com/users/kiran94/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kiran94/subscriptions","organizations_url":"https://api.github.com/users/kiran94/orgs","repos_url":"https://api.github.com/users/kiran94/repos","events_url":"https://api.github.com/users/kiran94/events{/privacy}","received_events_url":"https://api.github.com/users/kiran94/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-13T09:16:11Z","updated_at":"2023-02-13T09:16:11Z","author_association":"NONE","body":"Hello, I wanted to report that I've also observed this issue. Adding some details about how I got into this state in case it's helpful. \r\n\r\nI've created an iceberg table via AWS glue: \r\n\r\n```python\r\npartition_column = 'id'\r\npartition_bucket_size = 4\r\nudf_name = 'iceberg_bucket_long_' + str(partition_bucket_size)\r\n\r\nspark.sparkContext._jvm.org.apache.iceberg.spark.IcebergSpark.registerBucketUDF(\r\n        spark._jsparkSession, udf_name, spark.sparkContext._jvm.org.apache.spark.sql.types.DataTypes.LongType, partition_bucket_size)\r\n\r\ndf = df.sortWithinPartitions(F.expr(f\"{udf_name}({partition_column})\"))\r\n\r\ndf = df.writeTo('my_iceberg_table') \\\r\n        .partitionedBy(F.bucket(partition_bucket_size, partition_column))\r\n        .createOrReplace()\r\n```\r\n\r\nAt this point I could read the table fine via Athena and `pyiceberg`. However it led to many small files being which I believe was leading to poor query performance so I decided to follow https://docs.aws.amazon.com/athena/latest/ug/querying-iceberg-data-optimization.html \r\n\r\n```sql\r\nOPTIMIZE my_iceberg_table REWRITE DATA USING BIN_PACK\r\n```\r\n\r\nAfter this had completed successfully, I was able to still query the table from Athena but no longer from `pyiceberg`: \r\n\r\n```python\r\nValueError: Iceberg schema is not embedded into the Parquet file, see https://github.com/apache/iceberg/issues/6505\r\n```\r\n\r\nLet me know if there are any more details I can provide\r\n\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427595456/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427613589","html_url":"https://github.com/apache/iceberg/issues/6420#issuecomment-1427613589","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6420","id":1427613589,"node_id":"IC_kwDOCW7NX85VF6eV","user":{"login":"JanKaul","id":19823005,"node_id":"MDQ6VXNlcjE5ODIzMDA1","avatar_url":"https://avatars.githubusercontent.com/u/19823005?v=4","gravatar_id":"","url":"https://api.github.com/users/JanKaul","html_url":"https://github.com/JanKaul","followers_url":"https://api.github.com/users/JanKaul/followers","following_url":"https://api.github.com/users/JanKaul/following{/other_user}","gists_url":"https://api.github.com/users/JanKaul/gists{/gist_id}","starred_url":"https://api.github.com/users/JanKaul/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JanKaul/subscriptions","organizations_url":"https://api.github.com/users/JanKaul/orgs","repos_url":"https://api.github.com/users/JanKaul/repos","events_url":"https://api.github.com/users/JanKaul/events{/privacy}","received_events_url":"https://api.github.com/users/JanKaul/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-13T09:29:22Z","updated_at":"2023-02-13T09:34:24Z","author_association":"NONE","body":"I'm not entirely sure if I understand you correctly. I would expect a query engine catalog to proceed according to the following procedure:\n\n1. Find view metadata\n\nFind view metadata according to namespace and view name\n\n2. Read View metadata\n\nIf query engine doesn't support materialized views, then execute view query.\n\nIf query engine supports materialized views, then use storage table pointer (table_name+namespace, metadata location, UUID) to access storage table metadata. If the storage table metadata location is used, retrieving the metadata is easy. If namespace+table_name is used, the metadata has to be fetched from the iceberg or query engine catalog.\n\n3. Read storage table metadata\n\nUse storage table metadata to execute TableScan operator.\n\nIdeally, one would implement some kind of query engine catalog interface for the iceberg catalog. So that the iceberg catalog can be used directly.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427613589/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427803940","html_url":"https://github.com/apache/iceberg/pull/6786#issuecomment-1427803940","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6786","id":1427803940,"node_id":"IC_kwDOCW7NX85VGo8k","user":{"login":"zinking","id":118241,"node_id":"MDQ6VXNlcjExODI0MQ==","avatar_url":"https://avatars.githubusercontent.com/u/118241?v=4","gravatar_id":"","url":"https://api.github.com/users/zinking","html_url":"https://github.com/zinking","followers_url":"https://api.github.com/users/zinking/followers","following_url":"https://api.github.com/users/zinking/following{/other_user}","gists_url":"https://api.github.com/users/zinking/gists{/gist_id}","starred_url":"https://api.github.com/users/zinking/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zinking/subscriptions","organizations_url":"https://api.github.com/users/zinking/orgs","repos_url":"https://api.github.com/users/zinking/repos","events_url":"https://api.github.com/users/zinking/events{/privacy}","received_events_url":"https://api.github.com/users/zinking/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-13T11:44:58Z","updated_at":"2023-02-13T11:44:58Z","author_association":"CONTRIBUTOR","body":"what happens if we un-register the table and create a table with same name ? does the path gets renamed ? or just exception thrown?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427803940/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427865520","html_url":"https://github.com/apache/iceberg/pull/5837#issuecomment-1427865520","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5837","id":1427865520,"node_id":"IC_kwDOCW7NX85VG3-w","user":{"login":"gaborkaszab","id":29145491,"node_id":"MDQ6VXNlcjI5MTQ1NDkx","avatar_url":"https://avatars.githubusercontent.com/u/29145491?v=4","gravatar_id":"","url":"https://api.github.com/users/gaborkaszab","html_url":"https://github.com/gaborkaszab","followers_url":"https://api.github.com/users/gaborkaszab/followers","following_url":"https://api.github.com/users/gaborkaszab/following{/other_user}","gists_url":"https://api.github.com/users/gaborkaszab/gists{/gist_id}","starred_url":"https://api.github.com/users/gaborkaszab/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gaborkaszab/subscriptions","organizations_url":"https://api.github.com/users/gaborkaszab/orgs","repos_url":"https://api.github.com/users/gaborkaszab/repos","events_url":"https://api.github.com/users/gaborkaszab/events{/privacy}","received_events_url":"https://api.github.com/users/gaborkaszab/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-13T12:32:01Z","updated_at":"2023-02-13T12:32:01Z","author_association":"COLLABORATOR","body":"Hey @rdblue, @danielcweeks, @nastra, would you mind taking a look at this?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427865520/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427956046","html_url":"https://github.com/apache/iceberg/issues/6821#issuecomment-1427956046","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6821","id":1427956046,"node_id":"IC_kwDOCW7NX85VHOFO","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-13T13:36:33Z","updated_at":"2023-02-13T13:39:18Z","author_association":"MEMBER","body":"This feature already exists.\n\nhttps://iceberg.apache.org/javadoc/1.0.0/org/apache/iceberg/actions/RewriteDataFiles.html#MAX_CONCURRENT_FILE_GROUP_REWRITES\n\nAlthough I think we can do better with guessing what the right value is for this based on job sizes and number of cores","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427956046/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427980266","html_url":"https://github.com/apache/iceberg/issues/6820#issuecomment-1427980266","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6820","id":1427980266,"node_id":"IC_kwDOCW7NX85VHT_q","user":{"login":"Guillem96","id":21279306,"node_id":"MDQ6VXNlcjIxMjc5MzA2","avatar_url":"https://avatars.githubusercontent.com/u/21279306?v=4","gravatar_id":"","url":"https://api.github.com/users/Guillem96","html_url":"https://github.com/Guillem96","followers_url":"https://api.github.com/users/Guillem96/followers","following_url":"https://api.github.com/users/Guillem96/following{/other_user}","gists_url":"https://api.github.com/users/Guillem96/gists{/gist_id}","starred_url":"https://api.github.com/users/Guillem96/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Guillem96/subscriptions","organizations_url":"https://api.github.com/users/Guillem96/orgs","repos_url":"https://api.github.com/users/Guillem96/repos","events_url":"https://api.github.com/users/Guillem96/events{/privacy}","received_events_url":"https://api.github.com/users/Guillem96/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-13T13:55:50Z","updated_at":"2023-02-13T13:55:50Z","author_association":"CONTRIBUTOR","body":"Okay I managed to solve it with your PR changes and adding `AWS_DEFAULT_REGION=eu-west-1` to my environment.\r\n\r\nBut just to let you know, this is a wierd behaviour because I already have my default region setup in `~.aws/credentials`, so I'm expecting pyiceberg (or underlying pyarrow s3FileSystem) to fetch it from there.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427980266/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427982818","html_url":"https://github.com/apache/iceberg/issues/6505#issuecomment-1427982818","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6505","id":1427982818,"node_id":"IC_kwDOCW7NX85VHUni","user":{"login":"Guillem96","id":21279306,"node_id":"MDQ6VXNlcjIxMjc5MzA2","avatar_url":"https://avatars.githubusercontent.com/u/21279306?v=4","gravatar_id":"","url":"https://api.github.com/users/Guillem96","html_url":"https://github.com/Guillem96","followers_url":"https://api.github.com/users/Guillem96/followers","following_url":"https://api.github.com/users/Guillem96/following{/other_user}","gists_url":"https://api.github.com/users/Guillem96/gists{/gist_id}","starred_url":"https://api.github.com/users/Guillem96/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Guillem96/subscriptions","organizations_url":"https://api.github.com/users/Guillem96/orgs","repos_url":"https://api.github.com/users/Guillem96/repos","events_url":"https://api.github.com/users/Guillem96/events{/privacy}","received_events_url":"https://api.github.com/users/Guillem96/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-13T13:57:36Z","updated_at":"2023-02-13T13:57:36Z","author_association":"CONTRIBUTOR","body":"Just for further information I'll add here a code snippet that leads to the same error message\r\n\r\n```python\r\nfrom pyiceberg.catalog import load_catalog\r\nfrom pyiceberg.expressions import EqualTo\r\n\r\n# pyiceberg.yaml\r\n# catalog:\r\n#   default:\r\n#     type: glue\r\n#     py-io-impl: pyiceberg.io.pyarrow.PyArrowFileIO\r\n\r\ncatalog = load_catalog(\r\n    \"default\",\r\n    warehouse=\"...\",\r\n)\r\n\r\ntable = catalog.load_table((\"...\", \"...\"))\r\n\r\ndf = (\r\n    table.scan()\r\n    .filter(EqualTo(\"uuid\", \"...\"))\r\n    .select(\"rt\", \"cs1\", \"in\")\r\n    .to_arrow()\r\n)\r\n\r\nprint(df)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1427982818/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1428071909","html_url":"https://github.com/apache/iceberg/issues/6821#issuecomment-1428071909","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6821","id":1428071909,"node_id":"IC_kwDOCW7NX85VHqXl","user":{"login":"mgorsk1","id":5680655,"node_id":"MDQ6VXNlcjU2ODA2NTU=","avatar_url":"https://avatars.githubusercontent.com/u/5680655?v=4","gravatar_id":"","url":"https://api.github.com/users/mgorsk1","html_url":"https://github.com/mgorsk1","followers_url":"https://api.github.com/users/mgorsk1/followers","following_url":"https://api.github.com/users/mgorsk1/following{/other_user}","gists_url":"https://api.github.com/users/mgorsk1/gists{/gist_id}","starred_url":"https://api.github.com/users/mgorsk1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mgorsk1/subscriptions","organizations_url":"https://api.github.com/users/mgorsk1/orgs","repos_url":"https://api.github.com/users/mgorsk1/repos","events_url":"https://api.github.com/users/mgorsk1/events{/privacy}","received_events_url":"https://api.github.com/users/mgorsk1/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-13T14:53:19Z","updated_at":"2023-02-13T14:54:41Z","author_association":"NONE","body":"Thanks @RussellSpitzer indeed I must've missed it. I used this and after increasing it the number of executors grew as well. So far so good!\r\n\r\nThe improvement I see that currently:\r\n- with table has thousands of very large amount of small files (assume thousands) across few partitions (assume up to 1000), with each file has size < 10000 bytes\r\n- if MAX_FILE_GROUP_SIZE_BYTES_DEFAULT is set to > 10000 bytes\r\n- spark will spawn many executors (up to MAX_CONCURRENT_FILE_GROUP_REWRITES) but no compaction will be done\r\n\r\nso some pre-spawn executor job calculation taking this into account would be useful, wdyt?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1428071909/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1428074307","html_url":"https://github.com/apache/iceberg/issues/6821#issuecomment-1428074307","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6821","id":1428074307,"node_id":"IC_kwDOCW7NX85VHq9D","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-13T14:54:53Z","updated_at":"2023-02-13T14:54:53Z","author_association":"MEMBER","body":"Sorry I don't know what you mean","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1428074307/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1428089327","html_url":"https://github.com/apache/iceberg/issues/6824#issuecomment-1428089327","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6824","id":1428089327,"node_id":"IC_kwDOCW7NX85VHunv","user":{"login":"huyuanfeng2018","id":40817998,"node_id":"MDQ6VXNlcjQwODE3OTk4","avatar_url":"https://avatars.githubusercontent.com/u/40817998?v=4","gravatar_id":"","url":"https://api.github.com/users/huyuanfeng2018","html_url":"https://github.com/huyuanfeng2018","followers_url":"https://api.github.com/users/huyuanfeng2018/followers","following_url":"https://api.github.com/users/huyuanfeng2018/following{/other_user}","gists_url":"https://api.github.com/users/huyuanfeng2018/gists{/gist_id}","starred_url":"https://api.github.com/users/huyuanfeng2018/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huyuanfeng2018/subscriptions","organizations_url":"https://api.github.com/users/huyuanfeng2018/orgs","repos_url":"https://api.github.com/users/huyuanfeng2018/repos","events_url":"https://api.github.com/users/huyuanfeng2018/events{/privacy}","received_events_url":"https://api.github.com/users/huyuanfeng2018/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-13T15:01:35Z","updated_at":"2023-02-13T15:01:35Z","author_association":"CONTRIBUTOR","body":"So we can see how to solve this problem. \r\nmy opinion is\r\nIs it possible to store locked in the state after the unlocking fails. At the beginning of the next ckp cycle, if there is a state where the unlocking failed, try to unlock it first?\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1428089327/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1428094899","html_url":"https://github.com/apache/iceberg/issues/6824#issuecomment-1428094899","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6824","id":1428094899,"node_id":"IC_kwDOCW7NX85VHv-z","user":{"login":"huyuanfeng2018","id":40817998,"node_id":"MDQ6VXNlcjQwODE3OTk4","avatar_url":"https://avatars.githubusercontent.com/u/40817998?v=4","gravatar_id":"","url":"https://api.github.com/users/huyuanfeng2018","html_url":"https://github.com/huyuanfeng2018","followers_url":"https://api.github.com/users/huyuanfeng2018/followers","following_url":"https://api.github.com/users/huyuanfeng2018/following{/other_user}","gists_url":"https://api.github.com/users/huyuanfeng2018/gists{/gist_id}","starred_url":"https://api.github.com/users/huyuanfeng2018/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huyuanfeng2018/subscriptions","organizations_url":"https://api.github.com/users/huyuanfeng2018/orgs","repos_url":"https://api.github.com/users/huyuanfeng2018/repos","events_url":"https://api.github.com/users/huyuanfeng2018/events{/privacy}","received_events_url":"https://api.github.com/users/huyuanfeng2018/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-13T15:03:41Z","updated_at":"2023-02-13T15:04:49Z","author_association":"CONTRIBUTOR","body":"@raptond Please see this question，thanks ^-^","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1428094899/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1428402868","html_url":"https://github.com/apache/iceberg/pull/6826#issuecomment-1428402868","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6826","id":1428402868,"node_id":"IC_kwDOCW7NX85VI7K0","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-13T17:56:16Z","updated_at":"2023-02-13T17:57:00Z","author_association":"MEMBER","body":"I too started working on this before this PR:\r\nhttps://github.com/apache/iceberg/pull/6825\r\n\r\nBut I will close mine. As I couldn't finish all the errors yet. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1428402868/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1428417647","html_url":"https://github.com/apache/iceberg/pull/6807#issuecomment-1428417647","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6807","id":1428417647,"node_id":"IC_kwDOCW7NX85VI-xv","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-13T18:06:04Z","updated_at":"2023-02-13T18:06:04Z","author_association":"CONTRIBUTOR","body":"Overall looks good to me, just some nit comments about the tests","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1428417647/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1428484151","html_url":"https://github.com/apache/iceberg/pull/6815#issuecomment-1428484151","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6815","id":1428484151,"node_id":"IC_kwDOCW7NX85VJPA3","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-13T18:56:33Z","updated_at":"2023-02-13T18:56:33Z","author_association":"CONTRIBUTOR","body":"Thanks for the fix and the quick reviews!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1428484151/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1428597503","html_url":"https://github.com/apache/iceberg/pull/6644#issuecomment-1428597503","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6644","id":1428597503,"node_id":"IC_kwDOCW7NX85VJqr_","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-13T20:02:09Z","updated_at":"2023-02-13T20:02:09Z","author_association":"CONTRIBUTOR","body":"Thanks again @rubenvdg for picking this up 👏🏻 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1428597503/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1428647358","html_url":"https://github.com/apache/iceberg/pull/6828#issuecomment-1428647358","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6828","id":1428647358,"node_id":"IC_kwDOCW7NX85VJ22-","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-13T20:37:25Z","updated_at":"2023-02-13T20:37:25Z","author_association":"CONTRIBUTOR","body":"cc @RussellSpitzer @rdblue @jackye1995 @dramaticlly ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1428647358/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1428650056","html_url":"https://github.com/apache/iceberg/issues/6741#issuecomment-1428650056","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6741","id":1428650056,"node_id":"IC_kwDOCW7NX85VJ3hI","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-13T20:39:51Z","updated_at":"2023-02-13T20:39:51Z","author_association":"CONTRIBUTOR","body":"@dramaticlly, I have some time to implement this SQL conf. Have you looked into it already? I want this feature to be shipped with 1.2.0.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1428650056/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1428651635","html_url":"https://github.com/apache/iceberg/pull/6791#issuecomment-1428651635","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6791","id":1428651635,"node_id":"IC_kwDOCW7NX85VJ35z","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-13T20:41:12Z","updated_at":"2023-02-13T20:41:12Z","author_association":"CONTRIBUTOR","body":"Thanks, @szehon-ho @singhpk234!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1428651635/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1428720815","html_url":"https://github.com/apache/iceberg/pull/6716#issuecomment-1428720815","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6716","id":1428720815,"node_id":"IC_kwDOCW7NX85VKIyv","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-13T21:34:33Z","updated_at":"2023-02-13T21:34:33Z","author_association":"CONTRIBUTOR","body":"Will take another look today.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1428720815/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1428724673","html_url":"https://github.com/apache/iceberg/issues/6830#issuecomment-1428724673","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6830","id":1428724673,"node_id":"IC_kwDOCW7NX85VKJvB","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-13T21:38:11Z","updated_at":"2023-02-16T21:57:37Z","author_association":"CONTRIBUTOR","body":"Hi @akash-goel Thanks for raising this issue. [Creating tables (DDL)](https://py.iceberg.apache.org/api/#create-a-table) is already possible. We're working on the API to alter tables, and that should be in soon.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1428724673/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1428727547","html_url":"https://github.com/apache/iceberg/issues/6829#issuecomment-1428727547","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6829","id":1428727547,"node_id":"IC_kwDOCW7NX85VKKb7","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-13T21:41:01Z","updated_at":"2023-02-13T21:41:01Z","author_association":"CONTRIBUTOR","body":"Hi @akash-goel I know that DuckDB is working on native Iceberg support, but this isn't available today, and probably will take a bit of time. From a PyIceberg perspective, write support is a high priority and that's being worked on. Keep in mind, this would require you to convert the DuckDB query back to a PyArrow dataframe, but PyIceberg could provide helper methods for that.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1428727547/reactions","total_count":3,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":3,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1428769078","html_url":"https://github.com/apache/iceberg/pull/6818#issuecomment-1428769078","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6818","id":1428769078,"node_id":"IC_kwDOCW7NX85VKUk2","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-13T22:16:50Z","updated_at":"2023-02-13T22:16:50Z","author_association":"CONTRIBUTOR","body":"I should be able to take a look later today.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1428769078/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1428771738","html_url":"https://github.com/apache/iceberg/issues/6172#issuecomment-1428771738","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6172","id":1428771738,"node_id":"IC_kwDOCW7NX85VKVOa","user":{"login":"dmgcodevil","id":1413873,"node_id":"MDQ6VXNlcjE0MTM4NzM=","avatar_url":"https://avatars.githubusercontent.com/u/1413873?v=4","gravatar_id":"","url":"https://api.github.com/users/dmgcodevil","html_url":"https://github.com/dmgcodevil","followers_url":"https://api.github.com/users/dmgcodevil/followers","following_url":"https://api.github.com/users/dmgcodevil/following{/other_user}","gists_url":"https://api.github.com/users/dmgcodevil/gists{/gist_id}","starred_url":"https://api.github.com/users/dmgcodevil/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dmgcodevil/subscriptions","organizations_url":"https://api.github.com/users/dmgcodevil/orgs","repos_url":"https://api.github.com/users/dmgcodevil/repos","events_url":"https://api.github.com/users/dmgcodevil/events{/privacy}","received_events_url":"https://api.github.com/users/dmgcodevil/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-13T22:18:52Z","updated_at":"2023-02-13T22:18:52Z","author_association":"CONTRIBUTOR","body":"same with `1.0.0`","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1428771738/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1428789807","html_url":"https://github.com/apache/iceberg/pull/6672#issuecomment-1428789807","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6672","id":1428789807,"node_id":"IC_kwDOCW7NX85VKZov","user":{"login":"haizhou-zhao","id":6187287,"node_id":"MDQ6VXNlcjYxODcyODc=","avatar_url":"https://avatars.githubusercontent.com/u/6187287?v=4","gravatar_id":"","url":"https://api.github.com/users/haizhou-zhao","html_url":"https://github.com/haizhou-zhao","followers_url":"https://api.github.com/users/haizhou-zhao/followers","following_url":"https://api.github.com/users/haizhou-zhao/following{/other_user}","gists_url":"https://api.github.com/users/haizhou-zhao/gists{/gist_id}","starred_url":"https://api.github.com/users/haizhou-zhao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/haizhou-zhao/subscriptions","organizations_url":"https://api.github.com/users/haizhou-zhao/orgs","repos_url":"https://api.github.com/users/haizhou-zhao/repos","events_url":"https://api.github.com/users/haizhou-zhao/events{/privacy}","received_events_url":"https://api.github.com/users/haizhou-zhao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-13T22:32:58Z","updated_at":"2023-02-13T22:32:58Z","author_association":"CONTRIBUTOR","body":"@snazy I ran into the same issue as @Fokko mentioned above (I summarized my problem here: https://github.com/apache/iceberg/issues/6798). In addition to @Fokko's question, I want to know if you are writing some sort of model converter to convert, for example, between the [openAPI generated Schema object](https://github.com/apache/iceberg/blob/master/open-api/rest-catalog-open-api.yaml#L1075) and the [original iceberg Schema object](https://github.com/apache/iceberg/blob/master/api/src/main/java/org/apache/iceberg/Schema.java#L51). If not, would it be possible to know better how you are using the open API generated models? Thank you!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1428789807/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1428795920","html_url":"https://github.com/apache/iceberg/issues/6172#issuecomment-1428795920","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6172","id":1428795920,"node_id":"IC_kwDOCW7NX85VKbIQ","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-13T22:37:39Z","updated_at":"2023-02-13T22:38:44Z","author_association":"MEMBER","body":"The Catalog Not Found, implies that a different catalog manager is being used by the RewriteManager than is being used by the normal REPL, assuming that you are able to access the catalog plugin normally. If you have a chance, can you check \r\n```\r\nval sqlconf = SQLConf.get\r\nsqlconf.getConfString(\"spark.sql.catalog.ice\") // Or whatever you catalog is named\r\n```\r\n\r\nI've seen this as an issue in some Notebooks, where the conf is not correctly being inherited between sessions (or maybe not set correctly in the first place).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1428795920/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]