[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/859174845","html_url":"https://github.com/apache/iceberg/pull/2660#issuecomment-859174845","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2660","id":859174845,"node_id":"MDEyOklzc3VlQ29tbWVudDg1OTE3NDg0NQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-11T00:29:34Z","updated_at":"2021-06-11T00:29:34Z","author_association":"CONTRIBUTOR","body":"@SreeramGarlapati, thank you for writing the \"Concepts used in this PR\" section. That is a very helpful summary for reviewers.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/859174845/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/859362489","html_url":"https://github.com/apache/iceberg/pull/2691#issuecomment-859362489","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2691","id":859362489,"node_id":"MDEyOklzc3VlQ29tbWVudDg1OTM2MjQ4OQ==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-11T07:52:27Z","updated_at":"2021-06-11T07:52:27Z","author_association":"CONTRIBUTOR","body":"@marton-bod, @lcspinter: Could you please take a look as well?\r\n\r\nThanks,\r\nPeter ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/859362489/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/859363685","html_url":"https://github.com/apache/iceberg/issues/2686#issuecomment-859363685","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2686","id":859363685,"node_id":"MDEyOklzc3VlQ29tbWVudDg1OTM2MzY4NQ==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-11T07:54:30Z","updated_at":"2021-06-11T07:54:30Z","author_association":"CONTRIBUTOR","body":"@aimenglin: Could you please help us by describing how the problem was solved, so we can help others in the same situation?\r\n\r\nThanks,\r\nPeter","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/859363685/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/859609110","html_url":"https://github.com/apache/iceberg/pull/2282#issuecomment-859609110","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2282","id":859609110,"node_id":"MDEyOklzc3VlQ29tbWVudDg1OTYwOTExMA==","user":{"login":"sshkvar","id":3986221,"node_id":"MDQ6VXNlcjM5ODYyMjE=","avatar_url":"https://avatars.githubusercontent.com/u/3986221?v=4","gravatar_id":"","url":"https://api.github.com/users/sshkvar","html_url":"https://github.com/sshkvar","followers_url":"https://api.github.com/users/sshkvar/followers","following_url":"https://api.github.com/users/sshkvar/following{/other_user}","gists_url":"https://api.github.com/users/sshkvar/gists{/gist_id}","starred_url":"https://api.github.com/users/sshkvar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sshkvar/subscriptions","organizations_url":"https://api.github.com/users/sshkvar/orgs","repos_url":"https://api.github.com/users/sshkvar/repos","events_url":"https://api.github.com/users/sshkvar/events{/privacy}","received_events_url":"https://api.github.com/users/sshkvar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-11T14:09:32Z","updated_at":"2021-06-11T14:09:32Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer thank you for the response, changes are ready, but I can't push to the current git branch, so I created another [PR to my forked version of iceberg]( https://github.com/sshkvar/iceberg/pull/1/files)\r\nI can create PR to original Iceberg repository or @bkahloon can pull my changes to the current branch. What is the process for such cases? \r\n\r\nShort description about changes:\r\nAdded a new spark session config `spark.sql.iceberg.handle-timestamp-without-timezone` which is responsible for allowing reading/writing timestamps without timezone, the same as reader/writer config `spark-handle-timestamp-without-timezone`.\r\nAlso added additional spark session config `spark.sql.iceberg.store-timestamp-without-zone` which is responsible for indicating which iceberg type `TimestampType.withoutZone()` or `TimestampType.withZone()` will be used in [SparkTypeToType.java](https://github.com/sshkvar/iceberg/blob/02dfdf892f3d5c4f17392bc436b69b23fdb1da84/spark/src/main/java/org/apache/iceberg/spark/SparkTypeToType.java)\r\n\r\n@RussellSpitzer @bkahloon I would really appreciate for the review ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/859609110/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/859653266","html_url":"https://github.com/apache/iceberg/pull/2660#issuecomment-859653266","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2660","id":859653266,"node_id":"MDEyOklzc3VlQ29tbWVudDg1OTY1MzI2Ng==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-11T15:16:03Z","updated_at":"2021-06-11T15:16:03Z","author_association":"CONTRIBUTOR","body":"Let me take a look as well.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/859653266/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/859655665","html_url":"https://github.com/apache/iceberg/pull/2660#issuecomment-859655665","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2660","id":859655665,"node_id":"MDEyOklzc3VlQ29tbWVudDg1OTY1NTY2NQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-11T15:19:59Z","updated_at":"2021-06-11T15:19:59Z","author_association":"MEMBER","body":"@SreeramGarlapati Did you want me to take another pass? I think you addressed all my concerns and it seems like you have a lot of other eyes on this now :) I think that this is functionally a great first step and I'm +1 on merge once other reviewers concerns are addressed","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/859655665/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/859662313","html_url":"https://github.com/apache/iceberg/pull/2660#issuecomment-859662313","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2660","id":859662313,"node_id":"MDEyOklzc3VlQ29tbWVudDg1OTY2MjMxMw==","user":{"login":"SreeramGarlapati","id":11813428,"node_id":"MDQ6VXNlcjExODEzNDI4","avatar_url":"https://avatars.githubusercontent.com/u/11813428?v=4","gravatar_id":"","url":"https://api.github.com/users/SreeramGarlapati","html_url":"https://github.com/SreeramGarlapati","followers_url":"https://api.github.com/users/SreeramGarlapati/followers","following_url":"https://api.github.com/users/SreeramGarlapati/following{/other_user}","gists_url":"https://api.github.com/users/SreeramGarlapati/gists{/gist_id}","starred_url":"https://api.github.com/users/SreeramGarlapati/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SreeramGarlapati/subscriptions","organizations_url":"https://api.github.com/users/SreeramGarlapati/orgs","repos_url":"https://api.github.com/users/SreeramGarlapati/repos","events_url":"https://api.github.com/users/SreeramGarlapati/events{/privacy}","received_events_url":"https://api.github.com/users/SreeramGarlapati/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-11T15:30:48Z","updated_at":"2021-06-11T15:30:48Z","author_association":"COLLABORATOR","body":"> @SreeramGarlapati Did you want me to take another pass? I think you addressed all my concerns and it seems like you have a lot of other eyes on this now :) I think that this is functionally a great first step and I'm +1 on merge once other reviewers concerns are addressed\r\n\r\nyes, @RussellSpitzer. I think - it is ready for another pass. thank you!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/859662313/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/859703960","html_url":"https://github.com/apache/iceberg/issues/2686#issuecomment-859703960","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2686","id":859703960,"node_id":"MDEyOklzc3VlQ29tbWVudDg1OTcwMzk2MA==","user":{"login":"aimenglin","id":84943281,"node_id":"MDQ6VXNlcjg0OTQzMjgx","avatar_url":"https://avatars.githubusercontent.com/u/84943281?v=4","gravatar_id":"","url":"https://api.github.com/users/aimenglin","html_url":"https://github.com/aimenglin","followers_url":"https://api.github.com/users/aimenglin/followers","following_url":"https://api.github.com/users/aimenglin/following{/other_user}","gists_url":"https://api.github.com/users/aimenglin/gists{/gist_id}","starred_url":"https://api.github.com/users/aimenglin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aimenglin/subscriptions","organizations_url":"https://api.github.com/users/aimenglin/orgs","repos_url":"https://api.github.com/users/aimenglin/repos","events_url":"https://api.github.com/users/aimenglin/events{/privacy}","received_events_url":"https://api.github.com/users/aimenglin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-11T16:35:48Z","updated_at":"2021-06-11T16:35:48Z","author_association":"NONE","body":"@pvary I add ```table.updateProperties().set(\"engine.hive.enabled\", \"true\").commit()``` when I created the table on Spark.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/859703960/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/860121486","html_url":"https://github.com/apache/iceberg/pull/2684#issuecomment-860121486","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2684","id":860121486,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MDEyMTQ4Ng==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-12T22:33:39Z","updated_at":"2021-06-12T22:33:39Z","author_association":"CONTRIBUTOR","body":"@nastra, looks good other than the static imports. I also flagged an unnecessary whitespace change to fix. Thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/860121486/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/860124980","html_url":"https://github.com/apache/iceberg/issues/2607#issuecomment-860124980","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2607","id":860124980,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MDEyNDk4MA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-12T23:18:53Z","updated_at":"2021-06-12T23:18:53Z","author_association":"CONTRIBUTOR","body":"The idea of using `hadoop.*` properties from the catalog config to set Hadoop conf properties makes sense to me. Sounds like the argument against this is that it would be weird in Hive, but isn't this proposed for Spark where it has a precedent? We could find some other prefix for Hive, like `override.*` maybe? Or just live with `hadoop.*`. I don't think it would be that odd.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/860124980/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/860125093","html_url":"https://github.com/apache/iceberg/pull/2667#issuecomment-860125093","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2667","id":860125093,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MDEyNTA5Mw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-12T23:20:17Z","updated_at":"2021-06-12T23:20:17Z","author_association":"CONTRIBUTOR","body":"This looks correct to me, but I don't know why tests would be passing with a logic error like this. I approved running tests and we'll see if they still pass. If they do, then that indicates that this path isn't tested.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/860125093/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/860125228","html_url":"https://github.com/apache/iceberg/pull/2668#issuecomment-860125228","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2668","id":860125228,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MDEyNTIyOA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-12T23:22:03Z","updated_at":"2021-06-12T23:22:03Z","author_association":"CONTRIBUTOR","body":"Thanks, @wangjunyou!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/860125228/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/860125727","html_url":"https://github.com/apache/iceberg/pull/2659#issuecomment-860125727","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2659","id":860125727,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MDEyNTcyNw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-12T23:28:49Z","updated_at":"2021-06-12T23:28:49Z","author_association":"CONTRIBUTOR","body":"I don't agree with changing the default here. I think the solution instead is to update the table cache and invalidate entries after some period of time, like 1 minute. But it isn't correct to simply turn off caching by default. You should also be able to run `REFRESH TABLE` to update the table.\r\n\r\n@aokolnychyi and @rymurr, I think that we turned off timer-based cache invalidation because it was causing tables referenced by cached queries to be out of sync with tables that are freshly loaded. Should we rethink that? If I remember correctly, we turned off invalidation before we fixed Spark in many cases. Now that we have Spark handling caching correctly, can we go back to caching a table only for a minute?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/860125727/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/860125741","html_url":"https://github.com/apache/iceberg/pull/2659#issuecomment-860125741","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2659","id":860125741,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MDEyNTc0MQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-12T23:29:01Z","updated_at":"2021-06-12T23:29:01Z","author_association":"CONTRIBUTOR","body":"FYI @RussellSpitzer also.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/860125741/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/860125973","html_url":"https://github.com/apache/iceberg/pull/2639#issuecomment-860125973","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2639","id":860125973,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MDEyNTk3Mw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-12T23:32:08Z","updated_at":"2021-06-12T23:32:08Z","author_association":"CONTRIBUTOR","body":"I'm approving this to run unit tests. Thanks for working on this, @ggershinsky!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/860125973/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/860126203","html_url":"https://github.com/apache/iceberg/pull/2639#issuecomment-860126203","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2639","id":860126203,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MDEyNjIwMw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-12T23:35:30Z","updated_at":"2021-06-12T23:35:30Z","author_association":"CONTRIBUTOR","body":"@ggershinsky, the doc you linked to is quite long and it isn't clear what part of it explains what you're doing here. Can you provide a quick summary of how to plug into Parquet encryption and what this does? I'm assuming that it provides Parquet's equivalent of an `EncryptionManager` that gets the file AAD and necessary key material from Iceberg's `key_metadata` field. Is that correct?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/860126203/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/860126273","html_url":"https://github.com/apache/iceberg/pull/2441#issuecomment-860126273","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2441","id":860126273,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MDEyNjI3Mw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-12T23:36:29Z","updated_at":"2021-06-12T23:36:29Z","author_association":"CONTRIBUTOR","body":"This looks fine to me, but there's a conflict in versions.props and I guess 1.12.1 is out. @Fokko, can you update this?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/860126273/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/860128179","html_url":"https://github.com/apache/iceberg/pull/2638#issuecomment-860128179","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2638","id":860128179,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MDEyODE3OQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-13T00:01:47Z","updated_at":"2021-06-13T00:01:47Z","author_association":"CONTRIBUTOR","body":"I'm also skeptical about adding a \"native\" encryption API. It isn't clear what that is from the name and I think that using Parquet and ORC encryption is expected for those files. I would like to make the transition to configuring Parquet and ORC encryption a bit more seamless with a reasonable fallback if you want to use stream encryption for those formats.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/860128179/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/860192640","html_url":"https://github.com/apache/iceberg/pull/2659#issuecomment-860192640","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2659","id":860192640,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MDE5MjY0MA==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-13T11:06:20Z","updated_at":"2021-06-13T11:06:20Z","author_association":"MEMBER","body":"This is a tough one for me since it is basically our number one user question for multiuser tables. It definitely seems counter intuitive and if there was a way to just cache for all references in the same query and drop it for everything else I would be in favor of that. I feel less confident about changing the default to just disable caching, but that does seem less surprising for the majority of users than the current caching behavior.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/860192640/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/860295895","html_url":"https://github.com/apache/iceberg/pull/2689#issuecomment-860295895","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2689","id":860295895,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MDI5NTg5NQ==","user":{"login":"jun-he","id":12246263,"node_id":"MDQ6VXNlcjEyMjQ2MjYz","avatar_url":"https://avatars.githubusercontent.com/u/12246263?v=4","gravatar_id":"","url":"https://api.github.com/users/jun-he","html_url":"https://github.com/jun-he","followers_url":"https://api.github.com/users/jun-he/followers","following_url":"https://api.github.com/users/jun-he/following{/other_user}","gists_url":"https://api.github.com/users/jun-he/gists{/gist_id}","starred_url":"https://api.github.com/users/jun-he/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jun-he/subscriptions","organizations_url":"https://api.github.com/users/jun-he/orgs","repos_url":"https://api.github.com/users/jun-he/repos","events_url":"https://api.github.com/users/jun-he/events{/privacy}","received_events_url":"https://api.github.com/users/jun-he/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-14T00:32:08Z","updated_at":"2021-06-14T00:32:08Z","author_association":"COLLABORATOR","body":"Seems the failures are from linters\r\n```\r\n  linters run-test: commands[2] | mypy --ignore-missing-imports iceberg/\r\n  iceberg/api/transforms/transform_util.py:20: error: Library stubs not installed for \"pytz\" (or incompatible with Python 3.8)\r\n  iceberg/api/expressions/literals.py:23: error: Library stubs not installed for \"pytz\" (or incompatible with Python 3.8)\r\n  iceberg/api/expressions/literals.py:23: note: Hint: \"python3 -m pip install types-pytz\"\r\n  iceberg/api/expressions/literals.py:23: note: (or run \"mypy --install-types\" to install all missing stub packages)\r\n  iceberg/api/expressions/literals.py:23: note: See https://mypy.readthedocs.io/en/stable/running_mypy.html#missing-imports\r\n  iceberg/api/expressions/literals.py:385: error: Library stubs not installed for \"dateutil.parser\" (or incompatible with Python 3.8)\r\n  iceberg/api/expressions/literals.py:385: note: Hint: \"python3 -m pip install types-python-dateutil\"\r\n  iceberg/api/expressions/literals.py:385: error: Library stubs not installed for \"dateutil\" (or incompatible with Python 3.8)\r\n```\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/860295895/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/860458733","html_url":"https://github.com/apache/iceberg/pull/2684#issuecomment-860458733","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2684","id":860458733,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MDQ1ODczMw==","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-14T07:38:19Z","updated_at":"2021-06-14T07:38:19Z","author_association":"CONTRIBUTOR","body":"@rdblue thanks, everything should be addressed now","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/860458733/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/860461604","html_url":"https://github.com/apache/iceberg/pull/2441#issuecomment-860461604","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2441","id":860461604,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MDQ2MTYwNA==","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-14T07:42:42Z","updated_at":"2021-06-14T07:42:42Z","author_association":"CONTRIBUTOR","body":"@rdblue Sure thing!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/860461604/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/860508692","html_url":"https://github.com/apache/iceberg/issues/2468#issuecomment-860508692","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2468","id":860508692,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MDUwODY5Mg==","user":{"login":"iQiuyu-0821","id":18065383,"node_id":"MDQ6VXNlcjE4MDY1Mzgz","avatar_url":"https://avatars.githubusercontent.com/u/18065383?v=4","gravatar_id":"","url":"https://api.github.com/users/iQiuyu-0821","html_url":"https://github.com/iQiuyu-0821","followers_url":"https://api.github.com/users/iQiuyu-0821/followers","following_url":"https://api.github.com/users/iQiuyu-0821/following{/other_user}","gists_url":"https://api.github.com/users/iQiuyu-0821/gists{/gist_id}","starred_url":"https://api.github.com/users/iQiuyu-0821/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/iQiuyu-0821/subscriptions","organizations_url":"https://api.github.com/users/iQiuyu-0821/orgs","repos_url":"https://api.github.com/users/iQiuyu-0821/repos","events_url":"https://api.github.com/users/iQiuyu-0821/events{/privacy}","received_events_url":"https://api.github.com/users/iQiuyu-0821/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-14T08:44:26Z","updated_at":"2021-06-14T08:52:00Z","author_association":"NONE","body":"I have the same problem.\r\n\r\n**runtime env:**\r\n\r\nflink: 1.12.1\r\niceberg-flink-runtime: 0.12.0 build from master\r\n\r\n**catalog info:**\r\n\r\n```\r\ncatalogs: \r\n    - name: iceberg\r\n      type: iceberg\r\n      catalog-type: hadoop\r\n      warehouse: hdfs://localhost:9000/flink-iceberg/warehouse\r\n      property-version: 1\r\n      clients: 5\r\n```\r\n\r\n**execute sql:**\r\n\r\n```\r\nFlink SQL> set execution.type = streaming;\r\n[INFO] Session property has been set.\r\n\r\nFlink SQL> set table.dynamic-table-options.enabled = true;\r\n[INFO] Session property has been set.\r\n\r\nFlink SQL> select * from iceberg.iceberg_db.t1 /*+ OPTIONS('streaming'='true', 'monitor-interval'='1s')*/;\r\n[ERROR] Could not execute SQL statement. Reason:\r\njava.lang.ClassCastException: org.apache.iceberg.hadoop.HadoopCatalog cannot be cast to org.apache.iceberg.catalog.Catalog\r\n```\r\n\r\n**error info:**\r\n\r\n```\r\n2021-06-14 16:35:57,838 INFO  org.apache.iceberg.BaseMetastoreCatalog                      [] - Table loaded by catalog: iceberg.iceberg_db.t1\r\n2021-06-14 16:35:59,910 WARN  org.apache.flink.table.client.cli.CliClient                  [] - Could not execute SQL statement.\r\norg.apache.flink.table.client.gateway.SqlExecutionException: Invalid SQL query.\r\n\tat org.apache.flink.table.client.gateway.local.LocalExecutor.executeQueryInternal(LocalExecutor.java:548) ~[flink-sql-client_2.11-1.12.1.jar:1.12.1]\r\n\tat org.apache.flink.table.client.gateway.local.LocalExecutor.executeQuery(LocalExecutor.java:374) ~[flink-sql-client_2.11-1.12.1.jar:1.12.1]\r\n\tat org.apache.flink.table.client.cli.CliClient.callSelect(CliClient.java:648) ~[flink-sql-client_2.11-1.12.1.jar:1.12.1]\r\n\tat org.apache.flink.table.client.cli.CliClient.callCommand(CliClient.java:323) ~[flink-sql-client_2.11-1.12.1.jar:1.12.1]\r\n\tat java.util.Optional.ifPresent(Optional.java:159) [?:1.8.0_171]\r\n\tat org.apache.flink.table.client.cli.CliClient.open(CliClient.java:214) [flink-sql-client_2.11-1.12.1.jar:1.12.1]\r\n\tat org.apache.flink.table.client.SqlClient.openCli(SqlClient.java:144) [flink-sql-client_2.11-1.12.1.jar:1.12.1]\r\n\tat org.apache.flink.table.client.SqlClient.start(SqlClient.java:115) [flink-sql-client_2.11-1.12.1.jar:1.12.1]\r\n\tat org.apache.flink.table.client.SqlClient.main(SqlClient.java:201) [flink-sql-client_2.11-1.12.1.jar:1.12.1]\r\nCaused by: java.lang.IllegalArgumentException: Cannot initialize Catalog, org.apache.iceberg.hadoop.HadoopCatalog does not implement Catalog.\r\n\tat org.apache.iceberg.CatalogUtil.loadCatalog(CatalogUtil.java:186) ~[?:?]\r\n\tat org.apache.iceberg.flink.CatalogLoader$HadoopCatalogLoader.loadCatalog(CatalogLoader.java:79) ~[?:?]\r\n\tat org.apache.iceberg.flink.TableLoader$CatalogTableLoader.open(TableLoader.java:108) ~[?:?]\r\n\tat org.apache.iceberg.flink.source.FlinkSource$Builder.buildFormat(FlinkSource.java:178) ~[?:?]\r\n\tat org.apache.iceberg.flink.source.FlinkSource$Builder.build(FlinkSource.java:204) ~[?:?]\r\n\tat org.apache.iceberg.flink.IcebergTableSource.createDataStream(IcebergTableSource.java:110) ~[?:?]\r\n\tat org.apache.iceberg.flink.IcebergTableSource.access$000(IcebergTableSource.java:49) ~[?:?]\r\n\tat org.apache.iceberg.flink.IcebergTableSource$1.produceDataStream(IcebergTableSource.java:163) ~[?:?]\r\n\tat org.apache.flink.table.planner.plan.nodes.common.CommonPhysicalTableSourceScan.createSourceTransformation(CommonPhysicalTableSourceScan.scala:88) ~[flink-table-blink_2.11-1.12.1.jar:1.12.1]\r\n\tat org.apache.flink.table.planner.plan.nodes.physical.stream.StreamExecTableSourceScan.translateToPlanInternal(StreamExecTableSourceScan.scala:91) ~[flink-table-blink_2.11-1.12.1.jar:1.12.1]\r\n\tat org.apache.flink.table.planner.plan.nodes.physical.stream.StreamExecTableSourceScan.translateToPlanInternal(StreamExecTableSourceScan.scala:44) ~[flink-table-blink_2.11-1.12.1.jar:1.12.1]\r\n\tat org.apache.flink.table.planner.plan.nodes.exec.ExecNode$class.translateToPlan(ExecNode.scala:59) ~[flink-table-blink_2.11-1.12.1.jar:1.12.1]\r\n\tat org.apache.flink.table.planner.plan.nodes.physical.stream.StreamExecTableSourceScan.translateToPlan(StreamExecTableSourceScan.scala:44) ~[flink-table-blink_2.11-1.12.1.jar:1.12.1]\r\n\tat org.apache.flink.table.planner.plan.nodes.physical.stream.StreamExecLegacySink.translateToTransformation(StreamExecLegacySink.scala:158) ~[flink-table-blink_2.11-1.12.1.jar:1.12.1]\r\n\tat org.apache.flink.table.planner.plan.nodes.physical.stream.StreamExecLegacySink.translateToPlanInternal(StreamExecLegacySink.scala:82) ~[flink-table-blink_2.11-1.12.1.jar:1.12.1]\r\n\tat org.apache.flink.table.planner.plan.nodes.physical.stream.StreamExecLegacySink.translateToPlanInternal(StreamExecLegacySink.scala:48) ~[flink-table-blink_2.11-1.12.1.jar:1.12.1]\r\n\tat org.apache.flink.table.planner.plan.nodes.exec.ExecNode$class.translateToPlan(ExecNode.scala:59) ~[flink-table-blink_2.11-1.12.1.jar:1.12.1]\r\n\tat org.apache.flink.table.planner.plan.nodes.physical.stream.StreamExecLegacySink.translateToPlan(StreamExecLegacySink.scala:48) ~[flink-table-blink_2.11-1.12.1.jar:1.12.1]\r\n\tat org.apache.flink.table.planner.delegation.StreamPlanner$$anonfun$translateToPlan$1.apply(StreamPlanner.scala:66) ~[flink-table-blink_2.11-1.12.1.jar:1.12.1]\r\n\tat org.apache.flink.table.planner.delegation.StreamPlanner$$anonfun$translateToPlan$1.apply(StreamPlanner.scala:65) ~[flink-table-blink_2.11-1.12.1.jar:1.12.1]\r\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:234) ~[flink-dist_2.11-1.12.1.jar:1.12.1]\r\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:234) ~[flink-dist_2.11-1.12.1.jar:1.12.1]\r\n\tat scala.collection.Iterator$class.foreach(Iterator.scala:891) ~[flink-dist_2.11-1.12.1.jar:1.12.1]\r\n\tat scala.collection.AbstractIterator.foreach(Iterator.scala:1334) ~[flink-dist_2.11-1.12.1.jar:1.12.1]\r\n\tat scala.collection.IterableLike$class.foreach(IterableLike.scala:72) ~[flink-dist_2.11-1.12.1.jar:1.12.1]\r\n\tat scala.collection.AbstractIterable.foreach(Iterable.scala:54) ~[flink-dist_2.11-1.12.1.jar:1.12.1]\r\n\tat scala.collection.TraversableLike$class.map(TraversableLike.scala:234) ~[flink-dist_2.11-1.12.1.jar:1.12.1]\r\n\tat scala.collection.AbstractTraversable.map(Traversable.scala:104) ~[flink-dist_2.11-1.12.1.jar:1.12.1]\r\n\tat org.apache.flink.table.planner.delegation.StreamPlanner.translateToPlan(StreamPlanner.scala:65) ~[flink-table-blink_2.11-1.12.1.jar:1.12.1]\r\n\tat org.apache.flink.table.planner.delegation.PlannerBase.translate(PlannerBase.scala:167) ~[flink-table-blink_2.11-1.12.1.jar:1.12.1]\r\n\tat org.apache.flink.table.api.internal.TableEnvironmentImpl.translate(TableEnvironmentImpl.java:1329) ~[flink-table-blink_2.11-1.12.1.jar:1.12.1]\r\n\tat org.apache.flink.table.api.internal.TableEnvironmentImpl.translateAndClearBuffer(TableEnvironmentImpl.java:1321) ~[flink-table-blink_2.11-1.12.1.jar:1.12.1]\r\n\tat org.apache.flink.table.api.bridge.java.internal.StreamTableEnvironmentImpl.getPipeline(StreamTableEnvironmentImpl.java:328) ~[flink-table-blink_2.11-1.12.1.jar:1.12.1]\r\n\tat org.apache.flink.table.client.gateway.local.ExecutionContext.lambda$createPipeline$1(ExecutionContext.java:287) ~[flink-sql-client_2.11-1.12.1.jar:1.12.1]\r\n\tat org.apache.flink.table.client.gateway.local.ExecutionContext.wrapClassLoader(ExecutionContext.java:256) ~[flink-sql-client_2.11-1.12.1.jar:1.12.1]\r\n\tat org.apache.flink.table.client.gateway.local.ExecutionContext.createPipeline(ExecutionContext.java:282) ~[flink-sql-client_2.11-1.12.1.jar:1.12.1]\r\n\tat org.apache.flink.table.client.gateway.local.LocalExecutor.executeQueryInternal(LocalExecutor.java:542) ~[flink-sql-client_2.11-1.12.1.jar:1.12.1]\r\n\t... 8 more\r\nCaused by: java.lang.ClassCastException: org.apache.iceberg.hadoop.HadoopCatalog cannot be cast to org.apache.iceberg.catalog.Catalog\r\n\tat org.apache.iceberg.CatalogUtil.loadCatalog(CatalogUtil.java:182) ~[?:?]\r\n\tat org.apache.iceberg.flink.CatalogLoader$HadoopCatalogLoader.loadCatalog(CatalogLoader.java:79) ~[?:?]\r\n\tat org.apache.iceberg.flink.TableLoader$CatalogTableLoader.open(TableLoader.java:108) ~[?:?]\r\n\tat org.apache.iceberg.flink.source.FlinkSource$Builder.buildFormat(FlinkSource.java:178) ~[?:?]\r\n\tat org.apache.iceberg.flink.source.FlinkSource$Builder.build(FlinkSource.java:204) ~[?:?]\r\n\tat org.apache.iceberg.flink.IcebergTableSource.createDataStream(IcebergTableSource.java:110) ~[?:?]\r\n\tat org.apache.iceberg.flink.IcebergTableSource.access$000(IcebergTableSource.java:49) ~[?:?]\r\n\tat org.apache.iceberg.flink.IcebergTableSource$1.produceDataStream(IcebergTableSource.java:163) ~[?:?]\r\n\tat org.apache.flink.table.planner.plan.nodes.common.CommonPhysicalTableSourceScan.createSourceTransformation(CommonPhysicalTableSourceScan.scala:88) ~[flink-table-blink_2.11-1.12.1.jar:1.12.1]\r\n\tat org.apache.flink.table.planner.plan.nodes.physical.stream.StreamExecTableSourceScan.translateToPlanInternal(StreamExecTableSourceScan.scala:91) ~[flink-table-blink_2.11-1.12.1.jar:1.12.1]\r\n\tat org.apache.flink.table.planner.plan.nodes.physical.stream.StreamExecTableSourceScan.translateToPlanInternal(StreamExecTableSourceScan.scala:44) ~[flink-table-blink_2.11-1.12.1.jar:1.12.1]\r\n\tat org.apache.flink.table.planner.plan.nodes.exec.ExecNode$class.translateToPlan(ExecNode.scala:59) ~[flink-table-blink_2.11-1.12.1.jar:1.12.1]\r\n\tat org.apache.flink.table.planner.plan.nodes.physical.stream.StreamExecTableSourceScan.translateToPlan(StreamExecTableSourceScan.scala:44) ~[flink-table-blink_2.11-1.12.1.jar:1.12.1]\r\n\tat org.apache.flink.table.planner.plan.nodes.physical.stream.StreamExecLegacySink.translateToTransformation(StreamExecLegacySink.scala:158) ~[flink-table-blink_2.11-1.12.1.jar:1.12.1]\r\n\tat org.apache.flink.table.planner.plan.nodes.physical.stream.StreamExecLegacySink.translateToPlanInternal(StreamExecLegacySink.scala:82) ~[flink-table-blink_2.11-1.12.1.jar:1.12.1]\r\n\tat org.apache.flink.table.planner.plan.nodes.physical.stream.StreamExecLegacySink.translateToPlanInternal(StreamExecLegacySink.scala:48) ~[flink-table-blink_2.11-1.12.1.jar:1.12.1]\r\n\tat org.apache.flink.table.planner.plan.nodes.exec.ExecNode$class.translateToPlan(ExecNode.scala:59) ~[flink-table-blink_2.11-1.12.1.jar:1.12.1]\r\n\tat org.apache.flink.table.planner.plan.nodes.physical.stream.StreamExecLegacySink.translateToPlan(StreamExecLegacySink.scala:48) ~[flink-table-blink_2.11-1.12.1.jar:1.12.1]\r\n\tat org.apache.flink.table.planner.delegation.StreamPlanner$$anonfun$translateToPlan$1.apply(StreamPlanner.scala:66) ~[flink-table-blink_2.11-1.12.1.jar:1.12.1]\r\n\tat org.apache.flink.table.planner.delegation.StreamPlanner$$anonfun$translateToPlan$1.apply(StreamPlanner.scala:65) ~[flink-table-blink_2.11-1.12.1.jar:1.12.1]\r\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:234) ~[flink-dist_2.11-1.12.1.jar:1.12.1]\r\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:234) ~[flink-dist_2.11-1.12.1.jar:1.12.1]\r\n\tat scala.collection.Iterator$class.foreach(Iterator.scala:891) ~[flink-dist_2.11-1.12.1.jar:1.12.1]\r\n\tat scala.collection.AbstractIterator.foreach(Iterator.scala:1334) ~[flink-dist_2.11-1.12.1.jar:1.12.1]\r\n\tat scala.collection.IterableLike$class.foreach(IterableLike.scala:72) ~[flink-dist_2.11-1.12.1.jar:1.12.1]\r\n\tat scala.collection.AbstractIterable.foreach(Iterable.scala:54) ~[flink-dist_2.11-1.12.1.jar:1.12.1]\r\n\tat scala.collection.TraversableLike$class.map(TraversableLike.scala:234) ~[flink-dist_2.11-1.12.1.jar:1.12.1]\r\n\tat scala.collection.AbstractTraversable.map(Traversable.scala:104) ~[flink-dist_2.11-1.12.1.jar:1.12.1]\r\n\tat org.apache.flink.table.planner.delegation.StreamPlanner.translateToPlan(StreamPlanner.scala:65) ~[flink-table-blink_2.11-1.12.1.jar:1.12.1]\r\n\tat org.apache.flink.table.planner.delegation.PlannerBase.translate(PlannerBase.scala:167) ~[flink-table-blink_2.11-1.12.1.jar:1.12.1]\r\n\tat org.apache.flink.table.api.internal.TableEnvironmentImpl.translate(TableEnvironmentImpl.java:1329) ~[flink-table-blink_2.11-1.12.1.jar:1.12.1]\r\n\tat org.apache.flink.table.api.internal.TableEnvironmentImpl.translateAndClearBuffer(TableEnvironmentImpl.java:1321) ~[flink-table-blink_2.11-1.12.1.jar:1.12.1]\r\n\tat org.apache.flink.table.api.bridge.java.internal.StreamTableEnvironmentImpl.getPipeline(StreamTableEnvironmentImpl.java:328) ~[flink-table-blink_2.11-1.12.1.jar:1.12.1]\r\n\tat org.apache.flink.table.client.gateway.local.ExecutionContext.lambda$createPipeline$1(ExecutionContext.java:287) ~[flink-sql-client_2.11-1.12.1.jar:1.12.1]\r\n\tat org.apache.flink.table.client.gateway.local.ExecutionContext.wrapClassLoader(ExecutionContext.java:256) ~[flink-sql-client_2.11-1.12.1.jar:1.12.1]\r\n\tat org.apache.flink.table.client.gateway.local.ExecutionContext.createPipeline(ExecutionContext.java:282) ~[flink-sql-client_2.11-1.12.1.jar:1.12.1]\r\n\tat org.apache.flink.table.client.gateway.local.LocalExecutor.executeQueryInternal(LocalExecutor.java:542) ~[flink-sql-client_2.11-1.12.1.jar:1.12.1]\r\n\t... 8 more\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/860508692/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/860623039","html_url":"https://github.com/apache/iceberg/pull/2639#issuecomment-860623039","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2639","id":860623039,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MDYyMzAzOQ==","user":{"login":"ggershinsky","id":12033212,"node_id":"MDQ6VXNlcjEyMDMzMjEy","avatar_url":"https://avatars.githubusercontent.com/u/12033212?v=4","gravatar_id":"","url":"https://api.github.com/users/ggershinsky","html_url":"https://github.com/ggershinsky","followers_url":"https://api.github.com/users/ggershinsky/followers","following_url":"https://api.github.com/users/ggershinsky/following{/other_user}","gists_url":"https://api.github.com/users/ggershinsky/gists{/gist_id}","starred_url":"https://api.github.com/users/ggershinsky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ggershinsky/subscriptions","organizations_url":"https://api.github.com/users/ggershinsky/orgs","repos_url":"https://api.github.com/users/ggershinsky/repos","events_url":"https://api.github.com/users/ggershinsky/events{/privacy}","received_events_url":"https://api.github.com/users/ggershinsky/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-14T11:50:58Z","updated_at":"2021-06-14T11:50:58Z","author_association":"CONTRIBUTOR","body":"> I'm approving this to run unit tests. Thanks for working on this, @ggershinsky!\r\n\r\nThanks @rdblue!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/860623039/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/860627950","html_url":"https://github.com/apache/iceberg/pull/2639#issuecomment-860627950","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2639","id":860627950,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MDYyNzk1MA==","user":{"login":"ggershinsky","id":12033212,"node_id":"MDQ6VXNlcjEyMDMzMjEy","avatar_url":"https://avatars.githubusercontent.com/u/12033212?v=4","gravatar_id":"","url":"https://api.github.com/users/ggershinsky","html_url":"https://github.com/ggershinsky","followers_url":"https://api.github.com/users/ggershinsky/followers","following_url":"https://api.github.com/users/ggershinsky/following{/other_user}","gists_url":"https://api.github.com/users/ggershinsky/gists{/gist_id}","starred_url":"https://api.github.com/users/ggershinsky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ggershinsky/subscriptions","organizations_url":"https://api.github.com/users/ggershinsky/orgs","repos_url":"https://api.github.com/users/ggershinsky/repos","events_url":"https://api.github.com/users/ggershinsky/events{/privacy}","received_events_url":"https://api.github.com/users/ggershinsky/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-14T12:00:12Z","updated_at":"2021-06-14T12:00:12Z","author_association":"CONTRIBUTOR","body":">  Can you provide a quick summary of how to plug into Parquet encryption and what this does?\r\n\r\nCertainly. There are two encryption interfaces in parquet-mr-1.12.0 : low-level (direct impl of the spec; max flexibility; no key management) and high-level (a layer on top of low-level, with a lib-local key management tools driven by Hadoop properties). In Iceberg, we'll use directly the low-level Parquet encryption API - because the key management will be done by Iceberg, in a similar fashion for all formats; and because Iceberg has a centralized manifest capability, which makes key management more efficient than running lib-local nodes in each worker process.\r\nSince Iceberg also taps directly into Parquet low-level API (general, no encryption), this PR enables to link it to the encryption feature, and translates general column encryption configuration (TBD) into Parquet encryption configuration. \r\n\r\n> it provides Parquet's equivalent of an EncryptionManager that gets the file AAD and necessary key material from Iceberg's key_metadata field.\r\n\r\nWell, here we have the gap that I've described in the other PR. To encrypt data(/delete) files, we need the AES keys - the DEKs, \"data encryption keys\" which are used to actually encrypt the data and metadata modules (there must be a unique DEK per file/column). But the `key_material` is a binary field in the manifest entry for a data(/delete) file that keeps a \"wrapped\" version of these DEKs (encrypted with master keys, MEKs, in user's KMS system). It doesn't and shouldn't keep raw DEKs. Therefore, sending `key_material` to Parquet file writers (or any other writers) doesn't help. Per my proposal in the last sync, we can reverse this process - generate random DEKs at (Parquet) writers, use them for encryption, and send them in the `DataFile`/`DeleteFile`/`ContentFile` objects back to the manifest writer. This also seems to fit the current Iceberg model, where manifest entries are written after collecting `ContentFile` objects from file writers. At this point, the manifest writer process will contact the KMS to wrap these DEKs, and package them into the `key_metadata` field in the manifest file (for the readers).\r\n\r\nIn a future version, we might want to generate the DEKs (or get them from KMS) in the manifest writer process, and then distribute them to data/delete file writers, with a unique DEK per file (or a set of unique DEKs per file, for column encryption). This seems to be more complicated, and less fitting the current Iceberg flow; my suggestion would be to start with the reverse approach described above.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/860627950/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/860632539","html_url":"https://github.com/apache/iceberg/pull/2638#issuecomment-860632539","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2638","id":860632539,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MDYzMjUzOQ==","user":{"login":"ggershinsky","id":12033212,"node_id":"MDQ6VXNlcjEyMDMzMjEy","avatar_url":"https://avatars.githubusercontent.com/u/12033212?v=4","gravatar_id":"","url":"https://api.github.com/users/ggershinsky","html_url":"https://github.com/ggershinsky","followers_url":"https://api.github.com/users/ggershinsky/followers","following_url":"https://api.github.com/users/ggershinsky/following{/other_user}","gists_url":"https://api.github.com/users/ggershinsky/gists{/gist_id}","starred_url":"https://api.github.com/users/ggershinsky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ggershinsky/subscriptions","organizations_url":"https://api.github.com/users/ggershinsky/orgs","repos_url":"https://api.github.com/users/ggershinsky/repos","events_url":"https://api.github.com/users/ggershinsky/events{/privacy}","received_events_url":"https://api.github.com/users/ggershinsky/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-14T12:07:45Z","updated_at":"2021-06-14T12:07:45Z","author_association":"CONTRIBUTOR","body":"Yep, this PR is not a public API or anything visible to the user. It is a fully internal set of classes, that carry the barebone parameters required to activate Parquet or ORC encryption (the only formats with native encryption today). These parameters are mostly the column encryption keys; plus the footer key required for Parquet (will be ignored by ORC). Plus the AAD prefix - also Parquet-specific, but can be left for a future version, when we're done with basic table  encryption, and start working on end-to-end table integrity protection.\r\n\r\n(regarding the public API, I also think there are situations where a user might want to explicitly chose either \"native\" Parquet/ORC column encryption - or flat stream encryption for same Parquet/ORC files. But this is likely a future/advanced option, and in any case, out of scope for this PR)\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/860632539/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/860679016","html_url":"https://github.com/apache/iceberg/pull/2659#issuecomment-860679016","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2659","id":860679016,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MDY3OTAxNg==","user":{"login":"rymurr","id":2022305,"node_id":"MDQ6VXNlcjIwMjIzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/2022305?v=4","gravatar_id":"","url":"https://api.github.com/users/rymurr","html_url":"https://github.com/rymurr","followers_url":"https://api.github.com/users/rymurr/followers","following_url":"https://api.github.com/users/rymurr/following{/other_user}","gists_url":"https://api.github.com/users/rymurr/gists{/gist_id}","starred_url":"https://api.github.com/users/rymurr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rymurr/subscriptions","organizations_url":"https://api.github.com/users/rymurr/orgs","repos_url":"https://api.github.com/users/rymurr/repos","events_url":"https://api.github.com/users/rymurr/events{/privacy}","received_events_url":"https://api.github.com/users/rymurr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-14T13:20:12Z","updated_at":"2021-06-14T13:20:12Z","author_association":"CONTRIBUTOR","body":"> @aokolnychyi and @rymurr, I think that we turned off timer-based cache invalidation because it was causing tables referenced by cached queries to be out of sync with tables that are freshly loaded.\r\n\r\nI think it was also related to the table being dropped from the cache during a long running operation. \r\n\r\nIs this the only place in iceberg that a table would be cached? Or is it cached by spark as well. I would be in favour of having as little caching as possible handled by iceberg directly and rely on engine level caching for Tables. I guess adding the timer back to this cache is a way of caching multiple calls to the table before the Spark cache has been notified of the Spark Table?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/860679016/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/860833293","html_url":"https://github.com/apache/iceberg/pull/2675#issuecomment-860833293","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2675","id":860833293,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MDgzMzI5Mw==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-14T16:48:22Z","updated_at":"2021-06-14T16:48:22Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer we are not waiting for anyone to merge, but I thought for any format v2 change @rdblue should take a look and approve. If it's not necessary we will merge to unblock other subsequent changes.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/860833293/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/860884196","html_url":"https://github.com/apache/iceberg/issues/2676#issuecomment-860884196","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2676","id":860884196,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MDg4NDE5Ng==","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-14T18:05:27Z","updated_at":"2021-06-14T18:05:27Z","author_association":"CONTRIBUTOR","body":"Hi Kyle, thanks for bringing this up. It would be super helpful for beginners and anyone who want to try Iceberg for the first time. Agreed to start with a simple one. Just to brainstorm ideas:\r\n1. Even just a runtime without any catalog still be helpful for people who run Iceberg first time. \r\n2. The runtime with catalog would be closer to the real use case. \r\n3. The runtime with catalog and notebook.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/860884196/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/860891810","html_url":"https://github.com/apache/iceberg/pull/2595#issuecomment-860891810","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2595","id":860891810,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MDg5MTgxMA==","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-14T18:17:14Z","updated_at":"2021-06-14T18:17:14Z","author_association":"CONTRIBUTOR","body":"Hi @kbendick , sorry for the delayed review. Both spark2 and spark3 jmh commands works well in my laptop with your PR. For Spark3, I can do with both jdk8 and jdk11. Looks good to me overall. One question, is it possible to let gradle create dirs(`spark2/benchmark` and `spark3/benchmark`) instead of using `.gitkeep` files?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/860891810/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/861011004","html_url":"https://github.com/apache/iceberg/pull/2684#issuecomment-861011004","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2684","id":861011004,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MTAxMTAwNA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-14T21:33:11Z","updated_at":"2021-06-14T21:33:11Z","author_association":"CONTRIBUTOR","body":"Thanks @nastra! I merged this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/861011004/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/861011220","html_url":"https://github.com/apache/iceberg/pull/2695#issuecomment-861011220","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2695","id":861011220,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MTAxMTIyMA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-14T21:33:43Z","updated_at":"2021-06-14T21:33:43Z","author_association":"CONTRIBUTOR","body":"Running tests.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/861011220/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/861040175","html_url":"https://github.com/apache/iceberg/pull/2651#issuecomment-861040175","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2651","id":861040175,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MTA0MDE3NQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-14T22:40:52Z","updated_at":"2021-06-14T22:40:52Z","author_association":"CONTRIBUTOR","body":"@jackye1995, my primary concern with this is that you're reading the data to produce whether or not a row should be present. I think that would mean basically reading all of the data twice in Trino: once into pages and once for the `CloseableIterable<Boolean>` used to mark whether a row in a page should be kept. That doesn't seem worth it to me, although you could argue that if your projection is narrow it would be okay. You may also already be re-using the pages to produce the underlying `StructLike` iterable. If that's the case, then you can ignore from here on...\r\n\r\nI think a better approach would be to adapt the pages in Trino to produce a view of a row that implements `StructLike`, at least in a limited capacity (i.e. for top-level or struct columns only, no array/map nesting). That's what happens in Spark vectorization. There is a class that wraps a batch and provides access to a row using its ordinal. If you had that, you'd be able to read the data into pages and still use Iceberg's delete filters to test each row.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/861040175/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/861042571","html_url":"https://github.com/apache/iceberg/pull/2657#issuecomment-861042571","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2657","id":861042571,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MTA0MjU3MQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-14T22:47:07Z","updated_at":"2021-06-14T22:47:07Z","author_association":"CONTRIBUTOR","body":"@tprelle, the `spark.md` file has been split across several other files in the docs site. We've left it as-is so that existing links continue to function and so that we can move links internal to the site over to the new pages. But the actual documentation should probably be in [`spark-queries.md` instead](https://iceberg.apache.org/spark-queries/).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/861042571/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/861101630","html_url":"https://github.com/apache/iceberg/pull/2538#issuecomment-861101630","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2538","id":861101630,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MTEwMTYzMA==","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-15T01:26:27Z","updated_at":"2021-06-15T01:26:27Z","author_association":"COLLABORATOR","body":"@rdblue Is this ready to merge? The delete rewrites may depend on this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/861101630/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/861106556","html_url":"https://github.com/apache/iceberg/pull/2273#issuecomment-861106556","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2273","id":861106556,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MTEwNjU1Ng==","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-15T01:43:04Z","updated_at":"2021-06-15T01:43:04Z","author_association":"COLLABORATOR","body":"Close this since we have `RewriteStrategy` and `RewriteDatafilesAction` now. Thanks @RussellSpitzer  ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/861106556/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/861162434","html_url":"https://github.com/apache/iceberg/pull/2654#issuecomment-861162434","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2654","id":861162434,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MTE2MjQzNA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-15T04:36:23Z","updated_at":"2021-06-15T04:36:23Z","author_association":"CONTRIBUTOR","body":"This looks great to me but optional identity columns does not seem right. Do we have any systems where that's possible?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/861162434/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/861269643","html_url":"https://github.com/apache/iceberg/issues/2692#issuecomment-861269643","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2692","id":861269643,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MTI2OTY0Mw==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-15T07:48:33Z","updated_at":"2021-06-15T07:48:33Z","author_association":"CONTRIBUTOR","body":"As a starting point, for the Spark vectorized parquet reader, I think we should explicitly throw when we either\r\n- (1) encounter an encoding that’s not supported\r\n- (2) explicitly throw when we encounter a Parquet v2 file at read time.\r\n\r\n\r\nI think that approach 2 would potentially be simpler and more in line with the code from Spark, which has an explicit V1 path and V2 path for data pages, footers, etc (and which we modeled this class on).\r\n\r\nSpark 3.1.1 afaik does not support vectorized reading of files written with parquet v2 format, though it seems to be in the works.\r\n\r\nA more helpful error message would go a long way until we’ve updated the code to support vectorized reading of both parquet v1 write format and parquet v2 format in the Spark vectorized parquet reader.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/861269643/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/861639310","html_url":"https://github.com/apache/iceberg/issues/2696#issuecomment-861639310","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2696","id":861639310,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MTYzOTMxMA==","user":{"login":"WesternStar","id":728451,"node_id":"MDQ6VXNlcjcyODQ1MQ==","avatar_url":"https://avatars.githubusercontent.com/u/728451?v=4","gravatar_id":"","url":"https://api.github.com/users/WesternStar","html_url":"https://github.com/WesternStar","followers_url":"https://api.github.com/users/WesternStar/followers","following_url":"https://api.github.com/users/WesternStar/following{/other_user}","gists_url":"https://api.github.com/users/WesternStar/gists{/gist_id}","starred_url":"https://api.github.com/users/WesternStar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WesternStar/subscriptions","organizations_url":"https://api.github.com/users/WesternStar/orgs","repos_url":"https://api.github.com/users/WesternStar/repos","events_url":"https://api.github.com/users/WesternStar/events{/privacy}","received_events_url":"https://api.github.com/users/WesternStar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-15T16:20:20Z","updated_at":"2021-06-15T16:20:54Z","author_association":"NONE","body":"I was using java 11 and only java 8 was correct to use on emr\r\nHowever still having a couple of issues here that I'm working through.\r\n```\r\nHive Session ID = 6bc6ce9f-83e2-4f4a-bff0-c884f8aceb6d\r\nhive> add jar /lib/hive/auxlib/iceberg-hive-runtime-master-j8.jar\r\n    > ;\r\nAdded [/lib/hive/auxlib/iceberg-hive-runtime-master-j8.jar] to class path\r\nAdded resources: [/lib/hive/auxlib/iceberg-hive-runtime-master-j8.jar]\r\nhive> list jars;\r\n/lib/hive/auxlib/iceberg-hive-runtime-master-j8.jar\r\nhive> SET iceberg.engine.hive.enabled=true;\r\nhive> SET hive.vectorized.execution.enabled=false;\r\nhive> SET iceberg.catalog.glue.catalog-impl=org.apache.iceberg.aws.glue.GlueCatalog;\r\nhive> SET iceberg.catalog.glue.warehouse=s3://XXXXXXX/amcnair/testing/iceberg/fix/;\r\nhive> SET iceberg.catalog.glue.lock-impl=org.apache.iceberg.aws.glue.DynamoLockManager;\r\nhive> SET iceberg.catalog.glue.lock.table=IcebergTestingAmcnair;\r\nhive> CREATE EXTERNAL TABLE iceberg_db.sample\r\n    > STORED BY 'org.apache.iceberg.mr.hive.HiveIcebergStorageHandler'\r\n    > TBLPROPERTIES ('iceberg.catalog'='glue','engine.hive.enabled'='true' );\r\nSLF4J: Failed to load class \"org.slf4j.impl.StaticLoggerBinder\".\r\nSLF4J: Defaulting to no-operation (NOP) logger implementation\r\nSLF4J: See http://www.slf4j.org/codes.html#StaticLoggerBinder for further details.\r\nFAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask. AlreadyExistsException(message:Table sample already exists.)\r\nhive> select * from iceberg_db.sample\r\n    > ;\r\nFAILED: SemanticException Unable to fetch table sample. StorageDescriptor cannot be null for table: sample (Service: null; Status Code: 0; Error Code: null; Request ID: null; Proxy: null)\r\nhive> CREATE EXTERNAL TABLE iceberg_db.ext_sample\r\n    > STORED BY 'org.apache.iceberg.mr.hive.HiveIcebergStorageHandler'\r\n    > TBLPROPERTIES ('iceberg.catalog'='glue','engine.hive.enabled'='true' );\r\nFAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask. java.lang.RuntimeException: MetaException(message:org.apache.hadoop.hive.serde2.SerDeException Please provide an existing table or a valid schema)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/861639310/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/861684800","html_url":"https://github.com/apache/iceberg/pull/2648#issuecomment-861684800","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2648","id":861684800,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MTY4NDgwMA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-15T17:20:18Z","updated_at":"2021-06-15T17:20:18Z","author_association":"CONTRIBUTOR","body":"Looks great. Thanks @jshmchenxi!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/861684800/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/861698721","html_url":"https://github.com/apache/iceberg/pull/2659#issuecomment-861698721","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2659","id":861698721,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MTY5ODcyMQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-15T17:34:24Z","updated_at":"2021-06-15T17:34:24Z","author_association":"CONTRIBUTOR","body":"> Is this the only place in iceberg that a table would be cached?\r\n\r\nThe table will be referenced by Spark plans as well. I think the problem was that those plans weren't being invalidated when you ran `REFRESH TABLE t` because the catalog's `invalidateTable` method calls `refresh` on the table reference that it loads. So if a table was cleared from the cache then the existing references in Spark would no longer be updated by the catalog's `invalidateTable` call.\r\n\r\nThat seems like a Spark problem and not a catalog problem to me, which is why I think we should revisit this decision. Shouldn't Spark invalidate cached plans that reference a table when `REFRESH TABLE` runs, rather than assuming that the catalog can do it?\r\n\r\nWe may also want to purposely separate a table when it is in a cached plan. @aokolnychyi, what did we decide was the \"correct\" behavior when a query is cached?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/861698721/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/861717269","html_url":"https://github.com/apache/iceberg/pull/2654#issuecomment-861717269","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2654","id":861717269,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MTcxNzI2OQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-15T18:00:30Z","updated_at":"2021-06-15T18:00:30Z","author_association":"CONTRIBUTOR","body":"> . . . optional identity columns does not seem right. Do we have any systems where that's possible?\r\n\r\nI'm okay removing the ability to use optional columns. That's what @jackye1995 had originally and it aligns better with the SQL spec.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/861717269/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/861728176","html_url":"https://github.com/apache/iceberg/pull/2538#issuecomment-861728176","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2538","id":861728176,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MTcyODE3Ng==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-15T18:16:04Z","updated_at":"2021-06-15T18:16:04Z","author_association":"CONTRIBUTOR","body":"Thanks, @chenjunjiedada. I'll take a look.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/861728176/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/861728965","html_url":"https://github.com/apache/iceberg/pull/2654#issuecomment-861728965","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2654","id":861728965,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MTcyODk2NQ==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-15T18:17:27Z","updated_at":"2021-06-15T18:17:27Z","author_association":"CONTRIBUTOR","body":"trying to remember why we decided to make it optional: \r\n\r\nhttps://github.com/apache/iceberg/pull/2465#discussion_r615313057\r\n\r\nMy current thinking is that it does not hurt to make it optional. If the engine enforces the primary key to be not nullable, it will fail in that engine during CREATE TABLE anyway, just like what we see in Flink.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/861728965/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/861814718","html_url":"https://github.com/apache/iceberg/pull/2538#issuecomment-861814718","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2538","id":861814718,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MTgxNDcxOA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-15T20:37:42Z","updated_at":"2021-06-15T20:37:42Z","author_association":"CONTRIBUTOR","body":"@chenjunjiedada, the constant handling in Avro appears to be the only remaining issue. Once you update that, I'll merge this. Thanks for working on it!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/861814718/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/861831900","html_url":"https://github.com/apache/iceberg/pull/2603#issuecomment-861831900","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2603","id":861831900,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MTgzMTkwMA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-15T21:07:29Z","updated_at":"2021-06-15T21:07:29Z","author_association":"CONTRIBUTOR","body":"@jshmchenxi, see my comments above for more detail, but this approach can't work for the situation you describe. If you want to support this situation, then you would need to scan all table metadata to check whether the files that need to exist still do using added and existing entries, not delete entries. Since delete entries can be lost when history is cleaned up, you have to check for the actual files.\r\n\r\nI'm going to close this PR since the approach won't work. Feel free to open another one with an alternative implementation that checks for added or existing entries for the required files.\r\n\r\nThanks for working on this!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/861831900/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/861850669","html_url":"https://github.com/apache/iceberg/pull/2441#issuecomment-861850669","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2441","id":861850669,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MTg1MDY2OQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-15T21:37:30Z","updated_at":"2021-06-15T21:37:30Z","author_association":"CONTRIBUTOR","body":"Looks like there is a problem finding `parquet-avro`:\r\n\r\n```\r\nExecution failed for task ':iceberg-parquet:compileJava'.\r\n> Could not resolve all files for configuration ':iceberg-parquet:compileClasspath'.\r\n   > Could not find org.apache.parquet:parquet-avro:1.12.1.\r\n     Searched in the following locations:\r\n       - https://repo.maven.apache.org/maven2/org/apache/parquet/parquet-avro/1.12.1/parquet-avro-1.12.1.pom\r\n       - https://repo.maven.apache.org/maven2/org/apache/parquet/parquet-avro/1.12.1/parquet-avro-1.12.1.jar\r\n       - file:/home/runner/.m2/repository/org/apache/parquet/parquet-avro/1.12.1/parquet-avro-1.12.1.pom\r\n       - file:/home/runner/.m2/repository/org/apache/parquet/parquet-avro/1.12.1/parquet-avro-1.12.1.jar\r\n     Required by:\r\n         project :iceberg-parquet\r\n```\r\n\r\nOn maven central, it looks like 1.12.0 is the latest Parquet version. I misinterpreted @jshmchenxi's comment and though that it was released. Can you roll back to 1.12.0?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/861850669/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/861879555","html_url":"https://github.com/apache/iceberg/pull/2699#issuecomment-861879555","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2699","id":861879555,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MTg3OTU1NQ==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-15T22:35:20Z","updated_at":"2021-06-15T22:35:20Z","author_association":"CONTRIBUTOR","body":"cc @jackye1995 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/861879555/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/861880524","html_url":"https://github.com/apache/iceberg/pull/2654#issuecomment-861880524","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2654","id":861880524,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MTg4MDUyNA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-15T22:37:52Z","updated_at":"2021-06-15T22:38:18Z","author_association":"CONTRIBUTOR","body":"I think my confusion comes from the fact that PK means unique and not null and that having null in any column in the tuple we upsert by, means that tuple matches nothing from the SQL perspective. It feels easier to assume columns we use in equality deletes are not nullable. I agree about the downside of not being able to use optional columns added later as identity columns but I am not sure how important that is. We can probably cover that use case with default values that LinkedIn is working on.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/861880524/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/862135430","html_url":"https://github.com/apache/iceberg/issues/2558#issuecomment-862135430","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2558","id":862135430,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MjEzNTQzMA==","user":{"login":"silvermissile","id":5319647,"node_id":"MDQ6VXNlcjUzMTk2NDc=","avatar_url":"https://avatars.githubusercontent.com/u/5319647?v=4","gravatar_id":"","url":"https://api.github.com/users/silvermissile","html_url":"https://github.com/silvermissile","followers_url":"https://api.github.com/users/silvermissile/followers","following_url":"https://api.github.com/users/silvermissile/following{/other_user}","gists_url":"https://api.github.com/users/silvermissile/gists{/gist_id}","starred_url":"https://api.github.com/users/silvermissile/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/silvermissile/subscriptions","organizations_url":"https://api.github.com/users/silvermissile/orgs","repos_url":"https://api.github.com/users/silvermissile/repos","events_url":"https://api.github.com/users/silvermissile/events{/privacy}","received_events_url":"https://api.github.com/users/silvermissile/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-16T07:48:57Z","updated_at":"2021-06-16T07:56:16Z","author_association":"NONE","body":"Thanks to this pr , I 'm able to use flink sql 's  `TO_TIMESTAMP_LTZ()`  function  when insert data into iceberg table .   So are  Partition transforms on timestamp field.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/862135430/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/862388844","html_url":"https://github.com/apache/iceberg/issues/2351#issuecomment-862388844","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2351","id":862388844,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MjM4ODg0NA==","user":{"login":"cduongvn","id":4472857,"node_id":"MDQ6VXNlcjQ0NzI4NTc=","avatar_url":"https://avatars.githubusercontent.com/u/4472857?v=4","gravatar_id":"","url":"https://api.github.com/users/cduongvn","html_url":"https://github.com/cduongvn","followers_url":"https://api.github.com/users/cduongvn/followers","following_url":"https://api.github.com/users/cduongvn/following{/other_user}","gists_url":"https://api.github.com/users/cduongvn/gists{/gist_id}","starred_url":"https://api.github.com/users/cduongvn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cduongvn/subscriptions","organizations_url":"https://api.github.com/users/cduongvn/orgs","repos_url":"https://api.github.com/users/cduongvn/repos","events_url":"https://api.github.com/users/cduongvn/events{/privacy}","received_events_url":"https://api.github.com/users/cduongvn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-16T13:39:16Z","updated_at":"2021-06-16T13:39:16Z","author_association":"NONE","body":"We also experience poor performance on `count(*)` query\r\n\r\niceberg 0.11.0\r\ntrino 357\r\n\r\ntrino worker*3\r\n32CORE 150GB RAM\r\n\r\n```\r\ntrino> select count(1) from iceberg.raw.users;\r\n _col0\r\n--------\r\n 284903\r\n(1 row)\r\n\r\nQuery 20210616_132555_00103_cyj8y, FINISHED, 3 nodes\r\nSplits: 197,393 total, 197,393 done (100.00%)\r\n6:27 [285K rows, 3.01GB] [735 rows/s, 7.96MB/s]\r\n```\r\n\r\nThe table `iceberg.raw.user` is partitioned by `day(created_date)`","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/862388844/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/862394343","html_url":"https://github.com/apache/iceberg/issues/2351#issuecomment-862394343","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2351","id":862394343,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MjM5NDM0Mw==","user":{"login":"ckdarby","id":220283,"node_id":"MDQ6VXNlcjIyMDI4Mw==","avatar_url":"https://avatars.githubusercontent.com/u/220283?v=4","gravatar_id":"","url":"https://api.github.com/users/ckdarby","html_url":"https://github.com/ckdarby","followers_url":"https://api.github.com/users/ckdarby/followers","following_url":"https://api.github.com/users/ckdarby/following{/other_user}","gists_url":"https://api.github.com/users/ckdarby/gists{/gist_id}","starred_url":"https://api.github.com/users/ckdarby/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ckdarby/subscriptions","organizations_url":"https://api.github.com/users/ckdarby/orgs","repos_url":"https://api.github.com/users/ckdarby/repos","events_url":"https://api.github.com/users/ckdarby/events{/privacy}","received_events_url":"https://api.github.com/users/ckdarby/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-16T13:45:56Z","updated_at":"2021-06-16T13:45:56Z","author_association":"NONE","body":"@nautilus28 Are you writing each user as a new snapshot?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/862394343/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/862395309","html_url":"https://github.com/apache/iceberg/issues/2351#issuecomment-862395309","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2351","id":862395309,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MjM5NTMwOQ==","user":{"login":"cduongvn","id":4472857,"node_id":"MDQ6VXNlcjQ0NzI4NTc=","avatar_url":"https://avatars.githubusercontent.com/u/4472857?v=4","gravatar_id":"","url":"https://api.github.com/users/cduongvn","html_url":"https://github.com/cduongvn","followers_url":"https://api.github.com/users/cduongvn/followers","following_url":"https://api.github.com/users/cduongvn/following{/other_user}","gists_url":"https://api.github.com/users/cduongvn/gists{/gist_id}","starred_url":"https://api.github.com/users/cduongvn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cduongvn/subscriptions","organizations_url":"https://api.github.com/users/cduongvn/orgs","repos_url":"https://api.github.com/users/cduongvn/repos","events_url":"https://api.github.com/users/cduongvn/events{/privacy}","received_events_url":"https://api.github.com/users/cduongvn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-16T13:47:10Z","updated_at":"2021-06-16T13:49:38Z","author_association":"NONE","body":"@ckdarby no, we have updated rows, so new snapshot will contain new rows and some existing rows.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/862395309/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/862452559","html_url":"https://github.com/apache/iceberg/issues/2351#issuecomment-862452559","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2351","id":862452559,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MjQ1MjU1OQ==","user":{"login":"ckdarby","id":220283,"node_id":"MDQ6VXNlcjIyMDI4Mw==","avatar_url":"https://avatars.githubusercontent.com/u/220283?v=4","gravatar_id":"","url":"https://api.github.com/users/ckdarby","html_url":"https://github.com/ckdarby","followers_url":"https://api.github.com/users/ckdarby/followers","following_url":"https://api.github.com/users/ckdarby/following{/other_user}","gists_url":"https://api.github.com/users/ckdarby/gists{/gist_id}","starred_url":"https://api.github.com/users/ckdarby/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ckdarby/subscriptions","organizations_url":"https://api.github.com/users/ckdarby/orgs","repos_url":"https://api.github.com/users/ckdarby/repos","events_url":"https://api.github.com/users/ckdarby/events{/privacy}","received_events_url":"https://api.github.com/users/ckdarby/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-16T14:57:23Z","updated_at":"2021-06-16T14:57:23Z","author_association":"NONE","body":"@nautilus28 Do you do this for every user? My understanding is that you'd have the latest manifest but the latest manifest would point to all these individual manifest lists created for every user, no?\r\n\r\nAsking also from the perspective of that would explain why it had nearly 200k splits.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/862452559/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/862454886","html_url":"https://github.com/apache/iceberg/issues/2351#issuecomment-862454886","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2351","id":862454886,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MjQ1NDg4Ng==","user":{"login":"cduongvn","id":4472857,"node_id":"MDQ6VXNlcjQ0NzI4NTc=","avatar_url":"https://avatars.githubusercontent.com/u/4472857?v=4","gravatar_id":"","url":"https://api.github.com/users/cduongvn","html_url":"https://github.com/cduongvn","followers_url":"https://api.github.com/users/cduongvn/followers","following_url":"https://api.github.com/users/cduongvn/following{/other_user}","gists_url":"https://api.github.com/users/cduongvn/gists{/gist_id}","starred_url":"https://api.github.com/users/cduongvn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cduongvn/subscriptions","organizations_url":"https://api.github.com/users/cduongvn/orgs","repos_url":"https://api.github.com/users/cduongvn/repos","events_url":"https://api.github.com/users/cduongvn/events{/privacy}","received_events_url":"https://api.github.com/users/cduongvn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-16T15:00:12Z","updated_at":"2021-06-16T15:00:12Z","author_association":"NONE","body":"@ckdarby you might be right. What information I could check to confirm your assumption?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/862454886/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/862458415","html_url":"https://github.com/apache/iceberg/issues/2351#issuecomment-862458415","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2351","id":862458415,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MjQ1ODQxNQ==","user":{"login":"ckdarby","id":220283,"node_id":"MDQ6VXNlcjIyMDI4Mw==","avatar_url":"https://avatars.githubusercontent.com/u/220283?v=4","gravatar_id":"","url":"https://api.github.com/users/ckdarby","html_url":"https://github.com/ckdarby","followers_url":"https://api.github.com/users/ckdarby/followers","following_url":"https://api.github.com/users/ckdarby/following{/other_user}","gists_url":"https://api.github.com/users/ckdarby/gists{/gist_id}","starred_url":"https://api.github.com/users/ckdarby/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ckdarby/subscriptions","organizations_url":"https://api.github.com/users/ckdarby/orgs","repos_url":"https://api.github.com/users/ckdarby/repos","events_url":"https://api.github.com/users/ckdarby/events{/privacy}","received_events_url":"https://api.github.com/users/ckdarby/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-16T15:04:28Z","updated_at":"2021-06-16T15:04:28Z","author_association":"NONE","body":"@nautilus28 I think you're on Trino slack. I sent a message there and we can discuss more. If not, send over an email to ckdarby [at] gmail.com","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/862458415/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/862526792","html_url":"https://github.com/apache/iceberg/pull/2703#issuecomment-862526792","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2703","id":862526792,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MjUyNjc5Mg==","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-16T16:29:28Z","updated_at":"2021-06-16T16:29:28Z","author_association":"CONTRIBUTOR","body":"@rdblue is this something that you could potentially review?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/862526792/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/862526856","html_url":"https://github.com/apache/iceberg/pull/2704#issuecomment-862526856","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2704","id":862526856,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MjUyNjg1Ng==","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-16T16:29:33Z","updated_at":"2021-06-16T16:29:33Z","author_association":"CONTRIBUTOR","body":"@rdblue is this something that you could potentially review?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/862526856/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/862590766","html_url":"https://github.com/apache/iceberg/pull/2698#issuecomment-862590766","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2698","id":862590766,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MjU5MDc2Ng==","user":{"login":"TGooch44","id":1591711,"node_id":"MDQ6VXNlcjE1OTE3MTE=","avatar_url":"https://avatars.githubusercontent.com/u/1591711?v=4","gravatar_id":"","url":"https://api.github.com/users/TGooch44","html_url":"https://github.com/TGooch44","followers_url":"https://api.github.com/users/TGooch44/followers","following_url":"https://api.github.com/users/TGooch44/following{/other_user}","gists_url":"https://api.github.com/users/TGooch44/gists{/gist_id}","starred_url":"https://api.github.com/users/TGooch44/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TGooch44/subscriptions","organizations_url":"https://api.github.com/users/TGooch44/orgs","repos_url":"https://api.github.com/users/TGooch44/repos","events_url":"https://api.github.com/users/TGooch44/events{/privacy}","received_events_url":"https://api.github.com/users/TGooch44/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-16T17:59:08Z","updated_at":"2021-06-16T17:59:32Z","author_association":"CONTRIBUTOR","body":"@jun-he @rymurr I opened this PR to add some ignores on pytz and dateutil that are currently throwing linter errors on tox.  Let me know if this looks ok, or if you'd prefer to handle it another way.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/862590766/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/862617909","html_url":"https://github.com/apache/iceberg/pull/2595#issuecomment-862617909","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2595","id":862617909,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MjYxNzkwOQ==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-16T18:36:02Z","updated_at":"2021-06-16T18:42:14Z","author_association":"CONTRIBUTOR","body":"> Hi @kbendick , sorry for the delayed review. Both spark2 and spark3 jmh commands works well in my laptop with your PR. For Spark3, I can do with both jdk8 and jdk11. Looks good to me overall. One question, is it possible to let gradle create dirs(`spark2/benchmark` and `spark3/benchmark`) instead of using `.gitkeep` files?\r\n\r\nI'm admittedly not great with Gradle. I tried to figure out how to get this to work, but couldn't (though I didn't spend too much time on it and probably could get closer if I spent more time on it later). I could look into it further, but the current state in master is that if a user runs the commands as executed, they get a folder not found error. So I figured this was still an upgrade.\r\n\r\nBy default, if no output path is specified, the results get placed in a `results.txt` file under the projects `/build/`.\r\n\r\nSo given that this is a user specified input that does deviate from the default, it might make more sense to simply leave as is (where the user gets an error and then creates the folder) as opposed to complicating the build files and the separation of tasks into `tasks.gradle` and the single required `jmh.gradle` file (the JMH Gradle plugin framework isn't super flexible).\r\n\r\nThough I am partial to the gitignore as that ensures nobody uploads results from their laptop or some env that might be very resource constrained and not representative.\r\n\r\nLet me take another pass at it for a bit, but then maybe we can just revert those changes and leave it with the current behavior for the moment? That is, just failing if the user overrides the output file - which does provide a very clear `folder not found` message.\r\n\r\nIf we really want to have Gradle create the folders (which I agree is a good idea in theory), would it be possible to simply remove the `.gitkeep` files and the pre-made folders and then try for that in a follow up PR? Given the age of this PR and its size, I'm somewhat anxious to get it in and then start out any more build file changes in another PR. When I took a shot at it, it was clear it was going to complicate the build file somewhat, so I'd like to separate that discussion from this one which has gone on for a while. @flyrain ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/862617909/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/862651104","html_url":"https://github.com/apache/iceberg/pull/2695#issuecomment-862651104","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2695","id":862651104,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MjY1MTEwNA==","user":{"login":"jerqi","id":8159038,"node_id":"MDQ6VXNlcjgxNTkwMzg=","avatar_url":"https://avatars.githubusercontent.com/u/8159038?v=4","gravatar_id":"","url":"https://api.github.com/users/jerqi","html_url":"https://github.com/jerqi","followers_url":"https://api.github.com/users/jerqi/followers","following_url":"https://api.github.com/users/jerqi/following{/other_user}","gists_url":"https://api.github.com/users/jerqi/gists{/gist_id}","starred_url":"https://api.github.com/users/jerqi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jerqi/subscriptions","organizations_url":"https://api.github.com/users/jerqi/orgs","repos_url":"https://api.github.com/users/jerqi/repos","events_url":"https://api.github.com/users/jerqi/events{/privacy}","received_events_url":"https://api.github.com/users/jerqi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-16T19:23:34Z","updated_at":"2021-06-16T19:23:34Z","author_association":"CONTRIBUTOR","body":"All tests passed. The pr is ok. cc @rdblue  \r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/862651104/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/862651390","html_url":"https://github.com/apache/iceberg/pull/2441#issuecomment-862651390","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2441","id":862651390,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MjY1MTM5MA==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-16T19:24:00Z","updated_at":"2021-06-16T19:24:00Z","author_association":"CONTRIBUTOR","body":"> @kbendick Sorry for the late reply, I've been busy with work. I'm new to Iceberg and should learn more. And thanks for telling me the right persons to review these!\r\n\r\nNo worries. Like I mentioned, this was more of a concern due to some other things I knew were going on. But it's not a concern now.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/862651390/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/862652022","html_url":"https://github.com/apache/iceberg/pull/2695#issuecomment-862652022","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2695","id":862652022,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MjY1MjAyMg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-16T19:24:59Z","updated_at":"2021-06-16T19:24:59Z","author_association":"CONTRIBUTOR","body":"Thanks for following up, @jerqi! I merged this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/862652022/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/862652487","html_url":"https://github.com/apache/iceberg/pull/2699#issuecomment-862652487","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2699","id":862652487,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MjY1MjQ4Nw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-16T19:25:42Z","updated_at":"2021-06-16T19:25:42Z","author_association":"CONTRIBUTOR","body":"Thanks, @kbendick! I'll merge this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/862652487/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/862655055","html_url":"https://github.com/apache/iceberg/pull/2595#issuecomment-862655055","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2595","id":862655055,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MjY1NTA1NQ==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-16T19:29:59Z","updated_at":"2021-06-16T19:29:59Z","author_association":"CONTRIBUTOR","body":"I spoke to @flyrain offline and he agrees that due to the age of this PR and the complexity it's going to add to the build file (and the subsequent discussion), we should attempt to change the build file to create the output directories in a subsequent PR (as this discussion has already gotten really huge and the build file changes will almost certainly invite more discussion). This is arguably not worse than the current state, though I'm happy to remove the `.gitkeep` folders and keep it in the current state (where specifying the output path causes a failure until the user creates the directory the first time).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/862655055/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/862674111","html_url":"https://github.com/apache/iceberg/pull/2654#issuecomment-862674111","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2654","id":862674111,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MjY3NDExMQ==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-16T20:01:37Z","updated_at":"2021-06-16T20:01:37Z","author_association":"CONTRIBUTOR","body":"Okay, I will add the patch to disallow optional, float and double columns in the afternoon.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/862674111/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/862674658","html_url":"https://github.com/apache/iceberg/pull/2654#issuecomment-862674658","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2654","id":862674658,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MjY3NDY1OA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-16T20:02:31Z","updated_at":"2021-06-16T20:02:31Z","author_association":"CONTRIBUTOR","body":"Thanks, @jackye1995! Sorry that was my mistake in the first place.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/862674658/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/862676662","html_url":"https://github.com/apache/iceberg/pull/2651#issuecomment-862676662","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2651","id":862676662,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MjY3NjY2Mg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-16T20:05:48Z","updated_at":"2021-06-16T20:05:48Z","author_association":"CONTRIBUTOR","body":"I followed up with @jackye1995 on Slack and it sounds like the intent is to adapt pages to `StructLike` to use the Iceberg-native filters while not reading the data twice. So I think the approach here is solid, but we can clean up a few things in the implementation.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/862676662/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/862720525","html_url":"https://github.com/apache/iceberg/pull/2441#issuecomment-862720525","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2441","id":862720525,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MjcyMDUyNQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-16T20:55:53Z","updated_at":"2021-06-16T20:55:53Z","author_association":"CONTRIBUTOR","body":"Thanks, @Fokko! I merged this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/862720525/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/862752802","html_url":"https://github.com/apache/iceberg/issues/2696#issuecomment-862752802","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2696","id":862752802,"node_id":"MDEyOklzc3VlQ29tbWVudDg2Mjc1MjgwMg==","user":{"login":"WesternStar","id":728451,"node_id":"MDQ6VXNlcjcyODQ1MQ==","avatar_url":"https://avatars.githubusercontent.com/u/728451?v=4","gravatar_id":"","url":"https://api.github.com/users/WesternStar","html_url":"https://github.com/WesternStar","followers_url":"https://api.github.com/users/WesternStar/followers","following_url":"https://api.github.com/users/WesternStar/following{/other_user}","gists_url":"https://api.github.com/users/WesternStar/gists{/gist_id}","starred_url":"https://api.github.com/users/WesternStar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WesternStar/subscriptions","organizations_url":"https://api.github.com/users/WesternStar/orgs","repos_url":"https://api.github.com/users/WesternStar/repos","events_url":"https://api.github.com/users/WesternStar/events{/privacy}","received_events_url":"https://api.github.com/users/WesternStar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-16T21:53:45Z","updated_at":"2021-06-16T21:53:45Z","author_association":"NONE","body":"So I was able to get this down to removing the aws glue metastore global catalog from EMR and seeing if everything else worked. That in fact did work. It appears that due to the naming conflict between these two. I'm not sure what the fix here will be.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/862752802/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/862998229","html_url":"https://github.com/apache/iceberg/pull/2698#issuecomment-862998229","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2698","id":862998229,"node_id":"MDEyOklzc3VlQ29tbWVudDg2Mjk5ODIyOQ==","user":{"login":"rymurr","id":2022305,"node_id":"MDQ6VXNlcjIwMjIzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/2022305?v=4","gravatar_id":"","url":"https://api.github.com/users/rymurr","html_url":"https://github.com/rymurr","followers_url":"https://api.github.com/users/rymurr/followers","following_url":"https://api.github.com/users/rymurr/following{/other_user}","gists_url":"https://api.github.com/users/rymurr/gists{/gist_id}","starred_url":"https://api.github.com/users/rymurr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rymurr/subscriptions","organizations_url":"https://api.github.com/users/rymurr/orgs","repos_url":"https://api.github.com/users/rymurr/repos","events_url":"https://api.github.com/users/rymurr/events{/privacy}","received_events_url":"https://api.github.com/users/rymurr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-17T07:23:23Z","updated_at":"2021-06-17T07:23:59Z","author_association":"CONTRIBUTOR","body":"Hey @TGooch44 any reason to not add `types-python-dateutil` and `types-pytz` to the test env dependencies? \r\n\r\nI believe mypy recently changed its default behaviour. Previously it silently auto-downloaded these packages.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/862998229/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/863173853","html_url":"https://github.com/apache/iceberg/pull/2698#issuecomment-863173853","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2698","id":863173853,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MzE3Mzg1Mw==","user":{"login":"TGooch44","id":1591711,"node_id":"MDQ6VXNlcjE1OTE3MTE=","avatar_url":"https://avatars.githubusercontent.com/u/1591711?v=4","gravatar_id":"","url":"https://api.github.com/users/TGooch44","html_url":"https://github.com/TGooch44","followers_url":"https://api.github.com/users/TGooch44/followers","following_url":"https://api.github.com/users/TGooch44/following{/other_user}","gists_url":"https://api.github.com/users/TGooch44/gists{/gist_id}","starred_url":"https://api.github.com/users/TGooch44/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TGooch44/subscriptions","organizations_url":"https://api.github.com/users/TGooch44/orgs","repos_url":"https://api.github.com/users/TGooch44/repos","events_url":"https://api.github.com/users/TGooch44/events{/privacy}","received_events_url":"https://api.github.com/users/TGooch44/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-17T11:51:59Z","updated_at":"2021-06-17T11:51:59Z","author_association":"CONTRIBUTOR","body":"Sure, my thinking was that since these both have pretty limited usage, I didn't want to add in more deps, but I guess not really a big deal to add in type stubs.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/863173853/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/863393554","html_url":"https://github.com/apache/iceberg/pull/2698#issuecomment-863393554","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2698","id":863393554,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MzM5MzU1NA==","user":{"login":"TGooch44","id":1591711,"node_id":"MDQ6VXNlcjE1OTE3MTE=","avatar_url":"https://avatars.githubusercontent.com/u/1591711?v=4","gravatar_id":"","url":"https://api.github.com/users/TGooch44","html_url":"https://github.com/TGooch44","followers_url":"https://api.github.com/users/TGooch44/followers","following_url":"https://api.github.com/users/TGooch44/following{/other_user}","gists_url":"https://api.github.com/users/TGooch44/gists{/gist_id}","starred_url":"https://api.github.com/users/TGooch44/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TGooch44/subscriptions","organizations_url":"https://api.github.com/users/TGooch44/orgs","repos_url":"https://api.github.com/users/TGooch44/repos","events_url":"https://api.github.com/users/TGooch44/events{/privacy}","received_events_url":"https://api.github.com/users/TGooch44/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-17T16:39:58Z","updated_at":"2021-06-17T16:39:58Z","author_association":"CONTRIBUTOR","body":"> I personally prefer deps over `# noqa` but im not so bothered.\r\n\r\nGiven that these deps are only for mypy, I think you're right that it is better just to add them in over using ignores.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/863393554/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/863402757","html_url":"https://github.com/apache/iceberg/pull/2706#issuecomment-863402757","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2706","id":863402757,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MzQwMjc1Nw==","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-17T16:53:57Z","updated_at":"2021-06-17T16:53:57Z","author_association":"CONTRIBUTOR","body":"@rdblue could you review/commit this please?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/863402757/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/863456134","html_url":"https://github.com/apache/iceberg/pull/2705#issuecomment-863456134","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2705","id":863456134,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MzQ1NjEzNA==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-17T18:13:36Z","updated_at":"2021-06-17T18:13:36Z","author_association":"CONTRIBUTOR","body":"restart flaky CI task","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/863456134/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/863469298","html_url":"https://github.com/apache/iceberg/pull/2703#issuecomment-863469298","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2703","id":863469298,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MzQ2OTI5OA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-17T18:32:06Z","updated_at":"2021-06-17T18:32:06Z","author_association":"CONTRIBUTOR","body":"Thanks for the fix, @nastra!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/863469298/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/863470724","html_url":"https://github.com/apache/iceberg/pull/2707#issuecomment-863470724","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2707","id":863470724,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MzQ3MDcyNA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-17T18:34:25Z","updated_at":"2021-06-17T18:34:25Z","author_association":"CONTRIBUTOR","body":"Thanks, @rominparekh!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/863470724/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/863557341","html_url":"https://github.com/apache/iceberg/pull/2688#issuecomment-863557341","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2688","id":863557341,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MzU1NzM0MQ==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-17T20:55:29Z","updated_at":"2021-06-17T20:55:29Z","author_association":"CONTRIBUTOR","body":"@danielcweeks any additional comments?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/863557341/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/863595846","html_url":"https://github.com/apache/iceberg/pull/1870#issuecomment-863595846","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1870","id":863595846,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MzU5NTg0Ng==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-17T22:11:19Z","updated_at":"2021-06-17T22:11:19Z","author_association":"CONTRIBUTOR","body":"Thanks for pinging me, @jackye1995. I'll have another look now that my last review comments were addressed. Thanks @ismailsimsek!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/863595846/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/863604469","html_url":"https://github.com/apache/iceberg/issues/2686#issuecomment-863604469","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2686","id":863604469,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MzYwNDQ2OQ==","user":{"login":"jhsenjaliya","id":5017402,"node_id":"MDQ6VXNlcjUwMTc0MDI=","avatar_url":"https://avatars.githubusercontent.com/u/5017402?v=4","gravatar_id":"","url":"https://api.github.com/users/jhsenjaliya","html_url":"https://github.com/jhsenjaliya","followers_url":"https://api.github.com/users/jhsenjaliya/followers","following_url":"https://api.github.com/users/jhsenjaliya/following{/other_user}","gists_url":"https://api.github.com/users/jhsenjaliya/gists{/gist_id}","starred_url":"https://api.github.com/users/jhsenjaliya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhsenjaliya/subscriptions","organizations_url":"https://api.github.com/users/jhsenjaliya/orgs","repos_url":"https://api.github.com/users/jhsenjaliya/repos","events_url":"https://api.github.com/users/jhsenjaliya/events{/privacy}","received_events_url":"https://api.github.com/users/jhsenjaliya/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-17T22:32:05Z","updated_at":"2021-06-17T22:32:05Z","author_association":"NONE","body":"@aimenglin , once you add engine.hive.enabled to table properties ( as @marton-bod suggested) it works for me, i was having same issue before. ( I also had to disable vectorized execution as suggested by the iceberg docs, or u can follow the warning. ) - good luck.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/863604469/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/863628683","html_url":"https://github.com/apache/iceberg/pull/2538#issuecomment-863628683","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2538","id":863628683,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MzYyODY4Mw==","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-17T23:41:00Z","updated_at":"2021-06-17T23:41:00Z","author_association":"COLLABORATOR","body":"@rdblue , The last comment was addressed, could we merge this?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/863628683/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/863642487","html_url":"https://github.com/apache/iceberg/issues/2335#issuecomment-863642487","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2335","id":863642487,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MzY0MjQ4Nw==","user":{"login":"jhsenjaliya","id":5017402,"node_id":"MDQ6VXNlcjUwMTc0MDI=","avatar_url":"https://avatars.githubusercontent.com/u/5017402?v=4","gravatar_id":"","url":"https://api.github.com/users/jhsenjaliya","html_url":"https://github.com/jhsenjaliya","followers_url":"https://api.github.com/users/jhsenjaliya/followers","following_url":"https://api.github.com/users/jhsenjaliya/following{/other_user}","gists_url":"https://api.github.com/users/jhsenjaliya/gists{/gist_id}","starred_url":"https://api.github.com/users/jhsenjaliya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhsenjaliya/subscriptions","organizations_url":"https://api.github.com/users/jhsenjaliya/orgs","repos_url":"https://api.github.com/users/jhsenjaliya/repos","events_url":"https://api.github.com/users/jhsenjaliya/events{/privacy}","received_events_url":"https://api.github.com/users/jhsenjaliya/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-18T00:21:42Z","updated_at":"2021-06-18T00:21:42Z","author_association":"NONE","body":"Hi @flyrain, build from master still throws the same error, do we have any patch that fixes this ? Thanks","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/863642487/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/863746410","html_url":"https://github.com/apache/iceberg/issues/2710#issuecomment-863746410","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2710","id":863746410,"node_id":"MDEyOklzc3VlQ29tbWVudDg2Mzc0NjQxMA==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-18T04:28:02Z","updated_at":"2021-06-18T04:28:02Z","author_association":"MEMBER","body":"The current table metadata json file for this testing table is: \r\n\r\n```json\r\n{\r\n  \"format-version\" : 1,\r\n  \"table-uuid\" : \"e38f4202-f28f-4ae9-b2d1-21af112db2cc\",\r\n  \"location\" : \"oss://emr-iceberg/warehouse/emr_dlf_db.db/store_sales\",\r\n  \"last-updated-ms\" : 1623988963494,\r\n  \"last-column-id\" : 23,\r\n  \"schema\" : {\r\n    \"type\" : \"struct\",\r\n    \"schema-id\" : 0,\r\n    \"fields\" : [ {\r\n      \"id\" : 1,\r\n      \"name\" : \"ss_sold_time_sk\",\r\n      \"required\" : false,\r\n      \"type\" : \"long\"\r\n    }, {\r\n      \"id\" : 2,\r\n      \"name\" : \"ss_item_sk\",\r\n      \"required\" : false,\r\n      \"type\" : \"long\"\r\n    }, {\r\n      \"id\" : 3,\r\n      \"name\" : \"ss_customer_sk\",\r\n      \"required\" : false,\r\n      \"type\" : \"long\"\r\n    }, {\r\n      \"id\" : 4,\r\n      \"name\" : \"ss_cdemo_sk\",\r\n      \"required\" : false,\r\n      \"type\" : \"long\"\r\n    }, {\r\n      \"id\" : 5,\r\n      \"name\" : \"ss_hdemo_sk\",\r\n      \"required\" : false,\r\n      \"type\" : \"long\"\r\n    }, {\r\n      \"id\" : 6,\r\n      \"name\" : \"ss_addr_sk\",\r\n      \"required\" : false,\r\n      \"type\" : \"long\"\r\n    }, {\r\n      \"id\" : 7,\r\n      \"name\" : \"ss_store_sk\",\r\n      \"required\" : false,\r\n      \"type\" : \"long\"\r\n    }, {\r\n      \"id\" : 8,\r\n      \"name\" : \"ss_promo_sk\",\r\n      \"required\" : false,\r\n      \"type\" : \"long\"\r\n    }, {\r\n      \"id\" : 9,\r\n      \"name\" : \"ss_ticket_number\",\r\n      \"required\" : false,\r\n      \"type\" : \"long\"\r\n    }, {\r\n      \"id\" : 10,\r\n      \"name\" : \"ss_quantity\",\r\n      \"required\" : false,\r\n      \"type\" : \"int\"\r\n    }, {\r\n      \"id\" : 11,\r\n      \"name\" : \"ss_wholesale_cost\",\r\n      \"required\" : false,\r\n      \"type\" : \"decimal(7, 2)\"\r\n    }, {\r\n      \"id\" : 12,\r\n      \"name\" : \"ss_list_price\",\r\n      \"required\" : false,\r\n      \"type\" : \"decimal(7, 2)\"\r\n    }, {\r\n      \"id\" : 13,\r\n      \"name\" : \"ss_sales_price\",\r\n      \"required\" : false,\r\n      \"type\" : \"decimal(7, 2)\"\r\n    }, {\r\n      \"id\" : 14,\r\n      \"name\" : \"ss_ext_discount_amt\",\r\n      \"required\" : false,\r\n      \"type\" : \"decimal(7, 2)\"\r\n    }, {\r\n      \"id\" : 15,\r\n      \"name\" : \"ss_ext_sales_price\",\r\n      \"required\" : false,\r\n      \"type\" : \"decimal(7, 2)\"\r\n    }, {\r\n      \"id\" : 16,\r\n      \"name\" : \"ss_ext_wholesale_cost\",\r\n      \"required\" : false,\r\n      \"type\" : \"decimal(7, 2)\"\r\n    }, {\r\n      \"id\" : 17,\r\n      \"name\" : \"ss_ext_list_price\",\r\n      \"required\" : false,\r\n      \"type\" : \"decimal(7, 2)\"\r\n    }, {\r\n      \"id\" : 18,\r\n      \"name\" : \"ss_ext_tax\",\r\n      \"required\" : false,\r\n      \"type\" : \"decimal(7, 2)\"\r\n    }, {\r\n      \"id\" : 19,\r\n      \"name\" : \"ss_coupon_amt\",\r\n      \"required\" : false,\r\n      \"type\" : \"decimal(7, 2)\"\r\n    }, {\r\n      \"id\" : 20,\r\n      \"name\" : \"ss_net_paid\",\r\n      \"required\" : false,\r\n      \"type\" : \"decimal(7, 2)\"\r\n    }, {\r\n      \"id\" : 21,\r\n      \"name\" : \"ss_net_paid_inc_tax\",\r\n      \"required\" : false,\r\n      \"type\" : \"decimal(7, 2)\"\r\n    }, {\r\n      \"id\" : 22,\r\n      \"name\" : \"ss_net_profit\",\r\n      \"required\" : false,\r\n      \"type\" : \"decimal(7, 2)\"\r\n    }, {\r\n      \"id\" : 23,\r\n      \"name\" : \"ss_sold_date_sk\",\r\n      \"required\" : false,\r\n      \"type\" : \"long\"\r\n    } ]\r\n  },\r\n  \"current-schema-id\" : 0,\r\n  \"schemas\" : [ {\r\n    \"type\" : \"struct\",\r\n    \"schema-id\" : 0,\r\n    \"fields\" : [ {\r\n      \"id\" : 1,\r\n      \"name\" : \"ss_sold_time_sk\",\r\n      \"required\" : false,\r\n      \"type\" : \"long\"\r\n    }, {\r\n      \"id\" : 2,\r\n      \"name\" : \"ss_item_sk\",\r\n      \"required\" : false,\r\n      \"type\" : \"long\"\r\n    }, {\r\n      \"id\" : 3,\r\n      \"name\" : \"ss_customer_sk\",\r\n      \"required\" : false,\r\n      \"type\" : \"long\"\r\n    }, {\r\n      \"id\" : 4,\r\n      \"name\" : \"ss_cdemo_sk\",\r\n      \"required\" : false,\r\n      \"type\" : \"long\"\r\n    }, {\r\n      \"id\" : 5,\r\n      \"name\" : \"ss_hdemo_sk\",\r\n      \"required\" : false,\r\n      \"type\" : \"long\"\r\n    }, {\r\n      \"id\" : 6,\r\n      \"name\" : \"ss_addr_sk\",\r\n      \"required\" : false,\r\n      \"type\" : \"long\"\r\n    }, {\r\n      \"id\" : 7,\r\n      \"name\" : \"ss_store_sk\",\r\n      \"required\" : false,\r\n      \"type\" : \"long\"\r\n    }, {\r\n      \"id\" : 8,\r\n      \"name\" : \"ss_promo_sk\",\r\n      \"required\" : false,\r\n      \"type\" : \"long\"\r\n    }, {\r\n      \"id\" : 9,\r\n      \"name\" : \"ss_ticket_number\",\r\n      \"required\" : false,\r\n      \"type\" : \"long\"\r\n    }, {\r\n      \"id\" : 10,\r\n      \"name\" : \"ss_quantity\",\r\n      \"required\" : false,\r\n      \"type\" : \"int\"\r\n    }, {\r\n      \"id\" : 11,\r\n      \"name\" : \"ss_wholesale_cost\",\r\n      \"required\" : false,\r\n      \"type\" : \"decimal(7, 2)\"\r\n    }, {\r\n      \"id\" : 12,\r\n      \"name\" : \"ss_list_price\",\r\n      \"required\" : false,\r\n      \"type\" : \"decimal(7, 2)\"\r\n    }, {\r\n      \"id\" : 13,\r\n      \"name\" : \"ss_sales_price\",\r\n      \"required\" : false,\r\n      \"type\" : \"decimal(7, 2)\"\r\n    }, {\r\n      \"id\" : 14,\r\n      \"name\" : \"ss_ext_discount_amt\",\r\n      \"required\" : false,\r\n      \"type\" : \"decimal(7, 2)\"\r\n    }, {\r\n      \"id\" : 15,\r\n      \"name\" : \"ss_ext_sales_price\",\r\n      \"required\" : false,\r\n      \"type\" : \"decimal(7, 2)\"\r\n    }, {\r\n      \"id\" : 16,\r\n      \"name\" : \"ss_ext_wholesale_cost\",\r\n      \"required\" : false,\r\n      \"type\" : \"decimal(7, 2)\"\r\n    }, {\r\n      \"id\" : 17,\r\n      \"name\" : \"ss_ext_list_price\",\r\n      \"required\" : false,\r\n      \"type\" : \"decimal(7, 2)\"\r\n    }, {\r\n      \"id\" : 18,\r\n      \"name\" : \"ss_ext_tax\",\r\n      \"required\" : false,\r\n      \"type\" : \"decimal(7, 2)\"\r\n    }, {\r\n      \"id\" : 19,\r\n      \"name\" : \"ss_coupon_amt\",\r\n      \"required\" : false,\r\n      \"type\" : \"decimal(7, 2)\"\r\n    }, {\r\n      \"id\" : 20,\r\n      \"name\" : \"ss_net_paid\",\r\n      \"required\" : false,\r\n      \"type\" : \"decimal(7, 2)\"\r\n    }, {\r\n      \"id\" : 21,\r\n      \"name\" : \"ss_net_paid_inc_tax\",\r\n      \"required\" : false,\r\n      \"type\" : \"decimal(7, 2)\"\r\n    }, {\r\n      \"id\" : 22,\r\n      \"name\" : \"ss_net_profit\",\r\n      \"required\" : false,\r\n      \"type\" : \"decimal(7, 2)\"\r\n    }, {\r\n      \"id\" : 23,\r\n      \"name\" : \"ss_sold_date_sk\",\r\n      \"required\" : false,\r\n      \"type\" : \"long\"\r\n    } ]\r\n  } ],\r\n  \"partition-spec\" : [ {\r\n    \"name\" : \"ss_sold_date_sk_bucket\",\r\n    \"transform\" : \"void\",\r\n    \"source-id\" : 23,\r\n    \"field-id\" : 1000\r\n  } ],\r\n  \"default-spec-id\" : 1,\r\n  \"partition-specs\" : [ {\r\n    \"spec-id\" : 0,\r\n    \"fields\" : [ {\r\n      \"name\" : \"ss_sold_date_sk_bucket\",\r\n      \"transform\" : \"bucket[200]\",\r\n      \"source-id\" : 23,\r\n      \"field-id\" : 1000\r\n    } ]\r\n  }, {\r\n    \"spec-id\" : 1,\r\n    \"fields\" : [ {\r\n      \"name\" : \"ss_sold_date_sk_bucket\",\r\n      \"transform\" : \"void\",\r\n      \"source-id\" : 23,\r\n      \"field-id\" : 1000\r\n    } ]\r\n  } ],\r\n  \"last-partition-id\" : 1000,\r\n  \"default-sort-order-id\" : 0,\r\n  \"sort-orders\" : [ {\r\n    \"order-id\" : 0,\r\n    \"fields\" : [ ]\r\n  } ],\r\n  \"properties\" : {\r\n    \"owner\" : \"root\"\r\n  },\r\n  \"current-snapshot-id\" : 6150124945094061685,\r\n  \"snapshots\" : [ {\r\n    \"snapshot-id\" : 1616121965204544780,\r\n    \"timestamp-ms\" : 1623912758210,\r\n    \"summary\" : {\r\n      \"operation\" : \"append\",\r\n      \"spark.app.id\" : \"application_1623232753519_0011\",\r\n      \"added-data-files\" : \"1\",\r\n      \"added-records\" : \"10\",\r\n      \"added-files-size\" : \"7764\",\r\n      \"changed-partition-count\" : \"1\",\r\n      \"total-records\" : \"10\",\r\n      \"total-files-size\" : \"7764\",\r\n      \"total-data-files\" : \"1\",\r\n      \"total-delete-files\" : \"0\",\r\n      \"total-position-deletes\" : \"0\",\r\n      \"total-equality-deletes\" : \"0\"\r\n    },\r\n    \"manifest-list\" : \"oss://emr-iceberg/warehouse/emr_dlf_db.db/store_sales/metadata/snap-1616121965204544780-1-0892fb81-c77d-4653-9ad0-e48b4245a2fe.avro\"\r\n  }, {\r\n    \"snapshot-id\" : 6150124945094061685,\r\n    \"parent-snapshot-id\" : 1616121965204544780,\r\n    \"timestamp-ms\" : 1623973911363,\r\n    \"summary\" : {\r\n      \"operation\" : \"append\",\r\n      \"spark.app.id\" : \"application_1623232753519_0011\",\r\n      \"added-data-files\" : \"16261\",\r\n      \"added-records\" : \"28800426268\",\r\n      \"added-files-size\" : \"1123112440679\",\r\n      \"changed-partition-count\" : \"201\",\r\n      \"total-records\" : \"28800426278\",\r\n      \"total-files-size\" : \"1123112448443\",\r\n      \"total-data-files\" : \"16262\",\r\n      \"total-delete-files\" : \"0\",\r\n      \"total-position-deletes\" : \"0\",\r\n      \"total-equality-deletes\" : \"0\"\r\n    },\r\n    \"manifest-list\" : \"oss://emr-iceberg/warehouse/emr_dlf_db.db/store_sales/metadata/snap-6150124945094061685-1-86dbe856-c57b-4f5b-aea3-84fd34471329.avro\"\r\n  } ],\r\n  \"snapshot-log\" : [ {\r\n    \"timestamp-ms\" : 1623912758210,\r\n    \"snapshot-id\" : 1616121965204544780\r\n  }, {\r\n    \"timestamp-ms\" : 1623973911363,\r\n    \"snapshot-id\" : 6150124945094061685\r\n  } ],\r\n  \"metadata-log\" : [ {\r\n    \"timestamp-ms\" : 1623233762317,\r\n    \"metadata-file\" : \"oss://emr-iceberg/warehouse/emr_dlf_db.db/store_sales/metadata/00000-585dbe4e-c573-490b-841b-e909e898923a.metadata.json\"\r\n  }, {\r\n    \"timestamp-ms\" : 1623912758210,\r\n    \"metadata-file\" : \"oss://emr-iceberg/warehouse/emr_dlf_db.db/store_sales/metadata/00001-2d30ab82-9026-425c-bdd3-31a29048a723.metadata.json\"\r\n  }, {\r\n    \"timestamp-ms\" : 1623973911363,\r\n    \"metadata-file\" : \"oss://emr-iceberg/warehouse/emr_dlf_db.db/store_sales/metadata/00002-aa0facf2-75a5-422e-971e-c53ac88d7f3d.metadata.json\"\r\n  } ]\r\n}\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/863746410/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/863750016","html_url":"https://github.com/apache/iceberg/issues/2710#issuecomment-863750016","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2710","id":863750016,"node_id":"MDEyOklzc3VlQ29tbWVudDg2Mzc1MDAxNg==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-18T04:39:59Z","updated_at":"2021-06-18T04:39:59Z","author_association":"MEMBER","body":"Okay,  we apache master branch had a fixed for  this https://github.com/apache/iceberg/pull/2454.  Close this issue now.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/863750016/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/863776026","html_url":"https://github.com/apache/iceberg/issues/2335#issuecomment-863776026","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2335","id":863776026,"node_id":"MDEyOklzc3VlQ29tbWVudDg2Mzc3NjAyNg==","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-18T05:53:14Z","updated_at":"2021-06-18T05:53:14Z","author_association":"CONTRIBUTOR","body":"Hi @jhsenjaliya, please check https://github.com/apache/iceberg/pull/2460 and https://github.com/apache/iceberg/pull/2430.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/863776026/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/864121837","html_url":"https://github.com/apache/iceberg/pull/2712#issuecomment-864121837","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2712","id":864121837,"node_id":"MDEyOklzc3VlQ29tbWVudDg2NDEyMTgzNw==","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-18T15:34:24Z","updated_at":"2021-06-18T15:34:24Z","author_association":"CONTRIBUTOR","body":"/cc @rdblue ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/864121837/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/864122367","html_url":"https://github.com/apache/iceberg/pull/2714#issuecomment-864122367","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2714","id":864122367,"node_id":"MDEyOklzc3VlQ29tbWVudDg2NDEyMjM2Nw==","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-18T15:35:23Z","updated_at":"2021-06-18T15:35:23Z","author_association":"CONTRIBUTOR","body":"/cc @rdblue ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/864122367/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/864127601","html_url":"https://github.com/apache/iceberg/pull/2713#issuecomment-864127601","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2713","id":864127601,"node_id":"MDEyOklzc3VlQ29tbWVudDg2NDEyNzYwMQ==","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-18T15:44:50Z","updated_at":"2021-06-18T15:44:50Z","author_association":"CONTRIBUTOR","body":"/cc @rdblue looks like this one failed because it couldn't pull `snappy-java.jar` and I can't restart CI. Would you mind restarting CI please?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/864127601/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/864152276","html_url":"https://github.com/apache/iceberg/pull/1870#issuecomment-864152276","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1870","id":864152276,"node_id":"MDEyOklzc3VlQ29tbWVudDg2NDE1MjI3Ng==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-18T16:28:46Z","updated_at":"2021-06-18T16:28:46Z","author_association":"CONTRIBUTOR","body":"@ismailsimsek, this is looking really close. There are a few more minor issues but otherwise I think this is ready to go. Thank you for getting this done!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/864152276/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/864154789","html_url":"https://github.com/apache/iceberg/issues/2708#issuecomment-864154789","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2708","id":864154789,"node_id":"MDEyOklzc3VlQ29tbWVudDg2NDE1NDc4OQ==","user":{"login":"TGooch44","id":1591711,"node_id":"MDQ6VXNlcjE1OTE3MTE=","avatar_url":"https://avatars.githubusercontent.com/u/1591711?v=4","gravatar_id":"","url":"https://api.github.com/users/TGooch44","html_url":"https://github.com/TGooch44","followers_url":"https://api.github.com/users/TGooch44/followers","following_url":"https://api.github.com/users/TGooch44/following{/other_user}","gists_url":"https://api.github.com/users/TGooch44/gists{/gist_id}","starred_url":"https://api.github.com/users/TGooch44/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TGooch44/subscriptions","organizations_url":"https://api.github.com/users/TGooch44/orgs","repos_url":"https://api.github.com/users/TGooch44/repos","events_url":"https://api.github.com/users/TGooch44/events{/privacy}","received_events_url":"https://api.github.com/users/TGooch44/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-18T16:33:51Z","updated_at":"2021-06-18T16:33:51Z","author_association":"CONTRIBUTOR","body":"Merged #2709 to address this","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/864154789/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/864157268","html_url":"https://github.com/apache/iceberg/pull/2691#issuecomment-864157268","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2691","id":864157268,"node_id":"MDEyOklzc3VlQ29tbWVudDg2NDE1NzI2OA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-18T16:39:03Z","updated_at":"2021-06-18T16:39:03Z","author_association":"CONTRIBUTOR","body":"Thanks for the update, @vinson0526! I kicked off the tests and will merge once they pass. The changes look great!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/864157268/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/864165444","html_url":"https://github.com/apache/iceberg/pull/2711#issuecomment-864165444","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2711","id":864165444,"node_id":"MDEyOklzc3VlQ29tbWVudDg2NDE2NTQ0NA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-18T16:56:55Z","updated_at":"2021-06-18T16:56:55Z","author_association":"CONTRIBUTOR","body":"@pvary and @marton-bod, can you take a look at this?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/864165444/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/864169555","html_url":"https://github.com/apache/iceberg/pull/2667#issuecomment-864169555","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2667","id":864169555,"node_id":"MDEyOklzc3VlQ29tbWVudDg2NDE2OTU1NQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-18T17:04:22Z","updated_at":"2021-06-18T17:04:22Z","author_association":"CONTRIBUTOR","body":"@SreeramGarlapati, FYI. Looks like there may be some issues with `MicroBatches`. I'm committing this fix but we should probably have some good testing for your Spark 3 work.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/864169555/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/864171157","html_url":"https://github.com/apache/iceberg/pull/2661#issuecomment-864171157","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2661","id":864171157,"node_id":"MDEyOklzc3VlQ29tbWVudDg2NDE3MTE1Nw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-18T17:07:37Z","updated_at":"2021-06-18T17:07:37Z","author_association":"CONTRIBUTOR","body":"Merged. Thanks, @coolderli!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/864171157/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/864320036","html_url":"https://github.com/apache/iceberg/pull/2538#issuecomment-864320036","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2538","id":864320036,"node_id":"MDEyOklzc3VlQ29tbWVudDg2NDMyMDAzNg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-18T23:38:11Z","updated_at":"2021-06-18T23:38:11Z","author_association":"CONTRIBUTOR","body":"Thanks for pinging me, @chenjunjiedada! This looks good now, I'll merge it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/864320036/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/864322056","html_url":"https://github.com/apache/iceberg/pull/2538#issuecomment-864322056","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2538","id":864322056,"node_id":"MDEyOklzc3VlQ29tbWVudDg2NDMyMjA1Ng==","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-18T23:48:34Z","updated_at":"2021-06-18T23:48:34Z","author_association":"COLLABORATOR","body":"Thanks for the reviewing and merging! @rdblue @jackye1995 @yyanyy !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/864322056/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/864454887","html_url":"https://github.com/apache/iceberg/pull/1870#issuecomment-864454887","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1870","id":864454887,"node_id":"MDEyOklzc3VlQ29tbWVudDg2NDQ1NDg4Nw==","user":{"login":"ismailsimsek","id":6005685,"node_id":"MDQ6VXNlcjYwMDU2ODU=","avatar_url":"https://avatars.githubusercontent.com/u/6005685?v=4","gravatar_id":"","url":"https://api.github.com/users/ismailsimsek","html_url":"https://github.com/ismailsimsek","followers_url":"https://api.github.com/users/ismailsimsek/followers","following_url":"https://api.github.com/users/ismailsimsek/following{/other_user}","gists_url":"https://api.github.com/users/ismailsimsek/gists{/gist_id}","starred_url":"https://api.github.com/users/ismailsimsek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ismailsimsek/subscriptions","organizations_url":"https://api.github.com/users/ismailsimsek/orgs","repos_url":"https://api.github.com/users/ismailsimsek/repos","events_url":"https://api.github.com/users/ismailsimsek/events{/privacy}","received_events_url":"https://api.github.com/users/ismailsimsek/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-19T19:43:23Z","updated_at":"2021-06-19T19:43:23Z","author_association":"CONTRIBUTOR","body":"> @ismailsimsek, this is looking really close. There are a few more minor issues but otherwise I think this is ready to go. Thank you for getting this done!\r\n\r\nThank you for reviewing it @rdblue , its ready for another look","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/864454887/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/864463656","html_url":"https://github.com/apache/iceberg/issues/2335#issuecomment-864463656","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2335","id":864463656,"node_id":"MDEyOklzc3VlQ29tbWVudDg2NDQ2MzY1Ng==","user":{"login":"jhsenjaliya","id":5017402,"node_id":"MDQ6VXNlcjUwMTc0MDI=","avatar_url":"https://avatars.githubusercontent.com/u/5017402?v=4","gravatar_id":"","url":"https://api.github.com/users/jhsenjaliya","html_url":"https://github.com/jhsenjaliya","followers_url":"https://api.github.com/users/jhsenjaliya/followers","following_url":"https://api.github.com/users/jhsenjaliya/following{/other_user}","gists_url":"https://api.github.com/users/jhsenjaliya/gists{/gist_id}","starred_url":"https://api.github.com/users/jhsenjaliya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhsenjaliya/subscriptions","organizations_url":"https://api.github.com/users/jhsenjaliya/orgs","repos_url":"https://api.github.com/users/jhsenjaliya/repos","events_url":"https://api.github.com/users/jhsenjaliya/events{/privacy}","received_events_url":"https://api.github.com/users/jhsenjaliya/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-19T21:06:15Z","updated_at":"2021-06-19T21:06:15Z","author_association":"NONE","body":"Thanks @flyrain , #2460 made it work with spark 3.1.1\r\nbtw, it would be nice to release 0.12 soon, as dataproc 2.0 cluster comes with spark 3.1.1","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/864463656/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/864491908","html_url":"https://github.com/apache/iceberg/issues/2335#issuecomment-864491908","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2335","id":864491908,"node_id":"MDEyOklzc3VlQ29tbWVudDg2NDQ5MTkwOA==","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-20T02:54:39Z","updated_at":"2021-06-20T02:54:39Z","author_association":"CONTRIBUTOR","body":"The community is working on it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/864491908/reactions","total_count":3,"+1":3,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/864602481","html_url":"https://github.com/apache/iceberg/pull/2688#issuecomment-864602481","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2688","id":864602481,"node_id":"MDEyOklzc3VlQ29tbWVudDg2NDYwMjQ4MQ==","user":{"login":"danielcweeks","id":4925077,"node_id":"MDQ6VXNlcjQ5MjUwNzc=","avatar_url":"https://avatars.githubusercontent.com/u/4925077?v=4","gravatar_id":"","url":"https://api.github.com/users/danielcweeks","html_url":"https://github.com/danielcweeks","followers_url":"https://api.github.com/users/danielcweeks/followers","following_url":"https://api.github.com/users/danielcweeks/following{/other_user}","gists_url":"https://api.github.com/users/danielcweeks/gists{/gist_id}","starred_url":"https://api.github.com/users/danielcweeks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielcweeks/subscriptions","organizations_url":"https://api.github.com/users/danielcweeks/orgs","repos_url":"https://api.github.com/users/danielcweeks/repos","events_url":"https://api.github.com/users/danielcweeks/events{/privacy}","received_events_url":"https://api.github.com/users/danielcweeks/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-20T19:42:37Z","updated_at":"2021-06-20T19:42:37Z","author_association":"CONTRIBUTOR","body":"This looks good to me.  Just the two small updates (docs and empty line) and I'm happy to commit.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/864602481/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]