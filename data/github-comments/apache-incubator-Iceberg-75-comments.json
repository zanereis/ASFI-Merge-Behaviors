[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/768636817","html_url":"https://github.com/apache/iceberg/pull/2164#issuecomment-768636817","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2164","id":768636817,"node_id":"MDEyOklzc3VlQ29tbWVudDc2ODYzNjgxNw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-27T23:05:29Z","updated_at":"2021-01-27T23:05:29Z","author_association":"CONTRIBUTOR","body":"@rdblue, it looks to me that the check is needed. Let me know what you think. I'll submit a follow-up if needed.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/768636817/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/768643708","html_url":"https://github.com/apache/iceberg/pull/2165#issuecomment-768643708","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2165","id":768643708,"node_id":"MDEyOklzc3VlQ29tbWVudDc2ODY0MzcwOA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-27T23:22:32Z","updated_at":"2021-01-27T23:24:34Z","author_association":"CONTRIBUTOR","body":"cc @dilipbiswal @rdblue @RussellSpitzer ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/768643708/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/768656197","html_url":"https://github.com/apache/iceberg/pull/2166#issuecomment-768656197","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2166","id":768656197,"node_id":"MDEyOklzc3VlQ29tbWVudDc2ODY1NjE5Nw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-27T23:54:02Z","updated_at":"2021-01-27T23:54:02Z","author_association":"CONTRIBUTOR","body":"cc @dilipbiswal @rdblue ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/768656197/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/768741155","html_url":"https://github.com/apache/iceberg/pull/2153#issuecomment-768741155","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2153","id":768741155,"node_id":"MDEyOklzc3VlQ29tbWVudDc2ODc0MTE1NQ==","user":{"login":"dilipbiswal","id":14225158,"node_id":"MDQ6VXNlcjE0MjI1MTU4","avatar_url":"https://avatars.githubusercontent.com/u/14225158?v=4","gravatar_id":"","url":"https://api.github.com/users/dilipbiswal","html_url":"https://github.com/dilipbiswal","followers_url":"https://api.github.com/users/dilipbiswal/followers","following_url":"https://api.github.com/users/dilipbiswal/following{/other_user}","gists_url":"https://api.github.com/users/dilipbiswal/gists{/gist_id}","starred_url":"https://api.github.com/users/dilipbiswal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dilipbiswal/subscriptions","organizations_url":"https://api.github.com/users/dilipbiswal/orgs","repos_url":"https://api.github.com/users/dilipbiswal/repos","events_url":"https://api.github.com/users/dilipbiswal/events{/privacy}","received_events_url":"https://api.github.com/users/dilipbiswal/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-28T01:57:26Z","updated_at":"2021-01-28T01:57:34Z","author_association":"CONTRIBUTOR","body":"@rdblue @aokolnychyi \r\nCould we please check if this looks okay now ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/768741155/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/768744124","html_url":"https://github.com/apache/iceberg/pull/2166#issuecomment-768744124","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2166","id":768744124,"node_id":"MDEyOklzc3VlQ29tbWVudDc2ODc0NDEyNA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-28T02:06:14Z","updated_at":"2021-01-28T02:06:14Z","author_association":"CONTRIBUTOR","body":"Thanks for reviewing, @rdblue!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/768744124/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/768746220","html_url":"https://github.com/apache/iceberg/pull/2167#issuecomment-768746220","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2167","id":768746220,"node_id":"MDEyOklzc3VlQ29tbWVudDc2ODc0NjIyMA==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-28T02:12:33Z","updated_at":"2021-01-28T02:12:33Z","author_association":"MEMBER","body":"@aokolnychyi + @rdblue This is the issue I was talking about before","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/768746220/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/768747140","html_url":"https://github.com/apache/iceberg/pull/2167#issuecomment-768747140","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2167","id":768747140,"node_id":"MDEyOklzc3VlQ29tbWVudDc2ODc0NzE0MA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-28T02:14:41Z","updated_at":"2021-01-28T02:14:41Z","author_association":"CONTRIBUTOR","body":"@rdblue, could you help on this one?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/768747140/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/768767386","html_url":"https://github.com/apache/iceberg/issues/2169#issuecomment-768767386","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2169","id":768767386,"node_id":"MDEyOklzc3VlQ29tbWVudDc2ODc2NzM4Ng==","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-28T03:11:42Z","updated_at":"2021-01-28T03:11:42Z","author_association":"CONTRIBUTOR","body":"I created a [PR](https://github.com/apache/iceberg/pull/2170) with a fix.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/768767386/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/768787598","html_url":"https://github.com/apache/iceberg/issues/2168#issuecomment-768787598","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2168","id":768787598,"node_id":"MDEyOklzc3VlQ29tbWVudDc2ODc4NzU5OA==","user":{"login":"simuhunluo","id":22125687,"node_id":"MDQ6VXNlcjIyMTI1Njg3","avatar_url":"https://avatars.githubusercontent.com/u/22125687?v=4","gravatar_id":"","url":"https://api.github.com/users/simuhunluo","html_url":"https://github.com/simuhunluo","followers_url":"https://api.github.com/users/simuhunluo/followers","following_url":"https://api.github.com/users/simuhunluo/following{/other_user}","gists_url":"https://api.github.com/users/simuhunluo/gists{/gist_id}","starred_url":"https://api.github.com/users/simuhunluo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/simuhunluo/subscriptions","organizations_url":"https://api.github.com/users/simuhunluo/orgs","repos_url":"https://api.github.com/users/simuhunluo/repos","events_url":"https://api.github.com/users/simuhunluo/events{/privacy}","received_events_url":"https://api.github.com/users/simuhunluo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-28T04:15:05Z","updated_at":"2021-01-28T04:15:05Z","author_association":"NONE","body":"In this scene, where to configure aws_access_key_id ,aws_secret_access_key .  In hive-site.xml ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/768787598/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/768792770","html_url":"https://github.com/apache/iceberg/issues/2168#issuecomment-768792770","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2168","id":768792770,"node_id":"MDEyOklzc3VlQ29tbWVudDc2ODc5Mjc3MA==","user":{"login":"simuhunluo","id":22125687,"node_id":"MDQ6VXNlcjIyMTI1Njg3","avatar_url":"https://avatars.githubusercontent.com/u/22125687?v=4","gravatar_id":"","url":"https://api.github.com/users/simuhunluo","html_url":"https://github.com/simuhunluo","followers_url":"https://api.github.com/users/simuhunluo/followers","following_url":"https://api.github.com/users/simuhunluo/following{/other_user}","gists_url":"https://api.github.com/users/simuhunluo/gists{/gist_id}","starred_url":"https://api.github.com/users/simuhunluo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/simuhunluo/subscriptions","organizations_url":"https://api.github.com/users/simuhunluo/orgs","repos_url":"https://api.github.com/users/simuhunluo/repos","events_url":"https://api.github.com/users/simuhunluo/events{/privacy}","received_events_url":"https://api.github.com/users/simuhunluo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-28T04:33:24Z","updated_at":"2021-01-28T04:33:24Z","author_association":"NONE","body":"In addition, if want to use the open source [minio ](https://github.com/minio/minio/)as a poc verification, how to configure access_key, secret_access_key , endpoint, DynamoDb ?\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/768792770/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/768861794","html_url":"https://github.com/apache/iceberg/issues/2168#issuecomment-768861794","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2168","id":768861794,"node_id":"MDEyOklzc3VlQ29tbWVudDc2ODg2MTc5NA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-28T07:35:50Z","updated_at":"2021-01-28T07:35:50Z","author_association":"CONTRIBUTOR","body":"cc @jackye1995 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/768861794/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/768870857","html_url":"https://github.com/apache/iceberg/issues/2168#issuecomment-768870857","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2168","id":768870857,"node_id":"MDEyOklzc3VlQ29tbWVudDc2ODg3MDg1Nw==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-28T07:56:01Z","updated_at":"2021-01-28T07:56:01Z","author_association":"CONTRIBUTOR","body":"In general, each compute engine has its own page to explain loading custom catalog, that's why only spark example is given in AWS page. Probably good to add this note in the AWS page. I am gathering the small fixes for the 0.11 website right now, I will update them all at once, thanks for the suggestion.\r\n\r\nTo answer your question around Flink, use the guide here: https://iceberg.apache.org/flink/#custom-catalog, the minimum you need is:\r\n\r\n```\r\nCREATE CATALOG my_catalog WITH (\r\n  'type'='iceberg',\r\n  'catalog-impl'='org.apache.iceberg.aws.glue.GlueCatalog',\r\n  'warehouse'='s3://my-bucket/my/key/prefix'\r\n);\r\n```\r\n\r\nAWS credentials are accessed through the default credential chain that tries to retrieve credentials in a series of approaches: https://docs.aws.amazon.com/sdk-for-java/latest/developer-guide/credentials.html\r\n\r\nIf you need more customization such as endpoint, you can load your own AwsClientFactory through the guide https://iceberg.apache.org/aws/#aws-client-customization","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/768870857/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/768873706","html_url":"https://github.com/apache/iceberg/issues/2168#issuecomment-768873706","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2168","id":768873706,"node_id":"MDEyOklzc3VlQ29tbWVudDc2ODg3MzcwNg==","user":{"login":"bkahloon","id":42993708,"node_id":"MDQ6VXNlcjQyOTkzNzA4","avatar_url":"https://avatars.githubusercontent.com/u/42993708?v=4","gravatar_id":"","url":"https://api.github.com/users/bkahloon","html_url":"https://github.com/bkahloon","followers_url":"https://api.github.com/users/bkahloon/followers","following_url":"https://api.github.com/users/bkahloon/following{/other_user}","gists_url":"https://api.github.com/users/bkahloon/gists{/gist_id}","starred_url":"https://api.github.com/users/bkahloon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bkahloon/subscriptions","organizations_url":"https://api.github.com/users/bkahloon/orgs","repos_url":"https://api.github.com/users/bkahloon/repos","events_url":"https://api.github.com/users/bkahloon/events{/privacy}","received_events_url":"https://api.github.com/users/bkahloon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-28T08:02:13Z","updated_at":"2021-01-28T08:02:13Z","author_association":"CONTRIBUTOR","body":"I was able to use the following changes in the `sql-client-defaults.yaml` file to get an integration between Flink SQL Client, Iceberg and AWS Glue\r\n\r\n``` \r\ncatalogs: \r\n  - name: iceberg\r\n    type: iceberg\r\n    catalog-impl: org.apache.iceberg.aws.glue.GlueCatalog\r\n    lock-impl: org.apache.iceberg.aws.glue.DynamoLockManager\r\n    lock.table: icebergGlueLockTable\r\n    warehouse: s3://warehouse-bucket/\r\n```\r\n\r\nI also added the Iceberg Flink runtime jar to Flink's lib directory as well as the AWS SDK and HTTP client jars as well. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/768873706/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/768929479","html_url":"https://github.com/apache/iceberg/issues/2175#issuecomment-768929479","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2175","id":768929479,"node_id":"MDEyOklzc3VlQ29tbWVudDc2ODkyOTQ3OQ==","user":{"login":"HeartSaVioR","id":1317309,"node_id":"MDQ6VXNlcjEzMTczMDk=","avatar_url":"https://avatars.githubusercontent.com/u/1317309?v=4","gravatar_id":"","url":"https://api.github.com/users/HeartSaVioR","html_url":"https://github.com/HeartSaVioR","followers_url":"https://api.github.com/users/HeartSaVioR/followers","following_url":"https://api.github.com/users/HeartSaVioR/following{/other_user}","gists_url":"https://api.github.com/users/HeartSaVioR/gists{/gist_id}","starred_url":"https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HeartSaVioR/subscriptions","organizations_url":"https://api.github.com/users/HeartSaVioR/orgs","repos_url":"https://api.github.com/users/HeartSaVioR/repos","events_url":"https://api.github.com/users/HeartSaVioR/events{/privacy}","received_events_url":"https://api.github.com/users/HeartSaVioR/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-28T09:42:37Z","updated_at":"2021-01-28T09:43:22Z","author_association":"CONTRIBUTOR","body":"Iceberg parser extension doesn't add `MERGE INTO`. Spark does have it.\r\n\r\nAccording to Spark parser rule, I guess you missed `update` (the error message also mentions the point), so the right sentence would be `then update set t.id = t.id + s.id`.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/768929479/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/768930127","html_url":"https://github.com/apache/iceberg/issues/2175#issuecomment-768930127","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2175","id":768930127,"node_id":"MDEyOklzc3VlQ29tbWVudDc2ODkzMDEyNw==","user":{"login":"dilipbiswal","id":14225158,"node_id":"MDQ6VXNlcjE0MjI1MTU4","avatar_url":"https://avatars.githubusercontent.com/u/14225158?v=4","gravatar_id":"","url":"https://api.github.com/users/dilipbiswal","html_url":"https://github.com/dilipbiswal","followers_url":"https://api.github.com/users/dilipbiswal/followers","following_url":"https://api.github.com/users/dilipbiswal/following{/other_user}","gists_url":"https://api.github.com/users/dilipbiswal/gists{/gist_id}","starred_url":"https://api.github.com/users/dilipbiswal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dilipbiswal/subscriptions","organizations_url":"https://api.github.com/users/dilipbiswal/orgs","repos_url":"https://api.github.com/users/dilipbiswal/repos","events_url":"https://api.github.com/users/dilipbiswal/events{/privacy}","received_events_url":"https://api.github.com/users/dilipbiswal/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-28T09:43:46Z","updated_at":"2021-01-28T09:43:46Z","author_association":"CONTRIBUTOR","body":"Hello,\n\nHere is the grammar  for matched clause and matched action.\n\nmatchedClause\n    : WHEN MATCHED (AND matchedCond=booleanExpression)? THEN matchedAction\n    ;\n\nmatchedAction\n    : DELETE\n    | UPDATE SET ASTERISK\n    | UPDATE SET assignmentList\n    ;\n\nYou are missing the :\"UPDATE\" keyword ?\n\nRegards\n-- Dilip\nOn Thu, Jan 28, 2021 at 1:28 AM wjxiz <notifications@github.com> wrote:\n\n> I'm trying to test the merge into statement in Spark SQL with Iceberg\n> extension:\n>\n> $SPARK_HOME/bin/spark-shell --master $MASTER \\\n> --driver-memory ${DRIVE_MEMORY}G \\\n> --executor-memory ${EXECUTOR_MEMORY}G \\\n> --executor-cores $EXECUTOR_CORES \\\n> --num-executors $NUM_EXECUTOR \\\n> --conf spark.sql.catalogImplementation=hive \\\n> --conf spark.task.cpus=1 \\\n> --conf spark.locality.wait=0 \\\n> --conf spark.yarn.maxAppAttempts=1 \\\n> --conf spark.sql.shuffle.partitions=24 \\\n> --conf spark.sql.files.maxPartitionBytes=128m \\\n> --conf spark.sql.warehouse.dir=$OUT \\\n> --conf spark.task.resource.gpu.amount=0.08 \\\n> --conf spark.executor.resource.gpu.amount=1 \\\n> --packages org.apache.iceberg:iceberg-spark3-runtime:0.11.0 \\\n> --conf spark.sql.extensions=org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions \\\n> --conf spark.sql.catalog.spark_catalog=org.apache.iceberg.spark.SparkSessionCatalog \\\n> --conf spark.sql.catalog.spark_catalog.type=hive \\\n> --conf spark.sql.catalog.local=org.apache.iceberg.spark.SparkCatalog \\\n> --conf spark.sql.catalog.local.type=hadoop \\\n> --conf spark.sql.catalog.local.warehouse=$PWD/warehouse\n>\n>\n> Here's my test:\n>\n> scala> spark.sql(\"\"\"\n>      | merge into local.db.table1 t\n>      | using ( select * from local.db.table1_update) s\n>      | on t.data = s.data\n>      | when matched then set t.id = t.id + s.id\n>      | when not matched then insert *\n>      | \"\"\")\n> org.apache.spark.sql.catalyst.parser.ParseException:\n> mismatched input 'set' expecting {'DELETE', 'UPDATE'}(line 5, pos 18)\n>\n> == SQL ==\n>\n> merge into local.db.table1 t\n> using ( select * from local.db.table1_update) s\n> on t.data = s.data\n> when matched then set t.id = t.id + s.id\n> ------------------^^^\n> when not matched then insert *\n>\n>   at org.apache.spark.sql.catalyst.parser.ParseException.withCommand(ParseDriver.scala:266)\n>   at org.apache.spark.sql.catalyst.parser.AbstractSqlParser.parse(ParseDriver.scala:133)\n>   at org.apache.spark.sql.execution.SparkSqlParser.parse(SparkSqlParser.scala:48)\n>   at org.apache.spark.sql.catalyst.parser.AbstractSqlParser.parsePlan(ParseDriver.scala:81)\n>   at org.apache.spark.sql.catalyst.parser.extensions.IcebergSparkSqlExtensionsParser.parsePlan(IcebergSparkSqlExtensionsParser.scala:100)\n>   at org.apache.spark.sql.SparkSession.$anonfun$sql$2(SparkSession.scala:605)\n>   at org.apache.spark.sql.catalyst.QueryPlanningTracker.measurePhase(QueryPlanningTracker.scala:111)\n>   at org.apache.spark.sql.SparkSession.$anonfun$sql$1(SparkSession.scala:605)\n>   at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:764)\n>   at org.apache.spark.sql.SparkSession.sql(SparkSession.scala:602)\n>   ... 53 elided\n>\n>\n> for the environment:\n>\n> scala> spark.sparkContext.listJars\n> res0: Seq[String] = Vector(spark://10.19.183.124:38945/jars/org.apache.iceberg_iceberg-spark3-runtime-0.11.0.jar)\n>\n> not 100% sure if the extension has been loaded correctly because it seems\n> to be a parser issue that it doesn't recognize \"set\".\n>\n> â€”\n> You are receiving this because you are subscribed to this thread.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/apache/iceberg/issues/2175>, or unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/ADMQ6BQN365B7PJMLAVYJGTS4EU5RANCNFSM4WWWVB2Q>\n> .\n>\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/768930127/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/768932103","html_url":"https://github.com/apache/iceberg/issues/2168#issuecomment-768932103","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2168","id":768932103,"node_id":"MDEyOklzc3VlQ29tbWVudDc2ODkzMjEwMw==","user":{"login":"simuhunluo","id":22125687,"node_id":"MDQ6VXNlcjIyMTI1Njg3","avatar_url":"https://avatars.githubusercontent.com/u/22125687?v=4","gravatar_id":"","url":"https://api.github.com/users/simuhunluo","html_url":"https://github.com/simuhunluo","followers_url":"https://api.github.com/users/simuhunluo/followers","following_url":"https://api.github.com/users/simuhunluo/following{/other_user}","gists_url":"https://api.github.com/users/simuhunluo/gists{/gist_id}","starred_url":"https://api.github.com/users/simuhunluo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/simuhunluo/subscriptions","organizations_url":"https://api.github.com/users/simuhunluo/orgs","repos_url":"https://api.github.com/users/simuhunluo/repos","events_url":"https://api.github.com/users/simuhunluo/events{/privacy}","received_events_url":"https://api.github.com/users/simuhunluo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-28T09:47:18Z","updated_at":"2021-01-28T09:47:18Z","author_association":"NONE","body":" ðŸ‘ðŸ‘ Thanks for your answer.  \r\n\r\n> I was able to use the following changes in the `sql-client-defaults.yaml` file to get an integration between Flink SQL Client, Iceberg and AWS Glue\r\n> \r\n> ```\r\n> catalogs: \r\n>   - name: iceberg\r\n>     type: iceberg\r\n>     catalog-impl: org.apache.iceberg.aws.glue.GlueCatalog\r\n>     lock-impl: org.apache.iceberg.aws.glue.DynamoLockManager\r\n>     lock.table: icebergGlueLockTable\r\n>     warehouse: s3://warehouse-bucket/\r\n> ```\r\n> \r\n> I also added the Iceberg Flink runtime jar to Flink's lib directory as well as the AWS SDK and HTTP client jars as well.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/768932103/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/768933994","html_url":"https://github.com/apache/iceberg/issues/2175#issuecomment-768933994","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2175","id":768933994,"node_id":"MDEyOklzc3VlQ29tbWVudDc2ODkzMzk5NA==","user":{"login":"wjxiz1992","id":20476954,"node_id":"MDQ6VXNlcjIwNDc2OTU0","avatar_url":"https://avatars.githubusercontent.com/u/20476954?v=4","gravatar_id":"","url":"https://api.github.com/users/wjxiz1992","html_url":"https://github.com/wjxiz1992","followers_url":"https://api.github.com/users/wjxiz1992/followers","following_url":"https://api.github.com/users/wjxiz1992/following{/other_user}","gists_url":"https://api.github.com/users/wjxiz1992/gists{/gist_id}","starred_url":"https://api.github.com/users/wjxiz1992/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wjxiz1992/subscriptions","organizations_url":"https://api.github.com/users/wjxiz1992/orgs","repos_url":"https://api.github.com/users/wjxiz1992/repos","events_url":"https://api.github.com/users/wjxiz1992/events{/privacy}","received_events_url":"https://api.github.com/users/wjxiz1992/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-28T09:50:36Z","updated_at":"2021-01-28T09:50:36Z","author_association":"NONE","body":"Thanks a lot for the very quick response! \r\nYes, I missed the \"update\" keyword here, the query works after I added it.\r\nShould we update the [doc here](https://iceberg.apache.org/getting-started/#writing) as it's under the section of \"Spark\"?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/768933994/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/768934798","html_url":"https://github.com/apache/iceberg/issues/2168#issuecomment-768934798","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2168","id":768934798,"node_id":"MDEyOklzc3VlQ29tbWVudDc2ODkzNDc5OA==","user":{"login":"simuhunluo","id":22125687,"node_id":"MDQ6VXNlcjIyMTI1Njg3","avatar_url":"https://avatars.githubusercontent.com/u/22125687?v=4","gravatar_id":"","url":"https://api.github.com/users/simuhunluo","html_url":"https://github.com/simuhunluo","followers_url":"https://api.github.com/users/simuhunluo/followers","following_url":"https://api.github.com/users/simuhunluo/following{/other_user}","gists_url":"https://api.github.com/users/simuhunluo/gists{/gist_id}","starred_url":"https://api.github.com/users/simuhunluo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/simuhunluo/subscriptions","organizations_url":"https://api.github.com/users/simuhunluo/orgs","repos_url":"https://api.github.com/users/simuhunluo/repos","events_url":"https://api.github.com/users/simuhunluo/events{/privacy}","received_events_url":"https://api.github.com/users/simuhunluo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-28T09:52:05Z","updated_at":"2021-01-28T09:52:05Z","author_association":"NONE","body":"@bkahloon  where the metadata store, Together with data in s3?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/768934798/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/768939074","html_url":"https://github.com/apache/iceberg/issues/2175#issuecomment-768939074","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2175","id":768939074,"node_id":"MDEyOklzc3VlQ29tbWVudDc2ODkzOTA3NA==","user":{"login":"HeartSaVioR","id":1317309,"node_id":"MDQ6VXNlcjEzMTczMDk=","avatar_url":"https://avatars.githubusercontent.com/u/1317309?v=4","gravatar_id":"","url":"https://api.github.com/users/HeartSaVioR","html_url":"https://github.com/HeartSaVioR","followers_url":"https://api.github.com/users/HeartSaVioR/followers","following_url":"https://api.github.com/users/HeartSaVioR/following{/other_user}","gists_url":"https://api.github.com/users/HeartSaVioR/gists{/gist_id}","starred_url":"https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HeartSaVioR/subscriptions","organizations_url":"https://api.github.com/users/HeartSaVioR/orgs","repos_url":"https://api.github.com/users/HeartSaVioR/repos","events_url":"https://api.github.com/users/HeartSaVioR/events{/privacy}","received_events_url":"https://api.github.com/users/HeartSaVioR/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-28T09:59:15Z","updated_at":"2021-01-28T09:59:15Z","author_association":"CONTRIBUTOR","body":"Ah yes didn't realize you're trying to follow the doc. Would you mind if I ask to submit a PR for the fix? I'll take it up if you mind. Thanks in advance!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/768939074/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/768950228","html_url":"https://github.com/apache/iceberg/issues/2175#issuecomment-768950228","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2175","id":768950228,"node_id":"MDEyOklzc3VlQ29tbWVudDc2ODk1MDIyOA==","user":{"login":"wjxiz1992","id":20476954,"node_id":"MDQ6VXNlcjIwNDc2OTU0","avatar_url":"https://avatars.githubusercontent.com/u/20476954?v=4","gravatar_id":"","url":"https://api.github.com/users/wjxiz1992","html_url":"https://github.com/wjxiz1992","followers_url":"https://api.github.com/users/wjxiz1992/followers","following_url":"https://api.github.com/users/wjxiz1992/following{/other_user}","gists_url":"https://api.github.com/users/wjxiz1992/gists{/gist_id}","starred_url":"https://api.github.com/users/wjxiz1992/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wjxiz1992/subscriptions","organizations_url":"https://api.github.com/users/wjxiz1992/orgs","repos_url":"https://api.github.com/users/wjxiz1992/repos","events_url":"https://api.github.com/users/wjxiz1992/events{/privacy}","received_events_url":"https://api.github.com/users/wjxiz1992/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-28T10:18:24Z","updated_at":"2021-01-28T10:56:23Z","author_association":"NONE","body":"@HeartSaVioR Glad to submit a PR for it, but I couldn't find the corresponding file that contains related content.\r\nThe only file I can find is a MkDoc generated html: https://github.com/apache/iceberg/blob/asf-site/getting-started/index.html#L464 but I don't think I should make any change to that directly. The [getting-started.md](https://github.com/apache/iceberg/blob/064f4f565b892f6bae462ada82033e243d2f2e49/site/docs/getting-started.md#writing) in master branch doesn't contain \"merge into\".\r\ncould you point me to the right place? \r\nThanks!\r\n\r\n\r\n------update------:\r\nI saw where it is: https://github.com/apache/iceberg/pull/2160. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/768950228/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769209110","html_url":"https://github.com/apache/iceberg/issues/2168#issuecomment-769209110","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2168","id":769209110,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTIwOTExMA==","user":{"login":"bkahloon","id":42993708,"node_id":"MDQ6VXNlcjQyOTkzNzA4","avatar_url":"https://avatars.githubusercontent.com/u/42993708?v=4","gravatar_id":"","url":"https://api.github.com/users/bkahloon","html_url":"https://github.com/bkahloon","followers_url":"https://api.github.com/users/bkahloon/followers","following_url":"https://api.github.com/users/bkahloon/following{/other_user}","gists_url":"https://api.github.com/users/bkahloon/gists{/gist_id}","starred_url":"https://api.github.com/users/bkahloon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bkahloon/subscriptions","organizations_url":"https://api.github.com/users/bkahloon/orgs","repos_url":"https://api.github.com/users/bkahloon/repos","events_url":"https://api.github.com/users/bkahloon/events{/privacy}","received_events_url":"https://api.github.com/users/bkahloon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-28T16:33:27Z","updated_at":"2021-01-28T16:33:27Z","author_association":"CONTRIBUTOR","body":"Are you asking about Iceberg metadata files?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769209110/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769221942","html_url":"https://github.com/apache/iceberg/issues/2168#issuecomment-769221942","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2168","id":769221942,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTIyMTk0Mg==","user":{"login":"simuhunluo","id":22125687,"node_id":"MDQ6VXNlcjIyMTI1Njg3","avatar_url":"https://avatars.githubusercontent.com/u/22125687?v=4","gravatar_id":"","url":"https://api.github.com/users/simuhunluo","html_url":"https://github.com/simuhunluo","followers_url":"https://api.github.com/users/simuhunluo/followers","following_url":"https://api.github.com/users/simuhunluo/following{/other_user}","gists_url":"https://api.github.com/users/simuhunluo/gists{/gist_id}","starred_url":"https://api.github.com/users/simuhunluo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/simuhunluo/subscriptions","organizations_url":"https://api.github.com/users/simuhunluo/orgs","repos_url":"https://api.github.com/users/simuhunluo/repos","events_url":"https://api.github.com/users/simuhunluo/events{/privacy}","received_events_url":"https://api.github.com/users/simuhunluo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-28T16:53:04Z","updated_at":"2021-01-28T16:53:04Z","author_association":"NONE","body":"@bkahloon  Yeah.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769221942/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769230427","html_url":"https://github.com/apache/iceberg/issues/2168#issuecomment-769230427","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2168","id":769230427,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTIzMDQyNw==","user":{"login":"bkahloon","id":42993708,"node_id":"MDQ6VXNlcjQyOTkzNzA4","avatar_url":"https://avatars.githubusercontent.com/u/42993708?v=4","gravatar_id":"","url":"https://api.github.com/users/bkahloon","html_url":"https://github.com/bkahloon","followers_url":"https://api.github.com/users/bkahloon/followers","following_url":"https://api.github.com/users/bkahloon/following{/other_user}","gists_url":"https://api.github.com/users/bkahloon/gists{/gist_id}","starred_url":"https://api.github.com/users/bkahloon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bkahloon/subscriptions","organizations_url":"https://api.github.com/users/bkahloon/orgs","repos_url":"https://api.github.com/users/bkahloon/repos","events_url":"https://api.github.com/users/bkahloon/events{/privacy}","received_events_url":"https://api.github.com/users/bkahloon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-28T17:05:28Z","updated_at":"2021-01-28T17:05:45Z","author_association":"CONTRIBUTOR","body":"@simuhunluo I have not able to write to an Iceberg table yet, so I'm not sure what will happen in regards to the metadata files (I haven't looked through all the source code for the Glue Catalog as well). I had some issues with writing to the Iceberg table and have opened #2172 . If you get it working please let me know as well. Thanks","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769230427/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769240770","html_url":"https://github.com/apache/iceberg/issues/2175#issuecomment-769240770","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2175","id":769240770,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTI0MDc3MA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-28T17:17:10Z","updated_at":"2021-01-28T17:17:10Z","author_association":"CONTRIBUTOR","body":"Fixed in the docs. Thanks, everyone for finding the problem!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769240770/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769259075","html_url":"https://github.com/apache/iceberg/issues/2176#issuecomment-769259075","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2176","id":769259075,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTI1OTA3NQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-28T17:45:44Z","updated_at":"2021-01-28T17:45:44Z","author_association":"MEMBER","body":"It is possible but you have specified connecting to a Hive Metastore instance, and the connection is failing, If you don't have one I would switch your catalog settings to\r\n\r\n```\r\n   .config(\"spark.sql.catalog.spark_catalog\", \"org.apache.iceberg.spark.SparkSessionCatalog\")\r\n   .config(\"spark.sql.catalog.spark_catalog.type\", \"hadoop\")\r\n   .config(\"spark.sql.catalog.spark_catalog.warehouse\", \"/warehouse\");\r\n```\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769259075/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769261671","html_url":"https://github.com/apache/iceberg/issues/2172#issuecomment-769261671","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2172","id":769261671,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTI2MTY3MQ==","user":{"login":"bkahloon","id":42993708,"node_id":"MDQ6VXNlcjQyOTkzNzA4","avatar_url":"https://avatars.githubusercontent.com/u/42993708?v=4","gravatar_id":"","url":"https://api.github.com/users/bkahloon","html_url":"https://github.com/bkahloon","followers_url":"https://api.github.com/users/bkahloon/followers","following_url":"https://api.github.com/users/bkahloon/following{/other_user}","gists_url":"https://api.github.com/users/bkahloon/gists{/gist_id}","starred_url":"https://api.github.com/users/bkahloon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bkahloon/subscriptions","organizations_url":"https://api.github.com/users/bkahloon/orgs","repos_url":"https://api.github.com/users/bkahloon/repos","events_url":"https://api.github.com/users/bkahloon/events{/privacy}","received_events_url":"https://api.github.com/users/bkahloon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-28T17:50:11Z","updated_at":"2021-01-28T17:50:11Z","author_association":"CONTRIBUTOR","body":"@openinx could you please point me in the right direction","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769261671/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769262053","html_url":"https://github.com/apache/iceberg/pull/2125#issuecomment-769262053","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2125","id":769262053,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTI2MjA1Mw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-28T17:50:50Z","updated_at":"2021-01-28T17:50:50Z","author_association":"CONTRIBUTOR","body":"Looks good. Thanks for fixing this!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769262053/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769290824","html_url":"https://github.com/apache/iceberg/issues/2124#issuecomment-769290824","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2124","id":769290824,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTI5MDgyNA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-28T18:37:38Z","updated_at":"2021-01-28T18:37:38Z","author_association":"CONTRIBUTOR","body":"Thanks for submitting a fix for this, @steveloughran. Seems like this issue is resolved but I am wondering whether we should add this functionality to other places like `RemoveOrphanFilesAction` that do lists as well. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769290824/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769337943","html_url":"https://github.com/apache/iceberg/pull/2146#issuecomment-769337943","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2146","id":769337943,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTMzNzk0Mw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-28T19:54:28Z","updated_at":"2021-01-28T19:54:28Z","author_association":"CONTRIBUTOR","body":"Thanks, @rymurr! Looks great!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769337943/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769362017","html_url":"https://github.com/apache/iceberg/pull/2177#issuecomment-769362017","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2177","id":769362017,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTM2MjAxNw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-28T20:24:35Z","updated_at":"2021-01-28T20:24:35Z","author_association":"CONTRIBUTOR","body":"Thanks, @jackye1995!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769362017/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769413615","html_url":"https://github.com/apache/iceberg/pull/2167#issuecomment-769413615","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2167","id":769413615,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTQxMzYxNQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-28T21:33:39Z","updated_at":"2021-01-28T21:33:59Z","author_association":"CONTRIBUTOR","body":"This doesn't seem _that_ bad. Can you add a test that writes a Parquet file with that schema and validates that Spark can read it? Maybe a `TestMalformedParquet` suite?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769413615/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769414479","html_url":"https://github.com/apache/iceberg/pull/2167#issuecomment-769414479","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2167","id":769414479,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTQxNDQ3OQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-28T21:35:14Z","updated_at":"2021-01-28T21:35:14Z","author_association":"MEMBER","body":"@rdblue Just bad enough I hope, I really have no idea what's going on here at a spec level, i'm just trying to match what I see as valid from the internal apis :) \r\n\r\nI'll add in another test","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769414479/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769464933","html_url":"https://github.com/apache/iceberg/pull/2178#issuecomment-769464933","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2178","id":769464933,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTQ2NDkzMw==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-28T23:24:11Z","updated_at":"2021-01-28T23:24:11Z","author_association":"CONTRIBUTOR","body":"@rdblue All comments should now be addressed, please let me know any further comments, thank you!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769464933/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769465791","html_url":"https://github.com/apache/iceberg/pull/2179#issuecomment-769465791","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2179","id":769465791,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTQ2NTc5MQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-28T23:26:30Z","updated_at":"2021-01-28T23:26:30Z","author_association":"CONTRIBUTOR","body":"cc @dilipbiswal @rdblue ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769465791/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769482717","html_url":"https://github.com/apache/iceberg/pull/2179#issuecomment-769482717","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2179","id":769482717,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTQ4MjcxNw==","user":{"login":"dilipbiswal","id":14225158,"node_id":"MDQ6VXNlcjE0MjI1MTU4","avatar_url":"https://avatars.githubusercontent.com/u/14225158?v=4","gravatar_id":"","url":"https://api.github.com/users/dilipbiswal","html_url":"https://github.com/dilipbiswal","followers_url":"https://api.github.com/users/dilipbiswal/followers","following_url":"https://api.github.com/users/dilipbiswal/following{/other_user}","gists_url":"https://api.github.com/users/dilipbiswal/gists{/gist_id}","starred_url":"https://api.github.com/users/dilipbiswal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dilipbiswal/subscriptions","organizations_url":"https://api.github.com/users/dilipbiswal/orgs","repos_url":"https://api.github.com/users/dilipbiswal/repos","events_url":"https://api.github.com/users/dilipbiswal/events{/privacy}","received_events_url":"https://api.github.com/users/dilipbiswal/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T00:13:53Z","updated_at":"2021-01-29T00:13:53Z","author_association":"CONTRIBUTOR","body":"LGTM . thanks for adding this test @aokolnychyi ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769482717/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769503071","html_url":"https://github.com/apache/iceberg/pull/2129#issuecomment-769503071","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2129","id":769503071,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTUwMzA3MQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T01:08:56Z","updated_at":"2021-01-29T01:08:56Z","author_association":"CONTRIBUTOR","body":"This made me think a lot about what the behavior should be. Before diving further into the review, I think we should agree on that.\r\n\r\nWe have 3 cases for loading tables:\r\n* Hadoop table identified by its location\r\n* Hive catalog table tracked in the current metastore\r\n* A table in any catalog where the metastore is a reference\r\n\r\nIdeally, a Hive table that is owned by the Hive metastore would require no additional property to point it to a catalog, because the metastore is unnamed and is basically global. A table in another catalog would have a table property, `iceberg.catalog`, that has the other catalog's name. That leaves Hadoop tables and I would use a property like `iceberg.type=hadoop` to signal that the table location should be used to load it. I would not use a reserved catalog name to identify Hadoop tables to avoid colliding with user catalog names (e.g., \"hadoop\"), but we could make it reasonably unlikely if we wanted to use `iceberg.catalog=location_based_table` or something.\r\n\r\nWe also have existing behavior:\r\n* `iceberg.mr.catalog` is not defined: load all Iceberg tables as Hadoop tables using the location\r\n* `iceberg.mr.catalog=hive`: load all Iceberg tables using the table name from a HiveCatalog for the metastore URI\r\n* `iceberg.mr.catalog=hadoop`: load all Iceberg tables using the table name from a HadoopCatalog for the location stored in `iceberg.mr.catalog.hadoop.warehouse.location`\r\n* `iceberg.mr.catalog.loader.class`: when defined, load all Iceberg tables using the catalog produced by the loader class. This is primarily for direct use of the `InputFormat`, not for Hive.\r\n\r\nUnfortunately, the current behavior when `iceberg.mr.catalog` is not set and the table has no catalog set is to load the table's location. The \"ideal\" behavior I outlined above would load the table from an anonymous `HiveCatalog` created for the metastore URI. I don't really like the option of adding more table-level config if we can avoid it.\r\n\r\nHere's what I propose:\r\n* If a table has `iceberg.catalog` or `iceberg.type=hadoop`, then use the ideal behavior (no conflict with existing)\r\n* If a table does not have those properties, fall back to the value of `iceberg.mr.catalog`:\r\n    * When not defined: load the Iceberg table from the metastore by name\r\n    * `location`: load the Iceberg table as a Hadoop table by location\r\n    * `hive`: use the existing behavior for backward-compatibility\r\n    * `hadoop`: use the existing behavior for backward-compatibility\r\n\r\nI think this is a good compromise for behavior. If someone wants the default to be location-based table loading, then all they need to change is to set `iceberg.mr.catalog=location`. The other cases are unchanged, and the default is to load tables from the metastore (as expected). While it is a behavior change, I think it is a reasonable one.\r\n\r\nMiscellaneous:\r\n* I didn't mention a property to control table identifier above, like `iceberg.identifier`, but I think that would make sense. I would not support it for tables tracked in the metastore, though. It does not make sense to have a pointer to another table owned by the metastore.\r\n* Because the loader class is intended for the `InputFormat`, I think we should handle it in Hive by making sure it is not set or by using a different load method that ignores it. There should be no need to provide backward compatibility for this and we haven't documented it anywhere.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769503071/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769503822","html_url":"https://github.com/apache/iceberg/pull/2180#issuecomment-769503822","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2180","id":769503822,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTUwMzgyMg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T01:10:58Z","updated_at":"2021-01-29T01:10:58Z","author_association":"CONTRIBUTOR","body":"Tests passed the first time through. Re-running.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769503822/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769506627","html_url":"https://github.com/apache/iceberg/pull/2179#issuecomment-769506627","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2179","id":769506627,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTUwNjYyNw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T01:17:34Z","updated_at":"2021-01-29T01:17:34Z","author_association":"CONTRIBUTOR","body":"Thanks, @aokolnychyi!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769506627/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769507504","html_url":"https://github.com/apache/iceberg/pull/2178#issuecomment-769507504","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2178","id":769507504,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTUwNzUwNA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T01:19:31Z","updated_at":"2021-01-29T01:19:31Z","author_association":"CONTRIBUTOR","body":"Thanks, @jackye1995! I'll deploy this now.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769507504/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769508048","html_url":"https://github.com/apache/iceberg/pull/2170#issuecomment-769508048","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2170","id":769508048,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTUwODA0OA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T01:21:04Z","updated_at":"2021-01-29T01:21:04Z","author_association":"CONTRIBUTOR","body":"Thanks, @wypoon! I'll merge this when tests are passing.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769508048/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769513559","html_url":"https://github.com/apache/iceberg/pull/2167#issuecomment-769513559","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2167","id":769513559,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTUxMzU1OQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T01:36:08Z","updated_at":"2021-01-29T03:01:37Z","author_association":"MEMBER","body":"@rdblue I have an additional issue :/\r\n\r\nIn SparkParquetReaders we call\r\n```java\r\n      ColumnDescriptor desc = type.getColumnDescription(currentPath());\r\n```\r\n\r\nWhich fails when traversing with\r\n\r\n```\r\nArrived at primitive node, path invalid\r\norg.apache.parquet.io.InvalidRecordException: Arrived at primitive node, path invalid\r\n\tat org.apache.parquet.schema.PrimitiveType.getMaxRepetitionLevel(PrimitiveType.java:665)\r\n\tat org.apache.parquet.schema.GroupType.getMaxRepetitionLevel(GroupType.java:294)\r\n\tat org.apache.parquet.schema.GroupType.getMaxRepetitionLevel(GroupType.java:294)\r\n\tat org.apache.parquet.schema.MessageType.getMaxRepetitionLevel(MessageType.java:77)\r\n\tat org.apache.parquet.schema.MessageType.getColumnDescription(MessageType.java:94)\r\n\tat org.apache.iceberg.spark.data.SparkParquetReaders$ReadBuilder.primitive(SparkParquetReaders.java:222)\r\n```\r\n\r\nI'm not sure what the \"Desc\" is supposed to be here. There is no issue with writing the file or reading the file using the generic Parquet.read() file. But once I use the SparkParquetReader I have the issue.\r\n\r\nDo you have any ideas how this can be fixed?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769513559/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769528068","html_url":"https://github.com/apache/iceberg/pull/2165#issuecomment-769528068","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2165","id":769528068,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTUyODA2OA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T02:17:13Z","updated_at":"2021-01-29T02:17:13Z","author_association":"CONTRIBUTOR","body":"@rdblue, this one is ready for another round.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769528068/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769529102","html_url":"https://github.com/apache/iceberg/pull/2180#issuecomment-769529102","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2180","id":769529102,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTUyOTEwMg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T02:20:45Z","updated_at":"2021-01-29T02:20:45Z","author_association":"CONTRIBUTOR","body":"Thanks for taking the time to investigate, @rdblue! ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769529102/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769542927","html_url":"https://github.com/apache/iceberg/pull/2109#issuecomment-769542927","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2109","id":769542927,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTU0MjkyNw==","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T03:05:41Z","updated_at":"2021-01-29T03:06:37Z","author_association":"CONTRIBUTOR","body":"We actually implemented this in a slightly different way of calculating the watermark. Instead of using Flink watermark, we add some additional metadata (min, max, sum, count)  per DataFile for the timestamp column. In the committer, we use the min of min to decide the watermark value. We never regress the watermark value. Those metadata can also help us calculate metrics for ingestion latency (commit time - event/Kafka time): like min, max, avg.\r\n\r\nJust to share, by no means that I am suggesting changing the approach in this PR. It is perfectly good.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769542927/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769550250","html_url":"https://github.com/apache/iceberg/pull/2167#issuecomment-769550250","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2167","id":769550250,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTU1MDI1MA==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T03:28:44Z","updated_at":"2021-01-29T03:28:44Z","author_association":"MEMBER","body":"Figured out Array<Binary> I may have to write a test for a tope level repeated binary array as well :/ ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769550250/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769551567","html_url":"https://github.com/apache/iceberg/pull/2109#issuecomment-769551567","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2109","id":769551567,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTU1MTU2Nw==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T03:33:30Z","updated_at":"2021-01-29T03:37:18Z","author_association":"CONTRIBUTOR","body":"Through this PR, I have an idea whether we can add a `Callback` method to expose  to the user. After each submit succeed, the `Callback` method is called asynchronously, and the user can do some work in this callback method, such as send some information to kafka, and then consume the kafka data to perform some operations ,such as triggering downstream batch jobs,   what do you think ? @rdblue ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769551567/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769555106","html_url":"https://github.com/apache/iceberg/pull/2167#issuecomment-769555106","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2167","id":769555106,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTU1NTEwNg==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T03:46:06Z","updated_at":"2021-01-29T03:46:52Z","author_association":"MEMBER","body":"[malformed_parquet_not_txt.txt](https://github.com/apache/iceberg/files/5891488/malformed_parquet_not_txt.txt)\r\n\r\nThis is the Parquet file generated by the test, just in case anyone wants to take a look at what we are dealing with here with another framework.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769555106/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769559562","html_url":"https://github.com/apache/iceberg/issues/2172#issuecomment-769559562","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2172","id":769559562,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTU1OTU2Mg==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T04:01:51Z","updated_at":"2021-01-29T04:07:36Z","author_association":"MEMBER","body":"@bkahloon ,   in this iceberg 0.11.0 release,  we still don't support exporting cdc events to iceberg by using flink SQL, but data stream is supported.  Here is PR: https://github.com/apache/iceberg/commit/1b66bdfc084ac73fe999299d041aa2e5677f43c9. \r\n\r\nSupporting the flink SQL will be the exact goal in 0.12.0 .  For more details, you may be interested in this presentation: \r\n![image](https://user-images.githubusercontent.com/5028729/106230067-aa94ed00-6229-11eb-904d-ba4bca9209f3.png)\r\n\r\nThe slides share:  https://docs.google.com/presentation/d/1X2KrzlAF4tsxuHHhL3OEN8EkvAb4sLdcXRxGsKFjPBY/edit#slide=id.p\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769559562/reactions","total_count":2,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":2,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769566669","html_url":"https://github.com/apache/iceberg/issues/2172#issuecomment-769566669","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2172","id":769566669,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTU2NjY2OQ==","user":{"login":"bkahloon","id":42993708,"node_id":"MDQ6VXNlcjQyOTkzNzA4","avatar_url":"https://avatars.githubusercontent.com/u/42993708?v=4","gravatar_id":"","url":"https://api.github.com/users/bkahloon","html_url":"https://github.com/bkahloon","followers_url":"https://api.github.com/users/bkahloon/followers","following_url":"https://api.github.com/users/bkahloon/following{/other_user}","gists_url":"https://api.github.com/users/bkahloon/gists{/gist_id}","starred_url":"https://api.github.com/users/bkahloon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bkahloon/subscriptions","organizations_url":"https://api.github.com/users/bkahloon/orgs","repos_url":"https://api.github.com/users/bkahloon/repos","events_url":"https://api.github.com/users/bkahloon/events{/privacy}","received_events_url":"https://api.github.com/users/bkahloon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T04:27:24Z","updated_at":"2021-01-29T04:27:24Z","author_association":"CONTRIBUTOR","body":"Thanks a lot for the info @openinx ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769566669/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769618965","html_url":"https://github.com/apache/iceberg/issues/2181#issuecomment-769618965","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2181","id":769618965,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTYxODk2NQ==","user":{"login":"simuhunluo","id":22125687,"node_id":"MDQ6VXNlcjIyMTI1Njg3","avatar_url":"https://avatars.githubusercontent.com/u/22125687?v=4","gravatar_id":"","url":"https://api.github.com/users/simuhunluo","html_url":"https://github.com/simuhunluo","followers_url":"https://api.github.com/users/simuhunluo/followers","following_url":"https://api.github.com/users/simuhunluo/following{/other_user}","gists_url":"https://api.github.com/users/simuhunluo/gists{/gist_id}","starred_url":"https://api.github.com/users/simuhunluo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/simuhunluo/subscriptions","organizations_url":"https://api.github.com/users/simuhunluo/orgs","repos_url":"https://api.github.com/users/simuhunluo/repos","events_url":"https://api.github.com/users/simuhunluo/events{/privacy}","received_events_url":"https://api.github.com/users/simuhunluo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T06:58:30Z","updated_at":"2021-01-29T06:58:30Z","author_association":"NONE","body":"Have you try execute sql with command in sql-shell?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769618965/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769621263","html_url":"https://github.com/apache/iceberg/issues/2181#issuecomment-769621263","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2181","id":769621263,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTYyMTI2Mw==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T07:03:41Z","updated_at":"2021-01-29T07:03:41Z","author_association":"CONTRIBUTOR","body":"`iceberg-flink` and `iceberg-hive-metastore` is unnecessaryï¼Œyou can remove it from pom, we only need `iceberg-flink-runtime-xxx.jar` and `flink-sql-connector-hive-2.3.6_2.11-1.11.0.jar`,see [doc](https://iceberg.apache.org/flink/)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769621263/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769627622","html_url":"https://github.com/apache/iceberg/issues/2168#issuecomment-769627622","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2168","id":769627622,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTYyNzYyMg==","user":{"login":"simuhunluo","id":22125687,"node_id":"MDQ6VXNlcjIyMTI1Njg3","avatar_url":"https://avatars.githubusercontent.com/u/22125687?v=4","gravatar_id":"","url":"https://api.github.com/users/simuhunluo","html_url":"https://github.com/simuhunluo","followers_url":"https://api.github.com/users/simuhunluo/followers","following_url":"https://api.github.com/users/simuhunluo/following{/other_user}","gists_url":"https://api.github.com/users/simuhunluo/gists{/gist_id}","starred_url":"https://api.github.com/users/simuhunluo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/simuhunluo/subscriptions","organizations_url":"https://api.github.com/users/simuhunluo/orgs","repos_url":"https://api.github.com/users/simuhunluo/repos","events_url":"https://api.github.com/users/simuhunluo/events{/privacy}","received_events_url":"https://api.github.com/users/simuhunluo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T07:18:08Z","updated_at":"2021-01-29T07:18:08Z","author_association":"NONE","body":"@bkahloon   ok, be glad to share.  \r\n\r\nIn fact , I am trying to use hive metastore service  but not aws glue table.  \r\n+ After creating catalog with flink sql client(using minio as s3 service poc verification),\r\n```\r\nCREATE CATALOG hive_catalog with(\r\n  'type'='iceberg',\r\n  'catalog-type'='hive',\r\n  'uri'='thrift://localhost:9083',\r\n  'warehouse'='s3://mybucket/'\r\n);\r\n```\r\n+ When try to create the database, some error occurred\r\n```\r\ncreate database hive_catalog.mydb;\r\n```\r\n+ error content:\r\n```\r\nCaused by: org.apache.hadoop.hive.metastore.api.MetaException: Got exception: org.apache.hadoop.fs.s3.S3Exception org.jets3t.service.S3ServiceException: S3 Error Message. \r\n-- ResponseCode: 403, ResponseStatus: Forbidden, XML Error Message:\r\n <?xml version=\"1.0\" encoding=\"UTF-8\"?><Error><Code>InvalidAccessKeyId</Code><Message>The AWS Access Key Id you provided does not exist in our records.</Message><AWSAccessKeyId>minioadmin</AWSAccessKeyId><RequestId>707081D8D8FAE888</RequestId><HostId>h0zIBYj2MJDZ7H9uWtFXwkLyp8HWUk3F7mAr8DfrTym4HyKBFuJAqpMb3hOcEg3F3iOZkb0HBug=</HostId></Error>\r\n        at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$create_database_result$create_database_resultStandardScheme.read(ThriftHiveMetastore.java:39343) ~[?:?]\r\n        at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$create_database_result$create_database_resultStandardScheme.read(ThriftHiveMetastore.java:39311) ~[?:?]\r\n        at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$create_database_result.read(ThriftHiveMetastore.java:39245) ~[?:?]\r\n        at org.apache.thrift.TServiceClient.receiveBase(TServiceClient.java:86) ~[?:?]\r\n        at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Client.recv_create_database(ThriftHiveMetastore.java:1106) ~[?:?]\r\n        at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Client.create_database(ThriftHiveMetastore.java:1093) ~[?:?]\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.createDatabase(HiveMetaStoreClient.java:809) ~[?:?]\r\n        at org.apache.iceberg.hive.HiveCatalog.lambda$createNamespace$7(HiveCatalog.java:302) ~[?:?]\r\n        at org.apache.iceberg.hive.ClientPool.run(ClientPool.java:54) ~[?:?]\r\n        at org.apache.iceberg.hive.HiveCatalog.createNamespace(HiveCatalog.java:301) ~[?:?]\r\n        at org.apache.iceberg.flink.FlinkCatalog.createDatabase(FlinkCatalog.java:200) ~[?:?]\r\n        at org.apache.iceberg.flink.FlinkCatalog.createDatabase(FlinkCatalog.java:193) ~[?:?]\r\n        at org.apache.flink.table.api.internal.TableEnvironmentImpl.executeOperation(TableEnvironmentImpl.java:968) ~[flink-table_2.12-1.11.2.jar:1.11.2]\r\n        at org.apache.flink.table.api.internal.TableEnvironmentImpl.executeSql(TableEnvironmentImpl.java:690) ~[flink-table_2.12-1.11.2.jar:1.11.2]\r\n        at org.apache.flink.table.client.gateway.local.LocalExecutor.lambda$executeSql$7(LocalExecutor.java:360) ~[flink-sql-client_2.11-1.11.2.jar:1.11.2]\r\n        at org.apache.flink.table.client.gateway.local.ExecutionContext.wrapClassLoader(ExecutionContext.java:255) ~[flink-sql-client_2.11-1.11.2.jar:1.11.2]\r\n        at org.apache.flink.table.client.gateway.local.LocalExecutor.executeSql(LocalExecutor.java:360) ~[flink-sql-client_2.11-1.11.2.jar:1.11.2]\r\n        ... 8 more\r\n```\r\n\r\nIt is easy to understand why this error occurs. `minioadmin` is my local minio servicekey, It does not exist on the aws s3 sever.\r\nBut what I am puzzled is, the caller of s3 api should be iceberg, not hive metastore. \r\nAnyone has any ideas?\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769627622/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769641714","html_url":"https://github.com/apache/iceberg/issues/2168#issuecomment-769641714","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2168","id":769641714,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTY0MTcxNA==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T07:52:28Z","updated_at":"2021-01-29T07:53:11Z","author_association":"CONTRIBUTOR","body":"> @bkahloon where the metadata store, Together with data in s3?\r\n\r\nIceberg table metadata (table version metadata, snapshot, manifest), are always stored in the storage, because itself can become \"big metadata\". For GlueCatalog, it is stored under the path configured under `warehouse`. For Hive, it is determined by Hive's metastore config key `hive.metastore.warehouse.dir` value in Hive's runtime environment. ([link](https://github.com/apache/iceberg/blob/master/hive-metastore/src/main/java/org/apache/iceberg/hive/HiveCatalog.java#L490-L519\r\n)).\r\n\r\nBoth catalog supports overriding this metadata path at namespace or table level.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769641714/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769655284","html_url":"https://github.com/apache/iceberg/issues/2168#issuecomment-769655284","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2168","id":769655284,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTY1NTI4NA==","user":{"login":"simuhunluo","id":22125687,"node_id":"MDQ6VXNlcjIyMTI1Njg3","avatar_url":"https://avatars.githubusercontent.com/u/22125687?v=4","gravatar_id":"","url":"https://api.github.com/users/simuhunluo","html_url":"https://github.com/simuhunluo","followers_url":"https://api.github.com/users/simuhunluo/followers","following_url":"https://api.github.com/users/simuhunluo/following{/other_user}","gists_url":"https://api.github.com/users/simuhunluo/gists{/gist_id}","starred_url":"https://api.github.com/users/simuhunluo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/simuhunluo/subscriptions","organizations_url":"https://api.github.com/users/simuhunluo/orgs","repos_url":"https://api.github.com/users/simuhunluo/repos","events_url":"https://api.github.com/users/simuhunluo/events{/privacy}","received_events_url":"https://api.github.com/users/simuhunluo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T08:23:19Z","updated_at":"2021-01-29T08:23:19Z","author_association":"NONE","body":"Thanks for your answer. I have gained a lot. Metadata must store with data. This issue will be closed.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769655284/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769656812","html_url":"https://github.com/apache/iceberg/issues/2168#issuecomment-769656812","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2168","id":769656812,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTY1NjgxMg==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T08:26:54Z","updated_at":"2021-01-29T08:26:54Z","author_association":"CONTRIBUTOR","body":"Metadata does not need to be in the same storage as the data. But it is stored in a storage.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769656812/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769658717","html_url":"https://github.com/apache/iceberg/issues/2168#issuecomment-769658717","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2168","id":769658717,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTY1ODcxNw==","user":{"login":"simuhunluo","id":22125687,"node_id":"MDQ6VXNlcjIyMTI1Njg3","avatar_url":"https://avatars.githubusercontent.com/u/22125687?v=4","gravatar_id":"","url":"https://api.github.com/users/simuhunluo","html_url":"https://github.com/simuhunluo","followers_url":"https://api.github.com/users/simuhunluo/followers","following_url":"https://api.github.com/users/simuhunluo/following{/other_user}","gists_url":"https://api.github.com/users/simuhunluo/gists{/gist_id}","starred_url":"https://api.github.com/users/simuhunluo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/simuhunluo/subscriptions","organizations_url":"https://api.github.com/users/simuhunluo/orgs","repos_url":"https://api.github.com/users/simuhunluo/repos","events_url":"https://api.github.com/users/simuhunluo/events{/privacy}","received_events_url":"https://api.github.com/users/simuhunluo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T08:30:57Z","updated_at":"2021-01-29T08:30:57Z","author_association":"NONE","body":"The storage should be a filesystem? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769658717/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769661862","html_url":"https://github.com/apache/iceberg/issues/2168#issuecomment-769661862","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2168","id":769661862,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTY2MTg2Mg==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T08:37:24Z","updated_at":"2021-01-29T08:37:24Z","author_association":"CONTRIBUTOR","body":"No, S3 is not a file system for example. It completely depends on your implementation of `org.apache.iceberg.io.FileIO`. When you use `HiveCatalog` and `HadoopCatalog`, it by default uses `HadoopFileIO` which treats `s3://` as a file system. But if you use `ClueCatalog`, it uses `S3FileIO` which does not have file system assumptions (which also means better performance).\r\n\r\nSo when I say \"storage\", it is just conceptual, mostly because we have such a concept of \"file IO\". But technically it all depends on your implementation. You can implement a `MySQLIO` that write data to MySQL if you want, and it can be loaded by all catalogs.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769661862/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769667376","html_url":"https://github.com/apache/iceberg/issues/2168#issuecomment-769667376","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2168","id":769667376,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTY2NzM3Ng==","user":{"login":"simuhunluo","id":22125687,"node_id":"MDQ6VXNlcjIyMTI1Njg3","avatar_url":"https://avatars.githubusercontent.com/u/22125687?v=4","gravatar_id":"","url":"https://api.github.com/users/simuhunluo","html_url":"https://github.com/simuhunluo","followers_url":"https://api.github.com/users/simuhunluo/followers","following_url":"https://api.github.com/users/simuhunluo/following{/other_user}","gists_url":"https://api.github.com/users/simuhunluo/gists{/gist_id}","starred_url":"https://api.github.com/users/simuhunluo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/simuhunluo/subscriptions","organizations_url":"https://api.github.com/users/simuhunluo/orgs","repos_url":"https://api.github.com/users/simuhunluo/repos","events_url":"https://api.github.com/users/simuhunluo/events{/privacy}","received_events_url":"https://api.github.com/users/simuhunluo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T08:48:25Z","updated_at":"2021-01-29T08:48:25Z","author_association":"NONE","body":"In other words, I can implement MysqlIO to store metadata , and S3FileIO/HadoopFileIO(iceberg has supported) to store data.  Will this cause performance problems?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769667376/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769670937","html_url":"https://github.com/apache/iceberg/issues/2168#issuecomment-769670937","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2168","id":769670937,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTY3MDkzNw==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T08:55:12Z","updated_at":"2021-01-29T08:55:12Z","author_association":"CONTRIBUTOR","body":"The interface only allows defining a single FileIO for both operations. However, if you read the interface, you will realize that you can check the file path to see if it is metadata file or not, and then choose to write metadata and data differently. It is a very flexible interface.\r\n\r\nIn fact, the `HadoopFileIO` is doing such a thing right now for `HiveCatalog`. If you define a s3 path for your `warehouse`, then all your data files goes to s3, but by default all your metadata files are stored in the HDFS that the Hive metastore operates on. \r\n\r\nbtw, just to be clear, I am not advocating you to use mysql, that's just an example. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769670937/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769674534","html_url":"https://github.com/apache/iceberg/pull/2171#issuecomment-769674534","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2171","id":769674534,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTY3NDUzNA==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T09:01:56Z","updated_at":"2021-01-29T09:01:56Z","author_association":"CONTRIBUTOR","body":"@qphien: We have some internal deadlines end of this week, so we will come back to you in more details on the next week.\r\n\r\nIn the meantime we had discussed this briefly with @marton-bod.\r\n\r\nFor the current solution I have the following concerns:\r\n- This issues is better solved by [TEZ-4248](https://issues.apache.org/jira/browse/TEZ-4248). Since it is not yet in any release I understand why you are looking for solution in Iceberg.\r\n- Creating an extra `Record` object for every row in a table can be costly. We want to avoid running any extra lines of code on a codepath which runs on every row. And minimally we want to avoid creating objects on that codepath. I haven't checked but we might want to push down the stuff to Record generation.\r\n- When we solve the vectorization problem we can enable it in the tests here: https://github.com/apache/iceberg/blob/19622dcfcb426485748fa017a6181e23df5732dc/mr/src/test/java/org/apache/iceberg/mr/hive/HiveIcebergStorageHandlerTestUtils.java#L91-L93\r\n\r\nThanks,\r\nPeter","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769674534/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769679259","html_url":"https://github.com/apache/iceberg/pull/2180#issuecomment-769679259","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2180","id":769679259,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTY3OTI1OQ==","user":{"login":"rymurr","id":2022305,"node_id":"MDQ6VXNlcjIwMjIzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/2022305?v=4","gravatar_id":"","url":"https://api.github.com/users/rymurr","html_url":"https://github.com/rymurr","followers_url":"https://api.github.com/users/rymurr/followers","following_url":"https://api.github.com/users/rymurr/following{/other_user}","gists_url":"https://api.github.com/users/rymurr/gists{/gist_id}","starred_url":"https://api.github.com/users/rymurr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rymurr/subscriptions","organizations_url":"https://api.github.com/users/rymurr/orgs","repos_url":"https://api.github.com/users/rymurr/repos","events_url":"https://api.github.com/users/rymurr/events{/privacy}","received_events_url":"https://api.github.com/users/rymurr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T09:10:48Z","updated_at":"2021-01-29T09:10:48Z","author_association":"CONTRIBUTOR","body":"Thanks a lot for fixing this @rdblue . I just went over the original patch to try and figure out what I missed. It looks like I took the `5` from: https://github.com/apache/iceberg/blob/master/hive-metastore/src/main/java/org/apache/iceberg/hive/HiveClientPool.java#L42 rather than ` CatalogProperties.CLIENT_POOL_SIZE_DEFAULT`. \r\n\r\nI wonder if we should change `HiveClientPool` to use the default too? Or even better can we make the tests/code resilient to changes in pool size?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769679259/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769701554","html_url":"https://github.com/apache/iceberg/pull/2180#issuecomment-769701554","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2180","id":769701554,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTcwMTU1NA==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T09:52:11Z","updated_at":"2021-01-29T09:52:11Z","author_association":"CONTRIBUTOR","body":"I think the main difference is that `HiveCatalogs` uses an internal `CATALOG_CACHE` so if you try to get the Catalog for the same URI multiple times you will get back the same instance. OTOH with the new implementation there is no cache, and if you request a catalog you will get back a new instance every time - the question is if this is an intended behavior or we can share the instances.\r\n\r\nCC: @lcspinter","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769701554/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769705387","html_url":"https://github.com/apache/iceberg/pull/2171#issuecomment-769705387","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2171","id":769705387,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTcwNTM4Nw==","user":{"login":"qphien","id":17759741,"node_id":"MDQ6VXNlcjE3NzU5NzQx","avatar_url":"https://avatars.githubusercontent.com/u/17759741?v=4","gravatar_id":"","url":"https://api.github.com/users/qphien","html_url":"https://github.com/qphien","followers_url":"https://api.github.com/users/qphien/followers","following_url":"https://api.github.com/users/qphien/following{/other_user}","gists_url":"https://api.github.com/users/qphien/gists{/gist_id}","starred_url":"https://api.github.com/users/qphien/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/qphien/subscriptions","organizations_url":"https://api.github.com/users/qphien/orgs","repos_url":"https://api.github.com/users/qphien/repos","events_url":"https://api.github.com/users/qphien/events{/privacy}","received_events_url":"https://api.github.com/users/qphien/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T09:59:40Z","updated_at":"2021-01-29T09:59:40Z","author_association":"CONTRIBUTOR","body":"@pvary Thanks for your reply.  I agree that creating an extra record is not a good way to solve vectorization problem in hive, we need to find another way to solve this problem.\r\n\r\n[TEZ-4248](https://issues.apache.org/jira/browse/TEZ-4248) is a better way to solve  projection issue on tez.  BTW, do we need to change [this assert](https://github.com/apache/iceberg/blob/19622dcfcb426485748fa017a6181e23df5732dc/mr/src/main/java/org/apache/iceberg/mr/hive/HiveIcebergSerDe.java#L112-L118) currently since this issue happens no matter whether `hive.vectorized.execution.enabled` is enabled ?\r\n\r\n ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769705387/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769711970","html_url":"https://github.com/apache/iceberg/pull/2171#issuecomment-769711970","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2171","id":769711970,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTcxMTk3MA==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T10:11:30Z","updated_at":"2021-01-29T10:11:47Z","author_association":"CONTRIBUTOR","body":"> BTW, do we need to change [this assert](https://github.com/apache/iceberg/blob/19622dcfcb426485748fa017a6181e23df5732dc/mr/src/main/java/org/apache/iceberg/mr/hive/HiveIcebergSerDe.java#L112-L118) currently since this issue happens no matter whether `hive.vectorized.execution.enabled` is enabled ?\r\n\r\nTesting vectorization is hard. Even if we turn on vectorization we have to check the output of `EXPLAIN VECTORIZATION <QUERY>` to check if the vectorization is actually happening or not, but if you can add a test case which fails even with vectorization disabled that's a good indicator that we definitely need TEZ-4248 or some other solution, and helps investigating the problem","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769711970/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769725473","html_url":"https://github.com/apache/iceberg/issues/2181#issuecomment-769725473","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2181","id":769725473,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTcyNTQ3Mw==","user":{"login":"Simmyo","id":45420060,"node_id":"MDQ6VXNlcjQ1NDIwMDYw","avatar_url":"https://avatars.githubusercontent.com/u/45420060?v=4","gravatar_id":"","url":"https://api.github.com/users/Simmyo","html_url":"https://github.com/Simmyo","followers_url":"https://api.github.com/users/Simmyo/followers","following_url":"https://api.github.com/users/Simmyo/following{/other_user}","gists_url":"https://api.github.com/users/Simmyo/gists{/gist_id}","starred_url":"https://api.github.com/users/Simmyo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Simmyo/subscriptions","organizations_url":"https://api.github.com/users/Simmyo/orgs","repos_url":"https://api.github.com/users/Simmyo/repos","events_url":"https://api.github.com/users/Simmyo/events{/privacy}","received_events_url":"https://api.github.com/users/Simmyo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T10:38:46Z","updated_at":"2021-01-29T10:38:46Z","author_association":"NONE","body":"> Have you try execute sql with command in sql-shell?\r\n\r\nI was able to do this successfully with sql-shell","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769725473/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769725687","html_url":"https://github.com/apache/iceberg/issues/2181#issuecomment-769725687","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2181","id":769725687,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTcyNTY4Nw==","user":{"login":"Simmyo","id":45420060,"node_id":"MDQ6VXNlcjQ1NDIwMDYw","avatar_url":"https://avatars.githubusercontent.com/u/45420060?v=4","gravatar_id":"","url":"https://api.github.com/users/Simmyo","html_url":"https://github.com/Simmyo","followers_url":"https://api.github.com/users/Simmyo/followers","following_url":"https://api.github.com/users/Simmyo/following{/other_user}","gists_url":"https://api.github.com/users/Simmyo/gists{/gist_id}","starred_url":"https://api.github.com/users/Simmyo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Simmyo/subscriptions","organizations_url":"https://api.github.com/users/Simmyo/orgs","repos_url":"https://api.github.com/users/Simmyo/repos","events_url":"https://api.github.com/users/Simmyo/events{/privacy}","received_events_url":"https://api.github.com/users/Simmyo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T10:39:12Z","updated_at":"2021-01-29T10:39:12Z","author_association":"NONE","body":"> `iceberg-flink` and `iceberg-hive-metastore` is unnecessaryï¼Œyou can remove it from pom, we only need `iceberg-flink-runtime-xxx.jar` and `flink-sql-connector-hive-2.3.6_2.11-1.11.0.jar`,see [doc](https://iceberg.apache.org/flink/)\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769725687/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769732086","html_url":"https://github.com/apache/iceberg/issues/2181#issuecomment-769732086","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2181","id":769732086,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTczMjA4Ng==","user":{"login":"Simmyo","id":45420060,"node_id":"MDQ6VXNlcjQ1NDIwMDYw","avatar_url":"https://avatars.githubusercontent.com/u/45420060?v=4","gravatar_id":"","url":"https://api.github.com/users/Simmyo","html_url":"https://github.com/Simmyo","followers_url":"https://api.github.com/users/Simmyo/followers","following_url":"https://api.github.com/users/Simmyo/following{/other_user}","gists_url":"https://api.github.com/users/Simmyo/gists{/gist_id}","starred_url":"https://api.github.com/users/Simmyo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Simmyo/subscriptions","organizations_url":"https://api.github.com/users/Simmyo/orgs","repos_url":"https://api.github.com/users/Simmyo/repos","events_url":"https://api.github.com/users/Simmyo/events{/privacy}","received_events_url":"https://api.github.com/users/Simmyo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T10:52:37Z","updated_at":"2021-01-29T10:52:37Z","author_association":"NONE","body":"> `iceberg-flink` and `iceberg-hive-metastore` is unnecessaryï¼Œyou can remove it from pom, we only need `iceberg-flink-runtime-xxx.jar` and `flink-sql-connector-hive-2.3.6_2.11-1.11.0.jar`,see [doc](https://iceberg.apache.org/flink/)\r\n\r\nI still get the same error after I remove it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769732086/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769736710","html_url":"https://github.com/apache/iceberg/issues/2181#issuecomment-769736710","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2181","id":769736710,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTczNjcxMA==","user":{"login":"Simmyo","id":45420060,"node_id":"MDQ6VXNlcjQ1NDIwMDYw","avatar_url":"https://avatars.githubusercontent.com/u/45420060?v=4","gravatar_id":"","url":"https://api.github.com/users/Simmyo","html_url":"https://github.com/Simmyo","followers_url":"https://api.github.com/users/Simmyo/followers","following_url":"https://api.github.com/users/Simmyo/following{/other_user}","gists_url":"https://api.github.com/users/Simmyo/gists{/gist_id}","starred_url":"https://api.github.com/users/Simmyo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Simmyo/subscriptions","organizations_url":"https://api.github.com/users/Simmyo/orgs","repos_url":"https://api.github.com/users/Simmyo/repos","events_url":"https://api.github.com/users/Simmyo/events{/privacy}","received_events_url":"https://api.github.com/users/Simmyo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T11:02:06Z","updated_at":"2021-01-29T11:03:58Z","author_association":"NONE","body":"> > `iceberg-flink` and `iceberg-hive-metastore` is unnecessaryï¼Œyou can remove it from pom, we only need `iceberg-flink-runtime-xxx.jar` and `flink-sql-connector-hive-2.3.6_2.11-1.11.0.jar`,see [doc](https://iceberg.apache.org/flink/)\r\n> \r\n> I still get the same error after I remove it.\r\n\r\nremove `iceberg-hive-metastore` , unable to connect hive metastore with flink datastream.\r\n```\r\n TableLoader hiveTableLoader = TableLoader.fromCatalog(\r\n                (CatalogLoader) () -> new HiveCatalog(\"hive\", \"thrift://xxx:9083\",\r\n                        \"hdfs://xxx:8020/user/hive/warehouse\", 3, hadoopConf),\r\n                TableIdentifier.of(dbName, tableName));\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769736710/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769737942","html_url":"https://github.com/apache/iceberg/pull/2125#issuecomment-769737942","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2125","id":769737942,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTczNzk0Mg==","user":{"login":"steveloughran","id":162090,"node_id":"MDQ6VXNlcjE2MjA5MA==","avatar_url":"https://avatars.githubusercontent.com/u/162090?v=4","gravatar_id":"","url":"https://api.github.com/users/steveloughran","html_url":"https://github.com/steveloughran","followers_url":"https://api.github.com/users/steveloughran/followers","following_url":"https://api.github.com/users/steveloughran/following{/other_user}","gists_url":"https://api.github.com/users/steveloughran/gists{/gist_id}","starred_url":"https://api.github.com/users/steveloughran/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/steveloughran/subscriptions","organizations_url":"https://api.github.com/users/steveloughran/orgs","repos_url":"https://api.github.com/users/steveloughran/repos","events_url":"https://api.github.com/users/steveloughran/events{/privacy}","received_events_url":"https://api.github.com/users/steveloughran/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T11:04:31Z","updated_at":"2021-01-29T11:04:31Z","author_association":"CONTRIBUTOR","body":"thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769737942/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769742755","html_url":"https://github.com/apache/iceberg/pull/2171#issuecomment-769742755","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2171","id":769742755,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTc0Mjc1NQ==","user":{"login":"qphien","id":17759741,"node_id":"MDQ6VXNlcjE3NzU5NzQx","avatar_url":"https://avatars.githubusercontent.com/u/17759741?v=4","gravatar_id":"","url":"https://api.github.com/users/qphien","html_url":"https://github.com/qphien","followers_url":"https://api.github.com/users/qphien/followers","following_url":"https://api.github.com/users/qphien/following{/other_user}","gists_url":"https://api.github.com/users/qphien/gists{/gist_id}","starred_url":"https://api.github.com/users/qphien/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/qphien/subscriptions","organizations_url":"https://api.github.com/users/qphien/orgs","repos_url":"https://api.github.com/users/qphien/repos","events_url":"https://api.github.com/users/qphien/events{/privacy}","received_events_url":"https://api.github.com/users/qphien/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T11:13:55Z","updated_at":"2021-01-29T11:13:55Z","author_association":"CONTRIBUTOR","body":"```\r\n  public void testScanTable() throws IOException {\r\n    shell.setHiveSessionValue(\"hive.vectorized.execution.enabled\", \"false\");\r\n\r\n    testTables.createTable(shell, \"customers\", HiveIcebergStorageHandlerTestUtils.CUSTOMER_SCHEMA, fileFormat,\r\n        HiveIcebergStorageHandlerTestUtils.CUSTOMER_RECORDS);\r\n\r\n    // Adding the ORDER BY clause will cause Hive to spawn a local MR job this time.\r\n    List<Object[]> descRows =\r\n        shell.executeStatement(\"SELECT last_name, customer_id FROM default.customers ORDER BY customer_id DESC\");\r\n\r\n    Assert.assertEquals(3, descRows.size());\r\n    Assert.assertArrayEquals(new Object[] {\"Pink\", 2L}, descRows.get(0));\r\n    Assert.assertArrayEquals(new Object[] {\"Green\", 1L}, descRows.get(1));\r\n    Assert.assertArrayEquals(new Object[] {\"Brown\", 0L}, descRows.get(2));\r\n  }\r\n```\r\n\r\n\r\nWith vectorization disabled, this modified `testScanTable` test still throws the same exception due to missing `hive.io.file.readcolumn.names` in `MapOperator.jonConf`:\r\n```\r\nCaused by: java.lang.ArrayIndexOutOfBoundsException: 2\r\n\tat org.apache.iceberg.data.GenericRecord.get(GenericRecord.java:114)\r\n\tat org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector.getStructFieldData(IcebergRecordObjectInspector.java:75)\r\n\tat org.apache.hadoop.hive.ql.exec.ExprNodeColumnEvaluator._evaluate(ExprNodeColumnEvaluator.java:95)\r\n\tat org.apache.hadoop.hive.ql.exec.ExprNodeEvaluator.evaluate(ExprNodeEvaluator.java:80)\r\n\tat org.apache.hadoop.hive.ql.exec.ExprNodeEvaluator.evaluate(ExprNodeEvaluator.java:68)\r\n\tat org.apache.hadoop.hive.ql.exec.SelectOperator.process(SelectOperator.java:88)\r\n\t... 25 more\r\n```\r\n\r\n\r\nWe can add `conf.set(\"tez.mrreader.config.update.properties\", \"hive.io.file.readcolumn.names\")` in `HiveIcebergSerde.initialize()` or some other place with TEZ-4248 to solve this problem.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769742755/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769787140","html_url":"https://github.com/apache/iceberg/pull/1956#issuecomment-769787140","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1956","id":769787140,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTc4NzE0MA==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T12:51:45Z","updated_at":"2021-01-29T12:51:45Z","author_association":"MEMBER","body":"Seems we still have the class loader issue ( from the travis ): \r\n\r\n```java\r\norg.apache.iceberg.flink.sink.TestTaskWriters > testRandomData[format = parquet, partitioned = true] FAILED\r\n    java.lang.IllegalStateException: Trying to access closed classloader. Please check if you store classloaders directly or indirectly in static fields. If the stacktrace suggests that the leak occurs in a third party library and cannot be fixed immediately, you can disable this check with the configuration 'classloader.check-leaked-classloader'.\r\n        at org.apache.flink.runtime.execution.librarycache.FlinkUserCodeClassLoaders$SafetyNetWrapperClassLoader.ensureInner(FlinkUserCodeClassLoaders.java:164)\r\n        at org.apache.flink.runtime.execution.librarycache.FlinkUserCodeClassLoaders$SafetyNetWrapperClassLoader.getResource(FlinkUserCodeClassLoaders.java:183)\r\n        at org.apache.hadoop.conf.Configuration.getResource(Configuration.java:2337)\r\n        at org.apache.hadoop.conf.Configuration.loadResource(Configuration.java:2538)\r\n        at org.apache.hadoop.conf.Configuration.loadResources(Configuration.java:2492)\r\n        at org.apache.hadoop.conf.Configuration.getProps(Configuration.java:2405)\r\n        at org.apache.hadoop.conf.Configuration.get(Configuration.java:981)\r\n        at org.apache.hadoop.conf.Configuration.getTrimmed(Configuration.java:1031)\r\n        at org.apache.hadoop.conf.Configuration.getInt(Configuration.java:1251)\r\n        at org.apache.hadoop.io.compress.GzipCodec.createInputStream(GzipCodec.java:154)\r\n        at org.apache.parquet.hadoop.CodecFactory$HeapBytesDecompressor.decompress(CodecFactory.java:109)\r\n        at org.apache.parquet.hadoop.ColumnChunkPageReadStore$ColumnChunkPageReader$1.visit(ColumnChunkPageReadStore.java:103)\r\n        at org.apache.parquet.hadoop.ColumnChunkPageReadStore$ColumnChunkPageReader$1.visit(ColumnChunkPageReadStore.java:99)\r\n        at org.apache.parquet.column.page.DataPageV1.accept(DataPageV1.java:120)\r\n        at org.apache.parquet.hadoop.ColumnChunkPageReadStore$ColumnChunkPageReader.readPage(ColumnChunkPageReadStore.java:99)\r\n        at org.apache.iceberg.parquet.BaseColumnIterator.advance(BaseColumnIterator.java:60)\r\n        at org.apache.iceberg.parquet.BaseColumnIterator.setPageSource(BaseColumnIterator.java:51)\r\n        at org.apache.iceberg.parquet.ParquetValueReaders$PrimitiveReader.setPageSource(ParquetValueReaders.java:185)\r\n        at org.apache.iceberg.parquet.ParquetValueReaders$OptionReader.setPageSource(ParquetValueReaders.java:369)\r\n        at org.apache.iceberg.parquet.ParquetValueReaders$StructReader.setPageSource(ParquetValueReaders.java:685)\r\n        at org.apache.iceberg.parquet.ParquetReader$FileIterator.advance(ParquetReader.java:142)\r\n        at org.apache.iceberg.parquet.ParquetReader$FileIterator.next(ParquetReader.java:112)\r\n        at org.apache.iceberg.io.CloseableIterable$ConcatCloseableIterable$ConcatCloseableIterator.next(CloseableIterable.java:206)\r\n        at org.apache.iceberg.relocated.com.google.common.collect.Iterators.addAll(Iterators.java:356)\r\n        at org.apache.iceberg.relocated.com.google.common.collect.Iterables.addAll(Iterables.java:320)\r\n        at org.apache.iceberg.relocated.com.google.common.collect.HashMultiset.create(HashMultiset.java:61)\r\n        at org.apache.iceberg.flink.SimpleDataUtil.assertTableRecords(SimpleDataUtil.java:194)\r\n        at org.apache.iceberg.flink.SimpleDataUtil.assertTableRecords(SimpleDataUtil.java:200)\r\n        at org.apache.iceberg.flink.SimpleDataUtil.assertTableRows(SimpleDataUtil.java:183)\r\n        at org.apache.iceberg.flink.sink.TestTaskWriters.testRandomData(TestTaskWriters.java:234)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769787140/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769800112","html_url":"https://github.com/apache/iceberg/pull/1956#issuecomment-769800112","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1956","id":769800112,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTgwMDExMg==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T13:19:34Z","updated_at":"2021-01-29T13:19:34Z","author_association":"MEMBER","body":"Skimmed this flink PR https://github.com/apache/flink/commit/fce82d7f56d5da3d3bf9ea6b66888d1350eb172f,  sounds like we are still using the flink's class loader after we terminated the flink streaming job because we usually use the hadoop iceberg table to read records from it for assertion purpose. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769800112/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769811208","html_url":"https://github.com/apache/iceberg/issues/2181#issuecomment-769811208","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2181","id":769811208,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTgxMTIwOA==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T13:40:42Z","updated_at":"2021-01-29T13:40:42Z","author_association":"MEMBER","body":"@Simmyo ,  Yeah,  I guess it's true that we need the iceberg-hive-metastore  to load iceberg table inside the task managers if you are running flink data streaming job.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769811208/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769852537","html_url":"https://github.com/apache/iceberg/issues/2181#issuecomment-769852537","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2181","id":769852537,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTg1MjUzNw==","user":{"login":"Simmyo","id":45420060,"node_id":"MDQ6VXNlcjQ1NDIwMDYw","avatar_url":"https://avatars.githubusercontent.com/u/45420060?v=4","gravatar_id":"","url":"https://api.github.com/users/Simmyo","html_url":"https://github.com/Simmyo","followers_url":"https://api.github.com/users/Simmyo/followers","following_url":"https://api.github.com/users/Simmyo/following{/other_user}","gists_url":"https://api.github.com/users/Simmyo/gists{/gist_id}","starred_url":"https://api.github.com/users/Simmyo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Simmyo/subscriptions","organizations_url":"https://api.github.com/users/Simmyo/orgs","repos_url":"https://api.github.com/users/Simmyo/repos","events_url":"https://api.github.com/users/Simmyo/events{/privacy}","received_events_url":"https://api.github.com/users/Simmyo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T14:54:33Z","updated_at":"2021-01-29T14:54:33Z","author_association":"NONE","body":"> @Simmyo , Yeah, I guess it's true that we need the iceberg-hive-metastore to load iceberg table inside the task managers if you are running flink data streaming job.\r\n\r\nI think the official website document should be more detailed, I can't get much information","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769852537/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769952948","html_url":"https://github.com/apache/iceberg/issues/2033#issuecomment-769952948","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2033","id":769952948,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTk1Mjk0OA==","user":{"login":"elkhand","id":4366998,"node_id":"MDQ6VXNlcjQzNjY5OTg=","avatar_url":"https://avatars.githubusercontent.com/u/4366998?v=4","gravatar_id":"","url":"https://api.github.com/users/elkhand","html_url":"https://github.com/elkhand","followers_url":"https://api.github.com/users/elkhand/followers","following_url":"https://api.github.com/users/elkhand/following{/other_user}","gists_url":"https://api.github.com/users/elkhand/gists{/gist_id}","starred_url":"https://api.github.com/users/elkhand/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elkhand/subscriptions","organizations_url":"https://api.github.com/users/elkhand/orgs","repos_url":"https://api.github.com/users/elkhand/repos","events_url":"https://api.github.com/users/elkhand/events{/privacy}","received_events_url":"https://api.github.com/users/elkhand/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T17:50:42Z","updated_at":"2021-01-29T17:50:42Z","author_association":"CONTRIBUTOR","body":"Anyone facing the same issue, to bypass the issue until this bug is fixed on the Flink side:\r\nYou do not need to fix corrupted metadata files where `flink.max-committed-checkpoint-id` is set to `Long.MAX_VALUE`.\r\n\r\nJust follow this workflow for stateful upgrades going forward - this flow works as expected and you do not get corrupted metadata file anymore:\r\n- take manual savepoint, no job stopping or canceling `./bin/flink savepoint ${JOB_ID} /tmp/flink-savepoints`\r\n- cancel your job\r\n- do your code changes, upload a new jar of your job\r\n- start your job with the last saved savepoint\r\n\r\nAfter this flow, your `flink.max-committed-checkpoint-id` will be set to correct `checkpointId` .","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769952948/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769957065","html_url":"https://github.com/apache/iceberg/pull/2170#issuecomment-769957065","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2170","id":769957065,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTk1NzA2NQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T17:58:22Z","updated_at":"2021-01-29T17:58:22Z","author_association":"CONTRIBUTOR","body":"Merged. Thank you for fixing this, @wypoon! And thanks for the review, @steveloughran!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769957065/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769967215","html_url":"https://github.com/apache/iceberg/issues/2176#issuecomment-769967215","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2176","id":769967215,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTk2NzIxNQ==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T18:17:30Z","updated_at":"2021-01-29T18:17:30Z","author_association":"CONTRIBUTOR","body":"You are using hive catalog for your `spark_catalog` catalog, and hadoop catalog for your `local` catalog.\r\n\r\nFor hive catalog, you need to also specify the `uri` config, and you also need `warehouse` config:\r\n\r\n```\r\n.config(\"spark.sql.catalog.spark_catalog\", \"org.apache.iceberg.spark.SparkSessionCatalog\")\r\n.config(\"spark.sql.catalog.spark_catalog.type\", \"hive\")\r\n.config(\"spark.sql.catalog.spark_catalog.uri\", \"https://my.hive.cluster.com:9083\")\r\n.config(\"spark.sql.catalog.spark_catalog.warehouse\", \"/warehouse\")\r\n```\r\n\r\nCombine with Russell's answer, the complete config should be:\r\n\r\n```java\r\n.config(\"spark.sql.catalog.spark_catalog\", \"org.apache.iceberg.spark.SparkSessionCatalog\")\r\n.config(\"spark.sql.catalog.spark_catalog.type\", \"hive\")\r\n.config(\"spark.sql.catalog.spark_catalog.uri\", \"https://my.hive.ip.com:9083\")\r\n.config(\"spark.sql.catalog.spark_catalog.warehouse\", \"/warehouse-hive\") // I use a different path here to distinguish the two catalogs\r\n.config(\"spark.sql.catalog.local\", \"org.apache.iceberg.spark.SparkSessionCatalog\")\r\n.config(\"spark.sql.catalog.local.type\", \"hadoop\")\r\n.config(\"spark.sql.catalog.local.warehouse\", \"/warehouse\")\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769967215/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769967574","html_url":"https://github.com/apache/iceberg/issues/2169#issuecomment-769967574","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2169","id":769967574,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTk2NzU3NA==","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T18:18:12Z","updated_at":"2021-01-29T18:18:12Z","author_association":"CONTRIBUTOR","body":"A [fix](https://github.com/apache/iceberg/pull/2170) has been merged.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/769967574/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770026006","html_url":"https://github.com/apache/iceberg/pull/2109#issuecomment-770026006","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2109","id":770026006,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MDAyNjAwNg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T20:14:38Z","updated_at":"2021-01-29T20:14:38Z","author_association":"CONTRIBUTOR","body":"A callback sounds complicated and seems to tie too much of the back-end together. I wouldn't want Something plugged into the Iceberg component talking to Kafka directly. That sounds like we're trying to work around a framework limitation.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770026006/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770053775","html_url":"https://github.com/apache/iceberg/pull/2185#issuecomment-770053775","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2185","id":770053775,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MDA1Mzc3NQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T21:15:04Z","updated_at":"2021-01-29T21:15:04Z","author_association":"CONTRIBUTOR","body":"cc @dilipbiswal @rdblue ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770053775/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770062242","html_url":"https://github.com/apache/iceberg/pull/2180#issuecomment-770062242","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2180","id":770062242,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MDA2MjI0Mg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T21:33:52Z","updated_at":"2021-01-29T21:33:52Z","author_association":"CONTRIBUTOR","body":"> Or even better can we make the tests/code resilient to changes in pool size?\r\n\r\nThe simplest solution is to increase the max number of connections in the test metastore but we decided not to do so that we can catch any potential connection leaks (it did help a couple of times).\r\n\r\n> I wonder if we should change HiveClientPool to use the default too?\r\n\r\nWell, I am not sure we should default `HiveClientPool` with values from `CatalogProperties` as the pool does not technically belong to the catalog. That said, I think we should fix `HiveCatalog` constructor that just accepts a Hadoop conf. Also, I would remove the constructor from `HiveClientPool` that does not accept the pool size (it is package private and only used in one place I am suggesting to update). That way, we ensure `HiveCatalog` will always set a correct default pool size.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770062242/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770062383","html_url":"https://github.com/apache/iceberg/pull/2180#issuecomment-770062383","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2180","id":770062383,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MDA2MjM4Mw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T21:34:11Z","updated_at":"2021-01-29T21:34:11Z","author_association":"CONTRIBUTOR","body":"What do you think, @rymurr?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770062383/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770064458","html_url":"https://github.com/apache/iceberg/pull/2180#issuecomment-770064458","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2180","id":770064458,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MDA2NDQ1OA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T21:38:51Z","updated_at":"2021-01-29T21:38:51Z","author_association":"CONTRIBUTOR","body":"@pvary, could you elaborate a bit more? I am not sure I got it. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770064458/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770066258","html_url":"https://github.com/apache/iceberg/pull/2180#issuecomment-770066258","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2180","id":770066258,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MDA2NjI1OA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T21:43:09Z","updated_at":"2021-01-29T21:43:09Z","author_association":"CONTRIBUTOR","body":"> I think the main difference is that HiveCatalogs uses an internal CATALOG_CACHE so if you try to get the Catalog for the same URI multiple times you will get back the same instance\r\n\r\nI don't think that the changes to 2.4 apply to this path. In Spark 3, catalog instances have always been created once per session and are managed by Spark. Spark is the catalog \"caching\" in this case, and this hasn't changed because it doesn't go through the `IcebergSource`.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770066258/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770067647","html_url":"https://github.com/apache/iceberg/issues/2033#issuecomment-770067647","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2033","id":770067647,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MDA2NzY0Nw==","user":{"login":"elkhand","id":4366998,"node_id":"MDQ6VXNlcjQzNjY5OTg=","avatar_url":"https://avatars.githubusercontent.com/u/4366998?v=4","gravatar_id":"","url":"https://api.github.com/users/elkhand","html_url":"https://github.com/elkhand","followers_url":"https://api.github.com/users/elkhand/followers","following_url":"https://api.github.com/users/elkhand/following{/other_user}","gists_url":"https://api.github.com/users/elkhand/gists{/gist_id}","starred_url":"https://api.github.com/users/elkhand/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elkhand/subscriptions","organizations_url":"https://api.github.com/users/elkhand/orgs","repos_url":"https://api.github.com/users/elkhand/repos","events_url":"https://api.github.com/users/elkhand/events{/privacy}","received_events_url":"https://api.github.com/users/elkhand/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T21:46:39Z","updated_at":"2021-01-29T21:46:39Z","author_association":"CONTRIBUTOR","body":"Verified with @RussellSpitzer (thanks!):\r\n\r\nYou do not need to fix values of `flink.max-committed-checkpoint-id` in existing Iceberg metadata files either. You should be safe going forward: Flink/Presto/HMS/ Spark/Other engine should not be impacted by the wrong value (`Long.MAX_VALUE`) of `flink.max-committed-checkpoint-id` field.\r\n\r\nIf you follow the above mentioned alternative flow, Flink will also **not** be impacted by the wrong value in Iceberg metadata files.\r\n\r\n> Snapshot Summary is used as a way to store engine/platform specific metadata which a user may need to know about and which some engines use for their own record keeping.\r\n> The Flink property above is only referenced to (written or read) by Flinkâ€™s IcbergFileComitter so there is no impact on any other system.\r\n> There should be no issue with this property having a wrong value for any system other than Flink.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770067647/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770080267","html_url":"https://github.com/apache/iceberg/pull/2165#issuecomment-770080267","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2165","id":770080267,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MDA4MDI2Nw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T22:17:38Z","updated_at":"2021-01-29T22:17:38Z","author_association":"CONTRIBUTOR","body":"Thanks for reviewing, @rdblue!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770080267/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770082975","html_url":"https://github.com/apache/iceberg/issues/1439#issuecomment-770082975","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1439","id":770082975,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MDA4Mjk3NQ==","user":{"login":"ismailsimsek","id":6005685,"node_id":"MDQ6VXNlcjYwMDU2ODU=","avatar_url":"https://avatars.githubusercontent.com/u/6005685?v=4","gravatar_id":"","url":"https://api.github.com/users/ismailsimsek","html_url":"https://github.com/ismailsimsek","followers_url":"https://api.github.com/users/ismailsimsek/followers","following_url":"https://api.github.com/users/ismailsimsek/following{/other_user}","gists_url":"https://api.github.com/users/ismailsimsek/gists{/gist_id}","starred_url":"https://api.github.com/users/ismailsimsek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ismailsimsek/subscriptions","organizations_url":"https://api.github.com/users/ismailsimsek/orgs","repos_url":"https://api.github.com/users/ismailsimsek/repos","events_url":"https://api.github.com/users/ismailsimsek/events{/privacy}","received_events_url":"https://api.github.com/users/ismailsimsek/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T22:25:26Z","updated_at":"2021-01-29T22:25:26Z","author_association":"CONTRIBUTOR","body":"@it-sceptic this is now possible with [MERGE INTO](https://iceberg.apache.org/spark-writes/#merge-into) feature (iceberg release 0.11.0)\r\n\r\nyou can find [scd2 example here](https://github.com/ismailsimsek/iceberg-examples/blob/master/src/main/java/IcebergSCD2.java)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770082975/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770091743","html_url":"https://github.com/apache/iceberg/pull/2185#issuecomment-770091743","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2185","id":770091743,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MDA5MTc0Mw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T22:51:33Z","updated_at":"2021-01-29T22:51:33Z","author_association":"CONTRIBUTOR","body":"Thanks for reviewing, @rdblue!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770091743/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770097333","html_url":"https://github.com/apache/iceberg/pull/2110#issuecomment-770097333","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2110","id":770097333,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MDA5NzMzMw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T23:08:19Z","updated_at":"2021-01-29T23:08:19Z","author_association":"CONTRIBUTOR","body":"Why does this need to add Calcite dependencies?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770097333/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770097567","html_url":"https://github.com/apache/iceberg/pull/2084#issuecomment-770097567","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2084","id":770097567,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MDA5NzU2Nw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T23:09:00Z","updated_at":"2021-01-29T23:09:00Z","author_association":"CONTRIBUTOR","body":"@Fokko, could you rebase this? Now that 0.11.0 is out, we can get it into master.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770097567/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770098249","html_url":"https://github.com/apache/iceberg/pull/2087#issuecomment-770098249","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2087","id":770098249,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MDA5ODI0OQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T23:11:28Z","updated_at":"2021-01-29T23:11:28Z","author_association":"CONTRIBUTOR","body":"@aokolnychyi and @RussellSpitzer, can you take another look? Is this ready to merge?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770098249/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770099712","html_url":"https://github.com/apache/iceberg/pull/2087#issuecomment-770099712","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2087","id":770099712,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MDA5OTcxMg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T23:16:19Z","updated_at":"2021-01-29T23:16:19Z","author_association":"CONTRIBUTOR","body":"I will do another pass today. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770099712/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770100489","html_url":"https://github.com/apache/iceberg/pull/2092#issuecomment-770100489","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2092","id":770100489,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MDEwMDQ4OQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T23:18:53Z","updated_at":"2021-01-29T23:18:53Z","author_association":"CONTRIBUTOR","body":"Thanks for updating this, @XuQianJin-Stars. I think the implementation looks good now. We just need to fix up the tests. Thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770100489/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770110233","html_url":"https://github.com/apache/iceberg/pull/2089#issuecomment-770110233","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2089","id":770110233,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MDExMDIzMw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-29T23:53:18Z","updated_at":"2021-01-29T23:53:18Z","author_association":"CONTRIBUTOR","body":"Thank you, @jun-he! I think there are few main improvements needed:\r\n1. We should use `lastAssignedPartitionId` instead of `lastAssignedFieldId` in all cases to be more specific\r\n2. For a table replace, we need to reassign the partition field IDs and reuse any existing IDs for equivalent fields\r\n3. We need to update the spec doc\r\n\r\nWe can do all 3 in this PR, or just the first one if you prefer to separate them. Just let me know.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770110233/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770119089","html_url":"https://github.com/apache/iceberg/pull/2087#issuecomment-770119089","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2087","id":770119089,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MDExOTA4OQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-30T00:28:07Z","updated_at":"2021-01-30T00:28:07Z","author_association":"CONTRIBUTOR","body":"I just realized Russell had already given his approval 15 days ago. Since it was open for a while and all comments seem to be resolved, I'll merge it.\r\n\r\nThanks, @karuppayya!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770119089/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770148349","html_url":"https://github.com/apache/iceberg/issues/1626#issuecomment-770148349","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1626","id":770148349,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MDE0ODM0OQ==","user":{"login":"tweise","id":263695,"node_id":"MDQ6VXNlcjI2MzY5NQ==","avatar_url":"https://avatars.githubusercontent.com/u/263695?v=4","gravatar_id":"","url":"https://api.github.com/users/tweise","html_url":"https://github.com/tweise","followers_url":"https://api.github.com/users/tweise/followers","following_url":"https://api.github.com/users/tweise/following{/other_user}","gists_url":"https://api.github.com/users/tweise/gists{/gist_id}","starred_url":"https://api.github.com/users/tweise/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tweise/subscriptions","organizations_url":"https://api.github.com/users/tweise/orgs","repos_url":"https://api.github.com/users/tweise/repos","events_url":"https://api.github.com/users/tweise/events{/privacy}","received_events_url":"https://api.github.com/users/tweise/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-30T03:27:01Z","updated_at":"2021-01-30T03:27:01Z","author_association":"NONE","body":"https://github.com/apache/iceberg/pull/2105\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770148349/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770245760","html_url":"https://github.com/apache/iceberg/pull/2089#issuecomment-770245760","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2089","id":770245760,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MDI0NTc2MA==","user":{"login":"jun-he","id":12246263,"node_id":"MDQ6VXNlcjEyMjQ2MjYz","avatar_url":"https://avatars.githubusercontent.com/u/12246263?v=4","gravatar_id":"","url":"https://api.github.com/users/jun-he","html_url":"https://github.com/jun-he","followers_url":"https://api.github.com/users/jun-he/followers","following_url":"https://api.github.com/users/jun-he/following{/other_user}","gists_url":"https://api.github.com/users/jun-he/gists{/gist_id}","starred_url":"https://api.github.com/users/jun-he/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jun-he/subscriptions","organizations_url":"https://api.github.com/users/jun-he/orgs","repos_url":"https://api.github.com/users/jun-he/repos","events_url":"https://api.github.com/users/jun-he/events{/privacy}","received_events_url":"https://api.github.com/users/jun-he/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-30T17:13:03Z","updated_at":"2021-01-30T17:13:03Z","author_association":"COLLABORATOR","body":"@rdblue  thanks for the comments. Updated the PR with the renamed field. I will send separate PRs for item 2 and 3. Thanks.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770245760/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770264707","html_url":"https://github.com/apache/iceberg/pull/2186#issuecomment-770264707","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2186","id":770264707,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MDI2NDcwNw==","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-30T19:02:09Z","updated_at":"2021-01-30T19:02:09Z","author_association":"CONTRIBUTOR","body":"created by accident. meant for my private repo","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770264707/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770272865","html_url":"https://github.com/apache/iceberg/pull/2087#issuecomment-770272865","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2087","id":770272865,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MDI3Mjg2NQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-30T20:03:13Z","updated_at":"2021-01-30T20:03:13Z","author_association":"MEMBER","body":"Ah sorry! I need to fix my alert notifications \n\nSent from my iPhone\n\n> On Jan 29, 2021, at 6:28 PM, Anton Okolnychyi <notifications@github.com> wrote:\n> \n> ï»¿\n> Merged #2087 into master.\n> \n> â€”\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub, or unsubscribe.\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770272865/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770285720","html_url":"https://github.com/apache/iceberg/pull/2089#issuecomment-770285720","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2089","id":770285720,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MDI4NTcyMA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-30T21:49:00Z","updated_at":"2021-01-30T21:49:00Z","author_association":"CONTRIBUTOR","body":"Thanks, @jun-he!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770285720/reactions","total_count":1,"+1":0,"-1":0,"laugh":1,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]