[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1184831320","html_url":"https://github.com/apache/iceberg/pull/5277#issuecomment-1184831320","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5277","id":1184831320,"node_id":"IC_kwDOCW7NX85GnxdY","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-14T19:43:48Z","updated_at":"2022-07-14T19:43:48Z","author_association":"CONTRIBUTOR","body":"For reference, here's the class that pulls in this information at runtime at present: https://github.com/apache/iceberg/blob/90fe0edf1a671095e587a53adeb31cc84d01fb89/api/src/main/java/org/apache/iceberg/IcebergBuild.java#L63-L73","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1184831320/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1185041892","html_url":"https://github.com/apache/iceberg/issues/4168#issuecomment-1185041892","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4168","id":1185041892,"node_id":"IC_kwDOCW7NX85Gok3k","user":{"login":"dramaticlly","id":5961173,"node_id":"MDQ6VXNlcjU5NjExNzM=","avatar_url":"https://avatars.githubusercontent.com/u/5961173?v=4","gravatar_id":"","url":"https://api.github.com/users/dramaticlly","html_url":"https://github.com/dramaticlly","followers_url":"https://api.github.com/users/dramaticlly/followers","following_url":"https://api.github.com/users/dramaticlly/following{/other_user}","gists_url":"https://api.github.com/users/dramaticlly/gists{/gist_id}","starred_url":"https://api.github.com/users/dramaticlly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dramaticlly/subscriptions","organizations_url":"https://api.github.com/users/dramaticlly/orgs","repos_url":"https://api.github.com/users/dramaticlly/repos","events_url":"https://api.github.com/users/dramaticlly/events{/privacy}","received_events_url":"https://api.github.com/users/dramaticlly/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-15T00:12:01Z","updated_at":"2022-07-15T00:12:01Z","author_association":"CONTRIBUTOR","body":"Just want to share another incidence of this happening in the our production Flink application last week. This time we added extra instrumentation and collected more data points, but we still failed to get a reproduce of the issue\r\n\r\n## Setup \r\nIceberg 0.13.0 and Flink 13 with S3 fileIO turned on (default config for MPU size and threshold)\r\n\r\n## Symptom\r\n- Iceberg committed a broken snapshot `3619033567453770968` which track a non-exist data file `00008-0-a771cfe9-b71d-4e84-b784-e3b270b0ff80-00514.parquet` at  2022-07-10 06:15:00.666 PST\r\n- Subsequent read of given partition failed with `FileNotFoundException` because process engine cannot find the problematic data files on S3\r\n\r\n## Mitigation\r\n- Use scripts from iceberg library to \"delete\" the dataFiles, something like\r\n```scala\r\nval table = getIcebergTable(s\"$db_name.$tbl_name\")\r\nval df = spark.sql(s\"select * from iceberg.$db_name.$tbl_name.files\")\r\nval dataf = df.filter(df(\"file_path\") === dataFileOfInterest).persist\r\n\r\nval origDataFileSize=dataf.select(\"file_size_in_bytes\").map(r => r.getLong(0)).collect().head\r\nval origDataFileRecordCount=dataf.select(\"record_count\").map(r => r.getLong(0)).collect().head\r\nval dt = DataFiles.builder(table.spec)\r\n.withPath(dataFileOfInterest)\r\n.withFileSizeInBytes(origDataFileSize)\r\n.withPartitionPath(origPartitionPath)\r\n.withRecordCount(origDataFileRecordCount)\r\n.build()\r\n\r\nval t = table.newTransaction\r\nt.newOverwrite().deleteFile(dt).commit()\r\nt.commitTransaction();\r\n```\r\n- However some of data consumer are using [Spark incremental read](https://iceberg.apache.org/docs/latest/spark-queries/#incremental-read) to get list of appended data files in between snapshots and mitigation above can only help with read from latest snapshot, so there is no easy way for us to fix snapshot `3619033567453770968` but skip processing of this corrupted snapshot, which result in some data loss\r\n\r\n## Some investigation\r\n- We spent some time to collect the requests from AWS side and realized the S3 multipart upload get aborted at 2022-07-10 06:07:01.619 PST, or 8 minutes before snapshot was committed\r\n- The multipart upload abortion was caused by transient error in 1 of the upload-parts like `software.amazon.awssdk.core.exception.SdkClientException: Unable to execute HTTP request: Error writing to server` and all subsequent parts upload failed as expected.\r\n- Initially we are thinking maybe there's some exception gets swallowed so caller of https://github.com/apache/iceberg/blob/master/aws/src/main/java/org/apache/iceberg/aws/s3/S3OutputStream.java might not realize the problem of writing this parquet data files to S3. But we also spent some time in this AWS integration tests https://github.com/apache/iceberg/blob/master/aws/src/integration/java/org/apache/iceberg/aws/s3/TestS3MultipartUpload.java and looks like S3OutputStream behave as expected -> If there's exception in threads to upload part, `java.util.concurrent.CompletionException` will bubble up as expected on `close()`\r\n\r\n## Questions\r\n- Correct expectation of using S3OutputStream? Is it safe to assume that iceberg is ready to commit if all writers can write its data and metadata files to fileIO and writers are close without exception?\r\n- We are curious about call path on how S3OutputStream is wired to IcebergStreamWriter ? (assume this is where commit of list of data files happens), there's a lot of complexity in between and hard to identify the exact caller of S3OutputStream\r\n- What else does community suggest to help root cause the actual problem and prevent it from happening again?\r\n\r\nCC @rdblue @danielcweeks @szehon-ho @jackye1995 @singhpk234 @stevenzwu ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1185041892/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1185042222","html_url":"https://github.com/apache/iceberg/pull/4588#issuecomment-1185042222","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4588","id":1185042222,"node_id":"IC_kwDOCW7NX85Gok8u","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-15T00:12:35Z","updated_at":"2022-07-15T00:12:35Z","author_association":"CONTRIBUTOR","body":"I have been on a break. Just returning to this. I'm rebasing on master since there are conflicts. I'll follow up after that.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1185042222/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1185093323","html_url":"https://github.com/apache/iceberg/pull/5209#issuecomment-1185093323","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5209","id":1185093323,"node_id":"IC_kwDOCW7NX85GoxbL","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-15T02:05:12Z","updated_at":"2022-07-15T02:05:12Z","author_association":"CONTRIBUTOR","body":"> @hililiwei Actually after some more thought I think it may be easier for review if we break the DDL implementations in to separate PRs. Perhaps we could start with Create/Replace Tag in a separate PR? Let me know your thoughts!\r\n\r\nMakes sense, I've split it into Tag and Branch. Please help to take a look  #5281.\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1185093323/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1185183974","html_url":"https://github.com/apache/iceberg/issues/2796#issuecomment-1185183974","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2796","id":1185183974,"node_id":"IC_kwDOCW7NX85GpHjm","user":{"login":"jfz","id":1302547,"node_id":"MDQ6VXNlcjEzMDI1NDc=","avatar_url":"https://avatars.githubusercontent.com/u/1302547?v=4","gravatar_id":"","url":"https://api.github.com/users/jfz","html_url":"https://github.com/jfz","followers_url":"https://api.github.com/users/jfz/followers","following_url":"https://api.github.com/users/jfz/following{/other_user}","gists_url":"https://api.github.com/users/jfz/gists{/gist_id}","starred_url":"https://api.github.com/users/jfz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jfz/subscriptions","organizations_url":"https://api.github.com/users/jfz/orgs","repos_url":"https://api.github.com/users/jfz/repos","events_url":"https://api.github.com/users/jfz/events{/privacy}","received_events_url":"https://api.github.com/users/jfz/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-15T05:18:55Z","updated_at":"2022-07-15T05:20:58Z","author_association":"CONTRIBUTOR","body":"I think I have a fix for this see PR #5282 for details of root cause analysis and steps to reproduce.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1185183974/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1185203831","html_url":"https://github.com/apache/iceberg/pull/4602#issuecomment-1185203831","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4602","id":1185203831,"node_id":"IC_kwDOCW7NX85GpMZ3","user":{"login":"felixYyu","id":3785228,"node_id":"MDQ6VXNlcjM3ODUyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3785228?v=4","gravatar_id":"","url":"https://api.github.com/users/felixYyu","html_url":"https://github.com/felixYyu","followers_url":"https://api.github.com/users/felixYyu/followers","following_url":"https://api.github.com/users/felixYyu/following{/other_user}","gists_url":"https://api.github.com/users/felixYyu/gists{/gist_id}","starred_url":"https://api.github.com/users/felixYyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixYyu/subscriptions","organizations_url":"https://api.github.com/users/felixYyu/orgs","repos_url":"https://api.github.com/users/felixYyu/repos","events_url":"https://api.github.com/users/felixYyu/events{/privacy}","received_events_url":"https://api.github.com/users/felixYyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-15T06:00:07Z","updated_at":"2022-07-15T06:00:07Z","author_association":"CONTRIBUTOR","body":"@rdblue Could you merge this PR?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1185203831/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1185278728","html_url":"https://github.com/apache/iceberg/issues/1422#issuecomment-1185278728","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1422","id":1185278728,"node_id":"IC_kwDOCW7NX85GpesI","user":{"login":"MayankSharma-MS","id":17739025,"node_id":"MDQ6VXNlcjE3NzM5MDI1","avatar_url":"https://avatars.githubusercontent.com/u/17739025?v=4","gravatar_id":"","url":"https://api.github.com/users/MayankSharma-MS","html_url":"https://github.com/MayankSharma-MS","followers_url":"https://api.github.com/users/MayankSharma-MS/followers","following_url":"https://api.github.com/users/MayankSharma-MS/following{/other_user}","gists_url":"https://api.github.com/users/MayankSharma-MS/gists{/gist_id}","starred_url":"https://api.github.com/users/MayankSharma-MS/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MayankSharma-MS/subscriptions","organizations_url":"https://api.github.com/users/MayankSharma-MS/orgs","repos_url":"https://api.github.com/users/MayankSharma-MS/repos","events_url":"https://api.github.com/users/MayankSharma-MS/events{/privacy}","received_events_url":"https://api.github.com/users/MayankSharma-MS/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-15T07:52:53Z","updated_at":"2022-07-15T07:52:53Z","author_association":"NONE","body":"Hello, i see this is work in progress. Any estimates on when will this be merged to master?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1185278728/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1185280784","html_url":"https://github.com/apache/iceberg/issues/4581#issuecomment-1185280784","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4581","id":1185280784,"node_id":"IC_kwDOCW7NX85GpfMQ","user":{"login":"wobrycki","id":84959736,"node_id":"MDQ6VXNlcjg0OTU5NzM2","avatar_url":"https://avatars.githubusercontent.com/u/84959736?v=4","gravatar_id":"","url":"https://api.github.com/users/wobrycki","html_url":"https://github.com/wobrycki","followers_url":"https://api.github.com/users/wobrycki/followers","following_url":"https://api.github.com/users/wobrycki/following{/other_user}","gists_url":"https://api.github.com/users/wobrycki/gists{/gist_id}","starred_url":"https://api.github.com/users/wobrycki/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wobrycki/subscriptions","organizations_url":"https://api.github.com/users/wobrycki/orgs","repos_url":"https://api.github.com/users/wobrycki/repos","events_url":"https://api.github.com/users/wobrycki/events{/privacy}","received_events_url":"https://api.github.com/users/wobrycki/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-15T07:55:41Z","updated_at":"2022-07-15T07:55:41Z","author_association":"NONE","body":"Hi @RussellSpitzer ,\r\n\r\nwhen we want to read a Spark df using iceberg, and this df has UUID column type, \r\nwhile exporting this df to CSV we got an error:\r\n\r\n```\r\npy4j.protocol.Py4JJavaError: An error occurred while calling o669.csv.\r\n: org.apache.spark.SparkException: Job aborted.\r\n        at org.apache.spark.sql.errors.QueryExecutionErrors$.jobAbortedError(QueryExecutionErrors.scala:496)\r\n        at org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:251)\r\n        at org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:186)\r\n(...)\r\n        ... 1 moreCaused by: java.lang.ClassCastException: class [B cannot be cast to class org.apache.spark.unsafe.types.UTF8String ([B is in module java.base of loader 'bootstrap'; org.apache.spa\r\nrk.unsafe.types.UTF8String is in unnamed module of loader 'app')\r\n        at org.apache.spark.sql.catalyst.expressions.BaseGenericInternalRow.getUTF8String(rows.scala:46)\r\n        at org.apache.spark.sql.catalyst.expressions.BaseGenericInternalRow.getUTF8String$(rows.scala:46)\r\n        at org.apache.spark.sql.catalyst.expressions.GenericInternalRow.getUTF8String(rows.scala:195)\r\n        at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)\r\n        at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)\r\n```\r\n\r\nCan this be related to this issue?\r\nWe could reproduce that by having a table with only one column of UUID type.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1185280784/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1185396047","html_url":"https://github.com/apache/iceberg/pull/4325#issuecomment-1185396047","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4325","id":1185396047,"node_id":"IC_kwDOCW7NX85Gp7VP","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-15T10:13:09Z","updated_at":"2022-07-15T10:13:09Z","author_association":"CONTRIBUTOR","body":"hi @RussellSpitzer , could you please take a look when you are available?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1185396047/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1185557923","html_url":"https://github.com/apache/iceberg/pull/5268#issuecomment-1185557923","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5268","id":1185557923,"node_id":"IC_kwDOCW7NX85Gqi2j","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-15T13:40:30Z","updated_at":"2022-07-15T13:40:30Z","author_association":"CONTRIBUTOR","body":"I applied all the review feedback and splitted out the introduction of a `DefaultMetricsContext` and the `Timer` API into https://github.com/apache/iceberg/pull/5286. Once https://github.com/apache/iceberg/pull/5286 is merged, I'll rebase this PR so that it only contains Table Scan related changes","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1185557923/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1185582508","html_url":"https://github.com/apache/iceberg/issues/5174#issuecomment-1185582508","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5174","id":1185582508,"node_id":"IC_kwDOCW7NX85Gqo2s","user":{"login":"naseerscorpio","id":37637323,"node_id":"MDQ6VXNlcjM3NjM3MzIz","avatar_url":"https://avatars.githubusercontent.com/u/37637323?v=4","gravatar_id":"","url":"https://api.github.com/users/naseerscorpio","html_url":"https://github.com/naseerscorpio","followers_url":"https://api.github.com/users/naseerscorpio/followers","following_url":"https://api.github.com/users/naseerscorpio/following{/other_user}","gists_url":"https://api.github.com/users/naseerscorpio/gists{/gist_id}","starred_url":"https://api.github.com/users/naseerscorpio/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/naseerscorpio/subscriptions","organizations_url":"https://api.github.com/users/naseerscorpio/orgs","repos_url":"https://api.github.com/users/naseerscorpio/repos","events_url":"https://api.github.com/users/naseerscorpio/events{/privacy}","received_events_url":"https://api.github.com/users/naseerscorpio/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-15T14:07:22Z","updated_at":"2022-07-15T14:07:22Z","author_association":"NONE","body":"This was due to wrong property I had above: `sparl.sql.extensions`. Correcting that fixed the issue and merge works perfectly. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1185582508/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1185658187","html_url":"https://github.com/apache/iceberg/pull/5277#issuecomment-1185658187","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5277","id":1185658187,"node_id":"IC_kwDOCW7NX85Gq7VL","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-15T15:32:06Z","updated_at":"2022-07-15T15:32:06Z","author_association":"CONTRIBUTOR","body":"Thanks, @singhpk234!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1185658187/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1185662720","html_url":"https://github.com/apache/iceberg/issues/4168#issuecomment-1185662720","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4168","id":1185662720,"node_id":"IC_kwDOCW7NX85Gq8cA","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-15T15:37:30Z","updated_at":"2022-07-15T15:45:30Z","author_association":"CONTRIBUTOR","body":"> Is it safe to assume that iceberg is ready to commit if all writers can write its data and metadata files to fileIO and writers are close without exception?\r\n\r\nYes. That's why I'm surprised that you ended up with corrupt metadata. The complete failure should have caused a task failure that triggered a retry, rather than producing data. My guess is that there is an issue with error handling in the Flink writer that we should look into.\r\n\r\n> We are curious about call path on how S3OutputStream is wired to IcebergStreamWriter?\r\n\r\nWas the table partitioned or not? That will tell us the internal writer that was used.\r\n\r\nSince the multipart upload failed well before the snapshot was committed, my guess is that it happened when rolling a data file in the `RollingFileWriter`. I don't see a way that would get swallowed, but it is a good starting point to check into more. Do you have any stack trace from the logs where the failure happened?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1185662720/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":1},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1185725625","html_url":"https://github.com/apache/iceberg/issues/4168#issuecomment-1185725625","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4168","id":1185725625,"node_id":"IC_kwDOCW7NX85GrLy5","user":{"login":"dramaticlly","id":5961173,"node_id":"MDQ6VXNlcjU5NjExNzM=","avatar_url":"https://avatars.githubusercontent.com/u/5961173?v=4","gravatar_id":"","url":"https://api.github.com/users/dramaticlly","html_url":"https://github.com/dramaticlly","followers_url":"https://api.github.com/users/dramaticlly/followers","following_url":"https://api.github.com/users/dramaticlly/following{/other_user}","gists_url":"https://api.github.com/users/dramaticlly/gists{/gist_id}","starred_url":"https://api.github.com/users/dramaticlly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dramaticlly/subscriptions","organizations_url":"https://api.github.com/users/dramaticlly/orgs","repos_url":"https://api.github.com/users/dramaticlly/repos","events_url":"https://api.github.com/users/dramaticlly/events{/privacy}","received_events_url":"https://api.github.com/users/dramaticlly/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-15T16:53:52Z","updated_at":"2022-07-15T16:53:52Z","author_association":"CONTRIBUTOR","body":"> Was the table partitioned or not? That will tell us the internal writer that was used.\r\n\r\nYes the table is partitioned by date and hour\r\n\r\n> Since the multipart upload failed well before the snapshot was committed, my guess is that it happened when rolling a data file in the RollingFileWriter. I don't see a way that would get swallowed, but it is a good starting point to check into more.\r\n\r\nThanks for the pointer, I will dive into this and check\r\n\r\n\r\n> Do you have any stack trace from the logs where the failure happened?\r\n\r\nSo here's the log from 1st failed UploadPart call\r\n```log\r\n   message: Failed to upload part: UploadPartRequest(Bucket=redactedBucket, ContentLength=33554432, Key=hive/warehouse/redact_prod.db/redact_event_f/data/date=2022-07-10/hour=13/00008-0-a771cfe9-b71d-4e84-b784-e3b270b0ff80-00514.parquet, PartNumber=5, UploadId=7.mWLRQMPhA0n9LjxP1E2oe6yEwXfdrP2k66qzDNzxgg.0usbpYhOGOYFvuNAcauzhgxDZqFnLxKFE68L7N5uNtrxD6Xxww2EFjJ_oiDilnXFq6YR02_SbNPmLpDhd8sxNJXQHwmhJrj.Wd7_cOOjXuicNzH4B56O5XhnM9gwog-)\r\n```\r\n\r\nand corresponding stacktrace\r\n```\r\nexception: { \r\n     exception_class: java.util.concurrent.CompletionException\r\n     exception_message: software.amazon.awssdk.core.exception.SdkClientException: Unable to execute HTTP request: Error writing to server\r\n     stacktrace: java.util.concurrent.CompletionException: software.amazon.awssdk.core.exception.SdkClientException: Unable to execute HTTP request: Error writing to server\r\n\tat java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:314)\r\n\tat java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:319)\r\n\tat java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1702)\r\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)\r\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)\r\n\tat java.base/java.lang.Thread.run(Thread.java:829)\r\nCaused by: software.amazon.awssdk.core.exception.SdkClientException: Unable to execute HTTP request: Error writing to server\r\n\tat software.amazon.awssdk.core.exception.SdkClientException$BuilderImpl.build(SdkClientException.java:98)\r\n\tat software.amazon.awssdk.core.exception.SdkClientException.create(SdkClientException.java:43)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.stages.utils.RetryableStageHelper.setLastException(RetryableStageHelper.java:205)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.stages.RetryableStage.execute(RetryableStage.java:66)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.stages.RetryableStage.execute(RetryableStage.java:34)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.RequestPipelineBuilder$ComposingRequestPipelineStage.execute(RequestPipelineBuilder.java:206)\r\n\tat software.amazon.awssdk.core.internal.http.StreamManagingStage.execute(StreamManagingStage.java:56)\r\n\tat software.amazon.awssdk.core.internal.http.StreamManagingStage.execute(StreamManagingStage.java:36)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.stages.ApiCallTimeoutTrackingStage.executeWithTimer(ApiCallTimeoutTrackingStage.java:80)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.stages.ApiCallTimeoutTrackingStage.execute(ApiCallTimeoutTrackingStage.java:60)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.stages.ApiCallTimeoutTrackingStage.execute(ApiCallTimeoutTrackingStage.java:42)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.stages.ApiCallMetricCollectionStage.execute(ApiCallMetricCollectionStage.java:48)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.stages.ApiCallMetricCollectionStage.execute(ApiCallMetricCollectionStage.java:31)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.RequestPipelineBuilder$ComposingRequestPipelineStage.execute(RequestPipelineBuilder.java:206)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.RequestPipelineBuilder$ComposingRequestPipelineStage.execute(RequestPipelineBuilder.java:206)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.stages.ExecutionFailureExceptionReportingStage.execute(ExecutionFailureExceptionReportingStage.java:37)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.stages.ExecutionFailureExceptionReportingStage.execute(ExecutionFailureExceptionReportingStage.java:26)\r\n\tat software.amazon.awssdk.core.internal.http.AmazonSyncHttpClient$RequestExecutionBuilderImpl.execute(AmazonSyncHttpClient.java:193)\r\n\tat software.amazon.awssdk.core.internal.handler.BaseSyncClientHandler.invoke(BaseSyncClientHandler.java:133)\r\n\tat software.amazon.awssdk.core.internal.handler.BaseSyncClientHandler.doExecute(BaseSyncClientHandler.java:159)\r\n\tat software.amazon.awssdk.core.internal.handler.BaseSyncClientHandler.lambda$execute$1(BaseSyncClientHandler.java:112)\r\n\tat software.amazon.awssdk.core.internal.handler.BaseSyncClientHandler.measureApiCallSuccess(BaseSyncClientHandler.java:167)\r\n\tat software.amazon.awssdk.core.internal.handler.BaseSyncClientHandler.execute(BaseSyncClientHandler.java:94)\r\n\tat software.amazon.awssdk.core.client.handler.SdkSyncClientHandler.execute(SdkSyncClientHandler.java:45)\r\n\tat software.amazon.awssdk.awscore.client.handler.AwsSyncClientHandler.execute(AwsSyncClientHandler.java:55)\r\n\tat software.amazon.awssdk.services.s3.DefaultS3Client.uploadPart(DefaultS3Client.java:9609)\r\n\tat org.apache.iceberg.aws.s3.S3OutputStream.lambda$uploadParts$2(S3OutputStream.java:308)\r\n\tat java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)\r\n\t... 3 more\r\nCaused by: java.io.IOException: Error writing to server\r\n\tat java.base/sun.net.www.protocol.http.HttpURLConnection.writeRequests(HttpURLConnection.java:718)\r\n\tat java.base/sun.net.www.protocol.http.HttpURLConnection.writeRequests(HttpURLConnection.java:730)\r\n\tat java.base/sun.net.www.protocol.http.HttpURLConnection.getInputStream0(HttpURLConnection.java:1613)\r\n\tat java.base/sun.net.www.protocol.http.HttpURLConnection.getInputStream(HttpURLConnection.java:1520)\r\n\tat java.base/java.net.HttpURLConnection.getResponseCode(HttpURLConnection.java:527)\r\n\tat java.base/sun.net.www.protocol.https.HttpsURLConnectionImpl.getResponseCode(HttpsURLConnectionImpl.java:334)\r\n\tat software.amazon.awssdk.http.urlconnection.UrlConnectionHttpClient$RequestCallable.call(UrlConnectionHttpClient.java:210)\r\n\tat software.amazon.awssdk.http.urlconnection.UrlConnectionHttpClient$RequestCallable.call(UrlConnectionHttpClient.java:193)\r\n\tat software.amazon.awssdk.core.internal.util.MetricUtils.measureDurationUnsafe(MetricUtils.java:64)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.stages.MakeHttpRequestStage.executeHttpRequest(MakeHttpRequestStage.java:76)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.stages.MakeHttpRequestStage.execute(MakeHttpRequestStage.java:55)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.stages.MakeHttpRequestStage.execute(MakeHttpRequestStage.java:39)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.RequestPipelineBuilder$ComposingRequestPipelineStage.execute(RequestPipelineBuilder.java:206)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.RequestPipelineBuilder$ComposingRequestPipelineStage.execute(RequestPipelineBuilder.java:206)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.RequestPipelineBuilder$ComposingRequestPipelineStage.execute(RequestPipelineBuilder.java:206)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.RequestPipelineBuilder$ComposingRequestPipelineStage.execute(RequestPipelineBuilder.java:206)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.stages.ApiCallAttemptTimeoutTrackingStage.execute(ApiCallAttemptTimeoutTrackingStage.java:73)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.stages.ApiCallAttemptTimeoutTrackingStage.execute(ApiCallAttemptTimeoutTrackingStage.java:42)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.stages.TimeoutExceptionHandlingStage.execute(TimeoutExceptionHandlingStage.java:77)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.stages.TimeoutExceptionHandlingStage.execute(TimeoutExceptionHandlingStage.java:39)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.stages.ApiCallAttemptMetricCollectionStage.execute(ApiCallAttemptMetricCollectionStage.java:50)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.stages.ApiCallAttemptMetricCollectionStage.execute(ApiCallAttemptMetricCollectionStage.java:36)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.stages.RetryableStage.execute(RetryableStage.java:64)\r\n\t... 27 more\r\n\r\n   }\r\n```\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1185725625/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1185729663","html_url":"https://github.com/apache/iceberg/issues/5279#issuecomment-1185729663","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5279","id":1185729663,"node_id":"IC_kwDOCW7NX85GrMx_","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-15T16:58:47Z","updated_at":"2022-07-15T16:58:47Z","author_association":"CONTRIBUTOR","body":"Hi Puchneg! Thanks for your interest in this area.  Do you mind clarifying the desired behavior \"Support tagging snapshot during snapshot generation\"? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1185729663/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1185732995","html_url":"https://github.com/apache/iceberg/issues/5279#issuecomment-1185732995","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5279","id":1185732995,"node_id":"IC_kwDOCW7NX85GrNmD","user":{"login":"puchengy","id":8072956,"node_id":"MDQ6VXNlcjgwNzI5NTY=","avatar_url":"https://avatars.githubusercontent.com/u/8072956?v=4","gravatar_id":"","url":"https://api.github.com/users/puchengy","html_url":"https://github.com/puchengy","followers_url":"https://api.github.com/users/puchengy/followers","following_url":"https://api.github.com/users/puchengy/following{/other_user}","gists_url":"https://api.github.com/users/puchengy/gists{/gist_id}","starred_url":"https://api.github.com/users/puchengy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/puchengy/subscriptions","organizations_url":"https://api.github.com/users/puchengy/orgs","repos_url":"https://api.github.com/users/puchengy/repos","events_url":"https://api.github.com/users/puchengy/events{/privacy}","received_events_url":"https://api.github.com/users/puchengy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-15T17:03:18Z","updated_at":"2022-07-15T17:03:18Z","author_association":"CONTRIBUTOR","body":"@amogh-jahagirdar Hi thanks for following up. I am hoping to set a tag in a SparkSQL query via session property similar to \"wap.id\". After finish write, I hope to see this tag in the snapshot summary so that I can find out the corresponding snapshot id by querying the snapshot history.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1185732995/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1185766609","html_url":"https://github.com/apache/iceberg/issues/4168#issuecomment-1185766609","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4168","id":1185766609,"node_id":"IC_kwDOCW7NX85GrVzR","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-15T17:47:50Z","updated_at":"2022-07-15T17:47:50Z","author_association":"CONTRIBUTOR","body":"Looks like one problem is that the exception is [logged but not rethrown in the async future](https://github.com/apache/iceberg/blob/master/aws/src/main/java/org/apache/iceberg/aws/s3/S3OutputStream.java#L309-L318). Because no exception is thrown, the call to `CompleteableFuture::join` in `completeMultipartUpload` succeeds and should return `null` for that part.\r\n\r\nI would expect `completeMultipartUpload` to also fail because it tries to sort the parts (with at least one null part) by `CompletedPart::partNumber`. So there should be another failure somewhere.\r\n\r\nThis may be slightly incorrect since it looks like the thread pool executor is actually handling the exception (which is why the trace goes up to `ThreadPoolExecutor`.\r\n\r\nEither way, it looks like some exception should cause close to fail, but that is apparently ignored since the writer creates metadata for the file.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1185766609/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1185788683","html_url":"https://github.com/apache/iceberg/pull/5274#issuecomment-1185788683","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5274","id":1185788683,"node_id":"IC_kwDOCW7NX85GrbML","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-15T18:19:06Z","updated_at":"2022-07-15T18:19:06Z","author_association":"COLLABORATOR","body":"Merged, thanks @huaxingao @kbendick @bryanck for the quick turnaround!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1185788683/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1185791575","html_url":"https://github.com/apache/iceberg/pull/5274#issuecomment-1185791575","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5274","id":1185791575,"node_id":"IC_kwDOCW7NX85Grb5X","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-15T18:23:12Z","updated_at":"2022-07-15T18:23:12Z","author_association":"CONTRIBUTOR","body":"Thank you all very much! @szehon-ho @kbendick @bryanck ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1185791575/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1185805285","html_url":"https://github.com/apache/iceberg/issues/4581#issuecomment-1185805285","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4581","id":1185805285,"node_id":"IC_kwDOCW7NX85GrfPl","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-15T18:34:08Z","updated_at":"2022-07-15T18:34:08Z","author_association":"MEMBER","body":"Yep, currently the Spark code cannot read or write UUID correctly.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1185805285/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":1,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1185805540","html_url":"https://github.com/apache/iceberg/issues/4168#issuecomment-1185805540","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4168","id":1185805540,"node_id":"IC_kwDOCW7NX85GrfTk","user":{"login":"dramaticlly","id":5961173,"node_id":"MDQ6VXNlcjU5NjExNzM=","avatar_url":"https://avatars.githubusercontent.com/u/5961173?v=4","gravatar_id":"","url":"https://api.github.com/users/dramaticlly","html_url":"https://github.com/dramaticlly","followers_url":"https://api.github.com/users/dramaticlly/followers","following_url":"https://api.github.com/users/dramaticlly/following{/other_user}","gists_url":"https://api.github.com/users/dramaticlly/gists{/gist_id}","starred_url":"https://api.github.com/users/dramaticlly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dramaticlly/subscriptions","organizations_url":"https://api.github.com/users/dramaticlly/orgs","repos_url":"https://api.github.com/users/dramaticlly/repos","events_url":"https://api.github.com/users/dramaticlly/events{/privacy}","received_events_url":"https://api.github.com/users/dramaticlly/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-15T18:34:34Z","updated_at":"2022-07-15T18:34:34Z","author_association":"CONTRIBUTOR","body":">Looks like one problem is that the exception is [logged but not rethrown in the async future](https://github.com/apache/iceberg/blob/master/aws/src/main/java/org/apache/iceberg/aws/s3/S3OutputStream.java#L309-L318). Because no exception is thrown, the call to CompleteableFuture::join in completeMultipartUpload succeeds and should return null for that part.\r\n\r\nYes @rdblue and I think we also observed that, and align with what @danielcweeks suggested earlier in https://github.com/apache/iceberg/issues/4168#issuecomment-1123000990. I think rethrow after logging is desired, but subsequent multi-part uploads will also fail due to previous abort. We also attempted to reproduce abort MPU in integration tests , verified we can assert thrown exceptions on close.\r\n\r\n> Either way, it looks like some exception should cause close to fail, but that is apparently ignored since the writer creates metadata for the file.\r\n\r\nyep I think if there's any suggestion/pointers can help us understand why this is happening, it would be of tremendous help. Today we are seeing 3 more occurrence of this happening, some is related to flink TM out of memory/heap issue and somes are not, so have to disable S3FileIO for flink before this is root caused and prevention is in-place. On the other side, we have turned S3FileIO on for Spark for months now but never see any issue of similar kind.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1185805540/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1185805672","html_url":"https://github.com/apache/iceberg/issues/1422#issuecomment-1185805672","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1422","id":1185805672,"node_id":"IC_kwDOCW7NX85GrfVo","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-15T18:34:45Z","updated_at":"2022-07-15T18:34:45Z","author_association":"MEMBER","body":"It is very out of date, we never went forward with finishing it, so my current estimate would be the far future :)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1185805672/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1185848975","html_url":"https://github.com/apache/iceberg/pull/5282#issuecomment-1185848975","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5282","id":1185848975,"node_id":"IC_kwDOCW7NX85Grp6P","user":{"login":"jfz","id":1302547,"node_id":"MDQ6VXNlcjEzMDI1NDc=","avatar_url":"https://avatars.githubusercontent.com/u/1302547?v=4","gravatar_id":"","url":"https://api.github.com/users/jfz","html_url":"https://github.com/jfz","followers_url":"https://api.github.com/users/jfz/followers","following_url":"https://api.github.com/users/jfz/following{/other_user}","gists_url":"https://api.github.com/users/jfz/gists{/gist_id}","starred_url":"https://api.github.com/users/jfz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jfz/subscriptions","organizations_url":"https://api.github.com/users/jfz/orgs","repos_url":"https://api.github.com/users/jfz/repos","events_url":"https://api.github.com/users/jfz/events{/privacy}","received_events_url":"https://api.github.com/users/jfz/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-15T19:38:07Z","updated_at":"2022-07-15T19:38:07Z","author_association":"CONTRIBUTOR","body":"Another issue with `fromInputStream` is that it disables `close` of the original stream, and user is responsible for closing it outside of AWS SDK. In this particular case I think it's not too bad because SequenceInputStream closes the underlying input streams on iteration, only the BufferedInputStream is not closed but I think the buffer is GCed when this completes. cc @danielcweeks ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1185848975/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1185900996","html_url":"https://github.com/apache/iceberg/pull/4871#issuecomment-1185900996","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4871","id":1185900996,"node_id":"IC_kwDOCW7NX85Gr2nE","user":{"login":"rzhang10","id":75445426,"node_id":"MDQ6VXNlcjc1NDQ1NDI2","avatar_url":"https://avatars.githubusercontent.com/u/75445426?v=4","gravatar_id":"","url":"https://api.github.com/users/rzhang10","html_url":"https://github.com/rzhang10","followers_url":"https://api.github.com/users/rzhang10/followers","following_url":"https://api.github.com/users/rzhang10/following{/other_user}","gists_url":"https://api.github.com/users/rzhang10/gists{/gist_id}","starred_url":"https://api.github.com/users/rzhang10/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rzhang10/subscriptions","organizations_url":"https://api.github.com/users/rzhang10/orgs","repos_url":"https://api.github.com/users/rzhang10/repos","events_url":"https://api.github.com/users/rzhang10/events{/privacy}","received_events_url":"https://api.github.com/users/rzhang10/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-15T20:40:22Z","updated_at":"2022-07-15T20:40:22Z","author_association":"CONTRIBUTOR","body":"Hi @rdblue , I addressed the comments again and updated the spec, could you please take another look?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1185900996/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1186017876","html_url":"https://github.com/apache/iceberg/issues/5279#issuecomment-1186017876","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5279","id":1186017876,"node_id":"IC_kwDOCW7NX85GsTJU","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-15T23:19:10Z","updated_at":"2022-07-15T23:19:10Z","author_association":"CONTRIBUTOR","body":"I see are you looking for specifically accessing it via Snapshot Summary or is it just for the ability to query the snapshot ID from the ref? There's an ongoing [PR](https://github.com/apache/iceberg/pull/4807/files) for the snapshot ref metadata table. Once that gets merged, then the refs table can be queried to determine the corresponding snapshot id for a given tag. \r\n\r\nFor actually creating a tag after the write completes in Spark, I'm working on a change for that, will publish a draft for that soon","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1186017876/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1186054427","html_url":"https://github.com/apache/iceberg/pull/5283#issuecomment-1186054427","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5283","id":1186054427,"node_id":"IC_kwDOCW7NX85GscEb","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-16T01:56:39Z","updated_at":"2022-07-16T01:56:39Z","author_association":"MEMBER","body":"The problem with the test cases is that by default, spark is calling \"DROP TABLE\" SQL, which doesn't purge the data.\r\nBut because warehouse is temp dir, clean-up is happening at the end of each test case automatically.\r\n\r\nNow that hadoop catalog, I am supporting purge = false. So, testcase will not clean the data and getting table exists error.\r\n\r\nAlso, even without the version-hint files,  hadoop catalog prepares version by reading the metadata file name. \r\n\r\nProbably I need to modify test cases to use \"DROP TABLE PURGE\" SQL or stop deriving the version info when the version file doesn't exist( but not sure about the impact)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1186054427/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1186074435","html_url":"https://github.com/apache/iceberg/issues/5279#issuecomment-1186074435","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5279","id":1186074435,"node_id":"IC_kwDOCW7NX85Gsg9D","user":{"login":"puchengy","id":8072956,"node_id":"MDQ6VXNlcjgwNzI5NTY=","avatar_url":"https://avatars.githubusercontent.com/u/8072956?v=4","gravatar_id":"","url":"https://api.github.com/users/puchengy","html_url":"https://github.com/puchengy","followers_url":"https://api.github.com/users/puchengy/followers","following_url":"https://api.github.com/users/puchengy/following{/other_user}","gists_url":"https://api.github.com/users/puchengy/gists{/gist_id}","starred_url":"https://api.github.com/users/puchengy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/puchengy/subscriptions","organizations_url":"https://api.github.com/users/puchengy/orgs","repos_url":"https://api.github.com/users/puchengy/repos","events_url":"https://api.github.com/users/puchengy/events{/privacy}","received_events_url":"https://api.github.com/users/puchengy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-16T02:57:28Z","updated_at":"2022-07-16T02:57:28Z","author_association":"CONTRIBUTOR","body":"@amogh-jahagirdar thank you! it doesn't need to be done via snapshot summary, ref metadata table is fine. For the tag creation via spark write, looking forward to that, thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1186074435/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1186144217","html_url":"https://github.com/apache/iceberg/pull/4325#issuecomment-1186144217","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4325","id":1186144217,"node_id":"IC_kwDOCW7NX85Gsx_Z","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-16T10:21:08Z","updated_at":"2022-07-16T10:21:08Z","author_association":"CONTRIBUTOR","body":"> This looks really close to me, the only issues I think are remaining are\r\n> \r\n> 1. We cannot change any deprecated apis\r\n> 2. Any public apis that are changed need to remain, additional apis can be added and the originals can be deprecated\r\n> 3. I'm not sure about where the Action Constants should go. I think the SparkActionOptions is maybe too general but is probably fine if we document it with some Javadocs. As Is the option is there but there is no way of determining which actions it applies too. Ideally I would have had Migrate + Snapshot inherit from something with the option. It seems like putting it API would probably be too much, but maybe we just add an interface that they both can inherit SparkCreateAction, which has the option as a public field?\r\n\r\nI added some docs to `SparkActionOptions`, and I originally wanted to move all the Spark action options to it (not in this PR). I found that we already have `BaseSparkAction` , maybe we can put these options in it (i'm not sure)?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1186144217/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1186281553","html_url":"https://github.com/apache/iceberg/pull/5288#issuecomment-1186281553","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5288","id":1186281553,"node_id":"IC_kwDOCW7NX85GtThR","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-16T20:11:47Z","updated_at":"2022-07-16T20:11:47Z","author_association":"CONTRIBUTOR","body":"Thanks, @hrishisd! This looks good to me. I'll merge after tests run.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1186281553/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1186482295","html_url":"https://github.com/apache/iceberg/pull/5046#issuecomment-1186482295","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5046","id":1186482295,"node_id":"IC_kwDOCW7NX85GuEh3","user":{"login":"dungdm93","id":6848311,"node_id":"MDQ6VXNlcjY4NDgzMTE=","avatar_url":"https://avatars.githubusercontent.com/u/6848311?v=4","gravatar_id":"","url":"https://api.github.com/users/dungdm93","html_url":"https://github.com/dungdm93","followers_url":"https://api.github.com/users/dungdm93/followers","following_url":"https://api.github.com/users/dungdm93/following{/other_user}","gists_url":"https://api.github.com/users/dungdm93/gists{/gist_id}","starred_url":"https://api.github.com/users/dungdm93/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dungdm93/subscriptions","organizations_url":"https://api.github.com/users/dungdm93/orgs","repos_url":"https://api.github.com/users/dungdm93/repos","events_url":"https://api.github.com/users/dungdm93/events{/privacy}","received_events_url":"https://api.github.com/users/dungdm93/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-17T11:03:20Z","updated_at":"2022-07-17T11:03:20Z","author_association":"CONTRIBUTOR","body":"@[amogh-jahagirdar Currently, I'm see the faction of configurations between services, e.g: `glue`, `kms`, `dynamo` missing the way to set `credentialsProvider`\r\n\r\nWDYT about having common configuration of `endpoint`, `region`, `access-key-id`, `secret-access-key` and `session-token` for all services.\r\n```java\r\nString S3FILEIO_PREFIX = \"s3.\"\r\nString GLUE_PREFIX = \"glue.\"\r\n\r\n/**\r\n* To set S3 region, use s3.region, to set Glue region set glue.region, etc...\r\n**/\r\nString REGION_CONFIG = \"region\"\r\n/**\r\n* To set S3 endpoint, use s3.endpoint, to set Glue region set glue.endpoint, etc...\r\n**/\r\nString ENDPOINT_CONFIG = \"endpoint\"\r\n...\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1186482295/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1186545934","html_url":"https://github.com/apache/iceberg/pull/5270#issuecomment-1186545934","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5270","id":1186545934,"node_id":"IC_kwDOCW7NX85GuUEO","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-17T15:17:12Z","updated_at":"2022-07-17T15:17:12Z","author_association":"MEMBER","body":"Got this merged,  thanks @rdblue for the PR and thanks all for the reviewing!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1186545934/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1186546142","html_url":"https://github.com/apache/iceberg/pull/5262#issuecomment-1186546142","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5262","id":1186546142,"node_id":"IC_kwDOCW7NX85GuUHe","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-17T15:18:27Z","updated_at":"2022-07-17T15:18:27Z","author_association":"MEMBER","body":"Thanks all for the reviewing!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1186546142/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1186579816","html_url":"https://github.com/apache/iceberg/issues/3466#issuecomment-1186579816","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3466","id":1186579816,"node_id":"IC_kwDOCW7NX85GucVo","user":{"login":"lintingbin","id":5699014,"node_id":"MDQ6VXNlcjU2OTkwMTQ=","avatar_url":"https://avatars.githubusercontent.com/u/5699014?v=4","gravatar_id":"","url":"https://api.github.com/users/lintingbin","html_url":"https://github.com/lintingbin","followers_url":"https://api.github.com/users/lintingbin/followers","following_url":"https://api.github.com/users/lintingbin/following{/other_user}","gists_url":"https://api.github.com/users/lintingbin/gists{/gist_id}","starred_url":"https://api.github.com/users/lintingbin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lintingbin/subscriptions","organizations_url":"https://api.github.com/users/lintingbin/orgs","repos_url":"https://api.github.com/users/lintingbin/repos","events_url":"https://api.github.com/users/lintingbin/events{/privacy}","received_events_url":"https://api.github.com/users/lintingbin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-17T17:50:18Z","updated_at":"2022-07-17T17:50:18Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer We have a flink stream writing data to an iceberg table (the table is set to 'commit.manifest-merge.enabled' = 'false'). When I execute a rewrite manifest task in spark, this error comes up quite often, causing the task to fail. Does it mean that 'commit.manifest-merge.enabled' is not taking effect?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1186579816/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1186585236","html_url":"https://github.com/apache/iceberg/issues/5290#issuecomment-1186585236","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5290","id":1186585236,"node_id":"IC_kwDOCW7NX85GudqU","user":{"login":"samredai","id":43911210,"node_id":"MDQ6VXNlcjQzOTExMjEw","avatar_url":"https://avatars.githubusercontent.com/u/43911210?v=4","gravatar_id":"","url":"https://api.github.com/users/samredai","html_url":"https://github.com/samredai","followers_url":"https://api.github.com/users/samredai/followers","following_url":"https://api.github.com/users/samredai/following{/other_user}","gists_url":"https://api.github.com/users/samredai/gists{/gist_id}","starred_url":"https://api.github.com/users/samredai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samredai/subscriptions","organizations_url":"https://api.github.com/users/samredai/orgs","repos_url":"https://api.github.com/users/samredai/repos","events_url":"https://api.github.com/users/samredai/events{/privacy}","received_events_url":"https://api.github.com/users/samredai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-17T18:26:53Z","updated_at":"2022-07-17T18:26:53Z","author_association":"CONTRIBUTOR","body":"@kevinjqliu thanks for your comments and opening this issue! Yes the new theme will provide the experience you're seeing locally where the top nav bar is fixed and the version drop-down is always available.\n\nWe're in the process of deploying the theme to the versioned docs site (each version of the docs site is deployed on its own) so once that's deployed, this will all be live. This should be done within a few days.  ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1186585236/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1186607944","html_url":"https://github.com/apache/iceberg/issues/5290#issuecomment-1186607944","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5290","id":1186607944,"node_id":"IC_kwDOCW7NX85GujNI","user":{"login":"kevinjqliu","id":9057843,"node_id":"MDQ6VXNlcjkwNTc4NDM=","avatar_url":"https://avatars.githubusercontent.com/u/9057843?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinjqliu","html_url":"https://github.com/kevinjqliu","followers_url":"https://api.github.com/users/kevinjqliu/followers","following_url":"https://api.github.com/users/kevinjqliu/following{/other_user}","gists_url":"https://api.github.com/users/kevinjqliu/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinjqliu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinjqliu/subscriptions","organizations_url":"https://api.github.com/users/kevinjqliu/orgs","repos_url":"https://api.github.com/users/kevinjqliu/repos","events_url":"https://api.github.com/users/kevinjqliu/events{/privacy}","received_events_url":"https://api.github.com/users/kevinjqliu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-17T21:11:35Z","updated_at":"2022-07-17T21:11:55Z","author_association":"CONTRIBUTOR","body":"awesome! so this is not a bug. I'll close out the issue. \r\n\r\nIm curious how you were able to make this work across versions. I really like this feature and want to do the same for other projects docs. like for trino https://github.com/trinodb/trino/issues/13205\r\n@samredai ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1186607944/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1186618419","html_url":"https://github.com/apache/iceberg/issues/5290#issuecomment-1186618419","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5290","id":1186618419,"node_id":"IC_kwDOCW7NX85Gulwz","user":{"login":"samredai","id":43911210,"node_id":"MDQ6VXNlcjQzOTExMjEw","avatar_url":"https://avatars.githubusercontent.com/u/43911210?v=4","gravatar_id":"","url":"https://api.github.com/users/samredai","html_url":"https://github.com/samredai","followers_url":"https://api.github.com/users/samredai/followers","following_url":"https://api.github.com/users/samredai/following{/other_user}","gists_url":"https://api.github.com/users/samredai/gists{/gist_id}","starred_url":"https://api.github.com/users/samredai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samredai/subscriptions","organizations_url":"https://api.github.com/users/samredai/orgs","repos_url":"https://api.github.com/users/samredai/repos","events_url":"https://api.github.com/users/samredai/events{/privacy}","received_events_url":"https://api.github.com/users/samredai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-17T22:24:44Z","updated_at":"2022-07-17T22:24:44Z","author_association":"CONTRIBUTOR","body":"@kevinjqliu the magic happens in 3 places really. The versions are defined in the [config.toml](https://github.com/apache/iceberg-docs/blob/main/docs/config.toml#L25-L31) file, that list is used to generate the [drop-down](https://github.com/apache/iceberg-docs/blob/main/iceberg-theme/layouts/partials/version-dropdown.html) in the theme, and then the [deployment CI](https://github.com/apache/iceberg-docs/blob/main/.github/workflows/deploy.yml#L87) deploys the site to a sub-directory named after the branch/version name.\r\n\r\nWe use hugo but I would imagine a similar setup is achievable with most other static site frameworks. Let me know if you want to chat about how to make this work with your deployment setup.  ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1186618419/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1186691222","html_url":"https://github.com/apache/iceberg/issues/5267#issuecomment-1186691222","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5267","id":1186691222,"node_id":"IC_kwDOCW7NX85Gu3iW","user":{"login":"zfno111","id":32893310,"node_id":"MDQ6VXNlcjMyODkzMzEw","avatar_url":"https://avatars.githubusercontent.com/u/32893310?v=4","gravatar_id":"","url":"https://api.github.com/users/zfno111","html_url":"https://github.com/zfno111","followers_url":"https://api.github.com/users/zfno111/followers","following_url":"https://api.github.com/users/zfno111/following{/other_user}","gists_url":"https://api.github.com/users/zfno111/gists{/gist_id}","starred_url":"https://api.github.com/users/zfno111/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zfno111/subscriptions","organizations_url":"https://api.github.com/users/zfno111/orgs","repos_url":"https://api.github.com/users/zfno111/repos","events_url":"https://api.github.com/users/zfno111/events{/privacy}","received_events_url":"https://api.github.com/users/zfno111/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-18T02:10:00Z","updated_at":"2022-07-18T02:10:00Z","author_association":"NONE","body":"**i think i  have use a bad version**","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1186691222/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1186776179","html_url":"https://github.com/apache/iceberg/pull/5284#issuecomment-1186776179","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5284","id":1186776179,"node_id":"IC_kwDOCW7NX85GvMRz","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-18T05:14:35Z","updated_at":"2022-07-18T05:14:35Z","author_association":"MEMBER","body":"> I think this is incorrect.\r\nThis attempts to allow a catalog to use the active session instead of the one that created it, which is not correct.\r\n\r\n@rdblue: I see that other catalogs doesn't support the Dynamic catalog properties. So, the base problem is Nessie supporting configuring reference name dynamically as a spark catalog conf?\r\n\r\nAny suggestion to handle this?\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1186776179/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1186802302","html_url":"https://github.com/apache/iceberg/issues/5163#issuecomment-1186802302","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5163","id":1186802302,"node_id":"IC_kwDOCW7NX85GvSp-","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-18T06:07:07Z","updated_at":"2022-07-18T06:07:07Z","author_association":"CONTRIBUTOR","body":"> We write using hadoop catalog, but need to read from hive catalog for special reasons (for example, we need to create a hive view to read table, hadoop catalog can't create hive view).\r\n\r\n@yabola: It is possible to create Hive external tables where the Catalog is HadoopCatalog. So you can store your Iceberg tables in your desired Iceberg Catalog, and you still can query them from Hive, in the same way as any other table.\r\nSee: https://iceberg.apache.org/docs/latest/hive/#catalog-management\r\n\r\nWould this help in your use case?\r\n\r\nThat said, I still agree with the goal for this issue, but I think we should try to avoid cases where an Iceberg table is registered to multiple Iceberg catalogs.\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1186802302/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1186811858","html_url":"https://github.com/apache/iceberg/pull/5050#issuecomment-1186811858","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5050","id":1186811858,"node_id":"IC_kwDOCW7NX85GvU_S","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-18T06:22:02Z","updated_at":"2022-07-18T06:22:02Z","author_association":"CONTRIBUTOR","body":"cc @rdblue @openinx could you please take a look when you are available?\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1186811858/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1186967649","html_url":"https://github.com/apache/iceberg/pull/5286#issuecomment-1186967649","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5286","id":1186967649,"node_id":"IC_kwDOCW7NX85Gv7Bh","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-18T09:23:04Z","updated_at":"2022-07-18T09:23:04Z","author_association":"CONTRIBUTOR","body":"@rdblue @danielcweeks I believe I addressed all comments, can you guys re-review please?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1186967649/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1187067343","html_url":"https://github.com/apache/iceberg/issues/5163#issuecomment-1187067343","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5163","id":1187067343,"node_id":"IC_kwDOCW7NX85GwTXP","user":{"login":"yabola","id":31469905,"node_id":"MDQ6VXNlcjMxNDY5OTA1","avatar_url":"https://avatars.githubusercontent.com/u/31469905?v=4","gravatar_id":"","url":"https://api.github.com/users/yabola","html_url":"https://github.com/yabola","followers_url":"https://api.github.com/users/yabola/followers","following_url":"https://api.github.com/users/yabola/following{/other_user}","gists_url":"https://api.github.com/users/yabola/gists{/gist_id}","starred_url":"https://api.github.com/users/yabola/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yabola/subscriptions","organizations_url":"https://api.github.com/users/yabola/orgs","repos_url":"https://api.github.com/users/yabola/repos","events_url":"https://api.github.com/users/yabola/events{/privacy}","received_events_url":"https://api.github.com/users/yabola/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-18T10:57:22Z","updated_at":"2022-07-18T10:57:22Z","author_association":"CONTRIBUTOR","body":"@pvary Thanks for your advice. Yes, I can manually create the hive external table, and set the inputFormat to `HiveIcebergInputFormat` and other table properties, hive can access the data.\r\nBut it seems the `registerTable` command (by seting `iceberg.engine.hive.enabled`)seems to be more convenient and stable (it is same as manual creation essentially). \r\nI will create a PR recently for a \"force\" option on `registerTable`.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1187067343/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1187413248","html_url":"https://github.com/apache/iceberg/issues/1766#issuecomment-1187413248","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1766","id":1187413248,"node_id":"IC_kwDOCW7NX85Gxn0A","user":{"login":"bhanuunrivalled","id":4332242,"node_id":"MDQ6VXNlcjQzMzIyNDI=","avatar_url":"https://avatars.githubusercontent.com/u/4332242?v=4","gravatar_id":"","url":"https://api.github.com/users/bhanuunrivalled","html_url":"https://github.com/bhanuunrivalled","followers_url":"https://api.github.com/users/bhanuunrivalled/followers","following_url":"https://api.github.com/users/bhanuunrivalled/following{/other_user}","gists_url":"https://api.github.com/users/bhanuunrivalled/gists{/gist_id}","starred_url":"https://api.github.com/users/bhanuunrivalled/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bhanuunrivalled/subscriptions","organizations_url":"https://api.github.com/users/bhanuunrivalled/orgs","repos_url":"https://api.github.com/users/bhanuunrivalled/repos","events_url":"https://api.github.com/users/bhanuunrivalled/events{/privacy}","received_events_url":"https://api.github.com/users/bhanuunrivalled/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-18T13:21:50Z","updated_at":"2022-07-18T13:21:50Z","author_association":"NONE","body":"HI @jackye1995 ,\r\n\r\nI ran this test case \r\n\r\norg.apache.iceberg.aws.glue.TestGlueCatalogTable#testUpdateTable\r\n\r\n\r\n` @Test\r\n  public void testUpdateTable() {\r\n    String namespace = createNamespace();\r\n    String tableName = getRandomName();\r\n    // current should be null\r\n    TableOperations ops = glueCatalog.newTableOps(TableIdentifier.of(namespace, tableName));\r\n    TableMetadata current = ops.current();\r\n    Assert.assertNull(current);\r\n    // create table, refresh should update\r\n    createTable(namespace, tableName);\r\n    current = ops.refresh();\r\n    Assert.assertEquals(schema.toString(), current.schema().toString());\r\n    Assert.assertEquals(partitionSpec, current.spec());\r\n    Table table = glueCatalog.loadTable(TableIdentifier.of(namespace, tableName));\r\n    Assert.assertTrue(\"initial table history should be empty\", table.history().isEmpty());\r\n    // commit new version, should create a new snapshot\r\n    table = glueCatalog.loadTable(TableIdentifier.of(namespace, tableName));\r\n    DataFile dataFile = DataFiles.builder(partitionSpec)\r\n        .withPath(\"/path/to/data-a.parquet\")\r\n        .withFileSizeInBytes(10)\r\n        .withRecordCount(1)\r\n        .build();\r\n    table.newAppend().appendFile(dataFile).commit();\r\n    table = glueCatalog.loadTable(TableIdentifier.of(namespace, tableName));\r\n    Assert.assertEquals(\"commit should create a new table version\", 1, table.history().size());\r\n    // check table in Glue\r\n    GetTableResponse response = glue.getTable(GetTableRequest.builder()\r\n        .databaseName(namespace).name(tableName).build());\r\n    Assert.assertEquals(\"external table type is set after update\", \"EXTERNAL_TABLE\", response.table().tableType());\r\n    Assert.assertEquals(schema.columns().size(), response.table().storageDescriptor().columns().size());\r\n    Assert.assertEquals(partitionSpec.fields().size(), response.table().partitionKeys().size());\r\n  }`\r\n\r\nat the line \r\n\r\n` table = glueCatalog.loadTable(TableIdentifier.of(namespace, tableName));`\r\n\r\ni added a break point .\r\n\r\n\r\nduring this time I go to athena and query the random table created .\r\n\r\n\r\nbut I get the error ,\r\n\r\n<img width=\"807\" alt=\"image\" src=\"https://user-images.githubusercontent.com/4332242/179520382-fe4b697d-d208-4764-8b94-4e0c5b8e0710.png\">\r\n\r\n\r\nwe want the iceberg table to be queried by Athena . I sent you contact request in Linkedin \r\n\r\npls help \r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1187413248/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1187806334","html_url":"https://github.com/apache/iceberg/pull/5282#issuecomment-1187806334","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5282","id":1187806334,"node_id":"IC_kwDOCW7NX85GzHx-","user":{"login":"holdenk","id":59893,"node_id":"MDQ6VXNlcjU5ODkz","avatar_url":"https://avatars.githubusercontent.com/u/59893?v=4","gravatar_id":"","url":"https://api.github.com/users/holdenk","html_url":"https://github.com/holdenk","followers_url":"https://api.github.com/users/holdenk/followers","following_url":"https://api.github.com/users/holdenk/following{/other_user}","gists_url":"https://api.github.com/users/holdenk/gists{/gist_id}","starred_url":"https://api.github.com/users/holdenk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/holdenk/subscriptions","organizations_url":"https://api.github.com/users/holdenk/orgs","repos_url":"https://api.github.com/users/holdenk/repos","events_url":"https://api.github.com/users/holdenk/events{/privacy}","received_events_url":"https://api.github.com/users/holdenk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-18T17:14:43Z","updated_at":"2022-07-18T17:14:43Z","author_association":"CONTRIBUTOR","body":"Interesting, we've been running into something similar.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1187806334/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1188008043","html_url":"https://github.com/apache/iceberg/issues/5163#issuecomment-1188008043","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5163","id":1188008043,"node_id":"IC_kwDOCW7NX85Gz5Br","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-18T18:10:00Z","updated_at":"2022-07-19T10:00:30Z","author_association":"CONTRIBUTOR","body":"> @pvary Thanks for your advice. Yes, I can manually create the hive external table, and set the inputFormat to `HiveIcebergInputFormat` and other table properties, hive can access the data. But it seems the `registerTable` command (by seting `iceberg.engine.hive.enabled`)seems to be more convenient and stable (it is same as manual creation essentially). I will create a PR recently for a \"force\" option on `registerTable`.\r\n\r\n@yabola: You do not have to manually create a hive external table and set the table properties.\r\nYou can just do the following:\r\n```\r\nSET iceberg.catalog.hadoop_cat.type=hadoop;\r\nSET iceberg.catalog.hadoop_cat.warehouse=hdfs://example.com:8020/hadoop_cat;\r\n\r\nCREATE EXTERNAL TABLE database_a.table_a\r\nSTORED BY 'org.apache.iceberg.mr.hive.HiveIcebergStorageHandler'\r\nTBLPROPERTIES ('iceberg.catalog'='hadoop_cat');\r\n```\r\n\r\nOr if your table names are not matching you can do this:\r\n```\r\nCREATE EXTERNAL TABLE database_a.table_a\r\nSTORED BY 'org.apache.iceberg.mr.hive.HiveIcebergStorageHandler' \r\nLOCATION 'hdfs://some_bucket/some_path/other_table_name'\r\nTBLPROPERTIES ('iceberg.catalog'='location_based_table');\r\n```\r\n\r\nAfter this the `database_a.table_a` will be accessible for Hive, and it could be queried as any normal Hive table.\r\n\r\nI think the main misunderstanding here is that you do not have to use HiveCatalog to query an Iceberg table. You can use whatever Catalog implementation you want to use, and tell the Hive table to use that specific Catalog implementation to access the data/metadata of the table.\r\n\r\nBack to the original question:\r\n- I think the external table approach is better if you want the table in the target catalog to follow the changes of the table in the source catalog. If there is a change committed to the original table, then the queries against the Hive table will immediately reflect the changes.\r\n- OTOH if you want to access a specific snapshot of the table then `registerTable` could be useful. In this case you should make sure that the original catalog will not expire / or remove files used by the tables registered in the HiveCatalog. (I still would prefer to see a feature in Hive for providing a specific snapshotId or metadata file location of a table in table properties, instead of registering a table in HiveCatalog.)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1188008043/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1188008308","html_url":"https://github.com/apache/iceberg/pull/5300#issuecomment-1188008308","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5300","id":1188008308,"node_id":"IC_kwDOCW7NX85Gz5F0","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-18T18:10:04Z","updated_at":"2022-07-18T18:10:04Z","author_association":"CONTRIBUTOR","body":"@flyrain @rdblue @stevenzwu @karuppayya @szehon-ho @RussellSpitzer @anuragmantri ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1188008308/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1188045274","html_url":"https://github.com/apache/iceberg/issues/4168#issuecomment-1188045274","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4168","id":1188045274,"node_id":"IC_kwDOCW7NX85G0CHa","user":{"login":"abmo-x","id":69539469,"node_id":"MDQ6VXNlcjY5NTM5NDY5","avatar_url":"https://avatars.githubusercontent.com/u/69539469?v=4","gravatar_id":"","url":"https://api.github.com/users/abmo-x","html_url":"https://github.com/abmo-x","followers_url":"https://api.github.com/users/abmo-x/followers","following_url":"https://api.github.com/users/abmo-x/following{/other_user}","gists_url":"https://api.github.com/users/abmo-x/gists{/gist_id}","starred_url":"https://api.github.com/users/abmo-x/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/abmo-x/subscriptions","organizations_url":"https://api.github.com/users/abmo-x/orgs","repos_url":"https://api.github.com/users/abmo-x/repos","events_url":"https://api.github.com/users/abmo-x/events{/privacy}","received_events_url":"https://api.github.com/users/abmo-x/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-18T18:19:49Z","updated_at":"2022-07-18T18:34:15Z","author_association":"CONTRIBUTOR","body":"Wanted to also add that we are seeing similar behavior for file which BaseTaskWriter logs as successfully completed and I don't see any errors for s3 upload in the logs around that time frame. \r\n\r\nBut the data file does not exist on S3, but the below log is logged which then adds the data file to the manifest.\r\n\r\n```\r\n  2022-07-15T14:49:35.869+00:00 \r\nlogger_name:  org.apache.iceberg.aws.s3.S3OutputStream \r\n    message:  S3OutputStream initialized with S3_PATH_TO_FILE_THAT_DOESN'T_EXIST\r\n\r\n \r\n2022-07-15T15:04:08.447+00:00 \r\nlogger_name:  org.apache.iceberg.io.BaseTaskWriter \r\nComplete data file GenericDataFile{content=data, file_path=PATH_TO_FILE_THAT_DOESN'T_EXIST file_format=PARQUET, spec_id=0, partition=PartitionData{date=2022-07-15, hour=14}\r\n```\r\n\r\nOur S3 bucket is versioned, no versions exists in s3 for that file. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1188045274/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1188287870","html_url":"https://github.com/apache/iceberg/pull/5301#issuecomment-1188287870","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5301","id":1188287870,"node_id":"IC_kwDOCW7NX85G09V-","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-18T20:40:21Z","updated_at":"2022-07-18T20:40:21Z","author_association":"CONTRIBUTOR","body":"@flyrain @rdblue @stevenzwu @karuppayya @szehon-ho @RussellSpitzer @anuragmantri","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1188287870/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1188320441","html_url":"https://github.com/apache/iceberg/pull/4142#issuecomment-1188320441","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4142","id":1188320441,"node_id":"IC_kwDOCW7NX85G1FS5","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-18T21:17:27Z","updated_at":"2022-07-18T21:17:27Z","author_association":"COLLABORATOR","body":"Thanks @flyrain looks like we can move along then as per https://apache-iceberg.slack.com/archives/C025PH0G1D4/p1657921770288549 (couldnt find Hrishikesh's github handle to tag).  Will wait to see any other concern/comment.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1188320441/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1188327526","html_url":"https://github.com/apache/iceberg/pull/4142#issuecomment-1188327526","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4142","id":1188327526,"node_id":"IC_kwDOCW7NX85G1HBm","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-18T21:25:05Z","updated_at":"2022-07-18T21:25:05Z","author_association":"MEMBER","body":"@szehon-ho I think the suggestion on the discussion thread of providing DOT file output is probably a good one. We should probably at least have that as an option since I think text visualization is still going to be a bit difficult to navigate for tables of moderate size.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1188327526/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1188356748","html_url":"https://github.com/apache/iceberg/pull/5303#issuecomment-1188356748","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5303","id":1188356748,"node_id":"IC_kwDOCW7NX85G1OKM","user":{"login":"samredai","id":43911210,"node_id":"MDQ6VXNlcjQzOTExMjEw","avatar_url":"https://avatars.githubusercontent.com/u/43911210?v=4","gravatar_id":"","url":"https://api.github.com/users/samredai","html_url":"https://github.com/samredai","followers_url":"https://api.github.com/users/samredai/followers","following_url":"https://api.github.com/users/samredai/following{/other_user}","gists_url":"https://api.github.com/users/samredai/gists{/gist_id}","starred_url":"https://api.github.com/users/samredai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samredai/subscriptions","organizations_url":"https://api.github.com/users/samredai/orgs","repos_url":"https://api.github.com/users/samredai/repos","events_url":"https://api.github.com/users/samredai/events{/privacy}","received_events_url":"https://api.github.com/users/samredai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-18T21:51:11Z","updated_at":"2022-07-18T21:51:11Z","author_association":"CONTRIBUTOR","body":"cc: @CircArgs @Fokko @dramaticlly ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1188356748/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1188385120","html_url":"https://github.com/apache/iceberg/pull/4142#issuecomment-1188385120","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4142","id":1188385120,"node_id":"IC_kwDOCW7NX85G1VFg","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-18T22:26:35Z","updated_at":"2022-07-18T22:26:58Z","author_association":"COLLABORATOR","body":"Ah I missed that, yea I guess we can take format as an argument here. (like DOT, or  JSON as @kbendick suggested earlier).\r\n\r\nI guess it'll take some more time then than I have currently.  If someone else wants to take it up, feel free!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1188385120/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1188401258","html_url":"https://github.com/apache/iceberg/pull/5302#issuecomment-1188401258","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5302","id":1188401258,"node_id":"IC_kwDOCW7NX85G1ZBq","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-18T22:45:51Z","updated_at":"2022-07-18T22:45:51Z","author_association":"CONTRIBUTOR","body":"cc @rdblue @aokolnychyi @RussellSpitzer \r\nCould you please take a look when you have time? Thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1188401258/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1188425755","html_url":"https://github.com/apache/iceberg/pull/5299#issuecomment-1188425755","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5299","id":1188425755,"node_id":"IC_kwDOCW7NX85G1fAb","user":{"login":"danielcweeks","id":4925077,"node_id":"MDQ6VXNlcjQ5MjUwNzc=","avatar_url":"https://avatars.githubusercontent.com/u/4925077?v=4","gravatar_id":"","url":"https://api.github.com/users/danielcweeks","html_url":"https://github.com/danielcweeks","followers_url":"https://api.github.com/users/danielcweeks/followers","following_url":"https://api.github.com/users/danielcweeks/following{/other_user}","gists_url":"https://api.github.com/users/danielcweeks/gists{/gist_id}","starred_url":"https://api.github.com/users/danielcweeks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielcweeks/subscriptions","organizations_url":"https://api.github.com/users/danielcweeks/orgs","repos_url":"https://api.github.com/users/danielcweeks/repos","events_url":"https://api.github.com/users/danielcweeks/events{/privacy}","received_events_url":"https://api.github.com/users/danielcweeks/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-18T23:17:06Z","updated_at":"2022-07-18T23:17:06Z","author_association":"CONTRIBUTOR","body":"Thanks @waifairer!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1188425755/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1188668514","html_url":"https://github.com/apache/iceberg/pull/5305#issuecomment-1188668514","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5305","id":1188668514,"node_id":"IC_kwDOCW7NX85G2aRi","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-19T06:51:23Z","updated_at":"2022-07-19T06:51:23Z","author_association":"CONTRIBUTOR","body":"After this, I'll add `bucket` and `zorder` as well.\r\n\r\nThis is to facilitate the usage of the various transforms from PySpark as well as SQL.\r\n\r\nAdditionally, having a `zorder` function will make it possible for people to pre-sort their data on input, vs having to zorder sort it when running a data compaction job.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1188668514/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1188696611","html_url":"https://github.com/apache/iceberg/pull/5036#issuecomment-1188696611","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5036","id":1188696611,"node_id":"IC_kwDOCW7NX85G2hIj","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-19T07:26:26Z","updated_at":"2022-07-19T07:26:26Z","author_association":"CONTRIBUTOR","body":"@SinghAsDev: Could you please check why the test is failing? Also left some minor comments.\r\n\r\nThanks,\r\nPeter","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1188696611/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1188846672","html_url":"https://github.com/apache/iceberg/issues/5163#issuecomment-1188846672","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5163","id":1188846672,"node_id":"IC_kwDOCW7NX85G3FxQ","user":{"login":"yabola","id":31469905,"node_id":"MDQ6VXNlcjMxNDY5OTA1","avatar_url":"https://avatars.githubusercontent.com/u/31469905?v=4","gravatar_id":"","url":"https://api.github.com/users/yabola","html_url":"https://github.com/yabola","followers_url":"https://api.github.com/users/yabola/followers","following_url":"https://api.github.com/users/yabola/following{/other_user}","gists_url":"https://api.github.com/users/yabola/gists{/gist_id}","starred_url":"https://api.github.com/users/yabola/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yabola/subscriptions","organizations_url":"https://api.github.com/users/yabola/orgs","repos_url":"https://api.github.com/users/yabola/repos","events_url":"https://api.github.com/users/yabola/events{/privacy}","received_events_url":"https://api.github.com/users/yabola/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-19T09:53:03Z","updated_at":"2022-07-19T09:53:03Z","author_association":"CONTRIBUTOR","body":"@pvary Really thank you for explaining this to me, I did misunderstanding it before. It looks good if creating hive external table. \r\nI tried to operate in my environment, but there are some environmental problems with hive, I guess it may be that my hive version (1.1.0) is too low , I need to solve it first.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1188846672/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1188856243","html_url":"https://github.com/apache/iceberg/issues/5163#issuecomment-1188856243","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5163","id":1188856243,"node_id":"IC_kwDOCW7NX85G3IGz","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-19T10:03:03Z","updated_at":"2022-07-19T10:03:03Z","author_association":"CONTRIBUTOR","body":"Happy to help @yabola! Hive 1.1.0 is really old. 2.3.x, and 3.1.x is supported in some configurations, but if you are able to upgrade Hive 4.0.0-alpha-1 would be your best bet to query Iceberg tables","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1188856243/reactions","total_count":1,"+1":0,"-1":0,"laugh":1,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1188973318","html_url":"https://github.com/apache/iceberg/pull/4904#issuecomment-1188973318","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4904","id":1188973318,"node_id":"IC_kwDOCW7NX85G3ksG","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-19T12:09:43Z","updated_at":"2022-07-19T12:09:43Z","author_association":"CONTRIBUTOR","body":"@hililiwei: New to the Flink part, but read through the changes and left some comments. Feel free to correct me anywhere if I do not yet understand some of the Flink stuff. Thanks, Peter","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1188973318/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1189106204","html_url":"https://github.com/apache/iceberg/pull/5026#issuecomment-1189106204","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5026","id":1189106204,"node_id":"IC_kwDOCW7NX85G4FIc","user":{"login":"puneetzaroo","id":2358709,"node_id":"MDQ6VXNlcjIzNTg3MDk=","avatar_url":"https://avatars.githubusercontent.com/u/2358709?v=4","gravatar_id":"","url":"https://api.github.com/users/puneetzaroo","html_url":"https://github.com/puneetzaroo","followers_url":"https://api.github.com/users/puneetzaroo/followers","following_url":"https://api.github.com/users/puneetzaroo/following{/other_user}","gists_url":"https://api.github.com/users/puneetzaroo/gists{/gist_id}","starred_url":"https://api.github.com/users/puneetzaroo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/puneetzaroo/subscriptions","organizations_url":"https://api.github.com/users/puneetzaroo/orgs","repos_url":"https://api.github.com/users/puneetzaroo/repos","events_url":"https://api.github.com/users/puneetzaroo/events{/privacy}","received_events_url":"https://api.github.com/users/puneetzaroo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-19T14:12:34Z","updated_at":"2022-07-19T14:12:34Z","author_association":"CONTRIBUTOR","body":"A high level description of what the PR does would be helpful in debugging.\r\nAlso helpful would be some performance evaluation or results showing how this particular change improves over the current code base.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1189106204/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1189215761","html_url":"https://github.com/apache/iceberg/pull/5248#issuecomment-1189215761","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5248","id":1189215761,"node_id":"IC_kwDOCW7NX85G4f4R","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-19T15:43:30Z","updated_at":"2022-07-19T15:43:30Z","author_association":"CONTRIBUTOR","body":"Let me take a look now.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1189215761/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1189310180","html_url":"https://github.com/apache/iceberg/pull/4925#issuecomment-1189310180","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4925","id":1189310180,"node_id":"IC_kwDOCW7NX85G427k","user":{"login":"jzhuge","id":1883812,"node_id":"MDQ6VXNlcjE4ODM4MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1883812?v=4","gravatar_id":"","url":"https://api.github.com/users/jzhuge","html_url":"https://github.com/jzhuge","followers_url":"https://api.github.com/users/jzhuge/followers","following_url":"https://api.github.com/users/jzhuge/following{/other_user}","gists_url":"https://api.github.com/users/jzhuge/gists{/gist_id}","starred_url":"https://api.github.com/users/jzhuge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jzhuge/subscriptions","organizations_url":"https://api.github.com/users/jzhuge/orgs","repos_url":"https://api.github.com/users/jzhuge/repos","events_url":"https://api.github.com/users/jzhuge/events{/privacy}","received_events_url":"https://api.github.com/users/jzhuge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-19T16:33:12Z","updated_at":"2022-07-19T16:33:12Z","author_association":"MEMBER","body":"Hi @danielcweeks, could you please take a look and merge if it looks ok?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1189310180/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1189312673","html_url":"https://github.com/apache/iceberg/issues/5308#issuecomment-1189312673","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5308","id":1189312673,"node_id":"IC_kwDOCW7NX85G43ih","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-19T16:35:40Z","updated_at":"2022-07-19T16:35:40Z","author_association":"CONTRIBUTOR","body":"I wonder if this is related to what's being addressed in https://github.com/apache/iceberg/pull/5306","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1189312673/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1189314525","html_url":"https://github.com/apache/iceberg/pull/5309#issuecomment-1189314525","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5309","id":1189314525,"node_id":"IC_kwDOCW7NX85G43_d","user":{"login":"palaniappa","id":8463782,"node_id":"MDQ6VXNlcjg0NjM3ODI=","avatar_url":"https://avatars.githubusercontent.com/u/8463782?v=4","gravatar_id":"","url":"https://api.github.com/users/palaniappa","html_url":"https://github.com/palaniappa","followers_url":"https://api.github.com/users/palaniappa/followers","following_url":"https://api.github.com/users/palaniappa/following{/other_user}","gists_url":"https://api.github.com/users/palaniappa/gists{/gist_id}","starred_url":"https://api.github.com/users/palaniappa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/palaniappa/subscriptions","organizations_url":"https://api.github.com/users/palaniappa/orgs","repos_url":"https://api.github.com/users/palaniappa/repos","events_url":"https://api.github.com/users/palaniappa/events{/privacy}","received_events_url":"https://api.github.com/users/palaniappa/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-19T16:37:31Z","updated_at":"2022-07-19T16:37:31Z","author_association":"CONTRIBUTOR","body":"@rdblue can you please take a look at this small change ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1189314525/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1189317963","html_url":"https://github.com/apache/iceberg/pull/5289#issuecomment-1189317963","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5289","id":1189317963,"node_id":"IC_kwDOCW7NX85G441L","user":{"login":"danielcweeks","id":4925077,"node_id":"MDQ6VXNlcjQ5MjUwNzc=","avatar_url":"https://avatars.githubusercontent.com/u/4925077?v=4","gravatar_id":"","url":"https://api.github.com/users/danielcweeks","html_url":"https://github.com/danielcweeks","followers_url":"https://api.github.com/users/danielcweeks/followers","following_url":"https://api.github.com/users/danielcweeks/following{/other_user}","gists_url":"https://api.github.com/users/danielcweeks/gists{/gist_id}","starred_url":"https://api.github.com/users/danielcweeks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielcweeks/subscriptions","organizations_url":"https://api.github.com/users/danielcweeks/orgs","repos_url":"https://api.github.com/users/danielcweeks/repos","events_url":"https://api.github.com/users/danielcweeks/events{/privacy}","received_events_url":"https://api.github.com/users/danielcweeks/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-19T16:41:00Z","updated_at":"2022-07-19T16:41:00Z","author_association":"CONTRIBUTOR","body":"Thanks @amogh-jahagirdar (just waiting on checks)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1189317963/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1189406967","html_url":"https://github.com/apache/iceberg/issues/2796#issuecomment-1189406967","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2796","id":1189406967,"node_id":"IC_kwDOCW7NX85G5Oj3","user":{"login":"jfz","id":1302547,"node_id":"MDQ6VXNlcjEzMDI1NDc=","avatar_url":"https://avatars.githubusercontent.com/u/1302547?v=4","gravatar_id":"","url":"https://api.github.com/users/jfz","html_url":"https://github.com/jfz","followers_url":"https://api.github.com/users/jfz/followers","following_url":"https://api.github.com/users/jfz/following{/other_user}","gists_url":"https://api.github.com/users/jfz/gists{/gist_id}","starred_url":"https://api.github.com/users/jfz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jfz/subscriptions","organizations_url":"https://api.github.com/users/jfz/orgs","repos_url":"https://api.github.com/users/jfz/repos","events_url":"https://api.github.com/users/jfz/events{/privacy}","received_events_url":"https://api.github.com/users/jfz/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-19T18:17:07Z","updated_at":"2022-07-19T18:18:25Z","author_association":"CONTRIBUTOR","body":"@jackye1995 can you please take a look at the fix?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1189406967/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1189580471","html_url":"https://github.com/apache/iceberg/pull/5221#issuecomment-1189580471","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5221","id":1189580471,"node_id":"IC_kwDOCW7NX85G5463","user":{"login":"danielcweeks","id":4925077,"node_id":"MDQ6VXNlcjQ5MjUwNzc=","avatar_url":"https://avatars.githubusercontent.com/u/4925077?v=4","gravatar_id":"","url":"https://api.github.com/users/danielcweeks","html_url":"https://github.com/danielcweeks","followers_url":"https://api.github.com/users/danielcweeks/followers","following_url":"https://api.github.com/users/danielcweeks/following{/other_user}","gists_url":"https://api.github.com/users/danielcweeks/gists{/gist_id}","starred_url":"https://api.github.com/users/danielcweeks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielcweeks/subscriptions","organizations_url":"https://api.github.com/users/danielcweeks/orgs","repos_url":"https://api.github.com/users/danielcweeks/repos","events_url":"https://api.github.com/users/danielcweeks/events{/privacy}","received_events_url":"https://api.github.com/users/danielcweeks/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-19T21:44:23Z","updated_at":"2022-07-19T21:44:23Z","author_association":"CONTRIBUTOR","body":"Seems like we have general consensus that this is ok to proceed with.  Thanks @nastra!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1189580471/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1189620393","html_url":"https://github.com/apache/iceberg/issues/430#issuecomment-1189620393","issue_url":"https://api.github.com/repos/apache/iceberg/issues/430","id":1189620393,"node_id":"IC_kwDOCW7NX85G6Cqp","user":{"login":"Hoeze","id":1200058,"node_id":"MDQ6VXNlcjEyMDAwNTg=","avatar_url":"https://avatars.githubusercontent.com/u/1200058?v=4","gravatar_id":"","url":"https://api.github.com/users/Hoeze","html_url":"https://github.com/Hoeze","followers_url":"https://api.github.com/users/Hoeze/followers","following_url":"https://api.github.com/users/Hoeze/following{/other_user}","gists_url":"https://api.github.com/users/Hoeze/gists{/gist_id}","starred_url":"https://api.github.com/users/Hoeze/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Hoeze/subscriptions","organizations_url":"https://api.github.com/users/Hoeze/orgs","repos_url":"https://api.github.com/users/Hoeze/repos","events_url":"https://api.github.com/users/Hoeze/events{/privacy}","received_events_url":"https://api.github.com/users/Hoeze/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-19T22:41:13Z","updated_at":"2022-07-19T22:41:13Z","author_association":"NONE","body":"Any updates on this? Storage Partitioned Join landed in Spark v3.3.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1189620393/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1189744433","html_url":"https://github.com/apache/iceberg/pull/5306#issuecomment-1189744433","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5306","id":1189744433,"node_id":"IC_kwDOCW7NX85G6g8x","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-20T02:43:57Z","updated_at":"2022-07-20T02:43:57Z","author_association":"CONTRIBUTOR","body":"Thanks, @nastra!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1189744433/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1189745817","html_url":"https://github.com/apache/iceberg/pull/5286#issuecomment-1189745817","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5286","id":1189745817,"node_id":"IC_kwDOCW7NX85G6hSZ","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-20T02:46:52Z","updated_at":"2022-07-20T02:46:52Z","author_association":"CONTRIBUTOR","body":"Looks great. Thanks for adding this, @nastra!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1189745817/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1189783415","html_url":"https://github.com/apache/iceberg/issues/430#issuecomment-1189783415","issue_url":"https://api.github.com/repos/apache/iceberg/issues/430","id":1189783415,"node_id":"IC_kwDOCW7NX85G6qd3","user":{"login":"sunchao","id":506679,"node_id":"MDQ6VXNlcjUwNjY3OQ==","avatar_url":"https://avatars.githubusercontent.com/u/506679?v=4","gravatar_id":"","url":"https://api.github.com/users/sunchao","html_url":"https://github.com/sunchao","followers_url":"https://api.github.com/users/sunchao/followers","following_url":"https://api.github.com/users/sunchao/following{/other_user}","gists_url":"https://api.github.com/users/sunchao/gists{/gist_id}","starred_url":"https://api.github.com/users/sunchao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sunchao/subscriptions","organizations_url":"https://api.github.com/users/sunchao/orgs","repos_url":"https://api.github.com/users/sunchao/repos","events_url":"https://api.github.com/users/sunchao/events{/privacy}","received_events_url":"https://api.github.com/users/sunchao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-20T03:41:29Z","updated_at":"2022-07-20T03:41:29Z","author_association":"MEMBER","body":"I think this is ongoing - first Iceberg needs to support function catalog which is tracked (partially) by https://github.com/apache/iceberg/pull/5305. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1189783415/reactions","total_count":4,"+1":4,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1190075297","html_url":"https://github.com/apache/iceberg/pull/5045#issuecomment-1190075297","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5045","id":1190075297,"node_id":"IC_kwDOCW7NX85G7xuh","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-20T09:58:16Z","updated_at":"2022-07-20T09:58:24Z","author_association":"CONTRIBUTOR","body":"Merged, as it seems to me that everyone is in agreement that we should merge this, but it has been forgotten.\r\nDo we need this here as well, and maybe in other branches too? https://github.com/apache/iceberg-docs/blob/latest/docs/content/flink-connector.md","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1190075297/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1190081396","html_url":"https://github.com/apache/iceberg/pull/5045#issuecomment-1190081396","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5045","id":1190081396,"node_id":"IC_kwDOCW7NX85G7zN0","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-20T10:04:12Z","updated_at":"2022-07-20T10:04:12Z","author_association":"CONTRIBUTOR","body":"Usually https://github.com/apache/iceberg-docs/blob/latest/docs/content/flink-connector.md would be updated when copying over docs during a release, but here I think it would make sense to update it manually, since the docs for the release were updated before this was merged.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1190081396/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1190118695","html_url":"https://github.com/apache/iceberg/issues/5231#issuecomment-1190118695","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5231","id":1190118695,"node_id":"IC_kwDOCW7NX85G78Un","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-20T10:43:28Z","updated_at":"2022-07-20T10:43:28Z","author_association":"CONTRIBUTOR","body":"@varunsrinath: Also please share the Hive/Iceberg versions too","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1190118695/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1190127042","html_url":"https://github.com/apache/iceberg/issues/5243#issuecomment-1190127042","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5243","id":1190127042,"node_id":"IC_kwDOCW7NX85G7-XC","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-20T10:52:53Z","updated_at":"2022-07-20T10:52:53Z","author_association":"CONTRIBUTOR","body":"@nashiyue: Which execution engine did you use? Any errors during the insert on the console or in the HS2/HMS logs?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1190127042/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1190177918","html_url":"https://github.com/apache/iceberg/pull/5288#issuecomment-1190177918","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5288","id":1190177918,"node_id":"IC_kwDOCW7NX85G8Kx-","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-20T11:50:39Z","updated_at":"2022-07-20T11:51:11Z","author_association":"CONTRIBUTOR","body":"Merged, as this seems like we forget about only to merge the PR.\r\nThanks for the fix @hrishisd and Ryan for the review!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1190177918/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1190352837","html_url":"https://github.com/apache/iceberg/pull/5159#issuecomment-1190352837","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5159","id":1190352837,"node_id":"IC_kwDOCW7NX85G81fF","user":{"login":"gaborkaszab","id":29145491,"node_id":"MDQ6VXNlcjI5MTQ1NDkx","avatar_url":"https://avatars.githubusercontent.com/u/29145491?v=4","gravatar_id":"","url":"https://api.github.com/users/gaborkaszab","html_url":"https://github.com/gaborkaszab","followers_url":"https://api.github.com/users/gaborkaszab/followers","following_url":"https://api.github.com/users/gaborkaszab/following{/other_user}","gists_url":"https://api.github.com/users/gaborkaszab/gists{/gist_id}","starred_url":"https://api.github.com/users/gaborkaszab/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gaborkaszab/subscriptions","organizations_url":"https://api.github.com/users/gaborkaszab/orgs","repos_url":"https://api.github.com/users/gaborkaszab/repos","events_url":"https://api.github.com/users/gaborkaszab/events{/privacy}","received_events_url":"https://api.github.com/users/gaborkaszab/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-20T14:23:26Z","updated_at":"2022-07-20T14:23:26Z","author_association":"COLLABORATOR","body":"@rdblue I'm not sure I got your preference from you comment but I changed the code to have a table-level property instead of a catalog-level flag to control this functionality. I hope this is what you had in mind.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1190352837/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1190553613","html_url":"https://github.com/apache/iceberg/pull/4904#issuecomment-1190553613","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4904","id":1190553613,"node_id":"IC_kwDOCW7NX85G9mgN","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-20T17:25:46Z","updated_at":"2022-07-20T17:25:46Z","author_association":"CONTRIBUTOR","body":"@hililiwei: I am getting second thoughts about this newline stuff. We usually try to add a newline after every block. I see that in several places we do not really adhere to it. Still might worth to check if you think the code would look better.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1190553613/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1190555079","html_url":"https://github.com/apache/iceberg/issues/430#issuecomment-1190555079","issue_url":"https://api.github.com/repos/apache/iceberg/issues/430","id":1190555079,"node_id":"IC_kwDOCW7NX85G9m3H","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-20T17:27:09Z","updated_at":"2022-07-20T17:27:09Z","author_association":"CONTRIBUTOR","body":"I have `truncate` in #5305 and am working on bucket as well for once that is reviewed.\r\n\r\nI will open an issue for the FunctionCatalog and link it to this.  ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1190555079/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1190567116","html_url":"https://github.com/apache/iceberg/pull/4904#issuecomment-1190567116","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4904","id":1190567116,"node_id":"IC_kwDOCW7NX85G9pzM","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-20T17:38:40Z","updated_at":"2022-07-20T17:38:40Z","author_association":"CONTRIBUTOR","body":"> @hililiwei: I am getting second thoughts about this newline stuff. We usually try to add a newline after every block. I see that in several places we do not really adhere to it. Still might worth to check if you think the code would look better.\r\n\r\nThank you for your review. I'll check it as soon as possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1190567116/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1190606379","html_url":"https://github.com/apache/iceberg/pull/5316#issuecomment-1190606379","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5316","id":1190606379,"node_id":"IC_kwDOCW7NX85G9zYr","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-20T18:18:00Z","updated_at":"2022-07-20T18:18:00Z","author_association":"CONTRIBUTOR","body":"Ah, it looks like the unit tests are failing due to not being in ascending order? I didn't think was required. I'm validating this against S3 itself in the integration tests.\r\n\r\norg.apache.iceberg.aws.s3.TestS3OutputStream > testWriteWithChecksumEnabled FAILED\r\n    software.amazon.awssdk.services.s3.model.S3Exception: The list of parts was not in ascending order. The parts list must be specified in order by part number. (Service: S3, Status Code: 400, Request ID: )","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1190606379/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1190712956","html_url":"https://github.com/apache/iceberg/pull/5317#issuecomment-1190712956","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5317","id":1190712956,"node_id":"IC_kwDOCW7NX85G-NZ8","user":{"login":"abmo-x","id":69539469,"node_id":"MDQ6VXNlcjY5NTM5NDY5","avatar_url":"https://avatars.githubusercontent.com/u/69539469?v=4","gravatar_id":"","url":"https://api.github.com/users/abmo-x","html_url":"https://github.com/abmo-x","followers_url":"https://api.github.com/users/abmo-x/followers","following_url":"https://api.github.com/users/abmo-x/following{/other_user}","gists_url":"https://api.github.com/users/abmo-x/gists{/gist_id}","starred_url":"https://api.github.com/users/abmo-x/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/abmo-x/subscriptions","organizations_url":"https://api.github.com/users/abmo-x/orgs","repos_url":"https://api.github.com/users/abmo-x/repos","events_url":"https://api.github.com/users/abmo-x/events{/privacy}","received_events_url":"https://api.github.com/users/abmo-x/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-20T20:15:37Z","updated_at":"2022-07-20T20:15:37Z","author_association":"CONTRIBUTOR","body":"Updated with recommendations, Thanks @RussellSpitzer ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1190712956/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1190740182","html_url":"https://github.com/apache/iceberg/pull/5311#issuecomment-1190740182","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5311","id":1190740182,"node_id":"IC_kwDOCW7NX85G-UDW","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-20T20:45:22Z","updated_at":"2022-07-20T20:45:22Z","author_association":"CONTRIBUTOR","body":"I agree with @RussellSpitzer, I think we should avoid the double close, since that is what is causing the problem (at least as far as I understand).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1190740182/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1190837724","html_url":"https://github.com/apache/iceberg/pull/5311#issuecomment-1190837724","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5311","id":1190837724,"node_id":"IC_kwDOCW7NX85G-r3c","user":{"login":"abmo-x","id":69539469,"node_id":"MDQ6VXNlcjY5NTM5NDY5","avatar_url":"https://avatars.githubusercontent.com/u/69539469?v=4","gravatar_id":"","url":"https://api.github.com/users/abmo-x","html_url":"https://github.com/abmo-x","followers_url":"https://api.github.com/users/abmo-x/followers","following_url":"https://api.github.com/users/abmo-x/following{/other_user}","gists_url":"https://api.github.com/users/abmo-x/gists{/gist_id}","starred_url":"https://api.github.com/users/abmo-x/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/abmo-x/subscriptions","organizations_url":"https://api.github.com/users/abmo-x/orgs","repos_url":"https://api.github.com/users/abmo-x/repos","events_url":"https://api.github.com/users/abmo-x/events{/privacy}","received_events_url":"https://api.github.com/users/abmo-x/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-20T22:38:40Z","updated_at":"2022-07-21T02:02:03Z","author_association":"CONTRIBUTOR","body":"@rdblue @RussellSpitzer \r\nAdded a commit to clear currentWriter on close in BaseTaskWriter and added 2 test cases around failure to close and complete.\r\n\r\nI agree close should be only called once and we are relying on that behavior quite strongly and adding the data files. \r\nHowever I found that the writers are held and closed more than once in various scenarios which causes this issue where a close resulted in failure and writers end up in a bad state:\r\n\r\n1. when user defined functions catch all exceptions and ignore failures on write as seen in Flink's processElement which internally triggers a roll to new file.\r\n2. This behavior was also observed before other than BaseTaskWriter and fix was made to not close already closed stream in https://github.com/apache/iceberg/pull/1749 \r\n\r\nLet me know your thoughts. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1190837724/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1190907221","html_url":"https://github.com/apache/iceberg/pull/5317#issuecomment-1190907221","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5317","id":1190907221,"node_id":"IC_kwDOCW7NX85G-81V","user":{"login":"abmo-x","id":69539469,"node_id":"MDQ6VXNlcjY5NTM5NDY5","avatar_url":"https://avatars.githubusercontent.com/u/69539469?v=4","gravatar_id":"","url":"https://api.github.com/users/abmo-x","html_url":"https://github.com/abmo-x","followers_url":"https://api.github.com/users/abmo-x/followers","following_url":"https://api.github.com/users/abmo-x/following{/other_user}","gists_url":"https://api.github.com/users/abmo-x/gists{/gist_id}","starred_url":"https://api.github.com/users/abmo-x/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/abmo-x/subscriptions","organizations_url":"https://api.github.com/users/abmo-x/orgs","repos_url":"https://api.github.com/users/abmo-x/repos","events_url":"https://api.github.com/users/abmo-x/events{/privacy}","received_events_url":"https://api.github.com/users/abmo-x/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-21T00:38:02Z","updated_at":"2022-07-21T00:38:02Z","author_association":"CONTRIBUTOR","body":"> I think there are a few formatting issues remaining but other than that this is good to go. We need to revert all the changes which aren't directly related to the patch. I think the byte [] to byte[] is correct but we should separate that out into another patch. Since we are about to do a big programmatic style application soon it is probably best to just leave it as is for now.\r\n\r\nReverted formatting which was not part of the PR. Thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1190907221/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1190962203","html_url":"https://github.com/apache/iceberg/pull/5316#issuecomment-1190962203","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5316","id":1190962203,"node_id":"IC_kwDOCW7NX85G_KQb","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-21T02:20:40Z","updated_at":"2022-07-21T02:20:40Z","author_association":"CONTRIBUTOR","body":"Closing this, I realized I missed something fundamental with MPU. In a concurrent environment, it's very possible the part numbers are out of order in the current implementation and as of now we need to explicitly provide the parts in ascending order. In my head probably a way with atomic counters and a synchronized list which contains the parts in monotonically increasing order of id but it seems more complex than the value added. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1190962203/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1191043001","html_url":"https://github.com/apache/iceberg/pull/5282#issuecomment-1191043001","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5282","id":1191043001,"node_id":"IC_kwDOCW7NX85G_d-5","user":{"login":"puneetzaroo","id":2358709,"node_id":"MDQ6VXNlcjIzNTg3MDk=","avatar_url":"https://avatars.githubusercontent.com/u/2358709?v=4","gravatar_id":"","url":"https://api.github.com/users/puneetzaroo","html_url":"https://github.com/puneetzaroo","followers_url":"https://api.github.com/users/puneetzaroo/followers","following_url":"https://api.github.com/users/puneetzaroo/following{/other_user}","gists_url":"https://api.github.com/users/puneetzaroo/gists{/gist_id}","starred_url":"https://api.github.com/users/puneetzaroo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/puneetzaroo/subscriptions","organizations_url":"https://api.github.com/users/puneetzaroo/orgs","repos_url":"https://api.github.com/users/puneetzaroo/repos","events_url":"https://api.github.com/users/puneetzaroo/events{/privacy}","received_events_url":"https://api.github.com/users/puneetzaroo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-21T05:05:51Z","updated_at":"2022-07-21T05:05:51Z","author_association":"CONTRIBUTOR","body":"Looks good","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1191043001/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1191045722","html_url":"https://github.com/apache/iceberg/pull/5282#issuecomment-1191045722","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5282","id":1191045722,"node_id":"IC_kwDOCW7NX85G_epa","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-21T05:10:56Z","updated_at":"2022-07-21T05:10:56Z","author_association":"CONTRIBUTOR","body":"@jfz can you refactor the manual testing in the description to proper unit tests?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1191045722/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1191049887","html_url":"https://github.com/apache/iceberg/issues/5307#issuecomment-1191049887","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5307","id":1191049887,"node_id":"IC_kwDOCW7NX85G_fqf","user":{"login":"rajan-v","id":13184226,"node_id":"MDQ6VXNlcjEzMTg0MjI2","avatar_url":"https://avatars.githubusercontent.com/u/13184226?v=4","gravatar_id":"","url":"https://api.github.com/users/rajan-v","html_url":"https://github.com/rajan-v","followers_url":"https://api.github.com/users/rajan-v/followers","following_url":"https://api.github.com/users/rajan-v/following{/other_user}","gists_url":"https://api.github.com/users/rajan-v/gists{/gist_id}","starred_url":"https://api.github.com/users/rajan-v/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rajan-v/subscriptions","organizations_url":"https://api.github.com/users/rajan-v/orgs","repos_url":"https://api.github.com/users/rajan-v/repos","events_url":"https://api.github.com/users/rajan-v/events{/privacy}","received_events_url":"https://api.github.com/users/rajan-v/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-21T05:18:39Z","updated_at":"2022-07-21T05:22:08Z","author_association":"NONE","body":"I have verified Deletion through Spark-SQL. It's happening  through metafiles and generating delete files. \r\nSetup:- spark-3.2.1-bin-hadoop3.2   \ticeberg-spark-runtime-3.2_2.12-0.13.0.\r\n\r\nAnd yes i can see table().specs().size() > 1)  in iceberg-spark-runtime-3.0 and 3.1\r\n\r\nAnd Here is v3.2 https://github.com/apache/iceberg/blob/906ba1b4998f938c4615a96ec90921e4ccd09c4a/spark/v3.2/spark/src/main/java/org/apache/iceberg/spark/source/SparkTable.java#L236\r\n\r\n\r\n[iceberg-delete_files_generation.txt](https://github.com/apache/iceberg/files/9156024/iceberg-delete_files_generation.txt)\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1191049887/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1191081397","html_url":"https://github.com/apache/iceberg/pull/4807#issuecomment-1191081397","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4807","id":1191081397,"node_id":"IC_kwDOCW7NX85G_nW1","user":{"login":"rajarshisarkar","id":4561678,"node_id":"MDQ6VXNlcjQ1NjE2Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/4561678?v=4","gravatar_id":"","url":"https://api.github.com/users/rajarshisarkar","html_url":"https://github.com/rajarshisarkar","followers_url":"https://api.github.com/users/rajarshisarkar/followers","following_url":"https://api.github.com/users/rajarshisarkar/following{/other_user}","gists_url":"https://api.github.com/users/rajarshisarkar/gists{/gist_id}","starred_url":"https://api.github.com/users/rajarshisarkar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rajarshisarkar/subscriptions","organizations_url":"https://api.github.com/users/rajarshisarkar/orgs","repos_url":"https://api.github.com/users/rajarshisarkar/repos","events_url":"https://api.github.com/users/rajarshisarkar/events{/privacy}","received_events_url":"https://api.github.com/users/rajarshisarkar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-21T06:12:29Z","updated_at":"2022-07-21T06:12:29Z","author_association":"CONTRIBUTOR","body":"Hi @rdblue @jackye1995, Can you please review the changes once you get time.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1191081397/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1191112944","html_url":"https://github.com/apache/iceberg/issues/5321#issuecomment-1191112944","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5321","id":1191112944,"node_id":"IC_kwDOCW7NX85G_vDw","user":{"login":"mengshangxun","id":7135066,"node_id":"MDQ6VXNlcjcxMzUwNjY=","avatar_url":"https://avatars.githubusercontent.com/u/7135066?v=4","gravatar_id":"","url":"https://api.github.com/users/mengshangxun","html_url":"https://github.com/mengshangxun","followers_url":"https://api.github.com/users/mengshangxun/followers","following_url":"https://api.github.com/users/mengshangxun/following{/other_user}","gists_url":"https://api.github.com/users/mengshangxun/gists{/gist_id}","starred_url":"https://api.github.com/users/mengshangxun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mengshangxun/subscriptions","organizations_url":"https://api.github.com/users/mengshangxun/orgs","repos_url":"https://api.github.com/users/mengshangxun/repos","events_url":"https://api.github.com/users/mengshangxun/events{/privacy}","received_events_url":"https://api.github.com/users/mengshangxun/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-21T06:55:00Z","updated_at":"2022-07-21T06:55:00Z","author_association":"NONE","body":"","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1191112944/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1191143533","html_url":"https://github.com/apache/iceberg/pull/5323#issuecomment-1191143533","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5323","id":1191143533,"node_id":"IC_kwDOCW7NX85G_2ht","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-21T07:30:18Z","updated_at":"2022-07-21T07:30:18Z","author_association":"CONTRIBUTOR","body":"looks like we can't upgrade to 3.x because it requires JDK 11","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1191143533/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1191168958","html_url":"https://github.com/apache/iceberg/issues/5321#issuecomment-1191168958","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5321","id":1191168958,"node_id":"IC_kwDOCW7NX85G_8u-","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-21T07:59:01Z","updated_at":"2022-07-21T07:59:01Z","author_association":"CONTRIBUTOR","body":"I agree that this is confusing. I wonder if we should report back the timestamp in UTC to make this clearer","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1191168958/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1191487203","html_url":"https://github.com/apache/iceberg/pull/2807#issuecomment-1191487203","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2807","id":1191487203,"node_id":"IC_kwDOCW7NX85HBKbj","user":{"login":"mechgouki","id":8364215,"node_id":"MDQ6VXNlcjgzNjQyMTU=","avatar_url":"https://avatars.githubusercontent.com/u/8364215?v=4","gravatar_id":"","url":"https://api.github.com/users/mechgouki","html_url":"https://github.com/mechgouki","followers_url":"https://api.github.com/users/mechgouki/followers","following_url":"https://api.github.com/users/mechgouki/following{/other_user}","gists_url":"https://api.github.com/users/mechgouki/gists{/gist_id}","starred_url":"https://api.github.com/users/mechgouki/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mechgouki/subscriptions","organizations_url":"https://api.github.com/users/mechgouki/orgs","repos_url":"https://api.github.com/users/mechgouki/repos","events_url":"https://api.github.com/users/mechgouki/events{/privacy}","received_events_url":"https://api.github.com/users/mechgouki/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-21T13:29:16Z","updated_at":"2022-07-21T13:29:16Z","author_association":"NONE","body":"> \r\n@guillaumBrisard \r\nYes, we are waiting for the Doc to be merged, if everything go smoothly, we could consider in 0.14 release    \r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1191487203/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1191638768","html_url":"https://github.com/apache/iceberg/pull/5327#issuecomment-1191638768","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5327","id":1191638768,"node_id":"IC_kwDOCW7NX85HBvbw","user":{"login":"yabola","id":31469905,"node_id":"MDQ6VXNlcjMxNDY5OTA1","avatar_url":"https://avatars.githubusercontent.com/u/31469905?v=4","gravatar_id":"","url":"https://api.github.com/users/yabola","html_url":"https://github.com/yabola","followers_url":"https://api.github.com/users/yabola/followers","following_url":"https://api.github.com/users/yabola/following{/other_user}","gists_url":"https://api.github.com/users/yabola/gists{/gist_id}","starred_url":"https://api.github.com/users/yabola/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yabola/subscriptions","organizations_url":"https://api.github.com/users/yabola/orgs","repos_url":"https://api.github.com/users/yabola/repos","events_url":"https://api.github.com/users/yabola/events{/privacy}","received_events_url":"https://api.github.com/users/yabola/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-21T15:34:39Z","updated_at":"2022-07-21T15:34:39Z","author_association":"CONTRIBUTOR","body":"@flyrain CC~","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1191638768/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1191640747","html_url":"https://github.com/apache/iceberg/pull/5326#issuecomment-1191640747","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5326","id":1191640747,"node_id":"IC_kwDOCW7NX85HBv6r","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-21T15:36:36Z","updated_at":"2022-07-21T15:36:36Z","author_association":"CONTRIBUTOR","body":"I think this is for `pyenv`, but I don't think that we want to force a specific set of python versions. This should probably be local config and not checked in so I agree with removing it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1191640747/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1191645522","html_url":"https://github.com/apache/iceberg/pull/5320#issuecomment-1191645522","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5320","id":1191645522,"node_id":"IC_kwDOCW7NX85HBxFS","user":{"login":"danielcweeks","id":4925077,"node_id":"MDQ6VXNlcjQ5MjUwNzc=","avatar_url":"https://avatars.githubusercontent.com/u/4925077?v=4","gravatar_id":"","url":"https://api.github.com/users/danielcweeks","html_url":"https://github.com/danielcweeks","followers_url":"https://api.github.com/users/danielcweeks/followers","following_url":"https://api.github.com/users/danielcweeks/following{/other_user}","gists_url":"https://api.github.com/users/danielcweeks/gists{/gist_id}","starred_url":"https://api.github.com/users/danielcweeks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielcweeks/subscriptions","organizations_url":"https://api.github.com/users/danielcweeks/orgs","repos_url":"https://api.github.com/users/danielcweeks/repos","events_url":"https://api.github.com/users/danielcweeks/events{/privacy}","received_events_url":"https://api.github.com/users/danielcweeks/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-21T15:40:59Z","updated_at":"2022-07-21T16:34:38Z","author_association":"CONTRIBUTOR","body":"@nastra Thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1191645522/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1191673791","html_url":"https://github.com/apache/iceberg/issues/3227#issuecomment-1191673791","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3227","id":1191673791,"node_id":"IC_kwDOCW7NX85HB3-_","user":{"login":"dhruv-pratap","id":11399509,"node_id":"MDQ6VXNlcjExMzk5NTA5","avatar_url":"https://avatars.githubusercontent.com/u/11399509?v=4","gravatar_id":"","url":"https://api.github.com/users/dhruv-pratap","html_url":"https://github.com/dhruv-pratap","followers_url":"https://api.github.com/users/dhruv-pratap/followers","following_url":"https://api.github.com/users/dhruv-pratap/following{/other_user}","gists_url":"https://api.github.com/users/dhruv-pratap/gists{/gist_id}","starred_url":"https://api.github.com/users/dhruv-pratap/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dhruv-pratap/subscriptions","organizations_url":"https://api.github.com/users/dhruv-pratap/orgs","repos_url":"https://api.github.com/users/dhruv-pratap/repos","events_url":"https://api.github.com/users/dhruv-pratap/events{/privacy}","received_events_url":"https://api.github.com/users/dhruv-pratap/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-21T16:07:45Z","updated_at":"2022-07-21T16:07:45Z","author_association":"CONTRIBUTOR","body":"Hi @Fokko that should be okay, please go ahead. Apologies I couldn't get to this as some work related stuff came up at my end. I'll sync up with you once I circle back to this to see if there are any left overs from this item that I can pick-up. Thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1191673791/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1191677388","html_url":"https://github.com/apache/iceberg/pull/5282#issuecomment-1191677388","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5282","id":1191677388,"node_id":"IC_kwDOCW7NX85HB43M","user":{"login":"jfz","id":1302547,"node_id":"MDQ6VXNlcjEzMDI1NDc=","avatar_url":"https://avatars.githubusercontent.com/u/1302547?v=4","gravatar_id":"","url":"https://api.github.com/users/jfz","html_url":"https://github.com/jfz","followers_url":"https://api.github.com/users/jfz/followers","following_url":"https://api.github.com/users/jfz/following{/other_user}","gists_url":"https://api.github.com/users/jfz/gists{/gist_id}","starred_url":"https://api.github.com/users/jfz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jfz/subscriptions","organizations_url":"https://api.github.com/users/jfz/orgs","repos_url":"https://api.github.com/users/jfz/repos","events_url":"https://api.github.com/users/jfz/events{/privacy}","received_events_url":"https://api.github.com/users/jfz/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-21T16:10:13Z","updated_at":"2022-07-21T16:10:37Z","author_association":"CONTRIBUTOR","body":"> @jfz can you refactor the manual testing in the description to proper unit tests?\r\n\r\n@stevenzwu Thanks for looking into this. The challenge to test retry is that it requires \"S3Mock\" code change and still tricky to get only a particular request to fail at first attempt and succeed later. The happy path (upload a s3 object with size over 128k) is well covered in existing tests though, the above example is actually simplified from an existing test.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1191677388/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1191776539","html_url":"https://github.com/apache/iceberg/issues/5321#issuecomment-1191776539","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5321","id":1191776539,"node_id":"IC_kwDOCW7NX85HCREb","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-21T17:56:13Z","updated_at":"2022-07-21T17:56:22Z","author_association":"CONTRIBUTOR","body":"Iceberg only works with UTC timestamps. All translation to UTC is done by engines. I think this is the correct behavior for Iceberg, but it may not be the correct behavior for an engine to just pass the error through.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1191776539/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]