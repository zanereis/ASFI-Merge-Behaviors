[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/744990726","html_url":"https://github.com/apache/iceberg/issues/1911#issuecomment-744990726","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1911","id":744990726,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NDk5MDcyNg==","user":{"login":"txdong-sz","id":5066512,"node_id":"MDQ6VXNlcjUwNjY1MTI=","avatar_url":"https://avatars.githubusercontent.com/u/5066512?v=4","gravatar_id":"","url":"https://api.github.com/users/txdong-sz","html_url":"https://github.com/txdong-sz","followers_url":"https://api.github.com/users/txdong-sz/followers","following_url":"https://api.github.com/users/txdong-sz/following{/other_user}","gists_url":"https://api.github.com/users/txdong-sz/gists{/gist_id}","starred_url":"https://api.github.com/users/txdong-sz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/txdong-sz/subscriptions","organizations_url":"https://api.github.com/users/txdong-sz/orgs","repos_url":"https://api.github.com/users/txdong-sz/repos","events_url":"https://api.github.com/users/txdong-sz/events{/privacy}","received_events_url":"https://api.github.com/users/txdong-sz/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-15T01:47:02Z","updated_at":"2020-12-15T01:47:02Z","author_association":"NONE","body":"@rdblue    the reson why we use iceberg is that iceberg is cloud native.\r\nWorks with any cloud store and reduces NN congestion when in HDFS, by avoiding listing and renames\r\n\r\ni think that we need to consider everything about cloud object storeing \r\n\r\n\r\n\r\n\r\nwe have one table with 30TB data  stilll small data in our business\r\n\r\n![image](https://user-images.githubusercontent.com/5066512/102157109-dc403780-3eb9-11eb-8ffc-38783892b3c5.png)\r\n\r\n\r\n![image](https://user-images.githubusercontent.com/5066512/102157094-d6e2ed00-3eb9-11eb-9433-1049cb51cbd0.png)\r\n\r\n\r\nand we list table take about 10 seconds . \r\n\r\nso i think that the defualt implement need to be native cloud base  if the code is not effect other functions .\r\nand we need to review every code about list files to avoid avoid performance loss\r\n\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/744990726/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/745000616","html_url":"https://github.com/apache/iceberg/issues/35#issuecomment-745000616","issue_url":"https://api.github.com/repos/apache/iceberg/issues/35","id":745000616,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NTAwMDYxNg==","user":{"login":"shiyi23","id":40733762,"node_id":"MDQ6VXNlcjQwNzMzNzYy","avatar_url":"https://avatars.githubusercontent.com/u/40733762?v=4","gravatar_id":"","url":"https://api.github.com/users/shiyi23","html_url":"https://github.com/shiyi23","followers_url":"https://api.github.com/users/shiyi23/followers","following_url":"https://api.github.com/users/shiyi23/following{/other_user}","gists_url":"https://api.github.com/users/shiyi23/gists{/gist_id}","starred_url":"https://api.github.com/users/shiyi23/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shiyi23/subscriptions","organizations_url":"https://api.github.com/users/shiyi23/orgs","repos_url":"https://api.github.com/users/shiyi23/repos","events_url":"https://api.github.com/users/shiyi23/events{/privacy}","received_events_url":"https://api.github.com/users/shiyi23/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-15T01:58:30Z","updated_at":"2020-12-15T01:58:30Z","author_association":"NONE","body":"Has this issue been fied yet?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/745000616/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/745005063","html_url":"https://github.com/apache/iceberg/issues/1911#issuecomment-745005063","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1911","id":745005063,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NTAwNTA2Mw==","user":{"login":"HeartSaVioR","id":1317309,"node_id":"MDQ6VXNlcjEzMTczMDk=","avatar_url":"https://avatars.githubusercontent.com/u/1317309?v=4","gravatar_id":"","url":"https://api.github.com/users/HeartSaVioR","html_url":"https://github.com/HeartSaVioR","followers_url":"https://api.github.com/users/HeartSaVioR/followers","following_url":"https://api.github.com/users/HeartSaVioR/following{/other_user}","gists_url":"https://api.github.com/users/HeartSaVioR/gists{/gist_id}","starred_url":"https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HeartSaVioR/subscriptions","organizations_url":"https://api.github.com/users/HeartSaVioR/orgs","repos_url":"https://api.github.com/users/HeartSaVioR/repos","events_url":"https://api.github.com/users/HeartSaVioR/events{/privacy}","received_events_url":"https://api.github.com/users/HeartSaVioR/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-15T02:09:41Z","updated_at":"2020-12-15T02:09:41Z","author_association":"CONTRIBUTOR","body":"I wouldn't rather say any specific project should take all existing cloud providers into account. You can expect the smoother AWS support in Iceberg project due to the nature of where Iceberg project came from, and even more, AWS engineers are around here to contribute. The project has both contributors and heavy users for AWS, which is quite essential to lead the actual improvements.\r\n\r\nIt seems that you can provide the implementation of location provider via `write.location-provider.impl` in table properties. You can copy the code into your project (You can even fork Iceberg but there's public extension point so I'd rather use that instead), modify it, and specify the class name into the property. Just need to check the license before you do, but Apache License is relatively quite open so in many cases you won't be struggled.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/745005063/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/745021239","html_url":"https://github.com/apache/iceberg/issues/1628#issuecomment-745021239","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1628","id":745021239,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NTAyMTIzOQ==","user":{"login":"shiyi23","id":40733762,"node_id":"MDQ6VXNlcjQwNzMzNzYy","avatar_url":"https://avatars.githubusercontent.com/u/40733762?v=4","gravatar_id":"","url":"https://api.github.com/users/shiyi23","html_url":"https://github.com/shiyi23","followers_url":"https://api.github.com/users/shiyi23/followers","following_url":"https://api.github.com/users/shiyi23/following{/other_user}","gists_url":"https://api.github.com/users/shiyi23/gists{/gist_id}","starred_url":"https://api.github.com/users/shiyi23/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shiyi23/subscriptions","organizations_url":"https://api.github.com/users/shiyi23/orgs","repos_url":"https://api.github.com/users/shiyi23/repos","events_url":"https://api.github.com/users/shiyi23/events{/privacy}","received_events_url":"https://api.github.com/users/shiyi23/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-15T03:03:49Z","updated_at":"2020-12-15T03:03:49Z","author_association":"NONE","body":"/assign @shiyi23","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/745021239/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/745028445","html_url":"https://github.com/apache/iceberg/issues/1934#issuecomment-745028445","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1934","id":745028445,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NTAyODQ0NQ==","user":{"login":"jacques-n","id":183350,"node_id":"MDQ6VXNlcjE4MzM1MA==","avatar_url":"https://avatars.githubusercontent.com/u/183350?v=4","gravatar_id":"","url":"https://api.github.com/users/jacques-n","html_url":"https://github.com/jacques-n","followers_url":"https://api.github.com/users/jacques-n/followers","following_url":"https://api.github.com/users/jacques-n/following{/other_user}","gists_url":"https://api.github.com/users/jacques-n/gists{/gist_id}","starred_url":"https://api.github.com/users/jacques-n/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jacques-n/subscriptions","organizations_url":"https://api.github.com/users/jacques-n/orgs","repos_url":"https://api.github.com/users/jacques-n/repos","events_url":"https://api.github.com/users/jacques-n/events{/privacy}","received_events_url":"https://api.github.com/users/jacques-n/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-15T03:28:02Z","updated_at":"2020-12-15T03:28:02Z","author_association":"NONE","body":"I'm guessing that FileSystem.listStatusIterator() could be faster since you only need to check if it is greater than 1 and it doesn't require a full traversal. @txdong-sz do you want to propose a patch? You'd need to implement the filter outside the call since I believe that call doesn't support filters.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/745028445/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/745056654","html_url":"https://github.com/apache/iceberg/issues/1915#issuecomment-745056654","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1915","id":745056654,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NTA1NjY1NA==","user":{"login":"txdong-sz","id":5066512,"node_id":"MDQ6VXNlcjUwNjY1MTI=","avatar_url":"https://avatars.githubusercontent.com/u/5066512?v=4","gravatar_id":"","url":"https://api.github.com/users/txdong-sz","html_url":"https://github.com/txdong-sz","followers_url":"https://api.github.com/users/txdong-sz/followers","following_url":"https://api.github.com/users/txdong-sz/following{/other_user}","gists_url":"https://api.github.com/users/txdong-sz/gists{/gist_id}","starred_url":"https://api.github.com/users/txdong-sz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/txdong-sz/subscriptions","organizations_url":"https://api.github.com/users/txdong-sz/orgs","repos_url":"https://api.github.com/users/txdong-sz/repos","events_url":"https://api.github.com/users/txdong-sz/events{/privacy}","received_events_url":"https://api.github.com/users/txdong-sz/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-15T05:12:06Z","updated_at":"2020-12-15T05:12:06Z","author_association":"NONE","body":"what is the different of  TIMESTAMP(3) WITH LOCAL TIME ZONE  and   TIMESTAMP(6) WITH LOCAL TIME ZONE","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/745056654/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/745059522","html_url":"https://github.com/apache/iceberg/pull/1783#issuecomment-745059522","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1783","id":745059522,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NTA1OTUyMg==","user":{"login":"xabriel","id":218555,"node_id":"MDQ6VXNlcjIxODU1NQ==","avatar_url":"https://avatars.githubusercontent.com/u/218555?v=4","gravatar_id":"","url":"https://api.github.com/users/xabriel","html_url":"https://github.com/xabriel","followers_url":"https://api.github.com/users/xabriel/followers","following_url":"https://api.github.com/users/xabriel/following{/other_user}","gists_url":"https://api.github.com/users/xabriel/gists{/gist_id}","starred_url":"https://api.github.com/users/xabriel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xabriel/subscriptions","organizations_url":"https://api.github.com/users/xabriel/orgs","repos_url":"https://api.github.com/users/xabriel/repos","events_url":"https://api.github.com/users/xabriel/events{/privacy}","received_events_url":"https://api.github.com/users/xabriel/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-15T05:21:36Z","updated_at":"2020-12-15T05:21:36Z","author_association":"CONTRIBUTOR","body":"> > One thing I wanted to make explicit. The test TestSparkSchema3 has been removed as SupportsCatalogOptions doesn't allow to specify the schema. This introduces a breaking change between Spark2.4 and Spark3 based IcebergSource.\r\n> \r\n> Thanks @rymurr. I think this is the only remaining blocker.\r\n> \r\n> @prodeezy & @xabriel, do you specify the schema when reading Iceberg tables in Spark 3? I think the feature that this PR would disable was added by you, so I want to make sure you're okay with this potential change.\r\n\r\nThank you for the ping @rdblue.\r\n\r\nAll of our current code is based on Spark 2.4.X branch. We meant to pursue this further and to suggest a new API on the Spark 3 branch, but other work took precedence. The discussion is over at #590 (TL;DR: seems like we should have a `df.project(StructType)` API).\r\n\r\nSo yes this change will break us once we move to Spark 3. However I want to discuss internally whether we feel strongly about it or not. Will get back to this thread ASAP.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/745059522/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/745063201","html_url":"https://github.com/apache/iceberg/issues/1931#issuecomment-745063201","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1931","id":745063201,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NTA2MzIwMQ==","user":{"login":"zhangdove","id":25578853,"node_id":"MDQ6VXNlcjI1NTc4ODUz","avatar_url":"https://avatars.githubusercontent.com/u/25578853?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangdove","html_url":"https://github.com/zhangdove","followers_url":"https://api.github.com/users/zhangdove/followers","following_url":"https://api.github.com/users/zhangdove/following{/other_user}","gists_url":"https://api.github.com/users/zhangdove/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangdove/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangdove/subscriptions","organizations_url":"https://api.github.com/users/zhangdove/orgs","repos_url":"https://api.github.com/users/zhangdove/repos","events_url":"https://api.github.com/users/zhangdove/events{/privacy}","received_events_url":"https://api.github.com/users/zhangdove/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-15T05:32:44Z","updated_at":"2020-12-15T05:32:44Z","author_association":"CONTRIBUTOR","body":"Could you provide the version numbers of Spark and Iceberg? And more detailed steps and information?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/745063201/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/745196049","html_url":"https://github.com/apache/iceberg/pull/1870#issuecomment-745196049","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1870","id":745196049,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NTE5NjA0OQ==","user":{"login":"ismailsimsek","id":6005685,"node_id":"MDQ6VXNlcjYwMDU2ODU=","avatar_url":"https://avatars.githubusercontent.com/u/6005685?v=4","gravatar_id":"","url":"https://api.github.com/users/ismailsimsek","html_url":"https://github.com/ismailsimsek","followers_url":"https://api.github.com/users/ismailsimsek/followers","following_url":"https://api.github.com/users/ismailsimsek/following{/other_user}","gists_url":"https://api.github.com/users/ismailsimsek/gists{/gist_id}","starred_url":"https://api.github.com/users/ismailsimsek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ismailsimsek/subscriptions","organizations_url":"https://api.github.com/users/ismailsimsek/orgs","repos_url":"https://api.github.com/users/ismailsimsek/repos","events_url":"https://api.github.com/users/ismailsimsek/events{/privacy}","received_events_url":"https://api.github.com/users/ismailsimsek/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-15T10:24:01Z","updated_at":"2020-12-15T10:24:22Z","author_association":"CONTRIBUTOR","body":"@rdblue @kbendick @jackye1995 its ready for review.  \"Java CI / check\" failure doesn't seem related.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/745196049/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/745238862","html_url":"https://github.com/apache/iceberg/pull/1936#issuecomment-745238862","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1936","id":745238862,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NTIzODg2Mg==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-15T11:49:06Z","updated_at":"2020-12-15T11:49:06Z","author_association":"CONTRIBUTOR","body":"@openinx could you help review this  pr when you have time , thanks","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/745238862/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/745286527","html_url":"https://github.com/apache/iceberg/pull/1875#issuecomment-745286527","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1875","id":745286527,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NTI4NjUyNw==","user":{"login":"rymurr","id":2022305,"node_id":"MDQ6VXNlcjIwMjIzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/2022305?v=4","gravatar_id":"","url":"https://api.github.com/users/rymurr","html_url":"https://github.com/rymurr","followers_url":"https://api.github.com/users/rymurr/followers","following_url":"https://api.github.com/users/rymurr/following{/other_user}","gists_url":"https://api.github.com/users/rymurr/gists{/gist_id}","starred_url":"https://api.github.com/users/rymurr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rymurr/subscriptions","organizations_url":"https://api.github.com/users/rymurr/orgs","repos_url":"https://api.github.com/users/rymurr/repos","events_url":"https://api.github.com/users/rymurr/events{/privacy}","received_events_url":"https://api.github.com/users/rymurr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-15T13:28:04Z","updated_at":"2020-12-15T13:28:04Z","author_association":"CONTRIBUTOR","body":"I had another look at this, I am not super happy with the way the catalog name is chosen nor with the way the Hive catalog is instantiated in `CatalogUtil`. However there is very little code re-use and the Spark2 behaviour will be very similar to Spark3 wrt catalogs and identifiers. The surface area of this PR also has decreased (most of it is moving methods around).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/745286527/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/745447983","html_url":"https://github.com/apache/iceberg/issues/1931#issuecomment-745447983","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1931","id":745447983,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NTQ0Nzk4Mw==","user":{"login":"cccs-jc","id":56140112,"node_id":"MDQ6VXNlcjU2MTQwMTEy","avatar_url":"https://avatars.githubusercontent.com/u/56140112?v=4","gravatar_id":"","url":"https://api.github.com/users/cccs-jc","html_url":"https://github.com/cccs-jc","followers_url":"https://api.github.com/users/cccs-jc/followers","following_url":"https://api.github.com/users/cccs-jc/following{/other_user}","gists_url":"https://api.github.com/users/cccs-jc/gists{/gist_id}","starred_url":"https://api.github.com/users/cccs-jc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cccs-jc/subscriptions","organizations_url":"https://api.github.com/users/cccs-jc/orgs","repos_url":"https://api.github.com/users/cccs-jc/repos","events_url":"https://api.github.com/users/cccs-jc/events{/privacy}","received_events_url":"https://api.github.com/users/cccs-jc/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-15T17:35:32Z","updated_at":"2020-12-15T21:11:09Z","author_association":"CONTRIBUTOR","body":"Iceberg 0.9.0\r\nspark 3.0.0\r\n\r\nClosing this issue. I was running the command against a copy of the table. I did not think of the fact that in the metadata it references the files by absolute paths. So you cannot simply copy the entire data and metadata folders to create a clone of an iceberg table.\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/745447983/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/745534201","html_url":"https://github.com/apache/iceberg/pull/1932#issuecomment-745534201","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1932","id":745534201,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NTUzNDIwMQ==","user":{"login":"karuppayya","id":5082742,"node_id":"MDQ6VXNlcjUwODI3NDI=","avatar_url":"https://avatars.githubusercontent.com/u/5082742?v=4","gravatar_id":"","url":"https://api.github.com/users/karuppayya","html_url":"https://github.com/karuppayya","followers_url":"https://api.github.com/users/karuppayya/followers","following_url":"https://api.github.com/users/karuppayya/following{/other_user}","gists_url":"https://api.github.com/users/karuppayya/gists{/gist_id}","starred_url":"https://api.github.com/users/karuppayya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/karuppayya/subscriptions","organizations_url":"https://api.github.com/users/karuppayya/orgs","repos_url":"https://api.github.com/users/karuppayya/repos","events_url":"https://api.github.com/users/karuppayya/events{/privacy}","received_events_url":"https://api.github.com/users/karuppayya/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-15T20:02:54Z","updated_at":"2020-12-15T20:02:54Z","author_association":"CONTRIBUTOR","body":"I have removed the data correctness changes. After the removal, there are some minor refactoring(assertions, initialization etc). There are no other significant improvements. We can take the changes either in this PR or in a future PR relating to these tests. @rdblue @aokolnychyi @RussellSpitzer ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/745534201/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/745568607","html_url":"https://github.com/apache/iceberg/pull/1932#issuecomment-745568607","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1932","id":745568607,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NTU2ODYwNw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-15T21:08:58Z","updated_at":"2020-12-15T21:08:58Z","author_association":"CONTRIBUTOR","body":"Thanks @karuppayya! I merged this. Hopefully tests are a bit faster now!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/745568607/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/745710832","html_url":"https://github.com/apache/iceberg/pull/1919#issuecomment-745710832","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1919","id":745710832,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NTcxMDgzMg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-16T01:50:46Z","updated_at":"2020-12-16T01:51:31Z","author_association":"CONTRIBUTOR","body":"> The only open question I have is what about type promotion of partition fields.\r\n\r\nPartitions fields store the type output by the partition transform. In a lot of cases, that won't change. For example, bucket always produces ints no matter what the input type. Some transforms, like identity, will produce values of the input type. The only way to change the output type for those transforms is to change the input type through column promotion. When an identity partition column is promoted from int to long or float to double, the partition column is promoted automatically as well and the existing values are promoted on read.\r\n\r\nIn case you're wondering, we were also careful to make sure type promotion doesn't change the result of any partition functions. If the partition transform doesn't produce the same value when it is promoted after transformation, then promotion must be done before the transformation: `bucket(int_col, width)` is actually `bucket((long) int_col, width)`. (This is also one reason why promotion to String is dangerous and not supported.)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/745710832/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/745711250","html_url":"https://github.com/apache/iceberg/pull/1919#issuecomment-745711250","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1919","id":745711250,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NTcxMTI1MA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-16T01:52:09Z","updated_at":"2020-12-16T01:52:09Z","author_association":"CONTRIBUTOR","body":"Thanks for reviewing, @danielcweeks and @johnclara! I'll merge this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/745711250/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/745713500","html_url":"https://github.com/apache/iceberg/issues/1934#issuecomment-745713500","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1934","id":745713500,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NTcxMzUwMA==","user":{"login":"txdong-sz","id":5066512,"node_id":"MDQ6VXNlcjUwNjY1MTI=","avatar_url":"https://avatars.githubusercontent.com/u/5066512?v=4","gravatar_id":"","url":"https://api.github.com/users/txdong-sz","html_url":"https://github.com/txdong-sz","followers_url":"https://api.github.com/users/txdong-sz/followers","following_url":"https://api.github.com/users/txdong-sz/following{/other_user}","gists_url":"https://api.github.com/users/txdong-sz/gists{/gist_id}","starred_url":"https://api.github.com/users/txdong-sz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/txdong-sz/subscriptions","organizations_url":"https://api.github.com/users/txdong-sz/orgs","repos_url":"https://api.github.com/users/txdong-sz/repos","events_url":"https://api.github.com/users/txdong-sz/events{/privacy}","received_events_url":"https://api.github.com/users/txdong-sz/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-16T01:59:53Z","updated_at":"2020-12-16T01:59:53Z","author_association":"NONE","body":"@jacques-n \r\ni also think that it is not need to check metadata.json   \r\nif namespace with metadata folder in   so we can just consider that is a table\r\nor eles \r\ncheck if that metadata folder have a version-hint.text   file in it \r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/745713500/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/746072184","html_url":"https://github.com/apache/iceberg/pull/1917#issuecomment-746072184","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1917","id":746072184,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NjA3MjE4NA==","user":{"login":"marton-bod","id":19599214,"node_id":"MDQ6VXNlcjE5NTk5MjE0","avatar_url":"https://avatars.githubusercontent.com/u/19599214?v=4","gravatar_id":"","url":"https://api.github.com/users/marton-bod","html_url":"https://github.com/marton-bod","followers_url":"https://api.github.com/users/marton-bod/followers","following_url":"https://api.github.com/users/marton-bod/following{/other_user}","gists_url":"https://api.github.com/users/marton-bod/gists{/gist_id}","starred_url":"https://api.github.com/users/marton-bod/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marton-bod/subscriptions","organizations_url":"https://api.github.com/users/marton-bod/orgs","repos_url":"https://api.github.com/users/marton-bod/repos","events_url":"https://api.github.com/users/marton-bod/events{/privacy}","received_events_url":"https://api.github.com/users/marton-bod/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-16T10:40:44Z","updated_at":"2020-12-16T10:40:44Z","author_association":"COLLABORATOR","body":"@rdblue Could you please take a look at this as well, whenever suitable? :) Thank you!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/746072184/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/746454110","html_url":"https://github.com/apache/iceberg/pull/1508#issuecomment-746454110","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1508","id":746454110,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NjQ1NDExMA==","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-16T15:15:28Z","updated_at":"2020-12-16T15:15:28Z","author_association":"CONTRIBUTOR","body":"Sorry for the long pause.\r\nMy understanding is that the metadata-log (`TableMetadata.previousFiles()`) is in order of metadata committed, even if the timestamps may not be in order due to clock skew on different machines from which the commits are done. I have implemented @edwinchoi's suggestion to read each metadata file listed in the metadata-log to find the first one where the current-snapshot-id matches the target snapshot id.\r\nI have rebased on master (probably behind again by now), and made some changes accordingly.\r\n@rdblue, can you please take a look at this again?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/746454110/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/746730051","html_url":"https://github.com/apache/iceberg/issues/1548#issuecomment-746730051","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1548","id":746730051,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NjczMDA1MQ==","user":{"login":"holdenk","id":59893,"node_id":"MDQ6VXNlcjU5ODkz","avatar_url":"https://avatars.githubusercontent.com/u/59893?v=4","gravatar_id":"","url":"https://api.github.com/users/holdenk","html_url":"https://github.com/holdenk","followers_url":"https://api.github.com/users/holdenk/followers","following_url":"https://api.github.com/users/holdenk/following{/other_user}","gists_url":"https://api.github.com/users/holdenk/gists{/gist_id}","starred_url":"https://api.github.com/users/holdenk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/holdenk/subscriptions","organizations_url":"https://api.github.com/users/holdenk/orgs","repos_url":"https://api.github.com/users/holdenk/repos","events_url":"https://api.github.com/users/holdenk/events{/privacy}","received_events_url":"https://api.github.com/users/holdenk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-16T17:56:15Z","updated_at":"2020-12-16T17:56:15Z","author_association":"CONTRIBUTOR","body":"Rocking, I've finally got a bit of time for next week, I'll pick this up :)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/746730051/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/746731138","html_url":"https://github.com/apache/iceberg/pull/1421#issuecomment-746731138","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1421","id":746731138,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NjczMTEzOA==","user":{"login":"holdenk","id":59893,"node_id":"MDQ6VXNlcjU5ODkz","avatar_url":"https://avatars.githubusercontent.com/u/59893?v=4","gravatar_id":"","url":"https://api.github.com/users/holdenk","html_url":"https://github.com/holdenk","followers_url":"https://api.github.com/users/holdenk/followers","following_url":"https://api.github.com/users/holdenk/following{/other_user}","gists_url":"https://api.github.com/users/holdenk/gists{/gist_id}","starred_url":"https://api.github.com/users/holdenk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/holdenk/subscriptions","organizations_url":"https://api.github.com/users/holdenk/orgs","repos_url":"https://api.github.com/users/holdenk/repos","events_url":"https://api.github.com/users/holdenk/events{/privacy}","received_events_url":"https://api.github.com/users/holdenk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-16T17:56:54Z","updated_at":"2020-12-16T17:56:54Z","author_association":"CONTRIBUTOR","body":"I see this is out of date with the dev branch, are you still working on this?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/746731138/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/746826772","html_url":"https://github.com/apache/iceberg/pull/1942#issuecomment-746826772","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1942","id":746826772,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NjgyNjc3Mg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-16T18:55:56Z","updated_at":"2020-12-16T18:55:56Z","author_association":"CONTRIBUTOR","body":"@jun-he, I've extracted the partition spec update operation from #922 and added it on top of #1919. Most of these changes are yours, except I swapped out the API. There are also some additional changes in #922 that I didn't add because I wanted to keep this small. It would be great to have some of those refactors done, like updating tests to use the new API, if you are interested in contributing those changes in separate PRs or rebasing #922.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/746826772/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/746896078","html_url":"https://github.com/apache/iceberg/pull/1942#issuecomment-746896078","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1942","id":746896078,"node_id":"MDEyOklzc3VlQ29tbWVudDc0Njg5NjA3OA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-16T19:39:14Z","updated_at":"2020-12-16T19:39:14Z","author_association":"CONTRIBUTOR","body":"Thanks for reviewing, @aokolnychyi!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/746896078/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747042759","html_url":"https://github.com/apache/iceberg/pull/1942#issuecomment-747042759","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1942","id":747042759,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NzA0Mjc1OQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-16T21:22:19Z","updated_at":"2020-12-16T21:22:19Z","author_association":"CONTRIBUTOR","body":"Thanks for reviewing, @aokolnychyi!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747042759/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747082020","html_url":"https://github.com/apache/iceberg/pull/1947#issuecomment-747082020","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1947","id":747082020,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NzA4MjAyMA==","user":{"login":"dilipbiswal","id":14225158,"node_id":"MDQ6VXNlcjE0MjI1MTU4","avatar_url":"https://avatars.githubusercontent.com/u/14225158?v=4","gravatar_id":"","url":"https://api.github.com/users/dilipbiswal","html_url":"https://github.com/dilipbiswal","followers_url":"https://api.github.com/users/dilipbiswal/followers","following_url":"https://api.github.com/users/dilipbiswal/following{/other_user}","gists_url":"https://api.github.com/users/dilipbiswal/gists{/gist_id}","starred_url":"https://api.github.com/users/dilipbiswal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dilipbiswal/subscriptions","organizations_url":"https://api.github.com/users/dilipbiswal/orgs","repos_url":"https://api.github.com/users/dilipbiswal/repos","events_url":"https://api.github.com/users/dilipbiswal/events{/privacy}","received_events_url":"https://api.github.com/users/dilipbiswal/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-16T22:36:46Z","updated_at":"2020-12-16T22:36:46Z","author_association":"CONTRIBUTOR","body":"cc @aokolnychyi @rdblue @mehtaashish23 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747082020/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747084544","html_url":"https://github.com/apache/iceberg/pull/1945#issuecomment-747084544","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1945","id":747084544,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NzA4NDU0NA==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-16T22:42:02Z","updated_at":"2020-12-16T22:42:02Z","author_association":"CONTRIBUTOR","body":"There are also quite a few confusions about this internally, let me ask s3 directly","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747084544/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747089017","html_url":"https://github.com/apache/iceberg/pull/1945#issuecomment-747089017","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1945","id":747089017,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NzA4OTAxNw==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-16T22:52:12Z","updated_at":"2020-12-16T22:52:12Z","author_association":"CONTRIBUTOR","body":"Cool, the S3 team confirmed that all read operations including HEAD is now strongly consistent, so this can be reverted, sorry for the confusion.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747089017/reactions","total_count":4,"+1":2,"-1":0,"laugh":0,"hooray":2,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747106969","html_url":"https://github.com/apache/iceberg/issues/1949#issuecomment-747106969","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1949","id":747106969,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NzEwNjk2OQ==","user":{"login":"mehtaashish23","id":75326,"node_id":"MDQ6VXNlcjc1MzI2","avatar_url":"https://avatars.githubusercontent.com/u/75326?v=4","gravatar_id":"","url":"https://api.github.com/users/mehtaashish23","html_url":"https://github.com/mehtaashish23","followers_url":"https://api.github.com/users/mehtaashish23/followers","following_url":"https://api.github.com/users/mehtaashish23/following{/other_user}","gists_url":"https://api.github.com/users/mehtaashish23/gists{/gist_id}","starred_url":"https://api.github.com/users/mehtaashish23/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mehtaashish23/subscriptions","organizations_url":"https://api.github.com/users/mehtaashish23/orgs","repos_url":"https://api.github.com/users/mehtaashish23/repos","events_url":"https://api.github.com/users/mehtaashish23/events{/privacy}","received_events_url":"https://api.github.com/users/mehtaashish23/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-16T23:41:34Z","updated_at":"2020-12-16T23:41:34Z","author_association":"CONTRIBUTOR","body":"@rdblue , @aokolnychyi Let me know your thoughts on it. We would like to contribute this to community ASAP, since we are looking to use copy-on-write mode with Delete/MergeInto (before switching to \"merge on read\" implementation)\r\n\r\ncc: @dilipbiswal","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747106969/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747107978","html_url":"https://github.com/apache/iceberg/pull/1945#issuecomment-747107978","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1945","id":747107978,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NzEwNzk3OA==","user":{"login":"HeartSaVioR","id":1317309,"node_id":"MDQ6VXNlcjEzMTczMDk=","avatar_url":"https://avatars.githubusercontent.com/u/1317309?v=4","gravatar_id":"","url":"https://api.github.com/users/HeartSaVioR","html_url":"https://github.com/HeartSaVioR","followers_url":"https://api.github.com/users/HeartSaVioR/followers","following_url":"https://api.github.com/users/HeartSaVioR/following{/other_user}","gists_url":"https://api.github.com/users/HeartSaVioR/gists{/gist_id}","starred_url":"https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HeartSaVioR/subscriptions","organizations_url":"https://api.github.com/users/HeartSaVioR/orgs","repos_url":"https://api.github.com/users/HeartSaVioR/repos","events_url":"https://api.github.com/users/HeartSaVioR/events{/privacy}","received_events_url":"https://api.github.com/users/HeartSaVioR/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-16T23:44:37Z","updated_at":"2020-12-16T23:44:58Z","author_association":"CONTRIBUTOR","body":"Thanks for confirming the fact that negative cache is gone.\r\n\r\nThat said, would you mind if I ask about the documentation of aws module, especially mentioning the rationalization (benefits) of the existence of the module? (Say, you'll want to use the aws module instead of simply using Hadoop API on S3 support because...)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747107978/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747120796","html_url":"https://github.com/apache/iceberg/pull/1945#issuecomment-747120796","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1945","id":747120796,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NzEyMDc5Ng==","user":{"login":"danielcweeks","id":4925077,"node_id":"MDQ6VXNlcjQ5MjUwNzc=","avatar_url":"https://avatars.githubusercontent.com/u/4925077?v=4","gravatar_id":"","url":"https://api.github.com/users/danielcweeks","html_url":"https://github.com/danielcweeks","followers_url":"https://api.github.com/users/danielcweeks/followers","following_url":"https://api.github.com/users/danielcweeks/following{/other_user}","gists_url":"https://api.github.com/users/danielcweeks/gists{/gist_id}","starred_url":"https://api.github.com/users/danielcweeks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielcweeks/subscriptions","organizations_url":"https://api.github.com/users/danielcweeks/orgs","repos_url":"https://api.github.com/users/danielcweeks/repos","events_url":"https://api.github.com/users/danielcweeks/events{/privacy}","received_events_url":"https://api.github.com/users/danielcweeks/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-17T00:23:37Z","updated_at":"2020-12-17T00:23:37Z","author_association":"CONTRIBUTOR","body":"> Thanks for confirming the fact that negative cache is gone.\r\n> \r\n> That said, would you mind if I ask about the documentation of aws module, especially mentioning the rationalization (benefits) of the existence of the module? (Say, you'll want to use the aws module instead of simply using Hadoop API on S3 support because...)\r\n\r\n@HeartSaVioR good question, but I think that's probably beyond the scope for this specific PR, but would be great to raise in #1891 which is more documentation related (and may be getting at your exact question).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747120796/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747122046","html_url":"https://github.com/apache/iceberg/pull/1945#issuecomment-747122046","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1945","id":747122046,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NzEyMjA0Ng==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-17T00:26:19Z","updated_at":"2020-12-17T00:26:19Z","author_association":"CONTRIBUTOR","body":"Great to hear that HEAD requests are consistent! Thanks @jackye1995 and @danielcweeks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747122046/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747137094","html_url":"https://github.com/apache/iceberg/pull/1572#issuecomment-747137094","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1572","id":747137094,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NzEzNzA5NA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-17T01:03:31Z","updated_at":"2020-12-17T01:03:31Z","author_association":"CONTRIBUTOR","body":"I just talked with @holdenk directly about this and we agreed that it probably isn't the right direction to go because the shared code needs to be carried by an interface instead of an abstract class. The interface can't handle its own state, so it ends up having way more method calls to get state from the child classes. That splits state that should be managed by a single class across multiple places (e.g. buffer growth) and could introduce unnecessary dispatch costs due to the calls.\r\n\r\nWe agreed that it is cleaner to have some code duplication instead, so I'll close this issue. Thanks for investigating it and working on the prototype, @holdenk!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747137094/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747140414","html_url":"https://github.com/apache/iceberg/pull/1945#issuecomment-747140414","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1945","id":747140414,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NzE0MDQxNA==","user":{"login":"HeartSaVioR","id":1317309,"node_id":"MDQ6VXNlcjEzMTczMDk=","avatar_url":"https://avatars.githubusercontent.com/u/1317309?v=4","gravatar_id":"","url":"https://api.github.com/users/HeartSaVioR","html_url":"https://github.com/HeartSaVioR","followers_url":"https://api.github.com/users/HeartSaVioR/followers","following_url":"https://api.github.com/users/HeartSaVioR/following{/other_user}","gists_url":"https://api.github.com/users/HeartSaVioR/gists{/gist_id}","starred_url":"https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HeartSaVioR/subscriptions","organizations_url":"https://api.github.com/users/HeartSaVioR/orgs","repos_url":"https://api.github.com/users/HeartSaVioR/repos","events_url":"https://api.github.com/users/HeartSaVioR/events{/privacy}","received_events_url":"https://api.github.com/users/HeartSaVioR/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-17T01:14:25Z","updated_at":"2020-12-17T01:14:25Z","author_association":"CONTRIBUTOR","body":"@danielcweeks Sorry I missed there's already PR submitted. Thanks for the reference!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747140414/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747142066","html_url":"https://github.com/apache/iceberg/issues/1940#issuecomment-747142066","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1940","id":747142066,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NzE0MjA2Ng==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-17T01:19:42Z","updated_at":"2020-12-17T01:37:32Z","author_association":"CONTRIBUTOR","body":"do not create the kafka table on iceberg catalog , on the default catalog","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747142066/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747146918","html_url":"https://github.com/apache/iceberg/issues/1914#issuecomment-747146918","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1914","id":747146918,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NzE0NjkxOA==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-17T01:35:37Z","updated_at":"2020-12-17T01:39:45Z","author_association":"CONTRIBUTOR","body":"> @HeartSaVioR the reson why i need to use spark and flink is that\r\n> \r\n> 1. flink is not support by partition by hour\r\n>    ![image](https://user-images.githubusercontent.com/5066512/102064596-765c9d00-3e32-11eb-8f7e-081d42afeadb.png)\r\n>    and my table is very huge .  that is not a good parctice\r\n> 2. flink sql is standalone .  my table is huge ,so  i need more resource to run sql   and choose spark\r\n> \r\n> we use flink to write stream data to cos . it is of efficiency\r\n\r\n\r\n\r\n1. you can  create an iceberg table with flink sql\r\n ```\r\nCREATE TABLE iceberg.iceberg_db.iceberg_table (\r\n  id BIGINT COMMENT 'unique id',\r\n  data STRING,\r\n  `day` int\r\n  `hour` int) \r\nPARTITIONED BY (`day`,`hour`)\r\nWITH ('connector'='iceberg','write.format.default'='orc')\r\n\r\n```\r\n\r\nand write into the iceberg table with flink streaming sql :\r\n\r\n```\r\nINSERT INTO iceberg.iceberg_db.iceberg_table \r\nselect id ,data,DAYOFMONTH(your_timestamp),hour(your_timestamp) from kafka_table\r\n```\r\n\r\n\r\n2. flink sql client can use standalone cluster and yarn session cluster , you can start a yarn session cluster first ,and then submit the flink sql job to the session cluster .\r\n\r\nand set the parallelism for every flink sql job by the command:\r\n```\r\nset table.exec.resource.default-parallelism = 100\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747146918/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747147630","html_url":"https://github.com/apache/iceberg/pull/1917#issuecomment-747147630","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1917","id":747147630,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NzE0NzYzMA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-17T01:37:52Z","updated_at":"2020-12-17T01:37:52Z","author_association":"CONTRIBUTOR","body":"Thanks @marton-bod for reviewing, and @pvary for working on this!\r\n\r\nIt looks good to me. I noted a few nits to fix, but I'm also fine merging this if you don't have time to fix them. I'll wait a day or two and then merge if I don't hear back.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747147630/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747148191","html_url":"https://github.com/apache/iceberg/pull/922#issuecomment-747148191","issue_url":"https://api.github.com/repos/apache/iceberg/issues/922","id":747148191,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NzE0ODE5MQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-17T01:39:44Z","updated_at":"2020-12-17T01:39:44Z","author_association":"CONTRIBUTOR","body":"Most of the changes here are included in #1942 so I'll close this. It would be nice to get some of the test updates in another PR, though. Thanks @jun-he!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747148191/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747153858","html_url":"https://github.com/apache/iceberg/pull/1939#issuecomment-747153858","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1939","id":747153858,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NzE1Mzg1OA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-17T01:57:53Z","updated_at":"2020-12-17T01:57:53Z","author_association":"CONTRIBUTOR","body":"Looks good overall, thought I didn't look into the tests very thoroughly. Since this is getting into quite a bit of Flink logic, I'd appreciate it if @JingsongLi and @stevenzwu could also take a look and review.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747153858/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747154300","html_url":"https://github.com/apache/iceberg/pull/1946#issuecomment-747154300","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1946","id":747154300,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NzE1NDMwMA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-17T01:59:23Z","updated_at":"2020-12-17T01:59:23Z","author_association":"CONTRIBUTOR","body":"Thanks @yyanyy, I'll take a look at this one soon!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747154300/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747154770","html_url":"https://github.com/apache/iceberg/issues/1938#issuecomment-747154770","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1938","id":747154770,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NzE1NDc3MA==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-17T02:00:49Z","updated_at":"2020-12-17T02:00:49Z","author_association":"CONTRIBUTOR","body":"you can trace the pr https://github.com/apache/iceberg/issues/1617","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747154770/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747155128","html_url":"https://github.com/apache/iceberg/pull/1829#issuecomment-747155128","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1829","id":747155128,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NzE1NTEyOA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-17T02:01:49Z","updated_at":"2020-12-17T02:01:49Z","author_association":"CONTRIBUTOR","body":"Thanks for updating this, @yyanyy! I'll merge it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747155128/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747155334","html_url":"https://github.com/apache/iceberg/pull/1947#issuecomment-747155334","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1947","id":747155334,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NzE1NTMzNA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-17T02:02:30Z","updated_at":"2020-12-17T02:02:30Z","author_association":"CONTRIBUTOR","body":"Thanks @dilipbiswal! I'll take a closer look at this tomorrow.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747155334/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747156117","html_url":"https://github.com/apache/iceberg/issues/1938#issuecomment-747156117","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1938","id":747156117,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NzE1NjExNw==","user":{"login":"scanry","id":9125005,"node_id":"MDQ6VXNlcjkxMjUwMDU=","avatar_url":"https://avatars.githubusercontent.com/u/9125005?v=4","gravatar_id":"","url":"https://api.github.com/users/scanry","html_url":"https://github.com/scanry","followers_url":"https://api.github.com/users/scanry/followers","following_url":"https://api.github.com/users/scanry/following{/other_user}","gists_url":"https://api.github.com/users/scanry/gists{/gist_id}","starred_url":"https://api.github.com/users/scanry/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/scanry/subscriptions","organizations_url":"https://api.github.com/users/scanry/orgs","repos_url":"https://api.github.com/users/scanry/repos","events_url":"https://api.github.com/users/scanry/events{/privacy}","received_events_url":"https://api.github.com/users/scanry/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-17T02:04:47Z","updated_at":"2020-12-17T02:04:47Z","author_association":"NONE","body":"> you can trace the pr #1617\r\n\r\nthanks","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747156117/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747156346","html_url":"https://github.com/apache/iceberg/issues/1949#issuecomment-747156346","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1949","id":747156346,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NzE1NjM0Ng==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-17T02:05:30Z","updated_at":"2020-12-17T02:05:30Z","author_association":"CONTRIBUTOR","body":"Can you give us a clearer example of what you're trying to support here? I'm trying to understand the use case for ignoring the deletes in an overwrite.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747156346/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747156814","html_url":"https://github.com/apache/iceberg/issues/1816#issuecomment-747156814","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1816","id":747156814,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NzE1NjgxNA==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-17T02:06:54Z","updated_at":"2020-12-17T02:06:54Z","author_association":"CONTRIBUTOR","body":"done","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747156814/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747169900","html_url":"https://github.com/apache/iceberg/issues/1940#issuecomment-747169900","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1940","id":747169900,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NzE2OTkwMA==","user":{"login":"thirdparty-core","id":16370666,"node_id":"MDQ6VXNlcjE2MzcwNjY2","avatar_url":"https://avatars.githubusercontent.com/u/16370666?v=4","gravatar_id":"","url":"https://api.github.com/users/thirdparty-core","html_url":"https://github.com/thirdparty-core","followers_url":"https://api.github.com/users/thirdparty-core/followers","following_url":"https://api.github.com/users/thirdparty-core/following{/other_user}","gists_url":"https://api.github.com/users/thirdparty-core/gists{/gist_id}","starred_url":"https://api.github.com/users/thirdparty-core/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thirdparty-core/subscriptions","organizations_url":"https://api.github.com/users/thirdparty-core/orgs","repos_url":"https://api.github.com/users/thirdparty-core/repos","events_url":"https://api.github.com/users/thirdparty-core/events{/privacy}","received_events_url":"https://api.github.com/users/thirdparty-core/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-17T02:51:10Z","updated_at":"2020-12-17T02:51:10Z","author_association":"NONE","body":"According to your tips, it's working. \r\nThank you very much.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747169900/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747250046","html_url":"https://github.com/apache/iceberg/pull/1893#issuecomment-747250046","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1893","id":747250046,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NzI1MDA0Ng==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-17T06:54:37Z","updated_at":"2020-12-17T06:54:37Z","author_association":"CONTRIBUTOR","body":"@yyanyy thanks for your review,I update all","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747250046/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747305956","html_url":"https://github.com/apache/iceberg/pull/1947#issuecomment-747305956","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1947","id":747305956,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NzMwNTk1Ng==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-17T08:59:29Z","updated_at":"2020-12-17T08:59:29Z","author_association":"CONTRIBUTOR","body":"Ack.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747305956/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747403484","html_url":"https://github.com/apache/iceberg/issues/1914#issuecomment-747403484","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1914","id":747403484,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NzQwMzQ4NA==","user":{"login":"sshkvar","id":3986221,"node_id":"MDQ6VXNlcjM5ODYyMjE=","avatar_url":"https://avatars.githubusercontent.com/u/3986221?v=4","gravatar_id":"","url":"https://api.github.com/users/sshkvar","html_url":"https://github.com/sshkvar","followers_url":"https://api.github.com/users/sshkvar/followers","following_url":"https://api.github.com/users/sshkvar/following{/other_user}","gists_url":"https://api.github.com/users/sshkvar/gists{/gist_id}","starred_url":"https://api.github.com/users/sshkvar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sshkvar/subscriptions","organizations_url":"https://api.github.com/users/sshkvar/orgs","repos_url":"https://api.github.com/users/sshkvar/repos","events_url":"https://api.github.com/users/sshkvar/events{/privacy}","received_events_url":"https://api.github.com/users/sshkvar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-17T12:14:11Z","updated_at":"2020-12-17T12:14:11Z","author_association":"CONTRIBUTOR","body":"We have the same issue, Spark can't read iceberg tables which were created by Presto. \r\nPresto connector and Iceberg supports timestamp without timezone. \r\nIs it possible to add support of timestamp without timezone to iceber-spark-runtime? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747403484/reactions","total_count":3,"+1":3,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747450897","html_url":"https://github.com/apache/iceberg/pull/1947#issuecomment-747450897","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1947","id":747450897,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NzQ1MDg5Nw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-17T13:51:32Z","updated_at":"2020-12-17T13:55:13Z","author_association":"CONTRIBUTOR","body":"I think this PR is a great start, @dilipbiswal!\r\n\r\nI noted the following points that we need to address for correctness (some may be done separately):\r\n- We should perform the cardinality check as SQL standard requires.\r\n- We should align the assignments according to the target columns. This also applies to UPDATE.\r\n- We should think about how to group data before writing.\r\n- We will need more tests.\r\n\r\nThere are also good to have points (can be done in follow-ups if too much trouble):\r\n- We should use a LEFT ANTI join for merge statements with only `WHEN NOT MATCHED THEN INSERT` clause.\r\n- We should use a RIGHT OUTER join for merge statements with only `WHEN MATCHED` clauses.\r\n\r\nLet's discuss each point one by one.\r\n\r\n**Cardinality check**\r\n\r\nSQL standard requires an exception to be thrown if the ON clause in MERGE is such that more than 1 row in source matches a row in target. See [this](https://issues.apache.org/jira/browse/HIVE-14949) Hive issue for more info.\r\n\r\nSome systems do the cardinality check all the time while some, like Hive, make it optional. I'd say we should make it optional and let users configure it in the table properties by adding `write.merge.cardinality-check.enabled` property (true by default). The main problem with the cardinality check is the performance penalty: it requires an inner join. We are already doing this inner join for copy-on-write to find matches so we can modify that code to also do the cardinality check at the same time. I don't think we need an inner join for merge-on-read, though. \r\n\r\nTo sum up, I'd vote for having a flag in table properties and make the cardinality check optional (just like Hive ACID).\r\n\r\nWe need to think a bit about how we implement the cardinality check. Here, I am open to suggestions. One idea is to modify nodes for dynamic file filtering. For example, we can use `monotonically_increasing_id` until we have `row_id` metadata column, append it to rows in the target table before the inner join to find matches and then perform the cardinality check and collect matching files. In order to make this efficient, we should reuse as much work as possible.\r\n\r\nOne way to do that is to leverage an accumulator to track matching files:\r\n- append `_row_id` and `_file` columns to the target table\r\n- do an inner join on the merge condition\r\n- define a udf that accepts the file name, adds it to the accumulator and retuns 1\r\n- group by `_row_id`, perform the cardinality check\r\n- access the accumulator to get the matching files\r\n\r\nAnother way is like this:\r\n- append `_row_id` and `_file` columns to the target table\r\n- do an inner join on the merge condition\r\n- select `_row_id`,  `_file` into a separate plan\r\n- temporarily cache the created plan (or persist it on executor nodes)\r\n- perform 2 queries in parallel: one for cardinality check and one for the matching files\r\n- uncache/destroy the temp plan\r\n\r\n**Align assignments**\r\n\r\nI don't think Spark aligns the assignments inside UPDATE or MERGE. We won't be able to support updating nested fields without it. We will probably need a separate rule for this. The same rule can be applied to UPDATE.\r\n\r\n**Group data before writing**\r\n\r\nWe need to think about how to group data before writing new files with our updates and new records. One option is to group and order by partition columns. Another option is to group and order by the sort spec. The third option is to group updates and new records separately. Let's discuss it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747450897/reactions","total_count":4,"+1":4,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747453154","html_url":"https://github.com/apache/iceberg/pull/1947#issuecomment-747453154","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1947","id":747453154,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NzQ1MzE1NA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-17T13:55:41Z","updated_at":"2020-12-17T13:55:41Z","author_association":"CONTRIBUTOR","body":"BTW, I can work on some of these items in parallel so that we finish this ealier.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747453154/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747498481","html_url":"https://github.com/apache/iceberg/pull/1947#issuecomment-747498481","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1947","id":747498481,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NzQ5ODQ4MQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-17T15:12:36Z","updated_at":"2020-12-17T15:12:36Z","author_association":"MEMBER","body":"One thing we've been talking about it a bit is whether or not it would be useful to tune the write portion of this. For example it may be helpful to have an independent parameter for tuning the shuffle parameters when grouping the results before writing. This probably would be good to tune with a non-spark parameter so that users can customize it apart from the normal spark.sql.shuffle parameter.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747498481/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747635739","html_url":"https://github.com/apache/iceberg/issues/1952#issuecomment-747635739","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1952","id":747635739,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NzYzNTczOQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-17T19:01:40Z","updated_at":"2020-12-17T19:01:40Z","author_association":"CONTRIBUTOR","body":"Yes, I think we will need a `NotStartsWith` to handle this.\r\n\r\nWe can't keep the `Not` after rewriting because some evaluation doesn't support negation. For example, when lower and upper bounds are used to evaluate whether to read a file, the result may be true to indicate that the value may be contained in the file. That should not be negated because it does not confirm that the value is definitely in the file: if looking for files that \"do not contain X\", we can't use \"not(file might contain X)\".","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747635739/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747682529","html_url":"https://github.com/apache/iceberg/pull/1909#issuecomment-747682529","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1909","id":747682529,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NzY4MjUyOQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-17T20:26:46Z","updated_at":"2020-12-17T20:26:46Z","author_association":"CONTRIBUTOR","body":"Tests are passing, so I'll merge this. Thanks @yyanyy, @RussellSpitzer, and @aokolnychyi for reviewing!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747682529/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747686028","html_url":"https://github.com/apache/iceberg/pull/1953#issuecomment-747686028","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1953","id":747686028,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NzY4NjAyOA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-17T20:33:46Z","updated_at":"2020-12-17T20:33:46Z","author_association":"CONTRIBUTOR","body":"Thanks @shardulm94!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747686028/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747703996","html_url":"https://github.com/apache/iceberg/pull/1947#issuecomment-747703996","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1947","id":747703996,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NzcwMzk5Ng==","user":{"login":"dilipbiswal","id":14225158,"node_id":"MDQ6VXNlcjE0MjI1MTU4","avatar_url":"https://avatars.githubusercontent.com/u/14225158?v=4","gravatar_id":"","url":"https://api.github.com/users/dilipbiswal","html_url":"https://github.com/dilipbiswal","followers_url":"https://api.github.com/users/dilipbiswal/followers","following_url":"https://api.github.com/users/dilipbiswal/following{/other_user}","gists_url":"https://api.github.com/users/dilipbiswal/gists{/gist_id}","starred_url":"https://api.github.com/users/dilipbiswal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dilipbiswal/subscriptions","organizations_url":"https://api.github.com/users/dilipbiswal/orgs","repos_url":"https://api.github.com/users/dilipbiswal/repos","events_url":"https://api.github.com/users/dilipbiswal/events{/privacy}","received_events_url":"https://api.github.com/users/dilipbiswal/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-17T21:10:37Z","updated_at":"2020-12-17T21:10:37Z","author_association":"CONTRIBUTOR","body":"@aokolnychyi @RussellSpitzer \r\nThanks for those excellent comments. I am going to process them and get back  :-)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747703996/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747782500","html_url":"https://github.com/apache/iceberg/issues/1654#issuecomment-747782500","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1654","id":747782500,"node_id":"MDEyOklzc3VlQ29tbWVudDc0Nzc4MjUwMA==","user":{"login":"mickjermsurawong-stripe","id":42550941,"node_id":"MDQ6VXNlcjQyNTUwOTQx","avatar_url":"https://avatars.githubusercontent.com/u/42550941?v=4","gravatar_id":"","url":"https://api.github.com/users/mickjermsurawong-stripe","html_url":"https://github.com/mickjermsurawong-stripe","followers_url":"https://api.github.com/users/mickjermsurawong-stripe/followers","following_url":"https://api.github.com/users/mickjermsurawong-stripe/following{/other_user}","gists_url":"https://api.github.com/users/mickjermsurawong-stripe/gists{/gist_id}","starred_url":"https://api.github.com/users/mickjermsurawong-stripe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mickjermsurawong-stripe/subscriptions","organizations_url":"https://api.github.com/users/mickjermsurawong-stripe/orgs","repos_url":"https://api.github.com/users/mickjermsurawong-stripe/repos","events_url":"https://api.github.com/users/mickjermsurawong-stripe/events{/privacy}","received_events_url":"https://api.github.com/users/mickjermsurawong-stripe/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-18T00:05:08Z","updated_at":"2020-12-18T00:05:08Z","author_association":"CONTRIBUTOR","body":"Thanks @johnclara for confirming the problem here. We have also been running more smoothly after our internal patch. \r\n\r\nJust would like to bump this if upgrading avro to version 1.10.1 (to include this [patch](https://issues.apache.org/jira/browse/AVRO-2944)) should be cosidered for next iceberg release. One complication could be that hadoop still uses avro 1.7 (iceberg currently uses avro 1.9)\r\n\r\ncc @rdblue ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747782500/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747819953","html_url":"https://github.com/apache/iceberg/pull/1947#issuecomment-747819953","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1947","id":747819953,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NzgxOTk1Mw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-18T02:04:29Z","updated_at":"2020-12-18T02:04:29Z","author_association":"CONTRIBUTOR","body":"I agree with all of the points that @aokolnychyi brought up. I also have a few suggestions on how to do this more cleanly.\r\n\r\n> We should think about how to group data before writing.\r\n\r\nPlease take a look at #1955. That exposes `_pos` so that we can use it. I would suggest the following:\r\n* If the table has a sort order, add a global sort of all the rows produced by the merge node.\r\n* If the table does not have a sort order, then add a default sort by `_file`, `_pos`, partition columns, and the `MERGE` condition's references. That way, existing rows that have non-null `_file` and `_pos` will mostly preserve the sort order in the source data files (except for changed columns). Inserted rows will have nulls for `_file` and `_pos` and will then be sorted by partition columns to minimize the number of output files, and then by columns from the merge condition because those are likely to be high cardinality (giving Spark the ability to split partitions).\r\n\r\n> We should align the assignments according to the target columns. This also applies to UPDATE.\r\n\r\nAgreed. I think that we should have a rule similar to the logic in [`TableOutputResolver`](https://github.com/apache/spark/blob/master/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/analysis/TableOutputResolver.scala#L30). One branch would modify `UPDATE` and add expressions to pull unchanged column values from the existing row. Another branch would modify `INSERT` by rearranging the columns by name for `INSERT (_names_) VALUES (_vals_)`.\r\n\r\nAnd we should also have a `MergeOutputCheck` rule to assert that each `INSERT` or `UPDATE` action is aligned with the output of the merge node.\r\n\r\nModifying and checking the logical plan in the analyzer like this will require analyzer rules and a logical plan that doesn't contain `MergeIntoProcessor`. We will need a logical plan that the normal analysis rules can run on. Then we can hopefully remove the resolution from the rewrite as well.\r\n\r\n> We will need more tests\r\n\r\nDefinitely.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747819953/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747862370","html_url":"https://github.com/apache/iceberg/issues/1951#issuecomment-747862370","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1951","id":747862370,"node_id":"MDEyOklzc3VlQ29tbWVudDc0Nzg2MjM3MA==","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-18T04:36:56Z","updated_at":"2020-12-18T04:36:56Z","author_association":"CONTRIBUTOR","body":"As part of working on the FLIP-27 Flink source, I updated the code with Flink 1.12.0 version. Here is the PR.\r\nhttps://github.com/apache/iceberg/pull/1956\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747862370/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747862652","html_url":"https://github.com/apache/iceberg/issues/1951#issuecomment-747862652","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1951","id":747862652,"node_id":"MDEyOklzc3VlQ29tbWVudDc0Nzg2MjY1Mg==","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-18T04:38:06Z","updated_at":"2020-12-18T04:38:06Z","author_association":"CONTRIBUTOR","body":"But we probably should discuss when to merge though. maybe after Flink 1.12.1 released?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747862652/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747881410","html_url":"https://github.com/apache/iceberg/pull/1956#issuecomment-747881410","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1956","id":747881410,"node_id":"MDEyOklzc3VlQ29tbWVudDc0Nzg4MTQxMA==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-18T05:44:18Z","updated_at":"2020-12-18T05:54:46Z","author_association":"CONTRIBUTOR","body":"I think we should add the support for both flink 1.11 and   flink 1.12 , similar to spark2 and spark3.\r\nIf we upgrade flink 1.11 to flink 1.12 directly, users who using flink 1.11 will not be able to use iceberg\r\n\r\nSimilar to the support for hive in flink, flink also supports all hive versions  what do you think ?\r\n ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747881410/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747887621","html_url":"https://github.com/apache/iceberg/issues/1951#issuecomment-747887621","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1951","id":747887621,"node_id":"MDEyOklzc3VlQ29tbWVudDc0Nzg4NzYyMQ==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-18T06:01:22Z","updated_at":"2020-12-18T06:01:22Z","author_association":"CONTRIBUTOR","body":"> But we probably should discuss when to merge though. maybe after Flink 1.12.1 released?\r\n\r\nI think that the changes between minor versions have little impact. Generally, minor version changes are usually optimizations or bug fixes, and no major changes or api modifications will be made.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747887621/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747891175","html_url":"https://github.com/apache/iceberg/pull/1947#issuecomment-747891175","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1947","id":747891175,"node_id":"MDEyOklzc3VlQ29tbWVudDc0Nzg5MTE3NQ==","user":{"login":"dilipbiswal","id":14225158,"node_id":"MDQ6VXNlcjE0MjI1MTU4","avatar_url":"https://avatars.githubusercontent.com/u/14225158?v=4","gravatar_id":"","url":"https://api.github.com/users/dilipbiswal","html_url":"https://github.com/dilipbiswal","followers_url":"https://api.github.com/users/dilipbiswal/followers","following_url":"https://api.github.com/users/dilipbiswal/following{/other_user}","gists_url":"https://api.github.com/users/dilipbiswal/gists{/gist_id}","starred_url":"https://api.github.com/users/dilipbiswal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dilipbiswal/subscriptions","organizations_url":"https://api.github.com/users/dilipbiswal/orgs","repos_url":"https://api.github.com/users/dilipbiswal/repos","events_url":"https://api.github.com/users/dilipbiswal/events{/privacy}","received_events_url":"https://api.github.com/users/dilipbiswal/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-18T06:12:03Z","updated_at":"2020-12-18T06:12:03Z","author_association":"CONTRIBUTOR","body":"@rdblue Thanks for the comments. I will process them and get back with any questions. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747891175/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747943701","html_url":"https://github.com/apache/iceberg/pull/1844#issuecomment-747943701","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1844","id":747943701,"node_id":"MDEyOklzc3VlQ29tbWVudDc0Nzk0MzcwMQ==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-18T08:27:34Z","updated_at":"2020-12-18T08:27:34Z","author_association":"CONTRIBUTOR","body":"@danielcweeks since we are approaching the next release and also the holiday season, I would like to minimize the change here and only focus on finalizing the client factory interface, so at least this PR can join the current release train. I have moved AssumeRole part out of the picture and will use another PR for that discussion.\r\n\r\nI agree that it would be cleaner to move the factory out of the `AwsProperties` class. I have created `AwsClientFactories` class for that, following a similar structure as the`LocationProviders` class and made `DefaultAwsClientFactory` an inner class. I think this should make the whole thing much cleaner.\r\n\r\nThe only discussion at this point I believe is about making `AwsClientFactory` serializable or not. I tried about not serializing it, and as a result in S3FileIO I have to do:\r\n\r\n```java\r\nthis.s3 = () -> AwsClientFactories.from(properties)::s3\r\n```\r\n\r\nIn that call above, `properties` got serialized as a part of the serializable supplier, which defeats the purpose of us using `AwsProperties` to store only useful information. So I think making `AwsClientFactory` serializable should still be the way to go there.\r\n\r\nPlease let me know what you think, thank you!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747943701/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747960726","html_url":"https://github.com/apache/iceberg/pull/1955#issuecomment-747960726","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1955","id":747960726,"node_id":"MDEyOklzc3VlQ29tbWVudDc0Nzk2MDcyNg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-18T09:08:21Z","updated_at":"2020-12-18T09:08:21Z","author_association":"CONTRIBUTOR","body":"It looks like vectorized Parquet is failing, @rdblue.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/747960726/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748002552","html_url":"https://github.com/apache/iceberg/pull/1939#issuecomment-748002552","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1939","id":748002552,"node_id":"MDEyOklzc3VlQ29tbWVudDc0ODAwMjU1Mg==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-18T10:13:17Z","updated_at":"2020-12-18T10:13:17Z","author_association":"MEMBER","body":"@stevenzwu  Thanks for your reviewing,  I addressed all the things except the separate issue #1959.  any other concerns ? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748002552/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748067794","html_url":"https://github.com/apache/iceberg/pull/1955#issuecomment-748067794","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1955","id":748067794,"node_id":"MDEyOklzc3VlQ29tbWVudDc0ODA2Nzc5NA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-18T12:50:37Z","updated_at":"2020-12-18T12:51:29Z","author_association":"CONTRIBUTOR","body":"I confirm tests for the non-vectorized Parquet path are working fine. Seems like we don't populate the position in the vectorized path only.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748067794/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748071723","html_url":"https://github.com/apache/iceberg/pull/1947#issuecomment-748071723","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1947","id":748071723,"node_id":"MDEyOklzc3VlQ29tbWVudDc0ODA3MTcyMw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-18T13:00:16Z","updated_at":"2020-12-18T13:00:16Z","author_association":"CONTRIBUTOR","body":"I can give it a try with and contribute rules that would align assignments + port our tests. It would be great if @dilipbiswal could work on the cardinality check and grouping of records on write.\r\n\r\nOnce these are done, we can look into changing `MergeIntoProcessor`. \r\n\r\nHow does that sound?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748071723/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748106333","html_url":"https://github.com/apache/iceberg/pull/1955#issuecomment-748106333","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1955","id":748106333,"node_id":"MDEyOklzc3VlQ29tbWVudDc0ODEwNjMzMw==","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-18T14:15:39Z","updated_at":"2020-12-18T14:15:39Z","author_association":"COLLABORATOR","body":"You may want this PR: https://github.com/apache/iceberg/pull/1356.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748106333/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748123544","html_url":"https://github.com/apache/iceberg/pull/1947#issuecomment-748123544","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1947","id":748123544,"node_id":"MDEyOklzc3VlQ29tbWVudDc0ODEyMzU0NA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-18T14:47:54Z","updated_at":"2020-12-18T14:50:34Z","author_association":"CONTRIBUTOR","body":"> Please take a look at #1955. That exposes _pos so that we can use it.\r\n\r\nThat is a great PR, let's get it in today.\r\n\r\n> If the table has a sort order, add a global sort of all the rows produced by the merge node.\r\n\r\nWe have this option internally and it works well in some cases. There are a few things we need to be careful about, though.\r\n\r\nFirst, Spark will do a skew estimation step and the actual shuffle using two separate jobs. We don't want to recompute the merge join twice. Internally, we add a repartition stage after the join if a global sort on write is requested. While it does help a bit, it is not ideal. We have seen cases where the sort on write is by far the most expensive step of MERGE.\r\n\r\nSecond, even when we do a global sort, the layout within partitions won't be ideal. So people will most likely have to compact again making the global sort during MERGE redundant.\r\n\r\nThat's why we have to be careful about a global sort by default. I think this ultimately depends on the use case. Shall we make this configurable in table properties? How many query engines will follow it? Should that config be `copy-on-write` specific? I don't have answers to all the questions but it sounds reasonable to explore.\r\n\r\nAt the same time, if we don't do the global sort, we may end up having too many small files after the operation. We can consider doing a repartition by the partition columns and sorting by the sort key but that will suffer if we have a lot of data for a single partition. It would be great to know the number of files and the size of data we need to rewrite per partition to make a good decision here.\r\n\r\nTo sum up this case,\r\n\r\n- global sort -> good but expensive\r\n- repartition and then sort -> less expensive but what if too much data per partition?\r\n\r\n> If the table does not have a sort order, then add a default sort by _file, _pos, partition columns, and the MERGE condition's references.\r\n\r\nSorting updated records by `_file` and `_pos` may be a bit tricky. For example, I have a file with columns (p, c1, c2, c3) in partition 'A' that is sorted by c1 and c2. If I have a merge command that updates c2 column (part of my sort key), my new records will be probably out of order if I sort by `_file` and `_pos`. That said, this is a fallback scenario so it may be not that big a deal. \r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748123544/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748158267","html_url":"https://github.com/apache/iceberg/issues/1951#issuecomment-748158267","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1951","id":748158267,"node_id":"MDEyOklzc3VlQ29tbWVudDc0ODE1ODI2Nw==","user":{"login":"pan3793","id":26535726,"node_id":"MDQ6VXNlcjI2NTM1NzI2","avatar_url":"https://avatars.githubusercontent.com/u/26535726?v=4","gravatar_id":"","url":"https://api.github.com/users/pan3793","html_url":"https://github.com/pan3793","followers_url":"https://api.github.com/users/pan3793/followers","following_url":"https://api.github.com/users/pan3793/following{/other_user}","gists_url":"https://api.github.com/users/pan3793/gists{/gist_id}","starred_url":"https://api.github.com/users/pan3793/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pan3793/subscriptions","organizations_url":"https://api.github.com/users/pan3793/orgs","repos_url":"https://api.github.com/users/pan3793/repos","events_url":"https://api.github.com/users/pan3793/events{/privacy}","received_events_url":"https://api.github.com/users/pan3793/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-18T15:31:24Z","updated_at":"2020-12-18T15:31:47Z","author_association":"MEMBER","body":"Both Iceberg and Flink are changing rapidly, is there necessary to introduce `FlinkShim` which like `HiveShim` to support multiple Flink versions? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748158267/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748171743","html_url":"https://github.com/apache/iceberg/pull/1956#issuecomment-748171743","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1956","id":748171743,"node_id":"MDEyOklzc3VlQ29tbWVudDc0ODE3MTc0Mw==","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-18T15:56:09Z","updated_at":"2020-12-18T15:56:09Z","author_association":"CONTRIBUTOR","body":"Are you suggesting that we have a module for each Flink minor version release (like 1.11 and 1.12)? I am worried that It can quickly grow out of control, as Flink does a minor version release typically every 4 months. Flink Kafka connector used to be in this model (like kafka08, kafka09, kafka10, ...). Now it moved to the universal connector and just track the latest release version of kafka-clients.\r\n\r\nOr are you suggesting that the Flink connector code can handle all the 1.x Flink versions? I am not sure how flink hive connector handles some of the small API changes among all the versions.\r\n\r\nAs for spark2 and spark3, that is a major version upgrade. For upgrading Spark from 2.3 to 2.4, I assume Iceberg just upgrade the version in spark2 module. If in the future, Flink introduced major breaking API change and go up to 2.x, we probably should have a flink2 module in Iceberg.\r\n\r\nSince the Flink Iceberg connector lives in the Iceberg project, I was thinking that the latest connector can just pick a Flink minor version as the paved path. That is why I was asking if we should wait for Flink 1.12.1 patch release for some bug fixes.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748171743/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748183361","html_url":"https://github.com/apache/iceberg/pull/1947#issuecomment-748183361","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1947","id":748183361,"node_id":"MDEyOklzc3VlQ29tbWVudDc0ODE4MzM2MQ==","user":{"login":"dilipbiswal","id":14225158,"node_id":"MDQ6VXNlcjE0MjI1MTU4","avatar_url":"https://avatars.githubusercontent.com/u/14225158?v=4","gravatar_id":"","url":"https://api.github.com/users/dilipbiswal","html_url":"https://github.com/dilipbiswal","followers_url":"https://api.github.com/users/dilipbiswal/followers","following_url":"https://api.github.com/users/dilipbiswal/following{/other_user}","gists_url":"https://api.github.com/users/dilipbiswal/gists{/gist_id}","starred_url":"https://api.github.com/users/dilipbiswal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dilipbiswal/subscriptions","organizations_url":"https://api.github.com/users/dilipbiswal/orgs","repos_url":"https://api.github.com/users/dilipbiswal/repos","events_url":"https://api.github.com/users/dilipbiswal/events{/privacy}","received_events_url":"https://api.github.com/users/dilipbiswal/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-18T16:17:48Z","updated_at":"2020-12-18T16:17:48Z","author_association":"CONTRIBUTOR","body":"> I can give it a try with and contribute rules that would align assignments + port our tests. It would be great if @dilipbiswal could work on the cardinality check and grouping of records on write.\r\n\r\nSounds good to me Anton.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748183361/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748185363","html_url":"https://github.com/apache/iceberg/issues/1951#issuecomment-748185363","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1951","id":748185363,"node_id":"MDEyOklzc3VlQ29tbWVudDc0ODE4NTM2Mw==","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-18T16:21:15Z","updated_at":"2020-12-18T16:21:31Z","author_association":"CONTRIBUTOR","body":"pasting my comment from the PR here. let's consolidate the discussion in this issue. I guess both @zhangjun0x01 and @pan3793 was suggesting the shim layer approach. It definitely adds some significant complexity.\r\n\r\n===================\r\nAre you suggesting that we have a module for each Flink minor version release (like 1.11 and 1.12)? I am worried that It can quickly grow out of control, as Flink does a minor version release typically every 4 months. Flink Kafka connector used to be in this model (like kafka08, kafka09, kafka10, ...). Now it moved to the universal connector and just track the latest release version of kafka-clients.\r\n\r\nOr are you suggesting that the Flink connector code can handle all the 1.x Flink versions? I am not sure how flink hive connector handles some of the small API changes among all the versions.\r\n\r\nAs for spark2 and spark3, that is a major version upgrade. For upgrading Spark from 2.3 to 2.4, I assume Iceberg just upgrade the version in spark2 module. If in the future, Flink introduced major breaking API change and go up to 2.x, we probably should have a flink2 module in Iceberg.\r\n\r\nSince the Flink Iceberg connector lives in the Iceberg project, I was thinking that the latest connector can just pick a Flink minor version as the paved path. That is why I was asking if we should wait for Flink 1.12.1 patch release for some bug fixes.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748185363/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748189545","html_url":"https://github.com/apache/iceberg/issues/1949#issuecomment-748189545","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1949","id":748189545,"node_id":"MDEyOklzc3VlQ29tbWVudDc0ODE4OTU0NQ==","user":{"login":"mehtaashish23","id":75326,"node_id":"MDQ6VXNlcjc1MzI2","avatar_url":"https://avatars.githubusercontent.com/u/75326?v=4","gravatar_id":"","url":"https://api.github.com/users/mehtaashish23","html_url":"https://github.com/mehtaashish23","followers_url":"https://api.github.com/users/mehtaashish23/followers","following_url":"https://api.github.com/users/mehtaashish23/following{/other_user}","gists_url":"https://api.github.com/users/mehtaashish23/gists{/gist_id}","starred_url":"https://api.github.com/users/mehtaashish23/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mehtaashish23/subscriptions","organizations_url":"https://api.github.com/users/mehtaashish23/orgs","repos_url":"https://api.github.com/users/mehtaashish23/repos","events_url":"https://api.github.com/users/mehtaashish23/events{/privacy}","received_events_url":"https://api.github.com/users/mehtaashish23/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-18T16:29:09Z","updated_at":"2020-12-18T16:29:09Z","author_association":"CONTRIBUTOR","body":"@rdblue started an email thread for this, will summarize the details here as it concludes, but here is the detail. \r\n\r\nFor us, our main use case is primary key based dataSets (like MySQL bin log export) where the DELETE and MERGE always\r\nupdate records based on the primary key. Considering that I know the primary key and this fixed use case of primary key-\r\nbased updates, I can easily construct back CDC from the appended/deleted data from the table, by taking full outer join on \r\nprimary key between appended data and deleted data, and expose what all rows were updated/inserted/deleted, along with \r\nthe previous value in case of updates/deletes.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748189545/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748206553","html_url":"https://github.com/apache/iceberg/pull/1947#issuecomment-748206553","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1947","id":748206553,"node_id":"MDEyOklzc3VlQ29tbWVudDc0ODIwNjU1Mw==","user":{"login":"dilipbiswal","id":14225158,"node_id":"MDQ6VXNlcjE0MjI1MTU4","avatar_url":"https://avatars.githubusercontent.com/u/14225158?v=4","gravatar_id":"","url":"https://api.github.com/users/dilipbiswal","html_url":"https://github.com/dilipbiswal","followers_url":"https://api.github.com/users/dilipbiswal/followers","following_url":"https://api.github.com/users/dilipbiswal/following{/other_user}","gists_url":"https://api.github.com/users/dilipbiswal/gists{/gist_id}","starred_url":"https://api.github.com/users/dilipbiswal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dilipbiswal/subscriptions","organizations_url":"https://api.github.com/users/dilipbiswal/orgs","repos_url":"https://api.github.com/users/dilipbiswal/repos","events_url":"https://api.github.com/users/dilipbiswal/events{/privacy}","received_events_url":"https://api.github.com/users/dilipbiswal/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-18T17:02:24Z","updated_at":"2020-12-18T17:02:24Z","author_association":"CONTRIBUTOR","body":"@rdblue @aokolnychyi \r\nI am still coming to speed on the comments on Grouping and sorting the data before writing. I think repartitioning and sorting the data within each partition (local sort) is the most performant one ? Skewness of partitions is an orthogonal problem and not specific to MERGE INTO , am i right ? \r\n\r\nRyan/Anton, can you tell me what do we do in terms of partitioning and sorting for CTAS and INSERT ... INTO SELECT FROM .. case today ? \r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748206553/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748209624","html_url":"https://github.com/apache/iceberg/pull/1844#issuecomment-748209624","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1844","id":748209624,"node_id":"MDEyOklzc3VlQ29tbWVudDc0ODIwOTYyNA==","user":{"login":"danielcweeks","id":4925077,"node_id":"MDQ6VXNlcjQ5MjUwNzc=","avatar_url":"https://avatars.githubusercontent.com/u/4925077?v=4","gravatar_id":"","url":"https://api.github.com/users/danielcweeks","html_url":"https://github.com/danielcweeks","followers_url":"https://api.github.com/users/danielcweeks/followers","following_url":"https://api.github.com/users/danielcweeks/following{/other_user}","gists_url":"https://api.github.com/users/danielcweeks/gists{/gist_id}","starred_url":"https://api.github.com/users/danielcweeks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielcweeks/subscriptions","organizations_url":"https://api.github.com/users/danielcweeks/orgs","repos_url":"https://api.github.com/users/danielcweeks/repos","events_url":"https://api.github.com/users/danielcweeks/events{/privacy}","received_events_url":"https://api.github.com/users/danielcweeks/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-18T17:08:38Z","updated_at":"2020-12-18T17:08:38Z","author_association":"CONTRIBUTOR","body":"@jackye1995 thanks for breaking this apart, I think that really helps and we can follow on with the STS implementation and discuss the dynamic catalog configuration separately.\r\n\r\nAs to the `AwsClientFactory` being serializable,  I agree with you (my concern was more that it was part of AwsProperties which felt awkward.).  This looks good.\r\n\r\nAppears there are some checkstyle failures, but other than that, I'm good with this.\r\n\r\n ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748209624/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748210178","html_url":"https://github.com/apache/iceberg/issues/1951#issuecomment-748210178","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1951","id":748210178,"node_id":"MDEyOklzc3VlQ29tbWVudDc0ODIxMDE3OA==","user":{"login":"pan3793","id":26535726,"node_id":"MDQ6VXNlcjI2NTM1NzI2","avatar_url":"https://avatars.githubusercontent.com/u/26535726?v=4","gravatar_id":"","url":"https://api.github.com/users/pan3793","html_url":"https://github.com/pan3793","followers_url":"https://api.github.com/users/pan3793/followers","following_url":"https://api.github.com/users/pan3793/following{/other_user}","gists_url":"https://api.github.com/users/pan3793/gists{/gist_id}","starred_url":"https://api.github.com/users/pan3793/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pan3793/subscriptions","organizations_url":"https://api.github.com/users/pan3793/orgs","repos_url":"https://api.github.com/users/pan3793/repos","events_url":"https://api.github.com/users/pan3793/events{/privacy}","received_events_url":"https://api.github.com/users/pan3793/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-18T17:09:42Z","updated_at":"2020-12-18T17:23:38Z","author_association":"MEMBER","body":"@stevenzwu \n> Or are you suggesting that the Flink connector code can handle all the 1.x Flink versions?\n\nYes, what I mean `Shim` is something like:\r\nhttps://github.com/apache/spark/blob/master/sql/hive/src/main/scala/org/apache/spark/sql/hive/client/HiveShim.scala , so there is no need to maintain each version in a separate module.\r\n\r\nAnd I think the situation of `flink-kafka-connector` is quite different. Firstly, kafka provide a light `kafka-clients` to communicate with broker via RPC protocol, and since 0.10, kafka guarantees that the client is compatible with lower versions of broker, so after dropping support of kafka 0.9 and earlier versions, there is only one universal kafka connector with latest `kafka-clients`.\r\n\r\n> Since the Flink Iceberg connector lives in the Iceberg project.\r\n\r\nThe module uses some Flink @Internal API which not guarantee compatible in each minor release, i.e. `RowDataTypeInfo` is  renamed into `InternalTypeInfo` from flink 1.11 to flink 1.12, so I think the most light way is introduce a `FlinkShim` and use reflection to invoke the specific `method` in specific flink version.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748210178/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748230293","html_url":"https://github.com/apache/iceberg/issues/1959#issuecomment-748230293","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1959","id":748230293,"node_id":"MDEyOklzc3VlQ29tbWVudDc0ODIzMDI5Mw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-18T17:53:36Z","updated_at":"2020-12-18T17:53:36Z","author_association":"CONTRIBUTOR","body":"I think it is a good idea to commit the manifests directly, but I would want a flag to tell Iceberg whether it should rewrite them. In some cases, manifests are correctly written into the metadata directory. But it should be possible to write a manifest in a different location. For example, we write manifests in a bucket in the local region and rewrite in the committer to create a manifest in the table's normal region.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748230293/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748231753","html_url":"https://github.com/apache/iceberg/pull/1939#issuecomment-748231753","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1939","id":748231753,"node_id":"MDEyOklzc3VlQ29tbWVudDc0ODIzMTc1Mw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-18T17:56:51Z","updated_at":"2020-12-18T17:56:51Z","author_association":"CONTRIBUTOR","body":"+1\r\n\r\nIt would be great to have a review from @JingsongLi as well, but I'm going to go ahead and commit this since it looks good to @stevenzwu.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748231753/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748236369","html_url":"https://github.com/apache/iceberg/pull/1958#issuecomment-748236369","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1958","id":748236369,"node_id":"MDEyOklzc3VlQ29tbWVudDc0ODIzNjM2OQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-18T18:06:45Z","updated_at":"2020-12-18T18:07:26Z","author_association":"CONTRIBUTOR","body":"@zhangjun0x01, I think `static` is a good practice because static methods don't have access to any instance state. That makes it easier to understand and reason about what the method is doing because it can only operate on its inputs. I think that is helpful for cases like `commitChanges` here: it is clear that the commit affects the `Table` passed in and does not alter any state in the catalog instance.\r\n\r\nA similar situation is whether to use `static` for inner classes. I think it is easier to see in that case that keeping state separate from inner classes is a good practice when the inner class doesn't need to access state from the containing class. To me, static methods should be preferred for the same reason.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748236369/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748244697","html_url":"https://github.com/apache/iceberg/pull/1947#issuecomment-748244697","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1947","id":748244697,"node_id":"MDEyOklzc3VlQ29tbWVudDc0ODI0NDY5Nw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-18T18:24:45Z","updated_at":"2020-12-18T18:24:45Z","author_association":"CONTRIBUTOR","body":"> Skewness of partitions is an orthogonal problem and not specific to MERGE INTO , am i right ?\r\n\r\nThe full outer join probably requires shuffling data, which means that it will be distributed by the MATCH expression. There's no guarantee that the match expression is aligned with the table partitioning. If it isn't, then writing without a sort would introduce a ton of small files because each task would be writing to each output partition.\r\n\r\nTo avoid the small files problem, we need to repartition. If we repartition by just the partition expressions from the table, there is a good chance of producing a plan with too few tasks in the write stage because Spark can't split tasks for the same key. This is what introduces the skew. To avoid that, we can use a global sort to plan tasks that are balanced.\r\n\r\nA global sort is a best practice for writing anyway because it clusters data for faster reads.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748244697/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748246932","html_url":"https://github.com/apache/iceberg/pull/1947#issuecomment-748246932","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1947","id":748246932,"node_id":"MDEyOklzc3VlQ29tbWVudDc0ODI0NjkzMg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-18T18:29:43Z","updated_at":"2020-12-18T18:29:43Z","author_association":"CONTRIBUTOR","body":"@aokolnychyi, I agree with the idea to have a flag to disable global sort. Probably best to do this specific to copy-on-write because delta writes will need to be sorted by `_file` and `_pos` for deletes and we expect the inserts to be much, much smaller than the copy-on-write data. If we aren't rewriting retained rows, I think the global sort (with a repartition as you said) would be much cheaper.\r\n\r\nFor sorting by `_file` and `_pos`, what if we only did that for existing rows? We can discard the columns for updated rows. That way we rewrite the data files as though the rows were deleted and append the inserts and updates together. We may even want to do this in all cases: always prepend `_file` and `_pos` to whatever sort order we inject.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748246932/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748250068","html_url":"https://github.com/apache/iceberg/issues/1951#issuecomment-748250068","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1951","id":748250068,"node_id":"MDEyOklzc3VlQ29tbWVudDc0ODI1MDA2OA==","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-18T18:36:43Z","updated_at":"2020-12-19T22:15:15Z","author_association":"CONTRIBUTOR","body":"Definitely see the benefit of supporting multiple Flink versions via a shim layer. I am just concerned about the added complexity and maintenance overhead. Wondering how the spark2/3 modules handle the minor version upgrade in Spark.\r\n\r\nAnother question is if we want to keep supporting all the Flink minor versions. Flink has the policy of two released minor versions. Older Flink versions won't get backport of bug fixes\r\n\r\n@rdblue @openinx @JingsongLi ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748250068/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748251124","html_url":"https://github.com/apache/iceberg/pull/1356#issuecomment-748251124","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1356","id":748251124,"node_id":"MDEyOklzc3VlQ29tbWVudDc0ODI1MTEyNA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-18T18:39:10Z","updated_at":"2020-12-18T18:39:10Z","author_association":"CONTRIBUTOR","body":"Thanks for fixing this, @chenjunjiedada! And thanks to @shardulm94 and @holdenk for reviewing!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748251124/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748251420","html_url":"https://github.com/apache/iceberg/pull/1955#issuecomment-748251420","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1955","id":748251420,"node_id":"MDEyOklzc3VlQ29tbWVudDc0ODI1MTQyMA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-18T18:39:49Z","updated_at":"2020-12-18T18:39:49Z","author_association":"CONTRIBUTOR","body":"Merged #1356. Thanks for fixing that, @chenjunjiedada! Sorry I didn't get back to review that before now.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748251420/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748254088","html_url":"https://github.com/apache/iceberg/pull/1844#issuecomment-748254088","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1844","id":748254088,"node_id":"MDEyOklzc3VlQ29tbWVudDc0ODI1NDA4OA==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-18T18:45:50Z","updated_at":"2020-12-18T18:45:50Z","author_association":"CONTRIBUTOR","body":"@danielcweeks checkstyle fixed, please let me know if there is any other concern","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748254088/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748261424","html_url":"https://github.com/apache/iceberg/pull/1956#issuecomment-748261424","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1956","id":748261424,"node_id":"MDEyOklzc3VlQ29tbWVudDc0ODI2MTQyNA==","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-18T18:56:17Z","updated_at":"2020-12-18T18:56:17Z","author_association":"CONTRIBUTOR","body":"@JingsongLi saw the CI failure in Flink tests with `Trying to access closed classloader`, which I couldn't reproduce locally with `./gradlew :iceberg-flink:build`. It seems like the same problem as [FLINK-19843](https://issues.apache.org/jira/browse/FLINK-19843) that you fixed. I tried to close the result iterator as you did. But it doesn't seem to fix it.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748261424/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748262031","html_url":"https://github.com/apache/iceberg/pull/1648#issuecomment-748262031","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1648","id":748262031,"node_id":"MDEyOklzc3VlQ29tbWVudDc0ODI2MjAzMQ==","user":{"login":"shardulm94","id":6961317,"node_id":"MDQ6VXNlcjY5NjEzMTc=","avatar_url":"https://avatars.githubusercontent.com/u/6961317?v=4","gravatar_id":"","url":"https://api.github.com/users/shardulm94","html_url":"https://github.com/shardulm94","followers_url":"https://api.github.com/users/shardulm94/followers","following_url":"https://api.github.com/users/shardulm94/following{/other_user}","gists_url":"https://api.github.com/users/shardulm94/gists{/gist_id}","starred_url":"https://api.github.com/users/shardulm94/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shardulm94/subscriptions","organizations_url":"https://api.github.com/users/shardulm94/orgs","repos_url":"https://api.github.com/users/shardulm94/repos","events_url":"https://api.github.com/users/shardulm94/events{/privacy}","received_events_url":"https://api.github.com/users/shardulm94/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-18T18:57:29Z","updated_at":"2020-12-18T18:57:29Z","author_association":"CONTRIBUTOR","body":"@Fokko I am also interested in getting Iceberg onto Avro 1.10.1. Are you still working on this?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748262031/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748263335","html_url":"https://github.com/apache/iceberg/pull/1948#issuecomment-748263335","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1948","id":748263335,"node_id":"MDEyOklzc3VlQ29tbWVudDc0ODI2MzMzNQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-18T19:00:23Z","updated_at":"2020-12-18T19:00:23Z","author_association":"CONTRIBUTOR","body":"LGTM, nothing to add to existing comments.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748263335/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748269231","html_url":"https://github.com/apache/iceberg/pull/1948#issuecomment-748269231","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1948","id":748269231,"node_id":"MDEyOklzc3VlQ29tbWVudDc0ODI2OTIzMQ==","user":{"login":"holdenk","id":59893,"node_id":"MDQ6VXNlcjU5ODkz","avatar_url":"https://avatars.githubusercontent.com/u/59893?v=4","gravatar_id":"","url":"https://api.github.com/users/holdenk","html_url":"https://github.com/holdenk","followers_url":"https://api.github.com/users/holdenk/followers","following_url":"https://api.github.com/users/holdenk/following{/other_user}","gists_url":"https://api.github.com/users/holdenk/gists{/gist_id}","starred_url":"https://api.github.com/users/holdenk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/holdenk/subscriptions","organizations_url":"https://api.github.com/users/holdenk/orgs","repos_url":"https://api.github.com/users/holdenk/repos","events_url":"https://api.github.com/users/holdenk/events{/privacy}","received_events_url":"https://api.github.com/users/holdenk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-18T19:12:45Z","updated_at":"2020-12-18T19:12:45Z","author_association":"CONTRIBUTOR","body":"LGTM","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748269231/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748277392","html_url":"https://github.com/apache/iceberg/pull/1933#issuecomment-748277392","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1933","id":748277392,"node_id":"MDEyOklzc3VlQ29tbWVudDc0ODI3NzM5Mg==","user":{"login":"holdenk","id":59893,"node_id":"MDQ6VXNlcjU5ODkz","avatar_url":"https://avatars.githubusercontent.com/u/59893?v=4","gravatar_id":"","url":"https://api.github.com/users/holdenk","html_url":"https://github.com/holdenk","followers_url":"https://api.github.com/users/holdenk/followers","following_url":"https://api.github.com/users/holdenk/following{/other_user}","gists_url":"https://api.github.com/users/holdenk/gists{/gist_id}","starred_url":"https://api.github.com/users/holdenk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/holdenk/subscriptions","organizations_url":"https://api.github.com/users/holdenk/orgs","repos_url":"https://api.github.com/users/holdenk/repos","events_url":"https://api.github.com/users/holdenk/events{/privacy}","received_events_url":"https://api.github.com/users/holdenk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-18T19:25:03Z","updated_at":"2020-12-18T19:25:03Z","author_association":"CONTRIBUTOR","body":"I like the idea of this change, would it make sense to update the documentation as well so folks see how to use it? Less prone to typos in the data read/write config path is <3 <3","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748277392/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748279868","html_url":"https://github.com/apache/iceberg/pull/1893#issuecomment-748279868","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1893","id":748279868,"node_id":"MDEyOklzc3VlQ29tbWVudDc0ODI3OTg2OA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-18T19:30:42Z","updated_at":"2020-12-18T19:30:42Z","author_association":"CONTRIBUTOR","body":"Thanks for working on this @zhangjun0x01! It looks like a great start to me, and I'd really like to get this working in Flink.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748279868/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748298442","html_url":"https://github.com/apache/iceberg/pull/1933#issuecomment-748298442","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1933","id":748298442,"node_id":"MDEyOklzc3VlQ29tbWVudDc0ODI5ODQ0Mg==","user":{"login":"karuppayya","id":5082742,"node_id":"MDQ6VXNlcjUwODI3NDI=","avatar_url":"https://avatars.githubusercontent.com/u/5082742?v=4","gravatar_id":"","url":"https://api.github.com/users/karuppayya","html_url":"https://github.com/karuppayya","followers_url":"https://api.github.com/users/karuppayya/followers","following_url":"https://api.github.com/users/karuppayya/following{/other_user}","gists_url":"https://api.github.com/users/karuppayya/gists{/gist_id}","starred_url":"https://api.github.com/users/karuppayya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/karuppayya/subscriptions","organizations_url":"https://api.github.com/users/karuppayya/orgs","repos_url":"https://api.github.com/users/karuppayya/repos","events_url":"https://api.github.com/users/karuppayya/events{/privacy}","received_events_url":"https://api.github.com/users/karuppayya/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-18T20:15:57Z","updated_at":"2020-12-18T20:15:57Z","author_association":"CONTRIBUTOR","body":"@holdenk Thanks for feedback. I can add a column to site/docs/configuration.md's spark configs. Would that work?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748298442/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748302457","html_url":"https://github.com/apache/iceberg/pull/1933#issuecomment-748302457","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1933","id":748302457,"node_id":"MDEyOklzc3VlQ29tbWVudDc0ODMwMjQ1Nw==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-18T20:26:00Z","updated_at":"2020-12-18T20:26:00Z","author_association":"MEMBER","body":"> @holdenk Thanks for feedback. I can add a column to site/docs/configuration.md's spark configs. Would that work?\r\n\r\nI think you may want to add these to the Spark Section directly since they don't apply to configuration generally","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748302457/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748305937","html_url":"https://github.com/apache/iceberg/pull/1947#issuecomment-748305937","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1947","id":748305937,"node_id":"MDEyOklzc3VlQ29tbWVudDc0ODMwNTkzNw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-18T20:34:33Z","updated_at":"2020-12-18T20:34:33Z","author_association":"CONTRIBUTOR","body":"I looked into resolution and there is a rule in Spark: https://github.com/apache/spark/blob/master/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/analysis/Analyzer.scala#L1682-L1710\r\n\r\nLooks like if the assignments are out of order or a subset of the output columns, the expressions are left as-is. If there are no assignments, then the source table's columns are used to set the output columns by position, using an `Attribute` from the target table as the LHS.\r\n\r\nWe will need an analyzer rule that fills in the missing assignments for update, checks the order of assignments by name, and validates that inserts are complete. I also think that this rule should convert to a different MergeInto logical plan. The plan in Spark is not sufficient because it considers the plan resolved when assignments are resolved, not when the assignments actually produce the expected output. That's strange because resolution produces assignments when there aren't any, but allows them to be missing when some are present.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748305937/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748366564","html_url":"https://github.com/apache/iceberg/pull/1948#issuecomment-748366564","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1948","id":748366564,"node_id":"MDEyOklzc3VlQ29tbWVudDc0ODM2NjU2NA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-18T23:12:05Z","updated_at":"2020-12-18T23:12:05Z","author_association":"CONTRIBUTOR","body":"Thanks for reviewing, @holdenk, @RussellSpitzer, and @aokolnychyi! I merged this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748366564/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748383960","html_url":"https://github.com/apache/iceberg/pull/1955#issuecomment-748383960","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1955","id":748383960,"node_id":"MDEyOklzc3VlQ29tbWVudDc0ODM4Mzk2MA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-19T00:14:07Z","updated_at":"2020-12-19T00:14:07Z","author_association":"CONTRIBUTOR","body":"Rebased and fixed a couple of bugs with `_file` and `_pos` in vectorized Parquet reads.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748383960/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748389578","html_url":"https://github.com/apache/iceberg/pull/1933#issuecomment-748389578","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1933","id":748389578,"node_id":"MDEyOklzc3VlQ29tbWVudDc0ODM4OTU3OA==","user":{"login":"karuppayya","id":5082742,"node_id":"MDQ6VXNlcjUwODI3NDI=","avatar_url":"https://avatars.githubusercontent.com/u/5082742?v=4","gravatar_id":"","url":"https://api.github.com/users/karuppayya","html_url":"https://github.com/karuppayya","followers_url":"https://api.github.com/users/karuppayya/followers","following_url":"https://api.github.com/users/karuppayya/following{/other_user}","gists_url":"https://api.github.com/users/karuppayya/gists{/gist_id}","starred_url":"https://api.github.com/users/karuppayya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/karuppayya/subscriptions","organizations_url":"https://api.github.com/users/karuppayya/orgs","repos_url":"https://api.github.com/users/karuppayya/repos","events_url":"https://api.github.com/users/karuppayya/events{/privacy}","received_events_url":"https://api.github.com/users/karuppayya/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-19T00:39:18Z","updated_at":"2020-12-19T00:39:18Z","author_association":"CONTRIBUTOR","body":"> > @holdenk Thanks for feedback. I can add a column to site/docs/configuration.md's spark configs. Would that work?\r\n> \r\n> I think you may want to add these to the Spark Section directly since they don't apply to configuration generally\r\n\r\nI have added it as a \"Note\", open for any other suggestions for introducing into the doc.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748389578/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748473112","html_url":"https://github.com/apache/iceberg/pull/1947#issuecomment-748473112","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1947","id":748473112,"node_id":"MDEyOklzc3VlQ29tbWVudDc0ODQ3MzExMg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-19T13:11:20Z","updated_at":"2020-12-19T13:11:20Z","author_association":"CONTRIBUTOR","body":"I'll cover the missing rule while @dilipbiswal is working on the cardinality check and grouping on write.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/748473112/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]