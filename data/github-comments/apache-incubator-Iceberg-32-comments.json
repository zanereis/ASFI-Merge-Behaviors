[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/621199667","html_url":"https://github.com/apache/iceberg/issues/852#issuecomment-621199667","issue_url":"https://api.github.com/repos/apache/iceberg/issues/852","id":621199667,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMTE5OTY2Nw==","user":{"login":"massdosage","id":29457,"node_id":"MDQ6VXNlcjI5NDU3","avatar_url":"https://avatars.githubusercontent.com/u/29457?v=4","gravatar_id":"","url":"https://api.github.com/users/massdosage","html_url":"https://github.com/massdosage","followers_url":"https://api.github.com/users/massdosage/followers","following_url":"https://api.github.com/users/massdosage/following{/other_user}","gists_url":"https://api.github.com/users/massdosage/gists{/gist_id}","starred_url":"https://api.github.com/users/massdosage/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/massdosage/subscriptions","organizations_url":"https://api.github.com/users/massdosage/orgs","repos_url":"https://api.github.com/users/massdosage/repos","events_url":"https://api.github.com/users/massdosage/events{/privacy}","received_events_url":"https://api.github.com/users/massdosage/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-04-29T13:19:42Z","updated_at":"2020-04-29T13:19:42Z","author_association":"CONTRIBUTOR","body":"Yes, we plan to try re-use as much code from #843 in #933 as possible, it's being discussed on the related WIP PR. Unfortunately this *is* blocked by Guava because when you try actually use the InputFormat in Hive it fails due to Hive having a different version of Guava on its classpath which leads to runtime exceptions with method signatures that have changed etc. So one can't actually use the InputFormat until we resolve all the version clashes between classes that both Iceberg and Hive use that have incompatible version changes between them. We have an integration test using HiveRunner that we could add here to demonstrate this but it will require quite a few exclusions, some new dependencies on various Hive modules and all the shading and relocating before it will pass.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/621199667/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/621203179","html_url":"https://github.com/apache/iceberg/pull/974#issuecomment-621203179","issue_url":"https://api.github.com/repos/apache/iceberg/issues/974","id":621203179,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMTIwMzE3OQ==","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-04-29T13:24:34Z","updated_at":"2020-04-29T13:24:34Z","author_association":"COLLABORATOR","body":"I prefer to wait for [PR](https://github.com/apache/incubator-iceberg/pull/963) to get merged since the unit tests may need to updated as well. I will take a look at the PR as well to find what is fixed.\r\n\r\nDoes the logic of precondition checking make sense to you? I think that is needed.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/621203179/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/621336749","html_url":"https://github.com/apache/iceberg/pull/935#issuecomment-621336749","issue_url":"https://api.github.com/repos/apache/iceberg/issues/935","id":621336749,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMTMzNjc0OQ==","user":{"login":"massdosage","id":29457,"node_id":"MDQ6VXNlcjI5NDU3","avatar_url":"https://avatars.githubusercontent.com/u/29457?v=4","gravatar_id":"","url":"https://api.github.com/users/massdosage","html_url":"https://github.com/massdosage","followers_url":"https://api.github.com/users/massdosage/followers","following_url":"https://api.github.com/users/massdosage/following{/other_user}","gists_url":"https://api.github.com/users/massdosage/gists{/gist_id}","starred_url":"https://api.github.com/users/massdosage/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/massdosage/subscriptions","organizations_url":"https://api.github.com/users/massdosage/orgs","repos_url":"https://api.github.com/users/massdosage/repos","events_url":"https://api.github.com/users/massdosage/events{/privacy}","received_events_url":"https://api.github.com/users/massdosage/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-04-29T16:56:12Z","updated_at":"2020-04-29T16:56:12Z","author_association":"CONTRIBUTOR","body":"With the recent commit from @cmathiesen this now works across the whole project but isn't actually correct since many subprojects appear to be depending on Guava transitively so this would need to change. We can move onto that once we have agreement on whether we want to proceed with this approach and what the relocated package name should be.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/621336749/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/621349604","html_url":"https://github.com/apache/iceberg/pull/974#issuecomment-621349604","issue_url":"https://api.github.com/repos/apache/iceberg/issues/974","id":621349604,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMTM0OTYwNA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-04-29T17:20:01Z","updated_at":"2020-04-29T17:20:01Z","author_association":"CONTRIBUTOR","body":"Yes, I think those precondition checks are good.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/621349604/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/621364689","html_url":"https://github.com/apache/iceberg/issues/970#issuecomment-621364689","issue_url":"https://api.github.com/repos/apache/iceberg/issues/970","id":621364689,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMTM2NDY4OQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-04-29T17:49:21Z","updated_at":"2020-04-29T17:49:21Z","author_association":"CONTRIBUTOR","body":"@vanliu-tx, are you sure that there weren't any commit failures? With so many concurrent writes, I wouldn't be surprised if commits exceeded the maximum number of retries and failed. Do you have logs to check this?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/621364689/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/621365796","html_url":"https://github.com/apache/iceberg/issues/970#issuecomment-621365796","issue_url":"https://api.github.com/repos/apache/iceberg/issues/970","id":621365796,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMTM2NTc5Ng==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-04-29T17:51:25Z","updated_at":"2020-04-29T17:51:40Z","author_association":"CONTRIBUTOR","body":"Another thing you can do is turn up the [number of retries](https://iceberg.apache.org/configuration/#table-behavior-properties) on the table and re-running:\r\n\r\n```java\r\ntable.updateProperties()\r\n    .set(\"commit.retry.num-retries\", \"360\")\r\n    .commit();\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/621365796/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/621519116","html_url":"https://github.com/apache/iceberg/pull/986#issuecomment-621519116","issue_url":"https://api.github.com/repos/apache/iceberg/issues/986","id":621519116,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMTUxOTExNg==","user":{"login":"Parth-Brahmbhatt","id":6914358,"node_id":"MDQ6VXNlcjY5MTQzNTg=","avatar_url":"https://avatars.githubusercontent.com/u/6914358?v=4","gravatar_id":"","url":"https://api.github.com/users/Parth-Brahmbhatt","html_url":"https://github.com/Parth-Brahmbhatt","followers_url":"https://api.github.com/users/Parth-Brahmbhatt/followers","following_url":"https://api.github.com/users/Parth-Brahmbhatt/following{/other_user}","gists_url":"https://api.github.com/users/Parth-Brahmbhatt/gists{/gist_id}","starred_url":"https://api.github.com/users/Parth-Brahmbhatt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Parth-Brahmbhatt/subscriptions","organizations_url":"https://api.github.com/users/Parth-Brahmbhatt/orgs","repos_url":"https://api.github.com/users/Parth-Brahmbhatt/repos","events_url":"https://api.github.com/users/Parth-Brahmbhatt/events{/privacy}","received_events_url":"https://api.github.com/users/Parth-Brahmbhatt/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-04-29T23:19:02Z","updated_at":"2020-04-29T23:19:02Z","author_association":"CONTRIBUTOR","body":"+1.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/621519116/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/621524431","html_url":"https://github.com/apache/iceberg/pull/986#issuecomment-621524431","issue_url":"https://api.github.com/repos/apache/iceberg/issues/986","id":621524431,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMTUyNDQzMQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-04-29T23:35:51Z","updated_at":"2020-04-29T23:35:51Z","author_association":"CONTRIBUTOR","body":"Thanks for testing this with Presto, @Parth-Brahmbhatt!\r\n\r\nFYI @JamesRTaylor, this fixes the issue you found.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/621524431/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/621525366","html_url":"https://github.com/apache/iceberg/pull/986#issuecomment-621525366","issue_url":"https://api.github.com/repos/apache/iceberg/issues/986","id":621525366,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMTUyNTM2Ng==","user":{"login":"JamesRTaylor","id":6176299,"node_id":"MDQ6VXNlcjYxNzYyOTk=","avatar_url":"https://avatars.githubusercontent.com/u/6176299?v=4","gravatar_id":"","url":"https://api.github.com/users/JamesRTaylor","html_url":"https://github.com/JamesRTaylor","followers_url":"https://api.github.com/users/JamesRTaylor/followers","following_url":"https://api.github.com/users/JamesRTaylor/following{/other_user}","gists_url":"https://api.github.com/users/JamesRTaylor/gists{/gist_id}","starred_url":"https://api.github.com/users/JamesRTaylor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JamesRTaylor/subscriptions","organizations_url":"https://api.github.com/users/JamesRTaylor/orgs","repos_url":"https://api.github.com/users/JamesRTaylor/repos","events_url":"https://api.github.com/users/JamesRTaylor/events{/privacy}","received_events_url":"https://api.github.com/users/JamesRTaylor/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-04-29T23:38:52Z","updated_at":"2020-04-29T23:38:52Z","author_association":"NONE","body":"+1","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/621525366/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/621541933","html_url":"https://github.com/apache/iceberg/issues/970#issuecomment-621541933","issue_url":"https://api.github.com/repos/apache/iceberg/issues/970","id":621541933,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMTU0MTkzMw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-04-30T00:31:20Z","updated_at":"2020-04-30T00:31:20Z","author_association":"CONTRIBUTOR","body":"I'd also check if all commits were successful as Ryan said. This can be done by checking the number of snapshots before and after the test. Then we can be sure that we committed the expected number of snapshots. It may also make sense to tune other retry configs such as min/max wait to improve the performance.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/621541933/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/621542103","html_url":"https://github.com/apache/iceberg/pull/987#issuecomment-621542103","issue_url":"https://api.github.com/repos/apache/iceberg/issues/987","id":621542103,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMTU0MjEwMw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-04-30T00:31:51Z","updated_at":"2020-04-30T00:31:51Z","author_association":"CONTRIBUTOR","body":"+1\r\n\r\nThanks for fixing this so quickly, @aokolnychyi!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/621542103/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/621558051","html_url":"https://github.com/apache/iceberg/pull/708#issuecomment-621558051","issue_url":"https://api.github.com/repos/apache/iceberg/issues/708","id":621558051,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMTU1ODA1MQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-04-30T01:27:42Z","updated_at":"2020-04-30T01:27:42Z","author_association":"CONTRIBUTOR","body":"@Fokko, do you know if shading in Parquet changed? It looks like Parquet is causing the iceberg-spark-runtime Jar to be significantly larger (20MB+). I think it's that fastutil is now shaded in Parquet.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/621558051/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/621651729","html_url":"https://github.com/apache/iceberg/issues/970#issuecomment-621651729","issue_url":"https://api.github.com/repos/apache/iceberg/issues/970","id":621651729,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMTY1MTcyOQ==","user":{"login":"vanliu-tx","id":64360028,"node_id":"MDQ6VXNlcjY0MzYwMDI4","avatar_url":"https://avatars.githubusercontent.com/u/64360028?v=4","gravatar_id":"","url":"https://api.github.com/users/vanliu-tx","html_url":"https://github.com/vanliu-tx","followers_url":"https://api.github.com/users/vanliu-tx/followers","following_url":"https://api.github.com/users/vanliu-tx/following{/other_user}","gists_url":"https://api.github.com/users/vanliu-tx/gists{/gist_id}","starred_url":"https://api.github.com/users/vanliu-tx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vanliu-tx/subscriptions","organizations_url":"https://api.github.com/users/vanliu-tx/orgs","repos_url":"https://api.github.com/users/vanliu-tx/repos","events_url":"https://api.github.com/users/vanliu-tx/events{/privacy}","received_events_url":"https://api.github.com/users/vanliu-tx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-04-30T07:00:57Z","updated_at":"2020-04-30T07:00:57Z","author_association":"CONTRIBUTOR","body":"@rdblue,  In my test case I have modified the default reties to 20 to avoid some threads failed to commit data. One process has 20 threads to commit data, and each thread commit 10 times, the other process has 15 threads, also commit 10 times for each thread. So there are total 350 data commits in my test, which matches the vX.metadata.json(v1~v351, v1 is for creating table) file count in the metadata attached in the zip file (0423_meta.zip). \r\n\r\n`\r\nMap<String, String> props = ImmutableMap.of(TableProperties.DEFAULT_FILE_FORMAT, FILE_FORMAT, TableProperties.COMMIT_NUM_RETRIES, \"20\");\r\n`\r\n\r\nAs per https://github.com/apache/incubator-iceberg/pull/754, I think there are chances when one thread in a process enters commit and passes the base != current() check and then another thread in other process commits and refreshes the current metadata. That way, version is updated while the first thread commits, which, in turn, breaks the atomic rename operation as nextVersion will point to a non-existent file. Current fix only synchronized the commit action in one process, it can't synchronize among multi-processes. @aokolnychyi \r\n\r\nHere is an example that commit 9(v10) override commit 8(v9) as these two commits share the same parent-snapshot-id, so 100000 records are lost from commit 9 and so on. Please see the metadata diff in attached text file.\r\n\r\n[v8_v9_v10_diff.txt](https://github.com/apache/incubator-iceberg/files/4556623/v8_v9_v10_diff.txt)\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/621651729/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/621652911","html_url":"https://github.com/apache/iceberg/issues/970#issuecomment-621652911","issue_url":"https://api.github.com/repos/apache/iceberg/issues/970","id":621652911,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMTY1MjkxMQ==","user":{"login":"vanliu-tx","id":64360028,"node_id":"MDQ6VXNlcjY0MzYwMDI4","avatar_url":"https://avatars.githubusercontent.com/u/64360028?v=4","gravatar_id":"","url":"https://api.github.com/users/vanliu-tx","html_url":"https://github.com/vanliu-tx","followers_url":"https://api.github.com/users/vanliu-tx/followers","following_url":"https://api.github.com/users/vanliu-tx/following{/other_user}","gists_url":"https://api.github.com/users/vanliu-tx/gists{/gist_id}","starred_url":"https://api.github.com/users/vanliu-tx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vanliu-tx/subscriptions","organizations_url":"https://api.github.com/users/vanliu-tx/orgs","repos_url":"https://api.github.com/users/vanliu-tx/repos","events_url":"https://api.github.com/users/vanliu-tx/events{/privacy}","received_events_url":"https://api.github.com/users/vanliu-tx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-04-30T07:03:55Z","updated_at":"2020-04-30T07:03:55Z","author_association":"CONTRIBUTOR","body":"the zip file 0423_meta.zip is in the first post just below the picture.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/621652911/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/621867088","html_url":"https://github.com/apache/iceberg/pull/989#issuecomment-621867088","issue_url":"https://api.github.com/repos/apache/iceberg/issues/989","id":621867088,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMTg2NzA4OA==","user":{"login":"rdsr","id":129474,"node_id":"MDQ6VXNlcjEyOTQ3NA==","avatar_url":"https://avatars.githubusercontent.com/u/129474?v=4","gravatar_id":"","url":"https://api.github.com/users/rdsr","html_url":"https://github.com/rdsr","followers_url":"https://api.github.com/users/rdsr/followers","following_url":"https://api.github.com/users/rdsr/following{/other_user}","gists_url":"https://api.github.com/users/rdsr/gists{/gist_id}","starred_url":"https://api.github.com/users/rdsr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdsr/subscriptions","organizations_url":"https://api.github.com/users/rdsr/orgs","repos_url":"https://api.github.com/users/rdsr/repos","events_url":"https://api.github.com/users/rdsr/events{/privacy}","received_events_url":"https://api.github.com/users/rdsr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-04-30T13:53:22Z","updated_at":"2020-04-30T13:53:22Z","author_association":"CONTRIBUTOR","body":"cc @edgarRd ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/621867088/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/621990745","html_url":"https://github.com/apache/iceberg/issues/970#issuecomment-621990745","issue_url":"https://api.github.com/repos/apache/iceberg/issues/970","id":621990745,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMTk5MDc0NQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-04-30T17:20:48Z","updated_at":"2020-04-30T17:20:48Z","author_association":"CONTRIBUTOR","body":"@vanliu-tx, can you try the PR I just posted?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/621990745/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/622026764","html_url":"https://github.com/apache/iceberg/pull/544#issuecomment-622026764","issue_url":"https://api.github.com/repos/apache/iceberg/issues/544","id":622026764,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMjAyNjc2NA==","user":{"login":"mariusvniekerk","id":73973,"node_id":"MDQ6VXNlcjczOTcz","avatar_url":"https://avatars.githubusercontent.com/u/73973?v=4","gravatar_id":"","url":"https://api.github.com/users/mariusvniekerk","html_url":"https://github.com/mariusvniekerk","followers_url":"https://api.github.com/users/mariusvniekerk/followers","following_url":"https://api.github.com/users/mariusvniekerk/following{/other_user}","gists_url":"https://api.github.com/users/mariusvniekerk/gists{/gist_id}","starred_url":"https://api.github.com/users/mariusvniekerk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mariusvniekerk/subscriptions","organizations_url":"https://api.github.com/users/mariusvniekerk/orgs","repos_url":"https://api.github.com/users/mariusvniekerk/repos","events_url":"https://api.github.com/users/mariusvniekerk/events{/privacy}","received_events_url":"https://api.github.com/users/mariusvniekerk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-04-30T18:32:22Z","updated_at":"2020-04-30T18:32:22Z","author_association":"MEMBER","body":"@TGooch44 This has landed in pyarrow as of 0.17.0","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/622026764/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/622064202","html_url":"https://github.com/apache/iceberg/pull/708#issuecomment-622064202","issue_url":"https://api.github.com/repos/apache/iceberg/issues/708","id":622064202,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMjA2NDIwMg==","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-04-30T19:40:01Z","updated_at":"2020-04-30T19:40:01Z","author_association":"CONTRIBUTOR","body":"@rdblue I've compared the iceberg-parquet jars, and I don't see any (major) changes there. Fastutil is shaded now, but that one is only a few KB's. Let me check Spark.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/622064202/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/622069652","html_url":"https://github.com/apache/iceberg/pull/708#issuecomment-622069652","issue_url":"https://api.github.com/repos/apache/iceberg/issues/708","id":622069652,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMjA2OTY1Mg==","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-04-30T19:49:04Z","updated_at":"2020-04-30T19:49:04Z","author_association":"CONTRIBUTOR","body":"@rdblue looks like you're right! Looks like it is fastutil (and fasterxml Jackson, but that's an order of magnitude smaller):\r\n```\r\nMacBook-Pro-van-Fokko:0.8.0 fokkodriesprong$ du -sh org/apache/* | sort -h\r\n 56K\torg/apache/yetus\r\n142M\torg/apache/iceberg\r\nMacBook-Pro-van-Fokko:0.8.0 fokkodriesprong$ du -sh org/apache/iceberg/shaded/org/apache/parquet/shaded/* | sort -h\r\n288K\torg/apache/iceberg/shaded/org/apache/parquet/shaded/org\r\n7,2M\torg/apache/iceberg/shaded/org/apache/parquet/shaded/com\r\n 71M\torg/apache/iceberg/shaded/org/apache/parquet/shaded/it\r\n\r\n\r\nMacBook-Pro-van-Fokko:0.7.0 fokkodriesprong$ du -sh org/* | sort -h\r\n4,0K\torg/codehaus\r\n 56M\torg/apache\r\nMacBook-Pro-van-Fokko:0.7.0 fokkodriesprong$ du -sh org/apache/iceberg/shaded/org/apache/parquet/shaded/* | sort -h\r\n5,3M\torg/apache/iceberg/shaded/org/apache/parquet/shaded/org\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/622069652/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/622073546","html_url":"https://github.com/apache/iceberg/pull/708#issuecomment-622073546","issue_url":"https://api.github.com/repos/apache/iceberg/issues/708","id":622073546,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMjA3MzU0Ng==","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-04-30T19:54:24Z","updated_at":"2020-04-30T19:54:24Z","author_association":"CONTRIBUTOR","body":"https://issues.apache.org/jira/browse/PARQUET-1529","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/622073546/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/622077806","html_url":"https://github.com/apache/iceberg/pull/708#issuecomment-622077806","issue_url":"https://api.github.com/repos/apache/iceberg/issues/708","id":622077806,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMjA3NzgwNg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-04-30T20:01:44Z","updated_at":"2020-04-30T20:01:44Z","author_association":"CONTRIBUTOR","body":"I just checked the versions of fastutil and they've always been large (17-19MB). The maven-shade-plugin changed, so maybe that isn't doing as good of a job minimizing the Jar?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/622077806/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/622080848","html_url":"https://github.com/apache/iceberg/pull/708#issuecomment-622080848","issue_url":"https://api.github.com/repos/apache/iceberg/issues/708","id":622080848,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMjA4MDg0OA==","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-04-30T20:07:09Z","updated_at":"2020-04-30T20:07:09Z","author_association":"CONTRIBUTOR","body":"Compressed:\r\n```\r\nMacBook-Pro-van-Fokko:Downloads fokkodriesprong$ du -h 0.7.0/iceberg-spark-runtime-0.7.0-incubating.jar \r\n 15M\t0.7.0/iceberg-spark-runtime-0.7.0-incubating.jar\r\nMacBook-Pro-van-Fokko:Downloads fokkodriesprong$ du -h 0.8.0/iceberg-spark-runtime-0.8.0-incubating.jar \r\n 37M\t0.8.0/iceberg-spark-runtime-0.8.0-incubating.jar\r\n```\r\n\r\nUncompressed (after removing the binaries):\r\n```\r\nMacBook-Pro-van-Fokko:Downloads fokkodriesprong$ du -s -h 0.7.0/\r\n 56M\t0.7.0/\r\nMacBook-Pro-van-Fokko:Downloads fokkodriesprong$ du -s -h 0.8.0/\r\n143M\t0.8.0/\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/622080848/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/622088705","html_url":"https://github.com/apache/iceberg/pull/708#issuecomment-622088705","issue_url":"https://api.github.com/repos/apache/iceberg/issues/708","id":622088705,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMjA4ODcwNQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-04-30T20:21:50Z","updated_at":"2020-04-30T20:21:50Z","author_association":"CONTRIBUTOR","body":"Yeah, and locally I see that 78MB of that uncompressed size is fastutil.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/622088705/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/622092554","html_url":"https://github.com/apache/iceberg/pull/708#issuecomment-622092554","issue_url":"https://api.github.com/repos/apache/iceberg/issues/708","id":622092554,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMjA5MjU1NA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-04-30T20:29:18Z","updated_at":"2020-04-30T20:29:18Z","author_association":"CONTRIBUTOR","body":"Looks like fastutil isn't minimized in parquet-avro and parquet-hadoop.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/622092554/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/622096054","html_url":"https://github.com/apache/iceberg/pull/708#issuecomment-622096054","issue_url":"https://api.github.com/repos/apache/iceberg/issues/708","id":622096054,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMjA5NjA1NA==","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-04-30T20:35:55Z","updated_at":"2020-04-30T20:36:04Z","author_association":"CONTRIBUTOR","body":"Looks like it. For Avro it is 18.6MB vs 123KB for Avro. For Hadoop it is 427KB vs 279KB (1.10.1 vs 1.11.0).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/622096054/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/622098211","html_url":"https://github.com/apache/iceberg/pull/708#issuecomment-622098211","issue_url":"https://api.github.com/repos/apache/iceberg/issues/708","id":622098211,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMjA5ODIxMQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-04-30T20:39:51Z","updated_at":"2020-04-30T20:39:51Z","author_association":"CONTRIBUTOR","body":"I only checked Avro. Must just be that one then.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/622098211/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/622099184","html_url":"https://github.com/apache/iceberg/pull/708#issuecomment-622099184","issue_url":"https://api.github.com/repos/apache/iceberg/issues/708","id":622099184,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMjA5OTE4NA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-04-30T20:41:40Z","updated_at":"2020-04-30T20:41:40Z","author_association":"CONTRIBUTOR","body":"https://github.com/apache/incubator-iceberg/pull/992","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/622099184/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/622107823","html_url":"https://github.com/apache/iceberg/pull/992#issuecomment-622107823","issue_url":"https://api.github.com/repos/apache/iceberg/issues/992","id":622107823,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMjEwNzgyMw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-04-30T20:57:35Z","updated_at":"2020-04-30T20:57:35Z","author_association":"CONTRIBUTOR","body":"Looks like this also requires downgrading Avro.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/622107823/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/622110372","html_url":"https://github.com/apache/iceberg/pull/992#issuecomment-622110372","issue_url":"https://api.github.com/repos/apache/iceberg/issues/992","id":622110372,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMjExMDM3Mg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-04-30T21:02:52Z","updated_at":"2020-04-30T21:02:52Z","author_association":"CONTRIBUTOR","body":"I'm going to close this. I don't think it's worth downgrading to fix the Jar size. We'll release an 0.8.1 when Parquet is fixed.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/622110372/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/622111138","html_url":"https://github.com/apache/iceberg/pull/992#issuecomment-622111138","issue_url":"https://api.github.com/repos/apache/iceberg/issues/992","id":622111138,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMjExMTEzOA==","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-04-30T21:04:29Z","updated_at":"2020-04-30T21:04:29Z","author_association":"CONTRIBUTOR","body":"This is going to be troublesome since we've also updated the private constructors in Parquet.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/622111138/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/622112351","html_url":"https://github.com/apache/iceberg/pull/708#issuecomment-622112351","issue_url":"https://api.github.com/repos/apache/iceberg/issues/708","id":622112351,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMjExMjM1MQ==","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-04-30T21:06:56Z","updated_at":"2020-04-30T21:06:56Z","author_association":"CONTRIBUTOR","body":"https://github.com/apache/parquet-mr/pull/790","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/622112351/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/622128116","html_url":"https://github.com/apache/iceberg/pull/991#issuecomment-622128116","issue_url":"https://api.github.com/repos/apache/iceberg/issues/991","id":622128116,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMjEyODExNg==","user":{"login":"dongjoon-hyun","id":9700541,"node_id":"MDQ6VXNlcjk3MDA1NDE=","avatar_url":"https://avatars.githubusercontent.com/u/9700541?v=4","gravatar_id":"","url":"https://api.github.com/users/dongjoon-hyun","html_url":"https://github.com/dongjoon-hyun","followers_url":"https://api.github.com/users/dongjoon-hyun/followers","following_url":"https://api.github.com/users/dongjoon-hyun/following{/other_user}","gists_url":"https://api.github.com/users/dongjoon-hyun/gists{/gist_id}","starred_url":"https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongjoon-hyun/subscriptions","organizations_url":"https://api.github.com/users/dongjoon-hyun/orgs","repos_url":"https://api.github.com/users/dongjoon-hyun/repos","events_url":"https://api.github.com/users/dongjoon-hyun/events{/privacy}","received_events_url":"https://api.github.com/users/dongjoon-hyun/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-04-30T21:37:35Z","updated_at":"2020-04-30T21:37:35Z","author_association":"MEMBER","body":"Thank you for review and approval, @Fokko .","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/622128116/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/622148812","html_url":"https://github.com/apache/iceberg/pull/991#issuecomment-622148812","issue_url":"https://api.github.com/repos/apache/iceberg/issues/991","id":622148812,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMjE0ODgxMg==","user":{"login":"dongjoon-hyun","id":9700541,"node_id":"MDQ6VXNlcjk3MDA1NDE=","avatar_url":"https://avatars.githubusercontent.com/u/9700541?v=4","gravatar_id":"","url":"https://api.github.com/users/dongjoon-hyun","html_url":"https://github.com/dongjoon-hyun","followers_url":"https://api.github.com/users/dongjoon-hyun/followers","following_url":"https://api.github.com/users/dongjoon-hyun/following{/other_user}","gists_url":"https://api.github.com/users/dongjoon-hyun/gists{/gist_id}","starred_url":"https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongjoon-hyun/subscriptions","organizations_url":"https://api.github.com/users/dongjoon-hyun/orgs","repos_url":"https://api.github.com/users/dongjoon-hyun/repos","events_url":"https://api.github.com/users/dongjoon-hyun/events{/privacy}","received_events_url":"https://api.github.com/users/dongjoon-hyun/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-04-30T22:24:30Z","updated_at":"2020-04-30T22:24:30Z","author_association":"MEMBER","body":"cc @omalley ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/622148812/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/622154537","html_url":"https://github.com/apache/iceberg/pull/991#issuecomment-622154537","issue_url":"https://api.github.com/repos/apache/iceberg/issues/991","id":622154537,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMjE1NDUzNw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-04-30T22:38:13Z","updated_at":"2020-04-30T22:51:45Z","author_association":"CONTRIBUTOR","body":"I feel like me may want to do 0.8.1 with the new ORC and Parquet version (i.e. the jar size problem).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/622154537/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/622246098","html_url":"https://github.com/apache/iceberg/pull/989#issuecomment-622246098","issue_url":"https://api.github.com/repos/apache/iceberg/issues/989","id":622246098,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMjI0NjA5OA==","user":{"login":"rdsr","id":129474,"node_id":"MDQ6VXNlcjEyOTQ3NA==","avatar_url":"https://avatars.githubusercontent.com/u/129474?v=4","gravatar_id":"","url":"https://api.github.com/users/rdsr","html_url":"https://github.com/rdsr","followers_url":"https://api.github.com/users/rdsr/followers","following_url":"https://api.github.com/users/rdsr/following{/other_user}","gists_url":"https://api.github.com/users/rdsr/gists{/gist_id}","starred_url":"https://api.github.com/users/rdsr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdsr/subscriptions","organizations_url":"https://api.github.com/users/rdsr/orgs","repos_url":"https://api.github.com/users/rdsr/repos","events_url":"https://api.github.com/users/rdsr/events{/privacy}","received_events_url":"https://api.github.com/users/rdsr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-01T04:46:09Z","updated_at":"2020-05-01T14:58:07Z","author_association":"CONTRIBUTOR","body":"I reran the Spark jmh tests which @shardulm94  had written on a fresh checkout of iceberg and against my patch. Here's the output\r\n\r\nFresh checkout of Iceberg\r\n```\r\nBenchmark                                                                          Mode  Cnt   Score   Error  Units\r\nIcebergSourceNestedORCDataReadBenchmark.readFileSourceNonVectorized                  ss    5  11.004 ± 0.330   s/op\r\nIcebergSourceNestedORCDataReadBenchmark.readFileSourceVectorized                     ss    5  10.920 ± 1.424   s/op\r\nIcebergSourceNestedORCDataReadBenchmark.readIceberg                                  ss    5   2.028 ± 0.103   s/op\r\nIcebergSourceNestedORCDataReadBenchmark.readWithProjectionFileSourceNonVectorized    ss    5  10.695 ± 0.203   s/op\r\nIcebergSourceNestedORCDataReadBenchmark.readWithProjectionFileSourceVectorized       ss    5  10.293 ± 0.236   s/op\r\nIcebergSourceNestedORCDataReadBenchmark.readWithProjectionIceberg                    ss    5   1.850 ± 0.211   s/op\r\n```\r\n\r\nWith the ORC nested partition patch applied\r\n```\r\nBenchmark                                                                          Mode  Cnt   Score   Error  Units\r\nIcebergSourceNestedORCDataReadBenchmark.readFileSourceNonVectorized                  ss    5  13.984 ± 0.440   s/op\r\nIcebergSourceNestedORCDataReadBenchmark.readFileSourceVectorized                     ss    5  10.454 ± 0.438   s/op\r\nIcebergSourceNestedORCDataReadBenchmark.readIceberg                                  ss    5   2.264 ± 0.091   s/op\r\nIcebergSourceNestedORCDataReadBenchmark.readWithProjectionFileSourceNonVectorized    ss    5  10.037 ± 0.241   s/op\r\nIcebergSourceNestedORCDataReadBenchmark.readWithProjectionFileSourceVectorized       ss    5  10.615 ± 0.336   s/op\r\nIcebergSourceNestedORCDataReadBenchmark.readWithProjectionIceberg                    ss    5   1.980 ± 0.167   s/op\r\n```\r\n\r\nSeems like there isn't much difference. cc @shardulm94 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/622246098/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/622473506","html_url":"https://github.com/apache/iceberg/issues/994#issuecomment-622473506","issue_url":"https://api.github.com/repos/apache/iceberg/issues/994","id":622473506,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMjQ3MzUwNg==","user":{"login":"waterlx","id":13976495,"node_id":"MDQ6VXNlcjEzOTc2NDk1","avatar_url":"https://avatars.githubusercontent.com/u/13976495?v=4","gravatar_id":"","url":"https://api.github.com/users/waterlx","html_url":"https://github.com/waterlx","followers_url":"https://api.github.com/users/waterlx/followers","following_url":"https://api.github.com/users/waterlx/following{/other_user}","gists_url":"https://api.github.com/users/waterlx/gists{/gist_id}","starred_url":"https://api.github.com/users/waterlx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/waterlx/subscriptions","organizations_url":"https://api.github.com/users/waterlx/orgs","repos_url":"https://api.github.com/users/waterlx/repos","events_url":"https://api.github.com/users/waterlx/events{/privacy}","received_events_url":"https://api.github.com/users/waterlx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-01T17:06:10Z","updated_at":"2020-05-01T17:06:10Z","author_association":"CONTRIBUTOR","body":"To fix that, do we need to be more strict to exclude the sub-class of PositionAccessor when routing to build Position2Accessor?\r\nAccessors and #983 seems have the same issue?\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/622473506/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/622475299","html_url":"https://github.com/apache/iceberg/issues/994#issuecomment-622475299","issue_url":"https://api.github.com/repos/apache/iceberg/issues/994","id":622475299,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMjQ3NTI5OQ==","user":{"login":"waterlx","id":13976495,"node_id":"MDQ6VXNlcjEzOTc2NDk1","avatar_url":"https://avatars.githubusercontent.com/u/13976495?v=4","gravatar_id":"","url":"https://api.github.com/users/waterlx","html_url":"https://github.com/waterlx","followers_url":"https://api.github.com/users/waterlx/followers","following_url":"https://api.github.com/users/waterlx/following{/other_user}","gists_url":"https://api.github.com/users/waterlx/gists{/gist_id}","starred_url":"https://api.github.com/users/waterlx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/waterlx/subscriptions","organizations_url":"https://api.github.com/users/waterlx/orgs","repos_url":"https://api.github.com/users/waterlx/repos","events_url":"https://api.github.com/users/waterlx/events{/privacy}","received_events_url":"https://api.github.com/users/waterlx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-01T17:10:32Z","updated_at":"2020-05-01T17:10:32Z","author_association":"CONTRIBUTOR","body":"@rdblue Does it make sense to you?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/622475299/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/622536889","html_url":"https://github.com/apache/iceberg/issues/994#issuecomment-622536889","issue_url":"https://api.github.com/repos/apache/iceberg/issues/994","id":622536889,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMjUzNjg4OQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-01T19:49:28Z","updated_at":"2020-05-01T19:49:28Z","author_association":"CONTRIBUTOR","body":"Yes, I think you're right. One solution is to not wrap the specialized accessors. We may also be able to keep a transform function so that it is applied by the outer-most accessor. That would keep the two concerns separate.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/622536889/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/622609353","html_url":"https://github.com/apache/iceberg/pull/991#issuecomment-622609353","issue_url":"https://api.github.com/repos/apache/iceberg/issues/991","id":622609353,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMjYwOTM1Mw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-01T23:25:39Z","updated_at":"2020-05-01T23:25:39Z","author_association":"CONTRIBUTOR","body":"Thanks, @dongjoon-hyun!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/622609353/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/623171138","html_url":"https://github.com/apache/iceberg/pull/991#issuecomment-623171138","issue_url":"https://api.github.com/repos/apache/iceberg/issues/991","id":623171138,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMzE3MTEzOA==","user":{"login":"dongjoon-hyun","id":9700541,"node_id":"MDQ6VXNlcjk3MDA1NDE=","avatar_url":"https://avatars.githubusercontent.com/u/9700541?v=4","gravatar_id":"","url":"https://api.github.com/users/dongjoon-hyun","html_url":"https://github.com/dongjoon-hyun","followers_url":"https://api.github.com/users/dongjoon-hyun/followers","following_url":"https://api.github.com/users/dongjoon-hyun/following{/other_user}","gists_url":"https://api.github.com/users/dongjoon-hyun/gists{/gist_id}","starred_url":"https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongjoon-hyun/subscriptions","organizations_url":"https://api.github.com/users/dongjoon-hyun/orgs","repos_url":"https://api.github.com/users/dongjoon-hyun/repos","events_url":"https://api.github.com/users/dongjoon-hyun/events{/privacy}","received_events_url":"https://api.github.com/users/dongjoon-hyun/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-03T19:54:55Z","updated_at":"2020-05-03T19:54:55Z","author_association":"MEMBER","body":"Thank you for review and merging, @rdblue . Also, thank you, @aokolnychyi , @Fokko .","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/623171138/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/623551215","html_url":"https://github.com/apache/iceberg/pull/996#issuecomment-623551215","issue_url":"https://api.github.com/repos/apache/iceberg/issues/996","id":623551215,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMzU1MTIxNQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-04T15:59:35Z","updated_at":"2020-05-04T15:59:35Z","author_association":"CONTRIBUTOR","body":"@TGooch44, could you take a look at this Python PR?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/623551215/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/623551538","html_url":"https://github.com/apache/iceberg/pull/996#issuecomment-623551538","issue_url":"https://api.github.com/repos/apache/iceberg/issues/996","id":623551538,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMzU1MTUzOA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-04T16:00:06Z","updated_at":"2020-05-04T16:00:06Z","author_association":"CONTRIBUTOR","body":"@jun-he, can you explain what was wrong and needed to be fixed in the description of this PR?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/623551538/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/623557860","html_url":"https://github.com/apache/iceberg/pull/939#issuecomment-623557860","issue_url":"https://api.github.com/repos/apache/iceberg/issues/939","id":623557860,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMzU1Nzg2MA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-04T16:11:12Z","updated_at":"2020-05-04T16:11:12Z","author_association":"CONTRIBUTOR","body":"Overall, I think this is ready. I'd prefer to use `current` instead of `refresh` in the `updateEvent` methods, though. I'd probably wait to merge until then.\r\n\r\nIt would also be good to follow up with events in snapshot manager: rollback, fast-forward, and set current snapshot.\r\n\r\nLast, I think that this is going to send events each time an individual operation is committed in a transaction. That's okay for now, but we may want to go back through and suppress events during a transaction and then send them all at once when the transaction succeeds. That will handle retries better.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/623557860/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/623559713","html_url":"https://github.com/apache/iceberg/pull/939#issuecomment-623559713","issue_url":"https://api.github.com/repos/apache/iceberg/issues/939","id":623559713,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMzU1OTcxMw==","user":{"login":"rdsr","id":129474,"node_id":"MDQ6VXNlcjEyOTQ3NA==","avatar_url":"https://avatars.githubusercontent.com/u/129474?v=4","gravatar_id":"","url":"https://api.github.com/users/rdsr","html_url":"https://github.com/rdsr","followers_url":"https://api.github.com/users/rdsr/followers","following_url":"https://api.github.com/users/rdsr/following{/other_user}","gists_url":"https://api.github.com/users/rdsr/gists{/gist_id}","starred_url":"https://api.github.com/users/rdsr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdsr/subscriptions","organizations_url":"https://api.github.com/users/rdsr/orgs","repos_url":"https://api.github.com/users/rdsr/repos","events_url":"https://api.github.com/users/rdsr/events{/privacy}","received_events_url":"https://api.github.com/users/rdsr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-04T16:14:37Z","updated_at":"2020-05-04T16:14:37Z","author_association":"CONTRIBUTOR","body":"Thanks @rdblue . I'll create followups for the remaining items","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/623559713/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/623574959","html_url":"https://github.com/apache/iceberg/pull/996#issuecomment-623574959","issue_url":"https://api.github.com/repos/apache/iceberg/issues/996","id":623574959,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMzU3NDk1OQ==","user":{"login":"TGooch44","id":1591711,"node_id":"MDQ6VXNlcjE1OTE3MTE=","avatar_url":"https://avatars.githubusercontent.com/u/1591711?v=4","gravatar_id":"","url":"https://api.github.com/users/TGooch44","html_url":"https://github.com/TGooch44","followers_url":"https://api.github.com/users/TGooch44/followers","following_url":"https://api.github.com/users/TGooch44/following{/other_user}","gists_url":"https://api.github.com/users/TGooch44/gists{/gist_id}","starred_url":"https://api.github.com/users/TGooch44/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TGooch44/subscriptions","organizations_url":"https://api.github.com/users/TGooch44/orgs","repos_url":"https://api.github.com/users/TGooch44/repos","events_url":"https://api.github.com/users/TGooch44/events{/privacy}","received_events_url":"https://api.github.com/users/TGooch44/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-04T16:42:27Z","updated_at":"2020-05-04T16:42:27Z","author_association":"CONTRIBUTOR","body":"I'll review. Issue looks like string formatting was refactored to use .\nformat and the string wasn't updated to use the correct format syntax.\n\nOn Mon, May 4, 2020, 9:00 AM Ryan Blue <notifications@github.com> wrote:\n\n> @jun-he <https://github.com/jun-he>, can you explain what was wrong and\n> needed to be fixed in the description of this PR?\n>\n> —\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/apache/incubator-iceberg/pull/996#issuecomment-623551538>,\n> or unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/AAMETH6VDMSNH2Y4VSHEJO3RP3RBPANCNFSM4MYPZKCQ>\n> .\n>\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/623574959/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/623630277","html_url":"https://github.com/apache/iceberg/pull/996#issuecomment-623630277","issue_url":"https://api.github.com/repos/apache/iceberg/issues/996","id":623630277,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMzYzMDI3Nw==","user":{"login":"TGooch44","id":1591711,"node_id":"MDQ6VXNlcjE1OTE3MTE=","avatar_url":"https://avatars.githubusercontent.com/u/1591711?v=4","gravatar_id":"","url":"https://api.github.com/users/TGooch44","html_url":"https://github.com/TGooch44","followers_url":"https://api.github.com/users/TGooch44/followers","following_url":"https://api.github.com/users/TGooch44/following{/other_user}","gists_url":"https://api.github.com/users/TGooch44/gists{/gist_id}","starred_url":"https://api.github.com/users/TGooch44/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TGooch44/subscriptions","organizations_url":"https://api.github.com/users/TGooch44/orgs","repos_url":"https://api.github.com/users/TGooch44/repos","events_url":"https://api.github.com/users/TGooch44/events{/privacy}","received_events_url":"https://api.github.com/users/TGooch44/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-04T18:29:35Z","updated_at":"2020-05-04T18:29:35Z","author_association":"CONTRIBUTOR","body":"@jun-he looks good to me, except the rest of the project is using pytest for testing and not unittest.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/623630277/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/623874689","html_url":"https://github.com/apache/iceberg/pull/999#issuecomment-623874689","issue_url":"https://api.github.com/repos/apache/iceberg/issues/999","id":623874689,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMzg3NDY4OQ==","user":{"login":"rdsr","id":129474,"node_id":"MDQ6VXNlcjEyOTQ3NA==","avatar_url":"https://avatars.githubusercontent.com/u/129474?v=4","gravatar_id":"","url":"https://api.github.com/users/rdsr","html_url":"https://github.com/rdsr","followers_url":"https://api.github.com/users/rdsr/followers","following_url":"https://api.github.com/users/rdsr/following{/other_user}","gists_url":"https://api.github.com/users/rdsr/gists{/gist_id}","starred_url":"https://api.github.com/users/rdsr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdsr/subscriptions","organizations_url":"https://api.github.com/users/rdsr/orgs","repos_url":"https://api.github.com/users/rdsr/repos","events_url":"https://api.github.com/users/rdsr/events{/privacy}","received_events_url":"https://api.github.com/users/rdsr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-05T06:16:27Z","updated_at":"2020-05-05T06:16:27Z","author_association":"CONTRIBUTOR","body":"Thanks @rdblue . I'll look into it tomorrow!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/623874689/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/623883015","html_url":"https://github.com/apache/iceberg/pull/996#issuecomment-623883015","issue_url":"https://api.github.com/repos/apache/iceberg/issues/996","id":623883015,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMzg4MzAxNQ==","user":{"login":"jun-he","id":12246263,"node_id":"MDQ6VXNlcjEyMjQ2MjYz","avatar_url":"https://avatars.githubusercontent.com/u/12246263?v=4","gravatar_id":"","url":"https://api.github.com/users/jun-he","html_url":"https://github.com/jun-he","followers_url":"https://api.github.com/users/jun-he/followers","following_url":"https://api.github.com/users/jun-he/following{/other_user}","gists_url":"https://api.github.com/users/jun-he/gists{/gist_id}","starred_url":"https://api.github.com/users/jun-he/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jun-he/subscriptions","organizations_url":"https://api.github.com/users/jun-he/orgs","repos_url":"https://api.github.com/users/jun-he/repos","events_url":"https://api.github.com/users/jun-he/events{/privacy}","received_events_url":"https://api.github.com/users/jun-he/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-05T06:45:32Z","updated_at":"2020-05-05T06:45:32Z","author_association":"COLLABORATOR","body":"@TGooch44  Thanks for the comments and updated the test accordingly.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/623883015/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624117201","html_url":"https://github.com/apache/iceberg/pull/1002#issuecomment-624117201","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1002","id":624117201,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNDExNzIwMQ==","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-05T15:16:23Z","updated_at":"2020-05-05T15:16:23Z","author_association":"COLLABORATOR","body":"Nice PR! Just a minor comment about adding comments.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624117201/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624143229","html_url":"https://github.com/apache/iceberg/pull/999#issuecomment-624143229","issue_url":"https://api.github.com/repos/apache/iceberg/issues/999","id":624143229,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNDE0MzIyOQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-05T16:00:42Z","updated_at":"2020-05-05T16:00:42Z","author_association":"CONTRIBUTOR","body":"Thanks, @rdsr! Good for you to review since we will need to do the same thing for the ORC writers.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624143229/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624148453","html_url":"https://github.com/apache/iceberg/pull/1003#issuecomment-624148453","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1003","id":624148453,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNDE0ODQ1Mw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-05T16:09:47Z","updated_at":"2020-05-05T16:09:47Z","author_association":"CONTRIBUTOR","body":"Looks good, @waterlx. I'll merge when tests pass. Thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624148453/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624148659","html_url":"https://github.com/apache/iceberg/pull/1003#issuecomment-624148659","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1003","id":624148659,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNDE0ODY1OQ==","user":{"login":"waterlx","id":13976495,"node_id":"MDQ6VXNlcjEzOTc2NDk1","avatar_url":"https://avatars.githubusercontent.com/u/13976495?v=4","gravatar_id":"","url":"https://api.github.com/users/waterlx","html_url":"https://github.com/waterlx","followers_url":"https://api.github.com/users/waterlx/followers","following_url":"https://api.github.com/users/waterlx/following{/other_user}","gists_url":"https://api.github.com/users/waterlx/gists{/gist_id}","starred_url":"https://api.github.com/users/waterlx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/waterlx/subscriptions","organizations_url":"https://api.github.com/users/waterlx/orgs","repos_url":"https://api.github.com/users/waterlx/repos","events_url":"https://api.github.com/users/waterlx/events{/privacy}","received_events_url":"https://api.github.com/users/waterlx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-05T16:10:06Z","updated_at":"2020-05-05T16:12:05Z","author_association":"CONTRIBUTOR","body":"I find those are parts of #983 which is being draft by @chenjunjiedada ,  but does it make sense to make them addressed by a this PR separately so as to benefit others as early as possible (they are of use in Flink sink as well ^_^)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624148659/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624164060","html_url":"https://github.com/apache/iceberg/pull/1000#issuecomment-624164060","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1000","id":624164060,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNDE2NDA2MA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-05T16:38:04Z","updated_at":"2020-05-05T16:38:04Z","author_association":"CONTRIBUTOR","body":"@samarthjain, can you describe these changes in the description and give more context about why they are needed?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624164060/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624187049","html_url":"https://github.com/apache/iceberg/pull/1004#issuecomment-624187049","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1004","id":624187049,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNDE4NzA0OQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-05T17:12:05Z","updated_at":"2020-05-05T17:12:05Z","author_association":"CONTRIBUTOR","body":"@rdsr, this affects the work you're doing for ORC identity projections.\r\n\r\n@samarthjain, this hopefully makes the vectorized read path a bit easier.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624187049/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624228236","html_url":"https://github.com/apache/iceberg/pull/1000#issuecomment-624228236","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1000","id":624228236,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNDIyODIzNg==","user":{"login":"samarthjain","id":1642180,"node_id":"MDQ6VXNlcjE2NDIxODA=","avatar_url":"https://avatars.githubusercontent.com/u/1642180?v=4","gravatar_id":"","url":"https://api.github.com/users/samarthjain","html_url":"https://github.com/samarthjain","followers_url":"https://api.github.com/users/samarthjain/followers","following_url":"https://api.github.com/users/samarthjain/following{/other_user}","gists_url":"https://api.github.com/users/samarthjain/gists{/gist_id}","starred_url":"https://api.github.com/users/samarthjain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samarthjain/subscriptions","organizations_url":"https://api.github.com/users/samarthjain/orgs","repos_url":"https://api.github.com/users/samarthjain/repos","events_url":"https://api.github.com/users/samarthjain/events{/privacy}","received_events_url":"https://api.github.com/users/samarthjain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-05T18:27:20Z","updated_at":"2020-05-05T18:27:20Z","author_association":"COLLABORATOR","body":"@rdblue, @prodeezy - I have updated the PR describing the changes. Also pushed a commit to add doc for the method.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624228236/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624408226","html_url":"https://github.com/apache/iceberg/issues/970#issuecomment-624408226","issue_url":"https://api.github.com/repos/apache/iceberg/issues/970","id":624408226,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNDQwODIyNg==","user":{"login":"vanliu-tx","id":64360028,"node_id":"MDQ6VXNlcjY0MzYwMDI4","avatar_url":"https://avatars.githubusercontent.com/u/64360028?v=4","gravatar_id":"","url":"https://api.github.com/users/vanliu-tx","html_url":"https://github.com/vanliu-tx","followers_url":"https://api.github.com/users/vanliu-tx/followers","following_url":"https://api.github.com/users/vanliu-tx/following{/other_user}","gists_url":"https://api.github.com/users/vanliu-tx/gists{/gist_id}","starred_url":"https://api.github.com/users/vanliu-tx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vanliu-tx/subscriptions","organizations_url":"https://api.github.com/users/vanliu-tx/orgs","repos_url":"https://api.github.com/users/vanliu-tx/repos","events_url":"https://api.github.com/users/vanliu-tx/events{/privacy}","received_events_url":"https://api.github.com/users/vanliu-tx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-06T02:18:49Z","updated_at":"2020-05-06T02:18:49Z","author_association":"CONTRIBUTOR","body":"I was on vacation in last five days, will test it today and let you know the result.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624408226/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624532556","html_url":"https://github.com/apache/iceberg/pull/974#issuecomment-624532556","issue_url":"https://api.github.com/repos/apache/iceberg/issues/974","id":624532556,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNDUzMjU1Ng==","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-06T09:12:01Z","updated_at":"2020-05-06T09:47:09Z","author_association":"COLLABORATOR","body":"In [#963](https://github.com/apache/incubator-iceberg/pull/963), the `MergingSnapshotProducer#createManifest` calls`writer.add(entry)` which has a wrapper always set the sequence number to null so that inheritance logic could work. While in the current master, the `createManifest` does not wrap the entry so that the sequence number is inherited from its manifest, which is -1, then the later inheritance logic is bypassed.\r\n\r\n@rdblue, I add the fix here and remove unrelated changes, could you please have a look?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624532556/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624584967","html_url":"https://github.com/apache/iceberg/pull/935#issuecomment-624584967","issue_url":"https://api.github.com/repos/apache/iceberg/issues/935","id":624584967,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNDU4NDk2Nw==","user":{"login":"massdosage","id":29457,"node_id":"MDQ6VXNlcjI5NDU3","avatar_url":"https://avatars.githubusercontent.com/u/29457?v=4","gravatar_id":"","url":"https://api.github.com/users/massdosage","html_url":"https://github.com/massdosage","followers_url":"https://api.github.com/users/massdosage/followers","following_url":"https://api.github.com/users/massdosage/following{/other_user}","gists_url":"https://api.github.com/users/massdosage/gists{/gist_id}","starred_url":"https://api.github.com/users/massdosage/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/massdosage/subscriptions","organizations_url":"https://api.github.com/users/massdosage/orgs","repos_url":"https://api.github.com/users/massdosage/repos","events_url":"https://api.github.com/users/massdosage/events{/privacy}","received_events_url":"https://api.github.com/users/massdosage/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-06T11:07:56Z","updated_at":"2020-05-06T11:07:56Z","author_association":"CONTRIBUTOR","body":"Could we get another look at this from the committers please? I think we just need answers on two questions:\r\n\r\n1. What package to use for the relocated code (see comments and discussion above). My vote goes for `org.apache.iceberg.[original.package.name]`.\r\n2. Whether to minimise or not. My vote goes for not.\r\n\r\nOnce we have a decision on those we can apply the changes to the entire project and check whether this resolves the issues we see when trying to run the InputFormat on Hive.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624584967/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624619670","html_url":"https://github.com/apache/iceberg/issues/970#issuecomment-624619670","issue_url":"https://api.github.com/repos/apache/iceberg/issues/970","id":624619670,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNDYxOTY3MA==","user":{"login":"vanliu-tx","id":64360028,"node_id":"MDQ6VXNlcjY0MzYwMDI4","avatar_url":"https://avatars.githubusercontent.com/u/64360028?v=4","gravatar_id":"","url":"https://api.github.com/users/vanliu-tx","html_url":"https://github.com/vanliu-tx","followers_url":"https://api.github.com/users/vanliu-tx/followers","following_url":"https://api.github.com/users/vanliu-tx/following{/other_user}","gists_url":"https://api.github.com/users/vanliu-tx/gists{/gist_id}","starred_url":"https://api.github.com/users/vanliu-tx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vanliu-tx/subscriptions","organizations_url":"https://api.github.com/users/vanliu-tx/orgs","repos_url":"https://api.github.com/users/vanliu-tx/repos","events_url":"https://api.github.com/users/vanliu-tx/events{/privacy}","received_events_url":"https://api.github.com/users/vanliu-tx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-06T12:28:23Z","updated_at":"2020-05-06T12:28:23Z","author_association":"CONTRIBUTOR","body":"@rdblue I just run my test case (one process with 50 threads commit data files concurrently) with the lastest main branch, however, it failed. \r\n\r\nSome commits are lost as there were 500 commits in total, but only 485 metadata files. See the attached metadata folder zip file.\r\n[050605_metadata.zip](https://github.com/apache/incubator-iceberg/files/4586652/050605_metadata.zip)\r\n\r\nThere are some NPE in the log file, and the exception count (16) matches the missing commit count.\r\n`\r\nFailed to notify listeners (org.apache.iceberg.SnapshotProducer:308)\r\njava.lang.NullPointerException\r\n\tat org.apache.iceberg.MergingSnapshotProducer.updateEvent(MergingSnapshotProducer.java:325)\r\n\tat org.apache.iceberg.SnapshotProducer.notifyListeners(SnapshotProducer.java:303)\r\n\tat org.apache.iceberg.SnapshotProducer.commit(SnapshotProducer.java:298)\r\n\tat com.tencent.bkdata.iceberg.StreamDemo$1.run(StreamDemo.java:191)\r\n\tat java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)\r\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:266)\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n\tat java.lang.Thread.run(Thread.java:748)\r\n`\r\n\r\n[run.log](https://github.com/apache/incubator-iceberg/files/4586658/run.log)\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624619670/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624648209","html_url":"https://github.com/apache/iceberg/pull/935#issuecomment-624648209","issue_url":"https://api.github.com/repos/apache/iceberg/issues/935","id":624648209,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNDY0ODIwOQ==","user":{"login":"jerryshao","id":850797,"node_id":"MDQ6VXNlcjg1MDc5Nw==","avatar_url":"https://avatars.githubusercontent.com/u/850797?v=4","gravatar_id":"","url":"https://api.github.com/users/jerryshao","html_url":"https://github.com/jerryshao","followers_url":"https://api.github.com/users/jerryshao/followers","following_url":"https://api.github.com/users/jerryshao/following{/other_user}","gists_url":"https://api.github.com/users/jerryshao/gists{/gist_id}","starred_url":"https://api.github.com/users/jerryshao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jerryshao/subscriptions","organizations_url":"https://api.github.com/users/jerryshao/orgs","repos_url":"https://api.github.com/users/jerryshao/repos","events_url":"https://api.github.com/users/jerryshao/events{/privacy}","received_events_url":"https://api.github.com/users/jerryshao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-06T13:26:29Z","updated_at":"2020-05-06T13:26:29Z","author_association":"CONTRIBUTOR","body":"I’m in favor of `org.apache.iceberg.[original.package.name]`, or `o.a.i.shaded.[orginal.package.name]`.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624648209/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624720675","html_url":"https://github.com/apache/iceberg/pull/999#issuecomment-624720675","issue_url":"https://api.github.com/repos/apache/iceberg/issues/999","id":624720675,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNDcyMDY3NQ==","user":{"login":"rdsr","id":129474,"node_id":"MDQ6VXNlcjEyOTQ3NA==","avatar_url":"https://avatars.githubusercontent.com/u/129474?v=4","gravatar_id":"","url":"https://api.github.com/users/rdsr","html_url":"https://github.com/rdsr","followers_url":"https://api.github.com/users/rdsr/followers","following_url":"https://api.github.com/users/rdsr/following{/other_user}","gists_url":"https://api.github.com/users/rdsr/gists{/gist_id}","starred_url":"https://api.github.com/users/rdsr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdsr/subscriptions","organizations_url":"https://api.github.com/users/rdsr/orgs","repos_url":"https://api.github.com/users/rdsr/repos","events_url":"https://api.github.com/users/rdsr/events{/privacy}","received_events_url":"https://api.github.com/users/rdsr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-06T15:32:29Z","updated_at":"2020-05-06T15:32:29Z","author_association":"CONTRIBUTOR","body":"LGTM. Minor comments","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624720675/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624723722","html_url":"https://github.com/apache/iceberg/pull/933#issuecomment-624723722","issue_url":"https://api.github.com/repos/apache/iceberg/issues/933","id":624723722,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNDcyMzcyMg==","user":{"login":"massdosage","id":29457,"node_id":"MDQ6VXNlcjI5NDU3","avatar_url":"https://avatars.githubusercontent.com/u/29457?v=4","gravatar_id":"","url":"https://api.github.com/users/massdosage","html_url":"https://github.com/massdosage","followers_url":"https://api.github.com/users/massdosage/followers","following_url":"https://api.github.com/users/massdosage/following{/other_user}","gists_url":"https://api.github.com/users/massdosage/gists{/gist_id}","starred_url":"https://api.github.com/users/massdosage/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/massdosage/subscriptions","organizations_url":"https://api.github.com/users/massdosage/orgs","repos_url":"https://api.github.com/users/massdosage/repos","events_url":"https://api.github.com/users/massdosage/events{/privacy}","received_events_url":"https://api.github.com/users/massdosage/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-06T15:37:47Z","updated_at":"2020-05-06T15:37:47Z","author_association":"CONTRIBUTOR","body":"This is ready for another round of review. We've tried to refactor as much of the shared code between the InputFormats as possible but it's still not perfect. What we'd like input on:\r\n\r\n1. General feedback on the code layout, suggestions for improvement, any other shared code that could be cleaned up.\r\n2. What to do with the Hive dependencies that are creeping into the InputFormat? To make it really useful in Hive we'd actually need to add more (for example you can look at our downstream project that we are adding features in before attempting to merge them here to see what a more complete InputFormat for Hive would look like - https://github.com/ExpediaGroup/hiveberg/blob/master/src/main/java/com/expediagroup/hiveberg/IcebergInputFormat.java). For a more useful Hive integration we would also add a SerDe, StorageHandler etc. We could decide to put all of that code in `iceberg-hive` or create a new `hive-exec` subproject. \r\n3. Once we've decided that we need to decide how best to share code between what's in `mr` and whether it's worth having a \"base\" `mapred` InputFormat in `mr`and then possibly an extension of it in the hive/hive-exec subproject which extends it and adds Hive-specific functionality (this will be more complicated than just moving the whole thing there).\r\n4. And a gentle reminder that none of this will be usable in Hive until #935 has been completed.\r\n\r\nThoughts?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624723722/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624766145","html_url":"https://github.com/apache/iceberg/pull/856#issuecomment-624766145","issue_url":"https://api.github.com/repos/apache/iceberg/issues/856","id":624766145,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNDc2NjE0NQ==","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-06T16:54:06Z","updated_at":"2020-05-06T16:54:41Z","author_association":"CONTRIBUTOR","body":"@waterlx  I would +1 on your proposal of some serializable table interface. I understand @rdblue argument on not making `Table` interface serializable. \r\n\r\nWe defined a holder interface that holds the serializable components/fields/properties from the `Table` interface in our internal PoC implementation of Flink Iceberg source. However, I don't like the interface name `TableProperties` as it can easily get confused with the table properties concept in Iceberg.\r\n```\r\nimport lombok.Value;\r\n\r\n@Value\r\npublic class TableProperties implements Serializable {\r\n\r\n  private final Schema schema;\r\n  private final FileIO fileIO;\r\n  private final EncryptionManager encryptionManager;\r\n\r\n  public TableProperties(Table table) {\r\n    this.schema = table.schema();\r\n    this.fileIO = table.io();\r\n    this.encryptionManager = table.encryption();\r\n  }\r\n}\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624766145/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624777938","html_url":"https://github.com/apache/iceberg/pull/999#issuecomment-624777938","issue_url":"https://api.github.com/repos/apache/iceberg/issues/999","id":624777938,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNDc3NzkzOA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-06T17:17:07Z","updated_at":"2020-05-06T17:17:07Z","author_association":"CONTRIBUTOR","body":"Thanks, @rdsr! I've fixed the things you pointed out.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624777938/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624778493","html_url":"https://github.com/apache/iceberg/pull/996#issuecomment-624778493","issue_url":"https://api.github.com/repos/apache/iceberg/issues/996","id":624778493,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNDc3ODQ5Mw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-06T17:18:09Z","updated_at":"2020-05-06T17:18:09Z","author_association":"CONTRIBUTOR","body":"@TGooch44, do the tests look okay now?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624778493/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624790128","html_url":"https://github.com/apache/iceberg/pull/1007#issuecomment-624790128","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1007","id":624790128,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNDc5MDEyOA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-06T17:39:47Z","updated_at":"2020-05-06T17:39:47Z","author_association":"CONTRIBUTOR","body":"Thanks, @newroyker! I merged this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624790128/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624800409","html_url":"https://github.com/apache/iceberg/pull/856#issuecomment-624800409","issue_url":"https://api.github.com/repos/apache/iceberg/issues/856","id":624800409,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNDgwMDQwOQ==","user":{"login":"waterlx","id":13976495,"node_id":"MDQ6VXNlcjEzOTc2NDk1","avatar_url":"https://avatars.githubusercontent.com/u/13976495?v=4","gravatar_id":"","url":"https://api.github.com/users/waterlx","html_url":"https://github.com/waterlx","followers_url":"https://api.github.com/users/waterlx/followers","following_url":"https://api.github.com/users/waterlx/following{/other_user}","gists_url":"https://api.github.com/users/waterlx/gists{/gist_id}","starred_url":"https://api.github.com/users/waterlx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/waterlx/subscriptions","organizations_url":"https://api.github.com/users/waterlx/orgs","repos_url":"https://api.github.com/users/waterlx/repos","events_url":"https://api.github.com/users/waterlx/events{/privacy}","received_events_url":"https://api.github.com/users/waterlx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-06T18:00:13Z","updated_at":"2020-05-06T18:04:59Z","author_association":"CONTRIBUTOR","body":"@stevenzwu @JingsongLi Really appreciate your effort to review this PR.  I am working on the comments you provided.\r\nMeanwhile, our team are focusing on verifying/testing the sink and I am in process of uploading the bug fixes/enhancements into this PR one after another.\r\n\r\n**Progress update:**\r\nThe comments by @rdblue @openinx and @jerryshao regarding the initial version of this PR have been almost all addressed. \r\nBegin to work on the following items:\r\n- Addressing the comments added recently by @stevenzwu and @JingsongLi \r\n- Testing and bug fixing\r\n- Adding UT\r\n- Polishing the code and working on check-style issues\r\n\r\nThe PR is being updated and always a workable version (against the master branch) with functions verified. So if you are interested, feel free to download the PR and get it compiled with master branch. [This design doc](https://docs.google.com/document/d/19M-sP6FlTVm7BV7MM4Om1n_MVo1xCy7GyDl_9ZAjVNQ/edit) includes the sample Java code to give it a try  8-)\r\n\r\nDrop me a mail or add any comments if it does not work.\r\n\r\n@jerryshao @chenjunjiedada @openinx @aokolnychyi @ @bowenli86 @stevenzwu @JingsongLi @rdblue FYI","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624800409/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624805772","html_url":"https://github.com/apache/iceberg/pull/856#issuecomment-624805772","issue_url":"https://api.github.com/repos/apache/iceberg/issues/856","id":624805772,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNDgwNTc3Mg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-06T18:10:51Z","updated_at":"2020-05-06T18:10:51Z","author_association":"CONTRIBUTOR","body":"For table serialization, I think the right thing to do is to serialize what is needed to load the table on the node that needs to commit. I'd prefer not to make that a single string if the user passes the namespace and table separately. We should serialize those instead of trying to parse and recover them.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624805772/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624817589","html_url":"https://github.com/apache/iceberg/issues/1005#issuecomment-624817589","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1005","id":624817589,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNDgxNzU4OQ==","user":{"login":"waterlx","id":13976495,"node_id":"MDQ6VXNlcjEzOTc2NDk1","avatar_url":"https://avatars.githubusercontent.com/u/13976495?v=4","gravatar_id":"","url":"https://api.github.com/users/waterlx","html_url":"https://github.com/waterlx","followers_url":"https://api.github.com/users/waterlx/followers","following_url":"https://api.github.com/users/waterlx/following{/other_user}","gists_url":"https://api.github.com/users/waterlx/gists{/gist_id}","starred_url":"https://api.github.com/users/waterlx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/waterlx/subscriptions","organizations_url":"https://api.github.com/users/waterlx/orgs","repos_url":"https://api.github.com/users/waterlx/repos","events_url":"https://api.github.com/users/waterlx/events{/privacy}","received_events_url":"https://api.github.com/users/waterlx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-06T18:34:20Z","updated_at":"2020-05-06T18:34:46Z","author_association":"CONTRIBUTOR","body":"@kaidata Seems something wrong here 8-)\r\n```\r\nval catalog = new HiveCatalog(spark.sessionState.newHadoopConf())\r\n```\r\n\r\nYou might need to provide \"hive.metastore.uris\" into conf when `new HiveCatalog(conf)` ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624817589/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624821068","html_url":"https://github.com/apache/iceberg/pull/993#issuecomment-624821068","issue_url":"https://api.github.com/repos/apache/iceberg/issues/993","id":624821068,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNDgyMTA2OA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-06T18:41:27Z","updated_at":"2020-05-06T18:41:27Z","author_association":"CONTRIBUTOR","body":"+1 after @TGooch44 pointed out that precedence is fixed by this, not broken.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624821068/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624821925","html_url":"https://github.com/apache/iceberg/pull/993#issuecomment-624821925","issue_url":"https://api.github.com/repos/apache/iceberg/issues/993","id":624821925,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNDgyMTkyNQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-06T18:43:04Z","updated_at":"2020-05-06T18:43:04Z","author_association":"CONTRIBUTOR","body":"Just thought of one more thing. Should we test NOT precedence as well?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624821925/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624825178","html_url":"https://github.com/apache/iceberg/pull/993#issuecomment-624825178","issue_url":"https://api.github.com/repos/apache/iceberg/issues/993","id":624825178,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNDgyNTE3OA==","user":{"login":"TGooch44","id":1591711,"node_id":"MDQ6VXNlcjE1OTE3MTE=","avatar_url":"https://avatars.githubusercontent.com/u/1591711?v=4","gravatar_id":"","url":"https://api.github.com/users/TGooch44","html_url":"https://github.com/TGooch44","followers_url":"https://api.github.com/users/TGooch44/followers","following_url":"https://api.github.com/users/TGooch44/following{/other_user}","gists_url":"https://api.github.com/users/TGooch44/gists{/gist_id}","starred_url":"https://api.github.com/users/TGooch44/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TGooch44/subscriptions","organizations_url":"https://api.github.com/users/TGooch44/orgs","repos_url":"https://api.github.com/users/TGooch44/repos","events_url":"https://api.github.com/users/TGooch44/events{/privacy}","received_events_url":"https://api.github.com/users/TGooch44/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-06T18:49:26Z","updated_at":"2020-05-06T18:49:26Z","author_association":"CONTRIBUTOR","body":"I can add a test in a new PR since this was just merged\n\n\nOn Wed, May 6, 2020 at 11:43 AM Ryan Blue <notifications@github.com> wrote:\n\n> Just thought of one more thing. Should we test NOT precedence as well?\n>\n> —\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/apache/incubator-iceberg/pull/993#issuecomment-624821925>,\n> or unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/AAMETH2TCJHQY5X43QOLQFDRQGVUPANCNFSM4MWX27GA>\n> .\n>\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624825178/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624828989","html_url":"https://github.com/apache/iceberg/pull/996#issuecomment-624828989","issue_url":"https://api.github.com/repos/apache/iceberg/issues/996","id":624828989,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNDgyODk4OQ==","user":{"login":"TGooch44","id":1591711,"node_id":"MDQ6VXNlcjE1OTE3MTE=","avatar_url":"https://avatars.githubusercontent.com/u/1591711?v=4","gravatar_id":"","url":"https://api.github.com/users/TGooch44","html_url":"https://github.com/TGooch44","followers_url":"https://api.github.com/users/TGooch44/followers","following_url":"https://api.github.com/users/TGooch44/following{/other_user}","gists_url":"https://api.github.com/users/TGooch44/gists{/gist_id}","starred_url":"https://api.github.com/users/TGooch44/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TGooch44/subscriptions","organizations_url":"https://api.github.com/users/TGooch44/orgs","repos_url":"https://api.github.com/users/TGooch44/repos","events_url":"https://api.github.com/users/TGooch44/events{/privacy}","received_events_url":"https://api.github.com/users/TGooch44/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-06T18:56:22Z","updated_at":"2020-05-06T18:56:22Z","author_association":"CONTRIBUTOR","body":"+1 from me","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624828989/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624830209","html_url":"https://github.com/apache/iceberg/pull/544#issuecomment-624830209","issue_url":"https://api.github.com/repos/apache/iceberg/issues/544","id":624830209,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNDgzMDIwOQ==","user":{"login":"TGooch44","id":1591711,"node_id":"MDQ6VXNlcjE1OTE3MTE=","avatar_url":"https://avatars.githubusercontent.com/u/1591711?v=4","gravatar_id":"","url":"https://api.github.com/users/TGooch44","html_url":"https://github.com/TGooch44","followers_url":"https://api.github.com/users/TGooch44/followers","following_url":"https://api.github.com/users/TGooch44/following{/other_user}","gists_url":"https://api.github.com/users/TGooch44/gists{/gist_id}","starred_url":"https://api.github.com/users/TGooch44/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TGooch44/subscriptions","organizations_url":"https://api.github.com/users/TGooch44/orgs","repos_url":"https://api.github.com/users/TGooch44/repos","events_url":"https://api.github.com/users/TGooch44/events{/privacy}","received_events_url":"https://api.github.com/users/TGooch44/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-06T18:58:52Z","updated_at":"2020-05-06T18:58:52Z","author_association":"CONTRIBUTOR","body":"> @TGooch44 This has landed in pyarrow as of 0.17.0\r\n\r\n@mariusvniekerk Yes, thanks for the heads up.  I'm planning on updating this PR within the week to reflect the updates in arrow","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624830209/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624909717","html_url":"https://github.com/apache/iceberg/issues/797#issuecomment-624909717","issue_url":"https://api.github.com/repos/apache/iceberg/issues/797","id":624909717,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNDkwOTcxNw==","user":{"login":"adamkennedy","id":114942,"node_id":"MDQ6VXNlcjExNDk0Mg==","avatar_url":"https://avatars.githubusercontent.com/u/114942?v=4","gravatar_id":"","url":"https://api.github.com/users/adamkennedy","html_url":"https://github.com/adamkennedy","followers_url":"https://api.github.com/users/adamkennedy/followers","following_url":"https://api.github.com/users/adamkennedy/following{/other_user}","gists_url":"https://api.github.com/users/adamkennedy/gists{/gist_id}","starred_url":"https://api.github.com/users/adamkennedy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adamkennedy/subscriptions","organizations_url":"https://api.github.com/users/adamkennedy/orgs","repos_url":"https://api.github.com/users/adamkennedy/repos","events_url":"https://api.github.com/users/adamkennedy/events{/privacy}","received_events_url":"https://api.github.com/users/adamkennedy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-06T21:50:01Z","updated_at":"2020-05-06T21:50:01Z","author_association":"NONE","body":"Alternatively, generating your own ImmutableMap by doing a repeated inheritance inlining of the commons collections classes would be fairly straight forwards as well, if the licenses are compatible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624909717/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624942454","html_url":"https://github.com/apache/iceberg/pull/891#issuecomment-624942454","issue_url":"https://api.github.com/repos/apache/iceberg/issues/891","id":624942454,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNDk0MjQ1NA==","user":{"login":"danielcweeks","id":4925077,"node_id":"MDQ6VXNlcjQ5MjUwNzc=","avatar_url":"https://avatars.githubusercontent.com/u/4925077?v=4","gravatar_id":"","url":"https://api.github.com/users/danielcweeks","html_url":"https://github.com/danielcweeks","followers_url":"https://api.github.com/users/danielcweeks/followers","following_url":"https://api.github.com/users/danielcweeks/following{/other_user}","gists_url":"https://api.github.com/users/danielcweeks/gists{/gist_id}","starred_url":"https://api.github.com/users/danielcweeks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielcweeks/subscriptions","organizations_url":"https://api.github.com/users/danielcweeks/orgs","repos_url":"https://api.github.com/users/danielcweeks/repos","events_url":"https://api.github.com/users/danielcweeks/events{/privacy}","received_events_url":"https://api.github.com/users/danielcweeks/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-06T23:26:57Z","updated_at":"2020-05-06T23:26:57Z","author_association":"CONTRIBUTOR","body":"This all looks good to me. +1","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624942454/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624950741","html_url":"https://github.com/apache/iceberg/pull/995#issuecomment-624950741","issue_url":"https://api.github.com/repos/apache/iceberg/issues/995","id":624950741,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNDk1MDc0MQ==","user":{"login":"danielcweeks","id":4925077,"node_id":"MDQ6VXNlcjQ5MjUwNzc=","avatar_url":"https://avatars.githubusercontent.com/u/4925077?v=4","gravatar_id":"","url":"https://api.github.com/users/danielcweeks","html_url":"https://github.com/danielcweeks","followers_url":"https://api.github.com/users/danielcweeks/followers","following_url":"https://api.github.com/users/danielcweeks/following{/other_user}","gists_url":"https://api.github.com/users/danielcweeks/gists{/gist_id}","starred_url":"https://api.github.com/users/danielcweeks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielcweeks/subscriptions","organizations_url":"https://api.github.com/users/danielcweeks/orgs","repos_url":"https://api.github.com/users/danielcweeks/repos","events_url":"https://api.github.com/users/danielcweeks/events{/privacy}","received_events_url":"https://api.github.com/users/danielcweeks/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-06T23:52:23Z","updated_at":"2020-05-06T23:52:23Z","author_association":"CONTRIBUTOR","body":"So, this all looks good in terms of implementing these three move behaviors and I suspect a single column move is probably the most common case.  Hive supports a replace columns where you provide a new order list of positions and (of course depending on the file format and column resolution) will reorder the columns.  \r\n\r\nIt appears that Spark doesn't support ALTER TABLE ... REPLACE COLUMNS and presto has no syntax for reordering (also my understanding is there is no SQL standard for reordering).\r\n\r\nIt might be nice to have an option to take the existing schema and provide a new ordered list of columns (though that can be modeled with these primitives, so possibly a future enhancement?).\r\n\r\n+1 (nice test coverage)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624950741/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624951602","html_url":"https://github.com/apache/iceberg/pull/1002#issuecomment-624951602","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1002","id":624951602,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNDk1MTYwMg==","user":{"login":"danielcweeks","id":4925077,"node_id":"MDQ6VXNlcjQ5MjUwNzc=","avatar_url":"https://avatars.githubusercontent.com/u/4925077?v=4","gravatar_id":"","url":"https://api.github.com/users/danielcweeks","html_url":"https://github.com/danielcweeks","followers_url":"https://api.github.com/users/danielcweeks/followers","following_url":"https://api.github.com/users/danielcweeks/following{/other_user}","gists_url":"https://api.github.com/users/danielcweeks/gists{/gist_id}","starred_url":"https://api.github.com/users/danielcweeks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielcweeks/subscriptions","organizations_url":"https://api.github.com/users/danielcweeks/orgs","repos_url":"https://api.github.com/users/danielcweeks/repos","events_url":"https://api.github.com/users/danielcweeks/events{/privacy}","received_events_url":"https://api.github.com/users/danielcweeks/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-06T23:55:47Z","updated_at":"2020-05-06T23:55:47Z","author_association":"CONTRIBUTOR","body":"+1 LGTM","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624951602/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624957012","html_url":"https://github.com/apache/iceberg/pull/995#issuecomment-624957012","issue_url":"https://api.github.com/repos/apache/iceberg/issues/995","id":624957012,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNDk1NzAxMg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-07T00:15:30Z","updated_at":"2020-05-07T00:15:30Z","author_association":"CONTRIBUTOR","body":"> It might be nice to have an option to take the existing schema and provide a new ordered list of columns\r\n\r\nAgreed, but we have to be careful. The problem with REPLACE COLUMNS is that it isn't clear what the semantics are if a column is apparently removed and a new one is in its place. Is it a rename? What if the type was changed/widened? So we'd want to have a strict set of rules for reordering that removed ambiguous cases and probably didn't allow things like dropping a column that way.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624957012/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624990261","html_url":"https://github.com/apache/iceberg/issues/1005#issuecomment-624990261","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1005","id":624990261,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNDk5MDI2MQ==","user":{"login":"kaidata","id":20488453,"node_id":"MDQ6VXNlcjIwNDg4NDUz","avatar_url":"https://avatars.githubusercontent.com/u/20488453?v=4","gravatar_id":"","url":"https://api.github.com/users/kaidata","html_url":"https://github.com/kaidata","followers_url":"https://api.github.com/users/kaidata/followers","following_url":"https://api.github.com/users/kaidata/following{/other_user}","gists_url":"https://api.github.com/users/kaidata/gists{/gist_id}","starred_url":"https://api.github.com/users/kaidata/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaidata/subscriptions","organizations_url":"https://api.github.com/users/kaidata/orgs","repos_url":"https://api.github.com/users/kaidata/repos","events_url":"https://api.github.com/users/kaidata/events{/privacy}","received_events_url":"https://api.github.com/users/kaidata/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-07T02:20:25Z","updated_at":"2020-05-07T02:20:25Z","author_association":"NONE","body":"@waterlx ths your reply;\r\n1. my scenario(environment) is just on spark(spark-sql), no hive metastore service;\r\n2. can your introduce some reference files to me that i can read or write iceberg table(all flow), so i can analysis(or debug the deep logical) the metadata and data of iceberg","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624990261/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624994756","html_url":"https://github.com/apache/iceberg/pull/1000#issuecomment-624994756","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1000","id":624994756,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNDk5NDc1Ng==","user":{"login":"prodeezy","id":1474591,"node_id":"MDQ6VXNlcjE0NzQ1OTE=","avatar_url":"https://avatars.githubusercontent.com/u/1474591?v=4","gravatar_id":"","url":"https://api.github.com/users/prodeezy","html_url":"https://github.com/prodeezy","followers_url":"https://api.github.com/users/prodeezy/followers","following_url":"https://api.github.com/users/prodeezy/following{/other_user}","gists_url":"https://api.github.com/users/prodeezy/gists{/gist_id}","starred_url":"https://api.github.com/users/prodeezy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/prodeezy/subscriptions","organizations_url":"https://api.github.com/users/prodeezy/orgs","repos_url":"https://api.github.com/users/prodeezy/repos","events_url":"https://api.github.com/users/prodeezy/events{/privacy}","received_events_url":"https://api.github.com/users/prodeezy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-07T02:37:03Z","updated_at":"2020-05-07T02:37:03Z","author_association":"CONTRIBUTOR","body":"lgtm @samarthjain ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/624994756/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/625072006","html_url":"https://github.com/apache/iceberg/issues/1005#issuecomment-625072006","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1005","id":625072006,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNTA3MjAwNg==","user":{"login":"waterlx","id":13976495,"node_id":"MDQ6VXNlcjEzOTc2NDk1","avatar_url":"https://avatars.githubusercontent.com/u/13976495?v=4","gravatar_id":"","url":"https://api.github.com/users/waterlx","html_url":"https://github.com/waterlx","followers_url":"https://api.github.com/users/waterlx/followers","following_url":"https://api.github.com/users/waterlx/following{/other_user}","gists_url":"https://api.github.com/users/waterlx/gists{/gist_id}","starred_url":"https://api.github.com/users/waterlx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/waterlx/subscriptions","organizations_url":"https://api.github.com/users/waterlx/orgs","repos_url":"https://api.github.com/users/waterlx/repos","events_url":"https://api.github.com/users/waterlx/events{/privacy}","received_events_url":"https://api.github.com/users/waterlx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-07T07:07:00Z","updated_at":"2020-05-07T07:07:00Z","author_association":"CONTRIBUTOR","body":"@kaidata \r\nRegarding:\r\n> my scenario(environment) is just on spark(spark-sql), no hive metastore service;\r\n\r\nGot that. But the code you are using is to new a Hive catalog. Hive Catalog is backed by a Hive MetaStore. You can download Hive 2.3.6 package and launch a local Hive MetaStore (using embedded mode).\r\nOr you can use HadoopTables to create the table. You only need to specify a path on file sytem. No extra service (like Hive MetaStore) is needed. \r\n\r\nRegarding:\r\n> can your introduce some reference files to me that i can read or write iceberg table(all flow), so i can analysis(or debug the deep logical) the metadata and data of iceberg\r\n\r\nThe following 2 pages are good ones to start with:\r\n(1) http://iceberg.apache.org/java-api-quickstart/\r\n(2) http://iceberg.apache.org/spark/\r\nWe also have some posts in Chinese, if you can read Chinese and prefer to reading it, please drop me a mail at waterlx@gmail.com.\r\nRegarding debug, Spark read/write with remote debug on IDE could be used to know internal logic.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/625072006/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/625083974","html_url":"https://github.com/apache/iceberg/issues/1009#issuecomment-625083974","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1009","id":625083974,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNTA4Mzk3NA==","user":{"login":"waterlx","id":13976495,"node_id":"MDQ6VXNlcjEzOTc2NDk1","avatar_url":"https://avatars.githubusercontent.com/u/13976495?v=4","gravatar_id":"","url":"https://api.github.com/users/waterlx","html_url":"https://github.com/waterlx","followers_url":"https://api.github.com/users/waterlx/followers","following_url":"https://api.github.com/users/waterlx/following{/other_user}","gists_url":"https://api.github.com/users/waterlx/gists{/gist_id}","starred_url":"https://api.github.com/users/waterlx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/waterlx/subscriptions","organizations_url":"https://api.github.com/users/waterlx/orgs","repos_url":"https://api.github.com/users/waterlx/repos","events_url":"https://api.github.com/users/waterlx/events{/privacy}","received_events_url":"https://api.github.com/users/waterlx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-07T07:34:43Z","updated_at":"2020-05-07T07:34:43Z","author_association":"CONTRIBUTOR","body":"Hi @kaidata, thanks for bringing those issues to the community ^_^\r\n\r\nThe  offical website could be accessed. I met only a few times when the website could not be accessed or responded slowly. Please try to refresh it and that always works.\r\n\r\nWe do have \"get started\" pages, like:\r\n(1) http://iceberg.apache.org/java-api-quickstart/\r\n(2) http://iceberg.apache.org/spark/\r\nI know they are not perfect and need to be refined to some extend, so please raise detailed issues on which are not clear or not easy to understand, and we could make it better and more convenient to new comers (I am also a new comer here)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/625083974/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/625153818","html_url":"https://github.com/apache/iceberg/issues/1010#issuecomment-625153818","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1010","id":625153818,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNTE1MzgxOA==","user":{"login":"zachary124","id":3360971,"node_id":"MDQ6VXNlcjMzNjA5NzE=","avatar_url":"https://avatars.githubusercontent.com/u/3360971?v=4","gravatar_id":"","url":"https://api.github.com/users/zachary124","html_url":"https://github.com/zachary124","followers_url":"https://api.github.com/users/zachary124/followers","following_url":"https://api.github.com/users/zachary124/following{/other_user}","gists_url":"https://api.github.com/users/zachary124/gists{/gist_id}","starred_url":"https://api.github.com/users/zachary124/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zachary124/subscriptions","organizations_url":"https://api.github.com/users/zachary124/orgs","repos_url":"https://api.github.com/users/zachary124/repos","events_url":"https://api.github.com/users/zachary124/events{/privacy}","received_events_url":"https://api.github.com/users/zachary124/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-07T09:56:51Z","updated_at":"2020-05-07T09:56:51Z","author_association":"NONE","body":"hello，I want to use sparkSQL query iceberg hive table just like I query other hive table。I had build iceberg branch spark-3 and can create table and query table use spark。 but when I query the hive table use sql， it returned an error :\r\n`java.lang.RuntimeException: java.lang.InstantiationException\r\n\tat org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:134)\r\n\tat org.apache.spark.rdd.HadoopRDD.getInputFormat(HadoopRDD.scala:191)\r\n\tat org.apache.spark.rdd.HadoopRDD.getPartitions(HadoopRDD.scala:205)\r\n\tat org.apache.spark.rdd.RDD.$anonfun$partitions$2(RDD.scala:276)\r\n\tat scala.Option.getOrElse(Option.scala:138)\r\n\tat org.apache.spark.rdd.RDD.partitions(RDD.scala:272)\r\n\tat org.apache.spark.rdd.MapPartitionsRDD.getPartitions(MapPartitionsRDD.scala:49)\r\n\tat org.apache.spark.rdd.RDD.$anonfun$partitions$2(RDD.scala:276)\r\n\tat scala.Option.getOrElse(Option.scala:138)\r\n\tat org.apache.spark.rdd.RDD.partitions(RDD.scala:272)\r\n\tat org.apache.spark.rdd.MapPartitionsRDD.getPartitions(MapPartitionsRDD.scala:49)\r\n\tat org.apache.spark.rdd.RDD.$anonfun$partitions$2(RDD.scala:276)\r\n\tat scala.Option.getOrElse(Option.scala:138)\r\n\tat org.apache.spark.rdd.RDD.partitions(RDD.scala:272)\r\n\tat org.apache.spark.rdd.MapPartitionsRDD.getPartitions(MapPartitionsRDD.scala:49)\r\n\tat org.apache.spark.rdd.RDD.$anonfun$partitions$2(RDD.scala:276)\r\n\tat scala.Option.getOrElse(Option.scala:138)\r\n\tat org.apache.spark.rdd.RDD.partitions(RDD.scala:272)\r\n\tat org.apache.spark.rdd.MapPartitionsRDD.getPartitions(MapPartitionsRDD.scala:49)\r\n\tat org.apache.spark.rdd.RDD.$anonfun$partitions$2(RDD.scala:276)\r\n\tat scala.Option.getOrElse(Option.scala:138)\r\n\tat org.apache.spark.rdd.RDD.partitions(RDD.scala:272)\r\n\tat org.apache.spark.sql.execution.SparkPlan.executeTake(SparkPlan.scala:408)\r\n\tat org.apache.spark.sql.execution.CollectLimitExec.executeCollect(limit.scala:47)\r\n\tat org.apache.spark.sql.Dataset.collectFromPlan(Dataset.scala:3482)\r\n\tat org.apache.spark.sql.Dataset.$anonfun$head$1(Dataset.scala:2581)\r\n\tat org.apache.spark.sql.Dataset.$anonfun$withAction$1(Dataset.scala:3472)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$4(SQLExecution.scala:100)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:160)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:87)\r\n\tat org.apache.spark.sql.Dataset.withAction(Dataset.scala:3468)\r\n\tat org.apache.spark.sql.Dataset.head(Dataset.scala:2581)\r\n\tat org.apache.spark.sql.Dataset.take(Dataset.scala:2788)\r\n\tat org.apache.spark.sql.Dataset.getRows(Dataset.scala:297)\r\n\tat org.apache.spark.sql.Dataset.showString(Dataset.scala:334)\r\n\tat org.apache.spark.sql.Dataset.show(Dataset.scala:818)\r\n\tat org.apache.spark.sql.Dataset.show(Dataset.scala:795)\r\n\tat com.zachary.lake.SparkIcebergTestJob.createByHive(SparkIcebergTestJob.java:66)`\r\n\r\nmy code is \r\n![image](https://user-images.githubusercontent.com/3360971/81281138-06ac5580-908c-11ea-9abd-537e28dc278d.png)\r\n\r\nthanks \r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/625153818/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/625155907","html_url":"https://github.com/apache/iceberg/issues/1010#issuecomment-625155907","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1010","id":625155907,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNTE1NTkwNw==","user":{"login":"zachary124","id":3360971,"node_id":"MDQ6VXNlcjMzNjA5NzE=","avatar_url":"https://avatars.githubusercontent.com/u/3360971?v=4","gravatar_id":"","url":"https://api.github.com/users/zachary124","html_url":"https://github.com/zachary124","followers_url":"https://api.github.com/users/zachary124/followers","following_url":"https://api.github.com/users/zachary124/following{/other_user}","gists_url":"https://api.github.com/users/zachary124/gists{/gist_id}","starred_url":"https://api.github.com/users/zachary124/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zachary124/subscriptions","organizations_url":"https://api.github.com/users/zachary124/orgs","repos_url":"https://api.github.com/users/zachary124/repos","events_url":"https://api.github.com/users/zachary124/events{/privacy}","received_events_url":"https://api.github.com/users/zachary124/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-07T10:00:53Z","updated_at":"2020-05-07T10:00:53Z","author_association":"NONE","body":"I tried it on spark2.4.4, and the problem was the same, so I switched to spark3 and tried again ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/625155907/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/625364932","html_url":"https://github.com/apache/iceberg/pull/996#issuecomment-625364932","issue_url":"https://api.github.com/repos/apache/iceberg/issues/996","id":625364932,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNTM2NDkzMg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-07T16:37:40Z","updated_at":"2020-05-07T16:37:40Z","author_association":"CONTRIBUTOR","body":"Thanks for fixing this, @jun-he! And thanks for reviewing, @TGooch44!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/625364932/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/625371050","html_url":"https://github.com/apache/iceberg/pull/952#issuecomment-625371050","issue_url":"https://api.github.com/repos/apache/iceberg/issues/952","id":625371050,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNTM3MTA1MA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-07T16:48:59Z","updated_at":"2020-05-07T16:48:59Z","author_association":"CONTRIBUTOR","body":"I'm closing this because we plan to keep the separate structs.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/625371050/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/625371398","html_url":"https://github.com/apache/iceberg/pull/963#issuecomment-625371398","issue_url":"https://api.github.com/repos/apache/iceberg/issues/963","id":625371398,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNTM3MTM5OA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-07T16:49:37Z","updated_at":"2020-05-07T16:49:37Z","author_association":"CONTRIBUTOR","body":"I'm closing this because we plan to keep manifest_entry and data_file as separate structs.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/625371398/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/625398120","html_url":"https://github.com/apache/iceberg/pull/1002#issuecomment-625398120","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1002","id":625398120,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNTM5ODEyMA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-07T17:38:37Z","updated_at":"2020-05-07T17:38:37Z","author_association":"CONTRIBUTOR","body":"I'm going to merge this because the tests passed for the original commit and the new commit only changes comments.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/625398120/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/625427130","html_url":"https://github.com/apache/iceberg/pull/973#issuecomment-625427130","issue_url":"https://api.github.com/repos/apache/iceberg/issues/973","id":625427130,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNTQyNzEzMA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-07T18:36:54Z","updated_at":"2020-05-07T18:36:54Z","author_association":"CONTRIBUTOR","body":"Overall, this looks great and is very thorough. Thanks @shardulm94!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/625427130/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/625437097","html_url":"https://github.com/apache/iceberg/issues/757#issuecomment-625437097","issue_url":"https://api.github.com/repos/apache/iceberg/issues/757","id":625437097,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNTQzNzA5Nw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-07T18:57:21Z","updated_at":"2020-05-07T18:57:21Z","author_association":"CONTRIBUTOR","body":"I agree with @prodeezy that documenting those will be helpful.\r\n\r\n@whoAbhishekSah, sorry for the late reply. Please feel free to pick this up and contribute!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/625437097/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/625441120","html_url":"https://github.com/apache/iceberg/pull/1004#issuecomment-625441120","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1004","id":625441120,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNTQ0MTEyMA==","user":{"login":"danielcweeks","id":4925077,"node_id":"MDQ6VXNlcjQ5MjUwNzc=","avatar_url":"https://avatars.githubusercontent.com/u/4925077?v=4","gravatar_id":"","url":"https://api.github.com/users/danielcweeks","html_url":"https://github.com/danielcweeks","followers_url":"https://api.github.com/users/danielcweeks/followers","following_url":"https://api.github.com/users/danielcweeks/following{/other_user}","gists_url":"https://api.github.com/users/danielcweeks/gists{/gist_id}","starred_url":"https://api.github.com/users/danielcweeks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielcweeks/subscriptions","organizations_url":"https://api.github.com/users/danielcweeks/orgs","repos_url":"https://api.github.com/users/danielcweeks/repos","events_url":"https://api.github.com/users/danielcweeks/events{/privacy}","received_events_url":"https://api.github.com/users/danielcweeks/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-07T19:05:38Z","updated_at":"2020-05-07T19:05:38Z","author_association":"CONTRIBUTOR","body":"+1 LGTM, you might want to file an issue for ORC to support the constant projection because I assume ORC will still pay the additional copy cost.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/625441120/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/625442392","html_url":"https://github.com/apache/iceberg/pull/1004#issuecomment-625442392","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1004","id":625442392,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNTQ0MjM5Mg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-07T19:08:09Z","updated_at":"2020-05-07T19:08:09Z","author_association":"CONTRIBUTOR","body":"Ratandeep is already working on constant projection in #989.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/625442392/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/625447206","html_url":"https://github.com/apache/iceberg/pull/1004#issuecomment-625447206","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1004","id":625447206,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNTQ0NzIwNg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-07T19:18:18Z","updated_at":"2020-05-07T19:18:18Z","author_association":"CONTRIBUTOR","body":"I'm not sure why CI didn't run, but I tested locally to verify this change and everything passes. I'm going to merge this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/625447206/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/625448728","html_url":"https://github.com/apache/iceberg/pull/1000#issuecomment-625448728","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1000","id":625448728,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNTQ0ODcyOA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-07T19:21:38Z","updated_at":"2020-05-07T19:21:38Z","author_association":"CONTRIBUTOR","body":"#1004 was merged, so I don't think we need this refactor any longer.\r\n\r\nThere were only 2 cases where we need to project before returning a batch or row to Spark: if extra columns were projected for filtering (fixed by #1004) or when using a JoinedRow to add identity partition values. Since vectorized reads don't support adding identity-partitioned values, there are no longer any cases where we need to project.\r\n\r\nAlso, when vectorized reads do support identity-partitioned values, we should be able to use the `idToConstant` map that Avro and Parquet currently use. Then we would create columns in the right order to begin with and won't need a projection at all.\r\n\r\nSince this isn't needed and I already talked with @samarthjain, I'm going to close it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/625448728/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/625467381","html_url":"https://github.com/apache/iceberg/pull/891#issuecomment-625467381","issue_url":"https://api.github.com/repos/apache/iceberg/issues/891","id":625467381,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNTQ2NzM4MQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-07T20:01:39Z","updated_at":"2020-05-07T20:01:39Z","author_association":"CONTRIBUTOR","body":"Thanks for reviewing, everyone!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/625467381/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/625539715","html_url":"https://github.com/apache/iceberg/issues/1005#issuecomment-625539715","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1005","id":625539715,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNTUzOTcxNQ==","user":{"login":"kaidata","id":20488453,"node_id":"MDQ6VXNlcjIwNDg4NDUz","avatar_url":"https://avatars.githubusercontent.com/u/20488453?v=4","gravatar_id":"","url":"https://api.github.com/users/kaidata","html_url":"https://github.com/kaidata","followers_url":"https://api.github.com/users/kaidata/followers","following_url":"https://api.github.com/users/kaidata/following{/other_user}","gists_url":"https://api.github.com/users/kaidata/gists{/gist_id}","starred_url":"https://api.github.com/users/kaidata/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaidata/subscriptions","organizations_url":"https://api.github.com/users/kaidata/orgs","repos_url":"https://api.github.com/users/kaidata/repos","events_url":"https://api.github.com/users/kaidata/events{/privacy}","received_events_url":"https://api.github.com/users/kaidata/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-07T23:02:10Z","updated_at":"2020-05-07T23:02:10Z","author_association":"NONE","body":"@waterlx \r\nthx your replay, \r\n1. hadoop table, i have done; but when dataframe append save to location(table)，metadata is right，data have no change(no new parquet generate)\r\n2. hive table, use hive metastore service, i am doing now;\r\n\r\n```\r\nRegarding debug, Spark read/write with remote debug on IDE could be used to know internal logic.\r\n```\r\nyes, this is a good way(remote debug, when i write plugin of DataX); but i always debug in local ide environment As much as possible (just config hadoop_home(ddl) or change some line in NativeIO)【sometimes you should to overwrite opensource logical in temporary】【this is more convenient】\r\n\r\non the other hand，i am researching the data lake tech at recent(the document is [here](https://www.yuque.com/docs/share/8752f4b6-81aa-4feb-8929-a424b642f4bd?#));\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/625539715/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/625611615","html_url":"https://github.com/apache/iceberg/issues/1005#issuecomment-625611615","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1005","id":625611615,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNTYxMTYxNQ==","user":{"login":"waterlx","id":13976495,"node_id":"MDQ6VXNlcjEzOTc2NDk1","avatar_url":"https://avatars.githubusercontent.com/u/13976495?v=4","gravatar_id":"","url":"https://api.github.com/users/waterlx","html_url":"https://github.com/waterlx","followers_url":"https://api.github.com/users/waterlx/followers","following_url":"https://api.github.com/users/waterlx/following{/other_user}","gists_url":"https://api.github.com/users/waterlx/gists{/gist_id}","starred_url":"https://api.github.com/users/waterlx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/waterlx/subscriptions","organizations_url":"https://api.github.com/users/waterlx/orgs","repos_url":"https://api.github.com/users/waterlx/repos","events_url":"https://api.github.com/users/waterlx/events{/privacy}","received_events_url":"https://api.github.com/users/waterlx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-08T03:33:55Z","updated_at":"2020-05-08T03:33:55Z","author_association":"CONTRIBUTOR","body":"@kaidata  I used remote debug to debug local Spark and Iceberg too. Not sure if it could work for you.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/625611615/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/625702259","html_url":"https://github.com/apache/iceberg/pull/1013#issuecomment-625702259","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1013","id":625702259,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNTcwMjI1OQ==","user":{"login":"waterlx","id":13976495,"node_id":"MDQ6VXNlcjEzOTc2NDk1","avatar_url":"https://avatars.githubusercontent.com/u/13976495?v=4","gravatar_id":"","url":"https://api.github.com/users/waterlx","html_url":"https://github.com/waterlx","followers_url":"https://api.github.com/users/waterlx/followers","following_url":"https://api.github.com/users/waterlx/following{/other_user}","gists_url":"https://api.github.com/users/waterlx/gists{/gist_id}","starred_url":"https://api.github.com/users/waterlx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/waterlx/subscriptions","organizations_url":"https://api.github.com/users/waterlx/orgs","repos_url":"https://api.github.com/users/waterlx/repos","events_url":"https://api.github.com/users/waterlx/events{/privacy}","received_events_url":"https://api.github.com/users/waterlx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-08T08:22:43Z","updated_at":"2020-05-08T08:23:11Z","author_association":"CONTRIBUTOR","body":"The most direct way to address #994 is to limit the logic so that only PositionAccessor itself could be wrapped by Position2Accessor, while Its sub-classes is to be wrapped by WrappedPositionAccessor.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/625702259/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/625789601","html_url":"https://github.com/apache/iceberg/pull/1015#issuecomment-625789601","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1015","id":625789601,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNTc4OTYwMQ==","user":{"login":"waterlx","id":13976495,"node_id":"MDQ6VXNlcjEzOTc2NDk1","avatar_url":"https://avatars.githubusercontent.com/u/13976495?v=4","gravatar_id":"","url":"https://api.github.com/users/waterlx","html_url":"https://github.com/waterlx","followers_url":"https://api.github.com/users/waterlx/followers","following_url":"https://api.github.com/users/waterlx/following{/other_user}","gists_url":"https://api.github.com/users/waterlx/gists{/gist_id}","starred_url":"https://api.github.com/users/waterlx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/waterlx/subscriptions","organizations_url":"https://api.github.com/users/waterlx/orgs","repos_url":"https://api.github.com/users/waterlx/repos","events_url":"https://api.github.com/users/waterlx/events{/privacy}","received_events_url":"https://api.github.com/users/waterlx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-08T12:22:14Z","updated_at":"2020-05-08T12:22:14Z","author_association":"CONTRIBUTOR","body":"@rdblue Would you please reivew this small fix? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/625789601/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]